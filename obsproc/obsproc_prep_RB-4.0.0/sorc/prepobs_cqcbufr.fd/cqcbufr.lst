Page 1           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

      1 C$$$  MAIN PROGRAM DOCUMENTATION BLOCK
      2 C
      3 C MAIN PROGRAM: PREPOBS_CQCBUFR
      4 C   PRGMMR: KEYSER           ORG: NP22        DATE: 2016-05-18
      5 C
      6 C ABSTRACT: Perform complex quality control of rawinsonde heights
      7 C   and temperatures.  Errors are detected and many corrected.
      8 C   Checks used: Hydrostatic, increment, horizontal statistical,
      9 C   vertical statistical, (temporal,) baseline, and lapse rate.
     10 C   Also calculates intersonde (radiation) bias corrections.
     11 C
     12 C PROGRAM HISTORY LOG:
     13 C 1997-03-18  W. Collins  This code owes its heritage to CQCBUFR.
     14 C     However, this version is completely rewritten.  The qc for
     15 C     mandatory and significant levels is unified.
     16 C 1997-05-12  W. Collins  Corrections to subroutines called by
     17 C     AUXLEVS to make proper changes to auxiliary levels when data
     18 C     levels are corrected.  Also, add switch so that virtual
     19 C     temperature calculation can be bypassed.
     20 C 1997-05-19  W. Collins  Further corrections to subroutines
     21 C     called by AUXLEVS.
     22 C 1997-06-04  W. Collins  Prevent division by 0. when surface
     23 C     pressure is changed to mand lvl value.
     24 C 1997-06-09  W. Collins  Treat tropopause like significant temperature
     25 C     levels for DMA logic.  Slightly modify input to make sure that
     26 C     forecast variables are always picked up.
     27 C 1997-07-02  W. Collins  Allow larger temperature residuals at
     28 C     tropopause.  Correct error so that category 4 heights will be
     29 C     recalculated when necessary.
     30 C 1997-07-23  W. Collins  Correct error in 97-07-02 changes.
     31 C 1997-08-18  D. Keyser   LAPSE more carefully checks for equal 
     32 C     spanning pressure (to avoid divide by zero possibility)
     33 C 1997-08-27  W. Collins  VTPEVN error in virtual temperature
     34 C     calculation of dropsondes corrected.
     35 C 1997-09-25  W. Collins  Add switch to choose between using SQN to 
     36 C     match parts of report or not. USESQN needs to be .FALSE. for
     37 C     Reanalysis
     38 C 1997-10-16  W. Collins  Turn off type 106 baseline corrections.
     39 C 1997-12-09  W. Collins  Add switch DOHOR to be able to turn off
     40 C     the horizontal check, thus saving time.  VTPEVN sets the reason
     41 C     code for moisture variables to 1.  Corrected error in ZDIF; now
     42 C     correctly finds ZM.  Recalculate Tv when T is corrected.
     43 C 1998-01-07  W. Collins  Change RADEVN so that levels below ground
     44 C     will never get a radiation correction.
     45 C 1998-01-15  W. Collins  Limit computation error corrections to
     46 C     1.5 times limit for single level ht. corrs.
     47 C 1998-01-27  W. Collins  Temporal check is included for use by
     48 C     Reanalysis.
     49 C 1998-02-18  W. Collins  Resolve few remaining inconsistencies in
     50 C     use of TDO (dew-point depression)
     51 C 1998-02-23  W. Collins  Correct T130 to properly handle 1 missing
     52 C     level.  Eliminate warnings when compiled with standard Fortran
     53 C     90.
     54 C 1998-06-24  D. A. Keyser -- Radiosonde Types 37, 52, 61-63 (all
     55 C     Vaisala RS80) are no longer corrected (both in and out of U.S.),
     56 C     Radiosonde Type 60 (Vasiala RS80/Microcora) is still corrected
     57 C     as before (both in and out of U.S.)

Page 2           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

     58 C 1998-08-14  W. Collins  Make additional changes for Fortran 90
     59 C     compatibility.  Modifications made for Y2K compliance.
     60 C 1998-10-01  W. Collins  Correct date format in PEVENTS.
     61 C 1998-11-06  W. Collins  Add diagnosis of profiles in which the
     62 C     temperature sensor gets bad and remains so, resulting in large
     63 C     and persistent height and/or temperature residuals.  Error types
     64 C     41 and 42 are used.
     65 C 1998-12-03  W. Collins  Correct error which prevented RADEVN from
     66 C     being applied to all mandatory levels.  Also correct constant
     67 C     which solves for height adjustment due to "radiation" correction.
     68 C 1998-12-09  W. Collins  Change to make diagnosis of type 41-43 
     69 C     errors only for WMO blocks 42,43. Add WRT23 to Namelist. Default
     70 C     is .FALSE.  If .TRUE., then statistics file is updated for type
     71 C     41-43 tests. Skip POBERR if error in reading from statistics
     72 C     file.
     73 C 1999-02-01  R. Kistler  Make changes so that code may be run either on
     74 C     Crays or IBM SP.  Most changes involve specifying the second
     75 C     argument to UFBINT to be REAL(8).
     76 C 1999-02-10  W. Collins  Guarantee that ERR710 is called only when all
     77 C     the needed data are non-missing and not = 0.
     78 C 1999-04-27  W. Collins  New observation error diagnosis--
     79 C     uses combination of Bayesian logic, modeled error structure and
     80 C     fuzzy logic to make decisions. All residuals are normalized by
     81 C     sample statistics for each particular run.  A new output is added
     82 C     to help see why observation error diagnoses are made. Note that
     83 C     moisture (q) is quality controlled by this program for the first
     84 C     time.
     85 C 1999-11-16  W. Collins  Correct errors in treatment of moisture
     86 C     quality marks to honor previous marks.
     87 C 1999-12-09  W. Collins  Change VTPEVN so that Tv (virtual
     88 C     temperature) is calculated, even when the moisture quality is >
     89 C     3, except when the moisture exceeds 'Earth' limits.
     90 C 1999-12-14 W. Collins   Include writing the baseline residual in file
     91 C     NFSTN, so that station-by-station statistics can be calculated.
     92 C 2000-01-01 W. Collins   Set switches to use new 'radiation correction'
     93 C     tables (RADT4) as of this date.  These were generated from 1-yr
     94 C     statistics, and attempt to make sondes look like the average
     95 C     Vaisala RS-80 sonde.
     96 C 2000-03-09 W. Collins   Add fort.52--print of residuals and errors for
     97 C     use by SDMedit.
     98 C 2000-03-16 W. Collins   Modify change of 1999-12-14 as follows:  The
     99 C     original change calculated virtual temperature in all cases, but
    100 C     gave quality mark of 13. when the moisture flag was > 3.  This
    101 C     change allows good Tv flags for all temperatures at levels above
    102 C     700mb, regardless of the moisture quality mark.
    103 C 2000-06-13 W. Collins   Slight change to HSC so that HYDN fills HYDS
    104 C     when it is unreasonably large or missing.
    105 C 2000-09-08 W. Collins   New bias corrections for temperature (RADT5),
    106 C     based on all radiosonde data for 1999.  Temperatures are adjusted
    107 C     to mean Vaisala RS-80 (sonde type 61) increments.
    108 C 2001-02-28 W. Collins   Correct error of setting dew-point temperature
    109 C     to missing in FULVAL. Never flag T (Tv) bad as the result of
    110 C     flagging q bad. Make more efficient so that auxiliary level
    111 C     computations are ommitted when not needed.
    112 C 2001-03-02 W. Collins   Small, misc. code errors corrected in
    113 C     collaboration with Meta Sienkiewicz (NASA). May improve diagnosis
    114 C     for surface pressure errors.

Page 3           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    115 C 2001-03-15 W. Collins   Correction to T240 so that if type 106--
    116 C     surface pressure observation error--is allowed to be performed,
    117 C     the corrections form a consistent set and the new residuals near
    118 C     the surface all become small.  Slight changes to diagnosis of
    119 C     types.  Add collection of surface pressure increment and height
    120 C     increment at the surface to fort.16.
    121 C 2001-03-23 W. Collins   Problem in HOLES corrected and then call to
    122 C     HOLES (temporarily?) removed.
    123 C 2001-04-20 W. Collins   Correction to FUZZY to work properly when
    124 C     no guess is available. This allows possible diagnosis of
    125 C     observation errors, even with a missing guess, using other
    126 C     checks. It also prevents flagging all data.  Set surface
    127 C     pressure, even if guess is msg.
    128 C 2001-04-27 D. Keyser    Streamlined VTPEVN. Turned q event processing
    129 C     back on (even when DOVTMP=F). When q bad but passes sanity check,
    130 C     Tv now calculated in all cases but given a suspect q.m. if below
    131 C     700 mb and original TQM not 0 or > 3 (this was original intention
    132 C     of 1999-12-09 change which actually skipped Tv processing in all
    133 C     cases when q was bad)
    134 C 2001-05-11  W. Collins  Convert guess temperature from Tv to T,
    135 C     so that the residuals are comparing comparable quantities.
    136 C 2002-07-22  D. Keyser   If balloon drift coordinates (lat/lon/
    137 C     d-tim) are available, will use these to more precisely obtain
    138 C     estimated sun angle for intersonde bias corrections (RADCOR)
    139 C     (done in new subroutine SOELAN); more info re "RADCOR" now
    140 C     written to unit 68
    141 C 2004-03-17  D. Keyser   Corrected bug discovered by Christopher
    142 C     Redder (NASA/GSFC) where the order of ballon drift coord. (YDR,
    143 C     XDR) was reversed in the argument list for the call to
    144 C     subroutine GETOB (this results in incorrect sun angle calc.
    145 C     and corrections in the RADCOR step); updated subroutine RADT3
    146 C     docblock and added new radiosonde types since the last time it
    147 C     was updated (non of the new types receive corrections)
    148 C 2004-04-21  D. Keyser   For cases when DOVTMP=T, no longer calculates
    149 C     Tv on pressure levels above the tropopause because reported Tdd
    150 C     values at high levels are often inaccurate and unrealistic 0.4 to
    151 C     1.0 increases in Tv vs. T can occur (esp. above 10 mb and at
    152 C     U.S. sites) (q is still updated on these levels, however), if the
    153 C     reported tropopause level is below 500 mb it is not considered
    154 C     to be the tropopause for this test, also if no valid tropopause
    155 C     level is found by the time 80 mb is reached, all levels above
    156 C     this are considered to be above the tropopause for this test
    157 C     {thanks to Christopher Redder (NASA/GSFC) for discovering this
    158 C     problem}
    159 C 2005-08-03  D. Keyser   Revised RADCOR correction table in subr.
    160 C     RADT5 for China's Shanghai Radio sonde (BUFR type 32), after
    161 C     12/31/00 no corrections are made between 700 and 50 mb, inclusive
    162 C     because this sonde is being corrected on site (this will remove
    163 C     cold bias found in these sondes vs. guess below 50 mb) (Note 1:
    164 C     No corrections are made below 700 mb for any sondes, Note 2:
    165 C     Prior to 1/1/01, the previous correction table is still used for
    166 C     this sonde because, according to Yuetang Yhang of the Chinese
    167 C     NMC, this is when the on-site corrections started); added new
    168 C     radiosonde types in subr. RADT5 docblock since the last time it
    169 C     was updated
    170 C 2007-09-14  D. Keyser -- In subr. VTPEVN, Q.M. 3 is now assigned to
    171 C     calculated virt. temps only if the moisture Q.M. is truly bad

Page 4           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    172 C     (i.e. > 3 but not 9 or 15) (and, as before, orig. TQM is 1 or 2
    173 C     and POB is below 700 mb) - before, TQM set to 3 when QQM was 9 or
    174 C     15 and all other conditions met.  In RADCOR subroutines, minor
    175 C     code corrections suggested by Pat Pauley (corrects problems that
    176 C     could occur on some remote machines).  Corrected array overflow
    177 C     (and memory clobbering) issue when the number of RAOB IDs stored
    178 C     by radiosonde type in array SIDRAD (in RADCOR processing) is
    179 C     listed in subr. WTSTATS (which summarizes RADCOR stats).  If this
    180 C     limit is exceeded, only the limiting number of RAOBS will now be
    181 C     listed, along with a warning diagnostic - the limit has been
    182 C     increased from 400 to 800 since some reanalysis runs were
    183 C     exceeding the old limit.  Increased maximum number of radiosonde
    184 C     stations that can be processed from 899 to 999 (one reanlysis run
    185 C     hit this limit).  If this limit is exceeded, hard abort will now
    186 C     occur rather than zero r.c. with possible memory clobbering.
    187 C 2008-04-10  D. A. KEYSER -- Can handle radiosonde types > 99 which
    188 C     will soon be introduced into the BUFR database (based on November
    189 C     2007 WMO BUFR update)
    190 C 2008-10-08  D. A. KEYSER -- All RADCOR changes: Now processes
    191 C     radiosonde types > 111 and < 255 rather than setting them to
    192 C     missing (255), even though there are currently no valid types >
    193 C     111; modified to re-index array "SOLAR" (sun angle on mand. lvls)
    194 C     in oldest set of corrections (subr. RADT1) so that the correct
    195 C     values returned from subr. SOELAN are used for cases where
    196 C     balloon drift information is present (only applies to reanalysis
    197 C     since balloon drift was not available back when subr. RADT1 was
    198 C     called in real-time runs, subr. RADT1 is never called in current
    199 C     real-time runs anyway); modified to re-index array "SOLAR" in
    200 C     subr. SOELAN for cases involving the oldest set of corrections
    201 C     and where balloon drift information was not available so that
    202 C     proper values are returned to calling subr. RADT1 (only applies
    203 C     to reanalysis since subr. RADT1 is never called in current real-
    204 C     time runs); updated list of radiosonde types in newest correction
    205 C     subr. (RADT5) to conform with latest (Nov. 2007) WMO BUFR code
    206 C     table 0-02-011
    207 C 2008-10-08  D. A. KEYSER/J. WOOLLEN -- Subr. T240 modified to correct
    208 C     indexing error which can lead, on rare occasions, to out-of-
    209 C     bounds arrays and to the incorrect indexing of some variables;
    210 C     corrected if tests where integer values were tested for not being
    211 C     equal to real value for missing (BMISS = 10E10), these integer
    212 C     values can never be equal to BMISS for I*4 due to overflow -
    213 C     instead they are now tested for not being equal to new integer
    214 C     value for missing (IMISS, also = 10E10), although this is also an
    215 C     overflow value for I*4, it results in a correct evaluation
    216 C 2008-11-19  D. A. KEYSER -- All RADCOR changes: Updated newest
    217 C     correction subr. (RADT5) to recognize radiosonde types conforming
    218 C     with latest (Nov. 2008) WMO BUFR code table 0-02-011 and to
    219 C     produce more specific diagnostic print related to radiosonde
    220 C     types encountered (i.e., invalid, obsolete, vacant, etc.)
    221 C 2012-11-20  J. WOOLLEN  INITIAL PORT TO WCOSS 
    222 C 2013-02-05  D. Keyser   Final changes to run on WCOSS: Set BUFRLIB
    223 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
    224 C     overflow (also done for IMISS); rename all REAL(8) variables as
    225 C     *_8; use formatted print statements where previously unformatted
    226 C     print was > 80 characters.
    227 C 2016-05-18  D. Keyser   Corrected an integer overflow issue in subroutine
    228 C     INPUT2 which prevented the temporal check from running in the CDAS

Page 5           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    229 C     network (the only network where it currently would run).
    230 C
    231 C USAGE:
    232 C   INPUT FILES:
    233 C     UNIT 05  - STANDARD INPUT (DATA CARDS)
    234 C    (UNIT 12  - events file for mandatory levels)
    235 C     UNIT 14  - PREPBUFR file (BUFR), data input
    236 C    (UNIT 15  - block totals file)
    237 C    (UNIT 16  - collection of stations received)
    238 C    (UNIT 17  - t-24, used only for temporal check)
    239 C    (UNIT 18  - t-12, used only for temporal check)
    240 C    (UNIT 19  - t+12, used only for temporal check)
    241 C    (UNIT 20  - t+24, used only for temporal check)
    242 C     UNIT 23  - contains statistics for observation error checking
    243 C
    244 C   OUTPUT FILES:
    245 C     UNIT 06  - printout
    246 C    (UNIT 12  - events file for mandatory levels)
    247 C    (UNIT 15  - block totals file)
    248 C    (UNIT 16  - collection of stations received)
    249 C    (UNIT 22  - list of potential wind problems
    250 C     UNIT 23  - contains statistics for observation error checking
    251 C     UNIT 51  - output file of data (PREPBUFR) after correction
    252 C     UNIT 52  - output print file of values, residuals and events
    253 C    (UNIT 55  - ASCII file of all data necessary to run
    254 C                single station version of this code)
    255 C    (UNIT 60  - print file, details of decisions)
    256 C    (UNIT 61  - print file: list of all holes and their extent)
    257 C    (UNIT 68  - intersonde correction information file)
    258 C
    259 C   SUBPROGRAMS CALLED:
    260 C     UNIQUE:    - ACCUM    BEST     CHANGE  CHECKIT COMPER   DISTR
    261 C                  DMA      ERR123   ERR710  ISGOOD  LEVTYPS  OBERR
    262 C                  PEVENTS  PRNTOUT  PRSTNS  RBLOCKS RESIDS   ROUND
    263 C                  INCR     HOLES    HSC     ERRTYP  SIGERR   SEVENT
    264 C                  SHELL    SORT     ISORT   SIMPLE  STAT     STEVNTS
    265 C                  STNCNT   STYPE    T120    T121    T130     T140
    266 C                  EVPROC   ERR5     GETPS   CKPS    T220     T240
    267 C                  VOI      LAPSE    WBLOCKS ZDIF    INIT     SETTMP
    268 C                  XHORRES  AUXLEVS  WTSTATS WTISO   GETLEV   GETINC
    269 C                  INPUT    DHOR     FILL    GETOB   HORRES   MASEVN
    270 C                  MIMAP    OUTPUT   CHDIST  COORS   DRCTSL   INCRW
    271 C                  ISOLAT   QCOI     SEARCH  VSOLVE  RSTATS   EVENT
    272 C                  VTPEVN   PREP     RADEVN  RADT1   RADT2    RADT3
    273 C                  RADT4    RADT5    TAB     INPUT2  SOELAN   TMPCHK
    274 C                  FILALL   FULVAL   WINDATZ EVENTW  NOBERR   POBERR
    275 C                  FUZZY    AREA     CHKTMP  PATZ    LSTATS   PILNLNP
    276 C                  ALP      ANLWT    CUMPROB LMANLV  MANLEV   NMANLV
    277 C     LIBRARY:
    278 C       W3NCO    - W3FS13   W3FS21   W3TAGB  W3TAGE  ERREXIT  W3MOVDAT
    279 C       W3EMC    - W3FC05
    280 C       BUFRLIB  - CLOSBF   OPENBF   READMG   UFBQCD  CLOSMG  COPYMG
    281 C                  OPENMB   READSB   UFBCPY   UFBINT  UFBEVN  WRITSB
    282 C                  DATELEN  SETBMISS GETBMISS
    283 C
    284 C   EXIT STATES:
    285 C     COND =   0 - SUCCESSFUL RUN

Page 6           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    286 C     CODE >   0 - UNSUCCESSFUL RUN
    287 C
    288 C
    289 C REMARKS: NONE
    290 C     Note! The temporal check is not run operationally, but is 
    291 C     used for the Reanalysis and in the CDAS.
    292 C     For operational use, units 12, 15, and 16 will be empty on
    293 C     input, with information written to them for summary purposes.
    294 C
    295 C ATTRIBUTES:
    296 C   LANGUAGE: FORTRAN 90
    297 C   MACHINE:  NCEP WCOSS
    298 C
    299 C$$$
    300 
    301       PROGRAM PREPOBS_CQCBUFR
    302 
    303       REAL(8)          BMISS,GETBMISS
    304 
    305       CHARACTER*8      STN
    306       CHARACTER*10     EDATE
    307       LOGICAL          START, ENDIN, ANY, SKIP, WIND, SINGLE, OBS,
    308      &                 ANYS, SAME, PRNT
    309       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
    310      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
    311       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
    312       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
    313      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
    314       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
    315      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
    316      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
    317      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
    318      &                 BASR(2000),   PISR(2000),  PSINCR(2000),
    319      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
    320       COMMON /TESTS/   TEST
    321       COMMON /DOTYP40/ DOT40
    322       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
    323 
    324       LOGICAL          TEST, DOVTMP, USESQN, DOHOR, DOTMP, POUT,
    325      &                 DOT40, WRT23
    326       NAMELIST /NAMLST/ TEST, DOVTMP, USESQN, DOHOR, DOTMP, DOT40,
    327      &                  WRT23
    328 
    329       CALL W3TAGB('PREPOBS_CQCBUFR',2016,0139,0067,'NP22')
    330 
    331       TEST   = .TRUE.          ! Set .T. for tests to give more print
    332                         !!!  #### BE CAREFUL ##### in subr. POBERR,
    333                         !!!  TEST=T will actually encode additional
    334                         !!!  events in the output PREPBUFR file !!!
    335       DOVTMP = .TRUE.          ! Set .F. for RAP (and before that RUC)
    336       USESQN = .TRUE.          ! Set .F. for Reanalysis or old PREPBUFRs
    337       DOHOR  = .TRUE.          ! Set .F. for skipping horizontal check
    338       DOTMP  = .FALSE.         ! Set .T. for temporal check
    339       DOT40  = .TRUE.          ! Set .F. to exclude type40 check
    340       WRT23  = .FALSE.         ! Set .T. to update statistics file
    341 
    342       SINGLE = .FALSE.

Page 7           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    343       IF(.NOT.SINGLE) READ(5,NAMLST)
    344       WRITE(6,700) TEST, DOVTMP, USESQN, DOHOR, DOTMP, DOT40, WRT23
    345   700 FORMAT(/' WELCOME TO PREPOBS_CQCBUFR, LAST UPDATED 2016-05-18'/
    346      & '     SWITCHES: TEST =',L2,'  DOVTMP =',L2,'  USESQN =',L2,
    347      & '  DOHOR =',L2,'  DOTMP =',L2,'  DOT40 =',L2,'  WRT23 =',L2/)
    348 
    349 C  On WCOSS should always set BUFRLIB missing (BMISS) to 10E8 to avoid
    350 C   overflow when either an INTEGER*4 variable is set to BMISS or a
    351 C   REAL*8 (or REAL*4) variable that is missing is NINT'd
    352 C  -------------------------------------------------------------------
    353 ccccc CALL SETBMISS(10E10_8)
    354       CALL SETBMISS(10E8_8)
    355       BMISS=GETBMISS()
    356       XMISS=BMISS
    357       IMISS=10E8
    358       print *
    359       print *, 'BUFRLIB value for missing is: ',bmiss
    360       print *
    361 
    362       CALL ACCUM
    363       START  = .TRUE.          ! Input opens data file when START=.T.
    364       ENDIN  = .FALSE.         ! Initialize
    365       SKIP   = .FALSE.         ! Initialize
    366       SAME   = .FALSE.         ! Initialize
    367       WIND   = .FALSE.         ! Initialize
    368 
    369       IF(.NOT.DOHOR) THEN
    370         CALL INIT
    371         GOTO 300
    372       ENDIF
    373 
    374       IF(SINGLE) THEN
    375         CALL SETTMP
    376         GOTO 300
    377       ENDIF
    378 
    379 C  TOP OF LOOP TO READ DATA FOR HORIZONTAL CHECK
    380 C  ---------------------------------------------
    381 
    382   100 CONTINUE
    383       ITIME = 1
    384       WRITE(60,520) START,ENDIN,SKIP,SAME,WIND,ITIME,USESQN
    385   520 FORMAT(' MAIN--START,ENDIN,SKIP,SAME,WIND,ITIME,USESQN: ',
    386      &  5(L2,2X),I5,2X,L2)
    387       CALL INPUT(START,ENDIN,SKIP,SAME,WIND,ITIME,USESQN)
    388                                  ! Read data for 1 station
    389       IF(ENDIN) GOTO 200
    390       IF(SKIP .OR. WIND) GOTO 100
    391       CALL RESIDS(ITIME)         ! Calculate all but horizontal resids
    392       CALL ISGOOD                ! Preliminary quality assessment
    393       GOTO 100
    394 
    395   200 CONTINUE
    396 
    397       IF(DOTMP) THEN
    398         CALL INPUT2              ! Read data for temporal check
    399         CALL TMPCHK              ! Perform temporal check

Page 8           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    400       ELSE
    401         CALL SETTMP
    402       ENDIF
    403       CALL HORRES                ! Calculate horizontal residuals
    404       CALL STAT(ITIME)           ! Calculate & print statistics
    405       CALL XHORRES               ! Calc normalized horizontal residuals
    406 
    407       START = .TRUE.
    408 
    409 C  TOP OF LOOP FOR ALL OTHER CHECKS AND DMA
    410 C  ----------------------------------------
    411 
    412   300 CONTINUE
    413       ITIME = 2
    414       ISC = 0
    415       LAST = 0
    416       ANY = .TRUE.
    417       ANYS = .FALSE.
    418       IF(.NOT.SINGLE) THEN
    419         CALL INPUT(START,ENDIN,SKIP,SAME,WIND,ITIME,USESQN)
    420                                  ! Read data a 2nd time, 1 rpt at a time
    421       ELSE
    422         CALL RBLOCKS(SKIP,WIND,ENDIN)
    423       ENDIF
    424       IF(ENDIN) GOTO 600
    425       IF(SKIP) GOTO 500
    426       IF(WIND) THEN
    427         CALL INCRW
    428         CALL PRSTNS(WIND)
    429         GOTO 500
    430       ENDIF
    431       CALL CKPS
    432       CALL RESIDS(ITIME)
    433       CALL PRSTNS(WIND)
    434       ICALL = 3
    435       CALL PRNTOUT(SEQQ,ICALL)
    436 
    437 C  LOOP THROUGH LEVELS UNTIL TOP IS REACHED
    438 C  ----------------------------------------
    439 
    440   400 CONTINUE
    441       ISC = ISC + 1
    442       CALL DMA(ANY,OBS)          ! Decision Making Algorithm
    443       CALL CHANGE(ANY,SINGLE,SEQQ) ! Apply corrs to the data
    444       IF(ANY) ANYS = .TRUE.
    445       CALL RESIDS(ITIME)
    446       IF(ANY) CALL DHOR          ! Calculate changes to hor resids
    447       IF((ANY .OR. .NOT.OBS .OR. LAST.LT.NLEV) .AND. ISC.LT.30) GOTO 400
    448       CALL STEVNTS               ! Print BUFR events for single stn
    449       ICALL = 1
    450       IF(ANYS .AND. OBS) CALL PRNTOUT(SEQQ,ICALL)
    451       CALL MASEVN                ! Write CQC mass events
    452   500 CONTINUE
    453       CALL AUXLEVS(SKIP,SAME,WIND,SINGLE,ANYS)
    454       IF(.NOT.WIND) THEN
    455         CALL RADEVN              ! Write radiation correction events
    456         CALL VTPEVN(DOVTMP)      ! Write virtual temperature events

Page 9           Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    457       ENDIF
    458       CALL OUTPUT(ENDIN,SINGLE)
    459       GOTO 300                   ! Go back for the next report
    460 
    461 C  END OF DATA REACHED
    462 C  -------------------
    463 
    464   600 CONTINUE
    465       CALL STAT(ITIME)
    466       CALL PEVENTS               ! Print events
    467       IF(.NOT.SINGLE) CALL STNCNT  ! Print counts by WMO block
    468       I2 = IEVENT
    469       ICALL = 2
    470       CALL EVPROC(1,I2,ICALL)    ! Generate, print BUFR events
    471       CALL WTSTATS               ! Write statistics for RADCOR
    472       CALL WTISO
    473       CALL CLOSBF(NFIN)
    474       CALL CLOSBF(NFOUT)
    475 
    476       CALL W3TAGE('PREPOBS_CQCBUFR')
    477 
    478       STOP
    479       END


ENTRY POINTS

  Name              
                    
 MAIN__             

Page 10          Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  382                                                            390,393                           
 200                        Label  395                                                            389                               
 300                        Label  412                                                            371,376,459                       
 400                        Label  440                                                            447                               
 500                        Label  452                                                            425,429                           
 520                        Label  385                                                            384                               
 600                        Label  464                                                            424                               
 700                        Label  345                                                            344                               
 ACCUM                      Subr   362                                                            362                               
 ANY                        Local  307      L(4)            4           scalar                    416,442,443,444,446,447           
 ANYS                       Local  308      L(4)            4           scalar                    417,444,450,453                   
 AUXLEVS                    Subr   453                                                            453                               
 BASR                       Scalar 318      R(4)            4     1     2000     COM                                                
 BMISS                      Scalar 303      R(8)            8           scalar   COM              355,356,359                       
 BUFRLIB_MISSING            Common 322                                  16                                                          
 CHANGE                     Subr   443                                                            443                               
 CKPS                       Subr   431                                                            431                               
 CLOSBF                     Subr   473                                                            473,474                           
 COR                        Scalar 316      R(4)            4     1     2000     COM                                                
 CORVAL                     Scalar 316      R(4)            4     1     2000     COM                                                
 CQCPC                      Scalar 310      R(4)            4           scalar   COM                                                
 DHOR                       Subr   446                                                            446                               
 DMA                        Subr   442                                                            442                               
 DOHOR                      Local  324      L(4)            4           scalar                    326,337,344,369                   
 DOT40                      Scalar 321      L(4)            4           scalar   COM              326,339,344                       
 DOTMP                      Local  324      L(4)            4           scalar                    326,338,344,397                   
 DOTYP40                    Common 321                                  4                                                           
 DOVTMP                     Local  324      L(4)            4           scalar                    326,335,344,456                   
 EDATE                      Scalar 306      CHAR            10    1     2000     COM                                                
 ENDIN                      Local  307      L(4)            4           scalar                    364,384,387,389,419,422,424,458   
 EVENTS                     Common 314                                  156004                                                      
 EVPROC                     Subr   470                                                            470                               
 FILES                      Common 311                                  24                                                          
 GETBMISS                   Func   303      R(8)            8           scalar                    355                               
 H1                         Scalar 312      R(4)            4           scalar   COM                                                
 H2                         Scalar 312      R(4)            4           scalar   COM                                                
 HORRES                     Subr   403                                                            403                               
 HYDSTUF                    Common 312                                  64                                                          
 I2                         Local  468      I(4)            4           scalar                    468,470                           
 ICALL                      Local  434      I(4)            4           scalar                    434,435,449,450,469,470           
 IETYP                      Scalar 319      I(4)            4     1     2000     COM                                                
 IEVENT                     Scalar 317      I(4)            4           scalar   COM              468                               
 IMISS                      Scalar 322      I(4)            4           scalar   COM              357                               
 INCRW                      Subr   427                                                            427                               
 INIT                       Subr   370                                                            370                               
 INPUT                      Subr   387                                                            387,419                           
 INPUT2                     Subr   398                                                            398                               
 IPEVT                      Scalar 310      I(4)            4           scalar   COM                                                
 ISC                        Scalar 310      I(4)            4           scalar   COM              414,441,447                       
 ISCAN                      Scalar 314      I(4)            4     1     2000     COM                                                
 ISGOOD                     Subr   392                                                            392                               

Page 11          Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ITIME                      Local  383      I(4)            4           scalar                    383,384,387,391,404,413,419,432,44
                                                                                                  5,465                             
 IVAR                       Scalar 316      I(4)            4     1     2000     COM                                                
 LAST                       Scalar 313      I(4)            4           scalar   COM              415,447                           
 LEVL                       Scalar 315      I(4)            4     1     2000     COM                                                
 LMAND                      Scalar 310      I(4)            4     1     22       COM                                                
 LSFC                       Scalar 310      I(4)            4           scalar   COM                                                
 LSTYP                      Scalar 317      I(4)            4     1     2000     COM                                                
 LTYP                       Scalar 315      I(4)            4     1     2000     COM                                                
 MAND                       Scalar 309      I(4)            4           scalar   COM                                                
 MASEVN                     Subr   451                                                            451                               
 NAMLST                     Local  326                                  scalar                    343                               
 NFEVN                      Scalar 311      I(4)            4           scalar   COM                                                
 NFIN                       Scalar 311      I(4)            4           scalar   COM              473                               
 NFOUT                      Scalar 311      I(4)            4           scalar   COM              474                               
 NFSGL                      Scalar 311      I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 311      I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 311      I(4)            4           scalar   COM                                                
 NLEV                       Scalar 309      I(4)            4           scalar   COM              447                               
 NOBS                       Scalar 309      I(4)            4           scalar   COM                                                
 OBS                        Local  307      L(4)            4           scalar                    442,447,450                       
 OUTPUT                     Subr   458                                                            458                               
 PARAMS                     Common 309                                  148                                                         
 PCOR                       Scalar 317      R(4)            4     1     2000     COM                                                
 PEVENTS                    Subr   466                                                            466                               
 PISR                       Scalar 318      R(4)            4     1     2000     COM                                                
 POUT                       Scalar 313      L(4)            4           scalar   COM                                                
 PREPOBS_CQCBUFR            Prog   301                                                                                              
 PRES                       Scalar 315      R(4)            4     1     2000     COM                                                
 PRNT                       Scalar 308      L(4)            4           scalar   COM                                                
 PRNTOUT                    Subr   435                                                            435,450                           
 PRSTNS                     Subr   428                                                            428,433                           
 PSCOR                      Scalar 313      R(4)            4           scalar   COM                                                
 PSINCR                     Scalar 318      R(4)            4     1     2000     COM                                                
 QMARK                      Scalar 319      R(4)            4     1     2000     COM                                                
 RADEVN                     Subr   455                                                            455                               
 RADPC                      Scalar 309      R(4)            4           scalar   COM                                                
 RBLOCKS                    Subr   422                                                            422                               
 RESIDS                     Subr   391                                                            391,432,445                       
 SAME                       Local  308      L(4)            4           scalar                    366,384,387,419,453               
 SEQN                       Scalar 314      R(4)            4     1     2000     COM                                                
 SEQQ                       Local  435      R(4)            4           scalar                    435,443,450                       
 SETBMISS                   Subr   354                                                            354                               
 SETTMP                     Subr   375                                                            375,401                           
 SINGLE                     Local  307      L(4)            4           scalar                    342,343,374,418,443,453,458,467   
 SKIP                       Local  307      L(4)            4           scalar                    365,384,387,390,419,422,425,453   
 START                      Local  307      L(4)            4           scalar                    363,384,387,407,419               
 STAT                       Subr   404                                                            404,465                           
 STEVNTS                    Subr   448                                                            448                               
 STN                        Scalar 305      CHAR            8     1     2000     COM                                                
 STNCNT                     Subr   467                                                            467                               
 T1                         Scalar 312      R(4)            4           scalar   COM                                                
 TCBEST                     Scalar 312      R(4)            4     1     2        COM                                                
 TCOR                       Scalar 312      R(4)            4     1     2        COM                                                
 TEST                       Scalar 320      L(4)            4           scalar   COM              326,331,344                       

Page 12          Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TESTS                      Common 320                                  4                                                           
 TMPCHK                     Subr   399                                                            399                               
 TSCOR                      Scalar 313      R(4)            4           scalar   COM                                                
 TT                         Scalar 310      R(4)            4           scalar   COM                                                
 USESQN                     Local  324      L(4)            4           scalar                    326,336,344,384,387,419           
 VTPEVN                     Subr   456                                                            456                               
 VTPPC                      Scalar 309      R(4)            4           scalar   COM                                                
 W3TAGB                     Subr   329                                                            329                               
 W3TAGE                     Subr   476                                                            476                               
 WIND                       Local  307      L(4)            4           scalar                    367,384,387,390,419,422,426,428,43
                                                                                                  3,453,454                         
 WRT23                      Local  325      L(4)            4           scalar                    327,340,344                       
 WTISO                      Subr   472                                                            472                               
 WTSTATS                    Subr   471                                                            471                               
 XHORRES                    Subr   405                                                            405                               
 XMA                        Scalar 309      R(4)            4           scalar   COM                                                
 XMI                        Scalar 309      R(4)            4           scalar   COM                                                
 XMISS                      Scalar 322      R(4)            4           scalar   COM              356                               
 YMA                        Scalar 309      R(4)            4           scalar   COM                                                
 YMI                        Scalar 309      R(4)            4           scalar   COM                                                
 ZCBEST                     Scalar 312      R(4)            4     1     2        COM                                                
 ZCOR                       Scalar 312      R(4)            4     1     2        COM                                                
 ZSCOR                      Scalar 313      R(4)            4           scalar   COM                                                

Page 13          Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    480 C**********************************************************************
    481 
    482       BLOCK DATA
    483 
    484       COMMON /LEV926/ ISET,MANLIN(1001)
    485 
    486       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
    487       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
    488      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
    489       COMMON /CONSTS/  R, G, T0, CP, RV
    490       COMMON /LEVEL/   PMAND(21)
    491       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
    492      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
    493      &                 ZCLIM, TCLIM, NHLIM
    494       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
    495       LOGICAL PRNT
    496       DATA XMI /0./, XMA /360./, YMI /-90./, YMA /90./
    497       DATA MAND /21/, NFIN /14/, NFOUT /51/
    498       DATA NFEVN /12/, NFSUM /15/, NFSTN /16/, NFSGL /55/
    499       DATA NALLZ /41/, NALLT /51/
    500       DATA R /287.05/, G /9.80665/, T0 /273.15/
    501       DATA CP /1004.5/, RV /461.5/
    502       DATA ZCLIM /40./, TCLIM /5.0/, TT /7.0/, NHLIM /7/
    503       DATA ALLZ /0.,-1.,1.,-2.,2.,-3.,3.,-4.,4.,-5.,5.,
    504      &    -6.,6.,-7.,7.,-8.,8.,-9.,9.,-10.,10.,-11.,
    505      &    11.,-12.,12.,-13.,13.,-14.,14.,-15.,15.,-16.,
    506      &    16.,-17.,17.,-18.,18.,-19.,19.,-20.,20./
    507       DATA ALLT /0.,-1.,1.,-2.,2.,-3.,3.,-4.,4.,-5.,5.,
    508      &    -6.,6.,-7.,7.,-8.,8.,-9.,9.,-10.,10.,-11.,
    509      &    11.,-12.,12.,-13.,13.,-14.,14.,-15.,15.,
    510      &    -16.,16.,-17.,17.,-18.,18.,-19.,19.,-20.,
    511      &    20.,-21.,21.,-22.,22.,-23.,23.,-24.,24.,
    512      &    -25.,25.,-26.,26.,-27.,27.,-28.,28.,-29.,29.,
    513      &    -30.,30.,-31.,31.,-32.,32.,-33.,33.,-34.,34.,
    514      &    -35.,35./
    515 
    516 C  ALL LIMITS REPRESENT 10. STANDARD DEVIATIONS.
    517 C  --------------------------------------------
    518 
    519 	  DATA ISET /0/
    520       DATA HSCRES /33.,38.,31.,65.,49.,62.,51.,74.,88.,113.,
    521      &  120.,101.,143.,120.,143.,6*143./
    522       DATA XINC /186.,144.,129.,129.,161.,194.,241.,
    523      &  271.,310.,390.,433.,447.,456.,504.,571.,627.,
    524      &  686.,743.,800.,857.,914.,
    525      &  27.,24.,19.,16.,16.,17.,19.,21.,24.,24.,24.,24.,
    526      &  24.,24.,24.,24.,24.,24.,24.,24.,24.,
    527      &  135.,120.,95.,80.,80.,85.,95.,105.,120.,120.,120.,120.,
    528      &  120.,120.,120.,120.,120.,120.,120.,120.,120.,
    529      &  .016,.017,.014,.011,.0043,.0025,.0016,.0008,.0005,.0002,
    530      &  11*.0002/
    531       DATA HOIRES /149.,100.,104.,110.,149.,176.,219.,240.,261.,
    532      &  314.,353.,377.,399.,456.,541.,579.,
    533      &  614.,650.,686.,721.,757.,
    534      &  24.,21.,19.,14.,16.,17.,17.,17.,17.,20.,21.,24.,24.,
    535      &  24.,24.,24.,24.,24.,24.,24.,24.,
    536      &  120.,105.,95.,70.,80.,85.,85.,85.,85.,100.,105.,120.,120.,

Page 14          Source Listing                  PREPOBS_CQCBUFR
2017-04-18 11:07                                 cqcbufr.f

    537      &  120.,120.,120.,120.,120.,120.,120.,120.,
    538      &  .014,.013,.014,.010,.0043,.0026,.0015,.0007,.0005,.0002,
    539      &  11*.0002/
    540       DATA VOIRES /96.,50.,50.,52.,73.,74.,84.,89.,104.,167.,
    541      &  193.,190.,196.,249.,356.,493.,571.,643.,714.,786.,857.,
    542      &  10.,11.,11., 8., 8., 9.,10.,11.,15.,14.,16.,13.,
    543      &  13.,16.,24.,24.,24.,24.,24.,24.,24.,
    544      &  50.,55.,55.,40.,40.,45.,50.,55.,75.,70.,80.,65.,
    545      &  65.,80.,120.,120.,120.,120.,120.,120.,120.,
    546      &  .009,.008,.008,.006,.0029,.0016,.0010,.0006,.0006,.0006,
    547      &  .0004,.0003,9*.0002/
    548 C     DATA TMPSTD /86.,86.,93.,107.,143.,157.,171.,179.,186.,
    549 C    &  200.,221.,243.,271.,307.,343.,343.,343.,343.,343.,
    550 C    &  343.,343.,
    551 C    &  12.9,11.6,9.9,9.4,10.3,10.7,11.1,11.6,12.0,12.4,12.9,
    552 C    &  13.3,13.7,14.0,14.6,14.6,14.6,14.6,14.6,14.6,14.6,
    553 C    &  21*0.,
    554 C    &  21*0./
    555 C  FOLLOWING TMPSTD ARE IDEALIZED FROM 3 CASES IN JAN 1998
    556 C  THEY SHOULD PROBABLY BE REDONE AFTER MORE CASES ARE AVAILABLE
    557 C  -------------------------------------------------------------
    558       DATA TMPSTD /260.,250.,230.,255.,320.,400.,455.,460.,430.,420.,
    559      &  430.,460.,480.,510.,520.,520.,520.,520.,520.,520.,520.,
    560      &  30.,28.,27.,24.,22.,21.,22.,24,24.,22,20.,20.,20.,
    561      &  20.,21.,21.,21.,21.,21.,21.,21.,
    562      &  21*0.,
    563      &  21*0./
    564       DATA TFACT /2.0,2.0,2.0,1.8,1.6,1.6,1.6,1.6,
    565      &  1.5,1.3,1.0,0.9,0.8,0.8,0.8,0.8,
    566      &  0.8,0.8,0.8,0.8,0.8,
    567      &  1.0,1.0,1.4,1.5,1.5,1.5,1.4,1.3,1.3,
    568      &  1.2,1.2,1.1,1.0,0.9,0.9,0.9,
    569      &  0.9,0.9,0.9,0.9,0.9,
    570      &  21*0.,
    571      &  21*0./
    572       DATA PMAND /1000.,925.,850.,700.,500.,400.,300.,250.,200.,
    573      &  150.,100.,70.,50.,30.,20.,10.,7.,5.,3.,2.,1./
    574 
    575       END

Page 15          Source Listing                  _unnamed_data$_
2017-04-18 11:07                                 cqcbufr.f

    576       
    577 C**********************************************************************
    578 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    579 C                .      .    .                                       .
    580 C SUBPROGRAM:    ACCUM       Get files ready to accumulate information
    581 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
    582 C
    583 C ABSTRACT: The 3 files are used to summarize the performance of the
    584 C   code and the quality of the data over a period of time (typically
    585 C   a month).  This subroutine positions the file for adding
    586 C   information to them.  Operationally, the files will generally be
    587 C   empty and later filled by the PREPOBS_CQCBUFR. In that case, the 3
    588 C   files must be accessible when the job completes so that they can
    589 C   be copied to a more permanent place and cat'ed with the information
    590 C   from other times.
    591 C
    592 C PROGRAM HISTORY LOG:
    593 C 1997-03-18  W. Collins  Original author.
    594 C
    595 C USAGE:    CALL ACCUM
    596 C
    597 C   INPUT FILES:
    598 C     NFEVN    - ACCUMULATES EVENTS
    599 C     NFSUM    - ACCUMULATES SUMMARY INFORMATION FOR EVENTS
    600 C     NFSTN    - ACCUMULATES STATION RECEIPT INFORMATION
    601 C
    602 C   OUTPUT FILES:
    603 C     NFEVN    - UNIT NUMBER OF FILE WHICH ACCUMULATES EVENTS
    604 C     NFSUM    - UNIT NUMBER OF FILE WHICH ACCUMULATES SUMMARY
    605 C                INFORMATION FOR EVENTS
    606 C     NFSTN    - UNIT NUMBER OF FILE WHICH ACCUMULATES STATION RECEIPT
    607 C                INFORMATION
    608 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
    609 C
    610 C
    611 C REMARKS: NONE
    612 C
    613 C ATTRIBUTES:
    614 C   LANGUAGE: FORTRAN 90
    615 C   MACHINE:  NCEP WCOSS
    616 C
    617 C$$$
    618 
    619       SUBROUTINE ACCUM
    620 
    621       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
    622       COMMON /TESTS/   TEST
    623       LOGICAL          TEST
    624       CHARACTER*180    LINE
    625 
    626       IF(TEST) WRITE(60,500) NFIN,NFOUT,NFEVN,NFSUM,NFSTN
    627   500 FORMAT(' ACCUM--NFIN,NFOUT,NFEVN,NFSUM,NFSTN: ',5I5)
    628 
    629 C
    630 C     READ TO END OF DATA ON UNIT NFEVN, THEN
    631 C     BACKSPACE OVER EOF AND LAST RECORD.
    632 C     THIS UNIT IS USED TO ACCUMULATE THE EVENTS FILE.

Page 16          Source Listing                  ACCUM
2017-04-18 11:07                                 cqcbufr.f

    633 C
    634   600 CONTINUE
    635       READ(NFEVN,650,END=690,err=690) LINE
    636   650 FORMAT(A139)
    637       GO TO 600
    638   690 CONTINUE
    639       BACKSPACE NFEVN
    640 
    641 C
    642 C     READ TO END OF DATA ON UNIT NFSUM, THEN
    643 C     BACKSPACE OVER EOF AND LAST RECORD.
    644 C     THIS UNIT IS USED TO ACCUMULATE THE EVENTS FILE.
    645 C
    646   700 CONTINUE
    647       READ(NFSUM,750,END=790,err=790) LINE
    648   750 FORMAT(A132)
    649       GO TO 700
    650   790 CONTINUE
    651       BACKSPACE NFSUM
    652 C
    653 C     READ TO END OF DATA ON UNIT NFSTN, THEN
    654 C     BACKSPACE OVER EOF AND LAST RECORD.
    655 C     THIS UNIT IS USED TO ACCUMULATE THE STATION LIST.
    656 C
    657   800 CONTINUE
    658       READ(NFSTN,850,END=890,err=890) LINE
    659   850 FORMAT(A180)
    660       GO TO 800
    661   890 CONTINUE
    662       BACKSPACE NFSTN
    663 
    664       RETURN
    665       END

Page 17          Source Listing                  ACCUM
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 accum_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  627                                                            626                               
 600                        Label  634                                                            637                               
 650                        Label  636                                                            635                               
 690                        Label  638                                                            635                               
 700                        Label  646                                                            649                               
 750                        Label  648                                                            647                               
 790                        Label  650                                                            647                               
 800                        Label  657                                                            660                               
 850                        Label  659                                                            658                               
 890                        Label  661                                                            658                               
 ACCUM                      Subr   619                                                                                              
 FILES                      Common 621                                  24                                                          
 LINE                       Local  624      CHAR            180         scalar                    635,647,658                       
 NFEVN                      Scalar 621      I(4)            4           scalar   COM              626,635,639                       
 NFIN                       Scalar 621      I(4)            4           scalar   COM              626                               
 NFOUT                      Scalar 621      I(4)            4           scalar   COM              626                               
 NFSGL                      Scalar 621      I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 621      I(4)            4           scalar   COM              626,658,662                       
 NFSUM                      Scalar 621      I(4)            4           scalar   COM              626,647,651                       
 TEST                       Scalar 622      L(4)            4           scalar   COM              626                               
 TESTS                      Common 622                                  4                                                           

Page 18          Source Listing                  ACCUM
2017-04-18 11:07                                 cqcbufr.f

    666 
    667 C******************************************************************
    668 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    669 C                .      .    .                                       .
    670 C SUBPROGRAM:    ALP         RETURN THE LOGARITHM OF PRESSURE
    671 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
    672 C
    673 C ABSTRACT: Return the logarithm of pressure for input argument
    674 C   between 1.0 and 1400.0.  The values are calculated once and
    675 C   subsequently returned for a list.
    676 C
    677 C PROGRAM HISTORY LOG:
    678 C 1997-03-18  W. Collins  Original author.
    679 C
    680 C USAGE:    X=ALP(P)
    681 C   INPUT ARGUMENT LIST:
    682 C     P        - PRESSURE BETWEEN 1.0 AND 1400.0 hPa
    683 C
    684 C   OUTPUT ARGUMENT LIST:
    685 C     ALP      - RETURNS THE VALUE
    686 C
    687 C
    688 C REMARKS: NONE
    689 C
    690 C ATTRIBUTES:
    691 C   LANGUAGE: FORTRAN 90
    692 C   MACHINE:  NCEP WCOSS
    693 C
    694 C$$$
    695 
    696       FUNCTION ALP(P)
    697 
    698       REAL(8) BMISS
    699 
    700       SAVE ISET
    701 
    702 C  ALP RETURNS THE NATURAL LOGARITHM OF PRESSURE, FOR
    703 C  PRESSURE BETWEEN 1 AND 1400 HPA.  INPUT IS IN HPA.
    704 C  --------------------------------------------------
    705 
    706       COMMON /LOGS/    PRLOG(14000)
    707       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
    708 
    709       DATA ISET /0/
    710 
    711       IF(ISET.EQ.0) THEN
    712         DO I=1,14000
    713           PRLOG(I) = ALOG(REAL(I)/10.)
    714         ENDDO
    715         ISET = 1
    716       ENDIF
    717 
    718       IP = NINT(P*10.)
    719       IF(IP.LE.14000 .AND. IP.GE.1) THEN
    720         ALP = PRLOG(IP)
    721       ELSE
    722         IF(P.GT.0.) THEN

Page 19          Source Listing                  ALP
2017-04-18 11:07                                 cqcbufr.f

    723           ALP = ALOG(P)
    724         ELSE
    725           ALP = BMISS
    726         ENDIF
    727       ENDIF
    728 
    729       RETURN
    730       END


ENTRY POINTS

  Name            
                  
 alp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALOG                       Func   713                                  scalar                    713,723                           
 ALP                        Func   696      R(4)            4           scalar                    720,723,725                       
 ALP@0                      Local  696      R(4)            4           scalar                                                      
 BMISS                      Scalar 698      R(8)            8           scalar   COM              725                               
 BUFRLIB_MISSING            Common 707                                  16                                                          
 I                          Local  712      I(4)            4           scalar                    712,713                           
 IMISS                      Scalar 707      I(4)            4           scalar   COM                                                
 IP                         Local  718      I(4)            4           scalar                    718,719,720                       
 ISET                       Local  700      I(4)            4           scalar   SAVE             709,711,715                       
 LOGS                       Common 706                                  56000                                                       
 NINT                       Func   718                                  scalar                    718                               
 P                          Dummy  696      R(4)            4           scalar   ARG,INOUT        718,722,723                       
 PRLOG                      Scalar 706      R(4)            4     1     14000    COM              713,720                           
 REAL                       Func   713                                  scalar                    713                               
 XMISS                      Scalar 707      R(4)            4           scalar   COM                                                

Page 20          Source Listing                  ALP
2017-04-18 11:07                                 cqcbufr.f

    731 
    732 C********************************************************************
    733 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    734 C                .      .    .                                       .
    735 C SUBPROGRAM:    ANLWT       Get analysis weight for an observation
    736 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
    737 C
    738 C ABSTRACT: FOR A GIVEN X>0., RETURN THE ANALYSIS WEIGHT FOR AN
    739 C   OBSERVATION WITH A GIVEN NORMALIZED RESIDUAL OF X.  IN ORDER TO
    740 C   GET X, THE MEAN IS SUBTRACTED AND THEN DIVIDED BY THE STANDARD
    741 C   DEVIATION.  LINEAR INTERPOLATION IS USED FROM THE FOLLOWING TABLE.
    742 C   IT IS ASSUMED (FROM PAST DATA) THAT PER IS THE PROPORTION OF THE
    743 C   DATA THAT ARE IN ERROR.  ALL ROUGH ERRORS ARE ASSUMED TO BE
    744 C   CONTAINED WITHIN B STANDARD DEVIATIONS.
    745 C
    746 C PROGRAM HISTORY LOG:
    747 C 1999-04-13  W. Collins  Original author.
    748 C
    749 C USAGE:    X=ANLWT(X,B,PER)
    750 C
    751 C   INPUT ARGUMENT LIST:
    752 C     X        - NORMALIZED RESIDUAL
    753 C     B        - ROUGH ERRORS ASSUMED WITHIN B STANDARD DEVIATIONS
    754 C     PER      - PERCENT OF OBSERVATIONS ASSUMED TO BE IN ERROR
    755 C
    756 C   OUTPUT ARGUMENT LIST:
    757 C     ANLWT    - THE 'WEIGHT' ASSIGNED TO OBSERVATION
    758 C
    759 C
    760 C REMARKS: NONE
    761 C
    762 C ATTRIBUTES:
    763 C   LANGUAGE: FORTRAN 90
    764 C   MACHINE:  NCEP WCOSS
    765 C
    766 C$$$
    767 
    768       FUNCTION ANLWT(X,B,PER)
    769 
    770       REAL W(0:50)
    771       DATA W/.3989,.3970,.3910,.3814,.3683,.3521,.3332,.3123,
    772      &       .2897,.2661,.2420,.2179,.1942,.1714,.1497,.1295,
    773      &       .1109,.0940,.0790,.0656,.0540,.0440,.0355,.0283,
    774      &       .0224,.0175,.0136,.0104,.0079,.0060,.0044,.0033,
    775      &       .0024,.0017,.0012,.0009,.0006,.0004,.0003,.0002,
    776      &       .0001,.00009,.00006,.00004,.00002,.00002,.00001,
    777      &       .00001,.00000,.00000,.00000/
    778 
    779       IF(X.GE.5.) THEN
    780         WINT = 0.
    781       ELSE
    782         Y  = X*10.
    783         IY = Y
    784         F  = Y-IY
    785         WINT = (1.-F)* W(IY) + F*W(IY+1)
    786       ENDIF
    787 

Page 21          Source Listing                  ANLWT
2017-04-18 11:07                                 cqcbufr.f

    788       PNOT = 1.-PER
    789       CPRIME = 0.5/B
    790       DENOM = PNOT*WINT + PER*CPRIME
    791       IF(DENOM.NE.0.) THEN
    792         ANLWT = PNOT*WINT/DENOM
    793       ELSE
    794         ANLWT = 1.
    795       ENDIF
    796 
    797 C     A = .5*PER/B
    798 C     P = (1.-A)*WINT + A*(B+X)
    799 C     S = (1.-A)*WINT
    800 C
    801 C     IF(P.NE.0.) THEN
    802 C       ANLWT = S/P
    803 C     ELSE
    804 C       ANLWT = 1.
    805 C     ENDIF
    806 
    807       RETURN
    808       END


ENTRY POINTS

  Name              
                    
 anlwt_             

Page 22          Source Listing                  ANLWT
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANLWT                      Func   768      R(4)            4           scalar                    792,794                           
 ANLWT@0                    Local  768      R(4)            4           scalar                                                      
 B                          Dummy  768      R(4)            4           scalar   ARG,INOUT        789                               
 CPRIME                     Local  789      R(4)            4           scalar                    789,790                           
 DENOM                      Local  790      R(4)            4           scalar                    790,791,792                       
 F                          Local  784      R(4)            4           scalar                    784,785                           
 IY                         Local  783      I(4)            4           scalar                    783,784,785                       
 PER                        Dummy  768      R(4)            4           scalar   ARG,INOUT        788,790                           
 PNOT                       Local  788      R(4)            4           scalar                    788,790,792                       
 W                          Local  770      R(4)            4     1     51                        771,785                           
 WINT                       Local  780      R(4)            4           scalar                    780,785,790,792                   
 X                          Dummy  768      R(4)            4           scalar   ARG,INOUT        779,782                           
 Y                          Local  782      R(4)            4           scalar                    782,783,784                       

Page 23          Source Listing                  ANLWT
2017-04-18 11:07                                 cqcbufr.f

    809 
    810 C********************************************************************
    811 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    812 C                .      .    .                                       .
    813 C SUBPROGRAM:    AREA        Determine region from X,Y.
    814 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
    815 C
    816 C ABSTRACT: From the longitude and latitude, determine the global
    817 C   region in which an observation lies.
    818 C
    819 C PROGRAM HISTORY LOG:
    820 C 1999-04-13  W. Collins  Original author.
    821 C
    822 C USAGE:    CALL AREA(IA,X,Y)
    823 C
    824 C   INPUT ARGUMENT LIST:
    825 C     X        - LONGITUDE
    826 C     Y        - LATITUDE
    827 C
    828 C   OUTPUT ARGUMENT LIST:
    829 C     IA       - REGION (AREA) OF OBSERVATION
    830 C
    831 C   OUTPUT FILES:
    832 C     UNIT 06  - PRINTOUT
    833 C
    834 C REMARKS: NONE
    835 C
    836 C ATTRIBUTES:
    837 C   LANGUAGE: FORTRAN 90
    838 C   MACHINE:  NCEP WCOSS
    839 C
    840 C$$$
    841 
    842       SUBROUTINE AREA(IA,X,Y)
    843       DIMENSION XN(28),XX(28),YN(28),YX(28)
    844       LOGICAL START
    845 
    846 C     ALL LIMITS ARE INCLUSIVE
    847 C     ------------------------
    848 
    849       DATA XN /7*230.,7*-40.,7*50.,7*140./
    850       DATA XX /7*319.99,7*49.99,7*139.99,7*229.99/
    851       DATA YN /60.,40.,20.,-20.,-40.,-60.,-90.00,
    852      &         60.,40.,20.,-20.,-40.,-60.,-89.99,
    853      &         60.,40.,20.,-20.,-40.,-60.,-89.99,
    854      &         60.,40.,20.,-20.,-40.,-60.,-89.99/
    855       DATA YX /90.00,59.99,39.99,19.99,-20.01,-40.01,-60.01,
    856      &         89.99,59.99,39.99,19.99,-20.01,-40.01,-60.01,
    857      &         89.99,59.99,39.99,19.99,-20.01,-40.01,-60.01,
    858      &         89.99,59.99,39.99,19.99,-20.01,-40.01,-60.01/
    859       DATA START /.TRUE./
    860 
    861 C     IF(START) THEN
    862 C       WRITE(6,500)
    863 C       DO IA=1,28
    864 C         WRITE(6,551) IA,XN(IA),XX(IA),YN(IA),YX(IA)
    865 C       ENDDO

Page 24          Source Listing                  AREA
2017-04-18 11:07                                 cqcbufr.f

    866 C       START = .FALSE.
    867 C     ENDIF
    868 C 551 FORMAT(1X,I7,4F8.2)
    869 C 500 FORMAT(' REGION LIMITS:',/,
    870 C    &       ' REGION    X-MIN   X-MAX   Y-MIN   Y-MAX')
    871 
    872       IF(X.LT.-40.)   X = X + 360.
    873       IF(X.GT.319.99) X = X - 360.
    874       DO I=1,28
    875         IF(X.GE.XN(I) .AND. X.LE.XX(I)  .AND.
    876      &     Y.GE.YN(I) .AND. Y.LE.YX(I)) THEN
    877           IA = I
    878           RETURN
    879         ENDIF
    880       ENDDO
    881       IA = 0
    882       RETURN
    883       END


ENTRY POINTS

  Name             
                   
 area_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AREA                       Subr   842                                                                                              
 I                          Local  874      I(4)            4           scalar                    874,875,876,877                   
 IA                         Dummy  842      I(4)            4           scalar   ARG,INOUT        877,881                           
 START                      Local  844      L(4)            4           scalar                    859                               
 X                          Dummy  842      R(4)            4           scalar   ARG,INOUT        872,873,875                       
 XN                         Local  843      R(4)            4     1     28                        849,875                           
 XX                         Local  843      R(4)            4     1     28                        850,875                           
 Y                          Dummy  842      R(4)            4           scalar   ARG,INOUT        876                               
 YN                         Local  843      R(4)            4     1     28                        851,876                           
 YX                         Local  843      R(4)            4     1     28                        855,876                           

Page 25          Source Listing                  AREA
2017-04-18 11:07                                 cqcbufr.f

    884 
    885 C**********************************************************************
    886 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    887 C                .      .    .                                       .
    888 C SUBPROGRAM:    AUXLEVS     INTERPOLATE DATA TO AUXILIARY LEVELS
    889 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
    890 C
    891 C ABSTRACT: Interpolate data to auxiliary levels: levels that are not
    892 C   observed but which the regional models use.  Also, interpolate
    893 C   increments to these levels.
    894 C
    895 C PROGRAM HISTORY LOG:
    896 C 1997-03-18  W. Collins  Original author.
    897 C
    898 C USAGE:    CALL AUXLEVS(SKIP,SAME,WIND,SINGLE,ANYS)
    899 C   INPUT ARGUMENT LIST:
    900 C     SKIP     - TRUE FOR STATIONS TO SKIP (OUT OF REGION, ETC.)
    901 C     SAME     - TRUE WHEN WIND PART GOES WITH PREVIOUSLY READ
    902 C                MASS PART
    903 C     WIND     - TRUE FOR WIND PART OF REPORT
    904 C     SINGLE   - TRUE FOR SINGLE-STATION VERSION
    905 C     ANYS     - TRUE IF PROFILE HAS ANY ERRORS
    906 C
    907 C   OUTPUT FILES:
    908 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
    909 C
    910 C
    911 C REMARKS: NONE
    912 C
    913 C ATTRIBUTES:
    914 C   LANGUAGE: FORTRAN 90
    915 C   MACHINE:  NCEP WCOSS
    916 C
    917 C$$$
    918 
    919       SUBROUTINE AUXLEVS(SKIP,SAME,WIND,SINGLE,ANYS)
    920       PARAMETER (NST=999)
    921 
    922       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
    923      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
    924      &                 NEV, ISF(NST), NLVM, NLVW
    925       COMMON /EVNSND/  PO(255), TO(255), ZO(255), CA(255),
    926      &                 PQ(255), TQ(255), ZQ(255), INP(255),
    927      &                 PR(255), TR(255), ZR(255), INZ(255),
    928      &                 QO(255), QQ(255), QR(255), INT(255),
    929      &                 TDE(255),TDQ(255),TDR(255),INQ(255),
    930      &                 UO(255), VO(255), SPO(255),DIRO(255),
    931      &                 WQ(255), WR(255)
    932       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
    933       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
    934      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
    935       COMMON /STN/     IS
    936       COMMON /PEROR/   ISERR, ISOBERR
    937       COMMON /LTP/     LVTYP(9,255), NCH(9,255), LVRC(9,255), LVRCALL
    938       REAL             WO(2,255)
    939       LOGICAL          ISERR, ANYS, ISOBERR, PRNT, LVRC, LVRCALL
    940       CHARACTER*8 SID

Page 26          Source Listing                  AUXLEVS
2017-04-18 11:07                                 cqcbufr.f

    941       CHARACTER*40 PEVN,TEVN,ZEVN,WEVN,SPVN,DIRVN,QEVN
    942       LOGICAL SKIP, WIND, SINGLE, SAME
    943       DATA PEVN   /'POB PQM PPC PRC                         '/
    944       DATA TEVN   /'TOB TQM TPC TRC                         '/
    945       DATA ZEVN   /'ZOB ZQM ZPC ZRC                         '/
    946       DATA QEVN   /'QOB QQM QPC QRC                         '/
    947       DATA WEVN   /'UOB VOB WQM WPC WRC                     '/
    948       DATA SPVN   /'FFO WQM WPC WRC                         '/
    949       DATA DIRVN  /'DDO WQM WPC WRC                         '/
    950 
    951       IF(.NOT. WIND) THEN
    952         ISERR = ISERR .OR. ANYS .OR. ISOBERR
    953         ISERR = .FALSE.
    954       ENDIF
    955 
    956 C     IF(TEST) WRITE(60,510) SID(IS), SKIP, WIND, SINGLE, SAME
    957 C 510 FORMAT(' AUXLEVS--SID(IS),SKIP,WIND,SINGLE,SAME: ',A8,2X,4L3)
    958 
    959       IF(SINGLE) RETURN
    960 
    961 C  INTERPOLATE TO AUXILIARY LEVELS AND WRITE EVENTS
    962 C  ------------------------------------------------
    963 
    964       IF(.NOT. SKIP) THEN
    965         CALL GETLEV(WIND)
    966         IF(.NOT.LVRCALL) RETURN   ! Return if no auxiliary levels
    967         CALL GETINC(WIND)
    968         IF(.NOT. WIND) THEN
    969           CALL FILALL(SAME,WIND)
    970           CALL FULVAL(WIND)
    971           CALL EVENT(NFOUT,PEVN,NLV,PO,PQ,PR,INP,NEV,CQCPC)
    972           WRITE(60,511) NEV,SID(IS)
    973           CALL EVENT(NFOUT,TEVN,NLV,TO,TQ,TR,INP,NEV,CQCPC)
    974           WRITE(60,512) NEV,SID(IS)
    975           CALL EVENT(NFOUT,ZEVN,NLV,ZO,ZQ,ZR,INP,NEV,CQCPC)
    976           WRITE(60,513) NEV,SID(IS)
    977           CALL EVENT(NFOUT,QEVN,NLV,QO,QQ,QR,INP,NEV,CQCPC)
    978           WRITE(60,514) NEV,SID(IS)
    979         ELSE
    980           CALL WINDATZ(SAME)
    981           CALL FILALL(SAME,WIND)
    982           IF(SAME) THEN
    983             CALL FULVAL(WIND)
    984             DO I=1,NEV
    985               WO(1,I) = UO(I)
    986               WO(2,I) = VO(I)
    987             ENDDO
    988             CALL EVENT(NFOUT,PEVN,NLV,PO,PQ,PR,INP,NEV,CQCPC)
    989             WRITE(60,511) NEV,SID(IS)
    990             CALL EVENT(NFOUT,ZEVN,NLV,ZO,ZQ,ZR,INP,NEV,CQCPC)
    991             WRITE(60,513) NEV,SID(IS)
    992             CALL EVENTW(NFOUT,WEVN,NLV,WO,WQ,WR,INP,NEV,CQCPC)
    993             WRITE(60,515) NEV,SID(IS)
    994           ENDIF
    995         ENDIF
    996       ENDIF
    997 

Page 27          Source Listing                  AUXLEVS
2017-04-18 11:07                                 cqcbufr.f

    998   511 FORMAT(' AUXLEVS--',I3,' PRESSURE EVENTS WRITTEN FOR ',A8)
    999   512 FORMAT(' AUXLEVS--',I3,' TEMPERATURE EVENTS WRITTEN FOR ',A8)
   1000   513 FORMAT(' AUXLEVS--',I3,' HEIGHT EVENTS WRITTEN FOR ',A8)
   1001   514 FORMAT(' AUXLEVS--',I3,' MOISTURE EVENTS WRITTEN FOR ',A8)
   1002   515 FORMAT(' AUXLEVS--',I3,' WIND EVENTS WRITTEN FOR ',A8)
   1003 
   1004       RETURN
   1005       END


ENTRY POINTS

  Name                
                      
 auxlevs_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 511                        Label  998                                                            972,989                           
 512                        Label  999                                                            974                               
 513                        Label  1000                                                           976,991                           
 514                        Label  1001                                                           978                               
 515                        Label  1002                                                           993                               
 ANYS                       Dummy  919      L(4)            4           scalar   ARG,INOUT        952                               
 AUXLEVS                    Subr   919                                                                                              
 CA                         Scalar 925      R(4)            4     1     255      COM                                                
 CQCPC                      Scalar 934      R(4)            4           scalar   COM              971,973,975,977,988,990,992       
 DHR                        Scalar 922      R(4)            4     1     999      COM                                                
 DIRO                       Scalar 930      R(4)            4     1     255      COM                                                
 DIRVN                      Local  941      CHAR            40          scalar                    949                               
 ELV                        Scalar 923      R(4)            4     1     999      COM                                                
 EVENT                      Subr   971                                                            971,973,975,977,988,990           
 EVENTW                     Subr   992                                                            992                               
 EVNSND                     Common 925                                  26520                                                       
 FILALL                     Subr   969                                                            969,981                           
 FILES                      Common 932                                  24                                                          
 FULVAL                     Subr   970                                                            970,983                           
 GETINC                     Subr   967                                                            967                               
 GETLEV                     Subr   965                                                            965                               
 HEADER                     Common 922                                  35980                                                       
 I                          Local  984      I(4)            4           scalar                    984,985,986                       
 INP                        Scalar 926      I(4)            4     1     255      COM              971,973,975,977,988,990,992       
 INQ                        Scalar 929      I(4)            4     1     255      COM                                                
 INT                        Scalar 928      I(4)            4     1     255      COM                                                
 INZ                        Scalar 927      I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 934      I(4)            4           scalar   COM                                                
 IS                         Scalar 935      I(4)            4           scalar   COM              972,974,976,978,989,991,993       
 ISC                        Scalar 934      I(4)            4           scalar   COM                                                
 ISERR                      Scalar 936      L(4)            4           scalar   COM              952,953                           
 ISF                        Scalar 924      I(4)            4     1     999      COM                                                
 ISOBERR                    Scalar 936      L(4)            4           scalar   COM              952                               
 ITP                        Scalar 923      I(4)            4     1     999      COM                                                
 LMAND                      Scalar 934      I(4)            4     1     22       COM                                                
 LSFC                       Scalar 934      I(4)            4           scalar   COM                                                

Page 28          Source Listing                  AUXLEVS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LTP                        Common 937                                  27544                                                       
 LVRC                       Scalar 937      L(4)            4     2     2295     COM                                                
 LVRCALL                    Scalar 937      L(4)            4           scalar   COM              966                               
 LVTYP                      Scalar 937      I(4)            4     2     2295     COM                                                
 MAND                       Scalar 933      I(4)            4           scalar   COM                                                
 NCH                        Scalar 937      I(4)            4     2     2295     COM                                                
 NEV                        Scalar 924      I(4)            4           scalar   COM              971,972,973,974,975,976,977,978,98
                                                                                                  4,988,989,990,991,992,993         
 NFEVN                      Scalar 932      I(4)            4           scalar   COM                                                
 NFIN                       Scalar 932      I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 932      I(4)            4           scalar   COM              971,973,975,977,988,990,992       
 NFSGL                      Scalar 932      I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 932      I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 932      I(4)            4           scalar   COM                                                
 NLEV                       Scalar 933      I(4)            4           scalar   COM                                                
 NLV                        Scalar 923      I(4)            4           scalar   COM              971,973,975,977,988,990,992       
 NLVM                       Scalar 924      I(4)            4           scalar   COM                                                
 NLVW                       Scalar 924      I(4)            4           scalar   COM                                                
 NOBS                       Scalar 933      I(4)            4           scalar   COM                                                
 NST                        Param  920      I(4)            4           scalar                    922,923,924                       
 PARAMS                     Common 933                                  148                                                         
 PEROR                      Common 936                                  8                                                           
 PEVN                       Local  941      CHAR            40          scalar                    943,971,988                       
 PO                         Scalar 925      R(4)            4     1     255      COM              971,988                           
 PQ                         Scalar 926      R(4)            4     1     255      COM              971,988                           
 PR                         Scalar 927      R(4)            4     1     255      COM              971,988                           
 PRNT                       Scalar 934      L(4)            4           scalar   COM                                                
 QEVN                       Local  941      CHAR            40          scalar                    946,977                           
 QO                         Scalar 928      R(4)            4     1     255      COM              977                               
 QQ                         Scalar 928      R(4)            4     1     255      COM              977                               
 QR                         Scalar 928      R(4)            4     1     255      COM              977                               
 RADPC                      Scalar 933      R(4)            4           scalar   COM                                                
 SAME                       Dummy  919      L(4)            4           scalar   ARG,INOUT        969,980,981,982                   
 SID                        Scalar 922      CHAR            8     1     999      COM              972,974,976,978,989,991,993       
 SINGLE                     Dummy  919      L(4)            4           scalar   ARG,INOUT        959                               
 SKIP                       Dummy  919      L(4)            4           scalar   ARG,INOUT        964                               
 SPO                        Scalar 930      R(4)            4     1     255      COM                                                
 SPVN                       Local  941      CHAR            40          scalar                    948                               
 SQN                        Scalar 923      R(4)            4     1     999      COM                                                
 STN                        Common 935                                  4                                                           
 TDE                        Scalar 929      R(4)            4     1     255      COM                                                
 TDQ                        Scalar 929      R(4)            4     1     255      COM                                                
 TDR                        Scalar 929      R(4)            4     1     255      COM                                                
 TEVN                       Local  941      CHAR            40          scalar                    944,973                           
 TO                         Scalar 925      R(4)            4     1     255      COM              973                               
 TQ                         Scalar 926      R(4)            4     1     255      COM              973                               
 TR                         Scalar 927      R(4)            4     1     255      COM              973                               
 TT                         Scalar 934      R(4)            4           scalar   COM                                                
 UO                         Scalar 930      R(4)            4     1     255      COM              985                               
 VO                         Scalar 930      R(4)            4     1     255      COM              986                               
 VTPPC                      Scalar 933      R(4)            4           scalar   COM                                                
 WEVN                       Local  941      CHAR            40          scalar                    947,992                           
 WIND                       Dummy  919      L(4)            4           scalar   ARG,INOUT        951,965,967,968,969,970,981,983   
 WINDATZ                    Subr   980                                                            980                               
 WO                         Local  938      R(4)            4     2     510                       985,986,992                       

Page 29          Source Listing                  AUXLEVS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 WQ                         Scalar 931      R(4)            4     1     255      COM              992                               
 WR                         Scalar 931      R(4)            4     1     255      COM              992                               
 XMA                        Scalar 933      R(4)            4           scalar   COM                                                
 XMI                        Scalar 933      R(4)            4           scalar   COM                                                
 XOB                        Scalar 922      R(4)            4     1     999      COM                                                
 YMA                        Scalar 933      R(4)            4           scalar   COM                                                
 YMI                        Scalar 933      R(4)            4           scalar   COM                                                
 YOB                        Scalar 922      R(4)            4     1     999      COM                                                
 ZEVN                       Local  941      CHAR            40          scalar                    945,975,990                       
 ZO                         Scalar 925      R(4)            4     1     255      COM              975,990                           
 ZQ                         Scalar 926      R(4)            4     1     255      COM              975,990                           
 ZR                         Scalar 927      R(4)            4     1     255      COM              975,990                           

Page 30          Source Listing                  AUXLEVS
2017-04-18 11:07                                 cqcbufr.f

   1006 
   1007 C**********************************************************************
   1008 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1009 C                .      .    .                                       .
   1010 C SUBPROGRAM:    BEST        COMPUTES 'BEST' CORRECTION.
   1011 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   1012 C
   1013 C ABSTRACT: In most cases, the complex of hydrostatic residuals will
   1014 C   provide a test correction.  When it is not adequate, then the
   1015 C   other residuals are used to obtain an alternate test correction.
   1016 C   The 'best' value is a weighted mean of the available corrections.
   1017 C   Each is weighted by the inverse of its climatological standard
   1018 C   deviation.
   1019 C
   1020 C PROGRAM HISTORY LOG:
   1021 C 1997-03-18  W. Collins  Original author.
   1022 C
   1023 C USAGE:    CALL BEST(XB,X1,Y1,X2,Y2,X3,Y3,X4,Y4,X5,Y5)
   1024 C   INPUT ARGUMENT LIST:
   1025 C     X1       - FIRST RESIDUAL
   1026 C     Y1       - FIRST CLIMATOLOGICAL STANDARD DEVIATION
   1027 C     X2       - SECOND RESIDUAL
   1028 C     Y2       - SECOND CLIMATOLOGICAL STANDARD DEVIATION
   1029 C     X3       - THIRD RESIDUAL
   1030 C     Y3       - THIRD CLIMATOLOGICAL STANDARD DEVIATION
   1031 C     X4       - FOURTH RESIDUAL
   1032 C     Y4       - FOURTH CLIMATOLOGICAL STANDARD DEVIATION
   1033 C     X5       - FIFTH RESIDUAL
   1034 C     Y5       - FIFTH CLIMATOLOGICAL STANDARD DEVIATION
   1035 C
   1036 C   OUTPUT ARGUMENT LIST:
   1037 C     XB       - 'BEST' CORRECTION
   1038 C
   1039 C
   1040 C REMARKS: NONE
   1041 C
   1042 C ATTRIBUTES:
   1043 C   LANGUAGE: FORTRAN 90
   1044 C   MACHINE:  NCEP WCOSS
   1045 C
   1046 C$$$
   1047 
   1048       SUBROUTINE BEST(XB,X1,Y1,X2,Y2,X3,Y3,X4,Y4,X5,Y5)
   1049 
   1050       REAL(8) BMISS
   1051 
   1052       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   1053 
   1054       IF(X1.NE.XMISS. AND. Y1.NE.XMISS .AND. Y1.NE.0.) THEN
   1055         SUM1 = -X1/Y1
   1056         SUM2 = 1./Y1
   1057       ELSE
   1058         SUM1 = 0.
   1059         SUM2 = 0.
   1060       ENDIF
   1061       IF(X2.NE.XMISS .AND. Y2.NE.XMISS .AND. Y2.NE.0.) THEN
   1062         SUM1 = SUM1 - X2/Y2

Page 31          Source Listing                  BEST
2017-04-18 11:07                                 cqcbufr.f

   1063         SUM2 = SUM2 + 1./Y2
   1064       ENDIF
   1065       IF(X3.NE.XMISS .AND. Y3.NE.XMISS .AND. Y3.NE.0.) THEN
   1066         SUM1 = SUM1 - X3/Y3
   1067         SUM2 = SUM2 + 1./Y3
   1068       ENDIF
   1069       IF(X4.NE.XMISS .AND. Y4.NE.XMISS .AND. Y4.NE.0.) THEN
   1070         SUM1 = SUM1 - X4/Y4
   1071         SUM2 = SUM2 + 1./Y4
   1072       ENDIF
   1073       IF(X5.NE.XMISS .AND. Y5.NE.XMISS .AND. Y5.NE.0.) THEN
   1074         SUM1 = SUM1 - X5/Y5
   1075         SUM2 = SUM2 + 1./Y5
   1076       ENDIF
   1077       IF(SUM2.NE.0.) THEN
   1078         XB = SUM1/SUM2
   1079       ELSE
   1080         XB = XMISS
   1081       ENDIF
   1082 
   1083       RETURN
   1084       END


ENTRY POINTS

  Name             
                   
 best_             

Page 32          Source Listing                  BEST
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BEST                       Subr   1048                                                                                             
 BMISS                      Scalar 1050     R(8)            8           scalar   COM                                                
 BUFRLIB_MISSING            Common 1052                                 16                                                          
 IMISS                      Scalar 1052     I(4)            4           scalar   COM                                                
 SUM1                       Local  1055     R(4)            4           scalar                    1055,1058,1062,1066,1070,1074,1078
 SUM2                       Local  1056     R(4)            4           scalar                    1056,1059,1063,1067,1071,1075,1077
                                                                                                  ,1078                             
 X1                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1054,1055                         
 X2                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1061,1062                         
 X3                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1065,1066                         
 X4                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1069,1070                         
 X5                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1073,1074                         
 XB                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1078,1080                         
 XMISS                      Scalar 1052     R(4)            4           scalar   COM              1054,1061,1065,1069,1073,1080     
 Y1                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1054,1055,1056                    
 Y2                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1061,1062,1063                    
 Y3                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1065,1066,1067                    
 Y4                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1069,1070,1071                    
 Y5                         Dummy  1048     R(4)            4           scalar   ARG,INOUT        1073,1074,1075                    

Page 33          Source Listing                  BEST
2017-04-18 11:07                                 cqcbufr.f

   1085 
   1086 C**********************************************************************
   1087 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1088 C                .      .    .                                       .
   1089 C SUBPROGRAM:    CHANGE      APPLY CORRECTIONS TO DATA
   1090 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   1091 C
   1092 C ABSTRACT: Apply corrections to the data.  For pressure, the data are
   1093 C   resorted by pressure.
   1094 C
   1095 C PROGRAM HISTORY LOG:
   1096 C 1997-03-18  W. Collins  Original author.
   1097 C 1998-02-18  W. Collins  Correct recomputation of virtual temperature.
   1098 C
   1099 C USAGE:    CALL CHANGE(ANY,SINGLE,SEQLP)
   1100 C   INPUT ARGUMENT LIST:
   1101 C     ANY      - LOGICAL VARIABLE TRUE IF THERE ARE ANY CORRECITIONS
   1102 C     SINGLE   - LOGICAL VARIABLE, TRUE FOR SINGLE-STATION RUNNING
   1103 C     SEQLP    - SEQUENCE NUMBER
   1104 C
   1105 C   OUTPUT FILES:
   1106 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   1107 C
   1108 C REMARKS: NONE
   1109 C
   1110 C ATTRIBUTES:
   1111 C   LANGUAGE: FORTRAN 90
   1112 C   MACHINE:  NCEP WCOSS
   1113 C
   1114 C$$$
   1115       SUBROUTINE CHANGE(ANY,SINGLE,SEQLP)
   1116 
   1117       REAL(8) BMISS
   1118 
   1119       SAVE IEVOLD
   1120       PARAMETER (NST=999)
   1121       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   1122      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   1123      &                 NEV, ISF(NST), NLVM, NLVW
   1124       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   1125      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   1126      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   1127      &                 TDO(255), TDFC(255),TVO(255),
   1128      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   1129      &                 CAT(255), IND(255), LEVTYP(255),
   1130      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   1131      &                 YDR(255), XDR(255)
   1132       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
   1133      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
   1134      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
   1135      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
   1136      &                 BASR(2000),   PISR(2000),  PSINCR(2000),
   1137      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
   1138       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   1139      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   1140       COMMON /STN/     IS
   1141       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,

Page 34          Source Listing                  CHANGE
2017-04-18 11:07                                 cqcbufr.f

   1142      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   1143       COMMON /CONSTS/  R, G, T0, CP, RV
   1144       COMMON /TESTS/   TEST
   1145       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   1146 
   1147       LOGICAL          TEST, POUT
   1148       INTEGER          IVIND(255)
   1149       CHARACTER*8      SID, STN
   1150       CHARACTER*10     EDATE
   1151       LOGICAL ANY, SINGLE, PRNT, SDMP, SDMZ, SDMT, SDMQ
   1152       DATA IEVOLD /0/
   1153 
   1154 C-----------------------------------------------------------------------
   1155 C FCNS BELOW CONVERT TEMP/TD (K) & PRESS (MB) INTO SAT./ SPEC. HUM.(G/G)
   1156 C-----------------------------------------------------------------------
   1157       ES(T) = 6.1078*EXP((17.269*(T - 273.15))/(T - 273.15 + 237.3))
   1158       QS(T,P) = (0.622*ES(T))/(P-0.378*ES(T))
   1159 C-----------------------------------------------------------------------
   1160 
   1161       ANY = .FALSE.
   1162       ICALL = 2
   1163       IF(IEVENT.NE.IEVOLD) THEN
   1164         DO I=IEVOLD+1,IEVENT
   1165           IF(I.EQ.1) THEN
   1166             CALL PRNTOUT(SEQLP,ICALL)
   1167             IF(.NOT.SINGLE) CALL WBLOCKS
   1168           ELSEIF(.NOT.SINGLE .AND. I.EQ.IEVOLD+1
   1169      &      .AND. SEQN(I).NE.SEQLP) THEN
   1170             CALL PRNTOUT(SEQLP,ICALL)
   1171             CALL WBLOCKS
   1172           ELSEIF(SINGLE .AND. .NOT.PRNT .AND.
   1173      &      I.EQ.IEVOLD+1) THEN
   1174             CALL PRNTOUT(SEQLP,ICALL)
   1175           ENDIF
   1176           L  = LEVL(I)
   1177           IV = IVAR(I)
   1178           SDMP = .FALSE.
   1179           SDMZ = .FALSE.
   1180           SDMT = .FALSE.
   1181           SDMQ = .FALSE.
   1182           SDMP = PQM(L).EQ.0. .OR. PQM(L).GE.14. .OR.
   1183      &          (PQM(L).GE.4. .AND. PQM(L).LE.12.)
   1184           SDMZ = ZQM(L).EQ.0. .OR. ZQM(L).GE.14. .OR.
   1185      &          (ZQM(L).GE.4. .AND. ZQM(L).LE.12.)
   1186           SDMT = TQM(L).EQ.0. .OR. TQM(L).GE.14. .OR.
   1187      &          (TQM(L).GE.4. .AND. TQM(L).LE.12.)
   1188           SDMQ = QQM(L).EQ.0. .OR. QQM(L).GE.14. .OR.
   1189      &          (QQM(L).GE.4. .AND. QQM(L).LE.12.)
   1190 
   1191 C  PRINT SOME DIAGNOSTICS
   1192 C  ----------------------
   1193 
   1194           IF(TEST) WRITE(60,500) I,IV,PQM(L),SDMP,ZQM(L),SDMZ,TQM(L),
   1195      &      SDMT,QQM(L),PRES(I),CORVAL(I)
   1196   500     FORMAT(' CHANGE--EVENT: ',I5,' IV: ',I5,
   1197      &      '  PQM,SDMP,ZQM,SDMZ,TQM,SDMT,QQM,PRES,CORVAL:',
   1198      &      3(F8.0,2X,L2,2X),F8.0,2X,F8.1,2X,F8.1)

Page 35          Source Listing                  CHANGE
2017-04-18 11:07                                 cqcbufr.f

   1199 
   1200           IF(IV.EQ.1 .AND. .NOT.SDMP) THEN
   1201             IF(COR(I).NE.BMISS .AND. COR(I).NE.0.) ANY = .TRUE.
   1202             IF(LST(L).EQ.240) THEN
   1203               PS(IS) = CORVAL(I)
   1204 C             IF(ABS(PSCOR).LT.25.) THEN
   1205                 ZFC(L) = ZFC(L) - ZSCOR
   1206 C             ELSE
   1207 C               ZFC(L) = ZOB(L)
   1208 C             ENDIF
   1209             ENDIF
   1210             POB(L) = CORVAL(I)
   1211             PQM(L) = QMARK(I)
   1212             IF(CAT(L).NE.3 .AND. CAT(L).NE.4 .AND. CAT(L).NE.7) THEN
   1213               PRC(L) = IETYP(I)
   1214             ENDIF
   1215 C  RESORT RELATIVE TO NEW PRESSURES
   1216 C  --------------------------------
   1217             CALL SHELL(POB,IVIND,NLV,1)
   1218             CALL SORT(ZOB,IVIND,NLV)
   1219             CALL SORT(TOB,IVIND,NLV)
   1220             CALL SORT(TDO,IVIND,NLV)
   1221             CALL SORT(QOB,IVIND,NLV)
   1222             CALL SORT(CAT,IVIND,NLV)
   1223             CALL SORT(HRDR,IVIND,NLV)
   1224             CALL SORT(YDR,IVIND,NLV)
   1225             CALL SORT(XDR,IVIND,NLV)
   1226             CALL SORT(TVO,IVIND,NLV)
   1227             CALL SORT(PQM,IVIND,NLV)
   1228             CALL SORT(ZQM,IVIND,NLV)
   1229             CALL SORT(TQM,IVIND,NLV)
   1230             CALL SORT(QQM,IVIND,NLV)
   1231             CALL SORT(PFC,IVIND,NLV)
   1232             CALL SORT(ZFC,IVIND,NLV)
   1233             CALL SORT(TFC,IVIND,NLV)
   1234             CALL SORT(QFC,IVIND,NLV)
   1235             CALL SORT(PRC,IVIND,NLV)
   1236             CALL SORT(ZRC,IVIND,NLV)
   1237             CALL SORT(TRC,IVIND,NLV)
   1238             CALL SORT(QRC,IVIND,NLV)
   1239             CALL SORT(TDFC,IVIND,NLV)
   1240           ELSEIF(IV.EQ.2 .AND. .NOT.SDMZ) THEN
   1241             IF(COR(I).NE.BMISS .AND. COR(I).NE.0.) ANY = .TRUE.
   1242             ZOB(L) = CORVAL(I)
   1243             ZQM(L) = QMARK(I)
   1244             IF(CAT(L).NE.3 .AND. CAT(L).NE.4 .AND. CAT(L).NE.7) THEN
   1245               ZRC(L) = IETYP(I)
   1246             ENDIF
   1247           ELSEIF(IV.EQ.3 .AND. .NOT.SDMT) THEN
   1248             IF(COR(I).NE.BMISS .AND. COR(I).NE.0.) ANY = .TRUE.
   1249             TOB(L) = CORVAL(I)
   1250 C           TDO(L) = TDO(L)            ! No change for depression
   1251             IF(QOB(L).NE.BMISS .AND.
   1252      &        TDO(L).NE.BMISS .AND.
   1253      &        POB(L).NE.BMISS) THEN                !Recalculate q, Tv
   1254               TD     = TOB(L)-TDO(L)+T0            !TDO is depression
   1255               P      = POB(L)

Page 36          Source Listing                  CHANGE
2017-04-18 11:07                                 cqcbufr.f

   1256               QOB(L) = QS(TD,P)  !Recalculated for new T, original Td
   1257               TVO(L) = (TOB(L)+T0)*(1.+.61*QOB(L)) - T0
   1258             ELSE
   1259               TVO(L) = BMISS
   1260             ENDIF
   1261             TQM(L) = QMARK(I)
   1262             IF(CAT(L).NE.3 .AND. CAT(L).NE.4 .AND. CAT(L).NE.7) THEN
   1263               TRC(L) = IETYP(I)
   1264             ENDIF
   1265           ELSEIF((IV.EQ.4 .OR.IV.EQ.5) .AND. .NOT.SDMQ) THEN
   1266             IF(COR(I).NE.BMISS .AND. COR(I).NE.0.) ANY = .TRUE.
   1267             QOB(L) = CORVAL(I)
   1268             QQM(L) = QMARK(I)
   1269             IF(CAT(L).NE.3 .AND. CAT(L).NE.4 .AND. CAT(L).NE.7) THEN
   1270               QRC(L) = IETYP(I)
   1271             ENDIF
   1272           ENDIF
   1273         ENDDO
   1274       ENDIF
   1275 
   1276       IEVOLD = IEVENT
   1277       IF(ANY) LAST = 0
   1278 
   1279       RETURN
   1280       END


ENTRY POINTS

  Name               
                     
 change_             

Page 37          Source Listing                  CHANGE
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  1196                                                           1194                              
 ALLSND                     Common 1124                                 34512                                                       
 ANY                        Dummy  1115     L(4)            4           scalar   ARG,INOUT        1161,1201,1241,1248,1266,1277     
 BASR                       Scalar 1136     R(4)            4     1     2000     COM                                                
 BMISS                      Scalar 1117     R(8)            8           scalar   COM              1201,1241,1248,1251,1252,1253,1259
                                                                                                  ,1266                             
 BUFRLIB_MISSING            Common 1145                                 16                                                          
 CAT                        Scalar 1129     R(4)            4     1     255      COM              1212,1222,1244,1262,1269          
 CHANGE                     Subr   1115                                                                                             
 CONSTS                     Common 1143                                 20                                                          
 COR                        Scalar 1134     R(4)            4     1     2000     COM              1201,1241,1248,1266               
 CORVAL                     Scalar 1134     R(4)            4     1     2000     COM              1195,1203,1210,1242,1249,1267     
 CP                         Scalar 1143     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 1142     R(4)            4           scalar   COM                                                
 DHR                        Scalar 1121     R(4)            4     1     999      COM                                                
 EDATE                      Scalar 1137     CHAR            10    1     2000     COM                                                
 ELV                        Scalar 1122     R(4)            4     1     999      COM                                                
 ES                         Local  1157     R(4)            4           scalar                    1158                              
 EVENTS                     Common 1132                                 156004                                                      
 EXP                        Func   1157                                 scalar                    1157                              
 G                          Scalar 1143     R(4)            4           scalar   COM                                                
 GESPS                      Scalar 1130     R(4)            4     1     999      COM                                                
 H1                         Scalar 1138     R(4)            4           scalar   COM                                                
 H2                         Scalar 1138     R(4)            4           scalar   COM                                                
 HEADER                     Common 1121                                 35980                                                       
 HRDR                       Scalar 1130     R(4)            4     1     255      COM              1223                              
 HYDSTUF                    Common 1138                                 64                                                          
 I                          Local  1164     I(4)            4           scalar                    1164,1165,1168,1169,1173,1176,1177
                                                                                                  ,1194,1195,1201,1203,1210,1211,121
                                                                                                  3,1241,1242,1243,1245,1248,1249,12
                                                                                                  61,1263,1266,1267,1268,1270       
 ICALL                      Local  1162     I(4)            4           scalar                    1162,1166,1170,1174               
 IETYP                      Scalar 1137     I(4)            4     1     2000     COM              1213,1245,1263,1270               
 IEVENT                     Scalar 1135     I(4)            4           scalar   COM              1163,1164,1276                    
 IEVOLD                     Local  1119     I(4)            4           scalar   SAVE             1152,1163,1164,1168,1173,1276     
 IMISS                      Scalar 1145     I(4)            4           scalar   COM                                                
 IND                        Scalar 1129     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 1142     I(4)            4           scalar   COM                                                
 IS                         Scalar 1140     I(4)            4           scalar   COM              1203                              
 ISC                        Scalar 1142     I(4)            4           scalar   COM                                                
 ISCAN                      Scalar 1132     I(4)            4     1     2000     COM                                                
 ISF                        Scalar 1123     I(4)            4     1     999      COM                                                
 ITP                        Scalar 1122     I(4)            4     1     999      COM                                                
 IV                         Local  1177     I(4)            4           scalar                    1177,1194,1200,1240,1247,1265     
 IVAR                       Scalar 1134     I(4)            4     1     2000     COM              1177                              
 IVIND                      Local  1148     I(4)            4     1     255                       1217,1218,1219,1220,1221,1222,1223
                                                                                                  ,1224,1225,1226,1227,1228,1229,123
                                                                                                  0,1231,1232,1233,1234,1235,1236,12
                                                                                                  37,1238,1239                      
 L                          Local  1176     I(4)            4           scalar                    1176,1182,1183,1184,1185,1186,1187
                                                                                                  ,1188,1189,1194,1195,1202,1205,121

Page 38          Source Listing                  CHANGE
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  0,1211,1212,1213,1242,1243,1244,12
                                                                                                  45,1249,1251,1252,1253,1254,1255,1
                                                                                                  256,1257,1259,1261,1262,1263,1267,
                                                                                                  1268,1269,1270                    
 LAST                       Scalar 1139     I(4)            4           scalar   COM              1277                              
 LEVL                       Scalar 1133     I(4)            4     1     2000     COM              1176                              
 LEVTYP                     Scalar 1129     I(4)            4     1     255      COM                                                
 LMAND                      Scalar 1142     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 1142     I(4)            4           scalar   COM                                                
 LST                        Scalar 1130     I(4)            4     1     255      COM              1202                              
 LSTYP                      Scalar 1135     I(4)            4     1     2000     COM                                                
 LTYP                       Scalar 1133     I(4)            4     1     2000     COM                                                
 MAND                       Scalar 1141     I(4)            4           scalar   COM                                                
 NEV                        Scalar 1123     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 1141     I(4)            4           scalar   COM                                                
 NLV                        Scalar 1122     I(4)            4           scalar   COM              1217,1218,1219,1220,1221,1222,1223
                                                                                                  ,1224,1225,1226,1227,1228,1229,123
                                                                                                  0,1231,1232,1233,1234,1235,1236,12
                                                                                                  37,1238,1239                      
 NLVM                       Scalar 1123     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 1123     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 1141     I(4)            4           scalar   COM                                                
 NST                        Param  1120     I(4)            4           scalar                    1121,1122,1123,1130               
 P                          Local  1255     R(4)            4           scalar                    1255,1256                         
 PARAMS                     Common 1141                                 148                                                         
 PCOR                       Scalar 1135     R(4)            4     1     2000     COM                                                
 PFC                        Scalar 1124     R(4)            4     1     255      COM              1231                              
 PISR                       Scalar 1136     R(4)            4     1     2000     COM                                                
 POB                        Scalar 1124     R(4)            4     1     255      COM              1210,1217,1253,1255               
 POUT                       Scalar 1139     L(4)            4           scalar   COM                                                
 PQM                        Scalar 1124     R(4)            4     1     255      COM              1182,1183,1194,1211,1227          
 PRC                        Scalar 1124     R(4)            4     1     255      COM              1213,1235                         
 PRES                       Scalar 1133     R(4)            4     1     2000     COM              1195                              
 PRNT                       Scalar 1142     L(4)            4           scalar   COM              1172                              
 PRNTOUT                    Subr   1166                                                           1166,1170,1174                    
 PS                         Scalar 1130     R(4)            4     1     999      COM              1203                              
 PSCOR                      Scalar 1139     R(4)            4           scalar   COM                                                
 PSINCR                     Scalar 1136     R(4)            4     1     2000     COM                                                
 QFC                        Scalar 1128     R(4)            4     1     255      COM              1234                              
 QMARK                      Scalar 1137     R(4)            4     1     2000     COM              1211,1243,1261,1268               
 QOB                        Scalar 1128     R(4)            4     1     255      COM              1221,1251,1256,1257,1267          
 QQM                        Scalar 1128     R(4)            4     1     255      COM              1188,1189,1195,1230,1268          
 QRC                        Scalar 1128     R(4)            4     1     255      COM              1238,1270                         
 QS                         Local  1158     R(4)            4           scalar                    1256                              
 R                          Scalar 1143     R(4)            4           scalar   COM                                                
 RADPC                      Scalar 1141     R(4)            4           scalar   COM                                                
 RV                         Scalar 1143     R(4)            4           scalar   COM                                                
 SDMP                       Local  1151     L(4)            4           scalar                    1178,1182,1194,1200               
 SDMQ                       Local  1151     L(4)            4           scalar                    1181,1188,1265                    
 SDMT                       Local  1151     L(4)            4           scalar                    1180,1186,1195,1247               
 SDMZ                       Local  1151     L(4)            4           scalar                    1179,1184,1194,1240               
 SEQLP                      Dummy  1115     R(4)            4           scalar   ARG,INOUT        1166,1169,1170,1174               
 SEQN                       Scalar 1132     R(4)            4     1     2000     COM              1169                              
 SHELL                      Subr   1217                                                           1217                              
 SID                        Scalar 1121     CHAR            8     1     999      COM                                                

Page 39          Source Listing                  CHANGE
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SINGLE                     Dummy  1115     L(4)            4           scalar   ARG,INOUT        1167,1168,1172                    
 SORT                       Subr   1218                                                           1218,1219,1220,1221,1222,1223,1224
                                                                                                  ,1225,1226,1227,1228,1229,1230,123
                                                                                                  1,1232,1233,1234,1235,1236,1237,12
                                                                                                  38,1239                           
 SQN                        Scalar 1122     R(4)            4     1     999      COM                                                
 STN                        Common 1140                                 4                                                           
 STN                        Scalar 1132     CHAR            8     1     2000     COM                                                
 T0                         Scalar 1143     R(4)            4           scalar   COM              1254,1257                         
 T1                         Scalar 1138     R(4)            4           scalar   COM                                                
 TCBEST                     Scalar 1138     R(4)            4     1     2        COM                                                
 TCOR                       Scalar 1138     R(4)            4     1     2        COM                                                
 TD                         Local  1254     R(4)            4           scalar                    1254,1256                         
 TDFC                       Scalar 1127     R(4)            4     1     255      COM              1239                              
 TDO                        Scalar 1127     R(4)            4     1     255      COM              1220,1252,1254                    
 TEST                       Scalar 1144     L(4)            4           scalar   COM              1194                              
 TESTS                      Common 1144                                 4                                                           
 TFC                        Scalar 1126     R(4)            4     1     255      COM              1233                              
 TOB                        Scalar 1126     R(4)            4     1     255      COM              1219,1249,1254,1257               
 TQM                        Scalar 1126     R(4)            4     1     255      COM              1186,1187,1194,1229,1261          
 TRC                        Scalar 1126     R(4)            4     1     255      COM              1237,1263                         
 TSCOR                      Scalar 1139     R(4)            4           scalar   COM                                                
 TT                         Scalar 1142     R(4)            4           scalar   COM                                                
 TVO                        Scalar 1127     R(4)            4     1     255      COM              1226,1257,1259                    
 VTPPC                      Scalar 1141     R(4)            4           scalar   COM                                                
 WBLOCKS                    Subr   1167                                                           1167,1171                         
 XDR                        Scalar 1131     R(4)            4     1     255      COM              1225                              
 XMA                        Scalar 1141     R(4)            4           scalar   COM                                                
 XMI                        Scalar 1141     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 1145     R(4)            4           scalar   COM                                                
 XOB                        Scalar 1121     R(4)            4     1     999      COM                                                
 YDR                        Scalar 1131     R(4)            4     1     255      COM              1224                              
 YMA                        Scalar 1141     R(4)            4           scalar   COM                                                
 YMI                        Scalar 1141     R(4)            4           scalar   COM                                                
 YOB                        Scalar 1121     R(4)            4     1     999      COM                                                
 ZCBEST                     Scalar 1138     R(4)            4     1     2        COM                                                
 ZCOR                       Scalar 1138     R(4)            4     1     2        COM                                                
 ZFC                        Scalar 1125     R(4)            4     1     255      COM              1205,1232                         
 ZOB                        Scalar 1125     R(4)            4     1     255      COM              1218,1242                         
 ZQM                        Scalar 1125     R(4)            4     1     255      COM              1184,1185,1194,1228,1243          
 ZRC                        Scalar 1125     R(4)            4     1     255      COM              1236,1245                         
 ZSCOR                      Scalar 1139     R(4)            4           scalar   COM              1205                              

Page 40          Source Listing                  CHANGE
2017-04-18 11:07                                 cqcbufr.f

   1281 
   1282 C******************************************************************
   1283 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1284 C
   1285 C SUBPROGRAM: CHDIST
   1286 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   1287 C
   1288 C ABSTRACT: COMPUTES CHORD LENGTH DISTANCE FROM A FIXED POINT TO AN
   1289 C   ARRAY OF POINTS USING THE FORMULA: S**2/2 = 1 - COS(Y1-Y2) +
   1290 C   COS(Y1)*COS(Y2)*(1-COS(X1-X2)).  ALSO THE DIRECTION OF EACH POINT
   1291 C   IS COMPUTED WITH RESPECT TO THE FIXED POINT AND RETURNED AS WELL.
   1292 C
   1293 C PROGRAM HISTORY LOG:
   1294 C 1990-11-06  J. Woollen  Original author.
   1295 C
   1296 C USAGE:    CALL CHDIST(X1,Y1,X2,Y2,DIST,DIRN,NP)
   1297 C   INPUT ARGUMENTS:
   1298 C     X1         - X-COORDINATE  (LONGITUDE) OF FIXED POINT
   1299 C     Y1         - Y-COORDINATE  (LATITUDE ) OF FIXED POINT
   1300 C     X2         - X-COORDINATES (LONGITUDE) FOR SET OF POINTS
   1301 C     Y2         - Y-COORDINATES (LATITUDE ) FOR SET OF POINTS
   1302 C     NP         - NUMBER OF OUTPUTS REQUESTED
   1303 C
   1304 C   OUTPUT ARGUMENTS:
   1305 C     DIST       - CHORD LENGTH DISTANCES FROM FIXED POINT (KM)
   1306 C     DIRN       - DIRECTION FROM FIXED POINT (DEG)
   1307 C
   1308 C REMARKS: NONE.
   1309 C
   1310 C ATTRIBUTES:
   1311 C   LANGUAGE: FORTRAN 90
   1312 C   MACHINE:  NCEP WCOSS
   1313 C
   1314 C$$$
   1315       SUBROUTINE CHDIST(X1,Y1,X2,Y2,DIST,DIRN,NP)
   1316 
   1317       DIMENSION  X2(NP),Y2(NP),DIST(NP),DIRN(NP)
   1318 
   1319       DATA PI180/.0174532 /,RADE/6371./
   1320 
   1321 C----------------------------------------------------------------------
   1322 C----------------------------------------------------------------------
   1323 
   1324       IF(NP.EQ.0) RETURN
   1325 
   1326 C  COMPUTE THE DISTANCE
   1327 C  --------------------
   1328 
   1329       DO 10 I=1,NP
   1330       COSY1 = COS(Y1*PI180)
   1331       COSY2 = COS(Y2(I)*PI180)
   1332       COSDX = COS((X1-X2(I))*PI180)
   1333       COSDY = COS((Y1-Y2(I))*PI180)
   1334       S = 1.0-COSDY+COSY1*COSY2*(1.0-COSDX)
   1335       S = SQRT(2.*S)
   1336       IF(S.LE..002) S = 0.
   1337       DIST(I) = S*RADE

Page 41          Source Listing                  CHDIST
2017-04-18 11:07                                 cqcbufr.f

   1338 10    CONTINUE
   1339 
   1340 C  COMPUTE DIRECTIONS
   1341 C  ------------------
   1342 
   1343       DO 20 I=1,NP
   1344       DX = (X2(I)-X1)*COS(Y1)
   1345       DY = (Y2(I)-Y1)
   1346       IF(DX.GT.0.) THEN
   1347          DIRN(I) = 0. + ATAN(DY/DX)/PI180
   1348       ELSE IF(DX.LT.0.) THEN
   1349          DIRN(I) = 180. + ATAN(DY/DX)/PI180
   1350       ELSE IF(DX.EQ.0.) THEN
   1351          DIRN(I) = SIGN(90.,DY)
   1352       ENDIF
   1353       IF(DIRN(I).LT.0.) DIRN(I) = DIRN(I) + 360.
   1354 20    CONTINUE
   1355 
   1356 C      DO 30 I=1,NP
   1357 C30    PRINT*,DIST(I),DIRN(I)
   1358 
   1359       RETURN
   1360       END


ENTRY POINTS

  Name               
                     
 chdist_             

Page 42          Source Listing                  CHDIST
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1338                                                           1329                              
 20                         Label  1354                                                           1343                              
 ATAN                       Func   1347                                 scalar                    1347,1349                         
 CHDIST                     Subr   1315                                                                                             
 COS                        Func   1330                                 scalar                    1330,1331,1332,1333,1344          
 COSDX                      Local  1332     R(4)            4           scalar                    1332,1334                         
 COSDY                      Local  1333     R(4)            4           scalar                    1333,1334                         
 COSY1                      Local  1330     R(4)            4           scalar                    1330,1334                         
 COSY2                      Local  1331     R(4)            4           scalar                    1331,1334                         
 DIRN                       Dummy  1315     R(4)            4     1     0        ARG,INOUT        1347,1349,1351,1353               
 DIST                       Dummy  1315     R(4)            4     1     0        ARG,INOUT        1337                              
 DX                         Local  1344     R(4)            4           scalar                    1344,1346,1347,1348,1349,1350     
 DY                         Local  1345     R(4)            4           scalar                    1345,1347,1349,1351               
 I                          Local  1329     I(4)            4           scalar                    1329,1331,1332,1333,1337,1343,1344
                                                                                                  ,1345,1347,1349,1351,1353         
 NP                         Dummy  1315     I(4)            4           scalar   ARG,INOUT        1317,1324,1329,1343               
 PI180                      Local  1319     R(4)            4           scalar                    1319,1330,1331,1332,1333,1347,1349
 RADE                       Local  1319     R(4)            4           scalar                    1319,1337                         
 S                          Local  1334     R(4)            4           scalar                    1334,1335,1336,1337               
 SIGN                       Func   1351                                 scalar                    1351                              
 SQRT                       Func   1335                                 scalar                    1335                              
 X1                         Dummy  1315     R(4)            4           scalar   ARG,INOUT        1332,1344                         
 X2                         Dummy  1315     R(4)            4     1     0        ARG,INOUT        1332,1344                         
 Y1                         Dummy  1315     R(4)            4           scalar   ARG,INOUT        1330,1333,1344,1345               
 Y2                         Dummy  1315     R(4)            4     1     0        ARG,INOUT        1331,1333,1345                    

Page 43          Source Listing                  CHDIST
2017-04-18 11:07                                 cqcbufr.f

   1361 
   1362 C**********************************************************************
   1363 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1364 C                .      .    .                                       .
   1365 C SUBPROGRAM:    CHECKIT     CONFIRMS CORRECTIONS
   1366 C   PRGMMR: W. COLLINS       ORG: NP20       DATE: 1997-03-18
   1367 C
   1368 C ABSTRACT: Confirms whether or not a correction is acceptable.
   1369 C   The array GOOD has members for each check, as described below,
   1370 C   telling whether the check value is acceptable or not after the
   1371 C   test correction.
   1372 C
   1373 C PROGRAM HISTORY LOG:
   1374 C 1997-03-18  W. Collins  Original author.
   1375 C
   1376 C USAGE:    CALL CHECKIT(IER,ZC1,RIZ1,RVZ1,RHZ1,RTZ1,ZC2,RIZ2,RVZ2,
   1377 C                        RHZ2,RTZ2,TC1,RIT1,RVT1,RHT1,RTT1,TC2,RIT2,
   1378 C                        RVT2,RHT2,RTT2,S1,S2,S3,B1,B2,B3,GOOD)
   1379 C
   1380 C   INPUT ARGUMENT LIST:
   1381 C     IER      - ERROR TYPE
   1382 C                =  1 HEIGHT
   1383 C                =  2 TEMPERATURE
   1384 C                =  3 Z AND T
   1385 C                =  7 Z AT TWO LEVELS
   1386 C                =  8 T AT TWO LEVELS
   1387 C                =  9 Z AT LOWER, T AT UPPER LEVEL
   1388 C                = 10 T AT LOWER, Z AT UPPER LEVEL
   1389 C                = 33 Z AND T WITH COMPENSATION; NO CHECK ON HYDROSTATIC
   1390 C     ZC1      -
   1391 C     RIZ1     -
   1392 C     RVZ1     -
   1393 C     RHZ1     -
   1394 C     RTZ1     -
   1395 C     ZC2      -
   1396 C     RIZ2     -
   1397 C     RVZ2     -
   1398 C     RHZ2     -
   1399 C     RTZ2     -
   1400 C     TC1      -
   1401 C     RIT1     -
   1402 C     RVT1     -
   1403 C     RHT1     -
   1404 C     RTT1     -
   1405 C     TC2      -
   1406 C     RIT2     -
   1407 C     RVT2     -
   1408 C     RHT2     -
   1409 C     RTT2     -
   1410 C     S1       -
   1411 C     S2       -
   1412 C     S3       -
   1413 C     B1       -
   1414 C     B2       -
   1415 C     B3       -
   1416 C
   1417 C   OUTPUT ARGUMENT LIST:

Page 44          Source Listing                  CHDIST
2017-04-18 11:07                                 cqcbufr.f

   1418 C     GOOD     - TELLS WHICH RESIDUALS ARE MADE SMALLER BY CORRECTION
   1419 C            GOOD(CHECK,LEVEL,VARIABLE)
   1420 C              CHECK:
   1421 C              1 - INCREMENT
   1422 C              2 - VERTICAL
   1423 C              3 - HORIZONTAL
   1424 C              4 - HYDROSTATIC
   1425 C              5 - TEMPORAL
   1426 C              6 - ALL
   1427 C              LEVEL:
   1428 C              1 - LOWER
   1429 C              2 - UPPER
   1430 C              VARIABLE:
   1431 C              1 - HEIGHT
   1432 C              2 - TEMPERATURE
   1433 C
   1434 C   OUTPUT FILES:
   1435 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   1436 C
   1437 C REMARKS: NONE.
   1438 C
   1439 C ATTRIBUTES:
   1440 C   LANGUAGE: FORTRAN 90
   1441 C   MACHINE:  NCEP WCOSS
   1442 C
   1443 C$$$
   1444 
   1445       SUBROUTINE CHECKIT(IER,ZC1,RIZ1,RVZ1,RHZ1,RTZ1,ZC2,RIZ2,RVZ2,
   1446      &                   RHZ2,RTZ2,TC1,RIT1,RVT1,RHT1,RTT1,TC2,RIT2,
   1447      &                   RVT2,RHT2,RTT2,S1,S2,S3,B1,B2,B3,GOOD)
   1448 
   1449       REAL(8) BMISS
   1450 
   1451       COMMON /TESTS/   TEST
   1452       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   1453 
   1454       LOGICAL          TEST
   1455       REAL  ZC(2),TC(2),RIZ(2),RIT(2),RVZ(2),RVT(2),
   1456      &      RHZ(2),RHT(2),RTZ(2),RTT(2),S(3),B(3)
   1457       LOGICAL GOOD(6,2,2)
   1458 
   1459       ZC(1)  = ZC1
   1460       ZC(2)  = ZC2
   1461       TC(1)  = TC1
   1462       TC(2)  = TC2
   1463       RIZ(1) = RIZ1
   1464       RIZ(2) = RIZ2
   1465       RIT(1) = RIT1
   1466       RIT(2) = RIT2
   1467       RVZ(1) = RVZ1
   1468       RVZ(2) = RVZ2
   1469       RVT(1) = RVT1
   1470       RVT(2) = RVT2
   1471       RHZ(1) = RHZ1
   1472       RHZ(2) = RHZ2
   1473       RHT(1) = RHT1
   1474       RHT(2) = RHT2

Page 45          Source Listing                  CHECKIT
2017-04-18 11:07                                 cqcbufr.f

   1475       RTZ(1) = RTZ1
   1476       RTZ(2) = RTZ2
   1477       RTT(1) = RTT1
   1478       RTT(2) = RTT2
   1479       S(1)   = S1
   1480       S(2)   = S2
   1481       S(3)   = S3
   1482       B(1)   = B1
   1483       B(2)   = B2
   1484       B(3)   = B3
   1485 
   1486 
   1487       IF(IER.LE.3) THEN
   1488         LEV = 1
   1489       ELSE
   1490         LEV = 2
   1491       ENDIF
   1492 
   1493       DO K=1,2
   1494         DO J=1,2
   1495           DO I=1,6
   1496             GOOD(I,J,K) = .FALSE.
   1497           ENDDO
   1498         ENDDO
   1499       ENDDO
   1500 
   1501 C  EVALUATE CORRECTIONS FOR INCREMENT, VERTICAL, HORIZONTAL 
   1502 C  TEMPORAL RESIDUALS
   1503 C  --------------------------------------------------------
   1504 
   1505       DO L=1,LEV
   1506         IF(ABS(RIZ(L)+ZC(L)).LT.ABS(RIZ(L)) .OR. RIZ(L).EQ.XMISS)
   1507      &     GOOD(1,L,1) = .TRUE.
   1508         IF(ABS(RIT(L)+TC(L)).LT.ABS(RIT(L)) .OR. RIT(L).EQ.XMISS)
   1509      &     GOOD(1,L,2) = .TRUE.
   1510         IF(ABS(RVZ(L)+ZC(L)).LT.ABS(RVZ(L)) .OR. RVZ(L).EQ.XMISS)
   1511      &     GOOD(2,L,1) = .TRUE.
   1512         IF(ABS(RVT(L)+TC(L)).LT.ABS(RVT(L)) .OR. RVT(L).EQ.XMISS)
   1513      &     GOOD(2,L,2) = .TRUE.
   1514         IF(ABS(RHZ(L)+ZC(L)).LT.ABS(RHZ(L)) .OR. RHZ(L).EQ.XMISS)
   1515      &     GOOD(3,L,1) = .TRUE.
   1516         IF(ABS(RHT(L)+TC(L)).LT.ABS(RHT(L)) .OR. RHT(L).EQ.XMISS)
   1517      &     GOOD(3,L,2) = .TRUE.
   1518         IF(ABS(RTZ(L)+ZC(L)).LT.ABS(RTZ(L)) .OR. RTZ(L).EQ.XMISS)
   1519      &     GOOD(5,L,1) = .TRUE.
   1520         IF(ABS(RTT(L)+TC(L)).LT.ABS(RTT(L)) .OR. RTT(L).EQ.XMISS)
   1521      &     GOOD(5,L,2) = .TRUE.
   1522       ENDDO
   1523 
   1524 C  EVALUATE CORRECTIONS FOR HYDROSTATIC RESIDUALS
   1525 C  AND FOR OVERALL
   1526 C  ----------------------------------------------
   1527 
   1528       IF(IER.EQ.1) THEN
   1529         IF((ABS(S(1)+ZC(1)).LE.ABS(S(1)) .OR. S(1).EQ.XMISS) .AND.
   1530      &     (ABS(S(2)-ZC(1)).LE.ABS(S(2)) .OR. S(2).EQ.XMISS))
   1531      &     GOOD(4,1,1) = .TRUE.

Page 46          Source Listing                  CHECKIT
2017-04-18 11:07                                 cqcbufr.f

   1532         IF((GOOD(1,1,1) .OR. GOOD(2,1,1)) .AND. GOOD(3,1,1) .AND.
   1533      &      GOOD(4,1,1) .AND. GOOD(5,1,1)) GOOD(6,1,1) = .TRUE.
   1534 
   1535       ELSEIF(IER.EQ.2) THEN
   1536         IF((ABS(S(1)-B(1)*TC(1)).LE.ABS(S(1)) .OR. S(1).EQ.XMISS) .AND.
   1537      &     (ABS(S(2)-B(2)*TC(1)).LE.ABS(S(2)) .OR. S(2).EQ.XMISS))
   1538      &     GOOD(4,1,2) = .TRUE.
   1539         IF(GOOD(1,1,2) .AND. GOOD(2,1,2) .AND. GOOD(3,1,2) .AND.
   1540      &      GOOD(4,1,2) .AND. GOOD(5,1,2)) GOOD(6,1,2) = .TRUE.
   1541 
   1542       ELSEIF(IER.EQ.3) THEN
   1543         IF((ABS(S(1)+ZC(1)-B(1)*TC(1)).LE.ABS(S(1)) .OR.
   1544      &      S(1).EQ.XMISS) .AND.
   1545      &     (ABS(S(2)-ZC(1)-B(2)*TC(1)).LE.ABS(S(2)) .OR.
   1546      &      S(2).EQ.XMISS))  THEN
   1547           GOOD(4,1,1) = .TRUE.
   1548           GOOD(4,1,2) = .TRUE.
   1549         ENDIF
   1550         IF((GOOD(1,1,1) .OR. GOOD(2,1,1)) .AND. GOOD(3,1,1) .AND.
   1551      &      GOOD(4,1,1) .AND. GOOD(5,1,1)) GOOD(6,1,1) = .TRUE.
   1552         IF(GOOD(1,1,2) .AND. GOOD(2,1,2) .AND. GOOD(3,1,2) .AND.
   1553      &      GOOD(4,1,2) .AND. GOOD(5,1,2)) GOOD(6,1,2) = .TRUE.
   1554 
   1555       ELSEIF(IER.EQ.33) THEN
   1556         IF((GOOD(1,1,1) .OR. GOOD(2,1,1)) .AND. GOOD(3,1,1)
   1557      &     .AND. GOOD(5,1,1)) GOOD(6,1,1) = .TRUE.
   1558         IF(GOOD(1,1,2) .AND. GOOD(2,1,2) .AND. GOOD(3,1,2)
   1559      &     .AND. GOOD(5,1,2)) GOOD(6,1,2) = .TRUE.
   1560 
   1561       ELSEIF(IER.EQ.7) THEN
   1562         IF((ABS(S(1)+ZC(1)).LE.ABS(S(1)) .OR. S(1).EQ.XMISS) .AND.
   1563      &     (ABS(S(2)+ZC(2)-ZC(1)).LE.ABS(S(2)) .OR. S(2).EQ.XMISS) .AND.
   1564      &      ABS(S(3)-ZC(2)).LE.ABS(S(3))) THEN
   1565           GOOD(4,1,1) = .TRUE.
   1566           GOOD(4,2,1) = .TRUE.
   1567         ENDIF
   1568         IF((GOOD(1,1,1) .OR. GOOD(2,1,1)) .AND. GOOD(3,1,1) .AND.
   1569      &      GOOD(4,1,1) .AND. GOOD(5,1,1)) GOOD(6,1,1) = .TRUE.
   1570         IF((GOOD(1,2,1) .OR. GOOD(2,2,1)) .AND. GOOD(3,2,1) .AND.
   1571      &      GOOD(4,2,1) .AND. GOOD(5,2,1)) GOOD(6,2,1) = .TRUE.
   1572 
   1573       ELSEIF(IER.EQ.8) THEN
   1574         IF((ABS(S(1)-B(1)*TC(1)).LE.ABS(S(1)) .OR. S(1).EQ.XMISS) .AND.
   1575      &     (ABS(S(2)-B(2)*(TC(1)+TC(2))).LE.ABS(S(2)) .OR.
   1576      &      S(2).EQ.XMISS) .AND.
   1577      &     (ABS(S(3)-B(3)*TC(2)).LE.ABS(S(3)) .OR. S(3).EQ.XMISS)) THEN
   1578           GOOD(4,1,2) = .TRUE.
   1579           GOOD(4,2,2) = .TRUE.
   1580         ENDIF
   1581         IF(GOOD(1,1,2) .AND. GOOD(2,1,2) .AND. GOOD(3,1,2) .AND.
   1582      &      GOOD(4,1,2) .AND. GOOD(5,1,2)) GOOD(6,1,2) = .TRUE.
   1583         IF(GOOD(1,2,2) .AND. GOOD(2,2,2) .AND. GOOD(3,2,2) .AND.
   1584      &      GOOD(4,2,2) .AND. GOOD(5,2,2)) GOOD(6,2,2) = .TRUE.
   1585 
   1586       ELSEIF(IER.EQ.9) THEN
   1587         IF((ABS(S(1)+ZC(1)).LE.ABS(S(1)) .OR. S(1).EQ.XMISS) .AND.
   1588      &     (ABS(S(2)-ZC(1)-B(2)*TC(2)).LE.ABS(S(2)) .OR.

Page 47          Source Listing                  CHECKIT
2017-04-18 11:07                                 cqcbufr.f

   1589      &      S(2).EQ.XMISS) .AND.
   1590      &     (ABS(S(3)-B(2)*TC(2)).LE.ABS(S(3)) .OR. S(3).EQ.XMISS)) THEN
   1591           GOOD(4,1,1) = .TRUE.
   1592           GOOD(4,2,2) = .TRUE.
   1593         ENDIF
   1594         IF((GOOD(1,1,1) .OR. GOOD(2,1,1)) .AND. GOOD(3,1,1) .AND.
   1595      &      GOOD(4,1,1) .AND. GOOD(5,1,1)) GOOD(6,1,1) = .TRUE.
   1596         IF(GOOD(1,2,2) .AND. GOOD(2,2,2) .AND. GOOD(3,2,2) .AND.
   1597      &      GOOD(4,2,2) .AND. GOOD(5,2,2)) GOOD(6,2,2) = .TRUE.
   1598 
   1599       ELSEIF(IER.EQ.10) THEN
   1600         IF((ABS(S(1)-B(1)*TC(1)).LE.ABS(S(1)) .OR. S(1).EQ.XMISS) .AND.
   1601      &     (ABS(S(2)+ZC(2)-B(2)*TC(1)).LE.ABS(S(2)) .OR.
   1602      &      S(2).EQ.XMISS) .AND.
   1603      &     (ABS(S(3)-ZC(2)).LE.ABS(S(3)) .OR. S(3).EQ.XMISS)) THEN
   1604           GOOD(4,1,2) = .TRUE.
   1605           GOOD(4,2,1) = .TRUE.
   1606         ENDIF
   1607         IF(GOOD(1,1,2) .AND. GOOD(2,1,2) .AND. GOOD(3,1,2) .AND.
   1608      &      GOOD(4,1,2) .AND. GOOD(5,1,2)) GOOD(6,1,2) = .TRUE.
   1609         IF((GOOD(1,2,1) .OR. GOOD(2,2,1)) .AND. GOOD(3,2,1) .AND.
   1610      &      GOOD(4,2,1) .AND. GOOD(5,2,1)) GOOD(6,2,1) = .TRUE.
   1611       ENDIF
   1612 
   1613       IF(TEST) WRITE(60,500) (((GOOD(I,J,K),I=1,6),J=1,2),K=1,2)
   1614   500 FORMAT(' CHECKIT--GOOD: ',4(2X,6L2))
   1615 
   1616       RETURN
   1617       END

Page 48          Source Listing                  CHECKIT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 checkit_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  1614                                                           1613                              
 ABS                        Func   1506                                 scalar                    1506,1508,1510,1512,1514,1516,1518
                                                                                                  ,1520,1529,1530,1536,1537,1543,154
                                                                                                  5,1562,1563,1564,1574,1575,1577,15
                                                                                                  87,1588,1590,1600,1601,1603       
 B                          Local  1456     R(4)            4     1     3                         1482,1483,1484,1536,1537,1543,1545
                                                                                                  ,1574,1575,1577,1588,1590,1600,160
                                                                                                  1                                 
 B1                         Dummy  1447     R(4)            4           scalar   ARG,INOUT        1482                              
 B2                         Dummy  1447     R(4)            4           scalar   ARG,INOUT        1483                              
 B3                         Dummy  1447     R(4)            4           scalar   ARG,INOUT        1484                              
 BMISS                      Scalar 1449     R(8)            8           scalar   COM                                                
 BUFRLIB_MISSING            Common 1452                                 16                                                          
 CHECKIT                    Subr   1445                                                                                             
 GOOD                       Dummy  1447     L(4)            4     3     24       ARG,INOUT        1496,1507,1509,1511,1513,1515,1517
                                                                                                  ,1519,1521,1531,1532,1533,1538,153
                                                                                                  9,1540,1547,1548,1550,1551,1552,15
                                                                                                  53,1556,1557,1558,1559,1565,1566,1
                                                                                                  568,1569,1570,1571,1578,1579,1581,
                                                                                                  1582,1583,1584,1591,1592,1594,1595
                                                                                                  ,1596,1597,1604,1605,1607,1608,160
                                                                                                  9,1610,1613                       
 I                          Local  1495     I(4)            4           scalar                    1495,1496,1613                    
 IER                        Dummy  1445     I(4)            4           scalar   ARG,INOUT        1487,1528,1535,1542,1555,1561,1573
                                                                                                  ,1586,1599                        
 IMISS                      Scalar 1452     I(4)            4           scalar   COM                                                
 J                          Local  1494     I(4)            4           scalar                    1494,1496,1613                    
 K                          Local  1493     I(4)            4           scalar                    1493,1496,1613                    
 L                          Local  1505     I(4)            4           scalar                    1505,1506,1507,1508,1509,1510,1511
                                                                                                  ,1512,1513,1514,1515,1516,1517,151
                                                                                                  8,1519,1520,1521                  
 LEV                        Local  1488     I(4)            4           scalar                    1488,1490,1505                    
 RHT                        Local  1456     R(4)            4     1     2                         1473,1474,1516                    
 RHT1                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1473                              
 RHT2                       Dummy  1447     R(4)            4           scalar   ARG,INOUT        1474                              
 RHZ                        Local  1456     R(4)            4     1     2                         1471,1472,1514                    
 RHZ1                       Dummy  1445     R(4)            4           scalar   ARG,INOUT        1471                              
 RHZ2                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1472                              
 RIT                        Local  1455     R(4)            4     1     2                         1465,1466,1508                    
 RIT1                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1465                              
 RIT2                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1466                              
 RIZ                        Local  1455     R(4)            4     1     2                         1463,1464,1506                    
 RIZ1                       Dummy  1445     R(4)            4           scalar   ARG,INOUT        1463                              
 RIZ2                       Dummy  1445     R(4)            4           scalar   ARG,INOUT        1464                              

Page 49          Source Listing                  CHECKIT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RTT                        Local  1456     R(4)            4     1     2                         1477,1478,1520                    
 RTT1                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1477                              
 RTT2                       Dummy  1447     R(4)            4           scalar   ARG,INOUT        1478                              
 RTZ                        Local  1456     R(4)            4     1     2                         1475,1476,1518                    
 RTZ1                       Dummy  1445     R(4)            4           scalar   ARG,INOUT        1475                              
 RTZ2                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1476                              
 RVT                        Local  1455     R(4)            4     1     2                         1469,1470,1512                    
 RVT1                       Dummy  1446     R(4)            4           scalar   ARG,INOUT        1469                              
 RVT2                       Dummy  1447     R(4)            4           scalar   ARG,INOUT        1470                              
 RVZ                        Local  1455     R(4)            4     1     2                         1467,1468,1510                    
 RVZ1                       Dummy  1445     R(4)            4           scalar   ARG,INOUT        1467                              
 RVZ2                       Dummy  1445     R(4)            4           scalar   ARG,INOUT        1468                              
 S                          Local  1456     R(4)            4     1     3                         1479,1480,1481,1529,1530,1536,1537
                                                                                                  ,1543,1544,1545,1546,1562,1563,156
                                                                                                  4,1574,1575,1576,1577,1587,1588,15
                                                                                                  89,1590,1600,1601,1602,1603       
 S1                         Dummy  1447     R(4)            4           scalar   ARG,INOUT        1479                              
 S2                         Dummy  1447     R(4)            4           scalar   ARG,INOUT        1480                              
 S3                         Dummy  1447     R(4)            4           scalar   ARG,INOUT        1481                              
 TC                         Local  1455     R(4)            4     1     2                         1461,1462,1508,1512,1516,1520,1536
                                                                                                  ,1537,1543,1545,1574,1575,1577,158
                                                                                                  8,1590,1600,1601                  
 TC1                        Dummy  1446     R(4)            4           scalar   ARG,INOUT        1461                              
 TC2                        Dummy  1446     R(4)            4           scalar   ARG,INOUT        1462                              
 TEST                       Scalar 1451     L(4)            4           scalar   COM              1613                              
 TESTS                      Common 1451                                 4                                                           
 XMISS                      Scalar 1452     R(4)            4           scalar   COM              1506,1508,1510,1512,1514,1516,1518
                                                                                                  ,1520,1529,1530,1536,1537,1544,154
                                                                                                  6,1562,1563,1574,1576,1577,1587,15
                                                                                                  89,1590,1600,1602,1603            
 ZC                         Local  1455     R(4)            4     1     2                         1459,1460,1506,1510,1514,1518,1529
                                                                                                  ,1530,1543,1545,1562,1563,1564,158
                                                                                                  7,1588,1601,1603                  
 ZC1                        Dummy  1445     R(4)            4           scalar   ARG,INOUT        1459                              
 ZC2                        Dummy  1445     R(4)            4           scalar   ARG,INOUT        1460                              

Page 50          Source Listing                  CHECKIT
2017-04-18 11:07                                 cqcbufr.f

   1618 
   1619 C**********************************************************************
   1620 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1621 C                .      .    .                                       .
   1622 C SUBPROGRAM:    CHKTMP      CHECK TEMPORAL CHECK FOR BAD INFLUENCE
   1623 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1998-02-11
   1624 C
   1625 C ABSTRACT: CHECK TEMPORAL CHECK FOR THE INFLUENCE OF BAD DATA.  DO
   1626 C   NOT USE DATA AT OFF-TIMES IF THE INCREMENT THERE EXCEEDS 3.5
   1627 C   STANDARD DEVIATIONS
   1628 C
   1629 C PROGRAM HISTORY LOG:
   1630 C 1992-05-26  W. Collins  Original author.
   1631 C
   1632 C USAGE:    CALL CHKTMP(A,C,R,ICK)
   1633 C   INPUT ARGUMENT LIST:
   1634 C     A        - INCREMENT AT T-12 OR T-24 HOURS
   1635 C     C        - INCREMENT AT T+12 OR T+24 HOURS
   1636 C     R        - PROPORTIONAL TO LIMIT
   1637 C
   1638 C   OUTPUT ARGUMENT LIST:
   1639 C     ICK      - INDICATOR OF INFLUENCE OF BAD DATA:
   1640 C              = 0 INFLUENCING STATIONS OK
   1641 C              = 1 INFLUENCING STATION QUENSTIONABLE
   1642 C
   1643 C REMARKS: NONE.
   1644 C
   1645 C ATTRIBUTES:
   1646 C   LANGUAGE: FORTRAN 90
   1647 C   MACHINE:  NCEP WCOSS
   1648 C
   1649 C$$$
   1650 
   1651       SUBROUTINE CHKTMP(A,C,R,ICK)
   1652       IF(ABS(A).GT.0.35*R .OR. ABS(C).GT.0.35*R) THEN
   1653         ICK = 1
   1654       ELSE
   1655         ICK = 0
   1656       ENDIF
   1657       RETURN
   1658       END

Page 51          Source Listing                  CHKTMP
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 chktmp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  1651     R(4)            4           scalar   ARG,INOUT        1652                              
 ABS                        Func   1652                                 scalar                    1652                              
 C                          Dummy  1651     R(4)            4           scalar   ARG,INOUT        1652                              
 CHKTMP                     Subr   1651                                                                                             
 ICK                        Dummy  1651     I(4)            4           scalar   ARG,INOUT        1653,1655                         
 R                          Dummy  1651     R(4)            4           scalar   ARG,INOUT        1652                              

Page 52          Source Listing                  CHKTMP
2017-04-18 11:07                                 cqcbufr.f

   1659 
   1660 C**********************************************************************
   1661 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1662 C                .      .    .                                       .
   1663 C SUBPROGRAM:    CKPS        CHECK FOR SURFACE PRESSURE = 0.
   1664 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   1665 C
   1666 C ABSTRACT: Check for surface pressure = 0.
   1667 C
   1668 C PROGRAM HISTORY LOG:
   1669 C 1997-03-18  W. Collins  Original author.
   1670 C
   1671 C USAGE:    CALL CKPS
   1672 C   OUTPUT FILES:
   1673 C     UNIT 06  - PRINTOUT
   1674 C
   1675 C REMARKS: NONE.
   1676 C
   1677 C ATTRIBUTES:
   1678 C   LANGUAGE: FORTRAN 90
   1679 C   MACHINE:  NCEP WCOSS
   1680 C
   1681 C$$$
   1682 
   1683       SUBROUTINE CKPS
   1684       PARAMETER (NST=999)
   1685 
   1686       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   1687      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   1688      &                 NEV, ISF(NST), NLVM, NLVW
   1689       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   1690      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   1691      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   1692      &                 TDO(255), TDFC(255),TVO(255),
   1693      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   1694      &                 CAT(255), IND(255), LEVTYP(255),
   1695      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   1696      &                 YDR(255), XDR(255)
   1697       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   1698      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   1699       COMMON /STN/     IS
   1700       CHARACTER*8 SID
   1701       LOGICAL PRNT
   1702 
   1703       IF(ISC.NE.1) RETURN
   1704 
   1705 C  CHECK FOR SURFACE PRESSURE = 0.
   1706 C  -------------------------------
   1707 
   1708       DO LL=1,NLV
   1709         L = LL
   1710         IF(CAT(L).EQ.0) GOTO 10
   1711       ENDDO
   1712       RETURN
   1713    10 CONTINUE
   1714       IF(POB(L).NE.0.) RETURN
   1715 

Page 53          Source Listing                  CKPS
2017-04-18 11:07                                 cqcbufr.f

   1716 C  HAVE FOUND A SURFACE PRESSURE = 0.
   1717 C  NOW LOOK FOR THE FIRST COMPLETE LEVEL ABOVE
   1718 C  -------------------------------------------
   1719 
   1720       WRITE(6,500) SID(IS)
   1721   500 FORMAT(' CKPS--SURFACE PRESSURE = 0. FOR ',A8)
   1722 
   1723       DO LL=L+1,NLV
   1724         LP = LL
   1725         IF(CAT(LL).EQ.1 .AND. LEVTYP(LL).LE.2) GOTO 20
   1726       ENDDO
   1727       RETURN
   1728    20 CONTINUE
   1729 
   1730 C  COMPLETE LEVEL FOUND ABOVE
   1731 C  SOLVE FOR GOOD VALUE OF SURFACE PRESSURE
   1732 C  ----------------------------------------
   1733 
   1734       CALL GETPS(PSL,ELV(IS),ZOB(LP),TOB(LP),POB(LP))
   1735 
   1736 C  SET POB(L) AND PS(IS) EQUAL TO THIS VALUE
   1737 C  -----------------------------------------
   1738 
   1739 C     POB(L) = PSL
   1740 C     PS(IS) = PSL
   1741 
   1742 C  SAVE AN EVENT
   1743 C  -------------
   1744 
   1745 C     CALL SEVENT(SID(IS),SQN(IS),L,240,POB(L),LEVTYP(L),4,POB(L),
   1746 C    &  POB(L),POB(L),1.,107,0.,0.,0.)
   1747 
   1748       RETURN
   1749       END

Page 54          Source Listing                  CKPS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 ckps_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1713                                                           1710                              
 20                         Label  1728                                                           1725                              
 500                        Label  1721                                                           1720                              
 ALLSND                     Common 1689                                 34512                                                       
 CAT                        Scalar 1694     R(4)            4     1     255      COM              1710,1725                         
 CKPS                       Subr   1683                                                                                             
 CQCPC                      Scalar 1698     R(4)            4           scalar   COM                                                
 DHR                        Scalar 1686     R(4)            4     1     999      COM                                                
 ELV                        Scalar 1687     R(4)            4     1     999      COM              1734                              
 GESPS                      Scalar 1695     R(4)            4     1     999      COM                                                
 GETPS                      Subr   1734                                                           1734                              
 HEADER                     Common 1686                                 35980                                                       
 HRDR                       Scalar 1695     R(4)            4     1     255      COM                                                
 IND                        Scalar 1694     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 1698     I(4)            4           scalar   COM                                                
 IS                         Scalar 1699     I(4)            4           scalar   COM              1720,1734                         
 ISC                        Scalar 1698     I(4)            4           scalar   COM              1703                              
 ISF                        Scalar 1688     I(4)            4     1     999      COM                                                
 ITP                        Scalar 1687     I(4)            4     1     999      COM                                                
 L                          Local  1709     I(4)            4           scalar                    1709,1710,1714,1723               
 LEVTYP                     Scalar 1694     I(4)            4     1     255      COM              1725                              
 LL                         Local  1708     I(4)            4           scalar                    1708,1709,1723,1724,1725          
 LMAND                      Scalar 1698     I(4)            4     1     22       COM                                                
 LP                         Local  1724     I(4)            4           scalar                    1724,1734                         
 LSFC                       Scalar 1698     I(4)            4           scalar   COM                                                
 LST                        Scalar 1695     I(4)            4     1     255      COM                                                
 MAND                       Scalar 1697     I(4)            4           scalar   COM                                                
 NEV                        Scalar 1688     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 1697     I(4)            4           scalar   COM                                                
 NLV                        Scalar 1687     I(4)            4           scalar   COM              1708,1723                         
 NLVM                       Scalar 1688     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 1688     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 1697     I(4)            4           scalar   COM                                                
 NST                        Param  1684     I(4)            4           scalar                    1686,1687,1688,1695               
 PARAMS                     Common 1697                                 148                                                         
 PFC                        Scalar 1689     R(4)            4     1     255      COM                                                
 POB                        Scalar 1689     R(4)            4     1     255      COM              1714,1734                         
 PQM                        Scalar 1689     R(4)            4     1     255      COM                                                
 PRC                        Scalar 1689     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 1698     L(4)            4           scalar   COM                                                
 PS                         Scalar 1695     R(4)            4     1     999      COM                                                
 PSL                        Local  1734     R(4)            4           scalar                    1734                              
 QFC                        Scalar 1693     R(4)            4     1     255      COM                                                
 QOB                        Scalar 1693     R(4)            4     1     255      COM                                                

Page 55          Source Listing                  CKPS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QQM                        Scalar 1693     R(4)            4     1     255      COM                                                
 QRC                        Scalar 1693     R(4)            4     1     255      COM                                                
 RADPC                      Scalar 1697     R(4)            4           scalar   COM                                                
 SID                        Scalar 1686     CHAR            8     1     999      COM              1720                              
 SQN                        Scalar 1687     R(4)            4     1     999      COM                                                
 STN                        Common 1699                                 4                                                           
 TDFC                       Scalar 1692     R(4)            4     1     255      COM                                                
 TDO                        Scalar 1692     R(4)            4     1     255      COM                                                
 TFC                        Scalar 1691     R(4)            4     1     255      COM                                                
 TOB                        Scalar 1691     R(4)            4     1     255      COM              1734                              
 TQM                        Scalar 1691     R(4)            4     1     255      COM                                                
 TRC                        Scalar 1691     R(4)            4     1     255      COM                                                
 TT                         Scalar 1698     R(4)            4           scalar   COM                                                
 TVO                        Scalar 1692     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 1697     R(4)            4           scalar   COM                                                
 XDR                        Scalar 1696     R(4)            4     1     255      COM                                                
 XMA                        Scalar 1697     R(4)            4           scalar   COM                                                
 XMI                        Scalar 1697     R(4)            4           scalar   COM                                                
 XOB                        Scalar 1686     R(4)            4     1     999      COM                                                
 YDR                        Scalar 1696     R(4)            4     1     255      COM                                                
 YMA                        Scalar 1697     R(4)            4           scalar   COM                                                
 YMI                        Scalar 1697     R(4)            4           scalar   COM                                                
 YOB                        Scalar 1686     R(4)            4     1     999      COM                                                
 ZFC                        Scalar 1690     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 1690     R(4)            4     1     255      COM              1734                              
 ZQM                        Scalar 1690     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 1690     R(4)            4     1     255      COM                                                

Page 56          Source Listing                  CKPS
2017-04-18 11:07                                 cqcbufr.f

   1750       
   1751 C**********************************************************************
   1752 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1753 C                .      .    .                                       .
   1754 C SUBPROGRAM:    COMPER      DIAGNOSE COMPUTAION ERRORS
   1755 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   1756 C
   1757 C ABSTRACT: Diagnose and find corrections for computation errors and
   1758 C   errors in temperature and height at the same level where the
   1759 C   hydrostatic residuals compensate in such a way to make one of them
   1760 C   small.  In either case, there is just one large hydrostatic
   1761 C   residual.
   1762 C
   1763 C PROGRAM HISTORY LOG:
   1764 C 1997-03-18  W. Collins  Original author.
   1765 C
   1766 C USAGE:    CALL COMPER(L,LM)
   1767 C   INPUT ARGUMENT LIST:
   1768 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
   1769 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
   1770 C
   1771 C   OUTPUT FILES:
   1772 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   1773 C
   1774 C REMARKS: NONE.
   1775 C
   1776 C ATTRIBUTES:
   1777 C   LANGUAGE: FORTRAN 90
   1778 C   MACHINE:  NCEP WCOSS
   1779 C
   1780 C$$$
   1781 
   1782       SUBROUTINE COMPER(L,LM)
   1783       PARAMETER (NST=999)
   1784 
   1785       REAL(8) BMISS
   1786 
   1787       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   1788      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   1789      &                 NEV, ISF(NST), NLVM, NLVW
   1790       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   1791      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   1792      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   1793      &                 TDO(255), TDFC(255),TVO(255),
   1794      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   1795      &                 CAT(255), IND(255), LEVTYP(255),
   1796      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   1797      &                 YDR(255), XDR(255)
   1798       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   1799      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   1800      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   1801      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   1802      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   1803      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   1804      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   1805      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   1806      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),

Page 57          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   1807      &                 XTDH(255)
   1808       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   1809      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   1810      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   1811      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   1812      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   1813      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   1814      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   1815      &                 XTHM(21,NST),XTDVM(21,NST),
   1816      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   1817      &                 XQHM(21,NST),
   1818      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   1819      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   1820       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   1821      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   1822      &                 ZTMP(21,NST),   TTMP(21,NST),
   1823      &                 NZTMP(21,NST),  NTTMP(21,NST),
   1824      &                 ITERR(4)
   1825       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   1826      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   1827      &                 ZCLIM, TCLIM, NHLIM
   1828       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
   1829       COMMON /CONSTS/  R, G, T0, CP, RV
   1830       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   1831      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   1832       COMMON /STN/     IS
   1833       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   1834      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   1835       COMMON /TESTS/   TEST
   1836       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   1837 
   1838       LOGICAL          TEST, PRNT
   1839       CHARACTER*8 SID
   1840       LOGICAL POUT, GOOD(6,2,2)
   1841       LOGICAL ZG, TG, TDG, QG, ERROR
   1842 
   1843       IF(TEST) WRITE(60,500) SID(IS),POB(LM),L,LM,LST(LM)
   1844   500 FORMAT(' COMPER--CALLED FOR: ',A8,'   POB,L,LM,LST(LM): ',
   1845      &  F10.1,3I5)
   1846 
   1847 C  THIS SUBROUTNE DEALS WITH TWO DISTINCT TYPES OF ERRORS:
   1848 C     1) COMPUTATION ERRORS
   1849 C     2) TYPE 3 ERRORS WITH COMPENSATION
   1850 C  THEY ARE BOTH DIAGNOSED BY AN ISOLATED LARGE HYDROSTATIC RESIDUAL
   1851 C-------------------------------------------------------------------
   1852 
   1853       IF(HYD(L).EQ.BMISS) RETURN
   1854       IF(LST(LM).EQ.120) THEN
   1855         HYDLM = BASRES(IS)
   1856         IF(POB(LM).GT.0.) THEN
   1857           BLM = 0.5*(R/G)*ALOG(PS(IS)/POB(LM))
   1858         ELSE
   1859           BLM = BMISS
   1860         ENDIF
   1861         IF(BLM.LT.0.01) BLM = BMISS
   1862         ZILM = 0.
   1863       ELSE

Page 58          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   1864         IF(HYD(L-1).NE.BMISS) THEN
   1865           HYDLM = HYD(L-1)
   1866           BLM = B(L-1)
   1867           LL = LMAND(L-1)
   1868 C       ELSEIF(L.GT.2) THEN
   1869 C         IF(HYD(L-2).NE.BMISS) THEN
   1870 C           HYDLM = HYD(L-2)
   1871 C           BLM   = B(L-2)
   1872 C           LL    = LMAND(L-2)
   1873 C         ELSE
   1874 C           HYDLM = BMISS
   1875 C           BLM   = BMISS
   1876 C           LL    = BMISS
   1877 C         ENDIF
   1878         ELSE
   1879           HYDLM = BMISS
   1880           BLM   = BMISS
   1881           LL    = BMISS
   1882         ENDIF
   1883         IF(LL.LE.MAND) THEN
   1884           ZILM = ZI(LL)
   1885           ZVLM = ZV(LL)
   1886           TILM = TI(LL)
   1887           TVLM = TV(LL)
   1888         ELSE
   1889           ZILM = 0.
   1890           ZVLM = 0.
   1891           TILM = 0.
   1892           TVLM = 0.
   1893         ENDIF
   1894       ENDIF
   1895 
   1896       IF(TEST) WRITE(60,503) HYDLM, BLM, ZILM, HYD(L), B(L), ZI(LM)
   1897   503 FORMAT(' COMPER--HYDLM,BLM,ZILM: ',3F10.1,'  HYD(L),',
   1898      &  'B(L),ZI(LM): ',3F10.1)
   1899 
   1900       IF(HYDLM.NE.BMISS) THEN
   1901         POUT = .TRUE.
   1902         IF(LST(LM).EQ.120) THEN
   1903           E2 = 1.
   1904           E1 = 0.
   1905         ELSE
   1906           CALL BEST(ZCBEST(1),XMISS,XMISS,ZI(LM),XINC(L,1),
   1907      &      ZV(LM),VOIRES(L,1),ZHM(L,IS),HOIRES(L,1),
   1908      &      ZTMP(L,IS),TMPSTD(L,1))
   1909           CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),XINC(L,2),
   1910      &      TV(LM),VOIRES(L,2),THM(L,IS),HOIRES(L,2),
   1911      &      TTMP(L,IS),TMPSTD(L,2))
   1912 
   1913           ZDIF = ZI(LM) - ZILM
   1914           ZCR = -B(L)*HYDLM/(BLM+B(L))
   1915           TCR = HYDLM/(BLM+B(L))
   1916 
   1917 C  DECIDE WHICH ERROR IS MORE LIKELY
   1918 C  ---------------------------------
   1919 
   1920           E1 = ABS(ZDIF-HYDLM)

Page 59          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   1921           E2 = 0.5*(ABS(ZCBEST(1)-ZCR) + BLM*ABS(TCBEST(1)-TCR))
   1922           IF(TEST) WRITE(60,504) E1,E2,ZCBEST(1),TCBEST(1),ZDIF,ZCR,TCR
   1923   504     FORMAT(' COMPER--E1,E2,ZCBEST,TCBEST,ZDIF,ZCR,TCR: ',
   1924      &      2F10.3,5F10.1)
   1925         ENDIF
   1926 
   1927 C  TYPE 3 ERROR WITH COMPENSATION
   1928 C  ------------------------------
   1929 
   1930         IF(E2.LT.E1) THEN
   1931           IF(TEST) WRITE(60,501) SID(IS),POB(LM)
   1932   501     FORMAT(' COMPER--POSSIBLE TYPE 3 WITH COMPENSATION FOR: ',A8,
   1933      &      ' AT: ',F10.1)
   1934           IHSC(2,LM) = 3
   1935           IHSC(3,LM) = 3
   1936 
   1937 C  SINCE XCR AND XBEST ARE REASONABLE CORRECTIONS, AVERAGE THEM
   1938 C  ------------------------------------------------------------
   1939 
   1940           ZCR = 0.5* (ZCR + ZCBEST(1))
   1941           IF(ABS(ZCR).LT.ZCLIM) ZCR = 0.
   1942           TCR = 0.5* (TCR + TCBEST(1))
   1943           IF(ABS(TCR).LT.TCLIM) TCR = 0.
   1944           CALL SIMPLE(ZCR,ZOB(LL),ALLZ,NALLZ,1.)
   1945           CALL ROUND(ZCR,POB(LL),2)
   1946           CALL SIMPLE(TCR,TOB(LL),ALLT,NALLT,10.)
   1947           CALL ROUND(TCR,POB(LL),3)
   1948           PZCOR = ZCR
   1949           PTCOR = TCR
   1950           CALL CHECKIT(33,ZCR,   ZI(LM), ZV(LM),  ZHM(L,IS),ZTMP(L,IS),
   1951      &                   XMISS,  XMISS,  XMISS,  XMISS,    XMISS,
   1952      &                   TCR,    TI(LM), TV(LM), THM(L,IS),TTMP(L,IS),
   1953      &                   XMISS,  XMISS,  XMISS,  XMISS,    XMISS,
   1954      &              HYDLM,HYD(L),XMISS,BLM,B(L),XMISS,GOOD)
   1955           IF(TEST) WRITE(60,505) ZCR,ZI(LM),ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   1956      &      (GOOD(I,1,1),I=1,5),TCR,TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   1957      &      (GOOD(I,1,2),I=1,5)
   1958   505     FORMAT(' COMPER--ZCR,ZI,ZV,ZHM,ZTMP,GOOD-S: ',5F10.1,5L2,/,
   1959      &           '         TCR,TI,TV,THM,TTMP,GOOD-S: ',5F10.1,5L2)
   1960           IF(GOOD(6,1,1) .AND. GOOD(6,1,2) .AND.
   1961      &      ABS(ZCR).GE.ZCLIM .AND. ABS(TCR).GE.TCLIM) THEN
   1962             QM = 1.
   1963             CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   1964      &        2,ZCR,ZOB(LM)+ZCR,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   1965             CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   1966      &        3,TCR,TOB(LM)+TCR,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   1967           ELSE
   1968             IF(ABS(ZCBEST(1)).GT.0.25*XINC(L,1)) THEN
   1969               ZCR = 0.
   1970               QM = 13.
   1971             ELSE
   1972               IHSC(2,LM) = 0
   1973               PZCOR = ZCR
   1974               ZCR = 0.
   1975               QM = 1.
   1976             ENDIF
   1977             IF(IHSC(2,LM).NE.0) THEN

Page 60          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   1978               CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   1979      &          2,ZCR,ZOB(LM)+ZCR,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   1980             ENDIF
   1981             IF(ABS(TCBEST(1)).GT.0.25*XINC(L,2)) THEN
   1982               PTCOR = TCR
   1983               TCR = 0.
   1984               QM = 13.
   1985             ELSE
   1986               IHSC(3,LM) = 0
   1987               PTCOR = TCR
   1988               TCR = 0.
   1989               QM = 1.
   1990             ENDIF
   1991             IF(IHSC(3,LM).NE.0) THEN
   1992               CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   1993      &          3,TCR,TOB(LM)+TCR,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   1994             ENDIF
   1995           ENDIF
   1996 
   1997 C  COMPUTATION ERROR
   1998 C  -----------------
   1999 
   2000         ELSE
   2001           ZCR = -HYDLM
   2002           CALL ROUND(ZCR,500.,2)
   2003           PZCOR = ZCR
   2004           IF(ABS(ZCR).LT.1.5*ZCLIM) THEN
   2005             ZCR = 0.
   2006             RETURN
   2007           ENDIF
   2008           NSUM = 0
   2009           SUM  = 0.
   2010           SUMS = 0.
   2011           DO I=LM,MIN(LM+3,NLEV)
   2012             LL = MANLEV(POB(I))
   2013             IF(LL.NE.0 .AND. ZI(I).NE.BMISS) THEN
   2014               IF(LL.GE.L) THEN
   2015                 ZZ = ZI(I) + ZCR
   2016               ELSE
   2017                 ZZ = ZI(I)
   2018               ENDIF
   2019               NSUM = NSUM + 1
   2020               SUM  = SUM + ZZ
   2021               SUMS = SUMS + ZZ**2
   2022             ENDIF
   2023           ENDDO
   2024           XSUM = NSUM
   2025           IF(XSUM.NE.0.) THEN
   2026             SX = (SUMS - (SUM**2)/XSUM)/XSUM
   2027           ELSE
   2028             SX = BMISS
   2029           ENDIF
   2030           IF(SX.GT.0.) THEN
   2031             SX = SQRT(SX)
   2032           ELSE
   2033             SX = 0.
   2034           ENDIF

Page 61          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   2035           IF(TEST) WRITE(60,502) SID(IS),POB(LM),SX,ZCR
   2036   502     FORMAT(' COMPER--POSSIBLE COMPUTATION ERROR FOR: ',A8,
   2037      &      '   AT: ',F10.1,'   SX =',F10.2,'  ZCR =',F10.0)
   2038           IF(SX.LT.40.) THEN
   2039             BAD = 0.
   2040             ALL = 0.
   2041             DO I=L,MIN(L+3,LMAND(0))
   2042               LL = LMAND(I)
   2043               IF(LL.LE.MAND) THEN
   2044                 ALL = ALL + 1.
   2045                 CALL CHECKIT(3,ZCR,  ZI(LL),XMISS,ZHM(I,IS),ZTMP(I,IS),
   2046      &                         XMISS,XMISS, XMISS,XMISS,    XMISS,
   2047      &                         XMISS,XMISS, XMISS,XMISS,    XMISS,
   2048      &                         XMISS,XMISS, XMISS,XMISS,    XMISS,
   2049      &                    XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
   2050                 IF(.NOT.GOOD(1,1,1)) BAD = BAD + 1.
   2051               ENDIF
   2052             ENDDO
   2053             IF(ALL.NE.0.) THEN
   2054               RATIO = BAD/ALL
   2055             ELSE
   2056               RATIO = 0.
   2057             ENDIF
   2058             IF(TEST) WRITE(60,506) RATIO
   2059   506       FORMAT(' COMPER--RATIO: ',F10.2)
   2060             IF(RATIO.LT.0.5) THEN
   2061               QM = 1.
   2062               DO I=L,LMAND(0)
   2063                 LL = LMAND(I)
   2064                 IF(LL.LE.MAND) THEN
   2065                   IHSC(2,LL) = 6
   2066                   IF(ZOB(LL).NE.BMISS) THEN
   2067                     CALL SEVENT(SID(IS),SQN(IS),LL,LST(LL),POB(LL),
   2068      &                LEVTYP(LL),2,ZCR,ZOB(LL)+ZCR,PZCOR,QM,IHSC(2,LL),
   2069      &                  XMISS,XMISS,XMISS)
   2070                   ENDIF
   2071                 ENDIF
   2072               ENDDO
   2073             ELSE
   2074               ZCR = 0.
   2075               QM = 3.
   2076               IHSC(2,LM) = 6
   2077               IF(ZOB(LM).NE.BMISS) THEN
   2078                 CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),
   2079      &            LEVTYP(LM),2,ZCR,ZOB(LM)+ZCR,PZCOR,QM,IHSC(2,LM),
   2080      &              XMISS,XMISS,XMISS)
   2081               ENDIF
   2082             ENDIF
   2083           ELSE
   2084             ZCR = 0.
   2085             QM = 3.
   2086             IHSC(2,LM) = 6
   2087             IF(ZOB(LM).NE.BMISS) THEN
   2088               CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),
   2089      &          LEVTYP(LM),2,ZCR,ZOB(LM)+ZCR,PZCOR,QM,IHSC(2,LM),
   2090      &            XMISS,XMISS,XMISS)
   2091             ENDIF

Page 62          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   2092           ENDIF
   2093         ENDIF
   2094       ENDIF
   2095 
   2096       RETURN
   2097       END


ENTRY POINTS

  Name               
                     
 comper_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  1844                                                           1843                              
 501                        Label  1932                                                           1931                              
 502                        Label  2036                                                           2035                              
 503                        Label  1897                                                           1896                              
 504                        Label  1923                                                           1922                              
 505                        Label  1958                                                           1955                              
 506                        Label  2059                                                           2058                              
 ABS                        Func   1920                                 scalar                    1920,1921,1941,1943,1961,1968,1981
                                                                                                  ,2004                             
 ALL                        Local  2040     R(4)            4           scalar                    2040,2044,2053,2054               
 ALLOW                      Common 1828                                 456                                                         
 ALLSND                     Common 1790                                 34512                                                       
 ALLT                       Scalar 1828     R(4)            4     1     71       COM              1946                              
 ALLZ                       Scalar 1828     R(4)            4     1     41       COM              1944                              
 ALOG                       Func   1857                                 scalar                    1857                              
 B                          Scalar 1806     R(4)            4     1     21       COM              1866,1896,1914,1915,1954          
 BAD                        Local  2039     R(4)            4           scalar                    2039,2050,2054                    
 BASRES                     Scalar 1805     R(4)            4     1     999      COM              1855                              
 BEST                       Subr   1906                                                           1906,1909                         
 BLM                        Local  1857     R(4)            4           scalar                    1857,1859,1861,1866,1880,1896,1914
                                                                                                  ,1915,1921,1954                   
 BMISS                      Scalar 1785     R(8)            8           scalar   COM              1853,1859,1861,1864,1879,1880,1881
                                                                                                  ,1900,2013,2028,2066,2077,2087    
 BRES                       Scalar 1819     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 1836                                 16                                                          
 CAT                        Scalar 1795     R(4)            4     1     255      COM                                                
 CHECKIT                    Subr   1950                                                           1950,2045                         
 COMPER                     Subr   1782                                                                                             
 CONSTS                     Common 1829                                 20                                                          
 CP                         Scalar 1829     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 1831     R(4)            4           scalar   COM                                                
 DHR                        Scalar 1787     R(4)            4     1     999      COM                                                
 E1                         Local  1904     R(4)            4           scalar                    1904,1920,1922,1930               
 E2                         Local  1903     R(4)            4           scalar                    1903,1921,1922,1930               
 ELV                        Scalar 1788     R(4)            4     1     999      COM                                                
 ERROR                      Scalar 1819     L(4)            4     1     999      COM                                                
 G                          Scalar 1829     R(4)            4           scalar   COM              1857                              
 GESPS                      Scalar 1796     R(4)            4     1     999      COM                                                

Page 63          Source Listing                  COMPER
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GOOD                       Local  1840     L(4)            4     3     24                        1954,1956,1957,1960,2049,2050     
 H1                         Scalar 1833     R(4)            4           scalar   COM                                                
 H2                         Scalar 1833     R(4)            4           scalar   COM                                                
 HEADER                     Common 1787                                 35980                                                       
 HOIRES                     Scalar 1825     R(4)            4     2     84       COM              1907,1910                         
 HRDR                       Scalar 1796     R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 1825     R(4)            4     1     21       COM                                                
 HYD                        Scalar 1804     R(4)            4     1     21       COM              1853,1864,1865,1896,1954          
 HYDLM                      Local  1855     R(4)            4           scalar                    1855,1865,1879,1896,1900,1914,1915
                                                                                                  ,1920,1954,2001                   
 HYDM                       Scalar 1819     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 1804     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 1804     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 1804     R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 1833                                 64                                                          
 I                          Local  1956     I(4)            4           scalar                    1956,1957,2011,2012,2013,2015,2017
                                                                                                  ,2041,2042,2045,2062,2063         
 IHSC                       Scalar 1805     I(4)            4     2     1020     COM              1934,1935,1964,1966,1972,1977,1979
                                                                                                  ,1986,1991,1993,2065,2068,2076,207
                                                                                                  9,2086,2089                       
 IMISS                      Scalar 1836     I(4)            4           scalar   COM                                                
 IND                        Scalar 1795     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 1831     I(4)            4           scalar   COM                                                
 IS                         Scalar 1832     I(4)            4           scalar   COM              1843,1855,1857,1907,1908,1910,1911
                                                                                                  ,1931,1950,1952,1955,1956,1963,196
                                                                                                  5,1978,1992,2035,2045,2067,2078,20
                                                                                                  88                                
 ISC                        Scalar 1831     I(4)            4           scalar   COM                                                
 ISF                        Scalar 1789     I(4)            4     1     999      COM                                                
 ITERR                      Scalar 1824     I(4)            4     1     4        COM                                                
 ITP                        Scalar 1788     I(4)            4     1     999      COM                                                
 L                          Dummy  1782     I(4)            4           scalar   ARG,INOUT        1843,1853,1864,1865,1866,1867,1896
                                                                                                  ,1906,1907,1908,1909,1910,1911,191
                                                                                                  4,1915,1950,1952,1954,1955,1956,19
                                                                                                  68,1981,2014,2041,2062            
 LAST                       Scalar 1834     I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 1795     I(4)            4     1     255      COM              1963,1965,1978,1992,2068,2079,2089
 LIMS                       Common 1825                                 1776                                                        
 LL                         Local  1867     I(4)            4           scalar                    1867,1881,1883,1884,1885,1886,1887
                                                                                                  ,1944,1945,1946,1947,2012,2013,201
                                                                                                  4,2042,2043,2045,2063,2064,2065,20
                                                                                                  66,2067,2068                      
 LM                         Dummy  1782     I(4)            4           scalar   ARG,INOUT        1843,1854,1856,1857,1896,1902,1906
                                                                                                  ,1907,1909,1910,1913,1931,1934,193
                                                                                                  5,1950,1952,1955,1956,1963,1964,19
                                                                                                  65,1966,1972,1977,1978,1979,1986,1
                                                                                                  991,1992,1993,2011,2035,2076,2077,
                                                                                                  2078,2079,2086,2087,2088,2089     
 LMAND                      Scalar 1831     I(4)            4     1     22       COM              1867,2041,2042,2062,2063          
 LSFC                       Scalar 1831     I(4)            4           scalar   COM                                                
 LST                        Scalar 1796     I(4)            4     1     255      COM              1843,1854,1902,1963,1965,1978,1992
                                                                                                  ,2067,2078,2088                   
 MAND                       Scalar 1830     I(4)            4           scalar   COM              1883,2043,2064                    
 MANLEV                     Func   2012     I(4)            4           scalar                    2012                              
 MANRES                     Common 1808                                 2949048                                                     

Page 64          Source Listing                  COMPER
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIN                        Func   2011                                 scalar                    2011,2041                         
 NALLT                      Scalar 1828     I(4)            4           scalar   COM              1946                              
 NALLZ                      Scalar 1828     I(4)            4           scalar   COM              1944                              
 NBAS                       Scalar 1806     I(4)            4           scalar   COM                                                
 NEV                        Scalar 1789     I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 1827     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 1804     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 1806     I(4)            4     1     21       COM                                                
 NLEV                       Scalar 1830     I(4)            4           scalar   COM              2011                              
 NLV                        Scalar 1788     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 1789     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 1789     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 1830     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 1816     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 1800     I(4)            4     1     255      COM                                                
 NQV                        Scalar 1802     I(4)            4     1     255      COM                                                
 NST                        Param  1783     I(4)            4           scalar                    1787,1788,1789,1796,1805,1808,1809
                                                                                                  ,1810,1811,1812,1813,1814,1815,181
                                                                                                  6,1817,1818,1819,1820,1821,1822,18
                                                                                                  23                                
 NSUM                       Local  2008     I(4)            4           scalar                    2008,2019,2024                    
 NTDHM                      Scalar 1816     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 1800     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 1811     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 1802     I(4)            4     1     255      COM                                                
 NTHM                       Scalar 1814     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 1800     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 1811     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 1802     I(4)            4     1     255      COM                                                
 NTTMP                      Scalar 1823     I(4)            4     2     20979    COM                                                
 NTV                        Scalar 1802     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 1814     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 1800     I(4)            4     1     255      COM                                                
 NZIM                       Scalar 1811     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 1823     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 1802     I(4)            4     1     255      COM                                                
 PARAMS                     Common 1830                                 148                                                         
 PFC                        Scalar 1790     R(4)            4     1     255      COM                                                
 PI                         Scalar 1798     R(4)            4     1     255      COM                                                
 PIS                        Scalar 1819     R(4)            4     1     999      COM                                                
 POB                        Scalar 1790     R(4)            4     1     255      COM              1843,1856,1857,1931,1945,1947,1963
                                                                                                  ,1965,1978,1992,2012,2035,2067,207
                                                                                                  8,2088                            
 POUT                       Scalar 1834     L(4)            4           scalar   COM              1901                              
 PQM                        Scalar 1790     R(4)            4     1     255      COM                                                
 PRC                        Scalar 1790     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 1831     L(4)            4           scalar   COM                                                
 PS                         Scalar 1796     R(4)            4     1     999      COM              1857                              
 PSCOR                      Scalar 1834     R(4)            4           scalar   COM                                                
 PSINC                      Scalar 1805     R(4)            4           scalar   COM                                                
 PTCOR                      Local  1949     R(4)            4           scalar                    1949,1966,1982,1987,1993          
 PZCOR                      Local  1948     R(4)            4           scalar                    1948,1964,1973,1979,2003,2068,2079
                                                                                                  ,2089                             
 QFC                        Scalar 1794     R(4)            4     1     255      COM                                                
 QG                         Scalar 1818     L(4)            4     2     20979    COM                                                

Page 65          Source Listing                  COMPER
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QHM                        Scalar 1809     R(4)            4     2     20979    COM                                                
 QI                         Scalar 1798     R(4)            4     1     255      COM                                                
 QIM                        Scalar 1808     R(4)            4     2     20979    COM                                                
 QM                         Local  1962     R(4)            4           scalar                    1962,1964,1966,1970,1975,1979,1984
                                                                                                  ,1989,1993,2061,2068,2075,2079,208
                                                                                                  5,2089                            
 QOB                        Scalar 1794     R(4)            4     1     255      COM                                                
 QQM                        Scalar 1794     R(4)            4     1     255      COM                                                
 QRC                        Scalar 1794     R(4)            4     1     255      COM                                                
 QV                         Scalar 1799     R(4)            4     1     255      COM                                                
 QVM                        Scalar 1810     R(4)            4     2     20979    COM                                                
 R                          Scalar 1829     R(4)            4           scalar   COM              1857                              
 RADPC                      Scalar 1830     R(4)            4           scalar   COM                                                
 RATIO                      Local  2054     R(4)            4           scalar                    2054,2056,2058,2060               
 RESID                      Common 1798                                 41312                                                       
 ROUND                      Subr   1945                                                           1945,1947,2002                    
 RV                         Scalar 1829     R(4)            4           scalar   COM                                                
 SEVENT                     Subr   1963                                                           1963,1965,1978,1992,2067,2078,2088
 SID                        Scalar 1787     CHAR            8     1     999      COM              1843,1931,1963,1965,1978,1992,2035
                                                                                                  ,2067,2078,2088                   
 SIMPLE                     Subr   1944                                                           1944,1946                         
 SQN                        Scalar 1788     R(4)            4     1     999      COM              1963,1965,1978,1992,2067,2078,2088
 SQRT                       Func   2031                                 scalar                    2031                              
 STN                        Common 1832                                 4                                                           
 SUM                        Local  2009     R(4)            4           scalar                    2009,2020,2026                    
 SUMS                       Local  2010     R(4)            4           scalar                    2010,2021,2026                    
 SX                         Local  2026     R(4)            4           scalar                    2026,2028,2030,2031,2033,2035,2038
 T0                         Scalar 1829     R(4)            4           scalar   COM                                                
 T1                         Scalar 1833     R(4)            4           scalar   COM                                                
 TCBEST                     Scalar 1833     R(4)            4     1     2        COM              1909,1921,1922,1942,1981          
 TCLIM                      Scalar 1827     R(4)            4           scalar   COM              1943,1961                         
 TCOR                       Scalar 1833     R(4)            4     1     2        COM                                                
 TCR                        Local  1915     R(4)            4           scalar                    1915,1921,1922,1942,1943,1946,1947
                                                                                                  ,1949,1952,1956,1961,1966,1982,198
                                                                                                  3,1987,1988,1993                  
 TDFC                       Scalar 1793     R(4)            4     1     255      COM                                                
 TDG                        Scalar 1818     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 1809     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 1798     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 1808     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 1793     R(4)            4     1     255      COM                                                
 TDV                        Scalar 1799     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 1810     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 1835     L(4)            4           scalar   COM              1843,1896,1922,1931,1955,2035,2058
 TESTS                      Common 1835                                 4                                                           
 TFACT                      Scalar 1826     R(4)            4     2     84       COM                                                
 TFC                        Scalar 1792     R(4)            4     1     255      COM                                                
 TG                         Scalar 1818     L(4)            4     2     20979    COM                                                
 THM                        Scalar 1809     R(4)            4     2     20979    COM              1910,1952,1956                    
 TI                         Scalar 1798     R(4)            4     1     255      COM              1886,1909,1952,1956               
 TILM                       Local  1886     R(4)            4           scalar                    1886,1891                         
 TIM                        Scalar 1808     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 1821     R(4)            4     3     83916    COM                                                
 TL                         Scalar 1799     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 1805     R(4)            4     1     255      COM                                                

Page 66          Source Listing                  COMPER
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TMPSND                     Common 1820                                 1678336                                                     
 TMPSTD                     Scalar 1826     R(4)            4     2     84       COM              1908,1911                         
 TOB                        Scalar 1792     R(4)            4     1     255      COM              1946,1966,1993                    
 TOBT                       Scalar 1820     R(4)            4     3     83916    COM                                                
 TQM                        Scalar 1792     R(4)            4     1     255      COM                                                
 TRC                        Scalar 1792     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 1834     R(4)            4           scalar   COM                                                
 TT                         Scalar 1831     R(4)            4           scalar   COM                                                
 TTMP                       Scalar 1822     R(4)            4     2     20979    COM              1911,1952,1956                    
 TV                         Scalar 1799     R(4)            4     1     255      COM              1887,1910,1952,1956               
 TVLM                       Local  1887     R(4)            4           scalar                    1887,1892                         
 TVM                        Scalar 1810     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 1793     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 1826     R(4)            4     2     84       COM              1907,1910                         
 VTPPC                      Scalar 1830     R(4)            4           scalar   COM                                                
 XDR                        Scalar 1797     R(4)            4     1     255      COM                                                
 XINC                       Scalar 1825     R(4)            4     2     84       COM              1906,1909,1968,1981               
 XMA                        Scalar 1830     R(4)            4           scalar   COM                                                
 XMI                        Scalar 1830     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 1836     R(4)            4           scalar   COM              1906,1909,1951,1953,1954,1964,1966
                                                                                                  ,1979,1993,2045,2046,2047,2048,204
                                                                                                  9,2069,2080,2090                  
 XOB                        Scalar 1787     R(4)            4     1     999      COM                                                
 XQHM                       Scalar 1817     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 1801     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 1813     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 1803     R(4)            4     1     255      COM                                                
 XSUM                       Local  2024     R(4)            4           scalar                    2024,2025,2026                    
 XTDH                       Scalar 1807     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 1816     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 1801     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 1812     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 1803     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 1815     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 1806     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 1815     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 1801     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 1812     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 1803     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 1813     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 1806     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 1814     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 1801     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 1812     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 1803     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 1813     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 1797     R(4)            4     1     255      COM                                                
 YMA                        Scalar 1830     R(4)            4           scalar   COM                                                
 YMI                        Scalar 1830     R(4)            4           scalar   COM                                                
 YOB                        Scalar 1787     R(4)            4     1     999      COM                                                
 ZCBEST                     Scalar 1833     R(4)            4     1     2        COM              1906,1921,1922,1940,1968          
 ZCLIM                      Scalar 1827     R(4)            4           scalar   COM              1941,1961,2004                    
 ZCOR                       Scalar 1833     R(4)            4     1     2        COM                                                
 ZCR                        Local  1914     R(4)            4           scalar                    1914,1921,1922,1940,1941,1944,1945
                                                                                                  ,1948,1950,1955,1961,1964,1969,197

Page 67          Source Listing                  COMPER
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,1974,1979,2001,2002,2003,2004,20
                                                                                                  05,2015,2035,2045,2068,2074,2079,2
                                                                                                  084,2089                          
 ZD                         Scalar 1806     R(4)            4     1     255      COM                                                
 ZDIF                       Local  1913     R(4)            4           scalar                    1913,1920,1922                    
 ZFC                        Scalar 1791     R(4)            4     1     255      COM                                                
 ZG                         Scalar 1818     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 1809     R(4)            4     2     20979    COM              1907,1950,1955,2045               
 ZI                         Scalar 1798     R(4)            4     1     255      COM              1884,1896,1906,1913,1950,1955,2013
                                                                                                  ,2015,2017,2045                   
 ZILM                       Local  1862     R(4)            4           scalar                    1862,1884,1889,1896,1913          
 ZIM                        Scalar 1808     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 1821     R(4)            4     3     83916    COM                                                
 ZOB                        Scalar 1791     R(4)            4     1     255      COM              1944,1964,1979,2066,2068,2077,2079
                                                                                                  ,2087,2089                        
 ZOBT                       Scalar 1820     R(4)            4     3     83916    COM                                                
 ZQM                        Scalar 1791     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 1791     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 1834     R(4)            4           scalar   COM                                                
 ZTMP                       Scalar 1822     R(4)            4     2     20979    COM              1908,1950,1955,2045               
 ZV                         Scalar 1799     R(4)            4     1     255      COM              1885,1907,1950,1955               
 ZVLM                       Local  1885     R(4)            4           scalar                    1885,1890                         
 ZVM                        Scalar 1810     R(4)            4     2     20979    COM                                                
 ZZ                         Local  2015     R(4)            4           scalar                    2015,2017,2020,2021               

Page 68          Source Listing                  COMPER
2017-04-18 11:07                                 cqcbufr.f

   2098 
   2099 C**********************************************************************
   2100 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2101 C
   2102 C SUBPROGRAM: COORS
   2103 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   2104 C
   2105 C ABSTRACT: COMPUTES CHORD LENGTH DISTANCE FOR A MATRIX OF
   2106 C   LOCATIONS <(X,Y)I,(X,Y)J> USING THE NORMAL ANGLE  FORMULA:
   2107 C     S**2/2 = 1 - COS(Y1-Y2) + COS(Y1)*COS(Y2)*(1-COS(X1-X2))
   2108 C   DERIVATIVES OF DISTANCE WITH RESPECT TO LAT AND LON ARE ALSO
   2109 C   COMPUTED AND COMBINED WITH APPROPRIATE CORRELATION FUNCTIONS
   2110 C   AND DERIVATIVES WITH RESPECT TO DISTANCE TO FORM THE MULTI-
   2111 C   VARIATE CORRELATIONS FOR THE HEIGHT WIND ANALYSIS.
   2112 C
   2113 C PROGRAM HISTORY LOG:
   2114 C 1990-11-06  J. Woollen  Original author.
   2115 C
   2116 C USAGE:    CALL COORS(NP,CHTWV,X1,Y1,X2,Y2,D,ZZ)
   2117 C   INPUT ARGUMENTS:
   2118 C     NP     - NUMBER OF OUTPUTS REQUESTED
   2119 C     CHTWV  - VECTOR OF CONSTANTS FOR THE GAUSSIAN LENGTH SCALE
   2120 C     X1     - X-COORDINATES (LONGITUDE) FOR 1ST SET OF POINTS
   2121 C     Y1     - Y-COORDINATES (LATITUDE ) FOR 1ST SET OF POINTS
   2122 C     X2     - X-COORDINATES (LONGITUDE) FOR 2ND SET OF POINTS
   2123 C     Y2     - Y-COORDINATES (LATITUDE ) FOR 2ND SET OF POINTS
   2124 C
   2125 C   OUTPUT ARGUMENTS:
   2126 C     D     - DISTANCES BETWEEN ARRAYS OF POINTS IN RADIANS
   2127 C     ZZ    - CORRELATION BETWEEN HEIGHT AND HEIGHT
   2128 C
   2129 C REMARKS: THIS PROGRAM COMPUTES A GAUSSIAN CORRELATION WITH
   2130 C   LENGTH SCALE GIVEN BY THE CHTWV INPUT ARGUMENT.
   2131 C
   2132 C ATTRIBUTES:
   2133 C   LANGUAGE: FORTRAN 90
   2134 C   MACHINE:  NCEP WCOSS
   2135 C
   2136 C$$$
   2137 
   2138       SUBROUTINE COORS(NP,CHTWV,X1,Y1,X2,Y2,D,ZZ)
   2139 
   2140 
   2141       DIMENSION  CHTWV(NP),X1(NP),Y1(NP),X2(NP),Y2(NP)
   2142       DIMENSION  D(NP),ZZ(NP)
   2143 
   2144 
   2145       DATA PI180 /.0174532 /
   2146 
   2147 C----------------------------------------------------------------------
   2148 C----------------------------------------------------------------------
   2149 
   2150       IF(NP.EQ.0) RETURN
   2151 
   2152 C  LOOP OVER SET OF INPUT POINTS
   2153 C  -----------------------------
   2154 

Page 69          Source Listing                  COORS
2017-04-18 11:07                                 cqcbufr.f

   2155       DO 20 I=1,NP
   2156 
   2157 C  COMPUTE THE MATRIX OF SINES AND COSINES
   2158 C  ---------------------------------------
   2159 
   2160       COSY1 = COS(Y1(I)*PI180)
   2161       COSY2 = COS(Y2(I)*PI180)
   2162       COSDX = COS((X1(I)-X2(I))*PI180)
   2163       COSDY = COS((Y1(I)-Y2(I))*PI180)
   2164 
   2165 C  COMPUTE THE NORMAL ANGLE
   2166 C  ------------------------
   2167 
   2168       S = 1.0-COSDY+COSY1*COSY2*(1.0-COSDX)
   2169       S = SQRT(2.*S)
   2170 
   2171 
   2172 C  COMPUTE THE VARIOUS CORRELATIONS
   2173 C  --------------------------------
   2174 
   2175       ZZ(I) = EXP(-CHTWV(I)*S*S)
   2176       D(I)  = S
   2177 
   2178 20    CONTINUE
   2179 
   2180       RETURN
   2181       END


ENTRY POINTS

  Name              
                    
 coors_             

Page 70          Source Listing                  COORS
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  2178                                                           2155                              
 CHTWV                      Dummy  2138     R(4)            4     1     0        ARG,INOUT        2175                              
 COORS                      Subr   2138                                                                                             
 COS                        Func   2160                                 scalar                    2160,2161,2162,2163               
 COSDX                      Local  2162     R(4)            4           scalar                    2162,2168                         
 COSDY                      Local  2163     R(4)            4           scalar                    2163,2168                         
 COSY1                      Local  2160     R(4)            4           scalar                    2160,2168                         
 COSY2                      Local  2161     R(4)            4           scalar                    2161,2168                         
 D                          Dummy  2138     R(4)            4     1     0        ARG,INOUT        2176                              
 EXP                        Func   2175                                 scalar                    2175                              
 I                          Local  2155     I(4)            4           scalar                    2155,2160,2161,2162,2163,2175,2176
 NP                         Dummy  2138     I(4)            4           scalar   ARG,INOUT        2141,2142,2150,2155               
 PI180                      Local  2145     R(4)            4           scalar                    2145,2160,2161,2162,2163          
 S                          Local  2168     R(4)            4           scalar                    2168,2169,2175,2176               
 SQRT                       Func   2169                                 scalar                    2169                              
 X1                         Dummy  2138     R(4)            4     1     0        ARG,INOUT        2162                              
 X2                         Dummy  2138     R(4)            4     1     0        ARG,INOUT        2162                              
 Y1                         Dummy  2138     R(4)            4     1     0        ARG,INOUT        2160,2163                         
 Y2                         Dummy  2138     R(4)            4     1     0        ARG,INOUT        2161,2163                         
 ZZ                         Dummy  2138     R(4)            4     1     0        ARG,INOUT        2175                              

Page 71          Source Listing                  COORS
2017-04-18 11:07                                 cqcbufr.f

   2182 
   2183 C**********************************************************************
   2184 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2185 C                .      .    .                                       .
   2186 C SUBPROGRAM:    CUMPROB     Calculate cumulative probability
   2187 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   2188 C
   2189 C ABSTRACT: Calculate cumulative probability, interpolated from table.
   2190 C
   2191 C PROGRAM HISTORY LOG:
   2192 C 1999-04-13  W. Collins  Original author.
   2193 C
   2194 C USAGE:    Y=CUMPROB(X)
   2195 C
   2196 C   INPUT ARGUMENT LIST:
   2197 C     X        - VALUE
   2198 C
   2199 C   OUTPUT ARGUMENT LIST:
   2200 C     CUMPROB  - Cumulative probability
   2201 C
   2202 C REMARKS: NONE.
   2203 C
   2204 C ATTRIBUTES:
   2205 C   LANGUAGE: FORTRAN 90
   2206 C   MACHINE:  NCEP WCOSS
   2207 C
   2208 C$$$
   2209 
   2210       FUNCTION CUMPROB(X)
   2211 C
   2212 C  FOR A GIVEN X, RETURN THE CUMULATIVE PROBABILITY FOR 
   2213 C  ABS(VALUE <= X). X IS ASSUMED TO BE NORMAL VARIATE.
   2214 C  USE LINEAR INTERPOLATION IN A TABLE.
   2215 C
   2216 
   2217       REAL P(0:40)
   2218       DATA P/.5000,.5398,.5793,.6179,.6554,.6915,
   2219      &       .7257,.7580,.7881,.8159,.8413,
   2220      &       .8643,.8849,.9032,.9192,.9332,
   2221      &       .9452,.9554,.9641,.9713,.9772,
   2222      &       .9821,.9861,.9893,.9918,.9938,
   2223      &       .9953,.9965,.9974,.9981,.9987,
   2224      &       .9990,.9993,.9995,.9997,.9998,
   2225      &       .9998,.9999,.9999,1.0000,1.0000/
   2226 
   2227       IF(X.LT.0. OR. X.GE.4.) THEN
   2228         CUMPROB = 1.
   2229       ELSE
   2230         Y  = X*10.
   2231         IY = Y
   2232         F  = Y-IY
   2233         PY = (1.-F)* P(IY) + F*P(IY+1)
   2234         CUMPROB = 2.*(PY - .5000)
   2235       ENDIF
   2236 
   2237       RETURN
   2238       END

Page 72          Source Listing                  CUMPROB
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 cumprob_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CUMPROB                    Func   2210     R(4)            4           scalar                    2228,2234                         
 CUMPROB@0                  Local  2210     R(4)            4           scalar                                                      
 F                          Local  2232     R(4)            4           scalar                    2232,2233                         
 IY                         Local  2231     I(4)            4           scalar                    2231,2232,2233                    
 P                          Local  2217     R(4)            4     1     41                        2218,2233                         
 PY                         Local  2233     R(4)            4           scalar                    2233,2234                         
 X                          Dummy  2210     R(4)            4           scalar   ARG,INOUT        2227,2230                         
 Y                          Local  2230     R(4)            4           scalar                    2230,2231,2232                    

Page 73          Source Listing                  CUMPROB
2017-04-18 11:07                                 cqcbufr.f

   2239 
   2240 C**********************************************************************
   2241 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2242 C                .      .    .                                       .
   2243 C SUBPROGRAM:    DHOR        CALCULATE CHANGES TO HORIZONTAL RESIDUAL
   2244 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   2245 C
   2246 C ABSTRACT: Calculate changes to the horizontal residual that would
   2247 C   result from the corrections to temperature and height that were
   2248 C   found earlier.  The hydrostatic residual itself is not recalculate
   2249 C   under the assumption that it was screened from the influence of
   2250 C   bad neighbors when first calculated.
   2251 C
   2252 C PROGRAM HISTORY LOG:
   2253 C 1997-03-18  W. Collins  Original author.
   2254 C 1998-02-11  W. Collins  Add update to temporal check.
   2255 C
   2256 C USAGE:    CALL DHOR
   2257 C   OUTPUT FILES:
   2258 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   2259 C
   2260 C REMARKS: NONE.
   2261 C
   2262 C ATTRIBUTES:
   2263 C   LANGUAGE: FORTRAN 90
   2264 C   MACHINE:  NCEP WCOSS
   2265 C
   2266 C$$$
   2267 
   2268       SUBROUTINE DHOR
   2269 
   2270       REAL(8) BMISS
   2271 
   2272       SAVE IEVOLD
   2273       PARAMETER (NST=999)
   2274       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   2275      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   2276      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   2277      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   2278      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   2279      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   2280      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   2281      &                 XTHM(21,NST),XTDVM(21,NST),
   2282      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   2283      &                 XQHM(21,NST),
   2284      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   2285      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   2286       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   2287      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   2288      &                 ZTMP(21,NST),   TTMP(21,NST),
   2289      &                 NZTMP(21,NST),  NTTMP(21,NST),
   2290      &                 ITERR(4)
   2291       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
   2292      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
   2293      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
   2294      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
   2295      &                 BASR(2000),   PISR(2000),  PSINCR(2000),

Page 74          Source Listing                  DHOR
2017-04-18 11:07                                 cqcbufr.f

   2296      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
   2297       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   2298      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   2299      &                 ZCLIM, TCLIM, NHLIM
   2300       COMMON /STN/     IS
   2301       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   2302      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   2303       COMMON /TESTS/   TEST
   2304       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   2305 
   2306       LOGICAL          TEST
   2307       CHARACTER*8      STN
   2308       CHARACTER*10     EDATE
   2309       LOGICAL          PRNT
   2310       LOGICAL ZG, TG, TDG, QG, ERROR
   2311       DATA IEVOLD /0/
   2312 
   2313       IF(IEVENT.NE.IEVOLD) THEN
   2314         DO I=IEVOLD+1,IEVENT
   2315           LM = LEVL(I)
   2316           L  = MANLEV(PRES(I))
   2317           IF(L.EQ.0) GOTO 100
   2318           IV = IVAR(I)
   2319           IF(TEST) WRITE(60,500) STN(I),I,LM,L,IV
   2320   500     FORMAT(' DHOR--STN,EVENT,LM,L,IV: ',A8,2X,4I5)
   2321           IF(IV.EQ.1) THEN
   2322             GOTO 100
   2323           ELSEIF(IV.EQ.2) THEN
   2324             IF(ZHM(L,IS).NE.BMISS) THEN
   2325               ZHM(L,IS)  = ZHM(L,IS) + COR(I)
   2326               NZHM(L,IS) = MIN1(20.,20.*ABS(ZHM(L,IS))/HOIRES(L,1))
   2327             ENDIF
   2328             IF(ZTMP(L,IS).NE.BMISS) THEN
   2329               ZTMP(L,IS) = ZTMP(L,IS) + COR(I)
   2330               NZTMP(L,IS) = MIN1(20.,20.*ABS(ZTMP(L,IS)/
   2331      &           (TMPSTD(L,1)*TFACT(L,1))))
   2332             ENDIF
   2333           ELSEIF(IV.EQ.3) THEN
   2334             IF(THM(L,IS).NE.BMISS) THEN
   2335               THM(L,IS)  = THM(L,IS) + COR(I)
   2336               NTHM(L,IS) = MIN1(20.,20.*ABS(THM(L,IS))/HOIRES(L,2))
   2337             ENDIF
   2338             IF(TTMP(L,IS).NE.BMISS) THEN
   2339               TTMP(L,IS) = TTMP(L,IS) + COR(I)
   2340               NTTMP(L,IS) = MIN1(20.,20.*ABS(TTMP(L,IS)/
   2341      &           (TMPSTD(L,2)*TFACT(L,2))))
   2342             ENDIF
   2343           ENDIF
   2344   100     CONTINUE
   2345         ENDDO
   2346       ENDIF
   2347       IEVOLD = IEVENT
   2348 
   2349       RETURN
   2350       END

Page 75          Source Listing                  DHOR
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 dhor_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  2344                                                           2317,2322                         
 500                        Label  2320                                                           2319                              
 ABS                        Func   2326                                 scalar                    2326,2330,2336,2340               
 BASR                       Scalar 2295     R(4)            4     1     2000     COM                                                
 BMISS                      Scalar 2270     R(8)            8           scalar   COM              2324,2328,2334,2338               
 BRES                       Scalar 2285     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 2304                                 16                                                          
 COR                        Scalar 2293     R(4)            4     1     2000     COM              2325,2329,2335,2339               
 CORVAL                     Scalar 2293     R(4)            4     1     2000     COM                                                
 CQCPC                      Scalar 2302     R(4)            4           scalar   COM                                                
 DHOR                       Subr   2268                                                                                             
 EDATE                      Scalar 2296     CHAR            10    1     2000     COM                                                
 ERROR                      Scalar 2285     L(4)            4     1     999      COM                                                
 EVENTS                     Common 2291                                 156004                                                      
 HOIRES                     Scalar 2297     R(4)            4     2     84       COM              2326,2336                         
 HSCRES                     Scalar 2297     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 2285     R(4)            4     2     20979    COM                                                
 I                          Local  2314     I(4)            4           scalar                    2314,2315,2316,2318,2319,2325,2329
                                                                                                  ,2335,2339                        
 IETYP                      Scalar 2296     I(4)            4     1     2000     COM                                                
 IEVENT                     Scalar 2294     I(4)            4           scalar   COM              2313,2314,2347                    
 IEVOLD                     Local  2272     I(4)            4           scalar   SAVE             2311,2313,2314,2347               
 IMISS                      Scalar 2304     I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 2302     I(4)            4           scalar   COM                                                
 IS                         Scalar 2300     I(4)            4           scalar   COM              2324,2325,2326,2328,2329,2330,2334
                                                                                                  ,2335,2336,2338,2339,2340         
 ISC                        Scalar 2302     I(4)            4           scalar   COM                                                
 ISCAN                      Scalar 2291     I(4)            4     1     2000     COM                                                
 ITERR                      Scalar 2290     I(4)            4     1     4        COM                                                
 IV                         Local  2318     I(4)            4           scalar                    2318,2319,2321,2323,2333          
 IVAR                       Scalar 2293     I(4)            4     1     2000     COM              2318                              
 L                          Local  2316     I(4)            4           scalar                    2316,2317,2319,2324,2325,2326,2328
                                                                                                  ,2329,2330,2331,2334,2335,2336,233
                                                                                                  8,2339,2340,2341                  
 LEVL                       Scalar 2292     I(4)            4     1     2000     COM              2315                              
 LIMS                       Common 2297                                 1776                                                        
 LM                         Local  2315     I(4)            4           scalar                    2315,2319                         
 LMAND                      Scalar 2302     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 2302     I(4)            4           scalar   COM                                                
 LSTYP                      Scalar 2294     I(4)            4     1     2000     COM                                                
 LTYP                       Scalar 2292     I(4)            4     1     2000     COM                                                
 MAND                       Scalar 2301     I(4)            4           scalar   COM                                                
 MANLEV                     Func   2316     I(4)            4           scalar                    2316                              
 MANRES                     Common 2274                                 2949048                                                     

Page 76          Source Listing                  DHOR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIN1                       Func   2326                                 scalar                    2326,2330,2336,2340               
 NHLIM                      Scalar 2299     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 2301     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 2301     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 2282     I(4)            4     2     20979    COM                                                
 NST                        Param  2273     I(4)            4           scalar                    2274,2275,2276,2277,2278,2279,2280
                                                                                                  ,2281,2282,2283,2284,2285,2286,228
                                                                                                  7,2288,2289                       
 NTDHM                      Scalar 2282     I(4)            4     2     20979    COM                                                
 NTDIM                      Scalar 2277     I(4)            4     2     20979    COM                                                
 NTHM                       Scalar 2280     I(4)            4     2     20979    COM              2336                              
 NTIM                       Scalar 2277     I(4)            4     2     20979    COM                                                
 NTTMP                      Scalar 2289     I(4)            4     2     20979    COM              2340                              
 NZHM                       Scalar 2280     I(4)            4     2     20979    COM              2326                              
 NZIM                       Scalar 2277     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 2289     I(4)            4     2     20979    COM              2330                              
 PARAMS                     Common 2301                                 148                                                         
 PCOR                       Scalar 2294     R(4)            4     1     2000     COM                                                
 PIS                        Scalar 2285     R(4)            4     1     999      COM                                                
 PISR                       Scalar 2295     R(4)            4     1     2000     COM                                                
 PRES                       Scalar 2292     R(4)            4     1     2000     COM              2316                              
 PRNT                       Scalar 2302     L(4)            4           scalar   COM                                                
 PSINCR                     Scalar 2295     R(4)            4     1     2000     COM                                                
 QG                         Scalar 2284     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 2275     R(4)            4     2     20979    COM                                                
 QIM                        Scalar 2274     R(4)            4     2     20979    COM                                                
 QMARK                      Scalar 2296     R(4)            4     1     2000     COM                                                
 QVM                        Scalar 2276     R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 2301     R(4)            4           scalar   COM                                                
 SEQN                       Scalar 2291     R(4)            4     1     2000     COM                                                
 STN                        Common 2300                                 4                                                           
 STN                        Scalar 2291     CHAR            8     1     2000     COM              2319                              
 TCLIM                      Scalar 2299     R(4)            4           scalar   COM                                                
 TDG                        Scalar 2284     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 2275     R(4)            4     2     20979    COM                                                
 TDIM                       Scalar 2274     R(4)            4     2     20979    COM                                                
 TDVM                       Scalar 2276     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 2303     L(4)            4           scalar   COM              2319                              
 TESTS                      Common 2303                                 4                                                           
 TFACT                      Scalar 2298     R(4)            4     2     84       COM              2331,2341                         
 TG                         Scalar 2284     L(4)            4     2     20979    COM                                                
 THM                        Scalar 2275     R(4)            4     2     20979    COM              2334,2335,2336                    
 TIM                        Scalar 2274     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 2287     R(4)            4     3     83916    COM                                                
 TMPSND                     Common 2286                                 1678336                                                     
 TMPSTD                     Scalar 2298     R(4)            4     2     84       COM              2331,2341                         
 TOBT                       Scalar 2286     R(4)            4     3     83916    COM                                                
 TT                         Scalar 2302     R(4)            4           scalar   COM                                                
 TTMP                       Scalar 2288     R(4)            4     2     20979    COM              2338,2339,2340                    
 TVM                        Scalar 2276     R(4)            4     2     20979    COM                                                
 VOIRES                     Scalar 2298     R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 2301     R(4)            4           scalar   COM                                                
 XINC                       Scalar 2297     R(4)            4     2     84       COM                                                
 XMA                        Scalar 2301     R(4)            4           scalar   COM                                                
 XMI                        Scalar 2301     R(4)            4           scalar   COM                                                

Page 77          Source Listing                  DHOR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XMISS                      Scalar 2304     R(4)            4           scalar   COM                                                
 XQHM                       Scalar 2283     R(4)            4     2     20979    COM                                                
 XQIM                       Scalar 2279     R(4)            4     2     20979    COM                                                
 XTDHM                      Scalar 2282     R(4)            4     2     20979    COM                                                
 XTDIM                      Scalar 2278     R(4)            4     2     20979    COM                                                
 XTDVM                      Scalar 2281     R(4)            4     2     20979    COM                                                
 XTHM                       Scalar 2281     R(4)            4     2     20979    COM                                                
 XTIM                       Scalar 2278     R(4)            4     2     20979    COM                                                
 XTVM                       Scalar 2279     R(4)            4     2     20979    COM                                                
 XZHM                       Scalar 2280     R(4)            4     2     20979    COM                                                
 XZIM                       Scalar 2278     R(4)            4     2     20979    COM                                                
 XZVM                       Scalar 2279     R(4)            4     2     20979    COM                                                
 YMA                        Scalar 2301     R(4)            4           scalar   COM                                                
 YMI                        Scalar 2301     R(4)            4           scalar   COM                                                
 ZCLIM                      Scalar 2299     R(4)            4           scalar   COM                                                
 ZG                         Scalar 2284     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 2275     R(4)            4     2     20979    COM              2324,2325,2326                    
 ZIM                        Scalar 2274     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 2287     R(4)            4     3     83916    COM                                                
 ZOBT                       Scalar 2286     R(4)            4     3     83916    COM                                                
 ZTMP                       Scalar 2288     R(4)            4     2     20979    COM              2328,2329,2330                    
 ZVM                        Scalar 2276     R(4)            4     2     20979    COM                                                

Page 78          Source Listing                  DHOR
2017-04-18 11:07                                 cqcbufr.f

   2351       
   2352 C**********************************************************************
   2353 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2354 C                .      .    .                                       .
   2355 C SUBPROGRAM:    DISTR       CALCULATE MOMENTS OF DISTRIBUTION
   2356 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1991-07-23
   2357 C
   2358 C ABSTRACT: FOR GIVEN DATA, CALCULATE THE 0TH THROUGH 4TH MOMENTS.
   2359 C   ALSO PRODUCE BINNED DISTRIBUTION.
   2360 C
   2361 C PROGRAM HISTORY LOG:
   2362 C 1991-07-23  W. Collins  Original author.
   2363 C
   2364 C USAGE:    CALL DISTR(X,MSK,XLIM,XMSG,NX,N,NDIV,DDIV,NZERO,
   2365 C                      DZERO,NS,X1,SD,SK,XK)
   2366 C   INPUT ARGUMENT LIST:
   2367 C     X        - DATA
   2368 C     MSK      - MASK: VALUE = 0 -- USE IN COMPUTATIONS
   2369 C                      VALUE.NE.0 -- DONT USE
   2370 C     XLIM     - (1) MINIMUM VALUE TO USE
   2371 C                (2) MAXIMUM VALUE TO USE
   2372 C     XMSG     - MISSING VALUE FOR VARIABLE
   2373 C     NX       - DIMENSION OF X
   2374 C     NDIV     - NUMBER OF DIVISIONS
   2375 C     NZERO    - = 0, USE DZERO AS CENTER
   2376 C                = 1, USE MEAN AS CENTER
   2377 C     DZERO    - CENTRAL DIVISION LOCATION
   2378 C
   2379 C   OUTPUT ARGUMENT LIST:
   2380 C     N        - OUTPUT DISTRIBUTION, COUNT IN EACH DIVISION
   2381 C     NS       - COUNT OF VALUES USED
   2382 C     X1       - FIRST MOMENT (MEAN)
   2383 C     X2       - SECOND MOMENT
   2384 C     X3       - THIRD MOMENT
   2385 C     X4       - FOURTH MOMENT
   2386 C     SD       - STANDARD DEVIATION (POPULATION)
   2387 C                  = SQRT(X2 - X1**2)
   2388 C     SK       - SKEWNESS = X3/(X2)**(3/2)
   2389 C     XK       - KURTOSIS = X4/(SD**4) - 3
   2390 C
   2391 C REMARKS: NONE.
   2392 C
   2393 C ATTRIBUTES:
   2394 C   LANGUAGE: FORTRAN 90
   2395 C   MACHINE:  NCEP WCOSS
   2396 C
   2397 C$$$
   2398       
   2399       SUBROUTINE DISTR(X,MSK,XLIM,XMSG,NX,N,NDIV,DDIV,
   2400      &  NZERO,DZERO,NS,X1,SD,SK,XK)
   2401       PARAMETER (NST=999)
   2402 
   2403       INTEGER N(23), MSK(NST)
   2404       REAL X(NST),XLIM(2)
   2405 
   2406 C
   2407 C     COMPUTE VARIOUS POWERS OF X.

Page 79          Source Listing                  DISTR
2017-04-18 11:07                                 cqcbufr.f

   2408 C
   2409       NS = 0
   2410       SUM1 = 0.
   2411       SUM2 = 0.
   2412       SUM3 = 0.
   2413       SUM4 = 0.
   2414       DO 10 I=1,NX
   2415         IF(MSK(I).EQ.0.AND.ABS(X(I)).LT.0.5*XMSG
   2416      &    .AND.X(I).GE.XLIM(1).AND.X(I).LE.XLIM(2)) THEN
   2417           NS = NS + 1
   2418           SUM1 = SUM1 + X(I)
   2419           SUM2 = SUM2 + X(I)**2
   2420           SUM3 = SUM3 + X(I)**3
   2421           SUM4 = SUM4 + X(I)**4
   2422         ENDIF
   2423    10 CONTINUE
   2424       IF(NS.LT.1) THEN
   2425         DZERO = 0.
   2426         X1 = 0.
   2427         SD = 0.
   2428         SK = 0.
   2429         XK = 0.
   2430         GO TO 15
   2431       ENDIF
   2432       SUM1 = SUM1/NS
   2433       SUM2 = SUM2/NS
   2434       SUM3 = SUM3/NS
   2435       SUM4 = SUM4/NS
   2436 C
   2437 C     CALCULATE VARIOUS OUTPUT STATISTICS.
   2438 C
   2439       X1 = SUM1
   2440       ARG = SUM2 - SUM1**2
   2441       IF(ARG.GT.0.) THEN
   2442         SD = SQRT(ARG)
   2443       ELSE
   2444         SD = 0.
   2445       ENDIF
   2446       X3 = SUM3 - 3.*SUM2*SUM1 + 2.*SUM1**3
   2447       IF(SUM2.GT.0.) THEN
   2448         SK = X3/(SUM2)**1.5
   2449       ELSE
   2450         SK = 0.
   2451       ENDIF
   2452       X4 = SUM4 - 4.*SUM3*SUM1 + 6.*SUM2*SUM1**2 - 3.*SUM1**4
   2453       IF(SD.GT.0.) THEN
   2454         XK = (X4/SD**4) - 3.0
   2455       ELSE
   2456         XK = 0.
   2457       ENDIF
   2458 C
   2459 C     COUNT THE NUMBER OF OBSERVATIONS IN EACH DIVISION.
   2460 C
   2461    15 CONTINUE
   2462       IF(DDIV.EQ.0.) DDIV = 1.
   2463       IF(NZERO.EQ.1) DZERO = SUM1
   2464       DO 18 I=1,NDIV

Page 80          Source Listing                  DISTR
2017-04-18 11:07                                 cqcbufr.f

   2465         N(I) = 0
   2466    18 CONTINUE
   2467       CON = 0.5*NDIV + 1.0 - DZERO/DDIV
   2468       DO 20 I=1,NX
   2469         IF(MSK(I).EQ.0.AND.ABS(X(I)).LT.XMSG
   2470      &    .AND.X(I).GE.XLIM(1).AND.X(I).LE.XLIM(2)) THEN
   2471           INDEX = X(I)/DDIV + CON
   2472           IF(INDEX.LT.1) INDEX = 1
   2473           IF(INDEX.GT.NDIV) INDEX = NDIV
   2474           N(INDEX) = N(INDEX) + 1
   2475         ENDIF
   2476    20 CONTINUE
   2477       RETURN
   2478       END


ENTRY POINTS

  Name              
                    
 distr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  2423                                                           2414                              
 15                         Label  2461                                                           2430                              
 18                         Label  2466                                                           2464                              
 20                         Label  2476                                                           2468                              
 ABS                        Func   2415                                 scalar                    2415,2469                         
 ARG                        Local  2440     R(4)            4           scalar                    2440,2441,2442                    
 CON                        Local  2467     R(4)            4           scalar                    2467,2471                         
 DDIV                       Dummy  2399     R(4)            4           scalar   ARG,INOUT        2462,2467,2471                    
 DISTR                      Subr   2399                                                                                             
 DZERO                      Dummy  2400     R(4)            4           scalar   ARG,INOUT        2425,2463,2467                    
 I                          Local  2414     I(4)            4           scalar                    2414,2415,2416,2418,2419,2420,2421
                                                                                                  ,2464,2465,2468,2469,2470,2471    
 INDEX                      Local  2471     I(4)            4           scalar                    2471,2472,2473,2474               
 MSK                        Dummy  2399     I(4)            4     1     999      ARG,INOUT        2415,2469                         
 N                          Dummy  2399     I(4)            4     1     23       ARG,INOUT        2465,2474                         
 NDIV                       Dummy  2399     I(4)            4           scalar   ARG,INOUT        2464,2467,2473                    
 NS                         Dummy  2400     I(4)            4           scalar   ARG,INOUT        2409,2417,2424,2432,2433,2434,2435
 NST                        Param  2401     I(4)            4           scalar                    2403,2404                         
 NX                         Dummy  2399     I(4)            4           scalar   ARG,INOUT        2414,2468                         
 NZERO                      Dummy  2400     I(4)            4           scalar   ARG,INOUT        2463                              
 SD                         Dummy  2400     R(4)            4           scalar   ARG,INOUT        2427,2442,2444,2453,2454          
 SK                         Dummy  2400     R(4)            4           scalar   ARG,INOUT        2428,2448,2450                    
 SQRT                       Func   2442                                 scalar                    2442                              
 SUM1                       Local  2410     R(4)            4           scalar                    2410,2418,2432,2439,2440,2446,2452
                                                                                                  ,2463                             
 SUM2                       Local  2411     R(4)            4           scalar                    2411,2419,2433,2440,2446,2447,2448
                                                                                                  ,2452                             
 SUM3                       Local  2412     R(4)            4           scalar                    2412,2420,2434,2446,2452          
 SUM4                       Local  2413     R(4)            4           scalar                    2413,2421,2435,2452               
 X                          Dummy  2399     R(4)            4     1     999      ARG,INOUT        2415,2416,2418,2419,2420,2421,2469

Page 81          Source Listing                  DISTR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,2470,2471                        
 X1                         Dummy  2400     R(4)            4           scalar   ARG,INOUT        2426,2439                         
 X3                         Local  2446     R(4)            4           scalar                    2446,2448                         
 X4                         Local  2452     R(4)            4           scalar                    2452,2454                         
 XK                         Dummy  2400     R(4)            4           scalar   ARG,INOUT        2429,2454,2456                    
 XLIM                       Dummy  2399     R(4)            4     1     2        ARG,INOUT        2416,2470                         
 XMSG                       Dummy  2399     R(4)            4           scalar   ARG,INOUT        2415,2469                         

Page 82          Source Listing                  DISTR
2017-04-18 11:07                                 cqcbufr.f

   2479       
   2480 C**********************************************************************
   2481 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2482 C                .      .    .                                       .
   2483 C SUBPROGRAM:    DMA         PERFORM DECISION MAKING
   2484 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   2485 C
   2486 C ABSTRACT:  Decision Making Algorithm:  makes all decision regarding
   2487 C   data quality and determines corrections.
   2488 C
   2489 C PROGRAM HISTORY LOG:
   2490 C 1997-03-18  W. Collins  Original author.
   2491 C
   2492 C USAGE:    CALL DMA(ANY,OBS)
   2493 C   INPUT ARGUMENT LIST:
   2494 C     ANY      - TRUE IF THERE ARE ANY ERRORS
   2495 C     OBS      - TRUE FOR LAST SCAN WHEN OBSERVATION ERRORS ARE
   2496 C                DETERMINED
   2497 C
   2498 C   OUTPUT FILES:
   2499 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   2500 C
   2501 C REMARKS: NONE.
   2502 C
   2503 C ATTRIBUTES:
   2504 C   LANGUAGE: FORTRAN 90
   2505 C   MACHINE:  NCEP WCOSS
   2506 C
   2507 C$$$
   2508 
   2509       SUBROUTINE DMA(ANY,OBS)
   2510       PARAMETER (NST=999)
   2511       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   2512      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   2513      &                 NEV, ISF(NST), NLVM, NLVW
   2514       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   2515      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   2516       COMMON /STN/     IS
   2517       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   2518      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   2519       COMMON /DOTYP40/ DOT40
   2520       COMMON /TESTS/   TEST
   2521       LOGICAL          TEST, DOT40
   2522       CHARACTER*8 SID
   2523       LOGICAL POUT, ANY, OBS, PRNT
   2524       LOGICAL ZG, TG, TDG, QG, ERROR
   2525 
   2526       IF(TEST) WRITE(60,500) SID(IS)
   2527   500 FORMAT(' DMA--CALLED FOR: ',A8)
   2528       OBS = .FALSE.
   2529 
   2530 C  DETERMINE SURFACE TYPE
   2531 C  ----------------------
   2532 
   2533       IF(ISC.EQ.1) THEN
   2534         CALL STYPE
   2535 C       CALL HOLES

Page 83          Source Listing                  DMA
2017-04-18 11:07                                 cqcbufr.f

   2536       ENDIF
   2537 
   2538 C  PREFORM ANALYSIS, LAYER BY LAYER
   2539 C  --------------------------------
   2540 
   2541       IF(ANY .OR. LAST.LT.NLEV) THEN
   2542         CALL ERRTYP
   2543       ELSE
   2544         OBS = .TRUE.
   2545 C       CALL OBERR
   2546         CALL NOBERR
   2547         IF(DOT40) CALL POBERR
   2548       ENDIF
   2549 
   2550       RETURN
   2551       END


ENTRY POINTS

  Name            
                  
 dma_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  2527                                                           2526                              
 ANY                        Dummy  2509     L(4)            4           scalar   ARG,INOUT        2541                              
 CQCPC                      Scalar 2515     R(4)            4           scalar   COM                                                
 DHR                        Scalar 2511     R(4)            4     1     999      COM                                                
 DMA                        Subr   2509                                                                                             
 DOT40                      Scalar 2519     L(4)            4           scalar   COM              2547                              
 DOTYP40                    Common 2519                                 4                                                           
 ELV                        Scalar 2512     R(4)            4     1     999      COM                                                
 ERROR                      Local  2524     L(4)            4           scalar                                                      
 ERRTYP                     Subr   2542                                                           2542                              
 H1                         Scalar 2517     R(4)            4           scalar   COM                                                
 H2                         Scalar 2517     R(4)            4           scalar   COM                                                
 HEADER                     Common 2511                                 35980                                                       
 HYDSTUF                    Common 2517                                 64                                                          
 IPEVT                      Scalar 2515     I(4)            4           scalar   COM                                                
 IS                         Scalar 2516     I(4)            4           scalar   COM              2526                              
 ISC                        Scalar 2515     I(4)            4           scalar   COM              2533                              
 ISF                        Scalar 2513     I(4)            4     1     999      COM                                                
 ITP                        Scalar 2512     I(4)            4     1     999      COM                                                
 LAST                       Scalar 2518     I(4)            4           scalar   COM              2541                              
 LMAND                      Scalar 2515     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 2515     I(4)            4           scalar   COM                                                
 MAND                       Scalar 2514     I(4)            4           scalar   COM                                                
 NEV                        Scalar 2513     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 2514     I(4)            4           scalar   COM              2541                              
 NLV                        Scalar 2512     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 2513     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 2513     I(4)            4           scalar   COM                                                

Page 84          Source Listing                  DMA
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NOBERR                     Subr   2546                                                           2546                              
 NOBS                       Scalar 2514     I(4)            4           scalar   COM                                                
 NST                        Param  2510     I(4)            4           scalar                    2511,2512,2513                    
 OBS                        Dummy  2509     L(4)            4           scalar   ARG,INOUT        2528,2544                         
 PARAMS                     Common 2514                                 148                                                         
 POBERR                     Subr   2547                                                           2547                              
 POUT                       Scalar 2518     L(4)            4           scalar   COM                                                
 PRNT                       Scalar 2515     L(4)            4           scalar   COM                                                
 PSCOR                      Scalar 2518     R(4)            4           scalar   COM                                                
 QG                         Local  2524     L(4)            4           scalar                                                      
 RADPC                      Scalar 2514     R(4)            4           scalar   COM                                                
 SID                        Scalar 2511     CHAR            8     1     999      COM              2526                              
 SQN                        Scalar 2512     R(4)            4     1     999      COM                                                
 STN                        Common 2516                                 4                                                           
 STYPE                      Subr   2534                                                           2534                              
 T1                         Scalar 2517     R(4)            4           scalar   COM                                                
 TCBEST                     Scalar 2517     R(4)            4     1     2        COM                                                
 TCOR                       Scalar 2517     R(4)            4     1     2        COM                                                
 TDG                        Local  2524     L(4)            4           scalar                                                      
 TEST                       Scalar 2520     L(4)            4           scalar   COM              2526                              
 TESTS                      Common 2520                                 4                                                           
 TG                         Local  2524     L(4)            4           scalar                                                      
 TSCOR                      Scalar 2518     R(4)            4           scalar   COM                                                
 TT                         Scalar 2515     R(4)            4           scalar   COM                                                
 VTPPC                      Scalar 2514     R(4)            4           scalar   COM                                                
 XMA                        Scalar 2514     R(4)            4           scalar   COM                                                
 XMI                        Scalar 2514     R(4)            4           scalar   COM                                                
 XOB                        Scalar 2511     R(4)            4     1     999      COM                                                
 YMA                        Scalar 2514     R(4)            4           scalar   COM                                                
 YMI                        Scalar 2514     R(4)            4           scalar   COM                                                
 YOB                        Scalar 2511     R(4)            4     1     999      COM                                                
 ZCBEST                     Scalar 2517     R(4)            4     1     2        COM                                                
 ZCOR                       Scalar 2517     R(4)            4     1     2        COM                                                
 ZG                         Local  2524     L(4)            4           scalar                                                      
 ZSCOR                      Scalar 2518     R(4)            4           scalar   COM                                                

Page 85          Source Listing                  DMA
2017-04-18 11:07                                 cqcbufr.f

   2552 
   2553 C**********************************************************************
   2554 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2555 C
   2556 C SUBPROGRAM: DRCTSL
   2557 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   2558 C
   2559 C ABSTRACT: DRIVER FOR CHOLESKY TYPE LINEAR EQUATION SOLVER.
   2560 C
   2561 C PROGRAM HISTORY LOG:
   2562 C 1990-11-06  J. Woollen  Original author.
   2563 C
   2564 C USAGE:    CALL DRCTSL(FAALL,RAALL,DOTPRD,NDIM,MAXDIM,NXXYY,NFT,LEV,
   2565 C                       IV)
   2566 C   INPUT ARGUMENTS:
   2567 C     FAALL      - ARRAY OF SYMMETRIC MATRIXES
   2568 C     RAALL      - ARRAY OF MATRIX RIGHT HAND SIDES
   2569 C     NDIM       - ARRAY OF MATRIX RANKS
   2570 C     MAXDIM     - MAXIMUM RANK MATRIX IN MATRIX ARRAY
   2571 C     NXXYY      - NUMBER OF MATRIXES IN MATRIX ARRAY
   2572 C     NFT        - NUMBER OF RIGHT HAND SIDE VECTORS PER MATRIX
   2573 C     LEV        - LEVEL
   2574 C     IV         - VARIABLE
   2575 C   OUTPUT ARGUMENTS:
   2576 C     RAALL      - ARRAY OF MATRIX SOLUTIONS
   2577 C     DOTPRD     - ARRAY OF DOT PRODUCTS OF RHS VECTORS WITH MATRIX
   2578 C                  SOLUTIONS
   2579 C
   2580 C REMARKS: ILL CONDITIONED OR NON POSITIVE DEFINITE MATRIXES ARE
   2581 C   IDENTIFIED BY DOT PRODUCTS GT 1 OR LT 0 OR BY A MESSAGE FROM
   2582 C   VSOLVE. FIVE ATTEMPTS ARE MADE TO SOLVE BAD ONES, BY RIDGE
   2583 C   REGRESSION, AFTER WHICH A NULL SOLUTION IS RETURNED.
   2584 C
   2585 C ATTRIBUTES:
   2586 C   LANGUAGE: FORTRAN 90
   2587 C   MACHINE:  NCEP WCOSS
   2588 C
   2589 C$$$
   2590 C-----------------------------------------------------------------------
   2591 
   2592       SUBROUTINE DRCTSL(FAALL,RAALL,DOTPRD,NDIM,MAXDIM,NXXYY,NFT,LEV,IV)
   2593 
   2594       DIMENSION  FAALL(1000,10), DOTPRD(1000,1),
   2595      .           RAALL(1000,4,1), NDIM(1000)
   2596 
   2597       DIMENSION  A(1000,10),B(1000,4,1),BAD(1000),SMOOTH(6)
   2598 
   2599       LOGICAL BAD
   2600       DATA SMOOTH /1.00,1.01,1.02,1.05,1.10,2.00/
   2601 
   2602 C----------------------------------------------------------------------
   2603 C----------------------------------------------------------------------
   2604 
   2605 C  LOOP FOR POSSIBILITY OF BAD MATRIXS
   2606 C  -----------------------------------
   2607 
   2608       DO 50 ITRY=1,6

Page 86          Source Listing                  DRCTSL
2017-04-18 11:07                                 cqcbufr.f

   2609 
   2610       NBAD = 0
   2611 
   2612 C  INITIALIZE THE WORKING ARRAYS
   2613 C  -----------------------------
   2614 
   2615       DO J=1,MAXDIM*(MAXDIM+1)/2
   2616         DO I=1,NXXYY
   2617           A(I,J) = FAALL(I,J)
   2618         ENDDO
   2619       ENDDO
   2620 
   2621       DO K=1,NFT
   2622         DO J=1,MAXDIM
   2623           DO I=1,NXXYY
   2624             B(I,J,K) = RAALL(I,J,K)
   2625           ENDDO
   2626         ENDDO
   2627       ENDDO
   2628 
   2629       DO J=1,NFT
   2630         DO I=1,NXXYY
   2631           DOTPRD(I,J) = 0.
   2632         ENDDO
   2633       ENDDO
   2634 
   2635       DO J=1,MAXDIM
   2636         JJ = J*(J+1)/2
   2637         DO I=1,NXXYY
   2638           A(I,JJ) = FAALL(I,JJ)*SMOOTH(ITRY)
   2639         ENDDO
   2640       ENDDO
   2641 
   2642 C  CALL THE MATRIX SOLVER
   2643 C  ----------------------
   2644 
   2645       CALL VSOLVE (A,B,NDIM,BAD,NFT,NXXYY,MAXDIM)
   2646 
   2647 C  MAKE THE DOT PRODUCTS OF SOLUTIONS WITH RIGHT HAND SIDES
   2648 C  --------------------------------------------------------
   2649 
   2650       DO K=1,NFT
   2651         DO J=1,MAXDIM
   2652           DO I=1,NXXYY
   2653             DOTPRD(I,K) = DOTPRD(I,K) + RAALL(I,J,K)*B(I,J,K)
   2654           ENDDO
   2655         ENDDO
   2656       ENDDO
   2657 
   2658       DO K=1,NFT
   2659         DO I=1,NXXYY
   2660           IF(DOTPRD(I,K).GT.1.)THEN
   2661             DO J=1,MAXDIM
   2662               B(I,J,K) = B(I,J,K)/DOTPRD(I,K)
   2663             ENDDO
   2664             DOTPRD(I,K) = 1.
   2665           ENDIF

Page 87          Source Listing                  DRCTSL
2017-04-18 11:07                                 cqcbufr.f

   2666         ENDDO
   2667       ENDDO
   2668 
   2669 C  CHECK FOR BAD ONES - DO IT AGAIN IF NECESSARY
   2670 C  ---------------------------------------------
   2671 
   2672       DO J=1,NFT
   2673         DO I=1,NXXYY
   2674           BAD(I) = BAD(I) .OR. DOTPRD(I,J).LT.0.
   2675      &      .OR. DOTPRD(I,J).GT.1.
   2676         ENDDO
   2677       ENDDO
   2678 
   2679       DO I=1,NXXYY
   2680         IF(BAD(I)) THEN
   2681            DO K=1,NFT
   2682              DOTPRD(I,K) = 0.
   2683              DO J=1,MAXDIM
   2684                B(I,J,K) = 0.
   2685              ENDDO
   2686            ENDDO
   2687            NBAD = NBAD + 1
   2688         ENDIF
   2689       ENDDO
   2690 
   2691       IF(NBAD.NE.0) THEN
   2692         PRINT*, 'NBAD=',NBAD,' ON TRY ',ITRY
   2693      &         , ' LEV=',LEV,' IV=',IV
   2694       ELSE
   2695         GOTO 55
   2696       ENDIF
   2697 
   2698 50    CONTINUE
   2699 
   2700 C  COPY SOLUTIONS INTO OUTPUT ARRAY - ZERO BAD ONES OUT
   2701 C  ----------------------------------------------------
   2702 
   2703 55    CONTINUE
   2704       DO K=1,NFT
   2705         DO J=1,MAXDIM
   2706           DO I=1,NXXYY
   2707             RAALL(I,J,K) = B(I,J,K)
   2708           ENDDO
   2709         ENDDO
   2710       ENDDO
   2711 
   2712       RETURN
   2713       END

Page 88          Source Listing                  DRCTSL
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 drctsl_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 50                         Label  2698                                                           2608                              
 55                         Label  2703                                                           2695                              
 A                          Local  2597     R(4)            4     2     10000                     2617,2638,2645                    
 B                          Local  2597     R(4)            4     3     4000                      2624,2645,2653,2662,2684,2707     
 BAD                        Local  2597     L(4)            4     1     1000                      2645,2674,2680                    
 DOTPRD                     Dummy  2592     R(4)            4     2     1000     ARG,INOUT        2631,2653,2660,2662,2664,2674,2675
                                                                                                  ,2682                             
 DRCTSL                     Subr   2592                                                                                             
 FAALL                      Dummy  2592     R(4)            4     2     10000    ARG,INOUT        2617,2638                         
 I                          Local  2616     I(4)            4           scalar                    2616,2617,2623,2624,2630,2631,2637
                                                                                                  ,2638,2652,2653,2659,2660,2662,266
                                                                                                  4,2673,2674,2675,2679,2680,2682,26
                                                                                                  84,2706,2707                      
 ITRY                       Local  2608     I(4)            4           scalar                    2608,2638,2692                    
 IV                         Dummy  2592     I(4)            4           scalar   ARG,INOUT        2693                              
 J                          Local  2615     I(4)            4           scalar                    2615,2617,2622,2624,2629,2631,2635
                                                                                                  ,2636,2651,2653,2661,2662,2672,267
                                                                                                  4,2675,2683,2684,2705,2707        
 JJ                         Local  2636     I(4)            4           scalar                    2636,2638                         
 K                          Local  2621     I(4)            4           scalar                    2621,2624,2650,2653,2658,2660,2662
                                                                                                  ,2664,2681,2682,2684,2704,2707    
 LEV                        Dummy  2592     I(4)            4           scalar   ARG,INOUT        2693                              
 MAXDIM                     Dummy  2592     I(4)            4           scalar   ARG,INOUT        2615,2622,2635,2645,2651,2661,2683
                                                                                                  ,2705                             
 NBAD                       Local  2610     I(4)            4           scalar                    2610,2687,2691,2692               
 NDIM                       Dummy  2592     I(4)            4     1     1000     ARG,INOUT        2645                              
 NFT                        Dummy  2592     I(4)            4           scalar   ARG,INOUT        2621,2629,2645,2650,2658,2672,2681
                                                                                                  ,2704                             
 NXXYY                      Dummy  2592     I(4)            4           scalar   ARG,INOUT        2616,2623,2630,2637,2645,2652,2659
                                                                                                  ,2673,2679,2706                   
 RAALL                      Dummy  2592     R(4)            4     3     4000     ARG,INOUT        2624,2653,2707                    
 SMOOTH                     Local  2597     R(4)            4     1     6                         2600,2638                         
 VSOLVE                     Subr   2645                                                           2645                              

Page 89          Source Listing                  DRCTSL
2017-04-18 11:07                                 cqcbufr.f

   2714 
   2715 C******************************************************************
   2716 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2717 C                .      .    .                                       .
   2718 C SUBPROGRAM:    ERR123      PERFORM ERROR ANALYSIS FOR TYPE 1,2,3.
   2719 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   2720 C
   2721 C ABSTRACT: Perform error analysis for single height (type 1), single
   2722 C   temperature (type 2) and height and temperature (type 3) at the
   2723 C   same pressure level.
   2724 C
   2725 C PROGRAM HISTORY LOG:
   2726 C 1997-03-18  W. Collins  Original author.
   2727 C
   2728 C USAGE:    CALL ERR123(L,LM)
   2729 C   INPUT ARGUMENT LIST:
   2730 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
   2731 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
   2732 C
   2733 C   OUTPUT FILES:
   2734 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   2735 C
   2736 C REMARKS: NONE.
   2737 C
   2738 C ATTRIBUTES:
   2739 C   LANGUAGE: FORTRAN 90
   2740 C   MACHINE:  NCEP WCOSS
   2741 C
   2742 C$$$
   2743 
   2744       SUBROUTINE ERR123(L,LM)
   2745       PARAMETER (NST=999)
   2746 
   2747       REAL(8) BMISS
   2748 
   2749       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
   2750       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   2751      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   2752      &                 NEV, ISF(NST), NLVM, NLVW
   2753       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   2754      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   2755      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   2756      &                 TDO(255), TDFC(255),TVO(255),
   2757      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   2758      &                 CAT(255), IND(255), LEVTYP(255),
   2759      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   2760      &                 YDR(255), XDR(255)
   2761       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   2762      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   2763      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   2764      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   2765      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   2766      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   2767      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   2768      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   2769      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   2770      &                 XTDH(255)

Page 90          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   2771       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   2772      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   2773      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   2774      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   2775      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   2776      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   2777      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   2778      &                 XTHM(21,NST),XTDVM(21,NST),
   2779      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   2780      &                 XQHM(21,NST),
   2781      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   2782      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   2783       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   2784      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   2785      &                 ZTMP(21,NST),   TTMP(21,NST),
   2786      &                 NZTMP(21,NST),  NTTMP(21,NST),
   2787      &                 ITERR(4)
   2788       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   2789      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   2790      &                 ZCLIM, TCLIM, NHLIM
   2791       COMMON /CONSTS/  R, G, T0, CP, RV
   2792       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   2793      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   2794       COMMON /STN/     IS
   2795       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   2796      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   2797       COMMON /TESTS/   TEST
   2798       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   2799 
   2800       LOGICAL          TEST, SDMQ
   2801       CHARACTER*8 SID
   2802       LOGICAL POUT, GOOD(6,2,2)
   2803       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
   2804 
   2805       IF(TEST) WRITE(60,500) SID(IS), POB(LM), LST(LM), L, LM
   2806   500 FORMAT(' ERR123--CALLED FOR: ',A8,'  AT: ',F10.1,
   2807      &  ' WITH LST(LM),L,LM: ',3I5)
   2808 
   2809       QM = 2.
   2810       QMT = 2.
   2811       QMZ = 2.
   2812       NHYDLM = BMISS
   2813 
   2814 C  DETERMINE APPROPRIATE HYDROSTATIC RESIDUAL, B TO USE
   2815 C  ----------------------------------------------------
   2816 
   2817       IF(LST(LM).NE.121) THEN
   2818         HYDLT = HYDN(L)
   2819         HYDLZ = HYD(L)
   2820         NHYDL = NHYD(L)
   2821         BL   = B(L)
   2822       ELSE
   2823         HYDLT = BMISS
   2824         HYDLZ = BMISS
   2825         NHYDL = -1
   2826         BL   = BMISS
   2827       ENDIF

Page 91          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   2828       IF(LST(LM).EQ.130) THEN
   2829         IF(HYDN(L-1).NE.BMISS) THEN
   2830           HYDLMT = HYDN(L-1)
   2831           HYDLMZ = HYD(L-1)
   2832           NHYDLM = NHYD(L-1)
   2833           BLM = B(L-1)
   2834         ELSEIF(L.GT.2) THEN
   2835           IF(HYDN(L-2).NE.BMISS) THEN
   2836             HYDLMT = HYDN(L-2)
   2837             HYDLMZ = HYD(L-2)
   2838             NHYDLM = NHYD(L-2)
   2839             BLM = B(L-2)
   2840           ELSE
   2841             HYDLMT = BMISS
   2842             HYDLMZ = BMISS
   2843             NHYDL = -1
   2844             BLM = BMISS
   2845           ENDIF
   2846         ELSE
   2847           HYDLMT = BMISS
   2848           HYDLMZ = BMISS
   2849           NHYDL = -1
   2850           BLM = BMISS
   2851         ENDIF
   2852       ELSEIF(LST(LM).EQ.120) THEN
   2853         HYDLMT = BASRES(IS)
   2854         HYDLMZ = BASRES(IS)
   2855         NHYDLM = NBAS
   2856         BLM = 0.5*(R/G)*ALOG(PS(IS)/POB(LM))
   2857         IF(BLM.LT.0.01) BLM = BMISS
   2858       ELSE
   2859         RETURN
   2860       ENDIF
   2861 
   2862       H1 = BMISS
   2863       H2 = BMISS
   2864       T1 = BMISS
   2865       H1 = ABS(HYDLMZ+HYDLZ)
   2866 C     H1 = ABS(HYDLMT+HYDLT)
   2867       H2 = 2.*TT * SQRT(BLM**2 + BL**2)
   2868       T1 = ABS(HYDLT/BL - HYDLMT/BLM)
   2869 
   2870       IF(TEST) WRITE(60,504) POB(LM),H1,H2,T1,HYDLZ,HYDLMZ,HYDLT,
   2871      &  HYDLMT,BL,BLM
   2872   504 FORMAT(' ERR123--POB,H1,H2,T1: ',4F10.1,'  HYDLZ,HYDLMZ: ',
   2873      &  2F10.1,'  HYDLT,HYDLMT: ',2F10.1,'  BL,BLM: ',2F10.3)
   2874 
   2875 C  HEIGHT ERROR
   2876 C  ------------
   2877 
   2878       IF(H1.LT.H2 .AND. T1.GE.TT .AND.
   2879      &  NHYDL.GT.NHLIM .AND. NHYDLM.GT.NHLIM) THEN
   2880         IF(TEST) WRITE(60,501) POB(LM)
   2881   501   FORMAT(' ERR123--HEIGHT ERROR AT: ',F10.1)
   2882 C       ZCOR(1) = (HYDLZ/BL**2 - HYDLMZ/BLM**2)/
   2883 C    &         (1./BL**2 + 1./BLM**2)   ! Based upon X's
   2884         ZCOR(1) = 0.5*(HYDLZ-HYDLMZ)    ! Based upon s's

Page 92          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   2885         IHSC(2,LM) = 1
   2886         POUT = .TRUE.
   2887         IF(NZI(LM).LT.6) THEN
   2888           ZDIF = ZI(LM)
   2889         ELSE
   2890           ZDIF = ZD(LM)
   2891         ENDIF
   2892         CALL BEST(ZCBEST(1),XMISS,XMISS,ZDIF,XINC(L,1),
   2893      &    ZV(LM),VOIRES(L,1),ZHM(L,IS),HOIRES(L,1),
   2894      &    ZTMP(L,IS),TMPSTD(L,1))
   2895         ZR = ABS(ZCOR(1)-ZCBEST(1))/XINC(L,1)
   2896         IF(ZR.LT.0.25) THEN
   2897           ZC1 = ZCOR(1)
   2898           CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   2899           CALL ROUND(ZC1,POB(LM),2)
   2900           PZCOR = ZC1
   2901           IF(ABS(ZC1).LT.ZCLIM) THEN
   2902             ZC1 = 0.
   2903             QM = 3.
   2904           ELSE
   2905             QM = 1.
   2906           ENDIF
   2907           ZCOR(1) = ZC1
   2908         ELSE
   2909           ZC1 = ZCBEST(1)
   2910           PZCOR = ZC1
   2911           IF(ABS(ZC1).LT.ZCLIM) THEN
   2912             ZC1 = 0.
   2913             QM = 3.
   2914           ELSE
   2915             CALL CHECKIT(1,ZC1,  ZDIF, ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   2916      &                     XMISS,XMISS,XMISS, XMISS,    XMISS,
   2917      &                     XMISS,XMISS,XMISS, XMISS,    XMISS,
   2918      &                     XMISS,XMISS,XMISS, XMISS,    XMISS,
   2919      &                     HYDLMZ,HYDLZ,XMISS,BLM,BL,XMISS,GOOD)
   2920             IF(GOOD(6,1,1)) THEN
   2921               ZC1 = ZCBEST(1)
   2922               ZC0 = ZC1
   2923               CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   2924               CALL ROUND(ZC1,POB(LM),2)
   2925               PZCOR = ZC1
   2926               CALL CHECKIT(1,ZC1,  ZDIF, ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   2927      &                       XMISS,XMISS,XMISS, XMISS,    XMISS,
   2928      &                       XMISS,XMISS,XMISS, XMISS,    XMISS,
   2929      &                       XMISS,XMISS,XMISS, XMISS,    XMISS,
   2930      &                       HYDLMZ,HYDLZ,XMISS,BLM,BL,XMISS,GOOD)
   2931 C  THE FOLLOWING LOGIC, AND ELSEWHERE, CAN BE ELABORATED SO THAT
   2932 C  EVEN IF GOOD(6) IS NOT .TRUE. BUT GOOD(4) IS .TRUE., THEN THE
   2933 C  CORRECTION WILL BE MADE BUT FLAGGED AS QUESTIONABLE.  THIS IS
   2934 C  THE CASE WHERE A HYDROSTATIC AND OBSERVATIONAL ERROR MAY BE
   2935 C  COMBINED.
   2936               IF(GOOD(6,1,1)) THEN
   2937                 QM = 1.
   2938               ELSE
   2939                 ZC1 = ZC0
   2940                 PZCOR = ZC1
   2941                 QM = 1.

Page 93          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   2942               ENDIF
   2943             ELSE
   2944               ZC1 = 0.
   2945               QM = 13.
   2946             ENDIF
   2947           ENDIF
   2948         ENDIF
   2949         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),2,ZC1,
   2950      &    ZOB(LM)+ZC1,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   2951 
   2952 C  TEMPERATURE ERROR
   2953 C  -----------------
   2954 
   2955       ELSEIF(T1.LT.TT .AND. H1.GE.H2) THEN
   2956         IF(TEST) WRITE(60,502) POB(LM)
   2957   502   FORMAT(' ERR123--TEMPERATURE ERROR AT: ',F10.1)
   2958 C       TCOR(1) = 0.5 * (HYDLMT/BLM + HYDLT/BL)   ! Based upon X's
   2959         TCOR(1) = (HYDLMT*BLM + HYDLT*BL)/(BLM**2 + BL**2) ! on s's
   2960         IHSC(3,LM) = 2
   2961         POUT = .TRUE.
   2962         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
   2963      &    XINC(L,2),TV(LM),VOIRES(L,2),THM(L,IS),HOIRES(L,2),
   2964      &    TTMP(L,IS),TMPSTD(L,2))
   2965         TR = ABS(TCOR(1)-TCBEST(1))/XINC(L,2)
   2966         IF(TR.LT.0.25) THEN
   2967           TC1 = TCOR(1)
   2968           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   2969           CALL ROUND(TC1,POB(LM),3)
   2970           PTCOR = TC1
   2971           IF(ABS(TC1).LT.TCLIM) THEN
   2972             TC1 = 0.
   2973             QM = 3.
   2974           ELSE
   2975             QM = 1.
   2976           ENDIF
   2977           TCOR(1) = TC1
   2978         ELSE
   2979           TC1 = TCBEST(1)
   2980           PTCOR = TC1
   2981           IF(ABS(TC1).LT.TCLIM) THEN
   2982             TC1 = 0.
   2983             QM = 3.
   2984           ELSE
   2985             CALL CHECKIT(2,XMISS,XMISS, XMISS, XMISS,    XMISS,
   2986      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   2987      &                     TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   2988      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   2989      &                     HYDLMT,HYDLT,XMISS,BLM,BL,XMISS,GOOD)
   2990             IF(GOOD(6,1,2)) THEN
   2991               TC1  = TCBEST(1)
   2992               TC0 = TC1
   2993               CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   2994               CALL ROUND(TC1,POB(LM),3)
   2995               PTCOR = TC1
   2996               CALL CHECKIT(2,XMISS,XMISS, XMISS, XMISS,    XMISS,
   2997      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   2998      &                       TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),

Page 94          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   2999      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   3000      &                       HYDLMT,HYDLT,XMISS,BLM,BL,XMISS,GOOD)
   3001               IF(GOOD(6,1,2)) THEN
   3002                 QM = 1.
   3003               ELSE
   3004                 TC1 = TC0
   3005                 PTCOR = TC1
   3006                 QM = 1.
   3007               ENDIF
   3008             ELSE
   3009               TC1 = 0.
   3010               QM = 13.
   3011             ENDIF
   3012           ENDIF
   3013         ENDIF
   3014         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),3,TC1,
   3015      &    TOB(LM)+TC1,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   3016         SDMQ = .FALSE.
   3017         SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
   3018      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
   3019         IF((QM.EQ.3. .OR. QM.EQ.13.) .AND. QOB(LM).LT.BMISS .AND.
   3020      &     .NOT.SDMQ) THEN
   3021           CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),5,
   3022      &      0.,QOB(LM),0.,QM,IHSC(4,LM),XMISS,XMISS,XMISS)
   3023         ENDIF
   3024 
   3025 C  NO ERROR
   3026 C  --------
   3027 
   3028       ELSEIF(NHYDL.LT.NHLIM .AND. NHYDLM.LT.NHLIM) THEN
   3029 
   3030         IF(TEST) WRITE(60,506) POB(LM)
   3031   506   FORMAT(' ERR123--DECIDED NO HYDROSTATIC ERROR AT: ',F10.1)
   3032 
   3033         RETURN
   3034 
   3035 C  HEIGHT AND TEMPERATURE ERROR POSSIBLE
   3036 C  -------------------------------------
   3037 
   3038       ELSE
   3039         IF(TEST) WRITE(60,503) POB(LM)
   3040   503   FORMAT(' ERR123--Z AND T ERROR AT: ',F10.1)
   3041         ZCOR(1) = (BL*HYDLZ - BLM*HYDLMZ)/(BLM+BL)
   3042         TCOR(1) = (HYDLMT + HYDLT)/(BLM + BL)
   3043         IHSC(2,LM) = 3
   3044         IHSC(3,LM) = 3
   3045         POUT = .TRUE.
   3046         IF(NZI(LM).LT.6) THEN
   3047           ZDIF = ZI(LM)
   3048         ELSE
   3049           ZDIF = ZD(LM)
   3050         ENDIF
   3051         CALL BEST(ZCBEST(1),XMISS,XMISS,ZDIF,XINC(L,1),
   3052      &    ZV(LM),VOIRES(L,1),ZHM(L,IS),HOIRES(L,1),
   3053      &    ZTMP(L,IS),TMPSTD(L,1))
   3054         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
   3055      &    XINC(L,2),TV(LM),VOIRES(L,2),THM(L,IS),HOIRES(L,2),

Page 95          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   3056      &    TTMP(L,IS),TMPSTD(L,2))
   3057         ZR = ABS(ZCOR(1)-ZCBEST(1))/XINC(L,1)
   3058         TR = ABS(TCOR(1)-TCBEST(1))/XINC(L,2)
   3059         IF(TEST) WRITE(60,505) POB(LM),ZR,TR
   3060   505   FORMAT(' ERR123--POB,ZR,TR: ',F10.1,2F8.3)
   3061         IF(ZR.LT.0.20 .AND. TR.LT.0.20) THEN    !All resids agree
   3062           ZC1 = ZCOR(1)                         !Try hydrostatic corrs
   3063           TC1 = TCOR(1)
   3064           CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   3065           CALL ROUND(ZC1,POB(LM),2)
   3066           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   3067           CALL ROUND(TC1,POB(LM),3)
   3068           PZCOR = ZC1
   3069           PTCOR = TC1
   3070           CALL CHECKIT(3,ZC1,  ZDIF,  ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3071      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3072      &                   TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3073      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3074      &                   HYDLMT,HYDLT,XMISS,BLM,BL,XMISS,GOOD)
   3075           IF(ABS(ZC1).LT.ZCLIM) THEN
   3076             IHSC(2,LM) = 0                       !Corrs too small
   3077             ZC1 = 0.
   3078             QMZ = 1.
   3079           ELSEIF(GOOD(6,1,1) .AND. ABS(ZC1).GE.ZCLIM) THEN
   3080             QMZ = 1.                             !Good corr
   3081           ELSE
   3082             ZC1 = 0.                             !Bad corr, but large
   3083             QMZ = 13.                            !Flag value
   3084           ENDIF
   3085           IF(ABS(TC1).LT.TCLIM) THEN
   3086             IHSC(3,LM) = 0                       !Corr too small
   3087             TC1 = 0.
   3088             QMT = 1.
   3089           ELSEIF(GOOD(6,1,2) .AND. ABS(TC1).GE.TCLIM) THEN
   3090             QMT = 1.                             !Good corr
   3091           ELSE
   3092             TC1 = 0.                             !Bad corr, but large
   3093             QMT = 13.                            !Flag value
   3094           ENDIF
   3095         ELSE                             !Disagreement among residuals
   3096           ZC1 = ZCBEST(1)                        !Try best corrs
   3097           TC1 = TCBEST(1)
   3098           CALL ROUND(ZC1,POB(LM),2)
   3099           CALL ROUND(TC1,POB(LM),3)
   3100           PZCOR = ZC1
   3101           PTCOR = TC1
   3102           CALL CHECKIT(3,ZC1,  ZDIF,ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3103      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3104      &                   TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3105      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3106      &                   HYDLMT,HYDLT,XMISS,BLM,BL,XMISS,GOOD)
   3107           ZC0 = ZC1
   3108           TC0 = TC1
   3109           IF(GOOD(6,1,1) .AND. GOOD(6,1,2)) THEN   !Best corrs look good
   3110             CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   3111             CALL ROUND(ZC1,POB(LM),2)
   3112             CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)

Page 96          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   3113             CALL ROUND(TC1,POB(LM),3)
   3114             PZCOR = ZC1
   3115             PTCOR = TC1
   3116             CALL CHECKIT(3,ZC1,  ZDIF,ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3117      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3118      &                     TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3119      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3120      &                     HYDLMT,HYDLT,XMISS,BLM,BL,XMISS,GOOD)
   3121             IF(GOOD(6,1,1) .AND. GOOD(6,1,2)) THEN   !Try simple corrs
   3122               QMZ = 1.
   3123               QMT = 1.
   3124               IF(ABS(ZC1).LT.ZCLIM) THEN
   3125                 IHSC(2,LM) = 0                    !Corr too small
   3126                 ZC1 = 0.
   3127                 QMZ = 1.
   3128               ENDIF
   3129               IF(ABS(TC1).LT.TCLIM) THEN
   3130                 IHSC(3,LM) = 0                    !Corr too small
   3131                 TC1 = 0.
   3132                 QMT = 1.
   3133               ENDIF
   3134               ZCOR(1) = ZC1
   3135               TCOR(1) = TC1
   3136             ELSE                            !Simple corrs not both good
   3137               QMZ = 1.
   3138               QMT = 1.
   3139               ZC1 = ZC0                     !Revert to non-simple corrs
   3140               TC1 = TC0
   3141               IF(ABS(ZC1).LT.ZCLIM) THEN
   3142                 IHSC(2,LM) = 0              !Corr too small
   3143                 ZC1 = 0.
   3144                 QMZ = 1.
   3145               ENDIF
   3146               IF(ABS(TC1).LT.TCLIM) THEN
   3147                 IHSC(3,LM) = 0              !Corr too small
   3148                 TC1 = 0.
   3149                 QMT = 1.
   3150               ENDIF
   3151             ENDIF
   3152           ELSE                                !Check z,T separately
   3153             CALL CHECKIT(3,ZC1,  ZDIF,ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3154      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3155      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3156      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3157      &                     XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
   3158             IF(GOOD(6,1,1)) THEN
   3159               ZC0 = ZC1
   3160               CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   3161               CALL ROUND(ZC1,POB(LM),2)
   3162               PZCOR = ZC1
   3163               CALL CHECKIT(3,ZC1,  ZDIF,ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3164      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   3165      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   3166      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   3167      &                       XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
   3168               IF(GOOD(6,1,1)) THEN           !Simple z-corr is good
   3169                 QMZ = 1.

Page 97          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   3170                 IF(ABS(ZC1).LT.ZCLIM) THEN
   3171                   IHSC(2,LM) = 0             !Corr too small
   3172                   ZC1 = 0.
   3173                   QMZ = 1.
   3174                 ENDIF
   3175                 ZCOR(1) = ZC1
   3176               ELSE                           !Simple corr is not good
   3177                 QMZ = 1.
   3178                 ZC1 = ZC0                    !Revert to non-simple corr
   3179                 PZCOR = ZC1
   3180                 IF(ABS(ZC1).LT.ZCLIM) THEN
   3181                   IHSC(2,LM) = 0             !Corr too small
   3182                   ZC1 = 0.
   3183                   QMZ = 1.
   3184                 ENDIF
   3185               ENDIF
   3186             ENDIF
   3187             CALL CHECKIT(3,XMISS,XMISS, XMISS, XMISS,    XMISS,
   3188      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3189      &                     TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3190      &                     XMISS,XMISS, XMISS, XMISS,    XMISS,
   3191      &                     XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
   3192             IF(GOOD(6,1,2)) THEN
   3193               TC0 = TC1
   3194               CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   3195               CALL ROUND(TC1,POB(LM),3)
   3196               PTCOR = TC1
   3197               CALL CHECKIT(3,XMISS,XMISS, XMISS, XMISS,    XMISS,
   3198      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   3199      &                       TC1,  TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3200      &                       XMISS,XMISS, XMISS, XMISS,    XMISS,
   3201      &                       XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
   3202               IF(GOOD(6,1,2)) THEN
   3203                 QMT = 1.
   3204                 IF(ABS(TC1).LT.TCLIM) THEN
   3205                   IHSC(3,LM) = 0                !Corr too small
   3206                   TC1 = 0.
   3207                   QMT = 1.
   3208                 ENDIF
   3209                 TCOR(1) = TC1
   3210               ELSE
   3211                 TC1 = TC0
   3212                 PTCOR = TC1
   3213                 QMT = 1.
   3214                 IF(ABS(TC1).LT.TCLIM) THEN
   3215                   IHSC(3,LM) = 0
   3216                   TC1 = 0.
   3217                   QMT = 1.
   3218                 ENDIF
   3219               ENDIF
   3220             ENDIF
   3221             IHSC(2,LM) = 0
   3222             IHSC(3,LM) = 0
   3223             ZC1 = 0.                           !Neither corr is good
   3224             TC1 = 0.
   3225             QMZ = 1.
   3226             QMT = 1.

Page 98          Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   3227           ENDIF
   3228         ENDIF
   3229 
   3230         IF(IHSC(2,LM).NE.0) THEN
   3231           CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),2,
   3232      &      ZC1,ZOB(LM)+ZC1,PZCOR,QMZ,IHSC(2,LM),XMISS,XMISS,XMISS)
   3233         ENDIF
   3234         IF(IHSC(3,LM).NE.0) THEN
   3235           CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),3,
   3236      &      TC1,TOB(LM)+TC1,PTCOR,QMT,IHSC(3,LM),XMISS,XMISS,XMISS)
   3237           SDMQ = .FALSE.
   3238           SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
   3239      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
   3240           IF((QMT.EQ.3. .OR. QMT.EQ.13.) .AND. QOB(LM).LT.BMISS .AND.
   3241      &       .NOT.SDMQ) THEN
   3242             CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),5,
   3243      &        0.,QOB(LM),0.,QMT,IHSC(4,LM),XMISS,XMISS,XMISS)
   3244           ENDIF
   3245         ENDIF
   3246 
   3247       ENDIF
   3248 
   3249       RETURN
   3250       END


ENTRY POINTS

  Name               
                     
 err123_             

Page 99          Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  2806                                                           2805                              
 501                        Label  2881                                                           2880                              
 502                        Label  2957                                                           2956                              
 503                        Label  3040                                                           3039                              
 504                        Label  2872                                                           2870                              
 505                        Label  3060                                                           3059                              
 506                        Label  3031                                                           3030                              
 ABS                        Func   2865                                 scalar                    2865,2868,2895,2901,2911,2965,2971
                                                                                                  ,2981,3057,3058,3075,3079,3085,308
                                                                                                  9,3124,3129,3141,3146,3170,3180,32
                                                                                                  04,3214                           
 ALLOW                      Common 2749                                 456                                                         
 ALLSND                     Common 2753                                 34512                                                       
 ALLT                       Scalar 2749     R(4)            4     1     71       COM              2968,2993,3066,3112,3194          
 ALLZ                       Scalar 2749     R(4)            4     1     41       COM              2898,2923,3064,3110,3160          
 ALOG                       Func   2856                                 scalar                    2856                              
 B                          Scalar 2769     R(4)            4     1     21       COM              2821,2833,2839                    
 BASRES                     Scalar 2768     R(4)            4     1     999      COM              2853,2854                         
 BEST                       Subr   2892                                                           2892,2962,3051,3054               
 BL                         Local  2821     R(4)            4           scalar                    2821,2826,2867,2868,2871,2919,2930
                                                                                                  ,2959,2989,3000,3041,3042,3074,310
                                                                                                  6,3120                            
 BLM                        Local  2833     R(4)            4           scalar                    2833,2839,2844,2850,2856,2857,2867
                                                                                                  ,2868,2871,2919,2930,2959,2989,300
                                                                                                  0,3041,3042,3074,3106,3120        
 BMISS                      Scalar 2747     R(8)            8           scalar   COM              2812,2823,2824,2826,2829,2835,2841
                                                                                                  ,2842,2844,2847,2848,2850,2857,286
                                                                                                  2,2863,2864,3019,3240             
 BRES                       Scalar 2782     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 2798                                 16                                                          
 CAT                        Scalar 2758     R(4)            4     1     255      COM                                                
 CHECKIT                    Subr   2915                                                           2915,2926,2985,2996,3070,3102,3116
                                                                                                  ,3153,3163,3187,3197              
 CONSTS                     Common 2791                                 20                                                          
 CP                         Scalar 2791     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 2793     R(4)            4           scalar   COM                                                
 DHR                        Scalar 2750     R(4)            4     1     999      COM                                                
 ELV                        Scalar 2751     R(4)            4     1     999      COM                                                
 ERR123                     Subr   2744                                                                                             
 ERROR                      Scalar 2782     L(4)            4     1     999      COM                                                
 G                          Scalar 2791     R(4)            4           scalar   COM              2856                              
 GESPS                      Scalar 2759     R(4)            4     1     999      COM                                                
 GOOD                       Local  2802     L(4)            4     3     24                        2919,2920,2930,2936,2989,2990,3000
                                                                                                  ,3001,3074,3079,3089,3106,3109,312
                                                                                                  0,3121,3157,3158,3167,3168,3191,31
                                                                                                  92,3201,3202                      
 H1                         Scalar 2795     R(4)            4           scalar   COM              2862,2865,2870,2878,2955          
 H2                         Scalar 2795     R(4)            4           scalar   COM              2863,2867,2870,2878,2955          
 HEADER                     Common 2750                                 35980                                                       
 HOIRES                     Scalar 2788     R(4)            4     2     84       COM              2893,2963,3052,3055               
 HRDR                       Scalar 2759     R(4)            4     1     255      COM                                                

Page 100         Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HSCRES                     Scalar 2788     R(4)            4     1     21       COM                                                
 HYD                        Scalar 2767     R(4)            4     1     21       COM              2819,2831,2837                    
 HYDLMT                     Local  2830     R(4)            4           scalar                    2830,2836,2841,2847,2853,2868,2871
                                                                                                  ,2959,2989,3000,3042,3074,3106,312
                                                                                                  0                                 
 HYDLMZ                     Local  2831     R(4)            4           scalar                    2831,2837,2842,2848,2854,2865,2870
                                                                                                  ,2884,2919,2930,3041              
 HYDLT                      Local  2818     R(4)            4           scalar                    2818,2823,2868,2870,2959,2989,3000
                                                                                                  ,3042,3074,3106,3120              
 HYDLZ                      Local  2819     R(4)            4           scalar                    2819,2824,2865,2870,2884,2919,2930
                                                                                                  ,3041                             
 HYDM                       Scalar 2782     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 2767     R(4)            4     1     21       COM              2818,2829,2830,2835,2836          
 HYDQ                       Scalar 2767     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 2767     R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 2795                                 64                                                          
 IHSC                       Scalar 2768     I(4)            4     2     1020     COM              2885,2950,2960,3015,3022,3043,3044
                                                                                                  ,3076,3086,3125,3130,3142,3147,317
                                                                                                  1,3181,3205,3215,3221,3222,3230,32
                                                                                                  32,3234,3236,3243                 
 IMISS                      Scalar 2798     I(4)            4           scalar   COM                                                
 IND                        Scalar 2758     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 2793     I(4)            4           scalar   COM                                                
 IS                         Scalar 2794     I(4)            4           scalar   COM              2805,2853,2854,2856,2893,2894,2915
                                                                                                  ,2926,2949,2963,2964,2987,2998,301
                                                                                                  4,3021,3052,3053,3055,3056,3070,30
                                                                                                  72,3102,3104,3116,3118,3153,3163,3
                                                                                                  189,3199,3231,3235,3242           
 ISC                        Scalar 2793     I(4)            4           scalar   COM                                                
 ISF                        Scalar 2752     I(4)            4     1     999      COM                                                
 ITERR                      Scalar 2787     I(4)            4     1     4        COM                                                
 ITP                        Scalar 2751     I(4)            4     1     999      COM                                                
 L                          Dummy  2744     I(4)            4           scalar   ARG,INOUT        2805,2818,2819,2820,2821,2829,2830
                                                                                                  ,2831,2832,2833,2834,2835,2836,283
                                                                                                  7,2838,2839,2892,2893,2894,2895,29
                                                                                                  15,2926,2963,2964,2965,2987,2998,3
                                                                                                  051,3052,3053,3055,3056,3057,3058,
                                                                                                  3070,3072,3102,3104,3116,3118,3153
                                                                                                  ,3163,3189,3199                   
 LAST                       Scalar 2796     I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 2758     I(4)            4     1     255      COM              2949,3014,3021,3231,3235,3242     
 LIMS                       Common 2788                                 1776                                                        
 LM                         Dummy  2744     I(4)            4           scalar   ARG,INOUT        2805,2817,2828,2852,2856,2870,2880
                                                                                                  ,2885,2887,2888,2890,2893,2898,289
                                                                                                  9,2915,2923,2924,2926,2949,2950,29
                                                                                                  56,2960,2962,2963,2968,2969,2987,2
                                                                                                  993,2994,2998,3014,3015,3017,3018,
                                                                                                  3019,3021,3022,3030,3039,3043,3044
                                                                                                  ,3046,3047,3049,3052,3054,3055,305
                                                                                                  9,3064,3065,3066,3067,3070,3072,30
                                                                                                  76,3086,3098,3099,3102,3104,3110,3
                                                                                                  111,3112,3113,3116,3118,3125,3130,
                                                                                                  3142,3147,3153,3160,3161,3163,3171
                                                                                                  ,3181,3189,3194,3195,3199,3205,321
                                                                                                  5,3221,3222,3230,3231,3232,3234,32

Page 101         Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  35,3236,3238,3239,3240,3242,3243  
 LMAND                      Scalar 2793     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 2793     I(4)            4           scalar   COM                                                
 LST                        Scalar 2759     I(4)            4     1     255      COM              2805,2817,2828,2852,2949,3014,3021
                                                                                                  ,3231,3235,3242                   
 MAND                       Scalar 2792     I(4)            4           scalar   COM                                                
 MANRES                     Common 2771                                 2949048                                                     
 NALLT                      Scalar 2749     I(4)            4           scalar   COM              2968,2993,3066,3112,3194          
 NALLZ                      Scalar 2749     I(4)            4           scalar   COM              2898,2923,3064,3110,3160          
 NBAS                       Scalar 2769     I(4)            4           scalar   COM              2855                              
 NEV                        Scalar 2752     I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 2790     I(4)            4           scalar   COM              2879,3028                         
 NHYD                       Scalar 2767     I(4)            4     1     21       COM              2820,2832,2838                    
 NHYDL                      Local  2820     I(4)            4           scalar                    2820,2825,2843,2849,2879,3028     
 NHYDLM                     Local  2812     I(4)            4           scalar                    2812,2832,2838,2855,2879,3028     
 NHYDN                      Scalar 2769     I(4)            4     1     21       COM                                                
 NLEV                       Scalar 2792     I(4)            4           scalar   COM                                                
 NLV                        Scalar 2751     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 2752     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 2752     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 2792     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 2779     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 2763     I(4)            4     1     255      COM                                                
 NQV                        Scalar 2765     I(4)            4     1     255      COM                                                
 NST                        Param  2745     I(4)            4           scalar                    2750,2751,2752,2759,2768,2771,2772
                                                                                                  ,2773,2774,2775,2776,2777,2778,277
                                                                                                  9,2780,2781,2782,2783,2784,2785,27
                                                                                                  86                                
 NTDHM                      Scalar 2779     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 2763     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 2774     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 2765     I(4)            4     1     255      COM                                                
 NTHM                       Scalar 2777     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 2763     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 2774     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 2765     I(4)            4     1     255      COM                                                
 NTTMP                      Scalar 2786     I(4)            4     2     20979    COM                                                
 NTV                        Scalar 2765     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 2777     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 2763     I(4)            4     1     255      COM              2887,3046                         
 NZIM                       Scalar 2774     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 2786     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 2765     I(4)            4     1     255      COM                                                
 PARAMS                     Common 2792                                 148                                                         
 PFC                        Scalar 2753     R(4)            4     1     255      COM                                                
 PI                         Scalar 2761     R(4)            4     1     255      COM                                                
 PIS                        Scalar 2782     R(4)            4     1     999      COM                                                
 POB                        Scalar 2753     R(4)            4     1     255      COM              2805,2856,2870,2880,2899,2924,2949
                                                                                                  ,2956,2969,2994,3014,3021,3030,303
                                                                                                  9,3059,3065,3067,3098,3099,3111,31
                                                                                                  13,3161,3195,3231,3235,3242       
 POUT                       Scalar 2796     L(4)            4           scalar   COM              2886,2961,3045                    
 PQM                        Scalar 2753     R(4)            4     1     255      COM                                                
 PRC                        Scalar 2753     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 2793     L(4)            4           scalar   COM                                                

Page 102         Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PS                         Scalar 2759     R(4)            4     1     999      COM              2856                              
 PSCOR                      Scalar 2796     R(4)            4           scalar   COM                                                
 PSINC                      Scalar 2768     R(4)            4           scalar   COM                                                
 PTCOR                      Local  2970     R(4)            4           scalar                    2970,2980,2995,3005,3015,3069,3101
                                                                                                  ,3115,3196,3212,3236              
 PZCOR                      Local  2900     R(4)            4           scalar                    2900,2910,2925,2940,2950,3068,3100
                                                                                                  ,3114,3162,3179,3232              
 QFC                        Scalar 2757     R(4)            4     1     255      COM                                                
 QG                         Scalar 2781     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 2772     R(4)            4     2     20979    COM                                                
 QI                         Scalar 2761     R(4)            4     1     255      COM                                                
 QIM                        Scalar 2771     R(4)            4     2     20979    COM                                                
 QM                         Local  2809     R(4)            4           scalar                    2809,2903,2905,2913,2937,2941,2945
                                                                                                  ,2950,2973,2975,2983,3002,3006,301
                                                                                                  0,3015,3019,3022                  
 QMT                        Local  2810     R(4)            4           scalar                    2810,3088,3090,3093,3123,3132,3138
                                                                                                  ,3149,3203,3207,3213,3217,3226,323
                                                                                                  6,3240,3243                       
 QMZ                        Local  2811     R(4)            4           scalar                    2811,3078,3080,3083,3122,3127,3137
                                                                                                  ,3144,3169,3173,3177,3183,3225,323
                                                                                                  2                                 
 QOB                        Scalar 2757     R(4)            4     1     255      COM              3019,3022,3240,3243               
 QQM                        Scalar 2757     R(4)            4     1     255      COM              3017,3018,3238,3239               
 QRC                        Scalar 2757     R(4)            4     1     255      COM                                                
 QV                         Scalar 2762     R(4)            4     1     255      COM                                                
 QVM                        Scalar 2773     R(4)            4     2     20979    COM                                                
 R                          Scalar 2791     R(4)            4           scalar   COM              2856                              
 RADPC                      Scalar 2792     R(4)            4           scalar   COM                                                
 RESID                      Common 2761                                 41312                                                       
 ROUND                      Subr   2899                                                           2899,2924,2969,2994,3065,3067,3098
                                                                                                  ,3099,3111,3113,3161,3195         
 RV                         Scalar 2791     R(4)            4           scalar   COM                                                
 SDMQ                       Local  2800     L(4)            4           scalar                    3016,3017,3020,3237,3238,3241     
 SEVENT                     Subr   2949                                                           2949,3014,3021,3231,3235,3242     
 SID                        Scalar 2750     CHAR            8     1     999      COM              2805,2949,3014,3021,3231,3235,3242
 SIMPLE                     Subr   2898                                                           2898,2923,2968,2993,3064,3066,3110
                                                                                                  ,3112,3160,3194                   
 SQN                        Scalar 2751     R(4)            4     1     999      COM              2949,3014,3021,3231,3235,3242     
 SQRT                       Func   2867                                 scalar                    2867                              
 STN                        Common 2794                                 4                                                           
 T0                         Scalar 2791     R(4)            4           scalar   COM                                                
 T1                         Scalar 2795     R(4)            4           scalar   COM              2864,2868,2870,2878,2955          
 TC0                        Local  2992     R(4)            4           scalar                    2992,3004,3108,3140,3193,3211     
 TC1                        Local  2967     R(4)            4           scalar                    2967,2968,2969,2970,2971,2972,2977
                                                                                                  ,2979,2980,2981,2982,2987,2991,299
                                                                                                  2,2993,2994,2995,2998,3004,3005,30
                                                                                                  09,3014,3015,3063,3066,3067,3069,3
                                                                                                  072,3085,3087,3089,3092,3097,3099,
                                                                                                  3101,3104,3108,3112,3113,3115,3118
                                                                                                  ,3129,3131,3135,3140,3146,3148,318
                                                                                                  9,3193,3194,3195,3196,3199,3204,32
                                                                                                  06,3209,3211,3212,3214,3216,3224,3
                                                                                                  236                               
 TCBEST                     Scalar 2795     R(4)            4     1     2        COM              2962,2965,2979,2991,3054,3058,3097
 TCLIM                      Scalar 2790     R(4)            4           scalar   COM              2971,2981,3085,3089,3129,3146,3204

Page 103         Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,3214                             
 TCOR                       Scalar 2795     R(4)            4     1     2        COM              2959,2965,2967,2977,3042,3058,3063
                                                                                                  ,3135,3209                        
 TDFC                       Scalar 2756     R(4)            4     1     255      COM                                                
 TDG                        Scalar 2781     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 2772     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 2761     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 2771     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 2756     R(4)            4     1     255      COM                                                
 TDV                        Scalar 2762     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 2773     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 2797     L(4)            4           scalar   COM              2805,2870,2880,2956,3030,3039,3059
 TESTS                      Common 2797                                 4                                                           
 TFACT                      Scalar 2789     R(4)            4     2     84       COM                                                
 TFC                        Scalar 2755     R(4)            4     1     255      COM                                                
 TG                         Scalar 2781     L(4)            4     2     20979    COM                                                
 THM                        Scalar 2772     R(4)            4     2     20979    COM              2963,2987,2998,3055,3072,3104,3118
                                                                                                  ,3189,3199                        
 TI                         Scalar 2761     R(4)            4     1     255      COM              2962,2987,2998,3054,3072,3104,3118
                                                                                                  ,3189,3199                        
 TIM                        Scalar 2771     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 2784     R(4)            4     3     83916    COM                                                
 TL                         Scalar 2762     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 2768     R(4)            4     1     255      COM                                                
 TMPSND                     Common 2783                                 1678336                                                     
 TMPSTD                     Scalar 2789     R(4)            4     2     84       COM              2894,2964,3053,3056               
 TOB                        Scalar 2755     R(4)            4     1     255      COM              2968,2993,3015,3066,3112,3194,3236
 TOBT                       Scalar 2783     R(4)            4     3     83916    COM                                                
 TQM                        Scalar 2755     R(4)            4     1     255      COM                                                
 TR                         Local  2965     R(4)            4           scalar                    2965,2966,3058,3059,3061          
 TRC                        Scalar 2755     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 2796     R(4)            4           scalar   COM                                                
 TT                         Scalar 2793     R(4)            4           scalar   COM              2867,2878,2955                    
 TTMP                       Scalar 2785     R(4)            4     2     20979    COM              2964,2987,2998,3056,3072,3104,3118
                                                                                                  ,3189,3199                        
 TV                         Scalar 2762     R(4)            4     1     255      COM              2963,2987,2998,3055,3072,3104,3118
                                                                                                  ,3189,3199                        
 TVM                        Scalar 2773     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 2756     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 2789     R(4)            4     2     84       COM              2893,2963,3052,3055               
 VTPPC                      Scalar 2792     R(4)            4           scalar   COM                                                
 XDR                        Scalar 2760     R(4)            4     1     255      COM                                                
 XINC                       Scalar 2788     R(4)            4     2     84       COM              2892,2895,2963,2965,3051,3055,3057
                                                                                                  ,3058                             
 XMA                        Scalar 2792     R(4)            4           scalar   COM                                                
 XMI                        Scalar 2792     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 2798     R(4)            4           scalar   COM              2892,2916,2917,2918,2919,2927,2928
                                                                                                  ,2929,2930,2950,2962,2985,2986,298
                                                                                                  8,2989,2996,2997,2999,3000,3015,30
                                                                                                  22,3051,3054,3071,3073,3074,3103,3
                                                                                                  105,3106,3117,3119,3120,3154,3155,
                                                                                                  3156,3157,3164,3165,3166,3167,3187
                                                                                                  ,3188,3190,3191,3197,3198,3200,320
                                                                                                  1,3232,3236,3243                  
 XOB                        Scalar 2750     R(4)            4     1     999      COM                                                

Page 104         Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XQHM                       Scalar 2780     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 2764     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 2776     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 2766     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 2770     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 2779     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 2764     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 2775     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 2766     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 2778     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 2769     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 2778     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 2764     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 2775     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 2766     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 2776     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 2769     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 2777     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 2764     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 2775     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 2766     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 2776     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 2760     R(4)            4     1     255      COM                                                
 YMA                        Scalar 2792     R(4)            4           scalar   COM                                                
 YMI                        Scalar 2792     R(4)            4           scalar   COM                                                
 YOB                        Scalar 2750     R(4)            4     1     999      COM                                                
 ZC0                        Local  2922     R(4)            4           scalar                    2922,2939,3107,3139,3159,3178     
 ZC1                        Local  2897     R(4)            4           scalar                    2897,2898,2899,2900,2901,2902,2907
                                                                                                  ,2909,2910,2911,2912,2915,2921,292
                                                                                                  2,2923,2924,2925,2926,2939,2940,29
                                                                                                  44,2949,2950,3062,3064,3065,3068,3
                                                                                                  070,3075,3077,3079,3082,3096,3098,
                                                                                                  3100,3102,3107,3110,3111,3114,3116
                                                                                                  ,3124,3126,3134,3139,3141,3143,315
                                                                                                  3,3159,3160,3161,3162,3163,3170,31
                                                                                                  72,3175,3178,3179,3180,3182,3223,3
                                                                                                  232                               
 ZCBEST                     Scalar 2795     R(4)            4     1     2        COM              2892,2895,2909,2921,3051,3057,3096
 ZCLIM                      Scalar 2790     R(4)            4           scalar   COM              2901,2911,3075,3079,3124,3141,3170
                                                                                                  ,3180                             
 ZCOR                       Scalar 2795     R(4)            4     1     2        COM              2884,2895,2897,2907,3041,3057,3062
                                                                                                  ,3134,3175                        
 ZD                         Scalar 2769     R(4)            4     1     255      COM              2890,3049                         
 ZDIF                       Local  2888     R(4)            4           scalar                    2888,2890,2892,2915,2926,3047,3049
                                                                                                  ,3051,3070,3102,3116,3153,3163    
 ZFC                        Scalar 2754     R(4)            4     1     255      COM                                                
 ZG                         Scalar 2781     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 2772     R(4)            4     2     20979    COM              2893,2915,2926,3052,3070,3102,3116
                                                                                                  ,3153,3163                        
 ZI                         Scalar 2761     R(4)            4     1     255      COM              2888,3047                         
 ZIM                        Scalar 2771     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 2784     R(4)            4     3     83916    COM                                                
 ZOB                        Scalar 2754     R(4)            4     1     255      COM              2898,2923,2950,3064,3110,3160,3232
 ZOBT                       Scalar 2783     R(4)            4     3     83916    COM                                                
 ZQM                        Scalar 2754     R(4)            4     1     255      COM                                                

Page 105         Source Listing                  ERR123
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZR                         Local  2895     R(4)            4           scalar                    2895,2896,3057,3059,3061          
 ZRC                        Scalar 2754     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 2796     R(4)            4           scalar   COM                                                
 ZTMP                       Scalar 2785     R(4)            4     2     20979    COM              2894,2915,2926,3053,3070,3102,3116
                                                                                                  ,3153,3163                        
 ZV                         Scalar 2762     R(4)            4     1     255      COM              2893,2915,2926,3052,3070,3102,3116
                                                                                                  ,3153,3163                        
 ZVM                        Scalar 2773     R(4)            4     2     20979    COM                                                

Page 106         Source Listing                  ERR123
2017-04-18 11:07                                 cqcbufr.f

   3251 
   3252 C******************************************************************
   3253 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3254 C                .      .    .                                       .
   3255 C SUBPROGRAM:    ERR5        DETERMINE ERRORS AT THE TOP LEVEL
   3256 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   3257 C
   3258 C ABSTRACT: Determine errors of type 5: top mandatory level.  Diagnosis
   3259 C   is for surface types 131: mand, middle, lower hole boundary, and
   3260 C   type 140: mandatory, top.
   3261 C
   3262 C PROGRAM HISTORY LOG:
   3263 C 1997-03-18  W. Collins  Original author.
   3264 C
   3265 C USAGE:    CALL ERR5(L,LM)
   3266 C   INPUT ARGUMENT LIST:
   3267 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
   3268 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
   3269 C
   3270 C   OUTPUT FILES:
   3271 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   3272 C
   3273 C REMARKS: NONE.
   3274 C
   3275 C ATTRIBUTES:
   3276 C   LANGUAGE: FORTRAN 90
   3277 C   MACHINE:  NCEP WCOSS
   3278 C
   3279 C$$$
   3280 
   3281       SUBROUTINE ERR5(L,LM)
   3282       PARAMETER (NST=999)
   3283 
   3284       REAL(8) BMISS
   3285 
   3286       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   3287      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   3288      &                 NEV, ISF(NST), NLVM, NLVW
   3289       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   3290      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   3291      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   3292      &                 TDO(255), TDFC(255),TVO(255),
   3293      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   3294      &                 CAT(255), IND(255), LEVTYP(255),
   3295      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   3296      &                 YDR(255), XDR(255)
   3297       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   3298      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   3299      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   3300      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   3301      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   3302      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   3303      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   3304      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   3305      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   3306      &                 XTDH(255)
   3307       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),

Page 107         Source Listing                  ERR5
2017-04-18 11:07                                 cqcbufr.f

   3308      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   3309      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   3310      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   3311      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   3312      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   3313      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   3314      &                 XTHM(21,NST),XTDVM(21,NST),
   3315      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   3316      &                 XQHM(21,NST),
   3317      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   3318      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   3319       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   3320      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   3321      &                 ZTMP(21,NST),   TTMP(21,NST),
   3322      &                 NZTMP(21,NST),  NTTMP(21,NST),
   3323      &                 ITERR(4)
   3324       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   3325      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   3326      &                 ZCLIM, TCLIM, NHLIM
   3327       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
   3328       COMMON /STN/     IS
   3329       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   3330      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   3331       COMMON /TESTS/   TEST
   3332       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   3333 
   3334       LOGICAL          TEST
   3335       CHARACTER*8 SID
   3336       LOGICAL POUT, GOOD(6,2,2)
   3337       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
   3338 
   3339       IF(TEST) WRITE(60,500) SID(IS)
   3340   500 FORMAT(' ERR5--CALLED FOR: ',A8)
   3341 
   3342 C  TYPE 131: MAND,MIDDLE, LOWER HOLE BOUNDARY AND
   3343 C  TYPE 140: MAND, TOP
   3344 C  -------------------------------------------------
   3345 C  CALCULATE THE ERROR, BASED UPON ONLY HEIGHT ERROR
   3346 C  OR ONLY TEMPERATURE ERROR.
   3347 C  -------------------------------------------------
   3348 
   3349       IF(HYDN(L-1).NE.BMISS) THEN
   3350         ZCOR(1) = -HYDS(L-1)
   3351         TCOR(1) = HYDN(L-1)/B(L-1)
   3352       ELSEIF(HYDN(L-2).NE.BMISS) THEN
   3353         ZCOR(1) = -HYDS(L-2)
   3354         TCOR(1) = HYDN(L-2)/B(L-2)
   3355       ENDIF
   3356 
   3357 C  CALCULATE THE STATISTICALLY BEST COR FROM OTHER RESIDUALS
   3358 C  ---------------------------------------------------------
   3359 
   3360       IF(NZI(LM).LT.6) THEN
   3361         ZDIF = ZI(LM)
   3362       ELSE
   3363         ZDIF = ZD(LM)
   3364       ENDIF

Page 108         Source Listing                  ERR5
2017-04-18 11:07                                 cqcbufr.f

   3365       CALL BEST(ZCBEST(1),XMISS,XMISS,ZDIF,
   3366      &  XINC(L,1),ZV(LM),VOIRES(L,1),ZHM(L,IS),HOIRES(L,1),
   3367      &  ZTMP(L,IS),TMPSTD(L,1))
   3368       CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
   3369      &  XINC(L,2),TV(LM),VOIRES(L,2),THM(L,IS),HOIRES(L,2),
   3370      &  TTMP(L,IS),TMPSTD(L,2))
   3371 
   3372       IF(TEST) WRITE(60,501) ZCOR(1),TCOR(1),ZCBEST(1),TCBEST(1)
   3373   501 FORMAT(' ERR5--ZCOR,TCOR,ZCBEST,TCBEST: ',4F10.1)
   3374 
   3375 C  SEE IF HYDROSTATIC AND BEST CORS FIT A HEIGHT ERROR
   3376 C  ---------------------------------------------------
   3377 
   3378       ZR = ABS(ZCOR(1)-ZCBEST(1))/XINC(L,1)
   3379       IF(ZR.LT.0.25) THEN
   3380         ZC = ZCOR(1)
   3381         CALL SIMPLE(ZC,ZOB(LM),ALLZ,NALLZ,1.)
   3382         CALL ROUND(ZC,POB(LM),2)
   3383         PZCOR = ZC
   3384         IF(ABS(ZC).LT.ZCLIM) THEN
   3385           ZC = 0.
   3386           QM = 1.
   3387           ZCOR(1) = ZC
   3388         ELSE
   3389           ZCOR(1) = ZC
   3390           CALL CHECKIT(1,ZC,   ZD(LM),ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3391      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3392      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3393      &                   XMISS,XMISS, XMISS, XMISS,    XMISS,
   3394      &         HYDN(L-1),HYDN(L),XMISS,B(L-1),B(L),XMISS,GOOD)
   3395           IF(GOOD(6,1,1)) THEN
   3396             QM = 1.
   3397             IHSC(2,LM) = 5
   3398             POUT = .TRUE.
   3399             CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3400      &        2,ZC,ZOB(LM)+ZC,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   3401             RETURN
   3402           ENDIF
   3403         ENDIF
   3404       ENDIF
   3405 
   3406 C  SEE IF HYDROSTATIC AND BEST CORS FIT A TEMPERATURE ERROR
   3407 C  --------------------------------------------------------
   3408 
   3409       TR = ABS(TCOR(1)-TCBEST(1))/XINC(L,2)
   3410       IF(TR.LT.0.25) THEN
   3411         TC = TCOR(1)
   3412         CALL SIMPLE(TC,TOB(LM),ALLT,NALLT,10.)
   3413         CALL ROUND(TC,POB(LM),3)
   3414         PTCOR = TC
   3415         IF(ABS(TC).LT.TCLIM) THEN
   3416           TC = 0.
   3417           QM = 0.
   3418           TCOR(1) = TC
   3419         ELSE
   3420           TCOR(1) = TC
   3421           CALL CHECKIT(2,XMISS,  XMISS,  XMISS,  XMISS,    XMISS,

Page 109         Source Listing                  ERR5
2017-04-18 11:07                                 cqcbufr.f

   3422      &                   XMISS,  XMISS,  XMISS,  XMISS,    XMISS,
   3423      &                   TC,     TI(LM), TV(LM), THM(L,IS),TTMP(L,IS),
   3424      &                   XMISS,  XMISS,  XMISS,  XMISS,    XMISS,
   3425      &         HYDN(L-1),HYDN(L),XMISS,B(L-1),B(L),XMISS,GOOD)
   3426           IF(GOOD(6,1,2)) THEN
   3427             QM = 1.
   3428             IHSC(3,LM) = 5
   3429             POUT = .TRUE.
   3430             CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3431      &        3,TC,TOB(LM)+TC,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   3432             RETURN
   3433           ENDIF
   3434         ENDIF
   3435       ENDIF
   3436 
   3437 C  TRY TYPE 3 CORRECTION
   3438 C  ---------------------
   3439 
   3440       ZC = ZCBEST(1)
   3441       IF(ZC.NE.BMISS) THEN
   3442         CALL SIMPLE(ZC,ZOB(LM),ALLZ,NALLZ,1.)
   3443         CALL ROUND(ZC,POB(LM),2)
   3444       ENDIF
   3445       PZCOR = ZC
   3446       TC = TCBEST(1)
   3447       IF(TC.NE.BMISS) THEN
   3448         CALL SIMPLE(TC,TOB(LM),ALLT,NALLT,10.)
   3449         CALL ROUND(TC,POB(LM),3)
   3450       ENDIF
   3451       PTCOR = TC
   3452       IF(ZC.NE.BMISS .AND. TC.NE.BMISS .AND.
   3453      &  ABS(ZC).GT.ZCLIM .AND. ABS(TC).GT.TCLIM) THEN
   3454         ZCOR(1) = ZC
   3455         TCOR(1) = TC
   3456         CALL CHECKIT(3,ZC,   ZD(LM),ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3457      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3458      &                 TC,   TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3459      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3460      &       HYDN(L-1),HYDN(L),XMISS,B(L-1),B(L),XMISS,GOOD)
   3461       ELSEIF(ZC.NE.BMISS .AND. ABS(ZC).GT.ZCLIM) THEN
   3462         TC = 0.
   3463         CALL CHECKIT(3,ZC,   ZD(LM),ZV(LM),ZHM(L,IS),ZTMP(L,IS),
   3464      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3465      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3466      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3467      &       HYDN(L-1),HYDN(L),XMISS,B(L-1),B(L),XMISS,GOOD)
   3468       ELSEIF(TC.NE.BMISS .AND. ABS(TC).GT.TCLIM) THEN
   3469         ZC = 0.
   3470         CALL CHECKIT(3,XMISS,XMISS, XMISS, XMISS,    XMISS,
   3471      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3472      &                 TC,   TI(LM),TV(LM),THM(L,IS),TTMP(L,IS),
   3473      &                 XMISS,XMISS, XMISS, XMISS,    XMISS,
   3474      &       HYDN(L-1),HYDN(L),XMISS,B(L-1),B(L),XMISS,GOOD)
   3475       ELSE
   3476         ZC = 0.
   3477         TC = 0.
   3478         GOOD(6,1,1) = .FALSE.

Page 110         Source Listing                  ERR5
2017-04-18 11:07                                 cqcbufr.f

   3479         GOOD(6,1,2) = .FALSE.
   3480       ENDIF
   3481       IF(GOOD(6,1,1)) THEN
   3482         QM = 1.
   3483         IHSC(2,LM) = 5
   3484         POUT = .TRUE.
   3485         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3486      &    2,ZC,ZOB(LM)+ZC,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   3487       ENDIF
   3488       IF(GOOD(6,1,2)) THEN
   3489         QM = 1.
   3490         IHSC(3,LM) = 5
   3491         POUT = .TRUE.
   3492         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3493      &    3,TC,TOB(LM)+TC,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   3494       ENDIF
   3495       IF(GOOD(6,1,1) .OR. GOOD(6,1,2)) RETURN
   3496 
   3497 C  OTHERWISE, FLAG BOTH AS QUESTIONABLE OR BAD
   3498 C  -------------------------------------------
   3499 
   3500       IHSC(2,LM) = 5
   3501       IHSC(3,LM) = 5
   3502       IF(ABS(ZCOR(1)).GT.XINC(L,1)) THEN
   3503         QM = 13.
   3504         ZC = 0.
   3505         ZCOR(1) = 0.
   3506         POUT = .TRUE.
   3507         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3508      &    2,ZC,ZOB(LM)+ZC,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   3509       ELSE
   3510 C       QM = 3.
   3511 C       ZC = 0.
   3512 C       ZCOR(1) = 0.
   3513 C       POUT = .TRUE.
   3514 C       CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3515 C    &    2,ZC,ZOB(LM)+ZC,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   3516       ENDIF
   3517 
   3518       IF(ABS(TCOR(1)).GT.XINC(L,2)) THEN
   3519         QM = 13.
   3520         TC = 0.
   3521         TCOR(1) = 0.
   3522         POUT = .TRUE.
   3523         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3524      &    3,TC,TOB(LM)+TC,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   3525       ELSE
   3526 C       QM = 3.
   3527 C       TC = 0.
   3528 C       TCOR(1) = 0.
   3529 C       POUT = .TRUE.
   3530 C       CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   3531 C    &    3,TC,TOB(LM)+TC,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   3532       ENDIF
   3533 
   3534       RETURN
   3535       END

Page 111         Source Listing                  ERR5
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 err5_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  3340                                                           3339                              
 501                        Label  3373                                                           3372                              
 ABS                        Func   3378                                 scalar                    3378,3384,3409,3415,3453,3461,3468
                                                                                                  ,3502,3518                        
 ALLOW                      Common 3327                                 456                                                         
 ALLSND                     Common 3289                                 34512                                                       
 ALLT                       Scalar 3327     R(4)            4     1     71       COM              3412,3448                         
 ALLZ                       Scalar 3327     R(4)            4     1     41       COM              3381,3442                         
 B                          Scalar 3305     R(4)            4     1     21       COM              3351,3354,3394,3425,3460,3467,3474
 BASRES                     Scalar 3304     R(4)            4     1     999      COM                                                
 BEST                       Subr   3365                                                           3365,3368                         
 BMISS                      Scalar 3284     R(8)            8           scalar   COM              3349,3352,3441,3447,3452,3461,3468
 BRES                       Scalar 3318     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 3332                                 16                                                          
 CAT                        Scalar 3294     R(4)            4     1     255      COM                                                
 CHECKIT                    Subr   3390                                                           3390,3421,3456,3463,3470          
 DHR                        Scalar 3286     R(4)            4     1     999      COM                                                
 ELV                        Scalar 3287     R(4)            4     1     999      COM                                                
 ERR5                       Subr   3281                                                                                             
 ERROR                      Scalar 3318     L(4)            4     1     999      COM                                                
 GESPS                      Scalar 3295     R(4)            4     1     999      COM                                                
 GOOD                       Local  3336     L(4)            4     3     24                        3394,3395,3425,3426,3460,3467,3474
                                                                                                  ,3478,3479,3481,3488,3495         
 H1                         Scalar 3329     R(4)            4           scalar   COM                                                
 H2                         Scalar 3329     R(4)            4           scalar   COM                                                
 HEADER                     Common 3286                                 35980                                                       
 HOIRES                     Scalar 3324     R(4)            4     2     84       COM              3366,3369                         
 HRDR                       Scalar 3295     R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 3324     R(4)            4     1     21       COM                                                
 HYD                        Scalar 3303     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 3318     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 3303     R(4)            4     1     21       COM              3349,3351,3352,3354,3394,3425,3460
                                                                                                  ,3467,3474                        
 HYDQ                       Scalar 3303     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 3303     R(4)            4     1     21       COM              3350,3353                         
 HYDSTUF                    Common 3329                                 64                                                          
 IHSC                       Scalar 3304     I(4)            4     2     1020     COM              3397,3400,3428,3431,3483,3486,3490
                                                                                                  ,3493,3500,3501,3508,3524         
 IMISS                      Scalar 3332     I(4)            4           scalar   COM                                                
 IND                        Scalar 3294     I(4)            4     1     255      COM                                                
 IS                         Scalar 3328     I(4)            4           scalar   COM              3339,3366,3367,3369,3370,3390,3399
                                                                                                  ,3423,3430,3456,3458,3463,3472,348
                                                                                                  5,3492,3507,3523                  
 ISF                        Scalar 3288     I(4)            4     1     999      COM                                                

Page 112         Source Listing                  ERR5
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ITERR                      Scalar 3323     I(4)            4     1     4        COM                                                
 ITP                        Scalar 3287     I(4)            4     1     999      COM                                                
 L                          Dummy  3281     I(4)            4           scalar   ARG,INOUT        3349,3350,3351,3352,3353,3354,3366
                                                                                                  ,3367,3369,3370,3378,3390,3394,340
                                                                                                  9,3423,3425,3456,3458,3460,3463,34
                                                                                                  67,3472,3474,3502,3518            
 LAST                       Scalar 3330     I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 3294     I(4)            4     1     255      COM              3399,3430,3485,3492,3507,3523     
 LIMS                       Common 3324                                 1776                                                        
 LM                         Dummy  3281     I(4)            4           scalar   ARG,INOUT        3360,3361,3363,3366,3368,3369,3381
                                                                                                  ,3382,3390,3397,3399,3400,3412,341
                                                                                                  3,3423,3428,3430,3431,3442,3443,34
                                                                                                  48,3449,3456,3458,3463,3472,3483,3
                                                                                                  485,3486,3490,3492,3493,3500,3501,
                                                                                                  3507,3508,3523,3524               
 LST                        Scalar 3295     I(4)            4     1     255      COM              3399,3430,3485,3492,3507,3523     
 MANRES                     Common 3307                                 2949048                                                     
 NALLT                      Scalar 3327     I(4)            4           scalar   COM              3412,3448                         
 NALLZ                      Scalar 3327     I(4)            4           scalar   COM              3381,3442                         
 NBAS                       Scalar 3305     I(4)            4           scalar   COM                                                
 NEV                        Scalar 3288     I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 3326     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 3303     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 3305     I(4)            4     1     21       COM                                                
 NLV                        Scalar 3287     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 3288     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 3288     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 3315     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 3299     I(4)            4     1     255      COM                                                
 NQV                        Scalar 3301     I(4)            4     1     255      COM                                                
 NST                        Param  3282     I(4)            4           scalar                    3286,3287,3288,3295,3304,3307,3308
                                                                                                  ,3309,3310,3311,3312,3313,3314,331
                                                                                                  5,3316,3317,3318,3319,3320,3321,33
                                                                                                  22                                
 NTDHM                      Scalar 3315     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 3299     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 3310     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 3301     I(4)            4     1     255      COM                                                
 NTHM                       Scalar 3313     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 3299     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 3310     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 3301     I(4)            4     1     255      COM                                                
 NTTMP                      Scalar 3322     I(4)            4     2     20979    COM                                                
 NTV                        Scalar 3301     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 3313     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 3299     I(4)            4     1     255      COM              3360                              
 NZIM                       Scalar 3310     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 3322     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 3301     I(4)            4     1     255      COM                                                
 PFC                        Scalar 3289     R(4)            4     1     255      COM                                                
 PI                         Scalar 3297     R(4)            4     1     255      COM                                                
 PIS                        Scalar 3318     R(4)            4     1     999      COM                                                
 POB                        Scalar 3289     R(4)            4     1     255      COM              3382,3399,3413,3430,3443,3449,3485
                                                                                                  ,3492,3507,3523                   
 POUT                       Scalar 3330     L(4)            4           scalar   COM              3398,3429,3484,3491,3506,3522     

Page 113         Source Listing                  ERR5
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PQM                        Scalar 3289     R(4)            4     1     255      COM                                                
 PRC                        Scalar 3289     R(4)            4     1     255      COM                                                
 PRNT                       Local  3337     L(4)            4           scalar                                                      
 PS                         Scalar 3295     R(4)            4     1     999      COM                                                
 PSCOR                      Scalar 3330     R(4)            4           scalar   COM                                                
 PSINC                      Scalar 3304     R(4)            4           scalar   COM                                                
 PTCOR                      Local  3414     R(4)            4           scalar                    3414,3431,3451,3493,3524          
 PZCOR                      Local  3383     R(4)            4           scalar                    3383,3400,3445,3486,3508          
 QFC                        Scalar 3293     R(4)            4     1     255      COM                                                
 QG                         Scalar 3317     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 3308     R(4)            4     2     20979    COM                                                
 QI                         Scalar 3297     R(4)            4     1     255      COM                                                
 QIM                        Scalar 3307     R(4)            4     2     20979    COM                                                
 QM                         Local  3386     R(4)            4           scalar                    3386,3396,3400,3417,3427,3431,3482
                                                                                                  ,3486,3489,3493,3503,3508,3519,352
                                                                                                  4                                 
 QOB                        Scalar 3293     R(4)            4     1     255      COM                                                
 QQM                        Scalar 3293     R(4)            4     1     255      COM                                                
 QRC                        Scalar 3293     R(4)            4     1     255      COM                                                
 QV                         Scalar 3298     R(4)            4     1     255      COM                                                
 QVM                        Scalar 3309     R(4)            4     2     20979    COM                                                
 RESID                      Common 3297                                 41312                                                       
 ROUND                      Subr   3382                                                           3382,3413,3443,3449               
 SEVENT                     Subr   3399                                                           3399,3430,3485,3492,3507,3523     
 SID                        Scalar 3286     CHAR            8     1     999      COM              3339,3399,3430,3485,3492,3507,3523
 SIMPLE                     Subr   3381                                                           3381,3412,3442,3448               
 SQN                        Scalar 3287     R(4)            4     1     999      COM              3399,3430,3485,3492,3507,3523     
 STN                        Common 3328                                 4                                                           
 T1                         Scalar 3329     R(4)            4           scalar   COM                                                
 TC                         Local  3411     R(4)            4           scalar                    3411,3412,3413,3414,3415,3416,3418
                                                                                                  ,3420,3423,3431,3446,3447,3448,344
                                                                                                  9,3451,3452,3453,3455,3458,3462,34
                                                                                                  68,3472,3477,3493,3520,3524       
 TCBEST                     Scalar 3329     R(4)            4     1     2        COM              3368,3372,3409,3446               
 TCLIM                      Scalar 3326     R(4)            4           scalar   COM              3415,3453,3468                    
 TCOR                       Scalar 3329     R(4)            4     1     2        COM              3351,3354,3372,3409,3411,3418,3420
                                                                                                  ,3455,3518,3521                   
 TDFC                       Scalar 3292     R(4)            4     1     255      COM                                                
 TDG                        Scalar 3317     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 3308     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 3297     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 3307     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 3292     R(4)            4     1     255      COM                                                
 TDV                        Scalar 3298     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 3309     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 3331     L(4)            4           scalar   COM              3339,3372                         
 TESTS                      Common 3331                                 4                                                           
 TFACT                      Scalar 3325     R(4)            4     2     84       COM                                                
 TFC                        Scalar 3291     R(4)            4     1     255      COM                                                
 TG                         Scalar 3317     L(4)            4     2     20979    COM                                                
 THM                        Scalar 3308     R(4)            4     2     20979    COM              3369,3423,3458,3472               
 TI                         Scalar 3297     R(4)            4     1     255      COM              3368,3423,3458,3472               
 TIM                        Scalar 3307     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 3320     R(4)            4     3     83916    COM                                                
 TL                         Scalar 3298     R(4)            4     1     255      COM                                                

Page 114         Source Listing                  ERR5
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TLSAT                      Scalar 3304     R(4)            4     1     255      COM                                                
 TMPSND                     Common 3319                                 1678336                                                     
 TMPSTD                     Scalar 3325     R(4)            4     2     84       COM              3367,3370                         
 TOB                        Scalar 3291     R(4)            4     1     255      COM              3412,3431,3448,3493,3524          
 TOBT                       Scalar 3319     R(4)            4     3     83916    COM                                                
 TQM                        Scalar 3291     R(4)            4     1     255      COM                                                
 TR                         Local  3409     R(4)            4           scalar                    3409,3410                         
 TRC                        Scalar 3291     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 3330     R(4)            4           scalar   COM                                                
 TTMP                       Scalar 3321     R(4)            4     2     20979    COM              3370,3423,3458,3472               
 TV                         Scalar 3298     R(4)            4     1     255      COM              3369,3423,3458,3472               
 TVM                        Scalar 3309     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 3292     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 3325     R(4)            4     2     84       COM              3366,3369                         
 XDR                        Scalar 3296     R(4)            4     1     255      COM                                                
 XINC                       Scalar 3324     R(4)            4     2     84       COM              3366,3369,3378,3409,3502,3518     
 XMISS                      Scalar 3332     R(4)            4           scalar   COM              3365,3368,3391,3392,3393,3394,3400
                                                                                                  ,3421,3422,3424,3425,3431,3457,345
                                                                                                  9,3460,3464,3465,3466,3467,3470,34
                                                                                                  71,3473,3474,3486,3493,3508,3524  
 XOB                        Scalar 3286     R(4)            4     1     999      COM                                                
 XQHM                       Scalar 3316     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 3300     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 3312     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 3302     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 3306     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 3315     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 3300     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 3311     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 3302     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 3314     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 3305     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 3314     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 3300     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 3311     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 3302     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 3312     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 3305     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 3313     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 3300     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 3311     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 3302     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 3312     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 3296     R(4)            4     1     255      COM                                                
 YOB                        Scalar 3286     R(4)            4     1     999      COM                                                
 ZC                         Local  3380     R(4)            4           scalar                    3380,3381,3382,3383,3384,3385,3387
                                                                                                  ,3389,3390,3400,3440,3441,3442,344
                                                                                                  3,3445,3452,3453,3454,3456,3461,34
                                                                                                  63,3469,3476,3486,3504,3508       
 ZCBEST                     Scalar 3329     R(4)            4     1     2        COM              3365,3372,3378,3440               
 ZCLIM                      Scalar 3326     R(4)            4           scalar   COM              3384,3453,3461                    
 ZCOR                       Scalar 3329     R(4)            4     1     2        COM              3350,3353,3372,3378,3380,3387,3389
                                                                                                  ,3454,3502,3505                   
 ZD                         Scalar 3305     R(4)            4     1     255      COM              3363,3390,3456,3463               
 ZDIF                       Local  3361     R(4)            4           scalar                    3361,3363,3365                    

Page 115         Source Listing                  ERR5
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZFC                        Scalar 3290     R(4)            4     1     255      COM                                                
 ZG                         Scalar 3317     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 3308     R(4)            4     2     20979    COM              3366,3390,3456,3463               
 ZI                         Scalar 3297     R(4)            4     1     255      COM              3361                              
 ZIM                        Scalar 3307     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 3320     R(4)            4     3     83916    COM                                                
 ZOB                        Scalar 3290     R(4)            4     1     255      COM              3381,3400,3442,3486,3508          
 ZOBT                       Scalar 3319     R(4)            4     3     83916    COM                                                
 ZQM                        Scalar 3290     R(4)            4     1     255      COM                                                
 ZR                         Local  3378     R(4)            4           scalar                    3378,3379                         
 ZRC                        Scalar 3290     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 3330     R(4)            4           scalar   COM                                                
 ZTMP                       Scalar 3321     R(4)            4     2     20979    COM              3367,3390,3456,3463               
 ZV                         Scalar 3298     R(4)            4     1     255      COM              3366,3390,3456,3463               
 ZVM                        Scalar 3309     R(4)            4     2     20979    COM                                                

Page 116         Source Listing                  ERR5
2017-04-18 11:07                                 cqcbufr.f

   3536 
   3537 C******************************************************************
   3538 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3539 C                .      .    .                                       .
   3540 C SUBPROGRAM:    ERR710      PERFORM ERROR ANALYSIS FOR TYPES 7-10. 
   3541 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
   3542 C
   3543 C ABSTRACT: Perform error analysis for errors at adjacent levels:
   3544 C   2 heights, 2 temperatures, or 1 temperature and C1 height error.
   3545 C
   3546 C PROGRAM HISTORY LOG:
   3547 C 1997-03-18  W. Collins  Original author.
   3548 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
   3549 C     were tested for not being equal to real value for missing (BMISS
   3550 C     = 10E10), these integer values can never be equal to BMISS for
   3551 C     I*4 due to overflow - instead they are now tested for not being
   3552 C     equal to new integer value for missing (IMISS, also = 10E10),
   3553 C     although this is also an overflow value for I*4, it results in a
   3554 C     correct evaluation
   3555 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
   3556 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
   3557 C     overflow (also done for IMISS).
   3558 C
   3559 C USAGE:    CALL ERR710(L,LM)
   3560 C   INPUT ARGUMENT LIST:
   3561 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
   3562 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
   3563 C
   3564 C   OUTPUT FILES:
   3565 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   3566 C
   3567 C REMARKS: NONE.
   3568 C
   3569 C ATTRIBUTES:
   3570 C   LANGUAGE: FORTRAN 90
   3571 C   MACHINE:  NCEP WCOSS
   3572 C
   3573 C$$$
   3574 
   3575       SUBROUTINE ERR710(L,LM)
   3576       PARAMETER (NST=999)
   3577 
   3578       REAL(8) BMISS
   3579 
   3580       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
   3581       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   3582      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   3583      &                 NEV, ISF(NST), NLVM, NLVW
   3584       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   3585      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   3586      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   3587      &                 TDO(255), TDFC(255),TVO(255),
   3588      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   3589      &                 CAT(255), IND(255), LEVTYP(255),
   3590      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   3591      &                 YDR(255), XDR(255)
   3592       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),

Page 117         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3593      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   3594      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   3595      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   3596      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   3597      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   3598      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   3599      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   3600      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   3601      &                 XTDH(255)
   3602       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   3603      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   3604      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   3605      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   3606      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   3607      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   3608      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   3609      &                 XTHM(21,NST),XTDVM(21,NST),
   3610      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   3611      &                 XQHM(21,NST),
   3612      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   3613      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   3614       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   3615      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   3616      &                 ZTMP(21,NST),   TTMP(21,NST),
   3617      &                 NZTMP(21,NST),  NTTMP(21,NST),
   3618      &                 ITERR(4)
   3619       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   3620      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   3621      &                 ZCLIM, TCLIM, NHLIM
   3622       COMMON /CONSTS/  R, G, T0, CP, RV
   3623       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   3624      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   3625       COMMON /STN/     IS
   3626       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   3627      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   3628       COMMON /TESTS/   TEST
   3629       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   3630 
   3631       LOGICAL          TEST
   3632       CHARACTER*8 SID
   3633       LOGICAL POUT, GOOD(6,2,2)
   3634       LOGICAL C2, C3, C5, C6
   3635       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT, SDMQ
   3636 
   3637       IF(TEST) WRITE(60,500) SID(IS), L ,LM
   3638   500 FORMAT(' ERR710--CALLED FOR: ',A8,'  WITH L,LM:',2I4)
   3639 
   3640 C  DETERMINE APPROPRIATE HYDROSTATIC RESIDUAL, B TO USE
   3641 C  ----------------------------------------------------
   3642 
   3643       IF(B(L).EQ.BMISS .OR. B(L+1).EQ.BMISS .OR.
   3644      &   B(L).EQ.0. .OR. B(L+1).EQ.0.) RETURN
   3645 
   3646       IF(LST(LM).EQ.130) THEN
   3647         IF(HYDN(L-1).NE.BMISS) THEN
   3648           HYDLM = HYDN(L-1)
   3649           BLM = B(L-1)

Page 118         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3650         ELSEIF(L.GT.2) THEN
   3651           IF(HYDN(L-2).NE.BMISS) THEN
   3652             HYDLM = HYDN(L-2)
   3653             BLM = B(L-2)
   3654           ELSE
   3655             HYDLM = BMISS
   3656             BLM = BMISS
   3657           ENDIF
   3658         ELSE
   3659           HYDLM = BMISS
   3660           BLM = BMISS
   3661         ENDIF
   3662       ELSEIF(LST(LM).EQ.120) THEN
   3663         HYDLM = BASRES(IS)
   3664         IF(POB(LM).NE.0.) THEN
   3665           BLM = 0.5*(R/G)*ALOG(PS(IS)/POB(LM))
   3666         ELSE
   3667           BLM = BMISS
   3668         ENDIF
   3669         IF(BLM.LT.0.01) BLM = BMISS
   3670       ELSE
   3671         RETURN
   3672       ENDIF
   3673       IF(TEST) WRITE(60,566) HYDLM,BLM,B(L),B(L+1)
   3674   566 FORMAT(' ERR710--HYDLM,BLM,B(L),B(L+1): ',4F12.2)
   3675 
   3676 C  DETERMINE THE MOST LIKELY ERROR TYPE
   3677 C  ------------------------------------
   3678 
   3679       R7 = ABS(HYDLM+HYDN(L)+HYDN(L+1))/(TT
   3680      &      *SQRT(BLM**2+B(L)**2+B(L+1)**2))
   3681       R8 = ABS(HYDLM/BLM-HYDN(L)/B(L)+HYDN(L+1)/B(L+1))
   3682      &      /(SQRT(3.)*TT)
   3683       R9 = ABS(HYDLM+HYDN(L)-(B(L)/B(L+1))*HYDN(L+1))
   3684      &      /(TT*SQRT(BLM**2 + 2.*B(L)**2))
   3685       R10 = ABS(HYDN(L)+HYDN(L+1)-(B(L)/BLM)*HYDLM)
   3686      &      /(TT*SQRT(B(L+1)**2 + 2.*B(L)**2))
   3687 
   3688       C2 = .FALSE.
   3689       C3 = .FALSE.
   3690       C5 = .FALSE.
   3691       C6 = .FALSE.
   3692       IF(ABS(HYDLM).GT.TT*SQRT(BLM**2+B(L)**2))        C2 = .TRUE.
   3693       IF(ABS(HYDN(L+1)).GT.TT*SQRT(B(L+1)**2+B(L)**2)) C3 = .TRUE.
   3694       IF(BLM.NE.0.) THEN
   3695       IF(ABS(HYDLM)/BLM.GT.TT)                         C5 = .TRUE.
   3696       ENDIF
   3697       IF(B(L+1).NE.0.) THEN
   3698       IF(ABS(HYDN(L+1))/B(L+1).GT.TT)                  C6 = .TRUE.
   3699       ENDIF
   3700 
   3701 C  SEE WHICH TYPES ARE POSSIBLE
   3702 C  ----------------------------
   3703 
   3704       RAT = 1.
   3705       IET = 0
   3706       IF(R7.LT.1. .AND. C2 .AND. C3) THEN

Page 119         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3707         RAT = R7
   3708         IET = 7
   3709       ENDIF
   3710       IF(R8.LT.1. .AND. C5 .AND. C6) THEN
   3711         IF(R8.LT.RAT) THEN
   3712           RAT = R8
   3713           IET = 8
   3714         ENDIF
   3715       ENDIF
   3716       IF(R9.LT.1. .AND. C2 .AND. C6) THEN
   3717         IF(R9.LT.RAT) THEN
   3718           RAT = R9
   3719           IET = 9
   3720         ENDIF
   3721       ENDIF
   3722       IF(R10.LT.1. .AND. C3 .AND. C5) THEN
   3723         IF(R10.LT.RAT) THEN
   3724           RAT = R10
   3725           IET = 10
   3726         ENDIF
   3727       ENDIF
   3728 
   3729       IF(TEST) WRITE(60,510) IET,R7,R8,R9,R10,C2,C3,C5,C6,HYDLM,BLM
   3730   510 FORMAT(' ERR710--IET,R7,R8,R9,R10,C2,C3,C5,C6: ',I4,4F10.2,4L3,
   3731      &  '  HYDLM,BLM: ',F10.1,F10.4)
   3732 
   3733 C  IET TELLS WHICH ERROR TYPE IS MOST LIKELY
   3734 C  T-S TELL WHICH TYPE CRITERIA ARE SATISFIED
   3735 C  ------------------------------------------
   3736 
   3737       IF(IET.EQ.0 .AND. HYDN(L).NE.BMISS) CALL ERR123(L,LM)
   3738 
   3739 C  CALCULATE HYDROSTATIC CORRECTIONS
   3740 C  ---------------------------------
   3741 
   3742       LP  = L+1
   3743       LMP = LMAND(LP)
   3744       B1  = 1./BLM
   3745       B1S = B1**2
   3746       B2  = 1./B(L)
   3747       B2S = B2**2
   3748       B3  = 1./B(L+1)
   3749       B3S = B3**2
   3750       S1  = HYDLM
   3751       S2  = HYDN(L)
   3752       S3  = HYDN(L+1)
   3753       IF(IET.EQ.7) THEN
   3754         ZCOR(1) = (-S1*B1S*(B2S+B3S) + (S2+S3)*B2S*B3S)
   3755      &    /((B1S+B3S)*B2S + B1S*B3S)
   3756         ZCOR(2) = (-(S1+S2)*B1S*B2S + S3*B3S*(B1S+B2S))
   3757      &    /((B1S+B3S)*B2S + B1S*B3S)
   3758       ELSEIF(IET.EQ.8) THEN
   3759         TCOR(1) = (2.*S1*B1+S2*B2-S3*B3)/3.
   3760         TCOR(2) = (2.*S3*B3+S2*B2-S1*B1)/3.
   3761       ELSEIF(IET.EQ.9) THEN
   3762         ZCOR(1) = (S2*B2S-2.*S1*B1S-S3*B3*B2)/(2.*B1S+B2S)
   3763         TCOR(2) = (S2*B2*B1S+S1*B1S*B2+S3*B3*(B1S+B2S))

Page 120         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3764      &    /(2.*B1S+B2S)
   3765       ELSEIF(IET.EQ.10) THEN
   3766         TCOR(1) = (S1*B1*(B2S+B3S)+S2*B2*B3S+S3*B2*B3S)
   3767      &    /(B2S+2.*B3S)
   3768         ZCOR(2) = (S1*B1*B2+2.*S3*B3S-S2*B2S)/(B2S+2.*B3S)
   3769       ENDIF
   3770 
   3771 C  CALCULATE BEST CORRECTIONS FOR COMPARISON
   3772 C  -----------------------------------------
   3773 
   3774       IF(NZI(LM).LT.6) THEN
   3775         ZDIF = ZI(LM)
   3776       ELSE
   3777         ZDIF = ZD(LM)
   3778       ENDIF
   3779 cdak  IF(LMP.NE.BMISS) THEN
   3780       IF(LMP.NE.IMISS) THEN ! LMP will never test = bmiss, use imiss
   3781         IF(NZI(LMP).LT.6) THEN
   3782           ZDIFP = ZI(LMP)
   3783         ELSE
   3784           ZDIFP = ZD(LMP)
   3785         ENDIF
   3786       ELSE
   3787         ZDIFP = BMISS
   3788       ENDIF
   3789       IF(IET.EQ.7) THEN
   3790         CALL BEST(ZCBEST(1),XMISS,XMISS,ZI(LM),XINC(L,1),
   3791      &    XMISS,XMISS,ZHM(L,IS),HOIRES(L,1),
   3792      &    ZTMP(L,IS),TMPSTD(L,1))
   3793         CALL BEST(ZCBEST(2),XMISS,XMISS,ZI(LMP),XINC(LP,1),
   3794      &    XMISS,XMISS,ZHM(LP,IS),HOIRES(LP,1),
   3795      &    ZTMP(LP,IS),TMPSTD(LP,1))
   3796       ELSEIF(IET.EQ.8) THEN
   3797         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
   3798      &    XINC(L,2),XMISS,XMISS,THM(L,IS),HOIRES(L,2),
   3799      &    TTMP(L,IS),TMPSTD(L,2))
   3800         CALL BEST(TCBEST(2),XMISS,XMISS,TI(LMP),
   3801      &    XINC(LP,2),XMISS,XMISS,THM(LP,IS),HOIRES(LP,2),
   3802      &    TTMP(LP,IS),TMPSTD(LP,2))
   3803       ELSEIF(IET.EQ.9) THEN
   3804         CALL BEST(ZCBEST(1),XMISS,XMISS,ZDIF,XINC(L,1),
   3805      &    ZV(LM),VOIRES(L,1),ZHM(L,IS),HOIRES(L,1),
   3806      &    ZTMP(L,IS),TMPSTD(L,1))
   3807         CALL BEST(TCBEST(2),XMISS,XMISS,TI(LMP),
   3808      &    XINC(LP,2),TV(LMP),VOIRES(LP,2),THM(LP,IS),HOIRES(LP,2),
   3809      &    TTMP(LP,IS),TMPSTD(LP,2))
   3810       ELSEIF(IET.EQ.10) THEN
   3811         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
   3812      &    XINC(L,2),TV(LM),VOIRES(L,2),THM(L,IS),HOIRES(L,2),
   3813      &    TTMP(L,IS),TMPSTD(L,2))
   3814         CALL BEST(ZCBEST(2),XMISS,XMISS,ZDIFP,XINC(LP,1),
   3815      &    ZV(LMP),VOIRES(LP,1),ZHM(LP,IS),HOIRES(LP,1),
   3816      &    ZTMP(LP,IS),TMPSTD(LP,1))
   3817       ENDIF
   3818 
   3819 C  TEST TO SEE WHICH CORRECTIONS TO USE, IF ANY
   3820 C  CONSIDER EACH POTENTIAL CORRECTION SEPARATELY

Page 121         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3821 C  ---------------------------------------------
   3822 C  IN THE (NEAR) FUTURE, THE LOGIC SHOULD BE EXPANDED SO THAT WHEN
   3823 C  A PART OF THE POTENTIAL CORRECTION IS REJECTED, THEN THE 
   3824 C  SUGGESTED CORRECTION WILL BE RECALCULATED USING ONLY THE 
   3825 C  RELEVANT HYDROSTATIC RESIDUALS.
   3826 C  QUESTION: SHOULD BEST BE RECALCULATED USING VERTICAL RESIDS?
   3827 C  ------------------------------------------------------------
   3828 
   3829 C  TYPE 7 CORRECTIONS
   3830 C  ------------------
   3831 
   3832       IF(IET.EQ.7) THEN
   3833 
   3834         POUT = .TRUE.
   3835         IHSC(2,LM) = 7
   3836         IHSC(2,LMP) = 7
   3837         RZ1 = ABS(ZCOR(1)-ZCBEST(1))/XINC(L,1)
   3838         RZ2 = ABS(ZCOR(2)-ZCBEST(2))/XINC(L+1,1)
   3839 
   3840         IF(RZ1.LT.0.15 .AND. RZ2.LT.0.15) THEN
   3841           ZC1 = ZCOR(1)
   3842           CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   3843           CALL ROUND(ZC1,POB(LM),2)
   3844           PZCOR1 = ZC1
   3845           IF(ABS(ZC1).LT.ZCLIM) ZC1 = 0.
   3846           ZCOR(1) = ZC1
   3847           QM1 = 1.
   3848           ZC2 = ZCOR(2)
   3849           CALL SIMPLE(ZC2,ZOB(LMP),ALLZ,NALLZ,1.)
   3850           CALL ROUND(ZC2,POB(LMP),2)
   3851           PZCOR2 = ZC2
   3852           IF(ABS(ZC2).LT.ZCLIM) ZC2 = 0.
   3853           ZCOR(2) = ZC2
   3854           QM2 = 1.
   3855         ELSE
   3856           ZC1  = ZCBEST(1)
   3857           ZC2  = ZCBEST(2)
   3858           CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   3859           CALL ROUND(ZC1,POB(LM),2)
   3860           CALL SIMPLE(ZC2,ZOB(LMP),ALLZ,NALLZ,1.)
   3861           CALL ROUND(ZC2,POB(LMP),2)
   3862           PZCOR1 = ZC1
   3863           PZCOR2 = ZC2
   3864           IF(ABS(ZC1).LT.0.25*XINC(L,1)) ZC1 = 0.
   3865           IF(ABS(ZC2).LT.0.25*XINC(L+1,1)) ZC2 = 0.
   3866           CALL CHECKIT(7,ZC1,  ZDIF, XMISS,ZHM(L,IS),  ZTMP(L,IS),
   3867      &                   ZC2,  ZDIFP,XMISS,ZHM(L+1,IS),ZTMP(L+1,IS),
   3868      &                   XMISS,XMISS,XMISS,XMISS,      XMISS,
   3869      &                   XMISS,XMISS,XMISS,XMISS,      XMISS,
   3870      &                   HYDLM,HYD(L),XMISS,BLM,B(L),XMISS,GOOD)
   3871           IF(TEST) WRITE(60,501) ZC1, ZI(LM), ZV(LM), ZHM(L,IS),
   3872      &               ZTMP(L,IS),ZC2, ZI(LMP),ZV(LMP),ZHM(L+1,IS),
   3873      &               ZTMP(L+1,IS),
   3874      &               HYDLM,HYD(L),BLM,B(L),
   3875      &               ((GOOD(I,J,1),I=1,5),J=1,2)
   3876   501     FORMAT(' ERR710--(TYPE 7) ZC1,ZI(LM),ZV(LM),ZHM(L,IS),',
   3877      &           'ZTMP(L,IS),ZC2,ZI(LMP),ZV(LMP),ZHM(L+1,IS),',

Page 122         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3878      &           'ZTMP(L+1,IS),HYDLM,HYD(L),BLM,B(L),GOOD(z1,z2):'/
   3879      &           9X,14F10.1,5L4,2X,5L4)
   3880 
   3881           IF(GOOD(6,1,1)) THEN
   3882             QM1 = 1.
   3883           ELSE
   3884             IF(ZC1.EQ.0.) THEN
   3885               QM1 = 3.
   3886             ELSE
   3887               ZC1 = 0.
   3888               QM1 = 13.
   3889             ENDIF
   3890           ENDIF
   3891           IF(GOOD(6,2,1)) THEN
   3892             QM2 = 1.
   3893           ELSE
   3894             IF(ZC2.EQ.0.) THEN
   3895               QM2 = 3.
   3896             ELSE
   3897               ZC2 = 0.
   3898               QM2 = 13.
   3899             ENDIF
   3900           ENDIF
   3901         ENDIF
   3902 
   3903         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),2,ZC1,
   3904      &    ZOB(LM)+ZC1,PZCOR1,QM1,IHSC(2,LM),XMISS,XMISS,XMISS)
   3905         CALL SEVENT(SID(IS),SQN(IS),LMP,LST(LMP),POB(LMP),LEVTYP(LMP),
   3906      &    2,ZC2,ZOB(LMP)+ZC2,PZCOR2,QM2,IHSC(2,LMP),XMISS,XMISS,XMISS)
   3907 
   3908 C  TYPE 8 CORRECTIONS
   3909 C  ------------------
   3910 
   3911       ELSEIF(IET.EQ.8) THEN
   3912 
   3913         POUT = .TRUE.
   3914         IHSC(3,LM) = 8
   3915         IHSC(3,LMP) = 8
   3916         RT1 = ABS(TCOR(1)-TCBEST(1))/XINC(L,2)
   3917         RT2 = ABS(TCOR(2)-TCBEST(2))/XINC(L+1,2)
   3918 
   3919         IF(RT1.LT.0.15 .AND. RT2.LT.0.15) THEN
   3920           TC1 = TCOR(1)
   3921           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   3922           CALL ROUND(TC1,POB(LM),3)
   3923           PTCOR1 = TC1
   3924           IF(ABS(TC1).LT.0.25*XINC(L,2)) TC1 = 0.
   3925           TCOR(1) = TC1
   3926           QM1 = 1.
   3927           TC2 = TCOR(2)
   3928           CALL SIMPLE(TC2,TOB(LMP),ALLT,NALLT,10.)
   3929           CALL ROUND(TC2,POB(LMP),3)
   3930           PTCOR2 = TC2
   3931           IF(ABS(TC2).LT.0.25*XINC(L+1,2)) TC2 = 0.
   3932           TCOR(2) = TC2
   3933           QM2 = 1.
   3934         ELSE

Page 123         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3935           TC1  = TCBEST(1)
   3936           TC2  = TCBEST(2)
   3937           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   3938           CALL ROUND(TC1,POB(LM),3)
   3939           CALL SIMPLE(TC2,TOB(LMP),ALLT,NALLT,10.)
   3940           CALL ROUND(TC2,POB(LMP),3)
   3941           PTCOR1 = TC1
   3942           PTCOR2 = TC2
   3943           IF(ABS(TC1).LT.TCLIM) TC1 = 0.
   3944           IF(ABS(TC2).LT.TCLIM) TC2 = 0.
   3945           CALL CHECKIT(8,XMISS,XMISS,  XMISS,XMISS,      XMISS,
   3946      &                   XMISS,XMISS,  XMISS,XMISS,      XMISS,
   3947      &                   TC1,  TI(LM), XMISS,THM(L,IS),  TTMP(L,IS),
   3948      &                   TC2,  TI(LMP),XMISS,THM(L+1,IS),TTMP(L+1,IS),
   3949      &                   HYDLM,HYDN(L),XMISS,BLM,B(L),XMISS,GOOD)
   3950           IF(TEST) WRITE(60,502) TC1,TI(LM),TV(LM),THM(L,IS),
   3951      &               TTMP(L,IS),TC2,TI(LMP),TV(LMP),THM(L+1,IS),
   3952      &               TTMP(L+1,IS),HYDLM,HYDN(L),BLM,B(L),
   3953      &               ((GOOD(I,J,2),I=1,5),J=1,2)
   3954   502     FORMAT(' ERR710--(TYPE 8) TC1,TI(LM),TV(LM),THM(L,IS),',
   3955      &               'TTMP(L,IS),TC2,TI(LMP),TV(LMP),THM(L+1,IS),',
   3956      &               'TTMP(L+1,IS),HYDLM,HYDN(L),BLM,B(L),GOOD(T1,T2):'/
   3957      &               9X,14F10.1,5L4,2X,5L4)
   3958           IF(GOOD(6,1,2)) THEN
   3959             QM1 = 1.
   3960           ELSE
   3961             IF(TC1.EQ.0.) THEN
   3962               QM1 = 3.
   3963             ELSE
   3964               TC1 = 0.
   3965               QM1 = 13.
   3966             ENDIF
   3967           ENDIF
   3968           IF(GOOD(6,2,2)) THEN
   3969             QM2 = 1.
   3970           ELSE
   3971             IF(TC2.EQ.0.) THEN
   3972               QM2 = 3.
   3973             ELSE
   3974               TC2 = 0
   3975               QM2 = 13.
   3976             ENDIF
   3977           ENDIF
   3978         ENDIF
   3979 
   3980         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),3,TC1,
   3981      &    TOB(LM)+TC1,PTCOR1,QM1,IHSC(3,LM),XMISS,XMISS,XMISS)
   3982         CALL SEVENT(SID(IS),SQN(IS),LMP,LST(LMP),POB(LMP),LEVTYP(LMP),
   3983      &    3,TC2,TOB(LMP)+TC2,PTCOR2,QM2,IHSC(3,LMP),XMISS,XMISS,XMISS)
   3984         SDMQ = .FALSE.
   3985         SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
   3986      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
   3987         IF((QM1.EQ.3. .OR. QM1.EQ.13.) .AND. QOB(LM).LT.BMISS .AND.
   3988      &     .NOT.SDMQ) THEN
   3989           CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),5,
   3990      &      0.,QOB(LM),0.,QM1,IHSC(4,LM),XMISS,XMISS,XMISS)
   3991         ENDIF

Page 124         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   3992         SDMQ = .FALSE.
   3993         SDMQ = QQM(LMP).EQ.0. .OR. QQM(LMP).GE.14. .OR.
   3994      &        (QQM(LMP).GE.4. .AND. QQM(LMP).LE.12.)
   3995         IF((QM2.EQ.3. .OR. QM2.EQ.13.) .AND. QOB(LMP).LT.BMISS .AND.
   3996      &     .NOT.SDMQ) THEN
   3997           CALL SEVENT(SID(IS),SQN(IS),LMP,LST(LMP),POB(LMP),
   3998      &      LEVTYP(LMP),5,0.,QOB(LMP),0.,QM2,IHSC(4,LMP),XMISS,
   3999      &      XMISS,XMISS)
   4000         ENDIF
   4001 
   4002 C  TYPE 9 CORRECITONS
   4003 C  ------------------
   4004 
   4005       ELSEIF(IET.EQ.9) THEN
   4006 
   4007         POUT = .TRUE.
   4008         IHSC(2,LM) = 9
   4009         IHSC(3,LMP) = 9
   4010         RZ1 = ABS(ZCOR(1)-ZCBEST(1))/XINC(L,1)
   4011         RT2 = ABS(TCOR(2)-TCBEST(2))/XINC(L+1,2)
   4012 
   4013         IF(RZ1.LT.0.15 .AND. RT2.LT.0.15) THEN
   4014           ZC1 = ZCOR(1)
   4015           CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   4016           CALL ROUND(ZC1,POB(LM),2)
   4017           PZCOR1 = ZC1
   4018           IF(ABS(ZC1).LT.0.25*XINC(L,1)) ZC1 = 0.
   4019           ZCOR(1) = ZC1
   4020           QM1 = 1.
   4021           TC2 = TCOR(2)
   4022           CALL SIMPLE(TC2,TOB(LMP),ALLT,NALLT,10.)
   4023           CALL ROUND(TC2,POB(LMP),3)
   4024           PTCOR2 = TC2
   4025           IF(ABS(TC2).LT.0.25*XINC(L+1,2)) TC2 = 0.
   4026           TCOR(2) = TC2
   4027           QM2 = 1.
   4028         ELSE
   4029           ZC1  = ZCBEST(1)
   4030           TC2  = TCBEST(2)
   4031           CALL SIMPLE(ZC1,ZOB(LM),ALLZ,NALLZ,1.)
   4032           CALL ROUND(ZC1,POB(LM),2)
   4033           CALL SIMPLE(TC2,TOB(LMP),ALLT,NALLT,10.)
   4034           CALL ROUND(TC2,POB(LMP),3)
   4035           PZCOR1 = ZC1
   4036           TCOR(2) = TC2
   4037           IF(ABS(ZC1).LT.ZCLIM) ZC1 = 0.
   4038           IF(ABS(TC2).LT.TCLIM) TC2 = 0.
   4039           CALL CHECKIT(9,ZC1,  ZDIF,   ZV(LM), ZHM(L,IS),  ZTMP(L,IS),
   4040      &                   XMISS,XMISS,  XMISS,  XMISS,      XMISS,
   4041      &                   XMISS,XMISS,  XMISS,  XMISS,      XMISS,
   4042      &                   TC2,  TI(LMP),TV(LMP),THM(L+1,IS),TTMP(L+1,IS),
   4043      &                   HYDLM,HYDN(L),XMISS,BLM,B(L),XMISS,GOOD)
   4044           IF(TEST) WRITE(60,503) ZC1,ZI(LM),ZV(LM),ZHM(L,IS),
   4045      &               ZTMP(L,IS),TC2,TI(LMP),TV(LMP),THM(L+1,IS),
   4046      &               TTMP(L+1,IS),HYDLM,HYDN(L),BLM,B(L),
   4047      &               (GOOD(I,1,1),I=1,5),(GOOD(J,2,2),J=1,5)
   4048   503     FORMAT(' ERR710--(TYPE 9)  ZC1,ZI(LM),ZV(LM),ZHM(L,IS),',

Page 125         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   4049      &               'ZTMP(L,IS),TC2,TI(LMP),TV(LMP),THM(L+1,IS),',
   4050      &               'TTMP(L+1,IS),HYDLM,HYDN(L),BLM,B(L),GOOD(z1,T2):'/
   4051      &               9X,14F10.1,5L4,2X,5L4)
   4052           IF(GOOD(6,1,1)) THEN
   4053             QM1 = 1.
   4054           ELSE
   4055             IF(ZC1.EQ.0.) THEN
   4056               QM1 = 0.
   4057             ELSE
   4058               ZC1 = 0.
   4059               QM1 = 13.
   4060             ENDIF
   4061           ENDIF
   4062           IF(GOOD(6,2,2)) THEN
   4063             QM2 = 1.
   4064           ELSE
   4065             IF(TC2.EQ.0.) THEN
   4066               QM2 = 3.
   4067             ELSE
   4068               TC2 = 0
   4069               QM2 = 13.
   4070             ENDIF
   4071           ENDIF
   4072         ENDIF
   4073 
   4074         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),2,ZC1,
   4075      &    ZOB(LM)+ZC1,PZCOR1,QM1,IHSC(2,LM),XMISS,XMISS,XMISS)
   4076         CALL SEVENT(SID(IS),SQN(IS),LMP,LST(LMP),POB(LMP),LEVTYP(LMP),
   4077      &    3,TC2,TOB(LMP)+TC2,PTCOR2,QM2,IHSC(3,LMP),XMISS,XMISS,XMISS)
   4078         SDMQ = .FALSE.
   4079         SDMQ = QQM(LMP).EQ.0. .OR. QQM(LMP).GE.14. .OR.
   4080      &        (QQM(LMP).GE.4. .AND. QQM(LMP).LE.12.)
   4081         IF((QM2.EQ.3. .OR. QM2.EQ.13.) .AND. QOB(LMP).LT.BMISS .AND.
   4082      &     .NOT.SDMQ) THEN
   4083           CALL SEVENT(SID(IS),SQN(IS),LMP,LST(LMP),POB(LMP),
   4084      &      LEVTYP(LMP),5,0.,QOB(LMP),0.,QM2,IHSC(4,LMP),XMISS,
   4085      &      XMISS,XMISS)
   4086         ENDIF
   4087 
   4088 C  TYPE 10 CORRECTIONS
   4089 C  -------------------
   4090 
   4091       ELSEIF(IET.EQ.10) THEN
   4092 
   4093         POUT = .TRUE.
   4094         IHSC(3,LM) = 10
   4095         IHSC(2,LMP) = 10
   4096         RZ2 = ABS(ZCOR(2)-ZCBEST(2))/XINC(L+1,1)
   4097         RT1 = ABS(TCOR(1)-TCBEST(1))/XINC(L,2)
   4098         IF(RT1.LT.0.15 .AND. RZ2.LT.0.15) THEN
   4099           TC1 = TCOR(1)
   4100           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   4101           CALL ROUND(TC1,POB(LM),3)
   4102           PTCOR1 = TC1
   4103           IF(ABS(TC1).LT.TCLIM) TC1 = 0.
   4104           TCOR(1) = TC1
   4105           QM1 = 1.

Page 126         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   4106           ZC2 = ZCOR(2)
   4107           CALL SIMPLE(ZC2,ZOB(LMP),ALLZ,NALLZ,1.)
   4108           CALL ROUND(ZC2,POB(LMP),2)
   4109           PZCOR2 = ZC2
   4110           IF(ABS(ZC2).LT.ZCLIM) ZC2 = 0.
   4111           ZCOR(2) = ZC2
   4112           QM2 = 1.
   4113         ELSE
   4114           TC1  = TCBEST(1)
   4115           ZC2  = ZCBEST(2)
   4116           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
   4117           CALL ROUND(TC1,POB(LM),3)
   4118           CALL SIMPLE(ZC2,ZOB(LMP),ALLZ,NALLZ,1.)
   4119           CALL ROUND(ZC2,POB(LMP),2)
   4120           PTCOR1 = TC1
   4121           PZCOR2 = ZC2
   4122           IF(ABS(TC1).LT.TCLIM) TC1 = 0.
   4123           IF(ABS(ZC2).LT.ZCLIM) ZC2 = 0.
   4124           CALL CHECKIT(10,XMISS,XMISS, XMISS,  XMISS,      XMISS,
   4125      &                    ZC2,  ZDIFP, ZV(LMP),ZHM(L+1,IS),ZTMP(L+1,IS),
   4126      &                    TC1,  TI(LM),TV(LM), THM(L,IS),  TTMP(L,IS),
   4127      &                    XMISS, XMISS, XMISS, XMISS,      XMISS,
   4128      &                    HYDLM,HYDN(L),XMISS,BLM,B(L),XMISS,GOOD)
   4129           IF(TEST) WRITE(60,504) ZC2,ZI(LMP),ZV(LMP),ZHM(L+1,IS),
   4130      &               ZTMP(L+1,IS),TC1,TI(LM),TV(LM),THM(L,IS),
   4131      &               TTMP(L,IS),HYDLM,HYDN(L),BLM,B(L),
   4132      &               (GOOD(I,1,2),I=1,5),(GOOD(J,2,1),J=1,5)
   4133   504     FORMAT(' ERR710--(TYPE 10) ZC2,ZI(LMP),ZV(LMP),ZHM(L+1,IS),',
   4134      &               'ZTMP(L+1,IS),TC1,TI(LM),TV(LM),THM(L,IS),',
   4135      &               'TTMP(L,IS),HYDLM,HYDN(L),BLM,B(L),GOOD(T1,z2):'/
   4136      &               9X,14F10.1,5L4,2X,5L4)
   4137           IF(GOOD(6,1,2)) THEN
   4138             QM1 = 1.
   4139           ELSE
   4140             IF(TC1.EQ.0.) THEN
   4141               QM1 = 3.
   4142             ELSE
   4143               TC1 = 0.
   4144               QM1 = 13.
   4145             ENDIF
   4146           ENDIF
   4147           IF(GOOD(6,2,1)) THEN
   4148             QM2 = 1.
   4149           ELSE
   4150             IF(ZC2.EQ.0.) THEN
   4151               QM2 = 3.
   4152             ELSE
   4153               ZC2 = 0
   4154               QM2 = 13.
   4155             ENDIF
   4156           ENDIF
   4157         ENDIF
   4158 
   4159         CALL SEVENT(SID(IS),SQN(IS),LMP,LST(LMP),POB(LMP),LEVTYP(LMP),
   4160      &    2,ZC2,ZOB(LMP)+ZC2,PZCOR2,QM2,IHSC(2,LMP),XMISS,XMISS,XMISS)
   4161         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),3,TC1,
   4162      &    TOB(LM)+TC1,PTCOR1,QM1,IHSC(3,LM),XMISS,XMISS,XMISS)

Page 127         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   4163         SDMQ = .FALSE.
   4164         SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
   4165      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
   4166         IF((QM1.EQ.3. .OR. QM1.EQ.13.) .AND. QOB(LM).LT.BMISS .AND.
   4167      &     .NOT.SDMQ) THEN
   4168           CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),
   4169      &      LEVTYP(LM),5,0.,QOB(LM),0.,QM1,IHSC(4,LM),XMISS,
   4170      &      XMISS,XMISS)
   4171         ENDIF
   4172 
   4173       ENDIF
   4174 
   4175       RETURN
   4176       END


ENTRY POINTS

  Name               
                     
 err710_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  3638                                                           3637                              
 501                        Label  3876                                                           3871                              
 502                        Label  3954                                                           3950                              
 503                        Label  4048                                                           4044                              
 504                        Label  4133                                                           4129                              
 510                        Label  3730                                                           3729                              
 566                        Label  3674                                                           3673                              
 ABS                        Func   3679                                 scalar                    3679,3681,3683,3685,3692,3693,3695
                                                                                                  ,3698,3837,3838,3845,3852,3864,386
                                                                                                  5,3916,3917,3924,3931,3943,3944,40
                                                                                                  10,4011,4018,4025,4037,4038,4096,4
                                                                                                  097,4103,4110,4122,4123           
 ALLOW                      Common 3580                                 456                                                         
 ALLSND                     Common 3584                                 34512                                                       
 ALLT                       Scalar 3580     R(4)            4     1     71       COM              3921,3928,3937,3939,4022,4033,4100
                                                                                                  ,4116                             
 ALLZ                       Scalar 3580     R(4)            4     1     41       COM              3842,3849,3858,3860,4015,4031,4107
                                                                                                  ,4118                             
 ALOG                       Func   3665                                 scalar                    3665                              
 B                          Scalar 3600     R(4)            4     1     21       COM              3643,3644,3649,3653,3673,3680,3681
                                                                                                  ,3683,3684,3685,3686,3692,3693,369
                                                                                                  7,3698,3746,3748,3870,3874,3949,39
                                                                                                  52,4043,4046,4128,4131            
 B1                         Local  3744     R(4)            4           scalar                    3744,3745,3759,3760,3766,3768     
 B1S                        Local  3745     R(4)            4           scalar                    3745,3754,3755,3756,3757,3762,3763
                                                                                                  ,3764                             
 B2                         Local  3746     R(4)            4           scalar                    3746,3747,3759,3760,3762,3763,3766
                                                                                                  ,3768                             
 B2S                        Local  3747     R(4)            4           scalar                    3747,3754,3755,3756,3757,3762,3763
                                                                                                  ,3764,3766,3767,3768              

Page 128         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B3                         Local  3748     R(4)            4           scalar                    3748,3749,3759,3760,3762,3763     
 B3S                        Local  3749     R(4)            4           scalar                    3749,3754,3755,3756,3757,3766,3767
                                                                                                  ,3768                             
 BASRES                     Scalar 3599     R(4)            4     1     999      COM              3663                              
 BEST                       Subr   3790                                                           3790,3793,3797,3800,3804,3807,3811
                                                                                                  ,3814                             
 BLM                        Local  3649     R(4)            4           scalar                    3649,3653,3656,3660,3665,3667,3669
                                                                                                  ,3673,3680,3681,3684,3685,3692,369
                                                                                                  4,3695,3729,3744,3870,3874,3949,39
                                                                                                  52,4043,4046,4128,4131            
 BMISS                      Scalar 3578     R(8)            8           scalar   COM              3643,3647,3651,3655,3656,3659,3660
                                                                                                  ,3667,3669,3737,3787,3987,3995,408
                                                                                                  1,4166                            
 BRES                       Scalar 3613     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 3629                                 16                                                          
 C2                         Local  3634     L(4)            4           scalar                    3688,3692,3706,3716,3729          
 C3                         Local  3634     L(4)            4           scalar                    3689,3693,3706,3722,3729          
 C5                         Local  3634     L(4)            4           scalar                    3690,3695,3710,3722,3729          
 C6                         Local  3634     L(4)            4           scalar                    3691,3698,3710,3716,3729          
 CAT                        Scalar 3589     R(4)            4     1     255      COM                                                
 CHECKIT                    Subr   3866                                                           3866,3945,4039,4124               
 CONSTS                     Common 3622                                 20                                                          
 CP                         Scalar 3622     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 3624     R(4)            4           scalar   COM                                                
 DHR                        Scalar 3581     R(4)            4     1     999      COM                                                
 ELV                        Scalar 3582     R(4)            4     1     999      COM                                                
 ERR123                     Subr   3737                                                           3737                              
 ERR710                     Subr   3575                                                                                             
 ERROR                      Scalar 3613     L(4)            4     1     999      COM                                                
 G                          Scalar 3622     R(4)            4           scalar   COM              3665                              
 GESPS                      Scalar 3590     R(4)            4     1     999      COM                                                
 GOOD                       Local  3633     L(4)            4     3     24                        3870,3875,3881,3891,3949,3953,3958
                                                                                                  ,3968,4043,4047,4052,4062,4128,413
                                                                                                  2,4137,4147                       
 H1                         Scalar 3626     R(4)            4           scalar   COM                                                
 H2                         Scalar 3626     R(4)            4           scalar   COM                                                
 HEADER                     Common 3581                                 35980                                                       
 HOIRES                     Scalar 3619     R(4)            4     2     84       COM              3791,3794,3798,3801,3805,3808,3812
                                                                                                  ,3815                             
 HRDR                       Scalar 3590     R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 3619     R(4)            4     1     21       COM                                                
 HYD                        Scalar 3598     R(4)            4     1     21       COM              3870,3874                         
 HYDLM                      Local  3648     R(4)            4           scalar                    3648,3652,3655,3659,3663,3673,3679
                                                                                                  ,3681,3683,3685,3692,3695,3729,375
                                                                                                  0,3870,3874,3949,3952,4043,4046,41
                                                                                                  28,4131                           
 HYDM                       Scalar 3613     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 3598     R(4)            4     1     21       COM              3647,3648,3651,3652,3679,3681,3683
                                                                                                  ,3685,3693,3698,3737,3751,3752,394
                                                                                                  9,3952,4043,4046,4128,4131        
 HYDQ                       Scalar 3598     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 3598     R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 3626                                 64                                                          
 I                          Local  3875     I(4)            4           scalar                    3875,3953,4047,4132               
 IET                        Local  3705     I(4)            4           scalar                    3705,3708,3713,3719,3725,3729,3737

Page 129         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,3753,3758,3761,3765,3789,3796,380
                                                                                                  3,3810,3832,3911,4005,4091        
 IHSC                       Scalar 3599     I(4)            4     2     1020     COM              3835,3836,3904,3906,3914,3915,3981
                                                                                                  ,3983,3990,3998,4008,4009,4075,407
                                                                                                  7,4084,4094,4095,4160,4162,4169   
 IMISS                      Scalar 3629     I(4)            4           scalar   COM              3780                              
 IND                        Scalar 3589     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 3624     I(4)            4           scalar   COM                                                
 IS                         Scalar 3625     I(4)            4           scalar   COM              3637,3663,3665,3791,3792,3794,3795
                                                                                                  ,3798,3799,3801,3802,3805,3806,380
                                                                                                  8,3809,3812,3813,3815,3816,3866,38
                                                                                                  67,3871,3872,3873,3903,3905,3947,3
                                                                                                  948,3950,3951,3952,3980,3982,3989,
                                                                                                  3997,4039,4042,4044,4045,4046,4074
                                                                                                  ,4076,4083,4125,4126,4129,4130,413
                                                                                                  1,4159,4161,4168                  
 ISC                        Scalar 3624     I(4)            4           scalar   COM                                                
 ISF                        Scalar 3583     I(4)            4     1     999      COM                                                
 ITERR                      Scalar 3618     I(4)            4     1     4        COM                                                
 ITP                        Scalar 3582     I(4)            4     1     999      COM                                                
 J                          Local  3875     I(4)            4           scalar                    3875,3953,4047,4132               
 L                          Dummy  3575     I(4)            4           scalar   ARG,INOUT        3637,3643,3644,3647,3648,3649,3650
                                                                                                  ,3651,3652,3653,3673,3679,3680,368
                                                                                                  1,3683,3684,3685,3686,3692,3693,36
                                                                                                  97,3698,3737,3742,3746,3748,3751,3
                                                                                                  752,3790,3791,3792,3798,3799,3804,
                                                                                                  3805,3806,3812,3813,3837,3838,3864
                                                                                                  ,3865,3866,3867,3870,3871,3872,387
                                                                                                  3,3874,3916,3917,3924,3931,3947,39
                                                                                                  48,3949,3950,3951,3952,4010,4011,4
                                                                                                  018,4025,4039,4042,4043,4044,4045,
                                                                                                  4046,4096,4097,4125,4126,4128,4129
                                                                                                  ,4130,4131                        
 LAST                       Scalar 3627     I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 3589     I(4)            4     1     255      COM              3903,3905,3980,3982,3989,3998,4074
                                                                                                  ,4076,4084,4159,4161,4169         
 LIMS                       Common 3619                                 1776                                                        
 LM                         Dummy  3575     I(4)            4           scalar   ARG,INOUT        3637,3646,3662,3664,3665,3737,3774
                                                                                                  ,3775,3777,3790,3797,3805,3811,381
                                                                                                  2,3835,3842,3843,3858,3859,3871,39
                                                                                                  03,3904,3914,3921,3922,3937,3938,3
                                                                                                  947,3950,3980,3981,3985,3986,3987,
                                                                                                  3989,3990,4008,4015,4016,4031,4032
                                                                                                  ,4039,4044,4074,4075,4094,4100,410
                                                                                                  1,4116,4117,4126,4130,4161,4162,41
                                                                                                  64,4165,4166,4168,4169            
 LMAND                      Scalar 3624     I(4)            4     1     22       COM              3743                              
 LMP                        Local  3743     I(4)            4           scalar                    3743,3780,3781,3782,3784,3793,3800
                                                                                                  ,3807,3808,3815,3836,3849,3850,386
                                                                                                  0,3861,3872,3905,3906,3915,3928,39
                                                                                                  29,3939,3940,3948,3951,3982,3983,3
                                                                                                  993,3994,3995,3997,3998,4009,4022,
                                                                                                  4023,4033,4034,4042,4045,4076,4077
                                                                                                  ,4079,4080,4081,4083,4084,4095,410
                                                                                                  7,4108,4118,4119,4125,4129,4159,41

Page 130         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  60                                
 LP                         Local  3742     I(4)            4           scalar                    3742,3743,3793,3794,3795,3801,3802
                                                                                                  ,3808,3809,3814,3815,3816         
 LSFC                       Scalar 3624     I(4)            4           scalar   COM                                                
 LST                        Scalar 3590     I(4)            4     1     255      COM              3646,3662,3903,3905,3980,3982,3989
                                                                                                  ,3997,4074,4076,4083,4159,4161,416
                                                                                                  8                                 
 MAND                       Scalar 3623     I(4)            4           scalar   COM                                                
 MANRES                     Common 3602                                 2949048                                                     
 NALLT                      Scalar 3580     I(4)            4           scalar   COM              3921,3928,3937,3939,4022,4033,4100
                                                                                                  ,4116                             
 NALLZ                      Scalar 3580     I(4)            4           scalar   COM              3842,3849,3858,3860,4015,4031,4107
                                                                                                  ,4118                             
 NBAS                       Scalar 3600     I(4)            4           scalar   COM                                                
 NEV                        Scalar 3583     I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 3621     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 3598     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 3600     I(4)            4     1     21       COM                                                
 NLEV                       Scalar 3623     I(4)            4           scalar   COM                                                
 NLV                        Scalar 3582     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 3583     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 3583     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 3623     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 3610     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 3594     I(4)            4     1     255      COM                                                
 NQV                        Scalar 3596     I(4)            4     1     255      COM                                                
 NST                        Param  3576     I(4)            4           scalar                    3581,3582,3583,3590,3599,3602,3603
                                                                                                  ,3604,3605,3606,3607,3608,3609,361
                                                                                                  0,3611,3612,3613,3614,3615,3616,36
                                                                                                  17                                
 NTDHM                      Scalar 3610     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 3594     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 3605     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 3596     I(4)            4     1     255      COM                                                
 NTHM                       Scalar 3608     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 3594     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 3605     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 3596     I(4)            4     1     255      COM                                                
 NTTMP                      Scalar 3617     I(4)            4     2     20979    COM                                                
 NTV                        Scalar 3596     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 3608     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 3594     I(4)            4     1     255      COM              3774,3781                         
 NZIM                       Scalar 3605     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 3617     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 3596     I(4)            4     1     255      COM                                                
 PARAMS                     Common 3623                                 148                                                         
 PFC                        Scalar 3584     R(4)            4     1     255      COM                                                
 PI                         Scalar 3592     R(4)            4     1     255      COM                                                
 PIS                        Scalar 3613     R(4)            4     1     999      COM                                                
 POB                        Scalar 3584     R(4)            4     1     255      COM              3664,3665,3843,3850,3859,3861,3903
                                                                                                  ,3905,3922,3929,3938,3940,3980,398
                                                                                                  2,3989,3997,4016,4023,4032,4034,40
                                                                                                  74,4076,4083,4101,4108,4117,4119,4
                                                                                                  159,4161,4168                     
 POUT                       Scalar 3627     L(4)            4           scalar   COM              3834,3913,4007,4093               

Page 131         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PQM                        Scalar 3584     R(4)            4     1     255      COM                                                
 PRC                        Scalar 3584     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 3624     L(4)            4           scalar   COM                                                
 PS                         Scalar 3590     R(4)            4     1     999      COM              3665                              
 PSCOR                      Scalar 3627     R(4)            4           scalar   COM                                                
 PSINC                      Scalar 3599     R(4)            4           scalar   COM                                                
 PTCOR1                     Local  3923     R(4)            4           scalar                    3923,3941,3981,4102,4120,4162     
 PTCOR2                     Local  3930     R(4)            4           scalar                    3930,3942,3983,4024,4077          
 PZCOR1                     Local  3844     R(4)            4           scalar                    3844,3862,3904,4017,4035,4075     
 PZCOR2                     Local  3851     R(4)            4           scalar                    3851,3863,3906,4109,4121,4160     
 QFC                        Scalar 3588     R(4)            4     1     255      COM                                                
 QG                         Scalar 3612     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 3603     R(4)            4     2     20979    COM                                                
 QI                         Scalar 3592     R(4)            4     1     255      COM                                                
 QIM                        Scalar 3602     R(4)            4     2     20979    COM                                                
 QM1                        Local  3847     R(4)            4           scalar                    3847,3882,3885,3888,3904,3926,3959
                                                                                                  ,3962,3965,3981,3987,3990,4020,405
                                                                                                  3,4056,4059,4075,4105,4138,4141,41
                                                                                                  44,4162,4166,4169                 
 QM2                        Local  3854     R(4)            4           scalar                    3854,3892,3895,3898,3906,3933,3969
                                                                                                  ,3972,3975,3983,3995,3998,4027,406
                                                                                                  3,4066,4069,4077,4081,4084,4112,41
                                                                                                  48,4151,4154,4160                 
 QOB                        Scalar 3588     R(4)            4     1     255      COM              3987,3990,3995,3998,4081,4084,4166
                                                                                                  ,4169                             
 QQM                        Scalar 3588     R(4)            4     1     255      COM              3985,3986,3993,3994,4079,4080,4164
                                                                                                  ,4165                             
 QRC                        Scalar 3588     R(4)            4     1     255      COM                                                
 QV                         Scalar 3593     R(4)            4     1     255      COM                                                
 QVM                        Scalar 3604     R(4)            4     2     20979    COM                                                
 R                          Scalar 3622     R(4)            4           scalar   COM              3665                              
 R10                        Local  3685     R(4)            4           scalar                    3685,3722,3723,3724,3729          
 R7                         Local  3679     R(4)            4           scalar                    3679,3706,3707,3729               
 R8                         Local  3681     R(4)            4           scalar                    3681,3710,3711,3712,3729          
 R9                         Local  3683     R(4)            4           scalar                    3683,3716,3717,3718,3729          
 RADPC                      Scalar 3623     R(4)            4           scalar   COM                                                
 RAT                        Local  3704     R(4)            4           scalar                    3704,3707,3711,3712,3717,3718,3723
                                                                                                  ,3724                             
 RESID                      Common 3592                                 41312                                                       
 ROUND                      Subr   3843                                                           3843,3850,3859,3861,3922,3929,3938
                                                                                                  ,3940,4016,4023,4032,4034,4101,410
                                                                                                  8,4117,4119                       
 RT1                        Local  3916     R(4)            4           scalar                    3916,3919,4097,4098               
 RT2                        Local  3917     R(4)            4           scalar                    3917,3919,4011,4013               
 RV                         Scalar 3622     R(4)            4           scalar   COM                                                
 RZ1                        Local  3837     R(4)            4           scalar                    3837,3840,4010,4013               
 RZ2                        Local  3838     R(4)            4           scalar                    3838,3840,4096,4098               
 S1                         Local  3750     R(4)            4           scalar                    3750,3754,3756,3759,3760,3762,3763
                                                                                                  ,3766,3768                        
 S2                         Local  3751     R(4)            4           scalar                    3751,3754,3756,3759,3760,3762,3763
                                                                                                  ,3766,3768                        
 S3                         Local  3752     R(4)            4           scalar                    3752,3754,3756,3759,3760,3762,3763
                                                                                                  ,3766,3768                        
 SDMQ                       Local  3635     L(4)            4           scalar                    3984,3985,3988,3992,3993,3996,4078
                                                                                                  ,4079,4082,4163,4164,4167         

Page 132         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SEVENT                     Subr   3903                                                           3903,3905,3980,3982,3989,3997,4074
                                                                                                  ,4076,4083,4159,4161,4168         
 SID                        Scalar 3581     CHAR            8     1     999      COM              3637,3903,3905,3980,3982,3989,3997
                                                                                                  ,4074,4076,4083,4159,4161,4168    
 SIMPLE                     Subr   3842                                                           3842,3849,3858,3860,3921,3928,3937
                                                                                                  ,3939,4015,4022,4031,4033,4100,410
                                                                                                  7,4116,4118                       
 SQN                        Scalar 3582     R(4)            4     1     999      COM              3903,3905,3980,3982,3989,3997,4074
                                                                                                  ,4076,4083,4159,4161,4168         
 SQRT                       Func   3680                                 scalar                    3680,3682,3684,3686,3692,3693     
 STN                        Common 3625                                 4                                                           
 T0                         Scalar 3622     R(4)            4           scalar   COM                                                
 T1                         Scalar 3626     R(4)            4           scalar   COM                                                
 TC1                        Local  3920     R(4)            4           scalar                    3920,3921,3922,3923,3924,3925,3935
                                                                                                  ,3937,3938,3941,3943,3947,3950,396
                                                                                                  1,3964,3980,3981,4099,4100,4101,41
                                                                                                  02,4103,4104,4114,4116,4117,4120,4
                                                                                                  122,4126,4130,4140,4143,4161,4162 
 TC2                        Local  3927     R(4)            4           scalar                    3927,3928,3929,3930,3931,3932,3936
                                                                                                  ,3939,3940,3942,3944,3948,3951,397
                                                                                                  1,3974,3983,4021,4022,4023,4024,40
                                                                                                  25,4026,4030,4033,4034,4036,4038,4
                                                                                                  042,4045,4065,4068,4077           
 TCBEST                     Scalar 3626     R(4)            4     1     2        COM              3797,3800,3807,3811,3916,3917,3935
                                                                                                  ,3936,4011,4030,4097,4114         
 TCLIM                      Scalar 3621     R(4)            4           scalar   COM              3943,3944,4038,4103,4122          
 TCOR                       Scalar 3626     R(4)            4     1     2        COM              3759,3760,3763,3766,3916,3917,3920
                                                                                                  ,3925,3927,3932,4011,4021,4026,403
                                                                                                  6,4097,4099,4104                  
 TDFC                       Scalar 3587     R(4)            4     1     255      COM                                                
 TDG                        Scalar 3612     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 3603     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 3592     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 3602     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 3587     R(4)            4     1     255      COM                                                
 TDV                        Scalar 3593     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 3604     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 3628     L(4)            4           scalar   COM              3637,3673,3729,3871,3950,4044,4129
 TESTS                      Common 3628                                 4                                                           
 TFACT                      Scalar 3620     R(4)            4     2     84       COM                                                
 TFC                        Scalar 3586     R(4)            4     1     255      COM                                                
 TG                         Scalar 3612     L(4)            4     2     20979    COM                                                
 THM                        Scalar 3603     R(4)            4     2     20979    COM              3798,3801,3808,3812,3947,3948,3950
                                                                                                  ,3951,4042,4045,4126,4130         
 TI                         Scalar 3592     R(4)            4     1     255      COM              3797,3800,3807,3811,3947,3948,3950
                                                                                                  ,3951,4042,4045,4126,4130         
 TIM                        Scalar 3602     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 3615     R(4)            4     3     83916    COM                                                
 TL                         Scalar 3593     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 3599     R(4)            4     1     255      COM                                                
 TMPSND                     Common 3614                                 1678336                                                     
 TMPSTD                     Scalar 3620     R(4)            4     2     84       COM              3792,3795,3799,3802,3806,3809,3813
                                                                                                  ,3816                             
 TOB                        Scalar 3586     R(4)            4     1     255      COM              3921,3928,3937,3939,3981,3983,4022
                                                                                                  ,4033,4077,4100,4116,4162         

Page 133         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TOBT                       Scalar 3614     R(4)            4     3     83916    COM                                                
 TQM                        Scalar 3586     R(4)            4     1     255      COM                                                
 TRC                        Scalar 3586     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 3627     R(4)            4           scalar   COM                                                
 TT                         Scalar 3624     R(4)            4           scalar   COM              3679,3682,3684,3686,3692,3693,3695
                                                                                                  ,3698                             
 TTMP                       Scalar 3616     R(4)            4     2     20979    COM              3799,3802,3809,3813,3947,3948,3951
                                                                                                  ,3952,4042,4046,4126,4131         
 TV                         Scalar 3593     R(4)            4     1     255      COM              3808,3812,3950,3951,4042,4045,4126
                                                                                                  ,4130                             
 TVM                        Scalar 3604     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 3587     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 3620     R(4)            4     2     84       COM              3805,3808,3812,3815               
 VTPPC                      Scalar 3623     R(4)            4           scalar   COM                                                
 XDR                        Scalar 3591     R(4)            4     1     255      COM                                                
 XINC                       Scalar 3619     R(4)            4     2     84       COM              3790,3793,3798,3801,3804,3808,3812
                                                                                                  ,3814,3837,3838,3864,3865,3916,391
                                                                                                  7,3924,3931,4010,4011,4018,4025,40
                                                                                                  96,4097                           
 XMA                        Scalar 3623     R(4)            4           scalar   COM                                                
 XMI                        Scalar 3623     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 3629     R(4)            4           scalar   COM              3790,3791,3793,3794,3797,3798,3800
                                                                                                  ,3801,3804,3807,3811,3814,3866,386
                                                                                                  7,3868,3869,3870,3904,3906,3945,39
                                                                                                  46,3947,3948,3949,3981,3983,3990,3
                                                                                                  998,3999,4040,4041,4043,4075,4077,
                                                                                                  4084,4085,4124,4127,4128,4160,4162
                                                                                                  ,4169,4170                        
 XOB                        Scalar 3581     R(4)            4     1     999      COM                                                
 XQHM                       Scalar 3611     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 3595     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 3607     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 3597     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 3601     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 3610     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 3595     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 3606     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 3597     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 3609     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 3600     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 3609     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 3595     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 3606     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 3597     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 3607     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 3600     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 3608     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 3595     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 3606     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 3597     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 3607     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 3591     R(4)            4     1     255      COM                                                
 YMA                        Scalar 3623     R(4)            4           scalar   COM                                                
 YMI                        Scalar 3623     R(4)            4           scalar   COM                                                
 YOB                        Scalar 3581     R(4)            4     1     999      COM                                                

Page 134         Source Listing                  ERR710
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZC1                        Local  3841     R(4)            4           scalar                    3841,3842,3843,3844,3845,3846,3856
                                                                                                  ,3858,3859,3862,3864,3866,3871,388
                                                                                                  4,3887,3903,3904,4014,4015,4016,40
                                                                                                  17,4018,4019,4029,4031,4032,4035,4
                                                                                                  037,4039,4044,4055,4058,4074,4075 
 ZC2                        Local  3848     R(4)            4           scalar                    3848,3849,3850,3851,3852,3853,3857
                                                                                                  ,3860,3861,3863,3865,3867,3872,389
                                                                                                  4,3897,3906,4106,4107,4108,4109,41
                                                                                                  10,4111,4115,4118,4119,4121,4123,4
                                                                                                  125,4129,4150,4153,4160           
 ZCBEST                     Scalar 3626     R(4)            4     1     2        COM              3790,3793,3804,3814,3837,3838,3856
                                                                                                  ,3857,4010,4029,4096,4115         
 ZCLIM                      Scalar 3621     R(4)            4           scalar   COM              3845,3852,4037,4110,4123          
 ZCOR                       Scalar 3626     R(4)            4     1     2        COM              3754,3756,3762,3768,3837,3838,3841
                                                                                                  ,3846,3848,3853,4010,4014,4019,409
                                                                                                  6,4106,4111                       
 ZD                         Scalar 3600     R(4)            4     1     255      COM              3777,3784                         
 ZDIF                       Local  3775     R(4)            4           scalar                    3775,3777,3804,3866,4039          
 ZDIFP                      Local  3782     R(4)            4           scalar                    3782,3784,3787,3814,3867,4125     
 ZFC                        Scalar 3585     R(4)            4     1     255      COM                                                
 ZG                         Scalar 3612     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 3603     R(4)            4     2     20979    COM              3791,3794,3805,3815,3866,3867,3871
                                                                                                  ,3872,4039,4044,4125,4129         
 ZI                         Scalar 3592     R(4)            4     1     255      COM              3775,3782,3790,3793,3871,3872,4044
                                                                                                  ,4129                             
 ZIM                        Scalar 3602     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 3615     R(4)            4     3     83916    COM                                                
 ZOB                        Scalar 3585     R(4)            4     1     255      COM              3842,3849,3858,3860,3904,3906,4015
                                                                                                  ,4031,4075,4107,4118,4160         
 ZOBT                       Scalar 3614     R(4)            4     3     83916    COM                                                
 ZQM                        Scalar 3585     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 3585     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 3627     R(4)            4           scalar   COM                                                
 ZTMP                       Scalar 3616     R(4)            4     2     20979    COM              3792,3795,3806,3816,3866,3867,3872
                                                                                                  ,3873,4039,4045,4125,4130         
 ZV                         Scalar 3593     R(4)            4     1     255      COM              3805,3815,3871,3872,4039,4044,4125
                                                                                                  ,4129                             
 ZVM                        Scalar 3604     R(4)            4     2     20979    COM                                                

Page 135         Source Listing                  ERR710
2017-04-18 11:07                                 cqcbufr.f

   4177 
   4178 C******************************************************************
   4179 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4180 C                .      .    .                                       .
   4181 C SUBPROGRAM:    ERRTYP      CHECK QC FOR APPROPRIATE LEVEL TYPE
   4182 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   4183 C
   4184 C ABSTRACT: Call the appropriate subroutine for each level to check
   4185 C   the data quality.  See STYPE for a listing of these types.
   4186 C
   4187 C PROGRAM HISTORY LOG:
   4188 C 1997-03-18  W. Collins  Original author.
   4189 C
   4190 C USAGE:    CALL ERRTYP
   4191 C   OUTPUT FILES:
   4192 C     UNIT 06  - PRINTOUT
   4193 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   4194 C
   4195 C REMARKS: NONE.
   4196 C
   4197 C ATTRIBUTES:
   4198 C   LANGUAGE: FORTRAN 90
   4199 C   MACHINE:  NCEP WCOSS
   4200 C
   4201 C$$$
   4202 
   4203       SUBROUTINE ERRTYP
   4204       PARAMETER (NST=999)
   4205 
   4206       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   4207      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   4208      &                 NEV, ISF(NST), NLVM, NLVW
   4209       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   4210      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   4211      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   4212      &                 TDO(255), TDFC(255),TVO(255),
   4213      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   4214      &                 CAT(255), IND(255), LEVTYP(255),
   4215      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   4216      &                 YDR(255), XDR(255)
   4217       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   4218      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   4219      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   4220      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   4221      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   4222      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   4223      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   4224      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   4225      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   4226      &                 XTDH(255)
   4227       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   4228      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   4229       COMMON /STN/     IS
   4230       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   4231      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   4232       COMMON /TESTS/   TEST
   4233       LOGICAL          TEST

Page 136         Source Listing                  ERRTYP
2017-04-18 11:07                                 cqcbufr.f

   4234       CHARACTER*8 SID
   4235       LOGICAL POUT
   4236       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
   4237 
   4238       IF(TEST) WRITE(60,503) SID(IS)
   4239   503 FORMAT(' ERRTYP--CALLED FOR: ',A8)
   4240 
   4241 C  PREFORM ANALYSIS, LAYER BY LAYER
   4242 C  --------------------------------
   4243 
   4244       DO I=1,2
   4245         ZCOR(I)   = 0.
   4246         TCOR(I)   = 0.
   4247         ZCBEST(I) = 0.
   4248         TCBEST(I) = 0.
   4249       ENDDO
   4250       H1   = 0.
   4251       H2   = 0.
   4252       T1   = 0.
   4253       POUT = .FALSE.
   4254       IF(ISC.EQ.1) THEN
   4255         L1 = 1
   4256       ELSE
   4257         L1 = LAST+1
   4258       ENDIF
   4259       IF(L1.GT.NLEV) L1 = NLEV
   4260       DO LM=L1,NLEV
   4261         LS = LM
   4262         IF(LM.LE.0) THEN
   4263           WRITE(60,504) LM,NLEV
   4264   504     FORMAT(' ERRTYP--PROBLEM! LM = ',I5,'  NLEV = ',I5)
   4265           RETURN
   4266         ENDIF
   4267         L = MANLEV(POB(LM))
   4268         LAST = LM
   4269 
   4270 C  TYPE 240: SURFACE
   4271 C  -----------------
   4272 
   4273         IF(LST(LM).EQ.240) THEN
   4274           CALL T240(L,LS)
   4275           IF(POUT) GOTO 110
   4276 
   4277 C  TYPE 120: MAND, FIRST ABOVE GROUND
   4278 C  ----------------------------------
   4279 
   4280         ELSEIF(LST(LM).EQ.120) THEN
   4281           CALL T120(L,LS)
   4282           IF(POUT) GOTO 110
   4283 
   4284 C  TYPE 130: MAND, MIDDLE
   4285 C  ----------------------
   4286 
   4287         ELSEIF(LST(LM).EQ.130) THEN
   4288           CALL T130(L,LS)
   4289           IF(POUT) GOTO 110
   4290 

Page 137         Source Listing                  ERRTYP
2017-04-18 11:07                                 cqcbufr.f

   4291 C  TYPE 140: MAND, TOP, AND
   4292 C  TYPE 131: MAND,MIDDLE, LOWER HOLE BOUNDARY
   4293 C  ------------------------------------------
   4294 
   4295         ELSEIF(LST(LM).EQ.131 .OR. LST(LM).EQ.140) THEN
   4296           CALL T140(L,LS)
   4297           IF(POUT) GOTO 110
   4298 
   4299 C  TYPE 132: MAND,MIDDLE, UPPER HOLE BOUNDARY
   4300 C  ------------------------------------------
   4301 
   4302         ELSEIF(LST(LM).EQ.132) THEN
   4303           ! No hydrostatic correction
   4304 
   4305 C  TYPE 142: MAND, TOP, UPPER HOLE BOUNDARY (ISOLATED) AND
   4306 C  TYPE 133: MAND, MIDDLE, ISOLATED
   4307 C  -------------------------------------------------------
   4308 
   4309         ELSEIF(LST(LM).EQ.142 .OR.LST(LM).EQ.133) THEN
   4310           ! No hydrostatic correction
   4311 
   4312 C  TYPE 121: MAND 1ST ABOVE GROUND, LOWER HOLE BOUNDARY (ISOLATED)
   4313 C  ---------------------------------------------------------------
   4314 
   4315         ELSEIF(LST(LM).EQ.121) THEN
   4316           CALL T121(L,LS)
   4317           IF(POUT) GOTO 110
   4318 
   4319 C  TYPE 220: SIGNIFICANT LEVEL
   4320 C  ---------------------------
   4321 
   4322         ELSEIF(LST(LM).EQ.220) THEN
   4323           CALL T220(L,LS)
   4324           IF(POUT) GOTO 110
   4325 
   4326 C  TYPE 224: SIGNIFICANT LEVEL, ABOVE TOP MAND LVL
   4327 C  -----------------------------------------------
   4328 
   4329         ELSEIF(LST(LM).EQ.220) THEN
   4330           ! No hydrostatic correction
   4331 
   4332 C  TYPE 150: INCOMPLETE MANDATORY LEVEL
   4333 C  ------------------------------------
   4334 
   4335         ELSEIF(LST(LM).EQ.150) THEN
   4336           CALL T220(L,LS)
   4337           IF(POUT) GOTO 110
   4338         ENDIF
   4339       ENDDO
   4340 
   4341   110 CONTINUE
   4342       IF(POUT .AND. LM.LE.NLEV) THEN
   4343         IF(TEST) WRITE(60,500) SID(IS)
   4344         IF(TEST) WRITE(60,501)
   4345         IF(TEST) WRITE(60,502) POB(LM),IHSC(1,LM),PSCOR,IHSC(2,LM),
   4346      &    ZCOR(1),IHSC(3,LM),TCOR(1),LST(LM),ZCBEST(1),TCBEST(1)
   4347         IF(L+1.LE.MAND) THEN

Page 138         Source Listing                  ERRTYP
2017-04-18 11:07                                 cqcbufr.f

   4348           LX = LMAND(L+1)
   4349           IF(LX.LE.255) THEN
   4350             IF(TEST) WRITE(60,502) POB(LX),IHSC(1,LX),0.,IHSC(2,LX),
   4351      &        ZCOR(2),IHSC(3,LX),TCOR(2),LST(LX),ZCBEST(2),TCBEST(2)
   4352           ENDIF
   4353         ENDIF
   4354       ENDIF
   4355   500 FORMAT(//' ERRTYP--HYDROSTATIC DIAGNOSIS FOR STATION: ',A8)
   4356   501 FORMAT('   PRESS IHSC-P    PCOR IHSC-Z    ZCOR IHSC-T    TCOR',
   4357      &  '   LST  ZCBEST  TCBEST')
   4358   502 FORMAT(F8.1,2(I7,F8.0),I7,F8.1,I6,F8.0,F8.1)
   4359 
   4360       RETURN
   4361       END


ENTRY POINTS

  Name               
                     
 errtyp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 110                        Label  4341                                                           4275,4282,4289,4297,4317,4324,4337
 500                        Label  4355                                                           4343                              
 501                        Label  4356                                                           4344                              
 502                        Label  4358                                                           4345,4350                         
 503                        Label  4239                                                           4238                              
 504                        Label  4264                                                           4263                              
 ALLSND                     Common 4209                                 34512                                                       
 B                          Scalar 4225     R(4)            4     1     21       COM                                                
 BASRES                     Scalar 4224     R(4)            4     1     999      COM                                                
 CAT                        Scalar 4214     R(4)            4     1     255      COM                                                
 CQCPC                      Scalar 4228     R(4)            4           scalar   COM                                                
 DHR                        Scalar 4206     R(4)            4     1     999      COM                                                
 ELV                        Scalar 4207     R(4)            4     1     999      COM                                                
 ERROR                      Local  4236     L(4)            4           scalar                                                      
 ERRTYP                     Subr   4203                                                                                             
 GESPS                      Scalar 4215     R(4)            4     1     999      COM                                                
 H1                         Scalar 4230     R(4)            4           scalar   COM              4250                              
 H2                         Scalar 4230     R(4)            4           scalar   COM              4251                              
 HEADER                     Common 4206                                 35980                                                       
 HRDR                       Scalar 4215     R(4)            4     1     255      COM                                                
 HYD                        Scalar 4223     R(4)            4     1     21       COM                                                
 HYDN                       Scalar 4223     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 4223     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 4223     R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 4230                                 64                                                          
 I                          Local  4244     I(4)            4           scalar                    4244,4245,4246,4247,4248          
 IHSC                       Scalar 4224     I(4)            4     2     1020     COM              4345,4346,4350,4351               
 IND                        Scalar 4214     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 4228     I(4)            4           scalar   COM                                                
 IS                         Scalar 4229     I(4)            4           scalar   COM              4238,4343                         

Page 139         Source Listing                  ERRTYP
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ISC                        Scalar 4228     I(4)            4           scalar   COM              4254                              
 ISF                        Scalar 4208     I(4)            4     1     999      COM                                                
 ITP                        Scalar 4207     I(4)            4     1     999      COM                                                
 L                          Local  4267     I(4)            4           scalar                    4267,4274,4281,4288,4296,4316,4323
                                                                                                  ,4336,4347,4348                   
 L1                         Local  4255     I(4)            4           scalar                    4255,4257,4259,4260               
 LAST                       Scalar 4231     I(4)            4           scalar   COM              4257,4268                         
 LEVTYP                     Scalar 4214     I(4)            4     1     255      COM                                                
 LM                         Local  4260     I(4)            4           scalar                    4260,4261,4262,4263,4267,4268,4273
                                                                                                  ,4280,4287,4295,4302,4309,4315,432
                                                                                                  2,4329,4335,4342,4345,4346        
 LMAND                      Scalar 4228     I(4)            4     1     22       COM              4348                              
 LS                         Local  4261     I(4)            4           scalar                    4261,4274,4281,4288,4296,4316,4323
                                                                                                  ,4336                             
 LSFC                       Scalar 4228     I(4)            4           scalar   COM                                                
 LST                        Scalar 4215     I(4)            4     1     255      COM              4273,4280,4287,4295,4302,4309,4315
                                                                                                  ,4322,4329,4335,4346,4351         
 LX                         Local  4348     I(4)            4           scalar                    4348,4349,4350,4351               
 MAND                       Scalar 4227     I(4)            4           scalar   COM              4347                              
 MANLEV                     Func   4267     I(4)            4           scalar                    4267                              
 NBAS                       Scalar 4225     I(4)            4           scalar   COM                                                
 NEV                        Scalar 4208     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 4223     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 4225     I(4)            4     1     21       COM                                                
 NLEV                       Scalar 4227     I(4)            4           scalar   COM              4259,4260,4263,4342               
 NLV                        Scalar 4207     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 4208     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 4208     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 4227     I(4)            4           scalar   COM                                                
 NQI                        Scalar 4219     I(4)            4     1     255      COM                                                
 NQV                        Scalar 4221     I(4)            4     1     255      COM                                                
 NST                        Param  4204     I(4)            4           scalar                    4206,4207,4208,4215,4224          
 NTDI                       Scalar 4219     I(4)            4     1     255      COM                                                
 NTDV                       Scalar 4221     I(4)            4     1     255      COM                                                
 NTI                        Scalar 4219     I(4)            4     1     255      COM                                                
 NTL                        Scalar 4221     I(4)            4     1     255      COM                                                
 NTV                        Scalar 4221     I(4)            4     1     255      COM                                                
 NZI                        Scalar 4219     I(4)            4     1     255      COM                                                
 NZV                        Scalar 4221     I(4)            4     1     255      COM                                                
 PARAMS                     Common 4227                                 148                                                         
 PFC                        Scalar 4209     R(4)            4     1     255      COM                                                
 PI                         Scalar 4217     R(4)            4     1     255      COM                                                
 POB                        Scalar 4209     R(4)            4     1     255      COM              4267,4345,4350                    
 POUT                       Scalar 4231     L(4)            4           scalar   COM              4253,4275,4282,4289,4297,4317,4324
                                                                                                  ,4337,4342                        
 PQM                        Scalar 4209     R(4)            4     1     255      COM                                                
 PRC                        Scalar 4209     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 4228     L(4)            4           scalar   COM                                                
 PS                         Scalar 4215     R(4)            4     1     999      COM                                                
 PSCOR                      Scalar 4231     R(4)            4           scalar   COM              4345                              
 PSINC                      Scalar 4224     R(4)            4           scalar   COM                                                
 QFC                        Scalar 4213     R(4)            4     1     255      COM                                                
 QG                         Local  4236     L(4)            4           scalar                                                      
 QI                         Scalar 4217     R(4)            4     1     255      COM                                                
 QOB                        Scalar 4213     R(4)            4     1     255      COM                                                

Page 140         Source Listing                  ERRTYP
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QQM                        Scalar 4213     R(4)            4     1     255      COM                                                
 QRC                        Scalar 4213     R(4)            4     1     255      COM                                                
 QV                         Scalar 4218     R(4)            4     1     255      COM                                                
 RADPC                      Scalar 4227     R(4)            4           scalar   COM                                                
 RESID                      Common 4217                                 41312                                                       
 SID                        Scalar 4206     CHAR            8     1     999      COM              4238,4343                         
 SQN                        Scalar 4207     R(4)            4     1     999      COM                                                
 STN                        Common 4229                                 4                                                           
 T1                         Scalar 4230     R(4)            4           scalar   COM              4252                              
 T120                       Subr   4281                                                           4281                              
 T121                       Subr   4316                                                           4316                              
 T130                       Subr   4288                                                           4288                              
 T140                       Subr   4296                                                           4296                              
 T220                       Subr   4323                                                           4323,4336                         
 T240                       Subr   4274                                                           4274                              
 TCBEST                     Scalar 4230     R(4)            4     1     2        COM              4248,4346,4351                    
 TCOR                       Scalar 4230     R(4)            4     1     2        COM              4246,4346,4351                    
 TDFC                       Scalar 4212     R(4)            4     1     255      COM                                                
 TDG                        Local  4236     L(4)            4           scalar                                                      
 TDI                        Scalar 4217     R(4)            4     1     255      COM                                                
 TDO                        Scalar 4212     R(4)            4     1     255      COM                                                
 TDV                        Scalar 4218     R(4)            4     1     255      COM                                                
 TEST                       Scalar 4232     L(4)            4           scalar   COM              4238,4343,4344,4345,4350          
 TESTS                      Common 4232                                 4                                                           
 TFC                        Scalar 4211     R(4)            4     1     255      COM                                                
 TG                         Local  4236     L(4)            4           scalar                                                      
 TI                         Scalar 4217     R(4)            4     1     255      COM                                                
 TL                         Scalar 4218     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 4224     R(4)            4     1     255      COM                                                
 TOB                        Scalar 4211     R(4)            4     1     255      COM                                                
 TQM                        Scalar 4211     R(4)            4     1     255      COM                                                
 TRC                        Scalar 4211     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 4231     R(4)            4           scalar   COM                                                
 TT                         Scalar 4228     R(4)            4           scalar   COM                                                
 TV                         Scalar 4218     R(4)            4     1     255      COM                                                
 TVO                        Scalar 4212     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 4227     R(4)            4           scalar   COM                                                
 XDR                        Scalar 4216     R(4)            4     1     255      COM                                                
 XMA                        Scalar 4227     R(4)            4           scalar   COM                                                
 XMI                        Scalar 4227     R(4)            4           scalar   COM                                                
 XOB                        Scalar 4206     R(4)            4     1     999      COM                                                
 XQI                        Scalar 4220     R(4)            4     1     255      COM                                                
 XQV                        Scalar 4222     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 4226     R(4)            4     1     255      COM                                                
 XTDI                       Scalar 4220     R(4)            4     1     255      COM                                                
 XTDV                       Scalar 4222     R(4)            4     1     255      COM                                                
 XTH                        Scalar 4225     R(4)            4     1     255      COM                                                
 XTI                        Scalar 4220     R(4)            4     1     255      COM                                                
 XTV                        Scalar 4222     R(4)            4     1     255      COM                                                
 XZH                        Scalar 4225     R(4)            4     1     255      COM                                                
 XZI                        Scalar 4220     R(4)            4     1     255      COM                                                
 XZV                        Scalar 4222     R(4)            4     1     255      COM                                                
 YDR                        Scalar 4216     R(4)            4     1     255      COM                                                
 YMA                        Scalar 4227     R(4)            4           scalar   COM                                                
 YMI                        Scalar 4227     R(4)            4           scalar   COM                                                

Page 141         Source Listing                  ERRTYP
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YOB                        Scalar 4206     R(4)            4     1     999      COM                                                
 ZCBEST                     Scalar 4230     R(4)            4     1     2        COM              4247,4346,4351                    
 ZCOR                       Scalar 4230     R(4)            4     1     2        COM              4245,4346,4351                    
 ZD                         Scalar 4225     R(4)            4     1     255      COM                                                
 ZFC                        Scalar 4210     R(4)            4     1     255      COM                                                
 ZG                         Local  4236     L(4)            4           scalar                                                      
 ZI                         Scalar 4217     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 4210     R(4)            4     1     255      COM                                                
 ZQM                        Scalar 4210     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 4210     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 4231     R(4)            4           scalar   COM                                                
 ZV                         Scalar 4218     R(4)            4     1     255      COM                                                

Page 142         Source Listing                  ERRTYP
2017-04-18 11:07                                 cqcbufr.f

   4362 
   4363 C************************************************************************
   4364 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4365 C                .      .    .                                       .
   4366 C SUBPROGRAM:    EVENT         WRITE AN EVENT.
   4367 C   PRGMMR: J. Woollen       ORG: NP20       DATE: 1994-MM-DD
   4368 C
   4369 C ABSTRACT: COMPUTE EXPANSION FACTOR FOR CORECT.
   4370 C
   4371 C PROGRAM HISTORY LOG:
   4372 C 1994-MM-DD  J. Woollen  Original author.
   4373 C
   4374 C USAGE:    CALL EVENT(LUNIT,EVNSTR,NLV,OBS,QMS,RCS,IND,NEVN,QCPC)
   4375 C   INPUT ARGUMENT LIST:
   4376 C     LUNIT    - UNIT NUMBER
   4377 C     EVNSTR   - EVENT STREAM OF CHARACTERS
   4378 C     NLV      - NUMBER OF LEVELS
   4379 C     OBS      - OBSERVED VALUE
   4380 C     QMS      - QUALITY MARKER
   4381 C     RCS      - REASON CODE
   4382 C     IND      - INDIRECT ADDRESS OF VALUE
   4383 C     NEVN     - NUMBER OF EVENTS
   4384 C     QCPC     - PROGRAM CODE
   4385 C
   4386 C   OUTPUT FILES:
   4387 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   4388 C
   4389 C REMARKS: NONE.
   4390 C
   4391 C ATTRIBUTES:
   4392 C   LANGUAGE: FORTRAN 90
   4393 C   MACHINE:  NCEP WCOSS
   4394 C
   4395 C$$$
   4396       SUBROUTINE EVENT(LUNIT,EVNSTR,NLV,OBS,QMS,RCS,IND,NEVN,QCPC)
   4397 
   4398       REAL(8) BMISS,EVNS_8(4,255)
   4399 
   4400       COMMON /TESTS/   TEST
   4401       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   4402 
   4403       LOGICAL          TEST
   4404       CHARACTER*(*) EVNSTR
   4405       DIMENSION     OBS(NEVN),QMS(NEVN),RCS(NEVN),IND(NEVN)
   4406 
   4407 C-----------------------------------------------------------------------
   4408 C-----------------------------------------------------------------------
   4409 
   4410       IRET = 0
   4411       IF(NEVN.EQ.0) GOTO 100
   4412 
   4413 
   4414 C  CLEAR THE UFB ARRAY FIRST
   4415 C  -------------------------
   4416 
   4417       EVNS_8 = BMISS
   4418 

Page 143         Source Listing                  EVENT
2017-04-18 11:07                                 cqcbufr.f

   4419 C  TRANSFER EVENT ARRAYS INTO UFB ARRAY
   4420 C  ------------------------------------
   4421 
   4422       DO I=1,NEVN
   4423         J = IND(I)
   4424         IF(OBS(I).LT.0.5*BMISS .AND. J.LE.255) THEN
   4425            EVNS_8(1,J) = OBS(I)
   4426            EVNS_8(2,J) = QMS(I)
   4427            EVNS_8(3,J) = QCPC
   4428            EVNS_8(4,J) = RCS(I)
   4429         ENDIF
   4430       ENDDO
   4431 
   4432 C  WRITE THE EVENTS
   4433 C  ----------------
   4434 
   4435       CALL UFBINT(LUNIT,EVNS_8,4,NLV,IRET,EVNSTR)
   4436 
   4437   100 CONTINUE
   4438       IF(TEST) WRITE(60,500) LUNIT,NEVN,NLV,IRET,EVNSTR,QCPC
   4439   500 FORMAT(' EVENT--LUNIT,NEVN,NLV,IRET,EVNSTR:',4I5,A60,
   4440      &  ' QCPC:',F8.0)
   4441 
   4442       RETURN
   4443       END


ENTRY POINTS

  Name              
                    
 event_             

Page 144         Source Listing                  EVENT
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  4437                                                           4411                              
 500                        Label  4439                                                           4438                              
 BMISS                      Scalar 4398     R(8)            8           scalar   COM              4417,4424                         
 BUFRLIB_MISSING            Common 4401                                 16                                                          
 EVENT                      Subr   4396                                                                                             
 EVNSTR                     Dummy  4396     CHAR                        scalar   ARG,INOUT        4435,4438                         
 EVNS_8                     Local  4398     R(8)            8     2     1020                      4417,4425,4426,4427,4428,4435     
 I                          Local  4422     I(4)            4           scalar                    4422,4423,4424,4425,4426,4428     
 IMISS                      Scalar 4401     I(4)            4           scalar   COM                                                
 IND                        Dummy  4396     I(4)            4     1     0        ARG,INOUT        4423                              
 IRET                       Local  4410     I(4)            4           scalar                    4410,4435,4438                    
 J                          Local  4423     I(4)            4           scalar                    4423,4424,4425,4426,4427,4428     
 LUNIT                      Dummy  4396     I(4)            4           scalar   ARG,INOUT        4435,4438                         
 NEVN                       Dummy  4396     I(4)            4           scalar   ARG,INOUT        4405,4411,4422,4438               
 NLV                        Dummy  4396     I(4)            4           scalar   ARG,INOUT        4435,4438                         
 OBS                        Dummy  4396     R(4)            4     1     0        ARG,INOUT        4424,4425                         
 QCPC                       Dummy  4396     R(4)            4           scalar   ARG,INOUT        4427,4438                         
 QMS                        Dummy  4396     R(4)            4     1     0        ARG,INOUT        4426                              
 RCS                        Dummy  4396     R(4)            4     1     0        ARG,INOUT        4428                              
 TEST                       Scalar 4400     L(4)            4           scalar   COM              4438                              
 TESTS                      Common 4400                                 4                                                           
 UFBINT                     Subr   4435                                                           4435                              
 XMISS                      Scalar 4401     R(4)            4           scalar   COM                                                

Page 145         Source Listing                  EVENT
2017-04-18 11:07                                 cqcbufr.f

   4444 
   4445 C*******************************************************************
   4446 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4447 C                .      .    .                                       .
   4448 C SUBPROGRAM:    EVENTW        WRITE A WIND EVENT.
   4449 C   PRGMMR: J. Woollen       ORG: NP20       DATE: 1994-MM-DD
   4450 C
   4451 C ABSTRACT: COMPUTE EXPANSION FACTOR FOR CORECT.
   4452 C
   4453 C PROGRAM HISTORY LOG:
   4454 C 1994-MM-DD  J. Woollen  Original author.
   4455 C 1997-05-23  W. Collins  Modified for wind event.
   4456 C
   4457 C USAGE:    CALL EVENTW(LUNIT,EVNSTR,NLV,OBS,QMS,RCS,IND,NEVN,QCPC)
   4458 C   INPUT ARGUMENT LIST:
   4459 C     LUNIT    - UNIT NUMBER
   4460 C     EVNSTR   - EVENT STREAM OF CHARACTERS
   4461 C     NLV      - NUMBER OF LEVELS
   4462 C     OBS      - OBSERVED VALUES
   4463 C     QMS      - QUALITY MARKER
   4464 C     RCS      - REASON CODE
   4465 C     IND      - INDIRECT ADDRESS OF VALUE
   4466 C     NEVN     - NUMBER OF EVENTS
   4467 C     QCPC     - PROGRAM CODE
   4468 C
   4469 C   OUTPUT FILES:
   4470 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   4471 C
   4472 C REMARKS: NONE.
   4473 C
   4474 C ATTRIBUTES:
   4475 C   LANGUAGE: FORTRAN 90
   4476 C   MACHINE:  NCEP WCOSS
   4477 C
   4478 C$$$
   4479       SUBROUTINE EVENTW(LUNIT,EVNSTR,NLV,OBS,QMS,RCS,IND,NEVN,QCPC)
   4480 
   4481       REAL(8) BMISS,EVNS_8(5,255)
   4482 
   4483       COMMON /TESTS/   TEST
   4484       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   4485 
   4486       LOGICAL          TEST
   4487       CHARACTER*(*) EVNSTR
   4488       DIMENSION     OBS(2,NEVN),QMS(NEVN),RCS(NEVN),IND(NEVN)
   4489 
   4490 C-----------------------------------------------------------------------
   4491 C-----------------------------------------------------------------------
   4492 
   4493       IRET = 0
   4494       IF(NEVN.EQ.0) GOTO 100
   4495 
   4496 
   4497 C  CLEAR THE UFB ARRAY FIRST
   4498 C  -------------------------
   4499 
   4500       EVNS_8 = BMISS

Page 146         Source Listing                  EVENTW
2017-04-18 11:07                                 cqcbufr.f

   4501 
   4502 C  TRANSFER EVENT ARRAYS INTO UFB ARRAY
   4503 C  ------------------------------------
   4504 
   4505       DO I=1,NEVN
   4506         J = IND(I)
   4507         IF(OBS(1,I).LT.BMISS .AND. J.LE.255) THEN
   4508            EVNS_8(1,J) = OBS(1,I)
   4509            EVNS_8(2,J) = OBS(2,I)
   4510            EVNS_8(3,J) = QMS(I)
   4511            EVNS_8(4,J) = QCPC
   4512            EVNS_8(5,J) = RCS(I)
   4513         ENDIF
   4514       ENDDO
   4515 
   4516 C  WRITE THE EVENTS
   4517 C  ----------------
   4518 
   4519       CALL UFBINT(LUNIT,EVNS_8,5,NLV,IRET,EVNSTR)
   4520 
   4521   100 CONTINUE
   4522       IF(TEST) WRITE(60,500) LUNIT,NEVN,NLV,IRET,EVNSTR,QCPC
   4523   500 FORMAT(' EVENT--LUNIT,NEVN,NLV,IRET,EVNSTR:',4I5,A60,
   4524      &  ' QCPC:',F8.0)
   4525 
   4526       RETURN
   4527       END


ENTRY POINTS

  Name               
                     
 eventw_             

Page 147         Source Listing                  EVENTW
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  4521                                                           4494                              
 500                        Label  4523                                                           4522                              
 BMISS                      Scalar 4481     R(8)            8           scalar   COM              4500,4507                         
 BUFRLIB_MISSING            Common 4484                                 16                                                          
 EVENTW                     Subr   4479                                                                                             
 EVNSTR                     Dummy  4479     CHAR                        scalar   ARG,INOUT        4519,4522                         
 EVNS_8                     Local  4481     R(8)            8     2     1275                      4500,4508,4509,4510,4511,4512,4519
 I                          Local  4505     I(4)            4           scalar                    4505,4506,4507,4508,4509,4510,4512
 IMISS                      Scalar 4484     I(4)            4           scalar   COM                                                
 IND                        Dummy  4479     I(4)            4     1     0        ARG,INOUT        4506                              
 IRET                       Local  4493     I(4)            4           scalar                    4493,4519,4522                    
 J                          Local  4506     I(4)            4           scalar                    4506,4507,4508,4509,4510,4511,4512
 LUNIT                      Dummy  4479     I(4)            4           scalar   ARG,INOUT        4519,4522                         
 NEVN                       Dummy  4479     I(4)            4           scalar   ARG,INOUT        4488,4494,4505,4522               
 NLV                        Dummy  4479     I(4)            4           scalar   ARG,INOUT        4519,4522                         
 OBS                        Dummy  4479     R(4)            4     2     0        ARG,INOUT        4507,4508,4509                    
 QCPC                       Dummy  4479     R(4)            4           scalar   ARG,INOUT        4511,4522                         
 QMS                        Dummy  4479     R(4)            4     1     0        ARG,INOUT        4510                              
 RCS                        Dummy  4479     R(4)            4     1     0        ARG,INOUT        4512                              
 TEST                       Scalar 4483     L(4)            4           scalar   COM              4522                              
 TESTS                      Common 4483                                 4                                                           
 UFBINT                     Subr   4519                                                           4519                              
 XMISS                      Scalar 4484     R(4)            4           scalar   COM                                                

Page 148         Source Listing                  EVENTW
2017-04-18 11:07                                 cqcbufr.f

   4528 
   4529 C******************************************************************
   4530 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4531 C                .      .    .                                       .
   4532 C SUBPROGRAM:    EVPROC      PREPARE EVENTS FOR PREPBUFR OUTPUT
   4533 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   4534 C
   4535 C ABSTRACT: Prepare events for PREPBUFR output.  This is necessary
   4536 C   since there may be multiple actions on the same variable, but only
   4537 C   one event should be written.
   4538 C
   4539 C PROGRAM HISTORY LOG:
   4540 C 1997-03-18  W. Collins  Original author.
   4541 C
   4542 C USAGE:    CALL EVPROC(I1,I2,ICALL)
   4543 C   INPUT ARGUMENT LIST:
   4544 C     I1       - INDEX OF FIRST EVENT TO CONSIDER
   4545 C     I2       - INDEX OF LAST EVENT TO CONSIDER
   4546 C     ICALL    - 1 for call from MAIN
   4547 C              - 2 for call from STEVNTS
   4548 C
   4549 C   OUTPUT FILES:
   4550 C     UNIT 06  - PRINTOUT
   4551 C     UNIT 52  - OUTPUT PRINT FILE OF VALUES, RESIDUALS AND EVENTS
   4552 C
   4553 C REMARKS: NONE.
   4554 C
   4555 C ATTRIBUTES:
   4556 C   LANGUAGE: FORTRAN 90
   4557 C   MACHINE:  NCEP WCOSS
   4558 C
   4559 C$$$
   4560 
   4561       SUBROUTINE EVPROC(I1,I2,ICALL)
   4562       PARAMETER (NST=999)
   4563 
   4564       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
   4565      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
   4566      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
   4567      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
   4568      &                 BASR(2000),   PISR(2000),  PSINCR(2000),
   4569      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
   4570       COMMON /EVNBUF/ STNB(2000),   SEQNB(2000), ISCANB(2000),
   4571      &                LEVLB(2000),  PRESB(2000), LTYPB(2000),
   4572      &                IVARB(2000),  CORB(2000),  CORVALB(2000),
   4573      &                QMARKB(2000), IETYPB(2000),EDATEB(2000),
   4574      &                LSTYPB(2000), PCORB(2000), IEVENTB
   4575       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   4576      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   4577      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   4578      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   4579      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   4580      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   4581      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   4582      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   4583      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   4584      &                 XTDH(255)

Page 149         Source Listing                  EVPROC
2017-04-18 11:07                                 cqcbufr.f

   4585       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   4586      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   4587      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   4588      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   4589      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   4590      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   4591      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   4592      &                 XTHM(21,NST),XTDVM(21,NST),
   4593      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   4594      &                 XQHM(21,NST),
   4595      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   4596      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   4597 
   4598       REAL            BSEQN(2000), CORL(0:100), CORVALL(0:100),
   4599      &                QMARKL(0:100)
   4600       INTEGER         IBVAR(2000), IBLVL(2000), IETYPL(0:100),
   4601      &                IEV(2000)
   4602       CHARACTER*8     STN, STNB
   4603       CHARACTER*10    EDATE, EDATEB, BDATE(2000)
   4604       CHARACTER*2     CVAR(5)
   4605       LOGICAL         QGOOD
   4606       DATA CVAR/' P',' Z',' T','TD',' Q'/
   4607 
   4608 C  THIS SUBROUTINE PROCESSES THE EVENTS FILE TO PRODUCE A LIST OF EVENTS
   4609 C  TO BE ADDED TO THE PREPBUFR FILE. FIRST, MAKE A LIST OF ALL THE
   4610 C  UNIQUE DATA FOR WHICH THERE IS AN EVENT.
   4611 C  ---------------------------------------------------------------------
   4612 
   4613       IBUF = 0
   4614       DO I=I1,I2
   4615         IF(IBUF.NE.0) THEN
   4616           DO J=1,IBUF
   4617             IF(EDATE(I).EQ.BDATE(J) .AND.
   4618      &         SEQN(I).EQ.BSEQN(J)  .AND.
   4619      &         IVAR(I).EQ.IBVAR(J)  .AND.
   4620      &         LEVL(I).EQ.IBLVL(J)) GOTO 10
   4621           ENDDO
   4622 
   4623 C  MUST ADD TO LIST
   4624 C  ----------------
   4625 
   4626           IBUF = IBUF + 1
   4627           IEV(IBUF)   = I
   4628           BDATE(IBUF) = EDATE(I)
   4629           BSEQN(IBUF) = SEQN(I)
   4630           IBVAR(IBUF) = IVAR(I)
   4631           IBLVL(IBUF) = LEVL(I)
   4632 
   4633 C  ALREADY ON LIST
   4634 C  --------------
   4635 
   4636    10     CONTINUE
   4637 
   4638         ELSE
   4639 
   4640 C  ADD FIRST ITEM TO LIST
   4641 C  ----------------------

Page 150         Source Listing                  EVPROC
2017-04-18 11:07                                 cqcbufr.f

   4642 
   4643           IBUF = IBUF + 1
   4644           IEV(IBUF)   = I
   4645           BDATE(IBUF) = EDATE(I)
   4646           BSEQN(IBUF) = SEQN(I)
   4647           IBVAR(IBUF) = IVAR(I)
   4648           IBLVL(IBUF) = LEVL(I)
   4649 
   4650         ENDIF
   4651       ENDDO
   4652       IEVENTB = IBUF
   4653 
   4654 C  FOR EACH DATUM ON LIST, MAKE A LIST OF EVENTS
   4655 C  ---------------------------------------------
   4656 
   4657       DO J=1,IBUF
   4658         LIST = 0
   4659         DO I=I1,I2
   4660           IF(EDATE(I).EQ.BDATE(J) .AND.
   4661      &       SEQN(I).EQ.BSEQN(J)  .AND.
   4662      &       IVAR(I).EQ.IBVAR(J)  .AND.
   4663      &       LEVL(I).EQ.IBLVL(J)) THEN
   4664 
   4665             LIST = LIST + 1
   4666             IF(LIST.GT.100) GOTO 15
   4667             CORL(LIST)    = COR(I)
   4668             CORVALL(LIST) = CORVAL(I)
   4669             QMARKL(LIST)  = QMARK(I)
   4670             IETYPL(LIST)  = IETYP(I)
   4671           ENDIF
   4672         ENDDO
   4673    15   CONTINUE
   4674 
   4675 C  CREATE A FINAL EVENT FOR EACH ON LIST
   4676 C  -------------------------------------
   4677 
   4678 C  IF FINAL QMARKL IS GOOD, THEN CORRECTION IS SUM OF
   4679 C  CORRECTIONS.  OTHERWISE, CORRECTION = 0.
   4680 C  --------------------------------------------------
   4681 
   4682         QGOOD = .TRUE.
   4683         DO I=1,LIST
   4684           IF(QMARKL(I).GT.2.) QGOOD = .FALSE.
   4685         ENDDO
   4686         C = 0.
   4687         IF(QGOOD) THEN
   4688           DO I=1,LIST
   4689             C = C + CORL(I)
   4690           ENDDO
   4691         ENDIF
   4692         CORL(0) = C
   4693 
   4694 C  CORRECTED VALUE IS LAST VALUE, AND
   4695 C  QUALITY MARK HAS LAST VALUE
   4696 C  ----------------------------------
   4697 
   4698         CORVALL(0) = CORVALL(LIST)

Page 151         Source Listing                  EVPROC
2017-04-18 11:07                                 cqcbufr.f

   4699         QMARKL(0)  = QMARKL(LIST)
   4700 
   4701 C  IF QMARKL(0) .GE. 3, RESET CORL(0) TO 0.
   4702 C  ----------------------------------------
   4703 
   4704         IF(QMARKL(0).GE.3) CORL(0) = 0.
   4705 
   4706 C  ERROR TYPE WILL BE THAT OF FIRST CORRECTION, IF ANY.
   4707 C  OTHERWISE, SET IT TO LAST OTHER THAN 30, OTHERWISE,
   4708 C  SET TO 30.
   4709 C  ----------------------------------------------------
   4710 
   4711         IETYPL(0) = 0
   4712         DO I=1,LIST
   4713           IF(CORL(I).NE.0.) THEN
   4714             IETYPL(0) = IETYPL(I)
   4715             GOTO 20
   4716           ENDIF
   4717         ENDDO
   4718 
   4719         DO I=1,LIST
   4720           IF(IETYPL(I).NE.0 .AND. IETYPL(I).NE.30) THEN
   4721             IETYPL(0) = IETYPL(I)
   4722           ENDIF
   4723         ENDDO
   4724 
   4725         IF(IETYPL(0).EQ.0) THEN
   4726           DO I=1,LIST
   4727             IF(IETYPL(I).EQ.30) THEN
   4728               IETYPL(0) = 30
   4729             ENDIF
   4730           ENDDO
   4731         ENDIF
   4732 
   4733    20   CONTINUE
   4734 
   4735 C  CREATE BUFR EVENTS FILE
   4736 C  -----------------------
   4737 
   4738         I = IEV(J)
   4739         STNB(J)    = STN(I)
   4740         SEQNB(J)   = SEQN(I)
   4741         LEVLB(J)   = LEVL(I)
   4742         PRESB(J)   = PRES(I)
   4743         LTYPB(J)   = LTYP(I)
   4744         IVARB(J)   = IVAR(I)
   4745         CORB(J)    = CORL(0)
   4746         CORVALB(J) = CORVALL(0)
   4747         QMARKB(J)  = QMARKL(0)
   4748         IETYPB(J)  = IETYPL(0)
   4749         EDATEB(J)  = EDATE(I)
   4750         LSTYPB(J)  = LSTYP(I)
   4751         PCORB(J)   = PCOR(I)
   4752 
   4753       ENDDO
   4754 
   4755 C  WRITE BUFR EVENTS TO UNIT 6

Page 152         Source Listing                  EVPROC
2017-04-18 11:07                                 cqcbufr.f

   4756 C  ---------------------------
   4757 
   4758       IF(I1.EQ.1 .AND. I2.EQ.IEVENT .AND. I2.NE.0) WRITE(6,500)
   4759       DO I=1,IBUF
   4760         IF(MOD(I,10).EQ.1) WRITE(6,503)
   4761         OVAL = CORVALB(I) - CORB(I)
   4762         WRITE(6,504) PRESB(I),CVAR(IVARB(I)),IETYPB(I),QMARKB(I),
   4763      &    OVAL,CORB(I),CORVALB(I),LEVLB(I),LTYPB(I),STNB(I),
   4764      &    SEQNB(I),EDATEB(I)
   4765       ENDDO
   4766 
   4767 C  WRITE BUFR EVENTS TO UNIT 52 FOR SDM-S
   4768 C  --------------------------------------
   4769 
   4770       IF(ICALL.EQ.1) THEN
   4771         DO I=1,IBUF
   4772           IF(MOD(I,10).EQ.1) WRITE(52,503)
   4773           OVAL = CORVALB(I) - CORB(I)
   4774           WRITE(52,504) PRESB(I),CVAR(IVARB(I)),IETYPB(I),QMARKB(I),
   4775      &      OVAL,CORB(I),CORVALB(I),LEVLB(I),LTYPB(I),STNB(I),
   4776      &      SEQNB(I),EDATEB(I)
   4777         ENDDO
   4778       ENDIF
   4779 
   4780   500 FORMAT(//'BUFR EVENTS')
   4781   503 FORMAT('  PRESSURE VAR IETYP QMARK  ORIG-VAL       COR',
   4782      &       '   NEW-VAL  LEVEL LEVTYP  STATION     SQN        DATE')
   4783   504 FORMAT(1X,F9.1,2X,A2,I6,F6.0,3F10.1,I7,I7,4X,A8,F6.0,1X,A10)
   4784 
   4785       RETURN
   4786       END

Page 153         Source Listing                  EVPROC
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 evproc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  4636                                                           4620                              
 15                         Label  4673                                                           4666                              
 20                         Label  4733                                                           4715                              
 500                        Label  4780                                                           4758                              
 503                        Label  4781                                                           4760,4772                         
 504                        Label  4783                                                           4762,4774                         
 B                          Scalar 4583     R(4)            4     1     21       COM                                                
 BASR                       Scalar 4568     R(4)            4     1     2000     COM                                                
 BASRES                     Scalar 4582     R(4)            4     1     999      COM                                                
 BDATE                      Local  4603     CHAR            10    1     2000                      4617,4628,4645,4660               
 BRES                       Scalar 4596     R(4)            4     1     999      COM                                                
 BSEQN                      Local  4598     R(4)            4     1     2000                      4618,4629,4646,4661               
 C                          Local  4686     R(4)            4           scalar                    4686,4689,4692                    
 COR                        Scalar 4566     R(4)            4     1     2000     COM              4667                              
 CORB                       Scalar 4572     R(4)            4     1     2000     COM              4745,4761,4763,4773,4775          
 CORL                       Local  4598     R(4)            4     1     101                       4667,4689,4692,4704,4713,4745     
 CORVAL                     Scalar 4566     R(4)            4     1     2000     COM              4668                              
 CORVALB                    Scalar 4572     R(4)            4     1     2000     COM              4746,4761,4763,4773,4775          
 CORVALL                    Local  4598     R(4)            4     1     101                       4668,4698,4746                    
 CVAR                       Local  4604     CHAR            2     1     5                         4606,4762,4774                    
 EDATE                      Scalar 4569     CHAR            10    1     2000     COM              4617,4628,4645,4660,4749          
 EDATEB                     Scalar 4573     CHAR            10    1     2000     COM              4749,4764,4776                    
 ERROR                      Scalar 4596     R(4)            4     1     999      COM                                                
 EVENTS                     Common 4564                                 156004                                                      
 EVNBUF                     Common 4570                                 132004                                                      
 EVPROC                     Subr   4561                                                                                             
 HYD                        Scalar 4581     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 4596     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 4581     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 4581     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 4581     R(4)            4     1     21       COM                                                
 I                          Local  4614     I(4)            4           scalar                    4614,4617,4618,4619,4620,4627,4628
                                                                                                  ,4629,4630,4631,4644,4645,4646,464
                                                                                                  7,4648,4659,4660,4661,4662,4663,46
                                                                                                  67,4668,4669,4670,4683,4684,4688,4
                                                                                                  689,4712,4713,4714,4719,4720,4721,
                                                                                                  4726,4727,4738,4739,4740,4741,4742
                                                                                                  ,4743,4744,4749,4750,4751,4759,476
                                                                                                  0,4761,4762,4763,4764,4771,4772,47
                                                                                                  73,4774,4775,4776                 
 I1                         Dummy  4561     I(4)            4           scalar   ARG,INOUT        4614,4659,4758                    
 I2                         Dummy  4561     I(4)            4           scalar   ARG,INOUT        4614,4659,4758                    
 IBLVL                      Local  4600     I(4)            4     1     2000                      4620,4631,4648,4663               
 IBUF                       Local  4613     I(4)            4           scalar                    4613,4615,4616,4626,4627,4628,4629

Page 154         Source Listing                  EVPROC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,4630,4631,4643,4644,4645,4646,464
                                                                                                  7,4648,4652,4657,4759,4771        
 IBVAR                      Local  4600     I(4)            4     1     2000                      4619,4630,4647,4662               
 ICALL                      Dummy  4561     I(4)            4           scalar   ARG,INOUT        4770                              
 IETYP                      Scalar 4569     I(4)            4     1     2000     COM              4670                              
 IETYPB                     Scalar 4573     I(4)            4     1     2000     COM              4748,4762,4774                    
 IETYPL                     Local  4600     I(4)            4     1     101                       4670,4711,4714,4720,4721,4725,4727
                                                                                                  ,4728,4748                        
 IEV                        Local  4601     I(4)            4     1     2000                      4627,4644,4738                    
 IEVENT                     Scalar 4567     I(4)            4           scalar   COM              4758                              
 IEVENTB                    Scalar 4574     I(4)            4           scalar   COM              4652                              
 IHSC                       Scalar 4582     I(4)            4     2     1020     COM                                                
 ISCAN                      Scalar 4564     I(4)            4     1     2000     COM                                                
 ISCANB                     Scalar 4570     I(4)            4     1     2000     COM                                                
 IVAR                       Scalar 4566     I(4)            4     1     2000     COM              4619,4630,4647,4662,4744          
 IVARB                      Scalar 4572     I(4)            4     1     2000     COM              4744,4762,4774                    
 J                          Local  4616     I(4)            4           scalar                    4616,4617,4618,4619,4620,4657,4660
                                                                                                  ,4661,4662,4663,4738,4739,4740,474
                                                                                                  1,4742,4743,4744,4745,4746,4747,47
                                                                                                  48,4749,4750,4751                 
 LEVL                       Scalar 4565     I(4)            4     1     2000     COM              4620,4631,4648,4663,4741          
 LEVLB                      Scalar 4571     I(4)            4     1     2000     COM              4741,4763,4775                    
 LIST                       Local  4658     I(4)            4           scalar                    4658,4665,4666,4667,4668,4669,4670
                                                                                                  ,4683,4688,4698,4699,4712,4719,472
                                                                                                  6                                 
 LSTYP                      Scalar 4567     I(4)            4     1     2000     COM              4750                              
 LSTYPB                     Scalar 4574     I(4)            4     1     2000     COM              4750                              
 LTYP                       Scalar 4565     I(4)            4     1     2000     COM              4743                              
 LTYPB                      Scalar 4571     I(4)            4     1     2000     COM              4743,4763,4775                    
 MANRES                     Common 4585                                 2949048                                                     
 MOD                        Func   4760                                 scalar                    4760,4772                         
 NBAS                       Scalar 4583     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 4581     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 4583     I(4)            4     1     21       COM                                                
 NQHM                       Scalar 4593     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 4577     I(4)            4     1     255      COM                                                
 NQV                        Scalar 4579     I(4)            4     1     255      COM                                                
 NST                        Param  4562     I(4)            4           scalar                    4582,4585,4586,4587,4588,4589,4590
                                                                                                  ,4591,4592,4593,4594,4595,4596    
 NTDHM                      Scalar 4593     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 4577     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 4588     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 4579     I(4)            4     1     255      COM                                                
 NTHM                       Scalar 4591     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 4577     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 4588     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 4579     I(4)            4     1     255      COM                                                
 NTV                        Scalar 4579     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 4591     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 4577     I(4)            4     1     255      COM                                                
 NZIM                       Scalar 4588     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 4579     I(4)            4     1     255      COM                                                
 OVAL                       Local  4761     R(4)            4           scalar                    4761,4763,4773,4775               
 PCOR                       Scalar 4567     R(4)            4     1     2000     COM              4751                              
 PCORB                      Scalar 4574     R(4)            4     1     2000     COM              4751                              

Page 155         Source Listing                  EVPROC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PI                         Scalar 4575     R(4)            4     1     255      COM                                                
 PIS                        Scalar 4596     R(4)            4     1     999      COM                                                
 PISR                       Scalar 4568     R(4)            4     1     2000     COM                                                
 PRES                       Scalar 4565     R(4)            4     1     2000     COM              4742                              
 PRESB                      Scalar 4571     R(4)            4     1     2000     COM              4742,4762,4774                    
 PSINC                      Scalar 4582     R(4)            4           scalar   COM                                                
 PSINCR                     Scalar 4568     R(4)            4     1     2000     COM                                                
 QG                         Scalar 4595     R(4)            4     2     20979    COM                                                
 QGOOD                      Local  4605     L(4)            4           scalar                    4682,4684,4687                    
 QHM                        Scalar 4586     R(4)            4     2     20979    COM                                                
 QI                         Scalar 4575     R(4)            4     1     255      COM                                                
 QIM                        Scalar 4585     R(4)            4     2     20979    COM                                                
 QMARK                      Scalar 4569     R(4)            4     1     2000     COM              4669                              
 QMARKB                     Scalar 4573     R(4)            4     1     2000     COM              4747,4762,4774                    
 QMARKL                     Local  4599     R(4)            4     1     101                       4669,4684,4699,4704,4747          
 QV                         Scalar 4576     R(4)            4     1     255      COM                                                
 QVM                        Scalar 4587     R(4)            4     2     20979    COM                                                
 RESID                      Common 4575                                 41312                                                       
 SEQN                       Scalar 4564     R(4)            4     1     2000     COM              4618,4629,4646,4661,4740          
 SEQNB                      Scalar 4570     R(4)            4     1     2000     COM              4740,4764,4776                    
 STN                        Scalar 4564     CHAR            8     1     2000     COM              4739                              
 STNB                       Scalar 4570     CHAR            8     1     2000     COM              4739,4763,4775                    
 TDG                        Scalar 4595     R(4)            4     2     20979    COM                                                
 TDHM                       Scalar 4586     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 4575     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 4585     R(4)            4     2     20979    COM                                                
 TDV                        Scalar 4576     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 4587     R(4)            4     2     20979    COM                                                
 TG                         Scalar 4595     R(4)            4     2     20979    COM                                                
 THM                        Scalar 4586     R(4)            4     2     20979    COM                                                
 TI                         Scalar 4575     R(4)            4     1     255      COM                                                
 TIM                        Scalar 4585     R(4)            4     2     20979    COM                                                
 TL                         Scalar 4576     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 4582     R(4)            4     1     255      COM                                                
 TV                         Scalar 4576     R(4)            4     1     255      COM                                                
 TVM                        Scalar 4587     R(4)            4     2     20979    COM                                                
 XQHM                       Scalar 4594     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 4578     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 4590     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 4580     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 4584     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 4593     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 4578     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 4589     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 4580     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 4592     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 4583     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 4592     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 4578     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 4589     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 4580     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 4590     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 4583     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 4591     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 4578     R(4)            4     1     255      COM                                                

Page 156         Source Listing                  EVPROC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XZIM                       Scalar 4589     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 4580     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 4590     R(4)            4     2     20979    COM                                                
 ZD                         Scalar 4583     R(4)            4     1     255      COM                                                
 ZG                         Scalar 4595     R(4)            4     2     20979    COM                                                
 ZHM                        Scalar 4586     R(4)            4     2     20979    COM                                                
 ZI                         Scalar 4575     R(4)            4     1     255      COM                                                
 ZIM                        Scalar 4585     R(4)            4     2     20979    COM                                                
 ZV                         Scalar 4576     R(4)            4     1     255      COM                                                
 ZVM                        Scalar 4587     R(4)            4     2     20979    COM                                                

Page 157         Source Listing                  EVPROC
2017-04-18 11:07                                 cqcbufr.f

   4787 
   4788 C************************************************************************
   4789 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4790 C                .      .    .                                       .
   4791 C SUBPROGRAM:    FILALL      FILL AUXILIARY LEVELS WITH DATA
   4792 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   4793 C
   4794 C ABSTRACT: Fill auxiliary level with data.  I.e., interpolate data
   4795 C   from levels with LVTYP = 0 to levels with LVTYP = 1. See GETLEV
   4796 C   for how LVTYP is specified.
   4797 C
   4798 C PROGRAM HISTORY LOG:
   4799 C 1997-03-18  W. Collins  Original author.
   4800 C 1997-05-12  W. Collins  Correct logic for top level.
   4801 C 1997-05-12  W. Collins  Write height event only if the height
   4802 C     changes by at least 2 m.
   4803 C 1997-07-23  W. Collins  Limit the layer thickness to 200 hPa
   4804 C     over which heights are recalculated.
   4805 C
   4806 C USAGE:    CALL FILALL(SAME,WIND)
   4807 C   INPUT ARGUMENT LIST:
   4808 C     SAME     - TRUE WHEN WIND PART GOES WITH PREVIOUSL READ
   4809 C                MASS PART
   4810 C     WIND     - TRUE FOR WIND PART OF REPORT
   4811 C
   4812 C   OUTPUT FILES:
   4813 C     UNIT 06  - PRINTOUT
   4814 C
   4815 C REMARKS: NONE.
   4816 C
   4817 C ATTRIBUTES:
   4818 C   LANGUAGE: FORTRAN 90
   4819 C   MACHINE:  NCEP WCOSS
   4820 C
   4821 C$$$
   4822 
   4823       SUBROUTINE FILALL(SAME,WIND)
   4824       PARAMETER (NST=999)
   4825 
   4826       REAL(8) BMISS
   4827 
   4828       REAL            VAR(9,255), VARINC(9,255), PLOG(255), POBL(255)
   4829       CHARACTER*8     SID
   4830       LOGICAL         SAME, WIND
   4831       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   4832      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   4833      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   4834      &                 TDO(255), TDFC(255),TVO(255),
   4835      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   4836      &                 CAT(255), IND(255), LEVTYP(255),
   4837      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   4838      &                 YDR(255), XDR(255)
   4839       COMMON /ALSNDW/ POBW(255),PFCW(255),PQMW(255),PRCW(255),
   4840      &                ZOBW(255),ZFCW(255),ZQMW(255),ZRCW(255),
   4841      &                UOB(255),VOB(255),UFC(255),VFC(255),
   4842      &                WQM(255),WRC(255),SP(255), DIR(255),
   4843      &                CATW(255)

Page 158         Source Listing                  FILALL
2017-04-18 11:07                                 cqcbufr.f

   4844       COMMON /INC/    PNC(255),TNC(255),QNC(255),TDNC(255),ZNC(255)
   4845       COMMON /INCW/   PNCW(255),ZNCW(255),UNC(255),VNC(255)
   4846       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   4847      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   4848      &                 NEV, ISF(NST), NLVM, NLVW
   4849       COMMON /PEROR/  ISERR, ISOBERR
   4850       COMMON /LTP/    LVTYP(9,255), NCH(9,255), LVRC(9,255), LVRCALL
   4851       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   4852 
   4853       LOGICAL ISERR, LVRC, ISOBERR, LVRCALL
   4854       DATA   PPI /57.29578/
   4855       DATA   T0 /273.15/, R /287.05/, G /9.80665/
   4856 
   4857       VARINC = BMISS
   4858 
   4859       IF(WIND) THEN
   4860 C       IF(.NOT. SAME) WRITE(6,500) SID
   4861   500   FORMAT(' FILALL--SAME IS .FALSE. FOR: ',A8)
   4862         IF(.NOT. SAME) RETURN
   4863         IV1 = 7
   4864         IV2 = 8
   4865         DO L=1,NLV
   4866           VARINC(6,L) = PNCW(L)
   4867           VARINC(7,L) = UNC(L)
   4868           VARINC(8,L) = VNC(L)
   4869           VARINC(9,L) = ZNC(L)
   4870           POBL(L)     = POBW(L)
   4871           VAR(6,L)    = POBW(L)
   4872           VAR(7,L)    = UOB(L)
   4873           VAR(8,L)    = VOB(L)
   4874           VAR(9,L)    = ZOBW(L)
   4875           PLOG(L)     = ALP(POBW(L))
   4876         ENDDO
   4877       ELSE
   4878         IV1 = 2
   4879         IV2 = 3
   4880         DO L=1,NLV
   4881           VARINC(1,L) = PNC(L)
   4882           VARINC(2,L) = TNC(L)
   4883           VARINC(3,L) = TDNC(L)
   4884           VARINC(4,L) = QNC(L)
   4885           VARINC(5,L) = ZNC(L)
   4886           POBL(L)     = POB(L)
   4887           VAR(1,L)    = POB(L)
   4888           VAR(2,L)    = TOB(L)
   4889           VAR(3,L)    = TDO(L)
   4890           VAR(4,L)    = QOB(L)
   4891           VAR(5,L)    = ZOB(L)
   4892           PLOG(L)     = ALP(POB(L))
   4893         ENDDO
   4894       ENDIF
   4895 
   4896 C  INTERPOLATE INCREMENTS FROM LEVELS WHERE LVTYP = 1 
   4897 C  TO LEVELS WHERE LVTYP = 0, BUT ONLY IF THERE WAS
   4898 C  AN ORIGINAL VALUE PRESENT
   4899 C  DO FOR THE VARIABLES IN THE RANGE IV1 TO IV2
   4900 C  --------------------------------------------------------

Page 159         Source Listing                  FILALL
2017-04-18 11:07                                 cqcbufr.f

   4901 
   4902       DO IV=IV1,IV2
   4903         ipr = 0
   4904 
   4905 C  FIND FIRST GOOD LEVEL TO INTERPOLATE FROM
   4906 C  -----------------------------------------
   4907 
   4908         DO L=1,NLV
   4909           LFIRST = L
   4910           IF(LVTYP(IV,L).EQ.1 .AND. VARINC(IV,L).NE.BMISS) GOTO 100
   4911         ENDDO
   4912   100   CONTINUE
   4913 
   4914 C  FIND LAST GOOD LEVEL TO INTERPOLATE FROM
   4915 C  ----------------------------------------
   4916 
   4917         DO L=NLV,1,-1
   4918           LAST = L
   4919           IF(LVTYP(IV,L).EQ.1 .AND. VARINC(IV,L).NE.BMISS) GOTO 200
   4920         ENDDO
   4921   200   CONTINUE
   4922         IF(LAST.LT.LFIRST) GOTO 300
   4923 
   4924         DO L=1,NLV
   4925           IF(LVRC(IV,L) .AND. VAR(IV,L).NE.BMISS) THEN
   4926             VARINC(IV,L) = 0.
   4927             ipr = ipr + 1
   4928 C           if(ipr.eq.1 .and. iserr) write(6,504)
   4929 
   4930 C  FIND TWO LEVELS TO USE FOR INTERPOLATION, ONE BELOW AND ONE ABOVE
   4931 C  -----------------------------------------------------------------
   4932 
   4933             LEV1 = 1
   4934             LEV2 = NLV
   4935             IF(L.LT.LFIRST .AND. ABS(POBL(LFIRST)-POBL(L)).LT.100.) THEN
   4936               VARINC(IV,L) = VARINC(IV,LFIRST)
   4937             ELSE
   4938               DO LL=L-1,1,-1
   4939                 LEV1 = LL
   4940                 IF(LVTYP(IV,LL).EQ.1 .AND.
   4941      &             VARINC(IV,LL).NE.BMISS) GOTO 10
   4942               ENDDO
   4943             ENDIF
   4944 
   4945 C  NO LEVEL FOUND BELOW. TRY TO FIND A LEVEL ABOVE.
   4946 C  ------------------------------------------------
   4947 
   4948             DO LL=L+1,NLV
   4949               LEV2 = LL
   4950               IF(LVTYP(IV,LL).EQ.1 .AND.
   4951      &           VARINC(IV,LL).NE.BMISS) GOTO 5
   4952             ENDDO
   4953 
   4954 C  NONE ABOVE EITHER
   4955 C  -----------------
   4956 
   4957             GOTO 30

Page 160         Source Listing                  FILALL
2017-04-18 11:07                                 cqcbufr.f

   4958 
   4959 C  NONE BELOW, BUT FOUND A LEVEL ABOVE
   4960 C  -----------------------------------
   4961 
   4962 
   4963     5       CONTINUE
   4964             IF(ABS(POBL(L)-POBL(LEV2)).LT.100.) THEN
   4965               VARINC(IV,L) = VARINC(IV,LEV2)
   4966             ENDIF
   4967             GOTO 30
   4968 
   4969 C  LEVEL FOUND BELOW
   4970 C  -----------------
   4971 
   4972    10       CONTINUE
   4973             IF(L.GT.LAST) THEN
   4974               IF(ABS(POBL(L)-POBL(LAST)).LT.100.) THEN
   4975                 VARINC(IV,L) = VARINC(IV,LAST)
   4976               ENDIF
   4977               GOTO 30
   4978             ELSE
   4979               DO LL=L+1,NLV
   4980                 LEV2 = LL
   4981                 IF(LVTYP(IV,LL).EQ.1 .AND.
   4982      &             VARINC(IV,LL).NE.BMISS) GOTO 20
   4983               ENDDO
   4984             ENDIF
   4985 
   4986 C  NO LEVEL FOUND ABOVE; USE INCREMENT FROM BELOW
   4987 C  ----------------------------------------------
   4988 
   4989             IF(ABS(POBL(L)-POBL(LEV1)).LT.100.) THEN
   4990               VARINC(IV,L) = VARINC(IV,LEV1)
   4991             ENDIF
   4992             GOTO 30
   4993 
   4994    20       CONTINUE
   4995 
   4996 C  BOTH LEVELS FOUND--PERFORM INTERPOLATION, USING 2 LEVELS
   4997 C  --------------------------------------------------------
   4998 
   4999             IF(PLOG(LEV2)-PLOG(LEV1).NE.0. .AND.
   5000      &        ABS(POBL(LEV1)-POBL(LEV2)).LT.250.) THEN
   5001               VARINC(IV,L) = ((PLOG(LEV2)-PLOG(L))*VARINC(IV,LEV1)
   5002      &          + (PLOG(L)-PLOG(LEV1))*VARINC(IV,LEV2)) /
   5003      &            (PLOG(LEV2)-PLOG(LEV1))
   5004             ENDIF
   5005   30        CONTINUE
   5006 
   5007             if(iserr) then
   5008               write(6,501) iv,l,lev1,lev2,pobl(l),pobl(lev1),pobl(lev2),
   5009      &          cat(l),varinc(iv,l),varinc(iv,lev1),varinc(iv,lev2)
   5010   501         format(10x,4i5,3f12.1,f8.0,3f12.1)
   5011   504         format(' filall--    iv    l lev1 lev2      pob(l)',
   5012      &          '   pob(lev1)   pob(lev2)     cat      inc(l)',
   5013      &          '   inc(lev1)   inc(lev2)')
   5014             endif

Page 161         Source Listing                  FILALL
2017-04-18 11:07                                 cqcbufr.f

   5015 
   5016           ENDIF
   5017         ENDDO
   5018   300   CONTINUE
   5019       ENDDO
   5020 
   5021       IF(WIND) THEN
   5022         DO L=1,NLV
   5023           PNCW(L) = VARINC(6,L)
   5024           UNC(L)  = VARINC(7,L)
   5025           VNC(L)  = VARINC(8,L)
   5026           ZNCW(L) = VARINC(9,L)
   5027           SP(L)   = SQRT(UNC(L)**2 + VNC(L)**2)
   5028           IF(VNC(L).NE.0. .OR. UNC(L).NE.0.) THEN
   5029             DIR(L) = 90. - PPI*ATAN2(VNC(L),UNC(L))
   5030           ELSE
   5031             DIR(L) = 0.
   5032           ENDIF
   5033         ENDDO
   5034       ELSE
   5035         DO L=1,NLV
   5036           PNC(L)  = VARINC(1,L)
   5037           TNC(L)  = VARINC(2,L)
   5038           TDNC(L) = VARINC(3,L)
   5039           QNC(L)  = VARINC(4,L)
   5040           ZNC(L)  = VARINC(5,L)
   5041         ENDDO
   5042       ENDIF
   5043 
   5044 C  THE COUNTER NCH TELLS WHETHER AN ORIGINAL VALUE
   5045 C  HAS BEEN CHANGED.  AN EVENT WILL BE CREATED
   5046 C  FOR THESE VARIABLES.  INITIALIZE NCH.
   5047 C  -----------------------------------------------
   5048 
   5049       NCH = 0
   5050 
   5051 C  HYDROSTATICALLY RE-FILL ALL HEIGHTS THAT WERE
   5052 C  ORIGINALLY HYDROSTATICALLY INTERPOLATED.
   5053 C  ----------------------------------------------
   5054 
   5055       IF(.NOT. WIND) THEN
   5056         DO L=2,NLV
   5057           IF(LVRC(5,L)) THEN
   5058 
   5059 C  FIND NEXT LEVEL BELOW WITH NECESSARY GOOD DATA
   5060 C  ----------------------------------------------
   5061 
   5062             DO LL=L-1,1,-1
   5063               IF(POB(LL).NE.BMISS .AND. PQM(LL).LT.3. .AND.
   5064      &           ABS(POB(LL)-POB(L)).LE.200. .AND.
   5065      &           ZOB(LL).NE.BMISS .AND. ZQM(LL).LT.3. .AND.
   5066      &           TOB(LL).NE.BMISS .AND. TQM(LL).LT.3.) GOTO 40
   5067             ENDDO
   5068 
   5069 C  NO LEVEL FOUND BELOW WITH NECESSARY DATA
   5070 C  ----------------------------------------
   5071 

Page 162         Source Listing                  FILALL
2017-04-18 11:07                                 cqcbufr.f

   5072             LL = 1
   5073             GOTO 50
   5074    40       CONTINUE
   5075             IF(TNC(L).LT.BMISS .AND.
   5076      &         TFC(L).LT.BMISS .AND.
   5077      &         QOB(L).LT.BMISS) THEN
   5078               TL = (TNC(L)+TFC(L)+T0)*(1.+.61*QOB(L))
   5079             ELSEIF(TNC(L).LT.BMISS .AND.
   5080      &        TFC(L).LT.BMISS) THEN
   5081               TL = TNC(L)+TFC(L)+T0
   5082             ELSE
   5083               GOTO 50
   5084             ENDIF
   5085             IF(QOB(LL).LT.BMISS) THEN
   5086               TLL = (TOB(LL)+T0)*(1.+.61*QOB(LL))
   5087             ELSE
   5088               TLL = TOB(LL)+T0
   5089             ENDIF
   5090             ZOB(L) = ZOB(LL) - 0.5*(R/G)*(TL+TLL)*(PLOG(L)-PLOG(LL))
   5091             ZNC(L) = ZOB(L) - ZFC(L)
   5092             NCH(5,L) = 1
   5093             IF(ZQM(L).LE.2.) ZQM(L) = 1.
   5094             ZRC(L) = 15.
   5095    50       CONTINUE
   5096             if(iserr) then
   5097               write(6,505) l,ll,pob(l),pob(ll),zob(l),zob(ll),tl,tll
   5098   505         format(' filall--l,ll,pob-s,zob-s,tl,tll: ',
   5099      &          2i4,2f10.1,2f8.0,2f8.1)
   5100             endif
   5101           ENDIF
   5102         ENDDO
   5103         if(iserr) then
   5104           write(6,502) nlv
   5105           write(6,503) (pob(l),tob(l),tfc(l),tnc(l),qob(l),zob(l),
   5106      &      l=1,nlv)
   5107   502     format(' filall--pob    tob    tfc    tnc      qob',
   5108      &      '     zob   nlv:',i4)
   5109   503     format(1x,f11.1,3f7.1,f9.4,f8.0)
   5110         endif
   5111       ENDIF
   5112 
   5113       RETURN
   5114       END

Page 163         Source Listing                  FILALL
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 filall_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  4972                                                           4941                              
 100                        Label  4912                                                           4910                              
 20                         Label  4994                                                           4982                              
 200                        Label  4921                                                           4919                              
 30                         Label  5005                                                           4957,4967,4977,4992               
 300                        Label  5018                                                           4922                              
 40                         Label  5074                                                           5066                              
 5                          Label  4963                                                           4951                              
 50                         Label  5095                                                           5073,5083                         
 500                        Label  4861                                                                                             
 501                        Label  5010                                                           5008                              
 502                        Label  5107                                                           5104                              
 503                        Label  5109                                                           5105                              
 504                        Label  5011                                                                                             
 505                        Label  5098                                                           5097                              
 ABS                        Func   4935                                 scalar                    4935,4964,4974,4989,5000,5064     
 ALLSND                     Common 4831                                 34512                                                       
 ALP                        Func   4875     R(4)            4           scalar                    4875,4892                         
 ALSNDW                     Common 4839                                 17340                                                       
 ATAN2                      Func   5029                                 scalar                    5029                              
 BMISS                      Scalar 4826     R(8)            8           scalar   COM              4857,4910,4919,4925,4941,4951,4982
                                                                                                  ,5063,5065,5066,5075,5076,5077,507
                                                                                                  9,5080,5085                       
 BUFRLIB_MISSING            Common 4851                                 16                                                          
 CAT                        Scalar 4836     R(4)            4     1     255      COM              5009                              
 CATW                       Scalar 4843     R(4)            4     1     255      COM                                                
 DHR                        Scalar 4846     R(4)            4     1     999      COM                                                
 DIR                        Scalar 4842     R(4)            4     1     255      COM              5029,5031                         
 ELV                        Scalar 4847     R(4)            4     1     999      COM                                                
 FILALL                     Subr   4823                                                                                             
 G                          Local  4855     R(4)            4           scalar                    4855,5090                         
 GESPS                      Scalar 4837     R(4)            4     1     999      COM                                                
 HEADER                     Common 4846                                 35980                                                       
 HRDR                       Scalar 4837     R(4)            4     1     255      COM                                                
 IMISS                      Scalar 4851     I(4)            4           scalar   COM                                                
 INC                        Common 4844                                 5100                                                        
 INCW                       Common 4845                                 4080                                                        
 IND                        Scalar 4836     I(4)            4     1     255      COM                                                
 IPR                        Local  4903     I(4)            4           scalar                    4903,4927                         
 ISERR                      Scalar 4849     L(4)            4           scalar   COM              5007,5096,5103                    
 ISF                        Scalar 4848     I(4)            4     1     999      COM                                                
 ISOBERR                    Scalar 4849     L(4)            4           scalar   COM                                                
 ITP                        Scalar 4847     I(4)            4     1     999      COM                                                
 IV                         Local  4902     I(4)            4           scalar                    4902,4910,4919,4925,4926,4936,4940

Page 164         Source Listing                  FILALL
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,4941,4950,4951,4965,4975,4981,498
                                                                                                  2,4990,5001,5002,5008,5009        
 IV1                        Local  4863     I(4)            4           scalar                    4863,4878,4902                    
 IV2                        Local  4864     I(4)            4           scalar                    4864,4879,4902                    
 L                          Local  4865     I(4)            4           scalar                    4865,4866,4867,4868,4869,4870,4871
                                                                                                  ,4872,4873,4874,4875,4880,4881,488
                                                                                                  2,4883,4884,4885,4886,4887,4888,48
                                                                                                  89,4890,4891,4892,4908,4909,4910,4
                                                                                                  917,4918,4919,4924,4925,4926,4935,
                                                                                                  4936,4938,4948,4964,4965,4973,4974
                                                                                                  ,4975,4979,4989,4990,5001,5002,500
                                                                                                  8,5009,5022,5023,5024,5025,5026,50
                                                                                                  27,5028,5029,5031,5035,5036,5037,5
                                                                                                  038,5039,5040,5056,5057,5062,5064,
                                                                                                  5075,5076,5077,5078,5079,5080,5081
                                                                                                  ,5090,5091,5092,5093,5094,5097,510
                                                                                                  5,5106                            
 LAST                       Local  4918     I(4)            4           scalar                    4918,4922,4973,4974,4975          
 LEV1                       Local  4933     I(4)            4           scalar                    4933,4939,4989,4990,4999,5000,5001
                                                                                                  ,5002,5003,5008,5009              
 LEV2                       Local  4934     I(4)            4           scalar                    4934,4949,4964,4965,4980,4999,5000
                                                                                                  ,5001,5002,5003,5008,5009         
 LEVTYP                     Scalar 4836     I(4)            4     1     255      COM                                                
 LFIRST                     Local  4909     I(4)            4           scalar                    4909,4922,4935,4936               
 LL                         Local  4938     I(4)            4           scalar                    4938,4939,4940,4941,4948,4949,4950
                                                                                                  ,4951,4979,4980,4981,4982,5062,506
                                                                                                  3,5064,5065,5066,5072,5085,5086,50
                                                                                                  88,5090,5097                      
 LST                        Scalar 4837     I(4)            4     1     255      COM                                                
 LTP                        Common 4850                                 27544                                                       
 LVRC                       Scalar 4850     L(4)            4     2     2295     COM              4925,5057                         
 LVRCALL                    Scalar 4850     L(4)            4           scalar   COM                                                
 LVTYP                      Scalar 4850     I(4)            4     2     2295     COM              4910,4919,4940,4950,4981          
 NCH                        Scalar 4850     I(4)            4     2     2295     COM              5049,5092                         
 NEV                        Scalar 4848     I(4)            4           scalar   COM                                                
 NLV                        Scalar 4847     I(4)            4           scalar   COM              4865,4880,4908,4917,4924,4934,4948
                                                                                                  ,4979,5022,5035,5056,5104,5106    
 NLVM                       Scalar 4848     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 4848     I(4)            4           scalar   COM                                                
 NST                        Param  4824     I(4)            4           scalar                    4837,4846,4847,4848               
 PEROR                      Common 4849                                 8                                                           
 PFC                        Scalar 4831     R(4)            4     1     255      COM                                                
 PFCW                       Scalar 4839     R(4)            4     1     255      COM                                                
 PLOG                       Local  4828     R(4)            4     1     255                       4875,4892,4999,5001,5002,5003,5090
 PNC                        Scalar 4844     R(4)            4     1     255      COM              4881,5036                         
 PNCW                       Scalar 4845     R(4)            4     1     255      COM              4866,5023                         
 POB                        Scalar 4831     R(4)            4     1     255      COM              4886,4887,4892,5063,5064,5097,5105
 POBL                       Local  4828     R(4)            4     1     255                       4870,4886,4935,4964,4974,4989,5000
                                                                                                  ,5008                             
 POBW                       Scalar 4839     R(4)            4     1     255      COM              4870,4871,4875                    
 PPI                        Local  4854     R(4)            4           scalar                    4854,5029                         
 PQM                        Scalar 4831     R(4)            4     1     255      COM              5063                              
 PQMW                       Scalar 4839     R(4)            4     1     255      COM                                                
 PRC                        Scalar 4831     R(4)            4     1     255      COM                                                
 PRCW                       Scalar 4839     R(4)            4     1     255      COM                                                

Page 165         Source Listing                  FILALL
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PS                         Scalar 4837     R(4)            4     1     999      COM                                                
 QFC                        Scalar 4835     R(4)            4     1     255      COM                                                
 QNC                        Scalar 4844     R(4)            4     1     255      COM              4884,5039                         
 QOB                        Scalar 4835     R(4)            4     1     255      COM              4890,5077,5078,5085,5086,5105     
 QQM                        Scalar 4835     R(4)            4     1     255      COM                                                
 QRC                        Scalar 4835     R(4)            4     1     255      COM                                                
 R                          Local  4855     R(4)            4           scalar                    4855,5090                         
 SAME                       Dummy  4823     L(4)            4           scalar   ARG,INOUT        4862                              
 SID                        Scalar 4829     CHAR            8     1     999      COM                                                
 SP                         Scalar 4842     R(4)            4     1     255      COM              5027                              
 SQN                        Scalar 4847     R(4)            4     1     999      COM                                                
 SQRT                       Func   5027                                 scalar                    5027                              
 T0                         Local  4855     R(4)            4           scalar                    4855,5078,5081,5086,5088          
 TDFC                       Scalar 4834     R(4)            4     1     255      COM                                                
 TDNC                       Scalar 4844     R(4)            4     1     255      COM              4883,5038                         
 TDO                        Scalar 4834     R(4)            4     1     255      COM              4889                              
 TFC                        Scalar 4833     R(4)            4     1     255      COM              5076,5078,5080,5081,5105          
 TL                         Local  5078     R(4)            4           scalar                    5078,5081,5090,5097               
 TLL                        Local  5086     R(4)            4           scalar                    5086,5088,5090,5097               
 TNC                        Scalar 4844     R(4)            4     1     255      COM              4882,5037,5075,5078,5079,5081,5105
 TOB                        Scalar 4833     R(4)            4     1     255      COM              4888,5066,5086,5088,5105          
 TQM                        Scalar 4833     R(4)            4     1     255      COM              5066                              
 TRC                        Scalar 4833     R(4)            4     1     255      COM                                                
 TVO                        Scalar 4834     R(4)            4     1     255      COM                                                
 UFC                        Scalar 4841     R(4)            4     1     255      COM                                                
 UNC                        Scalar 4845     R(4)            4     1     255      COM              4867,5024,5027,5028,5029          
 UOB                        Scalar 4841     R(4)            4     1     255      COM              4872                              
 VAR                        Local  4828     R(4)            4     2     2295                      4871,4872,4873,4874,4887,4888,4889
                                                                                                  ,4890,4891,4925                   
 VARINC                     Local  4828     R(4)            4     2     2295                      4857,4866,4867,4868,4869,4881,4882
                                                                                                  ,4883,4884,4885,4910,4919,4926,493
                                                                                                  6,4941,4951,4965,4975,4982,4990,50
                                                                                                  01,5002,5009,5023,5024,5025,5026,5
                                                                                                  036,5037,5038,5039,5040           
 VFC                        Scalar 4841     R(4)            4     1     255      COM                                                
 VNC                        Scalar 4845     R(4)            4     1     255      COM              4868,5025,5027,5028,5029          
 VOB                        Scalar 4841     R(4)            4     1     255      COM              4873                              
 WIND                       Dummy  4823     L(4)            4           scalar   ARG,INOUT        4859,5021,5055                    
 WQM                        Scalar 4842     R(4)            4     1     255      COM                                                
 WRC                        Scalar 4842     R(4)            4     1     255      COM                                                
 XDR                        Scalar 4838     R(4)            4     1     255      COM                                                
 XMISS                      Scalar 4851     R(4)            4           scalar   COM                                                
 XOB                        Scalar 4846     R(4)            4     1     999      COM                                                
 YDR                        Scalar 4838     R(4)            4     1     255      COM                                                
 YOB                        Scalar 4846     R(4)            4     1     999      COM                                                
 ZFC                        Scalar 4832     R(4)            4     1     255      COM              5091                              
 ZFCW                       Scalar 4840     R(4)            4     1     255      COM                                                
 ZNC                        Scalar 4844     R(4)            4     1     255      COM              4869,4885,5040,5091               
 ZNCW                       Scalar 4845     R(4)            4     1     255      COM              5026                              
 ZOB                        Scalar 4832     R(4)            4     1     255      COM              4891,5065,5090,5091,5097,5105     
 ZOBW                       Scalar 4840     R(4)            4     1     255      COM              4874                              
 ZQM                        Scalar 4832     R(4)            4     1     255      COM              5065,5093                         
 ZQMW                       Scalar 4840     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 4832     R(4)            4     1     255      COM              5094                              
 ZRCW                       Scalar 4840     R(4)            4     1     255      COM                                                

Page 166         Source Listing                  FILALL
2017-04-18 11:07                                 cqcbufr.f

   5115 
   5116 C******************************************************************
   5117 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5118 C                .      .    .                                       .
   5119 C SUBPROGRAM:    FILL        FILL EVENTS AS DESCRIBED BELOW
   5120 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   5121 C
   5122 C ABSTRACT: Fill events.  This subroutine is used with GETOB to be
   5123 C   able to get input data as of a particular point in the processing,
   5124 C   e.g. after PREVENT, or after CQCHT.  In order to do this, some
   5125 C   events must be filled either forward or backward in the processing
   5126 C   stream.  For instance, the guess appears only at the last stage,
   5127 C   but should be available at all stages.  This subroutine does the 
   5128 C   necessary filling.  The selection of which stage date to use is
   5129 C   made in INPUT (variable MP).
   5130 C
   5131 C PROGRAM HISTORY LOG:
   5132 C 1997-03-18  W. Collins  Original author.
   5133 C
   5134 C USAGE:    CALL FILL(OBS,NLEV)
   5135 C   INPUT ARGUMENT LIST:
   5136 C     OBS      - ARRAY OF EVENTS, READ BY GETOB
   5137 C     NLEV     - NUMBER OF LEVELS OF DATA
   5138 C
   5139 C   OUTPUT ARGUMENT LIST:
   5140 C     OBS      - ARRAY OF EVENTS, FILLED
   5141 C
   5142 C REMARKS: NONE.
   5143 C
   5144 C ATTRIBUTES:
   5145 C   LANGUAGE: FORTRAN 90
   5146 C   MACHINE:  NCEP WCOSS
   5147 C
   5148 C$$$
   5149 
   5150       SUBROUTINE FILL(OBS,NLEV)
   5151       PARAMETER (MVO=5)        ! p,T,z,q,Td
   5152       PARAMETER (MVR=10)       ! dimensions of header
   5153       PARAMETER (MLV=255)      ! number of possible levels
   5154       PARAMETER (MEV=13)       ! number of possible events
   5155 
   5156 C     Last index of OBS: value, fcst value, quality mark, reason code.
   5157 
   5158       DIMENSION OBS(MVO,MLV,0:MEV,4)
   5159 
   5160       REAL(8) BMISS
   5161 
   5162       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5163 
   5164       BMAX = 0.5*BMISS
   5165 
   5166 C     FILL FORWARD WITH NON-MISSING VALUES.
   5167 
   5168       DO J=1,NLEV
   5169         DO K=1,MEV
   5170           DO L=1,4
   5171             IF(L.EQ.2) GOTO 6

Page 167         Source Listing                  FILL
2017-04-18 11:07                                 cqcbufr.f

   5172             DO I=1,MVO
   5173               IF(OBS(I,J,K,L).LT.BMAX) GOTO 5
   5174               DO KK=K-1,1,-1
   5175                 IF(OBS(I,J,KK,L).LT.BMAX) THEN
   5176                   OBS(I,J,K,L) = OBS(I,J,KK,L)
   5177                   GOTO 5
   5178                 ENDIF
   5179               ENDDO
   5180     5         CONTINUE
   5181             ENDDO
   5182     6       CONTINUE
   5183           ENDDO
   5184         ENDDO
   5185       ENDDO
   5186 
   5187 C     FILL BOTH WAYS FOR THE GUESS VALUES.
   5188 
   5189       DO J=1,NLEV
   5190         DO I=1,MVO
   5191           DO K=1,MEV
   5192             GES = BMISS
   5193             IF(OBS(I,J,K,2).LT.BMAX) THEN
   5194               GES = OBS(I,J,K,2)
   5195               GOTO 20
   5196             ENDIF
   5197           ENDDO
   5198    20     CONTINUE
   5199           DO K=1,MEV
   5200             OBS(I,J,K,2) = GES
   5201           ENDDO
   5202         ENDDO
   5203       ENDDO
   5204 
   5205 C     FILL BOTH WAYS FOR DEW-POINT TEMPERATURE.
   5206 
   5207       DO J=1,NLEV
   5208         TD = BMISS
   5209         DO M=1,MEV
   5210           IF(OBS(5,J,M,1).LT.BMAX) THEN
   5211             TD = OBS(5,J,M,1)
   5212             GOTO 30
   5213           ENDIF
   5214         ENDDO
   5215    30   CONTINUE
   5216         DO M=1,MEV
   5217           OBS(5,J,M,1) = TD
   5218         ENDDO
   5219       ENDDO
   5220 
   5221       RETURN
   5222       END

Page 168         Source Listing                  FILL
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 fill_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  5198                                                           5195                              
 30                         Label  5215                                                           5212                              
 5                          Label  5180                                                           5173,5177                         
 6                          Label  5182                                                           5171                              
 BMAX                       Local  5164     R(4)            4           scalar                    5164,5173,5175,5193,5210          
 BMISS                      Scalar 5160     R(8)            8           scalar   COM              5164,5192,5208                    
 BUFRLIB_MISSING            Common 5162                                 16                                                          
 FILL                       Subr   5150                                                                                             
 GES                        Local  5192     R(4)            4           scalar                    5192,5194,5200                    
 I                          Local  5172     I(4)            4           scalar                    5172,5173,5175,5176,5190,5193,5194
                                                                                                  ,5200                             
 IMISS                      Scalar 5162     I(4)            4           scalar   COM                                                
 J                          Local  5168     I(4)            4           scalar                    5168,5173,5175,5176,5189,5193,5194
                                                                                                  ,5200,5207,5210,5211,5217         
 K                          Local  5169     I(4)            4           scalar                    5169,5173,5174,5176,5191,5193,5194
                                                                                                  ,5199,5200                        
 KK                         Local  5174     I(4)            4           scalar                    5174,5175,5176                    
 L                          Local  5170     I(4)            4           scalar                    5170,5171,5173,5175,5176          
 M                          Local  5209     I(4)            4           scalar                    5209,5210,5211,5216,5217          
 MEV                        Param  5154     I(4)            4           scalar                    5158,5169,5191,5199,5209,5216     
 MLV                        Param  5153     I(4)            4           scalar                    5158                              
 MVO                        Param  5151     I(4)            4           scalar                    5158,5172,5190                    
 MVR                        Param  5152     I(4)            4           scalar                                                      
 NLEV                       Dummy  5150     I(4)            4           scalar   ARG,INOUT        5168,5189,5207                    
 OBS                        Dummy  5150     R(4)            4     4     71400    ARG,INOUT        5173,5175,5176,5193,5194,5200,5210
                                                                                                  ,5211,5217                        
 TD                         Local  5208     R(4)            4           scalar                    5208,5211,5217                    
 XMISS                      Scalar 5162     R(4)            4           scalar   COM                                                

Page 169         Source Listing                  FILL
2017-04-18 11:07                                 cqcbufr.f

   5223 
   5224 C**********************************************************************
   5225 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5226 C                .      .    .                                       .
   5227 C SUBPROGRAM:    FULVAL      ADD INCREMENT TO GUESS TO GET FULL VALUE
   5228 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1995-12-18
   5229 C
   5230 C ABSTRACT: ADD THE INCREMENT TO THE FIRST GUESS TO GET THE FULL VALUE.
   5231 C
   5232 C PROGRAM HISTORY LOG:
   5233 C 1995-12-18  W. Collins  Original author.
   5234 C 1997-04-28  W. Collins  Make sure that the events correspond to the
   5235 C     changes to the data.
   5236 C 1997-05-19  W. Collins  Make QOB correspond to the modified TDO.
   5237 C
   5238 C USAGE:    CALL FULVAL(WIND)
   5239 C   INPUT ARGUMENT LIST:
   5240 C     WIND     - .TRUE. FOR WIND PART OF REPORT, .FALSE. OTHERWISE
   5241 C
   5242 C   OUTPUT FILES:
   5243 C     UNIT 06  - PRINTOUT
   5244 C
   5245 C REMARKS: NONE.
   5246 C
   5247 C ATTRIBUTES:
   5248 C   LANGUAGE: FORTRAN 90
   5249 C   MACHINE:  NCEP WCOSS
   5250 C
   5251 C$$$
   5252       SUBROUTINE FULVAL(WIND)
   5253       PARAMETER (NST=999)
   5254 
   5255       REAL(8) BMISS
   5256 
   5257       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   5258      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   5259      &                 NEV, ISF(NST), NLVM, NLVW
   5260       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   5261      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   5262      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   5263      &                 TDO(255), TDFC(255),TVO(255),
   5264      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   5265      &                 CAT(255), IND(255), LEVTYP(255),
   5266      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   5267      &                 YDR(255), XDR(255)
   5268       COMMON /ALSNDW/ POBW(255),PFCW(255),PQMW(255),PRCW(255),
   5269      &                ZOBW(255),ZFCW(255),ZQMW(255),ZRCW(255),
   5270      &                UOB(255),VOB(255),UFC(255),VFC(255),
   5271      &                WQM(255),WRC(255),SP(255), DIR(255),
   5272      &                CATW(255)
   5273       COMMON /EVNSND/ PO (255),TO (255),ZO (255),CA (255),
   5274      &                PQ (255),TQ (255),ZQ (255),INP(255),
   5275      &                PR (255),TR (255),ZR (255),INZ(255),
   5276      &                QO (255),QQ (255),QR (255),INT(255),
   5277      &                TDE(255),TDQ(255),TDR(255),INQ(255),
   5278      &                UO(255), VO(255), SPO(255), DIRO(255),
   5279      &                WQ(255), WR(255)

Page 170         Source Listing                  FULVAL
2017-04-18 11:07                                 cqcbufr.f

   5280       COMMON /INC/    PNC(255),TNC(255),QNC(255),TDNC(255),ZNC(255)
   5281       COMMON /INCW/   PNCW(255),ZNCW(255),UNC(255),VNC(255)
   5282       COMMON /PEROR/  ISERR, ISOBERR
   5283       COMMON /LTP/    LVTYP(9,255), NCH(9,255), LVRC(9,255), LVRCALL
   5284       COMMON /STN/     IS
   5285       COMMON /TESTS/   TEST
   5286       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5287 
   5288       LOGICAL         TEST
   5289       LOGICAL         ISERR, LVRC, ISOBERR, PRNT, LVRCALL
   5290       CHARACTER*8     SID
   5291       LOGICAL         WIND, SDM, SDMT, SDMZ, ISNCH
   5292 
   5293 C-----------------------------------------------------------------------
   5294 C FCNS BELOW CONVERT TEMP/TD (K) & PRESS (MB) INTO SAT./ SPEC. HUM.(G/G)
   5295 C-----------------------------------------------------------------------
   5296       !ES(T) = 6.1078*EXP((17.269*(T - 273.15))/(T - 273.15 + 237.3))
   5297       !QS(T,P) = (0.622*ES(T))/(P-0.378*ES(T))
   5298 C-----------------------------------------------------------------------
   5299 
   5300 C  CLEAR THE EVENTS ARRAYS
   5301 C  -----------------------
   5302 
   5303       PO = BMISS
   5304       TO = BMISS
   5305       TDE = BMISS
   5306       QO = BMISS
   5307       ZO = BMISS
   5308       UO = BMISS
   5309       VO = BMISS
   5310       IN = BMISS
   5311 
   5312 C  ADD INCREMENTS TO FORECAST TO GET FULL VALUES.
   5313 C  DO ONLY FOR AUXILIARY LEVELS
   5314 C  -------------------------------------------------
   5315 
   5316       IF(.NOT. WIND) THEN
   5317         DO L=1,NLV
   5318           QM   = TQM(L)
   5319           SDMT = QM.EQ.0 .OR. QM.EQ.8 .OR. QM.EQ.9 .OR.
   5320      &           QM.EQ.11 .OR. QM.EQ.12 .OR. QM.EQ.14 .OR.
   5321      &           QM.EQ.15
   5322           QM   = ZQM(L)
   5323           SDMZ = QM.EQ.0 .OR. QM.EQ.8 .OR. QM.EQ.9 .OR.
   5324      &           QM.EQ.11 .OR. QM.EQ.12 .OR. QM.EQ.14 .OR.
   5325      &           QM.EQ.15
   5326 C         IF(LVRC(1,L) .AND.
   5327 C    &      PNC(L).NE.BMISS .AND. PFC(L).NE.BMISS) THEN
   5328 C           POB(L)  = PNC(L)+PFC(L)
   5329 C           NCH(1,L) = 1
   5330 C         ENDIF
   5331           IF(LVRC(2,L) .AND. .NOT.SDMT .AND.
   5332      &      TNC(L).NE.BMISS .AND. TFC(L).NE.BMISS) THEN
   5333             TOB(L)  = TNC(L)+TFC(L)
   5334             NCH(2,L) = 1
   5335           ENDIF
   5336 C         IF(LVRC(4,L) .AND. .NOT.SDMT .AND.

Page 171         Source Listing                  FULVAL
2017-04-18 11:07                                 cqcbufr.f

   5337 C    &      TDNC(L).NE.BMISS .AND. TDFC(L).NE.BMISS) THEN
   5338 C           TDO(L) = TDNC(L)+TDFC(L)
   5339 C           NCH(4,L) = 1
   5340 C  IF TDO IS CHANGED, RECALCULATE QOB.
   5341 C           IF(TDO(L).NE.BMISS .AND. POB(L).NE.BMISS) THEN
   5342 C             QOB(L)  = QS(TDO(L)+TOB(L)+273.15,POB(L))
   5343 C             NCH(3,L) = 1
   5344 C           ENDIF
   5345 C         ENDIF
   5346 C         IF(LVRC(5,L) .AND. .NOT.SDMZ .AND.
   5347 C    &      ZNC(L).NE.BMISS .AND. ZFC(L).NE.BMISS) THEN
   5348 C           ZOB(L)  = ZNC(L)+ZFC(L)
   5349 C           NCH(5,L) = 1
   5350 C         ENDIF
   5351         ENDDO
   5352       ELSE
   5353         DO L=1,NLV
   5354           QM = WQM(L)
   5355           SDM = QM.EQ.0 .OR. QM.EQ.8 .OR. QM.EQ.9 .OR.
   5356      &          QM.EQ.11 .OR. QM.EQ.12 .OR. QM.EQ.14 .OR.
   5357      &          QM.EQ.15
   5358 C         IF(LVRC(6,L) .AND.
   5359 C    &      PNCW(L).NE.BMISS .AND. PFCW(L).NE.BMISS) THEN
   5360 C           POBW(L) = PNCW(L)+PFCW(L)
   5361 C           NCH(6,L) = 1
   5362 C         ENDIF
   5363           IF(LVRC(7,L) .AND. .NOT. SDM .AND.
   5364      &      UNC(L).NE.BMISS .AND. UFC(L).NE.BMISS) THEN
   5365             UOB(L)  = UNC(L)+UFC(L)
   5366             NCH(7,L) = 1
   5367           ENDIF
   5368           IF(LVRC(8,L) .AND. .NOT. SDM .AND.
   5369      &      VNC(L).NE.BMISS .AND. VFC(L).NE.BMISS) THEN
   5370             VOB(L)  = VNC(L)+VFC(L)
   5371             NCH(8,L) = 1
   5372           ENDIF
   5373 C         IF(LVRC(9,L) .AND.
   5374 C    &      ZNCW(L).NE.BMISS .AND. ZFCW(L).NE.BMISS) THEN
   5375 C           ZOBW(L) = ZNCW(L)+ZFCW(L)
   5376 C           NCH(9,L) = 1
   5377 C         ENDIF
   5378         ENDDO
   5379       ENDIF
   5380 
   5381 C  PREPARE EVENT ARRAYS FOR UFB AND EXIT
   5382 C  LOOP THROUGH LEVELS, LOOKING FOR EVENTS
   5383 C  ---------------------------------------
   5384 
   5385       IEV = 0
   5386       IF(.NOT. WIND) THEN
   5387         ISNCH = .FALSE.
   5388         DO L=1,NLV
   5389 
   5390 C  SET QQM TO LARGER OF QQM AND TQM
   5391 C  --------------------------------
   5392 
   5393 CWC       QQM(L) = AMAX1(QQM(L),TQM(L))

Page 172         Source Listing                  FULVAL
2017-04-18 11:07                                 cqcbufr.f

   5394 
   5395           DO N=1,5
   5396             ISNCH = ISNCH .OR. NCH(N,L).EQ.1
   5397           ENDDO
   5398           IF(ISNCH) THEN
   5399           IEV = IEV + 1
   5400           INP(IEV) = L
   5401           IF(NCH(1,L).EQ.1) THEN
   5402             PO(IEV) = POB(L)
   5403             PQM(L)  = 1.
   5404             PQ(IEV) = PQM(L)
   5405             PR(IEV) = PRC(L)
   5406           ENDIF
   5407           IF(NCH(2,L).EQ.1) THEN
   5408             TO(IEV) = TOB(L)
   5409             TQM(L)  = 1.
   5410             TQ(IEV) = TQM(L)
   5411             TR(IEV) = TRC(L)
   5412           ENDIF
   5413 CWC       IF(NCH(3,L).EQ.1) THEN
   5414 CWC         IF(QOB(L).LT.BMISS) THEN
   5415 CWC           QO(IEV) = QOB(L)*1.E6
   5416 CWC           QQM(L)  = 1.
   5417 CWC           QQ(IEV) = QQM(L)
   5418 CWC           QR(IEV) = QRC(L)
   5419 CWC         ELSE
   5420 CWC           QO(IEV) = BMISS
   5421 CWC           QQ(IEV) = BMISS
   5422 CWC           QR(IEV) = BMISS
   5423 CWC         ENDIF
   5424 CWC       ENDIF
   5425 CWC       IF(NCH(4,L).EQ.1) THEN
   5426 CWC         IF(TDO(L).LT.BMISS .AND. TOB(L).LT.BMISS) THEN
   5427 CWC           TDE(IEV) = TOB(L) - TDO(L)
   5428 CWC           QQM(L)  = 1.
   5429 CWC           TDQ(IEV) = QQM(L)
   5430 CWC           TDR(IEV) = QRC(L)
   5431 CWC         ELSE
   5432 CWC           TDE(IEV) = BMISS
   5433 CWC           TDQ(IEV) = BMISS
   5434 CWC           TDR(IEV) = BMISS
   5435 CWC         ENDIF
   5436 CWC       ENDIF
   5437           IF(NCH(5,L).EQ.1) THEN
   5438             ZO(IEV) = ZOB(L)
   5439             ZQM(L)  = 1.
   5440             ZQ(IEV) = ZQM(L)
   5441             ZR(IEV) = ZRC(L)
   5442           ENDIF
   5443           IF(ISERR) THEN
   5444             IF(IEV.EQ.1) THEN
   5445               IF(TEST) THEN
   5446                 WRITE(6,504) SID(IS)
   5447   504           FORMAT(' FULVAL--event for: ',A8)
   5448                 WRITE(6,505)
   5449   505           FORMAT('   pressure      ht    temp  sp hum pqm',
   5450      &                 ' zqm tqm qqm  pr  zr  tr  qr ind')

Page 173         Source Listing                  FULVAL
2017-04-18 11:07                                 cqcbufr.f

   5451               ENDIF
   5452             ENDIF
   5453             IF(TEST) WRITE(6,506) PO(IEV),ZO(IEV),TO(IEV),QO(IEV),
   5454      &        PQ(IEV),ZQ(IEV),TQ(IEV),QQ(IEV),PR(IEV),ZR(IEV),TR(IEV),
   5455      &        QR(IEV),INP(IEV)
   5456   506       FORMAT(1X,F10.0,1X,F7.1,1X,F7.1,1X,F7.0,8(1X,F3.0),
   5457      &        1X,I3)
   5458           ENDIF
   5459           ENDIF
   5460           NEV = IEV
   5461         ENDDO
   5462       ELSE
   5463         ISNCH = .FALSE.
   5464         DO L=1,NLV
   5465           DO N=6,9
   5466             ISNCH = ISNCH .OR. NCH(N,L).EQ.1
   5467           ENDDO
   5468           IF(ISNCH) THEN
   5469           IEV = IEV + 1
   5470           INP(IEV) = L
   5471           IF(NCH(6,L).EQ.1) THEN
   5472             PO(IEV) = POBW(L)
   5473             PQMW(L) = 1.
   5474             PQ(IEV) = PQMW(L)
   5475             PR(IEV) = PRCW(L)
   5476           ENDIF
   5477           IF(NCH(9,L).EQ.1) THEN
   5478             ZO(IEV) = ZOBW(L)
   5479             ZQMW(L) = 1.
   5480             ZQ(IEV) = ZQMW(L)
   5481             ZR(IEV) = ZRCW(L)
   5482           ENDIF
   5483           IF(NCH(7,L).EQ.1 .OR. NCH(8,L).EQ.1) THEN
   5484             UO(IEV) = UOB(L)
   5485             VO(IEV) = VOB(L)
   5486             WQM(L)  = 1.
   5487             WQ(IEV) = WQM(L)
   5488             WR(IEV) = WRC(L)
   5489           ENDIF
   5490           IF(ISERR) THEN
   5491             WRITE(6,504) SID
   5492             WRITE(6,507)
   5493             WRITE(6,508) PO(IEV),ZO(IEV),UO(IEV),VO(IEV),PQ(IEV),
   5494      &      ZQ(IEV),WQ(IEV),PR(IEV),ZR(IEV),WR(IEV),INP(IEV)
   5495   507       FORMAT('   press      ht  u-comp  v-comp pqm zqm',
   5496      &             ' wqm  pr  zr  wr ind')
   5497   508       FORMAT(4(1X,F7.1),6(1X,F3.0),1X,I3)
   5498           ENDIF
   5499           ENDIF
   5500           NEV = IEV
   5501         ENDDO
   5502       ENDIF
   5503 
   5504       RETURN
   5505       END

Page 174         Source Listing                  FULVAL
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 fulval_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 504                        Label  5447                                                           5446,5491                         
 505                        Label  5449                                                           5448                              
 506                        Label  5456                                                           5453                              
 507                        Label  5495                                                           5492                              
 508                        Label  5497                                                           5493                              
 ALLSND                     Common 5260                                 34512                                                       
 ALSNDW                     Common 5268                                 17340                                                       
 BMISS                      Scalar 5255     R(8)            8           scalar   COM              5303,5304,5305,5306,5307,5308,5309
                                                                                                  ,5310,5332,5364,5369              
 BUFRLIB_MISSING            Common 5286                                 16                                                          
 CA                         Scalar 5273     R(4)            4     1     255      COM                                                
 CAT                        Scalar 5265     R(4)            4     1     255      COM                                                
 CATW                       Scalar 5272     R(4)            4     1     255      COM                                                
 DHR                        Scalar 5257     R(4)            4     1     999      COM                                                
 DIR                        Scalar 5271     R(4)            4     1     255      COM                                                
 DIRO                       Scalar 5278     R(4)            4     1     255      COM                                                
 ELV                        Scalar 5258     R(4)            4     1     999      COM                                                
 EVNSND                     Common 5273                                 26520                                                       
 FULVAL                     Subr   5252                                                                                             
 GESPS                      Scalar 5266     R(4)            4     1     999      COM                                                
 HEADER                     Common 5257                                 35980                                                       
 HRDR                       Scalar 5266     R(4)            4     1     255      COM                                                
 IEV                        Local  5385     I(4)            4           scalar                    5385,5399,5400,5402,5404,5405,5408
                                                                                                  ,5410,5411,5438,5440,5441,5444,545
                                                                                                  3,5454,5455,5460,5469,5470,5472,54
                                                                                                  74,5475,5478,5480,5481,5484,5485,5
                                                                                                  487,5488,5493,5494,5500           
 IMISS                      Scalar 5286     I(4)            4           scalar   COM                                                
 IN                         Local  5310     I(4)            4           scalar                    5310                              
 INC                        Common 5280                                 5100                                                        
 INCW                       Common 5281                                 4080                                                        
 IND                        Scalar 5265     I(4)            4     1     255      COM                                                
 INP                        Scalar 5274     I(4)            4     1     255      COM              5400,5455,5470,5494               
 INQ                        Scalar 5277     I(4)            4     1     255      COM                                                
 INT                        Scalar 5276     I(4)            4     1     255      COM                                                
 INZ                        Scalar 5275     I(4)            4     1     255      COM                                                
 IS                         Scalar 5284     I(4)            4           scalar   COM              5446                              
 ISERR                      Scalar 5282     L(4)            4           scalar   COM              5443,5490                         
 ISF                        Scalar 5259     I(4)            4     1     999      COM                                                
 ISNCH                      Local  5291     L(4)            4           scalar                    5387,5396,5398,5463,5466,5468     
 ISOBERR                    Scalar 5282     L(4)            4           scalar   COM                                                
 ITP                        Scalar 5258     I(4)            4     1     999      COM                                                
 L                          Local  5317     I(4)            4           scalar                    5317,5318,5322,5331,5332,5333,5334
                                                                                                  ,5353,5354,5363,5364,5365,5366,536

Page 175         Source Listing                  FULVAL
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  8,5369,5370,5371,5388,5396,5400,54
                                                                                                  01,5402,5403,5404,5405,5407,5408,5
                                                                                                  409,5410,5411,5437,5438,5439,5440,
                                                                                                  5441,5464,5466,5470,5471,5472,5473
                                                                                                  ,5474,5475,5477,5478,5479,5480,548
                                                                                                  1,5483,5484,5485,5486,5487,5488   
 LEVTYP                     Scalar 5265     I(4)            4     1     255      COM                                                
 LST                        Scalar 5266     I(4)            4     1     255      COM                                                
 LTP                        Common 5283                                 27544                                                       
 LVRC                       Scalar 5283     L(4)            4     2     2295     COM              5331,5363,5368                    
 LVRCALL                    Scalar 5283     L(4)            4           scalar   COM                                                
 LVTYP                      Scalar 5283     I(4)            4     2     2295     COM                                                
 N                          Local  5395     I(4)            4           scalar                    5395,5396,5465,5466               
 NCH                        Scalar 5283     I(4)            4     2     2295     COM              5334,5366,5371,5396,5401,5407,5437
                                                                                                  ,5466,5471,5477,5483              
 NEV                        Scalar 5259     I(4)            4           scalar   COM              5460,5500                         
 NLV                        Scalar 5258     I(4)            4           scalar   COM              5317,5353,5388,5464               
 NLVM                       Scalar 5259     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 5259     I(4)            4           scalar   COM                                                
 NST                        Param  5253     I(4)            4           scalar                    5257,5258,5259,5266               
 PEROR                      Common 5282                                 8                                                           
 PFC                        Scalar 5260     R(4)            4     1     255      COM                                                
 PFCW                       Scalar 5268     R(4)            4     1     255      COM                                                
 PNC                        Scalar 5280     R(4)            4     1     255      COM                                                
 PNCW                       Scalar 5281     R(4)            4     1     255      COM                                                
 PO                         Scalar 5273     R(4)            4     1     255      COM              5303,5402,5453,5472,5493          
 POB                        Scalar 5260     R(4)            4     1     255      COM              5402                              
 POBW                       Scalar 5268     R(4)            4     1     255      COM              5472                              
 PQ                         Scalar 5274     R(4)            4     1     255      COM              5404,5454,5474,5493               
 PQM                        Scalar 5260     R(4)            4     1     255      COM              5403,5404                         
 PQMW                       Scalar 5268     R(4)            4     1     255      COM              5473,5474                         
 PR                         Scalar 5275     R(4)            4     1     255      COM              5405,5454,5475,5494               
 PRC                        Scalar 5260     R(4)            4     1     255      COM              5405                              
 PRCW                       Scalar 5268     R(4)            4     1     255      COM              5475                              
 PRNT                       Local  5289     L(4)            4           scalar                                                      
 PS                         Scalar 5266     R(4)            4     1     999      COM                                                
 QFC                        Scalar 5264     R(4)            4     1     255      COM                                                
 QM                         Local  5318     R(4)            4           scalar                    5318,5319,5320,5321,5322,5323,5324
                                                                                                  ,5325,5354,5355,5356,5357         
 QNC                        Scalar 5280     R(4)            4     1     255      COM                                                
 QO                         Scalar 5276     R(4)            4     1     255      COM              5306,5453                         
 QOB                        Scalar 5264     R(4)            4     1     255      COM                                                
 QQ                         Scalar 5276     R(4)            4     1     255      COM              5454                              
 QQM                        Scalar 5264     R(4)            4     1     255      COM                                                
 QR                         Scalar 5276     R(4)            4     1     255      COM              5455                              
 QRC                        Scalar 5264     R(4)            4     1     255      COM                                                
 SDM                        Local  5291     L(4)            4           scalar                    5355,5363,5368                    
 SDMT                       Local  5291     L(4)            4           scalar                    5319,5331                         
 SDMZ                       Local  5291     L(4)            4           scalar                    5323                              
 SID                        Scalar 5257     CHAR            8     1     999      COM              5446,5491                         
 SP                         Scalar 5271     R(4)            4     1     255      COM                                                
 SPO                        Scalar 5278     R(4)            4     1     255      COM                                                
 SQN                        Scalar 5258     R(4)            4     1     999      COM                                                
 STN                        Common 5284                                 4                                                           
 TDE                        Scalar 5277     R(4)            4     1     255      COM              5305                              

Page 176         Source Listing                  FULVAL
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TDFC                       Scalar 5263     R(4)            4     1     255      COM                                                
 TDNC                       Scalar 5280     R(4)            4     1     255      COM                                                
 TDO                        Scalar 5263     R(4)            4     1     255      COM                                                
 TDQ                        Scalar 5277     R(4)            4     1     255      COM                                                
 TDR                        Scalar 5277     R(4)            4     1     255      COM                                                
 TEST                       Scalar 5285     L(4)            4           scalar   COM              5445,5453                         
 TESTS                      Common 5285                                 4                                                           
 TFC                        Scalar 5262     R(4)            4     1     255      COM              5332,5333                         
 TNC                        Scalar 5280     R(4)            4     1     255      COM              5332,5333                         
 TO                         Scalar 5273     R(4)            4     1     255      COM              5304,5408,5453                    
 TOB                        Scalar 5262     R(4)            4     1     255      COM              5333,5408                         
 TQ                         Scalar 5274     R(4)            4     1     255      COM              5410,5454                         
 TQM                        Scalar 5262     R(4)            4     1     255      COM              5318,5409,5410                    
 TR                         Scalar 5275     R(4)            4     1     255      COM              5411,5454                         
 TRC                        Scalar 5262     R(4)            4     1     255      COM              5411                              
 TVO                        Scalar 5263     R(4)            4     1     255      COM                                                
 UFC                        Scalar 5270     R(4)            4     1     255      COM              5364,5365                         
 UNC                        Scalar 5281     R(4)            4     1     255      COM              5364,5365                         
 UO                         Scalar 5278     R(4)            4     1     255      COM              5308,5484,5493                    
 UOB                        Scalar 5270     R(4)            4     1     255      COM              5365,5484                         
 VFC                        Scalar 5270     R(4)            4     1     255      COM              5369,5370                         
 VNC                        Scalar 5281     R(4)            4     1     255      COM              5369,5370                         
 VO                         Scalar 5278     R(4)            4     1     255      COM              5309,5485,5493                    
 VOB                        Scalar 5270     R(4)            4     1     255      COM              5370,5485                         
 WIND                       Dummy  5252     L(4)            4           scalar   ARG,INOUT        5316,5386                         
 WQ                         Scalar 5279     R(4)            4     1     255      COM              5487,5494                         
 WQM                        Scalar 5271     R(4)            4     1     255      COM              5354,5486,5487                    
 WR                         Scalar 5279     R(4)            4     1     255      COM              5488,5494                         
 WRC                        Scalar 5271     R(4)            4     1     255      COM              5488                              
 XDR                        Scalar 5267     R(4)            4     1     255      COM                                                
 XMISS                      Scalar 5286     R(4)            4           scalar   COM                                                
 XOB                        Scalar 5257     R(4)            4     1     999      COM                                                
 YDR                        Scalar 5267     R(4)            4     1     255      COM                                                
 YOB                        Scalar 5257     R(4)            4     1     999      COM                                                
 ZFC                        Scalar 5261     R(4)            4     1     255      COM                                                
 ZFCW                       Scalar 5269     R(4)            4     1     255      COM                                                
 ZNC                        Scalar 5280     R(4)            4     1     255      COM                                                
 ZNCW                       Scalar 5281     R(4)            4     1     255      COM                                                
 ZO                         Scalar 5273     R(4)            4     1     255      COM              5307,5438,5453,5478,5493          
 ZOB                        Scalar 5261     R(4)            4     1     255      COM              5438                              
 ZOBW                       Scalar 5269     R(4)            4     1     255      COM              5478                              
 ZQ                         Scalar 5274     R(4)            4     1     255      COM              5440,5454,5480,5494               
 ZQM                        Scalar 5261     R(4)            4     1     255      COM              5322,5439,5440                    
 ZQMW                       Scalar 5269     R(4)            4     1     255      COM              5479,5480                         
 ZR                         Scalar 5275     R(4)            4     1     255      COM              5441,5454,5481,5494               
 ZRC                        Scalar 5261     R(4)            4     1     255      COM              5441                              
 ZRCW                       Scalar 5269     R(4)            4     1     255      COM              5481                              

Page 177         Source Listing                  FULVAL
2017-04-18 11:07                                 cqcbufr.f

   5506 
   5507 C*********************************************************************
   5508 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5509 C                .      .    .                                       .
   5510 C SUBPROGRAM:    FUZZY       COMPUTE OBS ERROR FUZZY LOGIC RESULT
   5511 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1995-12-18
   5512 C
   5513 C ABSTRACT: GIVEN INCREMENT, VERTICAL RESIDUAL, HORIZONTAL RESIDUAL
   5514 C   AS NORMAL VARIATES, CALCULATE THE FUZZY LOGIC ESTIMATE OF THE
   5515 C   PRESENCE OF OBSERVATION ERROR.  THE RESULT IS IN TERMS OF THE MEAN
   5516 C   NORMAL VARIATE.  THE ACTUAL DECISION REGARDING AN ERROR OR NOT IS
   5517 C   NOT DONE HERE.
   5518 C
   5519 C PROGRAM HISTORY LOG:
   5520 C 1999-04-13  W. Collins  Original author.
   5521 C 2001-04-20  W. Collins  Correct error that showed up only when a
   5522 C     guess was not available: test leading to P = 0.
   5523 C
   5524 C USAGE:    CALL FUZZY(P,XI,XV,XH,B,PER)
   5525 C   INPUT ARGUMENT LIST:
   5526 C     XI   - INCREMENT, NORMAL VARIATE
   5527 C     XV   - VERTICAL RESIDUAL, NORMAL VARIATE
   5528 C     XH   - HORIZONTAL RESIDUAL, NORMAL VARIATE
   5529 C     B    - MAXIMUM RANGE OF ROUGH ERRORS
   5530 C     PER  - ASSUMED PROPORTION OF ROUGH ERRORS
   5531 C
   5532 C   OUTPUT ARGUMENT LIST:
   5533 C     P    - MEAN "ANALYSIS WEIGHT" FOR XI, XV, XH 
   5534 C
   5535 C
   5536 C REMARKS: NONE.
   5537 C
   5538 C ATTRIBUTES:
   5539 C   LANGUAGE: FORTRAN 90
   5540 C   MACHINE:  NCEP WCOSS
   5541 C
   5542 C$$$
   5543       SUBROUTINE FUZZY(P,XI,XV,XH,B,PER)
   5544 
   5545       REAL(8) BMISS
   5546 
   5547       REAL X(3)
   5548       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5549 
   5550       X(1) = ABS(XI)
   5551       X(2) = ABS(XV)
   5552       X(3) = ABS(XH)
   5553 
   5554       XUM = 0.
   5555       SUM = 0.
   5556       DO I=1,3
   5557         IF(X(I).LT..1*BMISS) THEN
   5558           XUM = XUM + 1.
   5559           SUM = SUM + ANLWT(X(I),B,PER)
   5560 C         SUM = SUM + CUMPROB(ABS(X(I)))
   5561         ENDIF
   5562       ENDDO

Page 178         Source Listing                  FUZZY
2017-04-18 11:07                                 cqcbufr.f

   5563 
   5564       IF(X(1).LT..1*BMISS .AND. X(1).GE.7.) THEN
   5565         P = 0.
   5566       ELSEIF(XUM.GT.0.) THEN
   5567         P = SUM/XUM
   5568       ELSE
   5569         P = BMISS
   5570       ENDIF
   5571 
   5572       RETURN
   5573       END 


ENTRY POINTS

  Name              
                    
 fuzzy_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   5550                                 scalar                    5550,5551,5552                    
 ANLWT                      Func   5559     R(4)            4           scalar                    5559                              
 B                          Dummy  5543     R(4)            4           scalar   ARG,INOUT        5559                              
 BMISS                      Scalar 5545     R(8)            8           scalar   COM              5557,5564,5569                    
 BUFRLIB_MISSING            Common 5548                                 16                                                          
 FUZZY                      Subr   5543                                                                                             
 I                          Local  5556     I(4)            4           scalar                    5556,5557,5559                    
 IMISS                      Scalar 5548     I(4)            4           scalar   COM                                                
 P                          Dummy  5543     R(4)            4           scalar   ARG,INOUT        5565,5567,5569                    
 PER                        Dummy  5543     R(4)            4           scalar   ARG,INOUT        5559                              
 SUM                        Local  5555     R(4)            4           scalar                    5555,5559,5567                    
 X                          Local  5547     R(4)            4     1     3                         5550,5551,5552,5557,5559,5564     
 XH                         Dummy  5543     R(4)            4           scalar   ARG,INOUT        5552                              
 XI                         Dummy  5543     R(4)            4           scalar   ARG,INOUT        5550                              
 XMISS                      Scalar 5548     R(4)            4           scalar   COM                                                
 XUM                        Local  5554     R(4)            4           scalar                    5554,5558,5566,5567               
 XV                         Dummy  5543     R(4)            4           scalar   ARG,INOUT        5551                              

Page 179         Source Listing                  FUZZY
2017-04-18 11:07                                 cqcbufr.f

   5574     
   5575 C*********************************************************************
   5576 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5577 C                .      .    .                                       .
   5578 C SUBPROGRAM:    GETINC      COMPUTE INCREMENTS 
   5579 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1995-12-18
   5580 C
   5581 C ABSTRACT: COMPUTE THE INCREMENT (OBSERVED VALUE MINUS FORECAST) AT
   5582 C   ALL "TRUE DATA LEVELS", I.E. LEVELS AT WHICH DATA WAS ACTUALLY
   5583 C   OBSERVED.
   5584 C
   5585 C PROGRAM HISTORY LOG:
   5586 C 1995-12-18  W. Collins  Original author.
   5587 C 1997-05-19  W. Collins  Only get increments TNC,UNC and VNC.
   5588 C
   5589 C USAGE:    CALL GETINC(WIND)
   5590 C   INPUT ARGUMENT LIST:
   5591 C     WIND     - .TRUE. FOR WIND PART OF REPORT, .FALSE. OTHERWISE
   5592 C
   5593 C   OUTPUT FILES:
   5594 C     UNIT 06  - PRINTOUT
   5595 C     UNIT 22  - LIST OF POTENTIAL WIND PROBLEMS
   5596 C
   5597 C REMARKS: NONE.
   5598 C
   5599 C ATTRIBUTES:
   5600 C   LANGUAGE: FORTRAN 90
   5601 C   MACHINE:  NCEP WCOSS
   5602 C
   5603 C$$$
   5604 
   5605       SUBROUTINE GETINC(WIND)
   5606       PARAMETER (NST=999)
   5607 
   5608       REAL(8) BMISS
   5609 
   5610       LOGICAL         WIND
   5611       CHARACTER*8     SID
   5612       CHARACTER*10    CDATE
   5613       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   5614      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   5615      &                 NEV, ISF(NST), NLVM, NLVW
   5616       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   5617      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   5618      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   5619      &                 TDO(255), TDFC(255),TVO(255),
   5620      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   5621      &                 CAT(255), IND(255), LEVTYP(255),
   5622      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   5623      &                 YDR(255), XDR(255)
   5624       COMMON /ALSNDW/ POBW(255),PFCW(255),PQMW(255),PRCW(255),
   5625      &                ZOBW(255),ZFCW(255),ZQMW(255),ZRCW(255),
   5626      &                UOB(255),VOB(255),UFC(255),VFC(255),
   5627      &                WQM(255),WRC(255),SP(255), DIR(255),
   5628      &                CATW(255)
   5629       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   5630      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT

Page 180         Source Listing                  GETINC
2017-04-18 11:07                                 cqcbufr.f

   5631       COMMON /INC/    PNC(255),TNC(255),QNC(255),TDNC(255),ZNC(255)
   5632       COMMON /INCW/   PNCW(255),ZNCW(255),UNC(255),VNC(255)
   5633       COMMON /PEROR/  ISERR, ISOBERR
   5634       COMMON /LTP/    LVTYP(9,255), NCH(9,255), LVRC(9,255), LVRCALL
   5635       COMMON /STN/    IS
   5636       COMMON /DATEX/  JDATE(5), CDATE
   5637       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5638 
   5639       LOGICAL ISERR, LVRC, ISOBERR, START, PRNT, LVRCALL
   5640       DATA START /.TRUE./
   5641 
   5642 C  INITIALIZE INCREMENTS
   5643 C  ---------------------
   5644 
   5645       PNC  = BMISS
   5646       TNC  = BMISS
   5647       QNC  = BMISS
   5648       TDNC = BMISS
   5649       ZNC  = BMISS
   5650       PNCW = BMISS
   5651       ZNCW = BMISS
   5652       UNC  = BMISS
   5653       VNC  = BMISS
   5654       IF(START) THEN
   5655 C       WRITE(22,505)
   5656         START = .FALSE.
   5657       ENDIF
   5658 
   5659 
   5660 C  SOLVE FOR INCREMENTS AT NON-AUXILIARY LEVELS WITH
   5661 C  GOOD, NON-MISSING DATA (I.E. LVTYP = 1)
   5662 C  -------------------------------------------------
   5663 
   5664       IF(.NOT. WIND) THEN
   5665         DO L=1,NLV
   5666 C         IF(LVTYP(1,L).EQ.1 .AND. POB(L).NE.BMISS .AND.
   5667 C    &       PFC(L).NE.BMISS) PNC(L)  = POB(L)-PFC(L)
   5668           IF(LVTYP(2,L).EQ.1 .AND. TOB(L).NE.BMISS .AND.
   5669      &       TFC(L).NE.BMISS) TNC(L)  = TOB(L)-TFC(L)
   5670 C         IF(LVTYP(3,L).EQ.1 .AND. QOB(L).NE.BMISS .AND.
   5671 C    &       QFC(L).NE.BMISS) QNC(L)  = QOB(L)-QFC(L)
   5672           IF(LVTYP(4,L).EQ.1 .AND. TDO(L).NE.BMISS .AND.
   5673      &       TDFC(L).NE.BMISS .AND. TOB(L).NE.BMISS)
   5674      &       TDNC(L) = (TOB(L)-TDO(L)) - TDFC(L)  !TDO is depression
   5675 C         IF(LVTYP(5,L).EQ.1 .AND. ZOB(L).NE.BMISS .AND.
   5676 C    &       ZFC(L).NE.BMISS) ZNC(L)  = ZOB(L)-ZFC(L)
   5677   	  IF(ISERR) THEN
   5678             WRITE(6,500) SID(IS),L,POB(L),PNC(L),TNC(L),QNC(L),TDNC(L),
   5679      &        ZNC(L)
   5680   500       FORMAT(' GETINC--SID,L,POB,PNC,TNC,QNC,TDNC,ZNC: ',
   5681      &        A8,I5,2X,6F10.1)
   5682           ENDIF
   5683         ENDDO
   5684 
   5685       ELSE
   5686         DO L=1,NLV
   5687 C         IF(LVTYP(6,L).EQ.1 .AND. POBW(L).NE.BMISS .AND.

Page 181         Source Listing                  GETINC
2017-04-18 11:07                                 cqcbufr.f

   5688 C    &       PFCW(L).NE.BMISS) PNCW(L) = POBW(L)-PFCW(L)
   5689 C  If CAT=4, first solve for POBW?
   5690 C         IF(LVTYP(9,L).EQ.1 .AND. ZOB(L).NE.BMISS .AND.
   5691 C    &       ZFCW(L).NE.BMISS) ZNCW(L) = ZOBW(L)-ZFCW(L)
   5692 C  If LVTYP=1, solve hydrostatically for ZOBW (?)
   5693           IF(LVTYP(7,L).EQ.1 .AND. UOB(L).NE.BMISS .AND.
   5694      &       UFC(L).NE.BMISS) UNC(L)  = UOB(L)-UFC(L)
   5695           IF(LVTYP(8,L).EQ.1 .AND. VOB(L).NE.BMISS .AND.
   5696      &       VFC(L).NE.BMISS) VNC(L)  = VOB(L)-VFC(L)
   5697           IF(UNC(L).NE.BMISS .AND. VNC(L).NE.BMISS) THEN
   5698              WNC = SQRT(UNC(L)**2 + VNC(L)**2)
   5699              IF(WNC.GT.25.) THEN
   5700                IF(UOB(L).NE.0. .OR. VOB(L).NE.0.) THEN
   5701                  ANGOB = 90. - 57.29578 * ATAN2(VOB(L),UOB(L))
   5702                  IF(ANGOB.LT.0.) ANGOB = ANGOB+360.
   5703                ELSE
   5704                  ANGOB = 0.
   5705                ENDIF
   5706                IF(UFC(L).NE.0. .OR. VFC(L).NE.0.) THEN
   5707                  ANGFC = 90. - 57.29578 * ATAN2(VFC(L),UFC(L))
   5708                  IF(ANGFC.LT.0.) ANGFC = ANGFC+360.
   5709                ELSE
   5710                  ANGFC = 0.
   5711                ENDIF
   5712                IANGOB = ANGOB
   5713                IANGFC = ANGFC
   5714                SPOB  = SQRT(VOB(L)**2 + UOB(L)**2)
   5715                SPFC  = SQRT(VFC(L)**2 + UFC(L)**2)
   5716 C              WRITE(22,502) CDATE,DHR(IS),SID(IS),XOB(IS),YOB(IS),
   5717 C    &           POBW(L),IANGOB,IANGFC,SPOB,SPFC,WNC
   5718              ENDIF
   5719   502        FORMAT(1X,A10,F8.0,2X,A8,2F8.2,F8.1,4X,I5,'/',I5,1X,
   5720      &         2F8.1,F8.0)
   5721   505        FORMAT(' POTENTIAL WIND PROBLEMS:',/,
   5722      &         59X,'DIRECTION         SPEED',/,
   5723      &         '     DATE    REL-HR    STN       LONG     LAT   PRESS',
   5724      &         '      OBS/GUESS      OBS   GUESS  V-DIFF')
   5725           ENDIF
   5726   	  IF(ISERR) THEN
   5727             WRITE(6,501) SID(IS),L,POBW(L),PNCW(L),ZNCW(L),UNC(L),VNC(L)
   5728   501       FORMAT(' GETINC--SID,L,POBW,PNCW,ZNCW,UNC,VNC:    ',
   5729      &        A8,I5,2X,5F10.1)
   5730           ENDIF
   5731         ENDDO
   5732       ENDIF
   5733 
   5734       RETURN
   5735       END

Page 182         Source Listing                  GETINC
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 getinc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  5680                                                           5678                              
 501                        Label  5728                                                           5727                              
 502                        Label  5719                                                                                             
 505                        Label  5721                                                                                             
 ALLSND                     Common 5616                                 34512                                                       
 ALSNDW                     Common 5624                                 17340                                                       
 ANGFC                      Local  5707     R(4)            4           scalar                    5707,5708,5710,5713               
 ANGOB                      Local  5701     R(4)            4           scalar                    5701,5702,5704,5712               
 ATAN2                      Func   5701                                 scalar                    5701,5707                         
 BMISS                      Scalar 5608     R(8)            8           scalar   COM              5645,5646,5647,5648,5649,5650,5651
                                                                                                  ,5652,5653,5668,5669,5672,5673,569
                                                                                                  3,5694,5695,5696,5697             
 BUFRLIB_MISSING            Common 5637                                 16                                                          
 CAT                        Scalar 5621     R(4)            4     1     255      COM                                                
 CATW                       Scalar 5628     R(4)            4     1     255      COM                                                
 CDATE                      Scalar 5612     CHAR            10          scalar   COM                                                
 CQCPC                      Scalar 5630     R(4)            4           scalar   COM                                                
 DATEX                      Common 5636                                 30                                                          
 DHR                        Scalar 5613     R(4)            4     1     999      COM                                                
 DIR                        Scalar 5627     R(4)            4     1     255      COM                                                
 ELV                        Scalar 5614     R(4)            4     1     999      COM                                                
 GESPS                      Scalar 5622     R(4)            4     1     999      COM                                                
 GETINC                     Subr   5605                                                                                             
 HEADER                     Common 5613                                 35980                                                       
 HRDR                       Scalar 5622     R(4)            4     1     255      COM                                                
 IANGFC                     Local  5713     I(4)            4           scalar                    5713                              
 IANGOB                     Local  5712     I(4)            4           scalar                    5712                              
 IMISS                      Scalar 5637     I(4)            4           scalar   COM                                                
 INC                        Common 5631                                 5100                                                        
 INCW                       Common 5632                                 4080                                                        
 IND                        Scalar 5621     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 5630     I(4)            4           scalar   COM                                                
 IS                         Scalar 5635     I(4)            4           scalar   COM              5678,5727                         
 ISC                        Scalar 5630     I(4)            4           scalar   COM                                                
 ISERR                      Scalar 5633     L(4)            4           scalar   COM              5677,5726                         
 ISF                        Scalar 5615     I(4)            4     1     999      COM                                                
 ISOBERR                    Scalar 5633     L(4)            4           scalar   COM                                                
 ITP                        Scalar 5614     I(4)            4     1     999      COM                                                
 JDATE                      Scalar 5636     I(4)            4     1     5        COM                                                
 L                          Local  5665     I(4)            4           scalar                    5665,5668,5669,5672,5673,5674,5678
                                                                                                  ,5679,5686,5693,5694,5695,5696,569
                                                                                                  7,5698,5700,5701,5706,5707,5714,57
                                                                                                  15,5727                           
 LEVTYP                     Scalar 5621     I(4)            4     1     255      COM                                                

Page 183         Source Listing                  GETINC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LMAND                      Scalar 5630     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 5630     I(4)            4           scalar   COM                                                
 LST                        Scalar 5622     I(4)            4     1     255      COM                                                
 LTP                        Common 5634                                 27544                                                       
 LVRC                       Scalar 5634     L(4)            4     2     2295     COM                                                
 LVRCALL                    Scalar 5634     L(4)            4           scalar   COM                                                
 LVTYP                      Scalar 5634     I(4)            4     2     2295     COM              5668,5672,5693,5695               
 MAND                       Scalar 5629     I(4)            4           scalar   COM                                                
 NCH                        Scalar 5634     I(4)            4     2     2295     COM                                                
 NEV                        Scalar 5615     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 5629     I(4)            4           scalar   COM                                                
 NLV                        Scalar 5614     I(4)            4           scalar   COM              5665,5686                         
 NLVM                       Scalar 5615     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 5615     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 5629     I(4)            4           scalar   COM                                                
 NST                        Param  5606     I(4)            4           scalar                    5613,5614,5615,5622               
 PARAMS                     Common 5629                                 148                                                         
 PEROR                      Common 5633                                 8                                                           
 PFC                        Scalar 5616     R(4)            4     1     255      COM                                                
 PFCW                       Scalar 5624     R(4)            4     1     255      COM                                                
 PNC                        Scalar 5631     R(4)            4     1     255      COM              5645,5678                         
 PNCW                       Scalar 5632     R(4)            4     1     255      COM              5650,5727                         
 POB                        Scalar 5616     R(4)            4     1     255      COM              5678                              
 POBW                       Scalar 5624     R(4)            4     1     255      COM              5727                              
 PQM                        Scalar 5616     R(4)            4     1     255      COM                                                
 PQMW                       Scalar 5624     R(4)            4     1     255      COM                                                
 PRC                        Scalar 5616     R(4)            4     1     255      COM                                                
 PRCW                       Scalar 5624     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 5630     L(4)            4           scalar   COM                                                
 PS                         Scalar 5622     R(4)            4     1     999      COM                                                
 QFC                        Scalar 5620     R(4)            4     1     255      COM                                                
 QNC                        Scalar 5631     R(4)            4     1     255      COM              5647,5678                         
 QOB                        Scalar 5620     R(4)            4     1     255      COM                                                
 QQM                        Scalar 5620     R(4)            4     1     255      COM                                                
 QRC                        Scalar 5620     R(4)            4     1     255      COM                                                
 RADPC                      Scalar 5629     R(4)            4           scalar   COM                                                
 SID                        Scalar 5611     CHAR            8     1     999      COM              5678,5727                         
 SP                         Scalar 5627     R(4)            4     1     255      COM                                                
 SPFC                       Local  5715     R(4)            4           scalar                    5715                              
 SPOB                       Local  5714     R(4)            4           scalar                    5714                              
 SQN                        Scalar 5614     R(4)            4     1     999      COM                                                
 SQRT                       Func   5698                                 scalar                    5698,5714,5715                    
 START                      Local  5639     L(4)            4           scalar                    5640,5654,5656                    
 STN                        Common 5635                                 4                                                           
 TDFC                       Scalar 5619     R(4)            4     1     255      COM              5673,5674                         
 TDNC                       Scalar 5631     R(4)            4     1     255      COM              5648,5674,5678                    
 TDO                        Scalar 5619     R(4)            4     1     255      COM              5672,5674                         
 TFC                        Scalar 5618     R(4)            4     1     255      COM              5669                              
 TNC                        Scalar 5631     R(4)            4     1     255      COM              5646,5669,5678                    
 TOB                        Scalar 5618     R(4)            4     1     255      COM              5668,5669,5673,5674               
 TQM                        Scalar 5618     R(4)            4     1     255      COM                                                
 TRC                        Scalar 5618     R(4)            4     1     255      COM                                                
 TT                         Scalar 5630     R(4)            4           scalar   COM                                                
 TVO                        Scalar 5619     R(4)            4     1     255      COM                                                
 UFC                        Scalar 5626     R(4)            4     1     255      COM              5694,5706,5707,5715               

Page 184         Source Listing                  GETINC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UNC                        Scalar 5632     R(4)            4     1     255      COM              5652,5694,5697,5698,5727          
 UOB                        Scalar 5626     R(4)            4     1     255      COM              5693,5694,5700,5701,5714          
 VFC                        Scalar 5626     R(4)            4     1     255      COM              5696,5706,5707,5715               
 VNC                        Scalar 5632     R(4)            4     1     255      COM              5653,5696,5697,5698,5727          
 VOB                        Scalar 5626     R(4)            4     1     255      COM              5695,5696,5700,5701,5714          
 VTPPC                      Scalar 5629     R(4)            4           scalar   COM                                                
 WIND                       Dummy  5605     L(4)            4           scalar   ARG,INOUT        5664                              
 WNC                        Local  5698     R(4)            4           scalar                    5698,5699                         
 WQM                        Scalar 5627     R(4)            4     1     255      COM                                                
 WRC                        Scalar 5627     R(4)            4     1     255      COM                                                
 XDR                        Scalar 5623     R(4)            4     1     255      COM                                                
 XMA                        Scalar 5629     R(4)            4           scalar   COM                                                
 XMI                        Scalar 5629     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 5637     R(4)            4           scalar   COM                                                
 XOB                        Scalar 5613     R(4)            4     1     999      COM                                                
 YDR                        Scalar 5623     R(4)            4     1     255      COM                                                
 YMA                        Scalar 5629     R(4)            4           scalar   COM                                                
 YMI                        Scalar 5629     R(4)            4           scalar   COM                                                
 YOB                        Scalar 5613     R(4)            4     1     999      COM                                                
 ZFC                        Scalar 5617     R(4)            4     1     255      COM                                                
 ZFCW                       Scalar 5625     R(4)            4     1     255      COM                                                
 ZNC                        Scalar 5631     R(4)            4     1     255      COM              5649,5679                         
 ZNCW                       Scalar 5632     R(4)            4     1     255      COM              5651,5727                         
 ZOB                        Scalar 5617     R(4)            4     1     255      COM                                                
 ZOBW                       Scalar 5625     R(4)            4     1     255      COM                                                
 ZQM                        Scalar 5617     R(4)            4     1     255      COM                                                
 ZQMW                       Scalar 5625     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 5617     R(4)            4     1     255      COM                                                
 ZRCW                       Scalar 5625     R(4)            4     1     255      COM                                                

Page 185         Source Listing                  GETINC
2017-04-18 11:07                                 cqcbufr.f

   5736 
   5737 C*****************************************************************
   5738 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5739 C                .      .    .                                       .
   5740 C SUBPROGRAM:    GETLEV      DETERMINE LEVELS OF ORIGINAL DATA
   5741 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1995-12-18
   5742 C
   5743 C ABSTRACT: DETERMINE THE LEVELS OF ORIGINAL DATA.  THE LEVELS WILL BE
   5744 C   USED ONLY IF THE ORIGINAL QUALITY WAS GOOD, OR THE MODIFIED VALUES
   5745 C   ARE JUDGED TO BE GOOD.  ALL "TRUE DATA LEVELS", I.E. LEVELS AT
   5746 C   WHICH DATA WAS ACTUALLY OBSERVED.
   5747 C
   5748 C PROGRAM HISTORY LOG:
   5749 C 1995-12-18  W. Collins  Original author.
   5750 C 1997-05-12  W. Collins  Add LVRC.
   5751 C 1997-07-23  W. Collins  For height, add CAT=4 to list making LVRC
   5752 C     .TRUE.
   5753 C
   5754 C USAGE:    CALL GETLEV(WIND)
   5755 C   INPUT ARGUMENT LIST:
   5756 C     WIND     - .TRUE. FOR WIND PART OF REPORT, .FALSE. OTHERWISE
   5757 C
   5758 C   OUTPUT FILES:
   5759 C     UNIT 06  - PRINTOUT
   5760 C
   5761 C REMARKS: NONE.
   5762 C
   5763 C ATTRIBUTES:
   5764 C   LANGUAGE: FORTRAN 90
   5765 C   MACHINE:  NCEP WCOSS
   5766 C
   5767 C$$$
   5768 
   5769 C  INDIVIDUALLY FOR PRESSURE, TEMPERATURE, MOISTURE, AND HEIGHT,
   5770 C  DETERMINE THE LEVELS OF ORIGINAL DATA.  THE LEVELS WILL BE USED
   5771 C  ONLY IF THE ORIGINAL QUALITY WAS GOOD, OR THE MODIFIED VALUES
   5772 C  ARE JUDGED TO BE GOOD.
   5773 C  LVTYP, FIRST INDEX:  = 1   PRESSURE     \
   5774 C                       = 2   TEMPERATURE   | MASS PART
   5775 C                       = 3   SPEC HUM      |
   5776 C                       = 4   DEW PT TEMP   |
   5777 C                       = 5   HEIGHT       /
   5778 C
   5779 C                       = 6   PRESSURE     \
   5780 C                       = 7   U-COMPONENT   | WIND PART
   5781 C                       = 8   V-COMPONENT   |
   5782 C                       = 9   HEIGHT       /
   5783 C
   5784 C  LVTYP  = 1 FOR ORIGINAL DATA LEVELS WITH GOOD QUALITY
   5785 C         = 0 OTHERWISE
   5786 C
   5787 C  LVRC   = .TRUE. FOR AUXILIARY LEVELS
   5788 C         = .FALSE. OTHERWISE
   5789 C
   5790 
   5791       SUBROUTINE GETLEV(WIND)
   5792       PARAMETER (NST=999)

Page 186         Source Listing                  GETLEV
2017-04-18 11:07                                 cqcbufr.f

   5793 
   5794       REAL(8) BMISS
   5795 
   5796       LOGICAL WIND
   5797       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   5798      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   5799      &                 NEV, ISF(NST), NLVM, NLVW
   5800       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   5801      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   5802      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   5803      &                 TDO(255), TDFC(255),TVO(255),
   5804      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   5805      &                 CAT(255), IND(255), LEVTYP(255),
   5806      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   5807      &                 YDR(255), XDR(255)
   5808       COMMON /ALSNDW/ POBW(255),PFCW(255),PQMW(255),PRCW(255),
   5809      &                ZOBW(255),ZFCW(255),ZQMW(255),ZRCW(255),
   5810      &                UOB(255),VOB(255),UFC(255),VFC(255),
   5811      &                WQM(255),WRC(255),SP(255), DIR(255),
   5812      &                CATW(255)
   5813       COMMON /PEROR/  ISERR, ISOBERR
   5814       COMMON /LTP/    LVTYP(9,255), NCH(9,255), LVRC(9,255), LVRCALL
   5815       COMMON /STN/     IS
   5816       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5817 
   5818       LOGICAL ISERR, LVRC, ISOBERR, PRNT, LVRCALL
   5819       CHARACTER*8     SID
   5820       LVTYP = 0
   5821       LVRC = .FALSE.
   5822       LVRCALL = .FALSE.
   5823       IF(.NOT. WIND) THEN
   5824 
   5825 C  MASS PART OF REPORT
   5826 C  -------------------
   5827 
   5828         IPR = 0
   5829         DO L=1,NLV
   5830           LCAT = CAT(L)
   5831           IF(ISERR) THEN
   5832             IPR = IPR + 1
   5833             IF(IPR.EQ.1) WRITE(6,502)
   5834           ENDIF
   5835 
   5836 C  LVRC = .true. if the level is an auxiliary level
   5837 C       = .false. otherwise
   5838 C  ------------------------------------------------
   5839 
   5840           LVRC(1,L) = PRC(L).EQ.101. .OR. PRC(L).EQ.103.
   5841      &                .OR. PRC(L).EQ.105.
   5842           LVRC(2,L) = TRC(L).EQ.101. .OR. TRC(L).EQ.102.
   5843      &                .OR. TRC(L).EQ.103.
   5844           LVRC(3,L) = QRC(L).EQ.101. .OR. QRC(L).EQ.102.
   5845      &                .OR. QRC(L).EQ.103.
   5846           LVRC(4,L) = QRC(L).EQ.101. .OR. QRC(L).EQ.102.
   5847      &                .OR. QRC(L).EQ.103.
   5848           LVRC(5,L) = ZRC(L).EQ.101. .OR. ZRC(L).EQ.103.
   5849      &                .OR. CAT(L).EQ.4.

Page 187         Source Listing                  GETLEV
2017-04-18 11:07                                 cqcbufr.f

   5850           DO I=1,5
   5851             IF(LVRC(I,L)) LVRCALL = .TRUE.
   5852           ENDDO
   5853           IF(.NOT.LVRCALL) RETURN
   5854 
   5855 C  LVTYP = 1 iff variable is not missing and
   5856 C                variable is not auxiliary (shown by rc) and
   5857 C                quality is good
   5858 C        = 0 otherwise
   5859 C  ----------------------------------------------------------
   5860 
   5861           IF(POB(L).NE.BMISS  .AND. .NOT.LVRC(1,L) .AND.
   5862      &      (PQM(L).LE.2 .OR. PQM(L).GT.15)) LVTYP(1,L) = 1
   5863           IF(TOB(L).NE.BMISS  .AND. .NOT.LVRC(2,L) .AND.
   5864      &      (TQM(L).LE.2 .OR. TQM(L).GT.15)) LVTYP(2,L) = 1
   5865           IF(QOB(L).NE.BMISS  .AND. .NOT.LVRC(2,L) .AND.
   5866      &      (QQM(L).LE.2 .OR. QQM(L).GT.15)) LVTYP(3,L) = 1
   5867           IF(TDO(L).NE.BMISS .AND. .NOT.LVRC(2,L) .AND.
   5868      &      (QQM(L).LE.2 .OR. QQM(L).GT.15)) LVTYP(4,L) = 1
   5869           IF(ZOB(L).NE.BMISS  .AND. .NOT.LVRC(5,L) .AND.
   5870      &      (ZQM(L).LE.2 .OR. ZQM(L).GT.15)) LVTYP(5,L) = 1
   5871           IF(ISERR) THEN
   5872             WRITE(6,500) SID(IS),NLV,L,POB(L),LCAT,(LVTYP(I,L),I=1,5),
   5873      &                   (LVRC(J,L),J=1,5)
   5874   500       FORMAT(10X,A8,2X,2I5,F8.1,I5,5I3,2X,5(1X,L1))
   5875   502       FORMAT(' GETLEV--   SID       NLV    L     POB LCAT',
   5876      &        '-----LVTYPs----  ---LVRCs--')
   5877           ENDIF
   5878         ENDDO
   5879 
   5880       ELSE
   5881 
   5882 C  WIND PART OF REPORT
   5883 C  -------------------
   5884 
   5885         IPR = 0
   5886         DO L=1,NLV
   5887 
   5888           LCAT = CAT(L)
   5889           LPRC = PRCW(L)
   5890           LWRC = WRC(L)
   5891           LZRC = ZRCW(L)
   5892           IF(ISERR) THEN
   5893             IPR = IPR + 1
   5894             IF(IPR.EQ.1) WRITE(6,501)
   5895           ENDIF
   5896 
   5897           LVRC(6,L) = PRC(L).EQ.101. .OR. PRC(L).EQ.103.
   5898      &                .OR. PRC(L).EQ.105.
   5899           LVRC(7,L) = WRC(L).EQ.101. .OR. WRC(L).EQ.102.
   5900      &                .OR. WRC(L).EQ.103.
   5901           LVRC(8,L) = WRC(L).EQ.101. .OR. WRC(L).EQ.102.
   5902      &                .OR. WRC(L).EQ.103.
   5903           LVRC(9,L) = ZRC(L).EQ.101. .OR. ZRC(L).EQ.103.
   5904           DO I=6,9
   5905             IF(LVRC(I,L)) LVRCALL = .TRUE.
   5906           ENDDO

Page 188         Source Listing                  GETLEV
2017-04-18 11:07                                 cqcbufr.f

   5907           IF(.NOT.LVRCALL) RETURN
   5908 
   5909           IF(LCAT.EQ.1 .OR. LCAT.EQ.3 .OR.
   5910      &        LCAT.EQ.4 .OR. LCAT.EQ.5) THEN
   5911             IF(POBW(L).NE.BMISS .AND. .NOT.LVRC(6,L) .AND.
   5912      &        (PQM(L).LE.2 .OR. PQM(L).GT.15)) LVTYP(6,L) = 1
   5913             IF(UOB(L).NE.BMISS .AND. .NOT.LVRC(7,L) .AND.
   5914      &        (WQM(L).LE.2 .OR. WQM(L).GT.15)) LVTYP(7,L) = 1
   5915             IF(VOB(L).NE.BMISS .AND. .NOT.LVRC(8,L) .AND.
   5916      &        (WQM(L).LE.2 .OR. WQM(L).GT.15)) LVTYP(8,L) = 1
   5917             IF(ZOBW(L).NE.BMISS .AND. .NOT.LVRC(9,L) .AND.
   5918      &        (ZQM(L).LE.2 .OR. ZQM(L).GT.15)) LVTYP(9,L) = 1
   5919           ENDIF
   5920           IF(ISERR) THEN
   5921             WRITE(6,503) SID(IS),NLV,L,POB(L),LCAT,LPRC,LWRC,LZRC,
   5922      &        (LVTYP(I,L),I=6,9),(LVRC(J,L),J=6,9)
   5923   501       FORMAT(' GETLEV--   SID       NLV    L     POB LCAT',
   5924      &        '  PRC  WRC  ZRC-----LVTYPs----  ---LVRCs--')
   5925   503       FORMAT(10X,A8,2X,2I5,F8.1,4I5,4I3,2X,5(1X,L1))
   5926           ENDIF
   5927         ENDDO
   5928 
   5929       ENDIF
   5930 
   5931       RETURN
   5932       END


ENTRY POINTS

  Name               
                     
 getlev_             

Page 189         Source Listing                  GETLEV
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  5874                                                           5872                              
 501                        Label  5923                                                           5894                              
 502                        Label  5875                                                           5833                              
 503                        Label  5925                                                           5921                              
 ALLSND                     Common 5800                                 34512                                                       
 ALSNDW                     Common 5808                                 17340                                                       
 BMISS                      Scalar 5794     R(8)            8           scalar   COM              5861,5863,5865,5867,5869,5911,5913
                                                                                                  ,5915,5917                        
 BUFRLIB_MISSING            Common 5816                                 16                                                          
 CAT                        Scalar 5805     R(4)            4     1     255      COM              5830,5849,5888                    
 CATW                       Scalar 5812     R(4)            4     1     255      COM                                                
 DHR                        Scalar 5797     R(4)            4     1     999      COM                                                
 DIR                        Scalar 5811     R(4)            4     1     255      COM                                                
 ELV                        Scalar 5798     R(4)            4     1     999      COM                                                
 GESPS                      Scalar 5806     R(4)            4     1     999      COM                                                
 GETLEV                     Subr   5791                                                                                             
 HEADER                     Common 5797                                 35980                                                       
 HRDR                       Scalar 5806     R(4)            4     1     255      COM                                                
 I                          Local  5850     I(4)            4           scalar                    5850,5851,5872,5904,5905,5922     
 IMISS                      Scalar 5816     I(4)            4           scalar   COM                                                
 IND                        Scalar 5805     I(4)            4     1     255      COM                                                
 IPR                        Local  5828     I(4)            4           scalar                    5828,5832,5833,5885,5893,5894     
 IS                         Scalar 5815     I(4)            4           scalar   COM              5872,5921                         
 ISERR                      Scalar 5813     L(4)            4           scalar   COM              5831,5871,5892,5920               
 ISF                        Scalar 5799     I(4)            4     1     999      COM                                                
 ISOBERR                    Scalar 5813     L(4)            4           scalar   COM                                                
 ITP                        Scalar 5798     I(4)            4     1     999      COM                                                
 J                          Local  5873     I(4)            4           scalar                    5873,5922                         
 L                          Local  5829     I(4)            4           scalar                    5829,5830,5840,5841,5842,5843,5844
                                                                                                  ,5845,5846,5847,5848,5849,5851,586
                                                                                                  1,5862,5863,5864,5865,5866,5867,58
                                                                                                  68,5869,5870,5872,5873,5886,5888,5
                                                                                                  889,5890,5891,5897,5898,5899,5900,
                                                                                                  5901,5902,5903,5905,5911,5912,5913
                                                                                                  ,5914,5915,5916,5917,5918,5921,592
                                                                                                  2                                 
 LCAT                       Local  5830     I(4)            4           scalar                    5830,5872,5888,5909,5910,5921     
 LEVTYP                     Scalar 5805     I(4)            4     1     255      COM                                                
 LPRC                       Local  5889     I(4)            4           scalar                    5889,5921                         
 LST                        Scalar 5806     I(4)            4     1     255      COM                                                
 LTP                        Common 5814                                 27544                                                       
 LVRC                       Scalar 5814     L(4)            4     2     2295     COM              5821,5840,5842,5844,5846,5848,5851
                                                                                                  ,5861,5863,5865,5867,5869,5873,589
                                                                                                  7,5899,5901,5903,5905,5911,5913,59
                                                                                                  15,5917,5922                      
 LVRCALL                    Scalar 5814     L(4)            4           scalar   COM              5822,5851,5853,5905,5907          
 LVTYP                      Scalar 5814     I(4)            4     2     2295     COM              5820,5862,5864,5866,5868,5870,5872
                                                                                                  ,5912,5914,5916,5918,5922         
 LWRC                       Local  5890     I(4)            4           scalar                    5890,5921                         
 LZRC                       Local  5891     I(4)            4           scalar                    5891,5921                         
 NCH                        Scalar 5814     I(4)            4     2     2295     COM                                                

Page 190         Source Listing                  GETLEV
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NEV                        Scalar 5799     I(4)            4           scalar   COM                                                
 NLV                        Scalar 5798     I(4)            4           scalar   COM              5829,5872,5886,5921               
 NLVM                       Scalar 5799     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 5799     I(4)            4           scalar   COM                                                
 NST                        Param  5792     I(4)            4           scalar                    5797,5798,5799,5806               
 PEROR                      Common 5813                                 8                                                           
 PFC                        Scalar 5800     R(4)            4     1     255      COM                                                
 PFCW                       Scalar 5808     R(4)            4     1     255      COM                                                
 POB                        Scalar 5800     R(4)            4     1     255      COM              5861,5872,5921                    
 POBW                       Scalar 5808     R(4)            4     1     255      COM              5911                              
 PQM                        Scalar 5800     R(4)            4     1     255      COM              5862,5912                         
 PQMW                       Scalar 5808     R(4)            4     1     255      COM                                                
 PRC                        Scalar 5800     R(4)            4     1     255      COM              5840,5841,5897,5898               
 PRCW                       Scalar 5808     R(4)            4     1     255      COM              5889                              
 PRNT                       Local  5818     L(4)            4           scalar                                                      
 PS                         Scalar 5806     R(4)            4     1     999      COM                                                
 QFC                        Scalar 5804     R(4)            4     1     255      COM                                                
 QOB                        Scalar 5804     R(4)            4     1     255      COM              5865                              
 QQM                        Scalar 5804     R(4)            4     1     255      COM              5866,5868                         
 QRC                        Scalar 5804     R(4)            4     1     255      COM              5844,5845,5846,5847               
 SID                        Scalar 5797     CHAR            8     1     999      COM              5872,5921                         
 SP                         Scalar 5811     R(4)            4     1     255      COM                                                
 SQN                        Scalar 5798     R(4)            4     1     999      COM                                                
 STN                        Common 5815                                 4                                                           
 TDFC                       Scalar 5803     R(4)            4     1     255      COM                                                
 TDO                        Scalar 5803     R(4)            4     1     255      COM              5867                              
 TFC                        Scalar 5802     R(4)            4     1     255      COM                                                
 TOB                        Scalar 5802     R(4)            4     1     255      COM              5863                              
 TQM                        Scalar 5802     R(4)            4     1     255      COM              5864                              
 TRC                        Scalar 5802     R(4)            4     1     255      COM              5842,5843                         
 TVO                        Scalar 5803     R(4)            4     1     255      COM                                                
 UFC                        Scalar 5810     R(4)            4     1     255      COM                                                
 UOB                        Scalar 5810     R(4)            4     1     255      COM              5913                              
 VFC                        Scalar 5810     R(4)            4     1     255      COM                                                
 VOB                        Scalar 5810     R(4)            4     1     255      COM              5915                              
 WIND                       Dummy  5791     L(4)            4           scalar   ARG,INOUT        5823                              
 WQM                        Scalar 5811     R(4)            4     1     255      COM              5914,5916                         
 WRC                        Scalar 5811     R(4)            4     1     255      COM              5890,5899,5900,5901,5902          
 XDR                        Scalar 5807     R(4)            4     1     255      COM                                                
 XMISS                      Scalar 5816     R(4)            4           scalar   COM                                                
 XOB                        Scalar 5797     R(4)            4     1     999      COM                                                
 YDR                        Scalar 5807     R(4)            4     1     255      COM                                                
 YOB                        Scalar 5797     R(4)            4     1     999      COM                                                
 ZFC                        Scalar 5801     R(4)            4     1     255      COM                                                
 ZFCW                       Scalar 5809     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 5801     R(4)            4     1     255      COM              5869                              
 ZOBW                       Scalar 5809     R(4)            4     1     255      COM              5917                              
 ZQM                        Scalar 5801     R(4)            4     1     255      COM              5870,5918                         
 ZQMW                       Scalar 5809     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 5801     R(4)            4     1     255      COM              5848,5903                         
 ZRCW                       Scalar 5809     R(4)            4     1     255      COM              5891                              

Page 191         Source Listing                  GETLEV
2017-04-18 11:07                                 cqcbufr.f

   5933 
   5934 C*************************************************************
   5935 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5936 C                .      .    .                                       .
   5937 C SUBPROGRAM:    GETOB       READ DATA FOR 1 OBSERVATION
   5938 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   5939 C
   5940 C ABSTRACT: Read data for a single observation. Place the date in OBS.
   5941 C
   5942 C PROGRAM HISTORY LOG:
   5943 C 1997-03-18  W. Collins  Original author.
   5944 C
   5945 C USAGE:    CALL GETOB(LUBFR,MP,HDR_8,NLEV,CAT,HRDR,YDR,XDR,OBS)
   5946 C   INPUT ARGUMENT LIST:
   5947 C     LUBFR    - UNIT NO. OF INPUT PREPBUFR FILE
   5948 C     MP       - PROCESSING STAGE AT WHICH DATA IS RETURNED:
   5949 C                0 - FINAL VALUES
   5950 C                1 - PREPRO
   5951 C                2 - SYNDATA
   5952 C                3 - CLIMO
   5953 C                4 - PREVENT
   5954 C                5 - CQCHT
   5955 C                6 - RADCOR
   5956 C                7 - PREPACQC
   5957 C                8 - VIRTMP
   5958 C                9 - OIQC
   5959 C                10 - SSI  (list valid as of 3/97)
   5960 C     HDR_8    - HEADER
   5961 C     NLEV     - NUMBER OF OBSERVATION LEVELS
   5962 C     CAT      - ARRAY OF CATEGORY BY LEVEL
   5963 C     HRDR     - ARRAY OF BALLOON DRIFT D-TIME BY LEVEL
   5964 C     YDR      - ARRAY OF BALLOON DRIFT LATITUDE BY LEVEL
   5965 C     XDR      - ARRAY OF BALLOON DRIFT LONGITUDE BY LEVEL
   5966 C
   5967 C   OUTPUT ARGUMENT LIST:
   5968 C     OBS      - ARRAY OF OBSERVATIONS
   5969 C
   5970 C   OUTPUT FILES:
   5971 C     UNIT LUBFR  - UNIT NUMBER OF PREPBUFR FILE
   5972 C
   5973 C REMARKS: NONE.
   5974 C
   5975 C ATTRIBUTES:
   5976 C   LANGUAGE: FORTRAN 90
   5977 C   MACHINE:  NCEP WCOSS
   5978 C
   5979 C$$$
   5980 
   5981       SUBROUTINE GETOB(LUBFR,MP,HDR_8,NLEV,CAT,HRDR,YDR,XDR,OBS)
   5982 
   5983 C     THIS SUBROUTINE RETURNS ALL EVENTS FOR AN OBSERVATION
   5984 
   5985       PARAMETER (MVO=5)        ! p,T,z,q,Td
   5986       PARAMETER (MVR=10)       ! dimensions of header
   5987       PARAMETER (MLV=255)      ! number of possible levels
   5988       PARAMETER (MEV=13)       ! number of possible events
   5989 

Page 192         Source Listing                  GETOB
2017-04-18 11:07                                 cqcbufr.f

   5990       REAL(8) BMISS,HDR_8(MVR),EVR_8(MVO,MLV,MEV,5),CAT_8(MLV),
   5991      &        HRDR_8(MLV),XDR_8(MLV),YDR_8(MLV)
   5992 
   5993 C     Last index of EVR_8: value, fcst value, quality mark, program
   5994 C     code, reason code
   5995 C     Last index of OBS: value, fcst value, quality mark, reason code.
   5996 
   5997       CHARACTER*50 HDSTR, OBSTR(2,5)
   5998       DIMENSION    OBS(MVO,MLV,0:MEV,4),CAT(MLV),HRDR(MLV),XDR(MLV),
   5999      &             YDR(MLV)
   6000       INTEGER      IORDER(0:13)
   6001 
   6002       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   6003 
   6004       DATA IORDER /0,1,2,3,4,7,5,11,12,6,8,9,10,13/
   6005       DATA HDSTR /'SID XOB YOB DHR ELV ITP TYP T29 SQN'/
   6006       DATA OBSTR /'POB TOB ZOB QOB TDO' , 'POB UOB VOB ZOB ZOB',
   6007      &            'PFC TFC ZFC QFC QFC' , 'PFC UFC VFC ZFC ZFC',
   6008      &            'PQM TQM ZQM QQM QQM' , 'PQM WQM WQM ZQM ZQM',
   6009      &            'PPC TPC ZPC QPC QPC' , 'PPC WPC WPC ZPC ZPC',
   6010      &            'PRC TRC ZRC QRC QRC' , 'PRC WRC WRC ZRC ZRC'/
   6011 
   6012       EVR_8 = BMISS
   6013       OBS = BMISS
   6014 
   6015 C  READ HEADER
   6016 C  -----------
   6017 
   6018       CALL UFBINT(LUBFR,HDR_8,MVR,1,IRET,HDSTR)
   6019       JKX = INT(HDR_8(7))/100
   6020 
   6021 C  GET BALLOON DRIFT INFORMATION
   6022 C  -----------------------------
   6023 
   6024       CALL UFBINT(LUBFR,HRDR_8,1,MLV,NLEV,'HRDR');HRDR=HRDR_8
   6025       CALL UFBINT(LUBFR,YDR_8,1,MLV,NLEV,'YDR');YDR=YDR_8
   6026       CALL UFBINT(LUBFR,XDR_8,1,MLV,NLEV,'XDR');XDR=XDR_8
   6027 
   6028 C  GET LEVEL CATEGORIES
   6029 C  --------------------
   6030 
   6031       CALL UFBINT(LUBFR,CAT_8,1,MLV,NLEV,'CAT');CAT=CAT_8
   6032       NLEV = MIN(255,NLEV)
   6033 
   6034 C  READ EVENTS
   6035 C  -----------
   6036 
   6037       IF(MP.EQ.0) THEN
   6038         DO K=1,3
   6039           CALL UFBINT(LUBFR,EVR_8(1,1,1,K),MVO,MLV,NLV,OBSTR(JKX,K))
   6040           DO J=1,NLEV
   6041             DO I=1,MVO
   6042               OBS(I,J,MP,K) = EVR_8(I,J,1,K)
   6043             ENDDO
   6044           ENDDO
   6045         ENDDO
   6046         K = 5

Page 193         Source Listing                  GETOB
2017-04-18 11:07                                 cqcbufr.f

   6047         CALL UFBINT(LUBFR,EVR_8(1,1,1,K),MVO,MLV,NLV,OBSTR(JKX,K))
   6048         DO J=1,NLEV
   6049           DO I=1,MVO
   6050             OBS(I,J,MP,4) = EVR_8(I,J,1,K)
   6051           ENDDO
   6052         ENDDO
   6053       ELSE
   6054         DO I=1,5
   6055           CALL UFBEVN(LUBFR,EVR_8(1,1,1,I),MVO,MLV,MEV,NLV,OBSTR(JKX,I))
   6056           IF(NLEV.NE.NLV) THEN
   6057             PRINT *, 'NLEVS NOT EQUAL - STOP 99'
   6058             CALL W3TAGE('PREPOBS_CQCBUFR')
   6059             CALL ERREXIT(99)
   6060           ENDIF
   6061         ENDDO
   6062 
   6063 C  EXPAND THE EVENTS INTO A REGULAR ARRAY
   6064 C  --------------------------------------
   6065 
   6066         DO K=1,MEV
   6067           DO J=1,NLEV
   6068             DO I=1,MVO
   6069               IP = NINT(EVR_8(I,J,K,4))
   6070               IF(IP.GE.0 .AND. IP.LE.MEV) THEN
   6071                 IPC = IORDER(IP)
   6072                 OBS(I,J,IPC,1) = EVR_8(I,J,K,1)
   6073                 OBS(I,J,IPC,2) = EVR_8(I,J,K,2)
   6074                 OBS(I,J,IPC,3) = EVR_8(I,J,K,3)
   6075                 OBS(I,J,IPC,4) = EVR_8(I,J,K,5)
   6076               ENDIF
   6077             ENDDO
   6078           ENDDO
   6079         ENDDO
   6080       ENDIF
   6081 
   6082       RETURN
   6083       END

Page 194         Source Listing                  GETOB
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 getob_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 5990     R(8)            8           scalar   COM              6012,6013                         
 BUFRLIB_MISSING            Common 6002                                 16                                                          
 CAT                        Dummy  5981     R(4)            4     1     255      ARG,INOUT        6031                              
 CAT_8                      Local  5990     R(8)            8     1     255                       6031                              
 ERREXIT                    Subr   6059                                                           6059                              
 EVR_8                      Local  5990     R(8)            8     4     82875                     6012,6039,6042,6047,6050,6055,6069
                                                                                                  ,6072,6073,6074,6075              
 GETOB                      Subr   5981                                                                                             
 HDR_8                      Dummy  5981     R(8)            8     1     10       ARG,INOUT        6018,6019                         
 HDSTR                      Local  5997     CHAR            50          scalar                    6005,6018                         
 HRDR                       Dummy  5981     R(4)            4     1     255      ARG,INOUT        6024                              
 HRDR_8                     Local  5991     R(8)            8     1     255                       6024                              
 I                          Local  6041     I(4)            4           scalar                    6041,6042,6049,6050,6054,6055,6068
                                                                                                  ,6069,6072,6073,6074,6075         
 IMISS                      Scalar 6002     I(4)            4           scalar   COM                                                
 INT                        Func   6019                                 scalar                    6019                              
 IORDER                     Local  6000     I(4)            4     1     14                        6004,6071                         
 IP                         Local  6069     I(4)            4           scalar                    6069,6070,6071                    
 IPC                        Local  6071     I(4)            4           scalar                    6071,6072,6073,6074,6075          
 IRET                       Local  6018     I(4)            4           scalar                    6018                              
 J                          Local  6040     I(4)            4           scalar                    6040,6042,6048,6050,6067,6069,6072
                                                                                                  ,6073,6074,6075                   
 JKX                        Local  6019     I(4)            4           scalar                    6019,6039,6047,6055               
 K                          Local  6038     I(4)            4           scalar                    6038,6039,6042,6046,6047,6050,6066
                                                                                                  ,6069,6072,6073,6074,6075         
 LUBFR                      Dummy  5981     I(4)            4           scalar   ARG,INOUT        6018,6024,6025,6026,6031,6039,6047
                                                                                                  ,6055                             
 MEV                        Param  5988     I(4)            4           scalar                    5990,5998,6055,6066,6070          
 MIN                        Func   6032                                 scalar                    6032                              
 MLV                        Param  5987     I(4)            4           scalar                    5990,5991,5998,5999,6024,6025,6026
                                                                                                  ,6031,6039,6047,6055              
 MP                         Dummy  5981     I(4)            4           scalar   ARG,INOUT        6037,6042,6050                    
 MVO                        Param  5985     I(4)            4           scalar                    5990,5998,6039,6041,6047,6049,6055
                                                                                                  ,6068                             
 MVR                        Param  5986     I(4)            4           scalar                    5990,6018                         
 NINT                       Func   6069                                 scalar                    6069                              
 NLEV                       Dummy  5981     I(4)            4           scalar   ARG,INOUT        6024,6025,6026,6031,6032,6040,6048
                                                                                                  ,6056,6067                        
 NLV                        Local  6039     I(4)            4           scalar                    6039,6047,6055,6056               
 OBS                        Dummy  5981     R(4)            4     4     71400    ARG,INOUT        6013,6042,6050,6072,6073,6074,6075
 OBSTR                      Local  5997     CHAR            50    2     10                        6006,6039,6047,6055               
 UFBEVN                     Subr   6055                                                           6055                              
 UFBINT                     Subr   6018                                                           6018,6024,6025,6026,6031,6039,6047
 W3TAGE                     Subr   6058                                                           6058                              

Page 195         Source Listing                  GETOB
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XDR                        Dummy  5981     R(4)            4     1     255      ARG,INOUT        6026                              
 XDR_8                      Local  5991     R(8)            8     1     255                       6026                              
 XMISS                      Scalar 6002     R(4)            4           scalar   COM                                                
 YDR                        Dummy  5981     R(4)            4     1     255      ARG,INOUT        6025                              
 YDR_8                      Local  5991     R(8)            8     1     255                       6025                              

Page 196         Source Listing                  GETOB
2017-04-18 11:07                                 cqcbufr.f

   6084 
   6085 C******************************************************************
   6086 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6087 C                .      .    .                                       .
   6088 C SUBPROGRAM:    GETPS       SOLVE FOR SURFACE PRESSURE
   6089 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   6090 C
   6091 C ABSTRACT:  Solve for surface pressure, given station elevation and
   6092 C   height and temperature at a known mandatory level above. The lapse
   6093 C   rate is specified from U.S. Standard atmosphere.
   6094 C
   6095 C PROGRAM HISTORY LOG:
   6096 C 1997-03-18  W. Collins  Original author.
   6097 C
   6098 C USAGE:    CALL GETPS(PS,ZS,Z1,T1,P1)
   6099 C   INPUT ARGUMENT LIST:
   6100 C     ZS       - STATION ELEVATION (M)
   6101 C     Z1       - HEIGHT AT FIRST MANDATORY LEVEL ABOVE THE SURFACE
   6102 C     T1       - TEMPERATURE AT Z1
   6103 C     P1       - PRESSURE AT Z1
   6104 C
   6105 C   OUTPUT ARGUMENT LIST:
   6106 C     PS       - SURFACE PRESSURE
   6107 C
   6108 C   OUTPUT FILES:
   6109 C     UNIT 06  - PRINTOUT
   6110 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   6111 C
   6112 C REMARKS: NONE.
   6113 C
   6114 C ATTRIBUTES:
   6115 C   LANGUAGE: FORTRAN 90
   6116 C   MACHINE:  NCEP WCOSS
   6117 C
   6118 C$$$
   6119 
   6120       SUBROUTINE GETPS(PS,ZS,Z1,T1,P1)
   6121       COMMON /CONSTS/  R, G, T0, CP, RV
   6122       DATA ALPHA /54./
   6123 
   6124 C  ASSUMPTIONS:
   6125 C     HYDROSTATIC
   6126 C     T = T1 + ALPHA*LN(P/P1)
   6127 C     ALPHA TAKEN FROM STANDARD ATMOSPHERE
   6128 C  ---------------------------------------
   6129 
   6130       GOR = G/R
   6131       TA = T1 + T0
   6132       P1 = ALOG(P1)
   6133       RAD = (TA-ALPHA*P1)**2 + 2.*ALPHA*(-.5*ALPHA*P1**2 +
   6134      &  TA*P1 + GOR*(Z1-ZS))
   6135       IF(RAD.LE.0.) THEN
   6136         RAD = 0.
   6137       ELSE
   6138         RAD = SQRT(RAD)
   6139       ENDIF
   6140       PS = EXP(P1 + (-TA+RAD)/ALPHA)

Page 197         Source Listing                  GETPS
2017-04-18 11:07                                 cqcbufr.f

   6141 
   6142       WRITE(60,500) PS,ZS,Z1,T1,P1
   6143   500 FORMAT(' GETPS--PS,ZS,Z1,T1,P1: ',5F10.1)
   6144 
   6145       RETURN
   6146       END


ENTRY POINTS

  Name              
                    
 getps_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  6143                                                           6142                              
 ALOG                       Func   6132                                 scalar                    6132                              
 ALPHA                      Local  6122     R(4)            4           scalar                    6122,6133,6140                    
 CONSTS                     Common 6121                                 20                                                          
 CP                         Scalar 6121     R(4)            4           scalar   COM                                                
 EXP                        Func   6140                                 scalar                    6140                              
 G                          Scalar 6121     R(4)            4           scalar   COM              6130                              
 GETPS                      Subr   6120                                                                                             
 GOR                        Local  6130     R(4)            4           scalar                    6130,6134                         
 P1                         Dummy  6120     R(4)            4           scalar   ARG,INOUT        6132,6133,6134,6140,6142          
 PS                         Dummy  6120     R(4)            4           scalar   ARG,INOUT        6140,6142                         
 R                          Scalar 6121     R(4)            4           scalar   COM              6130                              
 RAD                        Local  6133     R(4)            4           scalar                    6133,6135,6136,6138,6140          
 RV                         Scalar 6121     R(4)            4           scalar   COM                                                
 SQRT                       Func   6138                                 scalar                    6138                              
 T0                         Scalar 6121     R(4)            4           scalar   COM              6131                              
 T1                         Dummy  6120     R(4)            4           scalar   ARG,INOUT        6131,6142                         
 TA                         Local  6131     R(4)            4           scalar                    6131,6133,6134,6140               
 Z1                         Dummy  6120     R(4)            4           scalar   ARG,INOUT        6134,6142                         
 ZS                         Dummy  6120     R(4)            4           scalar   ARG,INOUT        6134,6142                         

Page 198         Source Listing                  GETPS
2017-04-18 11:07                                 cqcbufr.f

   6147 
   6148 C******************************************************************
   6149 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6150 C                .      .    .                                       .
   6151 C SUBPROGRAM:    HOLES       FIND HOLES IN THE DATA
   6152 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
   6153 C
   6154 C ABSTRACT: Find holes in the data.  A 'hole' is a region between
   6155 C   mandatory levels, where mandatory levels are not complete. There
   6156 C   must be at least 2 levels with incomplete information for it to be
   6157 C   a hole.
   6158 C
   6159 C PROGRAM HISTORY LOG:
   6160 C 1997-03-18  W. Collins  Original author.
   6161 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
   6162 C     were tested for not being equal to real value for missing (BMISS
   6163 C     = 10E10), these integer values can never be equal to BMISS for
   6164 C     I*4 due to overflow - instead they are now tested for not being
   6165 C     equal to new integer value for missing (IMISS, also = 10E10),
   6166 C     although this is also an overflow value for I*4, it results in a
   6167 C     correct evaluation
   6168 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
   6169 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
   6170 C     overflow (also done for IMISS). 
   6171 C
   6172 C USAGE:    CALL HOLES
   6173 C   OUTPUT FILES:
   6174 C     UNIT 61  - PRINTOUT OF 'HOLE' EXTENTS
   6175 C
   6176 C REMARKS: (This subroutine is for
   6177 C           monitoring purposes only and is not needed for running
   6178 C           of PREPOBS_CQCBUFR.)
   6179 C
   6180 C ATTRIBUTES:
   6181 C   LANGUAGE: FORTRAN 90
   6182 C   MACHINE:  NCEP WCOSS
   6183 C
   6184 C$$$
   6185 
   6186       SUBROUTINE HOLES
   6187       PARAMETER (NST=999)
   6188 
   6189       REAL(8) BMISS
   6190 
   6191       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   6192      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   6193      &                 NEV, ISF(NST), NLVM, NLVW
   6194       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   6195      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   6196      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   6197      &                 TDO(255), TDFC(255),TVO(255),
   6198      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   6199      &                 CAT(255), IND(255), LEVTYP(255),
   6200      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   6201      &                 YDR(255), XDR(255)
   6202       COMMON /STN/     IS
   6203       COMMON /DATEX/   JDATE(5), CDATE

Page 199         Source Listing                  HOLES
2017-04-18 11:07                                 cqcbufr.f

   6204       COMMON /TESTS/   TEST
   6205       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   6206 
   6207       LOGICAL          TEST
   6208       CHARACTER*8 SID
   6209       CHARACTER*10    CDATE
   6210 
   6211       LBELOW = BMISS
   6212       LABOVE = BMISS
   6213       LB     = BMISS
   6214       LA     = BMISS
   6215       DO L=1,NLV
   6216         IF(LST(L).EQ.121 .OR. LST(L).EQ.131 .OR.
   6217      &     LST(L).EQ.132 .OR. LST(L).EQ.142 .OR.
   6218      &     LST(L).EQ.133) THEN
   6219 C         IF(TEST) WRITE(61,501) CDATE,SID(IS),MANLEV(POB(L))
   6220   501     FORMAT(1X,A10,2X,A8,I5)
   6221         ENDIF
   6222         IF(CAT(L).EQ.1) THEN
   6223           IF(LST(L).EQ.121 .OR. LST(L).EQ.131) THEN
   6224             LB     = L
   6225             LBELOW = MANLEV(POB(L))
   6226           ENDIF
   6227                             ! LBELOW will never test = bmiss, use imiss
   6228 cdak      IF(LBELOW.NE.BMISS .AND. (LST(L).EQ.133 .OR.
   6229           IF(LBELOW.NE.IMISS .AND. (LST(L).EQ.133 .OR.
   6230      &       LST(L).EQ.132 .OR. LST(L).EQ.142)) THEN
   6231             LA     = L
   6232             LABOVE = MANLEV(POB(L))
   6233             IF(LA.GT.0 .AND. LA.LE.255 .AND.
   6234      &         LB.GT.0 .AND. LB.LE.255) THEN
   6235               IF(TEST) WRITE(61,500) CDATE,SID(IS),LBELOW,LABOVE,
   6236      &          LST(LB),LST(LA)
   6237             ENDIF
   6238   500       FORMAT(1X,A10,2X,A8,4(1X,I4))
   6239             IF(LST(L).EQ.133) THEN
   6240               LB     = LA
   6241               LBELOW = LABOVE
   6242             ELSE
   6243               LB     = BMISS
   6244               LBELOW = BMISS
   6245             ENDIF
   6246             LA     = BMISS
   6247             LABOVE = BMISS
   6248           ENDIF
   6249         ENDIF
   6250       ENDDO
   6251 
   6252       RETURN
   6253       END

Page 200         Source Listing                  HOLES
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 holes_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  6238                                                           6235                              
 501                        Label  6220                                                                                             
 ALLSND                     Common 6194                                 34512                                                       
 BMISS                      Scalar 6189     R(8)            8           scalar   COM              6211,6212,6213,6214,6243,6244,6246
                                                                                                  ,6247                             
 BUFRLIB_MISSING            Common 6205                                 16                                                          
 CAT                        Scalar 6199     R(4)            4     1     255      COM              6222                              
 CDATE                      Scalar 6203     CHAR            10          scalar   COM              6235                              
 DATEX                      Common 6203                                 30                                                          
 DHR                        Scalar 6191     R(4)            4     1     999      COM                                                
 ELV                        Scalar 6192     R(4)            4     1     999      COM                                                
 GESPS                      Scalar 6200     R(4)            4     1     999      COM                                                
 HEADER                     Common 6191                                 35980                                                       
 HOLES                      Subr   6186                                                                                             
 HRDR                       Scalar 6200     R(4)            4     1     255      COM                                                
 IMISS                      Scalar 6205     I(4)            4           scalar   COM              6229                              
 IND                        Scalar 6199     I(4)            4     1     255      COM                                                
 IS                         Scalar 6202     I(4)            4           scalar   COM              6235                              
 ISF                        Scalar 6193     I(4)            4     1     999      COM                                                
 ITP                        Scalar 6192     I(4)            4     1     999      COM                                                
 JDATE                      Scalar 6203     I(4)            4     1     5        COM                                                
 L                          Local  6215     I(4)            4           scalar                    6215,6216,6217,6218,6222,6223,6224
                                                                                                  ,6225,6229,6230,6231,6232,6239    
 LA                         Local  6214     I(4)            4           scalar                    6214,6231,6233,6236,6240,6246     
 LABOVE                     Local  6212     I(4)            4           scalar                    6212,6232,6235,6241,6247          
 LB                         Local  6213     I(4)            4           scalar                    6213,6224,6234,6236,6240,6243     
 LBELOW                     Local  6211     I(4)            4           scalar                    6211,6225,6229,6235,6241,6244     
 LEVTYP                     Scalar 6199     I(4)            4     1     255      COM                                                
 LST                        Scalar 6200     I(4)            4     1     255      COM              6216,6217,6218,6223,6229,6230,6236
                                                                                                  ,6239                             
 MANLEV                     Func   6225     I(4)            4           scalar                    6225,6232                         
 NEV                        Scalar 6193     I(4)            4           scalar   COM                                                
 NLV                        Scalar 6192     I(4)            4           scalar   COM              6215                              
 NLVM                       Scalar 6193     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 6193     I(4)            4           scalar   COM                                                
 NST                        Param  6187     I(4)            4           scalar                    6191,6192,6193,6200               
 PFC                        Scalar 6194     R(4)            4     1     255      COM                                                
 POB                        Scalar 6194     R(4)            4     1     255      COM              6225,6232                         
 PQM                        Scalar 6194     R(4)            4     1     255      COM                                                
 PRC                        Scalar 6194     R(4)            4     1     255      COM                                                
 PS                         Scalar 6200     R(4)            4     1     999      COM                                                
 QFC                        Scalar 6198     R(4)            4     1     255      COM                                                
 QOB                        Scalar 6198     R(4)            4     1     255      COM                                                
 QQM                        Scalar 6198     R(4)            4     1     255      COM                                                

Page 201         Source Listing                  HOLES
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QRC                        Scalar 6198     R(4)            4     1     255      COM                                                
 SID                        Scalar 6191     CHAR            8     1     999      COM              6235                              
 SQN                        Scalar 6192     R(4)            4     1     999      COM                                                
 STN                        Common 6202                                 4                                                           
 TDFC                       Scalar 6197     R(4)            4     1     255      COM                                                
 TDO                        Scalar 6197     R(4)            4     1     255      COM                                                
 TEST                       Scalar 6204     L(4)            4           scalar   COM              6235                              
 TESTS                      Common 6204                                 4                                                           
 TFC                        Scalar 6196     R(4)            4     1     255      COM                                                
 TOB                        Scalar 6196     R(4)            4     1     255      COM                                                
 TQM                        Scalar 6196     R(4)            4     1     255      COM                                                
 TRC                        Scalar 6196     R(4)            4     1     255      COM                                                
 TVO                        Scalar 6197     R(4)            4     1     255      COM                                                
 XDR                        Scalar 6201     R(4)            4     1     255      COM                                                
 XMISS                      Scalar 6205     R(4)            4           scalar   COM                                                
 XOB                        Scalar 6191     R(4)            4     1     999      COM                                                
 YDR                        Scalar 6201     R(4)            4     1     255      COM                                                
 YOB                        Scalar 6191     R(4)            4     1     999      COM                                                
 ZFC                        Scalar 6195     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 6195     R(4)            4     1     255      COM                                                
 ZQM                        Scalar 6195     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 6195     R(4)            4     1     255      COM                                                

Page 202         Source Listing                  HOLES
2017-04-18 11:07                                 cqcbufr.f

   6254 
   6255 C***********************************************************
   6256 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6257 C                .      .    .                                       .
   6258 C SUBPROGRAM:    HORRES      PERFORM HORIZONTAL CHECK
   6259 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   6260 C
   6261 C ABSTRACT: Perform horizontal check, solving for the horizontal
   6262 C   residual.
   6263 C
   6264 C PROGRAM HISTORY LOG:
   6265 C 1997-03-18  W. Collins  Original author.
   6266 C
   6267 C USAGE:    CALL HORRES
   6268 C   OUTPUT FILES:
   6269 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   6270 C
   6271 C REMARKS: NONE.
   6272 C
   6273 C ATTRIBUTES:
   6274 C   LANGUAGE: FORTRAN 90
   6275 C   MACHINE:  NCEP WCOSS
   6276 C
   6277 C$$$
   6278 
   6279       SUBROUTINE HORRES
   6280       PARAMETER (NST=999)
   6281 
   6282       REAL(8) BMISS
   6283 
   6284       REAL             HRES(21,4,NST),HSTD(21,4,NST),
   6285      &                 WTH(4,21,4,NST),OINC(21,4,NST)
   6286       INTEGER          IDH(4,21,4,NST)
   6287       LOGICAL          OG(21,4,NST)
   6288       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   6289      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   6290       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   6291      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   6292      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   6293      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   6294      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   6295      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   6296      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   6297      &                 XTHM(21,NST),XTDVM(21,NST),
   6298      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   6299      &                 XQHM(21,NST),
   6300      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   6301      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   6302       COMMON /STATS/   NV(21,7), AVGV(21,7), STDV(21,7),
   6303      &                 NH(21,7), AVGH(21,7), STDH(21,7),
   6304      &                 NI(21,7), AVGI(21,7), STDI(21,7),
   6305      &                 NT(21,4),  AVGT(21,4), STDT(21,4),
   6306      &                 NHY(21),   AVGHY(21),  STDHY(21),
   6307      &                 NB,        AVGB,       STDB,
   6308      &                 SKV(21,7), XKV(21,7),
   6309      &                 SKH(21,7), XKH(21,7),
   6310      &                 SKI(21,7), XKI(21,7),

Page 203         Source Listing                  HORRES
2017-04-18 11:07                                 cqcbufr.f

   6311      &                 SKT(21,4), XKT(21,4),
   6312      &                 SKHY(21),  XKHY(21),
   6313      &                 SKB,       XKB
   6314       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   6315      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   6316      &                 NEV, ISF(NST), NLVM, NLVW
   6317       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   6318      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   6319      &                 ZCLIM, TCLIM, NHLIM
   6320       COMMON /SERCH/   RSCAN,DELLAT,DELLON(181)
   6321       COMMON /CORP/    CHLP(0:1500),CVC,IFA(4,4)
   6322       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   6323 
   6324       CHARACTER*8      SID,SIDH(4,4),BLANK
   6325       LOGICAL          ZG, TG, TDG, QG, ERROR, PRNT
   6326       DATA PI180/.0174532/, RADE/6371./, MAXDIM/4/
   6327       DATA BLANK /'        '/
   6328 
   6329 
   6330 C  MAKE THE OBSERVATION INDEX MAP
   6331 C  ------------------------------
   6332 
   6333       CALL MIMAP(XOB,YOB,NOBS)
   6334 
   6335 C  SET UP THE SEARCH ARRAYS
   6336 C  ------------------------
   6337 
   6338       RSCAN  = 1000.
   6339       DELLAT = RSCAN/(PI180*RADE)
   6340       DO I=1,181
   6341         BLAT      = I - 91
   6342         COSLAT    = COS(BLAT*PI180)
   6343         DELLON(I) = MIN(DELLAT/COSLAT,180.0)
   6344       ENDDO
   6345 
   6346 C  SYMMETRIC MATRIX STORAGE CHART
   6347 C  ------------------------------
   6348 
   6349       IJ = 1
   6350       DO I = 1,MAXDIM
   6351         DO J = 1,I
   6352           IFA(I,J) = IJ
   6353           IFA(J,I) = IJ
   6354           IJ = IJ + 1
   6355         ENDDO
   6356       ENDDO
   6357 
   6358 C  MAKE A TABLE OF LENGTH SCALES BY MILIBARS
   6359 C  -----------------------------------------
   6360 
   6361       DO I=1,1500
   6362         CHLP(I) = 120.
   6363       ENDDO
   6364 
   6365       CVC = 5.0
   6366 
   6367 C  SET HORIZONTAL RESIDUAL ARRAYS TO MISSING

Page 204         Source Listing                  HORRES
2017-04-18 11:07                                 cqcbufr.f

   6368 C  -----------------------------------------
   6369 
   6370       DO K=1,NST
   6371         DO J=1,4
   6372           DO I=1,21
   6373             HRES(I,J,K) = BMISS
   6374             HSTD(I,J,K) = BMISS
   6375             DO L=1,4
   6376               IDH(L,I,J,K)  = 0
   6377               WTH(L,I,J,K)  = BMISS
   6378             ENDDO
   6379           ENDDO
   6380         ENDDO
   6381       ENDDO
   6382 
   6383 C  PUT INCREMENTS OF Z, T, TD, Q, AND THICKNESS INTO OINC.
   6384 C  ALSO PUT PRELIMINARY ASSESSMENTS INTO OG.
   6385 C  -------------------------------------------------------
   6386 
   6387       DO N=1,NOBS
   6388         DO L=1,MAND
   6389           OINC(L,1,N) = ZIM(L,N)
   6390           OINC(L,2,N) = TIM(L,N)
   6391           OINC(L,3,N) = TDIM(L,N)
   6392           OINC(L,4,N) = QIM(L,N)
   6393           OG(L,1,N)   = ZG(L,N)
   6394           OG(L,2,N)   = TG(L,N)
   6395           OG(L,3,N)   = TDG(L,N)
   6396           OG(L,4,N)   = QG(L,N)
   6397         ENDDO
   6398       ENDDO
   6399 
   6400 C     do n=1,nobs
   6401 C       if(test) WRITE(60,507) sid(n)
   6402 C       do l=1,mand
   6403 C         if(test) WRITE(60,508) pmand(l),(og(l,i,n),i=1,4)
   6404 C       enddo
   6405 C     enddo
   6406   507 format(' HORRES--STATION: ',A8)
   6407   508 format(' HORRES--PRESS,OG: ',F10.1,2X,4L2,' (before search)')
   6408 
   6409 
   6410       CALL SEARCH(21,4,MAND,4,1,NOBS,IDH,OINC,OG)
   6411       CALL QCOI  (21,4,MAND,4,1,NOBS,IDH,OINC,HRES,HSTD,WTH)
   6412 
   6413 C     do n=1,nobs
   6414 C       if(test) WRITE(60,505) sid(n)
   6415 C       do l=1,mand
   6416 C         do j=1,4
   6417 C           do k=1,4
   6418 C             if(idh(j,l,k,n).ne.0) then
   6419 C               sidh(j,k) = sid(idh(j,l,k,n))
   6420 C             else
   6421 C               sidh(j,k) = blank
   6422 C             endif
   6423 C           enddo
   6424 C         enddo

Page 205         Source Listing                  HORRES
2017-04-18 11:07                                 cqcbufr.f

   6425 C         if(test) WRITE(60,500) pmand(l),(sidh(i,1),i=1,4),
   6426 C    &                  (wth(i,l,1,n),i=1,4),og(l,1,n)
   6427 C         if(test) WRITE(60,501) pmand(l),(sidh(i,2),i=1,4),
   6428 C    &                  (wth(i,l,2,n),i=1,4),og(l,2,n)
   6429 C         if(test) WRITE(60,502) pmand(l),(sidh(i,3),i=1,4),
   6430 C    &                  (wth(i,l,3,n),i=1,4),og(l,3,n)
   6431 C         if(test) WRITE(60,503) pmand(l),(sidh(i,4),i=1,4),
   6432 C    &                  (wth(i,l,4,n),i=1,4),og(l,4,n)
   6433 C       enddo
   6434 C     enddo
   6435   500 format(' horres--idh,wth,og for z at: ',f8.0/(4a10,4f8.3,l3))
   6436   501 format(' horres--idh,wth,og for T at: ',f8.0/(4a10,4f8.3,l3))
   6437   502 format(' horres--idh,wth,og for Td at:',f8.0/(4a10,4f8.3,l3))
   6438   503 format(' horres--idh,wth,og for q at: ',f8.0/(4a10,4f8.3,l3))
   6439   505 format(' horres--sid: ',a8)
   6440 
   6441 
   6442 C  PUT RESULTS BACK INTO RESIDUAL ARRAYS
   6443 C  -------------------------------------
   6444 
   6445       DO N=1,NOBS
   6446         DO L=1,MAND
   6447           ZHM(L,N)  = HRES(L,1,N)
   6448           THM(L,N)  = HRES(L,2,N)
   6449           TDHM(L,N) = HRES(L,3,N)
   6450           QHM(L,N)  = HRES(L,4,N)
   6451         ENDDO
   6452       ENDDO
   6453 
   6454 C  CALCULATE NORMALIZED HORIZONTAL RESIDUALS.
   6455 C  ------------------------------------------
   6456 
   6457       DO J=1,NST
   6458         DO I=1,21
   6459           NZHM(I,J)  = -1
   6460           NTHM(I,J)  = -1
   6461           NTDHM(I,J) = -1
   6462           NQHM(I,J)  = -1
   6463 C         XZHM(I,J)  = BMISS
   6464 C         XTHM(I,J)  = BMISS
   6465 C         XTDHM(I,J) = BMISS
   6466 C         XQHM(I,J)  = BMISS
   6467         ENDDO
   6468       ENDDO
   6469       DO N=1,NOBS
   6470         DO L=1,MAND
   6471           IF(ZHM(L,N).LT.BMISS/2) THEN
   6472             NZHM(L,N) = MIN1(20.,20.*ABS(ZHM(L,N))/HOIRES(L,1))
   6473 C           XZHM(L,N) = (ABS(ZHM(L,N))-AVGH(L,1))/STDH(L,1)
   6474           ENDIF
   6475           IF(THM(L,N).LT.BMISS/2) THEN
   6476             NTHM(L,N) = MIN1(20.,20.*ABS(THM(L,N))/HOIRES(L,2))
   6477 C           XTHM(L,N) = (ABS(THM(L,N))-AVGH(L,2))/STDH(L,2)
   6478           ENDIF
   6479           IF(TDHM(L,N).LT.BMISS/2) THEN
   6480             NTDHM(L,N) = MIN1(20.,20.*ABS(TDHM(L,N))/HOIRES(L,3))
   6481 C           XTDHM(L,N) = (ABS(TDHM(L,N))-AVGH(L,3))/STDH(L,3)

Page 206         Source Listing                  HORRES
2017-04-18 11:07                                 cqcbufr.f

   6482           ENDIF
   6483           IF(QHM(L,N).LT.BMISS/2) THEN
   6484             NQHM(L,N) = MIN1(20.,20.*ABS(QHM(L,N))/HOIRES(L,4))
   6485 C           XQHM(L,N) = (ABS(QHM(L,N))-AVGH(L,4))/STDH(L,4)
   6486           ENDIF
   6487         ENDDO
   6488 
   6489 C       if(test) WRITE(60,505) sid(n)
   6490 C       if(test) WRITE(60,506) (zhm(l,n),nzhm(l,n),thm(l,n),nthm(l,n),
   6491 C    &    tdhm(l,n),ntdhm(l,n),qhm(l,n),nqhm(l,n),
   6492 C    &    l=1,mand)
   6493   506   format(' horres--'/'        zhm  nzhm         thm  nthm  ',
   6494      &    '      tdhm ntdhm         qhm  nqhm '/
   6495      &    (1x,4(e10.3,i6,2x)))
   6496 
   6497       ENDDO
   6498 
   6499       RETURN
   6500       END


ENTRY POINTS

  Name               
                     
 horres_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  6435                                                                                             
 501                        Label  6436                                                                                             
 502                        Label  6437                                                                                             
 503                        Label  6438                                                                                             
 505                        Label  6439                                                                                             
 506                        Label  6493                                                                                             
 507                        Label  6406                                                                                             
 508                        Label  6407                                                                                             
 ABS                        Func   6472                                 scalar                    6472,6476,6480,6484               
 AVGB                       Scalar 6307     R(4)            4           scalar   COM                                                
 AVGH                       Scalar 6303     R(4)            4     2     147      COM                                                
 AVGHY                      Scalar 6306     R(4)            4     1     21       COM                                                
 AVGI                       Scalar 6304     R(4)            4     2     147      COM                                                
 AVGT                       Scalar 6305     R(4)            4     2     84       COM                                                
 AVGV                       Scalar 6302     R(4)            4     2     147      COM                                                
 BLANK                      Local  6324     CHAR            8           scalar                    6327                              
 BLAT                       Local  6341     R(4)            4           scalar                    6341,6342                         
 BMISS                      Scalar 6282     R(8)            8           scalar   COM              6373,6374,6377,6471,6475,6479,6483
 BRES                       Scalar 6301     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 6322                                 16                                                          
 CHLP                       Scalar 6321     R(4)            4     1     1501     COM              6362                              
 CORP                       Common 6321                                 6072                                                        
 COS                        Func   6342                                 scalar                    6342                              
 COSLAT                     Local  6342     R(4)            4           scalar                    6342,6343                         
 CQCPC                      Scalar 6289     R(4)            4           scalar   COM                                                

Page 207         Source Listing                  HORRES
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CVC                        Scalar 6321     R(4)            4           scalar   COM              6365                              
 DELLAT                     Scalar 6320     R(4)            4           scalar   COM              6339,6343                         
 DELLON                     Scalar 6320     R(4)            4     1     181      COM              6343                              
 DHR                        Scalar 6314     R(4)            4     1     999      COM                                                
 ELV                        Scalar 6315     R(4)            4     1     999      COM                                                
 ERROR                      Scalar 6301     L(4)            4     1     999      COM                                                
 HEADER                     Common 6314                                 35980                                                       
 HOIRES                     Scalar 6317     R(4)            4     2     84       COM              6472,6476,6480,6484               
 HORRES                     Subr   6279                                                                                             
 HRES                       Local  6284     R(4)            4     3     83916                     6373,6411,6447,6448,6449,6450     
 HSCRES                     Scalar 6317     R(4)            4     1     21       COM                                                
 HSTD                       Local  6284     R(4)            4     3     83916                     6374,6411                         
 HYDM                       Scalar 6301     R(4)            4     2     20979    COM                                                
 I                          Local  6340     I(4)            4           scalar                    6340,6341,6343,6350,6351,6352,6353
                                                                                                  ,6361,6362,6372,6373,6374,6376,637
                                                                                                  7,6458,6459,6460,6461,6462        
 IDH                        Local  6286     I(4)            4     4     335664                    6376,6410,6411                    
 IFA                        Scalar 6321     I(4)            4     2     16       COM              6352,6353                         
 IJ                         Local  6349     I(4)            4           scalar                    6349,6352,6353,6354               
 IMISS                      Scalar 6322     I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 6289     I(4)            4           scalar   COM                                                
 ISC                        Scalar 6289     I(4)            4           scalar   COM                                                
 ISF                        Scalar 6316     I(4)            4     1     999      COM                                                
 ITP                        Scalar 6315     I(4)            4     1     999      COM                                                
 J                          Local  6351     I(4)            4           scalar                    6351,6352,6353,6371,6373,6374,6376
                                                                                                  ,6377,6457,6459,6460,6461,6462    
 K                          Local  6370     I(4)            4           scalar                    6370,6373,6374,6376,6377          
 L                          Local  6375     I(4)            4           scalar                    6375,6376,6377,6388,6389,6390,6391
                                                                                                  ,6392,6393,6394,6395,6396,6446,644
                                                                                                  7,6448,6449,6450,6470,6471,6472,64
                                                                                                  75,6476,6479,6480,6483,6484       
 LIMS                       Common 6317                                 1776                                                        
 LMAND                      Scalar 6289     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 6289     I(4)            4           scalar   COM                                                
 MAND                       Scalar 6288     I(4)            4           scalar   COM              6388,6410,6411,6446,6470          
 MANRES                     Common 6290                                 2949048                                                     
 MAXDIM                     Local  6326     I(4)            4           scalar                    6326,6350                         
 MIMAP                      Subr   6333                                                           6333                              
 MIN                        Func   6343                                 scalar                    6343                              
 MIN1                       Func   6472                                 scalar                    6472,6476,6480,6484               
 N                          Local  6387     I(4)            4           scalar                    6387,6389,6390,6391,6392,6393,6394
                                                                                                  ,6395,6396,6445,6447,6448,6449,645
                                                                                                  0,6469,6471,6472,6475,6476,6479,64
                                                                                                  80,6483,6484                      
 NB                         Scalar 6307     I(4)            4           scalar   COM                                                
 NEV                        Scalar 6316     I(4)            4           scalar   COM                                                
 NH                         Scalar 6303     I(4)            4     2     147      COM                                                
 NHLIM                      Scalar 6319     I(4)            4           scalar   COM                                                
 NHY                        Scalar 6306     I(4)            4     1     21       COM                                                
 NI                         Scalar 6304     I(4)            4     2     147      COM                                                
 NLEV                       Scalar 6288     I(4)            4           scalar   COM                                                
 NLV                        Scalar 6315     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 6316     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 6316     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 6288     I(4)            4           scalar   COM              6333,6387,6410,6411,6445,6469     

Page 208         Source Listing                  HORRES
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NQHM                       Scalar 6298     I(4)            4     2     20979    COM              6462,6484                         
 NST                        Param  6280     I(4)            4           scalar                    6284,6285,6286,6287,6290,6291,6292
                                                                                                  ,6293,6294,6295,6296,6297,6298,629
                                                                                                  9,6300,6301,6314,6315,6316,6370,64
                                                                                                  57                                
 NT                         Scalar 6305     I(4)            4     2     84       COM                                                
 NTDHM                      Scalar 6298     I(4)            4     2     20979    COM              6461,6480                         
 NTDIM                      Scalar 6293     I(4)            4     2     20979    COM                                                
 NTHM                       Scalar 6296     I(4)            4     2     20979    COM              6460,6476                         
 NTIM                       Scalar 6293     I(4)            4     2     20979    COM                                                
 NV                         Scalar 6302     I(4)            4     2     147      COM                                                
 NZHM                       Scalar 6296     I(4)            4     2     20979    COM              6459,6472                         
 NZIM                       Scalar 6293     I(4)            4     2     20979    COM                                                
 OG                         Local  6287     L(4)            4     3     83916                     6393,6394,6395,6396,6410          
 OINC                       Local  6285     R(4)            4     3     83916                     6389,6390,6391,6392,6410,6411     
 PARAMS                     Common 6288                                 148                                                         
 PI180                      Local  6326     R(4)            4           scalar                    6326,6339,6342                    
 PIS                        Scalar 6301     R(4)            4     1     999      COM                                                
 PRNT                       Scalar 6289     L(4)            4           scalar   COM                                                
 QCOI                       Subr   6411                                                           6411                              
 QG                         Scalar 6300     L(4)            4     2     20979    COM              6396                              
 QHM                        Scalar 6291     R(4)            4     2     20979    COM              6450,6483,6484                    
 QIM                        Scalar 6290     R(4)            4     2     20979    COM              6392                              
 QVM                        Scalar 6292     R(4)            4     2     20979    COM                                                
 RADE                       Local  6326     R(4)            4           scalar                    6326,6339                         
 RADPC                      Scalar 6288     R(4)            4           scalar   COM                                                
 RSCAN                      Scalar 6320     R(4)            4           scalar   COM              6338,6339                         
 SEARCH                     Subr   6410                                                           6410                              
 SERCH                      Common 6320                                 732                                                         
 SID                        Scalar 6314     CHAR            8     1     999      COM                                                
 SIDH                       Local  6324     CHAR            8     2     16                                                          
 SKB                        Scalar 6313     R(4)            4           scalar   COM                                                
 SKH                        Scalar 6309     R(4)            4     2     147      COM                                                
 SKHY                       Scalar 6312     R(4)            4     1     21       COM                                                
 SKI                        Scalar 6310     R(4)            4     2     147      COM                                                
 SKT                        Scalar 6311     R(4)            4     2     84       COM                                                
 SKV                        Scalar 6308     R(4)            4     2     147      COM                                                
 SQN                        Scalar 6315     R(4)            4     1     999      COM                                                
 STATS                      Common 6302                                 10940                                                       
 STDB                       Scalar 6307     R(4)            4           scalar   COM                                                
 STDH                       Scalar 6303     R(4)            4     2     147      COM                                                
 STDHY                      Scalar 6306     R(4)            4     1     21       COM                                                
 STDI                       Scalar 6304     R(4)            4     2     147      COM                                                
 STDT                       Scalar 6305     R(4)            4     2     84       COM                                                
 STDV                       Scalar 6302     R(4)            4     2     147      COM                                                
 TCLIM                      Scalar 6319     R(4)            4           scalar   COM                                                
 TDG                        Scalar 6300     L(4)            4     2     20979    COM              6395                              
 TDHM                       Scalar 6291     R(4)            4     2     20979    COM              6449,6479,6480                    
 TDIM                       Scalar 6290     R(4)            4     2     20979    COM              6391                              
 TDVM                       Scalar 6292     R(4)            4     2     20979    COM                                                
 TFACT                      Scalar 6318     R(4)            4     2     84       COM                                                
 TG                         Scalar 6300     L(4)            4     2     20979    COM              6394                              
 THM                        Scalar 6291     R(4)            4     2     20979    COM              6448,6475,6476                    
 TIM                        Scalar 6290     R(4)            4     2     20979    COM              6390                              
 TMPSTD                     Scalar 6318     R(4)            4     2     84       COM                                                

Page 209         Source Listing                  HORRES
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TT                         Scalar 6289     R(4)            4           scalar   COM                                                
 TVM                        Scalar 6292     R(4)            4     2     20979    COM                                                
 VOIRES                     Scalar 6318     R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 6288     R(4)            4           scalar   COM                                                
 WTH                        Local  6285     R(4)            4     4     335664                    6377,6411                         
 XINC                       Scalar 6317     R(4)            4     2     84       COM                                                
 XKB                        Scalar 6313     R(4)            4           scalar   COM                                                
 XKH                        Scalar 6309     R(4)            4     2     147      COM                                                
 XKHY                       Scalar 6312     R(4)            4     1     21       COM                                                
 XKI                        Scalar 6310     R(4)            4     2     147      COM                                                
 XKT                        Scalar 6311     R(4)            4     2     84       COM                                                
 XKV                        Scalar 6308     R(4)            4     2     147      COM                                                
 XMA                        Scalar 6288     R(4)            4           scalar   COM                                                
 XMI                        Scalar 6288     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 6322     R(4)            4           scalar   COM                                                
 XOB                        Scalar 6314     R(4)            4     1     999      COM              6333                              
 XQHM                       Scalar 6299     R(4)            4     2     20979    COM                                                
 XQIM                       Scalar 6295     R(4)            4     2     20979    COM                                                
 XTDHM                      Scalar 6298     R(4)            4     2     20979    COM                                                
 XTDIM                      Scalar 6294     R(4)            4     2     20979    COM                                                
 XTDVM                      Scalar 6297     R(4)            4     2     20979    COM                                                
 XTHM                       Scalar 6297     R(4)            4     2     20979    COM                                                
 XTIM                       Scalar 6294     R(4)            4     2     20979    COM                                                
 XTVM                       Scalar 6295     R(4)            4     2     20979    COM                                                
 XZHM                       Scalar 6296     R(4)            4     2     20979    COM                                                
 XZIM                       Scalar 6294     R(4)            4     2     20979    COM                                                
 XZVM                       Scalar 6295     R(4)            4     2     20979    COM                                                
 YMA                        Scalar 6288     R(4)            4           scalar   COM                                                
 YMI                        Scalar 6288     R(4)            4           scalar   COM                                                
 YOB                        Scalar 6314     R(4)            4     1     999      COM              6333                              
 ZCLIM                      Scalar 6319     R(4)            4           scalar   COM                                                
 ZG                         Scalar 6300     L(4)            4     2     20979    COM              6393                              
 ZHM                        Scalar 6291     R(4)            4     2     20979    COM              6447,6471,6472                    
 ZIM                        Scalar 6290     R(4)            4     2     20979    COM              6389                              
 ZVM                        Scalar 6292     R(4)            4     2     20979    COM                                                

Page 210         Source Listing                  HORRES
2017-04-18 11:07                                 cqcbufr.f

   6501 
   6502 C******************************************************************
   6503 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6504 C                .      .    .                                       .
   6505 C SUBPROGRAM:    HSC         CALCULATE HYDROSTATIC RESIDUALS
   6506 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   6507 C
   6508 C ABSTRACT: Calculate the hydrostatic residuals.  The residuals are
   6509 C   calculated both with and without use of significant level
   6510 C   temperatures.  They are also calculated with and without including
   6511 C   moisture:
   6512 C     HYDN IS HYDROSTATIC RESIDUAL USING MANDATORY TEMPERATURES
   6513 C     HYDQ IS HYD RESIDUAL USING MAND VIRTUAL TEMPERATURES
   6514 C     HYDS IS HYD RESIDUAL USING ALL VIRTUAL TEMPERATURES
   6515 C     HYD  IS HYD RESIDUAL BEST TO BE USED
   6516 C
   6517 C PROGRAM HISTORY LOG:
   6518 C 1997-03-18  W. Collins  Original author.
   6519 C 2000-06-13  W. Collins  Slight change so that HYDN fills HYDS
   6520 C     when it is unreasonably large or missing.
   6521 C
   6522 C USAGE:    CALL HSC
   6523 C
   6524 C REMARKS: NONE.
   6525 C
   6526 C ATTRIBUTES:
   6527 C   LANGUAGE: FORTRAN 90
   6528 C   MACHINE:  NCEP WCOSS
   6529 C
   6530 C$$$
   6531 
   6532       SUBROUTINE HSC
   6533       PARAMETER (NST=999)
   6534 
   6535       REAL(8) BMISS
   6536 
   6537       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   6538      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   6539      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   6540      &                 TDO(255), TDFC(255),TVO(255),
   6541      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   6542      &                 CAT(255), IND(255), LEVTYP(255),
   6543      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   6544      &                 YDR(255), XDR(255)
   6545       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   6546      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   6547      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   6548      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   6549      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   6550      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   6551      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   6552      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   6553      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   6554      &                 XTDH(255)
   6555       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   6556      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   6557      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),

Page 211         Source Listing                  HSC
2017-04-18 11:07                                 cqcbufr.f

   6558      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   6559      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   6560      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   6561      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   6562      &                 XTHM(21,NST),XTDVM(21,NST),
   6563      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   6564      &                 XQHM(21,NST),
   6565      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   6566      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   6567       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   6568      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   6569      &                 ZCLIM, TCLIM, NHLIM
   6570       COMMON /CONSTS/  R, G, T0, CP, RV
   6571       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   6572      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   6573       COMMON /STN/     IS
   6574       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   6575 
   6576       CHARACTER*8      SID
   6577       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
   6578 
   6579 C  CALCULATE HYDROSTATIC RESIDUALS
   6580 C    HYDN IS HYDROSTATIC RESIDUAL USING MANDATORY TEMPERATURES
   6581 C    HYDQ IS HYD RESIDUAL USING MAND VIRTUAL TEMPERATURES
   6582 C    HYDS IS HYD RESIDUAL USING ALL VIRTUAL TEMPERATURES
   6583 C    HYD  IS HYD RESIDUAL BEST TO BE USED
   6584 C  -----------------------------------------------------
   6585 
   6586       RTOG = R*T0/G
   6587       RO2G = .5*R/G
   6588       GOR  = G/R
   6589 
   6590       BASRES(IS) = BMISS
   6591       BRES(IS) = BMISS
   6592       PSINC  = BMISS
   6593       B = BMISS
   6594 
   6595 C  FIND INDEX OF THE FIRST MANDATORY LEVEL ABOVE THE SURFACE
   6596 C  AT WHICH HEIGHT AND TEMPERATURE ARE AVAILABLE.
   6597 C  ---------------------------------------------------------
   6598 
   6599       LUP = BMISS
   6600       DO L=LSFC+1,NLEV
   6601         LUP = L
   6602         IF(CAT(L).EQ.1 .AND. LEVTYP(L).LE.2) GOTO 20
   6603       ENDDO
   6604       RETURN
   6605 
   6606 C  TEST TO SEE IF NECESSARY INFO IS AVAILABLE FOR BASELINE RESIDUALS
   6607 C  AND THAT THE FIRST MANDATORY LEVEL IS NOT TOO FAR ABOVE SURFACE
   6608 C  -----------------------------------------------------------------
   6609 
   6610    20 CONTINUE
   6611       IF(LSFC.EQ.0)         GOTO 100        ! No sfc level
   6612       IF(LEVTYP(LSFC).GT.2) GOTO 100        ! Info not available
   6613       IF(POB(LSFC)-POB(LUP).GT.200.) GOTO 100
   6614 

Page 212         Source Listing                  HSC
2017-04-18 11:07                                 cqcbufr.f

   6615 C  GET HEIGHT DIFFERENCE BETWEEN SURFACE PRESS AND 1ST MAND LEVEL,
   6616 C  ACCORDING TO TEMPERATURES: BASRES
   6617 C  NOTE!  BASRES COULD BE CALCULATED VIA THREE METHODS AS IS THE
   6618 C  HYDROSTATIC RESIDUAL, AND CHOOSE THE BEST. 
   6619 C  --------------------------------------------------------------
   6620       SUM = 0.
   6621       L1 = LSFC
   6622       IF(LEVTYP(L1).EQ.1 .AND. TVO(L1).NE.BMISS) THEN
   6623         T1 = TVO(L1)
   6624       ELSE
   6625         T1 = TOB(L1)
   6626       ENDIF
   6627       DO L=LSFC,LUP-1
   6628         IF(LEVTYP(L+1).NE.3) THEN
   6629           L2 = L+1
   6630           IF(LEVTYP(L2).EQ.4 .AND. TVO(L2).NE.BMISS) THEN
   6631             T2 = TVO(L2)
   6632           ELSE
   6633             T2 = TOB(L2)
   6634           ENDIF
   6635           SUM = SUM - (ALP(POB(L1))-ALP(POB(L2))) *
   6636      &      (RTOG + RO2G*(T1+T2))
   6637           L1 = L2
   6638           T1 = T2
   6639         ENDIF
   6640       ENDDO
   6641       BASRES(IS) = ZOB(LUP) - ZOB(LSFC) + SUM
   6642       BRES(IS) = BASRES(IS)
   6643       NBAS = MIN1(20.,20.*ABS(BASRES(IS))/HSCRES(1))
   6644 
   6645 C  GET PRESSURE DIFFERENCE BETWEEN SURFACE AND 1ST MAND LEVEL,
   6646 C  USING REPORTED SURFACE PRESSURE, TEMPERATURES AND HEIGHTS:
   6647 C  PSINC
   6648 C  NOTE!  PSINC COULD BE CALCULATED VIA THREE METHODS AS IS THE
   6649 C  HYDROSTATIC RESIDUAL, AND CHOOSE THE BEST.
   6650 C  -----------------------------------------------------------
   6651 
   6652       IF(POB(LSFC).EQ.BMISS) GOTO 100
   6653       Z1 = ZOB(LUP) + SUM
   6654       IF(LEVTYP(LSFC).EQ.4 .AND. TVO(LSFC).NE.BMISS) THEN
   6655         TSFC = TVO(LSFC) + T0
   6656       ELSE
   6657         TSFC = TOB(LSFC) + T0
   6658       ENDIF
   6659       PSFC = POB(LSFC)*EXP(GOR*(Z1-ZOB(LSFC))/TSFC)
   6660       PSINC = POB(LSFC) - PSFC
   6661 
   6662 C  CALCULATE HYDROSTATIC RESIDUALS FOR REST OF MAND LEVELS
   6663 C  -------------------------------------------------------
   6664 
   6665   100 CONTINUE
   6666       IF(LUP.EQ.0) GOTO 200
   6667       L11  = LUP
   6668       L21  = LUP
   6669       L31  = LUP
   6670       LAST = 0
   6671       DO I=1,21

Page 213         Source Listing                  HSC
2017-04-18 11:07                                 cqcbufr.f

   6672         HYDN(I) = BMISS
   6673         HYDQ(I) = BMISS
   6674         HYDS(I) = BMISS
   6675         HYD(I)  = BMISS
   6676       ENDDO
   6677       SUM3 = 0.
   6678       DO L=LUP,NLEV-1
   6679         MLEV = MANLEV(POB(L11))
   6680         IF(LEVTYP(L11).LE.2 .AND. LEVTYP(L+1).LE.2 .AND.
   6681      &    MLEV.NE.0 .AND. (CAT(L+1).EQ.1 .OR. CAT(L+1).EQ.5)) THEN
   6682           LAST = L+1
   6683           L12  = L+1
   6684           B(MLEV) = RO2G*(ALP(POB(L11))-ALP(POB(L12)))
   6685           SUM1 = -(ALP(POB(L11))-ALP(POB(L12))) *
   6686      &     (RTOG + RO2G*(TOB(L11)+TOB(L12)))
   6687           HYDN(MLEV) = ZOB(L12)-ZOB(L11) + SUM1
   6688           L11 = L12
   6689         ENDIF
   6690         MLEV = MANLEV(POB(L21))
   6691         IF(LEVTYP(L21).EQ.1 .AND. LEVTYP(L+1).EQ.1 .AND.
   6692      &    MLEV.NE.0 .AND. (CAT(L+1).EQ.1 .OR. CAT(L+1).EQ.5)) THEN
   6693           L22  = L+1
   6694           SUM2 = -(ALP(POB(L21))-ALP(POB(L22))) *
   6695      &     (RTOG + RO2G*(TVO(L21)+TVO(L22)))
   6696           HYDQ(MLEV) = ZOB(L22)-ZOB(L21) + SUM2
   6697           L21 = L22
   6698         ENDIF
   6699         IF(LEVTYP(L+1).NE.3) THEN
   6700           L32 = L+1
   6701           IF((LEVTYP(L).EQ.1 .OR. LEVTYP(L).EQ.4) .AND.
   6702      &       TVO(L).NE.BMISS) THEN
   6703             T1 = TVO(L)
   6704           ELSE
   6705             T1 = TOB(L)
   6706           ENDIF
   6707           IF((LEVTYP(L32).EQ.1 .OR. LEVTYP(L32).EQ.4) .AND.
   6708      &       TVO(L32).NE.BMISS) THEN
   6709             T2 = TVO(L32)
   6710           ELSE
   6711             T2 = TOB(L32)
   6712           ENDIF
   6713           SUM3 = SUM3 - (ALP(POB(L))-ALP(POB(L32))) *
   6714      &     (RTOG + RO2G*(T1+T2))
   6715           MLEV = MANLEV(POB(L31))
   6716           IF(LEVTYP(L32).LE.2 .AND. MLEV.NE.0) THEN
   6717             HYDS(MLEV) = ZOB(L32)-ZOB(L31) + SUM3
   6718             L31 = L32
   6719             SUM3 = 0.
   6720           ENDIF
   6721         ENDIF
   6722       ENDDO
   6723   200 CONTINUE
   6724 
   6725 C  DECIDE WHICH HYDROSTATIC RESIDUAL TO USE.
   6726 C  -----------------------------------------
   6727 
   6728       DO I=1,21

Page 214         Source Listing                  HSC
2017-04-18 11:07                                 cqcbufr.f

   6729         NHYD(I)  = -1
   6730         NHYDN(I) = -1
   6731         IF(ABS(HYDS(I)).GT..001*BMISS) HYDS(I) = HYDN(I)
   6732       ENDDO
   6733       IF(LAST.NE.0) THEN
   6734         LEV1 = MANLEV(POB(LUP))
   6735         LEV2 = MANLEV(POB(LAST))
   6736         DO L=LEV1,LEV2
   6737           IF(HYDS(L).NE.BMISS .AND.
   6738      &      ABS(HYDN(L)-HYDQ(L)).LT.15. .AND.
   6739      &      ABS(HYDQ(L)-HYDS(L)).LT.15.) THEN
   6740             HYD(L) = HYDS(L)
   6741             HYDM(L,IS) = HYDS(L)
   6742           ELSEIF(HYDS(L).NE.BMISS .AND.
   6743      &      ABS(HYDS(L)).LT.ABS(HYDN(L)) .AND.
   6744      &      ABS(HYDS(L)).LT.ABS(HYDQ(L))) THEN
   6745             HYD(L) = HYDS(L)
   6746             HYDM(L,IS) = HYDS(L)
   6747           ELSEIF(HYDQ(L).NE.BMISS .AND.
   6748      &      ABS(HYDN(L)-HYDQ(L)).LT.15.) THEN
   6749             HYD(L) = HYDQ(L)
   6750             HYDM(L,IS) = HYDQ(L)
   6751           ELSEIF(HYDN(L).NE.BMISS) THEN
   6752             HYD(L) = HYDN(L)
   6753             HYDM(L,IS) = HYDN(L)
   6754           ELSEIF(HYDS(L).NE.BMISS) THEN
   6755             HYD(L) = HYDS(L)
   6756             HYDM(L,IS) = HYDS(L)
   6757           ELSE
   6758             HYD(L) = HYDQ(L)
   6759             HYDM(L,IS) = HYDQ(L)
   6760           ENDIF
   6761           IF(HYDS(L).NE.BMISS) THEN
   6762             HYD(L) = HYDS(L)       ! Note
   6763             HYDM(L,IS) = HYDS(L)   ! Note
   6764           ENDIF
   6765           IF(HYD(L).NE.BMISS) THEN
   6766             NHYD(L) = MIN1(20.,20.*ABS(HYD(L))/HSCRES(L))
   6767           ENDIF
   6768           IF(HYDN(L).NE.BMISS) THEN
   6769             NHYDN(L) = MIN1(20.,20.*ABS(HYDN(L))/HSCRES(L))
   6770           ENDIF
   6771         ENDDO
   6772       ENDIF
   6773 
   6774       RETURN
   6775       END

Page 215         Source Listing                  HSC
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name            
                  
 hsc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  6665                                                           6611,6612,6613,6652               
 20                         Label  6610                                                           6602                              
 200                        Label  6723                                                           6666                              
 ABS                        Func   6643                                 scalar                    6643,6731,6738,6739,6743,6744,6748
                                                                                                  ,6766,6769                        
 ALLSND                     Common 6537                                 34512                                                       
 ALP                        Func   6635     R(4)            4           scalar                    6635,6684,6685,6694,6713          
 B                          Scalar 6553     R(4)            4     1     21       COM              6593,6684                         
 BASRES                     Scalar 6552     R(4)            4     1     999      COM              6590,6641,6642,6643               
 BMISS                      Scalar 6535     R(8)            8           scalar   COM              6590,6591,6592,6593,6599,6622,6630
                                                                                                  ,6652,6654,6672,6673,6674,6675,670
                                                                                                  2,6708,6731,6737,6742,6747,6751,67
                                                                                                  54,6761,6765,6768                 
 BRES                       Scalar 6566     R(4)            4     1     999      COM              6591,6642                         
 BUFRLIB_MISSING            Common 6574                                 16                                                          
 CAT                        Scalar 6542     R(4)            4     1     255      COM              6602,6681,6692                    
 CONSTS                     Common 6570                                 20                                                          
 CP                         Scalar 6570     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 6572     R(4)            4           scalar   COM                                                
 ERROR                      Scalar 6566     L(4)            4     1     999      COM                                                
 EXP                        Func   6659                                 scalar                    6659                              
 G                          Scalar 6570     R(4)            4           scalar   COM              6586,6587,6588                    
 GESPS                      Scalar 6543     R(4)            4     1     999      COM                                                
 GOR                        Local  6588     R(4)            4           scalar                    6588,6659                         
 HOIRES                     Scalar 6567     R(4)            4     2     84       COM                                                
 HRDR                       Scalar 6543     R(4)            4     1     255      COM                                                
 HSC                        Subr   6532                                                                                             
 HSCRES                     Scalar 6567     R(4)            4     1     21       COM              6643,6766,6769                    
 HYD                        Scalar 6551     R(4)            4     1     21       COM              6675,6740,6745,6749,6752,6755,6758
                                                                                                  ,6762,6765,6766                   
 HYDM                       Scalar 6566     R(4)            4     2     20979    COM              6741,6746,6750,6753,6756,6759,6763
 HYDN                       Scalar 6551     R(4)            4     1     21       COM              6672,6687,6731,6738,6743,6748,6751
                                                                                                  ,6752,6753,6768,6769              
 HYDQ                       Scalar 6551     R(4)            4     1     21       COM              6673,6696,6738,6739,6744,6747,6748
                                                                                                  ,6749,6750,6758,6759              
 HYDS                       Scalar 6551     R(4)            4     1     21       COM              6674,6717,6731,6737,6739,6740,6741
                                                                                                  ,6742,6743,6744,6745,6746,6754,675
                                                                                                  5,6756,6761,6762,6763             
 I                          Local  6671     I(4)            4           scalar                    6671,6672,6673,6674,6675,6728,6729
                                                                                                  ,6730,6731                        
 IHSC                       Scalar 6552     I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 6574     I(4)            4           scalar   COM                                                
 IND                        Scalar 6542     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 6572     I(4)            4           scalar   COM                                                

Page 216         Source Listing                  HSC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IS                         Scalar 6573     I(4)            4           scalar   COM              6590,6591,6641,6642,6643,6741,6746
                                                                                                  ,6750,6753,6756,6759,6763         
 ISC                        Scalar 6572     I(4)            4           scalar   COM                                                
 L                          Local  6600     I(4)            4           scalar                    6600,6601,6602,6627,6628,6629,6678
                                                                                                  ,6680,6681,6682,6683,6691,6692,669
                                                                                                  3,6699,6700,6701,6702,6703,6705,67
                                                                                                  13,6736,6737,6738,6739,6740,6741,6
                                                                                                  742,6743,6744,6745,6746,6747,6748,
                                                                                                  6749,6750,6751,6752,6753,6754,6755
                                                                                                  ,6756,6758,6759,6761,6762,6763,676
                                                                                                  5,6766,6768,6769                  
 L1                         Local  6621     I(4)            4           scalar                    6621,6622,6623,6625,6635,6637     
 L11                        Local  6667     I(4)            4           scalar                    6667,6679,6680,6684,6685,6686,6687
                                                                                                  ,6688                             
 L12                        Local  6683     I(4)            4           scalar                    6683,6684,6685,6686,6687,6688     
 L2                         Local  6629     I(4)            4           scalar                    6629,6630,6631,6633,6635,6637     
 L21                        Local  6668     I(4)            4           scalar                    6668,6690,6691,6694,6695,6696,6697
 L22                        Local  6693     I(4)            4           scalar                    6693,6694,6695,6696,6697          
 L31                        Local  6669     I(4)            4           scalar                    6669,6715,6717,6718               
 L32                        Local  6700     I(4)            4           scalar                    6700,6707,6708,6709,6711,6713,6716
                                                                                                  ,6717,6718                        
 LAST                       Local  6670     I(4)            4           scalar                    6670,6682,6733,6735               
 LEV1                       Local  6734     I(4)            4           scalar                    6734,6736                         
 LEV2                       Local  6735     I(4)            4           scalar                    6735,6736                         
 LEVTYP                     Scalar 6542     I(4)            4     1     255      COM              6602,6612,6622,6628,6630,6654,6680
                                                                                                  ,6691,6699,6701,6707,6716         
 LIMS                       Common 6567                                 1776                                                        
 LMAND                      Scalar 6572     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 6572     I(4)            4           scalar   COM              6600,6611,6612,6613,6621,6627,6641
                                                                                                  ,6652,6654,6655,6657,6659,6660    
 LST                        Scalar 6543     I(4)            4     1     255      COM                                                
 LUP                        Local  6599     I(4)            4           scalar                    6599,6601,6613,6627,6641,6653,6666
                                                                                                  ,6667,6668,6669,6678,6734         
 MAND                       Scalar 6571     I(4)            4           scalar   COM                                                
 MANLEV                     Func   6679     I(4)            4           scalar                    6679,6690,6715,6734,6735          
 MANRES                     Common 6555                                 2949048                                                     
 MIN1                       Func   6643                                 scalar                    6643,6766,6769                    
 MLEV                       Local  6679     I(4)            4           scalar                    6679,6681,6684,6687,6690,6692,6696
                                                                                                  ,6715,6716,6717                   
 NBAS                       Scalar 6553     I(4)            4           scalar   COM              6643                              
 NHLIM                      Scalar 6569     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 6551     I(4)            4     1     21       COM              6729,6766                         
 NHYDN                      Scalar 6553     I(4)            4     1     21       COM              6730,6769                         
 NLEV                       Scalar 6571     I(4)            4           scalar   COM              6600,6678                         
 NOBS                       Scalar 6571     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 6563     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 6547     I(4)            4     1     255      COM                                                
 NQV                        Scalar 6549     I(4)            4     1     255      COM                                                
 NST                        Param  6533     I(4)            4           scalar                    6543,6552,6555,6556,6557,6558,6559
                                                                                                  ,6560,6561,6562,6563,6564,6565,656
                                                                                                  6                                 
 NTDHM                      Scalar 6563     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 6547     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 6558     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 6549     I(4)            4     1     255      COM                                                

Page 217         Source Listing                  HSC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTHM                       Scalar 6561     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 6547     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 6558     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 6549     I(4)            4     1     255      COM                                                
 NTV                        Scalar 6549     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 6561     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 6547     I(4)            4     1     255      COM                                                
 NZIM                       Scalar 6558     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 6549     I(4)            4     1     255      COM                                                
 PARAMS                     Common 6571                                 148                                                         
 PFC                        Scalar 6537     R(4)            4     1     255      COM                                                
 PI                         Scalar 6545     R(4)            4     1     255      COM                                                
 PIS                        Scalar 6566     R(4)            4     1     999      COM                                                
 POB                        Scalar 6537     R(4)            4     1     255      COM              6613,6635,6652,6659,6660,6679,6684
                                                                                                  ,6685,6690,6694,6713,6715,6734,673
                                                                                                  5                                 
 PQM                        Scalar 6537     R(4)            4     1     255      COM                                                
 PRC                        Scalar 6537     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 6572     L(4)            4           scalar   COM                                                
 PS                         Scalar 6543     R(4)            4     1     999      COM                                                
 PSFC                       Local  6659     R(4)            4           scalar                    6659,6660                         
 PSINC                      Scalar 6552     R(4)            4           scalar   COM              6592,6660                         
 QFC                        Scalar 6541     R(4)            4     1     255      COM                                                
 QG                         Scalar 6565     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 6556     R(4)            4     2     20979    COM                                                
 QI                         Scalar 6545     R(4)            4     1     255      COM                                                
 QIM                        Scalar 6555     R(4)            4     2     20979    COM                                                
 QOB                        Scalar 6541     R(4)            4     1     255      COM                                                
 QQM                        Scalar 6541     R(4)            4     1     255      COM                                                
 QRC                        Scalar 6541     R(4)            4     1     255      COM                                                
 QV                         Scalar 6546     R(4)            4     1     255      COM                                                
 QVM                        Scalar 6557     R(4)            4     2     20979    COM                                                
 R                          Scalar 6570     R(4)            4           scalar   COM              6586,6587,6588                    
 RADPC                      Scalar 6571     R(4)            4           scalar   COM                                                
 RESID                      Common 6545                                 41312                                                       
 RO2G                       Local  6587     R(4)            4           scalar                    6587,6636,6684,6686,6695,6714     
 RTOG                       Local  6586     R(4)            4           scalar                    6586,6636,6686,6695,6714          
 RV                         Scalar 6570     R(4)            4           scalar   COM                                                
 SID                        Local  6576     CHAR            8           scalar                                                      
 STN                        Common 6573                                 4                                                           
 SUM                        Local  6620     R(4)            4           scalar                    6620,6635,6641,6653               
 SUM1                       Local  6685     R(4)            4           scalar                    6685,6687                         
 SUM2                       Local  6694     R(4)            4           scalar                    6694,6696                         
 SUM3                       Local  6677     R(4)            4           scalar                    6677,6713,6717,6719               
 T0                         Scalar 6570     R(4)            4           scalar   COM              6586,6655,6657                    
 T1                         Local  6623     R(4)            4           scalar                    6623,6625,6636,6638,6703,6705,6714
 T2                         Local  6631     R(4)            4           scalar                    6631,6633,6636,6638,6709,6711,6714
 TCLIM                      Scalar 6569     R(4)            4           scalar   COM                                                
 TDFC                       Scalar 6540     R(4)            4     1     255      COM                                                
 TDG                        Scalar 6565     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 6556     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 6545     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 6555     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 6540     R(4)            4     1     255      COM                                                
 TDV                        Scalar 6546     R(4)            4     1     255      COM                                                

Page 218         Source Listing                  HSC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TDVM                       Scalar 6557     R(4)            4     2     20979    COM                                                
 TFACT                      Scalar 6568     R(4)            4     2     84       COM                                                
 TFC                        Scalar 6539     R(4)            4     1     255      COM                                                
 TG                         Scalar 6565     L(4)            4     2     20979    COM                                                
 THM                        Scalar 6556     R(4)            4     2     20979    COM                                                
 TI                         Scalar 6545     R(4)            4     1     255      COM                                                
 TIM                        Scalar 6555     R(4)            4     2     20979    COM                                                
 TL                         Scalar 6546     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 6552     R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 6568     R(4)            4     2     84       COM                                                
 TOB                        Scalar 6539     R(4)            4     1     255      COM              6625,6633,6657,6686,6705,6711     
 TQM                        Scalar 6539     R(4)            4     1     255      COM                                                
 TRC                        Scalar 6539     R(4)            4     1     255      COM                                                
 TSFC                       Local  6655     R(4)            4           scalar                    6655,6657,6659                    
 TT                         Scalar 6572     R(4)            4           scalar   COM                                                
 TV                         Scalar 6546     R(4)            4     1     255      COM                                                
 TVM                        Scalar 6557     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 6540     R(4)            4     1     255      COM              6622,6623,6630,6631,6654,6655,6695
                                                                                                  ,6702,6703,6708,6709              
 VOIRES                     Scalar 6568     R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 6571     R(4)            4           scalar   COM                                                
 XDR                        Scalar 6544     R(4)            4     1     255      COM                                                
 XINC                       Scalar 6567     R(4)            4     2     84       COM                                                
 XMA                        Scalar 6571     R(4)            4           scalar   COM                                                
 XMI                        Scalar 6571     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 6574     R(4)            4           scalar   COM                                                
 XQHM                       Scalar 6564     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 6548     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 6560     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 6550     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 6554     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 6563     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 6548     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 6559     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 6550     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 6562     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 6553     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 6562     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 6548     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 6559     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 6550     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 6560     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 6553     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 6561     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 6548     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 6559     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 6550     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 6560     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 6544     R(4)            4     1     255      COM                                                
 YMA                        Scalar 6571     R(4)            4           scalar   COM                                                
 YMI                        Scalar 6571     R(4)            4           scalar   COM                                                
 Z1                         Local  6653     R(4)            4           scalar                    6653,6659                         
 ZCLIM                      Scalar 6569     R(4)            4           scalar   COM                                                
 ZD                         Scalar 6553     R(4)            4     1     255      COM                                                
 ZFC                        Scalar 6538     R(4)            4     1     255      COM                                                

Page 219         Source Listing                  HSC
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZG                         Scalar 6565     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 6556     R(4)            4     2     20979    COM                                                
 ZI                         Scalar 6545     R(4)            4     1     255      COM                                                
 ZIM                        Scalar 6555     R(4)            4     2     20979    COM                                                
 ZOB                        Scalar 6538     R(4)            4     1     255      COM              6641,6653,6659,6687,6696,6717     
 ZQM                        Scalar 6538     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 6538     R(4)            4     1     255      COM                                                
 ZV                         Scalar 6546     R(4)            4     1     255      COM                                                
 ZVM                        Scalar 6557     R(4)            4     2     20979    COM                                                

Page 220         Source Listing                  HSC
2017-04-18 11:07                                 cqcbufr.f

   6776 
   6777 C******************************************************************
   6778 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6779 C                .      .    .                                       .
   6780 C SUBPROGRAM:    INCR        CALCULATE INCREMENTS
   6781 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   6782 C
   6783 C ABSTRACT: Calculate increments for all mass variables.
   6784 C
   6785 C PROGRAM HISTORY LOG:
   6786 C 1997-03-18  W. Collins  Original author.
   6787 C
   6788 C USAGE:    CALL INCR(ITIME)
   6789 C   INPUT ARGUMENT LIST:
   6790 C     ITIME    - 1 - FIRST CALL TO INPUT FOR STATION
   6791 C                2 - SECOND CALL TO INPUT FOR STATION
   6792 C  
   6793 C REMARKS: NONE.
   6794 C
   6795 C ATTRIBUTES:
   6796 C   LANGUAGE: FORTRAN 90
   6797 C   MACHINE:  NCEP WCOSS
   6798 C
   6799 C$$$
   6800 
   6801       SUBROUTINE INCR(ITIME)
   6802       PARAMETER (NST=999)
   6803 
   6804       REAL(8) BMISS
   6805 
   6806       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   6807      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   6808      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   6809      &                 TDO(255), TDFC(255),TVO(255),
   6810      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   6811      &                 CAT(255), IND(255), LEVTYP(255),
   6812      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   6813      &                 YDR(255), XDR(255)
   6814       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   6815      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   6816      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   6817      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   6818      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   6819      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   6820      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   6821      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   6822      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   6823      &                 XTDH(255)
   6824       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   6825      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   6826      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   6827      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   6828      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   6829      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   6830      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   6831      &                 XTHM(21,NST),XTDVM(21,NST),
   6832      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),

Page 221         Source Listing                  INCR
2017-04-18 11:07                                 cqcbufr.f

   6833      &                 XQHM(21,NST),
   6834      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   6835      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   6836       COMMON /STATS/   NV(21,7), AVGV(21,7), STDV(21,7),
   6837      &                 NH(21,7), AVGH(21,7), STDH(21,7),
   6838      &                 NI(21,7), AVGI(21,7), STDI(21,7),
   6839      &                 NT(21,4),  AVGT(21,4), STDT(21,4),
   6840      &                 NHY(21),   AVGHY(21),  STDHY(21),
   6841      &                 NB,        AVGB,       STDB,
   6842      &                 SKV(21,7), XKV(21,7),
   6843      &                 SKH(21,7), XKH(21,7),
   6844      &                 SKI(21,7), XKI(21,7),
   6845      &                 SKT(21,4), XKT(21,4),
   6846      &                 SKHY(21),  XKHY(21),
   6847      &                 SKB,       XKB
   6848       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   6849      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   6850      &                 ZCLIM, TCLIM, NHLIM
   6851       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   6852      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   6853       COMMON /STN/     IS
   6854       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   6855 
   6856       CHARACTER*8      SID
   6857       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
   6858 
   6859       DATA ISTART /0/
   6860 
   6861 C  INITIALIZE VALUES (INCLUDING SOME NON-INCREMENT FIELDS)
   6862 C  -------------------------------------------------------
   6863 
   6864       IF(ISTART.EQ.0 .OR. IS.EQ.1) THEN
   6865         DO N=1,NST
   6866           DO L=1,MAND
   6867             ZIM(L,N)   = BMISS
   6868             TIM(L,N)   = BMISS
   6869             TDIM(L,N)  = BMISS
   6870             QIM(L,N)   = BMISS
   6871             ZVM(L,N)   = BMISS
   6872             TVM(L,N)   = BMISS
   6873             TDVM(L,N)  = BMISS
   6874             QVM(L,N)   = BMISS
   6875             HYDM(L,N)  = BMISS
   6876           ENDDO
   6877         ENDDO
   6878         DO N=1,NST
   6879           DO I=1,MAND
   6880             NZIM(I,N)  = -1
   6881             NTIM(I,N)  = -1
   6882             NTDIM(I,N) = -1
   6883             IF(ITIME.EQ.2) THEN
   6884               XZIM(I,N)  = BMISS
   6885               XTIM(I,N)  = BMISS
   6886               XTDIM(I,N) = BMISS
   6887               XQIM(I,N)  = BMISS
   6888             ENDIF
   6889           ENDDO

Page 222         Source Listing                  INCR
2017-04-18 11:07                                 cqcbufr.f

   6890         ENDDO
   6891         ISTART = 1
   6892       ENDIF
   6893       DO I=1,255
   6894         PI(I)    = BMISS
   6895         ZI(I)    = BMISS
   6896         TI(I)    = BMISS
   6897         TDI(I)   = BMISS
   6898         QI(I)    = BMISS
   6899         NZI(I)   = -1
   6900         NTI(I)   = -1
   6901         NTDI(I)  = -1
   6902         NQI(I)   = -1
   6903         IF(ITIME.EQ.2) THEN
   6904           XZI(I)   = BMISS
   6905           XTI(I)   = BMISS
   6906           XTDI(I)  = BMISS
   6907           XQI(I)   = BMISS
   6908         ENDIF
   6909       ENDDO
   6910 
   6911       DO L=1,255
   6912         DO I=1,4
   6913           IHSC(I,L)  = 0
   6914         ENDDO
   6915       ENDDO
   6916 
   6917       IF(IS.EQ.0) RETURN
   6918 
   6919 C  CALCULATE INCREMENTS.
   6920 C  ---------------------
   6921 
   6922    10 CONTINUE
   6923       IF(PS(IS).LT.BMISS .AND. GESPS(IS).LT.BMISS) THEN
   6924         PIS(IS) = PS(IS) - GESPS(IS)
   6925       ENDIF
   6926       DO L=1,NLEV
   6927 
   6928         I = MANLEV(POB(L))
   6929         IF(I.NE.0) THEN
   6930           IF(ZOB(L).LT.BMISS .AND. ZFC(L).LT.BMISS) THEN
   6931             ZIM(I,IS)  = ZOB(L) - ZFC(L)
   6932             NZIM(I,IS) = MIN1(20.,20.*ABS(ZIM(I,IS))/XINC(I,1))
   6933             IF(ITIME.EQ.2) THEN
   6934             XZIM(I,IS) = (ZOB(L)-ZFC(L)-AVGI(I,1))
   6935      &                   /MAX(.1*XINC(I,1),STDI(I,1))
   6936             ENDIF
   6937           ENDIF
   6938           IF(TOB(L).LT.BMISS .AND. TFC(L).LT.BMISS) THEN
   6939             TIM(I,IS)  = TOB(L) - TFC(L)
   6940             NTIM(I,IS) = MIN1(20.,20.*ABS(TIM(I,IS))/XINC(I,2))
   6941             IF(ITIME.EQ.2) THEN
   6942               XTIM(I,IS) = (TOB(L)-TFC(L)-AVGI(I,2))
   6943      &                     /MAX(.1*XINC(I,2),STDI(I,2))
   6944             ENDIF
   6945           ENDIF
   6946           IF(TDO(L).LT.BMISS .AND. TDFC(L).LT.BMISS

Page 223         Source Listing                  INCR
2017-04-18 11:07                                 cqcbufr.f

   6947      &      .AND. TOB(L).LT.BMISS) THEN
   6948             TDIM(I,IS) = TDO(L) - TDFC(L)
   6949             NTDIM(I,IS)= MIN1(20.,20.*ABS(TDIM(I,IS))/XINC(I,3))
   6950             IF(ITIME.EQ.2) THEN
   6951             XTDIM(I,IS)= (TDIM(I,IS)-AVGI(I,3))
   6952      &                   /MAX(.1*XINC(I,3),STDI(I,3))
   6953             ENDIF
   6954           ENDIF
   6955           IF(QOB(L).LT.BMISS .AND. QFC(L).LT.BMISS) THEN
   6956             QIM(I,IS)  = QOB(L) - QFC(L)
   6957             IF(ITIME.EQ.2) THEN
   6958             XQIM(I,IS) = (ABS(QOB(L)-QFC(L)-AVGI(I,4)))
   6959      &                   /MAX(.1*XINC(I,4),STDI(I,4))
   6960             ENDIF
   6961           ENDIF
   6962         ENDIF
   6963 
   6964         J = NMANLV(POB(L))        ! index of nearest mand lvl
   6965 	IF(J.NE.0) THEN
   6966           IF(POB(L).LT.BMISS .AND. PFC(L).LT.BMISS) THEN
   6967             PI(L)   = POB(L) - PFC(L)
   6968           ENDIF
   6969           IF(ZOB(L).LT.BMISS .AND. ZFC(L).LT.BMISS) THEN
   6970             ZI(L)   = ZOB(L) - ZFC(L)
   6971             NZI(L)  = MIN1(20.,20.*ABS(ZI(L))/XINC(J,1))
   6972             IF(ITIME.EQ.2) THEN
   6973               XZI(L)  = (ZOB(L)-ZFC(L)-AVGI(J,1))
   6974      &                  /MAX(.1*XINC(J,1),STDI(J,1))
   6975             ENDIF
   6976           ENDIF
   6977           IF(TOB(L).LT.BMISS .AND. TFC(L).LT.BMISS) THEN
   6978             TI(L)   = TOB(L) - TFC(L)
   6979             NTI(L)  = MIN1(20.,20.*ABS(TI(L))/XINC(J,2))
   6980             IF(ITIME.EQ.2) THEN
   6981               XTI(L)  = (TOB(L)-TFC(L)-AVGI(J,2))
   6982      &                  /MAX(.1*XINC(J,2),STDI(J,2))
   6983             ENDIF
   6984           ENDIF
   6985           IF(TDO(L).LT.BMISS .AND. TDFC(L).LT.BMISS
   6986      &      .AND. TOB(L).LT.BMISS) THEN
   6987             TDI(L)  = TDO(L) - TDFC(L)
   6988             NTDI(L) = MIN1(20.,20.*ABS(TDI(L))/XINC(J,3))
   6989             IF(ITIME.EQ.2) THEN
   6990               XTDI(L) = (TDI(L)-AVGI(J,3))
   6991      &                  /MAX(.1*XINC(J,3),STDI(J,3))
   6992             ENDIF
   6993           ENDIF
   6994           IF(QOB(L).LT.BMISS .AND. QFC(L).LT.BMISS) THEN
   6995             QI(L)   = QOB(L) - QFC(L)
   6996             NQI(L)  = MIN1(20.,20.*ABS(QI(L))/XINC(J,4))
   6997             IF(ITIME.EQ.2) THEN
   6998               XQI(L)  = (QOB(L)-QFC(L)-AVGI(J,4))
   6999      &                  /MAX(.1*XINC(J,4),STDI(J,4))
   7000             ENDIF
   7001           ENDIF
   7002         ENDIF
   7003       ENDDO

Page 224         Source Listing                  INCR
2017-04-18 11:07                                 cqcbufr.f

   7004 
   7005       RETURN
   7006       END


ENTRY POINTS

  Name             
                   
 incr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  6922                                                                                             
 ABS                        Func   6932                                 scalar                    6932,6940,6949,6958,6971,6979,6988
                                                                                                  ,6996                             
 ALLSND                     Common 6806                                 34512                                                       
 AVGB                       Scalar 6841     R(4)            4           scalar   COM                                                
 AVGH                       Scalar 6837     R(4)            4     2     147      COM                                                
 AVGHY                      Scalar 6840     R(4)            4     1     21       COM                                                
 AVGI                       Scalar 6838     R(4)            4     2     147      COM              6934,6942,6951,6958,6973,6981,6990
                                                                                                  ,6998                             
 AVGT                       Scalar 6839     R(4)            4     2     84       COM                                                
 AVGV                       Scalar 6836     R(4)            4     2     147      COM                                                
 B                          Scalar 6822     R(4)            4     1     21       COM                                                
 BASRES                     Scalar 6821     R(4)            4     1     999      COM                                                
 BMISS                      Scalar 6804     R(8)            8           scalar   COM              6867,6868,6869,6870,6871,6872,6873
                                                                                                  ,6874,6875,6884,6885,6886,6887,689
                                                                                                  4,6895,6896,6897,6898,6904,6905,69
                                                                                                  06,6907,6923,6930,6938,6946,6947,6
                                                                                                  955,6966,6969,6977,6985,6986,6994 
 BRES                       Scalar 6835     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 6854                                 16                                                          
 CAT                        Scalar 6811     R(4)            4     1     255      COM                                                
 CQCPC                      Scalar 6852     R(4)            4           scalar   COM                                                
 ERROR                      Scalar 6835     L(4)            4     1     999      COM                                                
 GESPS                      Scalar 6812     R(4)            4     1     999      COM              6923,6924                         
 HOIRES                     Scalar 6848     R(4)            4     2     84       COM                                                
 HRDR                       Scalar 6812     R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 6848     R(4)            4     1     21       COM                                                
 HYD                        Scalar 6820     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 6835     R(4)            4     2     20979    COM              6875                              
 HYDN                       Scalar 6820     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 6820     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 6820     R(4)            4     1     21       COM                                                
 I                          Local  6879     I(4)            4           scalar                    6879,6880,6881,6882,6884,6885,6886
                                                                                                  ,6887,6893,6894,6895,6896,6897,689
                                                                                                  8,6899,6900,6901,6902,6904,6905,69
                                                                                                  06,6907,6912,6913,6928,6929,6931,6
                                                                                                  932,6934,6935,6939,6940,6942,6943,
                                                                                                  6948,6949,6951,6952,6956,6958,6959
 IHSC                       Scalar 6821     I(4)            4     2     1020     COM              6913                              
 IMISS                      Scalar 6854     I(4)            4           scalar   COM                                                
 INCR                       Subr   6801                                                                                             

Page 225         Source Listing                  INCR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IND                        Scalar 6811     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 6852     I(4)            4           scalar   COM                                                
 IS                         Scalar 6853     I(4)            4           scalar   COM              6864,6917,6923,6924,6931,6932,6934
                                                                                                  ,6939,6940,6942,6948,6949,6951,695
                                                                                                  6,6958                            
 ISC                        Scalar 6852     I(4)            4           scalar   COM                                                
 ISTART                     Local  6859     I(4)            4           scalar                    6859,6864,6891                    
 ITIME                      Dummy  6801     I(4)            4           scalar   ARG,INOUT        6883,6903,6933,6941,6950,6957,6972
                                                                                                  ,6980,6989,6997                   
 J                          Local  6964     I(4)            4           scalar                    6964,6965,6971,6973,6974,6979,6981
                                                                                                  ,6982,6988,6990,6991,6996,6998,699
                                                                                                  9                                 
 L                          Local  6866     I(4)            4           scalar                    6866,6867,6868,6869,6870,6871,6872
                                                                                                  ,6873,6874,6875,6911,6913,6926,692
                                                                                                  8,6930,6931,6934,6938,6939,6942,69
                                                                                                  46,6947,6948,6955,6956,6958,6964,6
                                                                                                  966,6967,6969,6970,6971,6973,6977,
                                                                                                  6978,6979,6981,6985,6986,6987,6988
                                                                                                  ,6990,6994,6995,6996,6998         
 LEVTYP                     Scalar 6811     I(4)            4     1     255      COM                                                
 LIMS                       Common 6848                                 1776                                                        
 LMAND                      Scalar 6852     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 6852     I(4)            4           scalar   COM                                                
 LST                        Scalar 6812     I(4)            4     1     255      COM                                                
 MAND                       Scalar 6851     I(4)            4           scalar   COM              6866,6879                         
 MANLEV                     Func   6928     I(4)            4           scalar                    6928                              
 MANRES                     Common 6824                                 2949048                                                     
 MAX                        Func   6935                                 scalar                    6935,6943,6952,6959,6974,6982,6991
                                                                                                  ,6999                             
 MIN1                       Func   6932                                 scalar                    6932,6940,6949,6971,6979,6988,6996
 N                          Local  6865     I(4)            4           scalar                    6865,6867,6868,6869,6870,6871,6872
                                                                                                  ,6873,6874,6875,6878,6880,6881,688
                                                                                                  2,6884,6885,6886,6887             
 NB                         Scalar 6841     I(4)            4           scalar   COM                                                
 NBAS                       Scalar 6822     I(4)            4           scalar   COM                                                
 NH                         Scalar 6837     I(4)            4     2     147      COM                                                
 NHLIM                      Scalar 6850     I(4)            4           scalar   COM                                                
 NHY                        Scalar 6840     I(4)            4     1     21       COM                                                
 NHYD                       Scalar 6820     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 6822     I(4)            4     1     21       COM                                                
 NI                         Scalar 6838     I(4)            4     2     147      COM                                                
 NLEV                       Scalar 6851     I(4)            4           scalar   COM              6926                              
 NMANLV                     Func   6964     I(4)            4           scalar                    6964                              
 NOBS                       Scalar 6851     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 6832     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 6816     I(4)            4     1     255      COM              6902,6996                         
 NQV                        Scalar 6818     I(4)            4     1     255      COM                                                
 NST                        Param  6802     I(4)            4           scalar                    6812,6821,6824,6825,6826,6827,6828
                                                                                                  ,6829,6830,6831,6832,6833,6834,683
                                                                                                  5,6865,6878                       
 NT                         Scalar 6839     I(4)            4     2     84       COM                                                
 NTDHM                      Scalar 6832     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 6816     I(4)            4     1     255      COM              6901,6988                         
 NTDIM                      Scalar 6827     I(4)            4     2     20979    COM              6882,6949                         
 NTDV                       Scalar 6818     I(4)            4     1     255      COM                                                

Page 226         Source Listing                  INCR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTHM                       Scalar 6830     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 6816     I(4)            4     1     255      COM              6900,6979                         
 NTIM                       Scalar 6827     I(4)            4     2     20979    COM              6881,6940                         
 NTL                        Scalar 6818     I(4)            4     1     255      COM                                                
 NTV                        Scalar 6818     I(4)            4     1     255      COM                                                
 NV                         Scalar 6836     I(4)            4     2     147      COM                                                
 NZHM                       Scalar 6830     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 6816     I(4)            4     1     255      COM              6899,6971                         
 NZIM                       Scalar 6827     I(4)            4     2     20979    COM              6880,6932                         
 NZV                        Scalar 6818     I(4)            4     1     255      COM                                                
 PARAMS                     Common 6851                                 148                                                         
 PFC                        Scalar 6806     R(4)            4     1     255      COM              6966,6967                         
 PI                         Scalar 6814     R(4)            4     1     255      COM              6894,6967                         
 PIS                        Scalar 6835     R(4)            4     1     999      COM              6924                              
 POB                        Scalar 6806     R(4)            4     1     255      COM              6928,6964,6966,6967               
 PQM                        Scalar 6806     R(4)            4     1     255      COM                                                
 PRC                        Scalar 6806     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 6852     L(4)            4           scalar   COM                                                
 PS                         Scalar 6812     R(4)            4     1     999      COM              6923,6924                         
 PSINC                      Scalar 6821     R(4)            4           scalar   COM                                                
 QFC                        Scalar 6810     R(4)            4     1     255      COM              6955,6956,6958,6994,6995,6998     
 QG                         Scalar 6834     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 6825     R(4)            4     2     20979    COM                                                
 QI                         Scalar 6814     R(4)            4     1     255      COM              6898,6995,6996                    
 QIM                        Scalar 6824     R(4)            4     2     20979    COM              6870,6956                         
 QOB                        Scalar 6810     R(4)            4     1     255      COM              6955,6956,6958,6994,6995,6998     
 QQM                        Scalar 6810     R(4)            4     1     255      COM                                                
 QRC                        Scalar 6810     R(4)            4     1     255      COM                                                
 QV                         Scalar 6815     R(4)            4     1     255      COM                                                
 QVM                        Scalar 6826     R(4)            4     2     20979    COM              6874                              
 RADPC                      Scalar 6851     R(4)            4           scalar   COM                                                
 RESID                      Common 6814                                 41312                                                       
 SID                        Local  6856     CHAR            8           scalar                                                      
 SKB                        Scalar 6847     R(4)            4           scalar   COM                                                
 SKH                        Scalar 6843     R(4)            4     2     147      COM                                                
 SKHY                       Scalar 6846     R(4)            4     1     21       COM                                                
 SKI                        Scalar 6844     R(4)            4     2     147      COM                                                
 SKT                        Scalar 6845     R(4)            4     2     84       COM                                                
 SKV                        Scalar 6842     R(4)            4     2     147      COM                                                
 STATS                      Common 6836                                 10940                                                       
 STDB                       Scalar 6841     R(4)            4           scalar   COM                                                
 STDH                       Scalar 6837     R(4)            4     2     147      COM                                                
 STDHY                      Scalar 6840     R(4)            4     1     21       COM                                                
 STDI                       Scalar 6838     R(4)            4     2     147      COM              6935,6943,6952,6959,6974,6982,6991
                                                                                                  ,6999                             
 STDT                       Scalar 6839     R(4)            4     2     84       COM                                                
 STDV                       Scalar 6836     R(4)            4     2     147      COM                                                
 STN                        Common 6853                                 4                                                           
 TCLIM                      Scalar 6850     R(4)            4           scalar   COM                                                
 TDFC                       Scalar 6809     R(4)            4     1     255      COM              6946,6948,6985,6987               
 TDG                        Scalar 6834     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 6825     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 6814     R(4)            4     1     255      COM              6897,6987,6988,6990               
 TDIM                       Scalar 6824     R(4)            4     2     20979    COM              6869,6948,6949,6951               
 TDO                        Scalar 6809     R(4)            4     1     255      COM              6946,6948,6985,6987               

Page 227         Source Listing                  INCR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TDV                        Scalar 6815     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 6826     R(4)            4     2     20979    COM              6873                              
 TFACT                      Scalar 6849     R(4)            4     2     84       COM                                                
 TFC                        Scalar 6808     R(4)            4     1     255      COM              6938,6939,6942,6977,6978,6981     
 TG                         Scalar 6834     L(4)            4     2     20979    COM                                                
 THM                        Scalar 6825     R(4)            4     2     20979    COM                                                
 TI                         Scalar 6814     R(4)            4     1     255      COM              6896,6978,6979                    
 TIM                        Scalar 6824     R(4)            4     2     20979    COM              6868,6939,6940                    
 TL                         Scalar 6815     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 6821     R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 6849     R(4)            4     2     84       COM                                                
 TOB                        Scalar 6808     R(4)            4     1     255      COM              6938,6939,6942,6947,6977,6978,6981
                                                                                                  ,6986                             
 TQM                        Scalar 6808     R(4)            4     1     255      COM                                                
 TRC                        Scalar 6808     R(4)            4     1     255      COM                                                
 TT                         Scalar 6852     R(4)            4           scalar   COM                                                
 TV                         Scalar 6815     R(4)            4     1     255      COM                                                
 TVM                        Scalar 6826     R(4)            4     2     20979    COM              6872                              
 TVO                        Scalar 6809     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 6849     R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 6851     R(4)            4           scalar   COM                                                
 XDR                        Scalar 6813     R(4)            4     1     255      COM                                                
 XINC                       Scalar 6848     R(4)            4     2     84       COM              6932,6935,6940,6943,6949,6952,6959
                                                                                                  ,6971,6974,6979,6982,6988,6991,699
                                                                                                  6,6999                            
 XKB                        Scalar 6847     R(4)            4           scalar   COM                                                
 XKH                        Scalar 6843     R(4)            4     2     147      COM                                                
 XKHY                       Scalar 6846     R(4)            4     1     21       COM                                                
 XKI                        Scalar 6844     R(4)            4     2     147      COM                                                
 XKT                        Scalar 6845     R(4)            4     2     84       COM                                                
 XKV                        Scalar 6842     R(4)            4     2     147      COM                                                
 XMA                        Scalar 6851     R(4)            4           scalar   COM                                                
 XMI                        Scalar 6851     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 6854     R(4)            4           scalar   COM                                                
 XQHM                       Scalar 6833     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 6817     R(4)            4     1     255      COM              6907,6998                         
 XQIM                       Scalar 6829     R(4)            4     2     20979    COM              6887,6958                         
 XQV                        Scalar 6819     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 6823     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 6832     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 6817     R(4)            4     1     255      COM              6906,6990                         
 XTDIM                      Scalar 6828     R(4)            4     2     20979    COM              6886,6951                         
 XTDV                       Scalar 6819     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 6831     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 6822     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 6831     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 6817     R(4)            4     1     255      COM              6905,6981                         
 XTIM                       Scalar 6828     R(4)            4     2     20979    COM              6885,6942                         
 XTV                        Scalar 6819     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 6829     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 6822     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 6830     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 6817     R(4)            4     1     255      COM              6904,6973                         
 XZIM                       Scalar 6828     R(4)            4     2     20979    COM              6884,6934                         
 XZV                        Scalar 6819     R(4)            4     1     255      COM                                                

Page 228         Source Listing                  INCR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XZVM                       Scalar 6829     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 6813     R(4)            4     1     255      COM                                                
 YMA                        Scalar 6851     R(4)            4           scalar   COM                                                
 YMI                        Scalar 6851     R(4)            4           scalar   COM                                                
 ZCLIM                      Scalar 6850     R(4)            4           scalar   COM                                                
 ZD                         Scalar 6822     R(4)            4     1     255      COM                                                
 ZFC                        Scalar 6807     R(4)            4     1     255      COM              6930,6931,6934,6969,6970,6973     
 ZG                         Scalar 6834     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 6825     R(4)            4     2     20979    COM                                                
 ZI                         Scalar 6814     R(4)            4     1     255      COM              6895,6970,6971                    
 ZIM                        Scalar 6824     R(4)            4     2     20979    COM              6867,6931,6932                    
 ZOB                        Scalar 6807     R(4)            4     1     255      COM              6930,6931,6934,6969,6970,6973     
 ZQM                        Scalar 6807     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 6807     R(4)            4     1     255      COM                                                
 ZV                         Scalar 6815     R(4)            4     1     255      COM                                                
 ZVM                        Scalar 6826     R(4)            4     2     20979    COM              6871                              

Page 229         Source Listing                  INCR
2017-04-18 11:07                                 cqcbufr.f

   7007 
   7008 C******************************************************************
   7009 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7010 C                .      .    .                                       .
   7011 C SUBPROGRAM:    INCRW       CALCULATE INCREMENTS
   7012 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   7013 C
   7014 C ABSTRACT: Calculate increments for all wind variables.
   7015 C
   7016 C PROGRAM HISTORY LOG:
   7017 C 1997-03-18  W. Collins  Original author.
   7018 C
   7019 C USAGE:    CALL INCRW
   7020 C
   7021 C REMARKS: NONE.
   7022 C
   7023 C ATTRIBUTES:
   7024 C   LANGUAGE: FORTRAN 90
   7025 C   MACHINE:  NCEP WCOSS
   7026 C
   7027 C$$$
   7028 
   7029       SUBROUTINE INCRW
   7030       PARAMETER (NST=999)
   7031 
   7032       REAL(8) BMISS
   7033 
   7034       COMMON /ALSNDW/  POBW(255), PFCW(255), PQMW(255), PRCW(255),
   7035      &                 ZOBW(255), ZFCW(255), ZQMW(255), ZRCW(255),
   7036      &                 UOB(255),  VOB(255),  UFC(255),  VFC(255),
   7037      &                 WQM(255),  WRC(255),  SP(255),   DIR(255),
   7038      &                 CATW(255)
   7039       COMMON /MANRSW/  UIM(21,NST), VIM(21,NST), SPIM(21,NST),
   7040      &                 DIRIM(21,NST)
   7041       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   7042      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   7043       COMMON /STN/     IS
   7044       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   7045 
   7046       CHARACTER*8      SID
   7047       LOGICAL PRNT
   7048 
   7049       DATA ISTART /0/
   7050       BMIS = 0.5*BMISS
   7051 
   7052 C  INITIALIZE VALUES (INCLUDING SOME NON-INCREMENT FIELDS)
   7053 C  -------------------------------------------------------
   7054 
   7055       IF(ISTART.EQ.0 .OR. IS.EQ.1) THEN
   7056         DO N=1,NST
   7057           DO L=1,21
   7058             UIM(L,N)   = BMISS
   7059             VIM(L,N)   = BMISS
   7060             SPIM(L,N)  = BMISS
   7061             DIRIM(L,N) = BMISS
   7062           ENDDO
   7063         ENDDO

Page 230         Source Listing                  INCRW
2017-04-18 11:07                                 cqcbufr.f

   7064         ISTART = 1
   7065       ENDIF
   7066 
   7067       IF(IS.EQ.0) RETURN
   7068 
   7069 C  CALCULATE INCREMENTS.
   7070 C  ---------------------
   7071 
   7072       DO L=1,NLEV
   7073 
   7074         I = MANLEV(POBW(L))
   7075         IF(I.NE.0) THEN
   7076           IF(UOB(L).LT.BMIS .AND. UFC(L).LT.BMIS) THEN
   7077             UIM(I,IS)  = UOB(L) - UFC(L)
   7078           ENDIF
   7079           IF(VOB(L).LT.BMIS .AND. VFC(L).LT.BMIS) THEN
   7080             VIM(I,IS)  = VOB(L) - VFC(L)
   7081           ENDIF
   7082           IF(UFC(L).LT.BMIS .AND. VFC(L).LT.BMIS) THEN
   7083             IF(VFC(L).EQ.0.) VFC(L) = .01
   7084             CALL W3FC05(-UFC(L),-VFC(L),DIRFC,SPFC)
   7085             IF(SP(L).LT.BMIS) THEN
   7086               SPIM(I,IS)  = SP(L) - SPFC
   7087             ENDIF
   7088             IF(DIR(L).LT.BMIS) THEN
   7089               DIRIM(I,IS)  = AMOD(DIR(L)-DIRFC+360.,360.)
   7090               IF(DIRIM(I,IS).GT.180.) DIRIM(I,IS) = DIRIM(I,IS)-360.
   7091             ENDIF
   7092           ENDIF
   7093         ENDIF
   7094       ENDDO
   7095 
   7096       RETURN
   7097       END

Page 231         Source Listing                  INCRW
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 incrw_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALSNDW                     Common 7034                                 17340                                                       
 AMOD                       Func   7089                                 scalar                    7089                              
 BMIS                       Local  7050     R(4)            4           scalar                    7050,7076,7079,7082,7085,7088     
 BMISS                      Scalar 7032     R(8)            8           scalar   COM              7050,7058,7059,7060,7061          
 BUFRLIB_MISSING            Common 7044                                 16                                                          
 CATW                       Scalar 7038     R(4)            4     1     255      COM                                                
 CQCPC                      Scalar 7042     R(4)            4           scalar   COM                                                
 DIR                        Scalar 7037     R(4)            4     1     255      COM              7088,7089                         
 DIRFC                      Local  7084     R(4)            4           scalar                    7084,7089                         
 DIRIM                      Scalar 7040     R(4)            4     2     20979    COM              7061,7089,7090                    
 I                          Local  7074     I(4)            4           scalar                    7074,7075,7077,7080,7086,7089,7090
 IMISS                      Scalar 7044     I(4)            4           scalar   COM                                                
 INCRW                      Subr   7029                                                                                             
 IPEVT                      Scalar 7042     I(4)            4           scalar   COM                                                
 IS                         Scalar 7043     I(4)            4           scalar   COM              7055,7067,7077,7080,7086,7089,7090
 ISC                        Scalar 7042     I(4)            4           scalar   COM                                                
 ISTART                     Local  7049     I(4)            4           scalar                    7049,7055,7064                    
 L                          Local  7057     I(4)            4           scalar                    7057,7058,7059,7060,7061,7072,7074
                                                                                                  ,7076,7077,7079,7080,7082,7083,708
                                                                                                  4,7085,7086,7088,7089             
 LMAND                      Scalar 7042     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 7042     I(4)            4           scalar   COM                                                
 MAND                       Scalar 7041     I(4)            4           scalar   COM                                                
 MANLEV                     Func   7074     I(4)            4           scalar                    7074                              
 MANRSW                     Common 7039                                 335664                                                      
 N                          Local  7056     I(4)            4           scalar                    7056,7058,7059,7060,7061          
 NLEV                       Scalar 7041     I(4)            4           scalar   COM              7072                              
 NOBS                       Scalar 7041     I(4)            4           scalar   COM                                                
 NST                        Param  7030     I(4)            4           scalar                    7039,7040,7056                    
 PARAMS                     Common 7041                                 148                                                         
 PFCW                       Scalar 7034     R(4)            4     1     255      COM                                                
 POBW                       Scalar 7034     R(4)            4     1     255      COM              7074                              
 PQMW                       Scalar 7034     R(4)            4     1     255      COM                                                
 PRCW                       Scalar 7034     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 7042     L(4)            4           scalar   COM                                                
 RADPC                      Scalar 7041     R(4)            4           scalar   COM                                                
 SID                        Local  7046     CHAR            8           scalar                                                      
 SP                         Scalar 7037     R(4)            4     1     255      COM              7085,7086                         
 SPFC                       Local  7084     R(4)            4           scalar                    7084,7086                         
 SPIM                       Scalar 7039     R(4)            4     2     20979    COM              7060,7086                         
 STN                        Common 7043                                 4                                                           
 TT                         Scalar 7042     R(4)            4           scalar   COM                                                
 UFC                        Scalar 7036     R(4)            4     1     255      COM              7076,7077,7082,7084               
 UIM                        Scalar 7039     R(4)            4     2     20979    COM              7058,7077                         

Page 232         Source Listing                  INCRW
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UOB                        Scalar 7036     R(4)            4     1     255      COM              7076,7077                         
 VFC                        Scalar 7036     R(4)            4     1     255      COM              7079,7080,7082,7083,7084          
 VIM                        Scalar 7039     R(4)            4     2     20979    COM              7059,7080                         
 VOB                        Scalar 7036     R(4)            4     1     255      COM              7079,7080                         
 VTPPC                      Scalar 7041     R(4)            4           scalar   COM                                                
 W3FC05                     Subr   7084                                                           7084                              
 WQM                        Scalar 7037     R(4)            4     1     255      COM                                                
 WRC                        Scalar 7037     R(4)            4     1     255      COM                                                
 XMA                        Scalar 7041     R(4)            4           scalar   COM                                                
 XMI                        Scalar 7041     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 7044     R(4)            4           scalar   COM                                                
 YMA                        Scalar 7041     R(4)            4           scalar   COM                                                
 YMI                        Scalar 7041     R(4)            4           scalar   COM                                                
 ZFCW                       Scalar 7035     R(4)            4     1     255      COM                                                
 ZOBW                       Scalar 7035     R(4)            4     1     255      COM                                                
 ZQMW                       Scalar 7035     R(4)            4     1     255      COM                                                
 ZRCW                       Scalar 7035     R(4)            4     1     255      COM                                                

Page 233         Source Listing                  INCRW
2017-04-18 11:07                                 cqcbufr.f

   7098 
   7099 C******************************************************************
   7100 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7101 C                .      .    .                                       .
   7102 C SUBPROGRAM:    INIT        INITIALIZE HORIZONTAL RESIDUALS.
   7103 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-12-09
   7104 C
   7105 C ABSTRACT: Initailize horizontal residuals when they will not be
   7106 C   calculated by the horizontal check.
   7107 C
   7108 C PROGRAM HISTORY LOG:
   7109 C 1997-12-09  W. Collins  Original author.
   7110 C
   7111 C USAGE:    CALL INIT
   7112 C
   7113 C REMARKS: NONE.
   7114 C
   7115 C ATTRIBUTES:
   7116 C   LANGUAGE: FORTRAN 90
   7117 C   MACHINE:  NCEP WCOSS
   7118 C
   7119 C$$$
   7120       SUBROUTINE INIT
   7121       PARAMETER (NST=999)
   7122 
   7123       REAL(8) BMISS
   7124 
   7125       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   7126      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   7127      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   7128      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   7129      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   7130      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   7131      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   7132      &                 XTHM(21,NST),XTDVM(21,NST),
   7133      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   7134      &                 XQHM(21,NST),
   7135      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   7136      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   7137       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   7138 
   7139       LOGICAL ZG, TG, TDG, QG, ERROR
   7140       DO J=1,NST
   7141         DO I=1,21
   7142           ZHM(I,J)  = BMISS
   7143           THM(I,J)  = BMISS
   7144           TDHM(I,J) = BMISS
   7145           QHM(I,J)  = BMISS
   7146         ENDDO
   7147       ENDDO
   7148       RETURN
   7149       END

Page 234         Source Listing                  INIT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 init_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 7123     R(8)            8           scalar   COM              7142,7143,7144,7145               
 BRES                       Scalar 7136     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 7137                                 16                                                          
 ERROR                      Scalar 7136     L(4)            4     1     999      COM                                                
 HYDM                       Scalar 7136     R(4)            4     2     20979    COM                                                
 I                          Local  7141     I(4)            4           scalar                    7141,7142,7143,7144,7145          
 IMISS                      Scalar 7137     I(4)            4           scalar   COM                                                
 INIT                       Subr   7120                                                                                             
 J                          Local  7140     I(4)            4           scalar                    7140,7142,7143,7144,7145          
 MANRES                     Common 7125                                 2949048                                                     
 NQHM                       Scalar 7133     I(4)            4     2     20979    COM                                                
 NST                        Param  7121     I(4)            4           scalar                    7125,7126,7127,7128,7129,7130,7131
                                                                                                  ,7132,7133,7134,7135,7136,7140    
 NTDHM                      Scalar 7133     I(4)            4     2     20979    COM                                                
 NTDIM                      Scalar 7128     I(4)            4     2     20979    COM                                                
 NTHM                       Scalar 7131     I(4)            4     2     20979    COM                                                
 NTIM                       Scalar 7128     I(4)            4     2     20979    COM                                                
 NZHM                       Scalar 7131     I(4)            4     2     20979    COM                                                
 NZIM                       Scalar 7128     I(4)            4     2     20979    COM                                                
 PIS                        Scalar 7136     R(4)            4     1     999      COM                                                
 QG                         Scalar 7135     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 7126     R(4)            4     2     20979    COM              7145                              
 QIM                        Scalar 7125     R(4)            4     2     20979    COM                                                
 QVM                        Scalar 7127     R(4)            4     2     20979    COM                                                
 TDG                        Scalar 7135     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 7126     R(4)            4     2     20979    COM              7144                              
 TDIM                       Scalar 7125     R(4)            4     2     20979    COM                                                
 TDVM                       Scalar 7127     R(4)            4     2     20979    COM                                                
 TG                         Scalar 7135     L(4)            4     2     20979    COM                                                
 THM                        Scalar 7126     R(4)            4     2     20979    COM              7143                              
 TIM                        Scalar 7125     R(4)            4     2     20979    COM                                                
 TVM                        Scalar 7127     R(4)            4     2     20979    COM                                                
 XMISS                      Scalar 7137     R(4)            4           scalar   COM                                                
 XQHM                       Scalar 7134     R(4)            4     2     20979    COM                                                
 XQIM                       Scalar 7130     R(4)            4     2     20979    COM                                                
 XTDHM                      Scalar 7133     R(4)            4     2     20979    COM                                                
 XTDIM                      Scalar 7129     R(4)            4     2     20979    COM                                                
 XTDVM                      Scalar 7132     R(4)            4     2     20979    COM                                                
 XTHM                       Scalar 7132     R(4)            4     2     20979    COM                                                
 XTIM                       Scalar 7129     R(4)            4     2     20979    COM                                                
 XTVM                       Scalar 7130     R(4)            4     2     20979    COM                                                
 XZHM                       Scalar 7131     R(4)            4     2     20979    COM                                                
 XZIM                       Scalar 7129     R(4)            4     2     20979    COM                                                
 XZVM                       Scalar 7130     R(4)            4     2     20979    COM                                                

Page 235         Source Listing                  INIT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZG                         Scalar 7135     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 7126     R(4)            4     2     20979    COM              7142                              
 ZIM                        Scalar 7125     R(4)            4     2     20979    COM                                                
 ZVM                        Scalar 7127     R(4)            4     2     20979    COM                                                

Page 236         Source Listing                  INIT
2017-04-18 11:07                                 cqcbufr.f

   7150 
   7151 C***************************************************************
   7152 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7153 C                .      .    .                                       .
   7154 C SUBPROGRAM:    INPUT       READ INPUT FOR ONE STATION
   7155 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   7156 C
   7157 C ABSTRACT: Read input for one station.
   7158 C
   7159 C PROGRAM HISTORY LOG:
   7160 C 1997-03-18  W. Collins  Original author.
   7161 C 2001-05-11  W. Collins  Convert guess temperature from Tv to T,
   7162 C     so that the residuals are comparing comparable quantities.
   7163 C
   7164 C USAGE:    CALL INPUT(START,ENDIN,SKIP,SAME,WIND,ITIME,USESQN)
   7165 C   INPUT ARGUMENT LIST:
   7166 C     START    - TRUE ON FIRST CALL
   7167 C     ENDIN    - TRUE AT END OF INPUT
   7168 C     SKIP     - TRUE FOR STATIONS TO SKIP (OUT OF REGION, ETC.)
   7169 C     SAME     - TRUE WHEN WIND PART GOES WITH PREVIOUSL READ
   7170 C                MASS PART
   7171 C     WIND     - TRUE FOR WIND PART OF REPORT
   7172 C     ITIME    - 1 - FIRST CALL TO INPUT FOR STATION
   7173 C                2 - SECOND CALL TO INPUT FOR STATION
   7174 C     USESQN   - TRUE WHEN SQN IS USED TO FIT PARTS OF REPORT 
   7175 C                TOGETHER
   7176 C
   7177 C   OUTPUT ARGUMENT LIST:
   7178 C   INPUT ARGUMENT LIST:
   7179 C     START    - TRUE ON FIRST CALL
   7180 C     ENDIN    - TRUE AT END OF INPUT
   7181 C     SKIP     - TRUE FOR STATIONS TO SKIP (OUT OF REGION, ETC.)
   7182 C     SAME     - TRUE WHEN WIND PART GOES WITH PREVIOUSLY READ
   7183 C                MASS PART
   7184 C     WIND     - TRUE FOR WIND PART OF REPORT
   7185 C
   7186 C   INPUT FILES:
   7187 C     UNIT NFIN - UNIT NUMBER OF INPUT PREPBUFR FILE
   7188 C
   7189 C   OUTPUT FILES:
   7190 C     UNIT NFOUT - UNIT NUMBER OF OUTPUT PREPBUFR FILE
   7191 C     UNIT 06    - PRINTOUT
   7192 C     UNIT 60    - PRINT FILE, DETAILS OF DECISIONS
   7193 C
   7194 C REMARKS: NONE.
   7195 C
   7196 C ATTRIBUTES:
   7197 C   LANGUAGE: FORTRAN 90
   7198 C   MACHINE:  NCEP WCOSS
   7199 C
   7200 C$$$
   7201 
   7202       SUBROUTINE INPUT(START,ENDIN,SKIP,SAME,WIND,ITIME,USESQN)
   7203       SAVE
   7204       PARAMETER (NST=999)      ! maximum number of stations
   7205       PARAMETER (MVO=5)        ! p,T,z,q,Td
   7206       PARAMETER (MLV=255)      ! number of possible levels

Page 237         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7207       PARAMETER (MEV=13)       ! number of possible programs/events
   7208       PARAMETER (MP=0)         ! program code for data
   7209 
   7210       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   7211      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   7212      &                 NEV, ISF(NST), NLVM, NLVW
   7213       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   7214      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   7215      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   7216      &                 TDO(255), TDFC(255),TVO(255),
   7217      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   7218      &                 CAT(255), IND(255), LEVTYP(255),
   7219      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   7220      &                 YDR(255), XDR(255)
   7221       COMMON /MANSND/  ZM(21,NST), TM(21,NST), TDM(21), QM(21), MANDL,
   7222      &                 MANDF, ZFM(21), TFM(21), QFM(21), PM(21)
   7223       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   7224      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   7225      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   7226      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   7227      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   7228      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   7229      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   7230      &                 XTHM(21,NST),XTDVM(21,NST),
   7231      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   7232      &                 XQHM(21,NST),
   7233      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   7234      &                 PIS(NST),   HYDM(21,NST),BRES(NST),ERROR(NST)
   7235       COMMON /ALSNDW/  POBW(255), PFCW(255), PQMW(255), PRCW(255),
   7236      &                 ZOBW(255), ZFCW(255), ZQMW(255), ZRCW(255),
   7237      &                 UOB(255),  VOB(255),  UFC(255),  VFC(255),
   7238      &                 WQM(255),  WRC(255),  SP(255),   DIR(255),
   7239      &                 CATW(255)
   7240       COMMON /DATEX/   JDATE(5), CDATE
   7241       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   7242      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   7243       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
   7244       COMMON /STN/     IS
   7245       COMMON /CONSTS/  R, G, T0, CP, RV
   7246       COMMON /STNKNT/  ISHIP,IBLK(100)
   7247       COMMON /TESTS/   TEST
   7248       LOGICAL          TEST, USESQN, PRNT
   7249       INTEGER          IV(255)
   7250       REAL(8)          BMISS,HDR_8(10),SF0_8(10),HDR2_8(10)
   7251       DIMENSION        OBS(MVO,MLV,0:MEV,4),
   7252      &                 FCST(10,255), QMKS(10,255),
   7253      &                 RCDS(10,255), OBSW(10,255), OBSW2(10,255),
   7254      &                 ZTMP(21),TTMP(21)
   7255 
   7256 C  OBS((p,T,z,q,Td),no. levs, no. prog/events,(obs,fcst,quality,reason))
   7257 C  ---------------------------------------------------------------------
   7258 
   7259       CHARACTER*8      SID, SUBSET, CDR(10), PRG(0:13)
   7260       CHARACTER*10     CDATE
   7261       CHARACTER*40     HSTR, OSTR, FCSTR, RCSTR, C1STR, CAT0,
   7262      &                 C1FSTR, OSTRW, OSTRW2
   7263       CHARACTER*50     OBSTR(2,5)

Page 238         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7264       LOGICAL          START, ENDIN, WIND, SKIP, SAME
   7265       LOGICAL          ZG, TG, TDG, QG, ERROR
   7266       EQUIVALENCE      (HDR_8,CDR)
   7267       INTEGER          IORDER(0:13)
   7268 
   7269       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   7270 
   7271       DATA IORDER /0,1,2,3,4,7,5,11,12,6,8,9,10,13/
   7272       DATA HSTR   /'SID XOB YOB DHR ELV ITP TYP T29 SQN     '/
   7273       DATA OSTR   /'POB ZOB TOB TDO QOB CAT                 '/
   7274       DATA FCSTR  /'PFC ZFC TFC QFC                         '/
   7275       DATA RCSTR  /'PRC ZRC TRC QRC                         '/
   7276       DATA C1STR  /'CAT=1 POB ZOB TOB TDO QOB CAT           '/
   7277       DATA C1FSTR /'CAT=1 PFC ZFC TFC     QFC               '/
   7278       DATA OSTRW  /'POB ZOB UOB VOB PFC ZFC UFC VFC PQM ZQM '/
   7279       DATA OSTRW2 /'WQM PRC ZRC WRC CAT                     '/
   7280       DATA CAT0   /'CAT=0 POB PFC                           '/
   7281       DATA OBSTR /'POB TOB ZOB QOB TDO' , 'POB UOB VOB ZOB ZOB',
   7282      &            'PFC TFC ZFC QFC QFC' , 'PFC UFC VFC ZFC ZFC',
   7283      &            'PQM TQM ZQM QQM QQM' , 'PQM WQM WQM ZQM ZQM',
   7284      &            'PPC TPC ZPC QPC QPC' , 'PPC WPC WPC ZPC ZPC',
   7285      &            'PRC TRC ZRC QRC QRC' , 'PRC WRC WRC ZRC ZRC'/
   7286       DATA PRG /' ','PREPRO','SYNDATA','CLIMO','PREVENT',
   7287      &          'PREPACQC','CQCHT','PROFCQC','CQCVAD','RADCOR',
   7288      &          'VIRTMP','OIQC','SSI','R3DVAR'/
   7289 
   7290       DATA PPI /57.29578/
   7291       DATA IPCNT /0/
   7292       BMAX = 0.5*BMISS
   7293 
   7294       ENDIN = .FALSE.
   7295       SKIP  = .FALSE.
   7296       WIND  = .FALSE.
   7297 
   7298 C  OPEN THE INPUT FILE
   7299 C  -------------------
   7300 
   7301       IF(START) THEN
   7302         CALL DATELEN(10)
   7303         CALL CLOSBF(NFIN)
   7304         REWIND NFIN
   7305         CALL OPENBF(NFIN,'IN',NFIN)
   7306         CALL READMG(NFIN,SUBSET,IDATE,IRETMG)
   7307         IF(IRETMG.NE.0) GOTO 6
   7308         WRITE(CDATE,'(I10)') IDATE
   7309         READ (CDATE,'(5I2)') JDATE
   7310         PRINT*,'DATA VALID AT ',CDATE
   7311         CALL UFBQCD(NFIN,'CQCHT',CQCPC)
   7312         CALL UFBQCD(NFIN,'VIRTMP',VTPPC)
   7313         CALL UFBQCD(NFIN,'RADCOR',RADPC)
   7314         CALL CLOSBF(NFIN)
   7315         REWIND NFIN
   7316         CALL OPENBF(NFIN,'IN',NFIN)
   7317         IF(ITIME.EQ.2) CALL OPENBF(NFOUT,'OUT',NFIN)
   7318         IS = 0
   7319         DO I=1,NST
   7320           SQN(I) = 0.

Page 239         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7321         ENDDO
   7322         SQNOLD = 0
   7323         SIDOLD = 0
   7324         START = .FALSE.
   7325         IRETSB = 1
   7326       ENDIF
   7327 
   7328 C  READ A REPORT
   7329 C  -------------
   7330 
   7331     5 CONTINUE
   7332       IF(IRETSB.NE.0) THEN
   7333         CALL READMG(NFIN,SUBSET,IDATE,IRETMG)
   7334         IF(TEST) WRITE(60,501) NFIN,SUBSET,IDATE,IRETMG
   7335   501   FORMAT(' INPUT--READMG CALLED: NFIN,SUBSET,IDATE,IRETMG = ',
   7336      &    I5,2X,A8,2X,I10,2X,I5)
   7337       ENDIF
   7338     6 IF(IRETMG.NE.0) THEN
   7339         ENDIN = .TRUE.
   7340         CALL CLOSBF(NFIN)
   7341         CALL CLOSBF(NFOUT)
   7342         RETURN
   7343       ENDIF
   7344 
   7345 C  UNPACK AN ADPUPA SUBSET
   7346 C  -----------------------
   7347 
   7348    10 CONTINUE
   7349       IF(ITIME.EQ.2) THEN
   7350         IF(SUBSET.NE.'ADPUPA') THEN
   7351           CALL CLOSMG(NFOUT)
   7352           CALL COPYMG(NFIN,NFOUT)
   7353           GOTO 5
   7354         ELSE
   7355           CALL OPENMB(NFOUT,SUBSET,IDATE)
   7356         ENDIF
   7357       ELSEIF(SUBSET.NE.'ADPUPA') THEN
   7358         GOTO 5
   7359       ENDIF
   7360       CALL READSB(NFIN,IRETSB)
   7361       IF(TEST) WRITE(60,502) IRETSB
   7362   502 FORMAT(' INPUT--READSB CALLED: IRETSB = ',I5)
   7363       IF(IRETSB.NE.0) GOTO 5
   7364       IF(ITIME.EQ.2) CALL UFBCPY(NFIN,NFOUT)
   7365 
   7366         CALL UFBINT(NFIN,HDR_8,10,  1,IRET,HSTR)
   7367         CALL UFBINT(NFIN,SF0_8,10,  1,ISF0,CAT0)
   7368 
   7369 C  SEVERAL CONDITIONALS FOR PROCESSING THE ADPUPA REPORTS
   7370 C  ------------------------------------------------------
   7371 
   7372         TYP     = HDR_8(7)
   7373         T29     = HDR_8(8)
   7374 
   7375         SKIP = SKIP .OR. HDR_8(2).LT.XMI. OR. HDR_8(2).GT.XMA
   7376      &    .OR. HDR_8(3).LT.YMI .OR. HDR_8(3).GT.YMA
   7377      &    .OR. T29.LT.11 .OR. (T29.GT.13.AND.T29.LT.21) .OR. T29.GT.23

Page 240         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7378      &    .OR. MOD(TYP,100.).NE.20
   7379 
   7380         WIND = TYP.GE.200
   7381         IF(WIND) THEN
   7382           IF(IS.EQ.0) IS = 1
   7383           ITP(IS) = 20000
   7384         ENDIF
   7385         IF(USESQN) THEN
   7386           IF(.NOT.WIND .AND. HDR_8(9).NE.SQNOLD) THEN
   7387             IS = IS + 1
   7388             SQNOLD = HDR_8(9)
   7389             SAME = .FALSE.
   7390           ELSE
   7391             SAME = .TRUE.
   7392           ENDIF
   7393         ELSE
   7394           IF(.NOT.WIND .AND. HDR_8(1).NE.SIDOLD) THEN
   7395             IS = IS + 1
   7396             SIDOLD = HDR_8(1)
   7397             SAME = .FALSE.
   7398           ELSE
   7399             SAME = .TRUE.
   7400           ENDIF
   7401         ENDIF
   7402 
   7403         IF(IS+1.GT.NST) THEN
   7404             PRINT *, 'MAXOBS (NST) EXCEEDED IN INPUT - STOP 99'
   7405             CALL W3TAGE('PREPOBS_CQCBUFR')
   7406             CALL ERREXIT(99)
   7407         ENDIF
   7408 
   7409         NOBS = IS
   7410         SID(IS) = CDR(1)
   7411         XOB(IS) = HDR_8(2)
   7412         YOB(IS) = HDR_8(3)
   7413         DHR(IS) = HDR_8(4)
   7414         ELV(IS) = HDR_8(5)
   7415         ITP(IS) = HDR_8(6)
   7416         SQN(IS) = HDR_8(9)
   7417         ISF(IS) = 0
   7418 
   7419         IF(.NOT.WIND .AND. ITIME.EQ.1) THEN
   7420           IDENT = 0
   7421           READ(SID(IS),'(I5)',ERR=15) IDENT
   7422 
   7423           IF(T29.LE.13) THEN
   7424             IBL = IDENT/1000
   7425             IF(IBL.EQ.0) IBL = 100
   7426             IBL = MIN(IBL,100)
   7427             IBLK(IBL) = IBLK(IBL)+1
   7428           ENDIF
   7429 
   7430 15        IF(IDENT.EQ.0) THEN
   7431              ISHIP = ISHIP + 1
   7432              IDENT = 10000 + ISHIP
   7433           ENDIF
   7434         ENDIF

Page 241         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7435 
   7436 C       WRITE(6,503) START,ITIME,IS,IDENT,SKIP
   7437         IF(TEST) WRITE(60,503) START,ITIME,IS,IDENT,SKIP
   7438   503   FORMAT(' INPUT--START,ITIME,IS,IDENT,SKIP: ',L2,3I8,L5)
   7439 
   7440 C  STORE THE SURFACE DATA AND FIRST GUESS VALUES
   7441 C  ---------------------------------------------
   7442 
   7443         PS(IS) = BMISS
   7444         GESPS(IS) = BMISS
   7445         PIS(IS) = BMISS
   7446         IF(ELV(IS).LT.BMISS .AND. ISF0.EQ.1) THEN
   7447           PS(IS)  = SF0_8(1)
   7448           IF(SF0_8(2).LT.BMISS) THEN
   7449             GESPS(IS) = SF0_8(2)
   7450             PIS(IS)   = PS(IS) - GESPS(IS)
   7451           ELSE
   7452             GESPS(IS) = BMISS
   7453             PIS(IS) = 0.
   7454           ENDIF
   7455         ENDIF
   7456 
   7457 C  IT'S GOING TO BE NECESSARY TO SORT ACCORDING TO PRESSURE
   7458 C  SOMETIMES THEY ARE OUT OF ORDER!!
   7459 C  ---------------------------------
   7460 
   7461 c --> error discovered by Christopher Redder NASA/GSFC, fixed
   7462 c      3/17/2004
   7463 ccccccccCALL GETOB(NFIN,MP,HDR2_8,NLEV,CAT,HRDR,XDR,YDR,OBS)
   7464         CALL GETOB(NFIN,MP,HDR2_8,NLEV,CAT,HRDR,YDR,XDR,OBS)
   7465         IF(MP.NE.0) CALL FILL(OBS,NLEV)
   7466         NLV = NLEV
   7467 
   7468 C  PRINT SELECTED RESULTS
   7469 C  ----------------------
   7470 
   7471         JKX = INT(HDR_8(7))/100
   7472         IF(IPCNT.LT.10000) THEN
   7473             IPCNT = IPCNT + 1
   7474             WRITE(60,600) SUBSET,SID(IS),CDATE,(HDR2_8(I),I=2,9)
   7475             IF(JKX.EQ.1) WRITE(60,601) NLV
   7476             IF(JKX.EQ.2) WRITE(60,603) NLV
   7477             DO L=1,NLV
   7478                 MISS = 0
   7479                 DO J=1,4
   7480                   DO I=1,MVO
   7481 C                   IF(OBS(I,L,MP,J).GE.BMAX) MISS = MISS + 1
   7482                   ENDDO
   7483                 ENDDO
   7484                 IF(MISS.LT.4*MVO) THEN
   7485                   IF(JKX.EQ.1) THEN
   7486                     WRITE(60,602) PRG(IORDER(MP)),((OBS(I,L,MP,J),
   7487      &                J=1,4),I=1,4),OBS(5,L,MP,1),CAT(L)
   7488                   ELSEIF(JKX.EQ.2) THEN
   7489                     WRITE(60,604) PRG(IORDER(MP)),((OBS(I,L,MP,J),
   7490      &                J=1,4),I=1,3),CAT(L)
   7491                   ENDIF

Page 242         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7492                 ENDIF
   7493             ENDDO
   7494         ENDIF
   7495 
   7496   600 FORMAT(/1X,A8,2X,A8,2X,A10,2X,4F8.2,4F5.0)
   7497   601 FORMAT(' PROGRAM        POB     PFC PQM PRC     TOB     TFC',
   7498      &  ' TQM TRC     ZOB     ZFC ZQM ZRC',
   7499      &          '     QOB     QFC QQM QRC     TDO CAT  NLV=',I5)
   7500   603 FORMAT(' PROGRAM        POB     PFC PQM PRC     UOB     UFC',
   7501      &  ' WQM WRC     VOB     VFC WQM WRC CAT  NLV=',I5)
   7502   602 FORMAT(1X,A8,2X,4(1X,F7.1,1X,F7.1,1X,F3.0,1X,F3.0),
   7503      &  1X,F7.1,1X,F3.0)
   7504   604 FORMAT(1X,A8,2X,3(1X,F7.1,1X,F7.1,1X,F3.0,1X,F3.0),1X,F3.0)
   7505 
   7506 C       WRITE(6,605) TYP,WIND,NLV
   7507   605   FORMAT(' INPUT--TYP,WIND,NLV: ',F7.0,2X,L2,2X,I4)
   7508 
   7509         IF(TYP.GE.BMISS) THEN
   7510            PRINT *, 'INPUT - NOT A PREPBUFR FILE - STOP 99'
   7511            CALL W3TAGE('PREPOBS_CQCBUFR')
   7512            CALL ERREXIT(99)
   7513         ENDIF
   7514 
   7515         IF(.NOT. WIND) THEN
   7516           DO L=1,MAND
   7517             ZM(L,IS) = BMISS
   7518             TM(L,IS) = BMISS
   7519           ENDDO
   7520           TDM = BMISS
   7521           QM  = BMISS
   7522           ZFM = BMISS
   7523           TFM = BMISS
   7524           QFM = BMISS
   7525           POB = BMISS
   7526           ZOB = BMISS
   7527           TOB = BMISS
   7528           TDO = BMISS
   7529           TVO = BMISS
   7530           UOB = BMISS
   7531           VOB = BMISS
   7532           QOB = BMISS
   7533           PQM = BMISS
   7534           TQM = BMISS
   7535           ZQM = BMISS
   7536           QQM = BMISS
   7537           WQM = BMISS
   7538           PFC = BMISS
   7539           ZFC = BMISS
   7540           TFC = BMISS
   7541           QFC = BMISS
   7542           UFC = BMISS
   7543           VFC = BMISS
   7544           PPC = BMISS
   7545           TPC = BMISS
   7546           ZPC = BMISS
   7547           QPC = BMISS
   7548           WPC = BMISS

Page 243         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7549           PRC = BMISS
   7550           ZRC = BMISS
   7551           TRC = BMISS
   7552           QRC = BMISS
   7553           WRC = BMISS
   7554           NLVM = NLV
   7555           ISF = 0
   7556           LSFC = 0
   7557           DO LL=1,NLVM
   7558            L = MANLEV(OBS(1,LL,MP,1))
   7559             IF(L.NE.0 .AND. CAT(LL).EQ.1) THEN
   7560               PM(L)  = OBS(1,LL,MP,1)
   7561               ZM(L,IS)  = OBS(3,LL,MP,1)
   7562               TM(L,IS)  = OBS(2,LL,MP,1)
   7563               TDM(L) = OBS(5,LL,MP,1)
   7564               IF(OBS(4,LL,MP,1).LT.BMISS) QM(L) = OBS(4,LL,MP,1)*1.0E-6
   7565               ZFM(L) = OBS(3,LL,MP,2)
   7566               TFM(L) = OBS(2,LL,MP,2)
   7567               IF(OBS(4,LL,MP,2).LT.BMISS) QFM(L) = OBS(4,LL,MP,2)*1.0E-6
   7568               MANDL = L
   7569             ENDIF
   7570           ENDDO
   7571           IV = 0
   7572           CALL SHELL(PM,IV,MANDL,1)
   7573           CALL SORT(ZM(1,IS),IV,MANDL)
   7574           CALL SORT(TM(1,IS),IV,MANDL)
   7575           CALL SORT(TDM,IV,MANDL)
   7576           CALL SORT(QM,IV,MANDL)
   7577           CALL SORT(ZFM,IV,MANDL)
   7578           CALL SORT(TFM,IV,MANDL)
   7579           CALL SORT(QFM,IV,MANDL)
   7580 
   7581 C  PRINT A FEW...
   7582 C  --------------
   7583 
   7584           IF(IPCNT.LT.10) THEN
   7585             WRITE(60,610)
   7586             WRITE(60,611) (PM(I),TM(I,IS),TFM(I),ZM(I,IS),ZFM(I),
   7587      &                    TDM(I),QM(I),QFM(I),I=1,MANDL)
   7588   610       FORMAT('   PRESS    TEMP  T-FCST      HT  Z-FCST',
   7589      &             '      TD       Q  Q-FCST')
   7590   611       FORMAT(1X,F7.1,2F8.1,2F8.0,F8.1,2F8.5)
   7591           ENDIF
   7592 
   7593           DO L=1,NLV
   7594             IND(L) = L
   7595             POB(L) = OBS(1,L,MP,1)
   7596             ZOB(L) = OBS(3,L,MP,1)
   7597             TOB(L) = OBS(2,L,MP,1)
   7598             IF(TOB(L).LT.BMISS .AND. OBS(5,L,MP,1).LT.BMISS) THEN
   7599               TDO(L) = TOB(L) - OBS(5,L,MP,1)   ! Store as depression
   7600             ENDIF
   7601             IF(OBS(4,L,MP,1).LT.BMISS) THEN
   7602               QOB(L) = OBS(4,L,MP,1)*1.0E-6
   7603               TVO(L)  = (TOB(L)+T0)*(1.+.61*QOB(L)) - T0
   7604             ENDIF
   7605             PQM(L) = OBS(1,L,MP,3)

Page 244         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7606             ZQM(L) = OBS(3,L,MP,3)
   7607             TQM(L) = OBS(2,L,MP,3)
   7608             QQM(L) = OBS(4,L,MP,3)
   7609             PFC(L) = OBS(1,L,MP,2)
   7610             ZFC(L) = OBS(3,L,MP,2)
   7611             TFC(L) = OBS(2,L,MP,2)
   7612             IF(OBS(4,L,MP,2).LT.BMISS) THEN
   7613               QFC(L) = OBS(4,L,MP,2)*1.0E-6
   7614 C  If possible, convert T-guess from Tv to T.
   7615               TFC(L) = (TFC(L)+T0)/(1.+.61*QFC(L)) - T0
   7616             ENDIF
   7617             PRC(L) = OBS(1,L,MP,4)
   7618             ZRC(L) = OBS(3,L,MP,4)
   7619             TRC(L) = OBS(2,L,MP,4)
   7620             QRC(L) = OBS(4,L,MP,4)
   7621             IF(CAT(L).EQ.0) THEN
   7622               ISF(IS) = L
   7623               LSFC    = L
   7624             ENDIF
   7625             IF(TFC(L).NE.BMISS .AND. QFC(L).NE.BMISS .AND.
   7626      &         POB(L).NE.BMISS) THEN
   7627               Q     = QFC(L)
   7628               WMIX  = Q/(1.-Q)
   7629               ES    = WMIX*POB(L) / (.622 + WMIX)
   7630               IF(ES.GT.0.) THEN
   7631                 TDFC(L) = (35.85*(ALOG(ES)-ALOG(6.1078))-T0*17.269)
   7632      &                / (ALOG(ES)-ALOG(6.1078)-17.269) - T0
   7633                 IF(TDFC(L).GT.TFC(L)) TDFC(L) = TFC(L)
   7634                 TDFC(L) = TFC(L) - TDFC(L)  ! Change to depression
   7635               ELSE
   7636                 TDFC(L) = BMISS
   7637               ENDIF
   7638             ELSE
   7639               TDFC(L) = BMISS
   7640             ENDIF
   7641           ENDDO
   7642           IV = 0
   7643           CALL SHELL(POB,IV,NLV,1)
   7644           CALL ISORT(IND,IV,NLV)
   7645           CALL SORT(ZOB,IV,NLV)
   7646           CALL SORT(TOB,IV,NLV)
   7647           CALL SORT(TDO,IV,NLV)
   7648           CALL SORT(QOB,IV,NLV)
   7649           CALL SORT(CAT,IV,NLV)
   7650           CALL SORT(HRDR,IV,NLV)
   7651           CALL SORT(YDR,IV,NLV)
   7652           CALL SORT(XDR,IV,NLV)
   7653           CALL SORT(TVO,IV,NLV)
   7654           CALL SORT(PQM,IV,NLV)
   7655           CALL SORT(ZQM,IV,NLV)
   7656           CALL SORT(TQM,IV,NLV)
   7657           CALL SORT(QQM,IV,NLV)
   7658           CALL SORT(PFC,IV,NLV)
   7659           CALL SORT(ZFC,IV,NLV)
   7660           CALL SORT(TFC,IV,NLV)
   7661           CALL SORT(QFC,IV,NLV)
   7662           CALL SORT(PRC,IV,NLV)

Page 245         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7663           CALL SORT(ZRC,IV,NLV)
   7664           CALL SORT(TRC,IV,NLV)
   7665           CALL SORT(QRC,IV,NLV)
   7666           CALL SORT(TDFC,IV,NLV)
   7667           ISURF = 0
   7668 
   7669 C  PRINT A FEW...
   7670 C  --------------
   7671 
   7672           IF(IPCNT.LT.1000) THEN
   7673             WRITE(60,612)
   7674             WRITE(60,613) (IND(I),POB(I),TOB(I),TFC(I),ZOB(I),ZFC(I),
   7675      &                    TDO(I),QOB(I),QFC(I),QQM(I),CAT(I),I=1,NLV)
   7676   612       FORMAT('  IND   PRESS    TEMP  T-FCST      HT  Z-FCST',
   7677      &             '      TD       Q  Q-FCST  QQM  CAT',
   7678      &             '  (in INPUT, after sorts)')
   7679   613       FORMAT(1X,I4,F8.1,2F8.1,2F8.0,F8.1,2F8.5,2F5.0)
   7680           ENDIF
   7681 
   7682           DO L=1,NLV
   7683             MANDF = L
   7684             IF(CAT(L).EQ.0) ISURF = 1
   7685             IF(ISURF.EQ.1 .AND. CAT(L).EQ.1) GOTO 20
   7686           ENDDO
   7687    20     CONTINUE
   7688           ICOUNT = ICOUNT + 1
   7689         ELSE
   7690           POBW = BMISS
   7691           ZOBW = BMISS
   7692           UOB  = BMISS
   7693           VOB  = BMISS
   7694           SP   = BMISS
   7695           DIR  = BMISS
   7696           PFCW = BMISS
   7697           ZFCW = BMISS
   7698           UFC  = BMISS
   7699           VFC  = BMISS
   7700           PQMW = BMISS
   7701           ZQMW = BMISS
   7702           WQM  = BMISS
   7703           PRCW = BMISS
   7704           ZRCW = BMISS
   7705           WRC  = BMISS
   7706           CATW = BMISS
   7707           ISF  = 0
   7708           LSFC = 0
   7709           NLVW = NLV
   7710           DO L=1,NLV
   7711             IND(L) = L
   7712             POBW(L) = OBS(1,L,MP,1)
   7713             ZOBW(L) = OBS(4,L,MP,1)
   7714             UOB(L)  = OBS(2,L,MP,1)
   7715             VOB(L)  = OBS(3,L,MP,1)
   7716             SP(L)   = SQRT(UOB(L)**2 + VOB(L)**2)
   7717             IF(VOB(L).NE.0. .AND. UOB(L).NE.0.) THEN
   7718               DIR(L)  = 90. - PPI * ATAN2(VOB(L),UOB(L))
   7719             ENDIF

Page 246         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7720             PFCW(L) = OBS(1,L,MP,2)
   7721             ZFCW(L) = OBS(4,L,MP,2)
   7722             UFC(L)  = OBS(2,L,MP,2)
   7723             VFC(L)  = OBS(3,L,MP,2)
   7724             PQMW(L) = OBS(1,L,MP,3)
   7725             ZQMW(L) = OBS(4,L,MP,3)
   7726             WQM(L)  = OBS(2,L,MP,3)
   7727             PRCW(L) = OBS(1,L,MP,4)
   7728             ZRCW(L) = OBS(4,L,MP,4)
   7729             WRC(L)  = OBS(2,L,MP,4)
   7730             CATW(L) = CAT(L)
   7731             IF(CATW(L).EQ.0) THEN
   7732               ISF(IS) = L
   7733               LSFC    = L
   7734             ENDIF
   7735           ENDDO
   7736         ENDIF
   7737 
   7738       RETURN
   7739       END


ENTRY POINTS

  Name              
                    
 input_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  7348                                                                                             
 15                         Label  7430                                                           7421                              
 20                         Label  7687                                                           7685                              
 5                          Label  7331                                                           7353,7358,7363                    
 501                        Label  7335                                                           7334                              
 502                        Label  7362                                                           7361                              
 503                        Label  7438                                                           7437                              
 6                          Label  7338                                                           7307                              
 600                        Label  7496                                                           7474                              
 601                        Label  7497                                                           7475                              
 602                        Label  7502                                                           7486                              
 603                        Label  7500                                                           7476                              
 604                        Label  7504                                                           7489                              
 605                        Label  7507                                                                                             
 610                        Label  7588                                                           7585                              
 611                        Label  7590                                                           7586                              
 612                        Label  7676                                                           7673                              
 613                        Label  7679                                                           7674                              
 ALLSND                     Common 7213                                 34512    SAVE                                               
 ALOG                       Func   7631                                 scalar                    7631,7632                         
 ALSNDW                     Common 7235                                 17340    SAVE                                               
 ATAN2                      Func   7718                                 scalar                    7718                              
 BMAX                       Local  7292     R(4)            4           scalar   SAVE             7292                              
 BMISS                      Scalar 7250     R(8)            8           scalar   COM              7292,7443,7444,7445,7446,7448,7452

Page 247         Source Listing                  INPUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,7509,7517,7518,7520,7521,7522,752
                                                                                                  3,7524,7525,7526,7527,7528,7529,75
                                                                                                  30,7531,7532,7533,7534,7535,7536,7
                                                                                                  537,7538,7539,7540,7541,7542,7543,
                                                                                                  7544,7545,7546,7547,7548,7549,7550
                                                                                                  ,7551,7552,7553,7564,7567,7598,760
                                                                                                  1,7612,7625,7626,7636,7639,7690,76
                                                                                                  91,7692,7693,7694,7695,7696,7697,7
                                                                                                  698,7699,7700,7701,7702,7703,7704,
                                                                                                  7705,7706                         
 BRES                       Scalar 7234     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 7269                                 16       SAVE                                               
 C1FSTR                     Local  7262     CHAR            40          scalar   SAVE             7277                              
 C1STR                      Local  7261     CHAR            40          scalar   SAVE             7276                              
 CAT                        Scalar 7218     R(4)            4     1     255      COM              7464,7487,7490,7559,7621,7649,7675
                                                                                                  ,7684,7685,7730                   
 CAT0                       Local  7261     CHAR            40          scalar   SAVE             7280,7367                         
 CATW                       Scalar 7239     R(4)            4     1     255      COM              7706,7730,7731                    
 CDATE                      Scalar 7240     CHAR            10          scalar   COM              7308,7309,7310,7474               
 CDR                        Local  7259     CHAR            8     1     10       SAVE             7410                              
 CLOSBF                     Subr   7303                                                           7303,7314,7340,7341               
 CLOSMG                     Subr   7351                                                           7351                              
 CONSTS                     Common 7245                                 20       SAVE                                               
 COPYMG                     Subr   7352                                                           7352                              
 CP                         Scalar 7245     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 7242     R(4)            4           scalar   COM              7311                              
 DATELEN                    Subr   7302                                                           7302                              
 DATEX                      Common 7240                                 30       SAVE                                               
 DHR                        Scalar 7210     R(4)            4     1     999      COM              7413                              
 DIR                        Scalar 7238     R(4)            4     1     255      COM              7695,7718                         
 ELV                        Scalar 7211     R(4)            4     1     999      COM              7414,7446                         
 ENDIN                      Dummy  7202     L(4)            4           scalar   ARG,INOUT        7294,7339                         
 ERREXIT                    Subr   7406                                                           7406,7512                         
 ERROR                      Scalar 7234     L(4)            4     1     999      COM                                                
 ES                         Local  7629     R(4)            4           scalar   SAVE             7629,7630,7631,7632               
 FCST                       Local  7252     R(4)            4     2     2550     SAVE                                               
 FCSTR                      Local  7261     CHAR            40          scalar   SAVE             7274                              
 FILES                      Common 7243                                 24       SAVE                                               
 FILL                       Subr   7465                                                           7465                              
 G                          Scalar 7245     R(4)            4           scalar   COM                                                
 GESPS                      Scalar 7219     R(4)            4     1     999      COM              7444,7449,7450,7452               
 GETOB                      Subr   7464                                                           7464                              
 HDR2_8                     Local  7250     R(8)            8     1     10       SAVE             7464,7474                         
 HDR_8                      Local  7250     R(8)            8     1     10       SAVE             7366,7372,7373,7375,7376,7386,7388
                                                                                                  ,7394,7396,7411,7412,7413,7414,741
                                                                                                  5,7416,7471                       
 HEADER                     Common 7210                                 35980    SAVE                                               
 HRDR                       Scalar 7219     R(4)            4     1     255      COM              7464,7650                         
 HSTR                       Local  7261     CHAR            40          scalar   SAVE             7272,7366                         
 HYDM                       Scalar 7234     R(4)            4     2     20979    COM                                                
 I                          Local  7319     I(4)            4           scalar   SAVE             7319,7320,7474,7480,7486,7487,7489
                                                                                                  ,7490,7586,7587,7674,7675         
 IBL                        Local  7424     I(4)            4           scalar   SAVE             7424,7425,7426,7427               
 IBLK                       Scalar 7246     I(4)            4     1     100      COM              7427                              
 ICOUNT                     Local  7688     I(4)            4           scalar   SAVE             7688                              

Page 248         Source Listing                  INPUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDATE                      Local  7306     I(4)            4           scalar   SAVE             7306,7308,7333,7334,7355          
 IDENT                      Local  7420     I(4)            4           scalar   SAVE             7420,7421,7424,7430,7432,7437     
 IMISS                      Scalar 7269     I(4)            4           scalar   COM                                                
 IND                        Scalar 7218     I(4)            4     1     255      COM              7594,7644,7674,7711               
 INPUT                      Subr   7202                                                                                             
 INT                        Func   7471                                 scalar                    7471                              
 IORDER                     Local  7267     I(4)            4     1     14       SAVE             7271,7486,7489                    
 IPCNT                      Local  7291     I(4)            4           scalar   SAVE             7291,7472,7473,7584,7672          
 IPEVT                      Scalar 7242     I(4)            4           scalar   COM                                                
 IRET                       Local  7366     I(4)            4           scalar   SAVE             7366                              
 IRETMG                     Local  7306     I(4)            4           scalar   SAVE             7306,7307,7333,7334,7338          
 IRETSB                     Local  7325     I(4)            4           scalar   SAVE             7325,7332,7360,7361,7363          
 IS                         Scalar 7244     I(4)            4           scalar   COM              7318,7382,7383,7387,7395,7403,7409
                                                                                                  ,7410,7411,7412,7413,7414,7415,741
                                                                                                  6,7417,7421,7437,7443,7444,7445,74
                                                                                                  46,7447,7449,7450,7452,7453,7474,7
                                                                                                  517,7518,7561,7562,7573,7574,7586,
                                                                                                  7622,7732                         
 ISC                        Scalar 7242     I(4)            4           scalar   COM                                                
 ISF                        Scalar 7212     I(4)            4     1     999      COM              7417,7555,7622,7707,7732          
 ISF0                       Local  7367     I(4)            4           scalar   SAVE             7367,7446                         
 ISHIP                      Scalar 7246     I(4)            4           scalar   COM              7431,7432                         
 ISORT                      Subr   7644                                                           7644                              
 ISURF                      Local  7667     I(4)            4           scalar   SAVE             7667,7684,7685                    
 ITIME                      Dummy  7202     I(4)            4           scalar   ARG,INOUT        7317,7349,7364,7419,7437          
 ITP                        Scalar 7211     I(4)            4     1     999      COM              7383,7415                         
 IV                         Local  7249     I(4)            4     1     255      SAVE             7571,7572,7573,7574,7575,7576,7577
                                                                                                  ,7578,7579,7642,7643,7644,7645,764
                                                                                                  6,7647,7648,7649,7650,7651,7652,76
                                                                                                  53,7654,7655,7656,7657,7658,7659,7
                                                                                                  660,7661,7662,7663,7664,7665,7666 
 J                          Local  7479     I(4)            4           scalar   SAVE             7479,7486,7487,7489,7490          
 JDATE                      Scalar 7240     I(4)            4     1     5        COM              7309                              
 JKX                        Local  7471     I(4)            4           scalar   SAVE             7471,7475,7476,7485,7488          
 L                          Local  7477     I(4)            4           scalar   SAVE             7477,7486,7487,7489,7490,7516,7517
                                                                                                  ,7518,7558,7559,7560,7561,7562,756
                                                                                                  3,7564,7565,7566,7567,7568,7593,75
                                                                                                  94,7595,7596,7597,7598,7599,7601,7
                                                                                                  602,7603,7605,7606,7607,7608,7609,
                                                                                                  7610,7611,7612,7613,7615,7617,7618
                                                                                                  ,7619,7620,7621,7622,7623,7625,762
                                                                                                  6,7627,7629,7631,7633,7634,7636,76
                                                                                                  39,7682,7683,7684,7685,7710,7711,7
                                                                                                  712,7713,7714,7715,7716,7717,7718,
                                                                                                  7720,7721,7722,7723,7724,7725,7726
                                                                                                  ,7727,7728,7729,7730,7731,7732,773
                                                                                                  3                                 
 LEVTYP                     Scalar 7218     I(4)            4     1     255      COM                                                
 LL                         Local  7557     I(4)            4           scalar   SAVE             7557,7558,7559,7560,7561,7562,7563
                                                                                                  ,7564,7565,7566,7567              
 LMAND                      Scalar 7242     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 7242     I(4)            4           scalar   COM              7556,7623,7708,7733               
 LST                        Scalar 7219     I(4)            4     1     255      COM                                                
 MAND                       Scalar 7241     I(4)            4           scalar   COM              7516                              
 MANDF                      Scalar 7222     I(4)            4           scalar   COM              7683                              

Page 249         Source Listing                  INPUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MANDL                      Scalar 7221     I(4)            4           scalar   COM              7568,7572,7573,7574,7575,7576,7577
                                                                                                  ,7578,7579,7587                   
 MANLEV                     Func   7558     I(4)            4           scalar                    7558                              
 MANRES                     Common 7223                                 2949048  SAVE                                               
 MANSND                     Common 7221                                 168344   SAVE                                               
 MEV                        Param  7207     I(4)            4           scalar                    7251                              
 MIN                        Func   7426                                 scalar                    7426                              
 MISS                       Local  7478     I(4)            4           scalar   SAVE             7478,7484                         
 MLV                        Param  7206     I(4)            4           scalar                    7251                              
 MOD                        Func   7378                                 scalar                    7378                              
 MP                         Param  7208     I(4)            4           scalar                    7464,7465,7486,7487,7489,7558,7560
                                                                                                  ,7561,7562,7563,7564,7565,7566,756
                                                                                                  7,7595,7596,7597,7598,7599,7601,76
                                                                                                  02,7605,7606,7607,7608,7609,7610,7
                                                                                                  611,7612,7613,7617,7618,7619,7620,
                                                                                                  7712,7713,7714,7715,7720,7721,7722
                                                                                                  ,7723,7724,7725,7726,7727,7728,772
                                                                                                  9                                 
 MVO                        Param  7205     I(4)            4           scalar                    7251,7480,7484                    
 NEV                        Scalar 7212     I(4)            4           scalar   COM                                                
 NFEVN                      Scalar 7243     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 7243     I(4)            4           scalar   COM              7303,7304,7305,7306,7311,7312,7313
                                                                                                  ,7314,7315,7316,7317,7333,7334,734
                                                                                                  0,7352,7360,7364,7366,7367,7464   
 NFOUT                      Scalar 7243     I(4)            4           scalar   COM              7317,7341,7351,7352,7355,7364     
 NFSGL                      Scalar 7243     I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 7243     I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 7243     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 7241     I(4)            4           scalar   COM              7464,7465,7466                    
 NLV                        Scalar 7211     I(4)            4           scalar   COM              7466,7475,7476,7477,7554,7593,7643
                                                                                                  ,7644,7645,7646,7647,7648,7649,765
                                                                                                  0,7651,7652,7653,7654,7655,7656,76
                                                                                                  57,7658,7659,7660,7661,7662,7663,7
                                                                                                  664,7665,7666,7675,7682,7709,7710 
 NLVM                       Scalar 7212     I(4)            4           scalar   COM              7554,7557                         
 NLVW                       Scalar 7212     I(4)            4           scalar   COM              7709                              
 NOBS                       Scalar 7241     I(4)            4           scalar   COM              7409                              
 NQHM                       Scalar 7231     I(4)            4     2     20979    COM                                                
 NST                        Param  7204     I(4)            4           scalar                    7210,7211,7212,7219,7221,7223,7224
                                                                                                  ,7225,7226,7227,7228,7229,7230,723
                                                                                                  1,7232,7233,7234,7319,7403        
 NTDHM                      Scalar 7231     I(4)            4     2     20979    COM                                                
 NTDIM                      Scalar 7226     I(4)            4     2     20979    COM                                                
 NTHM                       Scalar 7229     I(4)            4     2     20979    COM                                                
 NTIM                       Scalar 7226     I(4)            4     2     20979    COM                                                
 NZHM                       Scalar 7229     I(4)            4     2     20979    COM                                                
 NZIM                       Scalar 7226     I(4)            4     2     20979    COM                                                
 OBS                        Local  7251     R(4)            4     4     71400    SAVE             7464,7465,7486,7487,7489,7558,7560
                                                                                                  ,7561,7562,7563,7564,7565,7566,756
                                                                                                  7,7595,7596,7597,7598,7599,7601,76
                                                                                                  02,7605,7606,7607,7608,7609,7610,7
                                                                                                  611,7612,7613,7617,7618,7619,7620,
                                                                                                  7712,7713,7714,7715,7720,7721,7722
                                                                                                  ,7723,7724,7725,7726,7727,7728,772
                                                                                                  9                                 

Page 250         Source Listing                  INPUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 OBSTR                      Local  7263     CHAR            50    2     10       SAVE             7281                              
 OBSW                       Local  7253     R(4)            4     2     2550     SAVE                                               
 OBSW2                      Local  7253     R(4)            4     2     2550     SAVE                                               
 OPENBF                     Subr   7305                                                           7305,7316,7317                    
 OPENMB                     Subr   7355                                                           7355                              
 OSTR                       Local  7261     CHAR            40          scalar   SAVE             7273                              
 OSTRW                      Local  7262     CHAR            40          scalar   SAVE             7278                              
 OSTRW2                     Local  7262     CHAR            40          scalar   SAVE             7279                              
 PARAMS                     Common 7241                                 148      SAVE                                               
 PFC                        Scalar 7213     R(4)            4     1     255      COM              7538,7609,7658                    
 PFCW                       Scalar 7235     R(4)            4     1     255      COM              7696,7720                         
 PIS                        Scalar 7234     R(4)            4     1     999      COM              7445,7450,7453                    
 PM                         Scalar 7222     R(4)            4     1     21       COM              7560,7572,7586                    
 POB                        Scalar 7213     R(4)            4     1     255      COM              7525,7595,7626,7629,7643,7674     
 POBW                       Scalar 7235     R(4)            4     1     255      COM              7690,7712                         
 PPC                        Local  7544     R(4)            4           scalar   SAVE             7544                              
 PPI                        Local  7290     R(4)            4           scalar   SAVE             7290,7718                         
 PQM                        Scalar 7213     R(4)            4     1     255      COM              7533,7605,7654                    
 PQMW                       Scalar 7235     R(4)            4     1     255      COM              7700,7724                         
 PRC                        Scalar 7213     R(4)            4     1     255      COM              7549,7617,7662                    
 PRCW                       Scalar 7235     R(4)            4     1     255      COM              7703,7727                         
 PRG                        Local  7259     CHAR            8     1     14       SAVE             7286,7486,7489                    
 PRNT                       Scalar 7242     L(4)            4           scalar   COM                                                
 PS                         Scalar 7219     R(4)            4     1     999      COM              7443,7447,7450                    
 Q                          Local  7627     R(4)            4           scalar   SAVE             7627,7628                         
 QFC                        Scalar 7217     R(4)            4     1     255      COM              7541,7613,7615,7625,7627,7661,7675
 QFM                        Scalar 7222     R(4)            4     1     21       COM              7524,7567,7579,7587               
 QG                         Scalar 7233     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 7224     R(4)            4     2     20979    COM                                                
 QIM                        Scalar 7223     R(4)            4     2     20979    COM                                                
 QM                         Scalar 7221     R(4)            4     1     21       COM              7521,7564,7576,7587               
 QMKS                       Local  7252     R(4)            4     2     2550     SAVE                                               
 QOB                        Scalar 7217     R(4)            4     1     255      COM              7532,7602,7603,7648,7675          
 QPC                        Local  7547     R(4)            4           scalar   SAVE             7547                              
 QQM                        Scalar 7217     R(4)            4     1     255      COM              7536,7608,7657,7675               
 QRC                        Scalar 7217     R(4)            4     1     255      COM              7552,7620,7665                    
 QVM                        Scalar 7225     R(4)            4     2     20979    COM                                                
 R                          Scalar 7245     R(4)            4           scalar   COM                                                
 RADPC                      Scalar 7241     R(4)            4           scalar   COM              7313                              
 RCDS                       Local  7253     R(4)            4     2     2550     SAVE                                               
 RCSTR                      Local  7261     CHAR            40          scalar   SAVE             7275                              
 READMG                     Subr   7306                                                           7306,7333                         
 READSB                     Subr   7360                                                           7360                              
 RV                         Scalar 7245     R(4)            4           scalar   COM                                                
 SAME                       Dummy  7202     L(4)            4           scalar   ARG,INOUT        7389,7391,7397,7399               
 SF0_8                      Local  7250     R(8)            8     1     10       SAVE             7367,7447,7448,7449               
 SHELL                      Subr   7572                                                           7572,7643                         
 SID                        Scalar 7210     CHAR            8     1     999      COM              7410,7421,7474                    
 SIDOLD                     Local  7323     R(4)            4           scalar   SAVE             7323,7394,7396                    
 SKIP                       Dummy  7202     L(4)            4           scalar   ARG,INOUT        7295,7375,7437                    
 SORT                       Subr   7573                                                           7573,7574,7575,7576,7577,7578,7579
                                                                                                  ,7645,7646,7647,7648,7649,7650,765
                                                                                                  1,7652,7653,7654,7655,7656,7657,76
                                                                                                  58,7659,7660,7661,7662,7663,7664,7
                                                                                                  665,7666                          

Page 251         Source Listing                  INPUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SP                         Scalar 7238     R(4)            4     1     255      COM              7694,7716                         
 SQN                        Scalar 7211     R(4)            4     1     999      COM              7320,7416                         
 SQNOLD                     Local  7322     R(4)            4           scalar   SAVE             7322,7386,7388                    
 SQRT                       Func   7716                                 scalar                    7716                              
 START                      Dummy  7202     L(4)            4           scalar   ARG,INOUT        7301,7324,7437                    
 STN                        Common 7244                                 4        SAVE                                               
 STNKNT                     Common 7246                                 404      SAVE                                               
 SUBSET                     Local  7259     CHAR            8           scalar   SAVE             7306,7333,7334,7350,7355,7357,7474
 T0                         Scalar 7245     R(4)            4           scalar   COM              7603,7615,7631,7632               
 T29                        Local  7373     R(4)            4           scalar   SAVE             7373,7377,7423                    
 TDFC                       Scalar 7216     R(4)            4     1     255      COM              7631,7633,7634,7636,7639,7666     
 TDG                        Scalar 7233     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 7224     R(4)            4     2     20979    COM                                                
 TDIM                       Scalar 7223     R(4)            4     2     20979    COM                                                
 TDM                        Scalar 7221     R(4)            4     1     21       COM              7520,7563,7575,7587               
 TDO                        Scalar 7216     R(4)            4     1     255      COM              7528,7599,7647,7675               
 TDVM                       Scalar 7225     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 7247     L(4)            4           scalar   COM              7334,7361,7437                    
 TESTS                      Common 7247                                 4        SAVE                                               
 TFC                        Scalar 7215     R(4)            4     1     255      COM              7540,7611,7615,7625,7633,7634,7660
                                                                                                  ,7674                             
 TFM                        Scalar 7222     R(4)            4     1     21       COM              7523,7566,7578,7586               
 TG                         Scalar 7233     L(4)            4     2     20979    COM                                                
 THM                        Scalar 7224     R(4)            4     2     20979    COM                                                
 TIM                        Scalar 7223     R(4)            4     2     20979    COM                                                
 TM                         Scalar 7221     R(4)            4     2     20979    COM              7518,7562,7574,7586               
 TOB                        Scalar 7215     R(4)            4     1     255      COM              7527,7597,7598,7599,7603,7646,7674
 TPC                        Local  7545     R(4)            4           scalar   SAVE             7545                              
 TQM                        Scalar 7215     R(4)            4     1     255      COM              7534,7607,7656                    
 TRC                        Scalar 7215     R(4)            4     1     255      COM              7551,7619,7664                    
 TT                         Scalar 7242     R(4)            4           scalar   COM                                                
 TTMP                       Local  7254     R(4)            4     1     21       SAVE                                               
 TVM                        Scalar 7225     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 7216     R(4)            4     1     255      COM              7529,7603,7653                    
 TYP                        Local  7372     R(4)            4           scalar   SAVE             7372,7378,7380,7509               
 UFBCPY                     Subr   7364                                                           7364                              
 UFBINT                     Subr   7366                                                           7366,7367                         
 UFBQCD                     Subr   7311                                                           7311,7312,7313                    
 UFC                        Scalar 7237     R(4)            4     1     255      COM              7542,7698,7722                    
 UOB                        Scalar 7237     R(4)            4     1     255      COM              7530,7692,7714,7716,7717,7718     
 USESQN                     Dummy  7202     L(4)            4           scalar   ARG,INOUT        7385                              
 VFC                        Scalar 7237     R(4)            4     1     255      COM              7543,7699,7723                    
 VOB                        Scalar 7237     R(4)            4     1     255      COM              7531,7693,7715,7716,7717,7718     
 VTPPC                      Scalar 7241     R(4)            4           scalar   COM              7312                              
 W3TAGE                     Subr   7405                                                           7405,7511                         
 WIND                       Dummy  7202     L(4)            4           scalar   ARG,INOUT        7296,7380,7381,7386,7394,7419,7515
 WMIX                       Local  7628     R(4)            4           scalar   SAVE             7628,7629                         
 WPC                        Local  7548     R(4)            4           scalar   SAVE             7548                              
 WQM                        Scalar 7238     R(4)            4     1     255      COM              7537,7702,7726                    
 WRC                        Scalar 7238     R(4)            4     1     255      COM              7553,7705,7729                    
 XDR                        Scalar 7220     R(4)            4     1     255      COM              7464,7652                         
 XMA                        Scalar 7241     R(4)            4           scalar   COM              7375                              
 XMI                        Scalar 7241     R(4)            4           scalar   COM              7375                              
 XMISS                      Scalar 7269     R(4)            4           scalar   COM                                                
 XOB                        Scalar 7210     R(4)            4     1     999      COM              7411                              

Page 252         Source Listing                  INPUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XQHM                       Scalar 7232     R(4)            4     2     20979    COM                                                
 XQIM                       Scalar 7228     R(4)            4     2     20979    COM                                                
 XTDHM                      Scalar 7231     R(4)            4     2     20979    COM                                                
 XTDIM                      Scalar 7227     R(4)            4     2     20979    COM                                                
 XTDVM                      Scalar 7230     R(4)            4     2     20979    COM                                                
 XTHM                       Scalar 7230     R(4)            4     2     20979    COM                                                
 XTIM                       Scalar 7227     R(4)            4     2     20979    COM                                                
 XTVM                       Scalar 7228     R(4)            4     2     20979    COM                                                
 XZHM                       Scalar 7229     R(4)            4     2     20979    COM                                                
 XZIM                       Scalar 7227     R(4)            4     2     20979    COM                                                
 XZVM                       Scalar 7228     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 7220     R(4)            4     1     255      COM              7464,7651                         
 YMA                        Scalar 7241     R(4)            4           scalar   COM              7376                              
 YMI                        Scalar 7241     R(4)            4           scalar   COM              7376                              
 YOB                        Scalar 7210     R(4)            4     1     999      COM              7412                              
 ZFC                        Scalar 7214     R(4)            4     1     255      COM              7539,7610,7659,7674               
 ZFCW                       Scalar 7236     R(4)            4     1     255      COM              7697,7721                         
 ZFM                        Scalar 7222     R(4)            4     1     21       COM              7522,7565,7577,7586               
 ZG                         Scalar 7233     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 7224     R(4)            4     2     20979    COM                                                
 ZIM                        Scalar 7223     R(4)            4     2     20979    COM                                                
 ZM                         Scalar 7221     R(4)            4     2     20979    COM              7517,7561,7573,7586               
 ZOB                        Scalar 7214     R(4)            4     1     255      COM              7526,7596,7645,7674               
 ZOBW                       Scalar 7236     R(4)            4     1     255      COM              7691,7713                         
 ZPC                        Local  7546     R(4)            4           scalar   SAVE             7546                              
 ZQM                        Scalar 7214     R(4)            4     1     255      COM              7535,7606,7655                    
 ZQMW                       Scalar 7236     R(4)            4     1     255      COM              7701,7725                         
 ZRC                        Scalar 7214     R(4)            4     1     255      COM              7550,7618,7663                    
 ZRCW                       Scalar 7236     R(4)            4     1     255      COM              7704,7728                         
 ZTMP                       Local  7254     R(4)            4     1     21       SAVE                                               
 ZVM                        Scalar 7225     R(4)            4     2     20979    COM                                                

Page 253         Source Listing                  INPUT
2017-04-18 11:07                                 cqcbufr.f

   7740 
   7741 C**********************************************************************
   7742 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7743 C                .      .    .                                       .
   7744 C SUBPROGRAM:    INPUT2      READ INPUT FOR ALL STATIONS FOR TMP CHK
   7745 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-05-18
   7746 C
   7747 C ABSTRACT: Read input for all stations for temporal check.
   7748 C
   7749 C PROGRAM HISTORY LOG:
   7750 C 1997-03-18  W. Collins  Original author.
   7751 C 2016-05-18  D. Keyser   Corrected an integer overflow issue which prevented
   7752 C     the temporal check from running in the CDAS network (the only network
   7753 C     where it currently would run).
   7754 C
   7755 C USAGE:    CALL INPUT2
   7756 C
   7757 C   INPUT FILES:
   7758 C     UNIT NFTMP(1) - INPUT PREPBUFR FILE at T--
   7759 C     UNIT NFTMP(2) - INPUT PREPBUFR FILE at T-
   7760 C     UNIT NFTMP(3) - INPUT PREPBUFR FILE at T+
   7761 C     UNIT NFTMP(4) - INPUT PREPBUFR FILE at T++
   7762 C
   7763 C   OUTPUT FILES:
   7764 C     UNIT 06  - PRINTOUT
   7765 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   7766 C
   7767 C REMARKS: NONE.
   7768 C
   7769 C ATTRIBUTES:
   7770 C   LANGUAGE: FORTRAN 90
   7771 C   MACHINE:  NCEP WCOSS
   7772 C
   7773 C$$$
   7774 
   7775       SUBROUTINE INPUT2
   7776       PARAMETER(NST=999)
   7777 
   7778       REAL(8) BMISS,RIT_8,HDR_8(10),UPA_8(10,255)
   7779 
   7780       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   7781      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   7782      &                 ZTMP(21,NST),   TTMP(21,NST),
   7783      &                 NZTMP(21,NST),  NTTMP(21,NST),
   7784      &                 ITERR(4)
   7785       COMMON /DATEX/   JDATE(5), CDATE
   7786       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   7787      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   7788       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   7789      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   7790      &                 NEV, ISF(NST), NLVM, NLVW
   7791       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   7792 
   7793       CHARACTER*8      SID, SUBSET, CIT
   7794       CHARACTER*10     CDATE
   7795       CHARACTER*40     HSTR, USTR
   7796       DIMENSION        IIT(4), NFTMP(4)

Page 254         Source Listing                  INPUT2
2017-04-18 11:07                                 cqcbufr.f

   7797       REAL             RINC(5)
   7798       INTEGER          IDAT(8), JDAT(8)
   7799       LOGICAL          PRNT
   7800       EQUIVALENCE      (RIT_8,CIT)
   7801 
   7802       DATA HSTR  /'SID XOB YOB DHR ELV T29 TYP             '/
   7803       DATA USTR  /'CAT=1 POB ZOB TOB ZFC TFC               '/
   7804       DATA IIT   /-24,-12,12,24/
   7805       DATA NFTMP /17,18,19,20/
   7806 
   7807 C  INITIALIZE THE ARRAYS FOR TEMPORAL CHECK
   7808 C  ----------------------------------------
   7809 
   7810       DO K=1,4
   7811         ITERR(K) = 0
   7812       ENDDO
   7813       DO J=1,NST
   7814         DO I=1,21
   7815           ZTMP(I,J) = BMISS
   7816           TTMP(I,J) = BMISS
   7817           DO K=1,4
   7818             ZOBT(I,J,K) = BMISS
   7819             TOBT(I,J,K) = BMISS
   7820             ZIT(I,J,K)  = BMISS
   7821             TIT(I,J,K)  = BMISS
   7822           ENDDO
   7823         ENDDO
   7824       ENDDO
   7825 
   7826 C  BEGIN LOOP ON TIMES FOR TEMPORAL CHECK
   7827 C  --------------------------------------
   7828 
   7829       DO IT=1,4
   7830         MATCH = 0
   7831         REWIND NFTMP(IT)
   7832         READ(NFTMP(IT),END=200)
   7833         WRITE(6,500) NFTMP(IT), IIT(IT)
   7834   500   FORMAT(1X,'INPUT2--READING FROM FILE ',I5,' AT TIME = ',I5)
   7835 
   7836 C  FILE IS ATTACHED, OPEN IT AND CHECK THE DATE/TIME
   7837 C  -------------------------------------------------
   7838 
   7839         CALL DATELEN(10)
   7840         CALL OPENBF(NFTMP(IT),'IN',NFTMP(IT))
   7841     5   CONTINUE
   7842         CALL READMG(NFTMP(IT),SUBSET,IDATE,IRET)
   7843         IF(SUBSET.NE.'ADPUPA') THEN
   7844           IF(IRET.NE.0) GOTO 200
   7845           GOTO 5
   7846         ENDIF
   7847 
   7848         RINC(1) = 0
   7849         RINC(2) = IIT(IT)
   7850         RINC(3) = 0
   7851         RINC(4) = 0
   7852         RINC(5) = 0
   7853         IDAT(1) = JDATE(1)*100 + JDATE(2)

Page 255         Source Listing                  INPUT2
2017-04-18 11:07                                 cqcbufr.f

   7854         IDAT(2) = JDATE(3)
   7855         IDAT(3) = JDATE(4)
   7856         IDAT(4) = 0
   7857         IDAT(5) = JDATE(5)
   7858         IDAT(6) = 0
   7859         IDAT(7) = 0
   7860         IDAT(8) = 0
   7861         CALL W3MOVDAT(RINC,IDAT,JDAT)
   7862         KDATE = JDAT(1)*1000000 + JDAT(2)*10000 + JDAT(3)*100 + JDAT(5)
   7863         IF(IDATE.NE.KDATE) GOTO 200
   7864 
   7865 C  READ AND STORE ALL MATCHING DATA FROM THIS TIME
   7866 C  -----------------------------------------------
   7867 
   7868    10   CALL READSB(NFTMP(IT),IRET)
   7869         IF(IRET.NE.0) THEN
   7870    20     CALL READMG(NFTMP(IT),SUBSET,IDATE,IRET)
   7871           IF(SUBSET.NE.'ADPUPA') THEN
   7872             IF(IRET.NE.0) GOTO 100
   7873             GOTO 20
   7874           ENDIF
   7875           GOTO 10
   7876         ENDIF
   7877 
   7878         CALL UFBINT(NFTMP(IT),HDR_8,10,  1,IRET,HSTR)
   7879         CALL UFBINT(NFTMP(IT),UPA_8,10,255,NRET,USTR)
   7880 
   7881         RIT_8 = HDR_8(1)
   7882         X   = HDR_8(2)
   7883         Y   = HDR_8(3)
   7884         THR = HDR_8(4)
   7885         ELV = HDR_8(5)
   7886         RPT = HDR_8(6)
   7887 
   7888         IF(HDR_8(7).GT.200) GOTO 10
   7889 
   7890 C  FIND A MATCHING STATION
   7891 C  -----------------------
   7892 
   7893         DO N=1,NOBS
   7894           IF(CIT.EQ.SID(N) .AND. X.EQ.XOB(N) .AND. Y.EQ.YOB(N)) THEN
   7895             MATCH = MATCH + 1
   7896             DO L=1,NRET
   7897               P = UPA_8(1,L)
   7898               MANL = MANLEV(P)
   7899               IF(MANL.GT.0 .AND. MANL.LE.MAND) THEN
   7900                 ZOBT(MANL,N,IT) = UPA_8(2,L)
   7901                 TOBT(MANL,N,IT) = UPA_8(3,L)
   7902                 IF(UPA_8(2,L).NE.BMISS .AND. UPA_8(4,L).NE.BMISS)
   7903      &            ZIT(MANL,N,IT)  = UPA_8(2,L) - UPA_8(4,L)
   7904                 IF(UPA_8(3,L).NE.BMISS .AND. UPA_8(5,L).NE.BMISS)
   7905      &            TIT(MANL,N,IT)  = UPA_8(3,L) - UPA_8(5,L)
   7906               ENDIF
   7907             ENDDO
   7908 C           WRITE(60,516) IT,N,(ZOBT(L,N,IT),L=1,NRET)
   7909 C 516       FORMAT(' INPUT2--IT,N,ZOBT: ',2I5,21F8.1)
   7910 C           WRITE(60,518) IT,N,(ZIT(L,N,IT),L=1,NRET)

Page 256         Source Listing                  INPUT2
2017-04-18 11:07                                 cqcbufr.f

   7911 C 518       FORMAT(' INPUT2--IT,N,ZIT: ',2I5,21F8.1)
   7912 C           WRITE(60,517) IT,N,(TOBT(L,N,IT),L=1,NRET)
   7913 C 517       FORMAT(' INPUT2--IT,N,TOBT: ',2I5,21F8.1)
   7914 C           WRITE(60,519) IT,N,(TIT(L,N,IT),L=1,NRET)
   7915 C 519       FORMAT(' INPUT2--IT,N,TIT: ',2I5,21F8.1)
   7916             GOTO 10
   7917           ENDIF
   7918         ENDDO
   7919 
   7920         GOTO 10
   7921 
   7922 C  NORMAL END TO READING OF FILE
   7923 C  -----------------------------
   7924 
   7925   100   WRITE(6,501) MATCH,NFTMP(IT)
   7926   501   FORMAT(1X,I5,' OBS FOUND AT MATCHING STATIONS IN UNIT ',I2)
   7927         GOTO 300
   7928 
   7929 C  NO PROPER FILE FOUND AT THIS TIME
   7930 C  ---------------------------------
   7931 
   7932   200   ITERR(IT) = 1
   7933         WRITE(6,502) IIT(IT)
   7934   502   FORMAT(1X,'OFF-TIME UNAVAILABLE FOR ',I3)
   7935 
   7936   300   CONTINUE
   7937         CALL CLOSBF(NFTMP(IT))
   7938       ENDDO
   7939       RETURN
   7940       END

Page 257         Source Listing                  INPUT2
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 input2_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  7868                                                           7875,7888,7916,7920               
 100                        Label  7925                                                           7872                              
 20                         Label  7870                                                           7873                              
 200                        Label  7932                                                           7832,7844,7863                    
 300                        Label  7936                                                           7927                              
 5                          Label  7841                                                           7845                              
 500                        Label  7834                                                           7833                              
 501                        Label  7926                                                           7925                              
 502                        Label  7934                                                           7933                              
 BMISS                      Scalar 7778     R(8)            8           scalar   COM              7815,7816,7818,7819,7820,7821,7902
                                                                                                  ,7904                             
 BUFRLIB_MISSING            Common 7791                                 16                                                          
 CDATE                      Scalar 7785     CHAR            10          scalar   COM                                                
 CIT                        Local  7793     CHAR            8           scalar                    7894                              
 CLOSBF                     Subr   7937                                                           7937                              
 CQCPC                      Scalar 7787     R(4)            4           scalar   COM                                                
 DATELEN                    Subr   7839                                                           7839                              
 DATEX                      Common 7785                                 30                                                          
 DHR                        Scalar 7788     R(4)            4     1     999      COM                                                
 ELV                        Scalar 7789     R(4)            4     1     999      COM              7885                              
 HDR_8                      Local  7778     R(8)            8     1     10                        7878,7881,7882,7883,7884,7885,7886
                                                                                                  ,7888                             
 HEADER                     Common 7788                                 35980                                                       
 HSTR                       Local  7795     CHAR            40          scalar                    7802,7878                         
 I                          Local  7814     I(4)            4           scalar                    7814,7815,7816,7818,7819,7820,7821
 IDAT                       Local  7798     I(4)            4     1     8                         7853,7854,7855,7856,7857,7858,7859
                                                                                                  ,7860,7861                        
 IDATE                      Local  7842     I(4)            4           scalar                    7842,7863,7870                    
 IIT                        Local  7796     I(4)            4     1     4                         7804,7833,7849,7933               
 IMISS                      Scalar 7791     I(4)            4           scalar   COM                                                
 INPUT2                     Subr   7775                                                                                             
 IPEVT                      Scalar 7787     I(4)            4           scalar   COM                                                
 IRET                       Local  7842     I(4)            4           scalar                    7842,7844,7868,7869,7870,7872,7878
 ISC                        Scalar 7787     I(4)            4           scalar   COM                                                
 ISF                        Scalar 7790     I(4)            4     1     999      COM                                                
 IT                         Local  7829     I(4)            4           scalar                    7829,7831,7832,7833,7840,7842,7849
                                                                                                  ,7868,7870,7878,7879,7900,7901,790
                                                                                                  3,7905,7925,7932,7933,7937        
 ITERR                      Scalar 7784     I(4)            4     1     4        COM              7811,7932                         
 ITP                        Scalar 7789     I(4)            4     1     999      COM                                                
 J                          Local  7813     I(4)            4           scalar                    7813,7815,7816,7818,7819,7820,7821
 JDAT                       Local  7798     I(4)            4     1     8                         7861,7862                         
 JDATE                      Scalar 7785     I(4)            4     1     5        COM              7853,7854,7855,7857               
 K                          Local  7810     I(4)            4           scalar                    7810,7811,7817,7818,7819,7820,7821

Page 258         Source Listing                  INPUT2
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KDATE                      Local  7862     I(4)            4           scalar                    7862,7863                         
 L                          Local  7896     I(4)            4           scalar                    7896,7897,7900,7901,7902,7903,7904
                                                                                                  ,7905                             
 LMAND                      Scalar 7787     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 7787     I(4)            4           scalar   COM                                                
 MAND                       Scalar 7786     I(4)            4           scalar   COM              7899                              
 MANL                       Local  7898     I(4)            4           scalar                    7898,7899,7900,7901,7903,7905     
 MANLEV                     Func   7898     I(4)            4           scalar                    7898                              
 MATCH                      Local  7830     I(4)            4           scalar                    7830,7895,7925                    
 N                          Local  7893     I(4)            4           scalar                    7893,7894,7900,7901,7903,7905     
 NEV                        Scalar 7790     I(4)            4           scalar   COM                                                
 NFTMP                      Local  7796     I(4)            4     1     4                         7805,7831,7832,7833,7840,7842,7868
                                                                                                  ,7870,7878,7879,7925,7937         
 NLEV                       Scalar 7786     I(4)            4           scalar   COM                                                
 NLV                        Scalar 7789     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 7790     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 7790     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 7786     I(4)            4           scalar   COM              7893                              
 NRET                       Local  7879     I(4)            4           scalar                    7879,7896                         
 NST                        Param  7776     I(4)            4           scalar                    7780,7781,7782,7783,7788,7789,7790
                                                                                                  ,7813                             
 NTTMP                      Scalar 7783     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 7783     I(4)            4     2     20979    COM                                                
 OPENBF                     Subr   7840                                                           7840                              
 P                          Local  7897     R(4)            4           scalar                    7897,7898                         
 PARAMS                     Common 7786                                 148                                                         
 PRNT                       Scalar 7787     L(4)            4           scalar   COM                                                
 RADPC                      Scalar 7786     R(4)            4           scalar   COM                                                
 READMG                     Subr   7842                                                           7842,7870                         
 READSB                     Subr   7868                                                           7868                              
 RINC                       Local  7797     R(4)            4     1     5                         7848,7849,7850,7851,7852,7861     
 RIT_8                      Local  7778     R(8)            8           scalar                    7881                              
 RPT                        Local  7886     R(4)            4           scalar                    7886                              
 SID                        Scalar 7788     CHAR            8     1     999      COM              7894                              
 SQN                        Scalar 7789     R(4)            4     1     999      COM                                                
 SUBSET                     Local  7793     CHAR            8           scalar                    7842,7843,7870,7871               
 THR                        Local  7884     R(4)            4           scalar                    7884                              
 TIT                        Scalar 7781     R(4)            4     3     83916    COM              7821,7905                         
 TMPSND                     Common 7780                                 1678336                                                     
 TOBT                       Scalar 7780     R(4)            4     3     83916    COM              7819,7901                         
 TT                         Scalar 7787     R(4)            4           scalar   COM                                                
 TTMP                       Scalar 7782     R(4)            4     2     20979    COM              7816                              
 UFBINT                     Subr   7878                                                           7878,7879                         
 UPA_8                      Local  7778     R(8)            8     2     2550                      7879,7897,7900,7901,7902,7903,7904
                                                                                                  ,7905                             
 USTR                       Local  7795     CHAR            40          scalar                    7803,7879                         
 VTPPC                      Scalar 7786     R(4)            4           scalar   COM                                                
 W3MOVDAT                   Subr   7861                                                           7861                              
 X                          Local  7882     R(4)            4           scalar                    7882,7894                         
 XMA                        Scalar 7786     R(4)            4           scalar   COM                                                
 XMI                        Scalar 7786     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 7791     R(4)            4           scalar   COM                                                
 XOB                        Scalar 7788     R(4)            4     1     999      COM              7894                              
 Y                          Local  7883     R(4)            4           scalar                    7883,7894                         
 YMA                        Scalar 7786     R(4)            4           scalar   COM                                                

Page 259         Source Listing                  INPUT2
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YMI                        Scalar 7786     R(4)            4           scalar   COM                                                
 YOB                        Scalar 7788     R(4)            4     1     999      COM              7894                              
 ZIT                        Scalar 7781     R(4)            4     3     83916    COM              7820,7903                         
 ZOBT                       Scalar 7780     R(4)            4     3     83916    COM              7818,7900                         
 ZTMP                       Scalar 7782     R(4)            4     2     20979    COM              7815                              

Page 260         Source Listing                  INPUT2
2017-04-18 11:07                                 cqcbufr.f

   7941 
   7942 C******************************************************************
   7943 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7944 C                .      .    .                                       .
   7945 C SUBPROGRAM:    ISGOOD      MAKE QUICK DIAGNOSIS OF ERRORS.
   7946 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
   7947 C
   7948 C ABSTRACT: Make a quick estimate of which data are in error, using
   7949 C   hydrostatic, increment, vertical, and lapse rate residuals. Make
   7950 C   the determination only for mandatory levels.  These results are
   7951 C   used to determine which data are eligible to be used in the
   7952 C   horizontal check.
   7953 C
   7954 C PROGRAM HISTORY LOG:
   7955 C 1997-03-18  W. Collins  Original author.
   7956 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
   7957 C     were tested for not being equal to real value for missing (BMISS
   7958 C     = 10E10), these integer values can never be equal to BMISS for
   7959 C     I*4 due to overflow - instead they are now tested for not being
   7960 C     equal to new integer value for missing (IMISS, also = 10E10),
   7961 C     although this is also an overflow value for I*4, it results in a
   7962 C     correct evaluation
   7963 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
   7964 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
   7965 C     overflow (also done for IMISS). 
   7966 C
   7967 C USAGE:    CALL ISGOOD
   7968 C   OUTPUT FILES:
   7969 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   7970 C
   7971 C REMARKS: NONE.
   7972 C
   7973 C ATTRIBUTES:
   7974 C   LANGUAGE: FORTRAN 90
   7975 C   MACHINE:  NCEP WCOSS
   7976 C
   7977 C$$$
   7978 
   7979       SUBROUTINE ISGOOD
   7980       PARAMETER (NST=999)
   7981 
   7982       REAL(8) BMISS
   7983 
   7984       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   7985      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   7986      &                 NEV, ISF(NST), NLVM, NLVW
   7987       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   7988      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   7989      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   7990      &                 TDO(255), TDFC(255),TVO(255),
   7991      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   7992      &                 CAT(255), IND(255), LEVTYP(255),
   7993      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   7994      &                 YDR(255), XDR(255)
   7995       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   7996      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   7997       COMMON /LEVEL/   PMAND(21)

Page 261         Source Listing                  ISGOOD
2017-04-18 11:07                                 cqcbufr.f

   7998       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   7999      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   8000      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   8001      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   8002      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   8003      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   8004      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   8005      &                 XTHM(21,NST),XTDVM(21,NST),
   8006      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   8007      &                 XQHM(21,NST),
   8008      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   8009      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   8010       COMMON /STN/     IS
   8011       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   8012      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   8013      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   8014      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   8015      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   8016      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   8017      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   8018      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   8019      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   8020      &                 XTDH(255)
   8021       COMMON /TESTS/   TEST
   8022       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   8023 
   8024       LOGICAL          TEST
   8025       CHARACTER*8 SID
   8026       LOGICAL          ERROR,ZG,TG,TDG,QG,SINGLE, PRNT
   8027 
   8028       DO I=1,21
   8029         ZG(I,IS)    = .TRUE.
   8030         TG(I,IS)    = .TRUE.
   8031         TDG(I,IS)   = .TRUE.
   8032         QG(I,IS)    = .TRUE.
   8033       ENDDO
   8034       ERROR(IS) = .FALSE.
   8035       DO L=1,255
   8036         DO I=1,4
   8037           IHSC(I,L)  = 0
   8038         ENDDO
   8039       ENDDO
   8040       L1    = 0
   8041       LOW   = 1
   8042 
   8043 C  DO PRELIMINARY QUALITY CHECK FOR MANDATORY LEVELS ONLY
   8044 C  ------------------------------------------------------
   8045 
   8046       IF(TEST) WRITE(60,503) SID(IS),NLV
   8047   503 FORMAT(' ISGOOD--STN,NLV: ',A8,2X,I5)
   8048       DO L=1,MAND
   8049         LM = LMAND(L)
   8050 C       IF(LM.GT.255 .OR. LM.EQ.0) GOTO 100
   8051         IF(LM.GT.255 .OR. LM.EQ.0) THEN
   8052           IF(TEST) WRITE(60,504) L,LM,CAT(L),MANLEV(POB(L))
   8053   504     FORMAT(' ISGOOD--L,LM,CAT,MANLEV: ',I5,2X,I12,F8.0,I5)
   8054           GOTO 100

Page 262         Source Listing                  ISGOOD
2017-04-18 11:07                                 cqcbufr.f

   8055         ENDIF
   8056         IF(L1.EQ.0) L1 = L
   8057         ISUMZ  = 0
   8058         ISUMT  = 0
   8059         ISUMTD = 0
   8060         ISUMQ  = 0
   8061         ITSTZ  = 0
   8062         ITSTT  = 0
   8063         ITSTTD = 0
   8064         ITSTQ  = 0
   8065         IF(NZIM(L,IS).GE.10)      ISUMZ  = ISUMZ + 1
   8066         IF(NZV(LM).GE.10)         ISUMZ  = ISUMZ + 1
   8067 C       IF(NZHM(L,IS).GE.10)      ISUMZ  = ISUMZ + 1
   8068         IF(NTIM(L,IS).GE.10)      ISUMT  = ISUMT + 1
   8069         IF(NTV(LM).GE.10)         ISUMT  = ISUMT + 1
   8070 C       IF(NTHM(L,IS).GE.10)      ISUMT  = ISUMT + 1
   8071         IF(NTDIM(L,IS).GE.10)     ISUMTD = ISUMTD + 1
   8072         IF(NTDV(LM).GE.10)        ISUMTD = ISUMTD + 1
   8073 C       IF(NTDHM(L,IS).GE.10)     ISUMTD = ISUMTD + 1
   8074         IF(NQV(LM).GE.10)         ISUMQ  = ISUMQ + 1
   8075 C       IF(NQHM(L,IS).GE.10)      ISUMQ  = ISUMQ + 1
   8076         IF(NZIM(L,IS).NE.-1)      ITSTZ  = ITSTZ + 1
   8077         IF(NZV(LM).NE.-1)         ITSTZ  = ITSTZ + 1
   8078 C       IF(NZHM(L,IS).NE.-1)      ITSTZ  = ITSTZ + 1
   8079         IF(NTIM(L,IS).NE.-1)      ITSTT  = ITSTT + 1
   8080         IF(NTV(LM).NE.-1)         ITSTT  = ITSTT + 1
   8081 C       IF(NTHM(L,IS).NE.-1)      ITSTT  = ITSTT + 1
   8082         IF(NTDIM(L,IS).NE.-1)     ITSTTD = ITSTTD + 1
   8083         IF(NTDV(LM).NE.-1)        ITSTTD = ITSTTD + 1
   8084 C       IF(NTDHM(L,IS).NE.-1)     ITSTTD = ITSTTD + 1
   8085         IF(NQV(LM).NE.-1)         ITSTQ  = ITSTQ + 1
   8086 C       IF(NQHM(L,IS).NE.-1)      ITSTQ  = ITSTQ + 1
   8087         IF(L.EQ.L1) THEN
   8088           IF(NHYDN(L1).GE.10) THEN
   8089             ISUMZ = ISUMZ + 1
   8090             ISUMT = ISUMT + 1
   8091             ITSTZ = ITSTZ + 1
   8092             ITSTT = ITSTT + 1
   8093           ENDIF
   8094           I = LMAND(L1)
   8095           IF(NTL(I).GE.3) THEN
   8096             ISUMT = ISUMT + 1
   8097             ITSTT = ITSTT + 1
   8098           ENDIF
   8099         ELSEIF(L.EQ.LMAND(0)) THEN
   8100           IF(NHYDN(LOW).GE.10) THEN
   8101             ISUMZ = ISUMZ + 1
   8102             ISUMT = ISUMT + 1
   8103             ITSTZ = ITSTZ + 1
   8104             ITSTT = ITSTT + 1
   8105           ENDIF
   8106           I = LMAND(LOW)
   8107           IF(NTL(I).GE.3) THEN
   8108             ISUMT = ISUMT + 1
   8109             ITSTT = ITSTT + 1
   8110           ENDIF
   8111         ELSE

Page 263         Source Listing                  ISGOOD
2017-04-18 11:07                                 cqcbufr.f

   8112           IF(NHYD(LOW).GE.10 .OR. NHYDN(L).GE.10) THEN
   8113             ISUMZ = ISUMZ + 1
   8114             ISUMT = ISUMT + 1
   8115             ITSTZ = ITSTZ + 1
   8116             ITSTT = ITSTT + 1
   8117           ENDIF
   8118           IM = LMAND(LOW)
   8119 cdak      IF(IM.NE.BMISS) THEN
   8120           IF(IM.NE.IMISS) THEN ! IM will never test = bmiss, use imiss
   8121             IF(NTL(IM).GE.3) THEN
   8122               ISUMT = ISUMT + 1
   8123               ITSTT = ITSTT + 1
   8124             ENDIF
   8125           ENDIF
   8126           I  = LMAND(L)
   8127 cdak      IF(I.NE.BMISS) THEN
   8128           IF(I.NE.IMISS) THEN ! IM will never test = bmiss, use imiss
   8129             IF(NTL(I).GE.3) THEN
   8130               ISUMT = ISUMT + 1
   8131               ITSTT = ITSTT + 1
   8132             ENDIF
   8133           ENDIF
   8134         ENDIF
   8135 
   8136         IF(ITSTZ.EQ.0) ITSTZ = 1
   8137         IF(ITSTT.EQ.0) ITSTT = 1
   8138         IF(ITSTTD.EQ.0) ITSTTD = 1
   8139         RZ  = FLOAT(ISUMZ)/FLOAT(ITSTZ)
   8140         RT  = FLOAT(ISUMT)/FLOAT(ITSTT)
   8141         RTD = FLOAT(ISUMTD)/FLOAT(ITSTTD)
   8142 
   8143         IF(ISUMZ.GE.1 .AND. RZ.GE..5) THEN
   8144           ZG(L,IS) = .FALSE.
   8145           IHSC(2,LM) = 99
   8146           IF(TEST) WRITE(60,500) SID(IS),PMAND(L),ZG(L,IS),ISUMZ,ITSTZ
   8147   500     FORMAT(' ISGOOD--Z    BAD FOR ',A8,' AT ',F10.1,' MB',
   8148      &      '  ZG: ',L1,'  ISUMZ,ITSTZ: ',2I2)
   8149         ENDIF
   8150         IF(ISUMT.GE.1 .AND. RT.GE..5) THEN
   8151           TG(L,IS) = .FALSE.
   8152           IHSC(3,LM) = 99
   8153           IF(TEST) WRITE(60,501) SID(IS),PMAND(L),TG(L,IS),ISUMT,ITSTT
   8154   501     FORMAT(' ISGOOD--T    BAD FOR ',A8,' AT ',F10.1,' MB',
   8155      &      '  TG: ',L1,'  ISUMT,ITSTT: ',2I2)
   8156         ENDIF
   8157         IF(ISUMTD+ISUMQ.GE.1 .AND. RTD.GT..5) THEN
   8158           TDG(L,IS) = .FALSE.
   8159           QG(L,IS)  = .FALSE.
   8160           IHSC(4,LM) = 99
   8161           IF(TEST) WRITE(60,502) SID(IS),PMAND(L),TDG(L,IS),QG(L,IS),
   8162      &      ISUMTD,ITSTTD
   8163   502     FORMAT(' ISGOOD--TD,Q BAD FOR ',A8,' AT ',F10.1,' MB',
   8164      &      '  TDG,QG: ',2L1,'  ISUMTD,ITSTTD: ',2I2)
   8165         ENDIF
   8166 
   8167         IF(.NOT. ZG(L,IS) .OR. .NOT.TG(L,IS)) ERROR(IS) = .TRUE.
   8168 

Page 264         Source Listing                  ISGOOD
2017-04-18 11:07                                 cqcbufr.f

   8169         LOW = L
   8170   100   CONTINUE	
   8171       ENDDO
   8172 
   8173 C  TEST FOR BASELINE ERROR
   8174 C  -----------------------
   8175 
   8176       IF(NBAS.GT.10 .OR. ABS(PIS(IS)).GT.5.
   8177      &   .OR. ABS(PSINC).GT.5.) ERROR(IS) = .TRUE.
   8178 
   8179 C  TEST FOR POSSIBLE OBSERVATION ERRORS
   8180 C  ------------------------------------
   8181 
   8182       DO L=1,MAND
   8183         LM = LMAND(L)
   8184         IF(LM.GT.0 .AND. LM.LE.255) THEN
   8185           IF(NZI(LM).GT.10 .AND. NZV(LM).GT.10) THEN
   8186             ZG(L,IS) = .FALSE.
   8187             IHSC(2,LM) = 99
   8188             ERROR(IS) = .TRUE.
   8189             IF(TEST) WRITE(60,500) SID(IS),PMAND(L),ZG(L,IS)
   8190           ENDIF
   8191           IF(NTI(LM).GT.6 .AND. NTV(LM).GT.6) THEN
   8192             TG(L,IS) = .FALSE.
   8193             IHSC(3,LM) = 99
   8194             ERROR(IS) = .TRUE.
   8195             IF(TEST) WRITE(60,501) SID(IS),PMAND(L),TG(L,IS)
   8196           ENDIF
   8197         ENDIF
   8198       ENDDO
   8199 
   8200       RETURN
   8201       END

Page 265         Source Listing                  ISGOOD
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 isgood_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  8170                                                           8054                              
 500                        Label  8147                                                           8146,8189                         
 501                        Label  8154                                                           8153,8195                         
 502                        Label  8163                                                           8161                              
 503                        Label  8047                                                           8046                              
 504                        Label  8053                                                           8052                              
 ABS                        Func   8176                                 scalar                    8176,8177                         
 ALLSND                     Common 7987                                 34512                                                       
 B                          Scalar 8019     R(4)            4     1     21       COM                                                
 BASRES                     Scalar 8018     R(4)            4     1     999      COM                                                
 BMISS                      Scalar 7982     R(8)            8           scalar   COM                                                
 BRES                       Scalar 8009     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 8022                                 16                                                          
 CAT                        Scalar 7992     R(4)            4     1     255      COM              8052                              
 CQCPC                      Scalar 7996     R(4)            4           scalar   COM                                                
 DHR                        Scalar 7984     R(4)            4     1     999      COM                                                
 ELV                        Scalar 7985     R(4)            4     1     999      COM                                                
 ERROR                      Scalar 8009     L(4)            4     1     999      COM              8034,8167,8177,8188,8194          
 FLOAT                      Func   8139                                 scalar                    8139,8140,8141                    
 GESPS                      Scalar 7993     R(4)            4     1     999      COM                                                
 HEADER                     Common 7984                                 35980                                                       
 HRDR                       Scalar 7993     R(4)            4     1     255      COM                                                
 HYD                        Scalar 8017     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 8009     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 8017     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 8017     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 8017     R(4)            4     1     21       COM                                                
 I                          Local  8028     I(4)            4           scalar                    8028,8029,8030,8031,8032,8036,8037
                                                                                                  ,8094,8095,8106,8107,8126,8128,812
                                                                                                  9                                 
 IHSC                       Scalar 8018     I(4)            4     2     1020     COM              8037,8145,8152,8160,8187,8193     
 IM                         Local  8118     I(4)            4           scalar                    8118,8120,8121                    
 IMISS                      Scalar 8022     I(4)            4           scalar   COM              8120,8128                         
 IND                        Scalar 7992     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 7996     I(4)            4           scalar   COM                                                
 IS                         Scalar 8010     I(4)            4           scalar   COM              8029,8030,8031,8032,8034,8046,8065
                                                                                                  ,8068,8071,8076,8079,8082,8144,814
                                                                                                  6,8151,8153,8158,8159,8161,8167,81
                                                                                                  76,8177,8186,8188,8189,8192,8194,8
                                                                                                  195                               
 ISC                        Scalar 7996     I(4)            4           scalar   COM                                                
 ISF                        Scalar 7986     I(4)            4     1     999      COM                                                
 ISGOOD                     Subr   7979                                                                                             
 ISUMQ                      Local  8060     I(4)            4           scalar                    8060,8074,8157                    

Page 266         Source Listing                  ISGOOD
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ISUMT                      Local  8058     I(4)            4           scalar                    8058,8068,8069,8090,8096,8102,8108
                                                                                                  ,8114,8122,8130,8140,8150,8153    
 ISUMTD                     Local  8059     I(4)            4           scalar                    8059,8071,8072,8141,8157,8162     
 ISUMZ                      Local  8057     I(4)            4           scalar                    8057,8065,8066,8089,8101,8113,8139
                                                                                                  ,8143,8146                        
 ITP                        Scalar 7985     I(4)            4     1     999      COM                                                
 ITSTQ                      Local  8064     I(4)            4           scalar                    8064,8085                         
 ITSTT                      Local  8062     I(4)            4           scalar                    8062,8079,8080,8092,8097,8104,8109
                                                                                                  ,8116,8123,8131,8137,8140,8153    
 ITSTTD                     Local  8063     I(4)            4           scalar                    8063,8082,8083,8138,8141,8162     
 ITSTZ                      Local  8061     I(4)            4           scalar                    8061,8076,8077,8091,8103,8115,8136
                                                                                                  ,8139,8146                        
 L                          Local  8035     I(4)            4           scalar                    8035,8037,8048,8049,8052,8056,8065
                                                                                                  ,8068,8071,8076,8079,8082,8087,809
                                                                                                  9,8112,8126,8144,8146,8151,8153,81
                                                                                                  58,8159,8161,8167,8169,8182,8183,8
                                                                                                  186,8189,8192,8195                
 L1                         Local  8040     I(4)            4           scalar                    8040,8056,8087,8088,8094          
 LEVEL                      Common 7997                                 84                                                          
 LEVTYP                     Scalar 7992     I(4)            4     1     255      COM                                                
 LM                         Local  8049     I(4)            4           scalar                    8049,8051,8052,8066,8069,8072,8074
                                                                                                  ,8077,8080,8083,8085,8145,8152,816
                                                                                                  0,8183,8184,8185,8187,8191,8193   
 LMAND                      Scalar 7996     I(4)            4     1     22       COM              8049,8094,8099,8106,8118,8126,8183
 LOW                        Local  8041     I(4)            4           scalar                    8041,8100,8106,8112,8118,8169     
 LSFC                       Scalar 7996     I(4)            4           scalar   COM                                                
 LST                        Scalar 7993     I(4)            4     1     255      COM                                                
 MAND                       Scalar 7995     I(4)            4           scalar   COM              8048,8182                         
 MANLEV                     Func   8052     I(4)            4           scalar                    8052                              
 MANRES                     Common 7998                                 2949048                                                     
 NBAS                       Scalar 8019     I(4)            4           scalar   COM              8176                              
 NEV                        Scalar 7986     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 8017     I(4)            4     1     21       COM              8112                              
 NHYDN                      Scalar 8019     I(4)            4     1     21       COM              8088,8100,8112                    
 NLEV                       Scalar 7995     I(4)            4           scalar   COM                                                
 NLV                        Scalar 7985     I(4)            4           scalar   COM              8046                              
 NLVM                       Scalar 7986     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 7986     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 7995     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 8006     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 8013     I(4)            4     1     255      COM                                                
 NQV                        Scalar 8015     I(4)            4     1     255      COM              8074,8085                         
 NST                        Param  7980     I(4)            4           scalar                    7984,7985,7986,7993,7998,7999,8000
                                                                                                  ,8001,8002,8003,8004,8005,8006,800
                                                                                                  7,8008,8009,8018                  
 NTDHM                      Scalar 8006     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 8013     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 8001     I(4)            4     2     20979    COM              8071,8082                         
 NTDV                       Scalar 8015     I(4)            4     1     255      COM              8072,8083                         
 NTHM                       Scalar 8004     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 8013     I(4)            4     1     255      COM              8191                              
 NTIM                       Scalar 8001     I(4)            4     2     20979    COM              8068,8079                         
 NTL                        Scalar 8015     I(4)            4     1     255      COM              8095,8107,8121,8129               
 NTV                        Scalar 8015     I(4)            4     1     255      COM              8069,8080,8191                    
 NZHM                       Scalar 8004     I(4)            4     2     20979    COM                                                

Page 267         Source Listing                  ISGOOD
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NZI                        Scalar 8013     I(4)            4     1     255      COM              8185                              
 NZIM                       Scalar 8001     I(4)            4     2     20979    COM              8065,8076                         
 NZV                        Scalar 8015     I(4)            4     1     255      COM              8066,8077,8185                    
 PARAMS                     Common 7995                                 148                                                         
 PFC                        Scalar 7987     R(4)            4     1     255      COM                                                
 PI                         Scalar 8011     R(4)            4     1     255      COM                                                
 PIS                        Scalar 8009     R(4)            4     1     999      COM              8176                              
 PMAND                      Scalar 7997     R(4)            4     1     21       COM              8146,8153,8161,8189,8195          
 POB                        Scalar 7987     R(4)            4     1     255      COM              8052                              
 PQM                        Scalar 7987     R(4)            4     1     255      COM                                                
 PRC                        Scalar 7987     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 7996     L(4)            4           scalar   COM                                                
 PS                         Scalar 7993     R(4)            4     1     999      COM                                                
 PSINC                      Scalar 8018     R(4)            4           scalar   COM              8177                              
 QFC                        Scalar 7991     R(4)            4     1     255      COM                                                
 QG                         Scalar 8008     L(4)            4     2     20979    COM              8032,8159,8161                    
 QHM                        Scalar 7999     R(4)            4     2     20979    COM                                                
 QI                         Scalar 8011     R(4)            4     1     255      COM                                                
 QIM                        Scalar 7998     R(4)            4     2     20979    COM                                                
 QOB                        Scalar 7991     R(4)            4     1     255      COM                                                
 QQM                        Scalar 7991     R(4)            4     1     255      COM                                                
 QRC                        Scalar 7991     R(4)            4     1     255      COM                                                
 QV                         Scalar 8012     R(4)            4     1     255      COM                                                
 QVM                        Scalar 8000     R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 7995     R(4)            4           scalar   COM                                                
 RESID                      Common 8011                                 41312                                                       
 RT                         Local  8140     R(4)            4           scalar                    8140,8150                         
 RTD                        Local  8141     R(4)            4           scalar                    8141,8157                         
 RZ                         Local  8139     R(4)            4           scalar                    8139,8143                         
 SID                        Scalar 7984     CHAR            8     1     999      COM              8046,8146,8153,8161,8189,8195     
 SINGLE                     Local  8026     L(4)            4           scalar                                                      
 SQN                        Scalar 7985     R(4)            4     1     999      COM                                                
 STN                        Common 8010                                 4                                                           
 TDFC                       Scalar 7990     R(4)            4     1     255      COM                                                
 TDG                        Scalar 8008     L(4)            4     2     20979    COM              8031,8158,8161                    
 TDHM                       Scalar 7999     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 8011     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 7998     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 7990     R(4)            4     1     255      COM                                                
 TDV                        Scalar 8012     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 8000     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 8021     L(4)            4           scalar   COM              8046,8052,8146,8153,8161,8189,8195
 TESTS                      Common 8021                                 4                                                           
 TFC                        Scalar 7989     R(4)            4     1     255      COM                                                
 TG                         Scalar 8008     L(4)            4     2     20979    COM              8030,8151,8153,8167,8192,8195     
 THM                        Scalar 7999     R(4)            4     2     20979    COM                                                
 TI                         Scalar 8011     R(4)            4     1     255      COM                                                
 TIM                        Scalar 7998     R(4)            4     2     20979    COM                                                
 TL                         Scalar 8012     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 8018     R(4)            4     1     255      COM                                                
 TOB                        Scalar 7989     R(4)            4     1     255      COM                                                
 TQM                        Scalar 7989     R(4)            4     1     255      COM                                                
 TRC                        Scalar 7989     R(4)            4     1     255      COM                                                
 TT                         Scalar 7996     R(4)            4           scalar   COM                                                
 TV                         Scalar 8012     R(4)            4     1     255      COM                                                

Page 268         Source Listing                  ISGOOD
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TVM                        Scalar 8000     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 7990     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 7995     R(4)            4           scalar   COM                                                
 XDR                        Scalar 7994     R(4)            4     1     255      COM                                                
 XMA                        Scalar 7995     R(4)            4           scalar   COM                                                
 XMI                        Scalar 7995     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 8022     R(4)            4           scalar   COM                                                
 XOB                        Scalar 7984     R(4)            4     1     999      COM                                                
 XQHM                       Scalar 8007     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 8014     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 8003     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 8016     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 8020     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 8006     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 8014     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 8002     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 8016     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 8005     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 8019     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 8005     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 8014     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 8002     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 8016     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 8003     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 8019     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 8004     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 8014     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 8002     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 8016     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 8003     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 7994     R(4)            4     1     255      COM                                                
 YMA                        Scalar 7995     R(4)            4           scalar   COM                                                
 YMI                        Scalar 7995     R(4)            4           scalar   COM                                                
 YOB                        Scalar 7984     R(4)            4     1     999      COM                                                
 ZD                         Scalar 8019     R(4)            4     1     255      COM                                                
 ZFC                        Scalar 7988     R(4)            4     1     255      COM                                                
 ZG                         Scalar 8008     L(4)            4     2     20979    COM              8029,8144,8146,8167,8186,8189     
 ZHM                        Scalar 7999     R(4)            4     2     20979    COM                                                
 ZI                         Scalar 8011     R(4)            4     1     255      COM                                                
 ZIM                        Scalar 7998     R(4)            4     2     20979    COM                                                
 ZOB                        Scalar 7988     R(4)            4     1     255      COM                                                
 ZQM                        Scalar 7988     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 7988     R(4)            4     1     255      COM                                                
 ZV                         Scalar 8012     R(4)            4     1     255      COM                                                
 ZVM                        Scalar 8000     R(4)            4     2     20979    COM                                                

Page 269         Source Listing                  ISGOOD
2017-04-18 11:07                                 cqcbufr.f

   8202 
   8203 C**********************************************************************
   8204 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8205 C                .      .    .                                       .
   8206 C SUBPROGRAM:    ISOLAT      GET LIST OF ISOLATED STATIONS
   8207 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1994-03-17
   8208 C
   8209 C ABSTRACT: GET LIST OF ISOLATED STATIONS.
   8210 C
   8211 C PROGRAM HISTORY LOG:
   8212 C 1994-03-17  W. Collins  Original author.
   8213 C
   8214 C USAGE:    CALL ISOLAT(ID)
   8215 C   INPUT ARGUMENT LIST:
   8216 C     ID       - STATION IDENTIFIER
   8217 C
   8218 C REMARKS: NONE.
   8219 C
   8220 C ATTRIBUTES:
   8221 C   LANGUAGE: FORTRAN 90
   8222 C   MACHINE:  NCEP WCOSS
   8223 C
   8224 C$$$
   8225       SUBROUTINE ISOLAT(ID)
   8226       PARAMETER (NST=999)
   8227 
   8228 C
   8229 C     COLLECT LIST OF ISOLATED STATIONS.
   8230 C     THESE STATIONS HAD NO NEIGHBORS FOR HORIZONTAL CHECK.
   8231 C
   8232       COMMON /ISO/ IDISO(NST),NUM,ISISO
   8233       LOGICAL ISISO
   8234       DATA ISTART /0/
   8235       IF(ISTART.EQ.0) THEN
   8236         DO I=1,NST
   8237           IDISO(I) = 0
   8238         END DO
   8239         ISTART = 1
   8240         NUM = 0
   8241       ENDIF
   8242 
   8243 C     CHECK TO SEE IF ID IS ON THE LIST.
   8244 
   8245       DO I=1,NUM
   8246         IF(ID.EQ.IDISO(I)) GO TO 10
   8247       END DO
   8248         NUM = NUM + 1
   8249         IDISO(NUM) = ID
   8250    10 CONTINUE
   8251       RETURN
   8252       END

Page 270         Source Listing                  ISOLAT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 isolat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  8250                                                           8246                              
 I                          Local  8236     I(4)            4           scalar                    8236,8237,8245,8246               
 ID                         Dummy  8225     I(4)            4           scalar   ARG,INOUT        8246,8249                         
 IDISO                      Scalar 8232     I(4)            4     1     999      COM              8237,8246,8249                    
 ISISO                      Scalar 8232     L(4)            4           scalar   COM                                                
 ISO                        Common 8232                                 4004                                                        
 ISOLAT                     Subr   8225                                                                                             
 ISTART                     Local  8234     I(4)            4           scalar                    8234,8235,8239                    
 NST                        Param  8226     I(4)            4           scalar                    8232,8236                         
 NUM                        Scalar 8232     I(4)            4           scalar   COM              8240,8245,8248,8249               

Page 271         Source Listing                  ISOLAT
2017-04-18 11:07                                 cqcbufr.f

   8253 
   8254 C******************************************************************
   8255 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8256 C                .      .    .                                       .
   8257 C SUBPROGRAM:    ISORT       SORT, BASED ON ORDER IN INDX
   8258 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1994-03-17
   8259 C
   8260 C ABSTRACT: SORT INTEGERS IA ACCORDING TO THE ORDER SPECIFIED BY THE
   8261 C   INDICES IN INDX.
   8262 C
   8263 C PROGRAM HISTORY LOG:
   8264 C 1994-03-17  W. Collins  Original author.
   8265 C
   8266 C USAGE:    CALL SORT(IA,INDX,N)
   8267 C   INPUT ARGUMENT LIST:
   8268 C     IA       - VARIABLE
   8269 C     INDX     - ORDER FOR REARRANGEMENT OF RA
   8270 C     N        - DIMENSION OF RA
   8271 C
   8272 C   OUTPUT ARGUMENT LIST:
   8273 C     IA       - VARIABLE
   8274 C
   8275 C REMARKS: NONE.
   8276 C
   8277 C ATTRIBUTES:
   8278 C   LANGUAGE: FORTRAN 90
   8279 C   MACHINE:  NCEP WCOSS
   8280 C
   8281 C$$$
   8282       SUBROUTINE ISORT(IA,INDX,N)
   8283 C
   8284 C     SORT IA ACCORDING TO THE ORDER SPECIFIED BY THE
   8285 C     INDICES IN INDX.
   8286 
   8287       PARAMETER (NST=999)
   8288       DIMENSION IA(*), IKSP(NST)
   8289       INTEGER INDX(*)
   8290       DO J=1,N
   8291          IKSP(J) = IA(J)
   8292       ENDDO
   8293       DO J=1,N
   8294          IA(J) = IKSP(INDX(J))
   8295       ENDDO
   8296       RETURN
   8297       END

Page 272         Source Listing                  ISORT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 isort_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IA                         Dummy  8282     I(4)            4     1     0        ARG,INOUT        8291,8294                         
 IKSP                       Local  8288     I(4)            4     1     999                       8291,8294                         
 INDX                       Dummy  8282     I(4)            4     1     0        ARG,INOUT        8294                              
 ISORT                      Subr   8282                                                                                             
 J                          Local  8290     I(4)            4           scalar                    8290,8291,8293,8294               
 N                          Dummy  8282     I(4)            4           scalar   ARG,INOUT        8290,8293                         
 NST                        Param  8287     I(4)            4           scalar                    8288                              

Page 273         Source Listing                  ISORT
2017-04-18 11:07                                 cqcbufr.f

   8298 
   8299 C******************************************************************
   8300 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8301 C                .      .    .                                       .
   8302 C SUBPROGRAM:    LAPSE       PERFORM LAPSE RATE CHECK
   8303 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   8304 C
   8305 C ABSTRACT: Perform lapse rate check. The parameter NTL is assigned
   8306 C   to indicate the stability as follows:
   8307 C     1 - ABSOLUTELY STABLE
   8308 C     2 - STABLE TO UNSATURATED AIR BUT UNSTABLE TO SATURATED AIR
   8309 C     3 - ABSOLUTELY UNSTABLE
   8310 C     4 - ABSOLUTELY UNSTABLE WITH LOOSE LIMITS
   8311 C
   8312 C PROGRAM HISTORY LOG:
   8313 C 1997-03-18  W. Collins  Original author.
   8314 C
   8315 C USAGE:    CALL LAPSE
   8316 C
   8317 C REMARKS: NONE.
   8318 C
   8319 C ATTRIBUTES:
   8320 C   LANGUAGE: FORTRAN 90
   8321 C   MACHINE:  NCEP WCOSS
   8322 C
   8323 C$$$
   8324 
   8325       SUBROUTINE LAPSE
   8326       PARAMETER (NST=999)
   8327 
   8328       REAL(8) BMISS
   8329 
   8330       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   8331      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   8332      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   8333      &                 TDO(255), TDFC(255),TVO(255),
   8334      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   8335      &                 CAT(255), IND(255), LEVTYP(255),
   8336      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   8337      &                 YDR(255), XDR(255)
   8338       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   8339      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   8340      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   8341      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   8342      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   8343      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   8344      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   8345      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   8346      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   8347      &                 XTDH(255)
   8348       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   8349      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   8350       COMMON /CONSTS/  R, G, T0, CP, RV
   8351       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   8352 
   8353       LOGICAL          PRNT
   8354 

Page 274         Source Listing                  LAPSE
2017-04-18 11:07                                 cqcbufr.f

   8355 C  CALCULATE LAPSE RATES BETWEEN ALL PAIRS OF LEVELS ABOVE THE SFC
   8356 C  CALCULATE ONLY FOR LEVELS WITH NON-MISSING TEMPERATURES
   8357 C  ASSIGN NTL AS FOLLOWS:
   8358 C    1 - ABSOLUTELY STABLE
   8359 C    2 - STABLE TO UNSATURATED AIR BUT UNSTABLE TO SATURATED AIR
   8360 C    3 - ABSOLUTELY UNSTABLE
   8361 C    4 - ABSOLUTELY UNSTABLE WITH LOOSE LIMITS
   8362 C  ---------------------------------------------------------------
   8363 
   8364       GOR   = G/R
   8365       DAL   = G/CP
   8366       DO I=1,255
   8367         TL(I)    = BMISS
   8368         TLSAT(I) = BMISS
   8369         NTL(I)   = -1
   8370       ENDDO
   8371       LMIN = MAX(1,LSFC)
   8372       DO L=LMIN,NLEV-1
   8373         IF(LEVTYP(L).EQ.3) GOTO 100
   8374         DO LL=L+1,NLEV
   8375           IF(LEVTYP(LL).NE.3) GOTO 50
   8376         ENDDO
   8377         GOTO 100
   8378    50   CONTINUE
   8379         TKL = TOB(L) + T0
   8380         TKLL = TOB(LL) + T0
   8381         IF(NINT(POB(LL)*10.).GE.NINT(POB(L)*10.)) GOTO 100
   8382         IF(TKL.NE.0. .AND. POB(LL).NE.0. .AND. POB(L).NE.0.) THEN
   8383           IF((TKLL/TKL).GT.0. .AND. (POB(LL)/POB(L)).GT.0.) THEN
   8384             TL(L) = GOR * ALOG((TKLL)/(TKL)) / ALOG(POB(LL)/POB(L))
   8385             TLL   = GOR * ALOG((TKLL+2.)/(TKL)) / ALOG(POB(LL)/POB(L))
   8386           ENDIF
   8387         ELSE
   8388           GOTO 100
   8389         ENDIF
   8390         XL = (2.501 - .00237*TOB(L))*1.E6
   8391         ES = 6.1078 * EXP((17.269*TOB(L))/(TOB(L)+237.3))
   8392         PV = .622*XL / (R*TKL)
   8393         TLSAT(L) = (G/CP)*((POB(L)+PV)/(POB(L)+(XL/(CP*TKL))*
   8394      &    (R/RV)*PV))
   8395         IF(TLL.GT.DAL) THEN
   8396           NTL(L) = 4
   8397         ELSEIF(TL(L).GT.DAL) THEN
   8398           NTL(L) = 3
   8399         ELSEIF(TL(L).GT.TLSAT(L) .AND. TL(L).LT.DAL) THEN
   8400           NTL(L) = 2
   8401         ELSE
   8402           NTL(L) = 1
   8403         ENDIF
   8404   100   CONTINUE
   8405       ENDDO
   8406 
   8407       RETURN
   8408       END

Page 275         Source Listing                  LAPSE
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 lapse_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  8404                                                           8373,8377,8381,8388               
 50                         Label  8378                                                           8375                              
 ALLSND                     Common 8330                                 34512                                                       
 ALOG                       Func   8384                                 scalar                    8384,8385                         
 B                          Scalar 8346     R(4)            4     1     21       COM                                                
 BASRES                     Scalar 8345     R(4)            4     1     999      COM                                                
 BMISS                      Scalar 8328     R(8)            8           scalar   COM              8367,8368                         
 BUFRLIB_MISSING            Common 8351                                 16                                                          
 CAT                        Scalar 8335     R(4)            4     1     255      COM                                                
 CONSTS                     Common 8350                                 20                                                          
 CP                         Scalar 8350     R(4)            4           scalar   COM              8365,8393                         
 CQCPC                      Scalar 8349     R(4)            4           scalar   COM                                                
 DAL                        Local  8365     R(4)            4           scalar                    8365,8395,8397,8399               
 ES                         Local  8391     R(4)            4           scalar                    8391                              
 EXP                        Func   8391                                 scalar                    8391                              
 G                          Scalar 8350     R(4)            4           scalar   COM              8364,8365,8393                    
 GESPS                      Scalar 8336     R(4)            4     1     999      COM                                                
 GOR                        Local  8364     R(4)            4           scalar                    8364,8384,8385                    
 HRDR                       Scalar 8336     R(4)            4     1     255      COM                                                
 HYD                        Scalar 8344     R(4)            4     1     21       COM                                                
 HYDN                       Scalar 8344     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 8344     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 8344     R(4)            4     1     21       COM                                                
 I                          Local  8366     I(4)            4           scalar                    8366,8367,8368,8369               
 IHSC                       Scalar 8345     I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 8351     I(4)            4           scalar   COM                                                
 IND                        Scalar 8335     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 8349     I(4)            4           scalar   COM                                                
 ISC                        Scalar 8349     I(4)            4           scalar   COM                                                
 L                          Local  8372     I(4)            4           scalar                    8372,8373,8374,8379,8381,8382,8383
                                                                                                  ,8384,8385,8390,8391,8393,8396,839
                                                                                                  7,8398,8399,8400,8402             
 LAPSE                      Subr   8325                                                                                             
 LEVTYP                     Scalar 8335     I(4)            4     1     255      COM              8373,8375                         
 LL                         Local  8374     I(4)            4           scalar                    8374,8375,8380,8381,8382,8383,8384
                                                                                                  ,8385                             
 LMAND                      Scalar 8349     I(4)            4     1     22       COM                                                
 LMIN                       Local  8371     I(4)            4           scalar                    8371,8372                         
 LSFC                       Scalar 8349     I(4)            4           scalar   COM              8371                              
 LST                        Scalar 8336     I(4)            4     1     255      COM                                                
 MAND                       Scalar 8348     I(4)            4           scalar   COM                                                
 MAX                        Func   8371                                 scalar                    8371                              
 NBAS                       Scalar 8346     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 8344     I(4)            4     1     21       COM                                                

Page 276         Source Listing                  LAPSE
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NHYDN                      Scalar 8346     I(4)            4     1     21       COM                                                
 NINT                       Func   8381                                 scalar                    8381                              
 NLEV                       Scalar 8348     I(4)            4           scalar   COM              8372,8374                         
 NOBS                       Scalar 8348     I(4)            4           scalar   COM                                                
 NQI                        Scalar 8340     I(4)            4     1     255      COM                                                
 NQV                        Scalar 8342     I(4)            4     1     255      COM                                                
 NST                        Param  8326     I(4)            4           scalar                    8336,8345                         
 NTDI                       Scalar 8340     I(4)            4     1     255      COM                                                
 NTDV                       Scalar 8342     I(4)            4     1     255      COM                                                
 NTI                        Scalar 8340     I(4)            4     1     255      COM                                                
 NTL                        Scalar 8342     I(4)            4     1     255      COM              8369,8396,8398,8400,8402          
 NTV                        Scalar 8342     I(4)            4     1     255      COM                                                
 NZI                        Scalar 8340     I(4)            4     1     255      COM                                                
 NZV                        Scalar 8342     I(4)            4     1     255      COM                                                
 PARAMS                     Common 8348                                 148                                                         
 PFC                        Scalar 8330     R(4)            4     1     255      COM                                                
 PI                         Scalar 8338     R(4)            4     1     255      COM                                                
 POB                        Scalar 8330     R(4)            4     1     255      COM              8381,8382,8383,8384,8385,8393     
 PQM                        Scalar 8330     R(4)            4     1     255      COM                                                
 PRC                        Scalar 8330     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 8349     L(4)            4           scalar   COM                                                
 PS                         Scalar 8336     R(4)            4     1     999      COM                                                
 PSINC                      Scalar 8345     R(4)            4           scalar   COM                                                
 PV                         Local  8392     R(4)            4           scalar                    8392,8393,8394                    
 QFC                        Scalar 8334     R(4)            4     1     255      COM                                                
 QI                         Scalar 8338     R(4)            4     1     255      COM                                                
 QOB                        Scalar 8334     R(4)            4     1     255      COM                                                
 QQM                        Scalar 8334     R(4)            4     1     255      COM                                                
 QRC                        Scalar 8334     R(4)            4     1     255      COM                                                
 QV                         Scalar 8339     R(4)            4     1     255      COM                                                
 R                          Scalar 8350     R(4)            4           scalar   COM              8364,8392,8394                    
 RADPC                      Scalar 8348     R(4)            4           scalar   COM                                                
 RESID                      Common 8338                                 41312                                                       
 RV                         Scalar 8350     R(4)            4           scalar   COM              8394                              
 T0                         Scalar 8350     R(4)            4           scalar   COM              8379,8380                         
 TDFC                       Scalar 8333     R(4)            4     1     255      COM                                                
 TDI                        Scalar 8338     R(4)            4     1     255      COM                                                
 TDO                        Scalar 8333     R(4)            4     1     255      COM                                                
 TDV                        Scalar 8339     R(4)            4     1     255      COM                                                
 TFC                        Scalar 8332     R(4)            4     1     255      COM                                                
 TI                         Scalar 8338     R(4)            4     1     255      COM                                                
 TKL                        Local  8379     R(4)            4           scalar                    8379,8382,8383,8384,8385,8392,8393
 TKLL                       Local  8380     R(4)            4           scalar                    8380,8383,8384,8385               
 TL                         Scalar 8339     R(4)            4     1     255      COM              8367,8384,8397,8399               
 TLL                        Local  8385     R(4)            4           scalar                    8385,8395                         
 TLSAT                      Scalar 8345     R(4)            4     1     255      COM              8368,8393,8399                    
 TOB                        Scalar 8332     R(4)            4     1     255      COM              8379,8380,8390,8391               
 TQM                        Scalar 8332     R(4)            4     1     255      COM                                                
 TRC                        Scalar 8332     R(4)            4     1     255      COM                                                
 TT                         Scalar 8349     R(4)            4           scalar   COM                                                
 TV                         Scalar 8339     R(4)            4     1     255      COM                                                
 TVO                        Scalar 8333     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 8348     R(4)            4           scalar   COM                                                
 XDR                        Scalar 8337     R(4)            4     1     255      COM                                                
 XL                         Local  8390     R(4)            4           scalar                    8390,8392,8393                    

Page 277         Source Listing                  LAPSE
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XMA                        Scalar 8348     R(4)            4           scalar   COM                                                
 XMI                        Scalar 8348     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 8351     R(4)            4           scalar   COM                                                
 XQI                        Scalar 8341     R(4)            4     1     255      COM                                                
 XQV                        Scalar 8343     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 8347     R(4)            4     1     255      COM                                                
 XTDI                       Scalar 8341     R(4)            4     1     255      COM                                                
 XTDV                       Scalar 8343     R(4)            4     1     255      COM                                                
 XTH                        Scalar 8346     R(4)            4     1     255      COM                                                
 XTI                        Scalar 8341     R(4)            4     1     255      COM                                                
 XTV                        Scalar 8343     R(4)            4     1     255      COM                                                
 XZH                        Scalar 8346     R(4)            4     1     255      COM                                                
 XZI                        Scalar 8341     R(4)            4     1     255      COM                                                
 XZV                        Scalar 8343     R(4)            4     1     255      COM                                                
 YDR                        Scalar 8337     R(4)            4     1     255      COM                                                
 YMA                        Scalar 8348     R(4)            4           scalar   COM                                                
 YMI                        Scalar 8348     R(4)            4           scalar   COM                                                
 ZD                         Scalar 8346     R(4)            4     1     255      COM                                                
 ZFC                        Scalar 8331     R(4)            4     1     255      COM                                                
 ZI                         Scalar 8338     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 8331     R(4)            4     1     255      COM                                                
 ZQM                        Scalar 8331     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 8331     R(4)            4     1     255      COM                                                
 ZV                         Scalar 8339     R(4)            4     1     255      COM                                                

Page 278         Source Listing                  LAPSE
2017-04-18 11:07                                 cqcbufr.f

   8409 
   8410 C******************************************************************
   8411 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8412 C                .      .    .                                       .
   8413 C SUBPROGRAM:    LEVTYPS     CHARACTERIZE LEVEL TYPE
   8414 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
   8415 C
   8416 C ABSTRACT: Assign a type to each level, determined by what data are
   8417 C   non-missing:
   8418 C     1 - POB,ZOB,TOB,TDO  NON-MISSING (MAND OR SURVACE)
   8419 C     2 - POB,ZOB,TOB      NON-MISSING (MAND ONLY)
   8420 C     3 - POB,ZOB          NON-MISSING (MAND ONLY)
   8421 C     4 - POB,    TOB,TDO  NON-MISSING (MAND OR SIG)
   8422 C     5 - POB,    TOB      NON-MISSING (MAND OR SIG)
   8423 C
   8424 C PROGRAM HISTORY LOG:
   8425 C 1997-03-18  W. Collins  Original author.
   8426 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
   8427 C     were tested for not being equal to real value for missing (BMISS
   8428 C     = 10E10), these integer values can never be equal to BMISS for
   8429 C     I*4 due to overflow - instead they are now tested for not being
   8430 C     equal to new integer value for missing (IMISS, also = 10E10),
   8431 C     although this is also an overflow value for I*4, it results in a
   8432 C     correct evaluation
   8433 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
   8434 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
   8435 C     overflow (also done for IMISS). 
   8436 C
   8437 C USAGE:    CALL LEVTYPS
   8438 C
   8439 C REMARKS: NONE.
   8440 C
   8441 C ATTRIBUTES:
   8442 C   LANGUAGE: FORTRAN 90
   8443 C   MACHINE:  NCEP WCOSS
   8444 C
   8445 C$$$
   8446 
   8447       SUBROUTINE LEVTYPS
   8448       PARAMETER (NST=999)
   8449 
   8450       REAL(8) BMISS
   8451 
   8452       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   8453      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   8454      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   8455      &                 TDO(255), TDFC(255),TVO(255),
   8456      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   8457      &                 CAT(255), IND(255), LEVTYP(255),
   8458      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   8459      &                 YDR(255), XDR(255)
   8460       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   8461      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   8462       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   8463 
   8464       CHARACTER*8      SID
   8465       LOGICAL          PRNT

Page 279         Source Listing                  LEVTYPS
2017-04-18 11:07                                 cqcbufr.f

   8466 
   8467 C  ASSIGN LEVEL TYPES:
   8468 C    1 - POB,ZOB,TOB,TDO  NON-MISSING (MAND OR SURVACE)
   8469 C    2 - POB,ZOB,TOB      NON-MISSING (MAND ONLY)
   8470 C    3 - POB,ZOB          NON-MISSING (MAND ONLY)
   8471 C    4 - POB,    TOB,TDO  NON-MISSING (MAND OR SIG)
   8472 C    5 - POB,    TOB      NON-MISSING (MAND OR SIG)
   8473 C    6 - (POB),(TDO)      SECOND SURFACE LEVEL (CAT=MSG)
   8474 C  -----------------------------------------------------
   8475 
   8476       DO I=1,255
   8477         LEVTYP(I) = BMISS
   8478       ENDDO
   8479       DO L=1,NLEV
   8480         IF(POB(L).EQ.BMISS .OR. CAT(L).EQ.BMISS) THEN
   8481           LEVTYP(L) = 6
   8482           GOTO 10
   8483         ENDIF
   8484         IF(ZOB(L).LT.BMISS .AND. TOB(L).LT.BMISS .AND.
   8485      &    TDO(L).LT.BMISS) THEN
   8486           LEVTYP(L) = 1
   8487           GOTO 10
   8488         ELSEIF(ZOB(L).LT.BMISS .AND. TOB(L).LT.BMISS) THEN
   8489           LEVTYP(L) = 2
   8490           GOTO 10
   8491         ELSEIF(ZOB(L).LT.BMISS) THEN
   8492           LEVTYP(L) = 3
   8493           GOTO 10
   8494         ELSEIF(TOB(L).LT.BMISS .AND. TDO(L).LT.BMISS) THEN
   8495           LEVTYP(L) = 4
   8496           GOTO 10
   8497         ELSEIF(TOB(L).LT.BMISS) THEN
   8498           LEVTYP(L) = 5
   8499           GOTO 10
   8500         ELSE
   8501           LEVTYP(L) = 6
   8502         ENDIF
   8503    10   CONTINUE
   8504       ENDDO
   8505 
   8506 C  SET UP ARRAY OF INDICES OF THE MANDATORY LEVELS
   8507 C  ELEMENT 0 WILL CONTAIN THE NUMBER OF MANDATORY LEVELS
   8508 C  ALSO SOLVE FOR LEVEL OF SURFACE: LSFC
   8509 C  -----------------------------------------------------
   8510 
   8511       LSFC = 0
   8512       DO I=0,21
   8513         LMAND(I) = BMISS
   8514       ENDDO
   8515       MM = 0
   8516       DO L=1,NLEV
   8517         IF(CAT(L).EQ.0) THEN
   8518           LSFC = L
   8519           IF(MANLEV(POB(L)).NE.0) THEN
   8520             MM = MANLEV(POB(L))
   8521             LMAND(MM) = L
   8522           ENDIF

Page 280         Source Listing                  LEVTYPS
2017-04-18 11:07                                 cqcbufr.f

   8523         ELSEIF((CAT(L).EQ.1 .OR. CAT(L).EQ.5) .AND.
   8524      &    MANLEV(POB(L)).NE.0) THEN
   8525           MM = MANLEV(POB(L))
   8526           LMAND(MM) = L
   8527         ENDIF
   8528       ENDDO
   8529       LMAND(0) = MM
   8530       IF(LMAND(0).LT.0) LMAND(0) = 0
   8531                           ! LMAND(0) will never test = bmiss, use imiss
   8532 cdak  IF(LMAND(0).NE.BMISS .AND. LMAND(0).GT.21) LMAND(0) = 21
   8533       IF(LMAND(0).NE.IMISS .AND. LMAND(0).GT.21) LMAND(0) = 21
   8534 
   8535       RETURN
   8536       END


ENTRY POINTS

  Name                
                      
 levtyps_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  8503                                                           8482,8487,8490,8493,8496,8499     
 ALLSND                     Common 8452                                 34512                                                       
 BMISS                      Scalar 8450     R(8)            8           scalar   COM              8477,8480,8484,8485,8488,8491,8494
                                                                                                  ,8497,8513                        
 BUFRLIB_MISSING            Common 8462                                 16                                                          
 CAT                        Scalar 8457     R(4)            4     1     255      COM              8480,8517,8523                    
 CQCPC                      Scalar 8461     R(4)            4           scalar   COM                                                
 GESPS                      Scalar 8458     R(4)            4     1     999      COM                                                
 HRDR                       Scalar 8458     R(4)            4     1     255      COM                                                
 I                          Local  8476     I(4)            4           scalar                    8476,8477,8512,8513               
 IMISS                      Scalar 8462     I(4)            4           scalar   COM              8533                              
 IND                        Scalar 8457     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 8461     I(4)            4           scalar   COM                                                
 ISC                        Scalar 8461     I(4)            4           scalar   COM                                                
 L                          Local  8479     I(4)            4           scalar                    8479,8480,8481,8484,8485,8486,8488
                                                                                                  ,8489,8491,8492,8494,8495,8497,849
                                                                                                  8,8501,8516,8517,8518,8519,8520,85
                                                                                                  21,8523,8524,8525,8526            
 LEVTYP                     Scalar 8457     I(4)            4     1     255      COM              8477,8481,8486,8489,8492,8495,8498
                                                                                                  ,8501                             
 LEVTYPS                    Subr   8447                                                                                             
 LMAND                      Scalar 8461     I(4)            4     1     22       COM              8513,8521,8526,8529,8530,8533     
 LSFC                       Scalar 8461     I(4)            4           scalar   COM              8511,8518                         
 LST                        Scalar 8458     I(4)            4     1     255      COM                                                
 MAND                       Scalar 8460     I(4)            4           scalar   COM                                                
 MANLEV                     Func   8519     I(4)            4           scalar                    8519,8520,8524,8525               
 MM                         Local  8515     I(4)            4           scalar                    8515,8520,8521,8525,8526,8529     
 NLEV                       Scalar 8460     I(4)            4           scalar   COM              8479,8516                         
 NOBS                       Scalar 8460     I(4)            4           scalar   COM                                                
 NST                        Param  8448     I(4)            4           scalar                    8458                              

Page 281         Source Listing                  LEVTYPS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PARAMS                     Common 8460                                 148                                                         
 PFC                        Scalar 8452     R(4)            4     1     255      COM                                                
 POB                        Scalar 8452     R(4)            4     1     255      COM              8480,8519,8520,8524,8525          
 PQM                        Scalar 8452     R(4)            4     1     255      COM                                                
 PRC                        Scalar 8452     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 8461     L(4)            4           scalar   COM                                                
 PS                         Scalar 8458     R(4)            4     1     999      COM                                                
 QFC                        Scalar 8456     R(4)            4     1     255      COM                                                
 QOB                        Scalar 8456     R(4)            4     1     255      COM                                                
 QQM                        Scalar 8456     R(4)            4     1     255      COM                                                
 QRC                        Scalar 8456     R(4)            4     1     255      COM                                                
 RADPC                      Scalar 8460     R(4)            4           scalar   COM                                                
 SID                        Local  8464     CHAR            8           scalar                                                      
 TDFC                       Scalar 8455     R(4)            4     1     255      COM                                                
 TDO                        Scalar 8455     R(4)            4     1     255      COM              8485,8494                         
 TFC                        Scalar 8454     R(4)            4     1     255      COM                                                
 TOB                        Scalar 8454     R(4)            4     1     255      COM              8484,8488,8494,8497               
 TQM                        Scalar 8454     R(4)            4     1     255      COM                                                
 TRC                        Scalar 8454     R(4)            4     1     255      COM                                                
 TT                         Scalar 8461     R(4)            4           scalar   COM                                                
 TVO                        Scalar 8455     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 8460     R(4)            4           scalar   COM                                                
 XDR                        Scalar 8459     R(4)            4     1     255      COM                                                
 XMA                        Scalar 8460     R(4)            4           scalar   COM                                                
 XMI                        Scalar 8460     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 8462     R(4)            4           scalar   COM                                                
 YDR                        Scalar 8459     R(4)            4     1     255      COM                                                
 YMA                        Scalar 8460     R(4)            4           scalar   COM                                                
 YMI                        Scalar 8460     R(4)            4           scalar   COM                                                
 ZFC                        Scalar 8453     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 8453     R(4)            4     1     255      COM              8484,8488,8491                    
 ZQM                        Scalar 8453     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 8453     R(4)            4     1     255      COM                                                

Page 282         Source Listing                  LEVTYPS
2017-04-18 11:07                                 cqcbufr.f

   8537 
   8538 C******************************************************************
   8539 C$$  SUBPROGRAM DOCUMENTATION BLOCK
   8540 C                .      .    .                                       .
   8541 C SUBPROGRAM:    LMANLV      RETURN NEAREST MANDATORY LEVEL CNT BELOW
   8542 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   8543 C
   8544 C ABSTRACT: Return the value of the count of the nearest mandatory
   8545 C   level below: 1-1000, 2-925, ...
   8546 C
   8547 C PROGRAM HISTORY LOG:
   8548 C 1997-03-18  W. Collins  Original author.
   8549 C
   8550 C USAGE:    X=LMANLV(P)
   8551 C   INPUT ARGUMENT LIST:
   8552 C     P        - PRESSURE
   8553 C
   8554 C   OUTPUT ARGUMENT LIST:
   8555 C     LMANLV   - RETURNS THE VALUE
   8556 C
   8557 C REMARKS: NONE.
   8558 C
   8559 C ATTRIBUTES:
   8560 C   LANGUAGE: FORTRAN 90
   8561 C   MACHINE:  NCEP WCOSS
   8562 C
   8563 C$$$
   8564 
   8565       FUNCTION LMANLV(P)
   8566       SAVE ISET, LANLIN
   8567 
   8568       REAL(8) BMISS
   8569 
   8570       INTEGER LANLIN(10501)
   8571 
   8572       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   8573 
   8574       DATA ISET /0/
   8575 
   8576 C  DETERMINE THE INDEX OF THE NEAREST MANDATORY LEVEL BELOW
   8577 C  --------------------------------------------------------
   8578 
   8579       IF(ISET.EQ.0) THEN
   8580          DO I=1,10501
   8581          LANLIN(I) = 0
   8582          IF(I.LE.10000.AND. I.GE.9251) LANLIN(I) = 1
   8583          IF(I.LE.9250 .AND. I.GE.8501) LANLIN(I) = 2
   8584          IF(I.LE.8500 .AND. I.GE.7001) LANLIN(I) = 3
   8585          IF(I.LE.7000 .AND. I.GE.5001) LANLIN(I) = 4
   8586          IF(I.LE.5000 .AND. I.GE.4001) LANLIN(I) = 5
   8587          IF(I.LE.4000 .AND. I.GE.3001) LANLIN(I) = 6
   8588          IF(I.LE.3000 .AND. I.GE.2501) LANLIN(I) = 7
   8589          IF(I.LE.2500 .AND. I.GE.2001) LANLIN(I) = 8
   8590          IF(I.LE.2000 .AND. I.GE.1501) LANLIN(I) = 9
   8591          IF(I.LE.1500 .AND. I.GE.1001) LANLIN(I) = 10
   8592          IF(I.LE.1000 .AND. I.GE. 701) LANLIN(I) = 11
   8593          IF(I.LE. 700 .AND. I.GE. 501) LANLIN(I) = 12

Page 283         Source Listing                  LMANLV
2017-04-18 11:07                                 cqcbufr.f

   8594          IF(I.LE. 500 .AND. I.GE. 401) LANLIN(I) = 13
   8595          IF(I.LE. 400 .AND. I.GE. 301) LANLIN(I) = 14
   8596          IF(I.LE. 300 .AND. I.GE. 201) LANLIN(I) = 15
   8597          IF(I.LE. 200 .AND. I.GE. 101) LANLIN(I) = 16
   8598          IF(I.LE. 100 .AND. I.GE.  71) LANLIN(I) = 17
   8599          IF(I.LE.  70 .AND. I.GE.  51) LANLIN(I) = 18
   8600          IF(I.LE.  50 .AND. I.GE.  31) LANLIN(I) = 19
   8601          IF(I.LE.  30 .AND. I.GE.  21) LANLIN(I) = 20
   8602          IF(I.LE.  20                ) LANLIN(I) = 21
   8603 C        IF(                I.GE.9250) LANLIN(I) = 1
   8604 C        IF(I.LE.9249 .AND. I.GE.8500) LANLIN(I) = 2
   8605 C        IF(I.LE.8499 .AND. I.GE.7000) LANLIN(I) = 3
   8606 C        IF(I.LE.6999 .AND. I.GE.5000) LANLIN(I) = 4
   8607 C        IF(I.LE.4999 .AND. I.GE.4000) LANLIN(I) = 5
   8608 C        IF(I.LE.3999 .AND. I.GE.3000) LANLIN(I) = 6
   8609 C        IF(I.LE.2999 .AND. I.GE.2500) LANLIN(I) = 7
   8610 C        IF(I.LE.2499 .AND. I.GE.2000) LANLIN(I) = 8
   8611 C        IF(I.LE.1999 .AND. I.GE.1500) LANLIN(I) = 9
   8612 C        IF(I.LE.1499 .AND. I.GE.1000) LANLIN(I) = 10
   8613 C        IF(I.LE. 999 .AND. I.GE. 700) LANLIN(I) = 11
   8614 C        IF(I.LE. 699 .AND. I.GE. 500) LANLIN(I) = 12
   8615 C        IF(I.LE. 499 .AND. I.GE. 400) LANLIN(I) = 13
   8616 C        IF(I.LE. 399 .AND. I.GE. 300) LANLIN(I) = 14
   8617 C        IF(I.LE. 299 .AND. I.GE. 200) LANLIN(I) = 15
   8618 C        IF(I.LE. 199 .AND. I.GE. 100) LANLIN(I) = 16
   8619 C        IF(I.LE.  99 .AND. I.GE.  70) LANLIN(I) = 17
   8620 C        IF(I.LE.  69 .AND. I.GE.  50) LANLIN(I) = 18
   8621 C        IF(I.LE.  49 .AND. I.GE.  30) LANLIN(I) = 19
   8622 C        IF(I.LE.  29 .AND. I.GE.  20) LANLIN(I) = 20
   8623 C        IF(I.LE.  19                ) LANLIN(I) = 21
   8624          ENDDO
   8625          ISET = 1
   8626       ENDIF
   8627 
   8628       IF(P.GE.BMISS) THEN
   8629          LMANLV = 0
   8630       ELSE
   8631          IP = NINT(P*10.)
   8632 
   8633          IF(IP.GT.10500 .OR. IP.LT.5) THEN
   8634             LMANLV = 0
   8635          ELSE
   8636             LMANLV = LANLIN(IP)
   8637          ENDIF
   8638       ENDIF
   8639 
   8640       RETURN
   8641       END

Page 284         Source Listing                  LMANLV
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 lmanlv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 8568     R(8)            8           scalar   COM              8628                              
 BUFRLIB_MISSING            Common 8572                                 16                                                          
 I                          Local  8580     I(4)            4           scalar                    8580,8581,8582,8583,8584,8585,8586
                                                                                                  ,8587,8588,8589,8590,8591,8592,859
                                                                                                  3,8594,8595,8596,8597,8598,8599,86
                                                                                                  00,8601,8602                      
 IMISS                      Scalar 8572     I(4)            4           scalar   COM                                                
 IP                         Local  8631     I(4)            4           scalar                    8631,8633,8636                    
 ISET                       Local  8566     I(4)            4           scalar   SAVE             8574,8579,8625                    
 LANLIN                     Local  8566     I(4)            4     1     10501    SAVE             8581,8582,8583,8584,8585,8586,8587
                                                                                                  ,8588,8589,8590,8591,8592,8593,859
                                                                                                  4,8595,8596,8597,8598,8599,8600,86
                                                                                                  01,8602,8636                      
 LMANLV                     Func   8565     I(4)            4           scalar                    8629,8634,8636                    
 LMANLV@0                   Local  8565     I(4)            4           scalar                                                      
 NINT                       Func   8631                                 scalar                    8631                              
 P                          Dummy  8565     R(4)            4           scalar   ARG,INOUT        8628,8631                         
 XMISS                      Scalar 8572     R(4)            4           scalar   COM                                                

Page 285         Source Listing                  LMANLV
2017-04-18 11:07                                 cqcbufr.f

   8642 
   8643 C******************************************************************
   8644 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8645 C                .      .    .                                       .
   8646 C SUBPROGRAM:    MANLEV      RETURN LEVEL COUNT FOR MANDATORY LEVEL
   8647 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   8648 C
   8649 C ABSTRACT: For pressures equal to mandatory level values, return the
   8650 C   count of the mandatory level.  Otherwise, return 0.
   8651 C
   8652 C PROGRAM HISTORY LOG:
   8653 C 1997-03-18  W. Collins  Original author.
   8654 C
   8655 C USAGE:    X=MANLEV(P)
   8656 C   INPUT ARGUMENT LIST:
   8657 C     P        - PRESSURE
   8658 C
   8659 C   OUTPUT ARGUMENT LIST:
   8660 C     MANLEV   - RETURNS THE VALUE
   8661 C
   8662 C REMARKS: NONE.
   8663 C
   8664 C ATTRIBUTES:
   8665 C   LANGUAGE: FORTRAN 90
   8666 C   MACHINE:  NCEP WCOSS
   8667 C
   8668 C$$$
   8669 
   8670       FUNCTION MANLEV(P)
   8671       SAVE ISET, MANLIN
   8672 
   8673       REAL(8) BMISS
   8674 
   8675       INTEGER MANLIN(10001)
   8676 
   8677       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   8678 
   8679       DATA ISET /0/
   8680 
   8681       IF(ISET.EQ.0) THEN
   8682          DO I=1,10001
   8683          MANLIN(I) = 0
   8684          IF(I.EQ.10000) MANLIN(I) = 1
   8685          IF(I.EQ. 9250) MANLIN(I) = 2
   8686          IF(I.EQ. 8500) MANLIN(I) = 3
   8687          IF(I.EQ. 7000) MANLIN(I) = 4
   8688          IF(I.EQ. 5000) MANLIN(I) = 5
   8689          IF(I.EQ. 4000) MANLIN(I) = 6
   8690          IF(I.EQ. 3000) MANLIN(I) = 7
   8691          IF(I.EQ. 2500) MANLIN(I) = 8
   8692          IF(I.EQ. 2000) MANLIN(I) = 9
   8693          IF(I.EQ. 1500) MANLIN(I) = 10
   8694          IF(I.EQ. 1000) MANLIN(I) = 11
   8695          IF(I.EQ.  700) MANLIN(I) = 12
   8696          IF(I.EQ.  500) MANLIN(I) = 13
   8697          IF(I.EQ.  300) MANLIN(I) = 14
   8698          IF(I.EQ.  200) MANLIN(I) = 15

Page 286         Source Listing                  MANLEV
2017-04-18 11:07                                 cqcbufr.f

   8699          IF(I.EQ.  100) MANLIN(I) = 16
   8700          IF(I.EQ.   70) MANLIN(I) = 17
   8701          IF(I.EQ.   50) MANLIN(I) = 18
   8702          IF(I.EQ.   30) MANLIN(I) = 19
   8703          IF(I.EQ.   20) MANLIN(I) = 20
   8704          IF(I.EQ.   10) MANLIN(I) = 21
   8705          ENDDO
   8706          ISET = 1
   8707       ENDIF
   8708 
   8709       IF(P.GE.BMISS) THEN
   8710          MANLEV = 0
   8711       ELSE
   8712          IP = NINT(P*10.)
   8713 
   8714          IF(IP.GT.10000 .OR. IP.LT.10 .OR. MOD(IP,10).NE.0) THEN
   8715             MANLEV = 0
   8716          ELSE
   8717             MANLEV = MANLIN(NINT(P*10.))
   8718          ENDIF
   8719       ENDIF
   8720 
   8721       RETURN
   8722       END


ENTRY POINTS

  Name               
                     
 manlev_             

Page 287         Source Listing                  MANLEV
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 8673     R(8)            8           scalar   COM              8709                              
 BUFRLIB_MISSING            Common 8677                                 16                                                          
 I                          Local  8682     I(4)            4           scalar                    8682,8683,8684,8685,8686,8687,8688
                                                                                                  ,8689,8690,8691,8692,8693,8694,869
                                                                                                  5,8696,8697,8698,8699,8700,8701,87
                                                                                                  02,8703,8704                      
 IMISS                      Scalar 8677     I(4)            4           scalar   COM                                                
 IP                         Local  8712     I(4)            4           scalar                    8712,8714                         
 ISET                       Local  8671     I(4)            4           scalar   SAVE             8679,8681,8706                    
 MANLEV                     Func   8670     I(4)            4           scalar                    8710,8715,8717                    
 MANLEV@0                   Local  8670     I(4)            4           scalar                                                      
 MANLIN                     Local  8671     I(4)            4     1     10001    SAVE             8683,8684,8685,8686,8687,8688,8689
                                                                                                  ,8690,8691,8692,8693,8694,8695,869
                                                                                                  6,8697,8698,8699,8700,8701,8702,87
                                                                                                  03,8704,8717                      
 MOD                        Func   8714                                 scalar                    8714                              
 NINT                       Func   8712                                 scalar                    8712,8717                         
 P                          Dummy  8670     R(4)            4           scalar   ARG,INOUT        8709,8712,8717                    
 XMISS                      Scalar 8677     R(4)            4           scalar   COM                                                

Page 288         Source Listing                  MANLEV
2017-04-18 11:07                                 cqcbufr.f

   8723 
   8724 C**********************************************************************
   8725 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8726 C                .      .    .                                       .
   8727 C SUBPROGRAM:    MASEVN      WRITE A MASS EVENT FOR MANDATORY LEVELS.
   8728 C   PRGMMR: J. Woollen       ORG: NP20       DATE: 1994-03-17
   8729 C
   8730 C ABSTRACT: WRITE AN EVENT FOR MANDATORY LEVELS.
   8731 C
   8732 C PROGRAM HISTORY LOG:
   8733 C 1994-03-17  J. Woollen  Original author.
   8734 C 1995-12-18  W. Collins  Changes to guarantee that preexisting
   8735 C     flags are honored.
   8736 C 1996-07-22  W. Collins  Modify for use by PREPOBS_CQCBUFR.
   8737 C
   8738 C USAGE:    CALL MASEVN
   8739 C
   8740 C OUTPUT FILES:
   8741 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   8742 C
   8743 C REMARKS: NONE.
   8744 C
   8745 C ATTRIBUTES:
   8746 C   LANGUAGE: FORTRAN 90
   8747 C   MACHINE:  NCEP WCOSS
   8748 C
   8749 C$$$
   8750       SUBROUTINE MASEVN
   8751       PARAMETER (NST=999)
   8752 
   8753       REAL(8) BMISS
   8754 
   8755       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   8756      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   8757      &                 NEV, ISX(NST), NLVM, NLVW
   8758       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   8759      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   8760      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   8761      &                 TDO(255), TDFC(255),TVO(255),
   8762      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   8763      &                 CAT(255), IND(255), LEVTYP(255),
   8764      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   8765      &                 YDR(255), XDR(255)
   8766       COMMON /EVNSND/  PO(255), TO(255), ZO(255), CA(255),
   8767      &                 PQ(255), TQ(255), ZQ(255), INP(255),
   8768      &                 PR(255), TR(255), ZR(255), INZ(255),
   8769      &                 QO(255), QQ(255), QR(255), INT(255),
   8770      &                 TDE(255),TDQ(255),TDR(255),INQ(255),
   8771      &                 UO(255), VO(255), SPO(255),DIRO(255),
   8772      &                 WQ(255), WR(255)
   8773       COMMON /EVNBUF/ STNB(2000),   SEQNB(2000), ISCANB(2000),
   8774      &                LEVLB(2000),  PRESB(2000), LTYPB(2000),
   8775      &                IVARB(2000),  CORB(2000),  CORVALB(2000),
   8776      &                QMARKB(2000), IETYPB(2000),EDATEB(2000),
   8777      &                LSTYPB(2000), PCORB(2000), IEVENTB
   8778       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   8779      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT

Page 289         Source Listing                  MASEVN
2017-04-18 11:07                                 cqcbufr.f

   8780       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
   8781       COMMON /STN/     IS
   8782       COMMON /TESTS/   TEST
   8783       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   8784 
   8785       LOGICAL          TEST
   8786 
   8787       CHARACTER*8 COB(2),SID,CID,STNB
   8788       CHARACTER*10     EDATEB
   8789       CHARACTER*40 PEVN,TEVN,ZEVN,QEVN
   8790       DIMENSION   IOB(2)
   8791       EQUIVALENCE (COB(1),IOB(1))
   8792       LOGICAL     SDM,LEVCHK, PRNT
   8793 
   8794       DATA PEVN   /'POB PQM PPC PRC                         '/
   8795       DATA TEVN   /'TOB TQM TPC TRC                         '/
   8796       DATA ZEVN   /'ZOB ZQM ZPC ZRC                         '/
   8797       DATA QEVN   /'QOB QQM QPC QRC                         '/
   8798 
   8799 C-----------------------------------------------------------------------
   8800 C-----------------------------------------------------------------------
   8801 
   8802 C  CLEAR THE WORK ARRAYS FOR THIS OB
   8803 C  ---------------------------------
   8804 
   8805       PO = BMISS
   8806       TO = BMISS
   8807       ZO = BMISS
   8808       QO = BMISS
   8809       TDE = BMISS
   8810       INP = BMISS
   8811       INZ = BMISS
   8812       INT = BMISS
   8813       IEVP = 0
   8814       IEVZ = 0
   8815       IEVT = 0
   8816       IEVQ = 0
   8817 
   8818 C  LOOP OVER ALL EVENTS LOOKING FOR THIS PARTICULAR OB
   8819 C  ---------------------------------------------------
   8820 
   8821       DO 100 I=1,IEVENTB
   8822 
   8823         CID = STNB(I)
   8824         IV = IVARB(I)
   8825         IL = LEVLB(I)
   8826         IF(SQN(IS).NE.SEQNB(I) .OR. IL.GT.NLEV) GOTO 100
   8827 
   8828 C  FOUND A MATCH - DOUBLE CHECK TO MAKE SURE
   8829 C  -----------------------------------------
   8830 
   8831         LEVCHK = IL.LT.1 .OR. IL.GT.NLV
   8832         IF(LEVCHK) GOTO 100
   8833         IF(TEST) WRITE(60,502) SID(IS),IV,PRESB(I),CORVALB(I),
   8834      &    QMARKB(I),IETYPB(I)
   8835   502   FORMAT(' MASEVN--MATCH FOUND FOR: ',A8,'  IVAR,PRES,',
   8836      &    'CORVAL,QMARK,IETYP: ',I5,2X,F8.1,2X,F8.1,2X,F4.0,2X,I5)

Page 290         Source Listing                  MASEVN
2017-04-18 11:07                                 cqcbufr.f

   8837 
   8838 C       QM = QMARKB(I)
   8839         IF(IV.EQ.1)   QM = PQM(IL)
   8840         IF(IV.EQ.2)   QM = ZQM(IL)
   8841         IF(IV.EQ.3)   QM = TQM(IL)
   8842         IF(IV.EQ.4 .OR. IV.EQ.5)   QM = QQM(IL)
   8843         IF(IV.EQ.1) DEC = PRC(IL)
   8844         IF(IV.EQ.2) DEC = ZRC(IL)
   8845         IF(IV.EQ.3) DEC = TRC(IL)
   8846         IF(IV.EQ.4 .OR. IV.EQ.5) DEC = QRC(IL)
   8847 C       IF(QM.EQ.0.)  DEC = 0.
   8848 C       IF(QM.EQ.1.)  DEC = 1.
   8849 C       IF(QM.EQ.3.)  DEC = 3.
   8850 C       IF(QM.EQ.13.) DEC = 4.
   8851         IF(CAT(IL).EQ.3 .OR. CAT(IL).EQ.4 .OR. CAT(IL).EQ.7) THEN
   8852           IF(IV.EQ.1) DEC = PRC(IL)
   8853           IF(IV.EQ.2) DEC = ZRC(IL)
   8854           IF(IV.EQ.3) DEC = TRC(IL)
   8855           IF(IV.EQ.4 .OR. IV.EQ.5) DEC = QRC(IL)
   8856         ENDIF
   8857 
   8858 C       IF(IV.EQ.1) THEN
   8859 C         POD = PRESB(I)
   8860 C         ISURF = 0
   8861 C         DO L=1,NLV
   8862 C           DIF = ABS(POB(L)-POD)
   8863 C           IF(DIF.LT..1) ISURF = L
   8864 C         ENDDO
   8865 C       ENDIF
   8866         ISURF = LEVLB(I)
   8867 
   8868 C  HONOR KEEPS OR PURGES
   8869 C  ---------------------
   8870 
   8871         SDM = QM.EQ.0.OR.QM.EQ.8.OR.QM.EQ.9.OR.QM.EQ.11.OR.
   8872      &        QM.EQ.12.OR.QM.EQ.14.OR.QM.EQ.15
   8873 
   8874         IF(TEST) WRITE(60,501) CID,QM,DEC,SDM
   8875   501   FORMAT(' MASEVN--station,quality mark,decision,SDM:  ',
   8876      &         a8,1x,2f10.0,l8)
   8877 
   8878 C  PUT TOGETHER A BUFR EVENT
   8879 C  -------------------------
   8880 
   8881         IF(.NOT.SDM) THEN
   8882           IF(IV.EQ.2) THEN
   8883             IEVZ = IEVZ + 1
   8884             INZ(IEVZ) = LEVLB(I)
   8885             ZO(IEVZ)  = CORVALB(I)
   8886             ZQ(IEVZ)  = QMARKB(I)
   8887             ZR(IEVZ)  = DEC
   8888           ELSEIF(IV.EQ.3) THEN
   8889             IEVT = IEVT + 1
   8890             INT(IEVT) = LEVLB(I)
   8891             TO(IEVT)  = CORVALB(I)
   8892             TQ(IEVT)  = QMARKB(I)
   8893             TR(IEVT)  = DEC

Page 291         Source Listing                  MASEVN
2017-04-18 11:07                                 cqcbufr.f

   8894           ELSEIF(IV.EQ.4 .OR. IV.EQ.5) THEN
   8895             IEVQ = IEVQ + 1
   8896             INQ(IEVQ) = LEVLB(I)
   8897             QO(IEVQ)  = CORVALB(I)*1.E6
   8898             QQ(IEVQ)  = QMARKB(I)
   8899             QR(IEVQ)  = DEC
   8900           ELSEIF(IV.EQ.1) THEN
   8901             IF(ISURF.NE.0) THEN
   8902               IEVP = IEVP + 1
   8903               INP(IEVP) = LEVLB(I)
   8904               PO(IEVP)  = CORVALB(I)
   8905               PQ(IEVP)  = QMARKB(I)
   8906               PR(IEVP)  = DEC
   8907             ENDIF
   8908           ENDIF
   8909         ENDIF
   8910 100   CONTINUE
   8911 
   8912       IF(TEST) WRITE(60,505) SID(IS),IEVP,IEVZ,IEVT,IEVQ,IEVENTB
   8913   505 FORMAT(' MASEVN--CALLED FOR STATION: ',A8,
   8914      &  ' IEVP,IEVZ,IEVT,IEVQ,IEVENTB: ',5I5)
   8915 
   8916       CALL EVENT(NFOUT,PEVN,NLV,PO,PQ,PR,INP,IEVP,CQCPC)
   8917       WRITE(60,510) IEVP,SID(IS)
   8918       CALL EVENT(NFOUT,ZEVN,NLV,ZO,ZQ,ZR,INZ,IEVZ,CQCPC)
   8919       WRITE(60,511) IEVZ,SID(IS)
   8920       CALL EVENT(NFOUT,TEVN,NLV,TO,TQ,TR,INT,IEVT,CQCPC)
   8921       WRITE(60,512) IEVT,SID(IS)
   8922       CALL EVENT(NFOUT,QEVN,NLV,QO,QQ,QR,INQ,IEVQ,CQCPC)
   8923       WRITE(60,513) IEVQ,SID(IS)
   8924 
   8925       IF(IEVP.NE.0) THEN
   8926         IF(TEST) WRITE(60,506) (INP(I),PO(I),PQ(I),PR(I),I=1,IEVP)
   8927       ENDIF
   8928       IF(IEVZ.NE.0) THEN
   8929         IF(TEST) WRITE(60,507) (INZ(I),ZO(I),ZQ(I),ZR(I),I=1,IEVZ)
   8930       ENDIF
   8931       IF(IEVT.NE.0) THEN
   8932         IF(TEST) WRITE(60,508) (INT(I),TO(I),TQ(I),TR(I),I=1,IEVT)
   8933       ENDIF
   8934       IF(IEVQ.NE.0) THEN
   8935         IF(TEST) WRITE(60,509) (INQ(I),QO(I),QQ(I),QR(I),I=1,IEVQ)
   8936       ENDIF
   8937   506 FORMAT(' MASEVN--PRESSURE EVENTS:'/(10X,I4,3F12.1))
   8938   507 FORMAT(' MASEVN--HEIGHT EVENTS:'/(10X,I4,3F12.1))
   8939   508 FORMAT(' MASEVN--TEMPERATURE EVENTS:'/(10X,I4,3F12.1))
   8940   509 FORMAT(' MASEVN--MOISTURE EVENTS:   '/(10X,I4,F12.1,2F12.1))
   8941   510 FORMAT(' MASEVN--',I3,' PRESSURE EVENTS WRITTEN FOR: ',A8)
   8942   511 FORMAT(' MASEVN--',I3,' HEIGHT EVENTS WRITTEN FOR: ',A8)
   8943   512 FORMAT(' MASEVN--',I3,' TEMPERATURE EVENTS WRITTEN FOR: ',A8)
   8944   513 FORMAT(' MASEVN--',I3,' MOISTURE EVENTS WRITTEN FOR: ',A8)
   8945 
   8946       RETURN
   8947       END

Page 292         Source Listing                  MASEVN
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 masevn_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  8910                                                           8821,8826,8832                    
 501                        Label  8875                                                           8874                              
 502                        Label  8835                                                           8833                              
 505                        Label  8913                                                           8912                              
 506                        Label  8937                                                           8926                              
 507                        Label  8938                                                           8929                              
 508                        Label  8939                                                           8932                              
 509                        Label  8940                                                           8935                              
 510                        Label  8941                                                           8917                              
 511                        Label  8942                                                           8919                              
 512                        Label  8943                                                           8921                              
 513                        Label  8944                                                           8923                              
 ALLSND                     Common 8758                                 34512                                                       
 BMISS                      Scalar 8753     R(8)            8           scalar   COM              8805,8806,8807,8808,8809,8810,8811
                                                                                                  ,8812                             
 BUFRLIB_MISSING            Common 8783                                 16                                                          
 CA                         Scalar 8766     R(4)            4     1     255      COM                                                
 CAT                        Scalar 8763     R(4)            4     1     255      COM              8851                              
 CID                        Local  8787     CHAR            8           scalar                    8823,8874                         
 COB                        Local  8787     CHAR            8     1     2                                                           
 CORB                       Scalar 8775     R(4)            4     1     2000     COM                                                
 CORVALB                    Scalar 8775     R(4)            4     1     2000     COM              8833,8885,8891,8897,8904          
 CQCPC                      Scalar 8779     R(4)            4           scalar   COM              8916,8918,8920,8922               
 DEC                        Local  8843     R(4)            4           scalar                    8843,8844,8845,8846,8852,8853,8854
                                                                                                  ,8855,8874,8887,8893,8899,8906    
 DHR                        Scalar 8755     R(4)            4     1     999      COM                                                
 DIRO                       Scalar 8771     R(4)            4     1     255      COM                                                
 EDATEB                     Scalar 8776     CHAR            10    1     2000     COM                                                
 ELV                        Scalar 8756     R(4)            4     1     999      COM                                                
 EVENT                      Subr   8916                                                           8916,8918,8920,8922               
 EVNBUF                     Common 8773                                 132004                                                      
 EVNSND                     Common 8766                                 26520                                                       
 FILES                      Common 8780                                 24                                                          
 GESPS                      Scalar 8764     R(4)            4     1     999      COM                                                
 HEADER                     Common 8755                                 35980                                                       
 HRDR                       Scalar 8764     R(4)            4     1     255      COM                                                
 I                          Local  8821     I(4)            4           scalar                    8821,8823,8824,8825,8826,8833,8834
                                                                                                  ,8866,8884,8885,8886,8890,8891,889
                                                                                                  2,8896,8897,8898,8903,8904,8905,89
                                                                                                  26,8929,8932,8935                 
 IETYPB                     Scalar 8776     I(4)            4     1     2000     COM              8834                              
 IEVENTB                    Scalar 8777     I(4)            4           scalar   COM              8821,8912                         
 IEVP                       Local  8813     I(4)            4           scalar                    8813,8902,8903,8904,8905,8906,8912
                                                                                                  ,8916,8917,8925,8926              

Page 293         Source Listing                  MASEVN
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IEVQ                       Local  8816     I(4)            4           scalar                    8816,8895,8896,8897,8898,8899,8912
                                                                                                  ,8922,8923,8934,8935              
 IEVT                       Local  8815     I(4)            4           scalar                    8815,8889,8890,8891,8892,8893,8912
                                                                                                  ,8920,8921,8931,8932              
 IEVZ                       Local  8814     I(4)            4           scalar                    8814,8883,8884,8885,8886,8887,8912
                                                                                                  ,8918,8919,8928,8929              
 IL                         Local  8825     I(4)            4           scalar                    8825,8826,8831,8839,8840,8841,8842
                                                                                                  ,8843,8844,8845,8846,8851,8852,885
                                                                                                  3,8854,8855                       
 IMISS                      Scalar 8783     I(4)            4           scalar   COM                                                
 IND                        Scalar 8763     I(4)            4     1     255      COM                                                
 INP                        Scalar 8767     I(4)            4     1     255      COM              8810,8903,8916,8926               
 INQ                        Scalar 8770     I(4)            4     1     255      COM              8896,8922,8935                    
 INT                        Scalar 8769     I(4)            4     1     255      COM              8812,8890,8920,8932               
 INZ                        Scalar 8768     I(4)            4     1     255      COM              8811,8884,8918,8929               
 IOB                        Local  8790     I(4)            4     1     2                                                           
 IPEVT                      Scalar 8779     I(4)            4           scalar   COM                                                
 IS                         Scalar 8781     I(4)            4           scalar   COM              8826,8833,8912,8917,8919,8921,8923
 ISC                        Scalar 8779     I(4)            4           scalar   COM                                                
 ISCANB                     Scalar 8773     I(4)            4     1     2000     COM                                                
 ISURF                      Local  8866     I(4)            4           scalar                    8866,8901                         
 ISX                        Scalar 8757     I(4)            4     1     999      COM                                                
 ITP                        Scalar 8756     I(4)            4     1     999      COM                                                
 IV                         Local  8824     I(4)            4           scalar                    8824,8833,8839,8840,8841,8842,8843
                                                                                                  ,8844,8845,8846,8852,8853,8854,885
                                                                                                  5,8882,8888,8894,8900             
 IVARB                      Scalar 8775     I(4)            4     1     2000     COM              8824                              
 LEVCHK                     Local  8792     L(4)            4           scalar                    8831,8832                         
 LEVLB                      Scalar 8774     I(4)            4     1     2000     COM              8825,8866,8884,8890,8896,8903     
 LEVTYP                     Scalar 8763     I(4)            4     1     255      COM                                                
 LMAND                      Scalar 8779     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 8779     I(4)            4           scalar   COM                                                
 LST                        Scalar 8764     I(4)            4     1     255      COM                                                
 LSTYPB                     Scalar 8777     I(4)            4     1     2000     COM                                                
 LTYPB                      Scalar 8774     I(4)            4     1     2000     COM                                                
 MAND                       Scalar 8778     I(4)            4           scalar   COM                                                
 MASEVN                     Subr   8750                                                                                             
 NEV                        Scalar 8757     I(4)            4           scalar   COM                                                
 NFEVN                      Scalar 8780     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 8780     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 8780     I(4)            4           scalar   COM              8916,8918,8920,8922               
 NFSGL                      Scalar 8780     I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 8780     I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 8780     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 8778     I(4)            4           scalar   COM              8826                              
 NLV                        Scalar 8756     I(4)            4           scalar   COM              8831,8916,8918,8920,8922          
 NLVM                       Scalar 8757     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 8757     I(4)            4           scalar   COM                                                
 NOBS                       Scalar 8778     I(4)            4           scalar   COM                                                
 NST                        Param  8751     I(4)            4           scalar                    8755,8756,8757,8764               
 PARAMS                     Common 8778                                 148                                                         
 PCORB                      Scalar 8777     R(4)            4     1     2000     COM                                                
 PEVN                       Local  8789     CHAR            40          scalar                    8794,8916                         
 PFC                        Scalar 8758     R(4)            4     1     255      COM                                                
 PO                         Scalar 8766     R(4)            4     1     255      COM              8805,8904,8916,8926               

Page 294         Source Listing                  MASEVN
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 POB                        Scalar 8758     R(4)            4     1     255      COM                                                
 PQ                         Scalar 8767     R(4)            4     1     255      COM              8905,8916,8926                    
 PQM                        Scalar 8758     R(4)            4     1     255      COM              8839                              
 PR                         Scalar 8768     R(4)            4     1     255      COM              8906,8916,8926                    
 PRC                        Scalar 8758     R(4)            4     1     255      COM              8843,8852                         
 PRESB                      Scalar 8774     R(4)            4     1     2000     COM              8833                              
 PRNT                       Scalar 8779     L(4)            4           scalar   COM                                                
 PS                         Scalar 8764     R(4)            4     1     999      COM                                                
 QEVN                       Local  8789     CHAR            40          scalar                    8797,8922                         
 QFC                        Scalar 8762     R(4)            4     1     255      COM                                                
 QM                         Local  8839     R(4)            4           scalar                    8839,8840,8841,8842,8871,8872,8874
 QMARKB                     Scalar 8776     R(4)            4     1     2000     COM              8834,8886,8892,8898,8905          
 QO                         Scalar 8769     R(4)            4     1     255      COM              8808,8897,8922,8935               
 QOB                        Scalar 8762     R(4)            4     1     255      COM                                                
 QQ                         Scalar 8769     R(4)            4     1     255      COM              8898,8922,8935                    
 QQM                        Scalar 8762     R(4)            4     1     255      COM              8842                              
 QR                         Scalar 8769     R(4)            4     1     255      COM              8899,8922,8935                    
 QRC                        Scalar 8762     R(4)            4     1     255      COM              8846,8855                         
 RADPC                      Scalar 8778     R(4)            4           scalar   COM                                                
 SDM                        Local  8792     L(4)            4           scalar                    8871,8874,8881                    
 SEQNB                      Scalar 8773     R(4)            4     1     2000     COM              8826                              
 SID                        Scalar 8755     CHAR            8     1     999      COM              8833,8912,8917,8919,8921,8923     
 SPO                        Scalar 8771     R(4)            4     1     255      COM                                                
 SQN                        Scalar 8756     R(4)            4     1     999      COM              8826                              
 STN                        Common 8781                                 4                                                           
 STNB                       Scalar 8773     CHAR            8     1     2000     COM              8823                              
 TDE                        Scalar 8770     R(4)            4     1     255      COM              8809                              
 TDFC                       Scalar 8761     R(4)            4     1     255      COM                                                
 TDO                        Scalar 8761     R(4)            4     1     255      COM                                                
 TDQ                        Scalar 8770     R(4)            4     1     255      COM                                                
 TDR                        Scalar 8770     R(4)            4     1     255      COM                                                
 TEST                       Scalar 8782     L(4)            4           scalar   COM              8833,8874,8912,8926,8929,8932,8935
 TESTS                      Common 8782                                 4                                                           
 TEVN                       Local  8789     CHAR            40          scalar                    8795,8920                         
 TFC                        Scalar 8760     R(4)            4     1     255      COM                                                
 TO                         Scalar 8766     R(4)            4     1     255      COM              8806,8891,8920,8932               
 TOB                        Scalar 8760     R(4)            4     1     255      COM                                                
 TQ                         Scalar 8767     R(4)            4     1     255      COM              8892,8920,8932                    
 TQM                        Scalar 8760     R(4)            4     1     255      COM              8841                              
 TR                         Scalar 8768     R(4)            4     1     255      COM              8893,8920,8932                    
 TRC                        Scalar 8760     R(4)            4     1     255      COM              8845,8854                         
 TT                         Scalar 8779     R(4)            4           scalar   COM                                                
 TVO                        Scalar 8761     R(4)            4     1     255      COM                                                
 UO                         Scalar 8771     R(4)            4     1     255      COM                                                
 VO                         Scalar 8771     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 8778     R(4)            4           scalar   COM                                                
 WQ                         Scalar 8772     R(4)            4     1     255      COM                                                
 WR                         Scalar 8772     R(4)            4     1     255      COM                                                
 XDR                        Scalar 8765     R(4)            4     1     255      COM                                                
 XMA                        Scalar 8778     R(4)            4           scalar   COM                                                
 XMI                        Scalar 8778     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 8783     R(4)            4           scalar   COM                                                
 XOB                        Scalar 8755     R(4)            4     1     999      COM                                                
 YDR                        Scalar 8765     R(4)            4     1     255      COM                                                
 YMA                        Scalar 8778     R(4)            4           scalar   COM                                                

Page 295         Source Listing                  MASEVN
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YMI                        Scalar 8778     R(4)            4           scalar   COM                                                
 YOB                        Scalar 8755     R(4)            4     1     999      COM                                                
 ZEVN                       Local  8789     CHAR            40          scalar                    8796,8918                         
 ZFC                        Scalar 8759     R(4)            4     1     255      COM                                                
 ZO                         Scalar 8766     R(4)            4     1     255      COM              8807,8885,8918,8929               
 ZOB                        Scalar 8759     R(4)            4     1     255      COM                                                
 ZQ                         Scalar 8767     R(4)            4     1     255      COM              8886,8918,8929                    
 ZQM                        Scalar 8759     R(4)            4     1     255      COM              8840                              
 ZR                         Scalar 8768     R(4)            4     1     255      COM              8887,8918,8929                    
 ZRC                        Scalar 8759     R(4)            4     1     255      COM              8844,8853                         

Page 296         Source Listing                  MASEVN
2017-04-18 11:07                                 cqcbufr.f

   8948 
   8949 C**********************************************************************
   8950 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8951 C                .      .    .                                       .
   8952 C SUBPROGRAM:    MIMAP       FILL IMAP FOR HORIZONTAL SEARCH
   8953 C   PRGMMR: J. WOOLLEN       ORG: NP20       DATE: 1992-??-??
   8954 C
   8955 C ABSTRACT: FILL IMAP FOR HORIZONTAL SEARCH.
   8956 C
   8957 C PROGRAM HISTORY LOG:
   8958 C 1992-??-??  J. Woollen  Original author.
   8959 C
   8960 C USAGE:    CALL MIMAP(XQC,YQC,NREP)
   8961 C   INPUT ARGUMENT LIST:
   8962 C     XQC      - ARRAY OF LATITUDES TO SEARCH
   8963 C     YQC      - ARRAY OF LONGITUDES TO SEARCH
   8964 C     NREP     - SIZE OF LAT/LON ARRAYS
   8965 C
   8966 C REMARKS: NONE.
   8967 C
   8968 C ATTRIBUTES:
   8969 C   LANGUAGE: FORTRAN 90
   8970 C   MACHINE:  NCEP WCOSS
   8971 C
   8972 C$$$
   8973       SUBROUTINE MIMAP(XQC,YQC,NREP)
   8974 
   8975       DIMENSION XQC(NREP),YQC(NREP)
   8976 
   8977       COMMON /OBLIST/ NOB,INOB(1000),IMAP(360,181)
   8978 
   8979       DIMENSION INDD(1000)
   8980 
   8981 C-----------------------------------------------------------------------
   8982 C-----------------------------------------------------------------------
   8983 
   8984 C  MAKE SURE NONE OF THE LONGITUDES EQUAL 360.
   8985 C  -------------------------------------------
   8986 
   8987       DO N=1,NREP
   8988         IF(XQC(N).EQ.360.) XQC(N) = 0.
   8989       ENDDO
   8990 
   8991 C  LONGITUDE SORT
   8992 C  --------------
   8993 
   8994       NN = 0
   8995       DO NX=1,360
   8996         DO N=1,NREP
   8997 C         IX = NINT(XQC(N)+1.)
   8998           IX = MOD(NINT(XQC(N)+1.),360)+1
   8999           IF(IX.EQ.NX) THEN
   9000              NN = NN+1
   9001              INDD(NN) = N
   9002           ENDIF
   9003         ENDDO
   9004       ENDDO

Page 297         Source Listing                  MIMAP
2017-04-18 11:07                                 cqcbufr.f

   9005 
   9006 C  LATITUDE SORT
   9007 C  -------------
   9008 
   9009       NOB = 0
   9010       DO NY=1,181
   9011         DO N=1,NN
   9012           IY = NINT(YQC(INDD(N))+91.)
   9013           IF(IY.LT.1) IY = 1
   9014           IF(IY.GT.181) IY = 181
   9015           IF(IY.EQ.NY) THEN
   9016              NOB = NOB+1
   9017              INOB(NOB) = INDD(N)
   9018           ENDIF
   9019         ENDDO
   9020       ENDDO
   9021 
   9022 C  INITIALIZE IMAP ARRAY
   9023 C  ---------------------
   9024 
   9025       IF(NN.NE.NREP .OR. NOB.NE.NREP) THEN
   9026         PRINT *, 'MIMAP: NN.NE.NREP .OR. NOB.NE.NREP - STOP 99'
   9027         CALL W3TAGE('PREPOBS_CQCBUFR')
   9028         CALL ERREXIT(99)
   9029       ENDIF
   9030 
   9031       DO J=1,181
   9032         DO I=1,360
   9033           IMAP(I,J) = 0
   9034         ENDDO
   9035       ENDDO
   9036 
   9037       DO N=1,NOB
   9038         NX = XQC(INOB(N)) + 1.
   9039         NY = YQC(INOB(N)) + 91.
   9040         IF(IMAP(NX,NY).EQ.0) IMAP(NX,NY) = N
   9041       ENDDO
   9042 
   9043 C  FILL GAPS IN IMAP FOR CONTINUITY (BACKWARDS)
   9044 C  --------------------------------------------
   9045 
   9046       LASTN = NOB
   9047       DO NY=181,1,-1
   9048         DO NX=360,1,-1
   9049           IF(IMAP(NX,NY).EQ.0) THEN
   9050              IMAP(NX,NY) = LASTN
   9051           ELSE
   9052              LASTN = IMAP(NX,NY)
   9053           ENDIF
   9054         ENDDO
   9055       ENDDO
   9056 
   9057       RETURN
   9058       END

Page 298         Source Listing                  MIMAP
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 mimap_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERREXIT                    Subr   9028                                                           9028                              
 I                          Local  9032     I(4)            4           scalar                    9032,9033                         
 IMAP                       Scalar 8977     I(4)            4     2     65160    COM              9033,9040,9049,9050,9052          
 INDD                       Local  8979     I(4)            4     1     1000                      9001,9012,9017                    
 INOB                       Scalar 8977     I(4)            4     1     1000     COM              9017,9038,9039                    
 IX                         Local  8998     I(4)            4           scalar                    8998,8999                         
 IY                         Local  9012     I(4)            4           scalar                    9012,9013,9014,9015               
 J                          Local  9031     I(4)            4           scalar                    9031,9033                         
 LASTN                      Local  9046     I(4)            4           scalar                    9046,9050,9052                    
 MIMAP                      Subr   8973                                                                                             
 MOD                        Func   8998                                 scalar                    8998                              
 N                          Local  8987     I(4)            4           scalar                    8987,8988,8996,8998,9001,9011,9012
                                                                                                  ,9017,9037,9038,9039,9040         
 NINT                       Func   8998                                 scalar                    8998,9012                         
 NN                         Local  8994     I(4)            4           scalar                    8994,9000,9001,9011,9025          
 NOB                        Scalar 8977     I(4)            4           scalar   COM              9009,9016,9017,9025,9037,9046     
 NREP                       Dummy  8973     I(4)            4           scalar   ARG,INOUT        8975,8987,8996,9025               
 NX                         Local  8995     I(4)            4           scalar                    8995,8999,9038,9040,9048,9049,9050
                                                                                                  ,9052                             
 NY                         Local  9010     I(4)            4           scalar                    9010,9015,9039,9040,9047,9049,9050
                                                                                                  ,9052                             
 OBLIST                     Common 8977                                 264644                                                      
 W3TAGE                     Subr   9027                                                           9027                              
 XQC                        Dummy  8973     R(4)            4     1     0        ARG,INOUT        8988,8998,9038                    
 YQC                        Dummy  8973     R(4)            4     1     0        ARG,INOUT        9012,9039                         

Page 299         Source Listing                  MIMAP
2017-04-18 11:07                                 cqcbufr.f

   9059 
   9060 C******************************************************************
   9061 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9062 C                .      .    .                                       .
   9063 C SUBPROGRAM:    NMANLV      RETURN NEAREST MANDATORY LEVEL COUNT
   9064 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   9065 C
   9066 C ABSTRACT: Return the value of the count of the nearest mandatory
   9067 C   level: 1-1000, 2-925, ...
   9068 C
   9069 C PROGRAM HISTORY LOG:
   9070 C 1997-03-18  W. Collins  Original author.
   9071 C
   9072 C USAGE:    X=NMANLV(P)
   9073 C   INPUT ARGUMENT LIST:
   9074 C     P        - PRESSURE
   9075 C
   9076 C   OUTPUT ARGUMENT LIST:
   9077 C     NMANLV   - RETURNS THE VALUE
   9078 C
   9079 C REMARKS: NONE.
   9080 C
   9081 C ATTRIBUTES:
   9082 C   LANGUAGE: FORTRAN 90
   9083 C   MACHINE:  NCEP WCOSS
   9084 C
   9085 C$$$
   9086 
   9087       FUNCTION NMANLV(P)
   9088       SAVE ISET, NANLIN
   9089 
   9090       INTEGER NANLIN(10501)
   9091       DATA ISET /0/
   9092 
   9093 C  DETERMINE THE INDEX OF THE NEAREST MANDATORY LEVEL
   9094 C  --------------------------------------------------
   9095 
   9096       IF(ISET.EQ.0) THEN
   9097          DO I=1,10501
   9098          NANLIN(I) = 0
   9099          IF(                I.GE.9620) NANLIN(I) = 1
   9100          IF(I.LE.9619 .AND. I.GE.8880) NANLIN(I) = 2
   9101          IF(I.LE.8879 .AND. I.GE.7750) NANLIN(I) = 3
   9102          IF(I.LE.7749 .AND. I.GE.6000) NANLIN(I) = 4
   9103          IF(I.LE.5999 .AND. I.GE.4500) NANLIN(I) = 5
   9104          IF(I.LE.4499 .AND. I.GE.3500) NANLIN(I) = 6
   9105          IF(I.LE.3499 .AND. I.GE.2750) NANLIN(I) = 7
   9106          IF(I.LE.2749 .AND. I.GE.2250) NANLIN(I) = 8
   9107          IF(I.LE.2249 .AND. I.GE.1750) NANLIN(I) = 9
   9108          IF(I.LE.1749 .AND. I.GE.1250) NANLIN(I) = 10
   9109          IF(I.LE.1249 .AND. I.GE. 850) NANLIN(I) = 11
   9110          IF(I.LE. 849 .AND. I.GE. 600) NANLIN(I) = 12
   9111          IF(I.LE. 599 .AND. I.GE. 400) NANLIN(I) = 13
   9112          IF(I.LE. 399 .AND. I.GE. 250) NANLIN(I) = 14
   9113          IF(I.LE. 249 .AND. I.GE. 150) NANLIN(I) = 15
   9114          IF(I.LE. 149 .AND. I.GE.  85) NANLIN(I) = 16
   9115          IF(I.LE.  84 .AND. I.GE.  60) NANLIN(I) = 17

Page 300         Source Listing                  NMANLV
2017-04-18 11:07                                 cqcbufr.f

   9116          IF(I.LE.  59 .AND. I.GE.  40) NANLIN(I) = 18
   9117          IF(I.LE.  39 .AND. I.GE.  25) NANLIN(I) = 19
   9118          IF(I.LE.  24 .AND. I.GE.  15) NANLIN(I) = 20
   9119          IF(I.LE.  14                ) NANLIN(I) = 21
   9120          ENDDO
   9121          ISET = 1
   9122       ENDIF
   9123 
   9124       IP = NINT(P*10.)
   9125 
   9126       IF(IP.GT.10500) THEN
   9127          NMANLV = 1
   9128       ELSEIF(IP.LT.5) THEN
   9129          NMANLV = 21
   9130       ELSE
   9131          NMANLV = NANLIN(IP)
   9132       ENDIF
   9133 
   9134       RETURN
   9135       END


ENTRY POINTS

  Name               
                     
 nmanlv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  9097     I(4)            4           scalar                    9097,9098,9099,9100,9101,9102,9103
                                                                                                  ,9104,9105,9106,9107,9108,9109,911
                                                                                                  0,9111,9112,9113,9114,9115,9116,91
                                                                                                  17,9118,9119                      
 IP                         Local  9124     I(4)            4           scalar                    9124,9126,9128,9131               
 ISET                       Local  9088     I(4)            4           scalar   SAVE             9091,9096,9121                    
 NANLIN                     Local  9088     I(4)            4     1     10501    SAVE             9098,9099,9100,9101,9102,9103,9104
                                                                                                  ,9105,9106,9107,9108,9109,9110,911
                                                                                                  1,9112,9113,9114,9115,9116,9117,91
                                                                                                  18,9119,9131                      
 NINT                       Func   9124                                 scalar                    9124                              
 NMANLV                     Func   9087     I(4)            4           scalar                    9127,9129,9131                    
 NMANLV@0                   Local  9087     I(4)            4           scalar                                                      
 P                          Dummy  9087     R(4)            4           scalar   ARG,INOUT        9124                              

Page 301         Source Listing                  NMANLV
2017-04-18 11:07                                 cqcbufr.f

   9136 
   9137 C**********************************************************************
   9138 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9139 C                .      .    .                                       .
   9140 C SUBPROGRAM:    NOBERR      NEW OBSERVATION ERROR ROUTINE
   9141 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-04-27
   9142 C
   9143 C ABSTRACT: Find data with observation errors in height, temperature
   9144 C   and dew-point temperature (if TDQC = .true.).
   9145 C
   9146 C PROGRAM HISTORY LOG:
   9147 C 1999-04-27  W. Collins  Original author.
   9148 C
   9149 C USAGE:    CALL NOBERR
   9150 C   OUTPUT FILES:
   9151 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   9152 C
   9153 C REMARKS: NONE.
   9154 C
   9155 C ATTRIBUTES:
   9156 C   LANGUAGE: FORTRAN 90
   9157 C   MACHINE:  NCEP WCOSS
   9158 C
   9159 C$$$
   9160 
   9161       SUBROUTINE NOBERR
   9162       PARAMETER (NST=999)
   9163 
   9164       REAL(8) BMISS
   9165 
   9166       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   9167      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   9168      &                 NEV, ISF(NST), NLVM, NLVW
   9169       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   9170      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   9171      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   9172      &                 TDO(255), TDFC(255),TVO(255),
   9173      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   9174      &                 CAT(255), IND(255), LEVTYP(255),
   9175      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   9176      &                 YDR(255), XDR(255)
   9177       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   9178      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   9179      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   9180      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   9181      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   9182      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
   9183      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   9184      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   9185      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   9186      &                 XTDH(255)
   9187       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   9188      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   9189      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   9190      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   9191      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   9192      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),

Page 302         Source Listing                  NOBERR
2017-04-18 11:07                                 cqcbufr.f

   9193      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   9194      &                 XTHM(21,NST),XTDVM(21,NST),
   9195      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   9196      &                 XQHM(21,NST),
   9197      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   9198      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   9199       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   9200      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   9201      &                 ZTMP(21,NST),   TTMP(21,NST),
   9202      &                 NZTMP(21,NST),  NTTMP(21,NST),
   9203      &                 ITERR(4)
   9204       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   9205      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   9206      &                 ZCLIM, TCLIM, NHLIM
   9207       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   9208      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   9209       COMMON /STN/     IS
   9210       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   9211      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   9212       COMMON /PEROR/  ISERR, ISOBERR
   9213       COMMON /TESTS/   TEST
   9214       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   9215 
   9216       REAL        OBLIM(2,2)
   9217       CHARACTER*8 SID
   9218       LOGICAL     POUT, GOOD(6,2,2), TDQC
   9219       LOGICAL     TEST, ISERR, ISOBERR, PRNT
   9220       LOGICAL     ZG, TG, TDG, QG, ERROR
   9221       LOGICAL     SDMZ, SDMT, SDMQ
   9222 
   9223       IF(TEST) WRITE(60,500) SID(IS)
   9224   500 FORMAT(' NOBERR--CALLED FOR: ',A8)
   9225 
   9226       ISOBERR = .FALSE.
   9227       TDQC = .TRUE.
   9228       PZCOR = 0.
   9229 
   9230       DO L=1,NLVM
   9231         SDMZ = .FALSE.
   9232         SDMT = .FALSE.
   9233         SDMQ = .FALSE.
   9234         SDMZ = ZQM(L).EQ.0. .OR. ZQM(L).GE.14. .OR.
   9235      &        (ZQM(L).GE.4. .AND. ZQM(L).LE.12.)
   9236         SDMT = TQM(L).EQ.0. .OR. TQM(L).GE.14. .OR.
   9237      &        (TQM(L).GE.4. .AND. TQM(L).LE.12.)
   9238         SDMQ = QQM(L).EQ.0. .OR. QQM(L).GE.14. .OR.
   9239      &        (QQM(L).GE.4. .AND. QQM(L).LE.12.)
   9240         M = MANLEV(POB(L))
   9241         IF(M.NE.0) THEN
   9242           XZH(L)  = XZHM(M,IS)
   9243           XTH(L)  = XTHM(M,IS)
   9244           XTDH(L) = XTDHM(M,IS)
   9245         ELSE
   9246           XZH(L)  = BMISS
   9247           XTH(L)  = BMISS
   9248           XTDH(L) = BMISS
   9249         ENDIF

Page 303         Source Listing                  NOBERR
2017-04-18 11:07                                 cqcbufr.f

   9250 
   9251         FACT = 0.01
   9252 
   9253 C  HEIGHT
   9254 C  ------
   9255 
   9256         IF(.NOT.SDMZ) THEN
   9257           B = 10.
   9258           PER = .0035
   9259           P3 = 0.5*FACT
   9260           P13 = 0.1*FACT
   9261           CALL FUZZY(PZ,XZI(L),XZV(L),XZH(L),B,PER)
   9262           QM = 0.
   9263           IF(PZ.NE.BMISS .AND. PZ.LT.P3) THEN
   9264             POUT = .TRUE.
   9265             QM = 3.
   9266             ISOBERR = .TRUE.
   9267             ZC = 0.
   9268             IHSC(2,L) = 49.
   9269           ENDIF
   9270           IF(PZ.NE.BMISS .AND. PZ.LT.P13) QM = 13.
   9271           IF(QM.NE.0.) CALL SEVENT(SID(IS),SQN(IS),L,LST(L),POB(L), 
   9272      &         LEVTYP(L),2,ZC,ZOB(L)+ZC,ZC,QM,IHSC(2,L),XMISS,
   9273      &         XMISS,XMISS)
   9274         ENDIF
   9275 
   9276 
   9277 C  TEMPERATURE
   9278 C  -----------
   9279 
   9280 C  ARTIFICIALLY MAKE IT HARDER TO FLAG BAD TEMPERATURES
   9281 C  NEAR THE SURFACE
   9282 C  ----------------------------------------------------
   9283 
   9284         IF(PS(IS)-POB(L).GT.200.) THEN
   9285           CON = 1.0
   9286         ELSEIF(PS(IS)-POB(L).LE.100.) THEN
   9287           CON = 3.0
   9288         ELSE
   9289           CON = 3.0 - 2.*(PS(IS)-POB(L)-100.)/100.
   9290         ENDIF
   9291         IF(POB(L).GT.PS(IS)) CON = 1.0
   9292         IF(CAT(L).EQ.5) CON = 3.0
   9293 
   9294         IF(.NOT.SDMT) THEN
   9295           B = 10.
   9296           PER = .0035
   9297           P3 = 0.5*FACT
   9298           P13 = 0.1*FACT
   9299 C         IF(L-ISF(IS).EQ.0) THEN
   9300 C           P3  = .002*FACT
   9301 C           P13 = .001*FACT
   9302 C         ENDIF
   9303 C         IF(L-ISF(IS).NE.0 .AND. L-ISF(IS).LT.4) THEN
   9304 C           P3  = 0.05*FACT
   9305 C           P13 = 0.02*FACT
   9306 C         ENDIF

Page 304         Source Listing                  NOBERR
2017-04-18 11:07                                 cqcbufr.f

   9307 C         IF(L-ISF(IS).EQ.4) THEN
   9308 C           P3  = 0.15*FACT
   9309 C           P13 = 0.07*FACT
   9310 C         ENDIF
   9311           CALL FUZZY(PT,XTI(L)/CON,XTV(L)/CON,XTH(L)/CON,B,PER)
   9312           QM = 0.
   9313           IF(PT.NE.BMISS .AND. PT.LT.P3) THEN
   9314             POUT = .TRUE.
   9315             QM = 3.
   9316             ISOBERR = .TRUE.
   9317             TC = 0.
   9318             IHSC(3,L) = 49.
   9319           ENDIF
   9320           IF(PT.NE.BMISS .AND. PT.LT.P13) QM = 13.
   9321           IF(QM.NE.0.) CALL SEVENT(SID(IS),SQN(IS),L,LST(L),POB(L),
   9322      &         LEVTYP(L),3,TC,TOB(L)+TC,TC,QM,IHSC(3,L),XMISS,
   9323      &         XMISS,XMISS)
   9324         ENDIF
   9325 
   9326 C  MOISTURE
   9327 C  --------
   9328 
   9329         IF(.NOT.SDMQ) THEN
   9330           B = 20.
   9331           PER = .1
   9332           P3 = 0.5*FACT
   9333           P13 = 0.1*FACT
   9334           CALL FUZZY(PTD,XTDI(L),XTDV(L),XTDH(L),B,PER)
   9335           QM = 0.
   9336           IF(PTD.NE.BMISS .AND. PTD.LT.P3) THEN
   9337             POUT = .TRUE.
   9338             QM = 3.
   9339             ISOBERR = .TRUE.
   9340             IHSC(4,L) = 49.
   9341           ENDIF
   9342           IF(PTD.NE.BMISS .AND. PTD.LT.P13) QM = 13.
   9343           IF(QM.NE.0.) CALL SEVENT(SID(IS),SQN(IS),L,LST(L),POB(L),
   9344      &         LEVTYP(L),5,0.,QOB(L),0.,QM,IHSC(4,L),XMISS,
   9345      &         XMISS,XMISS)
   9346         ENDIF
   9347       ENDDO
   9348 
   9349       RETURN
   9350       END

Page 305         Source Listing                  NOBERR
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 noberr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  9224                                                           9223                              
 ALLSND                     Common 9169                                 34512                                                       
 B                          Scalar 9185     R(4)            4     1     21       COM              9257,9261,9295,9311,9330,9334     
 BASRES                     Scalar 9184     R(4)            4     1     999      COM                                                
 BMISS                      Scalar 9164     R(8)            8           scalar   COM              9246,9247,9248,9263,9270,9313,9320
                                                                                                  ,9336,9342                        
 BRES                       Scalar 9198     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 9214                                 16                                                          
 CAT                        Scalar 9174     R(4)            4     1     255      COM              9292                              
 CON                        Local  9285     R(4)            4           scalar                    9285,9287,9289,9291,9292,9311     
 CQCPC                      Scalar 9208     R(4)            4           scalar   COM                                                
 DHR                        Scalar 9166     R(4)            4     1     999      COM                                                
 ELV                        Scalar 9167     R(4)            4     1     999      COM                                                
 ERROR                      Scalar 9198     L(4)            4     1     999      COM                                                
 FACT                       Local  9251     R(4)            4           scalar                    9251,9259,9260,9297,9298,9332,9333
 FUZZY                      Subr   9261                                                           9261,9311,9334                    
 GESPS                      Scalar 9175     R(4)            4     1     999      COM                                                
 GOOD                       Local  9218     L(4)            4     3     24                                                          
 H1                         Scalar 9210     R(4)            4           scalar   COM                                                
 H2                         Scalar 9210     R(4)            4           scalar   COM                                                
 HEADER                     Common 9166                                 35980                                                       
 HOIRES                     Scalar 9204     R(4)            4     2     84       COM                                                
 HRDR                       Scalar 9175     R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 9204     R(4)            4     1     21       COM                                                
 HYD                        Scalar 9183     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 9198     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 9183     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 9183     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 9183     R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 9210                                 64                                                          
 IHSC                       Scalar 9184     I(4)            4     2     1020     COM              9268,9272,9318,9322,9340,9344     
 IMISS                      Scalar 9214     I(4)            4           scalar   COM                                                
 IND                        Scalar 9174     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 9208     I(4)            4           scalar   COM                                                
 IS                         Scalar 9209     I(4)            4           scalar   COM              9223,9242,9243,9244,9271,9284,9286
                                                                                                  ,9289,9291,9321,9343              
 ISC                        Scalar 9208     I(4)            4           scalar   COM                                                
 ISERR                      Scalar 9212     L(4)            4           scalar   COM                                                
 ISF                        Scalar 9168     I(4)            4     1     999      COM                                                
 ISOBERR                    Scalar 9212     L(4)            4           scalar   COM              9226,9266,9316,9339               
 ITERR                      Scalar 9203     I(4)            4     1     4        COM                                                
 ITP                        Scalar 9167     I(4)            4     1     999      COM                                                
 L                          Local  9230     I(4)            4           scalar                    9230,9234,9235,9236,9237,9238,9239
                                                                                                  ,9240,9242,9243,9244,9246,9247,924

Page 306         Source Listing                  NOBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  8,9261,9268,9271,9272,9284,9286,92
                                                                                                  89,9291,9292,9311,9318,9321,9322,9
                                                                                                  334,9340,9343,9344                
 LAST                       Scalar 9211     I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 9174     I(4)            4     1     255      COM              9272,9322,9344                    
 LIMS                       Common 9204                                 1776                                                        
 LMAND                      Scalar 9208     I(4)            4     1     22       COM                                                
 LSFC                       Scalar 9208     I(4)            4           scalar   COM                                                
 LST                        Scalar 9175     I(4)            4     1     255      COM              9271,9321,9343                    
 M                          Local  9240     I(4)            4           scalar                    9240,9241,9242,9243,9244          
 MAND                       Scalar 9207     I(4)            4           scalar   COM                                                
 MANLEV                     Func   9240     I(4)            4           scalar                    9240                              
 MANRES                     Common 9187                                 2949048                                                     
 NBAS                       Scalar 9185     I(4)            4           scalar   COM                                                
 NEV                        Scalar 9168     I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 9206     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 9183     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 9185     I(4)            4     1     21       COM                                                
 NLEV                       Scalar 9207     I(4)            4           scalar   COM                                                
 NLV                        Scalar 9167     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 9168     I(4)            4           scalar   COM              9230                              
 NLVW                       Scalar 9168     I(4)            4           scalar   COM                                                
 NOBERR                     Subr   9161                                                                                             
 NOBS                       Scalar 9207     I(4)            4           scalar   COM                                                
 NQHM                       Scalar 9195     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 9179     I(4)            4     1     255      COM                                                
 NQV                        Scalar 9181     I(4)            4     1     255      COM                                                
 NST                        Param  9162     I(4)            4           scalar                    9166,9167,9168,9175,9184,9187,9188
                                                                                                  ,9189,9190,9191,9192,9193,9194,919
                                                                                                  5,9196,9197,9198,9199,9200,9201,92
                                                                                                  02                                
 NTDHM                      Scalar 9195     I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 9179     I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 9190     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 9181     I(4)            4     1     255      COM                                                
 NTHM                       Scalar 9193     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 9179     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 9190     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 9181     I(4)            4     1     255      COM                                                
 NTTMP                      Scalar 9202     I(4)            4     2     20979    COM                                                
 NTV                        Scalar 9181     I(4)            4     1     255      COM                                                
 NZHM                       Scalar 9193     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 9179     I(4)            4     1     255      COM                                                
 NZIM                       Scalar 9190     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 9202     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 9181     I(4)            4     1     255      COM                                                
 OBLIM                      Local  9216     R(4)            4     2     4                                                           
 P13                        Local  9260     R(4)            4           scalar                    9260,9270,9298,9320,9333,9342     
 P3                         Local  9259     R(4)            4           scalar                    9259,9263,9297,9313,9332,9336     
 PARAMS                     Common 9207                                 148                                                         
 PER                        Local  9258     R(4)            4           scalar                    9258,9261,9296,9311,9331,9334     
 PEROR                      Common 9212                                 8                                                           
 PFC                        Scalar 9169     R(4)            4     1     255      COM                                                
 PI                         Scalar 9177     R(4)            4     1     255      COM                                                
 PIS                        Scalar 9198     R(4)            4     1     999      COM                                                

Page 307         Source Listing                  NOBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 POB                        Scalar 9169     R(4)            4     1     255      COM              9240,9271,9284,9286,9289,9291,9321
                                                                                                  ,9343                             
 POUT                       Scalar 9211     L(4)            4           scalar   COM              9264,9314,9337                    
 PQM                        Scalar 9169     R(4)            4     1     255      COM                                                
 PRC                        Scalar 9169     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 9208     L(4)            4           scalar   COM                                                
 PS                         Scalar 9175     R(4)            4     1     999      COM              9284,9286,9289,9291               
 PSCOR                      Scalar 9211     R(4)            4           scalar   COM                                                
 PSINC                      Scalar 9184     R(4)            4           scalar   COM                                                
 PT                         Local  9311     R(4)            4           scalar                    9311,9313,9320                    
 PTD                        Local  9334     R(4)            4           scalar                    9334,9336,9342                    
 PZ                         Local  9261     R(4)            4           scalar                    9261,9263,9270                    
 PZCOR                      Local  9228     R(4)            4           scalar                    9228                              
 QFC                        Scalar 9173     R(4)            4     1     255      COM                                                
 QG                         Scalar 9197     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 9188     R(4)            4     2     20979    COM                                                
 QI                         Scalar 9177     R(4)            4     1     255      COM                                                
 QIM                        Scalar 9187     R(4)            4     2     20979    COM                                                
 QM                         Local  9262     R(4)            4           scalar                    9262,9265,9270,9271,9272,9312,9315
                                                                                                  ,9320,9321,9322,9335,9338,9342,934
                                                                                                  3,9344                            
 QOB                        Scalar 9173     R(4)            4     1     255      COM              9344                              
 QQM                        Scalar 9173     R(4)            4     1     255      COM              9238,9239                         
 QRC                        Scalar 9173     R(4)            4     1     255      COM                                                
 QV                         Scalar 9178     R(4)            4     1     255      COM                                                
 QVM                        Scalar 9189     R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 9207     R(4)            4           scalar   COM                                                
 RESID                      Common 9177                                 41312                                                       
 SDMQ                       Local  9221     L(4)            4           scalar                    9233,9238,9329                    
 SDMT                       Local  9221     L(4)            4           scalar                    9232,9236,9294                    
 SDMZ                       Local  9221     L(4)            4           scalar                    9231,9234,9256                    
 SEVENT                     Subr   9271                                                           9271,9321,9343                    
 SID                        Scalar 9166     CHAR            8     1     999      COM              9223,9271,9321,9343               
 SQN                        Scalar 9167     R(4)            4     1     999      COM              9271,9321,9343                    
 STN                        Common 9209                                 4                                                           
 T1                         Scalar 9210     R(4)            4           scalar   COM                                                
 TC                         Local  9317     R(4)            4           scalar                    9317,9322                         
 TCBEST                     Scalar 9210     R(4)            4     1     2        COM                                                
 TCLIM                      Scalar 9206     R(4)            4           scalar   COM                                                
 TCOR                       Scalar 9210     R(4)            4     1     2        COM                                                
 TDFC                       Scalar 9172     R(4)            4     1     255      COM                                                
 TDG                        Scalar 9197     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 9188     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 9177     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 9187     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 9172     R(4)            4     1     255      COM                                                
 TDQC                       Local  9218     L(4)            4           scalar                    9227                              
 TDV                        Scalar 9178     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 9189     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 9213     L(4)            4           scalar   COM              9223                              
 TESTS                      Common 9213                                 4                                                           
 TFACT                      Scalar 9205     R(4)            4     2     84       COM                                                
 TFC                        Scalar 9171     R(4)            4     1     255      COM                                                
 TG                         Scalar 9197     L(4)            4     2     20979    COM                                                
 THM                        Scalar 9188     R(4)            4     2     20979    COM                                                

Page 308         Source Listing                  NOBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TI                         Scalar 9177     R(4)            4     1     255      COM                                                
 TIM                        Scalar 9187     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 9200     R(4)            4     3     83916    COM                                                
 TL                         Scalar 9178     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 9184     R(4)            4     1     255      COM                                                
 TMPSND                     Common 9199                                 1678336                                                     
 TMPSTD                     Scalar 9205     R(4)            4     2     84       COM                                                
 TOB                        Scalar 9171     R(4)            4     1     255      COM              9322                              
 TOBT                       Scalar 9199     R(4)            4     3     83916    COM                                                
 TQM                        Scalar 9171     R(4)            4     1     255      COM              9236,9237                         
 TRC                        Scalar 9171     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 9211     R(4)            4           scalar   COM                                                
 TT                         Scalar 9208     R(4)            4           scalar   COM                                                
 TTMP                       Scalar 9201     R(4)            4     2     20979    COM                                                
 TV                         Scalar 9178     R(4)            4     1     255      COM                                                
 TVM                        Scalar 9189     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 9172     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 9205     R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 9207     R(4)            4           scalar   COM                                                
 XDR                        Scalar 9176     R(4)            4     1     255      COM                                                
 XINC                       Scalar 9204     R(4)            4     2     84       COM                                                
 XMA                        Scalar 9207     R(4)            4           scalar   COM                                                
 XMI                        Scalar 9207     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 9214     R(4)            4           scalar   COM              9272,9273,9322,9323,9344,9345     
 XOB                        Scalar 9166     R(4)            4     1     999      COM                                                
 XQHM                       Scalar 9196     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 9180     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 9192     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 9182     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 9186     R(4)            4     1     255      COM              9244,9248,9334                    
 XTDHM                      Scalar 9195     R(4)            4     2     20979    COM              9244                              
 XTDI                       Scalar 9180     R(4)            4     1     255      COM              9334                              
 XTDIM                      Scalar 9191     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 9182     R(4)            4     1     255      COM              9334                              
 XTDVM                      Scalar 9194     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 9185     R(4)            4     1     255      COM              9243,9247,9311                    
 XTHM                       Scalar 9194     R(4)            4     2     20979    COM              9243                              
 XTI                        Scalar 9180     R(4)            4     1     255      COM              9311                              
 XTIM                       Scalar 9191     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 9182     R(4)            4     1     255      COM              9311                              
 XTVM                       Scalar 9192     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 9185     R(4)            4     1     255      COM              9242,9246,9261                    
 XZHM                       Scalar 9193     R(4)            4     2     20979    COM              9242                              
 XZI                        Scalar 9180     R(4)            4     1     255      COM              9261                              
 XZIM                       Scalar 9191     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 9182     R(4)            4     1     255      COM              9261                              
 XZVM                       Scalar 9192     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 9176     R(4)            4     1     255      COM                                                
 YMA                        Scalar 9207     R(4)            4           scalar   COM                                                
 YMI                        Scalar 9207     R(4)            4           scalar   COM                                                
 YOB                        Scalar 9166     R(4)            4     1     999      COM                                                
 ZC                         Local  9267     R(4)            4           scalar                    9267,9272                         
 ZCBEST                     Scalar 9210     R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 9206     R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 9210     R(4)            4     1     2        COM                                                

Page 309         Source Listing                  NOBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZD                         Scalar 9185     R(4)            4     1     255      COM                                                
 ZFC                        Scalar 9170     R(4)            4     1     255      COM                                                
 ZG                         Scalar 9197     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 9188     R(4)            4     2     20979    COM                                                
 ZI                         Scalar 9177     R(4)            4     1     255      COM                                                
 ZIM                        Scalar 9187     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 9200     R(4)            4     3     83916    COM                                                
 ZOB                        Scalar 9170     R(4)            4     1     255      COM              9272                              
 ZOBT                       Scalar 9199     R(4)            4     3     83916    COM                                                
 ZQM                        Scalar 9170     R(4)            4     1     255      COM              9234,9235                         
 ZRC                        Scalar 9170     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 9211     R(4)            4           scalar   COM                                                
 ZTMP                       Scalar 9201     R(4)            4     2     20979    COM                                                
 ZV                         Scalar 9178     R(4)            4     1     255      COM                                                
 ZVM                        Scalar 9189     R(4)            4     2     20979    COM                                                

Page 310         Source Listing                  NOBERR
2017-04-18 11:07                                 cqcbufr.f

   9351 
   9352 C**********************************************************************
   9353 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9354 C                .      .    .                                       .
   9355 C SUBPROGRAM:    OBERR       FIND DATA WITH OBSERVATION ERRORS
   9356 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
   9357 C
   9358 C ABSTRACT: Find data with observation errors in height, temperature
   9359 C   and dew-point temperature (if TDQC = .true.).
   9360 C
   9361 C PROGRAM HISTORY LOG:
   9362 C 1997-03-18  W. Collins  Original author.
   9363 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
   9364 C     were tested for not being equal to real value for missing (BMISS
   9365 C     = 10E10), these integer values can never be equal to BMISS for
   9366 C     I*4 due to overflow - instead they are now tested for not being
   9367 C     equal to new integer value for missing (IMISS, also = 10E10),
   9368 C     although this is also an overflow value for I*4, it results in a
   9369 C     correct evaluation
   9370 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
   9371 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
   9372 C     overflow (also done for IMISS). 
   9373 C
   9374 C USAGE:    CALL OBERR
   9375 C   OUTPUT FILES:
   9376 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   9377 C
   9378 C REMARKS: NONE.
   9379 C
   9380 C ATTRIBUTES:
   9381 C   LANGUAGE: FORTRAN 90
   9382 C   MACHINE:  NCEP WCOSS
   9383 C
   9384 C$$$
   9385 
   9386       SUBROUTINE OBERR
   9387       PARAMETER (NST=999)
   9388 
   9389       REAL(8) BMISS
   9390 
   9391       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   9392      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   9393      &                 NEV, ISF(NST), NLVM, NLVW
   9394       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   9395      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   9396      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   9397      &                 TDO(255), TDFC(255),TVO(255),
   9398      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   9399      &                 CAT(255), IND(255), LEVTYP(255),
   9400      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   9401      &                 YDR(255), XDR(255)
   9402       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   9403      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   9404      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   9405      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   9406      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
   9407      &                 XZV(255),XTV(255),XTDV(255),XQV(255),

Page 311         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9408      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
   9409      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
   9410      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
   9411      &                 XTDH(255)
   9412       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
   9413      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
   9414      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
   9415      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
   9416      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
   9417      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
   9418      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
   9419      &                 XTHM(21,NST),XTDVM(21,NST),
   9420      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
   9421      &                 XQHM(21,NST),
   9422      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
   9423      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
   9424       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
   9425      &                 ZIT(21,NST,4),  TIT(21,NST,4),
   9426      &                 ZTMP(21,NST),   TTMP(21,NST),
   9427      &                 NZTMP(21,NST),  NTTMP(21,NST),
   9428      &                 ITERR(4)
   9429       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
   9430      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
   9431      &                 ZCLIM, TCLIM, NHLIM
   9432       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
   9433      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
   9434       COMMON /STN/     IS
   9435       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
   9436      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
   9437       COMMON /PEROR/  ISERR, ISOBERR
   9438       COMMON /TESTS/   TEST
   9439       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   9440 
   9441       LOGICAL          TEST, ISERR, ISOBERR, PRNT
   9442       REAL        OBLIM(2,2)
   9443       CHARACTER*8 SID
   9444       LOGICAL     POUT, GOOD(6,2,2), TDQC
   9445       LOGICAL ZG, TG, TDG, QG, ERROR, SDMQ
   9446 C     DATA OBLIM /.55,.40,.40,.30/
   9447 C     DATA OBLIM /.66,.48,.48,.36/
   9448 C     DATA OBLIM /.55,.37,.40,.27/
   9449       DATA OBLIM /.605,.403,.440,.293/
   9450 
   9451       IF(TEST) WRITE(60,500) SID(IS)
   9452   500 FORMAT(' OBERR--CALLED FOR: ',A8)
   9453 
   9454       POUT = .FALSE.
   9455       TDQC = .FALSE.
   9456       ISOBERR = .FALSE.
   9457 
   9458       LAST = NLEV
   9459       DO LM=1,NLEV
   9460 
   9461       L = MANLEV(POB(LM))
   9462       LN = NMANLV(POB(LM))
   9463       IF(CAT(LM).EQ.1 .AND. L.NE.0) THEN
   9464         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),XINC(L,2),

Page 312         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9465      &    XMISS,XMISS,THM(L,IS),HOIRES(L,2),
   9466      &    TTMP(L,IS),TMPSTD(L,2))
   9467       ELSE
   9468         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),XINC(LN,2),
   9469      &    XMISS,XMISS,XMISS,XMISS,XMISS,XMISS)
   9470       ENDIF
   9471       IF(LM.GE.2) THEN
   9472         LB = NMANLV(POB(LM-1))
   9473         IF(LB.LT.1) LB = 1
   9474         IF(CAT(LM-1).EQ.1 .AND. LB.NE.0) THEN
   9475           CALL BEST(TCBB,XMISS,XMISS,TI(LM-1),XINC(LB,2),
   9476      &      XMISS,XMISS,THM(LB,IS),HOIRES(LB,2),
   9477      &      TTMP(LB,IS),TMPSTD(LB,2))
   9478         ELSE
   9479           CALL BEST(TCBB,XMISS,XMISS,TI(LM-1),XINC(LB,2),
   9480      &      XMISS,XMISS,XMISS,XMISS,XMISS,XMISS)
   9481         ENDIF
   9482       ELSE
   9483         LB = L
   9484         IF(LB.EQ.0) LB = LN
   9485         TCBB = BMISS
   9486       ENDIF
   9487       IF(LM.LT.NLVM-1) THEN
   9488         LA = NMANLV(POB(LM+1))
   9489         IF(LA.GT.NLVM) LA = NLVM
   9490         IF(CAT(LM+1).EQ.1 .AND. LA.NE.0) THEN
   9491           CALL BEST(TCBA,XMISS,XMISS,TI(LM+1),XINC(LA,2),
   9492      &      XMISS,XMISS,THM(LA,IS),HOIRES(LA,2),
   9493      &      TTMP(LA,IS),TMPSTD(LA,2))
   9494         ELSE
   9495           CALL BEST(TCBA,XMISS,XMISS,TI(LM+1),XINC(LA,2),
   9496      &      XMISS,XMISS,XMISS,XMISS,XMISS,XMISS)
   9497         ENDIF
   9498       ELSE
   9499         LA = L
   9500         IF(LA.EQ.0) LA = LN
   9501         TCBA = BMISS
   9502       ENDIF
   9503 
   9504 C  TEST FOR TEMPERATURE OBSERVATION ERROR
   9505 C  --------------------------------------
   9506 
   9507       QM = 0.
   9508       IF(PS(IS)-POB(LM).GT.200.) THEN
   9509         CON = 1.0
   9510       ELSEIF(PS(IS)-POB(LM).LE.100.) THEN
   9511         CON = 3.0
   9512       ELSE
   9513         CON = 3.0 - 2.*(PS(IS)-POB(LM)-100.)/100.
   9514       ENDIF
   9515       IF(POB(LM).GT.PS(IS)) CON = 1.0
   9516       IF(CAT(LM).EQ.5) CON = 3.0
   9517 
   9518       NTVP = 0
   9519                          ! NTV(LM+1) will never test = bmiss, use imiss
   9520 cdak  IF(LM+1.LE.NLVM .AND. NTV(LM+1).NE.BMISS) NTVP = NTV(LM+1)
   9521       IF(LM+1.LE.NLVM .AND. NTV(LM+1).NE.IMISS) NTVP = NTV(LM+1)

Page 313         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9522       NTVM = 0
   9523                          ! NTV(LM-1) will never test = bmiss, use imiss
   9524 cdak  IF(LM-1.GE.1 .AND. NTV(LM-1).NE.BMISS) NTVM = NTV(LM-1)
   9525       IF(LM-1.GE.1 .AND. NTV(LM-1).NE.IMISS) NTVM = NTV(LM-1)
   9526 
   9527       CC1 = CON*OBLIM(1,2)*XINC(LN,2)
   9528       CC2 = CON*OBLIM(2,2)*XINC(LN,2)
   9529       IF(TEST) WRITE(60,501) POB(LM),TCBEST(1),TCBB,TCBA,CC1,CC2
   9530   501 FORMAT(' OBERR--POB,TCBEST(1),TCBB,TCBA,CC1,CC2: ',6F10.1)
   9531 
   9532       IF(TCBEST(1).NE.BMISS .AND.
   9533      &  ABS(TCBEST(1)).GT.CON*OBLIM(1,2)*XINC(LN,2)) THEN
   9534         POUT = .TRUE.
   9535         TC = 0.
   9536         IHSC(3,LM) = 30.
   9537         IF(ABS(TCBEST(1)).GT.2.0*CON*OBLIM(1,2)*XINC(LN,2)) THEN
   9538           QM = 13.
   9539           ISOBERR = .TRUE.
   9540         ELSEIF(NTV(LM).GT.7 .AND. NTVP.LT.5 .AND. NTVM.LT.5) THEN
   9541           QM = 13.
   9542           ISOBERR = .TRUE.
   9543         ELSE
   9544           QM = 3.
   9545           ISOBERR = .TRUE.
   9546         ENDIF
   9547       ELSEIF(TCBEST(1).NE.BMISS .AND.
   9548      &  ABS(TCBEST(1)).GT.CON*OBLIM(2,2)*XINC(LN,2) .AND.
   9549      &  (ABS(TCBB).GT.CON*OBLIM(2,2)*XINC(LB,2) .OR.
   9550      &   ABS(TCBA).GT.CON*OBLIM(2,2)*XINC(LA,2))) THEN
   9551         POUT = .TRUE.
   9552         TC = 0.
   9553         IHSC(3,LM) = 31.
   9554         IF(NTV(LM).GT.7 .AND. NTVP.LT.5 .AND. NTVM.LT.5) THEN
   9555           QM = 13.
   9556           ISOBERR = .TRUE.
   9557         ELSE
   9558           QM = 3.
   9559           ISOBERR = .TRUE.
   9560         ENDIF
   9561       ELSEIF(TCBEST(1).NE.BMISS .AND.
   9562      &  ABS(TCBEST(1)).GT.CON*OBLIM(2,2)*XINC(LN,2)) THEN
   9563         IF(LM.GT.1) THEN
   9564           IF(NTL(LM).EQ.4 .OR. NTL(LM-1).EQ.4) THEN
   9565             POUT = .TRUE.
   9566             TC = 0.
   9567             IHSC(3,LM) = 32.
   9568             IF(NTV(LM).GT.7 .AND. NTVP.LT.5 .AND. NTVM.LT.5) THEN
   9569               QM = 13.
   9570               ISOBERR = .TRUE.
   9571             ELSE
   9572               QM = 3.
   9573               ISOBERR = .TRUE.
   9574             ENDIF
   9575           ELSE
   9576             POUT = .TRUE.
   9577             QM = 3.
   9578             ISOBERR = .TRUE.

Page 314         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9579             TC = 0.
   9580             IHSC(3,LM) = 33.
   9581           ENDIF
   9582         ELSEIF(LM.EQ.1) THEN
   9583           IF(NTL(LM).EQ.4) THEN
   9584             POUT = .TRUE.
   9585             TC = 0.
   9586             IHSC(3,LM) = 34.
   9587             QM = 13.
   9588             ISOBERR = .TRUE.
   9589           ELSE
   9590             POUT = .TRUE.
   9591             QM = 3.
   9592             ISOBERR = .TRUE.
   9593             TC = 0.
   9594             IHSC(3,LM) = 35.
   9595           ENDIF
   9596         ENDIF
   9597       ENDIF
   9598       IF(QM.EQ.3. .OR. QM.EQ.13.) THEN
   9599         PTCOR = 0.
   9600         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),3,TC,
   9601      &    TOB(LM)+TC,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
   9602       ENDIF
   9603 
   9604 C  TEST FOR HEIGHT OBSERVATION ERROR
   9605 C  ---------------------------------
   9606 
   9607       IF(CAT(LM).EQ.2 .OR. CAT(LM).EQ.5) GOTO 100
   9608       QM = 0.
   9609       LN = NMANLV(POB(LM))
   9610                                 ! LN will never test = bmiss, use imiss
   9611 cdak  IF(LN.GT.0 .AND. LN.NE.BMISS) THEN
   9612       IF(LN.GT.0 .AND. LN.NE.IMISS) THEN
   9613         IF(NZI(LM).LT.6) THEN
   9614           ZDIF = ZI(LM)
   9615         ELSE
   9616           ZDIF = ZD(LM)
   9617         ENDIF
   9618 C       CALL BEST(ZCBEST(1),XMISS,XMISS,ZDIF,XINC(LN,1),
   9619 C    &    XMISS,XMISS,ZHM(LN,IS),HOIRES(LN,1),
   9620 C    &    ZTMP(LN,IS),TMPSTD(LN,1))
   9621         CALL BEST(ZCBEST(1),XMISS,XMISS,ZI(LM),XINC(LN,1),
   9622      &    XMISS,XMISS,ZHM(LN,IS),HOIRES(LN,1),
   9623      &    ZTMP(LN,IS),TMPSTD(LN,1))
   9624       ELSE
   9625         ZCBEST(1) = BMISS
   9626       ENDIF
   9627 
   9628       CC1 = OBLIM(1,1)*XINC(LN,1)
   9629       CC2 = OBLIM(2,1)*XINC(LN,1)
   9630       IF(TEST) WRITE(60,502) POB(LM),ZCBEST(1),CC1,CC2
   9631   502 FORMAT(' OBERR--POB,ZCBEST(1),CC1,CC2: ',4F10.1)
   9632 
   9633       IF(ZCBEST(1).NE.BMISS .AND.
   9634      &  ABS(ZCBEST(1)).GT.OBLIM(1,1)*XINC(LN,1)) THEN
   9635         POUT = .TRUE.

Page 315         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9636         QM = 13.
   9637         ISOBERR = .TRUE.
   9638         ZC = 0.
   9639         IHSC(2,LM) = 36.
   9640       ELSEIF(ZCBEST(1).NE.BMISS .AND.
   9641      &  ABS(ZCBEST(1)).GT.OBLIM(2,1)*XINC(LN,1)) THEN
   9642         POUT = .TRUE.
   9643         QM = 3.
   9644         ISOBERR = .TRUE.
   9645         ZC = 0.
   9646         IHSC(2,LM) = 37.
   9647       ENDIF
   9648       IF(QM.EQ.3. .OR. QM.EQ.13.) THEN
   9649         PZCOR = 0.
   9650         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),2,ZC,
   9651      &    ZOB(LM)+ZC,PZCOR,QM,IHSC(2,LM),XMISS,XMISS,XMISS)
   9652       ENDIF
   9653   100 CONTINUE
   9654 
   9655 C  TEST FOR SPECIFIC HUMIDITY OBSERVATION ERROR
   9656 C  --------------------------------------------
   9657 
   9658       IF(TDQC) THEN
   9659         QM = 0.
   9660         IF(NTDI(LM).GE.20 .OR. NTDV(LM).GE.20) THEN
   9661           POUT = .TRUE.
   9662           QM = 13.
   9663           ISOBERR = .TRUE.
   9664           IHSC(4,LM) = 38.
   9665           IF(TEST) WRITE(60,601) POUT,QM,ISOBERR,IHSC(4,LM)
   9666   601     FORMAT(' POBERR--POUT,QM,ISOBERR,IHSC(4,LM): ',L2,F6.0,L2,I5)
   9667           SDMQ = .FALSE.
   9668           SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
   9669      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
   9670           IF(.NOT.SDMQ) THEN
   9671             CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),5,
   9672      &        0.,QOB(LM),0.,QM,IHSC(4,LM),XMISS,XMISS,XMISS)
   9673           ENDIF
   9674         ENDIF
   9675         IF(L.NE.0) THEN
   9676           IF(NTDHM(L,IS).GE.20) THEN
   9677             POUT = .TRUE.
   9678             QM = 13.
   9679             ISOBERR = .TRUE.
   9680             IHSC(4,LM) = 39.
   9681             PTDCOR = 0.
   9682             IF(TEST) WRITE(60,601) POUT,QM,ISOBERR,IHSC(4,LM)
   9683             SDMQ = .FALSE.
   9684             SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
   9685      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
   9686             IF(.NOT.SDMQ) THEN
   9687               CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
   9688      &          5,0.,QOB(LM),0.,QM,IHSC(4,LM),XMISS,XMISS,XMISS)
   9689             ENDIF
   9690           ENDIF
   9691         ENDIF
   9692       ENDIF

Page 316         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9693 
   9694       ENDDO
   9695 
   9696       RETURN
   9697       END


ENTRY POINTS

  Name              
                    
 oberr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  9653                                                           9607                              
 500                        Label  9452                                                           9451                              
 501                        Label  9530                                                           9529                              
 502                        Label  9631                                                           9630                              
 601                        Label  9666                                                           9665,9682                         
 ABS                        Func   9533                                 scalar                    9533,9537,9548,9549,9550,9562,9634
                                                                                                  ,9641                             
 ALLSND                     Common 9394                                 34512                                                       
 B                          Scalar 9410     R(4)            4     1     21       COM                                                
 BASRES                     Scalar 9409     R(4)            4     1     999      COM                                                
 BEST                       Subr   9464                                                           9464,9468,9475,9479,9491,9495,9621
 BMISS                      Scalar 9389     R(8)            8           scalar   COM              9485,9501,9532,9547,9561,9625,9633
                                                                                                  ,9640                             
 BRES                       Scalar 9423     R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 9439                                 16                                                          
 CAT                        Scalar 9399     R(4)            4     1     255      COM              9463,9474,9490,9516,9607          
 CC1                        Local  9527     R(4)            4           scalar                    9527,9529,9628,9630               
 CC2                        Local  9528     R(4)            4           scalar                    9528,9529,9629,9630               
 CON                        Local  9509     R(4)            4           scalar                    9509,9511,9513,9515,9516,9527,9528
                                                                                                  ,9533,9537,9548,9549,9550,9562    
 CQCPC                      Scalar 9433     R(4)            4           scalar   COM                                                
 DHR                        Scalar 9391     R(4)            4     1     999      COM                                                
 ELV                        Scalar 9392     R(4)            4     1     999      COM                                                
 ERROR                      Scalar 9423     L(4)            4     1     999      COM                                                
 GESPS                      Scalar 9400     R(4)            4     1     999      COM                                                
 GOOD                       Local  9444     L(4)            4     3     24                                                          
 H1                         Scalar 9435     R(4)            4           scalar   COM                                                
 H2                         Scalar 9435     R(4)            4           scalar   COM                                                
 HEADER                     Common 9391                                 35980                                                       
 HOIRES                     Scalar 9429     R(4)            4     2     84       COM              9465,9476,9492,9622               
 HRDR                       Scalar 9400     R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 9429     R(4)            4     1     21       COM                                                
 HYD                        Scalar 9408     R(4)            4     1     21       COM                                                
 HYDM                       Scalar 9423     R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 9408     R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 9408     R(4)            4     1     21       COM                                                
 HYDS                       Scalar 9408     R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 9435                                 64                                                          
 IHSC                       Scalar 9409     I(4)            4     2     1020     COM              9536,9553,9567,9580,9586,9594,9601

Page 317         Source Listing                  OBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,9639,9646,9651,9664,9665,9672,968
                                                                                                  0,9682,9688                       
 IMISS                      Scalar 9439     I(4)            4           scalar   COM              9521,9525,9612                    
 IND                        Scalar 9399     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 9433     I(4)            4           scalar   COM                                                
 IS                         Scalar 9434     I(4)            4           scalar   COM              9451,9465,9466,9476,9477,9492,9493
                                                                                                  ,9508,9510,9513,9515,9600,9622,962
                                                                                                  3,9650,9671,9676,9687             
 ISC                        Scalar 9433     I(4)            4           scalar   COM                                                
 ISERR                      Scalar 9437     L(4)            4           scalar   COM                                                
 ISF                        Scalar 9393     I(4)            4     1     999      COM                                                
 ISOBERR                    Scalar 9437     L(4)            4           scalar   COM              9456,9539,9542,9545,9556,9559,9570
                                                                                                  ,9573,9578,9588,9592,9637,9644,966
                                                                                                  3,9665,9679,9682                  
 ITERR                      Scalar 9428     I(4)            4     1     4        COM                                                
 ITP                        Scalar 9392     I(4)            4     1     999      COM                                                
 L                          Local  9461     I(4)            4           scalar                    9461,9463,9464,9465,9466,9483,9499
                                                                                                  ,9675,9676                        
 LA                         Local  9488     I(4)            4           scalar                    9488,9489,9490,9491,9492,9493,9495
                                                                                                  ,9499,9500,9550                   
 LAST                       Scalar 9436     I(4)            4           scalar   COM              9458                              
 LB                         Local  9472     I(4)            4           scalar                    9472,9473,9474,9475,9476,9477,9479
                                                                                                  ,9483,9484,9549                   
 LEVTYP                     Scalar 9399     I(4)            4     1     255      COM              9600,9650,9671,9687               
 LIMS                       Common 9429                                 1776                                                        
 LM                         Local  9459     I(4)            4           scalar                    9459,9461,9462,9463,9464,9468,9471
                                                                                                  ,9472,9474,9475,9479,9487,9488,949
                                                                                                  0,9491,9495,9508,9510,9513,9515,95
                                                                                                  16,9521,9525,9529,9536,9540,9553,9
                                                                                                  554,9563,9564,9567,9568,9580,9582,
                                                                                                  9583,9586,9594,9600,9601,9607,9609
                                                                                                  ,9613,9614,9616,9621,9630,9639,964
                                                                                                  6,9650,9651,9660,9664,9665,9668,96
                                                                                                  69,9671,9672,9680,9682,9684,9685,9
                                                                                                  687,9688                          
 LMAND                      Scalar 9433     I(4)            4     1     22       COM                                                
 LN                         Local  9462     I(4)            4           scalar                    9462,9468,9484,9500,9527,9528,9533
                                                                                                  ,9537,9548,9562,9609,9612,9621,962
                                                                                                  2,9623,9628,9629,9634,9641        
 LSFC                       Scalar 9433     I(4)            4           scalar   COM                                                
 LST                        Scalar 9400     I(4)            4     1     255      COM              9600,9650,9671,9687               
 MAND                       Scalar 9432     I(4)            4           scalar   COM                                                
 MANLEV                     Func   9461     I(4)            4           scalar                    9461                              
 MANRES                     Common 9412                                 2949048                                                     
 NBAS                       Scalar 9410     I(4)            4           scalar   COM                                                
 NEV                        Scalar 9393     I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 9431     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 9408     I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 9410     I(4)            4     1     21       COM                                                
 NLEV                       Scalar 9432     I(4)            4           scalar   COM              9458,9459                         
 NLV                        Scalar 9392     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 9393     I(4)            4           scalar   COM              9487,9489,9521                    
 NLVW                       Scalar 9393     I(4)            4           scalar   COM                                                
 NMANLV                     Func   9462     I(4)            4           scalar                    9462,9472,9488,9609               
 NOBS                       Scalar 9432     I(4)            4           scalar   COM                                                

Page 318         Source Listing                  OBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NQHM                       Scalar 9420     I(4)            4     2     20979    COM                                                
 NQI                        Scalar 9404     I(4)            4     1     255      COM                                                
 NQV                        Scalar 9406     I(4)            4     1     255      COM                                                
 NST                        Param  9387     I(4)            4           scalar                    9391,9392,9393,9400,9409,9412,9413
                                                                                                  ,9414,9415,9416,9417,9418,9419,942
                                                                                                  0,9421,9422,9423,9424,9425,9426,94
                                                                                                  27                                
 NTDHM                      Scalar 9420     I(4)            4     2     20979    COM              9676                              
 NTDI                       Scalar 9404     I(4)            4     1     255      COM              9660                              
 NTDIM                      Scalar 9415     I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 9406     I(4)            4     1     255      COM              9660                              
 NTHM                       Scalar 9418     I(4)            4     2     20979    COM                                                
 NTI                        Scalar 9404     I(4)            4     1     255      COM                                                
 NTIM                       Scalar 9415     I(4)            4     2     20979    COM                                                
 NTL                        Scalar 9406     I(4)            4     1     255      COM              9564,9583                         
 NTTMP                      Scalar 9427     I(4)            4     2     20979    COM                                                
 NTV                        Scalar 9406     I(4)            4     1     255      COM              9521,9525,9540,9554,9568          
 NTVM                       Local  9522     I(4)            4           scalar                    9522,9525,9540,9554,9568          
 NTVP                       Local  9518     I(4)            4           scalar                    9518,9521,9540,9554,9568          
 NZHM                       Scalar 9418     I(4)            4     2     20979    COM                                                
 NZI                        Scalar 9404     I(4)            4     1     255      COM              9613                              
 NZIM                       Scalar 9415     I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 9427     I(4)            4     2     20979    COM                                                
 NZV                        Scalar 9406     I(4)            4     1     255      COM                                                
 OBERR                      Subr   9386                                                                                             
 OBLIM                      Local  9442     R(4)            4     2     4                         9449,9527,9528,9533,9537,9548,9549
                                                                                                  ,9550,9562,9628,9629,9634,9641    
 PARAMS                     Common 9432                                 148                                                         
 PEROR                      Common 9437                                 8                                                           
 PFC                        Scalar 9394     R(4)            4     1     255      COM                                                
 PI                         Scalar 9402     R(4)            4     1     255      COM                                                
 PIS                        Scalar 9423     R(4)            4     1     999      COM                                                
 POB                        Scalar 9394     R(4)            4     1     255      COM              9461,9462,9472,9488,9508,9510,9513
                                                                                                  ,9515,9529,9600,9609,9630,9650,967
                                                                                                  1,9687                            
 POUT                       Scalar 9436     L(4)            4           scalar   COM              9454,9534,9551,9565,9576,9584,9590
                                                                                                  ,9635,9642,9661,9665,9677,9682    
 PQM                        Scalar 9394     R(4)            4     1     255      COM                                                
 PRC                        Scalar 9394     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 9433     L(4)            4           scalar   COM                                                
 PS                         Scalar 9400     R(4)            4     1     999      COM              9508,9510,9513,9515               
 PSCOR                      Scalar 9436     R(4)            4           scalar   COM                                                
 PSINC                      Scalar 9409     R(4)            4           scalar   COM                                                
 PTCOR                      Local  9599     R(4)            4           scalar                    9599,9601                         
 PTDCOR                     Local  9681     R(4)            4           scalar                    9681                              
 PZCOR                      Local  9649     R(4)            4           scalar                    9649,9651                         
 QFC                        Scalar 9398     R(4)            4     1     255      COM                                                
 QG                         Scalar 9422     L(4)            4     2     20979    COM                                                
 QHM                        Scalar 9413     R(4)            4     2     20979    COM                                                
 QI                         Scalar 9402     R(4)            4     1     255      COM                                                
 QIM                        Scalar 9412     R(4)            4     2     20979    COM                                                
 QM                         Local  9507     R(4)            4           scalar                    9507,9538,9541,9544,9555,9558,9569
                                                                                                  ,9572,9577,9587,9591,9598,9601,960
                                                                                                  8,9636,9643,9648,9651,9659,9662,96
                                                                                                  65,9672,9678,9682,9688            

Page 319         Source Listing                  OBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QOB                        Scalar 9398     R(4)            4     1     255      COM              9672,9688                         
 QQM                        Scalar 9398     R(4)            4     1     255      COM              9668,9669,9684,9685               
 QRC                        Scalar 9398     R(4)            4     1     255      COM                                                
 QV                         Scalar 9403     R(4)            4     1     255      COM                                                
 QVM                        Scalar 9414     R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 9432     R(4)            4           scalar   COM                                                
 RESID                      Common 9402                                 41312                                                       
 SDMQ                       Local  9445     L(4)            4           scalar                    9667,9668,9670,9683,9684,9686     
 SEVENT                     Subr   9600                                                           9600,9650,9671,9687               
 SID                        Scalar 9391     CHAR            8     1     999      COM              9451,9600,9650,9671,9687          
 SQN                        Scalar 9392     R(4)            4     1     999      COM              9600,9650,9671,9687               
 STN                        Common 9434                                 4                                                           
 T1                         Scalar 9435     R(4)            4           scalar   COM                                                
 TC                         Local  9535     R(4)            4           scalar                    9535,9552,9566,9579,9585,9593,9600
                                                                                                  ,9601                             
 TCBA                       Local  9491     R(4)            4           scalar                    9491,9495,9501,9529,9550          
 TCBB                       Local  9475     R(4)            4           scalar                    9475,9479,9485,9529,9549          
 TCBEST                     Scalar 9435     R(4)            4     1     2        COM              9464,9468,9529,9532,9533,9537,9547
                                                                                                  ,9548,9561,9562                   
 TCLIM                      Scalar 9431     R(4)            4           scalar   COM                                                
 TCOR                       Scalar 9435     R(4)            4     1     2        COM                                                
 TDFC                       Scalar 9397     R(4)            4     1     255      COM                                                
 TDG                        Scalar 9422     L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 9413     R(4)            4     2     20979    COM                                                
 TDI                        Scalar 9402     R(4)            4     1     255      COM                                                
 TDIM                       Scalar 9412     R(4)            4     2     20979    COM                                                
 TDO                        Scalar 9397     R(4)            4     1     255      COM                                                
 TDQC                       Local  9444     L(4)            4           scalar                    9455,9658                         
 TDV                        Scalar 9403     R(4)            4     1     255      COM                                                
 TDVM                       Scalar 9414     R(4)            4     2     20979    COM                                                
 TEST                       Scalar 9438     L(4)            4           scalar   COM              9451,9529,9630,9665,9682          
 TESTS                      Common 9438                                 4                                                           
 TFACT                      Scalar 9430     R(4)            4     2     84       COM                                                
 TFC                        Scalar 9396     R(4)            4     1     255      COM                                                
 TG                         Scalar 9422     L(4)            4     2     20979    COM                                                
 THM                        Scalar 9413     R(4)            4     2     20979    COM              9465,9476,9492                    
 TI                         Scalar 9402     R(4)            4     1     255      COM              9464,9468,9475,9479,9491,9495     
 TIM                        Scalar 9412     R(4)            4     2     20979    COM                                                
 TIT                        Scalar 9425     R(4)            4     3     83916    COM                                                
 TL                         Scalar 9403     R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 9409     R(4)            4     1     255      COM                                                
 TMPSND                     Common 9424                                 1678336                                                     
 TMPSTD                     Scalar 9430     R(4)            4     2     84       COM              9466,9477,9493,9623               
 TOB                        Scalar 9396     R(4)            4     1     255      COM              9601                              
 TOBT                       Scalar 9424     R(4)            4     3     83916    COM                                                
 TQM                        Scalar 9396     R(4)            4     1     255      COM                                                
 TRC                        Scalar 9396     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 9436     R(4)            4           scalar   COM                                                
 TT                         Scalar 9433     R(4)            4           scalar   COM                                                
 TTMP                       Scalar 9426     R(4)            4     2     20979    COM              9466,9477,9493                    
 TV                         Scalar 9403     R(4)            4     1     255      COM                                                
 TVM                        Scalar 9414     R(4)            4     2     20979    COM                                                
 TVO                        Scalar 9397     R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 9430     R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 9432     R(4)            4           scalar   COM                                                

Page 320         Source Listing                  OBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XDR                        Scalar 9401     R(4)            4     1     255      COM                                                
 XINC                       Scalar 9429     R(4)            4     2     84       COM              9464,9468,9475,9479,9491,9495,9527
                                                                                                  ,9528,9533,9537,9548,9549,9550,956
                                                                                                  2,9621,9628,9629,9634,9641        
 XMA                        Scalar 9432     R(4)            4           scalar   COM                                                
 XMI                        Scalar 9432     R(4)            4           scalar   COM                                                
 XMISS                      Scalar 9439     R(4)            4           scalar   COM              9464,9465,9468,9469,9475,9476,9479
                                                                                                  ,9480,9491,9492,9495,9496,9601,962
                                                                                                  1,9622,9651,9672,9688             
 XOB                        Scalar 9391     R(4)            4     1     999      COM                                                
 XQHM                       Scalar 9421     R(4)            4     2     20979    COM                                                
 XQI                        Scalar 9405     R(4)            4     1     255      COM                                                
 XQIM                       Scalar 9417     R(4)            4     2     20979    COM                                                
 XQV                        Scalar 9407     R(4)            4     1     255      COM                                                
 XTDH                       Scalar 9411     R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 9420     R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 9405     R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 9416     R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 9407     R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 9419     R(4)            4     2     20979    COM                                                
 XTH                        Scalar 9410     R(4)            4     1     255      COM                                                
 XTHM                       Scalar 9419     R(4)            4     2     20979    COM                                                
 XTI                        Scalar 9405     R(4)            4     1     255      COM                                                
 XTIM                       Scalar 9416     R(4)            4     2     20979    COM                                                
 XTV                        Scalar 9407     R(4)            4     1     255      COM                                                
 XTVM                       Scalar 9417     R(4)            4     2     20979    COM                                                
 XZH                        Scalar 9410     R(4)            4     1     255      COM                                                
 XZHM                       Scalar 9418     R(4)            4     2     20979    COM                                                
 XZI                        Scalar 9405     R(4)            4     1     255      COM                                                
 XZIM                       Scalar 9416     R(4)            4     2     20979    COM                                                
 XZV                        Scalar 9407     R(4)            4     1     255      COM                                                
 XZVM                       Scalar 9417     R(4)            4     2     20979    COM                                                
 YDR                        Scalar 9401     R(4)            4     1     255      COM                                                
 YMA                        Scalar 9432     R(4)            4           scalar   COM                                                
 YMI                        Scalar 9432     R(4)            4           scalar   COM                                                
 YOB                        Scalar 9391     R(4)            4     1     999      COM                                                
 ZC                         Local  9638     R(4)            4           scalar                    9638,9645,9650,9651               
 ZCBEST                     Scalar 9435     R(4)            4     1     2        COM              9621,9625,9630,9633,9634,9640,9641
 ZCLIM                      Scalar 9431     R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 9435     R(4)            4     1     2        COM                                                
 ZD                         Scalar 9410     R(4)            4     1     255      COM              9616                              
 ZDIF                       Local  9614     R(4)            4           scalar                    9614,9616                         
 ZFC                        Scalar 9395     R(4)            4     1     255      COM                                                
 ZG                         Scalar 9422     L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 9413     R(4)            4     2     20979    COM              9622                              
 ZI                         Scalar 9402     R(4)            4     1     255      COM              9614,9621                         
 ZIM                        Scalar 9412     R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 9425     R(4)            4     3     83916    COM                                                
 ZOB                        Scalar 9395     R(4)            4     1     255      COM              9651                              
 ZOBT                       Scalar 9424     R(4)            4     3     83916    COM                                                
 ZQM                        Scalar 9395     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 9395     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 9436     R(4)            4           scalar   COM                                                
 ZTMP                       Scalar 9426     R(4)            4     2     20979    COM              9623                              
 ZV                         Scalar 9403     R(4)            4     1     255      COM                                                

Page 321         Source Listing                  OBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZVM                        Scalar 9414     R(4)            4     2     20979    COM                                                

Page 322         Source Listing                  OBERR
2017-04-18 11:07                                 cqcbufr.f

   9698 
   9699 C**********************************************************************
   9700 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9701 C                .      .    .                                       .
   9702 C SUBPROGRAM:    OUTPUT      COMPLETE WRITING TO OUTPUT PREPBUFR FILE
   9703 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   9704 C
   9705 C ABSTRACT: Complete writing to output PREPBUFR file.  At the end of
   9706 C   all stations, also close the output file.
   9707 C
   9708 C PROGRAM HISTORY LOG:
   9709 C 1997-03-18  W. Collins  Original author.
   9710 C
   9711 C USAGE:    CALL OUTPUT(ENDIN,SINGLE)
   9712 C   INPUT ARGUMENT LIST:
   9713 C     ENDIN    - TRUE AT END OF INPUT
   9714 C     SINGLE   - TRUE FOR SINGLE-STATION VERSION
   9715 C
   9716 C   OUTPUT FILES:
   9717 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   9718 C
   9719 C REMARKS: NONE.
   9720 C
   9721 C ATTRIBUTES:
   9722 C   LANGUAGE: FORTRAN 90
   9723 C   MACHINE:  NCEP WCOSS
   9724 C
   9725 C$$$
   9726 
   9727       SUBROUTINE OUTPUT(ENDIN,SINGLE)
   9728       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
   9729       COMMON /TESTS/   TEST
   9730       LOGICAL          TEST
   9731       LOGICAL ENDIN,SINGLE, PRNT, HGTTBL
   9732 
   9733       IF(.NOT.SINGLE .AND. .NOT.ENDIN) THEN
   9734         CALL WRITSB(NFOUT)
   9735         IF(TEST) WRITE(60,500)
   9736   500   FORMAT(' OUTPUT--WRITSB CALLED')
   9737       ENDIF
   9738 
   9739       IF(ENDIN) CALL CLOSBF(NFOUT)
   9740 
   9741       RETURN
   9742       END

Page 323         Source Listing                  OUTPUT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 output_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  9736                                                           9735                              
 CLOSBF                     Subr   9739                                                           9739                              
 ENDIN                      Dummy  9727     L(4)            4           scalar   ARG,INOUT        9733,9739                         
 FILES                      Common 9728                                 24                                                          
 HGTTBL                     Local  9731     L(4)            4           scalar                                                      
 NFEVN                      Scalar 9728     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 9728     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 9728     I(4)            4           scalar   COM              9734,9739                         
 NFSGL                      Scalar 9728     I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 9728     I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 9728     I(4)            4           scalar   COM                                                
 OUTPUT                     Subr   9727                                                                                             
 PRNT                       Local  9731     L(4)            4           scalar                                                      
 SINGLE                     Dummy  9727     L(4)            4           scalar   ARG,INOUT        9733                              
 TEST                       Scalar 9729     L(4)            4           scalar   COM              9735                              
 TESTS                      Common 9729                                 4                                                           
 WRITSB                     Subr   9734                                                           9734                              

Page 324         Source Listing                  OUTPUT
2017-04-18 11:07                                 cqcbufr.f

   9743 
   9744 C****************************************************************
   9745 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9746 C                .      .    .                                       .
   9747 C SUBPROGRAM:    PATZ        FIND PRESSURE AT GIVEN HEIGHT
   9748 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1995-12-18
   9749 C
   9750 C ABSTRACT: FIND THE PRESSURE AT A GIVEN HEIGHT.  THERE ARE THREE
   9751 C   POSSIBLE METHODS USED, AS DESCRIBED BELOW.
   9752 C
   9753 C PROGRAM HISTORY LOG:
   9754 C 1995-12-18  W. Collins  Original author.
   9755 C
   9756 C USAGE:    CALL PATZ(P1,P2,P3,Z1,Z2,Z3,T1C,T3C,ALPHA,METHOD)
   9757 C   INPUT ARGUMENT LIST:
   9758 C     P1       - PRESSURE FOR METHODS 1 AND 2.          (HPA)
   9759 c     P3       - PRESSURE FOR METHODS 1 AND 2.          (HPA)
   9760 C     Z1       - HEIGHT FOR METHODS 1 AND 2.            (M)
   9761 C     Z2       - HEIGHT AT WHICH PRESSURE IS NEEDED     (M)
   9762 C     Z3       - OPTIONAL SECOND HEIGHT FOR METHODS
   9763 C                1 AND 2.                               (M)
   9764 C     T1C      - TEMPERATURE FOR METHODS 1 AND 2.       (DEG-C)
   9765 C     T3C      - TEMPERATURE FOR METHODS 1 AND 2.       (DEG-C)
   9766 C     ALPHA    - LAPSE RATE, EITHER SPECIFIED OR
   9767 C                CALCULATED IF MISSING.
   9768 C                FOR METHOD 1:  (DELTA-T/DELTA(LN(P))
   9769 C                FOR METHOD 2:  (DELTA-T/DELTA-Z)
   9770 C     METHOD   - DETERMINES WHICH SOLUTION METHOD TO USE.
   9771 C
   9772 C   OUTPUT ARGUMENT LIST:
   9773 C     P2       - PRESSURE AT GIVEN HEIGHT (Z2)          (HPA)
   9774 C
   9775 C OUTPUT FILES:
   9776 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   9777 C
   9778 C REMARKS: NONE.
   9779 C
   9780 C ATTRIBUTES:
   9781 C   LANGUAGE: FORTRAN 90
   9782 C   MACHINE:  NCEP WCOSS
   9783 C
   9784 C$$$
   9785 
   9786       SUBROUTINE PATZ(P1,P2,P3,Z1,Z2,Z3,T1C,T3C,ALPHA,METHOD)
   9787 
   9788       REAL(8) BMISS
   9789 
   9790       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   9791 
   9792 C     Find the pressure (P2) at a given height, Z2, using available
   9793 C     information at levels 1 and 3.  Z2 must always be non-missing.
   9794 C     P1, T1C, Z1 must always be non-missing in addition for methods
   9795 C     1 and 2.  Several cases are possible.  The methods are:
   9796 C       METHOD = 1
   9797 C            Assume T linear in ln(pressure).
   9798 C            Calculate ALPHA (lapse rate wrt ln(p)) if (P3,T3C) are
   9799 C            non-missing, otherwise ALPHA must be specified on input.

Page 325         Source Listing                  PATZ
2017-04-18 11:07                                 cqcbufr.f

   9800 C       METHOD = 2
   9801 C            Assume T linear in height.
   9802 C            Calculate ALPHA (lapse rate wrt z) if (P3,Z3) are
   9803 C            non-missing, otherwise ALPHA must be specified on input.
   9804 C       METHOD = 3
   9805 C            Use U.S. Standard Atmosphere pressure at Z2.
   9806 
   9807       DATA G /9.80665/, R /287.05/, T0 /273.15/
   9808       DATA C0 /234.51/, C1 /10769.23/, C4 /.190284/, C5 /-33538.5/
   9809 
   9810 C     WRITE(60,500) p1,p2,p3,z1,z2,z3,t1c,t3c,alpha,method
   9811   500 format(' PATZ--(begin)p1,p2,p3,z1,z2,z3,t1c,t3c,alpha,method: ',
   9812      &  8f8.1,f8.5,1x,i2)
   9813 
   9814 
   9815       IF(Z2.GT.0.5*BMISS) RETURN
   9816       IF(P1.NE.BMISS .AND. Z1.NE.BMISS .AND. Z2.EQ.Z1) THEN
   9817         P2 = P1
   9818         RETURN
   9819       ENDIF
   9820 
   9821       P2 = BMISS
   9822       GOR = G/R
   9823       T1 = T1C + T0
   9824       T3 = T3C + T0
   9825 
   9826       IF(METHOD.NE.3 .AND. (P1.EQ.BMISS.OR.T1C.EQ.BMISS.OR.Z1.EQ.BMISS))
   9827      &  METHOD = 3
   9828       IF(METHOD.EQ.2 .AND. (Z1.EQ.BMISS.OR.Z2.EQ.BMISS.OR.Z3.EQ.BMISS))
   9829      &  METHOD = 3
   9830 
   9831       IF(METHOD.EQ.1) THEN
   9832         IF(P3.NE.BMISS .AND. T3C.NE.BMISS) THEN
   9833           P1L = LOG(P1)
   9834           P3L = LOG(P3)
   9835           IF(P3L.NE.P1L) THEN
   9836             ALPHA = (T3-T1)/(P3L-P1L)
   9837           ELSE
   9838             ALPHA = 0.
   9839           ENDIF
   9840         ELSE
   9841 C         ALPHA is specified on input.
   9842           IF(ALPHA.EQ.BMISS) RETURN
   9843         ENDIF
   9844         IF(ALPHA.GT.0. .AND.
   9845      &    ((T1/ALPHA)**2 - (2*GOR/ALPHA) * (Z2-Z1)).GT.0.) THEN
   9846           P2L = P1L - (T1/ALPHA) + SQRT((T1/ALPHA)**2
   9847      &          - (2*GOR/ALPHA) * (Z2-Z1))
   9848         ELSEIF(ALPHA.LT.0. .AND.
   9849      &    ((T1/ALPHA)**2 - (2*GOR/ALPHA) * (Z2-Z1)).GT.0.) THEN
   9850           P2L = P1L - (T1/ALPHA) -SQRT((T1/ALPHA)**2
   9851      &          - (2*GOR/ALPHA) * (Z2-Z1))
   9852         ELSE
   9853           P2L = P1L - (GOR/T1) * (Z2-Z1)
   9854         ENDIF
   9855         P2 = EXP(P2L)
   9856 

Page 326         Source Listing                  PATZ
2017-04-18 11:07                                 cqcbufr.f

   9857       ELSEIF(METHOD.EQ.2) THEN
   9858         IF(P3.NE.BMISS .AND. Z3.NE.BMISS) THEN
   9859           IF(Z3.NE.Z1) THEN
   9860             ALPHA = (T3-T1)/(Z3-Z1)
   9861           ELSE
   9862             ALPHA = 0.
   9863           ENDIF
   9864         ELSE
   9865 C         ALPHA is specified on input.
   9866           IF(ALPHA.EQ.BMISS) RETURN
   9867         ENDIF
   9868         P2 = P1 * ((T1+ALPHA*Z2) / (T1+ALPHA*Z1))**(-GOR)
   9869 
   9870       ELSEIF(METHOD.EQ.3 .AND. Z2.NE.BMISS) THEN
   9871         IF(Z2.LT.C1) THEN
   9872           P2 = C0 * EXP(LOG((Z2-C1)/C5 + 1.)/C4)
   9873         ELSE
   9874           P2 = C0 * EXP((Z2-C1)/(C4*C5))
   9875         ENDIF
   9876       ENDIF
   9877 
   9878 C     WRITE(60,501) p1,p2,p3,z1,z2,z3,t1c,t3c,alpha,method
   9879   501 format(' PATZ--(end)p1,p2,p3,z1,z2,z3,t1c,t3c,alpha,method: ',
   9880      &  8f8.1,f8.5,1x,i2)
   9881 
   9882       RETURN
   9883       END


ENTRY POINTS

  Name             
                   
 patz_             

Page 327         Source Listing                  PATZ
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  9811                                                                                             
 501                        Label  9879                                                                                             
 ALPHA                      Dummy  9786     R(4)            4           scalar   ARG,INOUT        9836,9838,9842,9844,9845,9846,9847
                                                                                                  ,9848,9849,9850,9851,9860,9862,986
                                                                                                  6,9868                            
 BMISS                      Scalar 9788     R(8)            8           scalar   COM              9815,9816,9821,9826,9828,9832,9842
                                                                                                  ,9858,9866,9870                   
 BUFRLIB_MISSING            Common 9790                                 16                                                          
 C0                         Local  9808     R(4)            4           scalar                    9808,9872,9874                    
 C1                         Local  9808     R(4)            4           scalar                    9808,9871,9872,9874               
 C4                         Local  9808     R(4)            4           scalar                    9808,9872,9874                    
 C5                         Local  9808     R(4)            4           scalar                    9808,9872,9874                    
 EXP                        Func   9855                                 scalar                    9855,9872,9874                    
 G                          Local  9807     R(4)            4           scalar                    9807,9822                         
 GOR                        Local  9822     R(4)            4           scalar                    9822,9845,9847,9849,9851,9853,9868
 IMISS                      Scalar 9790     I(4)            4           scalar   COM                                                
 LOG                        Func   9833                                 scalar                    9833,9834,9872                    
 METHOD                     Dummy  9786     I(4)            4           scalar   ARG,INOUT        9826,9827,9828,9829,9831,9857,9870
 P1                         Dummy  9786     R(4)            4           scalar   ARG,INOUT        9816,9817,9826,9833,9868          
 P1L                        Local  9833     R(4)            4           scalar                    9833,9835,9836,9846,9850,9853     
 P2                         Dummy  9786     R(4)            4           scalar   ARG,INOUT        9817,9821,9855,9868,9872,9874     
 P2L                        Local  9846     R(4)            4           scalar                    9846,9850,9853,9855               
 P3                         Dummy  9786     R(4)            4           scalar   ARG,INOUT        9832,9834,9858                    
 P3L                        Local  9834     R(4)            4           scalar                    9834,9835,9836                    
 PATZ                       Subr   9786                                                                                             
 R                          Local  9807     R(4)            4           scalar                    9807,9822                         
 SQRT                       Func   9846                                 scalar                    9846,9850                         
 T0                         Local  9807     R(4)            4           scalar                    9807,9823,9824                    
 T1                         Local  9823     R(4)            4           scalar                    9823,9836,9845,9846,9849,9850,9853
                                                                                                  ,9860,9868                        
 T1C                        Dummy  9786     R(4)            4           scalar   ARG,INOUT        9823,9826                         
 T3                         Local  9824     R(4)            4           scalar                    9824,9836,9860                    
 T3C                        Dummy  9786     R(4)            4           scalar   ARG,INOUT        9824,9832                         
 XMISS                      Scalar 9790     R(4)            4           scalar   COM                                                
 Z1                         Dummy  9786     R(4)            4           scalar   ARG,INOUT        9816,9826,9828,9845,9847,9849,9851
                                                                                                  ,9853,9859,9860,9868              
 Z2                         Dummy  9786     R(4)            4           scalar   ARG,INOUT        9815,9816,9828,9845,9847,9849,9851
                                                                                                  ,9853,9868,9870,9871,9872,9874    
 Z3                         Dummy  9786     R(4)            4           scalar   ARG,INOUT        9828,9858,9859,9860               

Page 328         Source Listing                  PATZ
2017-04-18 11:07                                 cqcbufr.f

   9884 
   9885 C******************************************************************
   9886 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9887 C                .      .    .                                       .
   9888 C SUBPROGRAM:    PEVENTS     PRINT EVENTS
   9889 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   9890 C
   9891 C ABSTRACT: Print events.
   9892 C
   9893 C PROGRAM HISTORY LOG:
   9894 C 1997-03-18  W. Collins  Original author.
   9895 C
   9896 C USAGE:    CALL PEVENTS
   9897 C   OUTPUT FILES:
   9898 C     UNIT 06  - PRINTOUT
   9899 C     NFEVN    - UNIT NUMBER OF FILE CONTAINING PRINTOUT OF ALL EVENTS
   9900 C
   9901 C REMARKS: NONE.
   9902 C
   9903 C ATTRIBUTES:
   9904 C   LANGUAGE: FORTRAN 90
   9905 C   MACHINE:  NCEP WCOSS
   9906 C
   9907 C$$$
   9908 
   9909       SUBROUTINE PEVENTS
   9910 
   9911       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
   9912      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
   9913      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
   9914      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
   9915      &                 BASR(2000),   PISR(2000),  PSINCR(2000),
   9916      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
   9917       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
   9918 
   9919       CHARACTER*2     CVAR(5)
   9920       CHARACTER*8     STN
   9921       CHARACTER*10    EDATE
   9922       DATA CVAR/' P',' Z',' T','TD',' Q'/
   9923 
   9924       WRITE(6,500)
   9925       DO I=1,IEVENT
   9926         IF(QMARK(I).LT.3) THEN
   9927           OVAL = CORVAL(I) - COR(I)
   9928         ELSE
   9929           OVAL = CORVAL(I)
   9930         ENDIF
   9931         IF(MOD(I-1,10).EQ.0) WRITE(6,501)
   9932         WRITE(6,502) STN(I),EDATE(I),SEQN(I),ISCAN(I),LEVL(I),
   9933      &    PRES(I),LTYP(I),LSTYP(I),CVAR(IVAR(I)),OVAL,
   9934      &    COR(I),CORVAL(I),PCOR(I),QMARK(I),IETYP(I),BASR(I),
   9935      &    PISR(I),PSINCR(I)
   9936         WRITE(NFEVN,502) STN(I),EDATE(I),SEQN(I),ISCAN(I),LEVL(I),
   9937      &    PRES(I),LTYP(I),LSTYP(I),CVAR(IVAR(I)),OVAL,
   9938      &    COR(I),CORVAL(I),PCOR(I),QMARK(I),IETYP(I),BASR(I),
   9939      &    PISR(I),PSINCR(I)
   9940       ENDDO

Page 329         Source Listing                  PEVENTS
2017-04-18 11:07                                 cqcbufr.f

   9941 
   9942   500 FORMAT(///' EVENTS--')
   9943   501 FORMAT('   STN          DATE  SQN  SCAN LEVEL  PRESSURE LEVTYP',
   9944      &       ' SFCTYP VAR  ORIG-VAL       COR   NEW-VAL  ORIG-COR',
   9945      &       ' QMARK IETYP BAS-RES  PS-INC  PS-RES')
   9946   502 FORMAT(1X,A8,1X,A10,F6.0,I5,I6,F10.1,2I7,2X,A2,4F10.1,F6.0,I6,
   9947      &  3(1X,F7.1))
   9948 
   9949       RETURN
   9950       END


ENTRY POINTS

  Name                
                      
 pevents_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  9942                                                           9924                              
 501                        Label  9943                                                           9931                              
 502                        Label  9946                                                           9932,9936                         
 BASR                       Scalar 9915     R(4)            4     1     2000     COM              9934,9938                         
 COR                        Scalar 9913     R(4)            4     1     2000     COM              9927,9934,9938                    
 CORVAL                     Scalar 9913     R(4)            4     1     2000     COM              9927,9929,9934,9938               
 CVAR                       Local  9919     CHAR            2     1     5                         9922,9933,9937                    
 EDATE                      Scalar 9916     CHAR            10    1     2000     COM              9932,9936                         
 EVENTS                     Common 9911                                 156004                                                      
 FILES                      Common 9917                                 24                                                          
 I                          Local  9925     I(4)            4           scalar                    9925,9926,9927,9929,9931,9932,9933
                                                                                                  ,9934,9935,9936,9937,9938,9939    
 IETYP                      Scalar 9916     I(4)            4     1     2000     COM              9934,9938                         
 IEVENT                     Scalar 9914     I(4)            4           scalar   COM              9925                              
 ISCAN                      Scalar 9911     I(4)            4     1     2000     COM              9932,9936                         
 IVAR                       Scalar 9913     I(4)            4     1     2000     COM              9933,9937                         
 LEVL                       Scalar 9912     I(4)            4     1     2000     COM              9932,9936                         
 LSTYP                      Scalar 9914     I(4)            4     1     2000     COM              9933,9937                         
 LTYP                       Scalar 9912     I(4)            4     1     2000     COM              9933,9937                         
 MOD                        Func   9931                                 scalar                    9931                              
 NFEVN                      Scalar 9917     I(4)            4           scalar   COM              9936                              
 NFIN                       Scalar 9917     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 9917     I(4)            4           scalar   COM                                                
 NFSGL                      Scalar 9917     I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 9917     I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 9917     I(4)            4           scalar   COM                                                
 OVAL                       Local  9927     R(4)            4           scalar                    9927,9929,9933,9937               
 PCOR                       Scalar 9914     R(4)            4     1     2000     COM              9934,9938                         
 PEVENTS                    Subr   9909                                                                                             
 PISR                       Scalar 9915     R(4)            4     1     2000     COM              9935,9939                         
 PRES                       Scalar 9912     R(4)            4     1     2000     COM              9933,9937                         
 PSINCR                     Scalar 9915     R(4)            4     1     2000     COM              9935,9939                         
 QMARK                      Scalar 9916     R(4)            4     1     2000     COM              9926,9934,9938                    
 SEQN                       Scalar 9911     R(4)            4     1     2000     COM              9932,9936                         

Page 330         Source Listing                  PEVENTS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 STN                        Scalar 9911     CHAR            8     1     2000     COM              9932,9936                         

Page 331         Source Listing                  PEVENTS
2017-04-18 11:07                                 cqcbufr.f

   9951 
   9952 C******************************************************************
   9953 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9954 C                .      .    .                                       .
   9955 C SUBPROGRAM:    POBERR      FIND OBSERVATION ERRORS AT TOP OF PROFILE
   9956 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1998-08-21
   9957 C
   9958 C ABSTRACT: Find data with observation errors in height, temperature
   9959 C   at some level and persisting vertically.  In such cases, it
   9960 C   assumed that the temperature sensor has gone bad and all levels of
   9961 C   temperature and height above should be rejected.
   9962 C
   9963 C PROGRAM HISTORY LOG:
   9964 C 1998-08-21  W. Collins  Original author.
   9965 C
   9966 C USAGE:    CALL POBERR
   9967 C   OUTPUT FILES:
   9968 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
   9969 C
   9970 C REMARKS: NONE.
   9971 C
   9972 C ATTRIBUTES:
   9973 C   LANGUAGE: FORTRAN 90
   9974 C   MACHINE:  NCEP WCOSS
   9975 C
   9976 C$$$
   9977 
   9978       SUBROUTINE POBERR
   9979       PARAMETER (NST=999)
   9980 
   9981       REAL(8) BMISS
   9982 
   9983       COMMON /REGION/  AVGIY(21,2,28), STDIY(21,2,28)
   9984       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   9985      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   9986      &                 NEV, ISF(NST), NLVM, NLVW
   9987       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   9988      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   9989      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   9990      &                 TDO(255), TDFC(255),TVO(255),
   9991      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   9992      &                 CAT(255), IND(255), LEVTYP(255),
   9993      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   9994      &                 YDR(255), XDR(255)
   9995       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
   9996      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
   9997      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
   9998      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
   9999      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  10000      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  10001      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  10002      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  10003      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  10004      &                 XTDH(255)
  10005       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  10006      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  10007       COMMON /PEROR/  ISERR, ISOBERR

Page 332         Source Listing                  POBERR
2017-04-18 11:07                                 cqcbufr.f

  10008       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  10009      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  10010       COMMON /ISO/     IDISO(NST),NUM,ISISO
  10011       COMMON /STN/     IS
  10012       COMMON /NO40S/   NORD23, WRT23
  10013       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  10014 
  10015       LOGICAL          WRT23
  10016       COMMON /TESTS/   TEST
  10017       REAL             TLO(21), THI(21), ZLO(21), ZHI(21)
  10018       REAL             TLO0(21), THI0(21), ZLO0(21), ZHI0(21)
  10019       LOGICAL          TEST, POUT, ISOBERR, TBAD(255), ZBAD(255)
  10020       LOGICAL          ISISO, NORD23
  10021       CHARACTER*8      SID
  10022       DATA TLO0/-6.7,-5.6,-4.8,-3.3,-2.4,-2.6,-2.8,-3.4,
  10023      &  -3.4,-3.2,-3.4,-3.6,-3.8,-3.6,-4.4,6*-5.8/
  10024       DATA THI0/0.9,1.6,2.0,2.3,2.4,2.6,2.8,3.4,
  10025      &  3.4,3.2,3.4,3.6,3.8,3.6,4.4,6*5.8/
  10026       DATA ZLO0/-29.,-24.,-21.,-23.,-28.,-31.,-37.,-42.,
  10027      &  -51.,-63.,-76.,-77.,-72.,-74.,-86.,-121.,5*-150./
  10028       DATA ZHI0/33.,25.,23.,28.,39.,47.,56.,63.,
  10029      &  74.,90.,118.,126.,133.,162.,178.,223.,5*250./
  10030       DATA TLIMIT /0.65/, ZLIMIT /0.75/, STDNUM /2.5/
  10031 
  10032 !
  10033 !  SKIP THIS SUBROUTINE IF UNIT23 IS EMPTY
  10034 !
  10035       IF(NORD23) RETURN
  10036 !
  10037 !  GET WMO BLOCK FOR DECISIONS TO BE MADE LATER
  10038 !
  10039       IBL = 0
  10040       READ(SID(IS),'(I5)',ERR=100) IDENT
  10041       IBL = IDENT/1000
  10042 !
  10043 !  DO NOT DIAGNOSE TYPE 40'S FOR ISOLATED STATIONS
  10044 !
  10045       DO I=1,NUM
  10046         IF(IDENT.EQ.IDISO(I)) RETURN
  10047       ENDDO
  10048   100 CONTINUE
  10049 
  10050       POUT = .FALSE.
  10051       ISOBERR = .FALSE.
  10052 
  10053       DO L=1,255
  10054         TBAD(L) = .FALSE.
  10055         ZBAD(L) = .FALSE.
  10056       ENDDO
  10057 
  10058       CALL AREA(IA,XOB(IS),YOB(IS))
  10059 
  10060       IF(IA.NE.0) THEN
  10061         DO L=1,21
  10062           ZLO(L) = AVGIY(L,1,IA) - STDNUM * STDIY(L,1,IA)
  10063           TLO(L) = AVGIY(L,2,IA) - STDNUM * STDIY(L,2,IA)
  10064           ZHI(L) = AVGIY(L,1,IA) + STDNUM * STDIY(L,1,IA)

Page 333         Source Listing                  POBERR
2017-04-18 11:07                                 cqcbufr.f

  10065           THI(L) = AVGIY(L,2,IA) + STDNUM * STDIY(L,2,IA)
  10066         ENDDO
  10067       ELSE
  10068         DO L=1,21
  10069           ZLO(L) = ZLO0(L)
  10070           TLO(L) = TLO0(L)
  10071           ZHI(L) = ZHI0(L)
  10072           THI(L) = THI0(L)
  10073           WRITE(60,515) SID(IS),XOB(IS),YOB(IS)
  10074   515     FORMAT(' POBERR--DEFAULT STATISTICS USED FOR ',A8,' WITH',
  10075      &      ' (LAT,LON) = ',2F8.2)
  10076         ENDDO
  10077       ENDIF
  10078 
  10079       DO LM=1,NLEV
  10080         LN = NMANLV(POB(LM))    ! INDEX OF NEAREST MAND LVL
  10081         IF(TI(LM).NE.BMISS .AND.
  10082      &    (TI(LM).LT.TLO(LN) .OR. TI(LM).GT.THI(LN))) TBAD(LM) = .TRUE.
  10083         IF(ZI(LM).NE.BMISS .AND.
  10084      &    (ZI(LM).LT.ZLO(LN) .OR. ZI(LM).GT.ZHI(LN))) ZBAD(LM) = .TRUE.
  10085       ENDDO
  10086       IF(TEST) WRITE(60,500) SID(IS),(TBAD(L),L=1,NLEV)
  10087       IF(TEST) WRITE(60,501)         (ZBAD(L),L=1,NLEV)
  10088   500 FORMAT(' POBERR--STN: ',A8,' TBAD: ',(25(L1,1X),/))
  10089   501 FORMAT('              ',8X,' ZBAD: ',(25(L1,1X),/))
  10090 !
  10091 !  FIND LOWEST LEVEL OF TEMPERATURE WITH TLIMIT AMOUNT OF
  10092 !  TEMPERATURE INCREMENTS ABOVE THAT EXCEED LIMITS TLO OR THI.
  10093 !  HOWEVER, ONLY CHECK INCREMENTS AT OR ABOVE GROUND
  10094 !
  10095       TRAT   = 0.
  10096       LOWT   = 0
  10097       LEVCNT = 0
  10098       LEVBAD = 0
  10099       DO LM=1,NLEV
  10100         IF(TBAD(LM) .AND. POB(LM).LE.PS(IS)) THEN
  10101           LEVCNT = 1
  10102           LEVBAD = 1
  10103           DO L=LM+1,NLEV
  10104             IF(TI(L).NE.BMISS) LEVCNT = LEVCNT + 1
  10105             IF(TBAD(L))        LEVBAD = LEVBAD + 1
  10106           ENDDO
  10107           TRAT = REAL(LEVBAD)/REAL(LEVCNT)
  10108           IF(TRAT.GE.TLIMIT) THEN
  10109             LOWT = LM
  10110             GOTO 10
  10111           ENDIF
  10112         ENDIF
  10113       ENDDO
  10114    10 CONTINUE
  10115       IF(TEST) WRITE(60,503) LEVCNT,LEVBAD,TRAT,LOWT
  10116   503 FORMAT(' POBERR--LEVCNT,LEVBAD,TRAT,LOWT: ',2I5,F8.3,I5)
  10117 !
  10118 !  FIND LOWEST LEVEL OF HEIGHT WITH ZLIMIT AMOUNT OF
  10119 !  HEIGHT INCREMENTS ABOVE THAT EXCEED LIMITS ZLO OR ZHI.
  10120 !  HOWEVER, ONLY CHECK INCREMENTS AT OR ABOVE GROUND
  10121 !  AND DO NOT ALLOW LOWZ TO BE AT UPPERMOST HEIGHT LEVEL.

Page 334         Source Listing                  POBERR
2017-04-18 11:07                                 cqcbufr.f

  10122 !
  10123       LOWZ = 0
  10124       ZRAT = 0
  10125       DO LM=1,NLEV
  10126         IF(ZBAD(LM) .AND. POB(LM).LE.PS(IS)) THEN
  10127           LEVCNT = 1
  10128           LEVBAD = 1
  10129           DO L=LM+1,NLEV
  10130             IF(ZI(L).NE.BMISS) LEVCNT = LEVCNT + 1
  10131             IF(ZBAD(L))        LEVBAD = LEVBAD + 1
  10132           ENDDO
  10133           ZRAT = REAL(LEVBAD)/REAL(LEVCNT)
  10134           IF(ZRAT.GE.ZLIMIT) THEN
  10135             LOWZ = LM
  10136             DO L=LOWZ+1,NLEV
  10137               IF(ZI(L).NE.BMISS) GOTO 20
  10138             ENDDO
  10139             LOWZ = 0
  10140             GOTO 20
  10141           ENDIF
  10142         ENDIF
  10143       ENDDO
  10144    20 CONTINUE
  10145       IF(TEST) WRITE(60,504) LEVCNT,LEVBAD,ZRAT,LOWZ
  10146   504 FORMAT(' POBERR--LEVCNT,LEVBAD,ZRAT,LOWZ: ',2I5,F8.3,I5)
  10147 !
  10148 !  SEE IF THERE ARE BAD T-S OR Z-S
  10149 !
  10150       IF(LOWT.NE.0 .AND. LOWZ.NE.0) THEN
  10151         IF(LOWT.EQ.LOWZ) THEN
  10152           IER = 43
  10153         ELSEIF(LOWT.LT.LOWZ) THEN
  10154           IER = 42
  10155         ELSE
  10156           IER = 41
  10157         ENDIF
  10158         LOW = MIN(LOWT,LOWZ)
  10159       ELSEIF(LOWT.NE.0) THEN
  10160         LOW = LOWT
  10161         IER = 42
  10162       ELSEIF(LOWZ.NE.0) THEN
  10163         LOW = LOWZ
  10164         IER = 41
  10165       ELSE
  10166         LOW = 0
  10167       ENDIF
  10168 !
  10169 !  DO NOT FLAG LESS THAN 3 LEVELS; LET OBERR DO THE JOB
  10170 !
  10171       IF(NLEV-LOW.LT.2) LOW = 0
  10172 !
  10173 !  IF LOW.NE.0 THEN Z AND T ARE BAD FROM LEVEL LOW TO TOP
  10174 !  WRITE EVENTS
  10175 !
  10176       IF(IBL.EQ.42 .OR. IBL.EQ.43) THEN
  10177         QM = 13.
  10178       ELSE

Page 335         Source Listing                  POBERR
2017-04-18 11:07                                 cqcbufr.f

  10179         IF(TEST) THEN
  10180 ! DAK: This is the place in this code where TEST=T will actually encode
  10181 !      additional events in the output PREPBUFR file even though it is
  10182 !      mean to only add additional daignostic print!!
  10183           QM = 2.    ! This allows diagnosis of errors
  10184         ELSE
  10185           RETURN
  10186         ENDIF
  10187       ENDIF
  10188       TC = 0.
  10189       ZC = 0.
  10190       PTCOR = 0.
  10191       PZCOR = 0.
  10192       IF(LOW.NE.0) THEN
  10193         POUT = .TRUE.
  10194         ISOBERR = .TRUE.
  10195         IF(TEST) WRITE(60,502) SID(IS),LOW
  10196   502   FORMAT(' POBERR--BAD T AND Z FOR STATION ',A8,
  10197      &    ', BEGINNING AT LEVEL ',I3)
  10198         DO L=LOW,NLEV
  10199           IHSC(3,L) = IER
  10200           IHSC(2,L) = IER
  10201           IF(TOB(L).NE.BMISS) THEN
  10202             CALL SEVENT(SID(IS),SQN(IS),L,LST(L),POB(L),LEVTYP(L),3,
  10203      &        TC,TOB(L)+TC,PTCOR,QM,IHSC(3,L),XMISS,XMISS,XMISS)
  10204           ENDIF
  10205           IF(ZOB(L).NE.BMISS) THEN
  10206             CALL SEVENT(SID(IS),SQN(IS),L,LST(L),POB(L),LEVTYP(L),2,
  10207      &        ZC,ZOB(L)+ZC,PZCOR,QM,IHSC(2,L),XMISS,XMISS,XMISS)
  10208           ENDIF
  10209         ENDDO
  10210       ENDIF
  10211 
  10212       RETURN
  10213       END

Page 336         Source Listing                  POBERR
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 poberr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  10114                                                          10110                             
 100                        Label  10048                                                          10040                             
 20                         Label  10144                                                          10137,10140                       
 500                        Label  10088                                                          10086                             
 501                        Label  10089                                                          10087                             
 502                        Label  10196                                                          10195                             
 503                        Label  10116                                                          10115                             
 504                        Label  10146                                                          10145                             
 515                        Label  10074                                                          10073                             
 ALLSND                     Common 9987                                 34512                                                       
 AREA                       Subr   10058                                                          10058                             
 AVGIY                      Scalar 9983     R(4)            4     3     1176     COM              10062,10063,10064,10065           
 B                          Scalar 10003    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 10002    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 9981     R(8)            8           scalar   COM              10081,10083,10104,10130,10137,1020
                                                                                                  1,10205                           
 BUFRLIB_MISSING            Common 10013                                16                                                          
 CAT                        Scalar 9992     R(4)            4     1     255      COM                                                
 CQCPC                      Scalar 10009    R(4)            4           scalar   COM                                                
 DHR                        Scalar 9984     R(4)            4     1     999      COM                                                
 ELV                        Scalar 9985     R(4)            4     1     999      COM                                                
 GESPS                      Scalar 9993     R(4)            4     1     999      COM                                                
 H1                         Scalar 10005    R(4)            4           scalar   COM                                                
 H2                         Scalar 10005    R(4)            4           scalar   COM                                                
 HEADER                     Common 9984                                 35980                                                       
 HRDR                       Scalar 9993     R(4)            4     1     255      COM                                                
 HYD                        Scalar 10001    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 10001    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 10001    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 10001    R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 10005                                64                                                          
 I                          Local  10045    I(4)            4           scalar                    10045,10046                       
 IA                         Local  10058    I(4)            4           scalar                    10058,10060,10062,10063,10064,1006
                                                                                                  5                                 
 IBL                        Local  10039    I(4)            4           scalar                    10039,10041,10176                 
 IDENT                      Local  10040    I(4)            4           scalar                    10040,10041,10046                 
 IDISO                      Scalar 10010    I(4)            4     1     999      COM              10046                             
 IER                        Local  10152    I(4)            4           scalar                    10152,10154,10156,10161,10164,1019
                                                                                                  9,10200                           
 IHSC                       Scalar 10002    I(4)            4     2     1020     COM              10199,10200,10203,10207           
 IMISS                      Scalar 10013    I(4)            4           scalar   COM                                                
 IND                        Scalar 9992     I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 10009    I(4)            4           scalar   COM                                                
 IS                         Scalar 10011    I(4)            4           scalar   COM              10040,10058,10073,10086,10100,1012

Page 337         Source Listing                  POBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  6,10195,10202,10206               
 ISC                        Scalar 10009    I(4)            4           scalar   COM                                                
 ISERR                      Scalar 10007    I(4)            4           scalar   COM                                                
 ISF                        Scalar 9986     I(4)            4     1     999      COM                                                
 ISISO                      Scalar 10010    L(4)            4           scalar   COM                                                
 ISO                        Common 10010                                4004                                                        
 ISOBERR                    Scalar 10007    L(4)            4           scalar   COM              10051,10194                       
 ITP                        Scalar 9985     I(4)            4     1     999      COM                                                
 L                          Local  10053    I(4)            4           scalar                    10053,10054,10055,10061,10062,1006
                                                                                                  3,10064,10065,10068,10069,10070,10
                                                                                                  071,10072,10086,10087,10103,10104,
                                                                                                  10105,10129,10130,10131,10136,1013
                                                                                                  7,10198,10199,10200,10201,10202,10
                                                                                                  203,10205,10206,10207             
 LAST                       Scalar 10006    I(4)            4           scalar   COM                                                
 LEVBAD                     Local  10098    I(4)            4           scalar                    10098,10102,10105,10107,10115,1012
                                                                                                  8,10131,10133,10145               
 LEVCNT                     Local  10097    I(4)            4           scalar                    10097,10101,10104,10107,10115,1012
                                                                                                  7,10130,10133,10145               
 LEVTYP                     Scalar 9992     I(4)            4     1     255      COM              10202,10206                       
 LM                         Local  10079    I(4)            4           scalar                    10079,10080,10081,10082,10083,1008
                                                                                                  4,10099,10100,10103,10109,10125,10
                                                                                                  126,10129,10135                   
 LMAND                      Scalar 10009    I(4)            4     1     22       COM                                                
 LN                         Local  10080    I(4)            4           scalar                    10080,10082,10084                 
 LOW                        Local  10158    I(4)            4           scalar                    10158,10160,10163,10166,10171,1019
                                                                                                  2,10195,10198                     
 LOWT                       Local  10096    I(4)            4           scalar                    10096,10109,10115,10150,10151,1015
                                                                                                  3,10158,10159,10160               
 LOWZ                       Local  10123    I(4)            4           scalar                    10123,10135,10136,10139,10145,1015
                                                                                                  0,10151,10153,10158,10162,10163   
 LSFC                       Scalar 10009    I(4)            4           scalar   COM                                                
 LST                        Scalar 9993     I(4)            4     1     255      COM              10202,10206                       
 MAND                       Scalar 10008    I(4)            4           scalar   COM                                                
 MIN                        Func   10158                                scalar                    10158                             
 NBAS                       Scalar 10003    I(4)            4           scalar   COM                                                
 NEV                        Scalar 9986     I(4)            4           scalar   COM                                                
 NHYD                       Scalar 10001    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 10003    I(4)            4     1     21       COM                                                
 NLEV                       Scalar 10008    I(4)            4           scalar   COM              10079,10086,10087,10099,10103,1012
                                                                                                  5,10129,10136,10171,10198         
 NLV                        Scalar 9985     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 9986     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 9986     I(4)            4           scalar   COM                                                
 NMANLV                     Func   10080    I(4)            4           scalar                    10080                             
 NO40S                      Common 10012                                8                                                           
 NOBS                       Scalar 10008    I(4)            4           scalar   COM                                                
 NORD23                     Scalar 10012    L(4)            4           scalar   COM              10035                             
 NQI                        Scalar 9997     I(4)            4     1     255      COM                                                
 NQV                        Scalar 9999     I(4)            4     1     255      COM                                                
 NST                        Param  9979     I(4)            4           scalar                    9984,9985,9986,9993,10002,10010   
 NTDI                       Scalar 9997     I(4)            4     1     255      COM                                                
 NTDV                       Scalar 9999     I(4)            4     1     255      COM                                                
 NTI                        Scalar 9997     I(4)            4     1     255      COM                                                
 NTL                        Scalar 9999     I(4)            4     1     255      COM                                                

Page 338         Source Listing                  POBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTV                        Scalar 9999     I(4)            4     1     255      COM                                                
 NUM                        Scalar 10010    I(4)            4           scalar   COM              10045                             
 NZI                        Scalar 9997     I(4)            4     1     255      COM                                                
 NZV                        Scalar 9999     I(4)            4     1     255      COM                                                
 PARAMS                     Common 10008                                148                                                         
 PEROR                      Common 10007                                8                                                           
 PFC                        Scalar 9987     R(4)            4     1     255      COM                                                
 PI                         Scalar 9995     R(4)            4     1     255      COM                                                
 POB                        Scalar 9987     R(4)            4     1     255      COM              10080,10100,10126,10202,10206     
 POBERR                     Subr   9978                                                                                             
 POUT                       Scalar 10006    L(4)            4           scalar   COM              10050,10193                       
 PQM                        Scalar 9987     R(4)            4     1     255      COM                                                
 PRC                        Scalar 9987     R(4)            4     1     255      COM                                                
 PRNT                       Scalar 10009    R(4)            4           scalar   COM                                                
 PS                         Scalar 9993     R(4)            4     1     999      COM              10100,10126                       
 PSCOR                      Scalar 10006    R(4)            4           scalar   COM                                                
 PSINC                      Scalar 10002    R(4)            4           scalar   COM                                                
 PTCOR                      Local  10190    R(4)            4           scalar                    10190,10203                       
 PZCOR                      Local  10191    R(4)            4           scalar                    10191,10207                       
 QFC                        Scalar 9991     R(4)            4     1     255      COM                                                
 QI                         Scalar 9995     R(4)            4     1     255      COM                                                
 QM                         Local  10177    R(4)            4           scalar                    10177,10183,10203,10207           
 QOB                        Scalar 9991     R(4)            4     1     255      COM                                                
 QQM                        Scalar 9991     R(4)            4     1     255      COM                                                
 QRC                        Scalar 9991     R(4)            4     1     255      COM                                                
 QV                         Scalar 9996     R(4)            4     1     255      COM                                                
 RADPC                      Scalar 10008    R(4)            4           scalar   COM                                                
 REAL                       Func   10107                                scalar                    10107,10133                       
 REGION                     Common 9983                                 9408                                                        
 RESID                      Common 9995                                 41312                                                       
 SEVENT                     Subr   10202                                                          10202,10206                       
 SID                        Scalar 9984     CHAR            8     1     999      COM              10040,10073,10086,10195,10202,1020
                                                                                                  6                                 
 SQN                        Scalar 9985     R(4)            4     1     999      COM              10202,10206                       
 STDIY                      Scalar 9983     R(4)            4     3     1176     COM              10062,10063,10064,10065           
 STDNUM                     Local  10030    R(4)            4           scalar                    10030,10062,10063,10064,10065     
 STN                        Common 10011                                4                                                           
 T1                         Scalar 10005    R(4)            4           scalar   COM                                                
 TBAD                       Local  10019    L(4)            4     1     255                       10054,10082,10086,10100,10105     
 TC                         Local  10188    R(4)            4           scalar                    10188,10203                       
 TCBEST                     Scalar 10005    R(4)            4     1     2        COM                                                
 TCOR                       Scalar 10005    R(4)            4     1     2        COM                                                
 TDFC                       Scalar 9990     R(4)            4     1     255      COM                                                
 TDI                        Scalar 9995     R(4)            4     1     255      COM                                                
 TDO                        Scalar 9990     R(4)            4     1     255      COM                                                
 TDV                        Scalar 9996     R(4)            4     1     255      COM                                                
 TEST                       Scalar 10016    L(4)            4           scalar   COM              10086,10087,10115,10145,10179,1019
                                                                                                  5                                 
 TESTS                      Common 10016                                4                                                           
 TFC                        Scalar 9989     R(4)            4     1     255      COM                                                
 THI                        Local  10017    R(4)            4     1     21                        10065,10072,10082                 
 THI0                       Local  10018    R(4)            4     1     21                        10024,10072                       
 TI                         Scalar 9995     R(4)            4     1     255      COM              10081,10082,10104                 
 TL                         Scalar 9996     R(4)            4     1     255      COM                                                
 TLIMIT                     Local  10030    R(4)            4           scalar                    10030,10108                       

Page 339         Source Listing                  POBERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TLO                        Local  10017    R(4)            4     1     21                        10063,10070,10082                 
 TLO0                       Local  10018    R(4)            4     1     21                        10022,10070                       
 TLSAT                      Scalar 10002    R(4)            4     1     255      COM                                                
 TOB                        Scalar 9989     R(4)            4     1     255      COM              10201,10203                       
 TQM                        Scalar 9989     R(4)            4     1     255      COM                                                
 TRAT                       Local  10095    R(4)            4           scalar                    10095,10107,10108,10115           
 TRC                        Scalar 9989     R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 10006    R(4)            4           scalar   COM                                                
 TT                         Scalar 10009    R(4)            4           scalar   COM                                                
 TV                         Scalar 9996     R(4)            4     1     255      COM                                                
 TVO                        Scalar 9990     R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 10008    R(4)            4           scalar   COM                                                
 WRT23                      Scalar 10012    L(4)            4           scalar   COM                                                
 XDR                        Scalar 9994     R(4)            4     1     255      COM                                                
 XMA                        Scalar 10008    R(4)            4           scalar   COM                                                
 XMI                        Scalar 10008    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 10013    R(4)            4           scalar   COM              10203,10207                       
 XOB                        Scalar 9984     R(4)            4     1     999      COM              10058,10073                       
 XQI                        Scalar 9998     R(4)            4     1     255      COM                                                
 XQV                        Scalar 10000    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 10004    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 9998     R(4)            4     1     255      COM                                                
 XTDV                       Scalar 10000    R(4)            4     1     255      COM                                                
 XTH                        Scalar 10003    R(4)            4     1     255      COM                                                
 XTI                        Scalar 9998     R(4)            4     1     255      COM                                                
 XTV                        Scalar 10000    R(4)            4     1     255      COM                                                
 XZH                        Scalar 10003    R(4)            4     1     255      COM                                                
 XZI                        Scalar 9998     R(4)            4     1     255      COM                                                
 XZV                        Scalar 10000    R(4)            4     1     255      COM                                                
 YDR                        Scalar 9994     R(4)            4     1     255      COM                                                
 YMA                        Scalar 10008    R(4)            4           scalar   COM                                                
 YMI                        Scalar 10008    R(4)            4           scalar   COM                                                
 YOB                        Scalar 9984     R(4)            4     1     999      COM              10058,10073                       
 ZBAD                       Local  10019    L(4)            4     1     255                       10055,10084,10087,10126,10131     
 ZC                         Local  10189    R(4)            4           scalar                    10189,10207                       
 ZCBEST                     Scalar 10005    R(4)            4     1     2        COM                                                
 ZCOR                       Scalar 10005    R(4)            4     1     2        COM                                                
 ZD                         Scalar 10003    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 9988     R(4)            4     1     255      COM                                                
 ZHI                        Local  10017    R(4)            4     1     21                        10064,10071,10084                 
 ZHI0                       Local  10018    R(4)            4     1     21                        10028,10071                       
 ZI                         Scalar 9995     R(4)            4     1     255      COM              10083,10084,10130,10137           
 ZLIMIT                     Local  10030    R(4)            4           scalar                    10030,10134                       
 ZLO                        Local  10017    R(4)            4     1     21                        10062,10069,10084                 
 ZLO0                       Local  10018    R(4)            4     1     21                        10026,10069                       
 ZOB                        Scalar 9988     R(4)            4     1     255      COM              10205,10207                       
 ZQM                        Scalar 9988     R(4)            4     1     255      COM                                                
 ZRAT                       Local  10124    R(4)            4           scalar                    10124,10133,10134,10145           
 ZRC                        Scalar 9988     R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 10006    R(4)            4           scalar   COM                                                
 ZV                         Scalar 9996     R(4)            4     1     255      COM                                                

Page 340         Source Listing                  POBERR
2017-04-18 11:07                                 cqcbufr.f

  10214 
  10215 C******************************************************************
  10216 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  10217 C                .      .    .                                       .
  10218 C SUBPROGRAM:    PRNTOUT     PRINT RESULTS FOR A STATION
  10219 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  10220 C
  10221 C ABSTRACT: Print the results of cqc for a single station.
  10222 C
  10223 C PROGRAM HISTORY LOG:
  10224 C 1997-03-18  W. Collins  Original author.
  10225 C
  10226 C USAGE:    CALL PRNTOUT(SEQLP,ICALL)
  10227 C   INPUT ARGUMENT LIST:
  10228 C     ICALL  - 1 FOR CALL FROM MAIN
  10229 C            - 2 FOR CALL FROM CHANGE
  10230 C
  10231 C   OUTPUT ARGUMENT LIST:
  10232 C     SEQLP    - SEQUENCE NO. OF STATION
  10233 C
  10234 C   OUTPUT FILES:
  10235 C     UNIT 06  - PRINTOUT
  10236 C     UNIT 52  - OUTPUT PRINT FILE OF VALUES, RESIDUALS AND EVENTS
  10237 C
  10238 C REMARKS: NONE.
  10239 C
  10240 C ATTRIBUTES:
  10241 C   LANGUAGE: FORTRAN 90
  10242 C   MACHINE:  NCEP WCOSS
  10243 C
  10244 C$$$
  10245       
  10246       SUBROUTINE PRNTOUT(SEQLP,ICALL)
  10247       PARAMETER (NST=999)
  10248 
  10249       REAL(8) BMISS
  10250 
  10251       REAL             ZH(255), TH(255), TDH(255), HY(255),
  10252      &                 X(255),  XS(255), HYN(255),
  10253      &                 ZA(255), TA(255)
  10254       INTEGER          NZH(255),  NTH(255),  NTDH(255), NHY(255),
  10255      &                 NHYN(255), NTA(255), NZA(255)
  10256       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  10257      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  10258      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  10259      &                 TDO(255), TDFC(255),TVO(255),
  10260      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  10261      &                 CAT(255), IND(255), LEVTYP(255),
  10262      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  10263      &                 YDR(255), XDR(255)
  10264       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  10265      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  10266      &                 NEV, ISF(NST), NLVM, NLVW
  10267       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  10268      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  10269      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  10270      &                 XZI(255),XTI(255),XTDI(255),XQI(255),

Page 341         Source Listing                  PRNTOUT
2017-04-18 11:07                                 cqcbufr.f

  10271      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  10272      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  10273      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  10274      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  10275      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  10276      &                 XTDH(255)
  10277       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  10278      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  10279      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
  10280      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  10281      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
  10282      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  10283      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  10284      &                 XTHM(21,NST),XTDVM(21,NST),
  10285      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  10286      &                 XQHM(21,NST),
  10287      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  10288      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  10289       COMMON /TMPSND/  OBT(21,NST,4,2),
  10290      &                 ZIT(21,NST,4), TIT(21,NST,4),
  10291      &                 TMP(21,NST,2), NTMP(21,NST,2),
  10292      &                 ITERR(4)
  10293       COMMON /MANSND/  ZM(21,NST), TM(21,NST), TDM(21), QM(21), MANDL,
  10294      &                 MANDF, ZFM(21), TFM(21), QFM(21), PM(21)
  10295       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  10296      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  10297       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  10298 
  10299       CHARACTER*8      SID
  10300       CHARACTER*10     CDATE
  10301       COMMON /DATEX/   JDATE(5), CDATE
  10302       COMMON /STN/     IS
  10303       LOGICAL          QUICK, PRNT, XQUICK
  10304       LOGICAL ZG, TG, TDG, QG, ERROR
  10305 
  10306       PRNT = .TRUE.
  10307       IPEVT = 0
  10308       IF(ICALL.NE.3) THEN
  10309         SEQLPOLD = SEQLP
  10310         SEQLP = SQN(IS)
  10311       ENDIF
  10312 
  10313       DO I=1,255
  10314         ZH(I)    = BMISS
  10315         TH(I)    = BMISS
  10316         TDH(I)   = BMISS
  10317         HY(I)    = BMISS
  10318         HYN(I)   = BMISS
  10319         X(I)     = BMISS
  10320         XS(I)    = BMISS
  10321         NZH(I)   = -1
  10322         NTH(I)   = -1
  10323         NTDH(I)  = -1
  10324         NHY(I)   = -1
  10325         NHYN(I)  = -1
  10326       ENDDO
  10327       DO L=1,NLVM

Page 342         Source Listing                  PRNTOUT
2017-04-18 11:07                                 cqcbufr.f

  10328         M = MANLEV(POB(L))
  10329         IF(M.NE.0) THEN
  10330           DO LL=1,MAND
  10331             MM = MANLEV(PM(LL))
  10332             IF(MM.EQ.M) GOTO 60
  10333           ENDDO
  10334           GOTO 100
  10335    60     CONTINUE
  10336           ZH(L)  = ZHM(LL,IS)
  10337           TH(L)  = THM(LL,IS)
  10338           TDH(L) = TDHM(LL,IS)
  10339           HY(L)  = HYD(LL)
  10340           HYN(L) = HYDN(LL)
  10341           IF(B(LL).NE.0. .AND. HYDN(LL).NE.BMISS) THEN
  10342             X(L)   = HYDN(LL)/B(LL)
  10343           ENDIF
  10344           IF(B(LL).NE.0. .AND. HYDS(LL).NE.BMISS) THEN
  10345             XS(L)  = HYDS(LL)/B(LL)
  10346           ENDIF
  10347           NZH(L)  = NZHM(LL,IS)
  10348           NTH(L)  = NTHM(LL,IS)
  10349           NTDH(L) = NTDHM(LL,IS)
  10350           NHY(L)  = NHYD(LL)
  10351           NHYN(L) = NHYDN(LL)
  10352   100     CONTINUE
  10353         ENDIF
  10354       ENDDO
  10355       IF(PSINC.NE.BMISS .AND. PSINC.NE.0.) THEN
  10356         IPSINC = ABS(PSINC)/3.5
  10357       ELSE
  10358         IPSINC = 0.
  10359       ENDIF
  10360 
  10361       IF(ICALL.EQ.3) GOTO 700
  10362 
  10363 C  QUICK RECOGNITION PART
  10364 C  ----------------------
  10365 
  10366       DO L=1,255
  10367         NZA(L) = -1
  10368         NTA(L) = -1
  10369         ZA(L)  = BMISS
  10370         TA(L)  = BMISS
  10371       ENDDO
  10372       DO L=1,NLVM
  10373         LL = MANLEV(POB(L))
  10374         IF(LL.NE.0) THEN
  10375           NZA(L) = NTMP(LL,IS,1)
  10376           NTA(L) = NTMP(LL,IS,2)
  10377           ZA(L)  = TMP(LL,IS,1)
  10378           TA(L)  = TMP(LL,IS,2)
  10379         ENDIF
  10380       ENDDO
  10381 
  10382       QUICK = .FALSE.
  10383       IF(QUICK) THEN
  10384         WRITE(6,500) SID(IS),YOB(IS),XOB(IS),ELV(IS)

Page 343         Source Listing                  PRNTOUT
2017-04-18 11:07                                 cqcbufr.f

  10385         WRITE(6,504)
  10386         WRITE(6,505) POB(1),NZI(1),NZV(1),NZH(1),NZA(1),NHY(1),
  10387      &    NTI(1),NTV(1),NTH(1),NTL(1),NTA(1),NHYN(1),NTDI(1),
  10388      &   NTDV(1),NTDH(1),(IHSC(I,1),I=1,4),NBAS,IPSINC
  10389         DO L=2,NLVM
  10390           WRITE(6,506) POB(L),NZI(L),NZV(L),NZH(L),NZA(L),NHY(L),
  10391      &      NTI(L),NTV(L),NTH(L),NTL(L),NTA(L),NHYN(L),NTDI(L),
  10392      &     NTDV(L),NTDH(L),(IHSC(I,L),I=1,4)
  10393         ENDDO
  10394       ENDIF
  10395 
  10396   504 FORMAT(/'          ---Height----  ------Temp------ -DewP T-',
  10397      &        '   ------IHSC------'/
  10398      &        '   PRESS  I  V  H  T HY  I  V  H LP  T HY  I  V  H',
  10399      &        '      P   Z   T  Td  BAS IPSINC')
  10400   505 FORMAT(1X,F7.1,14I3,3X,4I4,I5,I7)
  10401   506 FORMAT(1X,F7.1,14I3,3X,4I4)
  10402 
  10403 C  ALTERNATE QUICK RECOGNITION PART
  10404 C  --------------------------------
  10405 
  10406       XQUICK = .TRUE.
  10407       IF(XQUICK) THEN
  10408         LM = MANLEV(POB(1))
  10409         IF(LM.NE.0) THEN
  10410           XZH(1) = XZHM(LM,IS)
  10411           XTH(1) = XTHM(LM,IS)
  10412           XTDH(1) = XTDHM(LM,IS)
  10413         ELSE
  10414           XZH(1) = BMISS
  10415           XTH(1) = BMISS
  10416           XTDH(1) = BMISS
  10417         ENDIF
  10418         B = 10.
  10419         PER = .035
  10420         CALL FUZZY(PZ,XZI(1),XZV(1),XZH(1),B,PER)
  10421         PER = .035
  10422         CALL FUZZY(PT,XTI(1),XTV(1),XTH(1),B,PER)
  10423         WRITE(6,500) SID(IS),YOB(IS),XOB(IS),ELV(IS)
  10424         WRITE(6,604)
  10425         WRITE(6,605) POB(1),XZI(1),XZV(1),XZH(1),PZ,NZA(1),NHY(1),
  10426      &    XTI(1),XTV(1),XTH(1),PT,NTL(1),NZA(2),NHYN(1),XTDI(1),
  10427      &   XTDV(1),XTDH(1),(IHSC(I,1),I=1,4),NBAS,IPSINC
  10428         DO L=2,NLVM
  10429           LM = MANLEV(POB(L))
  10430           IF(LM.NE.0) THEN
  10431             XZH(L) = XZHM(LM,IS)
  10432             XTH(L) = XTHM(LM,IS)
  10433             XTDH(L) = XTDHM(LM,IS)
  10434           ELSE
  10435             XZH(L) = BMISS
  10436             XTH(L) = BMISS
  10437             XTDH(L) = BMISS
  10438           ENDIF
  10439           B = 10.
  10440           PER = .035
  10441           CALL FUZZY(PZ,XZI(L),XZV(L),XZH(L),B,PER)

Page 344         Source Listing                  PRNTOUT
2017-04-18 11:07                                 cqcbufr.f

  10442           PER = .035
  10443           CALL FUZZY(PT,XTI(L),XTV(L),XTH(L),B,PER)
  10444           WRITE(6,606) POB(L),XZI(L),XZV(L),XZH(L),PZ,NZA(L),NHY(L),
  10445      &      XTI(L),XTV(L),XTH(L),PT,NTL(L),NTA(L),NHYN(L),XTDI(L),
  10446      &     XTDV(L),XTDH(L),(IHSC(I,L),I=1,4)
  10447         ENDDO
  10448       ENDIF
  10449 
  10450   604 FORMAT(/'          ---------------Height---------------',
  10451      &        '  --------------Temperature--------------',
  10452      &        ' ------Dew Pt Temp------',
  10453      &        '   ------IHSC------'/
  10454      &        '   PRESS       I       V       H     ACP  T HY    ',
  10455      &        '   I       V       H     ACP LP  T HY       I     ',
  10456      &        '  V       H      P   Z   T  Td  BAS IPSINC')
  10457   605 FORMAT(1X,F7.1,3(1X,F7.2),1X,F7.3,2I3,3(1X,F7.2),1X,F7.3,3I3,
  10458      &       3(1X,F7.2),3X,4I4,I5,I7)
  10459   606 FORMAT(1X,F7.1,3(1X,F7.2),1X,F7.3,2I3,3(1X,F7.2),1X,F7.3,3I3,
  10460      &       3(1X,F7.2),3X,4I4)
  10461 
  10462 C  PRINT INFORMATION FOR MONITORING
  10463 C  --------------------------------
  10464 
  10465       WRITE(6,500) SID(IS),YOB(IS),XOB(IS),ELV(IS)
  10466       WRITE(6,501) CDATE,DHR(IS),ISC,ITP(IS),PS(IS),PIS(IS),PSINC,
  10467      &             BASRES(IS)
  10468       WRITE(6,502)
  10469       DO L=1,NLVM
  10470         WRITE(6,503) POB(L),ZOB(L),ZI(L),ZV(L),ZH(L),ZA(L),HY(L),HYN(L),
  10471      &    TOB(L),TI(L),TV(L),TH(L),TA(L),X(L),TDO(L),TDI(L),TDV(L),
  10472      &    TDH(L),LST(L),CAT(L)
  10473       ENDDO
  10474       WRITE(6,507)
  10475 
  10476   700 CONTINUE
  10477 
  10478 C  PRINT INFORMATION FOR SDM-S
  10479 C  ---------------------------
  10480 
  10481       IF(ICALL.EQ.3 .OR. ICALL.EQ.1) THEN
  10482         WRITE(52,500) SID(IS),YOB(IS),XOB(IS),ELV(IS)
  10483         WRITE(52,501) CDATE,DHR(IS),ISC,ITP(IS),PS(IS),PIS(IS),PSINC,
  10484      &             BASRES(IS)
  10485         WRITE(52,508)
  10486         DO L=1,NLVM
  10487           WRITE(52,509) POB(L),ZOB(L),ZI(L),ZV(L),ZH(L),HY(L),HYN(L),
  10488      &      TOB(L),TI(L),TV(L),TH(L),X(L),CAT(L)
  10489         ENDDO
  10490         WRITE(52,507)
  10491       ENDIF
  10492 
  10493   500 FORMAT(//' STN ID: ',A8,'  LAT:',F7.2,'  LON:',F7.2,'  STN HT:',
  10494      &  F7.0)
  10495   501 FORMAT(' DATE/TIME: ',A10,'  DHOUR:',F4.1,'  SCAN:',I4,
  10496      &  '  INST TYPE:',I4.3,/,' SURFACE PRESS:',F8.1,'    PIS:',F8.1,
  10497      &  '  PSINC:',F8.1,'  BASRES:',F8.0)
  10498   502 FORMAT(/'          <------------Height-------------> ',

Page 345         Source Listing                  PRNTOUT
2017-04-18 11:07                                 cqcbufr.f

  10499      &  '<-Hydr Res-->',
  10500      &  ' <--------------Temperature--------------> <--Dew Point ',
  10501      &  'Temperature--> ',
  10502      &       /'   PRESS    ZOB     ZI     ZV     ZH     ZT   HYDS  ',
  10503      &  ' HYDN    TOB     TI     TV     TH     TT      X    TDO    TDI',
  10504      &  '    TDV    TDH  LST  CAT')
  10505   503 FORMAT(1X,F7.1,7(1X,F6.0),10(1X,F6.1),I5,F5.0)
  10506   507 FORMAT(/)
  10507   508 FORMAT(/'          <---------Height---------> ',
  10508      &  '<-Hydr Res-->',
  10509      &  ' <-----------Temperature----------> ',
  10510      &       /'   PRESS    ZOB     ZI     ZV     ZH   HYDS  ',
  10511      &  ' HYDN    TOB     TI     TV     TH      X',
  10512      &  '  CAT')
  10513   509 FORMAT(1X,F7.1,6(1X,F6.0),5(1X,F6.1),F5.0)
  10514 
  10515       RETURN
  10516       END


ENTRY POINTS

  Name                
                      
 prntout_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  10352                                                          10334                             
 500                        Label  10493                                                          10384,10423,10465,10482           
 501                        Label  10495                                                          10466,10483                       
 502                        Label  10498                                                          10468                             
 503                        Label  10505                                                          10470                             
 504                        Label  10396                                                          10385                             
 505                        Label  10400                                                          10386                             
 506                        Label  10401                                                          10390                             
 507                        Label  10506                                                          10474,10490                       
 508                        Label  10507                                                          10485                             
 509                        Label  10513                                                          10487                             
 60                         Label  10335                                                          10332                             
 604                        Label  10450                                                          10424                             
 605                        Label  10457                                                          10425                             
 606                        Label  10459                                                          10444                             
 700                        Label  10476                                                          10361                             
 ABS                        Func   10356                                scalar                    10356                             
 ALLSND                     Common 10256                                34512                                                       
 B                          Scalar 10275    R(4)            4     1     21       COM              10341,10342,10344,10345,10418,1042
                                                                                                  0,10422,10439,10441,10443         
 BASRES                     Scalar 10274    R(4)            4     1     999      COM              10467,10484                       
 BMISS                      Scalar 10249    R(8)            8           scalar   COM              10314,10315,10316,10317,10318,1031
                                                                                                  9,10320,10341,10344,10355,10369,10
                                                                                                  370,10414,10415,10416,10435,10436,
                                                                                                  10437                             
 BRES                       Scalar 10288    R(4)            4     1     999      COM                                                

Page 346         Source Listing                  PRNTOUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFRLIB_MISSING            Common 10297                                16                                                          
 CAT                        Scalar 10261    R(4)            4     1     255      COM              10472,10488                       
 CDATE                      Scalar 10300    CHAR            10          scalar   COM              10466,10483                       
 CQCPC                      Scalar 10296    R(4)            4           scalar   COM                                                
 DATEX                      Common 10301                                30                                                          
 DHR                        Scalar 10264    R(4)            4     1     999      COM              10466,10483                       
 ELV                        Scalar 10265    R(4)            4     1     999      COM              10384,10423,10465,10482           
 ERROR                      Scalar 10288    L(4)            4     1     999      COM                                                
 FUZZY                      Subr   10420                                                          10420,10422,10441,10443           
 GESPS                      Scalar 10262    R(4)            4     1     999      COM                                                
 HEADER                     Common 10264                                35980                                                       
 HRDR                       Scalar 10262    R(4)            4     1     255      COM                                                
 HY                         Local  10251    R(4)            4     1     255                       10317,10339,10470,10487           
 HYD                        Scalar 10273    R(4)            4     1     21       COM              10339                             
 HYDM                       Scalar 10288    R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 10273    R(4)            4     1     21       COM              10340,10341,10342                 
 HYDQ                       Scalar 10273    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 10273    R(4)            4     1     21       COM              10344,10345                       
 HYN                        Local  10252    R(4)            4     1     255                       10318,10340,10470,10487           
 I                          Local  10313    I(4)            4           scalar                    10313,10314,10315,10316,10317,1031
                                                                                                  8,10319,10320,10321,10322,10323,10
                                                                                                  324,10325,10388,10392,10427,10446 
 ICALL                      Dummy  10246    I(4)            4           scalar   ARG,INOUT        10308,10361,10481                 
 IHSC                       Scalar 10274    I(4)            4     2     1020     COM              10388,10392,10427,10446           
 IMISS                      Scalar 10297    I(4)            4           scalar   COM                                                
 IND                        Scalar 10261    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 10296    I(4)            4           scalar   COM              10307                             
 IPSINC                     Local  10356    I(4)            4           scalar                    10356,10358,10388,10427           
 IS                         Scalar 10302    I(4)            4           scalar   COM              10310,10336,10337,10338,10347,1034
                                                                                                  8,10349,10375,10376,10377,10378,10
                                                                                                  384,10410,10411,10412,10423,10431,
                                                                                                  10432,10433,10465,10466,10467,1048
                                                                                                  2,10483,10484                     
 ISC                        Scalar 10296    I(4)            4           scalar   COM              10466,10483                       
 ISF                        Scalar 10266    I(4)            4     1     999      COM                                                
 ITERR                      Scalar 10292    I(4)            4     1     4        COM                                                
 ITP                        Scalar 10265    I(4)            4     1     999      COM              10466,10483                       
 JDATE                      Scalar 10301    I(4)            4     1     5        COM                                                
 L                          Local  10327    I(4)            4           scalar                    10327,10328,10336,10337,10338,1033
                                                                                                  9,10340,10342,10345,10347,10348,10
                                                                                                  349,10350,10351,10366,10367,10368,
                                                                                                  10369,10370,10372,10373,10375,1037
                                                                                                  6,10377,10378,10389,10390,10391,10
                                                                                                  392,10428,10429,10431,10432,10433,
                                                                                                  10435,10436,10437,10441,10443,1044
                                                                                                  4,10445,10446,10469,10470,10471,10
                                                                                                  472,10486,10487,10488             
 LEVTYP                     Scalar 10261    I(4)            4     1     255      COM                                                
 LL                         Local  10330    I(4)            4           scalar                    10330,10331,10336,10337,10338,1033
                                                                                                  9,10340,10341,10342,10344,10345,10
                                                                                                  347,10348,10349,10350,10351,10373,
                                                                                                  10374,10375,10376,10377,10378     
 LM                         Local  10408    I(4)            4           scalar                    10408,10409,10410,10411,10412,1042
                                                                                                  9,10430,10431,10432,10433         
 LMAND                      Scalar 10296    I(4)            4     1     22       COM                                                

Page 347         Source Listing                  PRNTOUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LSFC                       Scalar 10296    I(4)            4           scalar   COM                                                
 LST                        Scalar 10262    I(4)            4     1     255      COM              10472                             
 M                          Local  10328    I(4)            4           scalar                    10328,10329,10332                 
 MAND                       Scalar 10295    I(4)            4           scalar   COM              10330                             
 MANDF                      Scalar 10294    I(4)            4           scalar   COM                                                
 MANDL                      Scalar 10293    I(4)            4           scalar   COM                                                
 MANLEV                     Func   10328    I(4)            4           scalar                    10328,10331,10373,10408,10429     
 MANRES                     Common 10277                                2949048                                                     
 MANSND                     Common 10293                                168344                                                      
 MM                         Local  10331    I(4)            4           scalar                    10331,10332                       
 NBAS                       Scalar 10275    I(4)            4           scalar   COM              10388,10427                       
 NEV                        Scalar 10266    I(4)            4           scalar   COM                                                
 NHY                        Local  10254    I(4)            4     1     255                       10324,10350,10386,10390,10425,1044
                                                                                                  4                                 
 NHYD                       Scalar 10273    I(4)            4     1     21       COM              10350                             
 NHYDN                      Scalar 10275    I(4)            4     1     21       COM              10351                             
 NHYN                       Local  10255    I(4)            4     1     255                       10325,10351,10387,10391,10426,1044
                                                                                                  5                                 
 NLEV                       Scalar 10295    I(4)            4           scalar   COM                                                
 NLV                        Scalar 10265    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 10266    I(4)            4           scalar   COM              10327,10372,10389,10428,10469,1048
                                                                                                  6                                 
 NLVW                       Scalar 10266    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 10295    I(4)            4           scalar   COM                                                
 NQHM                       Scalar 10285    I(4)            4     2     20979    COM                                                
 NQI                        Scalar 10269    I(4)            4     1     255      COM                                                
 NQV                        Scalar 10271    I(4)            4     1     255      COM                                                
 NST                        Param  10247    I(4)            4           scalar                    10262,10264,10265,10266,10274,1027
                                                                                                  7,10278,10279,10280,10281,10282,10
                                                                                                  283,10284,10285,10286,10287,10288,
                                                                                                  10289,10290,10291,10293           
 NTA                        Local  10255    I(4)            4     1     255                       10368,10376,10387,10391,10445     
 NTDH                       Local  10254    I(4)            4     1     255                       10323,10349,10388,10392           
 NTDHM                      Scalar 10285    I(4)            4     2     20979    COM              10349                             
 NTDI                       Scalar 10269    I(4)            4     1     255      COM              10387,10391                       
 NTDIM                      Scalar 10280    I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 10271    I(4)            4     1     255      COM              10388,10392                       
 NTH                        Local  10254    I(4)            4     1     255                       10322,10348,10387,10391           
 NTHM                       Scalar 10283    I(4)            4     2     20979    COM              10348                             
 NTI                        Scalar 10269    I(4)            4     1     255      COM              10387,10391                       
 NTIM                       Scalar 10280    I(4)            4     2     20979    COM                                                
 NTL                        Scalar 10271    I(4)            4     1     255      COM              10387,10391,10426,10445           
 NTMP                       Scalar 10291    I(4)            4     3     41958    COM              10375,10376                       
 NTV                        Scalar 10271    I(4)            4     1     255      COM              10387,10391                       
 NZA                        Local  10255    I(4)            4     1     255                       10367,10375,10386,10390,10425,1042
                                                                                                  6,10444                           
 NZH                        Local  10254    I(4)            4     1     255                       10321,10347,10386,10390           
 NZHM                       Scalar 10283    I(4)            4     2     20979    COM              10347                             
 NZI                        Scalar 10269    I(4)            4     1     255      COM              10386,10390                       
 NZIM                       Scalar 10280    I(4)            4     2     20979    COM                                                
 NZV                        Scalar 10271    I(4)            4     1     255      COM              10386,10390                       
 OBT                        Scalar 10289    R(4)            4     4     167832   COM                                                
 PARAMS                     Common 10295                                148                                                         
 PER                        Local  10419    R(4)            4           scalar                    10419,10420,10421,10422,10440,1044
                                                                                                  1,10442,10443                     

Page 348         Source Listing                  PRNTOUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PFC                        Scalar 10256    R(4)            4     1     255      COM                                                
 PI                         Scalar 10267    R(4)            4     1     255      COM                                                
 PIS                        Scalar 10288    R(4)            4     1     999      COM              10466,10483                       
 PM                         Scalar 10294    R(4)            4     1     21       COM              10331                             
 POB                        Scalar 10256    R(4)            4     1     255      COM              10328,10373,10386,10390,10408,1042
                                                                                                  5,10429,10444,10470,10487         
 PQM                        Scalar 10256    R(4)            4     1     255      COM                                                
 PRC                        Scalar 10256    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 10296    L(4)            4           scalar   COM              10306                             
 PRNTOUT                    Subr   10246                                                                                            
 PS                         Scalar 10262    R(4)            4     1     999      COM              10466,10483                       
 PSINC                      Scalar 10274    R(4)            4           scalar   COM              10355,10356,10466,10483           
 PT                         Local  10422    R(4)            4           scalar                    10422,10426,10443,10445           
 PZ                         Local  10420    R(4)            4           scalar                    10420,10425,10441,10444           
 QFC                        Scalar 10260    R(4)            4     1     255      COM                                                
 QFM                        Scalar 10294    R(4)            4     1     21       COM                                                
 QG                         Scalar 10287    L(4)            4     2     20979    COM                                                
 QHM                        Scalar 10278    R(4)            4     2     20979    COM                                                
 QI                         Scalar 10267    R(4)            4     1     255      COM                                                
 QIM                        Scalar 10277    R(4)            4     2     20979    COM                                                
 QM                         Scalar 10293    R(4)            4     1     21       COM                                                
 QOB                        Scalar 10260    R(4)            4     1     255      COM                                                
 QQM                        Scalar 10260    R(4)            4     1     255      COM                                                
 QRC                        Scalar 10260    R(4)            4     1     255      COM                                                
 QUICK                      Local  10303    L(4)            4           scalar                    10382,10383                       
 QV                         Scalar 10268    R(4)            4     1     255      COM                                                
 QVM                        Scalar 10279    R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 10295    R(4)            4           scalar   COM                                                
 RESID                      Common 10267                                41312                                                       
 SEQLP                      Dummy  10246    R(4)            4           scalar   ARG,INOUT        10309,10310                       
 SEQLPOLD                   Local  10309    R(4)            4           scalar                    10309                             
 SID                        Scalar 10264    CHAR            8     1     999      COM              10384,10423,10465,10482           
 SQN                        Scalar 10265    R(4)            4     1     999      COM              10310                             
 STN                        Common 10302                                4                                                           
 TA                         Local  10253    R(4)            4     1     255                       10370,10378,10471                 
 TDFC                       Scalar 10259    R(4)            4     1     255      COM                                                
 TDG                        Scalar 10287    L(4)            4     2     20979    COM                                                
 TDH                        Local  10251    R(4)            4     1     255                       10316,10338,10472                 
 TDHM                       Scalar 10278    R(4)            4     2     20979    COM              10338                             
 TDI                        Scalar 10267    R(4)            4     1     255      COM              10471                             
 TDIM                       Scalar 10277    R(4)            4     2     20979    COM                                                
 TDM                        Scalar 10293    R(4)            4     1     21       COM                                                
 TDO                        Scalar 10259    R(4)            4     1     255      COM              10471                             
 TDV                        Scalar 10268    R(4)            4     1     255      COM              10471                             
 TDVM                       Scalar 10279    R(4)            4     2     20979    COM                                                
 TFC                        Scalar 10258    R(4)            4     1     255      COM                                                
 TFM                        Scalar 10294    R(4)            4     1     21       COM                                                
 TG                         Scalar 10287    L(4)            4     2     20979    COM                                                
 TH                         Local  10251    R(4)            4     1     255                       10315,10337,10471,10488           
 THM                        Scalar 10278    R(4)            4     2     20979    COM              10337                             
 TI                         Scalar 10267    R(4)            4     1     255      COM              10471,10488                       
 TIM                        Scalar 10277    R(4)            4     2     20979    COM                                                
 TIT                        Scalar 10290    R(4)            4     3     83916    COM                                                
 TL                         Scalar 10268    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 10274    R(4)            4     1     255      COM                                                

Page 349         Source Listing                  PRNTOUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TM                         Scalar 10293    R(4)            4     2     20979    COM                                                
 TMP                        Scalar 10291    R(4)            4     3     41958    COM              10377,10378                       
 TMPSND                     Common 10289                                1678336                                                     
 TOB                        Scalar 10258    R(4)            4     1     255      COM              10471,10488                       
 TQM                        Scalar 10258    R(4)            4     1     255      COM                                                
 TRC                        Scalar 10258    R(4)            4     1     255      COM                                                
 TT                         Scalar 10296    R(4)            4           scalar   COM                                                
 TV                         Scalar 10268    R(4)            4     1     255      COM              10471,10488                       
 TVM                        Scalar 10279    R(4)            4     2     20979    COM                                                
 TVO                        Scalar 10259    R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 10295    R(4)            4           scalar   COM                                                
 X                          Local  10252    R(4)            4     1     255                       10319,10342,10471,10488           
 XDR                        Scalar 10263    R(4)            4     1     255      COM                                                
 XMA                        Scalar 10295    R(4)            4           scalar   COM                                                
 XMI                        Scalar 10295    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 10297    R(4)            4           scalar   COM                                                
 XOB                        Scalar 10264    R(4)            4     1     999      COM              10384,10423,10465,10482           
 XQHM                       Scalar 10286    R(4)            4     2     20979    COM                                                
 XQI                        Scalar 10270    R(4)            4     1     255      COM                                                
 XQIM                       Scalar 10282    R(4)            4     2     20979    COM                                                
 XQUICK                     Local  10303    L(4)            4           scalar                    10406,10407                       
 XQV                        Scalar 10272    R(4)            4     1     255      COM                                                
 XS                         Local  10252    R(4)            4     1     255                       10320,10345                       
 XTDH                       Scalar 10276    R(4)            4     1     255      COM              10412,10416,10427,10433,10437,1044
                                                                                                  6                                 
 XTDHM                      Scalar 10285    R(4)            4     2     20979    COM              10412,10433                       
 XTDI                       Scalar 10270    R(4)            4     1     255      COM              10426,10445                       
 XTDIM                      Scalar 10281    R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 10272    R(4)            4     1     255      COM              10427,10446                       
 XTDVM                      Scalar 10284    R(4)            4     2     20979    COM                                                
 XTH                        Scalar 10275    R(4)            4     1     255      COM              10411,10415,10422,10426,10432,1043
                                                                                                  6,10443,10445                     
 XTHM                       Scalar 10284    R(4)            4     2     20979    COM              10411,10432                       
 XTI                        Scalar 10270    R(4)            4     1     255      COM              10422,10426,10443,10445           
 XTIM                       Scalar 10281    R(4)            4     2     20979    COM                                                
 XTV                        Scalar 10272    R(4)            4     1     255      COM              10422,10426,10443,10445           
 XTVM                       Scalar 10282    R(4)            4     2     20979    COM                                                
 XZH                        Scalar 10275    R(4)            4     1     255      COM              10410,10414,10420,10425,10431,1043
                                                                                                  5,10441,10444                     
 XZHM                       Scalar 10283    R(4)            4     2     20979    COM              10410,10431                       
 XZI                        Scalar 10270    R(4)            4     1     255      COM              10420,10425,10441,10444           
 XZIM                       Scalar 10281    R(4)            4     2     20979    COM                                                
 XZV                        Scalar 10272    R(4)            4     1     255      COM              10420,10425,10441,10444           
 XZVM                       Scalar 10282    R(4)            4     2     20979    COM                                                
 YDR                        Scalar 10263    R(4)            4     1     255      COM                                                
 YMA                        Scalar 10295    R(4)            4           scalar   COM                                                
 YMI                        Scalar 10295    R(4)            4           scalar   COM                                                
 YOB                        Scalar 10264    R(4)            4     1     999      COM              10384,10423,10465,10482           
 ZA                         Local  10253    R(4)            4     1     255                       10369,10377,10470                 
 ZD                         Scalar 10275    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 10257    R(4)            4     1     255      COM                                                
 ZFM                        Scalar 10294    R(4)            4     1     21       COM                                                
 ZG                         Scalar 10287    L(4)            4     2     20979    COM                                                
 ZH                         Local  10251    R(4)            4     1     255                       10314,10336,10470,10487           
 ZHM                        Scalar 10278    R(4)            4     2     20979    COM              10336                             

Page 350         Source Listing                  PRNTOUT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZI                         Scalar 10267    R(4)            4     1     255      COM              10470,10487                       
 ZIM                        Scalar 10277    R(4)            4     2     20979    COM                                                
 ZIT                        Scalar 10290    R(4)            4     3     83916    COM                                                
 ZM                         Scalar 10293    R(4)            4     2     20979    COM                                                
 ZOB                        Scalar 10257    R(4)            4     1     255      COM              10470,10487                       
 ZQM                        Scalar 10257    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 10257    R(4)            4     1     255      COM                                                
 ZV                         Scalar 10268    R(4)            4     1     255      COM              10470,10487                       
 ZVM                        Scalar 10279    R(4)            4     2     20979    COM                                                

Page 351         Source Listing                  PRNTOUT
2017-04-18 11:07                                 cqcbufr.f

  10517  
  10518 C*********************************************************************
  10519 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  10520 C                .      .    .                                       .
  10521 C SUBPROGRAM:    PRSTNS      PRINT STATION CATEGORY INFORMATION
  10522 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  10523 C
  10524 C ABSTRACT:
  10525 C
  10526 C PROGRAM HISTORY LOG:
  10527 C 1997-03-18 W. Collins  Original author.
  10528 C 1999-12-14 W. Collins  Include writing the baseline residual in file
  10529 C     NFSTN, so that station-by-station statistics can be calculated.
  10530 C
  10531 C USAGE:    CALL PRSTNS(WIND)
  10532 C   INPUT ARGUMENTS:
  10533 C     WIND     - TRUE FOR WIND PART OF REPORT
  10534 C
  10535 C   OUTPUT FILES:
  10536 C     NFSTN    - UNIT NUMBER OF FILE CONTAINING STATION RECEIPT
  10537 C                INFORMATION
  10538 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  10539 C
  10540 C REMARKS: NONE.
  10541 C
  10542 C ATTRIBUTES:
  10543 C   LANGUAGE: FORTRAN 90
  10544 C   MACHINE:  NCEP WCOSS
  10545 C
  10546 C$$$
  10547  
  10548       SUBROUTINE PRSTNS(WIND)
  10549       PARAMETER (NST=999)
  10550       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  10551      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  10552      &                 NEV, ISF(NST), NLVM, NLVW
  10553       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  10554      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  10555      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  10556      &                 TDO(255), TDFC(255),TVO(255),
  10557      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  10558      &                 CAT(255), IND(255), LEVTYP(255),
  10559      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  10560      &                 YDR(255), XDR(255)
  10561       COMMON /ALSNDW/  POBW(255), PFCW(255), PQMW(255), PRCW(255),
  10562      &                 ZOBW(255), ZFCW(255), ZQMW(255), ZRCW(255),
  10563      &                 UOB(255),  VOB(255),  UFC(255),  VFC(255),
  10564      &                 WQM(255),  WRC(255),  SP(255),   DIR(255),
  10565      &                 CATW(255)
  10566       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  10567      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  10568      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
  10569      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  10570      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
  10571      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  10572      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  10573      &                 XTHM(21,NST),XTDVM(21,NST),

Page 352         Source Listing                  PRSTNS
2017-04-18 11:07                                 cqcbufr.f

  10574      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  10575      &                 XQHM(21,NST),
  10576      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  10577      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  10578       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  10579      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  10580      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  10581      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  10582      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  10583      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  10584      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  10585      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  10586      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  10587      &                 XTDH(255)
  10588       COMMON /MANRSW/  UIM(21,NST), VIM(21,NST), SPIM(21,NST),
  10589      &                 DIRIM(21,NST)
  10590       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  10591      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  10592       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
  10593       COMMON /DATEX/   JDATE(5), CDATE
  10594       COMMON /STN/     IS
  10595       REAL             ZINC(21),TINC(21),QINC(21),UINC(21),VINC(21),
  10596      &                 SPINC(21),DIRINC(21)
  10597       CHARACTER*4      PART(2)
  10598       CHARACTER*8      SID
  10599       CHARACTER*10     CDATE
  10600       INTEGER          ICAT(5)
  10601       LOGICAL          ZG,TG,TDG,QG,WIND, PRNT, ERROR
  10602       DATA SMISS /9999.9/
  10603       DATA PART /'MASS','WIND'/
  10604 
  10605 C  COUNT THE NUMBER OF LEVELS OF EACH CATEGORY
  10606 C  -------------------------------------------
  10607 
  10608       DO I=1,5
  10609         ICAT(I) = 0
  10610       ENDDO
  10611       DO L=1,NLV
  10612         IF(WIND) THEN
  10613           LCAT = CATW(L)
  10614         ELSE
  10615           LCAT = CAT(L)
  10616         ENDIF
  10617         IF(LCAT.GE.1 .AND. LCAT.LE.5) ICAT(LCAT) = ICAT(LCAT) + 1
  10618       ENDDO
  10619 
  10620       IF(WIND) THEN
  10621 
  10622 C  PREPARE INCREMENTS FOR PRINTING
  10623 C  -------------------------------
  10624 
  10625         DO I=1,21
  10626           UINC(I)   = AMIN1(UIM(I,IS),SMISS)
  10627           VINC(I)   = AMIN1(VIM(I,IS),SMISS)
  10628           SPINC(I)  = AMIN1(SPIM(I,IS),SMISS)
  10629           DIRINC(I) = AMIN1(DIRIM(I,IS),SMISS)
  10630         ENDDO

Page 353         Source Listing                  PRSTNS
2017-04-18 11:07                                 cqcbufr.f

  10631 
  10632         WRITE(NFSTN,502) CDATE,DHR(IS),SID(IS),NLV,PART(2),
  10633      &    (ICAT(I),I=1,5), (UINC(J),J=1,21), (VINC(J),J=1,21),
  10634      &    (SPINC(J),J=1,21), (DIRINC(J),J=1,21)
  10635 
  10636       ELSE
  10637 
  10638 C  PREPARE INCREMENTS FOR PRINTING
  10639 C  -------------------------------
  10640 
  10641         DO I=1,21
  10642           ZINC(I) = SMISS
  10643           TINC(I) = SMISS
  10644           QINC(I) = SMISS
  10645           BASELINE = SMISS
  10646           PINC = SMISS
  10647         ENDDO
  10648         DO I=1,21
  10649           IF(ZIM(I,IS).LT.SMISS .AND. ZG(I,IS)) ZINC(I) = ZIM(I,IS)
  10650           IF(TIM(I,IS).LT.SMISS .AND. TG(I,IS)) TINC(I) = TIM(I,IS)
  10651           IF(1.E6*QIM(I,IS).LT.SMISS .AND. QG(I,IS))
  10652      &                                        QINC(I) = 1.E6*QIM(I,IS)
  10653           BASELINE = AMIN1(BRES(IS),SMISS)
  10654           PINC = AMIN1(PIS(IS),SMISS)
  10655         ENDDO
  10656         IF(ISF(IS).NE.0) THEN
  10657           ZSINC = AMIN1(ZI(ISF(IS)),SMISS)
  10658         ELSE
  10659           ZSINC = SMISS
  10660         ENDIF
  10661         WRITE(60,501) SID(IS),ISC
  10662         WRITE(NFSTN,500) CDATE,DHR(IS),SID(IS),NLV,PART(1),
  10663      &    (ICAT(I),I=1,5), (ZINC(J),J=1,21), (TINC(K),K=1,21),
  10664      &    (QINC(L),L=1,21), BASELINE, PINC, ZSINC
  10665       ENDIF
  10666 
  10667 
  10668   500 FORMAT(1X,A10,1X,F8.2,1X,A8,1X,I5,1X,A4,1X,5I5,/,10X,21F8.0,/,
  10669      &  10X,21F8.1,/,10X,21F8.0,/,10X,2F8.1,F8.0)
  10670   501 FORMAT(' PRSTNS--SID,ISC: ',A8,2X,I3)
  10671   502 FORMAT(1X,A10,1X,F8.2,1X,A8,1X,I5,1X,A4,1X,5I5,/,10X,21F8.1,/,
  10672      &  10X,21F8.1,/,10X,21F8.1,/,10X,21F8.1)
  10673 
  10674       RETURN
  10675       END

Page 354         Source Listing                  PRSTNS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 prstns_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  10668                                                          10662                             
 501                        Label  10670                                                          10661                             
 502                        Label  10671                                                          10632                             
 ALLSND                     Common 10553                                34512                                                       
 ALSNDW                     Common 10561                                17340                                                       
 AMIN1                      Func   10626                                scalar                    10626,10627,10628,10629,10653,1065
                                                                                                  4,10657                           
 B                          Scalar 10586    R(4)            4     1     21       COM                                                
 BASELINE                   Local  10645    R(4)            4           scalar                    10645,10653,10664                 
 BASRES                     Scalar 10585    R(4)            4     1     999      COM                                                
 BRES                       Scalar 10577    R(4)            4     1     999      COM              10653                             
 CAT                        Scalar 10558    R(4)            4     1     255      COM              10615                             
 CATW                       Scalar 10565    R(4)            4     1     255      COM              10613                             
 CDATE                      Scalar 10593    CHAR            10          scalar   COM              10632,10662                       
 CQCPC                      Scalar 10591    R(4)            4           scalar   COM                                                
 DATEX                      Common 10593                                30                                                          
 DHR                        Scalar 10550    R(4)            4     1     999      COM              10632,10662                       
 DIR                        Scalar 10564    R(4)            4     1     255      COM                                                
 DIRIM                      Scalar 10589    R(4)            4     2     20979    COM              10629                             
 DIRINC                     Local  10596    R(4)            4     1     21                        10629,10634                       
 ELV                        Scalar 10551    R(4)            4     1     999      COM                                                
 ERROR                      Scalar 10577    L(4)            4     1     999      COM                                                
 FILES                      Common 10592                                24                                                          
 GESPS                      Scalar 10559    R(4)            4     1     999      COM                                                
 HEADER                     Common 10550                                35980                                                       
 HRDR                       Scalar 10559    R(4)            4     1     255      COM                                                
 HYD                        Scalar 10584    R(4)            4     1     21       COM                                                
 HYDM                       Scalar 10577    R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 10584    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 10584    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 10584    R(4)            4     1     21       COM                                                
 I                          Local  10608    I(4)            4           scalar                    10608,10609,10625,10626,10627,1062
                                                                                                  8,10629,10633,10641,10642,10643,10
                                                                                                  644,10648,10649,10650,10651,10652,
                                                                                                  10663                             
 ICAT                       Local  10600    I(4)            4     1     5                         10609,10617,10633,10663           
 IHSC                       Scalar 10585    I(4)            4     2     1020     COM                                                
 IND                        Scalar 10558    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 10591    I(4)            4           scalar   COM                                                
 IS                         Scalar 10594    I(4)            4           scalar   COM              10626,10627,10628,10629,10632,1064
                                                                                                  9,10650,10651,10652,10653,10654,10
                                                                                                  656,10657,10661,10662             
 ISC                        Scalar 10591    I(4)            4           scalar   COM              10661                             
 ISF                        Scalar 10552    I(4)            4     1     999      COM              10656,10657                       

Page 355         Source Listing                  PRSTNS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ITP                        Scalar 10551    I(4)            4     1     999      COM                                                
 J                          Local  10633    I(4)            4           scalar                    10633,10634,10663                 
 JDATE                      Scalar 10593    I(4)            4     1     5        COM                                                
 K                          Local  10663    I(4)            4           scalar                    10663                             
 L                          Local  10611    I(4)            4           scalar                    10611,10613,10615,10664           
 LCAT                       Local  10613    I(4)            4           scalar                    10613,10615,10617                 
 LEVTYP                     Scalar 10558    I(4)            4     1     255      COM                                                
 LMAND                      Scalar 10591    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 10591    I(4)            4           scalar   COM                                                
 LST                        Scalar 10559    I(4)            4     1     255      COM                                                
 MAND                       Scalar 10590    I(4)            4           scalar   COM                                                
 MANRES                     Common 10566                                2949048                                                     
 MANRSW                     Common 10588                                335664                                                      
 NBAS                       Scalar 10586    I(4)            4           scalar   COM                                                
 NEV                        Scalar 10552    I(4)            4           scalar   COM                                                
 NFEVN                      Scalar 10592    I(4)            4           scalar   COM                                                
 NFIN                       Scalar 10592    I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 10592    I(4)            4           scalar   COM                                                
 NFSGL                      Scalar 10592    I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 10592    I(4)            4           scalar   COM              10632,10662                       
 NFSUM                      Scalar 10592    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 10584    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 10586    I(4)            4     1     21       COM                                                
 NLEV                       Scalar 10590    I(4)            4           scalar   COM                                                
 NLV                        Scalar 10551    I(4)            4           scalar   COM              10611,10632,10662                 
 NLVM                       Scalar 10552    I(4)            4           scalar   COM                                                
 NLVW                       Scalar 10552    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 10590    I(4)            4           scalar   COM                                                
 NQHM                       Scalar 10574    I(4)            4     2     20979    COM                                                
 NQI                        Scalar 10580    I(4)            4     1     255      COM                                                
 NQV                        Scalar 10582    I(4)            4     1     255      COM                                                
 NST                        Param  10549    I(4)            4           scalar                    10550,10551,10552,10559,10566,1056
                                                                                                  7,10568,10569,10570,10571,10572,10
                                                                                                  573,10574,10575,10576,10577,10585,
                                                                                                  10588,10589                       
 NTDHM                      Scalar 10574    I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 10580    I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 10569    I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 10582    I(4)            4     1     255      COM                                                
 NTHM                       Scalar 10572    I(4)            4     2     20979    COM                                                
 NTI                        Scalar 10580    I(4)            4     1     255      COM                                                
 NTIM                       Scalar 10569    I(4)            4     2     20979    COM                                                
 NTL                        Scalar 10582    I(4)            4     1     255      COM                                                
 NTV                        Scalar 10582    I(4)            4     1     255      COM                                                
 NZHM                       Scalar 10572    I(4)            4     2     20979    COM                                                
 NZI                        Scalar 10580    I(4)            4     1     255      COM                                                
 NZIM                       Scalar 10569    I(4)            4     2     20979    COM                                                
 NZV                        Scalar 10582    I(4)            4     1     255      COM                                                
 PARAMS                     Common 10590                                148                                                         
 PART                       Local  10597    CHAR            4     1     2                         10603,10632,10662                 
 PFC                        Scalar 10553    R(4)            4     1     255      COM                                                
 PFCW                       Scalar 10561    R(4)            4     1     255      COM                                                
 PI                         Scalar 10578    R(4)            4     1     255      COM                                                
 PINC                       Local  10646    R(4)            4           scalar                    10646,10654,10664                 
 PIS                        Scalar 10577    R(4)            4     1     999      COM              10654                             

Page 356         Source Listing                  PRSTNS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 POB                        Scalar 10553    R(4)            4     1     255      COM                                                
 POBW                       Scalar 10561    R(4)            4     1     255      COM                                                
 PQM                        Scalar 10553    R(4)            4     1     255      COM                                                
 PQMW                       Scalar 10561    R(4)            4     1     255      COM                                                
 PRC                        Scalar 10553    R(4)            4     1     255      COM                                                
 PRCW                       Scalar 10561    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 10591    L(4)            4           scalar   COM                                                
 PRSTNS                     Subr   10548                                                                                            
 PS                         Scalar 10559    R(4)            4     1     999      COM                                                
 PSINC                      Scalar 10585    R(4)            4           scalar   COM                                                
 QFC                        Scalar 10557    R(4)            4     1     255      COM                                                
 QG                         Scalar 10576    L(4)            4     2     20979    COM              10651                             
 QHM                        Scalar 10567    R(4)            4     2     20979    COM                                                
 QI                         Scalar 10578    R(4)            4     1     255      COM                                                
 QIM                        Scalar 10566    R(4)            4     2     20979    COM              10651,10652                       
 QINC                       Local  10595    R(4)            4     1     21                        10644,10652,10664                 
 QOB                        Scalar 10557    R(4)            4     1     255      COM                                                
 QQM                        Scalar 10557    R(4)            4     1     255      COM                                                
 QRC                        Scalar 10557    R(4)            4     1     255      COM                                                
 QV                         Scalar 10579    R(4)            4     1     255      COM                                                
 QVM                        Scalar 10568    R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 10590    R(4)            4           scalar   COM                                                
 RESID                      Common 10578                                41312                                                       
 SID                        Scalar 10550    CHAR            8     1     999      COM              10632,10661,10662                 
 SMISS                      Local  10602    R(4)            4           scalar                    10602,10626,10627,10628,10629,1064
                                                                                                  2,10643,10644,10645,10646,10649,10
                                                                                                  650,10651,10653,10654,10657,10659 
 SP                         Scalar 10564    R(4)            4     1     255      COM                                                
 SPIM                       Scalar 10588    R(4)            4     2     20979    COM              10628                             
 SPINC                      Local  10596    R(4)            4     1     21                        10628,10634                       
 SQN                        Scalar 10551    R(4)            4     1     999      COM                                                
 STN                        Common 10594                                4                                                           
 TDFC                       Scalar 10556    R(4)            4     1     255      COM                                                
 TDG                        Scalar 10576    L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 10567    R(4)            4     2     20979    COM                                                
 TDI                        Scalar 10578    R(4)            4     1     255      COM                                                
 TDIM                       Scalar 10566    R(4)            4     2     20979    COM                                                
 TDO                        Scalar 10556    R(4)            4     1     255      COM                                                
 TDV                        Scalar 10579    R(4)            4     1     255      COM                                                
 TDVM                       Scalar 10568    R(4)            4     2     20979    COM                                                
 TFC                        Scalar 10555    R(4)            4     1     255      COM                                                
 TG                         Scalar 10576    L(4)            4     2     20979    COM              10650                             
 THM                        Scalar 10567    R(4)            4     2     20979    COM                                                
 TI                         Scalar 10578    R(4)            4     1     255      COM                                                
 TIM                        Scalar 10566    R(4)            4     2     20979    COM              10650                             
 TINC                       Local  10595    R(4)            4     1     21                        10643,10650,10663                 
 TL                         Scalar 10579    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 10585    R(4)            4     1     255      COM                                                
 TOB                        Scalar 10555    R(4)            4     1     255      COM                                                
 TQM                        Scalar 10555    R(4)            4     1     255      COM                                                
 TRC                        Scalar 10555    R(4)            4     1     255      COM                                                
 TT                         Scalar 10591    R(4)            4           scalar   COM                                                
 TV                         Scalar 10579    R(4)            4     1     255      COM                                                
 TVM                        Scalar 10568    R(4)            4     2     20979    COM                                                
 TVO                        Scalar 10556    R(4)            4     1     255      COM                                                

Page 357         Source Listing                  PRSTNS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UFC                        Scalar 10563    R(4)            4     1     255      COM                                                
 UIM                        Scalar 10588    R(4)            4     2     20979    COM              10626                             
 UINC                       Local  10595    R(4)            4     1     21                        10626,10633                       
 UOB                        Scalar 10563    R(4)            4     1     255      COM                                                
 VFC                        Scalar 10563    R(4)            4     1     255      COM                                                
 VIM                        Scalar 10588    R(4)            4     2     20979    COM              10627                             
 VINC                       Local  10595    R(4)            4     1     21                        10627,10633                       
 VOB                        Scalar 10563    R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 10590    R(4)            4           scalar   COM                                                
 WIND                       Dummy  10548    L(4)            4           scalar   ARG,INOUT        10612,10620                       
 WQM                        Scalar 10564    R(4)            4     1     255      COM                                                
 WRC                        Scalar 10564    R(4)            4     1     255      COM                                                
 XDR                        Scalar 10560    R(4)            4     1     255      COM                                                
 XMA                        Scalar 10590    R(4)            4           scalar   COM                                                
 XMI                        Scalar 10590    R(4)            4           scalar   COM                                                
 XOB                        Scalar 10550    R(4)            4     1     999      COM                                                
 XQHM                       Scalar 10575    R(4)            4     2     20979    COM                                                
 XQI                        Scalar 10581    R(4)            4     1     255      COM                                                
 XQIM                       Scalar 10571    R(4)            4     2     20979    COM                                                
 XQV                        Scalar 10583    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 10587    R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 10574    R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 10581    R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 10570    R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 10583    R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 10573    R(4)            4     2     20979    COM                                                
 XTH                        Scalar 10586    R(4)            4     1     255      COM                                                
 XTHM                       Scalar 10573    R(4)            4     2     20979    COM                                                
 XTI                        Scalar 10581    R(4)            4     1     255      COM                                                
 XTIM                       Scalar 10570    R(4)            4     2     20979    COM                                                
 XTV                        Scalar 10583    R(4)            4     1     255      COM                                                
 XTVM                       Scalar 10571    R(4)            4     2     20979    COM                                                
 XZH                        Scalar 10586    R(4)            4     1     255      COM                                                
 XZHM                       Scalar 10572    R(4)            4     2     20979    COM                                                
 XZI                        Scalar 10581    R(4)            4     1     255      COM                                                
 XZIM                       Scalar 10570    R(4)            4     2     20979    COM                                                
 XZV                        Scalar 10583    R(4)            4     1     255      COM                                                
 XZVM                       Scalar 10571    R(4)            4     2     20979    COM                                                
 YDR                        Scalar 10560    R(4)            4     1     255      COM                                                
 YMA                        Scalar 10590    R(4)            4           scalar   COM                                                
 YMI                        Scalar 10590    R(4)            4           scalar   COM                                                
 YOB                        Scalar 10550    R(4)            4     1     999      COM                                                
 ZD                         Scalar 10586    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 10554    R(4)            4     1     255      COM                                                
 ZFCW                       Scalar 10562    R(4)            4     1     255      COM                                                
 ZG                         Scalar 10576    L(4)            4     2     20979    COM              10649                             
 ZHM                        Scalar 10567    R(4)            4     2     20979    COM                                                
 ZI                         Scalar 10578    R(4)            4     1     255      COM              10657                             
 ZIM                        Scalar 10566    R(4)            4     2     20979    COM              10649                             
 ZINC                       Local  10595    R(4)            4     1     21                        10642,10649,10663                 
 ZOB                        Scalar 10554    R(4)            4     1     255      COM                                                
 ZOBW                       Scalar 10562    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 10554    R(4)            4     1     255      COM                                                
 ZQMW                       Scalar 10562    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 10554    R(4)            4     1     255      COM                                                

Page 358         Source Listing                  PRSTNS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZRCW                       Scalar 10562    R(4)            4     1     255      COM                                                
 ZSINC                      Local  10657    R(4)            4           scalar                    10657,10659,10664                 
 ZV                         Scalar 10579    R(4)            4     1     255      COM                                                
 ZVM                        Scalar 10568    R(4)            4     2     20979    COM                                                

Page 359         Source Listing                  PRSTNS
2017-04-18 11:07                                 cqcbufr.f

  10676 
  10677 C******************************************************************
  10678 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
  10679 C                .      .    .                                       .
  10680 C SUBPROGRAM:    QCOI        THE QC ANALYSIS KERNAL
  10681 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-03-24
  10682 C
  10683 C ABSTRACT: COMPUTES AND SETS UP THE COEFFIENT MATRIX AND RIGHT
  10684 C   HAND SIDES.  SOLVES THE MATRIX PROBLEMS. APPLIES THE COMPUTED
  10685 C   WEIGHTS TO THE RESIDUALS TO OBTAIN THE ANALYSIS INCREMENTS AND
  10686 C   ANALYSIS ERRORS.
  10687 C
  10688 C PROGRAM HISTORY LOG:
  10689 C 1988-02-05 D. Deaven   Original author.
  10690 C 1990-03-24 J. Woollen  ?????.
  10691 C
  10692 C USAGE:    CALL QCOI(LDIM,IDIM,L0,IV0,NOB1,NOB2,IDH,OINC,HRES,HSTD,
  10693 C                     WTS)
  10694 C   INPUT ARGUMENTS:
  10695 C     LDIM     - L-DIMENSION OF MATRIX
  10696 C     IDIM     - I-DIMENSION OF MATRIX
  10697 C     L0       - 
  10698 C     IV0      - 
  10699 C     NOB1     - 
  10700 C     NOB2     - 
  10701 C     IDH      - 
  10702 C     OINC     - 
  10703 C   OUTPUT ARGUMENTS:
  10704 C     HRES     - ANALYSIS INCREMENTS
  10705 C     HSTD     - ANALYSIS STANDARD DEVIATION
  10706 C     WTS      - COMPUTED WEIGHTS
  10707 C
  10708 C REMARKS: NONE.
  10709 C
  10710 C ATTRIBUTES:
  10711 C   LANGUAGE: FORTRAN 90
  10712 C   MACHINE:  NCEP WCOSS
  10713 C
  10714 C$$$
  10715 C-----------------------------------------------------------------------
  10716       SUBROUTINE QCOI(LDIM,IDIM,L0,IV0,NOB1,NOB2,IDH,OINC,HRES,HSTD,WTS)
  10717       PARAMETER (NST=999)
  10718 
  10719       REAL(8) BMISS
  10720 
  10721       DIMENSION IDH (4,LDIM,IDIM,NOBN)
  10722       DIMENSION OINC(  LDIM,IDIM,NOBN)
  10723       DIMENSION HRES(  LDIM,IDIM,NOB1:NOB2)
  10724       DIMENSION HSTD(  LDIM,IDIM,NOB1:NOB2)
  10725       DIMENSION WTS (4,LDIM,IDIM,NOB1:NOB2)
  10726 
  10727       COMMON /OBLIST/ NOBN,INOB(1000),IMAP(360,181)
  10728       COMMON /CORP  / CHLP(0:1500),CVC,IFA(4,4)
  10729       COMMON /LEVEL/   PMAND(21)
  10730       COMMON /HEADER/  CID(NST), DHR(NST), SLON(NST), SLAT(NST),
  10731      &                 SELV(NST), SQN(NST), ITP(NST), NLV,
  10732      &                 NEV, ISF(NST), NLVM, NLVW

Page 360         Source Listing                  QCOI
2017-04-18 11:07                                 cqcbufr.f

  10733       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  10734 
  10735       CHARACTER*8 CID
  10736 
  10737       DIMENSION  NCIND(1000+1),NDIM(1000),NKOBS(4000),
  10738      .           XXCP(4000),YYCP(4000),IICP(4000),
  10739      .           XXOBS(4000),YYOBS(4000),FCAOBS(4000),
  10740      .           CHTWV(10000),DIST(10000),ZZ(10000),
  10741      .           XXI(10000),YYI(10000),XXJ(10000),YYJ(10000)
  10742 
  10743       DIMENSION FAALL(1000,10),RAALL(1000,4,1),DOTPRD(1000,1)
  10744 
  10745       DATA MAXDIM /4/
  10746       DATA MINDIM /2/
  10747       DATA MAXOBS /1000/
  10748       DATA NFT    /1/
  10749 
  10750 C-----------------------------------------------------------------------
  10751 C-----------------------------------------------------------------------
  10752 
  10753 C  SEE IF THIS IS A ONE SHOT DEAL
  10754 C  ------------------------------
  10755 
  10756       IF(NOB1.EQ.NOB2) THEN
  10757          L1   = L0
  10758          L2   = L0
  10759          IV1  = IV0
  10760          IV2  = IV0
  10761       ELSE
  10762          L1   = 1
  10763          L2   = L0
  10764          IV1  = 1
  10765          IV2  = IV0
  10766       ENDIF
  10767 
  10768 C  LOOP OVER VARIABLES AND LEVELS
  10769 C  ------------------------------
  10770 
  10771       DO IV=IV1,IV2
  10772         DO LEV=L1,L2
  10773 
  10774           LL = LEV
  10775           IPRES = PMAND(LL)
  10776 
  10777 C  CLEAR OUT THE GARBAGE IN THE MATRIX ARRAYS
  10778 C  ------------------------------------------
  10779 
  10780           DO J=1,MAXDIM*(MAXDIM+1)/2
  10781             DO I=1,MAXOBS
  10782               FAALL(I,J) = 0.
  10783             ENDDO
  10784           ENDDO
  10785 
  10786           DO K=1,NFT
  10787             DO J=1,MAXDIM
  10788               DO I=1,MAXOBS
  10789                 RAALL(I,J,K) = 0.

Page 361         Source Listing                  QCOI
2017-04-18 11:07                                 cqcbufr.f

  10790               ENDDO
  10791             ENDDO
  10792           ENDDO
  10793 
  10794           DO NOB=NOB1,NOB2
  10795             HRES(LEV,IV,NOB) = BMISS
  10796             HSTD(LEV,IV,NOB) = BMISS
  10797             DO I=1,4
  10798               WTS(I,LEV,IV,NOB) = 0.
  10799             ENDDO
  10800           ENDDO
  10801 
  10802 C  STORE THE DATA INDEXS FOR THIS LEVEL
  10803 C  ------------------------------------
  10804 
  10805           IVMAX = 0
  10806           NXXYY = 0
  10807           NCIND(1) = 1
  10808 
  10809           DO NOB=NOB1,NOB2
  10810             NXXYY = NXXYY + 1
  10811             MDIM  = 0
  10812             IF(IDH(MINDIM,LEV,IV,NOB).NE.0) THEN
  10813               DO N=1,MAXDIM
  10814                 INDEX = IDH(N,LEV,IV,NOB)
  10815                 IF(INDEX.NE.0) THEN
  10816                   IVMAX = IVMAX + 1
  10817                   IICP(IVMAX) = NOB
  10818                   NKOBS(IVMAX) = INDEX
  10819                   IF(N.GE.MINDIM) MDIM = N
  10820                 ENDIF
  10821               ENDDO
  10822             ENDIF
  10823             NDIM(NXXYY) = MDIM
  10824             NCIND(NXXYY+1) = NCIND(NXXYY) + MDIM
  10825           ENDDO
  10826 
  10827 C  PULL THE OBSERVATION INFORMATION OUT OF STORAGE
  10828 C  -----------------------------------------------
  10829 
  10830           DO I=1,IVMAX
  10831             IOB = IICP(I)
  10832             NOB = NKOBS(I)
  10833             XXCP(I)   = SLON(IOB)
  10834             YYCP(I)   = SLAT(IOB)
  10835             XXOBS(I)  = SLON(NOB)
  10836             YYOBS(I)  = SLAT(NOB)
  10837             FCAOBS(I) = OINC(LEV,IV,NOB)
  10838             CHTWV(I)  = CHLP(IPRES)
  10839           ENDDO
  10840 
  10841 C  INITIALIZE THE MATRIX DIAGONAL TERMS
  10842 C  ------------------------------------
  10843 
  10844           DO IGRP=1,NXXYY
  10845             DO IOB=1,NDIM(IGRP)
  10846               FAALL(IGRP,IFA(IOB,IOB)) = 1.5

Page 362         Source Listing                  QCOI
2017-04-18 11:07                                 cqcbufr.f

  10847             ENDDO
  10848           ENDDO
  10849 
  10850 C  COMPUTE THE RIGHT HAND SIDES
  10851 C  ----------------------------
  10852 
  10853           CALL COORS(IVMAX,CHTWV,XXOBS,YYOBS,XXCP,YYCP,DIST,ZZ)
  10854 
  10855 C  STACK THE RHS TERMS IN THE SOLVER ARRAY
  10856 C  ---------------------------------------
  10857 
  10858           DO IGRP=1,NXXYY
  10859             DO IOB=1,NDIM(IGRP)
  10860               I = NCIND(IGRP) + IOB - 1
  10861               RAALL(IGRP,IOB,1) = ZZ(I)
  10862             ENDDO
  10863           ENDDO
  10864 
  10865 C  COMPUTE THE MATRIX TERMS AND STORE IN THE SOLVER
  10866 C  ------------------------------------------------
  10867 
  10868           M = 0
  10869           DO IGRP=1,NXXYY
  10870             IF(NDIM(IGRP).GT.0) THEN
  10871               DO IOB = 1,NDIM(IGRP)-1
  10872                 DO JOB = IOB+1,NDIM(IGRP)
  10873                   I = NCIND(IGRP) + IOB - 1
  10874                   J = NCIND(IGRP) + JOB - 1
  10875                   M = M+1
  10876                   XXI(M)   = XXOBS(I)
  10877                   YYI(M)   = YYOBS(I)
  10878                   XXJ(M)   = XXOBS(J)
  10879                   YYJ(M)   = YYOBS(J)
  10880                   CHTWV(M) = CHLP(IPRES)
  10881                 ENDDO
  10882               ENDDO
  10883             ENDIF
  10884           ENDDO
  10885 
  10886           CALL COORS(M,CHTWV,XXI,YYI,XXJ,YYJ,DIST,ZZ)
  10887 
  10888           M = 0
  10889           DO IGRP=1,NXXYY
  10890             IF(NDIM(IGRP).GT.0) THEN
  10891               DO IOB = 1,NDIM(IGRP)-1
  10892                 DO JOB = IOB+1,NDIM(IGRP)
  10893                   M = M+1
  10894                   FAALL(IGRP,IFA(IOB,JOB)) = ZZ(M)
  10895                 ENDDO
  10896               ENDDO
  10897             ENDIF
  10898           ENDDO
  10899 
  10900 C  CALL THE MATRIX SOLVER
  10901 C------------------------
  10902 
  10903           CALL DRCTSL(FAALL,RAALL,DOTPRD,NDIM,MAXDIM,NXXYY,NFT,LEV,IV)

Page 363         Source Listing                  QCOI
2017-04-18 11:07                                 cqcbufr.f

  10904 
  10905 C  AFTER SOLUTION OF ALL THE PROBLEMS STORE THE RESULTS
  10906 C  ----------------------------------------------------
  10907 
  10908           DO IGRP=1,NXXYY
  10909             IF(NDIM(IGRP).GT.0 .AND. DOTPRD(IGRP,1).GT.0.) THEN
  10910               NNOB = IICP(NCIND(IGRP))
  10911               SUM = 0.
  10912               DO IOB=1,NDIM(IGRP)
  10913                 I = NCIND(IGRP) + IOB - 1
  10914                 SUM = SUM + FCAOBS(I) * RAALL(IGRP,IOB,1)
  10915                 WTS(IOB,LEV,IV,NNOB) = RAALL(IGRP,IOB,1)
  10916               ENDDO
  10917               IF(ABS(OINC(LEV,IV,NNOB)).LT.BMISS) THEN
  10918                 HRES(LEV,IV,NNOB) = OINC(LEV,IV,NNOB) - SUM
  10919                 IF(ABS(HRES(LEV,IV,NNOB)).GT.10000.)
  10920      &            HRES(LEV,IV,NNOB) = BMISS
  10921               ELSE
  10922                 HRES(LEV,IV,NNOB) = BMISS
  10923               ENDIF
  10924               HSTD(LEV,IV,NNOB) = SQRT(1.5 - DOTPRD(IGRP,1))
  10925             ENDIF
  10926           ENDDO
  10927 
  10928         ENDDO
  10929       ENDDO
  10930 
  10931       RETURN
  10932       END

Page 364         Source Listing                  QCOI
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 qcoi_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   10917                                scalar                    10917,10919                       
 BMISS                      Scalar 10719    R(8)            8           scalar   COM              10795,10796,10917,10920,10922     
 BUFRLIB_MISSING            Common 10733                                16                                                          
 CHLP                       Scalar 10728    R(4)            4     1     1501     COM              10838,10880                       
 CHTWV                      Local  10740    R(4)            4     1     10000                     10838,10853,10880,10886           
 CID                        Scalar 10730    CHAR            8     1     999      COM                                                
 COORS                      Subr   10853                                                          10853,10886                       
 CORP                       Common 10728                                6072                                                        
 CVC                        Scalar 10728    R(4)            4           scalar   COM                                                
 DHR                        Scalar 10730    R(4)            4     1     999      COM                                                
 DIST                       Local  10740    R(4)            4     1     10000                     10853,10886                       
 DOTPRD                     Local  10743    R(4)            4     2     1000                      10903,10909,10924                 
 DRCTSL                     Subr   10903                                                          10903                             
 FAALL                      Local  10743    R(4)            4     2     10000                     10782,10846,10894,10903           
 FCAOBS                     Local  10739    R(4)            4     1     4000                      10837,10914                       
 HEADER                     Common 10730                                35980                                                       
 HRES                       Dummy  10716    R(4)            4     3     0        ARG,INOUT        10795,10918,10919,10920,10922     
 HSTD                       Dummy  10716    R(4)            4     3     0        ARG,INOUT        10796,10924                       
 I                          Local  10781    I(4)            4           scalar                    10781,10782,10788,10789,10797,1079
                                                                                                  8,10830,10831,10832,10833,10834,10
                                                                                                  835,10836,10837,10838,10860,10861,
                                                                                                  10873,10876,10877,10913,10914     
 IDH                        Dummy  10716    I(4)            4     4     0        ARG,INOUT        10812,10814                       
 IDIM                       Dummy  10716    I(4)            4           scalar   ARG,INOUT        10721,10722,10723,10724,10725     
 IFA                        Scalar 10728    I(4)            4     2     16       COM              10846,10894                       
 IGRP                       Local  10844    I(4)            4           scalar                    10844,10845,10846,10858,10859,1086
                                                                                                  0,10861,10869,10870,10871,10872,10
                                                                                                  873,10874,10889,10890,10891,10892,
                                                                                                  10894,10908,10909,10910,10912,1091
                                                                                                  3,10914,10915,10924               
 IICP                       Local  10738    I(4)            4     1     4000                      10817,10831,10910                 
 IMAP                       Scalar 10727    I(4)            4     2     65160    COM                                                
 IMISS                      Scalar 10733    I(4)            4           scalar   COM                                                
 INDEX                      Local  10814    I(4)            4           scalar                    10814,10815,10818                 
 INOB                       Scalar 10727    I(4)            4     1     1000     COM                                                
 IOB                        Local  10831    I(4)            4           scalar                    10831,10833,10834,10845,10846,1085
                                                                                                  9,10860,10861,10871,10872,10873,10
                                                                                                  891,10892,10894,10912,10913,10914,
                                                                                                  10915                             
 IPRES                      Local  10775    I(4)            4           scalar                    10775,10838,10880                 
 ISF                        Scalar 10732    I(4)            4     1     999      COM                                                
 ITP                        Scalar 10731    I(4)            4     1     999      COM                                                
 IV                         Local  10771    I(4)            4           scalar                    10771,10795,10796,10798,10812,1081
                                                                                                  4,10837,10903,10915,10917,10918,10

Page 365         Source Listing                  QCOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  919,10920,10922,10924             
 IV0                        Dummy  10716    I(4)            4           scalar   ARG,INOUT        10759,10760,10765                 
 IV1                        Local  10759    I(4)            4           scalar                    10759,10764,10771                 
 IV2                        Local  10760    I(4)            4           scalar                    10760,10765,10771                 
 IVMAX                      Local  10805    I(4)            4           scalar                    10805,10816,10817,10818,10830,1085
                                                                                                  3                                 
 J                          Local  10780    I(4)            4           scalar                    10780,10782,10787,10789,10874,1087
                                                                                                  8,10879                           
 JOB                        Local  10872    I(4)            4           scalar                    10872,10874,10892,10894           
 K                          Local  10786    I(4)            4           scalar                    10786,10789                       
 L0                         Dummy  10716    I(4)            4           scalar   ARG,INOUT        10757,10758,10763                 
 L1                         Local  10757    I(4)            4           scalar                    10757,10762,10772                 
 L2                         Local  10758    I(4)            4           scalar                    10758,10763,10772                 
 LDIM                       Dummy  10716    I(4)            4           scalar   ARG,INOUT        10721,10722,10723,10724,10725     
 LEV                        Local  10772    I(4)            4           scalar                    10772,10774,10795,10796,10798,1081
                                                                                                  2,10814,10837,10903,10915,10917,10
                                                                                                  918,10919,10920,10922,10924       
 LEVEL                      Common 10729                                84                                                          
 LL                         Local  10774    I(4)            4           scalar                    10774,10775                       
 M                          Local  10868    I(4)            4           scalar                    10868,10875,10876,10877,10878,1087
                                                                                                  9,10880,10886,10888,10893,10894   
 MAXDIM                     Local  10745    I(4)            4           scalar                    10745,10780,10787,10813,10903     
 MAXOBS                     Local  10747    I(4)            4           scalar                    10747,10781,10788                 
 MDIM                       Local  10811    I(4)            4           scalar                    10811,10819,10823,10824           
 MINDIM                     Local  10746    I(4)            4           scalar                    10746,10812,10819                 
 N                          Local  10813    I(4)            4           scalar                    10813,10814,10819                 
 NCIND                      Local  10737    I(4)            4     1     1001                      10807,10824,10860,10873,10874,1091
                                                                                                  0,10913                           
 NDIM                       Local  10737    I(4)            4     1     1000                      10823,10845,10859,10870,10871,1087
                                                                                                  2,10890,10891,10892,10903,10909,10
                                                                                                  912                               
 NEV                        Scalar 10732    I(4)            4           scalar   COM                                                
 NFT                        Local  10748    I(4)            4           scalar                    10748,10786,10903                 
 NKOBS                      Local  10737    I(4)            4     1     4000                      10818,10832                       
 NLV                        Scalar 10731    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 10732    I(4)            4           scalar   COM                                                
 NLVW                       Scalar 10732    I(4)            4           scalar   COM                                                
 NNOB                       Local  10910    I(4)            4           scalar                    10910,10915,10917,10918,10919,1092
                                                                                                  0,10922,10924                     
 NOB                        Local  10794    I(4)            4           scalar                    10794,10795,10796,10798,10809,1081
                                                                                                  2,10814,10817,10832,10835,10836,10
                                                                                                  837                               
 NOB1                       Dummy  10716    I(4)            4           scalar   ARG,INOUT        10723,10724,10725,10756,10794,1080
                                                                                                  9                                 
 NOB2                       Dummy  10716    I(4)            4           scalar   ARG,INOUT        10723,10724,10725,10756,10794,1080
                                                                                                  9                                 
 NOBN                       Scalar 10727    I(4)            4           scalar   COM              10721,10722                       
 NST                        Param  10717    I(4)            4           scalar                    10730,10731,10732                 
 NXXYY                      Local  10806    I(4)            4           scalar                    10806,10810,10823,10824,10844,1085
                                                                                                  8,10869,10889,10903,10908         
 OBLIST                     Common 10727                                264644                                                      
 OINC                       Dummy  10716    R(4)            4     3     0        ARG,INOUT        10837,10917,10918                 
 PMAND                      Scalar 10729    R(4)            4     1     21       COM              10775                             
 QCOI                       Subr   10716                                                                                            
 RAALL                      Local  10743    R(4)            4     3     4000                      10789,10861,10903,10914,10915     

Page 366         Source Listing                  QCOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SELV                       Scalar 10731    R(4)            4     1     999      COM                                                
 SLAT                       Scalar 10730    R(4)            4     1     999      COM              10834,10836                       
 SLON                       Scalar 10730    R(4)            4     1     999      COM              10833,10835                       
 SQN                        Scalar 10731    R(4)            4     1     999      COM                                                
 SQRT                       Func   10924                                scalar                    10924                             
 SUM                        Local  10911    R(4)            4           scalar                    10911,10914,10918                 
 WTS                        Dummy  10716    R(4)            4     4     0        ARG,INOUT        10798,10915                       
 XMISS                      Scalar 10733    R(4)            4           scalar   COM                                                
 XXCP                       Local  10738    R(4)            4     1     4000                      10833,10853                       
 XXI                        Local  10741    R(4)            4     1     10000                     10876,10886                       
 XXJ                        Local  10741    R(4)            4     1     10000                     10878,10886                       
 XXOBS                      Local  10739    R(4)            4     1     4000                      10835,10853,10876,10878           
 YYCP                       Local  10738    R(4)            4     1     4000                      10834,10853                       
 YYI                        Local  10741    R(4)            4     1     10000                     10877,10886                       
 YYJ                        Local  10741    R(4)            4     1     10000                     10879,10886                       
 YYOBS                      Local  10739    R(4)            4     1     4000                      10836,10853,10877,10879           
 ZZ                         Local  10740    R(4)            4     1     10000                     10853,10861,10886,10894           

Page 367         Source Listing                  QCOI
2017-04-18 11:07                                 cqcbufr.f

  10933 
  10934 C**********************************************************************     
  10935 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  10936 C                .      .    .                                       .
  10937 C SUBPROGRAM:    RBLOCKS     READ INPUT BLOCKS FOR SINGLE STATION VER
  10938 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  10939 C
  10940 C ABSTRACT: Read all data necessary to perform cqcht, one station at
  10941 C   a time.  This is called only if SINGLE = .true. and if a previous
  10942 C   full run has produced the necessary file. This is most useful for
  10943 C   testing new logic and runs well on a workstation.  When run in
  10944 C   this way, only the Csubroutines in part1 are needed (up through
  10945 C   ZDIF).  See Collins for particulars.
  10946 C
  10947 C PROGRAM HISTORY LOG:
  10948 C 1997-03-18  W. Collins  Original author.
  10949 C
  10950 C USAGE:    CALL RBLOCKS(SKIP,WIND,ENDIN)
  10951 C   OUTPUT ARGUMENT LIST:
  10952 C     SKIP     - SET TO .FALSE.
  10953 C     WIND     - SET TO .FALSE.
  10954 C     ENDIN    - SET TO .TRUE. AT END OF SUBROUTINE
  10955 C
  10956 C   INPUT FILES:
  10957 C     UNIT NFSGL  - ASCII FILE OF ALL DATA NECESSARY TO RUN SINGLE
  10958 C                   STATION VERSION OF THIS CODE
  10959 C
  10960 C   OUTPUT FILES:
  10961 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  10962 C
  10963 C REMARKS: NONE.
  10964 C
  10965 C ATTRIBUTES:
  10966 C   LANGUAGE: FORTRAN 90
  10967 C   MACHINE:  NCEP WCOSS
  10968 C
  10969 C$$$
  10970 
  10971       SUBROUTINE RBLOCKS(SKIP,WIND,ENDIN)
  10972       PARAMETER (NST=999)
  10973 
  10974       REAL(8) BMISS
  10975 
  10976       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  10977      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  10978      &                 NEV, ISF(NST), NLVM, NLVW
  10979       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  10980      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  10981      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  10982      &                 TDO(255), TDFC(255),TVO(255),
  10983      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  10984      &                 CAT(255), IND(255), LEVTYP(255),
  10985      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  10986      &                 YDR(255), XDR(255)
  10987       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  10988      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  10989      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),

Page 368         Source Listing                  RBLOCKS
2017-04-18 11:07                                 cqcbufr.f

  10990      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  10991      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
  10992      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  10993      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  10994      &                 XTHM(21,NST),XTDVM(21,NST),
  10995      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  10996      &                 XQHM(21,NST),
  10997      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  10998      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  10999       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  11000      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  11001      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  11002      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  11003      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  11004      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  11005      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  11006      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  11007      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  11008      &                 XTDH(255)
  11009       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  11010      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  11011       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
  11012       COMMON /STN/     IS
  11013       COMMON /DATEX/   JDATE(5), CDATE
  11014       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  11015 
  11016       CHARACTER*8      SID
  11017       CHARACTER*10     CDATE
  11018       COMMON /MANSND/  ZM(21,NST), TM(21,NST), TDM(21), QM(21), MANDL,
  11019      &                 MANDF, ZFM(21), TFM(21), QFM(21), PM(21)
  11020       COMMON /TESTS/   TEST
  11021       LOGICAL          TEST
  11022       REAL             P(255,23)
  11023       INTEGER          IP(255,3)
  11024       LOGICAL SKIP,WIND,ENDIN,PRNT
  11025       LOGICAL ZG, TG, TDG, QG, ERROR
  11026       DATA BMS /99999.99/, QBMS /9.999999/
  11027       IBMS = BMS
  11028 
  11029 C  INITIALIZE QUANTITIES AND SET HORIZONTAL RESIDUALS TO BMISS
  11030 C  -----------------------------------------------------------
  11031 
  11032       PRNT  = .FALSE.
  11033       SKIP  = .FALSE.
  11034       WIND  = .FALSE.
  11035       ENDIN = .FALSE.
  11036       DO I=1,21
  11037         NHYD(I) = -1
  11038         NHYDN(I) = -1
  11039       ENDDO
  11040       DO J=1,NST
  11041         DO I=1,21
  11042           ZHM(I,J)   = BMISS
  11043           THM(I,J)   = BMISS
  11044           TDHM(I,J)  = BMISS
  11045           QHM(I,J)   = BMISS
  11046           NZHM(I,J)  = -1

Page 369         Source Listing                  RBLOCKS
2017-04-18 11:07                                 cqcbufr.f

  11047           NTHM(I,J)  = -1
  11048           NTDHM(I,J) = -1
  11049           NQHM(I,J)  = -1
  11050         ENDDO
  11051       ENDDO
  11052       IS    = 1
  11053       NOBS  = IS
  11054 
  11055 C  READ CONTENTS OF COMMON BLOCKS FROM UNIT 55, FORMATTED FOR EDITING
  11056 C  ------------------------------------------------------------------
  11057 
  11058       IF(TEST) WRITE(60,505)
  11059   505 FORMAT(' RBLOCKS--')
  11060       READ(NFSGL,500,END=100,ERR=100) CDATE,(JDATE(I),I=1,4)
  11061       IF(TEST) WRITE(60,500) CDATE,(JDATE(I),I=1,4)
  11062   500 FORMAT(2X,A10,2X,4I2)
  11063       READ(NFSGL,501,END=100,ERR=100) SID(IS),DHR(IS),XOB(IS),YOB(IS),
  11064      &                 ELV(IS), SQN(IS), ITP(IS), NLV,
  11065      &                 NEV, ISF(IS), NLVM, NLVW
  11066       IF(TEST) WRITE(60,5501) SID(IS), DHR(IS), XOB(IS), YOB(IS),
  11067      &                 ELV(IS), SQN(IS), ITP(IS), NLV,
  11068      &                 NEV, ISF(IS), NLVM, NLVW
  11069   501 FORMAT(2X,A8,4F10.2,F10.0,6I10)
  11070  5501 FORMAT(2X,A8,4F10.2,F10.0,I10.3,5I10)
  11071       READ(NFSGL,503,END=100,ERR=100) MANDL,MANDF,PS(IS),GESPS(IS)
  11072   503 FORMAT(2I10,2F10.2)
  11073       PIS(IS) = PS(IS) - GESPS(IS)
  11074       DO I=1,NLV
  11075         READ(NFSGL,502,END=100,ERR=100) (P(I,J),J=1,23),(IP(I,K),K=1,3)
  11076       ENDDO
  11077   502 FORMAT(4F10.2,F10.6,5F10.2,F10.6,9F10.2,3F10.4,3I10)
  11078 
  11079       NLVM = NLV
  11080       NLEV = NLV
  11081       DO L=1,NLV
  11082         DO I=1,23
  11083           IF(P(L,I).EQ.BMS) P(L,I) = BMISS
  11084         ENDDO
  11085         IF(P(L,5).EQ.QBMS)  P(L,5) = BMISS
  11086         IF(P(L,11).EQ.QBMS) P(L,11) = BMISS
  11087         DO I=1,3
  11088           IF(IP(L,I).EQ.IBMS) IP(L,I) = BMISS
  11089         ENDDO
  11090       ENDDO
  11091 
  11092       DO L=1,NLV
  11093         POB(L) = P(L,1)
  11094         ZOB(L) = P(L,2)
  11095         TOB(L) = P(L,3)
  11096         TDO(L) = P(L,4)
  11097         QOB(L) = P(L,5)
  11098         TVO(L) = P(L,6)
  11099         PFC(L) = P(L,7)
  11100         ZFC(L) = P(L,8)
  11101         TFC(L) = P(L,9)
  11102         TDFC(L) = P(L,10)
  11103         QFC(L) = P(L,11)

Page 370         Source Listing                  RBLOCKS
2017-04-18 11:07                                 cqcbufr.f

  11104         PQM(L) = P(L,12)
  11105         ZQM(L) = P(L,13)
  11106         TQM(L) = P(L,14)
  11107         QQM(L) = P(L,15)
  11108         PRC(L) = P(L,16)
  11109         ZRC(L) = P(L,17)
  11110         TRC(L) = P(L,18)
  11111         QRC(L) = P(L,19)
  11112         CAT(L) = P(L,20)
  11113         HRDR(L)= P(L,21)
  11114         YDR(L) = P(L,22)
  11115         XDR(L) = P(L,23)
  11116         IND(L) = IP(L,1)
  11117         LEVTYP(L) = IP(L,2)
  11118         LST(L) = IP(L,3)
  11119       ENDDO
  11120 
  11121 C  FILL MANDATORY LEVEL FIELDS
  11122 C  ---------------------------
  11123 
  11124       DO I=1,NLV
  11125         L = MANLEV(POB(I))
  11126         IF(L.NE.0) THEN
  11127           PM(L) = POB(I)
  11128           ZM(L,IS) = ZOB(I)
  11129           TM(L,IS) = TOB(I)
  11130           TDM(L) = TDO(I)
  11131           QM(L) = QOB(L)
  11132           ZFM(L) = ZFC(I)
  11133           TFM(L) = TFC(I)
  11134           QFM(L) = QFC(I)
  11135         ENDIF
  11136       ENDDO
  11137 
  11138       RETURN
  11139 
  11140   100 CONTINUE
  11141       ENDIN = .TRUE.
  11142 
  11143       RETURN
  11144       END

Page 371         Source Listing                  RBLOCKS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 rblocks_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  11140                                                          11060,11063,11071,11075           
 500                        Label  11062                                                          11060,11061                       
 501                        Label  11069                                                          11063                             
 502                        Label  11077                                                          11075                             
 503                        Label  11072                                                          11071                             
 505                        Label  11059                                                          11058                             
 5501                       Label  11070                                                          11066                             
 ALLSND                     Common 10979                                34512                                                       
 B                          Scalar 11007    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 11006    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 10974    R(8)            8           scalar   COM              11042,11043,11044,11045,11083,1108
                                                                                                  5,11086,11088                     
 BMS                        Local  11026    R(4)            4           scalar                    11026,11027,11083                 
 BRES                       Scalar 10998    R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 11014                                16                                                          
 CAT                        Scalar 10984    R(4)            4     1     255      COM              11112                             
 CDATE                      Scalar 11013    CHAR            10          scalar   COM              11060,11061                       
 CQCPC                      Scalar 11010    R(4)            4           scalar   COM                                                
 DATEX                      Common 11013                                30                                                          
 DHR                        Scalar 10976    R(4)            4     1     999      COM              11063,11066                       
 ELV                        Scalar 10977    R(4)            4     1     999      COM              11064,11067                       
 ENDIN                      Dummy  10971    L(4)            4           scalar   ARG,INOUT        11035,11141                       
 ERROR                      Scalar 10998    L(4)            4     1     999      COM                                                
 FILES                      Common 11011                                24                                                          
 GESPS                      Scalar 10985    R(4)            4     1     999      COM              11071,11073                       
 HEADER                     Common 10976                                35980                                                       
 HRDR                       Scalar 10985    R(4)            4     1     255      COM              11113                             
 HYD                        Scalar 11005    R(4)            4     1     21       COM                                                
 HYDM                       Scalar 10998    R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 11005    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 11005    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 11005    R(4)            4     1     21       COM                                                
 I                          Local  11036    I(4)            4           scalar                    11036,11037,11038,11041,11042,1104
                                                                                                  3,11044,11045,11046,11047,11048,11
                                                                                                  049,11060,11061,11074,11075,11082,
                                                                                                  11083,11087,11088,11124,11125,1112
                                                                                                  7,11128,11129,11130,11132,11133,11
                                                                                                  134                               
 IBMS                       Local  11027    I(4)            4           scalar                    11027,11088                       
 IHSC                       Scalar 11006    I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 11014    I(4)            4           scalar   COM                                                
 IND                        Scalar 10984    I(4)            4     1     255      COM              11116                             
 IP                         Local  11023    I(4)            4     2     765                       11075,11088,11116,11117,11118     
 IPEVT                      Scalar 11010    I(4)            4           scalar   COM                                                

Page 372         Source Listing                  RBLOCKS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IS                         Scalar 11012    I(4)            4           scalar   COM              11052,11053,11063,11064,11065,1106
                                                                                                  6,11067,11068,11071,11073,11128,11
                                                                                                  129                               
 ISC                        Scalar 11010    I(4)            4           scalar   COM                                                
 ISF                        Scalar 10978    I(4)            4     1     999      COM              11065,11068                       
 ITP                        Scalar 10977    I(4)            4     1     999      COM              11064,11067                       
 J                          Local  11040    I(4)            4           scalar                    11040,11042,11043,11044,11045,1104
                                                                                                  6,11047,11048,11049,11075         
 JDATE                      Scalar 11013    I(4)            4     1     5        COM              11060,11061                       
 K                          Local  11075    I(4)            4           scalar                    11075                             
 L                          Local  11081    I(4)            4           scalar                    11081,11083,11085,11086,11088,1109
                                                                                                  2,11093,11094,11095,11096,11097,11
                                                                                                  098,11099,11100,11101,11102,11103,
                                                                                                  11104,11105,11106,11107,11108,1110
                                                                                                  9,11110,11111,11112,11113,11114,11
                                                                                                  115,11116,11117,11118,11125,11126,
                                                                                                  11127,11128,11129,11130,11131,1113
                                                                                                  2,11133,11134                     
 LEVTYP                     Scalar 10984    I(4)            4     1     255      COM              11117                             
 LMAND                      Scalar 11010    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 11010    I(4)            4           scalar   COM                                                
 LST                        Scalar 10985    I(4)            4     1     255      COM              11118                             
 MAND                       Scalar 11009    I(4)            4           scalar   COM                                                
 MANDF                      Scalar 11019    I(4)            4           scalar   COM              11071                             
 MANDL                      Scalar 11018    I(4)            4           scalar   COM              11071                             
 MANLEV                     Func   11125    I(4)            4           scalar                    11125                             
 MANRES                     Common 10987                                2949048                                                     
 MANSND                     Common 11018                                168344                                                      
 NBAS                       Scalar 11007    I(4)            4           scalar   COM                                                
 NEV                        Scalar 10978    I(4)            4           scalar   COM              11065,11068                       
 NFEVN                      Scalar 11011    I(4)            4           scalar   COM                                                
 NFIN                       Scalar 11011    I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 11011    I(4)            4           scalar   COM                                                
 NFSGL                      Scalar 11011    I(4)            4           scalar   COM              11060,11063,11071,11075           
 NFSTN                      Scalar 11011    I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 11011    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 11005    I(4)            4     1     21       COM              11037                             
 NHYDN                      Scalar 11007    I(4)            4     1     21       COM              11038                             
 NLEV                       Scalar 11009    I(4)            4           scalar   COM              11080                             
 NLV                        Scalar 10977    I(4)            4           scalar   COM              11064,11067,11074,11079,11080,1108
                                                                                                  1,11092,11124                     
 NLVM                       Scalar 10978    I(4)            4           scalar   COM              11065,11068,11079                 
 NLVW                       Scalar 10978    I(4)            4           scalar   COM              11065,11068                       
 NOBS                       Scalar 11009    I(4)            4           scalar   COM              11053                             
 NQHM                       Scalar 10995    I(4)            4     2     20979    COM              11049                             
 NQI                        Scalar 11001    I(4)            4     1     255      COM                                                
 NQV                        Scalar 11003    I(4)            4     1     255      COM                                                
 NST                        Param  10972    I(4)            4           scalar                    10976,10977,10978,10985,10987,1098
                                                                                                  8,10989,10990,10991,10992,10993,10
                                                                                                  994,10995,10996,10997,10998,11006,
                                                                                                  11018,11040                       
 NTDHM                      Scalar 10995    I(4)            4     2     20979    COM              11048                             
 NTDI                       Scalar 11001    I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 10990    I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 11003    I(4)            4     1     255      COM                                                

Page 373         Source Listing                  RBLOCKS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTHM                       Scalar 10993    I(4)            4     2     20979    COM              11047                             
 NTI                        Scalar 11001    I(4)            4     1     255      COM                                                
 NTIM                       Scalar 10990    I(4)            4     2     20979    COM                                                
 NTL                        Scalar 11003    I(4)            4     1     255      COM                                                
 NTV                        Scalar 11003    I(4)            4     1     255      COM                                                
 NZHM                       Scalar 10993    I(4)            4     2     20979    COM              11046                             
 NZI                        Scalar 11001    I(4)            4     1     255      COM                                                
 NZIM                       Scalar 10990    I(4)            4     2     20979    COM                                                
 NZV                        Scalar 11003    I(4)            4     1     255      COM                                                
 P                          Local  11022    R(4)            4     2     5865                      11075,11083,11085,11086,11093,1109
                                                                                                  4,11095,11096,11097,11098,11099,11
                                                                                                  100,11101,11102,11103,11104,11105,
                                                                                                  11106,11107,11108,11109,11110,1111
                                                                                                  1,11112,11113,11114,11115         
 PARAMS                     Common 11009                                148                                                         
 PFC                        Scalar 10979    R(4)            4     1     255      COM              11099                             
 PI                         Scalar 10999    R(4)            4     1     255      COM                                                
 PIS                        Scalar 10998    R(4)            4     1     999      COM              11073                             
 PM                         Scalar 11019    R(4)            4     1     21       COM              11127                             
 POB                        Scalar 10979    R(4)            4     1     255      COM              11093,11125,11127                 
 PQM                        Scalar 10979    R(4)            4     1     255      COM              11104                             
 PRC                        Scalar 10979    R(4)            4     1     255      COM              11108                             
 PRNT                       Scalar 11010    L(4)            4           scalar   COM              11032                             
 PS                         Scalar 10985    R(4)            4     1     999      COM              11071,11073                       
 PSINC                      Scalar 11006    R(4)            4           scalar   COM                                                
 QBMS                       Local  11026    R(4)            4           scalar                    11026,11085,11086                 
 QFC                        Scalar 10983    R(4)            4     1     255      COM              11103,11134                       
 QFM                        Scalar 11019    R(4)            4     1     21       COM              11134                             
 QG                         Scalar 10997    L(4)            4     2     20979    COM                                                
 QHM                        Scalar 10988    R(4)            4     2     20979    COM              11045                             
 QI                         Scalar 10999    R(4)            4     1     255      COM                                                
 QIM                        Scalar 10987    R(4)            4     2     20979    COM                                                
 QM                         Scalar 11018    R(4)            4     1     21       COM              11131                             
 QOB                        Scalar 10983    R(4)            4     1     255      COM              11097,11131                       
 QQM                        Scalar 10983    R(4)            4     1     255      COM              11107                             
 QRC                        Scalar 10983    R(4)            4     1     255      COM              11111                             
 QV                         Scalar 11000    R(4)            4     1     255      COM                                                
 QVM                        Scalar 10989    R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 11009    R(4)            4           scalar   COM                                                
 RBLOCKS                    Subr   10971                                                                                            
 RESID                      Common 10999                                41312                                                       
 SID                        Scalar 10976    CHAR            8     1     999      COM              11063,11066                       
 SKIP                       Dummy  10971    L(4)            4           scalar   ARG,INOUT        11033                             
 SQN                        Scalar 10977    R(4)            4     1     999      COM              11064,11067                       
 STN                        Common 11012                                4                                                           
 TDFC                       Scalar 10982    R(4)            4     1     255      COM              11102                             
 TDG                        Scalar 10997    L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 10988    R(4)            4     2     20979    COM              11044                             
 TDI                        Scalar 10999    R(4)            4     1     255      COM                                                
 TDIM                       Scalar 10987    R(4)            4     2     20979    COM                                                
 TDM                        Scalar 11018    R(4)            4     1     21       COM              11130                             
 TDO                        Scalar 10982    R(4)            4     1     255      COM              11096,11130                       
 TDV                        Scalar 11000    R(4)            4     1     255      COM                                                
 TDVM                       Scalar 10989    R(4)            4     2     20979    COM                                                
 TEST                       Scalar 11020    L(4)            4           scalar   COM              11058,11061,11066                 

Page 374         Source Listing                  RBLOCKS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TESTS                      Common 11020                                4                                                           
 TFC                        Scalar 10981    R(4)            4     1     255      COM              11101,11133                       
 TFM                        Scalar 11019    R(4)            4     1     21       COM              11133                             
 TG                         Scalar 10997    L(4)            4     2     20979    COM                                                
 THM                        Scalar 10988    R(4)            4     2     20979    COM              11043                             
 TI                         Scalar 10999    R(4)            4     1     255      COM                                                
 TIM                        Scalar 10987    R(4)            4     2     20979    COM                                                
 TL                         Scalar 11000    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 11006    R(4)            4     1     255      COM                                                
 TM                         Scalar 11018    R(4)            4     2     20979    COM              11129                             
 TOB                        Scalar 10981    R(4)            4     1     255      COM              11095,11129                       
 TQM                        Scalar 10981    R(4)            4     1     255      COM              11106                             
 TRC                        Scalar 10981    R(4)            4     1     255      COM              11110                             
 TT                         Scalar 11010    R(4)            4           scalar   COM                                                
 TV                         Scalar 11000    R(4)            4     1     255      COM                                                
 TVM                        Scalar 10989    R(4)            4     2     20979    COM                                                
 TVO                        Scalar 10982    R(4)            4     1     255      COM              11098                             
 VTPPC                      Scalar 11009    R(4)            4           scalar   COM                                                
 WIND                       Dummy  10971    L(4)            4           scalar   ARG,INOUT        11034                             
 XDR                        Scalar 10986    R(4)            4     1     255      COM              11115                             
 XMA                        Scalar 11009    R(4)            4           scalar   COM                                                
 XMI                        Scalar 11009    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 11014    R(4)            4           scalar   COM                                                
 XOB                        Scalar 10976    R(4)            4     1     999      COM              11063,11066                       
 XQHM                       Scalar 10996    R(4)            4     2     20979    COM                                                
 XQI                        Scalar 11002    R(4)            4     1     255      COM                                                
 XQIM                       Scalar 10992    R(4)            4     2     20979    COM                                                
 XQV                        Scalar 11004    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 11008    R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 10995    R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 11002    R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 10991    R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 11004    R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 10994    R(4)            4     2     20979    COM                                                
 XTH                        Scalar 11007    R(4)            4     1     255      COM                                                
 XTHM                       Scalar 10994    R(4)            4     2     20979    COM                                                
 XTI                        Scalar 11002    R(4)            4     1     255      COM                                                
 XTIM                       Scalar 10991    R(4)            4     2     20979    COM                                                
 XTV                        Scalar 11004    R(4)            4     1     255      COM                                                
 XTVM                       Scalar 10992    R(4)            4     2     20979    COM                                                
 XZH                        Scalar 11007    R(4)            4     1     255      COM                                                
 XZHM                       Scalar 10993    R(4)            4     2     20979    COM                                                
 XZI                        Scalar 11002    R(4)            4     1     255      COM                                                
 XZIM                       Scalar 10991    R(4)            4     2     20979    COM                                                
 XZV                        Scalar 11004    R(4)            4     1     255      COM                                                
 XZVM                       Scalar 10992    R(4)            4     2     20979    COM                                                
 YDR                        Scalar 10986    R(4)            4     1     255      COM              11114                             
 YMA                        Scalar 11009    R(4)            4           scalar   COM                                                
 YMI                        Scalar 11009    R(4)            4           scalar   COM                                                
 YOB                        Scalar 10976    R(4)            4     1     999      COM              11063,11066                       
 ZD                         Scalar 11007    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 10980    R(4)            4     1     255      COM              11100,11132                       
 ZFM                        Scalar 11019    R(4)            4     1     21       COM              11132                             
 ZG                         Scalar 10997    L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 10988    R(4)            4     2     20979    COM              11042                             

Page 375         Source Listing                  RBLOCKS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZI                         Scalar 10999    R(4)            4     1     255      COM                                                
 ZIM                        Scalar 10987    R(4)            4     2     20979    COM                                                
 ZM                         Scalar 11018    R(4)            4     2     20979    COM              11128                             
 ZOB                        Scalar 10980    R(4)            4     1     255      COM              11094,11128                       
 ZQM                        Scalar 10980    R(4)            4     1     255      COM              11105                             
 ZRC                        Scalar 10980    R(4)            4     1     255      COM              11109                             
 ZV                         Scalar 11000    R(4)            4     1     255      COM                                                
 ZVM                        Scalar 10989    R(4)            4     2     20979    COM                                                

Page 376         Source Listing                  RBLOCKS
2017-04-18 11:07                                 cqcbufr.f

  11145 
  11146 C**********************************************************************
  11147 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11148 C                .      .    .                                       .
  11149 C SUBPROGRAM:    RESIDS      CALCULATE RESIDUALS
  11150 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  11151 C
  11152 C ABSTRACT: Calculate residuals: increment, hydrostatic, vertical 
  11153 C   statistical, and lapse rate.  Also, determine level types and
  11154 C   calculate z-differences from vertical neighbors.
  11155 C
  11156 C PROGRAM HISTORY LOG:
  11157 C 1997-03-18  W. Collins  Original author.
  11158 C
  11159 C USAGE:    CALL RESIDS(ITIME)
  11160 C   INPUT ARGUMENT LIST:
  11161 C     ITIME    - 1 - FIRST CALL TO INPUT FOR STATION
  11162 C                2 - SECOND CALL TO INPUT FOR STATION
  11163 C
  11164 C REMARKS: NONE.
  11165 C
  11166 C ATTRIBUTES:
  11167 C   LANGUAGE: FORTRAN 90
  11168 C   MACHINE:  NCEP WCOSS
  11169 C
  11170 C$$$
  11171 
  11172       SUBROUTINE RESIDS(ITIME)
  11173 
  11174       CALL LEVTYPS
  11175       CALL INCR(ITIME)
  11176       CALL HSC
  11177       CALL VOI(ITIME)
  11178       CALL ZDIF
  11179       CALL LAPSE
  11180 
  11181       RETURN
  11182       END

Page 377         Source Listing                  RESIDS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 resids_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HSC                        Subr   11176                                                          11176                             
 INCR                       Subr   11175                                                          11175                             
 ITIME                      Dummy  11172    I(4)            4           scalar   ARG,INOUT        11175,11177                       
 LAPSE                      Subr   11179                                                          11179                             
 LEVTYPS                    Subr   11174                                                          11174                             
 RESIDS                     Subr   11172                                                                                            
 VOI                        Subr   11177                                                          11177                             
 ZDIF                       Subr   11178                                                          11178                             

Page 378         Source Listing                  RESIDS
2017-04-18 11:07                                 cqcbufr.f

  11183 
  11184 C******************************************************************
  11185 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11186 C                .      .    .                                       .
  11187 C SUBPROGRAM:    ROUND       ROUND DATA APPROPRIATELY
  11188 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  11189 C
  11190 C ABSTRACT: Round pressure to nearest 0.1 hPa, height to nearest
  11191 C   meter or 10 meters, and temperature to nearest 0.1 degree.
  11192 C
  11193 C PROGRAM HISTORY LOG:
  11194 C 1997-03-18  W. Collins  Original author.
  11195 C
  11196 C USAGE:    CALL ROUND(VAL,P,IV)
  11197 C   INPUT ARGUMENT LIST:
  11198 C     VAL      - UNROUNDED VALUE
  11199 C     P        - PRESSURE
  11200 C     IV       - VARIABLE:
  11201 C                1 - PRESSURE
  11202 C                2 - HEIGHT
  11203 C                3 - TEMPERATURE
  11204 C
  11205 C   OUTPUT ARGUMENT LIST:
  11206 C     VAL      - ROUNDED VALUE
  11207 C
  11208 C REMARKS: NONE.
  11209 C
  11210 C ATTRIBUTES:
  11211 C   LANGUAGE: FORTRAN 90
  11212 C   MACHINE:  NCEP WCOSS
  11213 C
  11214 C$$$
  11215  
  11216       SUBROUTINE ROUND(VAL,P,IV)
  11217 
  11218 C  ROUND VAL:
  11219 C     IF IV.EQ.1 (PRESSURE), THEN
  11220 C       ROUND TO NEAREST 0.1 MB
  11221 C     IF IV.EQ.2 (HEIGHT), THEN
  11222 C       IF(P.GE.700) ROUND TO NEAREST METER
  11223 C       ELSE ROUND TO NEAREST 10 METERS
  11224 C     IF IV.EQ.3 (TEMPERATURE), THEN
  11225 C       ROUND TO NEAREST 0.1 DEGREE
  11226 C---------------------------------------------
  11227 
  11228       IF(VAL.EQ.0.) RETURN
  11229 
  11230       IF(IV.EQ.2) THEN
  11231         IF(P.GE.700.) THEN
  11232           VAL = ANINT(VAL)
  11233         ELSE
  11234           VAL = 10.*ANINT(VAL/10.)
  11235         ENDIF
  11236       ELSEIF(IV.EQ.1 .OR. IV.EQ.3) THEN
  11237         VAL = ANINT(10.*VAL)/10.
  11238       ENDIF
  11239 

Page 379         Source Listing                  ROUND
2017-04-18 11:07                                 cqcbufr.f

  11240       RETURN
  11241       END


ENTRY POINTS

  Name              
                    
 round_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANINT                      Func   11232                                scalar                    11232,11234,11237                 
 IV                         Dummy  11216    I(4)            4           scalar   ARG,INOUT        11230,11236                       
 P                          Dummy  11216    R(4)            4           scalar   ARG,INOUT        11231                             
 ROUND                      Subr   11216                                                                                            
 VAL                        Dummy  11216    R(4)            4           scalar   ARG,INOUT        11228,11232,11234,11237           

Page 380         Source Listing                  ROUND
2017-04-18 11:07                                 cqcbufr.f

  11242 
  11243 C******************************************************************
  11244 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11245 C
  11246 C SUBPROGRAM: SEARCH
  11247 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-01
  11248 C
  11249 C ABSTRACT: SELECTS OBS TO BE USED FOR OI QUALITY CONTROL. FIVE
  11250 C   FIVE GROUPS OF OBSERVATIONS ARE SELECTED FOR EACH OB BEING
  11251 C   CHECKED. ANY OB SELECTED MUST HAVE PASSED THE QC IN THE PREVIOUS
  11252 C   ITERATION. INDEXES OF EACH SELECTED OB ARE STORED IN A LIST
  11253 C   WHICH THE OI ANALYSIS (SUBROUTINE QCOI) USES TO PERFORM THE
  11254 C   QC ANALYSIS ON A PACKAGE OF OBS BEING CHECKED AT ONE TIME.
  11255 C
  11256 C PROGRAM HISTORY LOG:
  11257 C 1990-11-06  J. Woollen  Original author.
  11258 C
  11259 C USAGE:    CALL SEARCH(LDIM,IDIM,L0,IV0,NOB1,NOB2,IDH,OINC,OG)
  11260 C   INPUT ARGUMENTS:
  11261 C     LDIM     - L-DIMENSION OF MATRIX
  11262 C     IDIM     - I-DIMENSION OF MATRIX
  11263 C     L0       - 
  11264 C     IV0      - 
  11265 C     NOB1     - 
  11266 C     NOB2     - 
  11267 C     IDH      - 
  11268 C     OINC     - 
  11269 C     OG       - 
  11270 C
  11271 C OUTPUT FILES:
  11272 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  11273 C
  11274 C REMARKS: NONE.
  11275 C
  11276 C ATTRIBUTES:
  11277 C   LANGUAGE: FORTRAN 90
  11278 C   MACHINE:  NCEP WCOSS
  11279 C
  11280 C$$$
  11281       SUBROUTINE SEARCH(LDIM,IDIM,L0,IV0,NOB1,NOB2,IDH,OINC,OG)
  11282       PARAMETER (NST=999)
  11283 
  11284       REAL(8) BMISS
  11285 
  11286       INTEGER   IDH (4,LDIM,IDIM,NOBN)
  11287       REAL      OINC(  LDIM,IDIM,NOBN)
  11288 
  11289       COMMON /OBLIST/ NOBN,INOB(1000),IMAP(360,181)
  11290       COMMON /HEADER/  CID(NST), DHR(NST), SLON(NST), SLAT(NST),
  11291      &                 SELV(NST), SQN(NST), ITP(NST), NLV,
  11292      &                 NEV, ISF(NST), NLVM, NLVW
  11293       COMMON /SERCH / RSCAN,DELLAT,DELLON(181)
  11294       COMMON /ISO/ IDISO(NST),NUM,ISISO
  11295       COMMON /TESTS/   TEST
  11296       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  11297 
  11298       LOGICAL          TEST

Page 381         Source Listing                  SEARCH
2017-04-18 11:07                                 cqcbufr.f

  11299       CHARACTER*8 CID
  11300 
  11301       DIMENSION  NIND(1000),RLAT(1000),RLON(1000),
  11302      .           DIST(1000),DIRN(1000),OBOK(1000),
  11303      .           NDIR(1000),IA(2),IB(2)
  11304 
  11305       LOGICAL    OBOK, ISISO
  11306       LOGICAL    OG(21,4,NST)
  11307 
  11308       DATA PI180/.0174532/, RADE/6371./
  11309       DATA MAXCYL/1000/
  11310 
  11311 C----------------------------------------------------------------------
  11312 C----------------------------------------------------------------------
  11313 
  11314 C  SEE IF THIS IS A ONE SHOT DEAL
  11315 C  ------------------------------
  11316 
  11317       IF(NOB1.EQ.NOB2) THEN
  11318          L1   = L0
  11319          L2   = L0
  11320          IV1  = IV0
  11321          IV2  = IV0
  11322       ELSE
  11323          L1   = 1
  11324          L2   = L0
  11325          IV1  = 1
  11326          IV2  = IV0
  11327       ENDIF
  11328 
  11329 C  LOOP OVER STATIONS TO BE CHECKED
  11330 C  --------------------------------
  11331 
  11332       DO 60 NOB=NOB1,NOB2
  11333       BLAT   = SLAT(NOB)
  11334       BLON   = SLON(NOB)
  11335 
  11336 C  ITEMIZE REPORTS IN THE SEACH CYLINDER
  11337 C  -------------------------------------
  11338 
  11339       LASTN = 0
  11340       NOBS  = 0
  11341 
  11342       J1 = MAX(BLAT-DELLAT,-90.) + 91
  11343       J2 = MIN(BLAT+DELLAT, 90.) + 91
  11344 
  11345       DO J=J1,J2
  11346 
  11347         I1 = MOD(BLON-DELLON(J)+360.,360.) + 1
  11348         I2 = MOD(BLON+DELLON(J)     ,360.) + 1
  11349 
  11350         IF(I1.LT.I2) THEN
  11351           IA(1) = I1
  11352           IB(1) = I2
  11353           KK = 1
  11354         ELSE IF(I1.GT.I2) THEN
  11355           IA(1) = I1

Page 382         Source Listing                  SEARCH
2017-04-18 11:07                                 cqcbufr.f

  11356           IB(1) = 360
  11357           IA(2) = 1
  11358           IB(2) = I2
  11359           KK = 2
  11360         ELSE IF(I1.EQ.I2) THEN
  11361           IA(1) = 1
  11362           IB(1) = 360
  11363           KK = 1
  11364         ENDIF
  11365 
  11366         DO K=1,KK
  11367           DO N=IMAP(IA(K),J),IMAP(IB(K),J)
  11368             IF(N.NE.LASTN .AND. INOB(N).NE.NOB) THEN
  11369               NOBS = NOBS+1
  11370               NIND(NOBS) = INOB(N)
  11371               RLAT(NOBS) = SLAT(INOB(N))
  11372               RLON(NOBS) = SLON(INOB(N))
  11373             ENDIF
  11374           ENDDO
  11375           LASTN = N-1
  11376         ENDDO
  11377       ENDDO
  11378 
  11379 C     IF(NOBS.GT.MAXCYL) THEN
  11380 C        PRINT *, 'SEARCH: NOBS GT MAXCYL - STOP 99'
  11381 C        CALL W3TAGE('PREPOBS_CQCBUFR')
  11382 C        CALL ERREXIT
  11383 C     ENDIF
  11384 
  11385 C  COMPUTE DISTANCE AND DIRECTION FROM THE CYLINDER CENTER
  11386 C  -------------------------------------------------------
  11387 
  11388       CALL CHDIST(BLON,BLAT,RLON,RLAT,DIST,DIRN,NOBS)
  11389 
  11390 C  CATAGORIZE OBS BY DISTACE AND DIRECTION
  11391 C  ---------------------------------------
  11392 
  11393       DO N=1,NOBS
  11394         NDIR(N) = MIN(IFIX(DIRN(N)/90.) + 1.,4.)
  11395       ENDDO
  11396 
  11397 C  LOOP OVER THE OBSERVATION LEVELS AND VARIABLES TO BE CHECKED
  11398 C  ------------------------------------------------------------
  11399 
  11400       NPICS = 0
  11401       NPICV = 0
  11402       DO L=L1,L2
  11403         DO IV=IV1,IV2
  11404           IF(ABS(OINC(L,IV,NOB)).LT.BMISS) NPICV = NPICV + 1
  11405 
  11406 C  CLEAR THE SEARCH ARRAY
  11407 C  ----------------------
  11408 
  11409           DO I=1,4
  11410             IDH(I,L,IV,NOB) = 0
  11411           ENDDO
  11412 

Page 383         Source Listing                  SEARCH
2017-04-18 11:07                                 cqcbufr.f

  11413 C  MARK BAD DATA
  11414 C  -------------
  11415 
  11416 C         DO N=1,NOBS
  11417 C           OBOK(N) = OG(L,IV,NIND(N))
  11418 C         ENDDO
  11419 
  11420 C  PICK CLOSEST DATA FROM EACH DIRECTION
  11421 C  -------------------------------------
  11422 
  11423           IF(ABS(OINC(L,IV,NOB)).LT.BMISS) THEN
  11424             NPIC = 0
  11425             DO J=1,4
  11426               DMIN = BMISS
  11427               DO N=1,NOBS
  11428 C               IF(NDIR(N).EQ.J .AND. OBOK(N) .AND. 
  11429                 IF(NDIR(N).EQ.J .AND. OG(L,IV,NIND(N)) .AND.
  11430      &            DIST(N).GT.10. AND. DIST(N).LT.DMIN) THEN
  11431                   DMIN = DIST(N)
  11432                   NN = N
  11433                 ENDIF
  11434               ENDDO
  11435               IF(DMIN.LT.RSCAN) THEN
  11436                 NPIC  = NPIC + 1
  11437                 NPICS = NPICS + 1
  11438                 IDH(NPIC,L,IV,NOB) = NIND(NN)
  11439                 IF(TEST) WRITE(60,500) NPIC,L,IV,CID(NOB),
  11440      &            CID(IDH(NPIC,L,IV,NOB)),
  11441      &            OG(L,IV,NIND(NN))
  11442   500           FORMAT(' SEARCH--NPIC,L,IV,CID,CID(IDH),OG: ',
  11443      &            3I7,2X,A8,2X,A8,2X,L1)
  11444               ENDIF
  11445             ENDDO
  11446           ENDIF
  11447 
  11448         ENDDO
  11449       ENDDO
  11450 
  11451       READ(CID(NOB),'(I5)',ERR=60) ID
  11452       ISISO = .FALSE.
  11453       IF(NPICS.EQ.0 .AND. NPICV.NE.0) THEN
  11454         ISISO = .TRUE.
  11455         CALL ISOLAT(ID)
  11456       ENDIF
  11457 
  11458 60    CONTINUE                     ! Ends loop:  DO 60 NOB=NOB1,NOB2
  11459 
  11460       RETURN
  11461       END

Page 384         Source Listing                  SEARCH
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 search_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  11442                                                          11439                             
 60                         Label  11458                                                          11332,11451                       
 ABS                        Func   11404                                scalar                    11404,11423                       
 BLAT                       Local  11333    R(4)            4           scalar                    11333,11342,11343,11388           
 BLON                       Local  11334    R(4)            4           scalar                    11334,11347,11348,11388           
 BMISS                      Scalar 11284    R(8)            8           scalar   COM              11404,11423,11426                 
 BUFRLIB_MISSING            Common 11296                                16                                                          
 CHDIST                     Subr   11388                                                          11388                             
 CID                        Scalar 11290    CHAR            8     1     999      COM              11439,11440,11451                 
 DELLAT                     Scalar 11293    R(4)            4           scalar   COM              11342,11343                       
 DELLON                     Scalar 11293    R(4)            4     1     181      COM              11347,11348                       
 DHR                        Scalar 11290    R(4)            4     1     999      COM                                                
 DIRN                       Local  11302    R(4)            4     1     1000                      11388,11394                       
 DIST                       Local  11302    R(4)            4     1     1000                      11388,11430,11431                 
 DMIN                       Local  11426    R(4)            4           scalar                    11426,11430,11431,11435           
 HEADER                     Common 11290                                35980                                                       
 I                          Local  11409    I(4)            4           scalar                    11409,11410                       
 I1                         Local  11347    I(4)            4           scalar                    11347,11350,11351,11354,11355,1136
                                                                                                  0                                 
 I2                         Local  11348    I(4)            4           scalar                    11348,11350,11352,11354,11358,1136
                                                                                                  0                                 
 IA                         Local  11303    I(4)            4     1     2                         11351,11355,11357,11361,11367     
 IB                         Local  11303    I(4)            4     1     2                         11352,11356,11358,11362,11367     
 ID                         Local  11451    I(4)            4           scalar                    11451,11455                       
 IDH                        Dummy  11281    I(4)            4     4     0        ARG,INOUT        11410,11438,11440                 
 IDIM                       Dummy  11281    I(4)            4           scalar   ARG,INOUT        11286,11287                       
 IDISO                      Scalar 11294    I(4)            4     1     999      COM                                                
 IFIX                       Func   11394                                scalar                    11394                             
 IMAP                       Scalar 11289    I(4)            4     2     65160    COM              11367                             
 IMISS                      Scalar 11296    I(4)            4           scalar   COM                                                
 INOB                       Scalar 11289    I(4)            4     1     1000     COM              11368,11370,11371,11372           
 ISF                        Scalar 11292    I(4)            4     1     999      COM                                                
 ISISO                      Scalar 11294    L(4)            4           scalar   COM              11452,11454                       
 ISO                        Common 11294                                4004                                                        
 ISOLAT                     Subr   11455                                                          11455                             
 ITP                        Scalar 11291    I(4)            4     1     999      COM                                                
 IV                         Local  11403    I(4)            4           scalar                    11403,11404,11410,11423,11429,1143
                                                                                                  8,11439,11440,11441               
 IV0                        Dummy  11281    I(4)            4           scalar   ARG,INOUT        11320,11321,11326                 
 IV1                        Local  11320    I(4)            4           scalar                    11320,11325,11403                 
 IV2                        Local  11321    I(4)            4           scalar                    11321,11326,11403                 
 J                          Local  11345    I(4)            4           scalar                    11345,11347,11348,11367,11425,1142
                                                                                                  9                                 
 J1                         Local  11342    I(4)            4           scalar                    11342,11345                       

Page 385         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 J2                         Local  11343    I(4)            4           scalar                    11343,11345                       
 K                          Local  11366    I(4)            4           scalar                    11366,11367                       
 KK                         Local  11353    I(4)            4           scalar                    11353,11359,11363,11366           
 L                          Local  11402    I(4)            4           scalar                    11402,11404,11410,11423,11429,1143
                                                                                                  8,11439,11440,11441               
 L0                         Dummy  11281    I(4)            4           scalar   ARG,INOUT        11318,11319,11324                 
 L1                         Local  11318    I(4)            4           scalar                    11318,11323,11402                 
 L2                         Local  11319    I(4)            4           scalar                    11319,11324,11402                 
 LASTN                      Local  11339    I(4)            4           scalar                    11339,11368,11375                 
 LDIM                       Dummy  11281    I(4)            4           scalar   ARG,INOUT        11286,11287                       
 MAX                        Func   11342                                scalar                    11342                             
 MAXCYL                     Local  11309    I(4)            4           scalar                    11309                             
 MIN                        Func   11343                                scalar                    11343,11394                       
 MOD                        Func   11347                                scalar                    11347,11348                       
 N                          Local  11367    I(4)            4           scalar                    11367,11368,11370,11371,11372,1137
                                                                                                  5,11393,11394,11427,11429,11430,11
                                                                                                  431,11432                         
 NDIR                       Local  11303    I(4)            4     1     1000                      11394,11429                       
 NEV                        Scalar 11292    I(4)            4           scalar   COM                                                
 NIND                       Local  11301    I(4)            4     1     1000                      11370,11429,11438,11441           
 NLV                        Scalar 11291    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 11292    I(4)            4           scalar   COM                                                
 NLVW                       Scalar 11292    I(4)            4           scalar   COM                                                
 NN                         Local  11432    I(4)            4           scalar                    11432,11438,11441                 
 NOB                        Local  11332    I(4)            4           scalar                    11332,11333,11334,11368,11404,1141
                                                                                                  0,11423,11438,11439,11440,11451   
 NOB1                       Dummy  11281    I(4)            4           scalar   ARG,INOUT        11317,11332                       
 NOB2                       Dummy  11281    I(4)            4           scalar   ARG,INOUT        11317,11332                       
 NOBN                       Scalar 11289    I(4)            4           scalar   COM              11286,11287                       
 NOBS                       Local  11340    I(4)            4           scalar                    11340,11369,11370,11371,11372,1138
                                                                                                  8,11393,11427                     
 NPIC                       Local  11424    I(4)            4           scalar                    11424,11436,11438,11439,11440     
 NPICS                      Local  11400    I(4)            4           scalar                    11400,11437,11453                 
 NPICV                      Local  11401    I(4)            4           scalar                    11401,11404,11453                 
 NST                        Param  11282    I(4)            4           scalar                    11290,11291,11292,11294,11306     
 NUM                        Scalar 11294    I(4)            4           scalar   COM                                                
 OBLIST                     Common 11289                                264644                                                      
 OBOK                       Local  11302    L(4)            4     1     1000                                                        
 OG                         Dummy  11281    L(4)            4     3     83916    ARG,INOUT        11429,11441                       
 OINC                       Dummy  11281    R(4)            4     3     0        ARG,INOUT        11404,11423                       
 PI180                      Local  11308    R(4)            4           scalar                    11308                             
 RADE                       Local  11308    R(4)            4           scalar                    11308                             
 RLAT                       Local  11301    R(4)            4     1     1000                      11371,11388                       
 RLON                       Local  11301    R(4)            4     1     1000                      11372,11388                       
 RSCAN                      Scalar 11293    R(4)            4           scalar   COM              11435                             
 SEARCH                     Subr   11281                                                                                            
 SELV                       Scalar 11291    R(4)            4     1     999      COM                                                
 SERCH                      Common 11293                                732                                                         
 SLAT                       Scalar 11290    R(4)            4     1     999      COM              11333,11371                       
 SLON                       Scalar 11290    R(4)            4     1     999      COM              11334,11372                       
 SQN                        Scalar 11291    R(4)            4     1     999      COM                                                
 TEST                       Scalar 11295    L(4)            4           scalar   COM              11439                             
 TESTS                      Common 11295                                4                                                           
 XMISS                      Scalar 11296    R(4)            4           scalar   COM                                                

Page 386         Source Listing                  SEARCH
2017-04-18 11:07                                 cqcbufr.f

  11462 
  11463 C***************************************************************
  11464 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11465 C
  11466 C SUBPROGRAM: SETTMP
  11467 C   PRGMMR: COLLINS          ORG: NP22       DATE: 1990-11-01
  11468 C
  11469 C ABSTRACT: SETS TEMPORARY ARRYS TO MISSING
  11470 C
  11471 C PROGRAM HISTORY LOG:
  11472 C 1990-11-06  W. Collins  Original author.
  11473 C
  11474 C REMARKS: NONE.
  11475 C
  11476 C ATTRIBUTES:
  11477 C   LANGUAGE: FORTRAN 90
  11478 C   MACHINE:  NCEP WCOSS
  11479 C
  11480 C$$$
  11481       SUBROUTINE SETTMP
  11482       PARAMETER (NST=999)
  11483 
  11484       REAL(8) BMISS
  11485 
  11486       COMMON /TMPSND/  OBT(21,NST,4,2),
  11487      &                 ZIT(21,NST,4), TIT(21,NST,4),
  11488      &                 TMP(21,NST,2), NTMP(21,NST,2), ITERR(4)
  11489       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  11490      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  11491       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  11492 
  11493       LOGICAL          PRNT
  11494       DO IV=1,2
  11495         DO IS=1,NST
  11496           DO L=1,MAND
  11497             DO IT=1,4
  11498               OBT(L,IS,IT,IV) = BMISS
  11499             ENDDO
  11500             TMP(L,IS,IV) = BMISS
  11501             NTMP(L,IS,IV) = 0
  11502           ENDDO
  11503         ENDDO
  11504       ENDDO
  11505 
  11506       RETURN
  11507       END

Page 387         Source Listing                  SETTMP
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 settmp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 11484    R(8)            8           scalar   COM              11498,11500                       
 BUFRLIB_MISSING            Common 11491                                16                                                          
 CQCPC                      Scalar 11490    R(4)            4           scalar   COM                                                
 IMISS                      Scalar 11491    I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 11490    I(4)            4           scalar   COM                                                
 IS                         Local  11495    I(4)            4           scalar                    11495,11498,11500,11501           
 ISC                        Scalar 11490    I(4)            4           scalar   COM                                                
 IT                         Local  11497    I(4)            4           scalar                    11497,11498                       
 ITERR                      Scalar 11488    I(4)            4     1     4        COM                                                
 IV                         Local  11494    I(4)            4           scalar                    11494,11498,11500,11501           
 L                          Local  11496    I(4)            4           scalar                    11496,11498,11500,11501           
 LMAND                      Scalar 11490    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 11490    I(4)            4           scalar   COM                                                
 MAND                       Scalar 11489    I(4)            4           scalar   COM              11496                             
 NLEV                       Scalar 11489    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 11489    I(4)            4           scalar   COM                                                
 NST                        Param  11482    I(4)            4           scalar                    11486,11487,11488,11495           
 NTMP                       Scalar 11488    I(4)            4     3     41958    COM              11501                             
 OBT                        Scalar 11486    R(4)            4     4     167832   COM              11498                             
 PARAMS                     Common 11489                                148                                                         
 PRNT                       Scalar 11490    L(4)            4           scalar   COM                                                
 RADPC                      Scalar 11489    R(4)            4           scalar   COM                                                
 SETTMP                     Subr   11481                                                                                            
 TIT                        Scalar 11487    R(4)            4     3     83916    COM                                                
 TMP                        Scalar 11488    R(4)            4     3     41958    COM              11500                             
 TMPSND                     Common 11486                                1678336                                                     
 TT                         Scalar 11490    R(4)            4           scalar   COM                                                
 VTPPC                      Scalar 11489    R(4)            4           scalar   COM                                                
 XMA                        Scalar 11489    R(4)            4           scalar   COM                                                
 XMI                        Scalar 11489    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 11491    R(4)            4           scalar   COM                                                
 YMA                        Scalar 11489    R(4)            4           scalar   COM                                                
 YMI                        Scalar 11489    R(4)            4           scalar   COM                                                
 ZIT                        Scalar 11487    R(4)            4     3     83916    COM                                                

Page 388         Source Listing                  SETTMP
2017-04-18 11:07                                 cqcbufr.f

  11508 
  11509 C***************************************************************
  11510 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11511 C                .      .    .                                       .
  11512 C SUBPROGRAM:    SEVENT      SAVE AN EVENT FOR LATER USE
  11513 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  11514 C
  11515 C ABSTRACT: Save an event in /EVENTS/ for later use.
  11516 C
  11517 C PROGRAM HISTORY LOG:
  11518 C 1997-03-18  W. Collins  Original author.
  11519 C
  11520 C USAGE:    CALL SEVENT(ST,SEQ,L,LST,P,LT,IV,C,CV,CP,QM,IE,
  11521 C                       BAS,PIS,PSINC)
  11522 C   INPUT ARGUMENT LIST:
  11523 C     ST       - STATION ID
  11524 C     SEQ      - SEQUENCE NUMBER
  11525 C     L        - LEVEL
  11526 C     P        - PRESSURE
  11527 C     LT       - LEVEL TYPE
  11528 C     IV       - VARIABLE
  11529 C     C        - CORRECTION
  11530 C     CV       - CORRECTED VALUE
  11531 C     CP       - ORIGINAL CORRECTION
  11532 C     QM       - QUALITY MARK
  11533 C     IE       - ERROR TYPE
  11534 C     BAS      - BASELINE RESIDUAL
  11535 C     PIS      - SURFACE PRESSURE INCREMENT
  11536 C     PSINC    - BASELINE RESIDUAL IN TERMS OF PRESSURE
  11537 C
  11538 C   OUTPUT FILES:
  11539 C     UNIT 06  - PRINTOUT
  11540 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  11541 C
  11542 C REMARKS: NONE.
  11543 C
  11544 C ATTRIBUTES:
  11545 C   LANGUAGE: FORTRAN 90
  11546 C   MACHINE:  NCEP WCOSS
  11547 C
  11548 C$$$
  11549 
  11550       SUBROUTINE SEVENT(ST,SEQ,L,LST,P,LT,IV,C,CV,CP,QM,IE,
  11551      &  BAS,PIS,PSINC)
  11552 
  11553       REAL(8) BMISS
  11554 
  11555       SAVE I
  11556 
  11557       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
  11558      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
  11559      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
  11560      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
  11561      &                 BASR(2000),   PISR(2000),  PSINCR(2000),
  11562      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
  11563       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  11564      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT

Page 389         Source Listing                  SEVENT
2017-04-18 11:07                                 cqcbufr.f

  11565       COMMON /DATEX/   JDATE(5), CDATE
  11566       COMMON /TESTS/   TEST
  11567       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  11568 
  11569       LOGICAL          TEST, PRNT
  11570       CHARACTER*8     STN, ST
  11571       CHARACTER*10    EDATE, CDATE
  11572       CHARACTER*2     CVAR(5)
  11573       DATA CVAR/' P',' Z',' T','TD',' Q'/
  11574       DATA I/0/
  11575 
  11576       I = I + 1
  11577       IEVENT = I
  11578       IF(I.GE.2000) THEN
  11579         I = I-1
  11580         IEVENT = I
  11581         WRITE(6,500)
  11582   500   FORMAT(' TOO MANY EVENTS TO RECORD THEM ALL')
  11583         RETURN
  11584       ENDIF
  11585       STN(I)    = ST                           ! station
  11586       SEQN(I)   = SEQ                          ! sequence number
  11587       ISCAN(I)  = ISC                          ! scan
  11588       LEVL(I)   = L                            ! level
  11589       PRES(I)   = P                            ! pressure
  11590       LTYP(I)   = LT                           ! level type
  11591       LSTYP(I)  = LST                          ! surface type
  11592       IVAR(I)   = IV                           ! variable (p,z,T,Td,q)
  11593       COR(I)    = C                            ! correction
  11594       CORVAL(I) = CV                           ! corrected value
  11595       IF(CV.NE.XMISS .AND. C.NE.XMISS) THEN
  11596         OVAL    = CV - C                       ! original value
  11597       ELSE
  11598         OVAL    = XMISS
  11599       ENDIF
  11600       PCOR(I)   = CP                           ! original correciton
  11601       QMARK(I)  = QM                           ! quality mark
  11602       IETYP(I)  = IE                           ! error type
  11603       EDATE(I)  = CDATE                        ! date/time
  11604       BASR(I)   = BAS                          ! baseline residual
  11605       PISR(I)   = PIS                          ! increment of sfc press
  11606       PSINCR(I) = PSINC                        ! baseline res in press
  11607 
  11608       IPEVT = IPEVT + 1
  11609       IF(TEST) THEN
  11610        WRITE(60,501)
  11611        IF(IVAR(I).LE.3) THEN
  11612         WRITE(60,502) STN(I),EDATE(I),SEQN(I),ISCAN(I),LEVL(I),
  11613      &    PRES(I),LTYP(I),CVAR(IVAR(I)),OVAL,COR(I),CORVAL(I),QMARK(I),
  11614      &    IETYP(I),LSTYP(I),PCOR(I),BASR(I),PISR(I),PSINCR(I)
  11615        ELSE
  11616         WRITE(60,503) STN(I),EDATE(I),SEQN(I),ISCAN(I),LEVL(I),
  11617      &    PRES(I),LTYP(I),CVAR(IVAR(I)),OVAL,COR(I),CORVAL(I),QMARK(I),
  11618      &    IETYP(I),LSTYP(I),PCOR(I),BASR(I),PISR(I),PSINCR(I)
  11619        ENDIF
  11620       ENDIF
  11621 

Page 390         Source Listing                  SEVENT
2017-04-18 11:07                                 cqcbufr.f

  11622   501 FORMAT(' SEVENT--STN          DATE  SQN  SCAN LEVEL  PRESSURE',
  11623      &       ' LEVTYP VAR  ORIG-VAL       COR   NEW-VAL QMARK IETYP',
  11624      &       ' SFCTYP  ORIG-COR BAS-RES  PS-INC  PS-RES')
  11625   502 FORMAT(7X,A8,1X,A10,F6.0,I5,I6,F10.1,I7,2X,A2,3F10.1,F6.0,I6,
  11626      &       I7,F10.1,3(1X,F7.1))
  11627   503 FORMAT(7X,A8,1X,A10,F6.0,I5,I6,F10.1,I7,2X,A2,3F10.6,F6.0,I6,
  11628      &       I7,F10.1,3(1X,F7.1))
  11629 
  11630       RETURN
  11631       END


ENTRY POINTS

  Name               
                     
 sevent_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  11582                                                          11581                             
 501                        Label  11622                                                          11610                             
 502                        Label  11625                                                          11612                             
 503                        Label  11627                                                          11616                             
 BAS                        Dummy  11551    R(4)            4           scalar   ARG,INOUT        11604                             
 BASR                       Scalar 11561    R(4)            4     1     2000     COM              11604,11614,11618                 
 BMISS                      Scalar 11553    R(8)            8           scalar   COM                                                
 BUFRLIB_MISSING            Common 11567                                16                                                          
 C                          Dummy  11550    R(4)            4           scalar   ARG,INOUT        11593,11595,11596                 
 CDATE                      Scalar 11565    CHAR            10          scalar   COM              11603                             
 COR                        Scalar 11559    R(4)            4     1     2000     COM              11593,11613,11617                 
 CORVAL                     Scalar 11559    R(4)            4     1     2000     COM              11594,11613,11617                 
 CP                         Dummy  11550    R(4)            4           scalar   ARG,INOUT        11600                             
 CQCPC                      Scalar 11564    R(4)            4           scalar   COM                                                
 CV                         Dummy  11550    R(4)            4           scalar   ARG,INOUT        11594,11595,11596                 
 CVAR                       Local  11572    CHAR            2     1     5                         11573,11613,11617                 
 DATEX                      Common 11565                                30                                                          
 EDATE                      Scalar 11562    CHAR            10    1     2000     COM              11603,11612,11616                 
 EVENTS                     Common 11557                                156004                                                      
 I                          Local  11555    I(4)            4           scalar   SAVE             11574,11576,11577,11578,11579,1158
                                                                                                  0,11585,11586,11587,11588,11589,11
                                                                                                  590,11591,11592,11593,11594,11600,
                                                                                                  11601,11602,11603,11604,11605,1160
                                                                                                  6,11611,11612,11613,11614,11616,11
                                                                                                  617,11618                         
 IE                         Dummy  11550    I(4)            4           scalar   ARG,INOUT        11602                             
 IETYP                      Scalar 11562    I(4)            4     1     2000     COM              11602,11614,11618                 
 IEVENT                     Scalar 11560    I(4)            4           scalar   COM              11577,11580                       
 IMISS                      Scalar 11567    I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 11564    I(4)            4           scalar   COM              11608                             
 ISC                        Scalar 11564    I(4)            4           scalar   COM              11587                             
 ISCAN                      Scalar 11557    I(4)            4     1     2000     COM              11587,11612,11616                 
 IV                         Dummy  11550    I(4)            4           scalar   ARG,INOUT        11592                             
 IVAR                       Scalar 11559    I(4)            4     1     2000     COM              11592,11611,11613,11617           

Page 391         Source Listing                  SEVENT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 JDATE                      Scalar 11565    I(4)            4     1     5        COM                                                
 L                          Dummy  11550    I(4)            4           scalar   ARG,INOUT        11588                             
 LEVL                       Scalar 11558    I(4)            4     1     2000     COM              11588,11612,11616                 
 LMAND                      Scalar 11564    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 11564    I(4)            4           scalar   COM                                                
 LST                        Dummy  11550    I(4)            4           scalar   ARG,INOUT        11591                             
 LSTYP                      Scalar 11560    I(4)            4     1     2000     COM              11591,11614,11618                 
 LT                         Dummy  11550    I(4)            4           scalar   ARG,INOUT        11590                             
 LTYP                       Scalar 11558    I(4)            4     1     2000     COM              11590,11613,11617                 
 MAND                       Scalar 11563    I(4)            4           scalar   COM                                                
 NLEV                       Scalar 11563    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 11563    I(4)            4           scalar   COM                                                
 OVAL                       Local  11596    R(4)            4           scalar                    11596,11598,11613,11617           
 P                          Dummy  11550    R(4)            4           scalar   ARG,INOUT        11589                             
 PARAMS                     Common 11563                                148                                                         
 PCOR                       Scalar 11560    R(4)            4     1     2000     COM              11600,11614,11618                 
 PIS                        Dummy  11551    R(4)            4           scalar   ARG,INOUT        11605                             
 PISR                       Scalar 11561    R(4)            4     1     2000     COM              11605,11614,11618                 
 PRES                       Scalar 11558    R(4)            4     1     2000     COM              11589,11613,11617                 
 PRNT                       Scalar 11564    L(4)            4           scalar   COM                                                
 PSINC                      Dummy  11551    R(4)            4           scalar   ARG,INOUT        11606                             
 PSINCR                     Scalar 11561    R(4)            4     1     2000     COM              11606,11614,11618                 
 QM                         Dummy  11550    R(4)            4           scalar   ARG,INOUT        11601                             
 QMARK                      Scalar 11562    R(4)            4     1     2000     COM              11601,11613,11617                 
 RADPC                      Scalar 11563    R(4)            4           scalar   COM                                                
 SEQ                        Dummy  11550    R(4)            4           scalar   ARG,INOUT        11586                             
 SEQN                       Scalar 11557    R(4)            4     1     2000     COM              11586,11612,11616                 
 SEVENT                     Subr   11550                                                                                            
 ST                         Dummy  11550    CHAR            8           scalar   ARG,INOUT        11585                             
 STN                        Scalar 11557    CHAR            8     1     2000     COM              11585,11612,11616                 
 TEST                       Scalar 11566    L(4)            4           scalar   COM              11609                             
 TESTS                      Common 11566                                4                                                           
 TT                         Scalar 11564    R(4)            4           scalar   COM                                                
 VTPPC                      Scalar 11563    R(4)            4           scalar   COM                                                
 XMA                        Scalar 11563    R(4)            4           scalar   COM                                                
 XMI                        Scalar 11563    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 11567    R(4)            4           scalar   COM              11595,11598                       
 YMA                        Scalar 11563    R(4)            4           scalar   COM                                                
 YMI                        Scalar 11563    R(4)            4           scalar   COM                                                

Page 392         Source Listing                  SEVENT
2017-04-18 11:07                                 cqcbufr.f

  11632 
  11633 C***************************************************************
  11634 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11635 C                .      .    .                                       .
  11636 C SUBPROGRAM:    SHELL       SHELL SORT BASED ON V.
  11637 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 12-24-91
  11638 C
  11639 C ABSTRACT: SHELL SORT, BASED UPON THE VALUES OF V.
  11640 C   IV IS THE ORIGINAL INDEX OF EACH ELEMENT OF V.
  11641 C
  11642 C PROGRAM HISTORY LOG:
  11643 C 1991-12-24  W. Collins  Original author.
  11644 C
  11645 C USAGE:    CALL SHELL(V,IV,MAX,IREV)
  11646 C   INPUT ARGUMENT LIST:
  11647 C     V        - VARIABLE
  11648 C     MAX      - DIMENSION OF V
  11649 C     IREV     = 0 FOR ASCENDING ORDER
  11650 C             <> 0 FOR DESCENDING ORDER
  11651 C
  11652 C   OUTPUT ARGUMENT LIST:
  11653 C     IV       - ORIGINAL INDEX OF VARIABLE
  11654 C     V        - VARIABLE, SORTED.
  11655 C
  11656 C REMARKS: NONE.
  11657 C
  11658 C ATTRIBUTES:
  11659 C   LANGUAGE: FORTRAN 90
  11660 C   MACHINE:  NCEP WCOSS
  11661 C
  11662 C$$$
  11663       SUBROUTINE SHELL(V,IV,MAX,IREV)
  11664       REAL V(*)
  11665       INTEGER IV(*)
  11666       DO 10 I=1,MAX
  11667         IV(I) = I
  11668    10 CONTINUE
  11669       IOFSET = MAX/2
  11670    20 CONTINUE
  11671       LIM = MAX - IOFSET
  11672    30 CONTINUE
  11673       ISW = 0
  11674       DO 40 I=1,LIM
  11675         IF(V(I).GT.V(I+IOFSET)) THEN
  11676           VT = V(I)
  11677           V(I) = V(I+IOFSET)
  11678           V(I+IOFSET) = VT
  11679           IVT = IV(I)
  11680           IV(I) = IV(I+IOFSET)
  11681           IV(I+IOFSET) = IVT
  11682           ISW = I
  11683         ENDIF
  11684    40 CONTINUE
  11685       LIM = ISW - IOFSET
  11686       IF(ISW.NE.0) GO TO 30
  11687       IOFSET = IOFSET/2
  11688       IF(IOFSET.GT.0) GO TO 20

Page 393         Source Listing                  SHELL
2017-04-18 11:07                                 cqcbufr.f

  11689 
  11690       IF(IREV.NE.0) THEN
  11691 C        REVERSE SORT ORDER...
  11692          NH = MAX/2
  11693          DO I=1,NH
  11694             ITEMP = IV(I)
  11695             IV(I) = IV(MAX+1-I)
  11696             IV(MAX+1-I) = ITEMP
  11697             TEMP = V(I)
  11698             V(I) = V(MAX+1-I)
  11699             V(MAX+1-I) = TEMP
  11700          ENDDO
  11701       ENDIF
  11702       RETURN
  11703       END


ENTRY POINTS

  Name              
                    
 shell_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  11668                                                          11666                             
 20                         Label  11670                                                          11688                             
 30                         Label  11672                                                          11686                             
 40                         Label  11684                                                          11674                             
 I                          Local  11666    I(4)            4           scalar                    11666,11667,11674,11675,11676,1167
                                                                                                  7,11678,11679,11680,11681,11682,11
                                                                                                  693,11694,11695,11696,11697,11698,
                                                                                                  11699                             
 IOFSET                     Local  11669    I(4)            4           scalar                    11669,11671,11675,11677,11678,1168
                                                                                                  0,11681,11685,11687,11688         
 IREV                       Dummy  11663    I(4)            4           scalar   ARG,INOUT        11690                             
 ISW                        Local  11673    I(4)            4           scalar                    11673,11682,11685,11686           
 ITEMP                      Local  11694    I(4)            4           scalar                    11694,11696                       
 IV                         Dummy  11663    I(4)            4     1     0        ARG,INOUT        11667,11679,11680,11681,11694,1169
                                                                                                  5,11696                           
 IVT                        Local  11679    I(4)            4           scalar                    11679,11681                       
 LIM                        Local  11671    I(4)            4           scalar                    11671,11674,11685                 
 MAX                        Dummy  11663    I(4)            4           scalar   ARG,INOUT        11666,11669,11671,11692,11695,1169
                                                                                                  6,11698,11699                     
 NH                         Local  11692    I(4)            4           scalar                    11692,11693                       
 SHELL                      Subr   11663                                                                                            
 TEMP                       Local  11697    R(4)            4           scalar                    11697,11699                       
 V                          Dummy  11663    R(4)            4     1     0        ARG,INOUT        11675,11676,11677,11678,11697,1169
                                                                                                  8,11699                           
 VT                         Local  11676    R(4)            4           scalar                    11676,11678                       

Page 394         Source Listing                  SHELL
2017-04-18 11:07                                 cqcbufr.f

  11704 
  11705 C******************************************************************
  11706 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11707 C                .      .    .                                       .
  11708 C SUBPROGRAM:    SIGERR      TEST FOR CORRECTIONS AT SIGNIFICANT LEVEL
  11709 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
  11710 C
  11711 C ABSTRACT: Test for temperature corrections at significant levels.
  11712 C
  11713 C PROGRAM HISTORY LOG:
  11714 C 1997-03-18  W. Collins  Original author.
  11715 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
  11716 C     were tested for not being equal to real value for missing (BMISS
  11717 C     = 10E10), these integer values can never be equal to BMISS for
  11718 C     I*4 due to overflow - instead they are now tested for not being
  11719 C     equal to new integer value for missing (IMISS, also = 10E10),
  11720 C     although this is also an overflow value for I*4, it results in a
  11721 C     correct evaluation
  11722 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
  11723 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
  11724 C     overflow (also done for IMISS). 
  11725 C
  11726 C USAGE:    CALL SIGERR(LM)
  11727 C   INPUT ARGUMENT LIST:
  11728 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  11729 C
  11730 C   OUTPUT FILES:
  11731 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  11732 C
  11733 C REMARKS: NONE.
  11734 C
  11735 C ATTRIBUTES:
  11736 C   LANGUAGE: FORTRAN 90
  11737 C   MACHINE:  NCEP WCOSS
  11738 C
  11739 C$$$
  11740 
  11741       SUBROUTINE SIGERR(LM)
  11742       PARAMETER (NST=999)
  11743 
  11744       REAL(8) BMISS
  11745 
  11746       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
  11747       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  11748      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  11749      &                 NEV, ISF(NST), NLVM, NLVW
  11750       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  11751      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  11752      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  11753      &                 TDO(255), TDFC(255),TVO(255),
  11754      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  11755      &                 CAT(255), IND(255), LEVTYP(255),
  11756      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  11757      &                 YDR(255), XDR(255)
  11758       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  11759      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  11760      &                 NZI(255),NTI(255),NTDI(255),NQI(255),

Page 395         Source Listing                  SIGERR
2017-04-18 11:07                                 cqcbufr.f

  11761      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  11762      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  11763      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  11764      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  11765      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  11766      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  11767      &                 XTDH(255)
  11768       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  11769      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  11770      &                 ZCLIM, TCLIM, NHLIM
  11771       COMMON /STN/     IS
  11772       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  11773      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  11774       COMMON /TESTS/   TEST
  11775       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  11776 
  11777       LOGICAL          TEST
  11778       CHARACTER*8 SID
  11779       LOGICAL POUT, GOOD(6,2,2)
  11780       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT, SDMQ
  11781       POUT = .FALSE.
  11782 
  11783       IF(TEST) WRITE(60,500) SID(IS),POB(LM),NTI(LM),NTV(LM)
  11784   500 FORMAT(' SIGERR--CALLED FOR: ',A8,'  ',F10.1,' MB,    NTI,NTV: ',
  11785      &  2I5)
  11786 
  11787       PTCOR = 0.
  11788 
  11789       NTVP = 0
  11790                          ! NTV(LM+1) will never test = bmiss, use imiss
  11791 cdak  IF(LM+1.LE.NLVM .AND. NTV(LM+1).NE.BMISS) NTVP = NTV(LM+1)
  11792       IF(LM+1.LE.NLVM .AND. NTV(LM+1).NE.IMISS) NTVP = NTV(LM+1)
  11793       NTVM = 0
  11794                          ! NTV(LM-1) will never test = bmiss, use imiss
  11795 cdak  IF(LM-1.GE.1 .AND. NTV(LM-1).NE.BMISS) NTVM = NTV(LM-1)
  11796       IF(LM-1.GE.1 .AND. NTV(LM-1).NE.IMISS) NTVM = NTV(LM-1)
  11797 
  11798       IF(TI(LM).NE.BMISS .AND. NTI(LM).GT.7 .AND.
  11799      &   TV(LM).NE.BMISS .AND. NTV(LM).GT.7) THEN
  11800         NL = NMANLV(POB(LM))
  11801         RATIO = (ABS(TV(LM)-TI(LM)))/XINC(NL,2)
  11802         IF(RATIO.LT.0.25) THEN
  11803           CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
  11804      &      XINC(NL,2),TV(LM),VOIRES(NL,2),XMISS,XMISS,XMISS,XMISS)
  11805           IHSC(3,LM) = 2
  11806           TCOR(1) = TCBEST(1)
  11807           TC1 = TCBEST(1)
  11808           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
  11809           CALL ROUND(TC1,POB(LM),3)
  11810           PTCOR = TC1
  11811           TCOR(1) = TC1
  11812           CALL CHECKIT(2,XMISS,XMISS, XMISS, XMISS,XMISS,
  11813      &                   XMISS,XMISS, XMISS, XMISS,XMISS,
  11814      &                   TC1,  TI(LM),TV(LM),XMISS,XMISS,
  11815      &                   XMISS,XMISS, XMISS, XMISS,XMISS,
  11816      &                   XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
  11817           IF(GOOD(6,1,2)) THEN

Page 396         Source Listing                  SIGERR
2017-04-18 11:07                                 cqcbufr.f

  11818             QM = 1.
  11819             IHSC(3,LM) = 20
  11820             POUT = .TRUE.
  11821           ELSE
  11822             TC1 = 0.
  11823             QM = 13.
  11824             IHSC(3,LM) = 21
  11825             POUT = .TRUE.
  11826           ENDIF
  11827         ELSE
  11828           TC1 = -TI(LM)
  11829           CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
  11830           CALL ROUND(TC1,POB(LM),3)
  11831           PTCOR = TC1
  11832           TCOR(1) = TC1
  11833           CALL CHECKIT(2,XMISS,  XMISS,  XMISS,  XMISS,XMISS,
  11834      &                   XMISS,  XMISS,  XMISS,  XMISS,XMISS,
  11835      &                   TC1,    TI(LM), TV(LM), XMISS,XMISS,
  11836      &                   XMISS,  XMISS,  XMISS,  XMISS,XMISS,
  11837      &                   XMISS,XMISS,XMISS,XMISS,XMISS,XMISS,GOOD)
  11838           IF(GOOD(6,1,2)) THEN
  11839           QM = 1.
  11840           IHSC(3,LM) = 22
  11841           POUT = .TRUE.
  11842           ELSE
  11843             TC1 = 0.
  11844             QM = 13.
  11845             IHSC(3,LM) = 23
  11846             POUT = .TRUE.
  11847           ENDIF
  11848         ENDIF
  11849       ELSEIF(TI(LM).NE.BMISS .AND. NTI(LM).GT.7) THEN
  11850         TC1 = 0.
  11851         PTCOR = TC1
  11852         QM = 3.
  11853         IHSC(3,LM) = 24
  11854         POUT = .TRUE.
  11855       ELSEIF(TV(LM).NE.BMISS .AND. NTV(LM).GT.7 .AND.
  11856      &       NTVP.LT.5 .AND. NTVM.LT.5) THEN    ! Perhaps tropopause
  11857         TC1 = 0.
  11858         PTCOR = TC1
  11859         QM = 1.
  11860         IHSC(3,LM) = 0
  11861         POUT = .TRUE.
  11862       ELSEIF(TV(LM).NE.BMISS .AND. NTV(LM).GT.7 .AND.
  11863      &       NTVP.LT.7 .AND. NTVM.LT.7) THEN
  11864         TC1 = 0.
  11865         PTCOR = TC1
  11866         QM = 3.
  11867         IHSC(3,LM) = 25
  11868         POUT = .TRUE.
  11869       ELSE
  11870         TC1 = 0.
  11871         PTCOR = TC1
  11872         QM = 1.
  11873         IHSC(3,LM) = 0
  11874       ENDIF

Page 397         Source Listing                  SIGERR
2017-04-18 11:07                                 cqcbufr.f

  11875       IF(IHSC(3,LM).NE.0) THEN
  11876         CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),3,TC1,
  11877      &    TOB(LM)+TC1,PTCOR,QM,IHSC(3,LM),XMISS,XMISS,XMISS)
  11878         SDMQ = .FALSE.
  11879         SDMQ = QQM(LM).EQ.0. .OR. QQM(LM).GE.14. .OR.
  11880      &        (QQM(LM).GE.4. .AND. QQM(LM).LE.12.)
  11881         IF((QM.EQ.3. .OR. QM.EQ.13.) .AND. QOB(LM).LT.BMISS .AND.
  11882      &     .NOT.SDMQ) THEN
  11883           CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),
  11884      &      LEVTYP(LM),5,0.,QOB(LM),0.,QM,IHSC(4,LM),XMISS,
  11885      &      XMISS,XMISS)
  11886         ENDIF
  11887       ENDIF
  11888 
  11889       RETURN
  11890       END


ENTRY POINTS

  Name               
                     
 sigerr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  11784                                                          11783                             
 ABS                        Func   11801                                scalar                    11801                             
 ALLOW                      Common 11746                                456                                                         
 ALLSND                     Common 11750                                34512                                                       
 ALLT                       Scalar 11746    R(4)            4     1     71       COM              11808,11829                       
 ALLZ                       Scalar 11746    R(4)            4     1     41       COM                                                
 B                          Scalar 11766    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 11765    R(4)            4     1     999      COM                                                
 BEST                       Subr   11803                                                          11803                             
 BMISS                      Scalar 11744    R(8)            8           scalar   COM              11798,11799,11849,11855,11862,1188
                                                                                                  1                                 
 BUFRLIB_MISSING            Common 11775                                16                                                          
 CAT                        Scalar 11755    R(4)            4     1     255      COM                                                
 CHECKIT                    Subr   11812                                                          11812,11833                       
 DHR                        Scalar 11747    R(4)            4     1     999      COM                                                
 ELV                        Scalar 11748    R(4)            4     1     999      COM                                                
 ERROR                      Local  11780    L(4)            4           scalar                                                      
 GESPS                      Scalar 11756    R(4)            4     1     999      COM                                                
 GOOD                       Local  11779    L(4)            4     3     24                        11816,11817,11837,11838           
 H1                         Scalar 11772    R(4)            4           scalar   COM                                                
 H2                         Scalar 11772    R(4)            4           scalar   COM                                                
 HEADER                     Common 11747                                35980                                                       
 HOIRES                     Scalar 11768    R(4)            4     2     84       COM                                                
 HRDR                       Scalar 11756    R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 11768    R(4)            4     1     21       COM                                                
 HYD                        Scalar 11764    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 11764    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 11764    R(4)            4     1     21       COM                                                

Page 398         Source Listing                  SIGERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HYDS                       Scalar 11764    R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 11772                                64                                                          
 IHSC                       Scalar 11765    I(4)            4     2     1020     COM              11805,11819,11824,11840,11845,1185
                                                                                                  3,11860,11867,11873,11875,11877,11
                                                                                                  884                               
 IMISS                      Scalar 11775    I(4)            4           scalar   COM              11792,11796                       
 IND                        Scalar 11755    I(4)            4     1     255      COM                                                
 IS                         Scalar 11771    I(4)            4           scalar   COM              11783,11876,11883                 
 ISF                        Scalar 11749    I(4)            4     1     999      COM                                                
 ITP                        Scalar 11748    I(4)            4     1     999      COM                                                
 LAST                       Scalar 11773    I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 11755    I(4)            4     1     255      COM              11876,11884                       
 LIMS                       Common 11768                                1776                                                        
 LM                         Dummy  11741    I(4)            4           scalar   ARG,INOUT        11783,11792,11796,11798,11799,1180
                                                                                                  0,11801,11803,11804,11805,11808,11
                                                                                                  809,11814,11819,11824,11828,11829,
                                                                                                  11830,11835,11840,11845,11849,1185
                                                                                                  3,11855,11860,11862,11867,11873,11
                                                                                                  875,11876,11877,11879,11880,11881,
                                                                                                  11883,11884                       
 LST                        Scalar 11756    I(4)            4     1     255      COM              11876,11883                       
 NALLT                      Scalar 11746    I(4)            4           scalar   COM              11808,11829                       
 NALLZ                      Scalar 11746    I(4)            4           scalar   COM                                                
 NBAS                       Scalar 11766    I(4)            4           scalar   COM                                                
 NEV                        Scalar 11749    I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 11770    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 11764    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 11766    I(4)            4     1     21       COM                                                
 NL                         Local  11800    I(4)            4           scalar                    11800,11801,11804                 
 NLV                        Scalar 11748    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 11749    I(4)            4           scalar   COM              11792                             
 NLVW                       Scalar 11749    I(4)            4           scalar   COM                                                
 NMANLV                     Func   11800    I(4)            4           scalar                    11800                             
 NQI                        Scalar 11760    I(4)            4     1     255      COM                                                
 NQV                        Scalar 11762    I(4)            4     1     255      COM                                                
 NST                        Param  11742    I(4)            4           scalar                    11747,11748,11749,11756,11765     
 NTDI                       Scalar 11760    I(4)            4     1     255      COM                                                
 NTDV                       Scalar 11762    I(4)            4     1     255      COM                                                
 NTI                        Scalar 11760    I(4)            4     1     255      COM              11783,11798,11849                 
 NTL                        Scalar 11762    I(4)            4     1     255      COM                                                
 NTV                        Scalar 11762    I(4)            4     1     255      COM              11783,11792,11796,11799,11855,1186
                                                                                                  2                                 
 NTVM                       Local  11793    I(4)            4           scalar                    11793,11796,11856,11863           
 NTVP                       Local  11789    I(4)            4           scalar                    11789,11792,11856,11863           
 NZI                        Scalar 11760    I(4)            4     1     255      COM                                                
 NZV                        Scalar 11762    I(4)            4     1     255      COM                                                
 PFC                        Scalar 11750    R(4)            4     1     255      COM                                                
 PI                         Scalar 11758    R(4)            4     1     255      COM                                                
 POB                        Scalar 11750    R(4)            4     1     255      COM              11783,11800,11809,11830,11876,1188
                                                                                                  3                                 
 POUT                       Scalar 11773    L(4)            4           scalar   COM              11781,11820,11825,11841,11846,1185
                                                                                                  4,11861,11868                     
 PQM                        Scalar 11750    R(4)            4     1     255      COM                                                
 PRC                        Scalar 11750    R(4)            4     1     255      COM                                                
 PRNT                       Local  11780    L(4)            4           scalar                                                      

Page 399         Source Listing                  SIGERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PS                         Scalar 11756    R(4)            4     1     999      COM                                                
 PSCOR                      Scalar 11773    R(4)            4           scalar   COM                                                
 PSINC                      Scalar 11765    R(4)            4           scalar   COM                                                
 PTCOR                      Local  11787    R(4)            4           scalar                    11787,11810,11831,11851,11858,1186
                                                                                                  5,11871,11877                     
 QFC                        Scalar 11754    R(4)            4     1     255      COM                                                
 QG                         Local  11780    L(4)            4           scalar                                                      
 QI                         Scalar 11758    R(4)            4     1     255      COM                                                
 QM                         Local  11818    R(4)            4           scalar                    11818,11823,11839,11844,11852,1185
                                                                                                  9,11866,11872,11877,11881,11884   
 QOB                        Scalar 11754    R(4)            4     1     255      COM              11881,11884                       
 QQM                        Scalar 11754    R(4)            4     1     255      COM              11879,11880                       
 QRC                        Scalar 11754    R(4)            4     1     255      COM                                                
 QV                         Scalar 11759    R(4)            4     1     255      COM                                                
 RATIO                      Local  11801    R(4)            4           scalar                    11801,11802                       
 RESID                      Common 11758                                41312                                                       
 ROUND                      Subr   11809                                                          11809,11830                       
 SDMQ                       Local  11780    L(4)            4           scalar                    11878,11879,11882                 
 SEVENT                     Subr   11876                                                          11876,11883                       
 SID                        Scalar 11747    CHAR            8     1     999      COM              11783,11876,11883                 
 SIGERR                     Subr   11741                                                                                            
 SIMPLE                     Subr   11808                                                          11808,11829                       
 SQN                        Scalar 11748    R(4)            4     1     999      COM              11876,11883                       
 STN                        Common 11771                                4                                                           
 T1                         Scalar 11772    R(4)            4           scalar   COM                                                
 TC1                        Local  11807    R(4)            4           scalar                    11807,11808,11809,11810,11811,1181
                                                                                                  4,11822,11828,11829,11830,11831,11
                                                                                                  832,11835,11843,11850,11851,11857,
                                                                                                  11858,11864,11865,11870,11871,1187
                                                                                                  6,11877                           
 TCBEST                     Scalar 11772    R(4)            4     1     2        COM              11803,11806,11807                 
 TCLIM                      Scalar 11770    R(4)            4           scalar   COM                                                
 TCOR                       Scalar 11772    R(4)            4     1     2        COM              11806,11811,11832                 
 TDFC                       Scalar 11753    R(4)            4     1     255      COM                                                
 TDG                        Local  11780    L(4)            4           scalar                                                      
 TDI                        Scalar 11758    R(4)            4     1     255      COM                                                
 TDO                        Scalar 11753    R(4)            4     1     255      COM                                                
 TDV                        Scalar 11759    R(4)            4     1     255      COM                                                
 TEST                       Scalar 11774    L(4)            4           scalar   COM              11783                             
 TESTS                      Common 11774                                4                                                           
 TFACT                      Scalar 11769    R(4)            4     2     84       COM                                                
 TFC                        Scalar 11752    R(4)            4     1     255      COM                                                
 TG                         Local  11780    L(4)            4           scalar                                                      
 TI                         Scalar 11758    R(4)            4     1     255      COM              11798,11801,11803,11814,11828,1183
                                                                                                  5,11849                           
 TL                         Scalar 11759    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 11765    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 11769    R(4)            4     2     84       COM                                                
 TOB                        Scalar 11752    R(4)            4     1     255      COM              11808,11829,11877                 
 TQM                        Scalar 11752    R(4)            4     1     255      COM                                                
 TRC                        Scalar 11752    R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 11773    R(4)            4           scalar   COM                                                
 TV                         Scalar 11759    R(4)            4     1     255      COM              11799,11801,11804,11814,11835,1185
                                                                                                  5,11862                           
 TVO                        Scalar 11753    R(4)            4     1     255      COM                                                

Page 400         Source Listing                  SIGERR
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VOIRES                     Scalar 11769    R(4)            4     2     84       COM              11804                             
 XDR                        Scalar 11757    R(4)            4     1     255      COM                                                
 XINC                       Scalar 11768    R(4)            4     2     84       COM              11801,11804                       
 XMISS                      Scalar 11775    R(4)            4           scalar   COM              11803,11804,11812,11813,11814,1181
                                                                                                  5,11816,11833,11834,11835,11836,11
                                                                                                  837,11877,11884,11885             
 XOB                        Scalar 11747    R(4)            4     1     999      COM                                                
 XQI                        Scalar 11761    R(4)            4     1     255      COM                                                
 XQV                        Scalar 11763    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 11767    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 11761    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 11763    R(4)            4     1     255      COM                                                
 XTH                        Scalar 11766    R(4)            4     1     255      COM                                                
 XTI                        Scalar 11761    R(4)            4     1     255      COM                                                
 XTV                        Scalar 11763    R(4)            4     1     255      COM                                                
 XZH                        Scalar 11766    R(4)            4     1     255      COM                                                
 XZI                        Scalar 11761    R(4)            4     1     255      COM                                                
 XZV                        Scalar 11763    R(4)            4     1     255      COM                                                
 YDR                        Scalar 11757    R(4)            4     1     255      COM                                                
 YOB                        Scalar 11747    R(4)            4     1     999      COM                                                
 ZCBEST                     Scalar 11772    R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 11770    R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 11772    R(4)            4     1     2        COM                                                
 ZD                         Scalar 11766    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 11751    R(4)            4     1     255      COM                                                
 ZG                         Local  11780    L(4)            4           scalar                                                      
 ZI                         Scalar 11758    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 11751    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 11751    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 11751    R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 11773    R(4)            4           scalar   COM                                                
 ZV                         Scalar 11759    R(4)            4     1     255      COM                                                

Page 401         Source Listing                  SIGERR
2017-04-18 11:07                                 cqcbufr.f

  11891 
  11892 C***************************************************************
  11893 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11894 C                .      .    .                                       .
  11895 C SUBPROGRAM:    SIMPLE      ATTEMPT TO FIND ONE-DIGIT CORRECTION
  11896 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1988-10-17
  11897 C
  11898 C ABSTRACT: TESTS CORRECTION OF ONE DIGIT OR INTERCHANGE
  11899 C   OF DIGITS OF VAL WITH A VALUE OF COR WITHIN RANGE SPECIFIED BY
  11900 C   ALL.
  11901 C
  11902 C PROGRAM HISTORY LOG:
  11903 C 1988-10-17  W. Collins  Original author.
  11904 C
  11905 C USAGE:    CALL SIMPLE(COR,VAL,ALL,N,CON)
  11906 C   INPUT ARGUMENT LIST:
  11907 C     COR      - HYDROSTATIC CORRECTION (UNITS VARY)
  11908 C     VAL      - VALUE TO BE CORRECTED (UNITS VARY)
  11909 C     ALL      - ARRAY OF ALLOWABLE VARIATION
  11910 C     N        - DIMENSION OF ALL
  11911 C     CON      = 1.  FOR HEIGHT
  11912 C              = 10. FOR TEMPERATURE
  11913 C
  11914 C   OUTPUT ARGUMENT LIST:
  11915 C     COR      - CORRECTION AS (POSSIBLY) MODIFIED BY
  11916 C              - THIS SUBROUTINE
  11917 C
  11918 C OUTPUT FILES:
  11919 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  11920 C
  11921 C REMARKS: NONE.
  11922 C
  11923 C ATTRIBUTES:
  11924 C   LANGUAGE: FORTRAN 90
  11925 C   MACHINE:  NCEP WCOSS
  11926 C
  11927 C$$$
  11928       SUBROUTINE SIMPLE(COR,VAL,ALL,N,CON)
  11929 C
  11930 C     SUBROUTINE TO TEST CORRECTION OF ONE DIGIT OF VAL
  11931 C     OR TWO OR MORE DIGITS OF VAL FOR PERMUTATION
  11932 C     WITH A VALUE OF COR WITHIN RANGE SPECIFIED BY ALL.
  11933 C       AS AN EXAMPLE:
  11934 C         FOR HEIGHT, ALL MIGHT HAVE VALUES OF 0., -10., +10.
  11935 C         THE VALUES SHOULD BE IN THE ORDER TO BE TESTED.
  11936 C
  11937 
  11938       REAL(8) BMISS
  11939 
  11940       REAL ALL(*)
  11941       COMMON /TESTS/   TEST
  11942       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  11943 
  11944       LOGICAL          TEST
  11945       INTEGER IDIG(0:10), IDIGT(0:10), JDIG(0:10), JDIGT(0:10)
  11946 
  11947       IF(COR.GE.BMISS) RETURN

Page 402         Source Listing                  SIMPLE
2017-04-18 11:07                                 cqcbufr.f

  11948       IF(TEST) WRITE(60,500) COR
  11949   500 FORMAT(' SIMPLE--ORIGINAL COR: ',F10.2)
  11950   501 FORMAT('         FINAL COR:    ',F10.2)
  11951 
  11952 C  TEST FOR SIGN CORRECTION
  11953 C  ------------------------
  11954 
  11955       IF(ABS(2.*VAL+COR).LE.ALL(N)/CON) THEN
  11956         COR = -2.*VAL
  11957         RETURN
  11958       ENDIF
  11959 
  11960       VAL0 = VAL
  11961       IVAL = NINT(CON*VAL)
  11962       VAL  = IVAL
  11963       COR0 = COR
  11964       ICOR = NINT(CON*COR)
  11965       COR  = ICOR
  11966       COR1 = ICOR
  11967 
  11968       DO 100 NN=1,N
  11969       DO 10 I=0,10
  11970         IDIG(I) = 0
  11971         IDIGT(I) = 0
  11972         JDIG(I) = 0
  11973         JDIGT(I) = 0
  11974    10 CONTINUE
  11975 
  11976 C
  11977 C     PUT THE DIGITS OF VAL INTO IDIG, BEGINNING WITH THE
  11978 C     UNIT DIGIT AND GOING TO HIGHER DIGITS.
  11979 C     DO NOT PAY ATTENTION TO THE SIGN.
  11980 C     ALSO COUNT NUMBER OF EACH DIGIT IN JDIG.
  11981 C
  11982       IVAL = ABS(VAL)
  11983       IF(IVAL.EQ.0) GO TO 40
  11984       DO 30 I=0,10
  11985         IDIG(I) = IVAL - 10 * (IVAL/10)
  11986         II = IDIG(I) + 1
  11987         JDIG(II) = JDIG(II) + 1
  11988         IVAL = IVAL/10
  11989         IF(IVAL.EQ.0) GO TO 40
  11990    30 CONTINUE
  11991    40 CONTINUE
  11992 C
  11993 C     MAKE A PROVISIONAL CORRECTION TO VAL.
  11994 C
  11995       VALT = VAL + COR + ALL(NN)
  11996 C
  11997 C     PUT DIGITS OF VALT INTO IDIGT.
  11998 C     ALSO COUNT NUMBER OF EACH DIGIT IN JDIGT.
  11999 C
  12000       IVALT = ABS(VALT)
  12001       IF(IVALT.EQ.0) GO TO 60
  12002       DO 50 I=0,10
  12003         IDIGT(I) = IVALT - 10 * (IVALT/10)
  12004         II = IDIGT(I) + 1

Page 403         Source Listing                  SIMPLE
2017-04-18 11:07                                 cqcbufr.f

  12005         JDIGT(II) = JDIGT(II) + 1
  12006         IVALT = IVALT/10
  12007         IF(IVALT.EQ.0) GO TO 60
  12008    50 CONTINUE
  12009    60 CONTINUE
  12010 C
  12011 C     COUNT THE NUMBER OF DIGITS THAT ARE DIFFERENT
  12012 C     BETWEEN IDIG AND IDIGT.
  12013 C
  12014       ICNT = 0
  12015       DO 70 I=0,10
  12016         IF(IDIG(I).NE.IDIGT(I)) ICNT = ICNT + 1
  12017    70 CONTINUE
  12018 C
  12019 C     TEST OF PERMUTATION OF DIGITS.
  12020 C
  12021       JCNT = 0
  12022       DO 80 I=0,10
  12023         JCNT = JCNT + (JDIG(I) - JDIGT(I))**2
  12024    80 CONTINUE
  12025 C
  12026 C     IF (ICNT.EQ.1.(ONE DIGIT DIFFERENT)
  12027 C       OR .JCNT.EQ.0) (PERMUTATION OF DIGITS)
  12028 C       THEN COR + ALL(NN) IS ACCEPTABLE.
  12029 C
  12030       IF(ICNT.EQ.1.OR.JCNT.EQ.0) THEN
  12031         COR = COR + ALL(NN)
  12032         COR = COR/CON
  12033         VAL = VAL0
  12034         IF(TEST) WRITE(60,501) COR
  12035         RETURN
  12036       ENDIF
  12037   100 CONTINUE
  12038 C
  12039 C     IF THIS POINT IS REACHED, THE ORIGINAL COR, ROUNDED, IS RETAINED.
  12040 C
  12041       COR = COR1/CON
  12042       VAL = VAL0
  12043       IF(TEST) WRITE(60,501) COR
  12044       RETURN
  12045       END

Page 404         Source Listing                  SIMPLE
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 simple_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  11974                                                          11969                             
 100                        Label  12037                                                          11968                             
 30                         Label  11990                                                          11984                             
 40                         Label  11991                                                          11983,11989                       
 50                         Label  12008                                                          12002                             
 500                        Label  11949                                                          11948                             
 501                        Label  11950                                                          12034,12043                       
 60                         Label  12009                                                          12001,12007                       
 70                         Label  12017                                                          12015                             
 80                         Label  12024                                                          12022                             
 ABS                        Func   11955                                scalar                    11955,11982,12000                 
 ALL                        Dummy  11928    R(4)            4     1     0        ARG,INOUT        11955,11995,12031                 
 BMISS                      Scalar 11938    R(8)            8           scalar   COM              11947                             
 BUFRLIB_MISSING            Common 11942                                16                                                          
 CON                        Dummy  11928    R(4)            4           scalar   ARG,INOUT        11955,11961,11964,12032,12041     
 COR                        Dummy  11928    R(4)            4           scalar   ARG,INOUT        11947,11948,11955,11956,11963,1196
                                                                                                  4,11965,11995,12031,12032,12034,12
                                                                                                  041,12043                         
 COR0                       Local  11963    R(4)            4           scalar                    11963                             
 COR1                       Local  11966    R(4)            4           scalar                    11966,12041                       
 I                          Local  11969    I(4)            4           scalar                    11969,11970,11971,11972,11973,1198
                                                                                                  4,11985,11986,12002,12003,12004,12
                                                                                                  015,12016,12022,12023             
 ICNT                       Local  12014    I(4)            4           scalar                    12014,12016,12030                 
 ICOR                       Local  11964    I(4)            4           scalar                    11964,11965,11966                 
 IDIG                       Local  11945    I(4)            4     1     11                        11970,11985,11986,12016           
 IDIGT                      Local  11945    I(4)            4     1     11                        11971,12003,12004,12016           
 II                         Local  11986    I(4)            4           scalar                    11986,11987,12004,12005           
 IMISS                      Scalar 11942    I(4)            4           scalar   COM                                                
 IVAL                       Local  11961    I(4)            4           scalar                    11961,11962,11982,11983,11985,1198
                                                                                                  8,11989                           
 IVALT                      Local  12000    I(4)            4           scalar                    12000,12001,12003,12006,12007     
 JCNT                       Local  12021    I(4)            4           scalar                    12021,12023,12030                 
 JDIG                       Local  11945    I(4)            4     1     11                        11972,11987,12023                 
 JDIGT                      Local  11945    I(4)            4     1     11                        11973,12005,12023                 
 N                          Dummy  11928    I(4)            4           scalar   ARG,INOUT        11955,11968                       
 NINT                       Func   11961                                scalar                    11961,11964                       
 NN                         Local  11968    I(4)            4           scalar                    11968,11995,12031                 
 SIMPLE                     Subr   11928                                                                                            
 TEST                       Scalar 11941    L(4)            4           scalar   COM              11948,12034,12043                 
 TESTS                      Common 11941                                4                                                           
 VAL                        Dummy  11928    R(4)            4           scalar   ARG,INOUT        11955,11956,11960,11961,11962,1198
                                                                                                  2,11995,12033,12042               
 VAL0                       Local  11960    R(4)            4           scalar                    11960,12033,12042                 

Page 405         Source Listing                  SIMPLE
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VALT                       Local  11995    R(4)            4           scalar                    11995,12000                       
 XMISS                      Scalar 11942    R(4)            4           scalar   COM                                                

Page 406         Source Listing                  SIMPLE
2017-04-18 11:07                                 cqcbufr.f

  12046 
  12047 C******************************************************************
  12048 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12049 C                .      .    .                                       .
  12050 C SUBPROGRAM:    SORT        SORT, BASED ON ORDER IN INDX
  12051 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1994-03-17
  12052 C
  12053 C ABSTRACT: SORT RA ACCORDING TO THE ORDER SPECIFIED BY THE INDICES
  12054 C   IN INDX.
  12055 C
  12056 C PROGRAM HISTORY LOG:
  12057 C 1994-03-17  W. Collins  Original author.
  12058 C
  12059 C USAGE:    CALL SORT(RA,INDX,N)
  12060 C   INPUT ARGUMENT LIST:
  12061 C     RA       - VARIABLE
  12062 C     INDX     - ORDER FOR REARRANGEMENT OF RA
  12063 C     N        - DIMENSION OF RA
  12064 C
  12065 C   OUTPUT ARGUMENT LIST:
  12066 C     RA       - VARIABLE
  12067 C
  12068 C REMARKS: NONE.
  12069 C
  12070 C ATTRIBUTES:
  12071 C   LANGUAGE: FORTRAN 90
  12072 C   MACHINE:  NCEP WCOSS
  12073 C
  12074 C$$$
  12075       SUBROUTINE SORT(RA,INDX,N)
  12076 C
  12077 C     SORT RA ACCORDING TO THE ORDER SPECIFIED BY THE
  12078 C     INDICES IN INDX.
  12079 C
  12080       PARAMETER (NST=999)
  12081 
  12082       DIMENSION RA(*), WKSP(NST)
  12083       INTEGER INDX(*)
  12084       DO J=1,N
  12085          WKSP(J) = RA(J)
  12086       ENDDO
  12087       DO J=1,N
  12088          RA(J) = WKSP(INDX(J))
  12089       ENDDO
  12090       RETURN
  12091       END

Page 407         Source Listing                  SORT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 sort_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INDX                       Dummy  12075    I(4)            4     1     0        ARG,INOUT        12088                             
 J                          Local  12084    I(4)            4           scalar                    12084,12085,12087,12088           
 N                          Dummy  12075    I(4)            4           scalar   ARG,INOUT        12084,12087                       
 NST                        Param  12080    I(4)            4           scalar                    12082                             
 RA                         Dummy  12075    R(4)            4     1     0        ARG,INOUT        12085,12088                       
 SORT                       Subr   12075                                                                                            
 WKSP                       Local  12082    R(4)            4     1     999                       12085,12088                       

Page 408         Source Listing                  SORT
2017-04-18 11:07                                 cqcbufr.f

  12092 
  12093 C******************************************************************
  12094 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12095 C                .      .    .                                       .
  12096 C SUBPROGRAM:    STAT        CALCULATE STATISTICS FOR CHECKS
  12097 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1991-07-23
  12098 C
  12099 C ABSTRACT: CALCULATE VARIOUS MOMENT STATISTICS FOR INCREMENTS
  12100 C   AND RESIDUALS.
  12101 C
  12102 C PROGRAM HISTORY LOG:
  12103 C 1991-07-23  W. Collins  Original author.
  12104 C 1998-09-23  W. Collins  Include statistics for 28 regions.  Also,
  12105 C     update these statistics to unit 23.
  12106 C
  12107 C USAGE:    CALL STAT(ITIME)
  12108 C   INPUT ARGUMENT LIST:
  12109 C     ITIME    - 1 - FIRST CALL TO INPUT FOR STATION
  12110 C                2 - SECOND CALL TO INPUT FOR STATION
  12111 C
  12112 C   INPUT FILES:
  12113 C     UNIT 23  - CONTAINS STATISTICS FOR OBSERVATION ERROR CHECKING
  12114 C
  12115 C   OUTPUT FILES:
  12116 C     UNIT 06  - PRINTOUT
  12117 C     UNIT 23  - CONTAINS STATISTICS FOR OBSERVATION ERROR CHECKING
  12118 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  12119 C
  12120 C REMARKS: NONE.
  12121 C
  12122 C ATTRIBUTES:
  12123 C   LANGUAGE: FORTRAN 90
  12124 C   MACHINE:  NCEP WCOSS
  12125 C
  12126 C$$$
  12127 
  12128       SUBROUTINE STAT(ITIME)
  12129       PARAMETER (NST=999)
  12130 
  12131 C
  12132 C     CALCULATE STATISTICS:
  12133 C       V  - VERTICAL
  12134 C       H  - HORIZONTAL
  12135 C       I  - INCREMENT
  12136 C       HY - HYDROSTATIC
  12137 C       B  - BASELINE
  12138 C       T  - TEMPORAL
  12139 C
  12140 C     LAST INDEX IN /STATS/ VARIABLES:
  12141 C       1  - HEIGHT
  12142 C       2  - TEMPERATURE
  12143 C       3  - DEW-POINT TEMPERATURE
  12144 C       4  - SPECIFIC HUMIDITY
  12145 C       5  - NORMALIZED HEIGHT
  12146 C       6  - NORMALIZED TEMPERATURE
  12147 C       7  - NORMALIZED DEW-POINT TEMPERATURE
  12148 C

Page 409         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12149 
  12150       REAL(8) BMISS
  12151 
  12152       REAL XLIM(2), X(NST), DD(7)
  12153       REAL XX(NST,28), AVGIX(21,2,28), STDIX(21,2,28),
  12154      &     SKIX(21,2,28), XKIX(21,2,28)
  12155       INTEGER JJ(28), MSKX(NST,28), NIX(21,2,28)
  12156       INTEGER NDIST(23), MSK(NST)
  12157       COMMON /REGION/  AVGIY(21,2,28), STDIY(21,2,28)
  12158       COMMON /STATS/   NV(21,7), AVGV(21,7), STDV(21,7),
  12159      &                 NH(21,7), AVGH(21,7), STDH(21,7),
  12160      &                 NI(21,7), AVGI(21,7), STDI(21,7),
  12161      &                 NT(21,4),  AVGT(21,4), STDT(21,4),
  12162      &                 NHY(21),   AVGHY(21),  STDHY(21),
  12163      &                 NB,        AVGB,       STDB,
  12164      &                 SKV(21,7), XKV(21,7),
  12165      &                 SKH(21,7), XKH(21,7),
  12166      &                 SKI(21,7), XKI(21,7),
  12167      &                 SKT(21,4), XKT(21,4),
  12168      &                 SKHY(21),  XKHY(21),
  12169      &                 SKB,       XKB
  12170       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  12171      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  12172      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
  12173      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  12174      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
  12175      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  12176      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  12177      &                 XTHM(21,NST),XTDVM(21,NST),
  12178      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  12179      &                 XQHM(21,NST),
  12180      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  12181      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  12182       COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4),
  12183      &                 ZIT(21,NST,4),  TIT(21,NST,4),
  12184      &                 ZTMP(21,NST),   TTMP(21,NST),
  12185      &                 NZTMP(21,NST),  NTTMP(21,NST),
  12186      &                 ITERR(4)
  12187       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  12188      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  12189      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  12190      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  12191      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  12192      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  12193      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  12194      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  12195      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  12196      &                 XTDH(255)
  12197       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  12198      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  12199      &                 NEV, ISF(NST), NLVM, NLVW
  12200       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  12201      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  12202      &                 ZCLIM, TCLIM, NHLIM
  12203       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  12204      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  12205       COMMON /LEVEL/   PMAND(21)

Page 410         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12206       COMMON /DATEX/   JDATE(5), CDATE
  12207       COMMON /TESTS/   TEST
  12208       COMMON /NO40S/   NORD23, WRT23
  12209       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  12210 
  12211       LOGICAL          TEST, NORD23, WRT23
  12212       CHARACTER*8      SID
  12213       CHARACTER*10     CDATE
  12214       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
  12215 
  12216       DATA DD /20.,1.,2.,.0001,.5,.5,.5/
  12217       DATA BETA /2.0/
  12218 
  12219       NLEVM = NLEV - 1
  12220       WRITE(6,533) CDATE
  12221   533 FORMAT(////' DATE: ',A10)
  12222 C
  12223 C     ZERO FIELDS.
  12224 C
  12225       DO I=1,21
  12226         DO J=1,7
  12227           NV(I,J)    = 0
  12228           NH(I,J)    = 0
  12229           NI(I,J)    = 0
  12230           AVGV(I,J)  = 0.
  12231           AVGH(I,J)  = 0.
  12232           AVGI(I,J)  = 0.
  12233           STDV(I,J)  = 0.
  12234           STDH(I,J)  = 0.
  12235           STDI(I,J)  = 0.
  12236         ENDDO
  12237         DO J=1,4
  12238           NT(I,J)    = 0
  12239           AVGT(I,J)  = 0.
  12240           STDT(I,J)  = 0.
  12241         ENDDO
  12242       ENDDO
  12243       DO I=1,21
  12244         NHY(I)   = 0
  12245         AVGHY(I) = 0.
  12246         STDHY(I) = 0.
  12247       ENDDO
  12248       NDIV  = 23
  12249       NB    = 0
  12250       AVGB  = 0.
  12251       STDB  = 0.
  12252       NZERO = 0
  12253       DZERO = 0.
  12254 C
  12255 C     DEFINE MASK FOR OBSERVATIONS TO INCLUDE IN COMPUTATIONS.
  12256 C
  12257       DO I=1,NST
  12258         MSK(I) = 0
  12259       ENDDO
  12260       DO I=1,NOBS
  12261         IF(ERROR(I)) MSK(I) = 1
  12262       ENDDO

Page 411         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12263       IF(TEST) WRITE(60,536)
  12264   536 FORMAT(' MASK:')
  12265       IF(TEST) WRITE(60,535) (I,MSK(I),I=1,NOBS)
  12266   535 FORMAT(1X,20(I4,I2),/)
  12267       DO 32 IV=1,7
  12268         DDIV = DD(IV)
  12269         IF(ITIME.EQ.1) THEN
  12270           IF(IV.EQ.1) WRITE(6,515)
  12271           IF(IV.EQ.2) WRITE(6,516)
  12272           IF(IV.EQ.3) WRITE(6,525)
  12273           IF(IV.EQ.4) WRITE(6,526)
  12274           IF(IV.LE.4) WRITE(6,512) DZERO, DDIV
  12275         ELSE
  12276           IF(IV.EQ.5) WRITE(6,515)
  12277           IF(IV.EQ.6) WRITE(6,516)
  12278           IF(IV.EQ.7) WRITE(6,525)
  12279           IF(IV.GE.5) WRITE(6,565) DZERO, DDIV
  12280         ENDIF
  12281         WRITE(6,534)
  12282         DO 30 L=1,MAND
  12283           IF(IV.LE.4) THEN
  12284             XLIM(1) = -XINC(L,IV)
  12285             XLIM(2) = XINC(L,IV)
  12286           ELSE
  12287             XLIM(1) = -10.
  12288             XLIM(2) = 10.
  12289           ENDIF
  12290           IF(ITIME.EQ.1) THEN
  12291             IF(IV.EQ.1) THEN
  12292               DO I=1,NOBS
  12293                 X(I) = ZIM(L,I)
  12294               ENDDO
  12295               IF(L.EQ.1) WRITE(6,513)
  12296               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12297      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12298      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12299               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12300             ELSEIF(IV.EQ.2) THEN
  12301               DO I=1,NOBS
  12302                 X(I) = TIM(L,I)
  12303               ENDDO
  12304               IF(L.EQ.1) WRITE(6,513)
  12305               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12306      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12307      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12308               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12309             ELSEIF(IV.EQ.3) THEN
  12310               DO I=1,NOBS
  12311                 X(I) = TDIM(L,I)
  12312               ENDDO
  12313               IF(L.EQ.1) WRITE(6,513)
  12314               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12315      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12316      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12317               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12318             ELSEIF(IV.EQ.4) THEN
  12319               DO I=1,NOBS

Page 412         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12320                 X(I) = QIM(L,I)
  12321               ENDDO
  12322               IF(L.EQ.1) WRITE(6,513)
  12323               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12324      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12325      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12326               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12327             ENDIF
  12328           ELSE
  12329             IF(IV.EQ.5) THEN
  12330               DO I=1,NOBS
  12331                 X(I) = XZIM(L,I)
  12332               ENDDO
  12333               IF(L.EQ.1) WRITE(6,513)
  12334               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12335      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12336      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12337               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12338             ELSEIF(IV.EQ.6) THEN
  12339               DO I=1,NOBS
  12340                 X(I) = XTIM(L,I)
  12341               ENDDO
  12342               IF(L.EQ.1) WRITE(6,513)
  12343               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12344      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12345      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12346               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12347             ELSEIF(IV.EQ.7) THEN
  12348               DO I=1,NOBS
  12349                 X(I) = XTDIM(L,I)
  12350               ENDDO
  12351               IF(L.EQ.1) WRITE(6,513)
  12352               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12353      &          DDIV,NZERO,DZERO,NI(L,IV),AVGI(L,IV),
  12354      &          STDI(L,IV),SKI(L,IV),XKI(L,IV))
  12355               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12356             ENDIF
  12357           ENDIF
  12358    30   CONTINUE
  12359    32 CONTINUE
  12360   512 FORMAT(' DISTRIBUTION FOR OBSERVED INCREMENTS.',
  12361      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12362      &  1PE12.3)
  12363   565 FORMAT(' DISTRIBUTION FOR NORMALIZED INCREMENTS.',
  12364      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12365      &  1PE12.3)
  12366   534   FORMAT(' ONLY STATIONS WITHOUT HYDROSTATIC SUSPICIONS',
  12367      &    ' ARE INCLUDED.')
  12368   513 FORMAT(/'  LEV  ... -10  -9  -8  -7  -6  -5',
  12369      &  '  -4  -3  -2  -1   0   1   2   3   4   5   6',
  12370      &  '   7   8   9  10 ...    MAXIMUM')
  12371   514 FORMAT(1X,I4,1X,23I4,1PE11.3)
  12372   515 FORMAT(/'HEIGHT')
  12373   516 FORMAT(/'TEMPERATURE')
  12374   525 FORMAT(/'DEW-POINT TEMPERATURE')
  12375   526 FORMAT(/'SPECIFIC HUMIDITY')
  12376       DO 42 IV=1,7

Page 413         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12377         DDIV = DD(IV)
  12378         IF(ITIME.EQ.1) THEN
  12379           IF(IV.EQ.1) WRITE(6,515)
  12380           IF(IV.EQ.2) WRITE(6,516)
  12381           IF(IV.EQ.3) WRITE(6,525)
  12382           IF(IV.EQ.4) WRITE(6,526)
  12383           IF(IV.LE.4) WRITE(6,517) DZERO, DDIV
  12384         ELSE
  12385           IF(IV.EQ.5) WRITE(6,515)
  12386           IF(IV.EQ.6) WRITE(6,516)
  12387           IF(IV.EQ.7) WRITE(6,525)
  12388           IF(IV.GE.5) WRITE(6,566) DZERO, DDIV
  12389         ENDIF
  12390         DO 40 L=1,MAND
  12391           IF(IV.LE.4) THEN
  12392             XLIM(1) = -VOIRES(L,IV)
  12393             XLIM(2) = VOIRES(L,IV)
  12394           ELSE
  12395             XLIM(1) = -10.
  12396             XLIM(2) = 10.
  12397           ENDIF
  12398           IF(ITIME.EQ.1) THEN
  12399             IF(IV.EQ.1) THEN
  12400               DO I=1,NOBS
  12401                 X(I) = ZVM(L,I)
  12402               ENDDO
  12403               IF(L.EQ.1) WRITE(6,513)
  12404               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12405      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12406      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))
  12407               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12408             ELSEIF(IV.EQ.2) THEN
  12409               DO I=1,NOBS
  12410                 X(I) = TVM(L,I)
  12411               ENDDO
  12412               IF(L.EQ.1) WRITE(6,513)
  12413               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12414      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12415      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))
  12416               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12417             ELSEIF(IV.EQ.3) THEN
  12418               DO I=1,NOBS
  12419                 X(I) = TDVM(L,I)
  12420               ENDDO
  12421               IF(L.EQ.1) WRITE(6,513)
  12422               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12423      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12424      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))
  12425               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12426             ELSEIF(IV.EQ.4) THEN
  12427               DO I=1,NOBS
  12428                 X(I) = QVM(L,I)
  12429               ENDDO
  12430               IF(L.EQ.1) WRITE(6,513)
  12431               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12432      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12433      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))

Page 414         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12434               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12435             ENDIF
  12436           ELSE
  12437             IF(IV.EQ.5) THEN
  12438               DO I=1,NOBS
  12439                 X(I) = XZVM(L,I)
  12440               ENDDO
  12441               IF(L.EQ.1) WRITE(6,513)
  12442               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12443      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12444      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))
  12445               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12446             ELSEIF(IV.EQ.6) THEN
  12447               DO I=1,NOBS
  12448                 X(I) = XTVM(L,I)
  12449               ENDDO
  12450               IF(L.EQ.1) WRITE(6,513)
  12451               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12452      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12453      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))
  12454               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12455             ELSEIF(IV.EQ.7) THEN
  12456               DO I=1,NOBS
  12457                 X(I) = XTDVM(L,I)
  12458               ENDDO
  12459               IF(L.EQ.1) WRITE(6,513)
  12460               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12461      &          DDIV,NZERO,DZERO,NV(L,IV),AVGV(L,IV),
  12462      &          STDV(L,IV),SKV(L,IV),XKV(L,IV))
  12463               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12464             ENDIF
  12465           ENDIF
  12466    40   CONTINUE
  12467    42 CONTINUE
  12468   517 FORMAT(' DISTRIBUTION FOR VERTICAL RESIDUALS.',
  12469      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12470      &  1PE12.3)
  12471   566 FORMAT(' DISTRIBUTION FOR NORMALIZED VERTICAL RESIDUALS.',
  12472      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12473      &  1PE12.3)
  12474       DO 52 IV=1,7
  12475         DDIV = DD(IV)
  12476         IF(ITIME.EQ.1) THEN
  12477           IF(IV.EQ.1) WRITE(6,515)
  12478           IF(IV.EQ.2) WRITE(6,516)
  12479           IF(IV.EQ.3) WRITE(6,525)
  12480           IF(IV.EQ.4) WRITE(6,526)
  12481           IF(IV.LE.4) WRITE(6,518) DZERO, DDIV
  12482         ELSE
  12483           IF(IV.EQ.5) WRITE(6,515)
  12484           IF(IV.EQ.6) WRITE(6,516)
  12485           IF(IV.EQ.7) WRITE(6,525)
  12486           IF(IV.GE.5) WRITE(6,567) DZERO, DDIV
  12487         ENDIF
  12488         DO 50 L=1,MAND
  12489           IF(IV.LE.4) THEN
  12490             XLIM(1) = -HOIRES(L,IV)

Page 415         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12491             XLIM(2) = HOIRES(L,IV)
  12492           ELSE
  12493             XLIM(1) = -10.
  12494             XLIM(2) = 10.
  12495           ENDIF
  12496           IF(ITIME.EQ.1) THEN
  12497             IF(IV.EQ.1) THEN
  12498               DO I=1,NOBS
  12499                 X(I) = ZHM(L,I)
  12500               ENDDO
  12501               IF(L.EQ.1) WRITE(6,513)
  12502               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12503      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12504      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12505               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12506             ELSEIF(IV.EQ.2) THEN
  12507               DO I=1,NOBS
  12508                 X(I) = THM(L,I)
  12509               ENDDO
  12510               IF(L.EQ.1) WRITE(6,513)
  12511               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12512      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12513      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12514               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12515             ELSEIF(IV.EQ.3) THEN
  12516               DO I=1,NOBS
  12517                 X(I) = TDHM(L,I)
  12518               ENDDO
  12519               IF(L.EQ.1) WRITE(6,513)
  12520               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12521      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12522      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12523               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12524             ELSEIF(IV.EQ.4) THEN
  12525               DO I=1,NOBS
  12526                 X(I) = QHM(L,I)
  12527               ENDDO
  12528               IF(L.EQ.1) WRITE(6,513)
  12529               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12530      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12531      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12532               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12533             ENDIF
  12534           ELSE
  12535             IF(IV.EQ.5) THEN
  12536               DO I=1,NOBS
  12537                 X(I) = XZHM(L,I)
  12538               ENDDO
  12539               IF(L.EQ.1) WRITE(6,513)
  12540               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12541      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12542      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12543               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12544             ELSEIF(IV.EQ.6) THEN
  12545               DO I=1,NOBS
  12546                 X(I) = XTHM(L,I)
  12547               ENDDO

Page 416         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12548               IF(L.EQ.1) WRITE(6,513)
  12549               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12550      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12551      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12552               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12553             ELSEIF(IV.EQ.7) THEN
  12554               DO I=1,NOBS
  12555                 X(I) = XTDHM(L,I)
  12556               ENDDO
  12557               IF(L.EQ.1) WRITE(6,513)
  12558               CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12559      &          DDIV,NZERO,DZERO,NH(L,IV),AVGH(L,IV),
  12560      &          STDH(L,IV),SKH(L,IV),XKH(L,IV))
  12561               WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12562             ENDIF
  12563           ENDIF
  12564 
  12565    50   CONTINUE
  12566    52 CONTINUE
  12567   518 FORMAT(' DISTRIBUTION FOR HORIZONTAL RESIDUALS.',
  12568      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12569      &  1PE12.3)
  12570   567 FORMAT(' DISTRIBUTION FOR NORMALIZED HORIZONTAL RESIDUALS.',
  12571      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12572      &  1PE12.3)
  12573 C---------------------------------------------
  12574       IF(ITIME.EQ.2) RETURN
  12575 C---------------------------------------------
  12576       DO IV=1,2
  12577         DDIV = DD(IV)
  12578         IF(IV.EQ.1) WRITE(6,515)
  12579         IF(IV.EQ.2) WRITE(6,516)
  12580         WRITE(6,534)
  12581         WRITE(6,571) DZERO, DDIV
  12582         WRITE(6,513)
  12583         DO L=1,MAND
  12584           XLIM(1) = -HOIRES(L,IV)
  12585           XLIM(2) = HOIRES(L,IV)
  12586 
  12587           IF(IV.EQ.1) THEN
  12588             DO I=1,NOBS
  12589               X(I) = ZTMP(L,I)
  12590             ENDDO
  12591           ELSEIF(IV.EQ.2) THEN
  12592             DO I=1,NOBS
  12593               X(I) = TTMP(L,I)
  12594             ENDDO
  12595           ENDIF
  12596 
  12597           CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12598      &      DDIV,NZERO,DZERO,NT(L,IV),AVGT(L,IV),
  12599      &      STDT(L,IV),SKT(L,IV),XKT(L,IV))
  12600           WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12601         ENDDO
  12602       ENDDO
  12603   571 FORMAT(' DISTRIBUTION FOR TEMPORAL RESIDUALS.',
  12604      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',

Page 417         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12605      &  1PE12.3)
  12606 C---------------------------------------------
  12607       DDIV = 5.
  12608       WRITE(6,515)
  12609       WRITE(6,534)
  12610       WRITE(6,519) DZERO, DDIV
  12611       WRITE(6,513)
  12612       DO 60 L=1,MAND-1
  12613         XLIM(1) = -HSCRES(L)
  12614         XLIM(2) = HSCRES(L)
  12615         DO I=1,NOBS
  12616           X(I) = HYDM(L,I)
  12617         ENDDO
  12618         CALL DISTR(X,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,
  12619      &    DDIV,NZERO,DZERO,NHY(L),AVGHY(L),
  12620      &    STDHY(L),SKHY(L),XKHY(L))
  12621         WRITE(6,514) L, (NDIST(I),I=1,NDIV), XLIM(2)
  12622    60 CONTINUE
  12623   519 FORMAT(' DISTRIBUTION FOR HYDROSTATIC RESIDUALS.',
  12624      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12625      &  1PE12.3)
  12626       XLIM(1) = -100.
  12627       XLIM(2) = 100.
  12628       DDIV = 2.
  12629       WRITE(6,520) DZERO, DDIV
  12630       WRITE(6,513)
  12631       WRITE(6,534)
  12632       CALL DISTR(BASRES,MSK,XLIM,XMISS,NOBS,NDIST,NDIV,DDIV,NZERO,
  12633      &  DZERO,NB,AVGB,STDB,SKB,XKB)
  12634       WRITE(6,521) (NDIST(I),I=1,NDIV)
  12635   520 FORMAT(/'DISTRIBUTION FOR BASELINE RESIDUALS.',
  12636      &  '  DIVISION ZERO = ',1PE12.3,'  DIVISION INCREMENT = ',
  12637      &  1PE12.3)
  12638   521 FORMAT(1X,5X,23I4)
  12639 C
  12640 C     PRINT STATISTICS.
  12641 C     THEY WILL BE PRINTED IN FIVE GROUPS:
  12642 C       NUMBER, AVERAGE, STANDARD DEVIATION, SKEWNESS, KURTOSIS.
  12643 C
  12644 C              -------- TEMP --------   --------- HT ---------
  12645 C       LEVEL  VERT   HOR   INC   TMP   VERT   HOR   INC   TMP   HYDRO
  12646 C         1      X     X     X     X      X      X    X     X      X
  12647 C        ...    ...   ...   ...   ...    ...   ...   ...   ...    ...
  12648 C        14      X     X     X     X      X     X     X     X      X
  12649 C        15      X     X     X     X      X     X     X     X
  12650 C
  12651       WRITE(6,500) XMI, XMA, YMI, YMA
  12652   500 FORMAT(////'OVERALL STATISTICS FOR LONGITUDES:',2F8.1,
  12653      &  /,'     AND LATITUDES:',2F8.1)
  12654       WRITE(6,506)
  12655       WRITE(6,501)
  12656   501 FORMAT(/'           ----------- HT ----------',
  12657      &  '   --------- TEMP ----------',
  12658      &  '   --- DEW-PT TEMP --   ----- SP HUM -----')
  12659       WRITE(6,502)
  12660   502 FORMAT(' LEVEL     VERT    HOR    INC    TMP   VERT    HOR',
  12661      &  '    INC    TMP   VERT    HOR    INC   VERT    HOR    INC',

Page 418         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12662      &  '  HYDRO')
  12663       DO 100 L=1,MAND
  12664         WRITE(6,503) L,NV(L,1),NH(L,1),NI(L,1),NT(L,1),NV(L,2),NH(L,2),
  12665      &     NI(L,2),NT(L,2),NV(L,3),NH(L,3),NI(L,3),NV(L,4),NH(L,4),
  12666      &     NI(L,4),NHY(L)
  12667   100 CONTINUE
  12668       WRITE(6,505) NB
  12669   503 FORMAT(1X,I5,2X,15I7)
  12670   505 FORMAT(' BASELINE:',I7)
  12671   506 FORMAT(/'NUMBERS OF OBSERVATIONS FOR EACH CHECK:')
  12672       WRITE(6,507)
  12673       WRITE(6,538)
  12674       WRITE(6,539)
  12675       DO 110 L=1,MAND
  12676         WRITE(6,540) L,AVGV(L,1),AVGH(L,1),AVGI(L,1),AVGT(L,1),
  12677      &    AVGV(L,2),AVGH(L,2),AVGI(L,2),AVGT(L,2),AVGV(L,3),AVGH(L,3),
  12678      &    AVGI(L,3),AVGV(L,4),AVGH(L,4),AVGI(L,4),AVGHY(L)
  12679   110 CONTINUE
  12680       WRITE(6,511) AVGB
  12681   509 FORMAT(1X,I5,2X,9F7.1,3F7.4,F7.1)
  12682   538 FORMAT(/'           ----------- HT ----------',
  12683      &  '   --------- TEMP ----------',
  12684      &  '   --- DEW-PT TEMP --   -------- SP HUM --------')
  12685   539 FORMAT(' LEVEL     VERT    HOR    INC    TMP   VERT    HOR',
  12686      &  '    INC    TMP   VERT    HOR    INC     VERT      HOR',
  12687      &  '      INC  HYDRO')
  12688   540 FORMAT(1X,I5,2X,11F7.1,3F9.5,F7.1)
  12689   541 FORMAT(1X,I5,2X,15F7.1)
  12690   511 FORMAT(' BASELINE:',F7.1)
  12691   507 FORMAT(/'MEAN OF OBSERVATIONS FOR EACH CHECK:')
  12692       WRITE(6,508)
  12693       WRITE(6,538)
  12694       WRITE(6,539)
  12695       DO 120 L=1,MAND
  12696         WRITE(6,540) L,STDV(L,1),STDH(L,1),STDI(L,1),STDT(L,1),
  12697      &    STDV(L,2),STDH(L,2),STDI(L,2),STDT(L,2),STDV(L,3),STDH(L,3),
  12698      &    STDI(L,3),STDV(L,4),STDH(L,4),STDI(L,4),STDHY(L)
  12699   120 CONTINUE
  12700       WRITE(6,511) STDB
  12701   508 FORMAT(/'STANDARD DEVIATION OF OBSERVATIONS FOR EACH CHECK:')
  12702       WRITE(6,531)
  12703       WRITE(6,501)
  12704       WRITE(6,502)
  12705       DO 130 L=1,MAND
  12706         WRITE(6,541) L,SKV(L,1),SKH(L,1),SKI(L,1),SKT(L,1),SKV(L,2),
  12707      &  SKH(L,2),SKI(L,2),SKT(L,2),SKV(L,3),SKH(L,3),SKI(L,3),
  12708      &  SKV(L,4),SKH(L,4),SKI(L,4),SKHY(L)
  12709   130 CONTINUE
  12710       WRITE(6,511) SKB
  12711   531 FORMAT(/'SKEWNESS OF OBSERVATIONS FOR EACH CHECK:')
  12712       WRITE(6,532)
  12713       WRITE(6,501)
  12714       WRITE(6,502)
  12715       DO 140 L=1,MAND
  12716         WRITE(6,541) L,XKV(L,1),XKH(L,1),XKI(L,1),XKT(L,1),XKV(L,2),
  12717      &    XKH(L,2),XKI(L,2),XKT(L,2),XKV(L,3),XKH(L,3),XKI(L,3),
  12718      &    XKV(L,4),XKH(L,4),XKI(L,4),XKHY(L)

Page 419         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12719   140 CONTINUE
  12720       WRITE(6,511) XKB
  12721   532 FORMAT(/'KURTOSIS OF OBSERVATIONS FOR EACH CHECK:')
  12722 
  12723 C
  12724 C     COMPUTE STATISTICS FOR OBSERVATION ERROR CHECKING: 28 REGIONS
  12725 C
  12726       DO IV=1,2
  12727         DO L=1,MAND
  12728           DO J=1,28
  12729             DO I=1,NST
  12730               MSKX(I,J) = 0
  12731             ENDDO
  12732           ENDDO
  12733           XLIM(1) = -XINC(L,IV)
  12734           XLIM(2) = XINC(L,IV)
  12735           IF(IV.EQ.1) THEN
  12736             DO IJ=1,28
  12737               JJ(IJ) = 0
  12738             ENDDO
  12739             DO I=1,NOBS
  12740               CALL AREA(IA,XOB(I),YOB(I))
  12741               IF(IA.NE.0) THEN
  12742                 JJ(IA) = JJ(IA) + 1
  12743                 XX(JJ(IA),IA) = ZIM(L,I)
  12744                 IF(ERROR(I)) MSKX(JJ(IA),IA) = 1
  12745               ENDIF
  12746             ENDDO
  12747           ELSEIF(IV.EQ.2) THEN
  12748             DO IJ=1,28
  12749               JJ(IJ) = 0
  12750             ENDDO
  12751             DO I=1,NOBS
  12752               CALL AREA(IA,XOB(I),YOB(I))
  12753               IF(IA.NE.0) THEN
  12754                 JJ(IA) = JJ(IA) + 1
  12755                 XX(JJ(IA),IA) = TIM(L,I)
  12756                 IF(ERROR(I)) MSKX(JJ(IA),IA) = 1
  12757               ENDIF
  12758             ENDDO
  12759           ENDIF
  12760           DO IA=1,28
  12761             DO I=1,JJ(IA)
  12762               X(I) = XX(I,IA)
  12763               MSK(I) = MSKX(I,IA)
  12764             ENDDO
  12765             CALL DISTR(X,MSK,XLIM,XMISS,JJ(IA),NDIST,NDIV,
  12766      &        DDIV,NZERO,DZERO,NIX(L,IV,IA),AVGIX(L,IV,IA),
  12767      &        STDIX(L,IV,IA),SKIX(L,IV,IA),XKIX(L,IV,IA))
  12768           ENDDO
  12769         ENDDO
  12770       ENDDO
  12771 C
  12772 C     PRINT RESULTS
  12773 C
  12774 C     WRITE(6,550)
  12775 C 550 FORMAT(' HEIGHT STATISTICS FOR TODAY BY REGION')

Page 420         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12776 C     DO L=1,21
  12777 C       WRITE(6,552) PMAND(L)
  12778 C 552   FORMAT(/' PRESSURE: ',F8.0)
  12779 C       DO J1=1,7
  12780 C         J2 = J1+7
  12781 C         J3 = J1+14
  12782 C         J4 = J1+21
  12783 C         WRITE(6,553) NIX(L,1,J1),NIX(L,1,J2),NIX(L,1,J3),NIX(L,1,J4),
  12784 C    &      AVGIX(L,1,J1),AVGIX(L,1,J2),AVGIX(L,1,J3),AVGIX(L,1,J4),
  12785 C    &      STDIX(L,1,J1),STDIX(L,1,J2),STDIX(L,1,J3),STDIX(L,1,J4)
  12786 C 553     FORMAT(1X,4I6,8F8.2)
  12787 C       ENDDO
  12788 C     ENDDO
  12789 
  12790 C     WRITE(6,554)
  12791 C 554 FORMAT(' TEMPERATURE STATISTICS FOR TODAY BY REGION')
  12792 C     DO L=1,21
  12793 C       WRITE(6,552) PMAND(L)
  12794 C       DO J1=1,7
  12795 C         J2 = J1+7
  12796 C         J3 = J1+14
  12797 C         J4 = J1+21
  12798 C         WRITE(6,553) NIX(L,2,J1),NIX(L,2,J2),NIX(L,2,J3),NIX(L,2,J4),
  12799 C    &      AVGIX(L,2,J1),AVGIX(L,2,J2),AVGIX(L,2,J3),AVGIX(L,2,J4),
  12800 C    &      STDIX(L,2,J1),STDIX(L,2,J2),STDIX(L,2,J3),STDIX(L,2,J4)
  12801 C       ENDDO
  12802 C     ENDDO
  12803 C
  12804 C     READ OLD STATISTICS FROM UNIT 23 SO THAT THEY CAN BE UPDATED.
  12805 C
  12806       DO IA=1,28
  12807         DO IV=1,2
  12808           READ(23,557,ERR=600) (AVGIY(I,IV,IA),I=1,21)
  12809           READ(23,558,ERR=600) (STDIY(I,IV,IA),I=1,21)
  12810         ENDDO
  12811       ENDDO
  12812       NORD23 = .FALSE.
  12813   557 FORMAT(1X,21F8.2)
  12814   558 FORMAT(1X,21F8.3)
  12815       DO IA=1,28
  12816         DO IV=1,2
  12817           DO L=1,21
  12818             ALPHA = AMIN1(1.,REAL(NIX(L,IV,IA))/400.)
  12819             AVGIY(L,IV,IA) = (1.-ALPHA)*AVGIY(L,IV,IA)
  12820      &        + ALPHA*AVGIX(L,IV,IA)
  12821             STDIY(L,IV,IA) = (1.-ALPHA)*STDIY(L,IV,IA)
  12822      &        + ALPHA*STDIX(L,IV,IA)
  12823           ENDDO
  12824         ENDDO
  12825       ENDDO
  12826 C
  12827 C     PRINT REVISED STATISTICS
  12828 C
  12829 C     WRITE(6,560)
  12830 C 560 FORMAT(' REVISED HEIGHT STATISTICS BY REGION')
  12831 C     DO L=1,21
  12832 C       WRITE(6,552) PMAND(L)

Page 421         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12833 C       DO J1=1,7
  12834 C         J2 = J1+7
  12835 C         J3 = J1+14
  12836 C         J4 = J1+21
  12837 C         WRITE(6,561)
  12838 C    &      AVGIY(L,1,J1),AVGIY(L,1,J2),AVGIY(L,1,J3),AVGIY(L,1,J4),
  12839 C    &      STDIY(L,1,J1),STDIY(L,1,J2),STDIY(L,1,J3),STDIY(L,1,J4)
  12840 C       ENDDO
  12841 C     ENDDO
  12842 C 561 FORMAT(1X,24X,8F8.2)
  12843 
  12844 C     WRITE(6,564)
  12845 C 564 FORMAT(' REVISED TEMPERATURE STATISTICS BY REGION')
  12846 C     DO L=1,21
  12847 C       WRITE(6,552) PMAND(L)
  12848 C       DO J1=1,7
  12849 C         J2 = J1+7
  12850 C         J3 = J1+14
  12851 C         J4 = J1+21
  12852 C         WRITE(6,561)
  12853 C    &      AVGIY(L,2,J1),AVGIY(L,2,J2),AVGIY(L,2,J3),AVGIY(L,2,J4),
  12854 C    &      STDIY(L,2,J1),STDIY(L,2,J2),STDIY(L,2,J3),STDIY(L,2,J4)
  12855 C       ENDDO
  12856 C     ENDDO
  12857 C
  12858 C     WRITE NEW STATISTICS TO UNIT 23
  12859 C
  12860       IF(WRT23) THEN
  12861         REWIND 23
  12862         DO IA=1,28
  12863           DO IV=1,2
  12864             WRITE(23,557) (AVGIY(I,IV,IA),I=1,21)
  12865             WRITE(23,558) (STDIY(I,IV,IA),I=1,21)
  12866           ENDDO
  12867         ENDDO
  12868       ENDIF
  12869 
  12870       RETURN
  12871 
  12872   600 CONTINUE
  12873       NORD23 = .TRUE.
  12874       RETURN
  12875       END

Page 422         Source Listing                  STAT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 stat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  12667                                                          12663                             
 110                        Label  12679                                                          12675                             
 120                        Label  12699                                                          12695                             
 130                        Label  12709                                                          12705                             
 140                        Label  12719                                                          12715                             
 30                         Label  12358                                                          12282                             
 32                         Label  12359                                                          12267                             
 40                         Label  12466                                                          12390                             
 42                         Label  12467                                                          12376                             
 50                         Label  12565                                                          12488                             
 500                        Label  12652                                                          12651                             
 501                        Label  12656                                                          12655,12703,12713                 
 502                        Label  12660                                                          12659,12704,12714                 
 503                        Label  12669                                                          12664                             
 505                        Label  12670                                                          12668                             
 506                        Label  12671                                                          12654                             
 507                        Label  12691                                                          12672                             
 508                        Label  12701                                                          12692                             
 509                        Label  12681                                                                                            
 511                        Label  12690                                                          12680,12700,12710,12720           
 512                        Label  12360                                                          12274                             
 513                        Label  12368                                                          12295,12304,12313,12322,12333,1234
                                                                                                  2,12351,12403,12412,12421,12430,12
                                                                                                  441,12450,12459,12501,12510,12519,
                                                                                                  12528,12539,12548,12557,12582,1261
                                                                                                  1,12630                           
 514                        Label  12371                                                          12299,12308,12317,12326,12337,1234
                                                                                                  6,12355,12407,12416,12425,12434,12
                                                                                                  445,12454,12463,12505,12514,12523,
                                                                                                  12532,12543,12552,12561,12600,1262
                                                                                                  1                                 
 515                        Label  12372                                                          12270,12276,12379,12385,12477,1248
                                                                                                  3,12578,12608                     
 516                        Label  12373                                                          12271,12277,12380,12386,12478,1248
                                                                                                  4,12579                           
 517                        Label  12468                                                          12383                             
 518                        Label  12567                                                          12481                             
 519                        Label  12623                                                          12610                             
 52                         Label  12566                                                          12474                             
 520                        Label  12635                                                          12629                             
 521                        Label  12638                                                          12634                             
 525                        Label  12374                                                          12272,12278,12381,12387,12479,1248
                                                                                                  5                                 
 526                        Label  12375                                                          12273,12382,12480                 

Page 423         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 531                        Label  12711                                                          12702                             
 532                        Label  12721                                                          12712                             
 533                        Label  12221                                                          12220                             
 534                        Label  12366                                                          12281,12580,12609,12631           
 535                        Label  12266                                                          12265                             
 536                        Label  12264                                                          12263                             
 538                        Label  12682                                                          12673,12693                       
 539                        Label  12685                                                          12674,12694                       
 540                        Label  12688                                                          12676,12696                       
 541                        Label  12689                                                          12706,12716                       
 557                        Label  12813                                                          12808,12864                       
 558                        Label  12814                                                          12809,12865                       
 565                        Label  12363                                                          12279                             
 566                        Label  12471                                                          12388                             
 567                        Label  12570                                                          12486                             
 571                        Label  12603                                                          12581                             
 60                         Label  12622                                                          12612                             
 600                        Label  12872                                                          12808,12809                       
 ALPHA                      Local  12818    R(4)            4           scalar                    12818,12819,12820,12821,12822     
 AMIN1                      Func   12818                                scalar                    12818                             
 AREA                       Subr   12740                                                          12740,12752                       
 AVGB                       Scalar 12163    R(4)            4           scalar   COM              12250,12633,12680                 
 AVGH                       Scalar 12159    R(4)            4     2     147      COM              12231,12503,12512,12521,12530,1254
                                                                                                  1,12550,12559,12676,12677,12678   
 AVGHY                      Scalar 12162    R(4)            4     1     21       COM              12245,12619,12678                 
 AVGI                       Scalar 12160    R(4)            4     2     147      COM              12232,12297,12306,12315,12324,1233
                                                                                                  5,12344,12353,12676,12677,12678   
 AVGIX                      Local  12153    R(4)            4     3     1176                      12766,12820                       
 AVGIY                      Scalar 12157    R(4)            4     3     1176     COM              12808,12819,12864                 
 AVGT                       Scalar 12161    R(4)            4     2     84       COM              12239,12598,12676,12677           
 AVGV                       Scalar 12158    R(4)            4     2     147      COM              12230,12405,12414,12423,12432,1244
                                                                                                  3,12452,12461,12676,12677,12678   
 B                          Scalar 12195    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 12194    R(4)            4     1     999      COM              12632                             
 BETA                       Local  12217    R(4)            4           scalar                    12217                             
 BMISS                      Scalar 12150    R(8)            8           scalar   COM                                                
 BRES                       Scalar 12181    R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 12209                                16                                                          
 CDATE                      Scalar 12206    CHAR            10          scalar   COM              12220                             
 CQCPC                      Scalar 12204    R(4)            4           scalar   COM                                                
 DATEX                      Common 12206                                30                                                          
 DD                         Local  12152    R(4)            4     1     7                         12216,12268,12377,12475,12577     
 DDIV                       Local  12268    R(4)            4           scalar                    12268,12274,12279,12297,12306,1231
                                                                                                  5,12324,12335,12344,12353,12377,12
                                                                                                  383,12388,12405,12414,12423,12432,
                                                                                                  12443,12452,12461,12475,12481,1248
                                                                                                  6,12503,12512,12521,12530,12541,12
                                                                                                  550,12559,12577,12581,12598,12607,
                                                                                                  12610,12619,12628,12629,12632,1276
                                                                                                  6                                 
 DHR                        Scalar 12197    R(4)            4     1     999      COM                                                
 DISTR                      Subr   12296                                                          12296,12305,12314,12323,12334,1234
                                                                                                  3,12352,12404,12413,12422,12431,12
                                                                                                  442,12451,12460,12502,12511,12520,
                                                                                                  12529,12540,12549,12558,12597,1261

Page 424         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  8,12632,12765                     
 DZERO                      Local  12253    R(4)            4           scalar                    12253,12274,12279,12297,12306,1231
                                                                                                  5,12324,12335,12344,12353,12383,12
                                                                                                  388,12405,12414,12423,12432,12443,
                                                                                                  12452,12461,12481,12486,12503,1251
                                                                                                  2,12521,12530,12541,12550,12559,12
                                                                                                  581,12598,12610,12619,12629,12633,
                                                                                                  12766                             
 ELV                        Scalar 12198    R(4)            4     1     999      COM                                                
 ERROR                      Scalar 12181    L(4)            4     1     999      COM              12261,12744,12756                 
 HEADER                     Common 12197                                35980                                                       
 HOIRES                     Scalar 12200    R(4)            4     2     84       COM              12490,12491,12584,12585           
 HSCRES                     Scalar 12200    R(4)            4     1     21       COM              12613,12614                       
 HYD                        Scalar 12193    R(4)            4     1     21       COM                                                
 HYDM                       Scalar 12181    R(4)            4     2     20979    COM              12616                             
 HYDN                       Scalar 12193    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 12193    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 12193    R(4)            4     1     21       COM                                                
 I                          Local  12225    I(4)            4           scalar                    12225,12227,12228,12229,12230,1223
                                                                                                  1,12232,12233,12234,12235,12238,12
                                                                                                  239,12240,12243,12244,12245,12246,
                                                                                                  12257,12258,12260,12261,12265,1229
                                                                                                  2,12293,12299,12301,12302,12308,12
                                                                                                  310,12311,12317,12319,12320,12326,
                                                                                                  12330,12331,12337,12339,12340,1234
                                                                                                  6,12348,12349,12355,12400,12401,12
                                                                                                  407,12409,12410,12416,12418,12419,
                                                                                                  12425,12427,12428,12434,12438,1243
                                                                                                  9,12445,12447,12448,12454,12456,12
                                                                                                  457,12463,12498,12499,12505,12507,
                                                                                                  12508,12514,12516,12517,12523,1252
                                                                                                  5,12526,12532,12536,12537,12543,12
                                                                                                  545,12546,12552,12554,12555,12561,
                                                                                                  12588,12589,12592,12593,12600,1261
                                                                                                  5,12616,12621,12634,12729,12730,12
                                                                                                  739,12740,12743,12744,12751,12752,
                                                                                                  12755,12756,12761,12762,12763,1280
                                                                                                  8,12809,12864,12865               
 IA                         Local  12740    I(4)            4           scalar                    12740,12741,12742,12743,12744,1275
                                                                                                  2,12753,12754,12755,12756,12760,12
                                                                                                  761,12762,12763,12765,12766,12767,
                                                                                                  12806,12808,12809,12815,12818,1281
                                                                                                  9,12820,12821,12822,12862,12864,12
                                                                                                  865                               
 IHSC                       Scalar 12194    I(4)            4     2     1020     COM                                                
 IJ                         Local  12736    I(4)            4           scalar                    12736,12737,12748,12749           
 IMISS                      Scalar 12209    I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 12204    I(4)            4           scalar   COM                                                
 ISC                        Scalar 12204    I(4)            4           scalar   COM                                                
 ISF                        Scalar 12199    I(4)            4     1     999      COM                                                
 ITERR                      Scalar 12186    I(4)            4     1     4        COM                                                
 ITIME                      Dummy  12128    I(4)            4           scalar   ARG,INOUT        12269,12290,12378,12398,12476,1249
                                                                                                  6,12574                           
 ITP                        Scalar 12198    I(4)            4     1     999      COM                                                
 IV                         Local  12267    I(4)            4           scalar                    12267,12268,12270,12271,12272,1227

Page 425         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,12274,12276,12277,12278,12279,12
                                                                                                  283,12284,12285,12291,12297,12298,
                                                                                                  12300,12306,12307,12309,12315,1231
                                                                                                  6,12318,12324,12325,12329,12335,12
                                                                                                  336,12338,12344,12345,12347,12353,
                                                                                                  12354,12376,12377,12379,12380,1238
                                                                                                  1,12382,12383,12385,12386,12387,12
                                                                                                  388,12391,12392,12393,12399,12405,
                                                                                                  12406,12408,12414,12415,12417,1242
                                                                                                  3,12424,12426,12432,12433,12437,12
                                                                                                  443,12444,12446,12452,12453,12455,
                                                                                                  12461,12462,12474,12475,12477,1247
                                                                                                  8,12479,12480,12481,12483,12484,12
                                                                                                  485,12486,12489,12490,12491,12497,
                                                                                                  12503,12504,12506,12512,12513,1251
                                                                                                  5,12521,12522,12524,12530,12531,12
                                                                                                  535,12541,12542,12544,12550,12551,
                                                                                                  12553,12559,12560,12576,12577,1257
                                                                                                  8,12579,12584,12585,12587,12591,12
                                                                                                  598,12599,12726,12733,12734,12735,
                                                                                                  12747,12766,12767,12807,12808,1280
                                                                                                  9,12816,12818,12819,12820,12821,12
                                                                                                  822,12863,12864,12865             
 J                          Local  12226    I(4)            4           scalar                    12226,12227,12228,12229,12230,1223
                                                                                                  1,12232,12233,12234,12235,12237,12
                                                                                                  238,12239,12240,12728,12730       
 JDATE                      Scalar 12206    I(4)            4     1     5        COM                                                
 JJ                         Local  12155    I(4)            4     1     28                        12737,12742,12743,12744,12749,1275
                                                                                                  4,12755,12756,12761,12765         
 L                          Local  12282    I(4)            4           scalar                    12282,12284,12285,12293,12295,1229
                                                                                                  7,12298,12299,12302,12304,12306,12
                                                                                                  307,12308,12311,12313,12315,12316,
                                                                                                  12317,12320,12322,12324,12325,1232
                                                                                                  6,12331,12333,12335,12336,12337,12
                                                                                                  340,12342,12344,12345,12346,12349,
                                                                                                  12351,12353,12354,12355,12390,1239
                                                                                                  2,12393,12401,12403,12405,12406,12
                                                                                                  407,12410,12412,12414,12415,12416,
                                                                                                  12419,12421,12423,12424,12425,1242
                                                                                                  8,12430,12432,12433,12434,12439,12
                                                                                                  441,12443,12444,12445,12448,12450,
                                                                                                  12452,12453,12454,12457,12459,1246
                                                                                                  1,12462,12463,12488,12490,12491,12
                                                                                                  499,12501,12503,12504,12505,12508,
                                                                                                  12510,12512,12513,12514,12517,1251
                                                                                                  9,12521,12522,12523,12526,12528,12
                                                                                                  530,12531,12532,12537,12539,12541,
                                                                                                  12542,12543,12546,12548,12550,1255
                                                                                                  1,12552,12555,12557,12559,12560,12
                                                                                                  561,12583,12584,12585,12589,12593,
                                                                                                  12598,12599,12600,12612,12613,1261
                                                                                                  4,12616,12619,12620,12621,12663,12
                                                                                                  664,12665,12666,12675,12676,12677,
                                                                                                  12678,12695,12696,12697,12698,1270
                                                                                                  5,12706,12707,12708,12715,12716,12

Page 426         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  717,12718,12727,12733,12734,12743,
                                                                                                  12755,12766,12767,12817,12818,1281
                                                                                                  9,12820,12821,12822               
 LEVEL                      Common 12205                                84                                                          
 LIMS                       Common 12200                                1776                                                        
 LMAND                      Scalar 12204    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 12204    I(4)            4           scalar   COM                                                
 MAND                       Scalar 12203    I(4)            4           scalar   COM              12282,12390,12488,12583,12612,1266
                                                                                                  3,12675,12695,12705,12715,12727   
 MANRES                     Common 12170                                2949048                                                     
 MSK                        Local  12156    I(4)            4     1     999                       12258,12261,12265,12296,12305,1231
                                                                                                  4,12323,12334,12343,12352,12404,12
                                                                                                  413,12422,12431,12442,12451,12460,
                                                                                                  12502,12511,12520,12529,12540,1254
                                                                                                  9,12558,12597,12618,12632,12763,12
                                                                                                  765                               
 MSKX                       Local  12155    I(4)            4     2     27972                     12730,12744,12756,12763           
 NB                         Scalar 12163    I(4)            4           scalar   COM              12249,12633,12668                 
 NBAS                       Scalar 12195    I(4)            4           scalar   COM                                                
 NDIST                      Local  12156    I(4)            4     1     23                        12296,12299,12305,12308,12314,1231
                                                                                                  7,12323,12326,12334,12337,12343,12
                                                                                                  346,12352,12355,12404,12407,12413,
                                                                                                  12416,12422,12425,12431,12434,1244
                                                                                                  2,12445,12451,12454,12460,12463,12
                                                                                                  502,12505,12511,12514,12520,12523,
                                                                                                  12529,12532,12540,12543,12549,1255
                                                                                                  2,12558,12561,12597,12600,12618,12
                                                                                                  621,12632,12634,12765             
 NDIV                       Local  12248    I(4)            4           scalar                    12248,12296,12299,12305,12308,1231
                                                                                                  4,12317,12323,12326,12334,12337,12
                                                                                                  343,12346,12352,12355,12404,12407,
                                                                                                  12413,12416,12422,12425,12431,1243
                                                                                                  4,12442,12445,12451,12454,12460,12
                                                                                                  463,12502,12505,12511,12514,12520,
                                                                                                  12523,12529,12532,12540,12543,1254
                                                                                                  9,12552,12558,12561,12597,12600,12
                                                                                                  618,12621,12632,12634,12765       
 NEV                        Scalar 12199    I(4)            4           scalar   COM                                                
 NH                         Scalar 12159    I(4)            4     2     147      COM              12228,12503,12512,12521,12530,1254
                                                                                                  1,12550,12559,12664,12665         
 NHLIM                      Scalar 12202    I(4)            4           scalar   COM                                                
 NHY                        Scalar 12162    I(4)            4     1     21       COM              12244,12619,12666                 
 NHYD                       Scalar 12193    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 12195    I(4)            4     1     21       COM                                                
 NI                         Scalar 12160    I(4)            4     2     147      COM              12229,12297,12306,12315,12324,1233
                                                                                                  5,12344,12353,12664,12665,12666   
 NIX                        Local  12155    I(4)            4     3     1176                      12766,12818                       
 NLEV                       Scalar 12203    I(4)            4           scalar   COM              12219                             
 NLEVM                      Local  12219    I(4)            4           scalar                    12219                             
 NLV                        Scalar 12198    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 12199    I(4)            4           scalar   COM                                                
 NLVW                       Scalar 12199    I(4)            4           scalar   COM                                                
 NO40S                      Common 12208                                8                                                           
 NOBS                       Scalar 12203    I(4)            4           scalar   COM              12260,12265,12292,12296,12301,1230
                                                                                                  5,12310,12314,12319,12323,12330,12

Page 427         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  334,12339,12343,12348,12352,12400,
                                                                                                  12404,12409,12413,12418,12422,1242
                                                                                                  7,12431,12438,12442,12447,12451,12
                                                                                                  456,12460,12498,12502,12507,12511,
                                                                                                  12516,12520,12525,12529,12536,1254
                                                                                                  0,12545,12549,12554,12558,12588,12
                                                                                                  592,12597,12615,12618,12632,12739,
                                                                                                  12751                             
 NORD23                     Scalar 12208    L(4)            4           scalar   COM              12812,12873                       
 NQHM                       Scalar 12178    I(4)            4     2     20979    COM                                                
 NQI                        Scalar 12189    I(4)            4     1     255      COM                                                
 NQV                        Scalar 12191    I(4)            4     1     255      COM                                                
 NST                        Param  12129    I(4)            4           scalar                    12152,12153,12155,12156,12170,1217
                                                                                                  1,12172,12173,12174,12175,12176,12
                                                                                                  177,12178,12179,12180,12181,12182,
                                                                                                  12183,12184,12185,12194,12197,1219
                                                                                                  8,12199,12257,12729               
 NT                         Scalar 12161    I(4)            4     2     84       COM              12238,12598,12664,12665           
 NTDHM                      Scalar 12178    I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 12189    I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 12173    I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 12191    I(4)            4     1     255      COM                                                
 NTHM                       Scalar 12176    I(4)            4     2     20979    COM                                                
 NTI                        Scalar 12189    I(4)            4     1     255      COM                                                
 NTIM                       Scalar 12173    I(4)            4     2     20979    COM                                                
 NTL                        Scalar 12191    I(4)            4     1     255      COM                                                
 NTTMP                      Scalar 12185    I(4)            4     2     20979    COM                                                
 NTV                        Scalar 12191    I(4)            4     1     255      COM                                                
 NV                         Scalar 12158    I(4)            4     2     147      COM              12227,12405,12414,12423,12432,1244
                                                                                                  3,12452,12461,12664,12665         
 NZERO                      Local  12252    I(4)            4           scalar                    12252,12297,12306,12315,12324,1233
                                                                                                  5,12344,12353,12405,12414,12423,12
                                                                                                  432,12443,12452,12461,12503,12512,
                                                                                                  12521,12530,12541,12550,12559,1259
                                                                                                  8,12619,12632,12766               
 NZHM                       Scalar 12176    I(4)            4     2     20979    COM                                                
 NZI                        Scalar 12189    I(4)            4     1     255      COM                                                
 NZIM                       Scalar 12173    I(4)            4     2     20979    COM                                                
 NZTMP                      Scalar 12185    I(4)            4     2     20979    COM                                                
 NZV                        Scalar 12191    I(4)            4     1     255      COM                                                
 PARAMS                     Common 12203                                148                                                         
 PI                         Scalar 12187    R(4)            4     1     255      COM                                                
 PIS                        Scalar 12181    R(4)            4     1     999      COM                                                
 PMAND                      Scalar 12205    R(4)            4     1     21       COM                                                
 PRNT                       Scalar 12204    L(4)            4           scalar   COM                                                
 PSINC                      Scalar 12194    R(4)            4           scalar   COM                                                
 QG                         Scalar 12180    L(4)            4     2     20979    COM                                                
 QHM                        Scalar 12171    R(4)            4     2     20979    COM              12526                             
 QI                         Scalar 12187    R(4)            4     1     255      COM                                                
 QIM                        Scalar 12170    R(4)            4     2     20979    COM              12320                             
 QV                         Scalar 12188    R(4)            4     1     255      COM                                                
 QVM                        Scalar 12172    R(4)            4     2     20979    COM              12428                             
 RADPC                      Scalar 12203    R(4)            4           scalar   COM                                                
 REAL                       Func   12818                                scalar                    12818                             
 REGION                     Common 12157                                9408                                                        

Page 428         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RESID                      Common 12187                                41312                                                       
 SID                        Scalar 12197    CHAR            8     1     999      COM                                                
 SKB                        Scalar 12169    R(4)            4           scalar   COM              12633,12710                       
 SKH                        Scalar 12165    R(4)            4     2     147      COM              12504,12513,12522,12531,12542,1255
                                                                                                  1,12560,12706,12707,12708         
 SKHY                       Scalar 12168    R(4)            4     1     21       COM              12620,12708                       
 SKI                        Scalar 12166    R(4)            4     2     147      COM              12298,12307,12316,12325,12336,1234
                                                                                                  5,12354,12706,12707,12708         
 SKIX                       Local  12154    R(4)            4     3     1176                      12767                             
 SKT                        Scalar 12167    R(4)            4     2     84       COM              12599,12706,12707                 
 SKV                        Scalar 12164    R(4)            4     2     147      COM              12406,12415,12424,12433,12444,1245
                                                                                                  3,12462,12706,12707,12708         
 SQN                        Scalar 12198    R(4)            4     1     999      COM                                                
 STAT                       Subr   12128                                                                                            
 STATS                      Common 12158                                10940                                                       
 STDB                       Scalar 12163    R(4)            4           scalar   COM              12251,12633,12700                 
 STDH                       Scalar 12159    R(4)            4     2     147      COM              12234,12504,12513,12522,12531,1254
                                                                                                  2,12551,12560,12696,12697,12698   
 STDHY                      Scalar 12162    R(4)            4     1     21       COM              12246,12620,12698                 
 STDI                       Scalar 12160    R(4)            4     2     147      COM              12235,12298,12307,12316,12325,1233
                                                                                                  6,12345,12354,12696,12697,12698   
 STDIX                      Local  12153    R(4)            4     3     1176                      12767,12822                       
 STDIY                      Scalar 12157    R(4)            4     3     1176     COM              12809,12821,12865                 
 STDT                       Scalar 12161    R(4)            4     2     84       COM              12240,12599,12696,12697           
 STDV                       Scalar 12158    R(4)            4     2     147      COM              12233,12406,12415,12424,12433,1244
                                                                                                  4,12453,12462,12696,12697,12698   
 TCLIM                      Scalar 12202    R(4)            4           scalar   COM                                                
 TDG                        Scalar 12180    L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 12171    R(4)            4     2     20979    COM              12517                             
 TDI                        Scalar 12187    R(4)            4     1     255      COM                                                
 TDIM                       Scalar 12170    R(4)            4     2     20979    COM              12311                             
 TDV                        Scalar 12188    R(4)            4     1     255      COM                                                
 TDVM                       Scalar 12172    R(4)            4     2     20979    COM              12419                             
 TEST                       Scalar 12207    L(4)            4           scalar   COM              12263,12265                       
 TESTS                      Common 12207                                4                                                           
 TFACT                      Scalar 12201    R(4)            4     2     84       COM                                                
 TG                         Scalar 12180    L(4)            4     2     20979    COM                                                
 THM                        Scalar 12171    R(4)            4     2     20979    COM              12508                             
 TI                         Scalar 12187    R(4)            4     1     255      COM                                                
 TIM                        Scalar 12170    R(4)            4     2     20979    COM              12302,12755                       
 TIT                        Scalar 12183    R(4)            4     3     83916    COM                                                
 TL                         Scalar 12188    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 12194    R(4)            4     1     255      COM                                                
 TMPSND                     Common 12182                                1678336                                                     
 TMPSTD                     Scalar 12201    R(4)            4     2     84       COM                                                
 TOBT                       Scalar 12182    R(4)            4     3     83916    COM                                                
 TT                         Scalar 12204    R(4)            4           scalar   COM                                                
 TTMP                       Scalar 12184    R(4)            4     2     20979    COM              12593                             
 TV                         Scalar 12188    R(4)            4     1     255      COM                                                
 TVM                        Scalar 12172    R(4)            4     2     20979    COM              12410                             
 VOIRES                     Scalar 12201    R(4)            4     2     84       COM              12392,12393                       
 VTPPC                      Scalar 12203    R(4)            4           scalar   COM                                                
 WRT23                      Scalar 12208    L(4)            4           scalar   COM              12860                             
 X                          Local  12152    R(4)            4     1     999                       12293,12296,12302,12305,12311,1231
                                                                                                  4,12320,12323,12331,12334,12340,12

Page 429         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  343,12349,12352,12401,12404,12410,
                                                                                                  12413,12419,12422,12428,12431,1243
                                                                                                  9,12442,12448,12451,12457,12460,12
                                                                                                  499,12502,12508,12511,12517,12520,
                                                                                                  12526,12529,12537,12540,12546,1254
                                                                                                  9,12555,12558,12589,12593,12597,12
                                                                                                  616,12618,12762,12765             
 XINC                       Scalar 12200    R(4)            4     2     84       COM              12284,12285,12733,12734           
 XKB                        Scalar 12169    R(4)            4           scalar   COM              12633,12720                       
 XKH                        Scalar 12165    R(4)            4     2     147      COM              12504,12513,12522,12531,12542,1255
                                                                                                  1,12560,12716,12717,12718         
 XKHY                       Scalar 12168    R(4)            4     1     21       COM              12620,12718                       
 XKI                        Scalar 12166    R(4)            4     2     147      COM              12298,12307,12316,12325,12336,1234
                                                                                                  5,12354,12716,12717,12718         
 XKIX                       Local  12154    R(4)            4     3     1176                      12767                             
 XKT                        Scalar 12167    R(4)            4     2     84       COM              12599,12716,12717                 
 XKV                        Scalar 12164    R(4)            4     2     147      COM              12406,12415,12424,12433,12444,1245
                                                                                                  3,12462,12716,12717,12718         
 XLIM                       Local  12152    R(4)            4     1     2                         12284,12285,12287,12288,12296,1229
                                                                                                  9,12305,12308,12314,12317,12323,12
                                                                                                  326,12334,12337,12343,12346,12352,
                                                                                                  12355,12392,12393,12395,12396,1240
                                                                                                  4,12407,12413,12416,12422,12425,12
                                                                                                  431,12434,12442,12445,12451,12454,
                                                                                                  12460,12463,12490,12491,12493,1249
                                                                                                  4,12502,12505,12511,12514,12520,12
                                                                                                  523,12529,12532,12540,12543,12549,
                                                                                                  12552,12558,12561,12584,12585,1259
                                                                                                  7,12600,12613,12614,12618,12621,12
                                                                                                  626,12627,12632,12733,12734,12765 
 XMA                        Scalar 12203    R(4)            4           scalar   COM              12651                             
 XMI                        Scalar 12203    R(4)            4           scalar   COM              12651                             
 XMISS                      Scalar 12209    R(4)            4           scalar   COM              12296,12305,12314,12323,12334,1234
                                                                                                  3,12352,12404,12413,12422,12431,12
                                                                                                  442,12451,12460,12502,12511,12520,
                                                                                                  12529,12540,12549,12558,12597,1261
                                                                                                  8,12632,12765                     
 XOB                        Scalar 12197    R(4)            4     1     999      COM              12740,12752                       
 XQHM                       Scalar 12179    R(4)            4     2     20979    COM                                                
 XQI                        Scalar 12190    R(4)            4     1     255      COM                                                
 XQIM                       Scalar 12175    R(4)            4     2     20979    COM                                                
 XQV                        Scalar 12192    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 12196    R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 12178    R(4)            4     2     20979    COM              12555                             
 XTDI                       Scalar 12190    R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 12174    R(4)            4     2     20979    COM              12349                             
 XTDV                       Scalar 12192    R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 12177    R(4)            4     2     20979    COM              12457                             
 XTH                        Scalar 12195    R(4)            4     1     255      COM                                                
 XTHM                       Scalar 12177    R(4)            4     2     20979    COM              12546                             
 XTI                        Scalar 12190    R(4)            4     1     255      COM                                                
 XTIM                       Scalar 12174    R(4)            4     2     20979    COM              12340                             
 XTV                        Scalar 12192    R(4)            4     1     255      COM                                                
 XTVM                       Scalar 12175    R(4)            4     2     20979    COM              12448                             
 XX                         Local  12153    R(4)            4     2     27972                     12743,12755,12762                 

Page 430         Source Listing                  STAT
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XZH                        Scalar 12195    R(4)            4     1     255      COM                                                
 XZHM                       Scalar 12176    R(4)            4     2     20979    COM              12537                             
 XZI                        Scalar 12190    R(4)            4     1     255      COM                                                
 XZIM                       Scalar 12174    R(4)            4     2     20979    COM              12331                             
 XZV                        Scalar 12192    R(4)            4     1     255      COM                                                
 XZVM                       Scalar 12175    R(4)            4     2     20979    COM              12439                             
 YMA                        Scalar 12203    R(4)            4           scalar   COM              12651                             
 YMI                        Scalar 12203    R(4)            4           scalar   COM              12651                             
 YOB                        Scalar 12197    R(4)            4     1     999      COM              12740,12752                       
 ZCLIM                      Scalar 12202    R(4)            4           scalar   COM                                                
 ZD                         Scalar 12195    R(4)            4     1     255      COM                                                
 ZG                         Scalar 12180    L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 12171    R(4)            4     2     20979    COM              12499                             
 ZI                         Scalar 12187    R(4)            4     1     255      COM                                                
 ZIM                        Scalar 12170    R(4)            4     2     20979    COM              12293,12743                       
 ZIT                        Scalar 12183    R(4)            4     3     83916    COM                                                
 ZOBT                       Scalar 12182    R(4)            4     3     83916    COM                                                
 ZTMP                       Scalar 12184    R(4)            4     2     20979    COM              12589                             
 ZV                         Scalar 12188    R(4)            4     1     255      COM                                                
 ZVM                        Scalar 12172    R(4)            4     2     20979    COM              12401                             

Page 431         Source Listing                  STAT
2017-04-18 11:07                                 cqcbufr.f

  12876 
  12877 C******************************************************************
  12878 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12879 C                .      .    .                                       .
  12880 C SUBPROGRAM:    STEVNTS     CALLS EVPROC FOR NEW EVENTS
  12881 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  12882 C
  12883 C ABSTRACT: Calls EVPROC with events created since last call.
  12884 C
  12885 C PROGRAM HISTORY LOG:
  12886 C 1997-03-18  W. Collins  Original author.
  12887 C
  12888 C USAGE:    CALL STENVTS
  12889 C
  12890 C REMARKS: NONE.
  12891 C
  12892 C ATTRIBUTES:
  12893 C   LANGUAGE: FORTRAN 90
  12894 C   MACHINE:  NCEP WCOSS
  12895 C
  12896 C$$$
  12897 
  12898       SUBROUTINE STEVNTS
  12899       SAVE IEVOLD
  12900       COMMON /EVENTS/  STN(2000),    SEQN(2000),  ISCAN(2000),
  12901      &                 LEVL(2000),   PRES(2000),  LTYP(2000),
  12902      &                 IVAR(2000),   COR(2000),   CORVAL(2000),
  12903      &                 LSTYP(2000),  PCOR(2000),  IEVENT,
  12904      &                 BASR(2000),   PISR(2000),  PSINCR(2000),
  12905      &                 QMARK(2000),  IETYP(2000), EDATE(2000)
  12906       CHARACTER*8 STN
  12907       CHARACTER*10    EDATE
  12908       DATA IEVOLD /0/
  12909 
  12910       I2 = IEVENT
  12911       ICALL = 1
  12912       CALL EVPROC(IEVOLD+1,I2,ICALL)
  12913       IEVOLD = IEVENT
  12914 
  12915       RETURN
  12916       END

Page 432         Source Listing                  STEVNTS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 stevnts_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BASR                       Scalar 12904    R(4)            4     1     2000     COM                                                
 COR                        Scalar 12902    R(4)            4     1     2000     COM                                                
 CORVAL                     Scalar 12902    R(4)            4     1     2000     COM                                                
 EDATE                      Scalar 12905    CHAR            10    1     2000     COM                                                
 EVENTS                     Common 12900                                156004                                                      
 EVPROC                     Subr   12912                                                          12912                             
 I2                         Local  12910    I(4)            4           scalar                    12910,12912                       
 ICALL                      Local  12911    I(4)            4           scalar                    12911,12912                       
 IETYP                      Scalar 12905    I(4)            4     1     2000     COM                                                
 IEVENT                     Scalar 12903    I(4)            4           scalar   COM              12910,12913                       
 IEVOLD                     Local  12899    I(4)            4           scalar   SAVE             12908,12912,12913                 
 ISCAN                      Scalar 12900    I(4)            4     1     2000     COM                                                
 IVAR                       Scalar 12902    I(4)            4     1     2000     COM                                                
 LEVL                       Scalar 12901    I(4)            4     1     2000     COM                                                
 LSTYP                      Scalar 12903    I(4)            4     1     2000     COM                                                
 LTYP                       Scalar 12901    I(4)            4     1     2000     COM                                                
 PCOR                       Scalar 12903    R(4)            4     1     2000     COM                                                
 PISR                       Scalar 12904    R(4)            4     1     2000     COM                                                
 PRES                       Scalar 12901    R(4)            4     1     2000     COM                                                
 PSINCR                     Scalar 12904    R(4)            4     1     2000     COM                                                
 QMARK                      Scalar 12905    R(4)            4     1     2000     COM                                                
 SEQN                       Scalar 12900    R(4)            4     1     2000     COM                                                
 STEVNTS                    Subr   12898                                                                                            
 STN                        Scalar 12900    CHAR            8     1     2000     COM                                                

Page 433         Source Listing                  STEVNTS
2017-04-18 11:07                                 cqcbufr.f

  12917 
  12918 C*****************************************************************
  12919 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12920 C                .      .    .                                       .
  12921 C SUBPROGRAM:    STNCNT      COUNT STATIONS BY WMO BLOCK.
  12922 C   PRGMMR: W. Collins       ORG: NP22       DATE: 1996-08-29
  12923 C
  12924 C ABSTRACT: ACCUMULATE COUNT OF RADIOSONDE STATIONS PROCESSED BY
  12925 C    WMO BLOCK AND TOTAL NUMBER OF SHIPS/RECOS.
  12926 C
  12927 C PROGRAM HISTORY LOG:
  12928 C 1996-08-29  W. Collins  Original author.
  12929 C
  12930 C USAGE:    CALL STNCNT
  12931 C
  12932 C   OUTPUT FILES:
  12933 C     UNIT NFSUM - UNIT NUMBER OF BLOCK TOTALS FILE
  12934 C     UNIT 06    - PRINTOUT
  12935 C     UNIT 60    - PRINT FILE, DETAILS OF DECISIONS
  12936 C
  12937 C REMARKS: NONE.
  12938 C
  12939 C ATTRIBUTES:
  12940 C   LANGUAGE: FORTRAN 90
  12941 C   MACHINE:  NCEP WCOSS
  12942 C
  12943 C$$$
  12944       SUBROUTINE STNCNT
  12945 
  12946       COMMON /DATEX/   JDATE(5), CDATE
  12947       COMMON /STNKNT/  ISHIP,IBLK(100)
  12948       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
  12949       COMMON /TESTS/   TEST
  12950       LOGICAL          TEST
  12951 
  12952       CHARACTER*8      BLOCK
  12953       CHARACTER*10     CDATE
  12954 
  12955       DATA BLOCK /'BLOCK TO'/
  12956       DATA NZERO /0/
  12957 
  12958 C  GET THE STATION COUNT TOTAL
  12959 C  ---------------------------
  12960 
  12961       ISUM = 0
  12962       DO I=1,99
  12963       ISUM = ISUM + IBLK(I)
  12964       ENDDO
  12965 
  12966 C  WRITE THE SUMMARY TO STANDARD OUTPUT FILES
  12967 C  ------------------------------------------
  12968 
  12969       WRITE(6 ,500) ISUM
  12970       WRITE(6 ,501) ISHIP
  12971       WRITE(6 ,507)
  12972 
  12973       IF(TEST) WRITE(60,500) ISUM

Page 434         Source Listing                  STNCNT
2017-04-18 11:07                                 cqcbufr.f

  12974       IF(TEST) WRITE(60,501) ISHIP
  12975       IF(TEST) WRITE(60,507)
  12976 
  12977 C  WRITE THE SUMMARY TO AN EVENTS FILE
  12978 C  -----------------------------------
  12979 
  12980       DO I=0,90,10
  12981       IF(I.EQ.0) THEN
  12982          WRITE(6 ,508) I, NZERO, (IBLK(J),J=1,9)
  12983          IF(TEST) WRITE(60,508) I, NZERO, (IBLK(J),J=1,9)
  12984       ELSE
  12985          WRITE(6 ,508) I, (IBLK(I+J-1),J=1,10)
  12986          IF(TEST) WRITE(60,508) I, (IBLK(I+J-1),J=1,10)
  12987       ENDIF
  12988       ENDDO
  12989 
  12990 C  WRITE VALUES TO EVENTS FILE FOR SUMMARY
  12991 C  ---------------------------------------
  12992 
  12993       WRITE(NFSUM,509) BLOCK, ISUM, ISHIP, (IBLK(I),I=1,25), CDATE
  12994       WRITE(NFSUM,510) BLOCK, (IBLK(I),I=26,50), CDATE
  12995       WRITE(NFSUM,510) BLOCK, (IBLK(I),I=51,75), CDATE
  12996       WRITE(NFSUM,511) BLOCK, (IBLK(I),I=76,99), CDATE
  12997 
  12998 C  FORMAT STATEMENTS
  12999 C  -----------------
  13000 
  13001 500   FORMAT(/'TOTAL NO. OF LAND STATIONS CHECKED:',I5)
  13002 501   FORMAT(' TOTAL NO. OF SHIPS/RECOS CHECKED:',I5)
  13003 507   FORMAT(' STATION COUNTS BY WMO BLOCK:',//,
  13004      .    6X,'    0    1    2    3    4    5    6    7',
  13005      .    '    8    9',/)
  13006 508   FORMAT(1X,11I5)
  13007 509   FORMAT(1X,A8,I6,I5,25I4,1X,A10)
  13008 510   FORMAT(1X,A8,11X  ,25I4,1X,A10)
  13009 511   FORMAT(1X,A8,11X  ,24I4,5X,A10)
  13010 
  13011       RETURN
  13012       END

Page 435         Source Listing                  STNCNT
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name               
                     
 stncnt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  13001                                                          12969,12973                       
 501                        Label  13002                                                          12970,12974                       
 507                        Label  13003                                                          12971,12975                       
 508                        Label  13006                                                          12982,12983,12985,12986           
 509                        Label  13007                                                          12993                             
 510                        Label  13008                                                          12994,12995                       
 511                        Label  13009                                                          12996                             
 BLOCK                      Local  12952    CHAR            8           scalar                    12955,12993,12994,12995,12996     
 CDATE                      Scalar 12946    CHAR            10          scalar   COM              12993,12994,12995,12996           
 DATEX                      Common 12946                                30                                                          
 FILES                      Common 12948                                24                                                          
 I                          Local  12962    I(4)            4           scalar                    12962,12963,12980,12981,12982,1298
                                                                                                  3,12985,12986,12993,12994,12995,12
                                                                                                  996                               
 IBLK                       Scalar 12947    I(4)            4     1     100      COM              12963,12982,12983,12985,12986,1299
                                                                                                  3,12994,12995,12996               
 ISHIP                      Scalar 12947    I(4)            4           scalar   COM              12970,12974,12993                 
 ISUM                       Local  12961    I(4)            4           scalar                    12961,12963,12969,12973,12993     
 J                          Local  12982    I(4)            4           scalar                    12982,12983,12985,12986           
 JDATE                      Scalar 12946    I(4)            4     1     5        COM                                                
 NFEVN                      Scalar 12948    I(4)            4           scalar   COM                                                
 NFIN                       Scalar 12948    I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 12948    I(4)            4           scalar   COM                                                
 NFSGL                      Scalar 12948    I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 12948    I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 12948    I(4)            4           scalar   COM              12993,12994,12995,12996           
 NZERO                      Local  12956    I(4)            4           scalar                    12956,12982,12983                 
 STNCNT                     Subr   12944                                                                                            
 STNKNT                     Common 12947                                404                                                         
 TEST                       Scalar 12949    L(4)            4           scalar   COM              12973,12974,12975,12983,12986     
 TESTS                      Common 12949                                4                                                           

Page 436         Source Listing                  STNCNT
2017-04-18 11:07                                 cqcbufr.f

  13013 
  13014 C******************************************************************
  13015 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13016 C                .      .    .                                       .
  13017 C SUBPROGRAM:    STYPE       DETERMINE THE TYPE OF ALL SURFACES
  13018 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
  13019 C
  13020 C ABSTRACT: Determine the type of all surfaces.  They are:
  13021 C     110 - mandatory, below ground
  13022 C     120 - mandatory, first above ground
  13023 C     121 - mandatory, first above ground, lower hole boundary
  13024 C     130 - mandatory, middle
  13025 C     131 - mandatory, middle, lower hole boundary
  13026 C     132 - mandatory, middle, upper hole boundary
  13027 C     133 - mandatory, middle, isolated
  13028 C     140 - mandatory, top
  13029 C     142 - mandatory, top, upper hole boundary
  13030 C     150 - mandatory, incomplete
  13031 C     220 - significant, middle or top
  13032 C     224 - significant, middle or top, above top mand level
  13033 C     240 - surface
  13034 C
  13035 C PROGRAM HISTORY LOG:
  13036 C 1997-03-18  W. Collins  Original author.
  13037 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
  13038 C     were tested for not being equal to real value for missing (BMISS
  13039 C     = 10E10), these integer values can never be equal to BMISS for
  13040 C     I*4 due to overflow - instead they are now tested for not being
  13041 C     equal to new integer value for missing (IMISS, also = 10E10),
  13042 C     although this is also an overflow value for I*4, it results in a
  13043 C     correct evaluation
  13044 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
  13045 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
  13046 C     overflow (also done for IMISS). 
  13047 C
  13048 C USAGE:    CALL STYPE
  13049 C
  13050 C REMARKS: NONE.
  13051 C
  13052 C ATTRIBUTES:
  13053 C   LANGUAGE: FORTRAN 90
  13054 C   MACHINE:  NCEP WCOSS
  13055 C
  13056 C$$$
  13057 
  13058       SUBROUTINE STYPE
  13059       PARAMETER (NST=999)
  13060 
  13061       REAL(8) BMISS
  13062 
  13063       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  13064      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  13065      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  13066      &                 TDO(255), TDFC(255),TVO(255),
  13067      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  13068      &                 CAT(255), IND(255), LEVTYP(255),
  13069      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),

Page 437         Source Listing                  STYPE
2017-04-18 11:07                                 cqcbufr.f

  13070      &                 YDR(255), XDR(255)
  13071       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  13072      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  13073       COMMON /STN/     IS
  13074       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13075 
  13076       LOGICAL          PRNT
  13077 
  13078       LF  = 0
  13079       DO I=1,255
  13080         LST(I) = BMISS
  13081       ENDDO
  13082       DO L=1,NLEV
  13083 
  13084 C  FIND LM, THE MANDATORY LEVEL INDEX OF NEXT MAND LVL BELOW, AND
  13085 C       LP, THE MANDATORY LEVEL INDEX OF NEXT MAND LVL ABOVE
  13086 C       WHICH CONTAIN BOTH HEIGHT AND TEMPERATURE.
  13087 C  --------------------------------------------------------------
  13088 
  13089         LL = MANLEV(POB(L))
  13090         LM = BMISS
  13091         IF(L.EQ.1) GOTO 10
  13092         DO K=L-1,1,-1
  13093           IF(CAT(K).EQ.1 .AND. LEVTYP(K).LE.2) THEN
  13094             LM = MANLEV(POB(K))
  13095             GOTO 10
  13096           ENDIF
  13097         ENDDO
  13098    10   CONTINUE
  13099         LP = BMISS
  13100         IF(L.EQ.NLEV) GOTO 20
  13101         DO K=L+1,NLEV
  13102           IF(CAT(K).EQ.1 .AND. LEVTYP(K).LE.2) THEN
  13103             LP = MANLEV(POB(K))
  13104             GOTO 20
  13105           ENDIF
  13106         ENDDO
  13107    20   CONTINUE
  13108 
  13109 C  NOW DETERMINE SURFACE TYPE
  13110 C  --------------------------
  13111 
  13112         IF(CAT(L).EQ.0) THEN
  13113           LST(L) = 240
  13114         ELSEIF(CAT(L).EQ.1) THEN
  13115           IF(LF.EQ.0 .AND. POB(L).LE.PS(IS)) LF = L
  13116           IF(POB(L).GT.PS(IS) .AND. PS(IS).NE.0.) THEN
  13117             LST(L) = 110
  13118           ELSEIF(LEVTYP(L).GE.3) THEN
  13119             LST(L) = 150
  13120                                 ! LP will never test = bmiss, use imiss
  13121 cdak      ELSEIF(L.EQ.LF .AND. LP.NE.BMISS .AND. LP.GE.LL+3) THEN
  13122           ELSEIF(L.EQ.LF .AND. LP.NE.IMISS .AND. LP.GE.LL+3) THEN
  13123             LST(L) = 121
  13124           ELSEIF(L.EQ.LF) THEN
  13125             LST(L) = 120
  13126                          ! LP and LM will never test = bmiss, use imiss

Page 438         Source Listing                  STYPE
2017-04-18 11:07                                 cqcbufr.f

  13127 cdak      ELSEIF(LP.NE.BMISS .AND. LM.NE.BMISS .AND.
  13128           ELSEIF(LP.NE.IMISS .AND. LM.NE.IMISS .AND.
  13129      &           LP.LT.LL+3 .AND. LM.GT.LL-3) THEN
  13130             LST(L) = 130
  13131                          ! LP and LM will never test = bmiss, use imiss
  13132 cdak      ELSEIF(LP.NE.BMISS .AND. LM.NE.BMISS .AND.
  13133           ELSEIF(LP.NE.IMISS .AND. LM.NE.IMISS .AND.
  13134      &           LP.GE.LL+3 .AND. LM.GT.LL-3) THEN
  13135             LST(L) = 131
  13136                          ! LP and LM will never test = bmiss, use imiss
  13137 cdak      ELSEIF(LP.NE.BMISS .AND. LM.NE.BMISS .AND.
  13138           ELSEIF(LP.NE.IMISS .AND. LM.NE.IMISS .AND.
  13139      &           LP.LT.LL+3 .AND. LM.LE.LL-3) THEN
  13140             LST(L) = 132
  13141                          ! LP and LM will never test = bmiss, use imiss
  13142 cdak      ELSEIF(LP.NE.BMISS .AND. LM.NE.BMISS .AND.
  13143           ELSEIF(LP.NE.IMISS .AND. LM.NE.IMISS .AND.
  13144      &           LP.GE.LL+3 .AND. LM.LE.LL-3) THEN
  13145             LST(L) = 133
  13146                           ! LMAND(0) will never test = bmiss, use imiss
  13147 cdak      ELSEIF(LMAND(0).NE.BMISS) THEN
  13148           ELSEIF(LMAND(0).NE.IMISS) THEN
  13149                                 ! LM will never test = bmiss, use imiss
  13150 cdak        IF(L.EQ.LMAND(LMAND(0)) .AND. LM.NE.BMISS
  13151             IF(L.EQ.LMAND(LMAND(0)) .AND. LM.NE.IMISS
  13152      &        .AND. LM.LE.LL-3) THEN
  13153               LST(L) = 142
  13154             ELSEIF(L.EQ.LMAND(LMAND(0))) THEN
  13155               LST(L) = 140
  13156             ELSE
  13157               LST(L) = 130
  13158             ENDIF
  13159           ENDIF
  13160         ELSEIF(CAT(L).EQ.2 .OR. CAT(L).EQ.5) THEN
  13161                           ! LMAND(0) will never test = bmiss, use imiss
  13162 cdak      IF(LMAND(0).NE.BMISS) THEN
  13163           IF(LMAND(0).NE.IMISS) THEN
  13164             IF(L.GT.LSFC .AND. L.GT.LMAND(LMAND(0))) THEN
  13165               LST(L) = 224
  13166             ELSEIF(L.GT.LSFC) THEN
  13167               LST(L) = 220
  13168             ENDIF
  13169           ENDIF
  13170         ENDIF
  13171       ENDDO
  13172 
  13173       RETURN
  13174       END

Page 439         Source Listing                  STYPE
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 stype_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  13098                                                          13091,13095                       
 20                         Label  13107                                                          13100,13104                       
 ALLSND                     Common 13063                                34512                                                       
 BMISS                      Scalar 13061    R(8)            8           scalar   COM              13080,13090,13099                 
 BUFRLIB_MISSING            Common 13074                                16                                                          
 CAT                        Scalar 13068    R(4)            4     1     255      COM              13093,13102,13112,13114,13160     
 CQCPC                      Scalar 13072    R(4)            4           scalar   COM                                                
 GESPS                      Scalar 13069    R(4)            4     1     999      COM                                                
 HRDR                       Scalar 13069    R(4)            4     1     255      COM                                                
 I                          Local  13079    I(4)            4           scalar                    13079,13080                       
 IMISS                      Scalar 13074    I(4)            4           scalar   COM              13122,13128,13133,13138,13143,1314
                                                                                                  8,13151,13163                     
 IND                        Scalar 13068    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 13072    I(4)            4           scalar   COM                                                
 IS                         Scalar 13073    I(4)            4           scalar   COM              13115,13116                       
 ISC                        Scalar 13072    I(4)            4           scalar   COM                                                
 K                          Local  13092    I(4)            4           scalar                    13092,13093,13094,13101,13102,1310
                                                                                                  3                                 
 L                          Local  13082    I(4)            4           scalar                    13082,13089,13091,13092,13100,1310
                                                                                                  1,13112,13113,13114,13115,13116,13
                                                                                                  117,13118,13119,13122,13123,13124,
                                                                                                  13125,13130,13135,13140,13145,1315
                                                                                                  1,13153,13154,13155,13157,13160,13
                                                                                                  164,13165,13166,13167             
 LEVTYP                     Scalar 13068    I(4)            4     1     255      COM              13093,13102,13118                 
 LF                         Local  13078    I(4)            4           scalar                    13078,13115,13122,13124           
 LL                         Local  13089    I(4)            4           scalar                    13089,13122,13129,13134,13139,1314
                                                                                                  4,13152                           
 LM                         Local  13090    I(4)            4           scalar                    13090,13094,13128,13129,13133,1313
                                                                                                  4,13138,13139,13143,13144,13151,13
                                                                                                  152                               
 LMAND                      Scalar 13072    I(4)            4     1     22       COM              13148,13151,13154,13163,13164     
 LP                         Local  13099    I(4)            4           scalar                    13099,13103,13122,13128,13129,1313
                                                                                                  3,13134,13138,13139,13143,13144   
 LSFC                       Scalar 13072    I(4)            4           scalar   COM              13164,13166                       
 LST                        Scalar 13069    I(4)            4     1     255      COM              13080,13113,13117,13119,13123,1312
                                                                                                  5,13130,13135,13140,13145,13153,13
                                                                                                  155,13157,13165,13167             
 MAND                       Scalar 13071    I(4)            4           scalar   COM                                                
 MANLEV                     Func   13089    I(4)            4           scalar                    13089,13094,13103                 
 NLEV                       Scalar 13071    I(4)            4           scalar   COM              13082,13100,13101                 
 NOBS                       Scalar 13071    I(4)            4           scalar   COM                                                
 NST                        Param  13059    I(4)            4           scalar                    13069                             
 PARAMS                     Common 13071                                148                                                         

Page 440         Source Listing                  STYPE
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PFC                        Scalar 13063    R(4)            4     1     255      COM                                                
 POB                        Scalar 13063    R(4)            4     1     255      COM              13089,13094,13103,13115,13116     
 PQM                        Scalar 13063    R(4)            4     1     255      COM                                                
 PRC                        Scalar 13063    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 13072    L(4)            4           scalar   COM                                                
 PS                         Scalar 13069    R(4)            4     1     999      COM              13115,13116                       
 QFC                        Scalar 13067    R(4)            4     1     255      COM                                                
 QOB                        Scalar 13067    R(4)            4     1     255      COM                                                
 QQM                        Scalar 13067    R(4)            4     1     255      COM                                                
 QRC                        Scalar 13067    R(4)            4     1     255      COM                                                
 RADPC                      Scalar 13071    R(4)            4           scalar   COM                                                
 STN                        Common 13073                                4                                                           
 STYPE                      Subr   13058                                                                                            
 TDFC                       Scalar 13066    R(4)            4     1     255      COM                                                
 TDO                        Scalar 13066    R(4)            4     1     255      COM                                                
 TFC                        Scalar 13065    R(4)            4     1     255      COM                                                
 TOB                        Scalar 13065    R(4)            4     1     255      COM                                                
 TQM                        Scalar 13065    R(4)            4     1     255      COM                                                
 TRC                        Scalar 13065    R(4)            4     1     255      COM                                                
 TT                         Scalar 13072    R(4)            4           scalar   COM                                                
 TVO                        Scalar 13066    R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 13071    R(4)            4           scalar   COM                                                
 XDR                        Scalar 13070    R(4)            4     1     255      COM                                                
 XMA                        Scalar 13071    R(4)            4           scalar   COM                                                
 XMI                        Scalar 13071    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 13074    R(4)            4           scalar   COM                                                
 YDR                        Scalar 13070    R(4)            4     1     255      COM                                                
 YMA                        Scalar 13071    R(4)            4           scalar   COM                                                
 YMI                        Scalar 13071    R(4)            4           scalar   COM                                                
 ZFC                        Scalar 13064    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 13064    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 13064    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 13064    R(4)            4     1     255      COM                                                

Page 441         Source Listing                  STYPE
2017-04-18 11:07                                 cqcbufr.f

  13175 
  13176 C******************************************************************
  13177 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13178 C                .      .    .                                       .
  13179 C SUBPROGRAM:    T120        FIND ERRORS AT TYPE 120 LEVELS
  13180 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  13181 C
  13182 C ABSTRACT: Find errors at type 120 levels: mandatory, first above
  13183 C   ground.
  13184 C
  13185 C PROGRAM HISTORY LOG:
  13186 C 1997-03-18  W. Collins  Original author.
  13187 C
  13188 C USAGE:    CALL T120(L,LM)
  13189 C   INPUT ARGUMENT LIST:
  13190 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
  13191 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  13192 C
  13193 C REMARKS: NONE.
  13194 C
  13195 C ATTRIBUTES:
  13196 C   LANGUAGE: FORTRAN 90
  13197 C   MACHINE:  NCEP WCOSS
  13198 C
  13199 C$$$
  13200  
  13201       SUBROUTINE T120(L,LM)
  13202       PARAMETER (NST=999)
  13203 
  13204       REAL(8) BMISS
  13205 
  13206       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  13207      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  13208      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  13209      &                 TDO(255), TDFC(255),TVO(255),
  13210      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  13211      &                 CAT(255), IND(255), LEVTYP(255),
  13212      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  13213      &                 YDR(255), XDR(255)
  13214       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  13215      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  13216      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  13217      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  13218      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  13219      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  13220      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  13221      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  13222      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  13223      &                 XTDH(255)
  13224       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  13225      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  13226      &                 ZCLIM, TCLIM, NHLIM
  13227       COMMON /STN/     IS
  13228       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  13229      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  13230       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13231 

Page 442         Source Listing                  T120
2017-04-18 11:07                                 cqcbufr.f

  13232       LOGICAL LGM,LG0,LGP,POUT, PRNT
  13233 
  13234       IF(L.LE.0) RETURN
  13235 
  13236       IF(PS(IS)-POB(LM).GT.200.) THEN
  13237         CON = 1.0
  13238       ELSEIF(PS(IS)-POB(LM).LT.100.) THEN
  13239         CON = 2.0
  13240       ELSE
  13241         CON = 2.0 - (PS(IS)-POB(LM)-100.)/100.
  13242       ENDIF
  13243 
  13244 C  TYPE 120: MAND, FIRST ABOVE GROUND
  13245 C  ----------------------------------
  13246 
  13247 C  WHICH HYDROSTATIC RESIDUALS ARE LARGE?
  13248 C  --------------------------------------
  13249 
  13250       POUT = .FALSE.
  13251       LGM = .FALSE.
  13252       LG0 = .FALSE.
  13253       LGP = .FALSE.
  13254       IF(BASRES(IS).NE.BMISS .AND. NBAS.GT.8) LGM = .TRUE.
  13255       IF(HYDN(L).NE.BMISS) THEN
  13256         IF(NHYDN(L).GT.NHLIM) LG0 = .TRUE.
  13257       ENDIF
  13258       IF(HYDN(L+1).NE.BMISS) THEN
  13259         IF(NHYDN(L+1).GT.NHLIM) LGP=.TRUE.
  13260       ELSEIF(L+2.LE.21 .AND. HYDN(L+2).NE.BMISS) THEN
  13261         IF(NHYDN(L+2).GT.NHLIM) LGP=.TRUE.
  13262       ENDIF
  13263 
  13264 C  MAKE DECISION FOR POSSIBLE ERROR TYPE
  13265 C  -------------------------------------
  13266 
  13267       IF(.NOT.LGM .AND. .NOT.LG0) THEN
  13268 C                                       POSSIBLE OBSERVATION ERROR
  13269       ELSEIF(((LGM .AND. LG0 .AND. LGP) .OR. (LGM .AND. LGP))
  13270      &  .AND. LEVTYP(LM).LE.2) THEN
  13271         CALL ERR710(L,LM)             ! POSSIBLE TYPE 7-10 ERRORS
  13272 C     ELSEIF(LGM .AND. LG0 .AND. .NOT.LGP
  13273       ELSEIF(LG0 .AND. .NOT.LGP
  13274      &  .AND. LEVTYP(LM).LE.2) THEN
  13275         CALL ERR123(L,LM)             ! POSSIBLE TYPE 1,2,3 ERRORS
  13276       ELSEIF(LGM .AND. .NOT.LG0) THEN
  13277         CALL COMPER(L,LM)             ! POSSIBLE COMPUTATION ERROR
  13278       ENDIF
  13279 
  13280       RETURN
  13281       END

Page 443         Source Listing                  T120
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 t120_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLSND                     Common 13206                                34512                                                       
 B                          Scalar 13222    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 13221    R(4)            4     1     999      COM              13254                             
 BMISS                      Scalar 13204    R(8)            8           scalar   COM              13254,13255,13258,13260           
 BUFRLIB_MISSING            Common 13230                                16                                                          
 CAT                        Scalar 13211    R(4)            4     1     255      COM                                                
 COMPER                     Subr   13277                                                          13277                             
 CON                        Local  13237    R(4)            4           scalar                    13237,13239,13241                 
 ERR123                     Subr   13275                                                          13275                             
 ERR710                     Subr   13271                                                          13271                             
 GESPS                      Scalar 13212    R(4)            4     1     999      COM                                                
 H1                         Scalar 13228    R(4)            4           scalar   COM                                                
 H2                         Scalar 13228    R(4)            4           scalar   COM                                                
 HOIRES                     Scalar 13224    R(4)            4     2     84       COM                                                
 HRDR                       Scalar 13212    R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 13224    R(4)            4     1     21       COM                                                
 HYD                        Scalar 13220    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 13220    R(4)            4     1     21       COM              13255,13258,13260                 
 HYDQ                       Scalar 13220    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 13220    R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 13228                                64                                                          
 IHSC                       Scalar 13221    I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 13230    I(4)            4           scalar   COM                                                
 IND                        Scalar 13211    I(4)            4     1     255      COM                                                
 IS                         Scalar 13227    I(4)            4           scalar   COM              13236,13238,13241,13254           
 L                          Dummy  13201    I(4)            4           scalar   ARG,INOUT        13234,13255,13256,13258,13259,1326
                                                                                                  0,13261,13271,13275,13277         
 LAST                       Scalar 13229    I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 13211    I(4)            4     1     255      COM              13270,13274                       
 LG0                        Local  13232    L(4)            4           scalar                    13252,13256,13267,13269,13273,1327
                                                                                                  6                                 
 LGM                        Local  13232    L(4)            4           scalar                    13251,13254,13267,13269,13276     
 LGP                        Local  13232    L(4)            4           scalar                    13253,13259,13261,13269,13273     
 LIMS                       Common 13224                                1776                                                        
 LM                         Dummy  13201    I(4)            4           scalar   ARG,INOUT        13236,13238,13241,13270,13271,1327
                                                                                                  4,13275,13277                     
 LST                        Scalar 13212    I(4)            4     1     255      COM                                                
 NBAS                       Scalar 13222    I(4)            4           scalar   COM              13254                             
 NHLIM                      Scalar 13226    I(4)            4           scalar   COM              13256,13259,13261                 
 NHYD                       Scalar 13220    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 13222    I(4)            4     1     21       COM              13256,13259,13261                 
 NQI                        Scalar 13216    I(4)            4     1     255      COM                                                
 NQV                        Scalar 13218    I(4)            4     1     255      COM                                                
 NST                        Param  13202    I(4)            4           scalar                    13212,13221                       

Page 444         Source Listing                  T120
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTDI                       Scalar 13216    I(4)            4     1     255      COM                                                
 NTDV                       Scalar 13218    I(4)            4     1     255      COM                                                
 NTI                        Scalar 13216    I(4)            4     1     255      COM                                                
 NTL                        Scalar 13218    I(4)            4     1     255      COM                                                
 NTV                        Scalar 13218    I(4)            4     1     255      COM                                                
 NZI                        Scalar 13216    I(4)            4     1     255      COM                                                
 NZV                        Scalar 13218    I(4)            4     1     255      COM                                                
 PFC                        Scalar 13206    R(4)            4     1     255      COM                                                
 PI                         Scalar 13214    R(4)            4     1     255      COM                                                
 POB                        Scalar 13206    R(4)            4     1     255      COM              13236,13238,13241                 
 POUT                       Scalar 13229    L(4)            4           scalar   COM              13250                             
 PQM                        Scalar 13206    R(4)            4     1     255      COM                                                
 PRC                        Scalar 13206    R(4)            4     1     255      COM                                                
 PRNT                       Local  13232    L(4)            4           scalar                                                      
 PS                         Scalar 13212    R(4)            4     1     999      COM              13236,13238,13241                 
 PSCOR                      Scalar 13229    R(4)            4           scalar   COM                                                
 PSINC                      Scalar 13221    R(4)            4           scalar   COM                                                
 QFC                        Scalar 13210    R(4)            4     1     255      COM                                                
 QI                         Scalar 13214    R(4)            4     1     255      COM                                                
 QOB                        Scalar 13210    R(4)            4     1     255      COM                                                
 QQM                        Scalar 13210    R(4)            4     1     255      COM                                                
 QRC                        Scalar 13210    R(4)            4     1     255      COM                                                
 QV                         Scalar 13215    R(4)            4     1     255      COM                                                
 RESID                      Common 13214                                41312                                                       
 STN                        Common 13227                                4                                                           
 T1                         Scalar 13228    R(4)            4           scalar   COM                                                
 T120                       Subr   13201                                                                                            
 TCBEST                     Scalar 13228    R(4)            4     1     2        COM                                                
 TCLIM                      Scalar 13226    R(4)            4           scalar   COM                                                
 TCOR                       Scalar 13228    R(4)            4     1     2        COM                                                
 TDFC                       Scalar 13209    R(4)            4     1     255      COM                                                
 TDI                        Scalar 13214    R(4)            4     1     255      COM                                                
 TDO                        Scalar 13209    R(4)            4     1     255      COM                                                
 TDV                        Scalar 13215    R(4)            4     1     255      COM                                                
 TFACT                      Scalar 13225    R(4)            4     2     84       COM                                                
 TFC                        Scalar 13208    R(4)            4     1     255      COM                                                
 TI                         Scalar 13214    R(4)            4     1     255      COM                                                
 TL                         Scalar 13215    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 13221    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 13225    R(4)            4     2     84       COM                                                
 TOB                        Scalar 13208    R(4)            4     1     255      COM                                                
 TQM                        Scalar 13208    R(4)            4     1     255      COM                                                
 TRC                        Scalar 13208    R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 13229    R(4)            4           scalar   COM                                                
 TV                         Scalar 13215    R(4)            4     1     255      COM                                                
 TVO                        Scalar 13209    R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 13225    R(4)            4     2     84       COM                                                
 XDR                        Scalar 13213    R(4)            4     1     255      COM                                                
 XINC                       Scalar 13224    R(4)            4     2     84       COM                                                
 XMISS                      Scalar 13230    R(4)            4           scalar   COM                                                
 XQI                        Scalar 13217    R(4)            4     1     255      COM                                                
 XQV                        Scalar 13219    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 13223    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 13217    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 13219    R(4)            4     1     255      COM                                                

Page 445         Source Listing                  T120
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XTH                        Scalar 13222    R(4)            4     1     255      COM                                                
 XTI                        Scalar 13217    R(4)            4     1     255      COM                                                
 XTV                        Scalar 13219    R(4)            4     1     255      COM                                                
 XZH                        Scalar 13222    R(4)            4     1     255      COM                                                
 XZI                        Scalar 13217    R(4)            4     1     255      COM                                                
 XZV                        Scalar 13219    R(4)            4     1     255      COM                                                
 YDR                        Scalar 13213    R(4)            4     1     255      COM                                                
 ZCBEST                     Scalar 13228    R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 13226    R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 13228    R(4)            4     1     2        COM                                                
 ZD                         Scalar 13222    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 13207    R(4)            4     1     255      COM                                                
 ZI                         Scalar 13214    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 13207    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 13207    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 13207    R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 13229    R(4)            4           scalar   COM                                                
 ZV                         Scalar 13215    R(4)            4     1     255      COM                                                

Page 446         Source Listing                  T120
2017-04-18 11:07                                 cqcbufr.f

  13282 
  13283 C******************************************************************
  13284 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13285 C                .      .    .                                       .
  13286 C SUBPROGRAM:    T121        FIND ERRORS AT TYPE 121 LEVELS
  13287 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  13288 C
  13289 C ABSTRACT: Find errors at type 121 levels: mandatory, first above
  13290 C   ground, lower hole boundary.
  13291 C
  13292 C PROGRAM HISTORY LOG:
  13293 C 1997-03-18  W. Collins  Original author.
  13294 C
  13295 C USAGE:    CALL T121(L,LM)
  13296 C   INPUT ARGUMENT LIST:
  13297 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
  13298 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  13299 C
  13300 C REMARKS: NONE.
  13301 C
  13302 C ATTRIBUTES:
  13303 C   LANGUAGE: FORTRAN 90
  13304 C   MACHINE:  NCEP WCOSS
  13305 C
  13306 C$$$
  13307 
  13308       SUBROUTINE T121(L,LM)
  13309       PARAMETER (NST=999)
  13310 
  13311       REAL(8) BMISS
  13312 
  13313       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  13314      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  13315      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  13316      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  13317      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  13318      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  13319      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  13320      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  13321      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  13322      &                 XTDH(255)
  13323       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  13324      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  13325      &                 ZCLIM, TCLIM, NHLIM
  13326       COMMON /STN/     IS
  13327       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  13328      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  13329       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13330 
  13331       LOGICAL LGM,POUT
  13332 
  13333 C  TYPE 121: MAND, FIRST ABOVE GROUND, LOWER HOLE BNDRY (ISOLATED)
  13334 C  ---------------------------------------------------------------
  13335 
  13336 C  SEE IF BASRES IS LARGE
  13337 C  ----------------------
  13338 

Page 447         Source Listing                  T121
2017-04-18 11:07                                 cqcbufr.f

  13339       POUT = .FALSE.
  13340       LGM = .FALSE.
  13341       IF(BASRES(IS).LT.BMISS .AND. NBAS.GT.10)
  13342      &  LGM = .TRUE.
  13343 
  13344 C  MAKE DECISION FOR POSSIBLE ERROR TYPE
  13345 C  -------------------------------------
  13346 
  13347       IF(.NOT.LGM) THEN
  13348 C       POSSIBLE OBSERVATION ERROR
  13349       ELSEIF(LGM) THEN
  13350         CALL ERR123(L,LM)              ! POSSIBLE TYPE 1,2,3 ERRORS
  13351       ENDIF
  13352 
  13353       RETURN
  13354       END


ENTRY POINTS

  Name             
                   
 t121_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B                          Scalar 13321    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 13320    R(4)            4     1     999      COM              13341                             
 BMISS                      Scalar 13311    R(8)            8           scalar   COM              13341                             
 BUFRLIB_MISSING            Common 13329                                16                                                          
 ERR123                     Subr   13350                                                          13350                             
 H1                         Scalar 13327    R(4)            4           scalar   COM                                                
 H2                         Scalar 13327    R(4)            4           scalar   COM                                                
 HOIRES                     Scalar 13323    R(4)            4     2     84       COM                                                
 HSCRES                     Scalar 13323    R(4)            4     1     21       COM                                                
 HYD                        Scalar 13319    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 13319    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 13319    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 13319    R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 13327                                64                                                          
 IHSC                       Scalar 13320    I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 13329    I(4)            4           scalar   COM                                                
 IS                         Scalar 13326    I(4)            4           scalar   COM              13341                             
 L                          Dummy  13308    I(4)            4           scalar   ARG,INOUT        13350                             
 LAST                       Scalar 13328    I(4)            4           scalar   COM                                                
 LGM                        Local  13331    L(4)            4           scalar                    13340,13342,13347,13349           
 LIMS                       Common 13323                                1776                                                        
 LM                         Dummy  13308    I(4)            4           scalar   ARG,INOUT        13350                             
 NBAS                       Scalar 13321    I(4)            4           scalar   COM              13341                             
 NHLIM                      Scalar 13325    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 13319    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 13321    I(4)            4     1     21       COM                                                
 NQI                        Scalar 13315    I(4)            4     1     255      COM                                                
 NQV                        Scalar 13317    I(4)            4     1     255      COM                                                

Page 448         Source Listing                  T121
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NST                        Param  13309    I(4)            4           scalar                    13320                             
 NTDI                       Scalar 13315    I(4)            4     1     255      COM                                                
 NTDV                       Scalar 13317    I(4)            4     1     255      COM                                                
 NTI                        Scalar 13315    I(4)            4     1     255      COM                                                
 NTL                        Scalar 13317    I(4)            4     1     255      COM                                                
 NTV                        Scalar 13317    I(4)            4     1     255      COM                                                
 NZI                        Scalar 13315    I(4)            4     1     255      COM                                                
 NZV                        Scalar 13317    I(4)            4     1     255      COM                                                
 PI                         Scalar 13313    R(4)            4     1     255      COM                                                
 POUT                       Scalar 13328    L(4)            4           scalar   COM              13339                             
 PSCOR                      Scalar 13328    R(4)            4           scalar   COM                                                
 PSINC                      Scalar 13320    R(4)            4           scalar   COM                                                
 QI                         Scalar 13313    R(4)            4     1     255      COM                                                
 QV                         Scalar 13314    R(4)            4     1     255      COM                                                
 RESID                      Common 13313                                41312                                                       
 STN                        Common 13326                                4                                                           
 T1                         Scalar 13327    R(4)            4           scalar   COM                                                
 T121                       Subr   13308                                                                                            
 TCBEST                     Scalar 13327    R(4)            4     1     2        COM                                                
 TCLIM                      Scalar 13325    R(4)            4           scalar   COM                                                
 TCOR                       Scalar 13327    R(4)            4     1     2        COM                                                
 TDI                        Scalar 13313    R(4)            4     1     255      COM                                                
 TDV                        Scalar 13314    R(4)            4     1     255      COM                                                
 TFACT                      Scalar 13324    R(4)            4     2     84       COM                                                
 TI                         Scalar 13313    R(4)            4     1     255      COM                                                
 TL                         Scalar 13314    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 13320    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 13324    R(4)            4     2     84       COM                                                
 TSCOR                      Scalar 13328    R(4)            4           scalar   COM                                                
 TV                         Scalar 13314    R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 13324    R(4)            4     2     84       COM                                                
 XINC                       Scalar 13323    R(4)            4     2     84       COM                                                
 XMISS                      Scalar 13329    R(4)            4           scalar   COM                                                
 XQI                        Scalar 13316    R(4)            4     1     255      COM                                                
 XQV                        Scalar 13318    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 13322    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 13316    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 13318    R(4)            4     1     255      COM                                                
 XTH                        Scalar 13321    R(4)            4     1     255      COM                                                
 XTI                        Scalar 13316    R(4)            4     1     255      COM                                                
 XTV                        Scalar 13318    R(4)            4     1     255      COM                                                
 XZH                        Scalar 13321    R(4)            4     1     255      COM                                                
 XZI                        Scalar 13316    R(4)            4     1     255      COM                                                
 XZV                        Scalar 13318    R(4)            4     1     255      COM                                                
 ZCBEST                     Scalar 13327    R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 13325    R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 13327    R(4)            4     1     2        COM                                                
 ZD                         Scalar 13321    R(4)            4     1     255      COM                                                
 ZI                         Scalar 13313    R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 13328    R(4)            4           scalar   COM                                                
 ZV                         Scalar 13314    R(4)            4     1     255      COM                                                

Page 449         Source Listing                  T121
2017-04-18 11:07                                 cqcbufr.f

  13355 
  13356 C******************************************************************
  13357 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13358 C                .      .    .                                       .
  13359 C SUBPROGRAM:    T130        FIND ERRORS AT TYPE 130 LEVELS
  13360 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  13361 C
  13362 C ABSTRACT: Find errors at type 130 levels: mandatory, middle.
  13363 C
  13364 C PROGRAM HISTORY LOG:
  13365 C 1997-03-18  W. Collins  Original author.
  13366 C
  13367 C USAGE:    CALL T130(L,LM)
  13368 C   INPUT ARGUMENT LIST:
  13369 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
  13370 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  13371 C
  13372 C   OUTPUT FILES:
  13373 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  13374 C
  13375 C REMARKS: NONE.
  13376 C
  13377 C ATTRIBUTES:
  13378 C   LANGUAGE: FORTRAN 90
  13379 C   MACHINE:  NCEP WCOSS
  13380 C
  13381 C$$$
  13382 
  13383       SUBROUTINE T130(L,LM)
  13384       PARAMETER (NST=999)
  13385 
  13386       REAL(8) BMISS
  13387 
  13388       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  13389      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  13390      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  13391      &                 TDO(255), TDFC(255),TVO(255),
  13392      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  13393      &                 CAT(255), IND(255), LEVTYP(255),
  13394      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  13395      &                 YDR(255), XDR(255)
  13396       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  13397      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  13398      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  13399      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  13400      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  13401      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  13402      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  13403      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  13404      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  13405      &                 XTDH(255)
  13406       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  13407      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  13408      &                 ZCLIM, TCLIM, NHLIM
  13409       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  13410      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  13411       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,

Page 450         Source Listing                  T130
2017-04-18 11:07                                 cqcbufr.f

  13412      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  13413       COMMON /STN/     IS
  13414       COMMON /TESTS/   TEST
  13415       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13416 
  13417       LOGICAL          TEST
  13418 
  13419       LOGICAL LGM,LGMM,LG0,LGP,POUT, PRNT
  13420       IF(L.LE.1) RETURN
  13421 
  13422       IF(PS(IS)-POB(LM).GT.200.) THEN
  13423         CON = 1.0
  13424       ELSEIF(PS(IS)-POB(LM).LT.100.) THEN
  13425         CON = 2.0
  13426       ELSE
  13427         CON = 2.0 - (PS(IS)-POB(LM)-100.)/100.
  13428       ENDIF
  13429 
  13430 C  WHICH HYDROSTATIC RESIDUALS ARE LARGE?
  13431 C  ALLOW A SINGLE MISSING LEVEL
  13432 C  --------------------------------------
  13433 
  13434       POUT = .FALSE.
  13435       LGM  = .FALSE.
  13436       LGMM = .FALSE.
  13437       LG0  = .FALSE.
  13438       LGP  = .FALSE.
  13439 
  13440       IF(HYDN(L-1).NE.BMISS) THEN
  13441         IF(NHYDN(L-1).GT.NHLIM) LGM = .TRUE.
  13442       ELSEIF(L.GT.2) THEN
  13443         IF(HYDN(L-2).NE.BMISS) THEN
  13444           IF(NHYDN(L-2).GT.NHLIM) LGMM = .TRUE.
  13445         ENDIF
  13446       ENDIF
  13447 
  13448       IF(HYDN(L).NE.BMISS) THEN
  13449         IF(NHYDN(L).GT.NHLIM) LG0 = .TRUE.
  13450       ENDIF
  13451 
  13452       IF(L+1.LT.MAND) THEN
  13453         IF(HYDN(L+1).NE.BMISS) THEN
  13454           IF(NHYDN(L+1).GT.NHLIM) LGP=.TRUE.
  13455         ELSEIF(L+2.LE.MAND .AND. HYDN(L+2).NE.BMISS) THEN
  13456           IF(NHYDN(L+2).GT.NHLIM) LGP=.TRUE.
  13457         ENDIF
  13458       ENDIF
  13459 
  13460       IF(TEST) WRITE(60,500) POB(LM),L,LM,LGM,LGMM,LG0,LGP,NHYDN(L-1),
  13461      &  NHLIM
  13462   500 FORMAT(' T130--POB(LM),L,LM,LGM,LGMM,LG0,LGP,NHYDN(L-1),NHLIM: ',
  13463      &  F10.1,2I5,4L5,2I5)
  13464 
  13465 C  MAKE DECISION FOR POSSIBLE ERROR TYPE
  13466 C  -------------------------------------
  13467 
  13468       IF(.NOT.LGM .AND. .NOT.LGMM .AND. .NOT.LG0) THEN

Page 451         Source Listing                  T130
2017-04-18 11:07                                 cqcbufr.f

  13469 C                                       POSSIBLE OBSERVATION ERROR
  13470       ELSEIF((((LGM.OR.LGMM) .AND. LG0 .AND. LGP) .OR.
  13471      &  (LGM .AND. LGP)) .AND. LEVTYP(LM).LE.2) THEN
  13472         CALL ERR710(L,LM)             ! POSSIBLE TYPE 7-10 ERRORS
  13473       ELSEIF((LGM .OR. LGMM) .AND. LG0) THEN
  13474         WRITE(60,501) LGM, LG0
  13475   501   FORMAT(' T130--POSSIBLE TYPE 1,2,3 ERRORS, LGM,LG0: ',2L5)
  13476         CALL ERR123(L,LM)             ! POSSIBLE TYPE 1,2,3 ERRORS
  13477       ELSEIF(LG0 .AND. .NOT.LGP
  13478      &  .AND. LEVTYP(LM).LE.2) THEN
  13479         WRITE(60,502) LGM, LG0
  13480   502   FORMAT(' T130--POSSIBLE TYPE 3 ERROR, LGM,LGP,LEVTYP(LM): ',
  13481      &    2L5,I5)
  13482 C       CALL ERR123(L,LM)       ! POSSIBLE TYPE 3 ERROR W COMPENSATION
  13483       ELSEIF(LGM .AND. .NOT.LG0) THEN
  13484         CALL COMPER(L,LM)             ! POSSIBLE COMPUTATION ERROR
  13485       ENDIF
  13486 
  13487       RETURN
  13488       END


ENTRY POINTS

  Name             
                   
 t130_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  13462                                                          13460                             
 501                        Label  13475                                                          13474                             
 502                        Label  13480                                                          13479                             
 ALLSND                     Common 13388                                34512                                                       
 B                          Scalar 13404    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 13403    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 13386    R(8)            8           scalar   COM              13440,13443,13448,13453,13455     
 BUFRLIB_MISSING            Common 13415                                16                                                          
 CAT                        Scalar 13393    R(4)            4     1     255      COM                                                
 COMPER                     Subr   13484                                                          13484                             
 CON                        Local  13423    R(4)            4           scalar                    13423,13425,13427                 
 CQCPC                      Scalar 13412    R(4)            4           scalar   COM                                                
 ERR123                     Subr   13476                                                          13476                             
 ERR710                     Subr   13472                                                          13472                             
 GESPS                      Scalar 13394    R(4)            4     1     999      COM                                                
 H1                         Scalar 13409    R(4)            4           scalar   COM                                                
 H2                         Scalar 13409    R(4)            4           scalar   COM                                                
 HOIRES                     Scalar 13406    R(4)            4     2     84       COM                                                
 HRDR                       Scalar 13394    R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 13406    R(4)            4     1     21       COM                                                
 HYD                        Scalar 13402    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 13402    R(4)            4     1     21       COM              13440,13443,13448,13453,13455     
 HYDQ                       Scalar 13402    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 13402    R(4)            4     1     21       COM                                                

Page 452         Source Listing                  T130
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HYDSTUF                    Common 13409                                64                                                          
 IHSC                       Scalar 13403    I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 13415    I(4)            4           scalar   COM                                                
 IND                        Scalar 13393    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 13412    I(4)            4           scalar   COM                                                
 IS                         Scalar 13413    I(4)            4           scalar   COM              13422,13424,13427                 
 ISC                        Scalar 13412    I(4)            4           scalar   COM                                                
 L                          Dummy  13383    I(4)            4           scalar   ARG,INOUT        13420,13440,13441,13442,13443,1344
                                                                                                  4,13448,13449,13452,13453,13454,13
                                                                                                  455,13456,13460,13472,13476,13484 
 LAST                       Scalar 13410    I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 13393    I(4)            4     1     255      COM              13471,13478                       
 LG0                        Local  13419    L(4)            4           scalar                    13437,13449,13460,13468,13470,1347
                                                                                                  3,13474,13477,13479,13483         
 LGM                        Local  13419    L(4)            4           scalar                    13435,13441,13460,13468,13470,1347
                                                                                                  1,13473,13474,13479,13483         
 LGMM                       Local  13419    L(4)            4           scalar                    13436,13444,13460,13468,13470,1347
                                                                                                  3                                 
 LGP                        Local  13419    L(4)            4           scalar                    13438,13454,13456,13460,13470,1347
                                                                                                  1,13477                           
 LIMS                       Common 13406                                1776                                                        
 LM                         Dummy  13383    I(4)            4           scalar   ARG,INOUT        13422,13424,13427,13460,13471,1347
                                                                                                  2,13476,13478,13484               
 LMAND                      Scalar 13412    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 13412    I(4)            4           scalar   COM                                                
 LST                        Scalar 13394    I(4)            4     1     255      COM                                                
 MAND                       Scalar 13411    I(4)            4           scalar   COM              13452,13455                       
 NBAS                       Scalar 13404    I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 13408    I(4)            4           scalar   COM              13441,13444,13449,13454,13456,1346
                                                                                                  1                                 
 NHYD                       Scalar 13402    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 13404    I(4)            4     1     21       COM              13441,13444,13449,13454,13456,1346
                                                                                                  0                                 
 NLEV                       Scalar 13411    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 13411    I(4)            4           scalar   COM                                                
 NQI                        Scalar 13398    I(4)            4     1     255      COM                                                
 NQV                        Scalar 13400    I(4)            4     1     255      COM                                                
 NST                        Param  13384    I(4)            4           scalar                    13394,13403                       
 NTDI                       Scalar 13398    I(4)            4     1     255      COM                                                
 NTDV                       Scalar 13400    I(4)            4     1     255      COM                                                
 NTI                        Scalar 13398    I(4)            4     1     255      COM                                                
 NTL                        Scalar 13400    I(4)            4     1     255      COM                                                
 NTV                        Scalar 13400    I(4)            4     1     255      COM                                                
 NZI                        Scalar 13398    I(4)            4     1     255      COM                                                
 NZV                        Scalar 13400    I(4)            4     1     255      COM                                                
 PARAMS                     Common 13411                                148                                                         
 PFC                        Scalar 13388    R(4)            4     1     255      COM                                                
 PI                         Scalar 13396    R(4)            4     1     255      COM                                                
 POB                        Scalar 13388    R(4)            4     1     255      COM              13422,13424,13427,13460           
 POUT                       Scalar 13410    L(4)            4           scalar   COM              13434                             
 PQM                        Scalar 13388    R(4)            4     1     255      COM                                                
 PRC                        Scalar 13388    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 13412    L(4)            4           scalar   COM                                                
 PS                         Scalar 13394    R(4)            4     1     999      COM              13422,13424,13427                 
 PSCOR                      Scalar 13410    R(4)            4           scalar   COM                                                

Page 453         Source Listing                  T130
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PSINC                      Scalar 13403    R(4)            4           scalar   COM                                                
 QFC                        Scalar 13392    R(4)            4     1     255      COM                                                
 QI                         Scalar 13396    R(4)            4     1     255      COM                                                
 QOB                        Scalar 13392    R(4)            4     1     255      COM                                                
 QQM                        Scalar 13392    R(4)            4     1     255      COM                                                
 QRC                        Scalar 13392    R(4)            4     1     255      COM                                                
 QV                         Scalar 13397    R(4)            4     1     255      COM                                                
 RADPC                      Scalar 13411    R(4)            4           scalar   COM                                                
 RESID                      Common 13396                                41312                                                       
 STN                        Common 13413                                4                                                           
 T1                         Scalar 13409    R(4)            4           scalar   COM                                                
 T130                       Subr   13383                                                                                            
 TCBEST                     Scalar 13409    R(4)            4     1     2        COM                                                
 TCLIM                      Scalar 13408    R(4)            4           scalar   COM                                                
 TCOR                       Scalar 13409    R(4)            4     1     2        COM                                                
 TDFC                       Scalar 13391    R(4)            4     1     255      COM                                                
 TDI                        Scalar 13396    R(4)            4     1     255      COM                                                
 TDO                        Scalar 13391    R(4)            4     1     255      COM                                                
 TDV                        Scalar 13397    R(4)            4     1     255      COM                                                
 TEST                       Scalar 13414    L(4)            4           scalar   COM              13460                             
 TESTS                      Common 13414                                4                                                           
 TFACT                      Scalar 13407    R(4)            4     2     84       COM                                                
 TFC                        Scalar 13390    R(4)            4     1     255      COM                                                
 TI                         Scalar 13396    R(4)            4     1     255      COM                                                
 TL                         Scalar 13397    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 13403    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 13407    R(4)            4     2     84       COM                                                
 TOB                        Scalar 13390    R(4)            4     1     255      COM                                                
 TQM                        Scalar 13390    R(4)            4     1     255      COM                                                
 TRC                        Scalar 13390    R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 13410    R(4)            4           scalar   COM                                                
 TT                         Scalar 13412    R(4)            4           scalar   COM                                                
 TV                         Scalar 13397    R(4)            4     1     255      COM                                                
 TVO                        Scalar 13391    R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 13407    R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 13411    R(4)            4           scalar   COM                                                
 XDR                        Scalar 13395    R(4)            4     1     255      COM                                                
 XINC                       Scalar 13406    R(4)            4     2     84       COM                                                
 XMA                        Scalar 13411    R(4)            4           scalar   COM                                                
 XMI                        Scalar 13411    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 13415    R(4)            4           scalar   COM                                                
 XQI                        Scalar 13399    R(4)            4     1     255      COM                                                
 XQV                        Scalar 13401    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 13405    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 13399    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 13401    R(4)            4     1     255      COM                                                
 XTH                        Scalar 13404    R(4)            4     1     255      COM                                                
 XTI                        Scalar 13399    R(4)            4     1     255      COM                                                
 XTV                        Scalar 13401    R(4)            4     1     255      COM                                                
 XZH                        Scalar 13404    R(4)            4     1     255      COM                                                
 XZI                        Scalar 13399    R(4)            4     1     255      COM                                                
 XZV                        Scalar 13401    R(4)            4     1     255      COM                                                
 YDR                        Scalar 13395    R(4)            4     1     255      COM                                                
 YMA                        Scalar 13411    R(4)            4           scalar   COM                                                
 YMI                        Scalar 13411    R(4)            4           scalar   COM                                                

Page 454         Source Listing                  T130
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZCBEST                     Scalar 13409    R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 13408    R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 13409    R(4)            4     1     2        COM                                                
 ZD                         Scalar 13404    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 13389    R(4)            4     1     255      COM                                                
 ZI                         Scalar 13396    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 13389    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 13389    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 13389    R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 13410    R(4)            4           scalar   COM                                                
 ZV                         Scalar 13397    R(4)            4     1     255      COM                                                

Page 455         Source Listing                  T130
2017-04-18 11:07                                 cqcbufr.f

  13489 
  13490 C******************************************************************
  13491 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13492 C                .      .    .                                       .
  13493 C SUBPROGRAM:    T140        FIND ERRORS AT TYPE 140 LEVELS
  13494 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  13495 C
  13496 C ABSTRACT: Find errors at type 140 levels: mandatory, top.
  13497 C
  13498 C PROGRAM HISTORY LOG:
  13499 C 1997-03-18  W. Collins  Original author.
  13500 C
  13501 C USAGE:    CALL T140(L,LM)
  13502 C   INPUT ARGUMENT LIST:
  13503 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
  13504 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  13505 C
  13506 C   OUTPUT FILES:
  13507 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  13508 C
  13509 C REMARKS: NONE.
  13510 C
  13511 C ATTRIBUTES:
  13512 C   LANGUAGE: FORTRAN 90
  13513 C   MACHINE:  NCEP WCOSS
  13514 C
  13515 C$$$
  13516 
  13517       SUBROUTINE T140(L,LM)
  13518       PARAMETER (NST=999)
  13519 
  13520       REAL(8) BMISS
  13521 
  13522       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  13523      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  13524      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  13525      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  13526      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  13527      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  13528      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  13529      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  13530      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  13531      &                 XTDH(255)
  13532       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  13533      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  13534      &                 ZCLIM, TCLIM, NHLIM
  13535       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  13536      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  13537       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13538 
  13539       LOGICAL LGM,POUT
  13540 
  13541 C  WHICH HYDROSTATIC RESIDUALS ARE LARGE?
  13542 C  --------------------------------------
  13543 
  13544       POUT = .FALSE.
  13545       LGM = .FALSE.

Page 456         Source Listing                  T140
2017-04-18 11:07                                 cqcbufr.f

  13546       IF(L.GT.1) THEN
  13547         IF(HYDN(L-1).LT.BMISS .AND. NHYDN(L-1).GT.NHLIM) LGM = .TRUE.
  13548       ELSEIF(L.GT.2) THEN
  13549         IF(HYDN(L-2).LT.BMISS .AND. NHYDN(L-2).GT.NHLIM) LGM = .TRUE.
  13550       ENDIF
  13551 
  13552 C  MAKE DECISION FOR POSSIBLE ERROR TYPE
  13553 C  -------------------------------------
  13554 
  13555       IF(LGM) THEN
  13556         CALL ERR5(L,LM)
  13557       ENDIF
  13558 
  13559       RETURN
  13560       END


ENTRY POINTS

  Name             
                   
 t140_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B                          Scalar 13530    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 13529    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 13520    R(8)            8           scalar   COM              13547,13549                       
 BUFRLIB_MISSING            Common 13537                                16                                                          
 ERR5                       Subr   13556                                                          13556                             
 H1                         Scalar 13535    R(4)            4           scalar   COM                                                
 H2                         Scalar 13535    R(4)            4           scalar   COM                                                
 HOIRES                     Scalar 13532    R(4)            4     2     84       COM                                                
 HSCRES                     Scalar 13532    R(4)            4     1     21       COM                                                
 HYD                        Scalar 13528    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 13528    R(4)            4     1     21       COM              13547,13549                       
 HYDQ                       Scalar 13528    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 13528    R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 13535                                64                                                          
 IHSC                       Scalar 13529    I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 13537    I(4)            4           scalar   COM                                                
 L                          Dummy  13517    I(4)            4           scalar   ARG,INOUT        13546,13547,13548,13549,13556     
 LAST                       Scalar 13536    I(4)            4           scalar   COM                                                
 LGM                        Local  13539    L(4)            4           scalar                    13545,13547,13549,13555           
 LIMS                       Common 13532                                1776                                                        
 LM                         Dummy  13517    I(4)            4           scalar   ARG,INOUT        13556                             
 NBAS                       Scalar 13530    I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 13534    I(4)            4           scalar   COM              13547,13549                       
 NHYD                       Scalar 13528    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 13530    I(4)            4     1     21       COM              13547,13549                       
 NQI                        Scalar 13524    I(4)            4     1     255      COM                                                
 NQV                        Scalar 13526    I(4)            4     1     255      COM                                                
 NST                        Param  13518    I(4)            4           scalar                    13529                             
 NTDI                       Scalar 13524    I(4)            4     1     255      COM                                                

Page 457         Source Listing                  T140
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTDV                       Scalar 13526    I(4)            4     1     255      COM                                                
 NTI                        Scalar 13524    I(4)            4     1     255      COM                                                
 NTL                        Scalar 13526    I(4)            4     1     255      COM                                                
 NTV                        Scalar 13526    I(4)            4     1     255      COM                                                
 NZI                        Scalar 13524    I(4)            4     1     255      COM                                                
 NZV                        Scalar 13526    I(4)            4     1     255      COM                                                
 PI                         Scalar 13522    R(4)            4     1     255      COM                                                
 POUT                       Scalar 13536    L(4)            4           scalar   COM              13544                             
 PSCOR                      Scalar 13536    R(4)            4           scalar   COM                                                
 PSINC                      Scalar 13529    R(4)            4           scalar   COM                                                
 QI                         Scalar 13522    R(4)            4     1     255      COM                                                
 QV                         Scalar 13523    R(4)            4     1     255      COM                                                
 RESID                      Common 13522                                41312                                                       
 T1                         Scalar 13535    R(4)            4           scalar   COM                                                
 T140                       Subr   13517                                                                                            
 TCBEST                     Scalar 13535    R(4)            4     1     2        COM                                                
 TCLIM                      Scalar 13534    R(4)            4           scalar   COM                                                
 TCOR                       Scalar 13535    R(4)            4     1     2        COM                                                
 TDI                        Scalar 13522    R(4)            4     1     255      COM                                                
 TDV                        Scalar 13523    R(4)            4     1     255      COM                                                
 TFACT                      Scalar 13533    R(4)            4     2     84       COM                                                
 TI                         Scalar 13522    R(4)            4     1     255      COM                                                
 TL                         Scalar 13523    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 13529    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 13533    R(4)            4     2     84       COM                                                
 TSCOR                      Scalar 13536    R(4)            4           scalar   COM                                                
 TV                         Scalar 13523    R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 13533    R(4)            4     2     84       COM                                                
 XINC                       Scalar 13532    R(4)            4     2     84       COM                                                
 XMISS                      Scalar 13537    R(4)            4           scalar   COM                                                
 XQI                        Scalar 13525    R(4)            4     1     255      COM                                                
 XQV                        Scalar 13527    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 13531    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 13525    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 13527    R(4)            4     1     255      COM                                                
 XTH                        Scalar 13530    R(4)            4     1     255      COM                                                
 XTI                        Scalar 13525    R(4)            4     1     255      COM                                                
 XTV                        Scalar 13527    R(4)            4     1     255      COM                                                
 XZH                        Scalar 13530    R(4)            4     1     255      COM                                                
 XZI                        Scalar 13525    R(4)            4     1     255      COM                                                
 XZV                        Scalar 13527    R(4)            4     1     255      COM                                                
 ZCBEST                     Scalar 13535    R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 13534    R(4)            4           scalar   COM                                                
 ZCOR                       Scalar 13535    R(4)            4     1     2        COM                                                
 ZD                         Scalar 13530    R(4)            4     1     255      COM                                                
 ZI                         Scalar 13522    R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 13536    R(4)            4           scalar   COM                                                
 ZV                         Scalar 13523    R(4)            4     1     255      COM                                                

Page 458         Source Listing                  T140
2017-04-18 11:07                                 cqcbufr.f

  13561 
  13562 C******************************************************************
  13563 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13564 C                .      .    .                                       .
  13565 C SUBPROGRAM:    T220        DETERMINE ERRORS FOR SIGNIFICANT LEVELS
  13566 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
  13567 C
  13568 C ABSTRACT: Determine for significant levels: middle or top.  Only
  13569 C   suspect communication errors if the hydrostatic residual is large
  13570 C   enough.
  13571 C
  13572 C PROGRAM HISTORY LOG:
  13573 C 1997-03-18  W. Collins  Original author.
  13574 C 2008-10-08  Woollen/Keyser -- corrected if tests where integer values
  13575 C     were tested for not being equal to real value for missing (BMISS
  13576 C     = 10E10), these integer values can never be equal to BMISS for
  13577 C     I*4 due to overflow - instead they are now tested for not being
  13578 C     equal to new integer value for missing (IMISS, also = 10E10),
  13579 C     although this is also an overflow value for I*4, it results in a
  13580 C     correct evaluation
  13581 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
  13582 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
  13583 C     overflow (also done for IMISS). 
  13584 C
  13585 C USAGE:    CALL T220(L,LM)
  13586 C   INPUT ARGUMENT LIST:
  13587 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
  13588 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  13589 C
  13590 C   OUTPUT FILES:
  13591 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  13592 C
  13593 C REMARKS: NONE.
  13594 C
  13595 C ATTRIBUTES:
  13596 C   LANGUAGE: FORTRAN 90
  13597 C   MACHINE:  NCEP WCOSS
  13598 C
  13599 C$$$
  13600 
  13601       SUBROUTINE T220(L,LM)
  13602       PARAMETER (NST=999)
  13603 
  13604       REAL(8) BMISS
  13605 
  13606       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  13607      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  13608      &                 NEV, ISF(NST), NLVM, NLVW
  13609       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  13610      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  13611      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  13612      &                 TDO(255), TDFC(255),TVO(255),
  13613      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  13614      &                 CAT(255), IND(255), LEVTYP(255),
  13615      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  13616      &                 YDR(255), XDR(255)
  13617       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),

Page 459         Source Listing                  T220
2017-04-18 11:07                                 cqcbufr.f

  13618      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  13619      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  13620      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  13621      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  13622      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  13623      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  13624      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  13625      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  13626      &                 XTDH(255)
  13627       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  13628      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  13629      &                 ZCLIM, TCLIM, NHLIM
  13630       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  13631      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  13632       COMMON /LEVEL/   PMAND(21)
  13633       COMMON /STN/     IS
  13634       COMMON /TESTS/   TEST
  13635       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13636 
  13637       LOGICAL          TEST, PRNT
  13638 
  13639       CHARACTER*8 SID
  13640 
  13641 C  DMA FOR MIDDLE OR TOP SIG LVL
  13642 C  ANY ERROR MUST BE ASSUMED TO BE OBSERVATION ERROR IF THE
  13643 C  HYDROSTATIC RESIDUAL IS MISSING.
  13644 C  --------------------------------------------------------
  13645 
  13646       LBELOW = LMANLV(POB(LM))
  13647       IF(LBELOW.GT.1) THEN
  13648         IF(HYD(LBELOW).EQ.BMISS) LBELOW = LBELOW - 1
  13649       ENDIF
  13650 
  13651                             ! LBELOW will never test = bmiss, use imiss
  13652 cdak  IF(TEST .AND. LBELOW.GT.1 .AND. LBELOW.NE.BMISS)
  13653       IF(TEST .AND. LBELOW.GT.1 .AND. LBELOW.NE.IMISS)
  13654      &  WRITE(60,501) POB(LM), L, LM, LBELOW, HYDS(LBELOW)
  13655   501 FORMAT(' T220--POB,L,LM,LBELOW,HYDS(LBELOW):  ',F10.1,
  13656      &  3I5,2X,F10.1)
  13657 
  13658                             ! LBELOW will never test = bmiss, use imiss
  13659 cdak  IF(LBELOW.GT.0 .AND. LBELOW.NE.BMISS) THEN
  13660       IF(LBELOW.GT.0 .AND. LBELOW.NE.IMISS) THEN
  13661         IF(HYDS(LBELOW).NE.BMISS) THEN
  13662           IF(LMAND(LBELOW).GT.0 .AND. LMAND(LBELOW).LE.255) THEN
  13663             P1  = POB(LMAND(LBELOW))
  13664             AP1 = ALP(P1)
  13665           ELSE
  13666             AP1 = BMISS
  13667           ENDIF
  13668           PN  = POB(LM)
  13669           APN = ALP(PN)
  13670           IF(LM+1.LE.NLVM) THEN
  13671             PLP  = POB(LM+1)
  13672             APLP = ALP(PLP)
  13673           ELSE
  13674             PLP  = BMISS

Page 460         Source Listing                  T220
2017-04-18 11:07                                 cqcbufr.f

  13675             APLP = BMISS
  13676           ENDIF
  13677           IF(LM-1.GE.1) THEN
  13678             PLM  = POB(LM-1)
  13679             APLM = ALP(PLM)
  13680           ELSE
  13681             PLM  = BMISS
  13682             APLM = BMISS
  13683           ENDIF
  13684 
  13685           IF(TEST) WRITE(60,502) LMAND(LBELOW),P1,PN,PLP,PLM
  13686   502     FORMAT(' T220--LMAND(LBELOW),P1,PN,PLP,PLM: ',
  13687      &      I5,5F10.1)
  13688 
  13689           IF(AP1.NE.BMISS .AND. APN.NE.BMISS .AND.
  13690      &       APLM.NE.BMISS .AND. APLP.NE.BMISS .AND.
  13691      &       AP1.NE.APN) THEN
  13692             RATIO = (APLP-APLM)/(APN-AP1)
  13693           ELSE
  13694             RATIO = 1.0
  13695           ENDIF
  13696           HYDLG = ABS(HYD(LBELOW)) * RATIO
  13697 
  13698 C  TEST FOR LARGE HYDROSTATIC RESIDUAL AT SIG LVL
  13699 C  ----------------------------------------------
  13700 
  13701           IF(HYDLG.GT.0.20*HSCRES(NMANLV(POB(LM)))) THEN
  13702             CALL SIGERR(LM)
  13703           ELSE
  13704             IF(TEST) WRITE(60,500) HYDLG,SID(IS),POB(LM)
  13705   500       FORMAT(' T220--HYDLG = ',F10.1,' NOT LARGE; NO CORR',
  13706      &        ' ATTEMPTED FOR: ',A8,' AT ',F10.1,' MB')
  13707           ENDIF
  13708         ENDIF
  13709       ENDIF
  13710 
  13711       RETURN
  13712       END

Page 461         Source Listing                  T220
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 t220_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  13705                                                          13704                             
 501                        Label  13655                                                          13654                             
 502                        Label  13686                                                          13685                             
 ABS                        Func   13696                                scalar                    13696                             
 ALLSND                     Common 13609                                34512                                                       
 ALP                        Func   13664    R(4)            4           scalar                    13664,13669,13672,13679           
 AP1                        Local  13664    R(4)            4           scalar                    13664,13666,13689,13691,13692     
 APLM                       Local  13679    R(4)            4           scalar                    13679,13682,13690,13692           
 APLP                       Local  13672    R(4)            4           scalar                    13672,13675,13690,13692           
 APN                        Local  13669    R(4)            4           scalar                    13669,13689,13691,13692           
 B                          Scalar 13625    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 13624    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 13604    R(8)            8           scalar   COM              13648,13661,13666,13674,13675,1368
                                                                                                  1,13682,13689,13690               
 BUFRLIB_MISSING            Common 13635                                16                                                          
 CAT                        Scalar 13614    R(4)            4     1     255      COM                                                
 CQCPC                      Scalar 13631    R(4)            4           scalar   COM                                                
 DHR                        Scalar 13606    R(4)            4     1     999      COM                                                
 ELV                        Scalar 13607    R(4)            4     1     999      COM                                                
 GESPS                      Scalar 13615    R(4)            4     1     999      COM                                                
 HEADER                     Common 13606                                35980                                                       
 HOIRES                     Scalar 13627    R(4)            4     2     84       COM                                                
 HRDR                       Scalar 13615    R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 13627    R(4)            4     1     21       COM              13701                             
 HYD                        Scalar 13623    R(4)            4     1     21       COM              13648,13696                       
 HYDLG                      Local  13696    R(4)            4           scalar                    13696,13701,13704                 
 HYDN                       Scalar 13623    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 13623    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 13623    R(4)            4     1     21       COM              13654,13661                       
 IHSC                       Scalar 13624    I(4)            4     2     1020     COM                                                
 IMISS                      Scalar 13635    I(4)            4           scalar   COM              13653,13660                       
 IND                        Scalar 13614    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 13631    I(4)            4           scalar   COM                                                
 IS                         Scalar 13633    I(4)            4           scalar   COM              13704                             
 ISC                        Scalar 13631    I(4)            4           scalar   COM                                                
 ISF                        Scalar 13608    I(4)            4     1     999      COM                                                
 ITP                        Scalar 13607    I(4)            4     1     999      COM                                                
 L                          Dummy  13601    I(4)            4           scalar   ARG,INOUT        13654                             
 LBELOW                     Local  13646    I(4)            4           scalar                    13646,13647,13648,13653,13654,1366
                                                                                                  0,13661,13662,13663,13685,13696   
 LEVEL                      Common 13632                                84                                                          
 LEVTYP                     Scalar 13614    I(4)            4     1     255      COM                                                
 LIMS                       Common 13627                                1776                                                        
 LM                         Dummy  13601    I(4)            4           scalar   ARG,INOUT        13646,13654,13668,13670,13671,1367

Page 462         Source Listing                  T220
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  7,13678,13701,13702,13704         
 LMAND                      Scalar 13631    I(4)            4     1     22       COM              13662,13663,13685                 
 LMANLV                     Func   13646    I(4)            4           scalar                    13646                             
 LSFC                       Scalar 13631    I(4)            4           scalar   COM                                                
 LST                        Scalar 13615    I(4)            4     1     255      COM                                                
 MAND                       Scalar 13630    I(4)            4           scalar   COM                                                
 NBAS                       Scalar 13625    I(4)            4           scalar   COM                                                
 NEV                        Scalar 13608    I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 13629    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 13623    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 13625    I(4)            4     1     21       COM                                                
 NLEV                       Scalar 13630    I(4)            4           scalar   COM                                                
 NLV                        Scalar 13607    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 13608    I(4)            4           scalar   COM              13670                             
 NLVW                       Scalar 13608    I(4)            4           scalar   COM                                                
 NMANLV                     Func   13701    I(4)            4           scalar                    13701                             
 NOBS                       Scalar 13630    I(4)            4           scalar   COM                                                
 NQI                        Scalar 13619    I(4)            4     1     255      COM                                                
 NQV                        Scalar 13621    I(4)            4     1     255      COM                                                
 NST                        Param  13602    I(4)            4           scalar                    13606,13607,13608,13615,13624     
 NTDI                       Scalar 13619    I(4)            4     1     255      COM                                                
 NTDV                       Scalar 13621    I(4)            4     1     255      COM                                                
 NTI                        Scalar 13619    I(4)            4     1     255      COM                                                
 NTL                        Scalar 13621    I(4)            4     1     255      COM                                                
 NTV                        Scalar 13621    I(4)            4     1     255      COM                                                
 NZI                        Scalar 13619    I(4)            4     1     255      COM                                                
 NZV                        Scalar 13621    I(4)            4     1     255      COM                                                
 P1                         Local  13663    R(4)            4           scalar                    13663,13664,13685                 
 PARAMS                     Common 13630                                148                                                         
 PFC                        Scalar 13609    R(4)            4     1     255      COM                                                
 PI                         Scalar 13617    R(4)            4     1     255      COM                                                
 PLM                        Local  13678    R(4)            4           scalar                    13678,13679,13681,13685           
 PLP                        Local  13671    R(4)            4           scalar                    13671,13672,13674,13685           
 PMAND                      Scalar 13632    R(4)            4     1     21       COM                                                
 PN                         Local  13668    R(4)            4           scalar                    13668,13669,13685                 
 POB                        Scalar 13609    R(4)            4     1     255      COM              13646,13654,13663,13668,13671,1367
                                                                                                  8,13701,13704                     
 PQM                        Scalar 13609    R(4)            4     1     255      COM                                                
 PRC                        Scalar 13609    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 13631    L(4)            4           scalar   COM                                                
 PS                         Scalar 13615    R(4)            4     1     999      COM                                                
 PSINC                      Scalar 13624    R(4)            4           scalar   COM                                                
 QFC                        Scalar 13613    R(4)            4     1     255      COM                                                
 QI                         Scalar 13617    R(4)            4     1     255      COM                                                
 QOB                        Scalar 13613    R(4)            4     1     255      COM                                                
 QQM                        Scalar 13613    R(4)            4     1     255      COM                                                
 QRC                        Scalar 13613    R(4)            4     1     255      COM                                                
 QV                         Scalar 13618    R(4)            4     1     255      COM                                                
 RADPC                      Scalar 13630    R(4)            4           scalar   COM                                                
 RATIO                      Local  13692    R(4)            4           scalar                    13692,13694,13696                 
 RESID                      Common 13617                                41312                                                       
 SID                        Scalar 13606    CHAR            8     1     999      COM              13704                             
 SIGERR                     Subr   13702                                                          13702                             
 SQN                        Scalar 13607    R(4)            4     1     999      COM                                                
 STN                        Common 13633                                4                                                           

Page 463         Source Listing                  T220
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 T220                       Subr   13601                                                                                            
 TCLIM                      Scalar 13629    R(4)            4           scalar   COM                                                
 TDFC                       Scalar 13612    R(4)            4     1     255      COM                                                
 TDI                        Scalar 13617    R(4)            4     1     255      COM                                                
 TDO                        Scalar 13612    R(4)            4     1     255      COM                                                
 TDV                        Scalar 13618    R(4)            4     1     255      COM                                                
 TEST                       Scalar 13634    L(4)            4           scalar   COM              13653,13685,13704                 
 TESTS                      Common 13634                                4                                                           
 TFACT                      Scalar 13628    R(4)            4     2     84       COM                                                
 TFC                        Scalar 13611    R(4)            4     1     255      COM                                                
 TI                         Scalar 13617    R(4)            4     1     255      COM                                                
 TL                         Scalar 13618    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 13624    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 13628    R(4)            4     2     84       COM                                                
 TOB                        Scalar 13611    R(4)            4     1     255      COM                                                
 TQM                        Scalar 13611    R(4)            4     1     255      COM                                                
 TRC                        Scalar 13611    R(4)            4     1     255      COM                                                
 TT                         Scalar 13631    R(4)            4           scalar   COM                                                
 TV                         Scalar 13618    R(4)            4     1     255      COM                                                
 TVO                        Scalar 13612    R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 13628    R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 13630    R(4)            4           scalar   COM                                                
 XDR                        Scalar 13616    R(4)            4     1     255      COM                                                
 XINC                       Scalar 13627    R(4)            4     2     84       COM                                                
 XMA                        Scalar 13630    R(4)            4           scalar   COM                                                
 XMI                        Scalar 13630    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 13635    R(4)            4           scalar   COM                                                
 XOB                        Scalar 13606    R(4)            4     1     999      COM                                                
 XQI                        Scalar 13620    R(4)            4     1     255      COM                                                
 XQV                        Scalar 13622    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 13626    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 13620    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 13622    R(4)            4     1     255      COM                                                
 XTH                        Scalar 13625    R(4)            4     1     255      COM                                                
 XTI                        Scalar 13620    R(4)            4     1     255      COM                                                
 XTV                        Scalar 13622    R(4)            4     1     255      COM                                                
 XZH                        Scalar 13625    R(4)            4     1     255      COM                                                
 XZI                        Scalar 13620    R(4)            4     1     255      COM                                                
 XZV                        Scalar 13622    R(4)            4     1     255      COM                                                
 YDR                        Scalar 13616    R(4)            4     1     255      COM                                                
 YMA                        Scalar 13630    R(4)            4           scalar   COM                                                
 YMI                        Scalar 13630    R(4)            4           scalar   COM                                                
 YOB                        Scalar 13606    R(4)            4     1     999      COM                                                
 ZCLIM                      Scalar 13629    R(4)            4           scalar   COM                                                
 ZD                         Scalar 13625    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 13610    R(4)            4     1     255      COM                                                
 ZI                         Scalar 13617    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 13610    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 13610    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 13610    R(4)            4     1     255      COM                                                
 ZV                         Scalar 13618    R(4)            4     1     255      COM                                                

Page 464         Source Listing                  T220
2017-04-18 11:07                                 cqcbufr.f

  13713 
  13714 C******************************************************************
  13715 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13716 C                .      .    .                                       .
  13717 C SUBPROGRAM:    T240        DETERMINE ERRORS AT THE SURFACE
  13718 C   PRGMMR: KEYSER         ORG: NP22       DATE: 2013-02-05
  13719 C
  13720 C ABSTRACT: Determine errors at the surface:
  13721 C           Type 100 - surface pressure communication error
  13722 C           Type 106 - surface pressure observation error
  13723 C           Type 102 - surface temperature communication error
  13724 C           Type 105 - surface error of undetermined type
  13725 C
  13726 C PROGRAM HISTORY LOG:
  13727 C 1997-03-18  W. Collins  Original author.
  13728 C 2008-10-08  Woollen/Keyser -- modified to correct indexing error
  13729 C     which can lead, on rare occasions, to out-of-bounds arrays and
  13730 C     to the incorrect indexing of some variables; corrected if tests
  13731 C     where integer values were tested for not being equal to real
  13732 C     value for missing (BMISS = 10E10), these integer values can
  13733 C     never be equal to BMISS for I*4 due to overflow - instead they
  13734 C     are now tested for not being equal to new integer value for
  13735 C     missing (IMISS, also = 10E10), although this is also an overflow
  13736 C     value for I*4, it results in a correct evaluation
  13737 C 2013-02-05  D. Keyser -- Final changes to run on WCOSS: Set BUFRLIB
  13738 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
  13739 C     overflow (also done for IMISS). 
  13740 C
  13741 C USAGE:    CALL T240(L,LM)
  13742 C   INPUT ARGUMENT LIST:
  13743 C     L        - LEVEL INDEX WITHIN MANDATORY LEVELS
  13744 C     LM       - LEVEL INDEX WITHIN ALL REPORTED LEVELS
  13745 C
  13746 C   OUTPUT FILES:
  13747 C     UNIT 06  - PRINTOUT
  13748 C     UNIT 22  - LIST OF POTENTIAL WIND PROBLEMS
  13749 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  13750 C
  13751 C REMARKS: NONE.
  13752 C
  13753 C ATTRIBUTES:
  13754 C   LANGUAGE: FORTRAN 90
  13755 C   MACHINE:  NCEP WCOSS
  13756 C
  13757 C$$$
  13758 
  13759       SUBROUTINE T240(L,LM)
  13760       PARAMETER (NST=999)
  13761 
  13762       REAL(8) BMISS
  13763 
  13764       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  13765      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  13766      &                 NEV, ISF(NST), NLVM, NLVW
  13767       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  13768      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  13769      &                 TOB(255), TFC(255), TQM(255), TRC(255),

Page 465         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  13770      &                 TDO(255), TDFC(255),TVO(255),
  13771      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  13772      &                 CAT(255), IND(255), LEVTYP(255),
  13773      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  13774      &                 YDR(255), XDR(255)
  13775       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  13776      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  13777      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  13778      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  13779      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  13780      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  13781      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  13782      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  13783      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  13784      &                 XTDH(255)
  13785       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  13786      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  13787      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
  13788      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  13789      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
  13790      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  13791      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  13792      &                 XTHM(21,NST),XTDVM(21,NST),
  13793      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  13794      &                 XQHM(21,NST),
  13795      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  13796      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  13797       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  13798      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  13799      &                 ZCLIM, TCLIM, NHLIM
  13800       COMMON /LEVEL/   PMAND(21)
  13801       COMMON /CONSTS/  R, G, T0, CP, RV
  13802       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  13803      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  13804       COMMON /ALLOW/   ALLZ(41), ALLT(71), NALLZ, NALLT
  13805       COMMON /STN/     IS
  13806       COMMON /HYDSTUF/ ZCOR(2),TCOR(2),H1,H2,T1,ZCBEST(2),TCBEST(2),
  13807      &                 POUT,LAST,PSCOR,TSCOR,ZSCOR
  13808       COMMON /TESTS/   TEST
  13809       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  13810 
  13811       LOGICAL          TEST, PRNT, FIRST
  13812       CHARACTER*8 SID
  13813       LOGICAL POUT, GOOD(6,2,2), L100, L106, L102, L105
  13814       LOGICAL ZG, TG, TDG, QG, ERROR
  13815       DATA PSLIM /3./
  13816 
  13817       IF(TEST) WRITE(60,500) SID(IS),PSINC,PIS(IS),BASRES(IS)
  13818   500 FORMAT(' T240--FOR STATION: ',A8,'  PSINC: ',F10.1,
  13819      &       '  PIS: ',F10.1,' BASRES: ',F10.1)
  13820 
  13821       LS = NMANLV(POB(LM))
  13822       LSP = LMAND(MIN(LS+1,MAND))
  13823       LSS = LMAND(LS)
  13824 
  13825       RO2G  = 0.5*R/G
  13826 C     C1    = .434294

Page 466         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  13827       C1    = .5
  13828       IF(POB(LM).NE.0. .AND. POB(LM).NE.BMISS) THEN
  13829         DZDP  = R*(TOB(LM)+T0)/(G*POB(LM))
  13830       ELSE
  13831         DZDP = 8.
  13832       ENDIF
  13833 C     write(6,600) dzdp
  13834   600 format(' T240--dzdp: ',f10.2)
  13835       PSCOR = 0.
  13836       TSCOR = 0.
  13837       ZSCOR = 0.
  13838       PPSCOR = 0.
  13839       PZSCOR = 0.
  13840       PTSCOR = 0.
  13841       IHSC(1,LM) = 0
  13842       IHSC(2,LM) = 0
  13843       IHSC(3,LM) = 0
  13844       IHSC(4,LM) = 0
  13845 
  13846 C  TYPE 240: SURFACE
  13847 C  -----------------
  13848 
  13849 C  CALCULATE QUANTITIES TO ALLOW DETERMINATION OF MOST LIKELY ERROR
  13850 C  ----------------------------------------------------------------
  13851 
  13852       R0 = BMISS
  13853       R1 = BMISS
  13854       R2 = BMISS
  13855       R3 = BMISS
  13856       R4 = BMISS
  13857       R5 = BMISS
  13858       SX = BMISS
  13859       X0 = 0.5
  13860       X1 = 1.0
  13861       X2 = 1.0
  13862       X3 = 0.65
  13863       X4 = 0.25
  13864       X5 = 1.0
  13865       L100 = .FALSE.
  13866       L106 = .FALSE.
  13867       L102 = .FALSE.
  13868       L105 = .FALSE.
  13869 
  13870       R0 = ABS(BASRES(IS)/DZDP)/PSLIM
  13871       IF(PSINC.NE.BMISS .AND. ABS(PSINC).GT.PSLIM .AND.
  13872      &   PIS(IS).NE.BMISS .AND. ABS(PIS(IS)).GT.PSLIM) THEN
  13873         R1 = ABS(PSINC-PIS(IS))/(PSLIM*C1*ALP(ABS(PSINC)))
  13874 C       write(6,601) r1
  13875   601   format(' T240--r1: ',f10.2)
  13876       ENDIF
  13877 
  13878       IF(PIS(IS).NE.BMISS .AND. ABS(PIS(IS)).GT.PSLIM) THEN
  13879 
  13880         IF(LSS.NE.IMISS) THEN
  13881            R2 = ABS(PIS(IS)-ZI(LSS)/DZDP)/PSLIM
  13882 C          write(6,602) r2
  13883   602      format(' T240--r2: ',f10.2)

Page 467         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  13884                                ! LSP will never test = bmiss, use imiss
  13885 cdak       IF(LSP.NE.BMISS) THEN
  13886            IF(LSP.NE.IMISS) THEN
  13887               R5 = ABS((ZI(LSP)-ZI(LSS))/DZDP)/PSLIM
  13888 C             write(6,603) r5
  13889   603         format(' T240--r5: ',f10.2)
  13890            ENDIF
  13891         ENDIF
  13892 
  13893         NSUM = 0
  13894         SUM  = 0.
  13895         SUMS = 0.
  13896         DO I=1,NLEV
  13897           IF(MANLEV(POB(I)).NE.0 .AND. ZI(I).NE.BMISS) THEN
  13898             NSUM = NSUM + 1
  13899             SUM  = SUM + ZI(I)
  13900             SUMS = SUMS + ZI(I)**2
  13901           ENDIF
  13902         ENDDO
  13903         XSUM = NSUM
  13904         IF(XSUM.NE.0.) THEN
  13905           SX = (SUMS - (SUM**2)/XSUM)/XSUM
  13906         ELSE
  13907           SX = 0.
  13908         ENDIF
  13909         IF(SX.GT.0.) THEN
  13910           SX = SQRT(SX)
  13911         ELSE
  13912           SX = 0.
  13913         ENDIF
  13914         R3 = (SX/DZDP)/PSLIM
  13915 C       write(6,604) r3
  13916   604   format(' T240--r3: ',f10.2)
  13917       ENDIF
  13918 
  13919       IF(BASRES(IS).NE.BMISS .AND. ABS(BASRES(IS)).GT.20.) THEN
  13920         DO I=LM+1,NLEV
  13921           IF(LEVTYP(I).NE.3) GOTO 10
  13922         ENDDO
  13923         GOTO 20
  13924    10   CONTINUE
  13925         IF(ABS(POB(I)-POB(LM)).GT.0.05) THEN
  13926           TSCOR = -BASRES(IS)/(RO2G*(ALP(POB(I))-ALP(POB(LM))))
  13927         ELSE
  13928           TSCOR = 0.
  13929         ENDIF
  13930 C       write(6,606) tscor
  13931   606   format(' T240--tscor: ',f10.1)
  13932         CALL ROUND(TSCOR,POB(LM),3)
  13933         CALL BEST(TCBEST(1),XMISS,XMISS,TI(LM),
  13934      &    XINC(LS,2),TV(LM),VOIRES(LS,2),XMISS,XMISS,XMISS,XMISS)
  13935         R4 = ABS(TSCOR-TCBEST(1))/XINC(LS,2)
  13936 C       write(6,605) r4
  13937   605   format(' T240--r4: ',f10.2)
  13938    20   CONTINUE
  13939       ENDIF
  13940 

Page 468         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  13941       R100 = BMISS
  13942       R106 = BMISS
  13943       R102 = BMISS
  13944 
  13945       IF(R1.NE.BMISS) R100 = R1/X1
  13946 
  13947 C     IF(R0.NE.BMISS .AND. R2.NE.BMISS .AND. R3.NE.BMISS .AND.
  13948 C    &   R5.NE.BMISS) THEN
  13949 C       R106 = AMAX1(R0/X0,R2/X2,R3/X3,R5/X5)
  13950 C     ELSEIF(R2.NE.BMISS .AND. R3.NE.BMISS .AND. R5.NE.BMISS) THEN
  13951 C       R106 = AMAX1(R2/X2,R5/X5,R3/X3)
  13952 C     ELSEIF(R2.NE.BMISS .AND. R3.NE.BMISS) THEN
  13953 C       R106 = AMAX1(R2/X2,R3/X3)
  13954 C     ENDIF
  13955 
  13956       IF(R0.NE.BMISS .AND. R2.NE.BMISS .AND. R5.NE.BMISS) THEN
  13957         R106 = AMAX1(R0/X0,R2/X2,R5/X5)
  13958       ELSEIF(R2.NE.BMISS .AND. R5.NE.BMISS) THEN
  13959         R106 = AMAX1(R2/X2,R5/X5)
  13960       ENDIF
  13961 
  13962       IF(R4.NE.BMISS) R102 = R4/X4
  13963 
  13964 C  THE MOST LIKELY ERROR IS ASSOCIATED WITH THE SMALLEST Rxxx
  13965 C  ----------------------------------------------------------
  13966 
  13967       IF(R100.LT.1.0 .AND. R100.LE.R106 .AND.
  13968      &   R100.LE.R102)                           L100 = .TRUE.
  13969       IF(R106.LT.1.0 .AND. R106.LE.R100 .AND.
  13970      &   R106.LE.R102)                           L106 = .TRUE.
  13971       IF(R102.LT.1.0 .AND. R102.LT.R100 .AND.
  13972      &   R102.LE.R106)                           L102 = .TRUE.
  13973       IF(.NOT.L100 .AND. .NOT.L106 .AND. .NOT.L102 .AND.
  13974      &   (((BASRES(IS).NE.BMISS .AND. ABS(BASRES(IS)).GT.20.) .OR.
  13975      &       (PSINC.NE.BMISS .AND. ABS(PSINC).GT.PSLIM) .OR.
  13976      &       (PIS(IS).NE.BMISS .AND. ABS(PIS(IS)).GT.2.*PSLIM)))
  13977      &                     )                     L105 = .TRUE.
  13978 C    &       .AND. ISC.GT.1)                     L105 = .TRUE.
  13979 
  13980       IF(TEST) WRITE(60,506) ISC,R100,R106,R102,L100,L106,L102,L105
  13981   506 FORMAT(' T240--ISC,R100,R106,R102,L100,L106,L102,L105: ',
  13982      &  I5,2X,3F16.3,4L3)
  13983 
  13984 C  WRITE DIAGNOSTIC STUFF TO UNIT 22
  13985 C  ---------------------------------
  13986 
  13987       FIRST = .TRUE.
  13988       DO I=1,NLEV
  13989         M = MANLEV(POB(I))
  13990         IF(M.NE.0) THEN
  13991           IF(FIRST .AND. HYD(M).NE.BMISS) THEN
  13992             HYD1 = HYD(M)
  13993             FIRST = .FALSE.
  13994           ENDIF
  13995         ENDIF
  13996       ENDDO
  13997       IF(R1.NE.BMISS .OR. R2.NE.BMISS .OR. R3.NE.BMISS .OR.

Page 469         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  13998      &   R4.NE.BMISS .OR. R5.NE.BMISS) THEN
  13999          IF(LSS.NE.IMISS .AND .LSP.NE.IMISS) THEN
  14000       WRITE(22,507) SID(IS),XOB(IS),YOB(IS),ELV(IS),PS(IS),LSS,POB(LSS),
  14001      &  LSP,POB(LSP)
  14002   507 FORMAT('--------------------------------------------------------',
  14003      &       '--------------------------------------------------------',
  14004      &       '------------------------------------------------------',/,
  14005      &       'SID, XOB, YOB, ELV, PS, LSS, P(LSS), LSP, P(LSP)        ',
  14006      &  A10,2F10.2,F10.0,F10.1,I10,F10.1,I10,F10.1)
  14007       WRITE(22,508) PIS(IS),PSINC,BASRES(IS),HYD1,ZI(LSS),ZI(LSP),
  14008      &  ZI(LSP)-ZI(LSS),SX
  14009   508 FORMAT('PIS,PSINC,BASRES,HYD1,ZI(LSS),ZI(LSP),ZI(LSP)-ZI(LSS),SX',
  14010      &  2F10.1,5F10.0,F10.1)
  14011       WRITE(22,509) PSINC-PIS(IS),PIS(IS)-ZI(LSS)/DZDP,DZDP,TSCOR,
  14012      &  TCBEST(1),TSCOR-TCBEST(1)
  14013   509 FORMAT('PSINC-PIS,PIS-ZI(LSS)/DZDP,DZDP,TSCOR,TCBEST,',
  14014      & 'TSCOR-TCBEST',2F10.1,F10.2,3F10.1)
  14015       WRITE(22,510) R0,R1,R2,R3,R4,R5,R100,R102,R106,L100,L102,L105,L106
  14016   510 FORMAT('R0,R1,R2,R3,R4,R5,R100,R102,R106,L100,L102,L105,L106    ',
  14017      &  9F10.2,4L5)
  14018       ENDIF
  14019       ENDIF
  14020 
  14021 C  IM NOT READY TO LET TYPE 106 CORRECTIONS BE PERFORMED
  14022 C  -----------------------------------------------------
  14023 
  14024       IF(L106) THEN
  14025         L106 = .FALSE.
  14026         L105 = .TRUE.
  14027       ENDIF
  14028 
  14029       IF(L100) GOTO 100
  14030       IF(L106) GOTO 200
  14031       IF(L102) GOTO 300
  14032       IF(L105) GOTO 400
  14033 C598  IF(PSINC.NE.BMISS .AND. ABS(PSINC).GT.2.*PSLIM) GOTO 400
  14034       RETURN
  14035 
  14036 C  CHECK FOR PS-COMM ERROR (TYPE 100)
  14037 C  ----------------------------------
  14038 
  14039   100 CONTINUE
  14040 
  14041       POUT = .TRUE.
  14042       IF(TEST) WRITE(60,501) R1
  14043   501 FORMAT(' T240--POSSIBLE PS-COMM ERROR, R1: ',F10.2)
  14044       LMAND1 = LMAND(1)
  14045       PSCOR = -PSINC
  14046       CALL SIMPLE(PSCOR,POB(LM),ALLZ,NALLZ,10.)
  14047       CALL ROUND(PSCOR,POB(LM),1)
  14048       ZSCOR = -PSCOR*DZDP
  14049       PPSCOR = PSCOR
  14050       PZSCOR = ZSCOR
  14051       IV = 1
  14052       QM = 1.
  14053       IHSC(1,LM) = 100
  14054       CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),

Page 470         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  14055      &  1,PSCOR,POB(LM)+PSCOR,PPSCOR,QM,IHSC(1,LM),BASRES(IS),PIS(IS),
  14056      &  PSINC)
  14057       RETURN
  14058 
  14059 C  CHECK FOR PS-OBS ERROR
  14060 C  ----------------------
  14061 
  14062   200 CONTINUE
  14063 
  14064       IF(TEST) WRITE(60,502)
  14065   502 FORMAT(' T240--POSSIBLE PS-OBS ERROR')
  14066       POUT = .TRUE.
  14067       IF(TEST) WRITE(60,503) sx,r2,r3,r5,dzdp
  14068   503 FORMAT(' T240--std of ZI,R2,R3,R5,DZDP: ',5f10.2)
  14069       PSCOR = -PIS(IS)
  14070       CALL SIMPLE(PSCOR,POB(LM),ALLZ,NALLZ,10.)
  14071       CALL ROUND(PSCOR,POB(LM),1)
  14072       ZCR = PSCOR*DZDP
  14073       IF(ABS(ZCR).LT.ZCLIM) RETURN
  14074       CALL ROUND(ZCR,500.,2)
  14075       ZSCOR =  ZCR
  14076       PPSCOR = PSCOR
  14077       PZSCOR = ZSCOR
  14078       QM = 1.
  14079       IHSC(1,LM) = 106
  14080       CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),1,
  14081      &  PSCOR,POB(LM)+PSCOR,PPSCOR,QM,IHSC(1,LM),BASRES(IS),
  14082      &  PIS(IS),PSINC)
  14083       QM = 1.
  14084       IHSC(2,LSFC) = 106
  14085       CALL SEVENT(SID(IS),SQN(IS),LSFC,LST(LSFC),POB(LM)+PSCOR,
  14086      &  LEVTYP(LSFC),2,0.,ELV(IS),0.,QM,IHSC(2,LSFC),
  14087      &  BASRES(IS),PIS(IS),PSINC)
  14088       DO I=1,NLEV
  14089       IHSC(2,I) = 106
  14090         IF(MANLEV(POB(I)).NE.0 .AND. ZOB(I).NE.BMISS) THEN
  14091           CALL SEVENT(SID(IS),SQN(IS),I,LST(I),POB(I),LEVTYP(I),2,
  14092      &      ZCR,ZOB(I)+ZCR,PZSCOR,QM,IHSC(2,I),BASRES(IS),
  14093      &      PIS(IS),PSINC)
  14094         ENDIF
  14095       ENDDO
  14096       RETURN
  14097 
  14098 C  CHECK FOR TS ERROR
  14099 C  ------------------
  14100 
  14101   300 CONTINUE
  14102 
  14103       TC1 = 0.5*(TSCOR+TCBEST(1))
  14104       PTSCOR = TC1
  14105       IF(TEST) WRITE(60,504)
  14106   504 FORMAT(' T240--POSSIBLE TS ERROR')
  14107       IF(TEST) WRITE(60,505) TSCOR,TCBEST(1),TC1,XINC(LS,2),R4
  14108   505 FORMAT(' T240--TSCOR: ',F10.1,'  TCBEST(1): ',F10.1,
  14109      &  '  GUESS COR: ',F10.1,' XINC: ',F10.1,' R4: ',F10.1)
  14110       IHSC(3,LM) = 102
  14111       POUT = .TRUE.

Page 471         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  14112 C     TC1 = TSCOR
  14113       CALL SIMPLE(TC1,TOB(LM),ALLT,NALLT,10.)
  14114       CALL ROUND(TC1,POB(LM),3)
  14115       IF(ABS(TC1).LT.TCLIM) THEN
  14116         IF(ABS(PTSCOR).LT.TCLIM) THEN
  14117           TC1 = 0.
  14118           QM = 3.
  14119           IHSC(3,LM) = 105
  14120         ELSE
  14121           TC1 = PTSCOR
  14122           CALL ROUND(TC1,POB(LM),3)
  14123           QM = 1.
  14124         ENDIF
  14125       ELSE
  14126         QM = 1.
  14127       ENDIF
  14128       TCOR(1) = TC1
  14129       CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
  14130      &  3,TC1,TOB(LM)+TC1,PTSCOR,QM,IHSC(3,LM),BASRES(IS),
  14131      &  PIS(IS),PSINC)
  14132       RETURN
  14133 
  14134 
  14135 C  OTHER ERRORS, PROBABLY IN PS
  14136 C  ----------------------------
  14137 
  14138   400 CONTINUE
  14139 
  14140       IHSC(1,LM) = 105
  14141       PC1 = 0.
  14142       QM = 1.
  14143       IF(BASRES(IS).NE.BMISS .AND. ABS(BASRES(IS)).GT.20.)    QM = 3.
  14144       IF(PSINC.NE.BMISS      .AND. ABS(PSINC).GT.2.*PSLIM)    QM = 3.
  14145       IF(PIS(IS).NE.BMISS    .AND. ABS(PIS(IS)).GT.4.*PSLIM)  QM = 3.
  14146       IF(BASRES(IS).NE.BMISS .AND. ABS(BASRES(IS)).GT.50.)    QM = 13.
  14147       IF(PSINC.NE.BMISS      .AND. ABS(PSINC).GT.4.*PSLIM)    QM = 13.
  14148       IF(PIS(IS).NE.BMISS    .AND. ABS(PIS(IS)).GT.8.*PSLIM)  QM = 13.
  14149       CALL SEVENT(SID(IS),SQN(IS),LM,LST(LM),POB(LM),LEVTYP(LM),
  14150      &  1,PC1,POB(LM)+PC1,0.,QM,IHSC(1,LM),BASRES(IS),
  14151      &  PIS(IS),PSINC)
  14152       RETURN
  14153 
  14154       END

Page 472         Source Listing                  T240
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name             
                   
 t240_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  13924                                                          13921                             
 100                        Label  14039                                                          14029                             
 20                         Label  13938                                                          13923                             
 200                        Label  14062                                                          14030                             
 300                        Label  14101                                                          14031                             
 400                        Label  14138                                                          14032                             
 500                        Label  13818                                                          13817                             
 501                        Label  14043                                                          14042                             
 502                        Label  14065                                                          14064                             
 503                        Label  14068                                                          14067                             
 504                        Label  14106                                                          14105                             
 505                        Label  14108                                                          14107                             
 506                        Label  13981                                                          13980                             
 507                        Label  14002                                                          14000                             
 508                        Label  14009                                                          14007                             
 509                        Label  14013                                                          14011                             
 510                        Label  14016                                                          14015                             
 600                        Label  13834                                                                                            
 601                        Label  13875                                                                                            
 602                        Label  13883                                                                                            
 603                        Label  13889                                                                                            
 604                        Label  13916                                                                                            
 605                        Label  13937                                                                                            
 606                        Label  13931                                                                                            
 ABS                        Func   13870                                scalar                    13870,13871,13872,13873,13878,1388
                                                                                                  1,13887,13919,13925,13935,13974,13
                                                                                                  975,13976,14073,14115,14116,14143,
                                                                                                  14144,14145,14146,14147,14148     
 ALLOW                      Common 13804                                456                                                         
 ALLSND                     Common 13767                                34512                                                       
 ALLT                       Scalar 13804    R(4)            4     1     71       COM              14113                             
 ALLZ                       Scalar 13804    R(4)            4     1     41       COM              14046,14070                       
 ALP                        Func   13873    R(4)            4           scalar                    13873,13926                       
 AMAX1                      Func   13957                                scalar                    13957,13959                       
 B                          Scalar 13783    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 13782    R(4)            4     1     999      COM              13817,13870,13919,13926,13974,1400
                                                                                                  7,14055,14081,14087,14092,14130,14
                                                                                                  143,14146,14150                   
 BEST                       Subr   13933                                                          13933                             
 BMISS                      Scalar 13762    R(8)            8           scalar   COM              13828,13852,13853,13854,13855,1385
                                                                                                  6,13857,13858,13871,13872,13878,13
                                                                                                  897,13919,13941,13942,13943,13945,
                                                                                                  13956,13958,13962,13974,13975,1397
                                                                                                  6,13991,13997,13998,14090,14143,14

Page 473         Source Listing                  T240
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  144,14145,14146,14147,14148       
 BRES                       Scalar 13796    R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 13809                                16                                                          
 C1                         Local  13827    R(4)            4           scalar                    13827,13873                       
 CAT                        Scalar 13772    R(4)            4     1     255      COM                                                
 CONSTS                     Common 13801                                20                                                          
 CP                         Scalar 13801    R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 13803    R(4)            4           scalar   COM                                                
 DHR                        Scalar 13764    R(4)            4     1     999      COM                                                
 DZDP                       Local  13829    R(4)            4           scalar                    13829,13831,13870,13881,13887,1391
                                                                                                  4,14011,14048,14067,14072         
 ELV                        Scalar 13765    R(4)            4     1     999      COM              14000,14086                       
 ERROR                      Scalar 13796    L(4)            4     1     999      COM                                                
 FIRST                      Local  13811    L(4)            4           scalar                    13987,13991,13993                 
 G                          Scalar 13801    R(4)            4           scalar   COM              13825,13829                       
 GESPS                      Scalar 13773    R(4)            4     1     999      COM                                                
 GOOD                       Local  13813    L(4)            4     3     24                                                          
 H1                         Scalar 13806    R(4)            4           scalar   COM                                                
 H2                         Scalar 13806    R(4)            4           scalar   COM                                                
 HEADER                     Common 13764                                35980                                                       
 HOIRES                     Scalar 13797    R(4)            4     2     84       COM                                                
 HRDR                       Scalar 13773    R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 13797    R(4)            4     1     21       COM                                                
 HYD                        Scalar 13781    R(4)            4     1     21       COM              13991,13992                       
 HYD1                       Local  13992    R(4)            4           scalar                    13992,14007                       
 HYDM                       Scalar 13796    R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 13781    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 13781    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 13781    R(4)            4     1     21       COM                                                
 HYDSTUF                    Common 13806                                64                                                          
 I                          Local  13896    I(4)            4           scalar                    13896,13897,13899,13900,13920,1392
                                                                                                  1,13925,13926,13988,13989,14088,14
                                                                                                  089,14090,14091,14092             
 IHSC                       Scalar 13782    I(4)            4     2     1020     COM              13841,13842,13843,13844,14053,1405
                                                                                                  5,14079,14081,14084,14086,14089,14
                                                                                                  092,14110,14119,14130,14140,14150 
 IMISS                      Scalar 13809    I(4)            4           scalar   COM              13880,13886,13999                 
 IND                        Scalar 13772    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 13803    I(4)            4           scalar   COM                                                
 IS                         Scalar 13805    I(4)            4           scalar   COM              13817,13870,13872,13873,13878,1388
                                                                                                  1,13919,13926,13974,13976,14000,14
                                                                                                  007,14011,14054,14055,14069,14080,
                                                                                                  14081,14082,14085,14086,14087,1409
                                                                                                  1,14092,14093,14129,14130,14131,14
                                                                                                  143,14145,14146,14148,14149,14150,
                                                                                                  14151                             
 ISC                        Scalar 13803    I(4)            4           scalar   COM              13980                             
 ISF                        Scalar 13766    I(4)            4     1     999      COM                                                
 ITP                        Scalar 13765    I(4)            4     1     999      COM                                                
 IV                         Local  14051    I(4)            4           scalar                    14051                             
 L                          Dummy  13759    I(4)            4           scalar   ARG,INOUT                                          
 L100                       Local  13813    L(4)            4           scalar                    13865,13968,13973,13980,14015,1402
                                                                                                  9                                 
 L102                       Local  13813    L(4)            4           scalar                    13867,13972,13973,13980,14015,1403
                                                                                                  1                                 

Page 474         Source Listing                  T240
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 L105                       Local  13813    L(4)            4           scalar                    13868,13977,13980,14015,14026,1403
                                                                                                  2                                 
 L106                       Local  13813    L(4)            4           scalar                    13866,13970,13973,13980,14015,1402
                                                                                                  4,14025,14030                     
 LAST                       Scalar 13807    I(4)            4           scalar   COM                                                
 LEVEL                      Common 13800                                84                                                          
 LEVTYP                     Scalar 13772    I(4)            4     1     255      COM              13921,14054,14080,14086,14091,1412
                                                                                                  9,14149                           
 LIMS                       Common 13797                                1776                                                        
 LM                         Dummy  13759    I(4)            4           scalar   ARG,INOUT        13821,13828,13829,13841,13842,1384
                                                                                                  3,13844,13920,13925,13926,13932,13
                                                                                                  933,13934,14046,14047,14053,14054,
                                                                                                  14055,14070,14071,14079,14080,1408
                                                                                                  1,14085,14110,14113,14114,14119,14
                                                                                                  122,14129,14130,14140,14149,14150 
 LMAND                      Scalar 13803    I(4)            4     1     22       COM              13822,13823,14044                 
 LMAND1                     Local  14044    I(4)            4           scalar                    14044                             
 LS                         Local  13821    I(4)            4           scalar                    13821,13822,13823,13934,13935,1410
                                                                                                  7                                 
 LSFC                       Scalar 13803    I(4)            4           scalar   COM              14084,14085,14086                 
 LSP                        Local  13822    I(4)            4           scalar                    13822,13886,13887,13999,14001,1400
                                                                                                  7,14008                           
 LSS                        Local  13823    I(4)            4           scalar                    13823,13880,13881,13887,13999,1400
                                                                                                  0,14007,14008,14011               
 LST                        Scalar 13773    I(4)            4     1     255      COM              14054,14080,14085,14091,14129,1414
                                                                                                  9                                 
 M                          Local  13989    I(4)            4           scalar                    13989,13990,13991,13992           
 MAND                       Scalar 13802    I(4)            4           scalar   COM              13822                             
 MANLEV                     Func   13897    I(4)            4           scalar                    13897,13989,14090                 
 MANRES                     Common 13785                                2949048                                                     
 MIN                        Func   13822                                scalar                    13822                             
 NALLT                      Scalar 13804    I(4)            4           scalar   COM              14113                             
 NALLZ                      Scalar 13804    I(4)            4           scalar   COM              14046,14070                       
 NBAS                       Scalar 13783    I(4)            4           scalar   COM                                                
 NEV                        Scalar 13766    I(4)            4           scalar   COM                                                
 NHLIM                      Scalar 13799    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 13781    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 13783    I(4)            4     1     21       COM                                                
 NLEV                       Scalar 13802    I(4)            4           scalar   COM              13896,13920,13988,14088           
 NLV                        Scalar 13765    I(4)            4           scalar   COM                                                
 NLVM                       Scalar 13766    I(4)            4           scalar   COM                                                
 NLVW                       Scalar 13766    I(4)            4           scalar   COM                                                
 NMANLV                     Func   13821    I(4)            4           scalar                    13821                             
 NOBS                       Scalar 13802    I(4)            4           scalar   COM                                                
 NQHM                       Scalar 13793    I(4)            4     2     20979    COM                                                
 NQI                        Scalar 13777    I(4)            4     1     255      COM                                                
 NQV                        Scalar 13779    I(4)            4     1     255      COM                                                
 NST                        Param  13760    I(4)            4           scalar                    13764,13765,13766,13773,13782,1378
                                                                                                  5,13786,13787,13788,13789,13790,13
                                                                                                  791,13792,13793,13794,13795,13796 
 NSUM                       Local  13893    I(4)            4           scalar                    13893,13898,13903                 
 NTDHM                      Scalar 13793    I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 13777    I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 13788    I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 13779    I(4)            4     1     255      COM                                                

Page 475         Source Listing                  T240
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTHM                       Scalar 13791    I(4)            4     2     20979    COM                                                
 NTI                        Scalar 13777    I(4)            4     1     255      COM                                                
 NTIM                       Scalar 13788    I(4)            4     2     20979    COM                                                
 NTL                        Scalar 13779    I(4)            4     1     255      COM                                                
 NTV                        Scalar 13779    I(4)            4     1     255      COM                                                
 NZHM                       Scalar 13791    I(4)            4     2     20979    COM                                                
 NZI                        Scalar 13777    I(4)            4     1     255      COM                                                
 NZIM                       Scalar 13788    I(4)            4     2     20979    COM                                                
 NZV                        Scalar 13779    I(4)            4     1     255      COM                                                
 PARAMS                     Common 13802                                148                                                         
 PC1                        Local  14141    R(4)            4           scalar                    14141,14150                       
 PFC                        Scalar 13767    R(4)            4     1     255      COM                                                
 PI                         Scalar 13775    R(4)            4     1     255      COM                                                
 PIS                        Scalar 13796    R(4)            4     1     999      COM              13817,13872,13873,13878,13881,1397
                                                                                                  6,14007,14011,14055,14069,14082,14
                                                                                                  087,14093,14131,14145,14148,14151 
 PMAND                      Scalar 13800    R(4)            4     1     21       COM                                                
 POB                        Scalar 13767    R(4)            4     1     255      COM              13821,13828,13829,13897,13925,1392
                                                                                                  6,13932,13989,14000,14001,14046,14
                                                                                                  047,14054,14055,14070,14071,14080,
                                                                                                  14081,14085,14090,14091,14114,1412
                                                                                                  2,14129,14149,14150               
 POUT                       Scalar 13807    L(4)            4           scalar   COM              14041,14066,14111                 
 PPSCOR                     Local  13838    R(4)            4           scalar                    13838,14049,14055,14076,14081     
 PQM                        Scalar 13767    R(4)            4     1     255      COM                                                
 PRC                        Scalar 13767    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 13803    L(4)            4           scalar   COM                                                
 PS                         Scalar 13773    R(4)            4     1     999      COM              14000                             
 PSCOR                      Scalar 13807    R(4)            4           scalar   COM              13835,14045,14046,14047,14048,1404
                                                                                                  9,14055,14069,14070,14071,14072,14
                                                                                                  076,14081,14085                   
 PSINC                      Scalar 13782    R(4)            4           scalar   COM              13817,13871,13873,13975,14007,1401
                                                                                                  1,14045,14056,14082,14087,14093,14
                                                                                                  131,14144,14147,14151             
 PSLIM                      Local  13815    R(4)            4           scalar                    13815,13870,13871,13872,13873,1387
                                                                                                  8,13881,13887,13914,13975,13976,14
                                                                                                  144,14145,14147,14148             
 PTSCOR                     Local  13840    R(4)            4           scalar                    13840,14104,14116,14121,14130     
 PZSCOR                     Local  13839    R(4)            4           scalar                    13839,14050,14077,14092           
 QFC                        Scalar 13771    R(4)            4     1     255      COM                                                
 QG                         Scalar 13795    L(4)            4     2     20979    COM                                                
 QHM                        Scalar 13786    R(4)            4     2     20979    COM                                                
 QI                         Scalar 13775    R(4)            4     1     255      COM                                                
 QIM                        Scalar 13785    R(4)            4     2     20979    COM                                                
 QM                         Local  14052    R(4)            4           scalar                    14052,14055,14078,14081,14083,1408
                                                                                                  6,14092,14118,14123,14126,14130,14
                                                                                                  142,14143,14144,14145,14146,14147,
                                                                                                  14148,14150                       
 QOB                        Scalar 13771    R(4)            4     1     255      COM                                                
 QQM                        Scalar 13771    R(4)            4     1     255      COM                                                
 QRC                        Scalar 13771    R(4)            4     1     255      COM                                                
 QV                         Scalar 13776    R(4)            4     1     255      COM                                                
 QVM                        Scalar 13787    R(4)            4     2     20979    COM                                                
 R                          Scalar 13801    R(4)            4           scalar   COM              13825,13829                       
 R0                         Local  13852    R(4)            4           scalar                    13852,13870,13956,13957,14015     

Page 476         Source Listing                  T240
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 R1                         Local  13853    R(4)            4           scalar                    13853,13873,13945,13997,14015,1404
                                                                                                  2                                 
 R100                       Local  13941    R(4)            4           scalar                    13941,13945,13967,13968,13969,1397
                                                                                                  1,13980,14015                     
 R102                       Local  13943    R(4)            4           scalar                    13943,13962,13968,13970,13971,1397
                                                                                                  2,13980,14015                     
 R106                       Local  13942    R(4)            4           scalar                    13942,13957,13959,13967,13969,1397
                                                                                                  0,13972,13980,14015               
 R2                         Local  13854    R(4)            4           scalar                    13854,13881,13956,13957,13958,1395
                                                                                                  9,13997,14015,14067               
 R3                         Local  13855    R(4)            4           scalar                    13855,13914,13997,14015,14067     
 R4                         Local  13856    R(4)            4           scalar                    13856,13935,13962,13998,14015,1410
                                                                                                  7                                 
 R5                         Local  13857    R(4)            4           scalar                    13857,13887,13956,13957,13958,1395
                                                                                                  9,13998,14015,14067               
 RADPC                      Scalar 13802    R(4)            4           scalar   COM                                                
 RESID                      Common 13775                                41312                                                       
 RO2G                       Local  13825    R(4)            4           scalar                    13825,13926                       
 ROUND                      Subr   13932                                                          13932,14047,14071,14074,14114,1412
                                                                                                  2                                 
 RV                         Scalar 13801    R(4)            4           scalar   COM                                                
 SEVENT                     Subr   14054                                                          14054,14080,14085,14091,14129,1414
                                                                                                  9                                 
 SID                        Scalar 13764    CHAR            8     1     999      COM              13817,14000,14054,14080,14085,1409
                                                                                                  1,14129,14149                     
 SIMPLE                     Subr   14046                                                          14046,14070,14113                 
 SQN                        Scalar 13765    R(4)            4     1     999      COM              14054,14080,14085,14091,14129,1414
                                                                                                  9                                 
 SQRT                       Func   13910                                scalar                    13910                             
 STN                        Common 13805                                4                                                           
 SUM                        Local  13894    R(4)            4           scalar                    13894,13899,13905                 
 SUMS                       Local  13895    R(4)            4           scalar                    13895,13900,13905                 
 SX                         Local  13858    R(4)            4           scalar                    13858,13905,13907,13909,13910,1391
                                                                                                  2,13914,14008,14067               
 T0                         Scalar 13801    R(4)            4           scalar   COM              13829                             
 T1                         Scalar 13806    R(4)            4           scalar   COM                                                
 T240                       Subr   13759                                                                                            
 TC1                        Local  14103    R(4)            4           scalar                    14103,14104,14107,14113,14114,1411
                                                                                                  5,14117,14121,14122,14128,14130   
 TCBEST                     Scalar 13806    R(4)            4     1     2        COM              13933,13935,14012,14103,14107     
 TCLIM                      Scalar 13799    R(4)            4           scalar   COM              14115,14116                       
 TCOR                       Scalar 13806    R(4)            4     1     2        COM              14128                             
 TDFC                       Scalar 13770    R(4)            4     1     255      COM                                                
 TDG                        Scalar 13795    L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 13786    R(4)            4     2     20979    COM                                                
 TDI                        Scalar 13775    R(4)            4     1     255      COM                                                
 TDIM                       Scalar 13785    R(4)            4     2     20979    COM                                                
 TDO                        Scalar 13770    R(4)            4     1     255      COM                                                
 TDV                        Scalar 13776    R(4)            4     1     255      COM                                                
 TDVM                       Scalar 13787    R(4)            4     2     20979    COM                                                
 TEST                       Scalar 13808    L(4)            4           scalar   COM              13817,13980,14042,14064,14067,1410
                                                                                                  5,14107                           
 TESTS                      Common 13808                                4                                                           
 TFACT                      Scalar 13798    R(4)            4     2     84       COM                                                
 TFC                        Scalar 13769    R(4)            4     1     255      COM                                                

Page 477         Source Listing                  T240
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TG                         Scalar 13795    L(4)            4     2     20979    COM                                                
 THM                        Scalar 13786    R(4)            4     2     20979    COM                                                
 TI                         Scalar 13775    R(4)            4     1     255      COM              13933                             
 TIM                        Scalar 13785    R(4)            4     2     20979    COM                                                
 TL                         Scalar 13776    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 13782    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 13798    R(4)            4     2     84       COM                                                
 TOB                        Scalar 13769    R(4)            4     1     255      COM              13829,14113,14130                 
 TQM                        Scalar 13769    R(4)            4     1     255      COM                                                
 TRC                        Scalar 13769    R(4)            4     1     255      COM                                                
 TSCOR                      Scalar 13807    R(4)            4           scalar   COM              13836,13926,13928,13932,13935,1401
                                                                                                  1,14012,14103,14107               
 TT                         Scalar 13803    R(4)            4           scalar   COM                                                
 TV                         Scalar 13776    R(4)            4     1     255      COM              13934                             
 TVM                        Scalar 13787    R(4)            4     2     20979    COM                                                
 TVO                        Scalar 13770    R(4)            4     1     255      COM                                                
 VOIRES                     Scalar 13798    R(4)            4     2     84       COM              13934                             
 VTPPC                      Scalar 13802    R(4)            4           scalar   COM                                                
 X0                         Local  13859    R(4)            4           scalar                    13859,13957                       
 X1                         Local  13860    R(4)            4           scalar                    13860,13945                       
 X2                         Local  13861    R(4)            4           scalar                    13861,13957,13959                 
 X3                         Local  13862    R(4)            4           scalar                    13862                             
 X4                         Local  13863    R(4)            4           scalar                    13863,13962                       
 X5                         Local  13864    R(4)            4           scalar                    13864,13957,13959                 
 XDR                        Scalar 13774    R(4)            4     1     255      COM                                                
 XINC                       Scalar 13797    R(4)            4     2     84       COM              13934,13935,14107                 
 XMA                        Scalar 13802    R(4)            4           scalar   COM                                                
 XMI                        Scalar 13802    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 13809    R(4)            4           scalar   COM              13933,13934                       
 XOB                        Scalar 13764    R(4)            4     1     999      COM              14000                             
 XQHM                       Scalar 13794    R(4)            4     2     20979    COM                                                
 XQI                        Scalar 13778    R(4)            4     1     255      COM                                                
 XQIM                       Scalar 13790    R(4)            4     2     20979    COM                                                
 XQV                        Scalar 13780    R(4)            4     1     255      COM                                                
 XSUM                       Local  13903    R(4)            4           scalar                    13903,13904,13905                 
 XTDH                       Scalar 13784    R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 13793    R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 13778    R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 13789    R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 13780    R(4)            4     1     255      COM                                                
 XTDVM                      Scalar 13792    R(4)            4     2     20979    COM                                                
 XTH                        Scalar 13783    R(4)            4     1     255      COM                                                
 XTHM                       Scalar 13792    R(4)            4     2     20979    COM                                                
 XTI                        Scalar 13778    R(4)            4     1     255      COM                                                
 XTIM                       Scalar 13789    R(4)            4     2     20979    COM                                                
 XTV                        Scalar 13780    R(4)            4     1     255      COM                                                
 XTVM                       Scalar 13790    R(4)            4     2     20979    COM                                                
 XZH                        Scalar 13783    R(4)            4     1     255      COM                                                
 XZHM                       Scalar 13791    R(4)            4     2     20979    COM                                                
 XZI                        Scalar 13778    R(4)            4     1     255      COM                                                
 XZIM                       Scalar 13789    R(4)            4     2     20979    COM                                                
 XZV                        Scalar 13780    R(4)            4     1     255      COM                                                
 XZVM                       Scalar 13790    R(4)            4     2     20979    COM                                                
 YDR                        Scalar 13774    R(4)            4     1     255      COM                                                
 YMA                        Scalar 13802    R(4)            4           scalar   COM                                                

Page 478         Source Listing                  T240
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YMI                        Scalar 13802    R(4)            4           scalar   COM                                                
 YOB                        Scalar 13764    R(4)            4     1     999      COM              14000                             
 ZCBEST                     Scalar 13806    R(4)            4     1     2        COM                                                
 ZCLIM                      Scalar 13799    R(4)            4           scalar   COM              14073                             
 ZCOR                       Scalar 13806    R(4)            4     1     2        COM                                                
 ZCR                        Local  14072    R(4)            4           scalar                    14072,14073,14074,14075,14092     
 ZD                         Scalar 13783    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 13768    R(4)            4     1     255      COM                                                
 ZG                         Scalar 13795    L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 13786    R(4)            4     2     20979    COM                                                
 ZI                         Scalar 13775    R(4)            4     1     255      COM              13881,13887,13897,13899,13900,1400
                                                                                                  7,14008,14011                     
 ZIM                        Scalar 13785    R(4)            4     2     20979    COM                                                
 ZOB                        Scalar 13768    R(4)            4     1     255      COM              14090,14092                       
 ZQM                        Scalar 13768    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 13768    R(4)            4     1     255      COM                                                
 ZSCOR                      Scalar 13807    R(4)            4           scalar   COM              13837,14048,14050,14075,14077     
 ZV                         Scalar 13776    R(4)            4     1     255      COM                                                
 ZVM                        Scalar 13787    R(4)            4     2     20979    COM                                                

Page 479         Source Listing                  T240
2017-04-18 11:07                                 cqcbufr.f

  14155 
  14156 C******************************************************************
  14157 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14158 C                .      .    .                                       .
  14159 C SUBPROGRAM:    TMPCHK      COMPUTES TEMPORAL RESIDUALS
  14160 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1990-12-06
  14161 C
  14162 C ABSTRACT: COMPUTES TEMPORAL RESIDUALS
  14163 C
  14164 C PROGRAM HISTORY LOG:
  14165 C   UNKNOWN   W. Collins  Original author.
  14166 C
  14167 C USAGE:    CALL TMPCHK
  14168 C
  14169 C   OUTPUT FILES:
  14170 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  14171 C
  14172 C REMARKS: NONE.
  14173 C
  14174 C ATTRIBUTES:
  14175 C   LANGUAGE: FORTRAN 90
  14176 C   MACHINE:  NCEP WCOSS
  14177 C
  14178 C$$$
  14179       SUBROUTINE TMPCHK
  14180       PARAMETER (NST=999)
  14181 
  14182       REAL(8) BMISS
  14183 
  14184 C     COMMON /TMPSND/  ZOBT(21,NST,4), TOBT(21,NST,4), 
  14185 C    &                 ZIT(21,NST,4),  TIT(21,NST,4),
  14186 C    &                 ZTMP(21,NST),   TTMP(21,NST),
  14187 C    &                 NZTMP(21,NST),  NTTMP(21,NST),
  14188 C    &                 ITERR(4)
  14189       COMMON /TMPSND/  OBT(21,NST,4,2), OIT(21,NST,4,2),
  14190      &                 TMP(21,NST,2), NTMP(21,NST,2), ITERR(4)
  14191       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  14192      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  14193       COMMON /MANSND/  OM(21,NST,2), TDM(21), QM(21), MANDL, MANDF,
  14194      &                 ZFM(21),TFM(21),QFM(21), PM(21)
  14195       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  14196      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  14197      &                 ZCLIM, TCLIM, NHLIM
  14198       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  14199 
  14200       LOGICAL          PRNT
  14201       INTEGER IND(5)
  14202 
  14203       DO IS=1,NOBS
  14204       DO IV=1,2
  14205         DO L=1,MAND
  14206           DO IT=1,4
  14207             IF(ITERR(IT).NE.0
  14208      &        .OR.OBT(L,IS,IT,IV).EQ.BMISS) THEN
  14209               IND(IT) = 0
  14210             ELSE
  14211               IND(IT) = 1

Page 480         Source Listing                  TMPCHK
2017-04-18 11:07                                 cqcbufr.f

  14212             ENDIF
  14213           ENDDO
  14214           IF(OM(L,IS,IV).EQ.BMISS) THEN
  14215             IND(5) = 0
  14216           ELSE
  14217             IND(5) = 1
  14218           ENDIF
  14219           IF(IV.EQ.2.AND.L.LE.2
  14220      &      .AND.IND(1)+IND(5)+IND(4).EQ.3) THEN
  14221             IM = 1
  14222             IP = 4
  14223             TMP(L,IS,IV) = (OM(L,IS,IV)
  14224      &        -0.5*(OBT(L,IS,1,IV)+OBT(L,IS,4,IV)))
  14225           ELSEIF(IND(2)+IND(5)+IND(3).EQ.3) THEN
  14226             IM = 2
  14227             IP = 3
  14228             TMP(L,IS,IV) = OM(L,IS,IV)
  14229      &        - 0.5*(OBT(L,IS,2,IV) + OBT(L,IS,3,IV))
  14230           ELSEIF(IND(2)+IND(5)+IND(4).EQ.3) THEN
  14231             IM = 2
  14232             IP = 4
  14233             TMP(L,IS,IV) = (OM(L,IS,IV)
  14234      &        -(2./3.)*OBT(L,IS,2,IV)-(1./3.)*OBT(L,IS,4,IV))
  14235           ELSEIF(IND(1)+IND(5)+IND(3).EQ.3) THEN
  14236             IM = 1
  14237             IP = 3
  14238             TMP(L,IS,IV) = (OM(L,IS,IV)
  14239      &        -(1./3.)*OBT(L,IS,1,IV)-(2./3.)*OBT(L,IS,3,IV))
  14240           ELSEIF(IND(1)+IND(5)+IND(4).EQ.3) THEN
  14241             IM = 1
  14242             IP = 4
  14243             TMP(L,IS,IV) = (OM(L,IS,IV)
  14244      &        -0.5*(OBT(L,IS,1,IV)+OBT(L,IS,4,IV)))
  14245           ELSE
  14246             TMP(L,IS,IV) = BMISS
  14247           ENDIF
  14248 
  14249 C           TEMPORAL CHECK FLAGS.
  14250 C
  14251           IF(TMP(L,IS,IV).EQ.BMISS) THEN
  14252             ITI = 0
  14253           ELSE
  14254             ITI = 20.*ABS(TMP(L,IS,IV))
  14255      &            /(TMPSTD(L,IV)*TFACT(L,IV))
  14256             ITI = MIN(ITI,20)
  14257             IF(ITI.NE.0) CALL CHKTMP(OIT(L,IS,IM,IV),
  14258      &        OIT(L,IS,IP,IV),TMPSTD(L,IV)*TFACT(L,IV),ICK)
  14259             IF(ICK.NE.0) THEN
  14260               ITI = 0
  14261               TMP(L,IS,IV) = BMISS
  14262             ENDIF
  14263           ENDIF
  14264           NTMP(L,IS,IV) = ITI
  14265         ENDDO
  14266         IF(IS.LE.10) THEN
  14267           WRITE(60,500) IS,IV,(NTMP(L,IS,IV),L=1,15),
  14268      &      (TMP(L,IS,IV),L=1,15)

Page 481         Source Listing                  TMPCHK
2017-04-18 11:07                                 cqcbufr.f

  14269   500     FORMAT(' TMPCHK--IS,IV,NTMP-S: ',2I5,2X,15I4,/,
  14270      &           '                TMP-S: ',15F12.1)
  14271         ENDIF
  14272       ENDDO
  14273       IF(IS.LE.10) THEN
  14274         WRITE(60,501) (OBT(5,IS,1,IV),OBT(5,IS,2,IV),OM(5,IS,IV),
  14275      &    OBT(5,IS,3,IV),OBT(5,IS,4,IV),IV=1,2)
  14276   501   FORMAT('               Z500-S: ',5F12.1,/,
  14277      &           '               T500-S: ',5F12.1)
  14278       ENDIF
  14279       ENDDO
  14280       RETURN
  14281       END


ENTRY POINTS

  Name               
                     
 tmpchk_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  14269                                                          14267                             
 501                        Label  14276                                                          14274                             
 ABS                        Func   14254                                scalar                    14254                             
 BMISS                      Scalar 14182    R(8)            8           scalar   COM              14208,14214,14246,14251,14261     
 BUFRLIB_MISSING            Common 14198                                16                                                          
 CHKTMP                     Subr   14257                                                          14257                             
 CQCPC                      Scalar 14192    R(4)            4           scalar   COM                                                
 HOIRES                     Scalar 14195    R(4)            4     2     84       COM                                                
 HSCRES                     Scalar 14195    R(4)            4     1     21       COM                                                
 ICK                        Local  14258    I(4)            4           scalar                    14258,14259                       
 IM                         Local  14221    I(4)            4           scalar                    14221,14226,14231,14236,14241,1425
                                                                                                  7                                 
 IMISS                      Scalar 14198    I(4)            4           scalar   COM                                                
 IND                        Local  14201    I(4)            4     1     5                         14209,14211,14215,14217,14220,1422
                                                                                                  5,14230,14235,14240               
 IP                         Local  14222    I(4)            4           scalar                    14222,14227,14232,14237,14242,1425
                                                                                                  8                                 
 IPEVT                      Scalar 14192    I(4)            4           scalar   COM                                                
 IS                         Local  14203    I(4)            4           scalar                    14203,14208,14214,14223,14224,1422
                                                                                                  8,14229,14233,14234,14238,14239,14
                                                                                                  243,14244,14246,14251,14254,14257,
                                                                                                  14258,14261,14264,14266,14267,1426
                                                                                                  8,14273,14274,14275               
 ISC                        Scalar 14192    I(4)            4           scalar   COM                                                
 IT                         Local  14206    I(4)            4           scalar                    14206,14207,14208,14209,14211     
 ITERR                      Scalar 14190    I(4)            4     1     4        COM              14207                             
 ITI                        Local  14252    I(4)            4           scalar                    14252,14254,14256,14257,14260,1426
                                                                                                  4                                 
 IV                         Local  14204    I(4)            4           scalar                    14204,14208,14214,14219,14223,1422
                                                                                                  4,14228,14229,14233,14234,14238,14
                                                                                                  239,14243,14244,14246,14251,14254,

Page 482         Source Listing                  TMPCHK
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  14255,14257,14258,14261,14264,1426
                                                                                                  7,14268,14274,14275               
 L                          Local  14205    I(4)            4           scalar                    14205,14208,14214,14219,14223,1422
                                                                                                  4,14228,14229,14233,14234,14238,14
                                                                                                  239,14243,14244,14246,14251,14254,
                                                                                                  14255,14257,14258,14261,14264,1426
                                                                                                  7,14268                           
 LIMS                       Common 14195                                1776                                                        
 LMAND                      Scalar 14192    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 14192    I(4)            4           scalar   COM                                                
 MAND                       Scalar 14191    I(4)            4           scalar   COM              14205                             
 MANDF                      Scalar 14193    I(4)            4           scalar   COM                                                
 MANDL                      Scalar 14193    I(4)            4           scalar   COM                                                
 MANSND                     Common 14193                                168344                                                      
 MIN                        Func   14256                                scalar                    14256                             
 NHLIM                      Scalar 14197    I(4)            4           scalar   COM                                                
 NLEV                       Scalar 14191    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 14191    I(4)            4           scalar   COM              14203                             
 NST                        Param  14180    I(4)            4           scalar                    14189,14190,14193                 
 NTMP                       Scalar 14190    I(4)            4     3     41958    COM              14264,14267                       
 OBT                        Scalar 14189    R(4)            4     4     167832   COM              14208,14224,14229,14234,14239,1424
                                                                                                  4,14274,14275                     
 OIT                        Scalar 14189    R(4)            4     4     167832   COM              14257,14258                       
 OM                         Scalar 14193    R(4)            4     3     41958    COM              14214,14223,14228,14233,14238,1424
                                                                                                  3,14274                           
 PARAMS                     Common 14191                                148                                                         
 PM                         Scalar 14194    R(4)            4     1     21       COM                                                
 PRNT                       Scalar 14192    L(4)            4           scalar   COM                                                
 QFM                        Scalar 14194    R(4)            4     1     21       COM                                                
 QM                         Scalar 14193    R(4)            4     1     21       COM                                                
 RADPC                      Scalar 14191    R(4)            4           scalar   COM                                                
 TCLIM                      Scalar 14197    R(4)            4           scalar   COM                                                
 TDM                        Scalar 14193    R(4)            4     1     21       COM                                                
 TFACT                      Scalar 14196    R(4)            4     2     84       COM              14255,14258                       
 TFM                        Scalar 14194    R(4)            4     1     21       COM                                                
 TMP                        Scalar 14190    R(4)            4     3     41958    COM              14223,14228,14233,14238,14243,1424
                                                                                                  6,14251,14254,14261,14268         
 TMPCHK                     Subr   14179                                                                                            
 TMPSND                     Common 14189                                1678336                                                     
 TMPSTD                     Scalar 14196    R(4)            4     2     84       COM              14255,14258                       
 TT                         Scalar 14192    R(4)            4           scalar   COM                                                
 VOIRES                     Scalar 14196    R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 14191    R(4)            4           scalar   COM                                                
 XINC                       Scalar 14195    R(4)            4     2     84       COM                                                
 XMA                        Scalar 14191    R(4)            4           scalar   COM                                                
 XMI                        Scalar 14191    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 14198    R(4)            4           scalar   COM                                                
 YMA                        Scalar 14191    R(4)            4           scalar   COM                                                
 YMI                        Scalar 14191    R(4)            4           scalar   COM                                                
 ZCLIM                      Scalar 14197    R(4)            4           scalar   COM                                                
 ZFM                        Scalar 14194    R(4)            4     1     21       COM                                                

Page 483         Source Listing                  TMPCHK
2017-04-18 11:07                                 cqcbufr.f

  14282 
  14283 C******************************************************************
  14284 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14285 C                .      .    .                                       .
  14286 C SUBPROGRAM:    VOI         PERFORM VERTICAL OI CHECK
  14287 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  14288 C
  14289 C ABSTRACT: Perform vertical statistical interpolation (OI) check.
  14290 C
  14291 C PROGRAM HISTORY LOG:
  14292 C 1997-03-18  W. Collins  Original author.
  14293 C 1997-04-28  W. Collins  Exclude use of data that were vertically
  14294 C     interpolated in PREPOBS_PREPDATA.
  14295 C
  14296 C USAGE:    CALL VOI(ITIME)
  14297 C   INPUT ARGUMENT LIST:
  14298 C     ITIME    - 1 - FIRST CALL TO INPUT FOR STATION
  14299 C                2 - SECOND CALL TO INPUT FOR STATION
  14300 C
  14301 C REMARKS: NONE.
  14302 C
  14303 C ATTRIBUTES:
  14304 C   LANGUAGE: FORTRAN 90
  14305 C   MACHINE:  NCEP WCOSS
  14306 C
  14307 C$$$
  14308 
  14309       SUBROUTINE VOI(ITIME)
  14310       PARAMETER (NST=999)
  14311 
  14312       REAL(8) BMISS
  14313 
  14314       REAL             VI(255,4), VR(255,4), CC(4)
  14315       INTEGER          LEV(4), IL(255,4)
  14316       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  14317      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  14318      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  14319      &                 TDO(255), TDFC(255),TVO(255),
  14320      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  14321      &                 CAT(255), IND(255), LEVTYP(255),
  14322      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  14323      &                 YDR(255), XDR(255)
  14324       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  14325      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  14326      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  14327      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  14328      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  14329      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  14330      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  14331      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  14332      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  14333      &                 XTDH(255)
  14334       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  14335      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  14336      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
  14337      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  14338      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),

Page 484         Source Listing                  VOI
2017-04-18 11:07                                 cqcbufr.f

  14339      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  14340      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  14341      &                 XTHM(21,NST),XTDVM(21,NST),
  14342      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  14343      &                 XQHM(21,NST),
  14344      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  14345      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  14346       COMMON /STATS/   NV(21,7), AVGV(21,7), STDV(21,7),
  14347      &                 NH(21,7), AVGH(21,7), STDH(21,7),
  14348      &                 NI(21,7), AVGI(21,7), STDI(21,7),
  14349      &                 NT(21,4),  AVGT(21,4), STDT(21,4),
  14350      &                 NHY(21),   AVGHY(21),  STDHY(21),
  14351      &                 NB,        AVGB,       STDB,
  14352      &                 SKV(21,7), XKV(21,7),
  14353      &                 SKH(21,7), XKH(21,7),
  14354      &                 SKI(21,7), XKI(21,7),
  14355      &                 SKT(21,4), XKT(21,4),
  14356      &                 SKHY(21),  XKHY(21),
  14357      &                 SKB,       XKB
  14358       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  14359      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  14360      &                 ZCLIM, TCLIM, NHLIM
  14361       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  14362      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  14363       COMMON /STN/     IS
  14364       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  14365 
  14366       LOGICAL          PRNT, START
  14367       LOGICAL ZG, TG, TDG, QG, ERROR, RCP, RCT, RCZ, RCATT, RCATZ
  14368       DATA CC /1.1,8.,1.,1./, GAMA /0.5/, POW /1.2/
  14369       DATA START /.TRUE./
  14370       COR(P1,P2,CCC) = 1./(1.+CCC*(ABS(ALOG(P1/P2)))**POW)
  14371 
  14372       PGAM = 1. + GAMA
  14373       PGAMS = PGAM**2
  14374 
  14375       IF(START) THEN
  14376         XZVM = BMISS
  14377         XTVM = BMISS
  14378         XTDVM = BMISS
  14379         START = .FALSE.
  14380       ENDIF
  14381       DO I=1,255
  14382         ZV(I)   = BMISS
  14383         TV(I)   = BMISS
  14384         TDV(I)  = BMISS
  14385         QV(I)   = BMISS
  14386         DO J=1,4
  14387           VI(I,J)   = BMISS
  14388           VR(I,J)   = BMISS
  14389         ENDDO
  14390         NZV(I)  = -1
  14391         NTV(I)  = -1
  14392         NTDV(I) = -1
  14393         NQV(I)  = -1
  14394         IF(ITIME.EQ.2) THEN
  14395           XZV(I)  = BMISS

Page 485         Source Listing                  VOI
2017-04-18 11:07                                 cqcbufr.f

  14396           XTV(I)  = BMISS
  14397           XTDV(I) = BMISS
  14398           XQV(I)  = BMISS
  14399         ENDIF
  14400       ENDDO
  14401       IF(NLEV.LT.2) RETURN
  14402 
  14403 C  PUT NON-MISSING INCREMENTS INTO LOCAL ARRAY FOR
  14404 C  CAT = 1,2,5 LEVELS ONLY
  14405 C  -----------------------------------------------
  14406 
  14407       DO J=1,4
  14408         DO I=1,255
  14409           IL(I,J)  = 0
  14410         ENDDO
  14411       ENDDO
  14412       LZ  = 0
  14413       LT  = 0
  14414       LTD = 0
  14415       LQ  = 0
  14416       DO L=1,NLEV
  14417 C       RCT = TRC(L).EQ.101. .OR. TRC(L).EQ.102. .OR. TRC(L).EQ.103.
  14418 C       RCZ = ZRC(L).EQ.101. .OR. ZRC(L).EQ.103.
  14419         RCATT = .FALSE.
  14420         RCATZ = .FALSE.
  14421         RCATZ = RCATZ .OR. CAT(L).EQ.1
  14422         RCATT = RCATT .OR. CAT(L).EQ.1 .OR. CAT(L).EQ.2 .OR. CAT(L).EQ.5
  14423         IF(ZI(L).LT.BMISS .AND. RCATZ) THEN
  14424           LZ = LZ+1
  14425           VI(LZ,1) = ZI(L)
  14426           IL(LZ,1) = L
  14427         ENDIF
  14428         IF(TI(L).LT.BMISS .AND. RCATT) THEN
  14429           LT = LT+1
  14430           VI(LT,2) = TI(L)
  14431           IL(LT,2) = L
  14432         ENDIF
  14433         IF(TDI(L).LT.BMISS .AND. RCATT) THEN
  14434           LTD = LTD+1
  14435           VI(LTD,3) = TDI(L)
  14436           IL(LTD,3) = L
  14437         ENDIF
  14438         IF(QI(L).LT.BMISS .AND. RCATT) THEN
  14439           LQ = LQ+1
  14440           VI(LQ,4) = QI(L)
  14441           IL(LQ,4) = L
  14442         ENDIF
  14443       ENDDO
  14444 
  14445       LEV(1) = LZ
  14446       LEV(2) = LT
  14447       LEV(3) = LTD
  14448       LEV(4) = LQ
  14449 
  14450       DO IV=1,4
  14451         CCC = CC(IV)
  14452 

Page 486         Source Listing                  VOI
2017-04-18 11:07                                 cqcbufr.f

  14453 C  BOTTOM LEVEL (SURFACE)
  14454 C  ----------------------
  14455 
  14456 	IF(IL(1,IV).EQ.0 .OR. IL(2,IV).EQ.0) GOTO 100
  14457         PR1 = POB(IL(1,IV))
  14458         PR2 = POB(IL(2,IV))
  14459         H1  = COR(PR1,PR2,CCC)/PGAM
  14460         VR(1,IV) = VI(1,IV) - H1*VI(2,IV)
  14461 
  14462 C  TOP LEVEL
  14463 C  ---------
  14464 
  14465         IF(IL(LEV(IV),IV).EQ.0 .OR. IL(LEV(IV)-1,IV).EQ.0) GOTO 100
  14466         PR1 = POB(IL(LEV(IV),IV))
  14467         PR2 = POB(IL(LEV(IV)-1,IV))
  14468         H1  = COR(PR1,PR2,CCC)/PGAM
  14469         VR(LEV(IV),IV) = VI(LEV(IV),IV) - H1*VI(LEV(IV)-1,IV)
  14470 
  14471 C  NOW OTHER LEVELS (This version does not check the distance
  14472 C                    to the neighboring levels.)
  14473 C  ---------------------------------------------
  14474 
  14475    50   CONTINUE
  14476         IF(LEV(IV).LT.3) GOTO 100
  14477         DO L=2,LEV(IV)-1
  14478           IF(IL(L,IV).EQ.0 .OR.IL(L-1,IV).EQ.0 .OR.
  14479      &       IL(L+1,IV).EQ.0) GOTO 60
  14480           PR0 = POB(IL(L,IV))
  14481           PR1 = POB(IL(L-1,IV))
  14482           PR2 = POB(IL(L+1,IV))
  14483           C01 = COR(PR0,PR1,CCC)
  14484           C02 = COR(PR0,PR2,CCC)
  14485           C12 = COR(PR1,PR2,CCC)
  14486           H1  = (PGAM*C01 - C02*C12) / (PGAMS - C12**2)
  14487           H2  = (PGAM*C02 - C01*C12) / (PGAMS - C12**2)
  14488           VR(L,IV) = VI(L,IV) - H1*VI(L-1,IV) - H2*VI(L+1,IV)
  14489    60     CONTINUE
  14490         ENDDO
  14491   100   CONTINUE
  14492       ENDDO
  14493 
  14494 C  PLACE VERTICAL RESIDUALS INTO PROPER COMMON ARRAYS
  14495 C  AND SOLVE FOR NORMALIZED VALUES.
  14496 C  --------------------------------------------------
  14497 
  14498       DO L=1,LEV(1)
  14499         I = NMANLV(POB(IL(L,1)))
  14500         II = MANLEV(POB(IL(L,1)))
  14501         IF(VI(L,1).LT.BMISS) THEN
  14502           IF(I.NE.0) THEN
  14503             ZV(IL(L,1)) = VR(L,1)
  14504             NZV(IL(L,1)) = MIN1(20.,20.*ABS(VR(L,1))/VOIRES(I,1))
  14505             IF(ITIME.EQ.2) THEN
  14506               XZV(IL(L,1)) = (VR(L,1)-AVGV(I,1))
  14507      &                       /MAX(.1*VOIRES(I,1),STDV(I,1))
  14508             ENDIF
  14509           ENDIF

Page 487         Source Listing                  VOI
2017-04-18 11:07                                 cqcbufr.f

  14510           IF(II.NE.0) THEN
  14511             ZVM(II,IS) = VR(L,1)
  14512             XZVM(II,IS) = XZV(IL(L,1))
  14513           ENDIF
  14514         ENDIF
  14515       ENDDO
  14516       DO L=1,LEV(2)
  14517         I = NMANLV(POB(IL(L,2)))
  14518         II = MANLEV(POB(IL(L,2)))
  14519         IF(VI(L,2).LT.BMISS) THEN
  14520           IF(I.NE.0) THEN
  14521             TV(IL(L,2)) = VR(L,2)
  14522             NTV(IL(L,2)) = MIN1(20.,20.*ABS(VR(L,2))/VOIRES(I,2))
  14523             IF(ITIME.EQ.2) THEN
  14524               XTV(IL(L,2)) = (VR(L,2)-AVGV(I,2))
  14525      &                       /MAX(.1*VOIRES(I,2),STDV(I,2))
  14526             ENDIF
  14527           ENDIF
  14528           IF(II.NE.0) THEN
  14529             TVM(II,IS) = VR(L,2)
  14530             XTVM(II,IS) = XTV(IL(L,2))
  14531           ENDIF
  14532         ENDIF
  14533       ENDDO
  14534       DO L=1,LEV(3)
  14535         I = NMANLV(POB(IL(L,3)))
  14536         II = MANLEV(POB(IL(L,3)))
  14537         IF(VI(L,3).LT.BMISS) THEN
  14538           IF(I.NE.0) THEN
  14539             TDV(IL(L,3)) = VR(L,3)
  14540             NTDV(IL(L,3)) = MIN1(20.,20.*ABS(VR(L,3))/VOIRES(I,3))
  14541             IF(ITIME.EQ.2) THEN
  14542               XTDV(IL(L,3)) = (VR(L,3)-AVGV(I,3))
  14543      &                        /MAX(.1*VOIRES(I,3),STDV(I,3))
  14544             ENDIF
  14545           ENDIF
  14546           IF(II.NE.0) THEN
  14547             TDVM(II,IS) = VR(L,3)
  14548             XTDVM(II,IS) = XTDV(IL(L,3))
  14549           ENDIF
  14550         ENDIF
  14551       ENDDO
  14552       DO L=1,LEV(4)
  14553         I = NMANLV(POB(IL(L,4)))
  14554         II = MANLEV(POB(IL(L,4)))
  14555         IF(VI(L,4).LT.BMISS .AND. I.NE.0) THEN
  14556           IF(I.NE.0) THEN
  14557             QV(IL(L,4)) = VR(L,4)
  14558             NQV(IL(L,4)) = MIN1(20.,20.*ABS(VR(L,4))/VOIRES(I,4))
  14559             IF(ITIME.EQ.2) THEN
  14560               XQV(IL(L,4)) = (VR(L,4)-AVGV(I,4))
  14561      &                       /MAX(.1*VOIRES(I,4),STDV(I,4))
  14562             ENDIF
  14563           ENDIF
  14564           IF(II.NE.0) THEN
  14565             QVM(II,IS) = VR(L,4)
  14566           ENDIF

Page 488         Source Listing                  VOI
2017-04-18 11:07                                 cqcbufr.f

  14567         ENDIF
  14568       ENDDO
  14569 
  14570       RETURN
  14571       END


ENTRY POINTS

  Name            
                  
 voi_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  14491                                                          14456,14465,14476                 
 50                         Label  14475                                                                                            
 60                         Label  14489                                                          14479                             
 ABS                        Func   14370                                scalar                    14370,14504,14522,14540,14558     
 ALLSND                     Common 14316                                34512                                                       
 ALOG                       Func   14370                                scalar                    14370                             
 AVGB                       Scalar 14351    R(4)            4           scalar   COM                                                
 AVGH                       Scalar 14347    R(4)            4     2     147      COM                                                
 AVGHY                      Scalar 14350    R(4)            4     1     21       COM                                                
 AVGI                       Scalar 14348    R(4)            4     2     147      COM                                                
 AVGT                       Scalar 14349    R(4)            4     2     84       COM                                                
 AVGV                       Scalar 14346    R(4)            4     2     147      COM              14506,14524,14542,14560           
 B                          Scalar 14332    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 14331    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 14312    R(8)            8           scalar   COM              14376,14377,14378,14382,14383,1438
                                                                                                  4,14385,14387,14388,14395,14396,14
                                                                                                  397,14398,14423,14428,14433,14438,
                                                                                                  14501,14519,14537,14555           
 BRES                       Scalar 14345    R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 14364                                16                                                          
 C01                        Local  14483    R(4)            4           scalar                    14483,14486,14487                 
 C02                        Local  14484    R(4)            4           scalar                    14484,14486,14487                 
 C12                        Local  14485    R(4)            4           scalar                    14485,14486,14487                 
 CAT                        Scalar 14321    R(4)            4     1     255      COM              14421,14422                       
 CC                         Local  14314    R(4)            4     1     4                         14368,14451                       
 CCC                        Local  14451    R(4)            4           scalar                    14451,14459,14468,14483,14484,1448
                                                                                                  5                                 
 COR                        Local  14370    R(4)            4           scalar                    14459,14468,14483,14484,14485     
 CQCPC                      Scalar 14362    R(4)            4           scalar   COM                                                
 ERROR                      Scalar 14345    L(4)            4     1     999      COM                                                
 GAMA                       Local  14368    R(4)            4           scalar                    14368,14372                       
 GESPS                      Scalar 14322    R(4)            4     1     999      COM                                                
 H1                         Local  14459    R(4)            4           scalar                    14459,14460,14468,14469,14486,1448
                                                                                                  8                                 
 H2                         Local  14487    R(4)            4           scalar                    14487,14488                       
 HOIRES                     Scalar 14358    R(4)            4     2     84       COM                                                
 HRDR                       Scalar 14322    R(4)            4     1     255      COM                                                
 HSCRES                     Scalar 14358    R(4)            4     1     21       COM                                                
 HYD                        Scalar 14330    R(4)            4     1     21       COM                                                

Page 489         Source Listing                  VOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HYDM                       Scalar 14345    R(4)            4     2     20979    COM                                                
 HYDN                       Scalar 14330    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 14330    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 14330    R(4)            4     1     21       COM                                                
 I                          Local  14381    I(4)            4           scalar                    14381,14382,14383,14384,14385,1438
                                                                                                  7,14388,14390,14391,14392,14393,14
                                                                                                  395,14396,14397,14398,14408,14409,
                                                                                                  14499,14502,14504,14506,14507,1451
                                                                                                  7,14520,14522,14524,14525,14535,14
                                                                                                  538,14540,14542,14543,14553,14555,
                                                                                                  14556,14558,14560,14561           
 IHSC                       Scalar 14331    I(4)            4     2     1020     COM                                                
 II                         Local  14500    I(4)            4           scalar                    14500,14510,14511,14512,14518,1452
                                                                                                  8,14529,14530,14536,14546,14547,14
                                                                                                  548,14554,14564,14565             
 IL                         Local  14315    I(4)            4     2     1020                      14409,14426,14431,14436,14441,1445
                                                                                                  6,14457,14458,14465,14466,14467,14
                                                                                                  478,14479,14480,14481,14482,14499,
                                                                                                  14500,14503,14504,14506,14512,1451
                                                                                                  7,14518,14521,14522,14524,14530,14
                                                                                                  535,14536,14539,14540,14542,14548,
                                                                                                  14553,14554,14557,14558,14560     
 IMISS                      Scalar 14364    I(4)            4           scalar   COM                                                
 IND                        Scalar 14321    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 14362    I(4)            4           scalar   COM                                                
 IS                         Scalar 14363    I(4)            4           scalar   COM              14511,14512,14529,14530,14547,1454
                                                                                                  8,14565                           
 ISC                        Scalar 14362    I(4)            4           scalar   COM                                                
 ITIME                      Dummy  14309    I(4)            4           scalar   ARG,INOUT        14394,14505,14523,14541,14559     
 IV                         Local  14450    I(4)            4           scalar                    14450,14451,14456,14457,14458,1446
                                                                                                  0,14465,14466,14467,14469,14476,14
                                                                                                  477,14478,14479,14480,14481,14482,
                                                                                                  14488                             
 J                          Local  14386    I(4)            4           scalar                    14386,14387,14388,14407,14409     
 L                          Local  14416    I(4)            4           scalar                    14416,14421,14422,14423,14425,1442
                                                                                                  6,14428,14430,14431,14433,14435,14
                                                                                                  436,14438,14440,14441,14477,14478,
                                                                                                  14479,14480,14481,14482,14488,1449
                                                                                                  8,14499,14500,14501,14503,14504,14
                                                                                                  506,14511,14512,14516,14517,14518,
                                                                                                  14519,14521,14522,14524,14529,1453
                                                                                                  0,14534,14535,14536,14537,14539,14
                                                                                                  540,14542,14547,14548,14552,14553,
                                                                                                  14554,14555,14557,14558,14560,1456
                                                                                                  5                                 
 LEV                        Local  14315    I(4)            4     1     4                         14445,14446,14447,14448,14465,1446
                                                                                                  6,14467,14469,14476,14477,14498,14
                                                                                                  516,14534,14552                   
 LEVTYP                     Scalar 14321    I(4)            4     1     255      COM                                                
 LIMS                       Common 14358                                1776                                                        
 LMAND                      Scalar 14362    I(4)            4     1     22       COM                                                
 LQ                         Local  14415    I(4)            4           scalar                    14415,14439,14440,14441,14448     
 LSFC                       Scalar 14362    I(4)            4           scalar   COM                                                
 LST                        Scalar 14322    I(4)            4     1     255      COM                                                
 LT                         Local  14413    I(4)            4           scalar                    14413,14429,14430,14431,14446     

Page 490         Source Listing                  VOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LTD                        Local  14414    I(4)            4           scalar                    14414,14434,14435,14436,14447     
 LZ                         Local  14412    I(4)            4           scalar                    14412,14424,14425,14426,14445     
 MAND                       Scalar 14361    I(4)            4           scalar   COM                                                
 MANLEV                     Func   14500    I(4)            4           scalar                    14500,14518,14536,14554           
 MANRES                     Common 14334                                2949048                                                     
 MAX                        Func   14507                                scalar                    14507,14525,14543,14561           
 MIN1                       Func   14504                                scalar                    14504,14522,14540,14558           
 NB                         Scalar 14351    I(4)            4           scalar   COM                                                
 NBAS                       Scalar 14332    I(4)            4           scalar   COM                                                
 NH                         Scalar 14347    I(4)            4     2     147      COM                                                
 NHLIM                      Scalar 14360    I(4)            4           scalar   COM                                                
 NHY                        Scalar 14350    I(4)            4     1     21       COM                                                
 NHYD                       Scalar 14330    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 14332    I(4)            4     1     21       COM                                                
 NI                         Scalar 14348    I(4)            4     2     147      COM                                                
 NLEV                       Scalar 14361    I(4)            4           scalar   COM              14401,14416                       
 NMANLV                     Func   14499    I(4)            4           scalar                    14499,14517,14535,14553           
 NOBS                       Scalar 14361    I(4)            4           scalar   COM                                                
 NQHM                       Scalar 14342    I(4)            4     2     20979    COM                                                
 NQI                        Scalar 14326    I(4)            4     1     255      COM                                                
 NQV                        Scalar 14328    I(4)            4     1     255      COM              14393,14558                       
 NST                        Param  14310    I(4)            4           scalar                    14322,14331,14334,14335,14336,1433
                                                                                                  7,14338,14339,14340,14341,14342,14
                                                                                                  343,14344,14345                   
 NT                         Scalar 14349    I(4)            4     2     84       COM                                                
 NTDHM                      Scalar 14342    I(4)            4     2     20979    COM                                                
 NTDI                       Scalar 14326    I(4)            4     1     255      COM                                                
 NTDIM                      Scalar 14337    I(4)            4     2     20979    COM                                                
 NTDV                       Scalar 14328    I(4)            4     1     255      COM              14392,14540                       
 NTHM                       Scalar 14340    I(4)            4     2     20979    COM                                                
 NTI                        Scalar 14326    I(4)            4     1     255      COM                                                
 NTIM                       Scalar 14337    I(4)            4     2     20979    COM                                                
 NTL                        Scalar 14328    I(4)            4     1     255      COM                                                
 NTV                        Scalar 14328    I(4)            4     1     255      COM              14391,14522                       
 NV                         Scalar 14346    I(4)            4     2     147      COM                                                
 NZHM                       Scalar 14340    I(4)            4     2     20979    COM                                                
 NZI                        Scalar 14326    I(4)            4     1     255      COM                                                
 NZIM                       Scalar 14337    I(4)            4     2     20979    COM                                                
 NZV                        Scalar 14328    I(4)            4     1     255      COM              14390,14504                       
 PARAMS                     Common 14361                                148                                                         
 PFC                        Scalar 14316    R(4)            4     1     255      COM                                                
 PGAM                       Local  14372    R(4)            4           scalar                    14372,14373,14459,14468,14486,1448
                                                                                                  7                                 
 PGAMS                      Local  14373    R(4)            4           scalar                    14373,14486,14487                 
 PI                         Scalar 14324    R(4)            4     1     255      COM                                                
 PIS                        Scalar 14345    R(4)            4     1     999      COM                                                
 POB                        Scalar 14316    R(4)            4     1     255      COM              14457,14458,14466,14467,14480,1448
                                                                                                  1,14482,14499,14500,14517,14518,14
                                                                                                  535,14536,14553,14554             
 POW                        Local  14370    R(4)            4           scalar                    14368,14370                       
 PQM                        Scalar 14316    R(4)            4     1     255      COM                                                
 PR0                        Local  14480    R(4)            4           scalar                    14480,14483,14484                 
 PR1                        Local  14457    R(4)            4           scalar                    14457,14459,14466,14468,14481,1448
                                                                                                  3,14485                           
 PR2                        Local  14458    R(4)            4           scalar                    14458,14459,14467,14468,14482,1448

Page 491         Source Listing                  VOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  4,14485                           
 PRC                        Scalar 14316    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 14362    L(4)            4           scalar   COM                                                
 PS                         Scalar 14322    R(4)            4     1     999      COM                                                
 PSINC                      Scalar 14331    R(4)            4           scalar   COM                                                
 QFC                        Scalar 14320    R(4)            4     1     255      COM                                                
 QG                         Scalar 14344    L(4)            4     2     20979    COM                                                
 QHM                        Scalar 14335    R(4)            4     2     20979    COM                                                
 QI                         Scalar 14324    R(4)            4     1     255      COM              14438,14440                       
 QIM                        Scalar 14334    R(4)            4     2     20979    COM                                                
 QOB                        Scalar 14320    R(4)            4     1     255      COM                                                
 QQM                        Scalar 14320    R(4)            4     1     255      COM                                                
 QRC                        Scalar 14320    R(4)            4     1     255      COM                                                
 QV                         Scalar 14325    R(4)            4     1     255      COM              14385,14557                       
 QVM                        Scalar 14336    R(4)            4     2     20979    COM              14565                             
 RADPC                      Scalar 14361    R(4)            4           scalar   COM                                                
 RCATT                      Local  14367    L(4)            4           scalar                    14419,14422,14428,14433,14438     
 RCATZ                      Local  14367    L(4)            4           scalar                    14420,14421,14423                 
 RCP                        Local  14367    L(4)            4           scalar                                                      
 RCT                        Local  14367    L(4)            4           scalar                                                      
 RCZ                        Local  14367    L(4)            4           scalar                                                      
 RESID                      Common 14324                                41312                                                       
 SKB                        Scalar 14357    R(4)            4           scalar   COM                                                
 SKH                        Scalar 14353    R(4)            4     2     147      COM                                                
 SKHY                       Scalar 14356    R(4)            4     1     21       COM                                                
 SKI                        Scalar 14354    R(4)            4     2     147      COM                                                
 SKT                        Scalar 14355    R(4)            4     2     84       COM                                                
 SKV                        Scalar 14352    R(4)            4     2     147      COM                                                
 START                      Local  14366    L(4)            4           scalar                    14369,14375,14379                 
 STATS                      Common 14346                                10940                                                       
 STDB                       Scalar 14351    R(4)            4           scalar   COM                                                
 STDH                       Scalar 14347    R(4)            4     2     147      COM                                                
 STDHY                      Scalar 14350    R(4)            4     1     21       COM                                                
 STDI                       Scalar 14348    R(4)            4     2     147      COM                                                
 STDT                       Scalar 14349    R(4)            4     2     84       COM                                                
 STDV                       Scalar 14346    R(4)            4     2     147      COM              14507,14525,14543,14561           
 STN                        Common 14363                                4                                                           
 TCLIM                      Scalar 14360    R(4)            4           scalar   COM                                                
 TDFC                       Scalar 14319    R(4)            4     1     255      COM                                                
 TDG                        Scalar 14344    L(4)            4     2     20979    COM                                                
 TDHM                       Scalar 14335    R(4)            4     2     20979    COM                                                
 TDI                        Scalar 14324    R(4)            4     1     255      COM              14433,14435                       
 TDIM                       Scalar 14334    R(4)            4     2     20979    COM                                                
 TDO                        Scalar 14319    R(4)            4     1     255      COM                                                
 TDV                        Scalar 14325    R(4)            4     1     255      COM              14384,14539                       
 TDVM                       Scalar 14336    R(4)            4     2     20979    COM              14547                             
 TFACT                      Scalar 14359    R(4)            4     2     84       COM                                                
 TFC                        Scalar 14318    R(4)            4     1     255      COM                                                
 TG                         Scalar 14344    L(4)            4     2     20979    COM                                                
 THM                        Scalar 14335    R(4)            4     2     20979    COM                                                
 TI                         Scalar 14324    R(4)            4     1     255      COM              14428,14430                       
 TIM                        Scalar 14334    R(4)            4     2     20979    COM                                                
 TL                         Scalar 14325    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 14331    R(4)            4     1     255      COM                                                
 TMPSTD                     Scalar 14359    R(4)            4     2     84       COM                                                

Page 492         Source Listing                  VOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TOB                        Scalar 14318    R(4)            4     1     255      COM                                                
 TQM                        Scalar 14318    R(4)            4     1     255      COM                                                
 TRC                        Scalar 14318    R(4)            4     1     255      COM                                                
 TT                         Scalar 14362    R(4)            4           scalar   COM                                                
 TV                         Scalar 14325    R(4)            4     1     255      COM              14383,14521                       
 TVM                        Scalar 14336    R(4)            4     2     20979    COM              14529                             
 TVO                        Scalar 14319    R(4)            4     1     255      COM                                                
 VI                         Local  14314    R(4)            4     2     1020                      14387,14425,14430,14435,14440,1446
                                                                                                  0,14469,14488,14501,14519,14537,14
                                                                                                  555                               
 VOI                        Subr   14309                                                                                            
 VOIRES                     Scalar 14359    R(4)            4     2     84       COM              14504,14507,14522,14525,14540,1454
                                                                                                  3,14558,14561                     
 VR                         Local  14314    R(4)            4     2     1020                      14388,14460,14469,14488,14503,1450
                                                                                                  4,14506,14511,14521,14522,14524,14
                                                                                                  529,14539,14540,14542,14547,14557,
                                                                                                  14558,14560,14565                 
 VTPPC                      Scalar 14361    R(4)            4           scalar   COM                                                
 XDR                        Scalar 14323    R(4)            4     1     255      COM                                                
 XINC                       Scalar 14358    R(4)            4     2     84       COM                                                
 XKB                        Scalar 14357    R(4)            4           scalar   COM                                                
 XKH                        Scalar 14353    R(4)            4     2     147      COM                                                
 XKHY                       Scalar 14356    R(4)            4     1     21       COM                                                
 XKI                        Scalar 14354    R(4)            4     2     147      COM                                                
 XKT                        Scalar 14355    R(4)            4     2     84       COM                                                
 XKV                        Scalar 14352    R(4)            4     2     147      COM                                                
 XMA                        Scalar 14361    R(4)            4           scalar   COM                                                
 XMI                        Scalar 14361    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 14364    R(4)            4           scalar   COM                                                
 XQHM                       Scalar 14343    R(4)            4     2     20979    COM                                                
 XQI                        Scalar 14327    R(4)            4     1     255      COM                                                
 XQIM                       Scalar 14339    R(4)            4     2     20979    COM                                                
 XQV                        Scalar 14329    R(4)            4     1     255      COM              14398,14560                       
 XTDH                       Scalar 14333    R(4)            4     1     255      COM                                                
 XTDHM                      Scalar 14342    R(4)            4     2     20979    COM                                                
 XTDI                       Scalar 14327    R(4)            4     1     255      COM                                                
 XTDIM                      Scalar 14338    R(4)            4     2     20979    COM                                                
 XTDV                       Scalar 14329    R(4)            4     1     255      COM              14397,14542,14548                 
 XTDVM                      Scalar 14341    R(4)            4     2     20979    COM              14378,14548                       
 XTH                        Scalar 14332    R(4)            4     1     255      COM                                                
 XTHM                       Scalar 14341    R(4)            4     2     20979    COM                                                
 XTI                        Scalar 14327    R(4)            4     1     255      COM                                                
 XTIM                       Scalar 14338    R(4)            4     2     20979    COM                                                
 XTV                        Scalar 14329    R(4)            4     1     255      COM              14396,14524,14530                 
 XTVM                       Scalar 14339    R(4)            4     2     20979    COM              14377,14530                       
 XZH                        Scalar 14332    R(4)            4     1     255      COM                                                
 XZHM                       Scalar 14340    R(4)            4     2     20979    COM                                                
 XZI                        Scalar 14327    R(4)            4     1     255      COM                                                
 XZIM                       Scalar 14338    R(4)            4     2     20979    COM                                                
 XZV                        Scalar 14329    R(4)            4     1     255      COM              14395,14506,14512                 
 XZVM                       Scalar 14339    R(4)            4     2     20979    COM              14376,14512                       
 YDR                        Scalar 14323    R(4)            4     1     255      COM                                                
 YMA                        Scalar 14361    R(4)            4           scalar   COM                                                
 YMI                        Scalar 14361    R(4)            4           scalar   COM                                                
 ZCLIM                      Scalar 14360    R(4)            4           scalar   COM                                                

Page 493         Source Listing                  VOI
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZD                         Scalar 14332    R(4)            4     1     255      COM                                                
 ZFC                        Scalar 14317    R(4)            4     1     255      COM                                                
 ZG                         Scalar 14344    L(4)            4     2     20979    COM                                                
 ZHM                        Scalar 14335    R(4)            4     2     20979    COM                                                
 ZI                         Scalar 14324    R(4)            4     1     255      COM              14423,14425                       
 ZIM                        Scalar 14334    R(4)            4     2     20979    COM                                                
 ZOB                        Scalar 14317    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 14317    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 14317    R(4)            4     1     255      COM                                                
 ZV                         Scalar 14325    R(4)            4     1     255      COM              14382,14503                       
 ZVM                        Scalar 14336    R(4)            4     2     20979    COM              14511                             

Page 494         Source Listing                  VOI
2017-04-18 11:07                                 cqcbufr.f

  14572 
  14573 C******************************************************************
  14574 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14575 C
  14576 C SUBPROGRAM: VSOLVE
  14577 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
  14578 C
  14579 C ABSTRACT: CHOLESKY TYPE SOLUTION FOR ARRAYS OF POSITIVE DEFINITE
  14580 C   SYMMETRIC MATRIXES.
  14581 C
  14582 C PROGRAM HISTORY LOG:
  14583 C 1990-11-06  J. Woollen  Original author.
  14584 C
  14585 C USAGE:    CALL VSOLVE (A,B,NDIM,BAD,NFT,NS,MAXDIM)
  14586 C   INPUT ARGUMENTS:
  14587 C     A          - ARRAY OF SYMMETRIC MATRIXES
  14588 C     B          - ARRAY OF RIGHT HAND SIDE VECTORS
  14589 C     NDIM       - ARRAY OF MATRIX RANKS
  14590 C     BAD        - BAD MATRIX INDICATOR
  14591 C     NFT        - NUMBER OF RIGHT HAND SIDES PER MATRIX
  14592 C     NS         - NUMBER OF MATRIXES TO SOLVE
  14593 C     MAXDIM     - LARGEST RANK MATRIX IN STACK
  14594 C
  14595 C   OUTPUT ARGUMENTS:
  14596 C     B          - CONTAINS THE SOLUTIONS UPON RETURN
  14597 C
  14598 C REMARKS: TRIANGULAR REPRESENTATION LISTS ELEMENTS TOWARDS THE
  14599 C   DIAGONAL. ALGORITHM FROM H.CARUS.
  14600 C
  14601 C ATTRIBUTES:
  14602 C   LANGUAGE: FORTRAN 90
  14603 C   MACHINE:  NCEP WCOSS
  14604 C
  14605 C$$$
  14606 C-----------------------------------------------------------------------
  14607 
  14608       SUBROUTINE VSOLVE (A,B,NDIM,BAD,NFT,NS,MAXDIM)
  14609 
  14610 
  14611       DIMENSION A(1000,10),B(1000,4,1),NDIM(1000),BAD(1000)
  14612       LOGICAL BAD
  14613 
  14614       DIMENSION T(1000)
  14615 
  14616       DATA CNUM/1.E-15/
  14617 
  14618 C----------------------------------------------------------------------
  14619       IX (I,J) = I*(I-1)/2 + J
  14620 C----------------------------------------------------------------------
  14621 
  14622       N = MAXDIM
  14623 
  14624       DO M=1,NS
  14625         BAD(M) = .FALSE.
  14626       ENDDO
  14627 
  14628 C  DECOMPOSE THE MATRIXES

Page 495         Source Listing                  VSOLVE
2017-04-18 11:07                                 cqcbufr.f

  14629 C  ----------------------
  14630 
  14631       DO I=1,N
  14632         DO J=1,I
  14633 
  14634           DO M=1,NS
  14635             T(M) = A(M,IX(I,J))
  14636           ENDDO
  14637 
  14638           DO K=1,J-1
  14639             DO M=1,NS
  14640               T(M) = T(M) - A(M,IX(I,K)) * A(M,IX(J,K))
  14641             ENDDO
  14642           ENDDO
  14643 
  14644           IF(I.GT.J) THEN
  14645             DO M=1,NS
  14646               A(M,IX(I,J)) = T(M) * A(M,IX(J,J))
  14647             ENDDO
  14648           ELSE
  14649             DO M=1,NS
  14650               IF(T(M).LT.CNUM .AND. NDIM(M).GE.I) BAD(M) = .TRUE.
  14651               IF(T(M).LE.0) T(M) = 1.
  14652             ENDDO
  14653 
  14654             DO M=1,NS
  14655               A(M,IX(I,I)) = 1./SQRT(T(M))
  14656             ENDDO
  14657           ENDIF
  14658 
  14659         ENDDO
  14660       ENDDO
  14661 
  14662 C  SOLVE FOR ALL RIGHT HAND SIDES
  14663 C  ------------------------------
  14664 
  14665       DO NF=1,NFT
  14666 
  14667 C  FORWARD SUBSTITUTION
  14668 C  --------------------
  14669 
  14670         DO I=1,N
  14671           DO M=1,NS
  14672             T(M) = B(M,I,NF)
  14673           ENDDO
  14674           DO J=1,I-1
  14675             DO M=1,NS
  14676               T(M) = T(M) - A(M,IX(I,J)) * B(M,J,NF)
  14677             ENDDO
  14678           ENDDO
  14679           DO M=1,NS
  14680             B(M,I,NF) = T(M) * A(M,IX(I,I))
  14681           ENDDO
  14682         ENDDO
  14683 
  14684 C  BACKWARD SUBSTITUTION
  14685 C  ---------------------

Page 496         Source Listing                  VSOLVE
2017-04-18 11:07                                 cqcbufr.f

  14686 
  14687         DO I=N,1,-1
  14688           DO M=1,NS
  14689             T(M) = B(M,I,NF)
  14690           ENDDO
  14691           IF(I.NE.N) THEN
  14692             DO J=I+1,N
  14693               DO M=1,NS
  14694                 T(M) = T(M) - A(M,IX(J,I)) * B(M,J,NF)
  14695               ENDDO
  14696             ENDDO
  14697           ENDIF
  14698           DO M=1,NS
  14699             B(M,I,NF) = T(M) * A(M,IX(I,I))
  14700           ENDDO
  14701         ENDDO
  14702 
  14703       ENDDO
  14704 
  14705       RETURN
  14706       END


ENTRY POINTS

  Name               
                     
 vsolve_             

Page 497         Source Listing                  VSOLVE
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  14608    R(4)            4     2     10000    ARG,INOUT        14635,14640,14646,14655,14676,1468
                                                                                                  0,14694,14699                     
 B                          Dummy  14608    R(4)            4     3     4000     ARG,INOUT        14672,14676,14680,14689,14694,1469
                                                                                                  9                                 
 BAD                        Dummy  14608    L(4)            4     1     1000     ARG,INOUT        14625,14650                       
 CNUM                       Local  14616    R(4)            4           scalar                    14616,14650                       
 I                          Local  14631    I(4)            4           scalar                    14631,14632,14635,14640,14644,1464
                                                                                                  6,14650,14655,14670,14672,14674,14
                                                                                                  676,14680,14687,14689,14691,14692,
                                                                                                  14694,14699                       
 IX                         Local  14619    I(4)            4           scalar                    14635,14640,14646,14655,14676,1468
                                                                                                  0,14694,14699                     
 J                          Local  14632    I(4)            4           scalar                    14632,14635,14638,14640,14644,1464
                                                                                                  6,14674,14676,14692,14694         
 K                          Local  14638    I(4)            4           scalar                    14638,14640                       
 M                          Local  14624    I(4)            4           scalar                    14624,14625,14634,14635,14639,1464
                                                                                                  0,14645,14646,14649,14650,14651,14
                                                                                                  654,14655,14671,14672,14675,14676,
                                                                                                  14679,14680,14688,14689,14693,1469
                                                                                                  4,14698,14699                     
 MAXDIM                     Dummy  14608    I(4)            4           scalar   ARG,INOUT        14622                             
 N                          Local  14622    I(4)            4           scalar                    14622,14631,14670,14687,14691,1469
                                                                                                  2                                 
 NDIM                       Dummy  14608    I(4)            4     1     1000     ARG,INOUT        14650                             
 NF                         Local  14665    I(4)            4           scalar                    14665,14672,14676,14680,14689,1469
                                                                                                  4,14699                           
 NFT                        Dummy  14608    I(4)            4           scalar   ARG,INOUT        14665                             
 NS                         Dummy  14608    I(4)            4           scalar   ARG,INOUT        14624,14634,14639,14645,14649,1465
                                                                                                  4,14671,14675,14679,14688,14693,14
                                                                                                  698                               
 SQRT                       Func   14655                                scalar                    14655                             
 T                          Local  14614    R(4)            4     1     1000                      14635,14640,14646,14650,14651,1465
                                                                                                  5,14672,14676,14680,14689,14694,14
                                                                                                  699                               
 VSOLVE                     Subr   14608                                                                                            

Page 498         Source Listing                  VSOLVE
2017-04-18 11:07                                 cqcbufr.f

  14707 
  14708 C****************************************************************
  14709 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14710 C
  14711 C SUBPROGRAM:    VTPENV      CALCULATE VIRTUAL TEMPERATURE
  14712 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2007-09-14
  14713 C
  14714 C ABSTRACT: CREATES VIRTUAL TEMPERATURE EVENTS.  THIS CONSISTS OF
  14715 C   FIRST RE-CALCULATING THE SPECIFIC HUMIDITY FROM THE FINAL UPDATED
  14716 C   DEWPOINT TEMPERATURE (CALCULATED FROM THE FINAL UPDATED SENSIBLE
  14717 C   TEMPERATURE AND THE ORIGINAL OBSERVED DEWPOINT DEPRESSION) AND
  14718 C   PRESSURE, FOLLOWED BY THE CALCULATION OF VIRTUAL TEMPERATURE FROM
  14719 C   THE JUST-CALCULATED SPECIFIC HUMIDITY AND THE FINAL UPDATED
  14720 C   SENSIBLE TEMPERATURE.  THE RE-CALCULATED SPECIFIC HUMIDITY IS
  14721 C   THEN ENCODED AS A STACKED EVENT TO BE LATER WRITTEN INTO THE
  14722 C   PREPBUFR FILE (UNDER PROGRAM "VIRTMP", REASON CODE 1).  IF THE
  14723 C   NAMELIST SWITCH DOVTMP IS TRUE, THEN THE JUST-CALCULATED VIRTUAL
  14724 C   TEMPERATURE IS THEN ALSO ENCODED AS A STACKED EVENT TO BE LATER
  14725 C   WRITTEN INTO THE PREPBUFR FILE (UNDER PROGRAM "VIRTMP", REASON
  14726 C   CODE EITHER 1 OR 7).  THERE ARE CERTAIN CASES WHEN THE VIRTUAL
  14727 C   TEMPERATURE IS NOT CALUCLATED (SEE COMMENTS IN SUBROUTINE).
  14728 C
  14729 C PROGRAM HISTORY LOG:
  14730 C 1994-MM-DD  J. Woollen  Original author.
  14731 C 1997-08-27  W. Collins  Add direct calculation from q.  Add DOVTMP
  14732 C     switch.
  14733 C 1999-12-09  W. Collins  Change VTPEVN so that Tv (virtual
  14734 C     temperature) is calculated, even when the moisture quality is >
  14735 C     3, except when the moisture exceeds 'Earth' limits.
  14736 C 2001-02-28  W. Collins  Correct error of setting dew-point
  14737 C     temperature to missing in FULVAL. Never flag T (Tv) bad as the
  14738 C     result of flagging q bad. Make more efficient so that auxiliary
  14739 C     level computations are ommitted when not needed.
  14740 C 2001-04-27  D. Keyser   Streamlined code. Turned q event processing
  14741 C     back on (even when DOVTMP=F). When q bad but passes sanity check,
  14742 C     Tv now calculated in all cases but given a suspect q.m. if below
  14743 C     700 mb and original TQM not 0 or > 3 (this was original intention
  14744 C     of 1999-12-09 change which actually skipped Tv processing in all
  14745 C     cases when q was bad).
  14746 C 2004-04-21  D. Keyser   For cases when DOVTMP=T, no longer calculates
  14747 C     Tv on pressure levels above the tropopause because reported Tdd
  14748 C     values at high levels are often inaccurate and unrealistic 0.4 to
  14749 C     1.0 increases in Tv vs. T can occur (esp. above 10 mb and at
  14750 C     U.S. sites) (q is still updated on these levels, however), if the
  14751 C     reported tropopause level is below 500 mb it is not considered
  14752 C     to be the tropopause for this test, also if no valid tropopause
  14753 C     level is found by the time 80 mb is reached, all levels above
  14754 C     this are considered to be above the tropopause for this test
  14755 C     {thanks to Christopher Redder (NASA/GSFC) for discovering this
  14756 C     problem}
  14757 C 2007-09-14  D. Keyser -- Q.M. 3 is now assigned to calculated virt.
  14758 C     temps only if the moisture Q.M. is truly bad (i.e. > 3 but not 9
  14759 C     or 15) (and, as before, orig. TQM is 1 or 2 and POB is below 700
  14760 C     mb) - before, TQM set to 3 when QQM was 9 or 15 and all other
  14761 C     conditions met
  14762 C                                                                     
  14763 C USAGE:    CALL VTPEVN(DOVTMP)

Page 499         Source Listing                  VSOLVE
2017-04-18 11:07                                 cqcbufr.f

  14764 C
  14765 C INPUT ARGUMENTS:
  14766 C           DOVTMP - LOGICAL ARGUMENT, TRUE IF VIRTUAL TEMPERATURE IS
  14767 C                    CALCULATED
  14768 C                                                                     
  14769 C   OUTPUT FILES:
  14770 C     UNIT 60  - PRINT FILE, DETAILS OF DECISIONS
  14771 C
  14772 C REMARKS: NONE.
  14773 C
  14774 C ATTRIBUTES:                                                         
  14775 C   LANGUAGE: FORTRAN 90
  14776 C   MACHINE:  NCEP WCOSS
  14777 C         
  14778 C$$$     
  14779       SUBROUTINE VTPEVN(DOVTMP)
  14780       PARAMETER (NST=999)
  14781 
  14782       REAL(8) BMISS
  14783 
  14784       CHARACTER*8      SID
  14785       CHARACTER*40     TEVN, QEVN
  14786       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  14787      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  14788      &                 NEV, ISF(NST), NLVM, NLVW
  14789       COMMON /STN/     IS
  14790       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  14791      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  14792      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  14793      &                 TDO(255), TDFC(255),TVO(255),
  14794      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  14795      &                 CAT(255), IND(255), LEVTYP(255),
  14796      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  14797      &                 YDR(255), XDR(255)
  14798       COMMON /EVNSND/ PO (255),TO (255),ZO (255),CA (255),
  14799      &                PQ (255),TQ (255),ZQ (255),INP(255),
  14800      &                PR (255),TR (255),ZR (255),INZ(255),
  14801      &                QO (255),QQ (255),QR (255),INT(255),
  14802      &                TDE(255),TDQ(255),TDR(255),INQ(255),
  14803      &                UO(255), VO(255), SPO(255), DIRO(255),
  14804      &                WQ(255), WR(255)
  14805       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  14806      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  14807       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
  14808       COMMON /TESTS/   TEST
  14809       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  14810 
  14811       LOGICAL          TEST, DOVTMP, PRNT, TROP
  14812 
  14813       DATA TEVN   /'TOB TQM TPC TRC                         '/
  14814       DATA QEVN   /'QOB QQM QPC QRC                         '/
  14815 
  14816 C-----------------------------------------------------------------------
  14817 C FCNS BELOW CONVERT TEMP/TD (K) & PRESS (MB) INTO SAT./ SPEC. HUM.(G/G)
  14818 C-----------------------------------------------------------------------
  14819       ES(T) = 6.1078*EXP((17.269*(T - 273.15))/(T - 273.15 + 237.3))
  14820       QS(T,P) = (0.622*ES(T))/(P-0.378*ES(T))

Page 500         Source Listing                  VTPEVN
2017-04-18 11:07                                 cqcbufr.f

  14821 C-----------------------------------------------------------------------
  14822 
  14823 C  CLEAR TEMPERATURE AND Q EVENTS
  14824 C  ------------------------------
  14825 
  14826       TO   = BMISS
  14827       TQ   = BMISS
  14828       TR   = BMISS
  14829       QO   = BMISS
  14830       QQ   = BMISS
  14831       QR   = BMISS
  14832       INT  = BMISS
  14833       INQ  = BMISS
  14834       IEVT = 0
  14835       IEVQ = 0
  14836       TROP = .FALSE.
  14837 
  14838 C  COMPUTE VIRTUAL TEMPERATURES AND SPECIFIC HUMIDITIES USING FINAL
  14839 C   UPDATED TEMPERATURE AND ORIGINAL OBSERVED DEWPOINT DEPRESSION
  14840 C  ----------------------------------------------------------------
  14841 
  14842       DO L=1,NLV
  14843          IF(POB(L).LT.BMISS .AND. TOB(L).LT.BMISS
  14844      $                      .AND. TDO(L).LT.BMISS) THEN
  14845             TD = TOB(L)-TDO(L) ! TD is dewpt (C), TDO is depression
  14846             IF(QQM(L).GT.3) THEN
  14847 C  Don't update q or calculate Tv if bad moisture obs fails sanity check
  14848                IF(TD.LT.-103.15 .OR. TD.GT.46.83 .OR. POB(L).LT.0.1 .OR.
  14849      $          POB(L).GT.1100.)  CYCLE
  14850             ENDIF
  14851             Q = QS(TD+273.15,POB(L))
  14852             QO(IEVQ+1) = Q*1E6
  14853             QQ(IEVQ+1) = QQM(L) ! Moist qm same as before for re-calc. q
  14854             QR(IEVQ+1) = 1      ! Re-calc. q gets unique reason code 1
  14855 C  Test this level to see if at or above trop (trop must be above
  14856 C   500 mb to pass test; if no trop level found assume it's at 80 mb)
  14857 C  Don't calculate Tv on this level if at or above trop (doesn't
  14858 C   affect q calculation)
  14859             TROP = ((CAT(L).EQ.5 .AND. POB(L).LT.500.) .OR.
  14860      $       POB(L).LT. 80. .OR. TROP)
  14861             IF(DOVTMP .AND. .NOT.TROP) THEN
  14862                TO(IEVT+1) = (TOB(L)+273.15) * (1.+.61*Q) - 273.15
  14863                IF((QQM(L).LT.4.OR.QQM(L).EQ.9.OR.QQM(L).EQ.15)
  14864      $          .OR. TQM(L).EQ.0 .OR. TQM(L).GT.3
  14865      $          .OR. POB(L).LE.700.) THEN
  14866                   TQ(IEVT+1) = TQM(L) ! Tv qm same as for T when q is ok
  14867                                       ! or q flagged by PREPRO (but not
  14868                                       ! bad)
  14869                   TR(IEVT+1) = 1      ! Tv gets unique reason code 1
  14870                ELSE
  14871                   TQ(IEVT+1) = 3 ! Tv qm susp for bad moist below 700 mb
  14872                   TR(IEVT+1) = 7 ! Tv gets unique reason code 7
  14873                ENDIF
  14874                INT(IEVT+1) = L
  14875                IEVT = IEVT+1
  14876             ENDIF
  14877             INQ(IEVQ+1) = L

Page 501         Source Listing                  VTPEVN
2017-04-18 11:07                                 cqcbufr.f

  14878             IEVQ = IEVQ+1
  14879          ENDIF
  14880       ENDDO
  14881 
  14882       IF(DOVTMP) THEN
  14883         CALL EVENT(NFOUT,TEVN,NLV,TO,TQ,TR,INT,IEVT,VTPPC)
  14884         WRITE(60,510) IEVT,SID(IS)
  14885   510   FORMAT(' VTPEVN--',I3,' TEMPERATURE EVENTS WRITTEN FOR:',A8)
  14886       ENDIF
  14887       CALL EVENT(NFOUT,QEVN,NLV,QO,QQ,QR,INQ,IEVQ,VTPPC)
  14888       WRITE(60,511) IEVQ,SID(IS)
  14889   511 FORMAT(' VTPEVN--',I3,' MOISTURE EVENTS WRITTEN FOR:',A8)
  14890 
  14891       RETURN
  14892       END


ENTRY POINTS

  Name               
                     
 vtpevn_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 510                        Label  14885                                                          14884                             
 511                        Label  14889                                                          14888                             
 ALLSND                     Common 14790                                34512                                                       
 BMISS                      Scalar 14782    R(8)            8           scalar   COM              14826,14827,14828,14829,14830,1483
                                                                                                  1,14832,14833,14843,14844         
 BUFRLIB_MISSING            Common 14809                                16                                                          
 CA                         Scalar 14798    R(4)            4     1     255      COM                                                
 CAT                        Scalar 14795    R(4)            4     1     255      COM              14859                             
 CQCPC                      Scalar 14806    R(4)            4           scalar   COM                                                
 DHR                        Scalar 14786    R(4)            4     1     999      COM                                                
 DIRO                       Scalar 14803    R(4)            4     1     255      COM                                                
 DOVTMP                     Dummy  14779    L(4)            4           scalar   ARG,INOUT        14861,14882                       
 ELV                        Scalar 14787    R(4)            4     1     999      COM                                                
 ES                         Local  14819    R(4)            4           scalar                    14820                             
 EVENT                      Subr   14883                                                          14883,14887                       
 EVNSND                     Common 14798                                26520                                                       
 EXP                        Func   14819                                scalar                    14819                             
 FILES                      Common 14807                                24                                                          
 GESPS                      Scalar 14796    R(4)            4     1     999      COM                                                
 HEADER                     Common 14786                                35980                                                       
 HRDR                       Scalar 14796    R(4)            4     1     255      COM                                                
 IEVQ                       Local  14835    I(4)            4           scalar                    14835,14852,14853,14854,14877,1487
                                                                                                  8,14887,14888                     
 IEVT                       Local  14834    I(4)            4           scalar                    14834,14862,14866,14869,14871,1487
                                                                                                  2,14874,14875,14883,14884         
 IMISS                      Scalar 14809    I(4)            4           scalar   COM                                                
 IND                        Scalar 14795    I(4)            4     1     255      COM                                                
 INP                        Scalar 14799    I(4)            4     1     255      COM                                                
 INQ                        Scalar 14802    I(4)            4     1     255      COM              14833,14877,14887                 

Page 502         Source Listing                  VTPEVN
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INT                        Scalar 14801    I(4)            4     1     255      COM              14832,14874,14883                 
 INZ                        Scalar 14800    I(4)            4     1     255      COM                                                
 IPEVT                      Scalar 14806    I(4)            4           scalar   COM                                                
 IS                         Scalar 14789    I(4)            4           scalar   COM              14884,14888                       
 ISC                        Scalar 14806    I(4)            4           scalar   COM                                                
 ISF                        Scalar 14788    I(4)            4     1     999      COM                                                
 ITP                        Scalar 14787    I(4)            4     1     999      COM                                                
 L                          Local  14842    I(4)            4           scalar                    14842,14843,14844,14845,14846,1484
                                                                                                  8,14849,14851,14853,14859,14860,14
                                                                                                  862,14863,14864,14865,14866,14874,
                                                                                                  14877                             
 LEVTYP                     Scalar 14795    I(4)            4     1     255      COM                                                
 LMAND                      Scalar 14806    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 14806    I(4)            4           scalar   COM                                                
 LST                        Scalar 14796    I(4)            4     1     255      COM                                                
 MAND                       Scalar 14805    I(4)            4           scalar   COM                                                
 NEV                        Scalar 14788    I(4)            4           scalar   COM                                                
 NFEVN                      Scalar 14807    I(4)            4           scalar   COM                                                
 NFIN                       Scalar 14807    I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 14807    I(4)            4           scalar   COM              14883,14887                       
 NFSGL                      Scalar 14807    I(4)            4           scalar   COM                                                
 NFSTN                      Scalar 14807    I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 14807    I(4)            4           scalar   COM                                                
 NLEV                       Scalar 14805    I(4)            4           scalar   COM                                                
 NLV                        Scalar 14787    I(4)            4           scalar   COM              14842,14883,14887                 
 NLVM                       Scalar 14788    I(4)            4           scalar   COM                                                
 NLVW                       Scalar 14788    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 14805    I(4)            4           scalar   COM                                                
 NST                        Param  14780    I(4)            4           scalar                    14786,14787,14788,14796           
 PARAMS                     Common 14805                                148                                                         
 PFC                        Scalar 14790    R(4)            4     1     255      COM                                                
 PO                         Scalar 14798    R(4)            4     1     255      COM                                                
 POB                        Scalar 14790    R(4)            4     1     255      COM              14843,14848,14849,14851,14859,1486
                                                                                                  0,14865                           
 PQ                         Scalar 14799    R(4)            4     1     255      COM                                                
 PQM                        Scalar 14790    R(4)            4     1     255      COM                                                
 PR                         Scalar 14800    R(4)            4     1     255      COM                                                
 PRC                        Scalar 14790    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 14806    L(4)            4           scalar   COM                                                
 PS                         Scalar 14796    R(4)            4     1     999      COM                                                
 Q                          Local  14851    R(4)            4           scalar                    14851,14852,14862                 
 QEVN                       Local  14785    CHAR            40          scalar                    14814,14887                       
 QFC                        Scalar 14794    R(4)            4     1     255      COM                                                
 QO                         Scalar 14801    R(4)            4     1     255      COM              14829,14852,14887                 
 QOB                        Scalar 14794    R(4)            4     1     255      COM                                                
 QQ                         Scalar 14801    R(4)            4     1     255      COM              14830,14853,14887                 
 QQM                        Scalar 14794    R(4)            4     1     255      COM              14846,14853,14863                 
 QR                         Scalar 14801    R(4)            4     1     255      COM              14831,14854,14887                 
 QRC                        Scalar 14794    R(4)            4     1     255      COM                                                
 QS                         Local  14820    R(4)            4           scalar                    14851                             
 RADPC                      Scalar 14805    R(4)            4           scalar   COM                                                
 SID                        Scalar 14784    CHAR            8     1     999      COM              14884,14888                       
 SPO                        Scalar 14803    R(4)            4     1     255      COM                                                
 SQN                        Scalar 14787    R(4)            4     1     999      COM                                                
 STN                        Common 14789                                4                                                           

Page 503         Source Listing                  VTPEVN
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TD                         Local  14845    R(4)            4           scalar                    14845,14848,14851                 
 TDE                        Scalar 14802    R(4)            4     1     255      COM                                                
 TDFC                       Scalar 14793    R(4)            4     1     255      COM                                                
 TDO                        Scalar 14793    R(4)            4     1     255      COM              14844,14845                       
 TDQ                        Scalar 14802    R(4)            4     1     255      COM                                                
 TDR                        Scalar 14802    R(4)            4     1     255      COM                                                
 TEST                       Scalar 14808    L(4)            4           scalar   COM                                                
 TESTS                      Common 14808                                4                                                           
 TEVN                       Local  14785    CHAR            40          scalar                    14813,14883                       
 TFC                        Scalar 14792    R(4)            4     1     255      COM                                                
 TO                         Scalar 14798    R(4)            4     1     255      COM              14826,14862,14883                 
 TOB                        Scalar 14792    R(4)            4     1     255      COM              14843,14845,14862                 
 TQ                         Scalar 14799    R(4)            4     1     255      COM              14827,14866,14871,14883           
 TQM                        Scalar 14792    R(4)            4     1     255      COM              14864,14866                       
 TR                         Scalar 14800    R(4)            4     1     255      COM              14828,14869,14872,14883           
 TRC                        Scalar 14792    R(4)            4     1     255      COM                                                
 TROP                       Local  14811    L(4)            4           scalar                    14836,14859,14860,14861           
 TT                         Scalar 14806    R(4)            4           scalar   COM                                                
 TVO                        Scalar 14793    R(4)            4     1     255      COM                                                
 UO                         Scalar 14803    R(4)            4     1     255      COM                                                
 VO                         Scalar 14803    R(4)            4     1     255      COM                                                
 VTPEVN                     Subr   14779                                                                                            
 VTPPC                      Scalar 14805    R(4)            4           scalar   COM              14883,14887                       
 WQ                         Scalar 14804    R(4)            4     1     255      COM                                                
 WR                         Scalar 14804    R(4)            4     1     255      COM                                                
 XDR                        Scalar 14797    R(4)            4     1     255      COM                                                
 XMA                        Scalar 14805    R(4)            4           scalar   COM                                                
 XMI                        Scalar 14805    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 14809    R(4)            4           scalar   COM                                                
 XOB                        Scalar 14786    R(4)            4     1     999      COM                                                
 YDR                        Scalar 14797    R(4)            4     1     255      COM                                                
 YMA                        Scalar 14805    R(4)            4           scalar   COM                                                
 YMI                        Scalar 14805    R(4)            4           scalar   COM                                                
 YOB                        Scalar 14786    R(4)            4     1     999      COM                                                
 ZFC                        Scalar 14791    R(4)            4     1     255      COM                                                
 ZO                         Scalar 14798    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 14791    R(4)            4     1     255      COM                                                
 ZQ                         Scalar 14799    R(4)            4     1     255      COM                                                
 ZQM                        Scalar 14791    R(4)            4     1     255      COM                                                
 ZR                         Scalar 14800    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 14791    R(4)            4     1     255      COM                                                

Page 504         Source Listing                  VTPEVN
2017-04-18 11:07                                 cqcbufr.f

  14893 
  14894 C**********************************************************************
  14895 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14896 C                .      .    .                                       .
  14897 C SUBPROGRAM:    WBLOCKS     WRITE OUTPUT FOR 'SINGLE' INPUT
  14898 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  14899 C
  14900 C ABSTRACT:  Write all data necessary for running single-station
  14901 C   version of code to unit NFSGL.
  14902 C
  14903 C PROGRAM HISTORY LOG:
  14904 C 1997-03-18  W. Collins  Original author.
  14905 C
  14906 C USAGE:    CALL WBLOCKS
  14907 C   OUTPUT FILES:
  14908 C     UNIT NFSGL - UNIT NUMBER OF FILE CONTAINING ALL DATA NECESSARY
  14909 C                  FOR SINGLE-STATION VERSION
  14910 C
  14911 C REMARKS: NONE.
  14912 C
  14913 C ATTRIBUTES:
  14914 C   LANGUAGE: FORTRAN 90
  14915 C   MACHINE:  NCEP WCOSS
  14916 C
  14917 C$$$
  14918 
  14919       SUBROUTINE WBLOCKS
  14920       PARAMETER (NST=999)
  14921 
  14922       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  14923      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  14924      &                 NEV, ISF(NST), NLVM, NLVW
  14925       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  14926      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  14927      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  14928      &                 TDO(255), TDFC(255),TVO(255),
  14929      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  14930      &                 CAT(255), IND(255), LEVTYP(255),
  14931      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  14932      &                 YDR(255), XDR(255)
  14933       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
  14934       COMMON /STN/     IS
  14935       COMMON /DATEX/   JDATE(5), CDATE
  14936       CHARACTER*8      SID
  14937       CHARACTER*10     CDATE
  14938       COMMON /MANSND/  ZM(21,NST), TM(21,NST), TDM(21), QM(21), MANDL,
  14939      &                 MANDF, ZFM(21), TFM(21), QFM(21), PM(21)
  14940       COMMON /TESTS/   TEST
  14941       LOGICAL          TEST
  14942       REAL             P(255,23)
  14943       INTEGER          IP(255,3)
  14944       DATA BMS /99999.99/, QBMS /9.999999/
  14945 
  14946 C  WRITE CONTENTS OF COMMON BLOCKS TO UNIT NFSGL, FORMATTED FOR EDITING
  14947 C  --------------------------------------------------------------------
  14948 
  14949       IF(TEST) WRITE(NFSGL,500) CDATE,(JDATE(I),I=1,4)

Page 505         Source Listing                  WBLOCKS
2017-04-18 11:07                                 cqcbufr.f

  14950   500 FORMAT(2X,A10,2X,4I2)
  14951       IF(TEST) WRITE(NFSGL,501) SID(IS), DHR(IS), XOB(IS), YOB(IS),
  14952      &                 ELV(IS), SQN(IS), ITP(IS), NLV,
  14953      &                 NEV, ISF(IS), NLVM, NLVW
  14954   501 FORMAT(2X,A8,4F10.2,F10.0,I10.3,5I10)
  14955       IF(TEST) WRITE(NFSGL,503) MANDL,MANDF,PS(IS),GESPS(IS)
  14956   503 FORMAT(2I10,2F10.2)
  14957 
  14958       IBMS = BMS
  14959       DO L=1,NLV
  14960         P(L,1) = AMIN1(POB(L),BMS)
  14961         P(L,2) = AMIN1(ZOB(L),BMS)
  14962         P(L,3) = AMIN1(TOB(L),BMS)
  14963         P(L,4) = AMIN1(TDO(L),BMS)
  14964         P(L,5) = AMIN1(QOB(L),QBMS)
  14965         P(L,6) = AMIN1(TVO(L),BMS)
  14966         P(L,7) = AMIN1(PFC(L),BMS)
  14967         P(L,8) = AMIN1(ZFC(L),BMS)
  14968         P(L,9) = AMIN1(TFC(L),BMS)
  14969         P(L,10) = AMIN1(TDFC(L),BMS)
  14970         P(L,11) = AMIN1(QFC(L),QBMS)
  14971         P(L,12) = AMIN1(PQM(L),BMS)
  14972         P(L,13) = AMIN1(ZQM(L),BMS)
  14973         P(L,14) = AMIN1(TQM(L),BMS)
  14974         P(L,15) = AMIN1(QQM(L),BMS)
  14975         P(L,16) = AMIN1(PRC(L),BMS)
  14976         P(L,17) = AMIN1(ZRC(L),BMS)
  14977         P(L,18) = AMIN1(TRC(L),BMS)
  14978         P(L,19) = AMIN1(QRC(L),BMS)
  14979         P(L,20) = AMIN1(CAT(L),BMS)
  14980         P(L,21) = AMIN1(HRDR(L),BMS)
  14981         P(L,22) = AMIN1(YDR(L),BMS)
  14982         P(L,23) = AMIN1(XDR(L),BMS)
  14983         IP(L,1) = MIN0(IND(L),IBMS)
  14984         IP(L,2) = MIN0(LEVTYP(L),IBMS)
  14985         IP(L,3) = MIN0(LST(L),IBMS)
  14986       ENDDO
  14987 
  14988       DO L=1,NLV
  14989         IF(TEST) WRITE(NFSGL,502) (P(L,I),I=1,23),(IP(L,J),J=1,3)
  14990       ENDDO
  14991   502 FORMAT(4F10.2,F10.6,5F10.2,F10.6,9F10.2,3F10.4,3I10)
  14992 
  14993       RETURN
  14994       END

Page 506         Source Listing                  WBLOCKS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 wblocks_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  14950                                                          14949                             
 501                        Label  14954                                                          14951                             
 502                        Label  14991                                                          14989                             
 503                        Label  14956                                                          14955                             
 ALLSND                     Common 14925                                34512                                                       
 AMIN1                      Func   14960                                scalar                    14960,14961,14962,14963,14964,1496
                                                                                                  5,14966,14967,14968,14969,14970,14
                                                                                                  971,14972,14973,14974,14975,14976,
                                                                                                  14977,14978,14979,14980,14981,1498
                                                                                                  2                                 
 BMS                        Local  14944    R(4)            4           scalar                    14944,14958,14960,14961,14962,1496
                                                                                                  3,14965,14966,14967,14968,14969,14
                                                                                                  971,14972,14973,14974,14975,14976,
                                                                                                  14977,14978,14979,14980,14981,1498
                                                                                                  2                                 
 CAT                        Scalar 14930    R(4)            4     1     255      COM              14979                             
 CDATE                      Scalar 14935    CHAR            10          scalar   COM              14949                             
 DATEX                      Common 14935                                30                                                          
 DHR                        Scalar 14922    R(4)            4     1     999      COM              14951                             
 ELV                        Scalar 14923    R(4)            4     1     999      COM              14952                             
 FILES                      Common 14933                                24                                                          
 GESPS                      Scalar 14931    R(4)            4     1     999      COM              14955                             
 HEADER                     Common 14922                                35980                                                       
 HRDR                       Scalar 14931    R(4)            4     1     255      COM              14980                             
 I                          Local  14949    I(4)            4           scalar                    14949,14989                       
 IBMS                       Local  14958    I(4)            4           scalar                    14958,14983,14984,14985           
 IND                        Scalar 14930    I(4)            4     1     255      COM              14983                             
 IP                         Local  14943    I(4)            4     2     765                       14983,14984,14985,14989           
 IS                         Scalar 14934    I(4)            4           scalar   COM              14951,14952,14953,14955           
 ISF                        Scalar 14924    I(4)            4     1     999      COM              14953                             
 ITP                        Scalar 14923    I(4)            4     1     999      COM              14952                             
 J                          Local  14989    I(4)            4           scalar                    14989                             
 JDATE                      Scalar 14935    I(4)            4     1     5        COM              14949                             
 L                          Local  14959    I(4)            4           scalar                    14959,14960,14961,14962,14963,1496
                                                                                                  4,14965,14966,14967,14968,14969,14
                                                                                                  970,14971,14972,14973,14974,14975,
                                                                                                  14976,14977,14978,14979,14980,1498
                                                                                                  1,14982,14983,14984,14985,14988,14
                                                                                                  989                               
 LEVTYP                     Scalar 14930    I(4)            4     1     255      COM              14984                             
 LST                        Scalar 14931    I(4)            4     1     255      COM              14985                             
 MANDF                      Scalar 14939    I(4)            4           scalar   COM              14955                             
 MANDL                      Scalar 14938    I(4)            4           scalar   COM              14955                             
 MANSND                     Common 14938                                168344                                                      

Page 507         Source Listing                  WBLOCKS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIN0                       Func   14983                                scalar                    14983,14984,14985                 
 NEV                        Scalar 14924    I(4)            4           scalar   COM              14953                             
 NFEVN                      Scalar 14933    I(4)            4           scalar   COM                                                
 NFIN                       Scalar 14933    I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 14933    I(4)            4           scalar   COM                                                
 NFSGL                      Scalar 14933    I(4)            4           scalar   COM              14949,14951,14955,14989           
 NFSTN                      Scalar 14933    I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 14933    I(4)            4           scalar   COM                                                
 NLV                        Scalar 14923    I(4)            4           scalar   COM              14952,14959,14988                 
 NLVM                       Scalar 14924    I(4)            4           scalar   COM              14953                             
 NLVW                       Scalar 14924    I(4)            4           scalar   COM              14953                             
 NST                        Param  14920    I(4)            4           scalar                    14922,14923,14924,14931,14938     
 P                          Local  14942    R(4)            4     2     5865                      14960,14961,14962,14963,14964,1496
                                                                                                  5,14966,14967,14968,14969,14970,14
                                                                                                  971,14972,14973,14974,14975,14976,
                                                                                                  14977,14978,14979,14980,14981,1498
                                                                                                  2,14989                           
 PFC                        Scalar 14925    R(4)            4     1     255      COM              14966                             
 PM                         Scalar 14939    R(4)            4     1     21       COM                                                
 POB                        Scalar 14925    R(4)            4     1     255      COM              14960                             
 PQM                        Scalar 14925    R(4)            4     1     255      COM              14971                             
 PRC                        Scalar 14925    R(4)            4     1     255      COM              14975                             
 PS                         Scalar 14931    R(4)            4     1     999      COM              14955                             
 QBMS                       Local  14944    R(4)            4           scalar                    14944,14964,14970                 
 QFC                        Scalar 14929    R(4)            4     1     255      COM              14970                             
 QFM                        Scalar 14939    R(4)            4     1     21       COM                                                
 QM                         Scalar 14938    R(4)            4     1     21       COM                                                
 QOB                        Scalar 14929    R(4)            4     1     255      COM              14964                             
 QQM                        Scalar 14929    R(4)            4     1     255      COM              14974                             
 QRC                        Scalar 14929    R(4)            4     1     255      COM              14978                             
 SID                        Scalar 14922    CHAR            8     1     999      COM              14951                             
 SQN                        Scalar 14923    R(4)            4     1     999      COM              14952                             
 STN                        Common 14934                                4                                                           
 TDFC                       Scalar 14928    R(4)            4     1     255      COM              14969                             
 TDM                        Scalar 14938    R(4)            4     1     21       COM                                                
 TDO                        Scalar 14928    R(4)            4     1     255      COM              14963                             
 TEST                       Scalar 14940    L(4)            4           scalar   COM              14949,14951,14955,14989           
 TESTS                      Common 14940                                4                                                           
 TFC                        Scalar 14927    R(4)            4     1     255      COM              14968                             
 TFM                        Scalar 14939    R(4)            4     1     21       COM                                                
 TM                         Scalar 14938    R(4)            4     2     20979    COM                                                
 TOB                        Scalar 14927    R(4)            4     1     255      COM              14962                             
 TQM                        Scalar 14927    R(4)            4     1     255      COM              14973                             
 TRC                        Scalar 14927    R(4)            4     1     255      COM              14977                             
 TVO                        Scalar 14928    R(4)            4     1     255      COM              14965                             
 WBLOCKS                    Subr   14919                                                                                            
 XDR                        Scalar 14932    R(4)            4     1     255      COM              14982                             
 XOB                        Scalar 14922    R(4)            4     1     999      COM              14951                             
 YDR                        Scalar 14932    R(4)            4     1     255      COM              14981                             
 YOB                        Scalar 14922    R(4)            4     1     999      COM              14951                             
 ZFC                        Scalar 14926    R(4)            4     1     255      COM              14967                             
 ZFM                        Scalar 14939    R(4)            4     1     21       COM                                                
 ZM                         Scalar 14938    R(4)            4     2     20979    COM                                                
 ZOB                        Scalar 14926    R(4)            4     1     255      COM              14961                             
 ZQM                        Scalar 14926    R(4)            4     1     255      COM              14972                             

Page 508         Source Listing                  WBLOCKS
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZRC                        Scalar 14926    R(4)            4     1     255      COM              14976                             

Page 509         Source Listing                  WBLOCKS
2017-04-18 11:07                                 cqcbufr.f

  14995 
  14996 C****************************************************************
  14997 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14998 C                .      .    .                                       .
  14999 C SUBPROGRAM:    WINDATZ     FIND PRESSURE AT HEIGHTS FOR CATEGORY 4
  15000 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  15001 C
  15002 C ABSTRACT: RESOLVE FOR THE PRESSURE AT THE HEIGHTS
  15003 C   OF WINDS-BY-HEIGHT, CATEGORY 4.  THERE WILL BE EXISTING PRESSURES,
  15004 C   PROVIDED BY PREPOBS_PREPDATA.
  15005 C
  15006 C PROGRAM HISTORY LOG:
  15007 C 1997-03-18  W. Collins  Original author.
  15008 C
  15009 C USAGE:    CALL WINDATZ(SAME)
  15010 C   INPUT ARGUMENT LIST:
  15011 C     SAME     - TRUE WHEN WIND PART GOES WITH PREVIOUSLY READ MASS
  15012 C                PART
  15013 C
  15014 C REMARKS: NONE.
  15015 C
  15016 C ATTRIBUTES:
  15017 C   LANGUAGE: FORTRAN 90
  15018 C   MACHINE:  NCEP WCOSS
  15019 C
  15020 C$$$
  15021 
  15022       SUBROUTINE WINDATZ(SAME)
  15023       PARAMETER (NST=999)
  15024 
  15025       REAL(8) BMISS
  15026 
  15027       REAL            PA(510), TA(510), ZA(510), QA(510), CATA(510)
  15028       INTEGER         INDX(510)
  15029       CHARACTER*8 SID
  15030       LOGICAL         SAME
  15031 
  15032       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
  15033      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
  15034      &                 NEV, ISF(NST), NLVM, NLVW
  15035       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
  15036      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
  15037      &                 TOB(255), TFC(255), TQM(255), TRC(255),
  15038      &                 TDO(255), TDFC(255),TVO(255),
  15039      &                 QOB(255), QFC(255), QQM(255), QRC(255),
  15040      &                 CAT(255), IND(255), LEVTYP(255),
  15041      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
  15042      &                 YDR(255), XDR(255)
  15043       COMMON /ALSNDW/  POBW(255), PFCW(255), PQMW(255), PRCW(255),
  15044      &                 ZOBW(255), ZFCW(255), ZQMW(255), ZRCW(255),
  15045      &                 UOB(255),  VOB(255),  UFC(255),  VFC(255),
  15046      &                 WQM(255),  WRC(255),  SP(255),   DIR(255),
  15047      &                 CATW(255)
  15048       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  15049 
  15050       DATA T0 /273.15/
  15051 

Page 510         Source Listing                  WINDATZ
2017-04-18 11:07                                 cqcbufr.f

  15052 C  THE PURPOSE OF THIS SUBROUTINE IS TO RESOLVE FOR THE PRESSURE AT
  15053 C  THE HEIGHTS OF WINDS-BY-HEIGHT, CATEGORY 4.  THERE WILL BE
  15054 C  EXISTING PRESSURES, PROVIDED BY PREPOBS_PREPDATA.
  15055 C  ----------------------------------------------------------------
  15056 
  15057       IF(.NOT. SAME) RETURN
  15058 
  15059 C  SET THE COMBINED FIELDS TO MISSING
  15060 C  ----------------------------------
  15061 
  15062       PA   = BMISS
  15063       TA   = BMISS
  15064       ZA   = BMISS
  15065       QA   = BMISS
  15066       CATA = BMISS
  15067 
  15068 C  MAKE A COMBINED LIST OF PRESSURES
  15069 C  ---------------------------------
  15070 
  15071       DO L=1,NLVM
  15072         PA(L) = POB(L)
  15073       ENDDO
  15074 
  15075       DO L=1,NLVW
  15076         PA(L+NLVM) = POBW(L)
  15077       ENDDO
  15078       NLVA = NLVM + NLVW
  15079 
  15080 C  LOOK FOR DUPLICATE PRESSURES AND SET ANY TO MISSING
  15081 C  ---------------------------------------------------
  15082 
  15083       DO L=1,NLVA
  15084         DO LL=L+1,NLVA
  15085           IF(PA(L).EQ.PA(LL)) PA(LL) = BMISS
  15086         ENDDO
  15087       ENDDO
  15088 
  15089 C  SORT PRESSURES, DESCENDING
  15090 C  --------------------------
  15091 
  15092       CALL SHELL(PA,INDX,NLVA,1)
  15093 
  15094 C  DETERMINE THE NUMBER OF NON-MISSING PRESSURES, RESET NLVA
  15095 C  ---------------------------------------------------------
  15096 
  15097       DO L=1,NLVA
  15098         LL = L
  15099         IF(PA(L).NE.BMISS) GOTO 10
  15100       ENDDO
  15101    10 CONTINUE
  15102       DO L=LL,NLVA
  15103         PA(L-LL+1) = PA(LL)
  15104       ENDDO
  15105       NLVA = NLVA-LL+1
  15106       IF(NLVA.LE.2) RETURN
  15107 
  15108 C  FILL TA,ZA,QA,CATA.

Page 511         Source Listing                  WINDATZ
2017-04-18 11:07                                 cqcbufr.f

  15109 C  -------------------------
  15110 
  15111       DO L=1,NLVM
  15112         DO LL=1,NLVA
  15113           IF(POB(L).EQ.PA(LL)) THEN
  15114             IF(TOB(L).NE.BMISS) TA(LL)   = TOB(L)
  15115             IF(ZOB(L).NE.BMISS) ZA(LL)   = ZOB(L)
  15116             IF(QOB(L).NE.BMISS) QA(LL)   = QOB(L)
  15117             IF(CAT(L).NE.BMISS) CATA(LL) = CAT(L)
  15118           ENDIF
  15119         ENDDO
  15120       ENDDO
  15121 
  15122       DO L=1,NLVW
  15123         DO LL=1,NLVA
  15124           IF(POBW(L).EQ.PA(LL)) THEN
  15125             IF(ZOBW(L).NE.BMISS) ZA(LL)   = ZOBW(L)
  15126             IF(CATW(L).NE.BMISS) CATA(LL) = CATW(L)
  15127           ENDIF
  15128         ENDDO
  15129       ENDDO
  15130 
  15131 C  GO THROUGH LIST, LOOKING FOR CATA=4 LEVELS.  AT EACH, FIND
  15132 C  SURROUNDING PRESSURES, IF THEY EXIST.  SOLVE HYDORSTATICALLY
  15133 C  FOR THE PRESSURE OF THIS LEVEL AND REPLACE PA WITH THIS
  15134 C  VALUE.  (USE VIRTUAL TEMPERATURES, IF POSSIBLE.)
  15135 C  ------------------------------------------------------------
  15136 
  15137       IF(CATA(1).EQ.4.) THEN
  15138         P1    = PA(2)
  15139         Z1    = ZA(2)
  15140         IF(QA(2).NE.BMISS) THEN
  15141           T1C = (TA(2)+T0)*(1.+.61*QA(2)) - T0
  15142         ELSE
  15143           T1C = TA(2)
  15144         ENDIF
  15145         Z2    = ZA(1)
  15146         P3    = BMISS
  15147         Z3    = BMISS
  15148         T3C   = BMISS
  15149         ALPHA = -.0065
  15150         METH = 2
  15151         CALL PATZ(P1,P2,P3,Z1,Z2,Z3,T1C,T3C,ALPHA,METH)
  15152         PA(1) = P2
  15153       ENDIF
  15154 
  15155       DO L=2,NLVA-1
  15156         IF(CATA(L).EQ.4.) THEN
  15157         DO LL=L-1,1,-1
  15158           L1 = LL
  15159           IF(CATA(LL).NE.4) GOTO 11
  15160         ENDDO
  15161    11   CONTINUE
  15162           P1    = PA(L1)
  15163           Z1    = ZA(L1)
  15164           IF(QA(L1).NE.BMISS) THEN
  15165             T1C = (TA(L1)+T0)*(1.+.61*QA(L1)) - T0

Page 512         Source Listing                  WINDATZ
2017-04-18 11:07                                 cqcbufr.f

  15166           ELSE
  15167             T1C = TA(L1)
  15168           ENDIF
  15169           Z2    = ZA(L)
  15170           DO LL=L+1,NLVA
  15171             L2 = LL
  15172             IF(CATA(LL).NE.4) GOTO 12
  15173           ENDDO
  15174           P3    = BMISS
  15175           Z3    = BMISS
  15176    12     CONTINUE
  15177           P3    = PA(L2)
  15178           Z3    = ZA(L2)
  15179           IF(QA(L2).NE.BMISS) THEN
  15180             T3C = (TA(L2)+T0)*(1.+.61*QA(L2)) - T0
  15181           ELSE
  15182             T3C = TA(L2)
  15183           ENDIF
  15184           ALPHA = BMISS
  15185           METH = 1
  15186           CALL PATZ(P1,P2,P3,Z1,Z2,Z3,T1C,T3C,ALPHA,METH)
  15187           PA(L) = P2
  15188         ENDIF
  15189       ENDDO
  15190 
  15191       IF(CATA(NLVA).EQ.4.) THEN
  15192         P1    = PA(NLVA-1)
  15193         Z1    = ZA(NLVA-1)
  15194         IF(QA(NLVA-1).NE.BMISS) THEN
  15195           TIC = (TA(NLVA-1)+T0)*(1.+.61*QA(NLVA-1)) - T0
  15196         ELSE
  15197           T1C = TA(NLVA-1)
  15198         ENDIF
  15199         Z2    = ZA(NLVA)
  15200         P3    = BMISS
  15201         Z3    = BMISS
  15202         T3C   = BMISS
  15203         ALPHA = -.0065
  15204         METH = 2
  15205         CALL PATZ(P1,P2,P3,Z1,Z2,Z3,T1C,T3C,ALPHA,METH)
  15206         PA(NLVA) = P2
  15207       ENDIF
  15208 
  15209 C  SET CAT=4 PRESSURES TO THOSE JUST SOLVED FOR
  15210 C  --------------------------------------------
  15211 
  15212       DO L=1,NLVM
  15213         IF(CAT(L).EQ.4.) THEN
  15214           DO LL=1,NLVA
  15215             IF(ZA(LL).EQ.ZOB(L)) GOTO 40
  15216           ENDDO
  15217           GOTO 50
  15218    40     CONTINUE
  15219           POB(L) = PA(LL)
  15220         ENDIF
  15221    50   CONTINUE
  15222       ENDDO

Page 513         Source Listing                  WINDATZ
2017-04-18 11:07                                 cqcbufr.f

  15223 
  15224       DO L=1,NLVW
  15225         IF(CATW(L).EQ.4.) THEN
  15226           DO LL=1,NLVA
  15227             IF(ZA(LL).EQ.ZOBW(L)) GOTO 20
  15228           ENDDO
  15229           GOTO 30
  15230    20     CONTINUE
  15231           POBW(L) = PA(LL)
  15232         ENDIF
  15233    30   CONTINUE
  15234       ENDDO
  15235 
  15236       RETURN
  15237       END


ENTRY POINTS

  Name                
                      
 windatz_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  15101                                                          15099                             
 11                         Label  15161                                                          15159                             
 12                         Label  15176                                                          15172                             
 20                         Label  15230                                                          15227                             
 30                         Label  15233                                                          15229                             
 40                         Label  15218                                                          15215                             
 50                         Label  15221                                                          15217                             
 ALLSND                     Common 15035                                34512                                                       
 ALPHA                      Local  15149    R(4)            4           scalar                    15149,15151,15184,15186,15203,1520
                                                                                                  5                                 
 ALSNDW                     Common 15043                                17340                                                       
 BMISS                      Scalar 15025    R(8)            8           scalar   COM              15062,15063,15064,15065,15066,1508
                                                                                                  5,15099,15114,15115,15116,15117,15
                                                                                                  125,15126,15140,15146,15147,15148,
                                                                                                  15164,15174,15175,15179,15184,1519
                                                                                                  4,15200,15201,15202               
 BUFRLIB_MISSING            Common 15048                                16                                                          
 CAT                        Scalar 15040    R(4)            4     1     255      COM              15117,15213                       
 CATA                       Local  15027    R(4)            4     1     510                       15066,15117,15126,15137,15156,1515
                                                                                                  9,15172,15191                     
 CATW                       Scalar 15047    R(4)            4     1     255      COM              15126,15225                       
 DHR                        Scalar 15032    R(4)            4     1     999      COM                                                
 DIR                        Scalar 15046    R(4)            4     1     255      COM                                                
 ELV                        Scalar 15033    R(4)            4     1     999      COM                                                
 GESPS                      Scalar 15041    R(4)            4     1     999      COM                                                
 HEADER                     Common 15032                                35980                                                       
 HRDR                       Scalar 15041    R(4)            4     1     255      COM                                                
 IMISS                      Scalar 15048    I(4)            4           scalar   COM                                                
 IND                        Scalar 15040    I(4)            4     1     255      COM                                                

Page 514         Source Listing                  WINDATZ
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INDX                       Local  15028    I(4)            4     1     510                       15092                             
 ISF                        Scalar 15034    I(4)            4     1     999      COM                                                
 ITP                        Scalar 15033    I(4)            4     1     999      COM                                                
 L                          Local  15071    I(4)            4           scalar                    15071,15072,15075,15076,15083,1508
                                                                                                  4,15085,15097,15098,15099,15102,15
                                                                                                  103,15111,15113,15114,15115,15116,
                                                                                                  15117,15122,15124,15125,15126,1515
                                                                                                  5,15156,15157,15169,15170,15187,15
                                                                                                  212,15213,15215,15219,15224,15225,
                                                                                                  15227,15231                       
 L1                         Local  15158    I(4)            4           scalar                    15158,15162,15163,15164,15165,1516
                                                                                                  7                                 
 L2                         Local  15171    I(4)            4           scalar                    15171,15177,15178,15179,15180,1518
                                                                                                  2                                 
 LEVTYP                     Scalar 15040    I(4)            4     1     255      COM                                                
 LL                         Local  15084    I(4)            4           scalar                    15084,15085,15098,15102,15103,1510
                                                                                                  5,15112,15113,15114,15115,15116,15
                                                                                                  117,15123,15124,15125,15126,15157,
                                                                                                  15158,15159,15170,15171,15172,1521
                                                                                                  4,15215,15219,15226,15227,15231   
 LST                        Scalar 15041    I(4)            4     1     255      COM                                                
 METH                       Local  15150    I(4)            4           scalar                    15150,15151,15185,15186,15204,1520
                                                                                                  5                                 
 NEV                        Scalar 15034    I(4)            4           scalar   COM                                                
 NLV                        Scalar 15033    I(4)            4           scalar   COM                                                
 NLVA                       Local  15078    I(4)            4           scalar                    15078,15083,15084,15092,15097,1510
                                                                                                  2,15105,15106,15112,15123,15155,15
                                                                                                  170,15191,15192,15193,15194,15195,
                                                                                                  15197,15199,15206,15214,15226     
 NLVM                       Scalar 15034    I(4)            4           scalar   COM              15071,15076,15078,15111,15212     
 NLVW                       Scalar 15034    I(4)            4           scalar   COM              15075,15078,15122,15224           
 NST                        Param  15023    I(4)            4           scalar                    15032,15033,15034,15041           
 P1                         Local  15138    R(4)            4           scalar                    15138,15151,15162,15186,15192,1520
                                                                                                  5                                 
 P2                         Local  15151    R(4)            4           scalar                    15151,15152,15186,15187,15205,1520
                                                                                                  6                                 
 P3                         Local  15146    R(4)            4           scalar                    15146,15151,15174,15177,15186,1520
                                                                                                  0,15205                           
 PA                         Local  15027    R(4)            4     1     510                       15062,15072,15076,15085,15092,1509
                                                                                                  9,15103,15113,15124,15138,15152,15
                                                                                                  162,15177,15187,15192,15206,15219,
                                                                                                  15231                             
 PATZ                       Subr   15151                                                          15151,15186,15205                 
 PFC                        Scalar 15035    R(4)            4     1     255      COM                                                
 PFCW                       Scalar 15043    R(4)            4     1     255      COM                                                
 POB                        Scalar 15035    R(4)            4     1     255      COM              15072,15113,15219                 
 POBW                       Scalar 15043    R(4)            4     1     255      COM              15076,15124,15231                 
 PQM                        Scalar 15035    R(4)            4     1     255      COM                                                
 PQMW                       Scalar 15043    R(4)            4     1     255      COM                                                
 PRC                        Scalar 15035    R(4)            4     1     255      COM                                                
 PRCW                       Scalar 15043    R(4)            4     1     255      COM                                                
 PS                         Scalar 15041    R(4)            4     1     999      COM                                                
 QA                         Local  15027    R(4)            4     1     510                       15065,15116,15140,15141,15164,1516
                                                                                                  5,15179,15180,15194,15195         
 QFC                        Scalar 15039    R(4)            4     1     255      COM                                                

Page 515         Source Listing                  WINDATZ
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QOB                        Scalar 15039    R(4)            4     1     255      COM              15116                             
 QQM                        Scalar 15039    R(4)            4     1     255      COM                                                
 QRC                        Scalar 15039    R(4)            4     1     255      COM                                                
 SAME                       Dummy  15022    L(4)            4           scalar   ARG,INOUT        15057                             
 SHELL                      Subr   15092                                                          15092                             
 SID                        Scalar 15029    CHAR            8     1     999      COM                                                
 SP                         Scalar 15046    R(4)            4     1     255      COM                                                
 SQN                        Scalar 15033    R(4)            4     1     999      COM                                                
 T0                         Local  15050    R(4)            4           scalar                    15050,15141,15165,15180,15195     
 T1C                        Local  15141    R(4)            4           scalar                    15141,15143,15151,15165,15167,1518
                                                                                                  6,15197,15205                     
 T3C                        Local  15148    R(4)            4           scalar                    15148,15151,15180,15182,15186,1520
                                                                                                  2,15205                           
 TA                         Local  15027    R(4)            4     1     510                       15063,15114,15141,15143,15165,1516
                                                                                                  7,15180,15182,15195,15197         
 TDFC                       Scalar 15038    R(4)            4     1     255      COM                                                
 TDO                        Scalar 15038    R(4)            4     1     255      COM                                                
 TFC                        Scalar 15037    R(4)            4     1     255      COM                                                
 TIC                        Local  15195    R(4)            4           scalar                    15195                             
 TOB                        Scalar 15037    R(4)            4     1     255      COM              15114                             
 TQM                        Scalar 15037    R(4)            4     1     255      COM                                                
 TRC                        Scalar 15037    R(4)            4     1     255      COM                                                
 TVO                        Scalar 15038    R(4)            4     1     255      COM                                                
 UFC                        Scalar 15045    R(4)            4     1     255      COM                                                
 UOB                        Scalar 15045    R(4)            4     1     255      COM                                                
 VFC                        Scalar 15045    R(4)            4     1     255      COM                                                
 VOB                        Scalar 15045    R(4)            4     1     255      COM                                                
 WINDATZ                    Subr   15022                                                                                            
 WQM                        Scalar 15046    R(4)            4     1     255      COM                                                
 WRC                        Scalar 15046    R(4)            4     1     255      COM                                                
 XDR                        Scalar 15042    R(4)            4     1     255      COM                                                
 XMISS                      Scalar 15048    R(4)            4           scalar   COM                                                
 XOB                        Scalar 15032    R(4)            4     1     999      COM                                                
 YDR                        Scalar 15042    R(4)            4     1     255      COM                                                
 YOB                        Scalar 15032    R(4)            4     1     999      COM                                                
 Z1                         Local  15139    R(4)            4           scalar                    15139,15151,15163,15186,15193,1520
                                                                                                  5                                 
 Z2                         Local  15145    R(4)            4           scalar                    15145,15151,15169,15186,15199,1520
                                                                                                  5                                 
 Z3                         Local  15147    R(4)            4           scalar                    15147,15151,15175,15178,15186,1520
                                                                                                  1,15205                           
 ZA                         Local  15027    R(4)            4     1     510                       15064,15115,15125,15139,15145,1516
                                                                                                  3,15169,15178,15193,15199,15215,15
                                                                                                  227                               
 ZFC                        Scalar 15036    R(4)            4     1     255      COM                                                
 ZFCW                       Scalar 15044    R(4)            4     1     255      COM                                                
 ZOB                        Scalar 15036    R(4)            4     1     255      COM              15115,15215                       
 ZOBW                       Scalar 15044    R(4)            4     1     255      COM              15125,15227                       
 ZQM                        Scalar 15036    R(4)            4     1     255      COM                                                
 ZQMW                       Scalar 15044    R(4)            4     1     255      COM                                                
 ZRC                        Scalar 15036    R(4)            4     1     255      COM                                                
 ZRCW                       Scalar 15044    R(4)            4     1     255      COM                                                

Page 516         Source Listing                  WINDATZ
2017-04-18 11:07                                 cqcbufr.f

  15238 
  15239 C************************************************************************
  15240 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  15241 C                .      .    .                                       .
  15242 C SUBPROGRAM:    WTISO       Write list of isolated observations
  15243 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  15244 C
  15245 C ABSTRACT: WRITE LIST OF ISOLATED OBSERVATIONS
  15246 C
  15247 C PROGRAM HISTORY LOG:
  15248 C 1997-03-18  W. Collins  Original author.
  15249 C
  15250 C USAGE:    CALL WTISO
  15251 C
  15252 C   OUTPUT FILES:
  15253 C     UNIT 06  - PRINTOUT
  15254 C
  15255 C REMARKS: NONE.
  15256 C
  15257 C ATTRIBUTES:
  15258 C   LANGUAGE: FORTRAN 90
  15259 C   MACHINE:  NCEP WCOSS
  15260 C
  15261 C$$$
  15262       SUBROUTINE WTISO
  15263       PARAMETER (NST=999)
  15264       COMMON /ISO/ IDISO(NST),NUM,ISISO
  15265       LOGICAL ISISO
  15266       WRITE(6,600)
  15267       WRITE(6,601) (IDISO(I),I=1,NUM)
  15268   600 FORMAT(' LIST OF ISOLATED STATIONS:')
  15269   601 FORMAT(I12.5)
  15270       RETURN
  15271       END

Page 517         Source Listing                  WTISO
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name              
                    
 wtiso_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 600                        Label  15268                                                          15266                             
 601                        Label  15269                                                          15267                             
 I                          Local  15267    I(4)            4           scalar                    15267                             
 IDISO                      Scalar 15264    I(4)            4     1     999      COM              15267                             
 ISISO                      Scalar 15264    L(4)            4           scalar   COM                                                
 ISO                        Common 15264                                4004                                                        
 NST                        Param  15263    I(4)            4           scalar                    15264                             
 NUM                        Scalar 15264    I(4)            4           scalar   COM              15267                             
 WTISO                      Subr   15262                                                                                            

Page 518         Source Listing                  WTISO
2017-04-18 11:07                                 cqcbufr.f

  15272 
  15273 C************************************************************************
  15274 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  15275 C                .      .    .                                       .
  15276 C SUBPROGRAM:    WTSTATS     WRITE SUMMARY OF RADCOR STATISTICS
  15277 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2007-09-14
  15278 C
  15279 C ABSTRACT: WRITE SUMMARY OF RADCOR STATISTICS
  15280 C
  15281 C PROGRAM HISTORY LOG:
  15282 C 1997-03-18  W. Collins  Original author.
  15283 C 2007-09-14  D. Keyser   Corrected array overflow (and memory
  15284 C     clobbering) issue when the number of RAOB IDs stored by
  15285 C     radiosonde type in array SIDRAD (in RADCOR processing) is listed.
  15286 C     If this limit is exceeded, only the limiting number of RAOBS will
  15287 C     now be listed, along with a warning diagnostic - the limit has
  15288 C     been increased from 400 to 800 since some reanalysis runs were
  15289 C     exceeding the old limit.
  15290 C
  15291 C USAGE:    CALL WTSTATS
  15292 C
  15293 C   OUTPUT FILES:
  15294 C     UNIT 06  - PRINTOUT
  15295 C     UNIT 68  - INTERSONDE CORRECTION INFORMATION FILE
  15296 C
  15297 C REMARKS: NONE.
  15298 C
  15299 C ATTRIBUTES:
  15300 C   LANGUAGE: FORTRAN 90
  15301 C   MACHINE:  NCEP WCOSS
  15302 C
  15303 C$$$
  15304       SUBROUTINE WTSTATS
  15305 
  15306       PARAMETER (NRID=800) ! max # of raob ids listed per inst. type
  15307       CHARACTER*8 SIDNOR, SIDRAD
  15308       COMMON/SWITCH/LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
  15309       COMMON/COUNT/   NTYPE(69),KTYPE(69),SIDNOR(2000),SIDRAD(NRID,255),
  15310      &                IICNT,JJCNT(255)
  15311       LOGICAL HGTTBL
  15312 
  15313 C  PRINT FINAL STATISTICS FOR INTERSONDE (RADIATION) CORRECTION
  15314 C  ------------------------------------------------------------
  15315 
  15316       IF(LEVRAD.GT.0)  THEN
  15317          CALL LSTATS(1)
  15318          CALL LSTATS(2)
  15319       END IF
  15320       PRINT 88
  15321       WRITE(68,88)
  15322    88 FORMAT(/38X,'THE FOLLOWING "ADPUPA" MASS REPORTS WERE NOT ',
  15323      . 'CORRECTED'/)
  15324       PRINT 89, (SIDNOR(I),I=1,IICNT)
  15325       WRITE(68,89) (SIDNOR(I),I=1,IICNT)
  15326    89 FORMAT(2X,9A8)
  15327 
  15328       PRINT 188

Page 519         Source Listing                  WTSTATS
2017-04-18 11:07                                 cqcbufr.f

  15329       WRITE(68,188)
  15330   188 FORMAT(/13X,'THE FOLLOWING "ADPUPA" MASS REPORTS WERE SUBJECT TO',
  15331      . ' CORRECTION (BASED ON SUN ANGLE AND PRESSURE LEVELS)'/)
  15332       DO  J = 1,255
  15333          IF(JJCNT(J).GT.0)  THEN
  15334             PRINT 189, J
  15335             WRITE(68,189) J
  15336   189       FORMAT(/20X,'** RADIOSONDE TYPE ',I3.3,' **'/)
  15337             JJCNT_MAX=MIN(JJCNT(J),NRID)
  15338             PRINT 89, (SIDRAD(I,J),I=1,JJCNT_MAX)
  15339             WRITE(68,89) (SIDRAD(I,J),I=1,JJCNT_MAX)
  15340             IF(JJCNT_MAX.NE.JJCNT(J)) THEN
  15341                PRINT'(" WARNING: THERE ARE TOTAL OF ",I0," REPORTS ",
  15342      .          "WITH THIS INST. TYPE - CAN ONLY PRINT FIRST ",I0,
  15343      .          " HERE DUE TO ARRAY SIZE LIMITATIONS")',JJCNT(J),NRID
  15344                WRITE(68,'("WARNING: THERE ARE TOTAL OF ",I4," REPORTS ",
  15345      .          "WITH THIS INST. TYPE - CAN ONLY PRINT FIRST ",I4,
  15346      .          " HERE DUE TO ARRAY SIZE LIMITATIONS")') JJCNT(J),NRID
  15347             END IF
  15348          END IF
  15349       END DO
  15350 
  15351       PRINT 90
  15352       WRITE(68,90)
  15353    90 FORMAT(///,49X,'"ADPUPA" MASS REPORT COUNTS BY RADIOSONDE TYPE',/)
  15354       PRINT 92, (NTYPE(I), I= 1,17),(KTYPE(I), I= 1,17)
  15355       WRITE(68,92) (NTYPE(I), I= 1,17),(KTYPE(I), I= 1,17)
  15356       PRINT 92, (NTYPE(I), I=18,34),(KTYPE(I), I=18,34)
  15357       WRITE(68,92) (NTYPE(I), I=18,34),(KTYPE(I), I=18,34)
  15358       PRINT 92, (NTYPE(I), I=35,51),(KTYPE(I), I=35,51)
  15359       WRITE(68,92) (NTYPE(I), I=35,51),(KTYPE(I), I=35,51)
  15360       PRINT 92, (NTYPE(I), I=52,68),(KTYPE(I), I=52,68)
  15361       WRITE(68,92) (NTYPE(I), I=52,68),(KTYPE(I), I=52,68)
  15362    92 FORMAT(/,3X,17I7.3,/,3X,17I7)
  15363       PRINT 93, KTYPE(69)
  15364       WRITE(68,93) KTYPE(69)
  15365    93 FORMAT(/,36X,'>>>>> TOTAL NUMBER OF "ADPUPA" MASS REPORTS =',I5,
  15366      . ' <<<<<')
  15367       PRINT 91
  15368       WRITE(68,91)
  15369    91 FORMAT(//,27X,'***** INTERSONDE (RADIATION) CORRECTION PROGRAM ',
  15370      . ' SUCCESSFULLY COMPLETED *****',////)
  15371 
  15372       RETURN
  15373       END

Page 520         Source Listing                  WTSTATS
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 wtstats_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 188                        Label  15330                                                          15328,15329                       
 189                        Label  15336                                                          15334,15335                       
 88                         Label  15322                                                          15320,15321                       
 89                         Label  15326                                                          15324,15325,15338,15339           
 90                         Label  15353                                                          15351,15352                       
 91                         Label  15369                                                          15367,15368                       
 92                         Label  15362                                                          15354,15355,15356,15357,15358,1535
                                                                                                  9,15360,15361                     
 93                         Label  15365                                                          15363,15364                       
 BAL_DRIFT                  Scalar 15308    R(4)            4           scalar   COM                                                
 COUNT                      Common 15309                                1649576                                                     
 HGTTBL                     Scalar 15308    L(4)            4           scalar   COM                                                
 I                          Local  15324    I(4)            4           scalar                    15324,15325,15338,15339,15354,1535
                                                                                                  5,15356,15357,15358,15359,15360,15
                                                                                                  361                               
 IICNT                      Scalar 15310    I(4)            4           scalar   COM              15324,15325                       
 IRCTBL                     Scalar 15308    I(4)            4           scalar   COM                                                
 J                          Local  15332    I(4)            4           scalar                    15332,15333,15334,15335,15337,1533
                                                                                                  8,15339,15340,15343,15346         
 JJCNT                      Scalar 15310    I(4)            4     1     255      COM              15333,15337,15340,15343,15346     
 JJCNT_MAX                  Local  15337    I(4)            4           scalar                    15337,15338,15339,15340           
 KTYPE                      Scalar 15309    I(4)            4     1     69       COM              15354,15355,15356,15357,15358,1535
                                                                                                  9,15360,15361,15363,15364         
 LEVRAD                     Scalar 15308    I(4)            4           scalar   COM              15316                             
 LSTATS                     Subr   15317                                                          15317,15318                       
 LWCORR                     Scalar 15308    I(4)            4           scalar   COM                                                
 MIN                        Func   15337                                scalar                    15337                             
 NRID                       Param  15306    I(4)            4           scalar                    15309,15337,15343,15346           
 NTYPE                      Scalar 15309    I(4)            4     1     69       COM              15354,15355,15356,15357,15358,1535
                                                                                                  9,15360,15361                     
 SIDNOR                     Scalar 15307    CHAR            8     1     2000     COM              15324,15325                       
 SIDRAD                     Scalar 15307    CHAR            8     2     204000   COM              15338,15339                       
 SWITCH                     Common 15308                                20                                                          
 WTSTATS                    Subr   15304                                                                                            

Page 521         Source Listing                  WTSTATS
2017-04-18 11:07                                 cqcbufr.f

  15374 
  15375 C*********************************************************************
  15376 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  15377 C                .      .    .                                       .
  15378 C SUBPROGRAM:    XHORRES     CALCULATE NORMALIZED HORIZONTAL RESIDUAL
  15379 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  15380 C
  15381 C ABSTRACT: CALCULATE NORMALIZED HORIZONTAL RESIDUAL
  15382 C
  15383 C PROGRAM HISTORY LOG:
  15384 C 1999-04-13  W. Collins  Original author.
  15385 C
  15386 C USAGE:    CALL XHORRES
  15387 C
  15388 C REMARKS: NONE.
  15389 C
  15390 C ATTRIBUTES:
  15391 C   LANGUAGE: FORTRAN 90
  15392 C   MACHINE:  NCEP WCOSS
  15393 C
  15394 C$$$
  15395 
  15396       SUBROUTINE XHORRES
  15397       PARAMETER (NST=999)
  15398 
  15399       REAL(8) BMISS
  15400 
  15401       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  15402      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  15403       COMMON /LIMS/    HSCRES(21), XINC(21,4), HOIRES(21,4),
  15404      &                 VOIRES(21,4), TMPSTD(21,4), TFACT(21,4),
  15405      &                 ZCLIM, TCLIM, NHLIM
  15406       COMMON /MANRES/  ZIM(21,NST),TIM(21,NST),TDIM(21,NST),QIM(21,NST),
  15407      &                 ZHM(21,NST),THM(21,NST),TDHM(21,NST),QHM(21,NST),
  15408      &                 ZVM(21,NST),TVM(21,NST),TDVM(21,NST),QVM(21,NST),
  15409      &                 NZIM(21,NST),NTIM(21,NST),NTDIM(21,NST),
  15410      &                 XZIM(21,NST),XTIM(21,NST),XTDIM(21,NST),
  15411      &                 XQIM(21,NST),XZVM(21,NST),XTVM(21,NST),
  15412      &                 NZHM(21,NST),XZHM(21,NST),NTHM(21,NST),
  15413      &                 XTHM(21,NST),XTDVM(21,NST),
  15414      &                 NTDHM(21,NST),XTDHM(21,NST),NQHM(21,NST),
  15415      &                 XQHM(21,NST),
  15416      &                 ZG(21,NST), TG(21,NST), TDG(21,NST), QG(21,NST),
  15417      &                 PIS(NST),   HYDM(21,NST),BRES(NST),  ERROR(NST)
  15418       COMMON /STATS/   NV(21,7), AVGV(21,7), STDV(21,7),
  15419      &                 NH(21,7), AVGH(21,7), STDH(21,7),
  15420      &                 NI(21,7), AVGI(21,7), STDI(21,7),
  15421      &                 NT(21,4),  AVGT(21,4), STDT(21,4),
  15422      &                 NHY(21),   AVGHY(21),  STDHY(21),
  15423      &                 NB,        AVGB,       STDB,
  15424      &                 SKV(21,7), XKV(21,7),
  15425      &                 SKH(21,7), XKH(21,7),
  15426      &                 SKI(21,7), XKI(21,7),
  15427      &                 SKT(21,4), XKT(21,4),
  15428      &                 SKHY(21),  XKHY(21),
  15429      &                 SKB,       XKB
  15430       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS

Page 522         Source Listing                  XHORRES
2017-04-18 11:07                                 cqcbufr.f

  15431 
  15432 C  CALCULATE NORMALIZED HORIZONTAL RESIDUALS.
  15433 C  ------------------------------------------
  15434 
  15435       DO J=1,NST
  15436         DO I=1,21
  15437           XZHM(I,J)  = BMISS
  15438           XTHM(I,J)  = BMISS
  15439           XTDHM(I,J) = BMISS
  15440           XQHM(I,J)  = BMISS
  15441         ENDDO
  15442       ENDDO
  15443       DO N=1,NOBS
  15444         DO L=1,MAND
  15445           IF(ZHM(L,N).LT.BMISS/2) THEN
  15446             XZHM(L,N) = (ZHM(L,N)-AVGH(L,1))
  15447      &                  /MAX(.1*HOIRES(L,1),STDH(L,1))
  15448           ENDIF
  15449           IF(THM(L,N).LT.BMISS/2) THEN
  15450             XTHM(L,N) = (THM(L,N)-AVGH(L,2))
  15451      &                  /MAX(.1*HOIRES(L,2),STDH(L,2))
  15452           ENDIF
  15453           IF(TDHM(L,N).LT.BMISS/2) THEN
  15454             XTDHM(L,N) = (TDHM(L,N)-AVGH(L,3))
  15455      &                   /MAX(.1*HOIRES(L,3),STDH(L,3))
  15456           ENDIF
  15457           IF(QHM(L,N).LT.BMISS/2) THEN
  15458             XQHM(L,N) = (QHM(L,N)-AVGH(L,4))
  15459      &                  /MAX(.1*HOIRES(L,4),STDH(L,4))
  15460           ENDIF
  15461         ENDDO
  15462       ENDDO
  15463   
  15464       RETURN
  15465       END

Page 523         Source Listing                  XHORRES
2017-04-18 11:07 Entry Points                    cqcbufr.f



ENTRY POINTS

  Name                
                      
 xhorres_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AVGB                       Scalar 15423    R(4)            4           scalar   COM                                                
 AVGH                       Scalar 15419    R(4)            4     2     147      COM              15446,15450,15454,15458           
 AVGHY                      Scalar 15422    R(4)            4     1     21       COM                                                
 AVGI                       Scalar 15420    R(4)            4     2     147      COM                                                
 AVGT                       Scalar 15421    R(4)            4     2     84       COM                                                
 AVGV                       Scalar 15418    R(4)            4     2     147      COM                                                
 BMISS                      Scalar 15399    R(8)            8           scalar   COM              15437,15438,15439,15440,15445,1544
                                                                                                  9,15453,15457                     
 BRES                       Scalar 15417    R(4)            4     1     999      COM                                                
 BUFRLIB_MISSING            Common 15430                                16                                                          
 CQCPC                      Scalar 15402    R(4)            4           scalar   COM                                                
 ERROR                      Scalar 15417    R(4)            4     1     999      COM                                                
 HOIRES                     Scalar 15403    R(4)            4     2     84       COM              15447,15451,15455,15459           
 HSCRES                     Scalar 15403    R(4)            4     1     21       COM                                                
 HYDM                       Scalar 15417    R(4)            4     2     20979    COM                                                
 I                          Local  15436    I(4)            4           scalar                    15436,15437,15438,15439,15440     
 IMISS                      Scalar 15430    I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 15402    I(4)            4           scalar   COM                                                
 ISC                        Scalar 15402    I(4)            4           scalar   COM                                                
 J                          Local  15435    I(4)            4           scalar                    15435,15437,15438,15439,15440     
 L                          Local  15444    I(4)            4           scalar                    15444,15445,15446,15447,15449,1545
                                                                                                  0,15451,15453,15454,15455,15457,15
                                                                                                  458,15459                         
 LIMS                       Common 15403                                1776                                                        
 LMAND                      Scalar 15402    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 15402    I(4)            4           scalar   COM                                                
 MAND                       Scalar 15401    I(4)            4           scalar   COM              15444                             
 MANRES                     Common 15406                                2949048                                                     
 MAX                        Func   15447                                scalar                    15447,15451,15455,15459           
 N                          Local  15443    I(4)            4           scalar                    15443,15445,15446,15449,15450,1545
                                                                                                  3,15454,15457,15458               
 NB                         Scalar 15423    I(4)            4           scalar   COM                                                
 NH                         Scalar 15419    I(4)            4     2     147      COM                                                
 NHLIM                      Scalar 15405    I(4)            4           scalar   COM                                                
 NHY                        Scalar 15422    I(4)            4     1     21       COM                                                
 NI                         Scalar 15420    I(4)            4     2     147      COM                                                
 NLEV                       Scalar 15401    I(4)            4           scalar   COM                                                
 NOBS                       Scalar 15401    I(4)            4           scalar   COM              15443                             
 NQHM                       Scalar 15414    I(4)            4     2     20979    COM                                                
 NST                        Param  15397    I(4)            4           scalar                    15406,15407,15408,15409,15410,1541
                                                                                                  1,15412,15413,15414,15415,15416,15
                                                                                                  417,15435                         
 NT                         Scalar 15421    I(4)            4     2     84       COM                                                
 NTDHM                      Scalar 15414    I(4)            4     2     20979    COM                                                

Page 524         Source Listing                  XHORRES
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTDIM                      Scalar 15409    I(4)            4     2     20979    COM                                                
 NTHM                       Scalar 15412    I(4)            4     2     20979    COM                                                
 NTIM                       Scalar 15409    I(4)            4     2     20979    COM                                                
 NV                         Scalar 15418    I(4)            4     2     147      COM                                                
 NZHM                       Scalar 15412    I(4)            4     2     20979    COM                                                
 NZIM                       Scalar 15409    I(4)            4     2     20979    COM                                                
 PARAMS                     Common 15401                                148                                                         
 PIS                        Scalar 15417    R(4)            4     1     999      COM                                                
 PRNT                       Scalar 15402    R(4)            4           scalar   COM                                                
 QG                         Scalar 15416    R(4)            4     2     20979    COM                                                
 QHM                        Scalar 15407    R(4)            4     2     20979    COM              15457,15458                       
 QIM                        Scalar 15406    R(4)            4     2     20979    COM                                                
 QVM                        Scalar 15408    R(4)            4     2     20979    COM                                                
 RADPC                      Scalar 15401    R(4)            4           scalar   COM                                                
 SKB                        Scalar 15429    R(4)            4           scalar   COM                                                
 SKH                        Scalar 15425    R(4)            4     2     147      COM                                                
 SKHY                       Scalar 15428    R(4)            4     1     21       COM                                                
 SKI                        Scalar 15426    R(4)            4     2     147      COM                                                
 SKT                        Scalar 15427    R(4)            4     2     84       COM                                                
 SKV                        Scalar 15424    R(4)            4     2     147      COM                                                
 STATS                      Common 15418                                10940                                                       
 STDB                       Scalar 15423    R(4)            4           scalar   COM                                                
 STDH                       Scalar 15419    R(4)            4     2     147      COM              15447,15451,15455,15459           
 STDHY                      Scalar 15422    R(4)            4     1     21       COM                                                
 STDI                       Scalar 15420    R(4)            4     2     147      COM                                                
 STDT                       Scalar 15421    R(4)            4     2     84       COM                                                
 STDV                       Scalar 15418    R(4)            4     2     147      COM                                                
 TCLIM                      Scalar 15405    R(4)            4           scalar   COM                                                
 TDG                        Scalar 15416    R(4)            4     2     20979    COM                                                
 TDHM                       Scalar 15407    R(4)            4     2     20979    COM              15453,15454                       
 TDIM                       Scalar 15406    R(4)            4     2     20979    COM                                                
 TDVM                       Scalar 15408    R(4)            4     2     20979    COM                                                
 TFACT                      Scalar 15404    R(4)            4     2     84       COM                                                
 TG                         Scalar 15416    R(4)            4     2     20979    COM                                                
 THM                        Scalar 15407    R(4)            4     2     20979    COM              15449,15450                       
 TIM                        Scalar 15406    R(4)            4     2     20979    COM                                                
 TMPSTD                     Scalar 15404    R(4)            4     2     84       COM                                                
 TT                         Scalar 15402    R(4)            4           scalar   COM                                                
 TVM                        Scalar 15408    R(4)            4     2     20979    COM                                                
 VOIRES                     Scalar 15404    R(4)            4     2     84       COM                                                
 VTPPC                      Scalar 15401    R(4)            4           scalar   COM                                                
 XHORRES                    Subr   15396                                                                                            
 XINC                       Scalar 15403    R(4)            4     2     84       COM                                                
 XKB                        Scalar 15429    R(4)            4           scalar   COM                                                
 XKH                        Scalar 15425    R(4)            4     2     147      COM                                                
 XKHY                       Scalar 15428    R(4)            4     1     21       COM                                                
 XKI                        Scalar 15426    R(4)            4     2     147      COM                                                
 XKT                        Scalar 15427    R(4)            4     2     84       COM                                                
 XKV                        Scalar 15424    R(4)            4     2     147      COM                                                
 XMA                        Scalar 15401    R(4)            4           scalar   COM                                                
 XMI                        Scalar 15401    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 15430    R(4)            4           scalar   COM                                                
 XQHM                       Scalar 15415    R(4)            4     2     20979    COM              15440,15458                       
 XQIM                       Scalar 15411    R(4)            4     2     20979    COM                                                
 XTDHM                      Scalar 15414    R(4)            4     2     20979    COM              15439,15454                       

Page 525         Source Listing                  XHORRES
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XTDIM                      Scalar 15410    R(4)            4     2     20979    COM                                                
 XTDVM                      Scalar 15413    R(4)            4     2     20979    COM                                                
 XTHM                       Scalar 15413    R(4)            4     2     20979    COM              15438,15450                       
 XTIM                       Scalar 15410    R(4)            4     2     20979    COM                                                
 XTVM                       Scalar 15411    R(4)            4     2     20979    COM                                                
 XZHM                       Scalar 15412    R(4)            4     2     20979    COM              15437,15446                       
 XZIM                       Scalar 15410    R(4)            4     2     20979    COM                                                
 XZVM                       Scalar 15411    R(4)            4     2     20979    COM                                                
 YMA                        Scalar 15401    R(4)            4           scalar   COM                                                
 YMI                        Scalar 15401    R(4)            4           scalar   COM                                                
 ZCLIM                      Scalar 15405    R(4)            4           scalar   COM                                                
 ZG                         Scalar 15416    R(4)            4     2     20979    COM                                                
 ZHM                        Scalar 15407    R(4)            4     2     20979    COM              15445,15446                       
 ZIM                        Scalar 15406    R(4)            4     2     20979    COM                                                
 ZVM                        Scalar 15408    R(4)            4     2     20979    COM                                                

Page 526         Source Listing                  XHORRES
2017-04-18 11:07                                 cqcbufr.f

  15466 
  15467 C******************************************************************
  15468 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  15469 C                .      .    .                                       .
  15470 C SUBPROGRAM:    ZDIF        CALCULATE HEIGHT DIFF FROM NEIGHBORS
  15471 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
  15472 C
  15473 C ABSTRACT: Calculate height difference from nearest neighbors.
  15474 C
  15475 C PROGRAM HISTORY LOG:
  15476 C 1997-03-18  W. Collins  Original author.
  15477 C
  15478 C USAGE:    CALL ZDIF
  15479 C
  15480 C REMARKS: NONE.
  15481 C
  15482 C ATTRIBUTES:
  15483 C   LANGUAGE: FORTRAN 90
  15484 C   MACHINE:  NCEP WCOSS
  15485 C
  15486 C$$$
  15487 
  15488       SUBROUTINE ZDIF
  15489       PARAMETER (NST=999)
  15490 
  15491       REAL(8) BMISS
  15492 
  15493       REAL             VI(255,4), VR(255,4), CC(4)
  15494       INTEGER          LEV(4), IL(255,4)
  15495       COMMON /RESID/   PI(255), ZI(255), TI(255), TDI(255), QI(255),
  15496      &                 TL(255), ZV(255), TV(255), TDV(255), QV(255),
  15497      &                 NZI(255),NTI(255),NTDI(255),NQI(255),
  15498      &                 XZI(255),XTI(255),XTDI(255),XQI(255),
  15499      &                 NTL(255),NZV(255),NTV(255),NTDV(255),NQV(255),
  15500      &                 XZV(255),XTV(255),XTDV(255),XQV(255),
  15501      &                 HYDN(21),HYDQ(21),HYDS(21),HYD(21),  NHYD(21),
  15502      &                 IHSC(4,255),BASRES(NST), PSINC, TLSAT(255),
  15503      &                 B(21), NBAS, ZD(255),NHYDN(21),XZH(255),XTH(255),
  15504      &                 XTDH(255)
  15505       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
  15506      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
  15507       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
  15508 
  15509       LOGICAL ZG, TG, TDG, QG, ERROR, PRNT
  15510 
  15511       DO L=1,NLEV
  15512         ZM = BMISS
  15513         IF(L.EQ.1) GOTO 10
  15514         DO I=L-1,1,-1
  15515           IF(ZI(I).NE.BMISS) THEN
  15516             ZM = ZI(I)
  15517             GOTO 10
  15518           ENDIF
  15519         ENDDO
  15520    10   CONTINUE
  15521 
  15522         Z0 = BMISS

Page 527         Source Listing                  ZDIF
2017-04-18 11:07                                 cqcbufr.f

  15523         IF(ZI(L).NE.BMISS) Z0 = ZI(L)
  15524 
  15525         ZP = BMISS
  15526         IF(L.EQ.NLEV) GOTO 20
  15527         DO I=L+1,NLEV
  15528           IF(ZI(I).NE.BMISS) THEN
  15529             ZP = ZI(I)
  15530             GOTO 20
  15531           ENDIF
  15532         ENDDO
  15533    20   CONTINUE
  15534 
  15535         IF(Z0.NE.BMISS) THEN
  15536           IF(ZM.NE.BMISS .AND. ZP.NE.BMISS) THEN
  15537             ZD(L) = Z0 - 0.5*(ZM+ZP)
  15538           ELSEIF(ZM.NE.BMISS .AND. ZP.EQ.BMISS) THEN
  15539             ZD(L) = Z0 - ZM
  15540           ELSEIF(ZP.NE.BMISS .AND. ZM.EQ.BMISS) THEN
  15541             ZD(L) = Z0 - ZP
  15542           ENDIF
  15543         ELSE
  15544           ZD(L) = ZI(L)
  15545         ENDIF
  15546       ENDDO
  15547 
  15548       RETURN
  15549       END


ENTRY POINTS

  Name             
                   
 zdif_             

Page 528         Source Listing                  ZDIF
2017-04-18 11:07 Symbol Table                    cqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  15520                                                          15513,15517                       
 20                         Label  15533                                                          15526,15530                       
 B                          Scalar 15503    R(4)            4     1     21       COM                                                
 BASRES                     Scalar 15502    R(4)            4     1     999      COM                                                
 BMISS                      Scalar 15491    R(8)            8           scalar   COM              15512,15515,15522,15523,15525,1552
                                                                                                  8,15535,15536,15538,15540         
 BUFRLIB_MISSING            Common 15507                                16                                                          
 CC                         Local  15493    R(4)            4     1     4                                                           
 CQCPC                      Scalar 15506    R(4)            4           scalar   COM                                                
 ERROR                      Local  15509    L(4)            4           scalar                                                      
 HYD                        Scalar 15501    R(4)            4     1     21       COM                                                
 HYDN                       Scalar 15501    R(4)            4     1     21       COM                                                
 HYDQ                       Scalar 15501    R(4)            4     1     21       COM                                                
 HYDS                       Scalar 15501    R(4)            4     1     21       COM                                                
 I                          Local  15514    I(4)            4           scalar                    15514,15515,15516,15527,15528,1552
                                                                                                  9                                 
 IHSC                       Scalar 15502    I(4)            4     2     1020     COM                                                
 IL                         Local  15494    I(4)            4     2     1020                                                        
 IMISS                      Scalar 15507    I(4)            4           scalar   COM                                                
 IPEVT                      Scalar 15506    I(4)            4           scalar   COM                                                
 ISC                        Scalar 15506    I(4)            4           scalar   COM                                                
 L                          Local  15511    I(4)            4           scalar                    15511,15513,15514,15523,15526,1552
                                                                                                  7,15537,15539,15541,15544         
 LEV                        Local  15494    I(4)            4     1     4                                                           
 LMAND                      Scalar 15506    I(4)            4     1     22       COM                                                
 LSFC                       Scalar 15506    I(4)            4           scalar   COM                                                
 MAND                       Scalar 15505    I(4)            4           scalar   COM                                                
 NBAS                       Scalar 15503    I(4)            4           scalar   COM                                                
 NHYD                       Scalar 15501    I(4)            4     1     21       COM                                                
 NHYDN                      Scalar 15503    I(4)            4     1     21       COM                                                
 NLEV                       Scalar 15505    I(4)            4           scalar   COM              15511,15526,15527                 
 NOBS                       Scalar 15505    I(4)            4           scalar   COM                                                
 NQI                        Scalar 15497    I(4)            4     1     255      COM                                                
 NQV                        Scalar 15499    I(4)            4     1     255      COM                                                
 NST                        Param  15489    I(4)            4           scalar                    15502                             
 NTDI                       Scalar 15497    I(4)            4     1     255      COM                                                
 NTDV                       Scalar 15499    I(4)            4     1     255      COM                                                
 NTI                        Scalar 15497    I(4)            4     1     255      COM                                                
 NTL                        Scalar 15499    I(4)            4     1     255      COM                                                
 NTV                        Scalar 15499    I(4)            4     1     255      COM                                                
 NZI                        Scalar 15497    I(4)            4     1     255      COM                                                
 NZV                        Scalar 15499    I(4)            4     1     255      COM                                                
 PARAMS                     Common 15505                                148                                                         
 PI                         Scalar 15495    R(4)            4     1     255      COM                                                
 PRNT                       Scalar 15506    L(4)            4           scalar   COM                                                
 PSINC                      Scalar 15502    R(4)            4           scalar   COM                                                
 QG                         Local  15509    L(4)            4           scalar                                                      
 QI                         Scalar 15495    R(4)            4     1     255      COM                                                
 QV                         Scalar 15496    R(4)            4     1     255      COM                                                
 RADPC                      Scalar 15505    R(4)            4           scalar   COM                                                
 RESID                      Common 15495                                41312                                                       

Page 529         Source Listing                  ZDIF
2017-04-18 11:07 Symbol Table                    cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TDG                        Local  15509    L(4)            4           scalar                                                      
 TDI                        Scalar 15495    R(4)            4     1     255      COM                                                
 TDV                        Scalar 15496    R(4)            4     1     255      COM                                                
 TG                         Local  15509    L(4)            4           scalar                                                      
 TI                         Scalar 15495    R(4)            4     1     255      COM                                                
 TL                         Scalar 15496    R(4)            4     1     255      COM                                                
 TLSAT                      Scalar 15502    R(4)            4     1     255      COM                                                
 TT                         Scalar 15506    R(4)            4           scalar   COM                                                
 TV                         Scalar 15496    R(4)            4     1     255      COM                                                
 VI                         Local  15493    R(4)            4     2     1020                                                        
 VR                         Local  15493    R(4)            4     2     1020                                                        
 VTPPC                      Scalar 15505    R(4)            4           scalar   COM                                                
 XMA                        Scalar 15505    R(4)            4           scalar   COM                                                
 XMI                        Scalar 15505    R(4)            4           scalar   COM                                                
 XMISS                      Scalar 15507    R(4)            4           scalar   COM                                                
 XQI                        Scalar 15498    R(4)            4     1     255      COM                                                
 XQV                        Scalar 15500    R(4)            4     1     255      COM                                                
 XTDH                       Scalar 15504    R(4)            4     1     255      COM                                                
 XTDI                       Scalar 15498    R(4)            4     1     255      COM                                                
 XTDV                       Scalar 15500    R(4)            4     1     255      COM                                                
 XTH                        Scalar 15503    R(4)            4     1     255      COM                                                
 XTI                        Scalar 15498    R(4)            4     1     255      COM                                                
 XTV                        Scalar 15500    R(4)            4     1     255      COM                                                
 XZH                        Scalar 15503    R(4)            4     1     255      COM                                                
 XZI                        Scalar 15498    R(4)            4     1     255      COM                                                
 XZV                        Scalar 15500    R(4)            4     1     255      COM                                                
 YMA                        Scalar 15505    R(4)            4           scalar   COM                                                
 YMI                        Scalar 15505    R(4)            4           scalar   COM                                                
 Z0                         Local  15522    R(4)            4           scalar                    15522,15523,15535,15537,15539,1554
                                                                                                  1                                 
 ZD                         Scalar 15503    R(4)            4     1     255      COM              15537,15539,15541,15544           
 ZDIF                       Subr   15488                                                                                            
 ZG                         Local  15509    L(4)            4           scalar                                                      
 ZI                         Scalar 15495    R(4)            4     1     255      COM              15515,15516,15523,15528,15529,1554
                                                                                                  4                                 
 ZM                         Local  15512    R(4)            4           scalar                    15512,15516,15536,15537,15538,1553
                                                                                                  9,15540                           
 ZP                         Local  15525    R(4)            4           scalar                    15525,15529,15536,15537,15538,1554
                                                                                                  0,15541                           
 ZV                         Scalar 15496    R(4)            4     1     255      COM                                                

Page 530         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 <Block Data>                      482                                                                                              
 ACCUM                      Subr   619                                                                                              
 ALLOW                      Common 486                                  456                                                         
 ALLOW                      Common 1828                                 456                                                         
 ALLOW                      Common 2749                                 456                                                         
 ALLOW                      Common 3327                                 456                                                         
 ALLOW                      Common 3580                                 456                                                         
 ALLOW                      Common 11746                                456                                                         
 ALLOW                      Common 13804                                456                                                         
 ALLSND                     Common 1124                                 34512                                                       
 ALLSND                     Common 1689                                 34512                                                       
 ALLSND                     Common 1790                                 34512                                                       
 ALLSND                     Common 2753                                 34512                                                       
 ALLSND                     Common 3289                                 34512                                                       
 ALLSND                     Common 3584                                 34512                                                       
 ALLSND                     Common 4209                                 34512                                                       
 ALLSND                     Common 4831                                 34512                                                       
 ALLSND                     Common 5260                                 34512                                                       
 ALLSND                     Common 5616                                 34512                                                       
 ALLSND                     Common 5800                                 34512                                                       
 ALLSND                     Common 6194                                 34512                                                       
 ALLSND                     Common 6537                                 34512                                                       
 ALLSND                     Common 6806                                 34512                                                       
 ALLSND                     Common 7213                                 34512    SAVE                                               
 ALLSND                     Common 7987                                 34512                                                       
 ALLSND                     Common 8330                                 34512                                                       
 ALLSND                     Common 8452                                 34512                                                       
 ALLSND                     Common 8758                                 34512                                                       
 ALLSND                     Common 9169                                 34512                                                       
 ALLSND                     Common 9394                                 34512                                                       
 ALLSND                     Common 9987                                 34512                                                       
 ALLSND                     Common 10256                                34512                                                       
 ALLSND                     Common 10553                                34512                                                       
 ALLSND                     Common 10979                                34512                                                       
 ALLSND                     Common 11750                                34512                                                       
 ALLSND                     Common 13063                                34512                                                       
 ALLSND                     Common 13206                                34512                                                       
 ALLSND                     Common 13388                                34512                                                       
 ALLSND                     Common 13609                                34512                                                       
 ALLSND                     Common 13767                                34512                                                       
 ALLSND                     Common 14316                                34512                                                       
 ALLSND                     Common 14790                                34512                                                       
 ALLSND                     Common 14925                                34512                                                       
 ALLSND                     Common 15035                                34512                                                       
 ALP                        Func   696      R(4)            4           scalar                    720,723,725                       
 ALSNDW                     Common 4839                                 17340                                                       
 ALSNDW                     Common 5268                                 17340                                                       
 ALSNDW                     Common 5624                                 17340                                                       
 ALSNDW                     Common 5808                                 17340                                                       
 ALSNDW                     Common 7034                                 17340                                                       
 ALSNDW                     Common 7235                                 17340    SAVE                                               

Page 531         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALSNDW                     Common 10561                                17340                                                       
 ALSNDW                     Common 15043                                17340                                                       
 ANLWT                      Func   768      R(4)            4           scalar                    792,794                           
 AREA                       Subr   842                                                                                              
 AUXLEVS                    Subr   919                                                                                              
 BEST                       Subr   1048                                                                                             
 BUFRLIB_MISSING            Common 322                                  16                                                          
 BUFRLIB_MISSING            Common 707                                  16                                                          
 BUFRLIB_MISSING            Common 1052                                 16                                                          
 BUFRLIB_MISSING            Common 1145                                 16                                                          
 BUFRLIB_MISSING            Common 1452                                 16                                                          
 BUFRLIB_MISSING            Common 1836                                 16                                                          
 BUFRLIB_MISSING            Common 2304                                 16                                                          
 BUFRLIB_MISSING            Common 2798                                 16                                                          
 BUFRLIB_MISSING            Common 3332                                 16                                                          
 BUFRLIB_MISSING            Common 3629                                 16                                                          
 BUFRLIB_MISSING            Common 4401                                 16                                                          
 BUFRLIB_MISSING            Common 4484                                 16                                                          
 BUFRLIB_MISSING            Common 4851                                 16                                                          
 BUFRLIB_MISSING            Common 5162                                 16                                                          
 BUFRLIB_MISSING            Common 5286                                 16                                                          
 BUFRLIB_MISSING            Common 5548                                 16                                                          
 BUFRLIB_MISSING            Common 5637                                 16                                                          
 BUFRLIB_MISSING            Common 5816                                 16                                                          
 BUFRLIB_MISSING            Common 6002                                 16                                                          
 BUFRLIB_MISSING            Common 6205                                 16                                                          
 BUFRLIB_MISSING            Common 6322                                 16                                                          
 BUFRLIB_MISSING            Common 6574                                 16                                                          
 BUFRLIB_MISSING            Common 6854                                 16                                                          
 BUFRLIB_MISSING            Common 7044                                 16                                                          
 BUFRLIB_MISSING            Common 7137                                 16                                                          
 BUFRLIB_MISSING            Common 7269                                 16       SAVE                                               
 BUFRLIB_MISSING            Common 7791                                 16                                                          
 BUFRLIB_MISSING            Common 8022                                 16                                                          
 BUFRLIB_MISSING            Common 8351                                 16                                                          
 BUFRLIB_MISSING            Common 8462                                 16                                                          
 BUFRLIB_MISSING            Common 8572                                 16                                                          
 BUFRLIB_MISSING            Common 8677                                 16                                                          
 BUFRLIB_MISSING            Common 8783                                 16                                                          
 BUFRLIB_MISSING            Common 9214                                 16                                                          
 BUFRLIB_MISSING            Common 9439                                 16                                                          
 BUFRLIB_MISSING            Common 9790                                 16                                                          
 BUFRLIB_MISSING            Common 10013                                16                                                          
 BUFRLIB_MISSING            Common 10297                                16                                                          
 BUFRLIB_MISSING            Common 10733                                16                                                          
 BUFRLIB_MISSING            Common 11014                                16                                                          
 BUFRLIB_MISSING            Common 11296                                16                                                          
 BUFRLIB_MISSING            Common 11491                                16                                                          
 BUFRLIB_MISSING            Common 11567                                16                                                          
 BUFRLIB_MISSING            Common 11775                                16                                                          
 BUFRLIB_MISSING            Common 11942                                16                                                          
 BUFRLIB_MISSING            Common 12209                                16                                                          
 BUFRLIB_MISSING            Common 13074                                16                                                          
 BUFRLIB_MISSING            Common 13230                                16                                                          
 BUFRLIB_MISSING            Common 13329                                16                                                          

Page 532         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFRLIB_MISSING            Common 13415                                16                                                          
 BUFRLIB_MISSING            Common 13537                                16                                                          
 BUFRLIB_MISSING            Common 13635                                16                                                          
 BUFRLIB_MISSING            Common 13809                                16                                                          
 BUFRLIB_MISSING            Common 14198                                16                                                          
 BUFRLIB_MISSING            Common 14364                                16                                                          
 BUFRLIB_MISSING            Common 14809                                16                                                          
 BUFRLIB_MISSING            Common 15048                                16                                                          
 BUFRLIB_MISSING            Common 15430                                16                                                          
 BUFRLIB_MISSING            Common 15507                                16                                                          
 CHANGE                     Subr   1115                                                                                             
 CHDIST                     Subr   1315                                                                                             
 CHECKIT                    Subr   1445                                                                                             
 CHKTMP                     Subr   1651                                                                                             
 CKPS                       Subr   1683                                                                                             
 COMPER                     Subr   1782                                                                                             
 CONSTS                     Common 489                                  20                                                          
 CONSTS                     Common 1143                                 20                                                          
 CONSTS                     Common 1829                                 20                                                          
 CONSTS                     Common 2791                                 20                                                          
 CONSTS                     Common 3622                                 20                                                          
 CONSTS                     Common 6121                                 20                                                          
 CONSTS                     Common 6570                                 20                                                          
 CONSTS                     Common 7245                                 20       SAVE                                               
 CONSTS                     Common 8350                                 20                                                          
 CONSTS                     Common 13801                                20                                                          
 COORS                      Subr   2138                                                                                             
 CORP                       Common 6321                                 6072                                                        
 CORP                       Common 10728                                6072                                                        
 COUNT                      Common 15309                                1649576                                                     
 CUMPROB                    Func   2210     R(4)            4           scalar                    2228,2234                         
 DATEX                      Common 5636                                 30                                                          
 DATEX                      Common 6203                                 30                                                          
 DATEX                      Common 7240                                 30       SAVE                                               
 DATEX                      Common 7785                                 30                                                          
 DATEX                      Common 10301                                30                                                          
 DATEX                      Common 10593                                30                                                          
 DATEX                      Common 11013                                30                                                          
 DATEX                      Common 11565                                30                                                          
 DATEX                      Common 12206                                30                                                          
 DATEX                      Common 12946                                30                                                          
 DATEX                      Common 14935                                30                                                          
 DHOR                       Subr   2268                                                                                             
 DISTR                      Subr   2399                                                                                             
 DMA                        Subr   2509                                                                                             
 DOTYP40                    Common 321                                  4                                                           
 DOTYP40                    Common 2519                                 4                                                           
 DRCTSL                     Subr   2592                                                                                             
 ERR123                     Subr   2744                                                                                             
 ERR5                       Subr   3281                                                                                             
 ERR710                     Subr   3575                                                                                             
 ERRTYP                     Subr   4203                                                                                             
 EVENT                      Subr   4396                                                                                             
 EVENTS                     Common 314                                  156004                                                      
 EVENTS                     Common 1132                                 156004                                                      

Page 533         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 EVENTS                     Common 2291                                 156004                                                      
 EVENTS                     Common 4564                                 156004                                                      
 EVENTS                     Common 9911                                 156004                                                      
 EVENTS                     Common 11557                                156004                                                      
 EVENTS                     Common 12900                                156004                                                      
 EVENTW                     Subr   4479                                                                                             
 EVNBUF                     Common 4570                                 132004                                                      
 EVNBUF                     Common 8773                                 132004                                                      
 EVNSND                     Common 925                                  26520                                                       
 EVNSND                     Common 5273                                 26520                                                       
 EVNSND                     Common 8766                                 26520                                                       
 EVNSND                     Common 14798                                26520                                                       
 EVPROC                     Subr   4561                                                                                             
 FILALL                     Subr   4823                                                                                             
 FILES                      Common 311                                  24                                                          
 FILES                      Common 494                                  24                                                          
 FILES                      Common 621                                  24                                                          
 FILES                      Common 932                                  24                                                          
 FILES                      Common 7243                                 24       SAVE                                               
 FILES                      Common 8780                                 24                                                          
 FILES                      Common 9728                                 24                                                          
 FILES                      Common 9917                                 24                                                          
 FILES                      Common 10592                                24                                                          
 FILES                      Common 11011                                24                                                          
 FILES                      Common 12948                                24                                                          
 FILES                      Common 14807                                24                                                          
 FILES                      Common 14933                                24                                                          
 FILL                       Subr   5150                                                                                             
 FULVAL                     Subr   5252                                                                                             
 FUZZY                      Subr   5543                                                                                             
 GETINC                     Subr   5605                                                                                             
 GETLEV                     Subr   5791                                                                                             
 GETOB                      Subr   5981                                                                                             
 GETPS                      Subr   6120                                                                                             
 HEADER                     Common 922                                  35980                                                       
 HEADER                     Common 1121                                 35980                                                       
 HEADER                     Common 1686                                 35980                                                       
 HEADER                     Common 1787                                 35980                                                       
 HEADER                     Common 2511                                 35980                                                       
 HEADER                     Common 2750                                 35980                                                       
 HEADER                     Common 3286                                 35980                                                       
 HEADER                     Common 3581                                 35980                                                       
 HEADER                     Common 4206                                 35980                                                       
 HEADER                     Common 4846                                 35980                                                       
 HEADER                     Common 5257                                 35980                                                       
 HEADER                     Common 5613                                 35980                                                       
 HEADER                     Common 5797                                 35980                                                       
 HEADER                     Common 6191                                 35980                                                       
 HEADER                     Common 6314                                 35980                                                       
 HEADER                     Common 7210                                 35980    SAVE                                               
 HEADER                     Common 7788                                 35980                                                       
 HEADER                     Common 7984                                 35980                                                       
 HEADER                     Common 8755                                 35980                                                       
 HEADER                     Common 9166                                 35980                                                       
 HEADER                     Common 9391                                 35980                                                       

Page 534         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HEADER                     Common 9984                                 35980                                                       
 HEADER                     Common 10264                                35980                                                       
 HEADER                     Common 10550                                35980                                                       
 HEADER                     Common 10730                                35980                                                       
 HEADER                     Common 10976                                35980                                                       
 HEADER                     Common 11290                                35980                                                       
 HEADER                     Common 11747                                35980                                                       
 HEADER                     Common 12197                                35980                                                       
 HEADER                     Common 13606                                35980                                                       
 HEADER                     Common 13764                                35980                                                       
 HEADER                     Common 14786                                35980                                                       
 HEADER                     Common 14922                                35980                                                       
 HEADER                     Common 15032                                35980                                                       
 HOLES                      Subr   6186                                                                                             
 HORRES                     Subr   6279                                                                                             
 HSC                        Subr   6532                                                                                             
 HYDSTUF                    Common 312                                  64                                                          
 HYDSTUF                    Common 1138                                 64                                                          
 HYDSTUF                    Common 1833                                 64                                                          
 HYDSTUF                    Common 2517                                 64                                                          
 HYDSTUF                    Common 2795                                 64                                                          
 HYDSTUF                    Common 3329                                 64                                                          
 HYDSTUF                    Common 3626                                 64                                                          
 HYDSTUF                    Common 4230                                 64                                                          
 HYDSTUF                    Common 9210                                 64                                                          
 HYDSTUF                    Common 9435                                 64                                                          
 HYDSTUF                    Common 10005                                64                                                          
 HYDSTUF                    Common 11772                                64                                                          
 HYDSTUF                    Common 13228                                64                                                          
 HYDSTUF                    Common 13327                                64                                                          
 HYDSTUF                    Common 13409                                64                                                          
 HYDSTUF                    Common 13535                                64                                                          
 HYDSTUF                    Common 13806                                64                                                          
 INC                        Common 4844                                 5100                                                        
 INC                        Common 5280                                 5100                                                        
 INC                        Common 5631                                 5100                                                        
 INCR                       Subr   6801                                                                                             
 INCRW                      Subr   7029                                                                                             
 INCW                       Common 4845                                 4080                                                        
 INCW                       Common 5281                                 4080                                                        
 INCW                       Common 5632                                 4080                                                        
 INIT                       Subr   7120                                                                                             
 INPUT                      Subr   7202                                                                                             
 INPUT2                     Subr   7775                                                                                             
 ISGOOD                     Subr   7979                                                                                             
 ISO                        Common 8232                                 4004                                                        
 ISO                        Common 10010                                4004                                                        
 ISO                        Common 11294                                4004                                                        
 ISO                        Common 15264                                4004                                                        
 ISOLAT                     Subr   8225                                                                                             
 ISORT                      Subr   8282                                                                                             
 LAPSE                      Subr   8325                                                                                             
 LEV926                     Common 484                                  4008                                                        
 LEVEL                      Common 490                                  84                                                          
 LEVEL                      Common 7997                                 84                                                          

Page 535         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LEVEL                      Common 10729                                84                                                          
 LEVEL                      Common 12205                                84                                                          
 LEVEL                      Common 13632                                84                                                          
 LEVEL                      Common 13800                                84                                                          
 LEVTYPS                    Subr   8447                                                                                             
 LIMS                       Common 491                                  1776                                                        
 LIMS                       Common 1825                                 1776                                                        
 LIMS                       Common 2297                                 1776                                                        
 LIMS                       Common 2788                                 1776                                                        
 LIMS                       Common 3324                                 1776                                                        
 LIMS                       Common 3619                                 1776                                                        
 LIMS                       Common 6317                                 1776                                                        
 LIMS                       Common 6567                                 1776                                                        
 LIMS                       Common 6848                                 1776                                                        
 LIMS                       Common 9204                                 1776                                                        
 LIMS                       Common 9429                                 1776                                                        
 LIMS                       Common 11768                                1776                                                        
 LIMS                       Common 12200                                1776                                                        
 LIMS                       Common 13224                                1776                                                        
 LIMS                       Common 13323                                1776                                                        
 LIMS                       Common 13406                                1776                                                        
 LIMS                       Common 13532                                1776                                                        
 LIMS                       Common 13627                                1776                                                        
 LIMS                       Common 13797                                1776                                                        
 LIMS                       Common 14195                                1776                                                        
 LIMS                       Common 14358                                1776                                                        
 LIMS                       Common 15403                                1776                                                        
 LMANLV                     Func   8565     I(4)            4           scalar                    8629,8634,8636                    
 LOGS                       Common 706                                  56000                                                       
 LTP                        Common 937                                  27544                                                       
 LTP                        Common 4850                                 27544                                                       
 LTP                        Common 5283                                 27544                                                       
 LTP                        Common 5634                                 27544                                                       
 LTP                        Common 5814                                 27544                                                       
 MANLEV                     Func   8670     I(4)            4           scalar                    8710,8715,8717                    
 MANRES                     Common 1808                                 2949048                                                     
 MANRES                     Common 2274                                 2949048                                                     
 MANRES                     Common 2771                                 2949048                                                     
 MANRES                     Common 3307                                 2949048                                                     
 MANRES                     Common 3602                                 2949048                                                     
 MANRES                     Common 4585                                 2949048                                                     
 MANRES                     Common 6290                                 2949048                                                     
 MANRES                     Common 6555                                 2949048                                                     
 MANRES                     Common 6824                                 2949048                                                     
 MANRES                     Common 7125                                 2949048                                                     
 MANRES                     Common 7223                                 2949048  SAVE                                               
 MANRES                     Common 7998                                 2949048                                                     
 MANRES                     Common 9187                                 2949048                                                     
 MANRES                     Common 9412                                 2949048                                                     
 MANRES                     Common 10277                                2949048                                                     
 MANRES                     Common 10566                                2949048                                                     
 MANRES                     Common 10987                                2949048                                                     
 MANRES                     Common 12170                                2949048                                                     
 MANRES                     Common 13785                                2949048                                                     
 MANRES                     Common 14334                                2949048                                                     

Page 536         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MANRES                     Common 15406                                2949048                                                     
 MANRSW                     Common 7039                                 335664                                                      
 MANRSW                     Common 10588                                335664                                                      
 MANSND                     Common 7221                                 168344   SAVE                                               
 MANSND                     Common 10293                                168344                                                      
 MANSND                     Common 11018                                168344                                                      
 MANSND                     Common 14193                                168344                                                      
 MANSND                     Common 14938                                168344                                                      
 MASEVN                     Subr   8750                                                                                             
 MIMAP                      Subr   8973                                                                                             
 NMANLV                     Func   9087     I(4)            4           scalar                    9127,9129,9131                    
 NO40S                      Common 10012                                8                                                           
 NO40S                      Common 12208                                8                                                           
 NOBERR                     Subr   9161                                                                                             
 OBERR                      Subr   9386                                                                                             
 OBLIST                     Common 8977                                 264644                                                      
 OBLIST                     Common 10727                                264644                                                      
 OBLIST                     Common 11289                                264644                                                      
 OUTPUT                     Subr   9727                                                                                             
 PARAMS                     Common 309                                  148                                                         
 PARAMS                     Common 487                                  148                                                         
 PARAMS                     Common 933                                  148                                                         
 PARAMS                     Common 1141                                 148                                                         
 PARAMS                     Common 1697                                 148                                                         
 PARAMS                     Common 1830                                 148                                                         
 PARAMS                     Common 2301                                 148                                                         
 PARAMS                     Common 2514                                 148                                                         
 PARAMS                     Common 2792                                 148                                                         
 PARAMS                     Common 3623                                 148                                                         
 PARAMS                     Common 4227                                 148                                                         
 PARAMS                     Common 5629                                 148                                                         
 PARAMS                     Common 6288                                 148                                                         
 PARAMS                     Common 6571                                 148                                                         
 PARAMS                     Common 6851                                 148                                                         
 PARAMS                     Common 7041                                 148                                                         
 PARAMS                     Common 7241                                 148      SAVE                                               
 PARAMS                     Common 7786                                 148                                                         
 PARAMS                     Common 7995                                 148                                                         
 PARAMS                     Common 8348                                 148                                                         
 PARAMS                     Common 8460                                 148                                                         
 PARAMS                     Common 8778                                 148                                                         
 PARAMS                     Common 9207                                 148                                                         
 PARAMS                     Common 9432                                 148                                                         
 PARAMS                     Common 10008                                148                                                         
 PARAMS                     Common 10295                                148                                                         
 PARAMS                     Common 10590                                148                                                         
 PARAMS                     Common 11009                                148                                                         
 PARAMS                     Common 11489                                148                                                         
 PARAMS                     Common 11563                                148                                                         
 PARAMS                     Common 12203                                148                                                         
 PARAMS                     Common 13071                                148                                                         
 PARAMS                     Common 13411                                148                                                         
 PARAMS                     Common 13630                                148                                                         
 PARAMS                     Common 13802                                148                                                         
 PARAMS                     Common 14191                                148                                                         

Page 537         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PARAMS                     Common 14361                                148                                                         
 PARAMS                     Common 14805                                148                                                         
 PARAMS                     Common 15401                                148                                                         
 PARAMS                     Common 15505                                148                                                         
 PATZ                       Subr   9786                                                                                             
 PEROR                      Common 936                                  8                                                           
 PEROR                      Common 4849                                 8                                                           
 PEROR                      Common 5282                                 8                                                           
 PEROR                      Common 5633                                 8                                                           
 PEROR                      Common 5813                                 8                                                           
 PEROR                      Common 9212                                 8                                                           
 PEROR                      Common 9437                                 8                                                           
 PEROR                      Common 10007                                8                                                           
 PEVENTS                    Subr   9909                                                                                             
 POBERR                     Subr   9978                                                                                             
 PREPOBS_CQCBUFR            Prog   301                                                                                              
 PRNTOUT                    Subr   10246                                                                                            
 PRSTNS                     Subr   10548                                                                                            
 QCOI                       Subr   10716                                                                                            
 RBLOCKS                    Subr   10971                                                                                            
 REGION                     Common 9983                                 9408                                                        
 REGION                     Common 12157                                9408                                                        
 RESID                      Common 1798                                 41312                                                       
 RESID                      Common 2761                                 41312                                                       
 RESID                      Common 3297                                 41312                                                       
 RESID                      Common 3592                                 41312                                                       
 RESID                      Common 4217                                 41312                                                       
 RESID                      Common 4575                                 41312                                                       
 RESID                      Common 6545                                 41312                                                       
 RESID                      Common 6814                                 41312                                                       
 RESID                      Common 8011                                 41312                                                       
 RESID                      Common 8338                                 41312                                                       
 RESID                      Common 9177                                 41312                                                       
 RESID                      Common 9402                                 41312                                                       
 RESID                      Common 9995                                 41312                                                       
 RESID                      Common 10267                                41312                                                       
 RESID                      Common 10578                                41312                                                       
 RESID                      Common 10999                                41312                                                       
 RESID                      Common 11758                                41312                                                       
 RESID                      Common 12187                                41312                                                       
 RESID                      Common 13214                                41312                                                       
 RESID                      Common 13313                                41312                                                       
 RESID                      Common 13396                                41312                                                       
 RESID                      Common 13522                                41312                                                       
 RESID                      Common 13617                                41312                                                       
 RESID                      Common 13775                                41312                                                       
 RESID                      Common 14324                                41312                                                       
 RESID                      Common 15495                                41312                                                       
 RESIDS                     Subr   11172                                                                                            
 ROUND                      Subr   11216                                                                                            
 SEARCH                     Subr   11281                                                                                            
 SERCH                      Common 6320                                 732                                                         
 SERCH                      Common 11293                                732                                                         
 SETTMP                     Subr   11481                                                                                            
 SEVENT                     Subr   11550                                                                                            

Page 538         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SHELL                      Subr   11663                                                                                            
 SIGERR                     Subr   11741                                                                                            
 SIMPLE                     Subr   11928                                                                                            
 SORT                       Subr   12075                                                                                            
 STAT                       Subr   12128                                                                                            
 STATS                      Common 6302                                 10940                                                       
 STATS                      Common 6836                                 10940                                                       
 STATS                      Common 12158                                10940                                                       
 STATS                      Common 14346                                10940                                                       
 STATS                      Common 15418                                10940                                                       
 STEVNTS                    Subr   12898                                                                                            
 STN                        Common 935                                  4                                                           
 STN                        Common 1140                                 4                                                           
 STN                        Common 1699                                 4                                                           
 STN                        Common 1832                                 4                                                           
 STN                        Common 2300                                 4                                                           
 STN                        Common 2516                                 4                                                           
 STN                        Common 2794                                 4                                                           
 STN                        Common 3328                                 4                                                           
 STN                        Common 3625                                 4                                                           
 STN                        Common 4229                                 4                                                           
 STN                        Common 5284                                 4                                                           
 STN                        Common 5635                                 4                                                           
 STN                        Common 5815                                 4                                                           
 STN                        Common 6202                                 4                                                           
 STN                        Common 6573                                 4                                                           
 STN                        Common 6853                                 4                                                           
 STN                        Common 7043                                 4                                                           
 STN                        Common 7244                                 4        SAVE                                               
 STN                        Common 8010                                 4                                                           
 STN                        Common 8781                                 4                                                           
 STN                        Common 9209                                 4                                                           
 STN                        Common 9434                                 4                                                           
 STN                        Common 10011                                4                                                           
 STN                        Common 10302                                4                                                           
 STN                        Common 10594                                4                                                           
 STN                        Common 11012                                4                                                           
 STN                        Common 11771                                4                                                           
 STN                        Common 13073                                4                                                           
 STN                        Common 13227                                4                                                           
 STN                        Common 13326                                4                                                           
 STN                        Common 13413                                4                                                           
 STN                        Common 13633                                4                                                           
 STN                        Common 13805                                4                                                           
 STN                        Common 14363                                4                                                           
 STN                        Common 14789                                4                                                           
 STN                        Common 14934                                4                                                           
 STNCNT                     Subr   12944                                                                                            
 STNKNT                     Common 7246                                 404      SAVE                                               
 STNKNT                     Common 12947                                404                                                         
 STYPE                      Subr   13058                                                                                            
 SWITCH                     Common 15308                                20                                                          
 T120                       Subr   13201                                                                                            
 T121                       Subr   13308                                                                                            
 T130                       Subr   13383                                                                                            

Page 539         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 T140                       Subr   13517                                                                                            
 T220                       Subr   13601                                                                                            
 T240                       Subr   13759                                                                                            
 TESTS                      Common 320                                  4                                                           
 TESTS                      Common 622                                  4                                                           
 TESTS                      Common 1144                                 4                                                           
 TESTS                      Common 1451                                 4                                                           
 TESTS                      Common 1835                                 4                                                           
 TESTS                      Common 2303                                 4                                                           
 TESTS                      Common 2520                                 4                                                           
 TESTS                      Common 2797                                 4                                                           
 TESTS                      Common 3331                                 4                                                           
 TESTS                      Common 3628                                 4                                                           
 TESTS                      Common 4232                                 4                                                           
 TESTS                      Common 4400                                 4                                                           
 TESTS                      Common 4483                                 4                                                           
 TESTS                      Common 5285                                 4                                                           
 TESTS                      Common 6204                                 4                                                           
 TESTS                      Common 7247                                 4        SAVE                                               
 TESTS                      Common 8021                                 4                                                           
 TESTS                      Common 8782                                 4                                                           
 TESTS                      Common 9213                                 4                                                           
 TESTS                      Common 9438                                 4                                                           
 TESTS                      Common 9729                                 4                                                           
 TESTS                      Common 10016                                4                                                           
 TESTS                      Common 11020                                4                                                           
 TESTS                      Common 11295                                4                                                           
 TESTS                      Common 11566                                4                                                           
 TESTS                      Common 11774                                4                                                           
 TESTS                      Common 11941                                4                                                           
 TESTS                      Common 12207                                4                                                           
 TESTS                      Common 12949                                4                                                           
 TESTS                      Common 13414                                4                                                           
 TESTS                      Common 13634                                4                                                           
 TESTS                      Common 13808                                4                                                           
 TESTS                      Common 14808                                4                                                           
 TESTS                      Common 14940                                4                                                           
 TMPCHK                     Subr   14179                                                                                            
 TMPSND                     Common 1820                                 1678336                                                     
 TMPSND                     Common 2286                                 1678336                                                     
 TMPSND                     Common 2783                                 1678336                                                     
 TMPSND                     Common 3319                                 1678336                                                     
 TMPSND                     Common 3614                                 1678336                                                     
 TMPSND                     Common 7780                                 1678336                                                     
 TMPSND                     Common 9199                                 1678336                                                     
 TMPSND                     Common 9424                                 1678336                                                     
 TMPSND                     Common 10289                                1678336                                                     
 TMPSND                     Common 11486                                1678336                                                     
 TMPSND                     Common 12182                                1678336                                                     
 TMPSND                     Common 14189                                1678336                                                     
 VOI                        Subr   14309                                                                                            
 VSOLVE                     Subr   14608                                                                                            
 VTPEVN                     Subr   14779                                                                                            
 WBLOCKS                    Subr   14919                                                                                            
 WINDATZ                    Subr   15022                                                                                            

Page 540         Source Listing                  ZDIF
2017-04-18 11:07 Subprograms/Common Blocks       cqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 WTISO                      Subr   15262                                                                                            
 WTSTATS                    Subr   15304                                                                                            
 XHORRES                    Subr   15396                                                                                            
 ZDIF                       Subr   15488                                                                                            

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape
       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__

Page 541         Source Listing                  ZDIF
2017-04-18 11:07                                 cqcbufr.f

       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : cqcbufr.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
