Page 1           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

      1 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      2 C
      3 C SUBPROGRAM:    RADEVN      PREPARES REPORT FOR RADIATION CORRECTIONS
      4 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2013-02-05
      5 C
      6 C ABSTRACT: PREPARES FOR RADIOSONDE HEIGHT AND TEMPERATURE CORRECTIONS
      7 C   DUE TO INTERSONDE DIFFERENCES (MAINLY RADIATIVE EFFECTS ON THE
      8 C   INSTRUMENT (SEE REMARKS FOR LEVELS).  THE SOLAR HOUR ANGLE AND
      9 C   SOLAR ELEVATION ANGLE ARE CALCULATED. THE PROPER SUBROUTINE
     10 C   CONTAINING CORRECTION TABLES IS THEN CALLED.  THE CORRECTIONS ARE
     11 C   THEN APPLIED DIRECTLY TO THE MANDATORY LEVELS, AND (FOR THE
     12 C   "NEWER" TABLES) THE TEMPERATURE CORRECTIONS ARE INTERPOLETED TO
     13 C   THE SURFACE, SIGINIFICANT AND TROPOSPHERIC LEVELS.  THIS SUBROUTINE
     14 C   HANDLES ONE REPORT AT A TIME.
     15 C
     16 C PROGRAM HISTORY LOG:
     17 C 1994-02-27  J. WOOLLEN   -- COPIED FROM ORIGINAL "GETRAD" SUROUTINE
     18 C     WHICH WAS PART OF RADNCORR PROGRAM, AND CONVERTED FOR USE WITH
     19 C     BUFR
     20 C 1996-02-20  D. KEYSER    -- CORRECTED PROBLEM OF DOUBLE CORRECTION
     21 C     OF HEIGHTS AND TEMPERATURES AT AND ABOVE 10 MB WHICH CAN OCCUR
     22 C     DUE TO IMPRECISION IN STORAGE OF PRESSURE OB
     23 C 2002-07-22  D. KEYSER    -- IF BALLOON DRIFT COORDINATES (LAT/LON/
     24 C     D-TIM) ARE AVAILABLE, WILL USE THESE TO MORE PRECISELY OBTAIN
     25 C     ESTIMATED SUN ANGLE (DONE IN NEW SUBROUTINE SOELAN); MORE
     26 C     INFO RE RADCOR NOW WRITTEN TO UNIT 68
     27 C 2007-09-14  D. KEYSER    -- INCREASED THE UPPER-LIMIT FOR THE NUMBER
     28 C     OF RAOB IDS STORED BY RADIOSONDE TYPE IN ARRAY SIDRAD (FOR LATER
     29 C     LISTING AT THE END OF THE MAIN PROGRAM WHEN SUMMARIZING RADCOR
     30 C     STATS) FROM 400 TO 800 SINCE SOME REANALYSIS RUNS WERE EXCEEDING
     31 C     THE OLD LIMIT CAUSING ARRAY OVERFLOW (AND MEMORY CLOBBERING)
     32 C     ISSUES; INCREASED MAXIMUM NUMBER OF RADIOSONDE STATIONS THAT CAN
     33 C     BE PROCESSED FROM 899 TO 999 (ONE REANLYSIS RUN HIT THIS LIMIT)
     34 C 2008-04-10  D. A. KEYSER -- CAN HANDLE RADIOSONDE TYPES > 99 WHICH
     35 C     WILL SOON BE INTRODUCED INTO THE BUFR DATABASE (BASED ON NOVEMBER
     36 C     2007 WMO BUFR UPDATE)
     37 C 2008-10-08  D. A. KEYSER -- NOW PROCESSES RADIOSONDE TYPES > 111 AND
     38 C     < 255 RATHER THAN SETTING THEM TO MISSING (255), EVEN THOUGH
     39 C     THERE ARE CURRENTLY NO VALID TYPES > 111; MODIFIED TO RE-INDEX
     40 C     ARRAY "SOLAR" (SUN ANGLE ON MAND. LVLS) IN OLDEST SET OF
     41 C     CORRECTIONS (SUBR. RADT1) SO THAT THE CORRECT VALUES RETURNED
     42 C     FROM SUBR. SOELAN ARE USED FOR CASES WHERE BALLOON DRIFT
     43 C     INFORMATION IS PRESENT (ONLY APPLIES TO REANALYSIS SINCE BALLOON
     44 C     DRIFT WAS NOT AVAILABLE BACK WHEN SUBR. RADT1 WAS CALLED IN REAL-
     45 C     TIME RUNS, SUBR. RADT1 IS NEVER CALLED IN CURRENT REAL-TIME RUNS
     46 C     ANYWAY); MODIFIED TO RE-INDEX ARRAY "SOLAR" IN SUBR. SOELAN FOR
     47 C     CASES INVOLVING THE OLDEST SET OF CORRECTIONS AND WHERE BALLOON
     48 C     DRIFT INFORMATION WAS NOT AVAILABLE SO THAT PROPER VALUES ARE
     49 C     RETURNED TO CALLING SUBR. RADT1 (ONLY APPLIES TO REANALYSIS SINCE
     50 C     SUBR. RADT1 IS NEVER CALLED IN CURRENT REAL-TIME RUNS); UPDATED
     51 C     LIST OF RADIOSONDE TYPES IN NEWEST CORRECTION SUBR. (RADT5) TO
     52 C     CONFORM WITH LATEST (NOV. 2007) WMO BUFR CODE TABLE 0-02-011
     53 C 2008-11-19  D. A. KEYSER -- UPDATED NEWEST CORRECTION SUBR. (RADT5)
     54 C     TO RECOGNIZE RADIOSONDE TYPES CONFORMING WITH LATEST (NOV. 2008)
     55 C     WMO BUFR CODE TABLE 0-02-011 AND TO PRODUCE MORE SPECIFIC
     56 C     DIAGNOSTIC PRINT RELATED TO RADIOSONDE TYPES ENCOUNTERED (I.E.,
     57 C     INVALID, OBSOLETE, VACANT, ETC.)

Page 2           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

     58 C 2012-11-20  J. WOOLLEN  INITIAL PORT TO WCOSS 
     59 C 2013-02-05  D. Keyser   Final changes to run on WCOSS: Set BUFRLIB
     60 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
     61 C     overflow; use formatted print statements where previously
     62 C     unformatted print was > 80 characters.
     63 C
     64 C USAGE:    CALL RADENV
     65 C
     66 C   OUTPUT FILES:
     67 C     UNIT 06  - PRINTOUT
     68 C     UNIT 68  - RADCOR INFORMATION FILE
     69 C
     70 C REMARKS: CORRECTIONS ARE APPLIED AT AND ABOVE THE FOLLOWING LEVELS
     71 C   BASED ON VARIABLE "IRCTBL":
     72 C                          IRCTBL = 1 --  100 MB ;
     73 C                          IRCTBL = 2 --  700 MB ;
     74 C                          IRCTBL = 3 -- 1000 MB ;
     75 C                          IRCTBL = 4 --  700 MB ;
     76 C                          IRCTBL = 5 --  700 MB ;
     77 C   CALLED BY SUBROUTINE "DMA22".
     78 C
     79 C ATTRIBUTES:
     80 C   LANGUAGE: FORTRAN 90
     81 C   MACHINE:  NCEP WCOSS
     82 C
     83 C$$$
     84       SUBROUTINE RADEVN
     85       PARAMETER (NST=999)
     86       PARAMETER (NRID=800) ! max # of raob ids listed per inst. type
     87 
     88       REAL(8) BMISS
     89       REAL             SOLAR(16)
     90       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
     91      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
     92      &                 NEV, ISF(NST), NLVM, NLVW
     93       COMMON /STN/     IS
     94       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
     95      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
     96      &                 TOB(255), TFC(255), TQM(255), TRC(255),
     97      &                 TDO(255), TDFC(255),TVO(255),
     98      &                 QOB(255), QFC(255), QQM(255), QRC(255),
     99      &                 CAT(255), IND(255), LEVTYP(255),
    100      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
    101      &                 YDR(255), XDR(255)
    102 
    103       COMMON /EVNSND/ PO (255),TO (255),ZO (255),CA (255),
    104      &                PQ (255),TQ (255),ZQ (255),INP(255),
    105      &                PR (255),TR (255),ZR (255),INZ(255),
    106      &                QO (255),QQ (255),QR (255),INT(255),
    107      &                TDW(255),TDQ(255),TDR(255),INQ(255),
    108      &                UO(255), VO(255), SPO(255), DIRO(255),
    109      &                WQ(255), WR(255)
    110       COMMON /RADCOM/ HGT(16),TMP(16),DHT(16),DTP(16),JTYPE
    111       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
    112       COMMON /PMAND / PRES(16),KMIN,KMAX,INM(16)
    113       COMMON/COUNT/   NTYPE(69),KTYPE(69),SIDNOR(2000),SIDRAD(NRID,255),
    114      &                IICNT,JJCNT(255)

Page 3           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    115       COMMON /DATEX/   IDATE(5), CDATE
    116       COMMON /FILES/   NFIN, NFOUT, NFEVN, NFSUM, NFSTN, NFSGL
    117       COMMON /PARAMS/  MAND,NOBS,XMI,XMA,YMI,YMA,NLEV,VTPPC,RADPC,
    118      &                 LMAND(0:21),LSFC,ISC,IPEVT,PRNT,CQCPC,TT
    119       COMMON /TESTS/   TEST
    120       COMMON /DATE_IDT/IDT
    121       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
    122 
    123       LOGICAL          TEST, HGTTBL, BAL_DRIFT
    124 
    125       CHARACTER*1  VAR(2)
    126       CHARACTER*40 TEVN,ZEVN
    127       CHARACTER*8  SID, SIDNOR, SIDRAD
    128       CHARACTER*10     CDATE
    129       DIMENSION    KPRES(21),IFIRST(255)
    130       LOGICAL      INIT,NOSWC, PRNT
    131 
    132       DATA KPRES /1000 , 925 , 850 , 700 , 500 , 400 , 300,
    133      .             250 , 200 , 150 , 100 ,  70 ,  50 ,  30,
    134      .              20 ,  10 ,   7 ,   5 ,   3 ,   2 ,   1/
    135       DATA TEVN  /'TOB TQM TPC TRC                         '/
    136       DATA ZEVN  /'ZOB ZQM ZPC ZRC                         '/
    137       DATA INIT  /.TRUE./
    138       DATA VAR   /'Z','T'/
    139       DATA IFIRST /255*0/
    140 
    141 C-----------------------------------------------------------------------
    142 C-----------------------------------------------------------------------
    143 
    144 C  FIRST TIME CALL PREP TO READ NAMELISTS AND SET PARAMETERS
    145 C  ---------------------------------------------------------
    146 
    147       IF(INIT) THEN
    148          INIT = .FALSE.
    149          LEVRAD = 0
    150          NTYPE = 99999
    151          KTYPE = 0
    152          IICNT = 0
    153          JJCNT = 0
    154          SIDNOR = '        '
    155          SIDRAD = '        '
    156          PRINT 321, IDATE
    157          WRITE(68,321)  IDATE
    158   321 FORMAT(//23X,'WELCOME TO THE RADIOSONDE INTERSONDE (RADIATION) ',
    159      $ 'CORRECTION PART OF THE CQC PROGRAM'/53X,'LAST UPDATED 05 FEB ',
    160      $ '2013'///45X,'DATE FROM BUFR MESSAGES IS: ',I3.2,I2.2,3I3.2//)
    161          WRITE(68,322)  CDATE
    162   322    FORMAT(3X,'CDATE is ',A)
    163          CALL PREP(IDATE)
    164          PRES = KPRES(1:16)
    165       ENDIF
    166 
    167 C  INITIALIZE ALL UNCORRECTED HEIGHTS AND TEMPS AS MISSING
    168 C  -------------------------------------------------------
    169 
    170       KMIN  = LEVRAD
    171       KMAX  = 16

Page 4           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    172       DHT   = 0
    173       DTP   = 0
    174       NEV   = 0
    175       TMP   = BMISS
    176       HGT   = BMISS
    177       TO    = BMISS
    178       ZO    = BMISS
    179       IN    = BMISS
    180       INM   = 0
    181 
    182 
    183       ALON  = MOD(720.+360.-XOB(IS),360.)
    184       JTYPE = ITP(IS)
    185       IF(JTYPE.LE.0 .OR. (JTYPE.GE.255.AND.JTYPE.NE.20000)) JTYPE = 255
    186       IF(JTYPE.NE.20000)  CALL TAB(JTYPE) ! (inst. type may be set to
    187                                           !  20000 for special cases in
    188                                           !  cqcbufr.f)
    189 
    190       IF(IRCTBL.EQ.1)  THEN
    191 
    192 C  COME HERE FOR IRCTBL=1 CORRECTIONS (OLDEST TABLES)
    193 C  --------------------------------------------------
    194 
    195 C     NEW CHECKS FOR THE NEW RADIOSONDE TYPES
    196 C     ---------------------------------------
    197 
    198          IF(JTYPE.EQ.14)  JTYPE =  4  ! VAISALA (IN/OUT OF FINLAND)
    199 
    200          IF(JTYPE.EQ.20)  JTYPE = 12  ! RUSSIAN RKZ
    201          IF(JTYPE.EQ.21)  JTYPE = 12  ! UNKNOWN RUSSIAN
    202 
    203 C     NEW CHECKS FOR THE OLD RADIOSONDE TYPES
    204 C     ---------------------------------------
    205 
    206 C        EXCLUDE CHINESE (WMO BLOCKS 50-59) FROM RUSSIAN TYPE
    207 C        ----------------------------------------------------
    208 
    209          IF(SID(IS)(1:1).EQ.'5')  JTYPE = 19
    210 
    211       ENDIF
    212 
    213       BAL_DRIFT = .TRUE.
    214 
    215 C  FILL THE MANDATORY LEVEL EVENT AND CORRECTION ARRAYS FOR THIS REPORT
    216 C  --------------------------------------------------------------------
    217 
    218       DO L=1,NLV
    219          M = MANLEV(POB(L))
    220          IF(M.GT.0 .AND. M.LE.KMAX) THEN
    221             TMP(M) = TOB(L)
    222             HGT(M) = ZOB(L)
    223             INM(M)  = L
    224             IF(MAX(HRDR(INM(M)),XDR(INM(M)),YDR(INM(M))).GE.BMISS)
    225      $       BAL_DRIFT = .FALSE.
    226          ENDIF
    227       ENDDO
    228 

Page 5           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    229       WRITE (68,*)
    230       IF(.NOT.BAL_DRIFT) THEN
    231          WRITE(68,'(" Report ",A," does not have balloon drift ",
    232      &    "coordinates - use ""old"" method for determining sun ",
    233      &    "angle")') SID(IS)
    234       ELSE
    235          WRITE(68,'(" Report ",A," has balloon drift coordinates - use",
    236      &    " ""new"" method for determining sun angle")') SID(IS)
    237       END IF
    238 
    239 C  CALL APPROPRIATE SUBROUTINE TO APPLY CORRECTIONS - SAVE DELTAS
    240 C  --------------------------------------------------------------
    241 
    242       IF(IRCTBL.EQ.1)  CALL RADT1(NOSWC,IRET)
    243       IF(IRCTBL.EQ.2)  CALL RADT2(NOSWC,IRET)
    244       IF(IRCTBL.EQ.3)  CALL RADT3(IRET)
    245       IF(IRCTBL.EQ.4)  CALL RADT4(IRET)
    246       IF(IRCTBL.EQ.5)  CALL RADT5(IRET)
    247 
    248       IF(IRET.NE.0)  THEN
    249          if(iret.eq.-1)  then
    250             IICNT = IICNT + 1
    251             IF(IICNT.LT.2001)  THEN
    252                SIDNOR(IICNT) = SID(IS)
    253             ELSE
    254                PRINT'(" WARNING: > 2000 REPORTS WITH NO CORRECTION ",
    255      .          "- CAN ONLY PRINT FIRST 2000 REPORTS IN SUMMARY AT ",
    256      .          "END")'
    257                WRITE(68,'("WARNING: > 2000 REPORTS WITH NO CORRECTION ",
    258      .          "- CAN ONLY PRINT FIRST 2000 REPORTS IN SUMMARY AT ",
    259      $          "END")')
    260             END IF
    261 cppppp
    262          else
    263                WRITE(68,'("^^^^^Here is a IRET = -99")')
    264 cppppp
    265          end if
    266          RETURN
    267       END IF
    268 
    269       JJCNT(JTYPE) = JJCNT(JTYPE) + 1
    270       IF(JJCNT(JTYPE).LE.NRID)  THEN
    271          SIDRAD(JJCNT(JTYPE),JTYPE) = SID(IS)
    272       ELSE IF(IFIRST(JTYPE).EQ.0) THEN
    273          WRITE(6,'("WARNING: AT LEAST ",I4," REPORTS WITH INST. TYPE ",
    274      .    I3.3," - CAN ONLY PRINT FIRST ",I4," REPORTS IN CORRECTION ",
    275      .    "SUMMARY AT END")') JJCNT(JTYPE),JTYPE,NRID
    276          WRITE(68,'("WARNING: AT LEAST ",I4," REPORTS WITH INST. TYPE ",
    277      .    I3.3," - CAN ONLY PRINT FIRST ",I4," REPORTS IN CORRECTION ",
    278      .    "SUMMARY AT END")') JJCNT(JTYPE),JTYPE,NRID
    279          IFIRST(JTYPE) = 1
    280       END IF
    281 
    282       IF(IRCTBL.LE.2.AND.NOSWC) KMIN = 16
    283 
    284 C  APPLY CORRECTIONS TO MANDATORY LEVELS
    285 C  -------------------------------------

Page 6           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    286 
    287       LSFM = LMANLV(PS(IS))
    288       KMIN = MAX0(KMIN,LSFM+1)
    289       DO M=KMIN,KMAX
    290          IF(INM(M).GT.0 .AND. INM(M).LE.NLV) THEN
    291          IF(TMP(M).LT.0.5*BMISS .AND. TOB(INM(M)).LT.0.5*BMISS) THEN
    292             IV = 2
    293             CALL RSTATS(IV,TOB(INM(M))*10.,TMP(M)*10.,ALON*100.,
    294      &         YOB(IS)*100.,KPRES(M))
    295             IF(DTP(M).NE.0) THEN
    296                NEV = NEV+1
    297                TO(NEV) = TMP(M)
    298                TQ(NEV) = TQM(INM(M))
    299                TR(NEV) = 1
    300                INT(NEV) = INM(M)
    301 cppppp
    302 cdak           IF(ITP(IS).EQ.49) THEN
    303 cppppp
    304                   WRITE(68,722) DHR(IS),ITP(IS),SID(IS)(1:5),
    305      &                          NINT(POB(INM(M))),VAR(IV),TOB(INM(M)),
    306      &                          TMP(M),TFC(INM(M))
    307   722             FORMAT(' DHR=',F5.2,' IT=',I3,' ID=',A5,' P=',I4,1X,
    308      &                   A1,': ORG=',F7.1,' COR=',F7.1,' FST=',F7.1)
    309 cppppp
    310 cdak           ENDIF
    311 cppppp
    312                TOB(INM(M)) = TMP(M)
    313             ENDIF
    314          ENDIF
    315          ENDIF
    316       ENDDO
    317 
    318       CALL EVENT(NFOUT,TEVN,NLV,TO,TQ,TR,INT,NEV,RADPC)
    319       WRITE(60,510) NEV,SID(IS)
    320       WRITE(68,510) NEV,SID(IS)
    321   510 FORMAT(' RADEVN--',I3,' TEMPERATURE EVENTS WRITTEN FOR: ',A8)
    322 
    323       NEV = 0
    324       DO M=KMIN,KMAX
    325          IF(INM(M).GT.0 .AND. INM(M).LE.NLV) THEN
    326          IF(HGT(M).LT.0.5*BMISS .AND. ZOB(INM(M)).LT.0.5*BMISS) THEN
    327            IV = 1
    328            CALL RSTATS(IV,ZOB(INM(M)),HGT(M),ALON*100.,
    329      &       YOB(IS)*100.,KPRES(M))
    330             IF(DHT(M).NE.0) THEN
    331                NEV = NEV+1
    332                ZO(NEV) = HGT(M)
    333                ZQ(NEV) = ZQM(INM(M))
    334                ZR(NEV) = 1
    335                INZ(NEV) = INM(M)
    336 cppppp
    337 cdak           IF(ITP(IS).EQ.49) THEN
    338 cppppp
    339                   WRITE(68,722) DHR(IS),ITP(IS),SID(IS)(1:5),
    340      &                          NINT(POB(INM(M))),VAR(IV),ZOB(INM(M)),
    341      &                          HGT(M),ZFC(INM(M))
    342 cppppp

Page 7           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    343 cdak           ENDIF
    344 cppppp
    345                ZOB(INM(M)) = HGT(M)
    346             ENDIF
    347          ENDIF
    348          ENDIF
    349       ENDDO
    350 
    351       CALL EVENT(NFOUT,ZEVN,NLV,ZO,ZQ,ZR,INZ,NEV,RADPC)
    352       WRITE(60,511) NEV,SID(IS)
    353       WRITE(68,511) NEV,SID(IS)
    354   511 FORMAT(' RADEVN--',I3,' HEIGHT EVENTS WRITTEN FOR: ',A8)
    355 
    356       IF(IRCTBL.EQ.1) RETURN
    357 
    358 C INTERPOLATE CORRECTIONS TO SFC, SIG, TROP LVLS & MAND. LVLS ABOVE KMAX
    359 C ----------------------------------------------------------------------
    360 
    361       NEV = 0
    362       LSURF = NLV+1
    363       DO L=1,NLV
    364         IF(ABS(POB(L)-PS(IS)).LT..05) THEN
    365           LSURF = L+1
    366           GOTO 10
    367         ENDIF
    368       ENDDO
    369    10 CONTINUE
    370       IV = 2
    371       DO L=LSURF,NLV
    372          IF(MANLEV(POB(L)).EQ.0 .OR. NINT(POB(L)).LT.KPRES(KMAX)) THEN
    373             TCOR = PILNLNP(POB(L),PRES,DTP,KMAX)
    374             IF(TOB(L).LT.0.5*BMISS .AND. TCOR.NE.0) THEN
    375                IF(MANLEV(POB(L)).GT.0) THEN
    376                  CALL RSTATS(IV,TOB(L)*10.,(TOB(L)+TCOR)*10.,
    377      &             ALON*100.,YOB(IS)*100.,NINT(POB(L)))
    378                ENDIF
    379                NEV = NEV+1
    380                TO(NEV) = TOB(L) + TCOR
    381 cppppp
    382                IF(ITP(IS).EQ.49) THEN
    383 cppppp
    384                   WRITE(68,822) SID(IS)(1:5),NINT(POB(L)),VAR(IV),
    385      &                          TOB(L),TO(NEV)
    386   822             FORMAT(' ID=',A5,' P=',I4,1X,A1,': ORG=',F7.1,' COR=',
    387      &                   F7.1)
    388 cppppp
    389                ENDIF
    390 cppppp
    391                TOB(L)  = TO(NEV)
    392                TQ(NEV) = TQM(L)
    393                TR(NEV) = 1
    394                INT(NEV) = L
    395             ENDIF
    396          ENDIF
    397       ENDDO
    398       CALL EVENT(NFOUT,TEVN,NLV,TO,TQ,TR,INT,NEV,RADPC)
    399       WRITE(60,510) NEV,SID(IS)

Page 8           Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    400       WRITE(68,510) NEV,SID(IS)
    401 
    402       NEV = 0
    403       IV = 1
    404       DO L=LSURF,NLV
    405          IF(MANLEV(POB(L)).EQ.0 .OR. NINT(POB(L)).LT.KPRES(KMAX)) THEN
    406             ZCOR = PILNLNP(POB(L),PRES,DHT,KMAX)
    407             IF(ZOB(L).LT.0.5*BMISS .AND. ZCOR.NE.0 .AND. L.NE.ISF(IS))
    408      &        THEN
    409                IF(MANLEV(POB(L)).GT.0) THEN
    410                  CALL RSTATS(IV,ZOB(L),ZOB(L)+ZCOR,ALON*100.,
    411      &             YOB(IS)*100.,NINT(POB(L)))
    412                ENDIF
    413                NEV = NEV+1
    414                ZO(NEV) = ZOB(L) + ZCOR
    415 cppppp
    416                IF(ITP(IS).EQ.49) THEN
    417 cppppp
    418                   WRITE(68,822) SID(IS)(1:5),NINT(POB(L)),VAR(IV),
    419      &                          ZOB(L),ZO(NEV)
    420 cppppp
    421                ENDIF
    422 cppppp
    423                ZOB(L)  = ZO(NEV)
    424                ZQ(NEV) = ZQM(L)
    425                ZR(NEV) = 1
    426                INZ(NEV) = L
    427             ENDIF
    428          ENDIF
    429       ENDDO
    430       CALL EVENT(NFOUT,ZEVN,NLV,ZO,ZQ,ZR,INZ,NEV,RADPC)
    431       WRITE(60,511) NEV,SID(IS)
    432       WRITE(68,511) NEV,SID(IS)
    433 
    434       RETURN
    435       END

Page 9           Source Listing                  RADEVN
2017-04-18 11:07 Entry Points                    radcor.f



ENTRY POINTS

  Name               
                     
 radevn_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  369                                                            366                               
 321                        Label  158                                                            156,157                           
 322                        Label  162                                                            161                               
 510                        Label  321                                                            319,320,399,400                   
 511                        Label  354                                                            352,353,431,432                   
 722                        Label  307                                                            304,339                           
 822                        Label  386                                                            384,418                           
 ABS                        Func   364                                  scalar                    364                               
 ALLSND                     Common 94                                   34512                                                       
 ALON                       Local  183      R(4)            4           scalar                    183,293,328,377,410               
 BAL_DRIFT                  Scalar 111      L(4)            4           scalar   COM              213,225,230                       
 BMISS                      Scalar 88       R(8)            8           scalar   COM              175,176,177,178,179,224,291,326,37
                                                                                                  4,407                             
 BUFRLIB_MISSING            Common 121                                  16                                                          
 CA                         Scalar 103      R(4)            4     1     255      COM                                                
 CAT                        Scalar 99       R(4)            4     1     255      COM                                                
 CDATE                      Scalar 115      CHAR            10          scalar   COM              161                               
 COUNT                      Common 113                                  1649576                                                     
 CQCPC                      Scalar 118      R(4)            4           scalar   COM                                                
 DATEX                      Common 115                                  30                                                          
 DATE_IDT                   Common 120                                  4                                                           
 DHR                        Scalar 90       R(4)            4     1     999      COM              304,339                           
 DHT                        Scalar 110      R(4)            4     1     16       COM              172,330,406                       
 DIRO                       Scalar 108      R(4)            4     1     255      COM                                                
 DTP                        Scalar 110      R(4)            4     1     16       COM              173,295,373                       
 ELV                        Scalar 91       R(4)            4     1     999      COM                                                
 EVENT                      Subr   318                                                            318,351,398,430                   
 EVNSND                     Common 103                                  26520                                                       
 FILES                      Common 116                                  24                                                          
 GESPS                      Scalar 100      R(4)            4     1     999      COM                                                
 HEADER                     Common 90                                   35980                                                       
 HGT                        Scalar 110      R(4)            4     1     16       COM              176,222,326,328,332,341,345       
 HGTTBL                     Scalar 111      L(4)            4           scalar   COM                                                
 HRDR                       Scalar 100      R(4)            4     1     255      COM              224                               
 IDATE                      Scalar 115      I(4)            4     1     5        COM              156,157,163                       
 IDT                        Scalar 120      I(4)            4           scalar   COM                                                
 IFIRST                     Local  129      I(4)            4     1     255                       139,272,279                       
 IICNT                      Scalar 114      I(4)            4           scalar   COM              152,250,251,252                   
 IMISS                      Scalar 121      I(4)            4           scalar   COM                                                
 IN                         Local  179      I(4)            4           scalar                    179                               
 IND                        Scalar 99       I(4)            4     1     255      COM                                                
 INIT                       Local  130      L(4)            4           scalar                    137,147,148                       
 INM                        Scalar 112      I(4)            4     1     16       COM              180,223,224,290,291,293,298,300,30
                                                                                                  5,306,312,325,326,328,333,335,340,

Page 10          Source Listing                  RADEVN
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  341,345                           
 INP                        Scalar 104      I(4)            4     1     255      COM                                                
 INQ                        Scalar 107      I(4)            4     1     255      COM                                                
 INT                        Scalar 106      I(4)            4     1     255      COM              300,318,394,398                   
 INZ                        Scalar 105      I(4)            4     1     255      COM              335,351,426,430                   
 IPEVT                      Scalar 118      I(4)            4           scalar   COM                                                
 IRCTBL                     Scalar 111      I(4)            4           scalar   COM              190,242,243,244,245,246,282,356   
 IRET                       Local  242      I(4)            4           scalar                    242,243,244,245,246,248,249       
 IS                         Scalar 93       I(4)            4           scalar   COM              183,184,209,233,236,252,271,287,29
                                                                                                  4,304,319,320,329,339,352,353,364,
                                                                                                  377,382,384,399,400,407,411,416,41
                                                                                                  8,431,432                         
 ISC                        Scalar 118      I(4)            4           scalar   COM                                                
 ISF                        Scalar 92       I(4)            4     1     999      COM              407                               
 ITP                        Scalar 91       I(4)            4     1     999      COM              184,304,339,382,416               
 IV                         Local  292      I(4)            4           scalar                    292,293,305,327,328,340,370,376,38
                                                                                                  4,403,410,418                     
 JJCNT                      Scalar 114      I(4)            4     1     255      COM              153,269,270,271,275,278           
 JTYPE                      Scalar 110      I(4)            4           scalar   COM              184,185,186,198,200,201,209,269,27
                                                                                                  0,271,272,275,278,279             
 KMAX                       Scalar 112      I(4)            4           scalar   COM              171,220,289,324,372,373,405,406   
 KMIN                       Scalar 112      I(4)            4           scalar   COM              170,282,288,289,324               
 KPRES                      Local  129      I(4)            4     1     21                        132,164,294,329,372,405           
 KTYPE                      Scalar 113      I(4)            4     1     69       COM              151                               
 L                          Local  218      I(4)            4           scalar                    218,219,221,222,223,363,364,365,37
                                                                                                  1,372,373,374,375,376,377,380,384,
                                                                                                  385,391,392,394,404,405,406,407,40
                                                                                                  9,410,411,414,418,419,423,424,426 
 LEVRAD                     Scalar 111      I(4)            4           scalar   COM              149,170                           
 LEVTYP                     Scalar 99       I(4)            4     1     255      COM                                                
 LMAND                      Scalar 118      I(4)            4     1     22       COM                                                
 LMANLV                     Func   287      I(4)            4           scalar                    287                               
 LSFC                       Scalar 118      I(4)            4           scalar   COM                                                
 LSFM                       Local  287      I(4)            4           scalar                    287,288                           
 LST                        Scalar 100      I(4)            4     1     255      COM                                                
 LSURF                      Local  362      I(4)            4           scalar                    362,365,371,404                   
 LWCORR                     Scalar 111      I(4)            4           scalar   COM                                                
 M                          Local  219      I(4)            4           scalar                    219,220,221,222,223,224,289,290,29
                                                                                                  1,293,294,295,297,298,300,305,306,
                                                                                                  312,324,325,326,328,329,330,332,33
                                                                                                  3,335,340,341,345                 
 MAND                       Scalar 117      I(4)            4           scalar   COM                                                
 MANLEV                     Func   219      I(4)            4           scalar                    219,372,375,405,409               
 MAX                        Func   224                                  scalar                    224                               
 MAX0                       Func   288                                  scalar                    288                               
 MOD                        Func   183                                  scalar                    183                               
 NEV                        Scalar 92       I(4)            4           scalar   COM              174,296,297,298,299,300,318,319,32
                                                                                                  0,323,331,332,333,334,335,351,352,
                                                                                                  353,361,379,380,385,391,392,393,39
                                                                                                  4,398,399,400,402,413,414,419,423,
                                                                                                  424,425,426,430,431,432           
 NFEVN                      Scalar 116      I(4)            4           scalar   COM                                                
 NFIN                       Scalar 116      I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 116      I(4)            4           scalar   COM              318,351,398,430                   
 NFSGL                      Scalar 116      I(4)            4           scalar   COM                                                

Page 11          Source Listing                  RADEVN
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NFSTN                      Scalar 116      I(4)            4           scalar   COM                                                
 NFSUM                      Scalar 116      I(4)            4           scalar   COM                                                
 NINT                       Func   305                                  scalar                    305,340,372,377,384,405,411,418   
 NLEV                       Scalar 117      I(4)            4           scalar   COM                                                
 NLV                        Scalar 91       I(4)            4           scalar   COM              218,290,318,325,351,362,363,371,39
                                                                                                  8,404,430                         
 NLVM                       Scalar 92       I(4)            4           scalar   COM                                                
 NLVW                       Scalar 92       I(4)            4           scalar   COM                                                
 NOBS                       Scalar 117      I(4)            4           scalar   COM                                                
 NOSWC                      Local  130      L(4)            4           scalar                    242,243,282                       
 NRID                       Param  86       I(4)            4           scalar                    113,270,275,278                   
 NST                        Param  85       I(4)            4           scalar                    90,91,92,100                      
 NTYPE                      Scalar 113      I(4)            4     1     69       COM              150                               
 PARAMS                     Common 117                                  148                                                         
 PFC                        Scalar 94       R(4)            4     1     255      COM                                                
 PILNLNP                    Func   373      R(4)            4           scalar                    373,406                           
 PMAND                      Common 112                                  136                                                         
 PO                         Scalar 103      R(4)            4     1     255      COM                                                
 POB                        Scalar 94       R(4)            4     1     255      COM              219,305,340,364,372,373,375,377,38
                                                                                                  4,405,406,409,411,418             
 PQ                         Scalar 104      R(4)            4     1     255      COM                                                
 PQM                        Scalar 94       R(4)            4     1     255      COM                                                
 PR                         Scalar 105      R(4)            4     1     255      COM                                                
 PRC                        Scalar 94       R(4)            4     1     255      COM                                                
 PREP                       Subr   163                                                            163                               
 PRES                       Scalar 112      R(4)            4     1     16       COM              164,373,406                       
 PRNT                       Scalar 118      L(4)            4           scalar   COM                                                
 PS                         Scalar 100      R(4)            4     1     999      COM              287,364                           
 QFC                        Scalar 98       R(4)            4     1     255      COM                                                
 QO                         Scalar 106      R(4)            4     1     255      COM                                                
 QOB                        Scalar 98       R(4)            4     1     255      COM                                                
 QQ                         Scalar 106      R(4)            4     1     255      COM                                                
 QQM                        Scalar 98       R(4)            4     1     255      COM                                                
 QR                         Scalar 106      R(4)            4     1     255      COM                                                
 QRC                        Scalar 98       R(4)            4     1     255      COM                                                
 RADCOM                     Common 110                                  260                                                         
 RADEVN                     Subr   84                                                                                               
 RADPC                      Scalar 117      R(4)            4           scalar   COM              318,351,398,430                   
 RADT1                      Subr   242                                                            242                               
 RADT2                      Subr   243                                                            243                               
 RADT3                      Subr   244                                                            244                               
 RADT4                      Subr   245                                                            245                               
 RADT5                      Subr   246                                                            246                               
 RSTATS                     Subr   293                                                            293,328,376,410                   
 SID                        Scalar 90       CHAR            8     1     999      COM              209,233,236,252,271,304,319,320,33
                                                                                                  9,352,353,384,399,400,418,431,432 
 SIDNOR                     Scalar 113      CHAR            8     1     2000     COM              154,252                           
 SIDRAD                     Scalar 113      CHAR            8     2     204000   COM              155,271                           
 SOLAR                      Local  89       R(4)            4     1     16                                                          
 SPO                        Scalar 108      R(4)            4     1     255      COM                                                
 SQN                        Scalar 91       R(4)            4     1     999      COM                                                
 STN                        Common 93                                   4                                                           
 SWITCH                     Common 111                                  20                                                          
 TAB                        Subr   186                                                            186                               
 TCOR                       Local  373      R(4)            4           scalar                    373,374,376,380                   

Page 12          Source Listing                  RADEVN
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TDFC                       Scalar 97       R(4)            4     1     255      COM                                                
 TDO                        Scalar 97       R(4)            4     1     255      COM                                                
 TDQ                        Scalar 107      R(4)            4     1     255      COM                                                
 TDR                        Scalar 107      R(4)            4     1     255      COM                                                
 TDW                        Scalar 107      R(4)            4     1     255      COM                                                
 TEST                       Scalar 119      L(4)            4           scalar   COM                                                
 TESTS                      Common 119                                  4                                                           
 TEVN                       Local  126      CHAR            40          scalar                    135,318,398                       
 TFC                        Scalar 96       R(4)            4     1     255      COM              306                               
 TMP                        Scalar 110      R(4)            4     1     16       COM              175,221,291,293,297,306,312       
 TO                         Scalar 103      R(4)            4     1     255      COM              177,297,318,380,385,391,398       
 TOB                        Scalar 96       R(4)            4     1     255      COM              221,291,293,305,312,374,376,380,38
                                                                                                  5,391                             
 TQ                         Scalar 104      R(4)            4     1     255      COM              298,318,392,398                   
 TQM                        Scalar 96       R(4)            4     1     255      COM              298,392                           
 TR                         Scalar 105      R(4)            4     1     255      COM              299,318,393,398                   
 TRC                        Scalar 96       R(4)            4     1     255      COM                                                
 TT                         Scalar 118      R(4)            4           scalar   COM                                                
 TVO                        Scalar 97       R(4)            4     1     255      COM                                                
 UO                         Scalar 108      R(4)            4     1     255      COM                                                
 VAR                        Local  125      CHAR            1     1     2                         138,305,340,384,418               
 VO                         Scalar 108      R(4)            4     1     255      COM                                                
 VTPPC                      Scalar 117      R(4)            4           scalar   COM                                                
 WQ                         Scalar 109      R(4)            4     1     255      COM                                                
 WR                         Scalar 109      R(4)            4     1     255      COM                                                
 XDR                        Scalar 101      R(4)            4     1     255      COM              224                               
 XMA                        Scalar 117      R(4)            4           scalar   COM                                                
 XMI                        Scalar 117      R(4)            4           scalar   COM                                                
 XMISS                      Scalar 121      R(4)            4           scalar   COM                                                
 XOB                        Scalar 90       R(4)            4     1     999      COM              183                               
 YDR                        Scalar 101      R(4)            4     1     255      COM              224                               
 YMA                        Scalar 117      R(4)            4           scalar   COM                                                
 YMI                        Scalar 117      R(4)            4           scalar   COM                                                
 YOB                        Scalar 90       R(4)            4     1     999      COM              294,329,377,411                   
 ZCOR                       Local  406      R(4)            4           scalar                    406,407,410,414                   
 ZEVN                       Local  126      CHAR            40          scalar                    136,351,430                       
 ZFC                        Scalar 95       R(4)            4     1     255      COM              341                               
 ZO                         Scalar 103      R(4)            4     1     255      COM              178,332,351,414,419,423,430       
 ZOB                        Scalar 95       R(4)            4     1     255      COM              222,326,328,340,345,407,410,414,41
                                                                                                  9,423                             
 ZQ                         Scalar 104      R(4)            4     1     255      COM              333,351,424,430                   
 ZQM                        Scalar 95       R(4)            4     1     255      COM              333,424                           
 ZR                         Scalar 105      R(4)            4     1     255      COM              334,351,425,430                   
 ZRC                        Scalar 95       R(4)            4     1     255      COM                                                

Page 13          Source Listing                  RADEVN
2017-04-18 11:07                                 radcor.f

    436 
    437 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    438 C
    439 C SUBPROGRAM:    PREP        SET UP VARIABLES FOR RADIATION CORRECTION
    440 C   PRGMMR: J. WOOLLEN       ORG: GSC        DATE: 1994-02-27
    441 C
    442 C ABSTRACT: DOES PRELIMINARY WORK PRIOR TO APPLYING RADIOSONDE HEIGHT
    443 C   AND TEMPERATURE CORRECTIONS DUE TO INTERSONDE DIFFERENCES (MAINLY
    444 C   RADIATIVE EFFECTS ON THE INSTRUMENT).  THE JULIAN DAY AND TRUE
    445 C   SOLAR NOON ARE DETERMINED FOR THIS DAY OF THE YEAR.  BASED ON THE 
    446 C   DATE OF THE DATA (FROM THE BUFR MESSAGE) THE PROPER VALUE FOR THE
    447 C   VARIABLE "IRCTBL" IS DETERMINED (THIS WILL LATER POINT TO PROPER
    448 C   SET OF CORRECTION TABLES).
    449 C
    450 C PROGRAM HISTORY LOG:
    451 C 1994-02-27  J. WOOLLEN   -- COPIED FROM ORIGINAL PARTS OF ORIGINAL
    452 C     RADNCORR PROGRAM, AND CONVERTED FOR USE WITH BUFR
    453 C
    454 C USAGE:    CALL PREP(IDATE)
    455 C   INPUT ARGUMENT LIST:
    456 C     IDATE    - 5-WORD INTEGER {YY(1-2),YY(3-4),MM,DD,HH} CONTAINING
    457 C                BUFR MESSAGE DATE
    458 C
    459 C   INPUT FILES:
    460 C     UNIT 04  - NAMELIST CONTAINING VARIABLES READ INTO SUBROUTINE
    461 C
    462 C   OUTPUT FILES:
    463 C     UNIT 06  - PRINTOUT
    464 C     UNIT 68  - RADCOR INFORMATION FILE
    465 C
    466 C REMARKS: CALLED BY SUBROUTINE "RADEVN".
    467 C
    468 C ATTRIBUTES:
    469 C   LANGUAGE: FORTRAN 90
    470 C   MACHINE:  NCEP WCOSS
    471 C
    472 C$$$
    473       SUBROUTINE PREP(IDATE)
    474 
    475       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
    476       COMMON /SUNNY / IDAYR,IDAYSY,TSNOON
    477       COMMON /DATE_IDT/IDT
    478 
    479       NAMELIST/KDTA/IRCTBL
    480       NAMELIST/LDTA/LEVRAD,LWCORR
    481 
    482       DIMENSION IDATE(5),JDATE(5)
    483       LOGICAL   HGTTBL
    484 
    485 C-----------------------------------------------------------------------
    486 C-----------------------------------------------------------------------
    487 
    488 C***********************************************************************
    489 C  COMPUTE: IDAYR   = DAY OF THE YEAR
    490 C           IDAYSY  = TOTAL NUMBER OF DAYS IN YEAR
    491 C           TSNOON  = TRUE SOLAR NOON FOR TODAY'S DATE (HRS GMT)
    492 C***********************************************************************

Page 14          Source Listing                  PREP
2017-04-18 11:07                                 radcor.f

    493 
    494       IYR = 100*IDATE(1) + IDATE(2)
    495       IMO = IDATE(3)
    496       IDY = IDATE(4)
    497       CALL W3FS13(IYR,IMO,IDY,IDAYR)
    498       CALL W3FS13(IYR,12,31,IDAYSY)
    499       DANGL  = 6.2831853 * (REAL(IDAYR) - 79.)/REAL(IDAYSY)
    500       SDGL   = SIN(DANGL)
    501       CDGL   = COS(DANGL)
    502       TSNOON = -.030*SDGL-.120*CDGL+.330*SDGL*CDGL+.0016*SDGL**2-.0008
    503       WRITE(60,500) IYR,IMO,IDY,IDAYR,IDAYSY,TSNOON
    504       WRITE(68,500) IYR,IMO,IDY,IDAYR,IDAYSY,TSNOON
    505   500 FORMAT(' PREP--IYR,IMO,IDY,IDAYR,IDAYSY,TSNOON:',I6,2I3,2I5,F10.4)
    506 
    507 C-----------------------------------------------------------
    508 C  IDTTS1 IS NO. OF MIN. FROM 00Z 01/01/78 TO 12Z 07/30/1986
    509 C  IDTTS2 IS NO. OF MIN. FROM 00Z 01/01/78 TO 12Z 01/22/1992
    510 C  IDTTS3 IS NO. OF MIN. FROM 00Z 01/01/78 TO 12Z 12/17/1991
    511 C  IDTTS4 IS NO. OF MIN. FROM 00Z 01/01/78 TO 06Z 03/18/1992
    512 C  IDTTS5 IS NO. OF MIN. FROM 00Z 01/01/78 TO 00Z 10/01/1993
    513 C  IDTTS6 IS NO. OF MIN. FROM 00Z 01/01/78 TO 00Z 01/01/1998
    514 C  IDTTS7 IS NO. OF MIN. FROM 00Z 01/01/78 TO 00Z 01/01/2000
    515 C  IDT    IS NO. OF MIN. FROM 00Z 01/01/78 TO THE DD/MM/YYYY
    516 C-----------------------------------------------------------
    517 
    518       IDTTS1 = 4510800
    519       IDTTS2 = 7393680
    520       IDTTS3 = 7341840
    521       IDTTS4 = 7473960
    522       IDTTS5 = 8282880
    523       IDTTS6 = 10519200
    524       IDTTS7 = 10519931  ! number of min from 00Z 01/01/78 TO
    525                          ! 00Z 01/01/2000 is actually 11570400
    526 
    527 C  FIGURE OUT WHAT DATE THIS IS
    528 C  ----------------------------
    529 
    530       JDATE(1) = IDATE(1)*100 + IDATE(2)
    531       JDATE(2) = IDATE(3)
    532       JDATE(3) = IDATE(4)
    533       JDATE(4) = IDATE(5)
    534       JDATE(5) = 0
    535       CALL W3FS21(JDATE,IDT)
    536 
    537 C  HEIGHT CORRECTIONS ARE NOT OBTAINED FROM TABLES AFTER 10/1/93
    538 C  -------------------------------------------------------------
    539 
    540       HGTTBL = (IDT.LT.IDTTS5)
    541 
    542 C  THE DEFAULT VALUE FOR IRCTBL DEPENDS ON THE DATE OF THE DATA
    543 C  ------------------------------------------------------------
    544 
    545       IF(IDT.LT.IDTTS1)  THEN
    546          IRCTBL = 1
    547       ELSE  IF(IDT.LT.IDTTS2)  THEN
    548          IRCTBL = 2
    549       ELSE IF(IDT.LT.IDTTS7) THEN

Page 15          Source Listing                  PREP
2017-04-18 11:07                                 radcor.f

    550          IRCTBL = 3
    551       ELSE
    552          IRCTBL = 5 
    553       END IF
    554       READ(4,KDTA,END=1,err=1)
    555     1 CONTINUE
    556 
    557 C  THE DEF. VALUES FOR LWCORR AND LEVRAD DEPEND UPON THE VALUE OF IRCTBL
    558 C  ---------------------------------------------------------------------
    559 
    560       LWCORR =  1
    561       LEVRAD = 11
    562       IF(IRCTBL.GE.2)  LEVRAD = 1
    563       READ(4,LDTA,END=2,err=2)
    564     2 CONTINUE
    565 
    566 C  FOR IRCTBL = 3, LWCORR IS NOT APPLICABLE SO IT IS ALWAYS SET TO ZERO
    567 C  ---------------------------------------------------------------------
    568       IF(IRCTBL.EQ.3)  LWCORR = 0
    569 
    570 C  PRINT THE PARAMETERS AND EXIT
    571 C  -----------------------------
    572 
    573       WRITE(6,KDTA)
    574       WRITE(68,KDTA)
    575       WRITE(6,LDTA)
    576       WRITE(68,LDTA)
    577       IF(IRCTBL.EQ.1)  THEN
    578          PRINT 200
    579          WRITE(68,200)
    580       ELSE IF(IRCTBL.EQ.2)  THEN
    581          PRINT 201
    582          WRITE(68,201)
    583       ELSE IF(IRCTBL.EQ.3)  THEN
    584          PRINT 202
    585          WRITE(68,202)
    586       ELSE IF(IRCTBL.EQ.4)  THEN
    587          PRINT 204
    588          WRITE(68,204)
    589       ELSE IF(IRCTBL.EQ.5)  THEN
    590          PRINT 205
    591          WRITE(68,205)
    592       END IF
    593       IF(LEVRAD.LE.0)  THEN
    594          PRINT 203
    595          WRITE(68,203)
    596       END IF
    597 
    598       RETURN
    599 
    600 C  FORMAT STATEMENTS
    601 C  -----------------
    602 
    603 200   FORMAT(//,13X,'CORRECTIONS ARE BASED ON STUDY BY MCINTURFF AND ',
    604      &       'FINGER (1968) -- OPERATIONAL ONLY PRIOR TO 12Z 07/30/86')
    605 201   FORMAT(//,9X,'CORRECTIONS ARE BASED ON STUDY BY MCINTURFF ET AL.',
    606      &       ' (1979) -- OPERATIONAL 12Z 07/30/86 TO 12Z 01/22/92')

Page 16          Source Listing                  PREP
2017-04-18 11:07                                 radcor.f

    607 202   FORMAT(//,5X,'CORRECTIONS ARE BASED ON STUDY BY SCHMIDLIN(1990) ',
    608      &       'AND P JULIAN (NMC ON 374) -- OPERATIONAL 12Z 01/22/92',//)
    609 203   FORMAT(10X,'===> SWITCH "LEVRAD" = 0 -- NO CORRECTIONS APPLIED',/)
    610 204   FORMAT(//,5X,'CORRECTIONS ARE BASED ON STUDY BY COLLINS',
    611      &  ' (1999)',//)
    612 205   FORMAT(//,5X,'CORRECTIONS ARE BASED ON STUDY BY COLLINS',
    613      &' (2000)',//)
    614 
    615       END


ENTRY POINTS

  Name             
                   
 prep_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  555                                                            554                               
 2                          Label  564                                                            563                               
 200                        Label  603                                                            578,579                           
 201                        Label  605                                                            581,582                           
 202                        Label  607                                                            584,585                           
 203                        Label  609                                                            594,595                           
 204                        Label  610                                                            587,588                           
 205                        Label  612                                                            590,591                           
 500                        Label  505                                                            503,504                           
 BAL_DRIFT                  Scalar 475      R(4)            4           scalar   COM                                                
 CDGL                       Local  501      R(4)            4           scalar                    501,502                           
 COS                        Func   501                                  scalar                    501                               
 DANGL                      Local  499      R(4)            4           scalar                    499,500,501                       
 DATE_IDT                   Common 477                                  4                                                           
 HGTTBL                     Scalar 475      L(4)            4           scalar   COM              540                               
 IDATE                      Dummy  473      I(4)            4     1     5        ARG,INOUT        494,495,496,530,531,532,533       
 IDAYR                      Scalar 476      I(4)            4           scalar   COM              497,499,503,504                   
 IDAYSY                     Scalar 476      I(4)            4           scalar   COM              498,499,503,504                   
 IDT                        Scalar 477      I(4)            4           scalar   COM              535,540,545,547,549               
 IDTTS1                     Local  518      I(4)            4           scalar                    518,545                           
 IDTTS2                     Local  519      I(4)            4           scalar                    519,547                           
 IDTTS3                     Local  520      I(4)            4           scalar                    520                               
 IDTTS4                     Local  521      I(4)            4           scalar                    521                               
 IDTTS5                     Local  522      I(4)            4           scalar                    522,540                           
 IDTTS6                     Local  523      I(4)            4           scalar                    523                               
 IDTTS7                     Local  524      I(4)            4           scalar                    524,549                           
 IDY                        Local  496      I(4)            4           scalar                    496,497,503,504                   
 IMO                        Local  495      I(4)            4           scalar                    495,497,503,504                   
 IRCTBL                     Scalar 475      I(4)            4           scalar   COM              479,546,548,550,552,562,568,577,58
                                                                                                  0,583,586,589                     
 IYR                        Local  494      I(4)            4           scalar                    494,497,498,503,504               
 JDATE                      Local  482      I(4)            4     1     5                         530,531,532,533,534,535           
 KDTA                       Local  479                                  scalar                    554,573,574                       
 LDTA                       Local  480                                  scalar                    563,575,576                       
 LEVRAD                     Scalar 475      I(4)            4           scalar   COM              480,561,562,593                   

Page 17          Source Listing                  PREP
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LWCORR                     Scalar 475      I(4)            4           scalar   COM              480,560,568                       
 PREP                       Subr   473                                                                                              
 REAL                       Func   499                                  scalar                    499                               
 SDGL                       Local  500      R(4)            4           scalar                    500,502                           
 SIN                        Func   500                                  scalar                    500                               
 SUNNY                      Common 476                                  12                                                          
 SWITCH                     Common 475                                  20                                                          
 TSNOON                     Scalar 476      R(4)            4           scalar   COM              502,503,504                       
 W3FS13                     Subr   497                                                            497,498                           
 W3FS21                     Subr   535                                                            535                               

Page 18          Source Listing                  PREP
2017-04-18 11:07                                 radcor.f

    616 
    617 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    618 C
    619 C SUBPROGRAM:    RADT1       APPLIES OLDEST SET OF RADIATION CORRECTNS
    620 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2008-10-08
    621 C
    622 C ABSTRACT: THIS SUBROUTINE APPLIES RADIATION CORRECTIONS TO THE
    623 C   OBSERVED RADIOSONDE HEIGHTS AND TEMPERATURES FOR ALL SIX
    624 C   STRATOSPHERIC LEVELS: 100, 70, 50, 30, 20, AND 10 MB.  DATA ARE
    625 C   PASSED THROUGH COMMON /RADCOM/.  THE CORRECTION OF RAOBS FOR SHORT-
    626 C   WAVE RADIATIVE EFFECTS IS ACCOMPLISHED BY READING IN TABLES OF
    627 C   NUMBERS WHICH ARE DEPENDENT ON THE RADIOSONDE TYPE.  THE CORRECTION
    628 C   OF RAOBS FOR LONG-WAVE RADIATION (AT 10 MB ONLY) IS BASED ON THE
    629 C   4'TH POWER OF THE 10 MB TEMPERATURE.  CALLED FOR ONE REPORT
    630 C   AT A TIME.
    631 C
    632 C PROGRAM HISTORY LOG:
    633 C 1971-12-19  KEITH JOHNSON -- W/NMC??
    634 C 1973-09-13  PPC
    635 C 1990-12-05  D. A. KEYSER -- CONVERTED TO VS FORTRAN(77)& RESTRUCTURED
    636 C 1994-02-27  J. WOOLLEN   -- CONVERTED FOR USE WITH BUFR
    637 C 2002-07-22  D. A. KEYSER -- CALLS NEW ROUTINE SOELAN TO CALCULATE SUN
    638 C     ANGLE ON VALID MANDATORY LEVELS RATHER THAN DOING CALCULATION IN
    639 C     THIS SUBROUTINE
    640 C 2007-09-14  D. KEYSER    -- MINOR CODE CORRECTIONS SUGGESTED BY PAT
    641 C     PAULEY (CORRECTS PROBLEMS THAT COULD OCCUR ON SOME REMOTE
    642 C     MACHINES)
    643 C 2008-10-08  D. KEYSER    -- MODIFIED TO RE-INDEX ARRAY "SOLAR" (SUN
    644 C     ANGLE ON MAND. LVLS) SO THAT THE CORRECT VALUES RETURNED FROM
    645 C     SUBR. SOELAN ARE USED FOR CASES WHERE BALLOON DRIFT INFORMATION
    646 C     IS PRESENT (ONLY APPLIES TO REANALYSIS SINCE BALLOON DRIFT WAS
    647 C     NOT AVAILABLE BACK WHEN THIS SUBR. WAS CALLED IN REAL-TIME RUNS,
    648 C     THIS SUBR. IS NEVER CALLED IN CURRENT REAL-TIME RUNS ANYWAY)
    649 C
    650 C USAGE:    CALL RADT1(NOSWC,IRET)
    651 C   OUTPUT ARGUMENT LIST:
    652 C     NOSWC    - LOGICAL INDICATING NO SHORT-WAVE CORRECTION APPLIED
    653 C     IRET     - RETURN CODE (0=CORRECTIONS, -1=NO CORRECTIONS,
    654 C              - -99=??????)
    655 C
    656 C REMARKS: THESE CORRECTIONS USE THE ORIGINAL NMC OFFICE NOTE 29
    657 C   RADIOSONDE TYPE CODES OBTAINED FROM THE NMC UPPER-AIR DICTIONARY.
    658 C   CALLED BY SUBROUTINE "RADEVN".
    659 C
    660 C
    661 C   KEY FOR RADIOSONDE TYPES USED HERE:
    662 C
    663 C JTYPE(ON29)  CODE NAME (DICTIONARY)  DESCRIPTION
    664 C
    665 C     UNSPEC.        T5N    (INACTIVE) FRENCH METOX
    666 C        1           T1J               U.S. NOAA / VIZ
    667 C        2 ** NO CORRECTION **         RESERVED
    668 C        3           T3L               U.S. AN/AMT 4
    669 C        4           T4M               FINNISH VAISALA (IN FINLAND)
    670 C        5 ** NO CORRECTION **         FRENCH MESURAL (IN FRANCE)
    671 C        6 ** NO CORRECTION (INACTIVE) PORTUGAL (CANADIAN MODEL IV)
    672 C        7 ** NO CORRECTION **         W. GERMAN GRAW

Page 19          Source Listing                  PREP
2017-04-18 11:07                                 radcor.f

    673 C        8 ** NO CORRECTION **         RESERVED
    674 C        9           T9R               JAPANESE "CODE SENDING"
    675 C       10           TASLSH (INACTIVE) E. GERMAN FREIBERG
    676 C       11           TBS               U.K. KEW
    677 C       12           TCT               U.S.S.R A-22
    678 C       13 ** NO CORRECTION **         RESERVED
    679 C       14 (CHGED. TO JTYPE= 4 INSTR)  FINNISH VAISALA (IN/OUT FINLAND)
    680 C       15 (CHGED. TO JTYPE= 5 INSTR)  FRENCH MESURAL (OUT OF FRANCE)
    681 C       16 ** NO CORRECTION **         AUSTRALIAN PHILLIPS
    682 C       17 ** NO CORRECTION (INACTIVE) AUSTRALIAN "DIAMOND HINMAN"
    683 C       18 ** NO CORRECTION **         CANADIAN "SANGAMO"
    684 C       19 ** NO CORRECTION **         CHINESE
    685 C       20 (CHGED. TO JTYPE=12 INSTR)  U.S.S.R. RKZ
    686 C       21 (CHGED. TO JTYPE=12 INSTR)  U.S.S.R. UNKNOWN (AVG. A-22&RKZ)
    687 C       22 ** NO CORRECTION **         INDIAN MET. SERVICE
    688 C       23 ** NO CORRECTION **         AUSTRIAN ELIN
    689 C       24 ** NO CORRECTION **         KOREAN JINYANG / VIZ
    690 C       25 ** NO CORRECTION **         SWISS METEOLABOR
    691 C       26 ** NO CORRECTION **         CZECH VINOHRADY
    692 C       27 ** NO CORRECTION **         U.S. MSS (SPACE DATA CORP.)
    693 C       28.. 97  ** NO CORRECTION **   RESERVED
    694 C
    695 C
    696 C ATTRIBUTES:
    697 C   LANGUAGE: FORTRAN 90
    698 C   MACHINE:  NCEP WCOSS
    699 C
    700 C$$$
    701       SUBROUTINE RADT1(NOSWC,IRET)
    702 
    703       REAL(8) BMISS
    704 
    705       COMMON /RADCOM/ HGT(16),TMP(16),DHT(16),DTP(16),JTYPE
    706       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
    707       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
    708 
    709       REAL         CUTOFF(6),SOLAR(16),PRES6(6),DTS(6),DHS(6),ALP(5),
    710      .             ANGLE(11),T1J(66),T3L(66),T4M(66),T5N(66),T9R(66),
    711      .             TASLSH(66),TBS(66),TCT(66),H1J(11),H3L(11),H4M(11),
    712      .             H5N(11),H9R(11),HASLSH(11),HBS(11),HCT(11),
    713      .             TTAB(66,8),HTAB(11,8)
    714       INTEGER      ITYPTB(255)
    715       EQUIVALENCE  (TTAB(1,1),T1J(1)),(TTAB(1,2),T3L(1)),
    716      .             (TTAB(1,3),T4M(1)),(TTAB(1,4),T5N(1)),
    717      .             (TTAB(1,5),T9R(1)),(TTAB(1,6),TASLSH(1)),
    718      .             (TTAB(1,7),TBS(1)),(TTAB(1,8),TCT(1))
    719       EQUIVALENCE  (HTAB(1,1),H1J(1)),(HTAB(1,2),H3L(1)),
    720      .             (HTAB(1,3),H4M(1)),(HTAB(1,4),H5N(1)),
    721      .             (HTAB(1,5),H9R(1)),(HTAB(1,6),HASLSH(1)),
    722      .             (HTAB(1,7),HBS(1)),(HTAB(1,8),HCT(1))
    723       LOGICAL      INIT,NOSWC, HGTTBL
    724 
    725 C  TEMPERATURE CORRECTIONS (*10 K) FOR S-W RADIATION EFFECTS
    726 C  ---------------------------------------------------------
    727 
    728 C     NOAA / VIZ
    729 

Page 20          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

    730       DATA T1J /
    731      $   0.,  3.,  6.,  8.,  9., 10., 10., 10.,  9.,  8.,  5.,
    732      $   0.,  4.,  7.,  9., 10., 11., 11., 11., 10.,  9.,  5.,
    733      $   0.,  5.,  8., 10., 12., 12., 13., 13., 11., 10.,  6.,
    734      $   0.,  7., 12., 14., 16., 16., 17., 16., 14., 11.,  7.,
    735      $   0.,  9., 16., 18., 20., 20., 20., 19., 16., 12.,  8.,
    736      $   0., 15., 22., 25., 26., 27., 26., 25., 22., 18., 12./
    737 
    738 C      AN/AMT 4   NOAA/ VIZ MILITARY TYPE
    739 
    740       DATA T3L /
    741      $   0.,  2.,  4.,  5.,  6.,  7.,  8.,  8.,  6.,  2.,  0.,
    742      $   0.,  2.,  4.,  6.,  7.,  8.,  9.,  9.,  7.,  2.,  0.,
    743      $   0.,  2.,  4.,  7.,  9., 10., 11., 10.,  8.,  3.,  0.,
    744      $   0.,  3.,  6., 10., 12., 13., 14., 12., 10.,  4.,  0.,
    745      $   0.,  6.,  9., 12., 15., 16., 17., 15., 12.,  4.,  0.,
    746      $   0., 12., 15., 18., 20., 22., 22., 20., 16.,  6.,  0./
    747 
    748 C     VAISALA INSIDE FINLAND (ALSO USED FOR VAISALA OUT OF FINLAND)
    749 
    750       DATA T4M /
    751      $   0.,  2.,  4.,  6.,  8., 10., 11., 11., 10.,  8.,  6.,
    752      $  -3.,  1.,  3.,  6.,  8., 10., 11., 12., 10.,  8.,  6.,
    753      $  -6.,  0.,  3.,  6.,  8., 10., 13., 12., 10.,  8.,  6.,
    754      $ -10., -3.,  2.,  4.,  8., 10., 13., 13., 11.,  9.,  7.,
    755      $ -14., -6.,  0.,  4.,  8., 10., 14., 13., 11.,  9.,  7.,
    756      $ -23., -6.,  0.,  5.,  9., 11., 14., 13., 12., 10.,  8./
    757 
    758 C     FRENCH METOX (INACTIVE - CORRECTIONS NOT APPLIED)
    759 
    760       DATA T5N /
    761      $   0.,  0.,  8., 12., 16., 20., 23., 26., 24., 17.,  9.,
    762      $   0.,  0., 13., 20., 25., 30., 35., 38., 38., 31., 17.,
    763      $   0.,  0., 18., 27., 34., 41., 46., 51., 52., 46., 26.,
    764      $   0.,  0., 27., 42., 54., 64., 70., 76., 76., 65., 30.,
    765      $   0.,  0., 36., 57., 72., 82., 90., 96., 95., 83., 55.,
    766      $   0.,  0., 56., 83.,105.,122.,132.,140.,140.,130.,116./
    767 
    768 C     JAPANESE
    769 
    770       DATA T9R /
    771      $   0.,  0., 12., 14., 14., 13., 11.,  9.,  7.,  0.,  0.,
    772      $   0.,  0., 18., 21., 20., 17., 14., 11.,  7.,  0.,  0.,
    773      $   0.,  0., 24., 28., 26., 22., 18., 13.,  6.,  0.,  0.,
    774      $   0.,  0., 30., 36., 33., 29., 24., 18., 11.,  0.,  0.,
    775      $   0.,  0., 33., 39., 36., 30., 23., 16.,  5.,  0.,  0.,
    776      $   0.,  0., 38., 47., 40., 30., 20.,  7., -8.,  0.,  0./
    777 
    778 C     EAST GERMAN FREIBERG (INACTIVE - CORRECTIONS NOT APPLIED)
    779 
    780       DATA TASLSH /
    781      $   0.,  0.,  8., 11., 14., 18., 20., 23.,  0.,  0.,  0.,
    782      $   0.,  0., 12., 15., 18., 22., 24., 26.,  0.,  0.,  0.,
    783      $   0.,  0., 16., 19., 22., 26., 28., 30.,  0.,  0.,  0.,
    784      $   0.,  0., 24., 34., 42., 48., 52., 54.,  0.,  0.,  0.,
    785      $   0.,  0., 30., 45., 55., 61., 65., 67.,  0.,  0.,  0.,
    786      $   0.,  0., 58., 68., 76., 80., 81., 82.,  0.,  0.,  0./

Page 21          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

    787 
    788 C     UNITED KINGDOM KEW (WPT HAD THIS INSTRUMENT AS PAKISTANI FAN-TYPE)
    789 
    790       DATA TBS /
    791      $   0.,  0.,  6., 10., 10.,  6.,  6.,  6., -4.,-12.,  0.,
    792      $   0.,  0.,  6., 11., 10.,  6.,  8.,  8., -1.,-11.,  0.,
    793      $   0.,  0.,  6., 12., 10.,  6., 10., 11.,  2., -8.,  0.,
    794      $   0.,  0., 16., 20., 16., 10., 14., 14., -8.,-34.,  0.,
    795      $   0., 15., 26., 28., 30., 24., 24., 22.,  0.,-36.,  0.,
    796      $   0., 40., 52., 54., 50., 44., 44., 46., 28.,  7.,  0./
    797 
    798 C     U.S.S.R. A-22
    799 
    800       DATA  TCT /
    801      $  -2.,  2.,  8.,  9., 10., 10., 10., 10.,  8.,  0.,  0.,
    802      $  -1.,  4., 10., 11., 13., 14., 15., 14., 12.,  0.,  0.,
    803      $  -1.,  6., 12., 14., 16., 18., 20., 19., 17.,  0.,  0.,
    804      $   2., 10., 14., 18., 20., 23., 25., 24., 22.,  0.,  0.,
    805      $   3., 14., 22., 25., 27., 29., 30., 28., 26.,  0.,  0.,
    806      $   9., 24., 32., 37., 40., 43., 44., 41., 39.,  0.,  0./
    807 
    808 C  HEIGHT CORRECTIONS (M) AT 100 MB FOR S-W RADIATION EFFECTS
    809 C  ----------------------------------------------------------
    810 
    811       DATA  H1J   /  0., 10.,20.,29.,35.,38.,39.,37., 30., 27.,25./
    812       DATA  H3L   / -9., -2., 8.,17.,23.,25.,26.,25., 18.,  0., 0./
    813       DATA  H4M   /  0.,  7.,17.,22.,27.,32.,36.,36., 34., 30.,27./
    814       DATA  H5N   /  0.,  0.,10.,22.,34.,44.,53.,60., 59., 48.,26./
    815       DATA  H9R   /  0.,  0.,38.,38.,38.,37.,36.,35., 34.,  0., 0./
    816       DATA  HASLSH/  0.,  0.,19.,29.,38.,47.,56.,65.,  0.,  0., 0./
    817       DATA  HBS   /-33.,-22.,-1.,11.,13., 5., 6.,10.,-12.,-47., 0./
    818       DATA  HCT   /-14.,  6.,22.,33.,38.,41.,42.,40., 38.,  0., 0./
    819 
    820 
    821       DATA INIT   /.TRUE./
    822       DATA PRES6  /100.,70.,50.,30.,20.,10./
    823       DATA ANGLE  /0.,0.,10.,20.,30.,40.,50.,60.,70.,80.,90./
    824       DATA CUTOFF /-5.54,-5.76,-6.02,-6.31,-6.55,-7.04/
    825       DATA ITYPTB /1,0,2,3,0,0,0,0,5,6,7,8,0,242*0/
    826 
    827 C-----------------------------------------------------------------------
    828 C-----------------------------------------------------------------------
    829 
    830       IRET = 0
    831 
    832 C  EACH TIME THROUGH, COMPUTE LOGS OF PRESSURE RATIOS
    833 C  --------------------------------------------------
    834 
    835       DO I=1,5
    836          ALP(I) = 1.46 * ALOG(PRES6(I)/PRES6(I+1))
    837       ENDDO
    838 
    839 C  GET TABLE INDEX FROM RADIOSONDE TYPE
    840 C  ------------------------------------
    841 
    842       ITAB = 0
    843       IF(JTYPE.GT.0 .AND. JTYPE.LT.256) ITAB = ITYPTB(JTYPE)

Page 22          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

    844       NOSWC = (JTYPE.LT.1.OR.JTYPE.GE.14.OR.ITAB.LE.0)
    845 
    846 C  IF LWCORR=1 AND NOSWC THEN NO CORRECTIONS ARE MADE
    847 C  --------------------------------------------------
    848 
    849       IF(LWCORR.LE.1.AND.NOSWC) THEN
    850          IRET = -1
    851          if(jtype.eq.20000)  iret = -99
    852          RETURN
    853       ENDIF
    854 
    855 C  GET SOLAR ELEVATION ANGLE ON ALL VALID MANDATORY LEVELS
    856 C  -------------------------------------------------------
    857 
    858       CALL SOELAN(SOLAR)
    859 
    860 C  APPLY SHORT- (AND POSS. LONG-) WAVE CORRECTIONS (LEVELS 11 TO 16)
    861 C  -----------------------------------------------------------------
    862 
    863       IF(NOSWC) THEN
    864          L = 6
    865       ELSE
    866          L = 1
    867       ENDIF
    868 
    869       DO I=L,6
    870          ANGLE(1) = CUTOFF(I)
    871          DTS(I)   = 0.
    872          DHS(I)   = 0.
    873          DTL      = 0.
    874          DHL      = 0.
    875 
    876          IF(.NOT.NOSWC .AND. SOLAR(10+I).GE.CUTOFF(I))  THEN
    877             DO K=2,10
    878                IF(SOLAR(10+I).LT.ANGLE(K))  GO TO 40
    879             ENDDO
    880             K = 11
    881 40          KK = K + (11 * (I - 1))
    882             DSUN = (SOLAR(10+I) - ANGLE(K-1))/(ANGLE(K) - ANGLE(K-1))
    883 
    884 C  COMPUTE S-W TEMP CORRECTIONS FOR ALL LEVELS BETWEEN 100 & 10 MB
    885 C  ---------------------------------------------------------------
    886 
    887             DTS(I) =DSUN*(TTAB(KK,ITAB)-TTAB(KK-1,ITAB))+TTAB(KK-1,ITAB)
    888 
    889 C  COMPUTE S-W HEIGHT CORRECTIONS AT 100 MB & INTERP. TO HIGHER LEVELS
    890 C  -------------------------------------------------------------------
    891 
    892             IF(I.EQ.1)  THEN
    893                DHS(1) =DSUN*(HTAB(K,ITAB)-HTAB(K-1,ITAB))+HTAB(K-1,ITAB)
    894             ELSE
    895                DHS(I) = DHS(I-1) + (ALP(I-1) * (DTS(I) + 10.*DTS(I-1)))
    896             ENDIF
    897          ENDIF
    898 
    899 C  CORRECT DTS BY A FACTOR OF 10
    900 C  -----------------------------

Page 23          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

    901 
    902          DTS(I) = .1*DTS(I)
    903          IF(I.EQ.6 .AND. LWCORR.GT.0 .AND. TMP(16).LT.BMISS)  THEN
    904 
    905 C  FOR LWCORR.GT.0, COMPUTE L-W TEMP & HGHT CORRECTIONS (ONLY AT 10 MB)
    906 C  --------------------------------------------------------------------
    907 
    908             DTL = .0625*(TMP(16)-DTS(6)) + 5.09
    909             DHL = (TMP(16)-DTS(6)) + 81.4
    910          ENDIF
    911 
    912 C  SAVE AND APPLY THE CORRECTIONS
    913 C  ------------------------------
    914 
    915          DHT(10+I) = DHL - DHS(I)
    916          DTP(10+I) = DTL - DTS(I)
    917 
    918          IF(HGT(10+I).LT.BMISS)  HGT(10+I) = HGT(10+I) + DHT(10+I)
    919          IF(TMP(10+I).LT.BMISS)  TMP(10+I) = TMP(10+I) + DTP(10+I)
    920 
    921       ENDDO
    922 
    923       RETURN
    924       END


ENTRY POINTS

  Name              
                    
 radt1_             

Page 24          Source Listing                  RADT1
2017-04-18 11:07 Symbol Table                    radcor.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 40                         Label  881                                                            878                               
 ALOG                       Func   836                                  scalar                    836                               
 ALP                        Local  709      R(4)            4     1     5                         836,895                           
 ANGLE                      Local  710      R(4)            4     1     11                        823,870,878,882                   
 BAL_DRIFT                  Scalar 706      R(4)            4           scalar   COM                                                
 BMISS                      Scalar 703      R(8)            8           scalar   COM              903,918,919                       
 BUFRLIB_MISSING            Common 707                                  16                                                          
 CUTOFF                     Local  709      R(4)            4     1     6                         824,870,876                       
 DHL                        Local  874      R(4)            4           scalar                    874,909,915                       
 DHS                        Local  709      R(4)            4     1     6                         872,893,895,915                   
 DHT                        Scalar 705      R(4)            4     1     16       COM              915,918                           
 DSUN                       Local  882      R(4)            4           scalar                    882,887,893                       
 DTL                        Local  873      R(4)            4           scalar                    873,908,916                       
 DTP                        Scalar 705      R(4)            4     1     16       COM              916,919                           
 DTS                        Local  709      R(4)            4     1     6                         871,887,895,902,908,909,916       
 H1J                        Local  711      R(4)            4     1     11       SAVE             811                               
 H3L                        Local  711      R(4)            4     1     11       SAVE             812                               
 H4M                        Local  711      R(4)            4     1     11       SAVE             813                               
 H5N                        Local  712      R(4)            4     1     11       SAVE             814                               
 H9R                        Local  712      R(4)            4     1     11       SAVE             815                               
 HASLSH                     Local  712      R(4)            4     1     11       SAVE             816                               
 HBS                        Local  712      R(4)            4     1     11       SAVE             817                               
 HCT                        Local  712      R(4)            4     1     11       SAVE             818                               
 HGT                        Scalar 705      R(4)            4     1     16       COM              918                               
 HGTTBL                     Scalar 706      L(4)            4           scalar   COM                                                
 HTAB                       Local  713      R(4)            4     2     88                        893                               
 I                          Local  835      I(4)            4           scalar                    835,836,869,870,871,872,876,878,88
                                                                                                  1,882,887,892,895,902,903,915,916,
                                                                                                  918,919                           
 IMISS                      Scalar 707      I(4)            4           scalar   COM                                                
 INIT                       Local  723      L(4)            4           scalar                    821                               
 IRCTBL                     Scalar 706      I(4)            4           scalar   COM                                                
 IRET                       Dummy  701      I(4)            4           scalar   ARG,INOUT        830,850,851                       
 ITAB                       Local  842      I(4)            4           scalar                    842,843,844,887,893               
 ITYPTB                     Local  714      I(4)            4     1     255                       825,843                           
 JTYPE                      Scalar 705      I(4)            4           scalar   COM              843,844,851                       
 K                          Local  877      I(4)            4           scalar                    877,878,880,881,882,893           
 KK                         Local  881      I(4)            4           scalar                    881,887                           
 L                          Local  864      I(4)            4           scalar                    864,866,869                       
 LEVRAD                     Scalar 706      I(4)            4           scalar   COM                                                
 LWCORR                     Scalar 706      I(4)            4           scalar   COM              849,903                           
 NOSWC                      Dummy  701      L(4)            4           scalar   ARG,INOUT        844,849,863,876                   
 PRES6                      Local  709      R(4)            4     1     6                         822,836                           
 RADCOM                     Common 705                                  260                                                         
 RADT1                      Subr   701                                                                                              
 SOELAN                     Subr   858                                                            858                               
 SOLAR                      Local  709      R(4)            4     1     16                        858,876,878,882                   
 SWITCH                     Common 706                                  20                                                          
 T1J                        Local  710      R(4)            4     1     66       SAVE             730                               
 T3L                        Local  710      R(4)            4     1     66       SAVE             740                               
 T4M                        Local  710      R(4)            4     1     66       SAVE             750                               

Page 25          Source Listing                  RADT1
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 T5N                        Local  710      R(4)            4     1     66       SAVE             760                               
 T9R                        Local  710      R(4)            4     1     66       SAVE             770                               
 TASLSH                     Local  711      R(4)            4     1     66       SAVE             780                               
 TBS                        Local  711      R(4)            4     1     66       SAVE             790                               
 TCT                        Local  711      R(4)            4     1     66       SAVE             800                               
 TMP                        Scalar 705      R(4)            4     1     16       COM              903,908,909,919                   
 TTAB                       Local  713      R(4)            4     2     528                       887                               
 XMISS                      Scalar 707      R(4)            4           scalar   COM                                                

Page 26          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

    925 
    926 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    927 C
    928 C SUBPROGRAM:    RADT2       APPLIES NEWER SET OF RADIATION CORRECTONS
    929 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2007-09-14
    930 C
    931 C ABSTRACT: THIS SUBROUTINE APPLIES RADIATION CORRECTIONS TO THE
    932 C   OBSERVED RADIOSONDE HEIGHTS AND TEMPERATURES ON THE BOTTOM 16
    933 C   MANDATORY PRESSURE LEVELS.  DATA ARE PASSED THROUGH COMMON
    934 C   /RADCOM/.  THE CORRECTION OF RAOBS FOR SHORT-WAVE RADIATIVE EFFECTS
    935 C   IS ACCOMPLISHED BY READING IN TABLES OF NUMBERS WHICH ARE DEPENDENT
    936 C   ON THE RADIOSONDE TYPE.  THE CORRECTION OF RAOBS FOR LONG-WAVE
    937 C   RADIATION (AT 10 MB ONLY) IS BASED ON THE 4'TH POWER OF THE 10 MB
    938 C   TEMPERATURE.  CALLED FOR ONE REPORT AT A TIME.
    939 C
    940 C PROGRAM HISTORY LOG:
    941 C   UNKNOWN   G. D. DIMEGO
    942 C 1988-03-10  D. A. KEYSER  -- PROCESSING OF 'LWCALL' SWITCH
    943 C 1988-11-04  D. A. KEYSER -- ADDED CORRECTIONS FOR NEW NOAA VIZ-A,
    944 C     VIZ-B, AND SPACE DATA CORP.
    945 C 1989-03-10  D. A. KEYSER -- EXPANDED TABLES FOR SINGLE NIGHTTIME
    946 C     CORR. & CORR. BELOW 700 MB, ADDED TABLE FOR SDC-89 SONDE BASED
    947 C     ON VIZ CORR. + (VIZ - SDC) BIAS
    948 C 1990-12-05  D. A. KEYSER -- CONVERTED TO VS FORTRAN(77)& RESTRUCTURED
    949 C 1992-03-18  D. A. KEYSER -- ADDED CORRECTIONS AT 925 MB TO TABLES
    950 C 1994-02-27  J. WOOLLEN   -- CONVERTED FOR USE WITH BUFR
    951 C 2002-07-22  D. A. KEYSER -- CALLS NEW ROUTINE SOELAN TO CALCULATE SUN
    952 C     ANGLE ON VALID MANDATORY LEVELS RATHER THAN DOING CALCULATION IN
    953 C     THIS SUBROUTINE
    954 C 2007-09-14  D. KEYSER    -- MINOR CODE CORRECTIONS SUGGESTED BY PAT
    955 C     PAULEY (CORRECTS PROBLEMS THAT COULD OCCUR ON SOME REMOTE
    956 C     MACHINES)
    957 C
    958 C USAGE:    CALL RADT2(NOSWC,IRET)
    959 C   OUTPUT ARGUMENT LIST:
    960 C     NOSWC    - LOGICAL INDICATING NO SHORT-WAVE CORRECTION APPLIED
    961 C     IRET     - RETURN CODE (0=CORRECTIONS, -1=NO CORRECTIONS,
    962 C              - -99=??????)
    963 C
    964 C   OUTPUT FILES:
    965 C     UNIT 06  - PRINTOUT
    966 C     UNIT 68  - RADCOR INFORMATION FILE
    967 C
    968 C REMARKS: THESE CORRECTIONS USE THE ORIGINAL NMC OFFICE NOTE 29
    969 C   RADIOSONDE TYPE CODES OBTAINED FROM THE NMC UPPER-AIR DICTIONARY.
    970 C   CALLED BY SUBROUTINE "RADEVN".
    971 C
    972 C
    973 C   KEY FOR RADIOSONDE TYPES USED HERE:
    974 C
    975 C JTYPE(ON29)  CODE NAME (DICTIONARY)  DESCRIPTION
    976 C
    977 C     1           T1J00Z         U.S. NOAA / VIZ-A - 1988 -- 00Z
    978 C      -- OR --   T1J12Z         U.S. NOAA / VIZ-A - 1988 -- 12Z
    979 C     2    ** NO CORRECTION **   RESERVED
    980 C     3           T3L            U.S. AN/AMT 4
    981 C     4           T4M            FINNISH VAISALA (IN FINLAND)

Page 27          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

    982 C     5           T5N            FRENCH MESURAL (IN FRANCE)
    983 C     6    ** NO CORRECTION **   PORTUGAL (CANADIAN MODEL IV) (INACTIVE)
    984 C     7           T7P            WEST GERMAN GRAW
    985 C     8    ** NO CORRECTION **   RESERVED
    986 C     9           T9R            JAPANESE "CODE SENDING"
    987 C    10           TASLSH         EAST GERMAN FREIBERG (INACTIVE)
    988 C    11           TBS            UNITED KINGDOM KEW
    989 C    12           T2200Z         U.S.S.R A-22 -- 00Z
    990 C      -- OR --   T2212Z         U.S.S.R A-22 -- 12Z
    991 C    13    ** NO CORRECTION **   RESERVED
    992 C    14           TVSL2          FINNISH VAISALA (IN/OUT FINLAND)
    993 C    15           TFMR2          FRENCH MESURAL (OUT OF FRANCE)
    994 C    16    ** NO CORRECTION **   AUSTRALIAN PHILLIPS
    995 C    17           TAUS           AUSTRALIAN "DIAMOND HINMAN" (INACTIVE)
    996 C    18           TCSG           CANADIAN "SANGAMO"
    997 C    19           TCHI           CHINESE
    998 C    20           TRK00Z         U.S.S.R. RKZ -- 00Z
    999 C      -- OR --   TRK12Z         U.S.S.R. RKZ -- 12Z
   1000 C    21           TAV00Z         U.S.S.R. UNKNOWN (AVG. A-22&RKZ) -- 00Z
   1001 C      -- OR --   TAV12Z         U.S.S.R. UNKNOWN (AVG. A-22&RKZ) -- 12Z
   1002 C    22    ** NO CORRECTION **   INDIAN MET. SERVICE
   1003 C    23    ** NO CORRECTION **   AUSTRIAN ELIN
   1004 C    24    ** NO CORRECTION **   KOREAN JINYANG / VIZ
   1005 C    25    ** NO CORRECTION **   SWISS METEOLABOR
   1006 C    26    ** NO CORRECTION **   CZECH VINOHRADY
   1007 C    27    ** NO CORRECTION **   U.S. MSS (SPACE DATA CORP.)
   1008 C    28           T1J00Z         U.S. NOAA / VIZ-B - 1988 -- 00Z
   1009 C      -- OR --   T1J12Z         U.S. NOAA / VIZ-B - 1988 -- 12Z
   1010 C    29           TSD00Z         U.S. NOAA / SPACE DATA CORP. - 1989
   1011 C      -- OR --   TSD12Z         U.S. NOAA / SPACE DATA CORP. - 1989
   1012 C    30 \
   1013 C   THRU > ** NO CORRECTION **   RESERVED
   1014 C    97 /
   1015 C
   1016 C
   1017 C   KEY FOR LEVELS IN DATA (CORRECTION) TABLES:
   1018 C
   1019 C     1 - 1000 MB
   1020 C     2 -- 925 MB
   1021 C     3 -- 850 MB        T --  20 MB
   1022 C     4 -- 700 MB        L --  10 MB
   1023 C     5 -- 500 MB        A -- 400 MB (INTERP. BETWEEN 500 & 300 MB)
   1024 C     6 -- 300 MB        B -- 250 MB (INTERP. BETWEEN 300 & 200 MB)
   1025 C     7 -- 200 MB        C -- 150 MB (INTERP. BETWEEN 200 & 100 MB)
   1026 C     8 -- 100 MB        D --  70 MB (INTERP. BETWEEN 100 &  50 MB)
   1027 C     9 --  50 MB        E --  30 MB (INTERP. BETWEEN  50 &  10 MB)
   1028 C     $ --  30 MB        F --  20 MB (INTERP. BETWEEN  50 &  10 MB)
   1029 C
   1030 C
   1031 C   THE RADIATION CORRECTION TABLES ARE OBTAINED FROM NOAA TECH. MEMO.
   1032 C   NWS NMC 63, BY MCINTURFF ET. AL. (1972).
   1033 C
   1034 C
   1035 C   THE CUTOFF ANGLE AT EACH LEVEL IS CALCULATED USING THE RELATION:
   1036 C              CUTOFF ANGLE = -1.76459 * (Z**.40795) ,
   1037 C   WHERE Z IS A REFERENCE HEIGHT FOR THE LEVEL (IN KILOMETERS).
   1038 C   (SEE NMC OFFICE NOTE 306, TABLE 4 FOR LIST OF REFERENCE HEIGHTS.)

Page 28          Source Listing                  RADT1
2017-04-18 11:07                                 radcor.f

   1039 C
   1040 C
   1041 C ATTRIBUTES:
   1042 C   LANGUAGE: FORTRAN 90
   1043 C   MACHINE:  NCEP WCOSS
   1044 C
   1045 C$$$
   1046       SUBROUTINE RADT2(NOSWC,IRET)
   1047       PARAMETER (NST=999)
   1048 
   1049       REAL(8) BMISS
   1050 
   1051       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   1052      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   1053      &                 NEV, ISF(NST), NLVM, NLVW
   1054       COMMON /RADCOM/ HGT(16),TMP(16),DHT(16),DTP(16),JTYPE
   1055       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
   1056       COMMON /PMAND / PRES(16),KMIN,KMAX,INM(16)
   1057       COMMON /STN/     IS
   1058       COMMON /DATEX/   IDATE(5), CDATE
   1059       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   1060 
   1061       REAL        T1J00Z(11,16),T1J12Z(11,16),T2200Z(11,16),
   1062      .            T2212Z(11,16),TRK00Z(11,16),TRK12Z(11,16),
   1063      .            TAV00Z(11,16),TAV12Z(11,16),T3L(11,16),T4M(11,16),
   1064      .            T5N(11,16),T7P(11,16),T9R(11,16),TASLSH(11,16),
   1065      .            TBS(11,16),TVSL2(11,16),TFMR2(11,16),TAUS(11,16),
   1066      .            TCSG(11,16),TCHI(11,16),TSD00Z(11,16),TSD12Z(11,16),
   1067      .            TTAB(11,16,22),CUTOFF(16),SOLAR(16),ANGLE(11),
   1068      .            ALP(16),DTS(16),DHS(16)
   1069       INTEGER     ITYPTB(255)
   1070       EQUIVALENCE (TTAB(1,1,1), T1J00Z(1,1)),(TTAB(1,1,2), T1J12Z(1,1)),
   1071      .            (TTAB(1,1,3), T3L(1,1)),   (TTAB(1,1,4), T4M(1,1))   ,
   1072      .            (TTAB(1,1,5), T5N(1,1)),   (TTAB(1,1,6), T7P(1,1))   ,
   1073      .            (TTAB(1,1,7), T9R(1,1)),   (TTAB(1,1,8), TASLSH(1,1)),
   1074      .            (TTAB(1,1,9), TBS(1,1)),   (TTAB(1,1,10),T2200Z(1,1)),
   1075      .            (TTAB(1,1,11),T2212Z(1,1)),(TTAB(1,1,12),TVSL2(1,1)) ,
   1076      .            (TTAB(1,1,13),TFMR2(1,1)), (TTAB(1,1,14),TAUS(1,1))  ,
   1077      .            (TTAB(1,1,15),TCSG(1,1)),  (TTAB(1,1,16),TCHI(1,1))  ,
   1078      .            (TTAB(1,1,17),TRK00Z(1,1)),(TTAB(1,1,18),TRK12Z(1,1)),
   1079      .            (TTAB(1,1,19),TAV00Z(1,1)),(TTAB(1,1,20),TAV12Z(1,1)),
   1080      .            (TTAB(1,1,21),TSD00Z(1,1)),(TTAB(1,1,22),TSD12Z(1,1))
   1081       CHARACTER*8 SID
   1082       CHARACTER*10     CDATE
   1083       LOGICAL     NOSWC,SWC, HGTTBL
   1084 
   1085       DATA  ANGLE  /-90.,-5.,5.,15.,25.,35.,45.,55.,65.,75.,85./
   1086       DATA  CUTOFF/-0.73,-1.58,-2.06,-2.77,-3.56,-3.95,-4.36,-4.58,
   1087      .             -4.83,-5.12,-5.49,-5.79,-6.06,-6.43,-6.72,-7.17/
   1088 
   1089 C  ITYPTB ASSIGNS PROPER TEMPERATURE CORRECTION TABLE TO INST. TYPES
   1090 C  -----------------------------------------------------------------
   1091 
   1092 C  ===> JTYPE:       1    2    3    4    5    6    7    8    9   10
   1093 
   1094       DATA  ITYPTB / 1 ,  0 ,  3 ,  4 ,  5 ,  0 ,  6 ,  0 ,  7 ,  8 ,
   1095 

Page 29          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1096 C  ===> JTYPE:      11   12   13   14   15   16   17   18   19   20
   1097 
   1098      .               9 , 10 ,  0 , 12 , 13 ,  0 , 14 , 15 , 16 , 17 ,
   1099 
   1100 C  ===> JTYPE:      21   22   23   24   25   26   27   28   29  30-256
   1101 
   1102      .              19 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  1 , 21 ,226*0/
   1103 
   1104 C  TEMPERATURE CORRECTIONS (*10 K) FOR S-W RADIATION EFFECTS
   1105 C  ---------------------------------------------------------
   1106 
   1107 
   1108 C    NOAA / VIZ - A 1988, TECH MEMO TABLE FOR 00Z AFTERNOON DAYLIGHT
   1109 C               =====>  JTYPE =  1  --   ITAB =  1  <=====
   1110 C                                -- OR --
   1111 C    NOAA / VIZ - B 1988, TECH MEMO TABLE FOR 00Z AFTERNOON DAYLIGHT
   1112 C               =====>  JTYPE = 28  --   ITAB =  1  <=====
   1113 
   1114       DATA  T1J00Z /
   1115 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1116 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1117 C LEVEL
   1118      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1119      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1120      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1121      4    0.,  2.,  3.,  5.,  6.,  6.,  3.,  4.,  5.,  5.,  4.,
   1122      5    0.,  2.,  3.,  4.,  5.,  5.,  4.,  4.,  5.,  5.,  6.,
   1123      A    0.,  2.,  3.,  5.,  5.,  5.,  4.,  4.,  5.,  5.,  6.,
   1124      6    0.,  2.,  4.,  6.,  6.,  6.,  5.,  5.,  5.,  5.,  6.,
   1125      B    0.,  2.,  4.,  6.,  6.,  6.,  5.,  6.,  6.,  6.,  7.,
   1126      7    0.,  1.,  5.,  6.,  7.,  7.,  6.,  7.,  7.,  7.,  8.,
   1127      C    0.,  1.,  6.,  7.,  8.,  8.,  8.,  8.,  8.,  9.,  9.,
   1128      8    0.,  2.,  7.,  9., 10., 10., 10., 10., 10., 12., 10.,
   1129      D    0.,  3.,  9., 11., 12., 12., 11., 10., 11., 11., 10.,
   1130      9    0.,  5., 11., 13., 14., 14., 12., 11., 13., 10.,  9.,
   1131      $    0.,  9., 16., 18., 21., 19., 14., 14., 10., 16., 12.,
   1132      T    0., 12., 19., 23., 26., 24., 18., 15., 13., 13., 22.,
   1133      L    0., 19., 24., 29., 32., 26., 28., 23., 25., 11., 32./
   1134 
   1135 
   1136 C    NOAA / VIZ - A 1988, TECH MEMO TABLE FOR 12Z MORNING DAYLIGHT
   1137 C               =====>  JTYPE =  1  --   ITAB =  2  <=====
   1138 C                                -- OR --
   1139 C    NOAA / VIZ - B 1988, TECH MEMO TABLE FOR 12Z MORNING DAYLIGHT
   1140 C               =====>  JTYPE = 28  --   ITAB =  2  <=====
   1141 
   1142       DATA  T1J12Z /
   1143 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1144 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1145 C LEVEL
   1146      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1147      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1148      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1149      4    0., -2., -1.,  2.,  4.,  5.,  4.,  8.,  9.,  0.,  0.,
   1150      5    0., -2., -1.,  2.,  4.,  4.,  5., 10.,  9.,  0.,  0.,
   1151      A    0., -2., -1.,  2.,  3.,  4.,  6., 11., 10.,  0.,  0.,
   1152      6    0., -2.,  0.,  2.,  2.,  4.,  7., 12., 11.,  0.,  0.,

Page 30          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1153      B    0., -1.,  1.,  3.,  3.,  6., 11., 11., 10.,  0.,  0.,
   1154      7    0.,  0.,  2.,  5.,  4.,  8., 15., 10.,  9.,  0.,  0.,
   1155      C    0.,  0.,  3.,  6.,  5.,  8., 14., 13.,  9.,  0.,  0.,
   1156      8    0.,  1.,  5.,  7.,  7.,  8., 12., 16., 10.,  0.,  0.,
   1157      D    0.,  1.,  5.,  7.,  8.,  9., 13., 13., 12.,  0.,  0.,
   1158      9    0.,  0.,  5.,  7.,  9., 11., 14., 10., 15.,  0.,  0.,
   1159      $    0., -1.,  6., 10., 11., 14., 13., 22., -4.,  0.,  0.,
   1160      T    0., -2.,  8., 11., 11., 15., 12., 13.,  0.,  0.,  0.,
   1161      L    0.,  0., 13., 13., 11., 13., 19., 35.,  0.,  0.,  0./
   1162 
   1163 
   1164 C                   AN/AMT 4 NOAA / VIZ MILITARY TYPE
   1165 C               =====>  JTYPE =  3  --   ITAB =  3  <=====
   1166 
   1167       DATA  T3L /
   1168 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1169 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___ ___      ANGLE
   1170 C LEVEL
   1171      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1172      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1173      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1174      4    0., -1.,  0.,  0.,  2.,  3.,  3.,  3.,  2.,  1.,  0.,
   1175      5    0., -5., -1.,  0.,  2.,  4.,  3.,  4.,  4.,  3.,  0.,
   1176      A    0., -3.,  0.,  1.,  2.,  4.,  3.,  4.,  4.,  3.,  0.,
   1177      6    0., -2.,  1.,  4.,  4.,  5.,  4.,  5.,  6.,  5.,  0.,
   1178      B    0., -1.,  2.,  4.,  4.,  5.,  4.,  5.,  6.,  5.,  0.,
   1179      7    0.,  0.,  5.,  6.,  5.,  5.,  4.,  6.,  7.,  6.,  0.,
   1180      C    0.,  0.,  4.,  6.,  6.,  6.,  6.,  7.,  7.,  7.,  0.,
   1181      8    0., -1.,  4.,  8.,  8.,  9.,  9., 10.,  8.,  9.,  0.,
   1182      D    0.,  0.,  6.,  8.,  9., 10., 10., 12., 11.,  0.,  0.,
   1183      9    0.,  2.,  8.,  8., 11., 11., 11., 14., 15.,  0.,  0.,
   1184      $    0.,  8., 12., 17., 14., 18., 15., 17., 18.,  0.,  0.,
   1185      T    0.,  0., 17., 18., 18., 16., 17., 17., 16., 12.,  0.,
   1186      L    0., 15., 14., 29., 17., 20., 25., 27., 23., 19.,  0./
   1187 
   1188 
   1189 C     VAISALA INSIDE FINLAND (NEW VALUES INTERPOLATED FOR LEVELS E&F)
   1190 C               =====>  JTYPE =  4  --   ITAB =  4  <=====
   1191 
   1192       DATA  T4M /
   1193 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1194 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1195 C LEVEL
   1196      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1197      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1198      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1199      4    0., -1.,  1.,  1.,  1.,  1.,  1.,  0.,  0.,  0.,  0.,
   1200      5    0., -1.,  2.,  4., -2.,  4.,  0.,  0.,  0.,  0.,  0.,
   1201      A    0., -1.,  1.,  3.,  0.,  2.,  0.,  0.,  0.,  0.,  0.,
   1202      6    0., -3.,  0.,  2.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,
   1203      B    0., -2.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,
   1204      7    0., -1.,  1., -2., -2.,  1.,  0.,  0.,  0.,  0.,  0.,
   1205      C    0.,  0.,  0., -1., -1.,  0.,  0.,  0.,  0.,  0.,  0.,
   1206      8    0.,  0., -1.,  0., -1.,  0.,  0.,  0.,  0.,  0.,  0.,
   1207      D    0., -2., -1.,  0.,  0.,  2.,  0.,  0.,  0.,  0.,  0.,
   1208      9    0., -4., -2.,  0.,  1.,  4.,  0.,  0.,  0.,  0.,  0.,
   1209      E    0., -2., -2., -1.,  2.,  4.,  0.,  0.,  0.,  0.,  0.,

Page 31          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1210      F    0.,  1., -1., -3.,  4.,  3.,  0.,  0.,  0.,  0.,  0.,
   1211      T    0.,  3.,  0., -4.,  5.,  2.,  0.,  0.,  0.,  0.,  0./
   1212 
   1213 
   1214 C                 MESURAL INSIDE METROPOLITAN FRANCE
   1215 C               =====>  JTYPE =  5  --   ITAB =  5  <=====
   1216 
   1217       DATA T5N  /
   1218 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1219 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1220 C LEVEL
   1221      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1222      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1223      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1224      4    0.,  0.,  0.,  3.,  2.,  3.,  2.,  2., -2.,  0.,  0.,
   1225      5    0.,  0.,  0.,  4.,  2.,  3.,  6.,  3.,  2.,  0.,  0.,
   1226      A    0.,  0.,  0.,  3.,  2.,  3.,  5.,  3.,  1.,  0.,  0.,
   1227      6    0.,  0.,  0.,  3.,  2.,  4.,  5.,  3.,  1.,  0.,  0.,
   1228      B    0.,  0.,  0.,  1.,  3.,  4.,  2.,  3.,  1.,  0.,  0.,
   1229      7    0.,  0.,  0., -1.,  5.,  5., -1.,  5.,  2.,  0.,  0.,
   1230      C    0.,  0.,  0.,  1.,  5.,  5.,  0.,  5.,  3.,  0.,  0.,
   1231      8    0.,  0.,  0.,  4.,  6.,  6.,  3.,  6.,  5.,  0.,  0.,
   1232      D    0.,  0.,  0.,  6.,  7.,  7.,  5.,  7.,  8.,  0.,  0.,
   1233      9    0.,  0.,  0.,  9.,  8.,  8.,  8.,  8., 12.,  0.,  0.,
   1234      $    0.,  0.,  0., 11., 12., 10., 13., 11.,  9.,  0.,  0.,
   1235      T    0.,  0.,  0., 12., 13., 18., 12., 16., 18.,  0.,  0.,
   1236      L    0.,  0.,  0., 19., 22., 26., 32., 11.,  9.,  0.,  0./
   1237 
   1238 
   1239 C                           WEST GERMAN GRAW
   1240 C               =====>  JTYPE =  7  --   ITAB =  6  <=====
   1241 
   1242       DATA  T7P /
   1243 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1244 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1245 C LEVEL
   1246      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1247      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1248      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1249      4    0.,  0.,  0.,  1., -1.,  0.,  1.,  0., -2.,  0.,  0.,
   1250      5    0.,  0.,  0.,  0., -1.,  0.,  0.,  0.,  2.,  0.,  0.,
   1251      A    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,
   1252      6    0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,
   1253      B    0.,  0.,  0.,  0.,  1.,  1.,  1.,  0.,  0.,  0.,  0.,
   1254      7    0.,  0.,  0.,  1.,  2.,  3.,  3.,  1.,  2.,  0.,  0.,
   1255      C    0.,  0.,  0.,  2.,  3.,  3.,  3.,  1.,  3.,  0.,  0.,
   1256      8    0.,  0.,  0.,  4.,  5.,  3.,  4.,  3.,  6.,  0.,  0.,
   1257      D    0.,  0.,  0.,  5.,  5.,  4.,  2.,  3.,  5.,  0.,  0.,
   1258      9    0.,  0.,  0.,  6.,  5.,  6.,  2.,  4.,  5.,  0.,  0.,
   1259      $    0.,  0.,  9.,  6.,  6.,  8.,  1.,  0.,  0.,  0.,  0.,
   1260      T    0.,  0., 10.,  5.,  6.,  6., -1.,  4.,  0.,  0.,  0.,
   1261      L    0.,  0.,  0.,  7.,  3.,  7., -2., -3.,  0.,  0.,  0./
   1262 
   1263 
   1264 C                                JAPANESE
   1265 C               =====>  JTYPE =  9  --   ITAB =  7  <=====
   1266 

Page 32          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1267       DATA  T9R /
   1268 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1269 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1270 C LEVEL
   1271      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1272      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1273      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1274      4    0.,  0.,  3.,  0.,  1.,  2.,  2.,  2.,  3.,  0.,  0.,
   1275      5    0.,  0.,  0.,  2.,  3.,  3.,  4.,  5.,  7.,  0.,  0.,
   1276      A    0.,  0.,  0.,  3.,  3.,  3.,  4.,  5.,  6.,  0.,  0.,
   1277      6    0.,  0.,  0.,  6.,  4.,  3.,  4.,  5.,  6.,  0.,  0.,
   1278      B    0.,  0.,  0.,  5.,  4.,  4.,  4.,  4.,  5.,  0.,  0.,
   1279      7    0.,  0.,  0.,  4.,  6.,  6.,  4.,  4.,  5.,  0.,  0.,
   1280      C    0.,  0.,  0.,  5.,  6.,  6.,  5.,  5.,  4.,  0.,  0.,
   1281      8    0.,  0.,  0.,  7.,  8.,  7.,  8.,  8.,  4.,  0.,  0.,
   1282      D    0.,  0.,  0., 10., 10.,  8.,  8.,  8.,  2.,  0.,  0.,
   1283      9    0.,  0.,  0., 13., 12., 10.,  8.,  9.,  2.,  1.,  0.,
   1284      $    0.,  0.,  0., 26., 19., 16., 12., 11., 10., -5.,  0.,
   1285      T    0.,  0.,  0.,  0., 30., 28., 19., 13., 14.,-10.,  0.,
   1286      L    0.,  0.,  0.,  0., 41., 35., 16., 18., 14.,  0.,  0./
   1287 
   1288 
   1289 C         EAST GERMAN FREIBERG (INACTIVE - WAS NOT IN TECH MEMO)
   1290 C         SOURCE UNKNOWN POSSIBLY TAKEN FROM ORIGINAL RADNCORR)
   1291 C               =====>  JTYPE = 10  --   ITAB =  8  <=====
   1292 
   1293       DATA  TASLSH /
   1294 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1295 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1296 C LEVEL
   1297      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1298      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1299      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1300      4    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1301      5    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1302      A    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1303      6    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1304      B    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1305      7    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1306      C    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1307      8    0.,  0.,  4.,  9., 12., 16., 19., 21., 11.,  0.,  0.,
   1308      D    0.,  0.,  6., 13., 16., 20., 23., 25., 13.,  0.,  0.,
   1309      9    0.,  0.,  8., 17., 20., 24., 27., 29., 15.,  0.,  0.,
   1310      $    0.,  0., 12., 29., 38., 45., 50., 53., 27.,  0.,  0.,
   1311      T    0.,  0., 15., 37., 50., 58., 63., 66., 33.,  0.,  0.,
   1312      L    0.,  0., 29., 63., 72., 78., 80., 81., 41.,  0.,  0./
   1313 
   1314 
   1315 C   UNITED KINGDOM KEW (WPT HAD THIS INSTRUMENT AS PAKISTANI FAN-TYPE)
   1316 C               =====>  JTYPE = 11  --   ITAB =  9  <=====
   1317 
   1318       DATA  TBS /
   1319 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1320 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1321 C LEVEL
   1322      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1323      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,

Page 33          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1324      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1325      4    0.,  0., -3., -1., -1.,  0., -1., -1., -1.,  0.,  0.,
   1326      5    0.,  0., -2.,  0.,  0.,  0.,  0.,  0., -1., -6.,  0.,
   1327      A    0.,  0., -2.,  0.,  0.,  0.,  0.,  0.,  0., -4.,  0.,
   1328      6    0.,  0., -2.,  0.,  0.,  2.,  1.,  1.,  0., -3.,  0.,
   1329      B    0.,  0., -1.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,
   1330      7    0.,  0., -1., -1.,  0.,  0.,  0., -2.,  0.,  0.,  0.,
   1331      C    0.,  0.,  0.,  0.,  1.,  0.,  0., -2.,  0.,  0.,  0.,
   1332      8    0.,  0., -2.,  1.,  3.,  2.,  0., -3., -1.,  0.,  0.,
   1333      D    0.,  0., -6., -1.,  1.,  0., -1., -1.,  1.,  0.,  0.,
   1334      9    0.,  0.,-10., -3.,  1., -1., -3.,  0.,  3.,  0.,  0.,
   1335      $    0.,  0., -5., -1.,  8.,  3.,  1.,  4., -1.,  0.,  0.,
   1336      T    0.,  0.,  3.,  4., 16., 15., 11.,  8.,  0.,  0.,  0.,
   1337      L    0.,  0., 32., 33., 43., 33., 28., 14.,  0.,  0.,  0./
   1338 
   1339 
   1340 C          USSR A-22 TECH MEMO TABLE FOR 00Z MORNING DAYLIGHT
   1341 C               =====>  JTYPE = 12  --   ITAB = 10  <=====
   1342 
   1343       DATA  T2200Z /
   1344 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1345 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1346 C LEVEL
   1347      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1348      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1349      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1350      4    0.,  0.,  1.,  0., -1.,  0., -1., -2.,  0.,  0.,  0.,
   1351      5    0., -1.,  0.,  0., -1.,  0.,  0., -2.,  0.,  0.,  0.,
   1352      A    0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,
   1353      6    0.,  0.,  0.,  0.,  2.,  1.,  2.,  1.,  0.,  0.,  0.,
   1354      B    0.,  0.,  1.,  0.,  2.,  1.,  1.,  0.,  0.,  0.,  0.,
   1355      7    0.,  0.,  2.,  1.,  2.,  2., -1., -2.,  0.,  0.,  0.,
   1356      C    0.,  0.,  2.,  1.,  2.,  3.,  0.,  0.,  0.,  0.,  0.,
   1357      8    0.,  0.,  2.,  2.,  3.,  5.,  1.,  3.,  0.,  0.,  0.,
   1358      D    0.,  0.,  2.,  3.,  4.,  6.,  3.,  3.,  0.,  0.,  0.,
   1359      9    0., -1.,  3.,  5.,  5.,  8.,  5.,  3.,  0.,  0.,  0.,
   1360      $    0., -2.,  4.,  6.,  5.,  7.,  6.,  4.,  3.,  0.,  0.,
   1361      T    0., -1.,  6.,  9.,  9., 11., 12.,  9., -6.,  0.,  0.,
   1362      L    0.,  1.,  9., 19., 28.,  5., 23., 24.,  0.,  0.,  0./
   1363 
   1364 
   1365 C          USSR A-22 TECH MEMO TABLE FOR 12Z AFTERNOON DAYLIGHT
   1366 C               =====>  JTYPE = 12  --   ITAB = 11  <=====
   1367 
   1368       DATA  T2212Z /
   1369 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1370 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1371 C LEVEL
   1372      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1373      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1374      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1375      4    0.,  1.,  3.,  3.,  5.,  2.,  2.,  1.,  1.,  0.,  0.,
   1376      5    0.,  2.,  2.,  3.,  3.,  2.,  2.,  3.,  0.,  0.,  0.,
   1377      A    0.,  2.,  2.,  3.,  2.,  3.,  3.,  3.,  2.,  0.,  0.,
   1378      6    0.,  1.,  3.,  2.,  1.,  4.,  4.,  2.,  4.,  0.,  0.,
   1379      B    0.,  1.,  3.,  2.,  2.,  3.,  2.,  0.,  2.,  0.,  0.,
   1380      7    0.,  1.,  3.,  2.,  3.,  1.,  0., -2.,  0.,  0.,  0.,

Page 34          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1381      C    0.,  1.,  4.,  3.,  4.,  3.,  1., -1.,  0.,  0.,  0.,
   1382      8    0.,  2.,  5.,  4.,  5.,  5.,  3.,  0.,  0.,  0.,  0.,
   1383      D    0.,  2.,  5.,  5.,  6.,  7.,  4.,  2.,  0.,  0.,  0.,
   1384      9    0.,  3.,  6.,  7.,  7.,  9.,  6.,  4.,  0.,  0.,  0.,
   1385      $    0.,  2.,  3.,  8.,  9.,  9.,  5.,  8.,  0.,  0.,  0.,
   1386      T    0.,  3.,  5., 10.,  1., 12., 10.,  2.,  0.,  0.,  0.,
   1387      L    0., -2.,  2., 25.,  3., 18.,  2.,  0.,  0.,  0.,  0./
   1388 
   1389 
   1390 C                   VAISALA INSIDE & OUTSIDE OF FINLAND
   1391 C               =====>  JTYPE = 14  --   ITAB = 12  <=====
   1392 
   1393       DATA  TVSL2 /
   1394 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1395 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1396 C LEVEL
   1397      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1398      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1399      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1400      4    0., -2.,  1.,  1.,  3.,  1.,  2.,  3.,  5.,  3.,  2.,
   1401      5    0.,  2.,  1.,  0.,  1.,  2.,  2.,  3.,  4.,  6.,  0.,
   1402      A    0.,  0.,  1.,  0.,  1.,  2.,  1.,  3.,  4.,  6.,  0.,
   1403      6    0., -1.,  1.,  1.,  2.,  2.,  3.,  3.,  5.,  6.,  0.,
   1404      B    0.,  0.,  1.,  1.,  1.,  2.,  3.,  3.,  5.,  6.,  0.,
   1405      7    0.,  0.,  1.,  1.,  1.,  2.,  3.,  5.,  6.,  6.,  0.,
   1406      C    0.,  0.,  1.,  1.,  2.,  3.,  3.,  6.,  8.,  8.,  0.,
   1407      8    0.,  1.,  3.,  3.,  4.,  6.,  5.,  8., 13., 13.,  0.,
   1408      D    0.,  1.,  5.,  6.,  7.,  9.,  8.,  9., 10.,  0.,  0.,
   1409      9    0.,  1.,  8., 10., 10., 12., 12., 10.,  8.,  0.,  0.,
   1410      $    0.,  1., 20., 24., 22., 20., 15.,  4.,  1.,  0.,  0.,
   1411      T    0.,  1., 19., 24., 20., 20., 16.,  4.,  1.,  0.,  0.,
   1412      L    0., 26., 31., 40., 18., 33., 14., 25.,  0.,  0.,  0./
   1413 
   1414 
   1415 C                     MESURAL USED OUTSIDE OF FRANCE
   1416 C               =====>  JTYPE = 15  --   ITAB = 13  <=====
   1417 
   1418       DATA  TFMR2 /
   1419 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1420 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1421 C LEVEL
   1422      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1423      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1424      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1425      4    0.,  0.,  0.,  0.,  8.,  6.,  8.,  5.,  2.,  0.,  0.,
   1426      5    0.,  0.,  0.,  0.,  5.,  8.,  9.,  7.,  5.,  4.,  0.,
   1427      A    0.,  0.,  0.,  0.,  8.,  8., 11.,  8.,  6.,  4.,  0.,
   1428      6    0.,  0.,  0.,  0., 13.,  9., 14., 11.,  8.,  6.,  0.,
   1429      B    0.,  0.,  0.,  0., 17., 10., 32., 28., 38., 20.,  0.,
   1430      7    0.,  0.,  0.,  0., 23., 22., 55., 49., 76., 38.,  0.,
   1431      C    0.,  0.,  0.,  0., 28., 23., 42., 39., 54., 27.,  0.,
   1432      8    0.,  0.,  0.,  0., 37., 25., 24., 27., 23., 12.,  0.,
   1433      D    0.,  0.,  0.,  0., 49., 33., 33., 15., 30., 18.,  0.,
   1434      9    0.,  0.,  0.,  0., 62., 42., 43.,  4., 37., 24.,  0.,
   1435      $    0.,  0.,  0.,  0., 76., 66., 51., 51., 53.,  0.,  0.,
   1436      T    0.,  0.,  0.,  0.,114., 88., 85., 93., 50.,  0.,  0.,
   1437      L    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0./

Page 35          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1438 
   1439 
   1440 C                   AUSTRALIAN DIAMOND HINMAN (INACTIVE)
   1441 C               =====>  JTYPE = 17  --   ITAB = 14  <=====
   1442 
   1443       DATA  TAUS /
   1444 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1445 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1446 C LEVEL
   1447      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1448      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1449      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1450      4    0.,  0.,  3.,  0.,  3.,  2.,  1.,  3.,  7.,  3.,  4.,
   1451      5    0.,  0.,  0.,  2.,  1.,  2.,  2.,  4.,  5.,  4., -3.,
   1452      A    0.,  0.,  0.,  2.,  1.,  2.,  2.,  3.,  3.,  2.,  0.,
   1453      6    0.,  0.,  0.,  2.,  2.,  2.,  3.,  2.,  2.,  1.,  0.,
   1454      B    0.,  0.,  0.,  2.,  2.,  3.,  4.,  3.,  3.,  2.,  0.,
   1455      7    0.,  0.,  2.,  4.,  4.,  5.,  6.,  5.,  6.,  5.,  9.,
   1456      C    0.,  0.,  0.,  4.,  5.,  5.,  7.,  7.,  8.,  7.,  8.,
   1457      8    0.,  0.,  0.,  6.,  8.,  7.,  9., 10., 11., 10.,  8.,
   1458      D    0.,  0.,  0.,  7.,  9.,  9., 11., 10., 12., 12.,  0.,
   1459      9    0.,  0.,  0.,  9., 10., 11., 13., 11., 14., 14.,  0.,
   1460      $    0.,  0.,  0.,  8., 17., 17., 17., 18., 14., 24.,  0.,
   1461      T    0.,  0.,  0., 18., 17., 16., 28., 22., 17., 14.,  0.,
   1462      L    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0./
   1463 
   1464 
   1465 C                           SANGAMO CANADIAN
   1466 C               =====>  JTYPE = 18  --   ITAB = 15  <=====
   1467 
   1468       DATA  TCSG /
   1469 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1470 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1471 C LEVEL
   1472      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1473      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1474      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1475      4    0.,  0.,  1.,  3.,  4.,  3.,  2., -1., -3.,  0.,  0.,
   1476      5    0.,  0.,  0.,  4.,  5.,  5.,  1.,  3.,  1.,  0.,  0.,
   1477      A    0.,  0.,  0.,  4.,  5.,  5.,  2.,  3.,  3.,  0.,  0.,
   1478      6    0.,  0.,  2.,  4.,  5.,  7.,  5.,  5.,  6., -1.,  0.,
   1479      B    0.,  0.,  2.,  4.,  5.,  6.,  3.,  5.,  7.,  3.,  0.,
   1480      7    0.,  0.,  4.,  4.,  5.,  6.,  2.,  6.,  9., 10.,  0.,
   1481      C    0.,  0.,  4.,  5.,  5.,  7.,  4.,  8.,  9.,  8.,  0.,
   1482      8    0.,  1.,  6.,  7.,  7.,  9.,  8., 13., 10.,  8.,  0.,
   1483      D    0.,  1.,  7.,  9.,  8., 10.,  9.,  9.,  9., 12.,  0.,
   1484      9    0.,  1.,  8., 11.,  9., 12., 11.,  7.,  9., 17.,  0.,
   1485      $    0.,  4., 11., 13., 14., 12., 10.,  8., 13., 16.,  0.,
   1486      T    0.,  5., 14., 14., 14., 13., 10., 14., 14., 12.,  0.,
   1487      L    0., 15., 19., 13., 12., 22.,  4., 17., 10., 13.,  0./
   1488 
   1489 
   1490 C                                 CHINESE
   1491 C               =====>  JTYPE = 19  --   ITAB = 16  <=====
   1492 
   1493       DATA  TCHI /
   1494 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR

Page 36          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1495 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1496 C LEVEL
   1497      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1498      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1499      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1500      4    0., -2., -2., -1., -1.,  0.,  0.,  0.,  0.,  0.,  0.,
   1501      5    0.,  1., -1., -1.,  0., -4.,  0.,  0.,  0.,  0.,  0.,
   1502      A    0.,  0., -2., -2., -2., -3.,  0.,  0.,  0.,  0.,  0.,
   1503      6    0.,  0., -4., -5., -6., -3.,  0.,  0.,  0.,  0.,  0.,
   1504      B    0.,  0., -4., -4., -4., -3.,  0.,  0.,  0.,  0.,  0.,
   1505      7    0.,  1., -4., -3., -2., -4.,  0.,  0.,  0.,  0.,  0.,
   1506      C    0.,  0., -3., -1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1507      8    0.,  0., -2.,  0.,  1.,  4.,  6.,  0.,  0.,  0.,  0.,
   1508      D    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1509      9    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1510      $    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1511      T    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1512      L    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0./
   1513 
   1514 
   1515 C           USSR RKZ TECH MEMO TABLE FOR 00Z MORNING DAYLIGHT
   1516 C               =====>  JTYPE = 20  --   ITAB = 17  <=====
   1517 
   1518       DATA  TRK00Z /
   1519 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1520 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1521 C LEVEL
   1522      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1523      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1524      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1525      4    0., -2.,  1.,  0., -1., -3., -3., -3.,  0.,  0.,  0.,
   1526      5    0.,  0.,  0.,  0., -1., -1., -1., -3.,  0.,  0.,  0.,
   1527      A    0.,  0.,  0.,  1.,  0., -1.,  0., -2.,  0.,  0.,  0.,
   1528      6    0.,  0.,  0.,  2.,  1.,  0.,  1., -1.,  0.,  0.,  0.,
   1529      B    0.,  0.,  0.,  2.,  2.,  0.,  1., -1.,  0.,  0.,  0.,
   1530      7    0., -1.,  1.,  1.,  4.,  1.,  1., -1.,  0.,  0.,  0.,
   1531      C    0.,  0.,  2.,  2.,  3.,  1.,  1.,  0.,  0.,  0.,  0.,
   1532      8    0.,  0.,  3.,  3.,  2.,  1.,  0.,  2.,  0.,  0.,  0.,
   1533      D    0.,  0.,  3.,  4.,  2.,  1.,  0.,  2.,  0.,  0.,  0.,
   1534      9    0.,  1.,  4.,  5.,  2.,  1.,  1.,  1.,  0.,  0.,  0.,
   1535      $    0.,  1.,  7.,  6.,  3.,  1.,  0., -1., -2.,  0.,  0.,
   1536      T    0.,  2.,  9.,  9.,  6.,  3.,  1.,  3.,  2.,  0.,  0.,
   1537      L    0.,  5., 15., 17., 18., 16.,  5.,  1.,  9.,  0.,  0./
   1538 
   1539 
   1540 C        USSR RKZ TECH MEMO TABLE FOR 12Z AFTERNOON DAYLIGHT
   1541 C               =====>  JTYPE = 20  --   ITAB = 18  <=====
   1542 
   1543       DATA  TRK12Z /
   1544 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1545 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1546 C LEVEL
   1547      1    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1548      2    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1549      3    0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
   1550      4    0.,  1.,  2.,  3.,  3.,  3.,  3.,  1.,  1.,  0.,  0.,
   1551      5    0.,  0.,  2.,  3.,  3.,  3.,  3.,  2.,  1.,  0.,  0.,

Page 37          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1552      A    0.,  0.,  3.,  3.,  3.,  3.,  3.,  2.,  0.,  0.,  0.,
   1553      6    0.,  1.,  4.,  3.,  3.,  3.,  4.,  2.,  0.,  0.,  0.,
   1554      B    0.,  1.,  4.,  3.,  3.,  3.,  3.,  1.,  0.,  0.,  0.,
   1555      7    0.,  2.,  3.,  4.,  2.,  3.,  2.,  0.,  0.,  0.,  0.,
   1556      C    0.,  2.,  4.,  4.,  2.,  2.,  1.,  0.,  0.,  0.,  0.,
   1557      8    0.,  2.,  5.,  5.,  2.,  1.,  0.,  0.,  0.,  0.,  0.,
   1558      D    0.,  3.,  6.,  6.,  3.,  1.,  1.,  1.,  0.,  0.,  0.,
   1559      9    0.,  5.,  8.,  7.,  5.,  2.,  3.,  3.,  0.,  0.,  0.,
   1560      $    0.,  7., 10.,  9.,  7.,  4.,  2., -2.,  0.,  0.,  0.,
   1561      T    0.,  8., 11., 11.,  6.,  6.,  1., -1.,  0.,  0.,  0.,
   1562      L    0., 18., 28., 17.,  5.,  5.,  0.,  0.,  0.,  0.,  0./
   1563 
   1564 
   1565 C        USSR UNKNOWN (AVG. OF A-22 AND RKZ) FOR 00Z MORNING DAYLIGHT
   1566 C               =====>  JTYPE = 21  --   ITAB = 19  <=====
   1567 
   1568       DATA  TAV00Z /
   1569 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1570 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1571 C LEVEL
   1572      1   0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
   1573      2   0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
   1574      3   0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
   1575      4   0.0,-1.0, 1.0, 0.0,-1.0,-1.5,-2.0,-2.5, 0.0, 0.0, 0.0,
   1576      5   0.0,-0.5, 0.0, 0.0,-1.0,-0.5,-0.5,-2.5, 0.0, 0.0, 0.0,
   1577      A   0.0, 0.0, 0.0, 0.5, 0.0,-0.5, 0.5,-1.0, 0.0, 0.0, 0.0,
   1578      6   0.0, 0.0, 0.0, 1.0, 1.5, 0.5, 1.5, 0.0, 0.0, 0.0, 0.0,
   1579      B   0.0, 0.0, 0.5, 1.0, 2.0, 0.5, 1.0,-0.5, 0.0, 0.0, 0.0,
   1580      7   0.0,-0.5, 1.5, 1.0, 3.0, 1.5, 0.0,-1.5, 0.0, 0.0, 0.0,
   1581      C   0.0, 0.0, 2.0, 1.5, 2.5, 2.0, 0.5, 0.0, 0.0, 0.0, 0.0,
   1582      8   0.0, 0.0, 2.5, 2.5, 2.5, 3.0, 0.5, 2.5, 0.0, 0.0, 0.0,
   1583      D   0.0, 0.0, 2.5, 3.5, 3.0, 3.5, 1.5, 2.5, 0.0, 0.0, 0.0,
   1584      9   0.0, 0.0, 3.5, 5.0, 3.5, 4.5, 3.0, 2.0, 0.0, 0.0, 0.0,
   1585      $   0.0,-0.5, 5.5, 6.0, 4.0, 4.0, 3.0, 1.5, 0.5, 0.0, 0.0,
   1586      T   0.0, 0.5, 7.5, 9.0, 7.5, 7.0, 6.5, 6.0,-2.0, 0.0, 0.0,
   1587      L   0.0, 3.0,12.0,18.0,23.0,10.5,14.0,12.5, 4.5, 0.0, 0.0/
   1588 
   1589 
   1590 C      USSR UNKNOWN (AVG. OF A-22 AND RKZ) FOR 12Z AFTERNOON DAYLIGHT
   1591 C               =====>  JTYPE = 21  --   ITAB = 20  <=====
   1592 
   1593       DATA  TAV12Z /
   1594 C         N   -5    5   15   25   35   45   55   65   75   85  --> SOLAR
   1595 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___     ANGLE
   1596 C LEVEL
   1597      1   0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
   1598      2   0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
   1599      3   0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
   1600      4   0.0, 1.0, 2.5, 3.0, 4.0, 2.5, 2.5, 1.0, 1.0, 0.0, 0.0,
   1601      5   0.0, 1.0, 2.0, 3.0, 3.0, 2.5, 2.5, 2.5, 0.5, 0.0, 0.0,
   1602      A   0.0, 1.0, 2.5, 3.0, 2.5, 3.0, 3.0, 2.5, 1.0, 0.0, 0.0,
   1603      6   0.0, 1.0, 3.5, 2.5, 2.0, 3.5, 4.0, 2.0, 2.0, 0.0, 0.0,
   1604      B   0.0, 1.0, 3.5, 2.5, 2.5, 3.0, 2.5, 0.5, 1.0, 0.0, 0.0,
   1605      7   0.0, 1.5, 3.0, 3.0, 2.5, 2.0, 1.0,-1.0, 0.0, 0.0, 0.0,
   1606      C   0.0, 1.5, 4.0, 3.5, 3.0, 2.5, 1.0,-0.5, 0.0, 0.0, 0.0,
   1607      8   0.0, 2.0, 5.0, 4.5, 3.5, 3.0, 1.5, 0.0, 0.0, 0.0, 0.0,
   1608      D   0.0, 2.5, 5.5, 5.5, 4.5, 4.0, 2.5, 1.5, 0.0, 0.0, 0.0,

Page 38          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1609      9   0.0, 4.0, 7.0, 7.0, 6.0, 5.5, 4.5, 3.5, 0.0, 0.0, 0.0,
   1610      $   0.0, 4.5, 6.5, 8.5, 8.0, 6.5, 3.5, 3.0, 0.0, 0.0, 0.0,
   1611      T   0.0, 5.5, 8.0,10.5, 3.5, 9.0, 5.5, 0.5, 0.0, 0.0, 0.0,
   1612      L   0.0, 8.0,15.0,21.0, 4.0,11.5, 1.0, 0.0, 0.0, 0.0, 0.0/
   1613 
   1614 
   1615 C    NOAA / SPACE DATA CORP. 1989, TABLE FOR 00Z AFTERNOON DAYLIGHT
   1616 C      (TECH MEMO TABLE FOR NOAA / VIZ-A 1988 WITH A BIAS APPLIED)
   1617 C               =====>  JTYPE = 29  --   ITAB = 21  <=====
   1618 
   1619       DATA  TSD00Z /
   1620 C         N   -5    5   15   25   35   45   55   65   75   85 --> SOLAR
   1621 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___    ANGLE
   1622 C LEVEL
   1623      1  -2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,
   1624      2  -2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,
   1625      3  -2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,
   1626      4  -1.7, 0.3, 1.3, 3.3, 4.3, 4.3, 1.3, 2.3, 3.3, 3.3, 2.3,
   1627      5   0.9, 2.9, 3.9, 4.9, 5.9, 5.9, 4.9, 4.9, 5.9, 5.9, 6.9,
   1628      A   4.2, 6.2, 7.2, 9.2, 9.2, 9.2, 8.2, 8.2, 9.2, 9.2,10.2,
   1629      6   4.2, 6.2, 8.2,10.2,10.2,10.2, 9.2, 9.2, 9.2, 9.2,10.2,
   1630      B   4.2, 6.2, 8.2,10.2,10.2,10.2, 9.2,10.2,10.2,10.2,11.2,
   1631      7   6.3, 7.3,11.3,12.3,13.3,13.3,12.3,13.3,13.3,13.3,14.3,
   1632      C   6.9, 7.9,12.9,13.9,14.9,14.9,14.9,14.9,14.9,15.9,15.9,
   1633      8   6.6, 8.6,13.6,15.6,16.6,16.6,16.6,16.6,16.6,18.6,16.6,
   1634      D   7.0,10.0,16.0,18.0,19.0,19.0,18.0,17.0,18.0,18.0,17.0,
   1635      9   7.4,12.4,18.4,20.4,21.4,21.4,19.4,18.4,20.4,17.4,16.4,
   1636      $   8.1,17.1,24.1,26.1,29.1,27.1,22.1,22.1,18.1,24.1,20.1,
   1637      T   8.6,20.6,27.6,31.6,34.6,32.6,26.6,23.6,21.6,21.6,30.6,
   1638      L   7.9,26.9,31.9,36.9,39.9,33.9,35.9,30.9,32.9,18.9,39.9/
   1639 
   1640 
   1641 C     NOAA / SPACE DATA CORP. 1989, TABLE FOR 12Z MORNING DAYLIGHT
   1642 C      (TECH MEMO TABLE FOR NOAA / VIZ-A 1988 WITH A BIAS APPLIED)
   1643 C               =====>  JTYPE = 29  --   ITAB = 22  <=====
   1644 
   1645       DATA  TSD12Z /
   1646 C         N   -5    5   15   25   35   45   55   65   75   85 --> SOLAR
   1647 C        ___  ___  ___  ___  ___  ___  ___  ___  ___  ___  ___    ANGLE
   1648 C LEVEL
   1649      1  -2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,-2.7,
   1650      2  -2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,
   1651      3  -2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,-2.3,
   1652      4  -1.7,-3.7,-2.0, 0.3, 2.3, 3.3, 2.3, 6.3, 7.3,-1.7,-1.7,
   1653      5   0.9,-1.1,-0.1, 2.9, 4.9, 4.9, 5.9,10.9, 9.9, 0.9, 0.9,
   1654      A   4.2, 2.2, 3.2, 6.2, 7.2, 8.2,10.2,15.2,14.2, 4.2, 4.2,
   1655      6   4.2, 2.2, 4.2, 6.2, 6.2, 8.2,11.2,16.2,15.2, 4.2, 4.2,
   1656      B   4.2, 3.2, 5.2, 7.2, 7.2,10.2,15.2,15.2,14.2, 4.2, 4.2,
   1657      7   6.3, 6.3, 8.3,11.3,10.3,14.3,21.3,16.3,15.3, 6.3, 6.3,
   1658      C   6.9, 6.9, 9.9,12.9,11.9,14.9,20.9,19.9,15.9, 6.9, 6.9,
   1659      8   6.6, 7.6,11.6,13.6,13.6,14.6,18.6,22.6,16.6, 6.6, 6.6,
   1660      D   7.0, 8.0,12.0,14.0,15.0,16.0,20.0,20.0,19.0, 7.0, 7.0,
   1661      9   7.4, 7.4,12.4,14.4,16.4,18.4,21.4,17.4,22.4, 7.4, 7.4,
   1662      $   8.1, 7.1,14.1,18.1,19.1,22.1,21.1,30.1, 4.1, 8.1, 8.1,
   1663      T   8.6, 6.6,16.6,19.6,19.6,23.6,20.6,21.6, 8.6, 8.6, 8.6,
   1664      L   7.9, 7.9,20.9,20.9,18.9,20.9,26.9,42.9, 7.9, 7.9, 7.9/
   1665 

Page 39          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1666 C-----------------------------------------------------------------------
   1667 C-----------------------------------------------------------------------
   1668 
   1669       IRET = 0
   1670 
   1671 C  EACH TIME THROUGH, COMPUTE LOGS OF PRESSURE RATIOS AND ASSIGN
   1672 C  TO LEVELS 2 THROUGH 16 -- IF R. TYPE IS NOT 29 (S.D.C. - 1989), SET
   1673 C  VALUES ON 925, 850 & 700 MB TO 0. TO KEEP CONSISTENT W/ PRIOR VERSION
   1674 C  WHICH APPLIES NO HEIGHT CORRECTION AT 700 MB (NOTE: THIS MAY BE
   1675 C  CHANGED -- WHY SHOULDN'T 700 MB HAVE A HEIGHT CORRECTION?)
   1676 C  ---------------------------------------------------------------------
   1677 
   1678       ALP(1) = 0.0
   1679       DO I=2,16
   1680          ALP(I) = ALOG(PRES(I-1)/PRES(I))
   1681       ENDDO
   1682       IF(JTYPE.NE.29)  THEN
   1683          ALP(2) = 0.0
   1684          ALP(3) = 0.0
   1685          ALP(4) = 0.0
   1686       ENDIF
   1687 
   1688 C  GET TABLE INDEX FROM RADIOSONDE TYPE - CHECK FOR PM CORRECTIONS
   1689 C  ---------------------------------------------------------------
   1690 
   1691       ITAB = 0
   1692       IF(JTYPE.GT.0 .AND. JTYPE.LT.256) ITAB = ITYPTB(JTYPE)
   1693 
   1694       OBSTM = IDATE(5) + DHR(IS)
   1695 
   1696       IF(OBSTM.GE.9. AND. OBSTM.LT.18) THEN
   1697          IF(ITAB.EQ.1 ) ITAB = ITAB+1
   1698          IF(ITAB.EQ.10) ITAB = ITAB+1
   1699          IF(ITAB.EQ.17) ITAB = ITAB+1
   1700          IF(ITAB.EQ.19) ITAB = ITAB+1
   1701          IF(ITAB.EQ.21) ITAB = ITAB+1
   1702       ENDIF
   1703 
   1704 C  CHECK FOR VALID CORRECTION PARAMETERS
   1705 C  -------------------------------------
   1706 
   1707       NOSWC = JTYPE.LT.1 .OR. JTYPE.GT.29
   1708       IF(NOSWC .AND. JTYPE.NE.99 .and. jtype.ne.20000)  THEN
   1709          WRITE(6,1)  SID(IS),JTYPE
   1710          WRITE(68,1) SID(IS),JTYPE
   1711       END IF
   1712 1     FORMAT(/5X,'* * *  STN. ID ',A8,' HAS AN INVALID RAOB TYPE ',
   1713      . 'DESIGNATION (BUFR/ON 29 CODE ',I8,') - NO CORRECTION POSSIBLE')
   1714 
   1715       NOSWC = NOSWC .OR. ITAB.LE.0
   1716       SWC   = .NOT.NOSWC
   1717 
   1718       IF(LWCORR.LE.1 .AND. NOSWC) THEN
   1719          IRET = -1
   1720          if(jtype.eq.20000)  iret = -99
   1721          RETURN
   1722       ENDIF

Page 40          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1723 
   1724 C  GET SOLAR ELEVATION ANGLE ON ALL VALID MANDATORY LEVELS
   1725 C  -------------------------------------------------------
   1726 
   1727       CALL SOELAN(SOLAR)
   1728 
   1729 C  APPLY SHORT- (& POSS. LONG-) WAVE TEMPERATURE AND HEIGHT CORRECTIONS
   1730 C  --------------------------------------------------------------------
   1731 
   1732       DO ILEV=1,16
   1733          ANGLE(2)  = CUTOFF(ILEV)
   1734          DTS(ILEV) = 0
   1735          DHS(ILEV) = 0
   1736          DTL       = 0
   1737          DHL       = 0
   1738 
   1739          IF(SWC)  THEN
   1740             IF(SOLAR(ILEV).GE.CUTOFF(ILEV))  THEN
   1741                IF(SOLAR(ILEV).LT.ANGLE(11)) THEN
   1742                   DO K=3,11
   1743                      IF(SOLAR(ILEV).LT.ANGLE(K)) THEN
   1744                         TABU = TTAB(K  ,ILEV,ITAB)
   1745                         TABD = TTAB(K-1,ILEV,ITAB)
   1746                         DSUN = (SOLAR(ILEV) - ANGLE(K-1))/
   1747      .                   (ANGLE(K) - ANGLE(K-1))
   1748                         DTS(ILEV) = TABD + DSUN*(TABU-TABD)
   1749                         GO TO 10
   1750                      ENDIF
   1751                   ENDDO
   1752                ELSE
   1753                   DTS(ILEV) = TTAB(11,ILEV,ITAB)
   1754                ENDIF
   1755             ELSE
   1756 
   1757 C  IF ANGLE < CUTOFF (NIGHT), TEMP CORRECTION FROM 'NIGHT' VALUE IN TBL
   1758 C  --------------------------------------------------------------------
   1759 
   1760                DTS(ILEV) = TTAB(1,ILEV,ITAB)
   1761             ENDIF
   1762 
   1763 C  COMPUTE SHORT-WAVE HEIGHT CORRECTIONS, VIA HYDROSTATIC INTERPOLATION
   1764 C  --------------------------------------------------------------------
   1765 
   1766 10          HYF = 1.46*ALP(ILEV)
   1767             IF(ILEV.EQ.1) THEN
   1768                DHS(ILEV) = HYF*DTS(ILEV)
   1769             ELSE
   1770                DHS(ILEV) = DHS(ILEV-1) + HYF*(10.*DTS(ILEV-1)+DTS(ILEV))
   1771             ENDIF
   1772 
   1773          ENDIF
   1774 
   1775 C  CORRECT DTS BY A FACTOR OF 10
   1776 C  -----------------------------
   1777 
   1778          DTS(ILEV) = .1*DTS(ILEV)
   1779          IF(ILEV.EQ.16 .AND. LWCORR.GT.0 .AND. TMP(16).LT.BMISS) THEN

Page 41          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1780 
   1781 C  FOR LWCORR .GT. 0, COMPUTE L-W TEMP & HGHT CORRECTIONS (ONLY AT 10MB)
   1782 C  ---------------------------------------------------------------------
   1783 
   1784             DTL = .0625*(TMP(ILEV)-DTS(ILEV)) + 5.09
   1785             DHL =  (TMP(ILEV)-DTS(ILEV)) + 81.4
   1786          ENDIF
   1787 
   1788 C  SAVE AND APPLY THE CORRECTIONS
   1789 C  ------------------------------
   1790 
   1791          DHT(ILEV) = DHL-DHS(ILEV)
   1792          DTP(ILEV) = DTL-DTS(ILEV)
   1793 
   1794          IF(HGT(ILEV).LT.BMISS) HGT(ILEV) = HGT(ILEV) + DHT(ILEV)
   1795          IF(TMP(ILEV).LT.BMISS) TMP(ILEV) = TMP(ILEV) + DTP(ILEV)
   1796 
   1797       ENDDO
   1798 
   1799       RETURN
   1800       END


ENTRY POINTS

  Name              
                    
 radt2_             

Page 42          Source Listing                  RADT2
2017-04-18 11:07 Symbol Table                    radcor.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  1712                                                           1709,1710                         
 10                         Label  1766                                                           1749                              
 ALOG                       Func   1680                                 scalar                    1680                              
 ALP                        Local  1068     R(4)            4     1     16                        1678,1680,1683,1684,1685,1766     
 ANGLE                      Local  1067     R(4)            4     1     11                        1085,1733,1741,1743,1746,1747     
 BAL_DRIFT                  Scalar 1055     R(4)            4           scalar   COM                                                
 BMISS                      Scalar 1049     R(8)            8           scalar   COM              1779,1794,1795                    
 BUFRLIB_MISSING            Common 1059                                 16                                                          
 CDATE                      Scalar 1058     CHAR            10          scalar   COM                                                
 CUTOFF                     Local  1067     R(4)            4     1     16                        1086,1733,1740                    
 DATEX                      Common 1058                                 30                                                          
 DHL                        Local  1737     R(4)            4           scalar                    1737,1785,1791                    
 DHR                        Scalar 1051     R(4)            4     1     999      COM              1694                              
 DHS                        Local  1068     R(4)            4     1     16                        1735,1768,1770,1791               
 DHT                        Scalar 1054     R(4)            4     1     16       COM              1791,1794                         
 DSUN                       Local  1746     R(4)            4           scalar                    1746,1748                         
 DTL                        Local  1736     R(4)            4           scalar                    1736,1784,1792                    
 DTP                        Scalar 1054     R(4)            4     1     16       COM              1792,1795                         
 DTS                        Local  1068     R(4)            4     1     16                        1734,1748,1753,1760,1768,1770,1778
                                                                                                  ,1784,1785,1792                   
 ELV                        Scalar 1052     R(4)            4     1     999      COM                                                
 HEADER                     Common 1051                                 35980                                                       
 HGT                        Scalar 1054     R(4)            4     1     16       COM              1794                              
 HGTTBL                     Scalar 1055     L(4)            4           scalar   COM                                                
 HYF                        Local  1766     R(4)            4           scalar                    1766,1768,1770                    
 I                          Local  1679     I(4)            4           scalar                    1679,1680                         
 IDATE                      Scalar 1058     I(4)            4     1     5        COM              1694                              
 ILEV                       Local  1732     I(4)            4           scalar                    1732,1733,1734,1735,1740,1741,1743
                                                                                                  ,1744,1745,1746,1748,1753,1760,176
                                                                                                  6,1767,1768,1770,1778,1779,1784,17
                                                                                                  85,1791,1792,1794,1795            
 IMISS                      Scalar 1059     I(4)            4           scalar   COM                                                
 INM                        Scalar 1056     I(4)            4     1     16       COM                                                
 IRCTBL                     Scalar 1055     I(4)            4           scalar   COM                                                
 IRET                       Dummy  1046     I(4)            4           scalar   ARG,INOUT        1669,1719,1720                    
 IS                         Scalar 1057     I(4)            4           scalar   COM              1694,1709,1710                    
 ISF                        Scalar 1053     I(4)            4     1     999      COM                                                
 ITAB                       Local  1691     I(4)            4           scalar                    1691,1692,1697,1698,1699,1700,1701
                                                                                                  ,1715,1744,1745,1753,1760         
 ITP                        Scalar 1052     I(4)            4     1     999      COM                                                
 ITYPTB                     Local  1069     I(4)            4     1     255                       1094,1692                         
 JTYPE                      Scalar 1054     I(4)            4           scalar   COM              1682,1692,1707,1708,1709,1710,1720
 K                          Local  1742     I(4)            4           scalar                    1742,1743,1744,1745,1746,1747     
 KMAX                       Scalar 1056     I(4)            4           scalar   COM                                                
 KMIN                       Scalar 1056     I(4)            4           scalar   COM                                                
 LEVRAD                     Scalar 1055     I(4)            4           scalar   COM                                                
 LWCORR                     Scalar 1055     I(4)            4           scalar   COM              1718,1779                         
 NEV                        Scalar 1053     I(4)            4           scalar   COM                                                
 NLV                        Scalar 1052     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 1053     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 1053     I(4)            4           scalar   COM                                                

Page 43          Source Listing                  RADT2
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NOSWC                      Dummy  1046     L(4)            4           scalar   ARG,INOUT        1707,1708,1715,1716,1718          
 NST                        Param  1047     I(4)            4           scalar                    1051,1052,1053                    
 OBSTM                      Local  1694     R(4)            4           scalar                    1694,1696                         
 PMAND                      Common 1056                                 136                                                         
 PRES                       Scalar 1056     R(4)            4     1     16       COM              1680                              
 RADCOM                     Common 1054                                 260                                                         
 RADT2                      Subr   1046                                                                                             
 SID                        Scalar 1051     CHAR            8     1     999      COM              1709,1710                         
 SOELAN                     Subr   1727                                                           1727                              
 SOLAR                      Local  1067     R(4)            4     1     16                        1727,1740,1741,1743,1746          
 SQN                        Scalar 1052     R(4)            4     1     999      COM                                                
 STN                        Common 1057                                 4                                                           
 SWC                        Local  1083     L(4)            4           scalar                    1716,1739                         
 SWITCH                     Common 1055                                 20                                                          
 T1J00Z                     Local  1061     R(4)            4     2     176      SAVE             1114                              
 T1J12Z                     Local  1061     R(4)            4     2     176      SAVE             1142                              
 T2200Z                     Local  1061     R(4)            4     2     176      SAVE             1343                              
 T2212Z                     Local  1062     R(4)            4     2     176      SAVE             1368                              
 T3L                        Local  1063     R(4)            4     2     176      SAVE             1167                              
 T4M                        Local  1063     R(4)            4     2     176      SAVE             1192                              
 T5N                        Local  1064     R(4)            4     2     176      SAVE             1217                              
 T7P                        Local  1064     R(4)            4     2     176      SAVE             1242                              
 T9R                        Local  1064     R(4)            4     2     176      SAVE             1267                              
 TABD                       Local  1745     R(4)            4           scalar                    1745,1748                         
 TABU                       Local  1744     R(4)            4           scalar                    1744,1748                         
 TASLSH                     Local  1064     R(4)            4     2     176      SAVE             1293                              
 TAUS                       Local  1065     R(4)            4     2     176      SAVE             1443                              
 TAV00Z                     Local  1063     R(4)            4     2     176      SAVE             1568                              
 TAV12Z                     Local  1063     R(4)            4     2     176      SAVE             1593                              
 TBS                        Local  1065     R(4)            4     2     176      SAVE             1318                              
 TCHI                       Local  1066     R(4)            4     2     176      SAVE             1493                              
 TCSG                       Local  1066     R(4)            4     2     176      SAVE             1468                              
 TFMR2                      Local  1065     R(4)            4     2     176      SAVE             1418                              
 TMP                        Scalar 1054     R(4)            4     1     16       COM              1779,1784,1785,1795               
 TRK00Z                     Local  1062     R(4)            4     2     176      SAVE             1518                              
 TRK12Z                     Local  1062     R(4)            4     2     176      SAVE             1543                              
 TSD00Z                     Local  1066     R(4)            4     2     176      SAVE             1619                              
 TSD12Z                     Local  1066     R(4)            4     2     176      SAVE             1645                              
 TTAB                       Local  1067     R(4)            4     3     3872                      1744,1745,1753,1760               
 TVSL2                      Local  1065     R(4)            4     2     176      SAVE             1393                              
 XMISS                      Scalar 1059     R(4)            4           scalar   COM                                                
 XOB                        Scalar 1051     R(4)            4     1     999      COM                                                
 YOB                        Scalar 1051     R(4)            4     1     999      COM                                                

Page 44          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1801 
   1802 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1803 C
   1804 C SUBPROGRAM:    RADT3       APPLIES NEWEST SET OF RADIATION CORRECTNS
   1805 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2007-09-14
   1806 C
   1807 C ABSTRACT: THIS SUBROUTINE APPLIES RADIATION CORRECTIONS TO THE
   1808 C   OBSERVED RADIOSONDE HEIGHTS AND TEMPERATURES ON THE BOTTOM 16
   1809 C   MANDATORY PRESSURE LEVELS.  DATA ARE PASSED THROUGH COMMON
   1810 C   /RADCOM/.  THE CORRECTION OF RAOBS FOR BOTH SHORT- AND LONG-WAVE
   1811 C   EFFECTS IN ACCOMPLISHED BY READING IN TABLES OF NUMBERS WHICH ARE
   1812 C   DEPENDENT ON THE RADIOSONDE TYPE. CALLED FOR ONE REPORT AT A TIME.
   1813 C
   1814 C PROGRAM HISTORY LOG:
   1815 C 1990-06-20  P. R. JULIAN(W/NMC00) -- ORIGINAL AUTHOR
   1816 C 1990-12-12  D. A. KEYSER -- FURTHER REFINEMENTS
   1817 C 1992-03-18  D. A. KEYSER -- ADDED CORRECTIONS AT 925 MB TO TABLES;
   1818 C     AIR IS-4A-1680 & AIR IS-4A-1680X SONDES RECEIVE VIZ CORRECTIONS
   1819 C     (BEFORE THEY WERE NOT CORRECTED)
   1820 C 1993-05-26  D. A. KEYSER -- ADDED RADIOSONDE TYPE 47 FOR JAPAN-MEISEI
   1821 C     RS2-91, RECEIVES SAME CORRECTIONS AS MEISEI RS2-80 (I. TYPE 22)
   1822 C 1993-09-01  D. A. KEYSER -- AFTER 00Z 10/1/93 GRAVITATION CONSTANT
   1823 C     IN MICROARTS CORRECTED, VIZ & SDC SONDES NOW CORRECT GEOPOTENT.
   1824 C     VIA HYDRO. INTEGR. (LIKE ALL OTHER SONDES) RATHER THAN FROM
   1825 C     SPECIAL CORRECTION TABLES
   1826 C 1994-02-27  J. WOOLLEN   -- CONVERTED FOR USE WITH BUFR
   1827 C 1994-09-20  D. A. KEYSER -- ADDED NEW CORRECTION TABLE TO CORRECT
   1828 C     FOR VAISALA INSTRUMENT AT U.S. SITES (THIS TABLE SLIGHTLY
   1829 C     DIFFERENT THAT FOR VAISALA INSTRUMENT AT NON-U.S. SITES SINCE
   1830 C     A DIFFERENT ON-SITE CORRECTION IS APPLIED)
   1831 C 1995-11-07  D. A. KEYSER -- UPDATED THE LIST OF U.S. SITES THAT  
   1832 C     ARE TO USE THE NEW U.S. VAISALA CORRECTION TABLE IF AND WHEN 
   1833 C     THEY SWITCH TO THE VAISALA INSTRUMENT
   1834 C 1997-05-13  D. A. KEYSER -- ADDED NEW RADIOSONDE TYPES CORRESPONDING
   1835 C     TO CODE FIGURES 48-52 AND 64,65 (TYPE 52 GETS A CORRECTION)
   1836 C 1997-05-29  D. A. KEYSER -- RADIOSONDE TYPE 51 (U.S. VIZ B2 SONDE)
   1837 C     NOW GETS SAME CORRECTIONS AS TYPE 11 (VIZ B SONDE), BEFORE TYPE
   1838 C     51 WAS NOT CORRECTED.
   1839 C 1998-06-24  D. A. KEYSER -- RADIOSONDE TYPES 37, 52, 61-63 (ALL
   1840 C     VAISALA RS80) ARE NO LONGER CORRECTED (BOTH IN AND OUT OF U.S.),
   1841 C     RADIOSONDE TYPE 60 (VASIALA RS80/MICROCORA) IS STILL CORRECTED
   1842 C     AS BEFORE (BOTH IN AND OUT OF U.S.)
   1843 C 2002-07-22  D. A. KEYSER -- CALLS NEW ROUTINE SOELAN TO CALCULATE SUN
   1844 C     ANGLE ON VALID MANDATORY LEVELS RATHER THAN DOING CALCULATION IN
   1845 C     THIS SUBROUTINE
   1846 C 2007-09-14  D. KEYSER    -- MINOR CODE CORRECTIONS SUGGESTED BY PAT
   1847 C     PAULEY (CORRECTS PROBLEMS THAT COULD OCCUR ON SOME REMOTE
   1848 C     MACHINES)
   1849 C
   1850 C USAGE:    CALL RADT3(IRET)
   1851 C   OUTPUT ARGUMENT LIST:
   1852 C     IRET     - RETURN CODE (0=CORRECTIONS, -1=NO CORRECTIONS,
   1853 C              - -99=??????)
   1854 C
   1855 C   OUTPUT FILES:
   1856 C     UNIT 06  - PRINTOUT
   1857 C     UNIT 68  - RADCOR INFORMATION FILE

Page 45          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1858 C
   1859 C REMARKS: THESE CORRECTIONS USE THE BUFR CODE FIGURE FOR RADIOSONDE
   1860 C   TYPE OBTAINED FROM BUFR-FM94 TABLE 0 02 011.  THE NMC UPPER-AIR
   1861 C   DICTIONARY ALSO CONTAINS THIS BUFR CODE FIGURE FOR RADIOSONDE
   1862 C   TYPE.  CALLED BY SUBROUTINE "RADEVN".
   1863 C
   1864 C
   1865 C   KEY FOR RADIOSONDE TYPES USED HERE:
   1866 C
   1867 C  JTYPE                   DESCRIPTION                     TABLE NUMBER
   1868 C
   1869 C  < 0                     INVALID
   1870 C  0 TO 6                  NOT USED FOR SONDES
   1871 C  7 TO 8                  RESERVED
   1872 C    9                     UNKNOWN TYPE
   1873 C   10                     (U.S.) NOAA / VIZ TYPE  A          3(T),1(G)@
   1874 C   11                     (U.S.) NOAA / VIZ TYPE  B          3(T),1(G)@
   1875 C   12                     (U.S.) NOAA / SPACE DATA CORP.     4(T),2(G)@
   1876 C   13   ==> NOT IN USE    (AUSTRALIA) ASTOR
   1877 C   14                     (U.S.) VIZ MARK I MICROSONDE
   1878 C   15                     (U.S.) EEC COMPANY TYPE  23
   1879 C   16                     (AUSTRIA) ELIN
   1880 C   17                     (GERMANY) GRAW  G
   1881 C   18                     RESERVED
   1882 C   19   ==> ONLY 1 SITE   (GERMANY) GRAW  M60                6(T)
   1883 C   20                     INDIAN MET. SERVICE TYPE  MK3
   1884 C   21                     (S. KOREA) VIZ/JIN YANG MARK I MICROSONDE
   1885 C   22                     (JAPAN) MEISEI  RS2-80             1(T)
   1886 C   23                     (FRANCE) MENSURAL FMO  1950A
   1887 C   24                     (FRANCE) MENSURAL FMO  1945A
   1888 C   25                     (FRANCE) MENSURAL  MH73A
   1889 C   26                     (SWITZERLAND) METEOLABOR BASORA
   1890 C   27                     (RUSSIA) AVK-MRZ                   7(T)
   1891 C   28                     (RUSSIA) METEORIT  MARZ2-1         8(T)
   1892 C   29                     (RUSSIA) METEORIT  MARZ2-2         8(T)
   1893 C   30                     (JAPAN) OKI  RS2-80
   1894 C   31                     (CANADA) VIZ/VALCOM TYPE A         2(T)
   1895 C   32                     (CHINA) SHANGHAI RADIO            10(T)
   1896 C   33   ==> NOT IN USE    (U.K.) UK MET OFFICE  MK3          9(T)
   1897 C   34                     (CZECHOSLOVAKIA) VINOHRADY
   1898 C   35                     VAISALA  RS18
   1899 C   36                     VAISALA  RS21
   1900 C   37                     VAISALA  RS80
   1901 C   38                     (U.S.) VIZ LOCATE (LORAN-C)
   1902 C   39                     (GERMANY) SPRENGER  E076
   1903 C   40                     (GERMANY) SPRENGER  E084
   1904 C   41                     (GERMANY) SPRENGER  E085
   1905 C   42                     (GERMANY) SPRENGER  E086
   1906 C   43                     (U.S.) AIR IS - 4A - 1680          3(T)
   1907 C   44                     (U.S.) AIR IS - 4A - 1680 X        3(T)
   1908 C   45                     (U.S.) RS MSS                      4(T)
   1909 C   46                     (U.S.) AIR IS - 4A - 403
   1910 C   47                     (JAPAN) MEISEI  RS2-91             1(T)
   1911 C   48                     (CANADA) VALCOM
   1912 C   49                     (U.S.) VIZ MARK II
   1913 C   50                     (GERMANY) GRAW DFM-90
   1914 C   51                     (U.S.) NOAA / VIZ TYPE  B2         3(T),1(G)@

Page 46          Source Listing                  RADT2
2017-04-18 11:07                                 radcor.f

   1915 C   52                     VAISALA  RS80/MICROARTS
   1916 C 53 TO 59                 RESERVED FOR ADDITIONAL SONDES
   1917 C   60                     VAISALA  RS80/MICROCORA            5 OR 11(T)
   1918 C   61                     VAISALA  RS80/DIGICORA  OR MARWIN
   1919 C   62                     VAISALA  RS80/PCCORA
   1920 C   63                     VAISALA  RS80/STAR
   1921 C   64                     (U.S.) ORBITAL SCI. CORP TYPE 909-11-xx      
   1922 C   65                     (U.S.) VIZ/TRANSPONDER TYPE 1499-520
   1923 C 66 TO 89                 RESERVED FOR ADDITIONAL AUTOMATED SYSTEMS
   1924 C   90                     UNKNOWN TYPE
   1925 C   91                     PRESSURE ONLY
   1926 C   92                     PRESSURE ONLY PLUS TRANSPONDER
   1927 C   93                     PRESSURE ONLY PLUS RADAR REFLECTOR
   1928 C   94                     NO PRESSURE PLUS TRANSPONDER
   1929 C   95                     NO PRESSURE PLUS RADAR REFLECTOR
   1930 C   96                     DESCENDING
   1931 C 97 TO 254                RESERVED
   1932 C  255                     MISSING VALUE
   1933 C >255                     INVALID
   1934 C
   1935 C  @ - VALID ONLY PRIOR TO 00Z 02/01/92
   1936 C
   1937 C
   1938 C   KEY FOR LEVELS IN DATA (CORRECTION) TABLES:
   1939 C
   1940 C     1 - 1000 MB
   1941 C     2 -- 925 MB
   1942 C     3 -- 850 MB        T --  20 MB
   1943 C     4 -- 700 MB        L --  10 MB
   1944 C     5 -- 500 MB        A -- 400 MB (INTERP. BETWEEN 500 & 300 MB)
   1945 C     6 -- 300 MB        B -- 250 MB (INTERP. BETWEEN 300 & 200 MB)
   1946 C     7 -- 200 MB        C -- 150 MB (INTERP. BETWEEN 200 & 100 MB)
   1947 C     8 -- 100 MB        D --  70 MB (INTERP. BETWEEN 100 &  50 MB)
   1948 C     9 --  50 MB        E --  30 MB (INTERP. BETWEEN  50 &  10 MB)
   1949 C     $ --  30 MB        F --  20 MB (INTERP. BETWEEN  50 &  10 MB)
   1950 C
   1951 C
   1952 C   THE RADIATION CORRECTION TABLES ARE BASED UPON DATA FROM TESTS BY
   1953 C   F. SCHMIDLIN AND FROM OBSERVED INCREMENTS FROM NWP ASSIMILATION.
   1954 C   REFER TO NMC OFFICE NOTE 374 BY P. JULIAN, ET. AL.
   1955 C
   1956 C
   1957 C   THE CUTOFF ANGLE AT EACH LEVEL CALCULATED USING THE RELATION:
   1958 C              CUTOFF ANGLE = -1.76459 * (Z**.40795) ,
   1959 C   WHERE Z IS A REFERENCE HEIGHT FOR THE LEVEL (IN KILOMETERS)
   1960 C   (SEE NMC OFFICE NOTE 306, TABLE 4 FOR LIST OF REFERENCE HEIGHTS.)
   1961 C
   1962 C
   1963 C ATTRIBUTES:
   1964 C   LANGUAGE: FORTRAN 90
   1965 C   MACHINE:  NCEP WCOSS
   1966 C
   1967 C$$$
   1968       SUBROUTINE RADT3(IRET)
   1969       PARAMETER (NST=999)
   1970 
   1971       REAL(8) BMISS

Page 47          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   1972 
   1973       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   1974      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   1975      &                 NEV, ISF(NST), NLVM, NLVW
   1976       COMMON /RADCOM/ HGT(16),TMP(16),DHT(16),DTP(16),JTYPE
   1977       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
   1978       COMMON /PMAND / PRES(16),KMIN,KMAX,INM(16)
   1979       COMMON /STN/     IS
   1980       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   1981 
   1982       REAL        TTAB(10,16,12),ZTAB(10,16,2),CUTOFF(16),
   1983      .            SOLAR(16),ANGLE(10),ALP(16),DTS(16),DHS(16),
   1984      .            JAPANT(10,16),CANADT(10,16),USVZAT(10,16),
   1985      .            VRS80T(10,16),GRM60T(10,16),A22IVT(10,16),
   1986      .            UKMK3T(10,16),SHANGT(10,16),USVZAG(10,16),
   1987      .            USSDCT(10,16),MARZ2T(10,16),USSDCG(10,16),
   1988      .            VRS80U(10,16),USMK2T(10,16)
   1989       INTEGER     ITYPTT(255),ITYPTG(255)
   1990       EQUIVALENCE (TTAB(1,1, 1),JAPANT(1,1)),(TTAB(1,1, 2),CANADT(1,1)),
   1991      .            (TTAB(1,1, 3),USVZAT(1,1)),(TTAB(1,1, 4),USSDCT(1,1)),
   1992      .            (TTAB(1,1, 5),VRS80T(1,1)),(TTAB(1,1, 6),GRM60T(1,1)),
   1993      .            (TTAB(1,1, 7),A22IVT(1,1)),(TTAB(1,1, 8),MARZ2T(1,1)),
   1994      .            (TTAB(1,1, 9),UKMK3T(1,1)),(TTAB(1,1,10),SHANGT(1,1)),
   1995      .            (TTAB(1,1,11),VRS80U(1,1)),(TTAB(1,1,12),USMK2T(1,1)),
   1996      .            (ZTAB(1,1, 1),USVZAG(1,1)),(ZTAB(1,1, 2),USSDCG(1,1))
   1997       LOGICAL     HGTTBL
   1998       CHARACTER*8 SID
   1999 
   2000       DATA  ANGLE  / -90, -5, 5, 15, 25, 35, 45, 55, 65, 75/
   2001       DATA  CUTOFF / -.73, -1.58, -2.06, -2.77,
   2002      .              -3.56, -3.95, -4.36, -4.58,
   2003      .              -4.83, -5.12, -5.49, -5.79,
   2004      .              -6.06, -6.43, -6.72, -7.17/
   2005 
   2006 C  ITYPTT ASSIGNS PROPER TEMPERATURE CORRECTION TABLE TO INST. TYPES
   2007 C  -----------------------------------------------------------------
   2008 
   2009 C  ===> JTYPE:      1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
   2010 
   2011       DATA  ITYPTT/-1,-1,-1,-1,-1,-1,-1,-1,-1, 3, 3, 4, 0, 0, 0,
   2012 
   2013 C  ===> JTYPE:     16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
   2014 
   2015      $              0, 0,-1, 6, 0, 0, 1, 0, 0, 0, 0, 7, 8, 8, 0,
   2016 
   2017 C  ===> JTYPE:     31 32 33 34 35 36 37 38 39 40 41 42 43 44 45
   2018 
   2019      $              2,10, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 4,
   2020 
   2021 C  ===> JTYPE:     46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
   2022 
   2023      $              0, 1, 0, 0, 0, 3, 0,-1,-1,-1,-1,-1,-1,-1, 5,
   2024 
   2025 C  ===> JTYPE:     61 62 63 64 65 66-89 90-96 97 98 99 100-255
   2026 
   2027      $              0, 0, 0, 0, 0,24*-1, 7*0, -1,-1,-1, 156*0/
   2028 

Page 48          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2029 C  ITYPTG ASSIGNS PROPER GEOPOTENTIAL CORRECTION TABLE TO INST. TYPES
   2030 C  ------------------------------------------------------------------
   2031 
   2032 C  ===> JTYPE:      1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
   2033 
   2034       DATA  ITYPTG/ 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 0, 0, 0,
   2035 
   2036 C  ===> JTYPE:     16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
   2037 
   2038      $              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
   2039 
   2040 C  ===> JTYPE:     31 32 33 34 35 36 37 38 39 40 41 42 43 44 45
   2041 
   2042      $              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
   2043 
   2044 C  ===> JTYPE:     46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
   2045 
   2046      $              0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
   2047 
   2048 C  ===> JTYPE:     61 62 63 64 65 66-255
   2049 
   2050      $              0, 0, 0, 0, 0,190*0/
   2051 
   2052 C  TEMPERATURE CORRECTION TABLES ( * 10 K) FOR RADIATIVE EFFECTS
   2053 C  -------------------------------------------------------------
   2054 
   2055 
   2056 C                      (JAPAN) MEISEI  RS2-80
   2057 C              =====>  JTYPE = 22  --   ITAB = 1   <=====
   2058 C                             -- OR --
   2059 C                      (JAPAN) MEISEI  RS2-91
   2060 C              =====>  JTYPE = 47  --   ITAB = 1   <=====
   2061 
   2062       DATA  JAPANT  /
   2063 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2064 C        ___  ___    ___   ___   ___   ___   ___   ___   ___   ___
   2065 C LEVEL
   2066      1   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2067      2   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2068      3   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2069      4   0.0,  0.0,  3.0,  0.0,  1.0,  2.0,  2.0,  2.0,  3.0,  0.0,
   2070      5   0.0,  0.0,  0.0,  2.0,  3.0,  3.0,  4.0,  5.0,  7.0,  0.0,
   2071      A   0.0,  0.0,  0.0,  3.0,  3.0,  3.0,  4.0,  5.0,  6.0,  0.0,
   2072      6   0.0,  0.0,  0.0,  6.0,  4.0,  3.0,  4.0,  5.0,  6.0,  0.0,
   2073      B   0.0,  0.0,  0.0,  5.0,  4.0,  4.0,  4.0,  4.0,  5.0,  0.0,
   2074      7   0.0,  0.0,  0.0,  4.0,  6.0,  6.0,  4.0,  4.0,  5.0,  0.0,
   2075      C   0.0,  0.0,  0.0,  5.0,  6.0,  6.0,  5.0,  5.0,  4.0,  0.0,
   2076      8   0.0,  0.0,  0.0,  7.0,  8.0,  7.0,  8.0,  8.0,  4.0,  0.0,
   2077      D   0.0,  0.0,  0.0, 10.0, 10.0,  8.0,  8.0,  8.0,  2.0,  0.0,
   2078      9   0.0,  0.0,  0.0, 13.0, 12.0, 10.0,  8.0,  9.0,  2.0,  1.0,
   2079      $   0.0,  0.0,  0.0, 26.0, 19.0, 16.0, 12.0, 11.0, 10.0, -5.0,
   2080      T   0.0,  0.0,  0.0, 33.0, 30.0, 28.0, 19.0, 13.0, 14.0,-10.0,
   2081      L   0.0,  0.0,  0.0, 43.0, 41.0, 35.0, 16.0, 18.0, 14.0,  0.0/
   2082 
   2083 
   2084 C        (CANADA) VIZ/VALCOM TYPE A -- SAME CORRECTIONS AS VIZ-A
   2085 C              =====>  JTYPE = 31  --   ITAB = 2   <=====

Page 49          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2086 
   2087       DATA  CANADT  /
   2088 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2089 C        ___  ___    ___   ___   ___   ___   ___   ___   ___   ___
   2090 C LEVEL
   2091      1   0.2,  0.2,  0.2,  0.8,  0.8,  0.9,  0.9,  0.9,  0.9,  0.9,
   2092      2  -0.1, -0.1,  0.3,  1.1,  1.1,  1.2,  1.3,  1.3,  1.3,  1.3,
   2093      3  -0.3, -0.3,  0.3,  1.3,  1.3,  1.5,  1.7,  1.7,  1.7,  1.7,
   2094      4  -0.5, -0.5,  0.6,  1.9,  1.9,  2.0,  2.0,  2.0,  2.0,  2.0,
   2095      5  -0.6, -0.6,  1.3,  2.9,  2.9,  2.7,  2.5,  2.5,  2.5,  2.5,
   2096      A  -0.5, -0.5,  1.7,  3.7,  3.7,  3.3,  2.8,  2.8,  2.8,  2.8,
   2097      6  -0.2, -0.2,  2.4,  4.3,  4.3,  3.8,  3.3,  3.3,  3.3,  3.3,
   2098      B   0.1,  0.1,  3.1,  4.8,  4.8,  4.5,  4.3,  4.3,  4.3,  4.3,
   2099      7   0.1,  0.1,  3.7,  5.2,  5.2,  5.4,  5.6,  5.6,  5.6,  5.6,
   2100      C  -0.2, -0.2,  4.4,  6.0,  6.0,  6.5,  7.1,  7.1,  7.1,  7.1,
   2101      8  -0.7, -0.7,  5.5,  7.2,  7.2,  7.6,  8.1,  8.1,  8.1,  8.1,
   2102      D  -1.5, -1.5,  6.3,  8.4,  8.4,  8.6,  8.9,  8.9,  8.9,  8.9,
   2103      9  -2.3, -2.3,  6.1,  9.2,  9.2,  9.3,  9.5,  9.5,  9.5,  9.5,
   2104      $  -3.3, -3.3,  5.8, 10.2, 10.2, 10.0,  9.9,  9.9,  9.9,  9.9,
   2105      T  -4.8, -4.8,  5.4, 10.7, 10.7, 10.2,  9.8,  9.8,  9.8,  9.8,
   2106      L -10.6,-10.6,  3.8, 11.8, 11.8, 10.5,  9.3,  9.3,  9.3,  9.3/
   2107 
   2108 
   2109 C          (U.S.) NOAA / VIZ  TYPE A -- BASED ON SCHMIDLIN
   2110 C              =====>  JTYPE = 10  --   ITAB = 3   <=====
   2111 C                             -- OR --
   2112 C          (U.S.) NOAA / VIZ  TYPE B -- BASED ON SCHMIDLIN
   2113 C              =====>  JTYPE = 11  --   ITAB = 3   <=====
   2114 C                             -- OR --
   2115 C          (U.S.) AIR IS - 4A - 1680 -- BASED ON SCHMIDLIN
   2116 C              =====>  JTYPE = 43  --   ITAB = 3   <=====
   2117 C                             -- OR --
   2118 C          (U.S.) AIR IS - 4A - 1680 X -- BASED ON SCHMIDLIN
   2119 C              =====>  JTYPE = 44  --   ITAB = 3   <=====
   2120 
   2121       DATA  USVZAT  /
   2122 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2123 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2124 C LEVEL
   2125      1   0.2,  0.2,  0.2,  0.8,  0.8,  0.9,  0.9,  0.9,  0.9,  0.9,
   2126      2  -0.1, -0.1,  0.3,  1.1,  1.1,  1.2,  1.3,  1.3,  1.3,  1.3,
   2127      3  -0.3, -0.3,  0.3,  1.3,  1.3,  1.5,  1.7,  1.7,  1.7,  1.7,
   2128      4  -0.5, -0.5,  0.6,  1.9,  1.9,  2.0,  2.0,  2.0,  2.0,  2.0,
   2129      5  -0.6, -0.6,  1.3,  2.9,  2.9,  2.7,  2.5,  2.5,  2.5,  2.5,
   2130      A  -0.5, -0.5,  1.7,  3.7,  3.7,  3.3,  2.8,  2.8,  2.8,  2.8,
   2131      6  -0.2, -0.2,  2.4,  4.3,  4.3,  3.8,  3.3,  3.3,  3.3,  3.3,
   2132      B   0.1,  0.1,  3.1,  4.8,  4.8,  4.5,  4.3,  4.3,  4.3,  4.3,
   2133      7   0.1,  0.1,  3.7,  5.2,  5.2,  5.4,  5.6,  5.6,  5.6,  5.6,
   2134      C  -0.2, -0.2,  4.4,  6.0,  6.0,  6.5,  7.1,  7.1,  7.1,  7.1,
   2135      8  -0.7, -0.7,  5.5,  7.2,  7.2,  7.6,  8.1,  8.1,  8.1,  8.1,
   2136      D  -1.5, -1.5,  6.3,  8.4,  8.4,  8.6,  8.9,  8.9,  8.9,  8.9,
   2137      9  -2.3, -2.3,  6.1,  9.2,  9.2,  9.3,  9.5,  9.5,  9.5,  9.5,
   2138      $  -3.3, -3.3,  5.8, 10.2, 10.2, 10.0,  9.9,  9.9,  9.9,  9.9,
   2139      T  -4.8, -4.8,  5.4, 10.7, 10.7, 10.2,  9.8,  9.8,  9.8,  9.8,
   2140      L -10.6,-10.6,  3.8, 11.8, 11.8, 10.5,  9.3,  9.3,  9.3,  9.3/
   2141 
   2142 

Page 50          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2143 C                   (U.S.) RS SDC / SPACE DATA CORP.
   2144 C              =====>  JTYPE = 12  --   ITAB = 4   <=====
   2145 C                             -- OR --
   2146 C                            (U.S.) RS MSS
   2147 C              =====>  JTYPE = 45  --   ITAB = 4   <=====
   2148 
   2149       DATA  USSDCT  /
   2150 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2151 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2152 C LEVEL
   2153      1  -2.4, -2.4, -2.3, -2.1, -1.8, -1.5, -1.2, -1.2, -1.2, -1.2,
   2154      2  -2.6, -2.6, -2.2, -1.8, -1.4, -1.0, -0.5, -0.5, -0.5, -0.5,
   2155      3  -2.8, -2.8, -2.1, -1.4, -1.0, -0.4,  0.2,  0.2,  0.2,  0.2,
   2156      4  -2.8, -2.8, -1.7,  0.2,  0.8,  1.3,  1.6,  1.6,  1.6,  1.6,
   2157      5  -1.3, -1.3,  1.1,  3.5,  3.8,  4.1,  4.5,  4.5,  4.5,  4.5,
   2158      A   0.7,  0.7,  3.0,  6.0,  6.2,  6.4,  6.7,  6.7,  6.7,  6.7,
   2159      6   2.8,  2.8,  6.5,  9.1,  9.4,  9.7,  9.9,  9.9,  9.9,  9.9,
   2160      B   3.8,  3.8,  7.9, 11.4, 11.8, 12.1, 12.4, 12.4, 12.4, 12.4,
   2161      7   4.9,  4.9,  9.1, 13.7, 14.2, 14.6, 14.8, 14.8, 14.8, 14.8,
   2162      C   4.9,  4.9, 10.9, 16.0, 16.6, 16.8, 17.1, 17.1, 17.1, 17.1,
   2163      8   4.7,  4.7, 11.0, 17.2, 18.4, 18.8, 19.1, 19.1, 19.1, 19.1,
   2164      D   4.3,  4.3, 12.2, 19.4, 20.5, 20.7, 21.9, 21.9, 21.9, 21.9,
   2165      9   3.9,  3.9, 14.0, 21.2, 22.2, 23.4, 24.5, 24.5, 24.5, 25.5,
   2166      $   3.1,  3.1, 17.4, 23.2, 23.5, 24.4, 25.9, 25.9, 25.9, 25.9,
   2167      T   1.7,  1.7, 14.7, 24.7, 25.5, 26.2, 26.8, 26.8, 26.8, 26.8,
   2168      L  -4.0, -4.0, 12.0, 25.8, 26.6, 27.7, 28.3, 28.3, 28.3, 28.3/
   2169 
   2170 
   2171 C               VAISALA  RS80/MICROCORA -- NON-U.S. SITES
   2172 C              =====>  JTYPE = 60  --   ITAB = 5   <=====
   2173 
   2174       DATA  VRS80T  /
   2175 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2176 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2177 C LEVEL
   2178      1   2.0,  2.0,  0.0,  2.0,  2.0,  1.5,  1.0,  1.0,  1.0,  1.0,
   2179      2   1.0,  1.0,  0.5,  2.0,  2.0,  1.5,  1.0,  1.0,  1.0,  1.0,
   2180      3   0.0,  0.0,  1.0,  2.0,  2.0,  1.5,  1.0,  1.0,  1.0,  1.0,
   2181      4   1.0,  1.0,  2.0,  3.0,  3.0,  1.5,  0.0,  0.0,  0.0,  0.0,
   2182      5   1.0,  1.0,  2.0,  1.0,  1.0,  0.5,  0.0,  0.0,  0.0,  0.0,
   2183      A   2.0,  2.0,  4.0,  1.0,  1.0,  0.0, -1.0, -1.0, -1.0, -1.0,
   2184      6   4.0,  4.0,  5.0,  3.0,  3.0,  2.0,  1.0,  1.0,  1.0,  1.0,
   2185      B   6.0,  6.0,  7.0,  4.0,  4.0,  3.5,  3.0,  3.0,  3.0,  3.0,
   2186      7   5.0,  5.0,  5.0,  5.0,  5.0,  4.5,  4.0,  4.0,  4.0,  4.0,
   2187      C   5.0,  5.0,  6.0,  3.0,  3.0,  3.5,  4.0,  4.0,  4.0,  4.0,
   2188      8   5.0,  5.0,  6.0,  3.0,  3.0,  3.0,  3.0,  3.0,  3.0,  3.0,
   2189      D   4.0,  4.0,  7.0,  3.0,  3.0,  2.5,  2.0,  2.0,  2.0,  2.0,
   2190      9   6.0,  6.0,  4.0, -1.0, -1.0,  1.0,  3.0,  3.0,  3.0,  3.0,
   2191      $   7.0,  7.0,  3.0, -2.0, -2.0, -1.0,  0.0,  0.0,  0.0,  0.0,
   2192      T  11.0, 11.0,  3.0, -2.0, -2.0, -1.5, -1.0, -1.0, -1.0, -1.0,
   2193      L  20.0, 20.0, 15.0, 11.0, 11.0,  9.0,  7.0,  7.0,  7.0,  7.0/
   2194 
   2195 
   2196 C               (GERMANY) GRAW  M60 -- BASED ON SCHMIDLIN
   2197 C              =====>  JTYPE = 19  --   ITAB = 6   <=====
   2198 
   2199       DATA  GRM60T  /

Page 51          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2200 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2201 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2202 C LEVEL
   2203      1  -5.0, -5.0, -2.0,  0.0,  0.0,  1.5,  3.0,  3.0,  3.0,  3.0,
   2204      2  -1.0, -1.0, -1.5,  0.5,  0.5,  1.5,  2.5,  2.5,  2.5,  2.5,
   2205      3   3.0,  3.0, -1.0,  1.0,  1.0,  1.5,  2.0,  2.0,  2.0,  2.0,
   2206      4   4.0,  4.0,  0.0, -2.0, -2.0, -1.5, -1.0, -1.0, -1.0, -1.0,
   2207      5   2.0,  2.0,  3.0,  4.0,  4.0,  2.5,  1.0,  1.0,  1.0,  1.0,
   2208      A   2.0,  2.0,  6.0,  3.0,  3.0,  2.0,  1.0,  1.0,  1.0,  1.0,
   2209      6   6.0,  6.0,  8.0,  8.0,  8.0,  5.0,  3.0,  3.0,  3.0,  3.0,
   2210      B   8.0,  8.0,  8.0,  9.0,  9.0,  6.0,  3.0,  3.0,  3.0,  3.0,
   2211      7   8.0,  8.0,  8.0,  5.0,  5.0,  4.5,  4.0,  4.0,  4.0,  4.0,
   2212      C   5.0,  5.0,  7.0,  1.0,  1.0,  3.5,  6.0,  6.0,  6.0,  6.0,
   2213      8   3.0,  3.0,  8.0,  9.0,  9.0,  7.5,  6.0,  6.0,  6.0,  6.0,
   2214      D   1.0,  1.0,  9.0,  5.0,  5.0,  7.5, 10.0, 10.0, 10.0, 10.0,
   2215      9   2.0,  2.0,  1.0,  2.0,  3.0,  5.0,  9.0,  9.0,  9.0,  9.0,
   2216      $  -6.0, -6.0,-11.0, -8.0, -5.0,  0.0,  4.0,  4.0,  4.0,  4.0,
   2217      T  -3.0, -3.0,-15.0,-10.0, -7.5, -5.0,  0.0,  0.0,  0.0,  0.0,
   2218      L  -3.0, -3.0,-99.0,-75.0,-50.0,-35.0,-27.0,-27.0,-27.0,-27.0/
   2219 
   2220 
   2221 C        (RUSSIA) METEORIT  AVK-MRZ - AVERAGED FROM PREVIOUS TABLES
   2222 C              =====>  JTYPE = 27  --   ITAB = 7   <=====
   2223 
   2224       DATA  A22IVT  /
   2225 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2226 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2227 C LEVEL
   2228      1   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2229      2   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2230      3   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2231      4   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2232      5   0.0,  0.0,  1.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2233      A   0.0,  0.0,  1.0,  1.0,  1.0,  1.0,  0.0,  0.0,  0.0,  0.0,
   2234      6   0.0,  0.0,  2.0,  1.0,  1.0,  1.0,  0.0,  0.0,  0.0,  0.0,
   2235      B   0.0,  0.0,  2.0,  2.0,  2.0,  2.0,  0.0,  0.0,  0.0,  0.0,
   2236      7   0.0,  0.0,  2.0,  2.0,  2.0,  2.0,  1.0,  0.0,  0.0,  0.0,
   2237      C   0.0,  0.0,  2.0,  3.0,  3.0,  3.0,  2.0,  0.0,  0.0,  0.0,
   2238      8   0.0,  0.0,  3.0,  4.0,  4.0,  5.0,  3.0,  1.0,  0.0,  0.0,
   2239      D   0.0,  0.0,  3.0,  4.0,  5.0,  7.0,  5.0,  3.0,  0.0,  0.0,
   2240      9   0.0,  0.0,  4.0,  6.0,  6.0,  8.0,  6.0,  4.0,  0.0,  0.0,
   2241      $   0.0,  0.0,  4.0,  7.0,  7.0,  8.0,  6.0,  6.0,  0.0,  0.0,
   2242      T   0.0,  0.0,  5.0, 10.0,  5.0, 11.0, 11.0,  6.0,  0.0,  0.0,
   2243      L   0.0,  0.0,  6.0, 22.0, 16.0, 11.5, 11.3, 11.0,  0.0,  0.0/
   2244 
   2245 
   2246 C      (RUSSIA) METEORIT  MARZ2-1 -- AVERAGED FROM PREVIOUS TABLES
   2247 C              =====>  JTYPE = 28  --   ITAB = 8   <=====
   2248 C                              -- OR --
   2249 C      (RUSSIA) METEORIT  MARZ2-2 -- AVERAGED FROM PREVIOUS TABLES
   2250 C              =====>  JTYPE = 29  --   ITAB = 8   <=====
   2251 
   2252       DATA  MARZ2T  /
   2253 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2254 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2255 C LEVEL
   2256      1   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,

Page 52          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2257      2   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2258      3   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2259      4   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2260      5   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
   2261      A   0.0,  0.0,  1.0,  1.0,  1.0,  1.0,  0.0,  0.0,  0.0,  0.0,
   2262      6   0.0,  0.0,  1.0,  1.0,  1.0,  1.0,  0.0,  0.0,  0.0,  0.0,
   2263      B   0.0,  0.0,  2.0,  2.0,  2.0,  1.0,  0.0,  0.0,  0.0,  0.0,
   2264      7   0.0,  0.0,  2.0,  2.0,  2.0,  1.0,  0.0,  0.0,  0.0,  0.0,
   2265      C   0.0,  0.0,  3.5,  3.0,  2.5,  1.0,  0.5,  0.0,  0.0,  0.0,
   2266      8   0.0,  1.0,  4.0,  4.0,  2.5,  1.0,  0.5,  0.0,  0.0,  0.0,
   2267      D   0.0,  2.0,  4.5,  4.5,  2.5,  1.0,  0.5,  0.0,  0.0,  0.0,
   2268      9   0.0,  3.0,  6.0,  6.0,  3.5,  1.5,  1.0,  0.0,  0.0,  0.0,
   2269      $   0.0,  4.0,  8.5,  7.5,  5.0,  2.5,  1.0,  0.0,  0.0,  0.0,
   2270      T   0.0,  5.0, 10.0, 10.0,  6.0,  4.5,  1.0,  0.0,  0.0,  0.0,
   2271      L   0.0, 11.0, 22.0, 17.0, 11.5, 10.5,  2.0,  1.0,  0.0,  0.0/
   2272 
   2273 
   2274 C            (U.K.) UK MET OFFICE  MK3 -- BASED ON SCHMIDLIN
   2275 C       (CURRENTLY NOT IN USE -- UK STATIONS USE VAISALA SONDE)
   2276 C              =====>  JTYPE = 33  --   ITAB = 9   <=====
   2277 
   2278       DATA  UKMK3T  /
   2279 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2280 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2281 C LEVEL
   2282      1   3.0,  3.0, -4.0, -3.0, -3.0, -4.0, -6.0, -6.0, -6.0, -6.0,
   2283      2   0.5,  0.5, -4.0, -2.0, -2.0, -3.0, -4.5, -4.5, -4.5, -4.5,
   2284      3  -2.0, -2.0, -4.0, -1.0, -1.0, -2.0, -3.0, -3.0, -3.0, -3.0,
   2285      4  -1.0, -1.0,  1.0,  0.0,  0.0, -1.0, -2.0, -2.0, -2.0, -2.0,
   2286      5   0.0,  0.0, -2.0,  0.0,  0.0, -1.0, -3.0, -3.0, -3.0, -3.0,
   2287      A  -1.0, -1.0,  0.0,  0.0,  0.0, -1.0, -3.0, -3.0, -3.0, -3.0,
   2288      6  -1.0, -1.0,  0.0,  1.0,  1.0,  0.0, -2.0, -2.0, -2.0, -2.0,
   2289      B   0.0,  0.0,  2.0,  3.0,  3.0,  1.0, -1.0, -1.0, -1.0, -1.0,
   2290      7   0.0,  0.0,  1.0,  2.0,  2.0,  1.0,  1.0,  1.0,  1.0,  1.0,
   2291      C   0.0,  0.0,  2.0,  2.0,  2.0,  1.0,  1.0,  1.0,  1.0,  1.0,
   2292      8   0.0,  0.0,  2.0,  1.0,  1.0,  1.0,  2.0,  2.0,  2.0,  2.0,
   2293      D   0.0,  0.0,  2.0,  2.0,  2.0,  2.0,  2.0,  2.0,  2.0,  2.0,
   2294      9   0.0,  0.0,  3.0,  5.0,  5.0,  3.0,  2.0,  2.0,  2.0,  2.0,
   2295      $   1.0,  1.0,  2.0,  4.0,  4.0,  3.0,  2.0,  2.0,  2.0,  2.0,
   2296      T   3.0,  3.0,  3.0,  5.0,  5.0,  3.0,  1.0,  1.0,  1.0,  1.0,
   2297      L   6.0,  6.0, 11.0, 11.0, 11.0, 10.0, 10.0, 10.0, 10.0, 10.0/
   2298 
   2299 
   2300 C              (CHINA) SHANGHAI RADIO -- BASED ON JULIAN
   2301 C              =====>  JTYPE = 32  --   ITAB = 10  <=====
   2302 
   2303       DATA  SHANGT  /
   2304 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2305 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2306 C LEVEL
   2307      1   0.5,  0.3,  0.0,  0.4,  0.5,  0.9,  0.9,  0.9,  0.9,  0.9,
   2308      2   0.5,  0.6,  1.0,  1.2,  1.0,  0.9,  0.9,  0.9,  0.9,  0.9,
   2309      3   0.5,  0.9,  1.9,  2.0,  1.5,  0.9,  0.9,  0.9,  0.9,  0.9,
   2310      4  -0.1,  1.9,  2.6,  2.7,  1.8,  1.8,  1.8,  1.9,  1.9,  1.9,
   2311      5   1.2,  5.5,  6.3,  6.0,  4.9,  4.1,  4.1,  4.1,  4.2,  4.2,
   2312      A   4.7,  8.8,  9.8,  9.7,  9.1,  9.0,  9.0,  9.0,  9.0,  9.0,
   2313      6  10.3, 13.7, 14.2, 14.7, 15.2, 16.0, 16.0, 16.0, 16.0, 16.0,

Page 53          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2314      B  13.7, 15.3, 16.4, 17.2, 18.5, 19.9, 19.9, 19.9, 19.9, 19.9,
   2315      7  16.7, 17.4, 18.0, 18.9, 21.1, 22.8, 22.8, 22.8, 22.8, 22.8,
   2316      C  17.4, 17.2, 17.1, 17.6, 20.3, 22.0, 22.0, 22.0, 22.0, 22.0,
   2317      8   8.7,  8.3,  8.1,  6.0,  7.6,  7.4,  7.4,  7.4,  7.4,  7.4,
   2318      D -11.5,-10.1,- 9.1,-13.9,-13.4,-13.2,-13.2,-13.2,-13.2,-13.2,
   2319      9 - 9.0,-12.6,-13.3,-20.3,-18.9,-18.9,-18.9,-18.9,-18.9,-18.9,
   2320      $   1.8,- 6.7,- 7.4,-15.3,-15.0,-17.0,-17.1,-17.1,-17.1,-17.1,
   2321      T  11.4,  5.0,  2.0,- 5.0,- 6.4,-10.0,-10.0,-10.0,-10.0,-10.0,
   2322      L  16.6, 13.5, 12.1,  8.5,  5.7,  4.0,  4.0,  4.0,  4.0,  4.0/
   2323 
   2324 
   2325 C                 VAISALA  RS80/MICROCORA -- U.S. SITES
   2326 C              =====>  JTYPE = 60  --   ITAB = 11  <=====
   2327 
   2328       DATA  VRS80U  /
   2329 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2330 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2331 C LEVEL
   2332      1   2.0,  2.0,  0.0,  2.0,  2.0,  1.5,  1.0,  1.0,  1.0,  1.0,
   2333      2   1.0,  1.0,  0.5,  2.0,  2.0,  1.5,  1.0,  1.0,  1.0,  1.0,
   2334      3   0.0,  0.0,  1.0,  2.0,  2.0,  1.5,  1.0,  1.0,  1.0,  1.0,
   2335      4   1.0,  1.0,  2.0,  3.0,  3.0,  1.5,  0.0,  0.0,  0.0,  0.0,
   2336      5   1.0,  1.0,  2.0,  1.0,  1.0,  0.5,  0.0,  0.0,  0.0,  0.0,
   2337      A   2.0,  2.0,  4.0,  1.0,  1.0,  0.0, -1.0, -1.0, -1.0, -1.0,
   2338      6   4.0,  4.0,  5.0,  3.0,  3.0,  2.0,  1.0,  1.0,  1.0,  1.0,
   2339      B   6.0,  6.0,  7.0,  4.0,  4.0,  3.5,  3.0,  3.0,  3.0,  3.0,
   2340      7   5.0,  5.0,  5.0,  5.0,  5.0,  4.5,  4.0,  4.0,  4.0,  4.0,
   2341      C   5.0,  5.0,  6.0,  3.0,  3.0,  3.5,  4.0,  4.0,  4.0,  4.0,
   2342      8   5.0,  5.0,  6.0,  3.0,  3.0,  3.0,  3.0,  3.0,  3.0,  3.0,
   2343      D   4.0,  4.0,  7.0,  3.0,  3.0,  2.5,  2.0,  2.0,  2.0,  2.0,
   2344      9   6.0,  6.0,  4.0, -1.0, -1.0,  1.0,  3.0,  3.0,  3.0,  3.0,
   2345      $   4.0,  4.0,  2.0, -2.0, -2.0, -1.0,  0.0,  0.0,  0.0,  0.0,
   2346      T   7.0,  7.0,  2.0, -2.0, -2.0, -1.5, -1.0, -1.0, -1.0, -1.0,
   2347      L  13.0, 13.0, 13.0, 11.0, 11.0,  9.0,  7.0,  7.0,  7.0,  7.0/
   2348 
   2349 
   2350 C                 VIZ MICROSONDE (MARK II)
   2351 C              =====>  JTYPE = 49  --   ITAB = 12  <=====
   2352 
   2353       DATA  USMK2T  /
   2354 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2355 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2356 C LEVEL
   2357      1   1.2,  1.2,  0.2,  0.8,  0.8,  0.9,  0.9,  0.9,  0.9,  0.9,
   2358      2   0.9,  0.9,  0.3,  1.1,  1.1,  1.2,  1.3,  1.3,  1.3,  1.3,
   2359      3   0.7,  0.7,  0.3,  1.3,  1.3,  1.5,  1.7,  1.7,  1.7,  1.7,
   2360      4   0.5,  0.5,  0.6,  1.9,  1.9,  2.0,  2.0,  2.0,  2.0,  2.0,
   2361      5   0.4,  0.4,  1.3,  2.9,  2.9,  2.7,  2.5,  2.5,  2.5,  2.5,
   2362      A   0.5,  0.5,  1.7,  3.7,  3.7,  3.3,  2.8,  2.8,  2.8,  2.8,
   2363      6   0.8,  0.8,  2.4,  4.3,  4.3,  3.8,  3.3,  3.3,  3.3,  3.3,
   2364      B   0.9,  1.1,  3.1,  4.8,  4.8,  4.5,  4.3,  4.3,  4.3,  4.3,
   2365      7   0.9,  0.1,  2.7,  4.2,  4.2,  4.4,  4.6,  4.6,  4.6,  4.6,
   2366      C   0.8, -0.2,  3.4,  4.0,  4.0,  4.5,  5.1,  5.1,  5.1,  5.1,
   2367      8   0.3, -0.7,  4.5,  5.2,  5.2,  5.6,  6.1,  6.1,  6.1,  6.1,
   2368      D  -0.5, -1.5,  4.3,  5.4,  6.4,  6.6,  5.9,  6.9,  6.9,  6.9,
   2369      9  -2.3, -2.3,  4.1,  6.2,  6.2,  6.3,  6.5,  6.5,  6.5,  6.5,
   2370      $  -3.3, -4.3,  2.8,  5.2,  5.2,  5.0,  4.9,  4.9,  4.9,  4.9,

Page 54          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2371      T  -5.8, -7.8,  0.4,  2.7,  2.7,  5.2,  4.8,  4.8,  4.8,  4.8,
   2372      L -12.6,-15.6, -5.2, -2.2, -2.2, -3.5, -4.7, -4.7, -4.7, -4.7/
   2373 
   2374 
   2375 C  GEOPOTENTIAL CORRECTION TABLES (METERS) FOR RADIATIVE EFFECTS
   2376 C  AND INCORRECT GRAVITY CONSTANT IN MICROARTS
   2377 C  -------------------------------------------------------------
   2378 
   2379 
   2380 C          (U.S.) NOAA / VIZ  TYPE A -- BASED ON SCHMIDLIN
   2381 C              =====>  JTYPE = 10  --   JTAB = 1  <=====
   2382 C                             -- OR --
   2383 C          (U.S.) NOAA / VIZ  TYPE B -- BASED ON SCHMIDLIN
   2384 C              =====>  JTYPE = 11  --   JTAB = 1  <=====
   2385 
   2386       DATA  USVZAG  /
   2387 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2388 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2389 C LEVEL
   2390      1    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
   2391      2    0.,   0.,   0.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
   2392      3    1.,   1.,   1.,   2.,   2.,   2.,   2.,   2.,   2.,   2.,
   2393      4    2.,   2.,   3.,   4.,   4.,   4.,   4.,   4.,   4.,   4.,
   2394      5    3.,   3.,   5.,   8.,   8.,   8.,   8.,   8.,   8.,   8.,
   2395      A    4.,   4.,   7.,  11.,  11.,  11.,  11.,  11.,  11.,  11.,
   2396      6    5.,   5.,  10.,  16.,  16.,  16.,  15.,  15.,  15.,  15.,
   2397      B    6.,   6.,  13.,  19.,  19.,  18.,  17.,  17.,  17.,  17.,
   2398      7    7.,   7.,  16.,  23.,  23.,  22.,  21.,  21.,  21.,  21.,
   2399      C    8.,   8.,  20.,  29.,  29.,  29.,  28.,  28.,  28.,  28.,
   2400      8    9.,   9.,  28.,  39.,  39.,  39.,  39.,  39.,  39.,  39.,
   2401      D    9.,   9.,  36.,  48.,  48.,  48.,  49.,  49.,  49.,  49.,
   2402      9    9.,   9.,  43.,  58.,  59.,  59.,  60.,  60.,  60.,  60.,
   2403      $    7.,   7.,  54.,  75.,  75.,  75.,  76.,  76.,  76.,  76.,
   2404      T    4.,   4.,  63.,  89.,  89.,  89.,  90.,  90.,  90.,  90.,
   2405      L   -9.,  -9.,  75., 115., 115., 113., 112., 112., 112., 110./
   2406 
   2407 
   2408 C     (U.S.) RS SDC / SPACE DATA CORP. -- BASED ON SCHMIDLIN/AHNERT
   2409 C              =====>  JTYPE = 12  --   JTAB = 2  <=====
   2410 
   2411       DATA  USSDCG  /
   2412 C       NITE   -5     5    15     25    35    45    55    65    75 S.ANG
   2413 C      _____ _____ _____ _____ _____ _____ _____ _____ _____ _____
   2414 C LEVEL
   2415      1    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
   2416      2    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
   2417      3    0.,   0.,   0.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
   2418      4    0.,   0.,   1.,   1.,   2.,   3.,   3.,   3.,   3.,   3.,
   2419      5   -1.,  -1.,   3.,   5.,   6.,   7.,   7.,   7.,   7.,   7.,
   2420      A    0.,   0.,   4.,   9.,  11.,  11.,  12.,  12.,  12.,  12.,
   2421      6    3.,   3.,  10.,  17.,  18.,  19.,  21.,  21.,  21.,  21.,
   2422      B    5.,   5.,  13.,  23.,  25.,  26.,  27.,  27.,  27.,  27.,
   2423      7    9.,   9.,  16.,  32.,  33.,  35.,  37.,  37.,  37.,  37.,
   2424      C   14.,  14.,  25.,  46.,  48.,  50.,  52.,  52.,  52.,  52.,
   2425      8   21.,  21.,  38.,  67.,  69.,  72.,  75.,  75.,  75.,  75.,
   2426      D   27.,  27.,  56.,  87.,  90.,  94.,  98.,  98.,  98.,  98.,
   2427      9   33.,  33.,  85., 108., 113., 117., 122., 122., 122., 122.,

Page 55          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2428      $   41.,  41.,  94., 144., 152., 157., 162., 162., 162., 162.,
   2429      T   45.,  45., 123., 175., 182., 189., 195., 162., 162., 162.,
   2430      L   46.,  46., 155., 230., 236., 247., 256., 256., 256., 256./
   2431 
   2432 C-----------------------------------------------------------------------
   2433 C-----------------------------------------------------------------------
   2434 
   2435       IRET = 0
   2436 
   2437 C  EACH TIME THROUGH, COMPUTE LOGS OF PRESSURE RATIOS
   2438 C  --------------------------------------------------
   2439 
   2440       ALP(1) = 0.0
   2441       DO I=2,16
   2442          ALP(I) = ALOG(PRES(I-1)/PRES(I))
   2443       ENDDO
   2444 
   2445 C  GET TABLE INDEX FROM RAOB TYPE - CHECK FOR VALID CORR. PARAMETERS
   2446 C  (GEOPOTENTIAL CORRECTION TABLE JTAB ONLY VALID PRIOR TO 00Z 10/1/93)
   2447 C  --------------------------------------------------------------------
   2448 
   2449       ITAB = 0
   2450       JTAB = 0
   2451       IF(JTYPE.GT.0.AND.JTYPE.LT.256) THEN
   2452          ITAB = ITYPTT(JTYPE)
   2453          IF(ITAB.EQ.0)  THEN
   2454             IRET = -1
   2455             RETURN
   2456          ELSE  IF(ITAB.EQ.5)  THEN
   2457             IF(SID(IS)(1:1).EQ.'W'.OR.SID(IS)(1:2).EQ.'70'.OR.
   2458      &       SID(IS)(1:2).EQ.'72'.OR.SID(IS)(1:2).EQ.'74'.OR.
   2459      &       SID(IS).EQ.'89009   '.OR.SID(IS).EQ.'89664   '.OR.
   2460      &       SID(IS).EQ.'91762   '.OR.SID(IS).EQ.'91765   '.OR.
   2461      &       (SID(IS)(1:5).GT.'91065'.AND.SID(IS)(1:5).LT.'91191').OR.
   2462      &       (SID(IS)(1:5).GT.'91284'.AND.SID(IS)(1:5).LT.'91357').OR.
   2463      &       (SID(IS)(1:5).GT.'91407'.AND.SID(IS)(1:5).LT.'91435'))
   2464      &        ITAB =11
   2465          ELSE  IF(ITAB.LT.0)  THEN
   2466             WRITE(6,1)  SID(IS),JTYPE
   2467             WRITE(68,1) SID(IS),JTYPE
   2468             IRET = -1
   2469             RETURN
   2470          END IF
   2471          IF(ITAB.EQ.11)  THEN
   2472             PRINT *, '##### A U.S. VAISALA AT STNID :',SID(IS)
   2473             WRITE(68,'("##### A U.S. VAISALA AT STNID :",A)') SID(IS)
   2474          END IF
   2475          IF(HGTTBL) JTAB = ITYPTG(JTYPE)
   2476       ELSE
   2477          WRITE(6,1)  SID(IS),JTYPE
   2478          WRITE(68,1) SID(IS),JTYPE
   2479 1        FORMAT(5X,'* * *  STN. ID ',A8,' HAS AN INVALID RAOB TYPE ',
   2480      .    'DESIGNATION (BUFR/ON29 CODE ',I8,') - NO CORRECTION ',
   2481      .    'POSSIBLE')
   2482          IRET = -1
   2483          if(jtype.eq.20000)  iret = -99
   2484          RETURN

Page 56          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2485       ENDIF
   2486 
   2487 C  GET SOLAR ELEVATION ANGLE ON ALL VALID MANDATORY LEVELS
   2488 C  -------------------------------------------------------
   2489 
   2490       CALL SOELAN(SOLAR)
   2491 
   2492 C  APPLY TEMPERATURE AND HEIGHT CORRECTIONS
   2493 C  ----------------------------------------
   2494 
   2495       DO ILEV=1,16
   2496          ANGLE(2)  = CUTOFF(ILEV)
   2497          DTS(ILEV) = 0
   2498          DHS(ILEV) = 0
   2499          DTL       = 0
   2500          DHL       = 0
   2501 
   2502          IF(SOLAR(ILEV).GE.CUTOFF(ILEV))  THEN
   2503             IF(SOLAR(ILEV).LT.ANGLE(10)) THEN
   2504                DO K=3,10
   2505                   IF(SOLAR(ILEV).LT.ANGLE(K)) THEN
   2506                      TABU = TTAB(K  ,ILEV,ITAB)
   2507                      TABD = TTAB(K-1,ILEV,ITAB)
   2508                      DSUN=(SOLAR(ILEV)-ANGLE(K-1))/(ANGLE(K)-ANGLE(K-1))
   2509                      DTS(ILEV) = TABD + DSUN*(TABU-TABD)
   2510                      IF(JTAB.GT.0)  THEN
   2511                         TABU = ZTAB(K  ,ILEV,JTAB)
   2512                         TABD = ZTAB(K-1,ILEV,JTAB)
   2513                         DHS(ILEV) = TABD + DSUN*(TABU-TABD)
   2514                      ENDIF
   2515                      GO TO 10
   2516                   ENDIF
   2517                ENDDO
   2518             ELSE
   2519                DTS(ILEV) = TTAB(10,ILEV,ITAB)
   2520                IF(JTAB.GT.0)  DHS(ILEV) = ZTAB(10,ILEV,JTAB)
   2521             ENDIF
   2522          ELSE
   2523 
   2524 C  IF ANGLE < CUTOFF (NIGHT), CORRECTION FROM 'NIGHT' VALUE IN TBL
   2525 C  --------------------------------------------------------------------
   2526 
   2527             DTS(ILEV) = TTAB(1,ILEV,ITAB)
   2528             IF(JTAB.GT.0)  DHS(ILEV) = ZTAB(1,ILEV,JTAB)
   2529          ENDIF
   2530 
   2531 C  IF JTAB IS ZERO, COMPUTE HEIGHT CORRECTIONS VIA HYDROSTATIC INTERP.
   2532 C  -------------------------------------------------------------------
   2533 
   2534 10       IF(JTAB.LE.0)  THEN
   2535 
   2536 C  The constant is (R/(20*g)) = 1.46355
   2537 
   2538             HYF = 1.46355*ALP(ILEV)
   2539             IF(ILEV.EQ.1) THEN
   2540                DHS(ILEV) = HYF*DTS(ILEV)
   2541             ELSE

Page 57          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2542                DHS(ILEV) = DHS(ILEV-1) + HYF*(10.*DTS(ILEV-1)+DTS(ILEV))
   2543             ENDIF
   2544          ENDIF
   2545 
   2546 C  CORRECT DTS BY A FACTOR OF 10
   2547 C  -----------------------------
   2548 
   2549          DTS(ILEV) = .1*DTS(ILEV)
   2550 
   2551 C  SAVE AND APPLY THE CORRECTIONS
   2552 C  ------------------------------
   2553 
   2554          DHT(ILEV) = DHL - DHS(ILEV)
   2555          DTP(ILEV) = DTL - DTS(ILEV)
   2556 
   2557          IF(HGT(ILEV).LT.BMISS) HGT(ILEV) = HGT(ILEV) + DHT(ILEV)
   2558          IF(TMP(ILEV).LT.BMISS) TMP(ILEV) = TMP(ILEV) + DTP(ILEV)
   2559 
   2560       ENDDO
   2561 
   2562       RETURN
   2563       END


ENTRY POINTS

  Name              
                    
 radt3_             

Page 58          Source Listing                  RADT3
2017-04-18 11:07 Symbol Table                    radcor.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  2479                                                           2466,2467,2477,2478               
 10                         Label  2534                                                           2515                              
 A22IVT                     Local  1985     R(4)            4     2     160      SAVE             2224                              
 ALOG                       Func   2442                                 scalar                    2442                              
 ALP                        Local  1983     R(4)            4     1     16                        2440,2442,2538                    
 ANGLE                      Local  1983     R(4)            4     1     10                        2000,2496,2503,2505,2508          
 BAL_DRIFT                  Scalar 1977     R(4)            4           scalar   COM                                                
 BMISS                      Scalar 1971     R(8)            8           scalar   COM              2557,2558                         
 BUFRLIB_MISSING            Common 1980                                 16                                                          
 CANADT                     Local  1984     R(4)            4     2     160      SAVE             2087                              
 CUTOFF                     Local  1982     R(4)            4     1     16                        2001,2496,2502                    
 DHL                        Local  2500     R(4)            4           scalar                    2500,2554                         
 DHR                        Scalar 1973     R(4)            4     1     999      COM                                                
 DHS                        Local  1983     R(4)            4     1     16                        2498,2513,2520,2528,2540,2542,2554
 DHT                        Scalar 1976     R(4)            4     1     16       COM              2554,2557                         
 DSUN                       Local  2508     R(4)            4           scalar                    2508,2509,2513                    
 DTL                        Local  2499     R(4)            4           scalar                    2499,2555                         
 DTP                        Scalar 1976     R(4)            4     1     16       COM              2555,2558                         
 DTS                        Local  1983     R(4)            4     1     16                        2497,2509,2519,2527,2540,2542,2549
                                                                                                  ,2555                             
 ELV                        Scalar 1974     R(4)            4     1     999      COM                                                
 GRM60T                     Local  1985     R(4)            4     2     160      SAVE             2199                              
 HEADER                     Common 1973                                 35980                                                       
 HGT                        Scalar 1976     R(4)            4     1     16       COM              2557                              
 HGTTBL                     Scalar 1977     L(4)            4           scalar   COM              2475                              
 HYF                        Local  2538     R(4)            4           scalar                    2538,2540,2542                    
 I                          Local  2441     I(4)            4           scalar                    2441,2442                         
 ILEV                       Local  2495     I(4)            4           scalar                    2495,2496,2497,2498,2502,2503,2505
                                                                                                  ,2506,2507,2508,2509,2511,2512,251
                                                                                                  3,2519,2520,2527,2528,2538,2539,25
                                                                                                  40,2542,2549,2554,2555,2557,2558  
 IMISS                      Scalar 1980     I(4)            4           scalar   COM                                                
 INM                        Scalar 1978     I(4)            4     1     16       COM                                                
 IRCTBL                     Scalar 1977     I(4)            4           scalar   COM                                                
 IRET                       Dummy  1968     I(4)            4           scalar   ARG,INOUT        2435,2454,2468,2482,2483          
 IS                         Scalar 1979     I(4)            4           scalar   COM              2457,2458,2459,2460,2461,2462,2463
                                                                                                  ,2466,2467,2472,2473,2477,2478    
 ISF                        Scalar 1975     I(4)            4     1     999      COM                                                
 ITAB                       Local  2449     I(4)            4           scalar                    2449,2452,2453,2456,2464,2465,2471
                                                                                                  ,2506,2507,2519,2527              
 ITP                        Scalar 1974     I(4)            4     1     999      COM                                                
 ITYPTG                     Local  1989     I(4)            4     1     255                       2034,2475                         
 ITYPTT                     Local  1989     I(4)            4     1     255                       2011,2452                         
 JAPANT                     Local  1984     R(4)            4     2     160      SAVE             2062                              
 JTAB                       Local  2450     I(4)            4           scalar                    2450,2475,2510,2511,2512,2520,2528
                                                                                                  ,2534                             
 JTYPE                      Scalar 1976     I(4)            4           scalar   COM              2451,2452,2466,2467,2475,2477,2478
                                                                                                  ,2483                             
 K                          Local  2504     I(4)            4           scalar                    2504,2505,2506,2507,2508,2511,2512
 KMAX                       Scalar 1978     I(4)            4           scalar   COM                                                
 KMIN                       Scalar 1978     I(4)            4           scalar   COM                                                

Page 59          Source Listing                  RADT3
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LEVRAD                     Scalar 1977     I(4)            4           scalar   COM                                                
 LWCORR                     Scalar 1977     I(4)            4           scalar   COM                                                
 MARZ2T                     Local  1987     R(4)            4     2     160      SAVE             2252                              
 NEV                        Scalar 1975     I(4)            4           scalar   COM                                                
 NLV                        Scalar 1974     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 1975     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 1975     I(4)            4           scalar   COM                                                
 NST                        Param  1969     I(4)            4           scalar                    1973,1974,1975                    
 PMAND                      Common 1978                                 136                                                         
 PRES                       Scalar 1978     R(4)            4     1     16       COM              2442                              
 RADCOM                     Common 1976                                 260                                                         
 RADT3                      Subr   1968                                                                                             
 SHANGT                     Local  1986     R(4)            4     2     160      SAVE             2303                              
 SID                        Scalar 1973     CHAR            8     1     999      COM              2457,2458,2459,2460,2461,2462,2463
                                                                                                  ,2466,2467,2472,2473,2477,2478    
 SOELAN                     Subr   2490                                                           2490                              
 SOLAR                      Local  1983     R(4)            4     1     16                        2490,2502,2503,2505,2508          
 SQN                        Scalar 1974     R(4)            4     1     999      COM                                                
 STN                        Common 1979                                 4                                                           
 SWITCH                     Common 1977                                 20                                                          
 TABD                       Local  2507     R(4)            4           scalar                    2507,2509,2512,2513               
 TABU                       Local  2506     R(4)            4           scalar                    2506,2509,2511,2513               
 TMP                        Scalar 1976     R(4)            4     1     16       COM              2558                              
 TTAB                       Local  1982     R(4)            4     3     1920                      2506,2507,2519,2527               
 UKMK3T                     Local  1986     R(4)            4     2     160      SAVE             2278                              
 USMK2T                     Local  1988     R(4)            4     2     160      SAVE             2353                              
 USSDCG                     Local  1987     R(4)            4     2     160      SAVE             2411                              
 USSDCT                     Local  1987     R(4)            4     2     160      SAVE             2149                              
 USVZAG                     Local  1986     R(4)            4     2     160      SAVE             2386                              
 USVZAT                     Local  1984     R(4)            4     2     160      SAVE             2121                              
 VRS80T                     Local  1985     R(4)            4     2     160      SAVE             2174                              
 VRS80U                     Local  1988     R(4)            4     2     160      SAVE             2328                              
 XMISS                      Scalar 1980     R(4)            4           scalar   COM                                                
 XOB                        Scalar 1973     R(4)            4     1     999      COM                                                
 YOB                        Scalar 1973     R(4)            4     1     999      COM                                                
 ZTAB                       Local  1982     R(4)            4     3     320                       2511,2512,2520,2528               

Page 60          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2564 
   2565 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2566 C
   2567 C SUBPROGRAM:    RADT4       APPLIES NEWEST SET OF RADIATION CORRECTNS
   2568 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2007-09-14
   2569 C
   2570 C ABSTRACT: THIS SUBROUTINE APPLIES RADIATION CORRECTIONS TO THE
   2571 C   OBSERVED RADIOSONDE HEIGHTS AND TEMPERATURES ON THE BOTTOM 16
   2572 C   MANDATORY PRESSURE LEVELS.  DATA ARE PASSED THROUGH COMMON
   2573 C   /RADCOM/.  THE CORRECTION OF RAOBS FOR BOTH SHORT- AND LONG-WAVE
   2574 C   EFFECTS IN ACCOMPLISHED BY READING IN TABLES OF NUMBERS WHICH ARE
   2575 C   DEPENDENT ON THE RADIOSONDE TYPE. CALLED FOR ONE REPORT AT A TIME.
   2576 C
   2577 C PROGRAM HISTORY LOG:
   2578 C 1999-06-02  W. COLLINS (W/NP22) -- ORIGINAL AUTHOR
   2579 C 2002-07-22  D. A. KEYSER -- CALLS NEW ROUTINE SOELAN TO CALCULATE SUN
   2580 C     ANGLE ON VALID MANDATORY LEVELS RATHER THAN DOING CALCULATION IN
   2581 C     THIS SUBROUTINE
   2582 C 2007-09-14  D. KEYSER    -- MINOR CODE CORRECTIONS SUGGESTED BY PAT
   2583 C     PAULEY (CORRECTS PROBLEMS THAT COULD OCCUR ON SOME REMOTE
   2584 C     MACHINES)
   2585 C
   2586 C USAGE:    CALL RADT4(IRET)
   2587 C   OUTPUT ARGUMENT LIST:
   2588 C     IRET     - RETURN CODE (0=CORRECTIONS, -1=NO CORRECTIONS,
   2589 C              - -99=??????)
   2590 C
   2591 C   OUTPUT FILES:
   2592 C     UNIT 06  - PRINTOUT
   2593 C     UNIT 68  - RADCOR INFORMATION FILE
   2594 C
   2595 C REMARKS: THESE CORRECTIONS USE THE BUFR CODE FIGURE FOR RADIOSONDE
   2596 C   TYPE OBTAINED FROM BUFR-FM94 TABLE 0 02 011.  THE NMC UPPER-AIR
   2597 C   DICTIONARY ALSO CONTAINS THIS BUFR CODE FIGURE FOR RADIOSONDE
   2598 C   TYPE.  CALLED BY SUBROUTINE "RADEVN".
   2599 C
   2600 C
   2601 C   KEY FOR RADIOSONDE TYPES USED HERE:
   2602 C
   2603 C  JTYPE   (   * =     )   DESCRIPTION                      TABLE NUMBER
   2604 C          (in use 1998)
   2605 C  < 0                     INVALID
   2606 C  0 TO 6                  NOT USED FOR SONDES
   2607 C  7 TO 8                  RESERVED
   2608 C    9          *          UNKNOWN TYPE (Don't adjust)            1
   2609 C   10          *          (U.S.) NOAA / VIZ TYPE  A              2
   2610 C   11          *          (U.S.) NOAA / VIZ TYPE  B              3
   2611 C   12          *          (U.S.) NOAA / SPACE DATA CORP.         4
   2612 C   13                     (AUSTRALIA) ASTOR
   2613 C   14                     (U.S.) VIZ MARK I MICROSONDE
   2614 C   15                     (U.S.) EEC COMPANY TYPE  23
   2615 C   16                     (AUSTRIA) ELIN
   2616 C   17                     (GERMANY) GRAW  G
   2617 C   18                     RESERVED
   2618 C   19          *          (GERMANY) GRAW  M60                    5
   2619 C   20          *          INDIAN MET. SERVICE TYPE  MK3          6
   2620 C   21          *          (S. KOREA) VIZ/JIN YANG MARK I MICROSONDE 7

Page 61          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2621 C   22          *          (JAPAN) MEISEI  RS2-80                 8
   2622 C   23                     (FRANCE) MENSURAL FMO  1950A
   2623 C   24                     (FRANCE) MENSURAL FMO  1945A
   2624 C   25                     (FRANCE) MENSURAL  MH73A
   2625 C   26                     (SWITZERLAND) METEOLABOR BASORA
   2626 C   27          *          (RUSSIA) AVK-MRZ                       9
   2627 C   28          *          (RUSSIA) METEORIT  MARZ2-1            10
   2628 C   29          *          (RUSSIA) METEORIT  MARZ2-2            11
   2629 C   30                     (JAPAN) OKI  RS2-80
   2630 C   31          *          (CANADA) VIZ/VALCOM TYPE A            12
   2631 C   32          *          (CHINA) SHANGHAI RADIO                13
   2632 C   33                     (U.K.) UK MET OFFICE  MK3    
   2633 C   34                     (CZECHOSLOVAKIA) VINOHRADY
   2634 C   35                     VAISALA  RS18
   2635 C   36                     VAISALA  RS21
   2636 C   37          *          VAISALA  RS80                         14
   2637 C   38                     (U.S.) VIZ LOCATE (LORAN-C)
   2638 C   39                     (GERMANY) SPRENGER  E076
   2639 C   40                     (GERMANY) SPRENGER  E084
   2640 C   41                     (GERMANY) SPRENGER  E085
   2641 C   42                     (GERMANY) SPRENGER  E086
   2642 C   43          *          (U.S.) AIR IS - 4A - 1680             15
   2643 C   44          *          (U.S.) AIR IS - 4A - 1680 X           15 
   2644 C   45          *          (U.S.) RS MSS                         16 
   2645 C   46                     (U.S.) AIR IS - 4A - 403
   2646 C   47          *          (JAPAN) MEISEI  RS2-91                17 
   2647 C   48                     (CANADA) VALCOM
   2648 C   49          *          (U.S.) VIZ MARK II                    18
   2649 C   50          *          (GERMANY) GRAW DFM-90                 19
   2650 C   51          *          (U.S.) NOAA / VIZ TYPE  B2            20
   2651 C   52          *          VAISALA  RS80/MICROARTS               21
   2652 C 53 TO 59                 RESERVED FOR ADDITIONAL SONDES
   2653 C   60          *          VAISALA  RS80/MICROCORA               22
   2654 C   61          *          VAISALA  RS80/DIGICORA  OR MARWIN     23
   2655 C   62          *          VAISALA  RS80/PCCORA                  24
   2656 C   63          *          VAISALA  RS80/STAR                    25
   2657 C   64                     (U.S.) ORBITAL SCI. CORP TYPE 909-11-xx
   2658 C   65                     (U.S.) VIZ/TRANSPONDER TYPE 1499-520
   2659 C 66 TO 70                 RESERVED FOR ADDITIONAL AUTOMATED SYSTEMS
   2660 C   71        (1999)       VAISALA RS90/DIGICORA OR MARWIN
   2661 C   72                     VAISALA RS90/PCCORA
   2662 C   73                     VAISALA RS90/AUTOSONDE
   2663 C   74                     VAISALA RS90/STAR
   2664 C 75 TO 89                 RESERVED FOR ADDITIONAL AUTOMATED SYSTEMS
   2665 C   90          *          UNKNOWN TYPE (Don't correct)          26
   2666 C   91                     PRESSURE ONLY
   2667 C   92          *          PRESSURE ONLY PLUS TRANSPONDER No corr 27
   2668 C   93                     PRESSURE ONLY PLUS RADAR REFLECTOR
   2669 C   94                     NO PRESSURE PLUS TRANSPONDER
   2670 C   95                     NO PRESSURE PLUS RADAR REFLECTOR
   2671 C   96                     DESCENDING
   2672 C 97 TO 254                RESERVED
   2673 C  255                     MISSING VALUE
   2674 C >255                     INVALID
   2675 C
   2676 C
   2677 C   KEY FOR LEVELS IN DATA (CORRECTION) TABLES:

Page 62          Source Listing                  RADT3
2017-04-18 11:07                                 radcor.f

   2678 C
   2679 C     1 - 1000 MB
   2680 C     2 -- 925 MB
   2681 C     3 -- 850 MB
   2682 C     4 -- 700 MB
   2683 C     5 -- 500 MB
   2684 C     6 -- 400 MB
   2685 C     7 -- 300 MB
   2686 C     8 -- 250 MB
   2687 C     9 -- 200 MB
   2688 C     A -- 150 MB
   2689 C     B -- 100 MB
   2690 C     C --  70 MB
   2691 C     D --  50 MB
   2692 C     E --  30 MB
   2693 C     F --  20 MB
   2694 C     G --  10 MB
   2695 C
   2696 C
   2697 C   THE RADIATION CORRECTION TABLES ARE BASED UPON
   2698 C   OBSERVED INCREMENTS FROM NWP ASSIMILATION.  THE ADJUSTMENTS
   2699 C   ARE TO MAKE ALL SONDE TYPES COMPARE WITH THE MEAN VAISALA
   2700 C   RS80 SONDE.
   2701 C
   2702 C
   2703 C   THE CUTOFF ANGLE AT EACH LEVEL CALCULATED USING THE RELATION:
   2704 C              CUTOFF ANGLE = -1.76459 * (Z**.40795) ,
   2705 C   WHERE Z IS A REFERENCE HEIGHT FOR THE LEVEL (IN KILOMETERS)
   2706 C   (SEE NMC OFFICE NOTE 306, TABLE 4 FOR LIST OF REFERENCE HEIGHTS.)
   2707 C
   2708 C
   2709 C ATTRIBUTES:
   2710 C   LANGUAGE: FORTRAN 90
   2711 C   MACHINE:  NCEP WCOSS
   2712 C
   2713 C$$$
   2714       SUBROUTINE RADT4(IRET)
   2715       PARAMETER (NST=999)
   2716 
   2717       REAL(8) BMISS
   2718 
   2719       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   2720      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   2721      &                 NEV, ISF(NST), NLVM, NLVW
   2722       COMMON /RADCOM/ HGT(16),TMP(16),DHT(16),DTP(16),JTYPE
   2723       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
   2724       COMMON /PMAND / PRES(16),KMIN,KMAX,INM(16)
   2725       COMMON /STN/     IS
   2726       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   2727 
   2728       REAL        TTAB(5,16,27),CUTOFF(16),
   2729      .            SOLAR(16),ANGLE(5),ALP(16),DTS(16),DHS(16),
   2730      .            USVIZA(5,16), USVIZB(5,16), USSDCP(5,16),
   2731      .            GRAW60(5,16), INDMK3(5,16), KORMK1(5,16),
   2732      .            MEIS80(5,16), RUSAVK(5,16), RUSZ21(5,16),
   2733      .            RUSZ22(5,16), CANVZA(5,16), CHINSR(5,16),
   2734      .            VARS80(5,16), AIRR80(5,16), USRSMS(5,16),

Page 63          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   2735      .            MEIS91(5,16), VIZMK2(5,16), GRAW90(5,16),
   2736      .            USVZB2(5,16), MICROA(5,16), MICORA(5,16),
   2737      .            DICORA(5,16), PCCORA(5,16), VASTAR(5,16),
   2738      .            UNKN90(5,16), UNKN09(5,16), TYPE92(5,16)
   2739       INTEGER     ITYPTT(255)
   2740       EQUIVALENCE (TTAB(1,1, 1),UNKN09(1,1)),(TTAB(1,1, 2),USVIZA(1,1)),
   2741      .            (TTAB(1,1, 3),USVIZB(1,1)),(TTAB(1,1, 4),USSDCP(1,1)),
   2742      .            (TTAB(1,1, 5),GRAW60(1,1)),(TTAB(1,1, 6),INDMK3(1,1)),
   2743      .            (TTAB(1,1, 7),KORMK1(1,1)),(TTAB(1,1, 8),MEIS80(1,1)),
   2744      .            (TTAB(1,1, 9),RUSAVK(1,1)),(TTAB(1,1,10),RUSZ21(1,1)),
   2745      .            (TTAB(1,1,11),RUSZ22(1,1)),(TTAB(1,1,12),CANVZA(1,1)),
   2746      .            (TTAB(1,1,13),CHINSR(1,1)),(TTAB(1,1,14),VARS80(1,1)),
   2747      .            (TTAB(1,1,15),AIRR80(1,1)),(TTAB(1,1,16),USRSMS(1,1)),
   2748      .            (TTAB(1,1,17),MEIS91(1,1)),(TTAB(1,1,18),VIZMK2(1,1)),
   2749      .            (TTAB(1,1,19),GRAW90(1,1)),(TTAB(1,1,20),USVZB2(1,1)),
   2750      .            (TTAB(1,1,21),MICROA(1,1)),(TTAB(1,1,22),MICORA(1,1)),
   2751      .            (TTAB(1,1,23),DICORA(1,1)),(TTAB(1,1,24),PCCORA(1,1)),
   2752      .            (TTAB(1,1,25),VASTAR(1,1)),(TTAB(1,1,26),UNKN90(1,1)),
   2753      .            (TTAB(1,1,27),TYPE92(1,1))
   2754       LOGICAL     HGTTBL
   2755       CHARACTER*8 SID
   2756 
   2757       DATA  ANGLE  / -90, -10, 15, 30, 60/
   2758       DATA  CUTOFF / -.73, -1.58, -2.06, -2.77,
   2759      .              -3.56, -3.95, -4.36, -4.58,
   2760      .              -4.83, -5.12, -5.49, -5.79,
   2761      .              -6.06, -6.43, -6.72, -7.17/
   2762 
   2763 C  ITYPTT ASSIGNS PROPER TEMPERATURE CORRECTION TABLE TO INST. TYPES
   2764 C  -----------------------------------------------------------------
   2765 
   2766 C  ===> JTYPE:      1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
   2767 
   2768       DATA  ITYPTT/-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 3, 4, 0, 0, 0,
   2769 
   2770 C  ===> JTYPE:     16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
   2771 
   2772      $              0, 0,-1, 5, 6, 7, 8, 0, 0, 0, 0, 9,10,11, 0,
   2773 
   2774 C  ===> JTYPE:     31 32 33 34 35 36 37 38 39 40 41 42 43 44 45
   2775 
   2776      $             12,13, 0, 0, 0, 0,14, 0, 0, 0, 0, 0,15,15,16,
   2777 
   2778 C  ===> JTYPE:     46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
   2779 
   2780      $              0,17, 0,18,19,20,21,-1,-1,-1,-1,-1,-1,-1,22,
   2781 
   2782 C  ===> JTYPE:     61 62 63 64 65 66-89 90-96 97 98 99 100-255
   2783 
   2784      $             23,24,25, 0, 0,24*-1, 7*0, -1,-1,-1, 156*0/
   2785 
   2786 
   2787 C  TEMPERATURE CORRECTION TABLES ( * 10 K) FOR RADIATIVE EFFECTS
   2788 C  -------------------------------------------------------------
   2789 
   2790 C          UNKNOWN TYPE                        
   2791 C     ====> JTYPE =  9  --  ITAB = 1  <====

Page 64          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   2792  
   2793       DATA  UNKN09  /
   2794 C       NITE   -10    15    30    60  Solar Angle
   2795 C        ___   ___   ___   ___   ___
   2796 C LEVEL
   2797      1  -5.8, -7.1,-14.9,-13.6, -4.7,
   2798      2  -2.9,  -.7, -8.2, -5.1,-11.1,
   2799      3   1.0, -1.1, -2.3,   .0, -1.3,
   2800      4    .3,  1.5,  -.9,   .3,  2.4,
   2801      5   -.2,  3.7,  1.4,  1.8,  3.7,
   2802      6   -.5,  3.2,  2.2,  1.2,  3.2,
   2803      7   1.3,  3.0,  5.0,  4.5,  1.3,
   2804      8   2.3,  5.6,  6.3,  6.3,  5.2,
   2805      9    .1,  2.4,   .8,  1.5,  1.7,
   2806      A   -.1,  1.1, -3.4, -3.6, -2.4,
   2807      B   -.3,  1.8, -5.6, -5.6, -1.8,
   2808      C  -3.6, -1.1,   .5,   .0, -8.0,
   2809      D  -2.3,  2.6,  7.3,  6.2,   .5,
   2810      E    .0,   .4, 13.8, 15.0, 11.3,
   2811      F   -.4,  3.4, 14.8, 14.8, 14.8,
   2812      G -13.4,  -.6, -7.7, -5.7, -5.7/
   2813  
   2814  
   2815 C          (U.S.) NOAA / VIZ TYPE  A           
   2816 C     ====> JTYPE = 10  --  ITAB = 2  <====
   2817  
   2818       DATA  USVIZA  /
   2819 C       NITE   -10    15    30    60  Solar Angle
   2820 C        ___   ___   ___   ___   ___
   2821 C LEVEL
   2822      1  -8.0,-11.6,-14.3,-11.6,   .6,
   2823      2  -4.0, -8.5, -9.1, -3.3,  3.0,
   2824      3  -1.9,  -.4, -3.6,  2.3, -4.5,
   2825      4  -2.1,  3.4,  -.2,  1.8, -1.1,
   2826      5  -2.6,   .0, -2.2,  1.4,  1.7,
   2827      6  -3.9,  1.5,  -.2,   .8, -1.8,
   2828      7  -1.1,  4.0,  2.8,  3.1,  1.1,
   2829      8    .6,  6.2,  3.6,  4.1,  2.0,
   2830      9  -1.7,   .6, -5.0,  4.8, -1.1,
   2831      A  -5.6, -3.5,-10.8,  5.7, -1.2,
   2832      B  -4.7, -2.7, -7.6,  2.8, 14.1,
   2833      C  -4.2, -1.6,  3.3,  9.4, 13.7,
   2834      D   2.1,  6.3, 18.9, 14.0, 21.9,
   2835      E   7.6,  4.8, 31.3, 22.4, 16.4,
   2836      F  10.5, 12.1, 31.2, 18.0, 18.3,
   2837      G  -1.9, -8.9, 21.7, -2.3,  9.5/
   2838  
   2839  
   2840 C          (U.S.) NOAA / VIZ TYPE  B           
   2841 C     ====> JTYPE = 11  --  ITAB = 3  <====
   2842  
   2843       DATA  USVIZB  /
   2844 C       NITE   -10    15    30    60  Solar Angle
   2845 C        ___   ___   ___   ___   ___
   2846 C LEVEL
   2847      1 -10.5, -3.7, -2.7,  3.4,  1.5,
   2848      2  -6.6, -4.7, -2.1,  4.0,  2.5,

Page 65          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   2849      3  -2.8,  -.4,  -.1,  3.7,  -.4,
   2850      4  -3.0, -1.3,  -.2,   .9,  1.0,
   2851      5  -3.9,  -.7,  1.0,  1.9, -2.1,
   2852      6  -4.0,   .6,  1.7,  1.5, -2.3,
   2853      7  -2.2,  2.0,  3.8,  2.5,  4.8,
   2854      8  -3.0,  2.5,  5.1,  3.4,  3.8,
   2855      9  -5.7,   .7,  3.9,  5.4,  1.4,
   2856      A -10.7,  1.4,  4.7,  5.8,  2.3,
   2857      B  -6.8,  1.4,  9.6, 13.2, 10.3,
   2858      C  -4.0,  -.6,  4.3, 12.4, 16.6,
   2859      D   1.4,   .3,  9.6, 15.8, 21.6,
   2860      E  -1.6,  1.2, 16.5, 22.6, 20.8,
   2861      F  -5.5,  5.3, 17.4, 22.5, 20.4,
   2862      G -17.4, -1.8, 13.3, 15.9,  6.8/
   2863  
   2864  
   2865 C          (U.S.) NOAA / SPACE DATA CORP.      
   2866 C     ====> JTYPE = 12  --  ITAB = 4  <====
   2867  
   2868       DATA  USSDCP  /
   2869 C       NITE   -10    15    30    60  Solar Angle
   2870 C        ___   ___   ___   ___   ___
   2871 C LEVEL
   2872      1 -13.8,-17.0, -8.2, -9.2, -9.2,
   2873      2  -8.1,  2.8,  -.2,  6.6,  6.6,
   2874      3  -4.1,  3.4,  4.4,  4.4,  4.4,
   2875      4  -2.1,  1.1,  -.6,   .4,   .4,
   2876      5  -2.1, -1.9,  1.4,  -.2,  -.2,
   2877      6  -4.6, -1.7,  -.4,  1.8,  1.8,
   2878      7  -4.3,  1.3,  2.9,  2.7,  2.7,
   2879      8  -3.8,  1.0,  2.0,  3.4,  3.4,
   2880      9  -6.3,  1.8,  8.5,  7.9,  7.9,
   2881      A  -6.2,  5.2, 14.2, 16.7, 16.7,
   2882      B  -5.5,  5.8, 11.4, 13.4, 13.4,
   2883      C   1.4,  2.4,  3.8,  4.8,  4.8,
   2884      D   4.8,  3.2,   .5, -1.3, -1.3,
   2885      E   7.9,  5.1,  3.9,  9.0,  9.0,
   2886      F  17.6,  4.6,  2.8, 13.7, 13.7,
   2887      G   5.8, 18.8, 54.2, 17.3, 17.3/
   2888  
   2889  
   2890 C          (GERMANY) GRAW  M60 (one site)      
   2891 C     ====> JTYPE = 19  --  ITAB = 5  <====
   2892  
   2893       DATA  GRAW60  /
   2894 C       NITE   -10    15    30    60  Solar Angle
   2895 C        ___   ___   ___   ___   ___
   2896 C LEVEL
   2897      1  10.3,  3.2,  6.2, -7.0, 20.0,
   2898      2   -.8,  2.8,  1.3,  -.3,  1.8,
   2899      3   -.6,  9.4,  1.5,  3.2,   .7,
   2900      4   -.3,  5.2,   .7,  5.7,-10.3,
   2901      5   -.3, -2.1,   .7,  4.8, -1.7,
   2902      6  -1.1, -5.7,  -.5,  4.5,  -.3,
   2903      7  -5.0,-11.3, -2.4,-10.1, -3.9,
   2904      8  -4.0, -5.9,  -.4,  3.3,  1.8,
   2905      9   2.9,  2.5, 12.3, 11.4,  8.0,

Page 66          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   2906      A   3.8,  6.7,  9.5, 10.4, 15.2,
   2907      B   8.2,  7.3,  8.8,  7.4, 11.6,
   2908      C   4.6,  7.0,  6.3,  6.0,  3.2,
   2909      D    .7,  2.6,  1.5,   .2, -6.1,
   2910      E  -3.7, -4.6, -7.5, -3.4, -4.9,
   2911      F  -7.0, -1.0, -8.9,-22.6, -2.7,
   2912      G  -5.9,-15.1,-10.1, 20.6, 10.3/
   2913  
   2914  
   2915 C          INDIAN MET. SERVICE TYPE  MK3       
   2916 C     ====> JTYPE = 20  --  ITAB = 6  <====
   2917  
   2918       DATA  INDMK3  /
   2919 C       NITE   -10    15    30    60  Solar Angle
   2920 C        ___   ___   ___   ___   ___
   2921 C LEVEL
   2922      1 -16.8,-14.7, -6.6,  1.9,  1.9,
   2923      2 -10.4, -9.3, -6.1, -7.1, -7.1,
   2924      3   1.5,  1.6,  4.0,  3.0,  3.0,
   2925      4   5.4,  4.9,  8.2, 11.9, 11.9,
   2926      5  -6.8, -1.2,  2.5,  6.7,  6.7,
   2927      6  -7.4,  -.8,  6.4,  8.7,  8.7,
   2928      7  -7.6,  1.6,  8.3, 21.1, 21.1,
   2929      8  -7.6,  3.2, 11.7, 25.6, 25.6,
   2930      9 -15.5, -4.5,  6.4, 17.9, 17.9,
   2931      A -22.0, -8.9,  2.6, 13.1, 13.1,
   2932      B -13.4, -2.2,  5.9,  4.5,  4.5,
   2933      C  -6.2,  1.1,  3.2,  3.2,  3.2,
   2934      D   -.3, 11.8, 15.3, 15.3, 15.3,
   2935      E   -.9, 13.1, 14.1, 14.1, 14.1,
   2936      F  -1.4,  7.4,  8.7,  8.7,  8.7,
   2937      G   -.5, -3.0,   .6,   .6,   .6/
   2938  
   2939  
   2940 C          (S. KOREA) VIZ/JIN YANG MARK I MICRO
   2941 C     ====> JTYPE = 21  --  ITAB = 7  <====
   2942  
   2943       DATA  KORMK1  /
   2944 C       NITE   -10    15    30    60  Solar Angle
   2945 C        ___   ___   ___   ___   ___
   2946 C LEVEL
   2947      1  -5.5, -7.2, -7.2,  -.6,  -.6,
   2948      2  -4.8,  6.1,  6.1, -2.2, -2.2,
   2949      3  -6.9,  4.3,  4.3, -4.6, -4.6,
   2950      4  -5.5,  1.2,  1.2, -3.0, -3.0,
   2951      5  -3.8,  1.4,  1.4,   .4,   .4,
   2952      6  -1.6,  4.5,  4.5,  3.7,  3.7,
   2953      7   3.1, 15.3, 11.0,  9.5,  9.5,
   2954      8   4.1, 21.2, 13.2,  9.8,  9.8,
   2955      9  -1.6, 15.1, 15.1,  5.3,  5.3,
   2956      A  -8.2,  2.8,  8.1,  3.4,  3.4,
   2957      B  -8.7,  -.6, -1.0,  7.3,  7.3,
   2958      C  -4.6,  6.5,  5.1,  5.8,  5.8,
   2959      D   -.9,  2.5,  9.4, 11.1, 11.1,
   2960      E   6.8, 19.6, 14.7, 17.3, 17.3,
   2961      F   9.9, 26.6, 26.0, 20.6, 20.6,
   2962      G   2.1, 23.7, 15.3, 19.3, 19.4/

Page 67          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   2963  
   2964  
   2965 C          (JAPAN) MEISEI  RS2-80              
   2966 C     ====> JTYPE = 22  --  ITAB = 8  <====
   2967  
   2968       DATA  MEIS80  /
   2969 C       NITE   -10    15    30    60  Solar Angle
   2970 C        ___   ___   ___   ___   ___
   2971 C LEVEL
   2972      1 -19.3,-24.5,-25.5,-20.3, -4.5,
   2973      2 -16.3, 12.7,-10.3,-10.2, -6.8,
   2974      3 -10.1,  3.6, -6.3, -6.1,   .9,
   2975      4  -7.5,  5.8, -7.3, -3.6,  -.7,
   2976      5  -3.2, -2.3,  1.8, -1.4, -2.6,
   2977      6  -1.8,   .7,  1.6,  1.9, -2.3,
   2978      7  -1.3,-19.2,  2.1,  1.6,  1.4,
   2979      8  -1.6, -9.0,  6.0,  2.9, -1.8,
   2980      9  -6.4, -2.8,  2.8,   .0,  -.2,
   2981      A -10.9,  2.4,   .2,  -.9, -5.2,
   2982      B  -6.6,  1.0,  6.8,  8.8,  4.3,
   2983      C  -6.9,  1.8,  6.8,  5.5,  5.0,
   2984      D   6.0, -5.0, 19.2, 12.9,  8.7,
   2985      E  12.2, -3.9, 17.7, 11.8,  8.1,
   2986      F   8.5, -2.5, 11.0, 11.8,  2.2,
   2987      G -11.9,-12.4, 27.1, 22.7, -6.2/
   2988  
   2989  
   2990 C          (RUSSIA) AVK-MRZ                    
   2991 C     ====> JTYPE = 27  --  ITAB = 9  <====
   2992  
   2993       DATA  RUSAVK  /
   2994 C       NITE   -10    15    30    60  Solar Angle
   2995 C        ___   ___   ___   ___   ___
   2996 C LEVEL
   2997      1   9.9,  8.8, 12.7, 10.7, 10.7,
   2998      2   4.9,  3.3,  4.9,  5.1,  5.1,
   2999      3   5.5,  5.1,  3.6,  2.6,  2.6,
   3000      4   1.1,  1.3,  1.4,  -.3,  -.3,
   3001      5   1.5,  2.9,  5.9,  5.2,  2.2,
   3002      6   3.4,  4.3,  7.9,  8.2,  9.2,
   3003      7   4.7,  5.5,  9.7,  9.6,  7.1,
   3004      8   3.5,  4.2,  8.8,  9.7,  7.0,
   3005      9   2.7,  5.5, 12.5, 15.6, 15.9,
   3006      A   3.2,  9.8, 16.2, 17.3, 26.1,
   3007      B   4.1,  9.7, 16.1, 17.5, 23.4,
   3008      C    .8, 10.4, 15.6, 13.2, 13.2,
   3009      D  -4.3,  5.8, 10.7,  7.9,  7.9,
   3010      E  -4.9,  5.5,  9.9,  7.4,  7.4,
   3011      F  -3.2,  4.0,  7.5,  3.5,  3.5,
   3012      G  -6.7,  5.9, 10.8,  5.7,  5.7/
   3013  
   3014  
   3015 C          (RUSSIA) METEORIT  MARZ2-1          
   3016 C     ====> JTYPE = 28  --  ITAB = 10 <====
   3017  
   3018       DATA  RUSZ21  /
   3019 C       NITE   -10    15    30    60  Solar Angle

Page 68          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3020 C        ___   ___   ___   ___   ___
   3021 C LEVEL
   3022      1  10.8,   .2, 22.5,  -.8,  -.8,
   3023      2   5.6,  3.9,  8.8,  6.0,  6.0,
   3024      3   5.3,  5.1,  6.0,  4.1,  4.1,
   3025      4   3.3,  3.0,  1.3,  2.7,  2.7,
   3026      5   4.0,  6.0,  5.9,  5.1,  5.1,
   3027      6   5.7,  7.1,  7.8,  6.6,  6.6,
   3028      7   5.6,  6.6,  8.8,  6.1,  6.1,
   3029      8   2.7,  5.0,  9.1,  6.1,  6.1,
   3030      9   1.6,  5.0, 14.0, 17.7, 17.7,
   3031      A   2.8, 10.5, 16.0, 20.1, 20.1,
   3032      B   5.5, 10.3, 14.2, 20.5, 20.5,
   3033      C   4.0, 10.9, 14.7, 18.0, 18.0,
   3034      D   -.9,  6.0, 10.8, 10.8, 10.8,
   3035      E  -4.1,  3.7, 11.0,  7.0,  7.0,
   3036      F  -3.8,  3.9, 11.6,  4.1,  4.1,
   3037      G   2.7,  6.9, 15.0,  1.9,  1.9/
   3038  
   3039  
   3040 C          (RUSSIA) METEORIT  MARZ2-2          
   3041 C     ====> JTYPE = 29  --  ITAB = 11 <====
   3042  
   3043       DATA  RUSZ22  /
   3044 C       NITE   -10    15    30    60  Solar Angle
   3045 C        ___   ___   ___   ___   ___
   3046 C LEVEL
   3047      1   9.2,  8.7, 11.0,  8.1,  8.1,
   3048      2  10.3,  4.2,  3.7,  6.0,  6.0,
   3049      3   8.0,  6.1,  6.0,  3.2,  3.2,
   3050      4   4.6,  4.5,  5.4,  2.6,  2.6,
   3051      5  -1.1,  3.4,  6.9,  8.8,  8.8,
   3052      6  -3.5,  1.4,  5.7, 11.2, 11.2,
   3053      7  -7.3, -3.1, -1.3, 10.7, 10.7,
   3054      8  -3.2,  2.0,  4.2, 10.7, 10.7,
   3055      9   3.3, 11.4, 17.7, 15.3, 15.3,
   3056      A   5.4, 11.7, 16.5, 19.5, 19.5,
   3057      B   4.8,  9.8, 14.9, 17.4, 17.4,
   3058      C   2.7, 11.9, 16.4, 14.7, 14.7,
   3059      D  -4.1,  7.5, 12.8, 10.8, 10.8,
   3060      E  -7.7, 10.2, 12.0, 10.6, 10.6,
   3061      F  -3.9,  9.2,  8.8,  2.3,  2.3,
   3062      G -17.6,  9.4,  7.7,  1.8,  1.8/
   3063  
   3064  
   3065 C          (CANADA) VIZ/VALCOM TYPE A          
   3066 C     ====> JTYPE = 31  --  ITAB = 12 <====
   3067  
   3068       DATA  CANVZA  /
   3069 C       NITE   -10    15    30    60  Solar Angle
   3070 C        ___   ___   ___   ___   ___
   3071 C LEVEL
   3072      1  22.7, 10.5, 13.3, 30.0, 30.0,
   3073      2   9.4,   .9,  7.4, 12.6, 12.6,
   3074      3   8.0,  2.2,  6.2, 13.5, 13.5,
   3075      4   1.1, -1.5, -2.9,  1.5,  1.5,
   3076      5    .4,  1.6,  2.0,  3.0,  3.0,

Page 69          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3077      6  -2.7,  1.1,   .0,  1.8,  1.8,
   3078      7   1.1, -1.7,  2.6,  3.2,  3.2,
   3079      8    .2, -1.2,   .7, -1.4, -1.4,
   3080      9   2.7,  2.4,  7.2,  7.9,  7.9,
   3081      A  -3.4,  1.0,  7.3,  2.7,  2.7,
   3082      B   4.7,  6.1, 11.2, 16.0, 16.0,
   3083      C   2.4,  6.1,  8.8,  5.8,  5.8,
   3084      D   3.4,  1.5,  3.6,  -.8,  -.8,
   3085      E   7.1,  2.7,  1.5,  2.9,  2.9,
   3086      F   7.8, -1.0, -5.1, -3.9, -3.9,
   3087      G   6.2, -2.2, -4.2,  1.6,  1.6/
   3088  
   3089  
   3090 C          (CHINA) SHANGHAI RADIO              
   3091 C     ====> JTYPE = 32  --  ITAB = 13 <====
   3092  
   3093       DATA  CHINSR  /
   3094 C       NITE   -10    15    30    60  Solar Angle
   3095 C        ___   ___   ___   ___   ___
   3096 C LEVEL
   3097      1   -.3,  4.0, -3.7, -9.5, -9.5,
   3098      2   -.2, -1.7, -7.8, -7.8, -7.8,
   3099      3   3.3,  -.2, -4.5, -3.4, -3.4,
   3100      4   2.7,  -.1,  -.7,   .5,   .5,
   3101      5   4.0,  5.6,  7.6,  9.8,  9.8,
   3102      6   4.8,  9.9, 13.3, 14.6, 14.6,
   3103      7   7.9, 10.9, 13.1, 15.2, 15.2,
   3104      8   8.3,  9.8, 13.9, 16.3, 16.3,
   3105      9   7.9,  5.6, 10.3,  9.0,  9.0,
   3106      A   9.2,  8.8, 11.1, 10.3, 10.3,
   3107      B   3.2,  4.8,  6.3, 11.2, 11.2,
   3108      C  -7.0, -2.1, -8.1, -4.1, -4.1,
   3109      D  -6.1, -1.8, -7.1, -4.9, -4.9,
   3110      E  -2.8,  2.4,  1.9,   .9,   .9,
   3111      F  -3.1,  6.2,  6.5, -1.8, -1.8,
   3112      G -15.8, -9.5,-15.3,-23.8,-23.8/
   3113  
   3114  
   3115 C          VAISALA  RS80                       
   3116 C     ====> JTYPE = 37  --  ITAB = 14 <====
   3117  
   3118       DATA  VARS80  /
   3119 C       NITE   -10    15    30    60  Solar Angle
   3120 C        ___   ___   ___   ___   ___
   3121 C LEVEL
   3122      1  -8.9,-14.7, -3.9, -3.2, -2.3,
   3123      2  -2.0, -3.3, -1.9, -1.2,   .3,
   3124      3  -1.7, -1.3, -2.0, -1.5,  1.8,
   3125      4    .7,  1.0,   .5,   .4,  2.8,
   3126      5   -.4,   .7,   .9,   .3,  2.1,
   3127      6   -.8,  1.3,   .8,   .2,  2.5,
   3128      7  -1.1,  -.3,   .7,  1.6,   .6,
   3129      8   -.8,   .2,   .4,  1.2,  1.3,
   3130      9  -2.1, -2.5, -2.1, -2.6,  1.1,
   3131      A  -2.3, -2.9, -3.9, -3.4, -1.9,
   3132      B  -5.6, -7.2, -7.7, -5.4, -4.6,
   3133      C  -2.1,  -.3, -1.8, -2.1, -3.6,

Page 70          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3134      D   1.3,   .4,  2.9,  3.4,   .8,
   3135      E   4.1,   .9,  1.1,  5.2,  7.2,
   3136      F   7.7,  2.7,  7.6, 10.7, 19.1,
   3137      G   4.0,  4.5,  -.6,   .4, 13.5/
   3138  
   3139  
   3140 C          (U.S.) AIR IS - 4A - 1680           
   3141 C          (U.S.) AIR IS - 4A - 1680 X         
   3142 C     ====> JTYPE = 43  --  ITAB = 15 <====
   3143  
   3144       DATA  AIRR80  /
   3145 C       NITE   -10    15    30    60  Solar Angle
   3146 C        ___   ___   ___   ___   ___
   3147 C LEVEL
   3148      1   3.4, 15.5,-11.5,   .0,  4.8,
   3149      2  -6.0, 18.1, -6.4, -5.5,   .4,
   3150      3   -.6, 15.7,   .1,   .4,   .2,
   3151      4  -2.6, 12.8,  6.1,  3.1, -1.4,
   3152      5    .1,  7.5,  8.0,  8.6,  2.2,
   3153      6   -.6,  4.9,  9.2, 10.9,  2.9,
   3154      7    .8, -4.6,   .8, 15.3,  3.3,
   3155      8    .1,  3.7,  9.5, 18.9,  4.4,
   3156      9  -4.7,  7.6, 16.8, 18.0,  6.7,
   3157      A -10.3,  6.9,  9.3, 17.1,  2.2,
   3158      B  -3.9,  3.7, 14.5, 25.5, 27.8,
   3159      C  -6.4,  6.1, 21.2, 29.5, 10.1,
   3160      D  10.6,  8.7, 25.9, 37.5, 36.6,
   3161      E  19.7, 17.0, 21.6, 45.4, 27.2,
   3162      F  32.8, 12.3, 15.3, 44.6, 51.7,
   3163      G   2.7,  2.7,  6.2, 67.8, 67.8/
   3164  
   3165  
   3166 C          (U.S.) RS MSS                       
   3167 C     ====> JTYPE = 45  --  ITAB = 16 <====
   3168  
   3169       DATA  USRSMS  /
   3170 C       NITE   -10    15    30    60  Solar Angle
   3171 C        ___   ___   ___   ___   ___
   3172 C LEVEL
   3173      1  -9.6,-13.9, -9.1,   .3,  2.8,
   3174      2  -7.0, -5.5,   .0,  4.6,  3.9,
   3175      3  -3.7, -2.9,  -.2,   .9,  1.5,
   3176      4   -.2, -1.1,  -.9,   .4,  1.3,
   3177      5  -2.9, -1.8,   .0,   .9, -2.3,
   3178      6  -5.3, -3.3,  -.1,  -.6, -3.0,
   3179      7  -4.1, -1.7,  3.4,  -.2, -1.7,
   3180      8  -6.0, -1.9,  3.1,  1.4, -2.7,
   3181      9 -10.6, -5.9,  -.7, -3.7, -4.5,
   3182      A -13.7, -6.9,  -.6, -6.1, -5.6,
   3183      B  -9.0, -3.7,   .1,  -.8,   .7,
   3184      C   -.6, -2.6, -4.5,  4.6,  9.8,
   3185      D   5.3,  2.7,  2.8, 12.0, 11.9,
   3186      E  10.4,  7.4,  7.6, 18.7, 11.5,
   3187      F  10.3, 12.9, 11.6, 18.7, 12.8,
   3188      G   7.6, 24.5, 49.6,  6.4,  7.7/
   3189  
   3190  

Page 71          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3191 C          (JAPAN) MEISEI  RS2-91              
   3192 C     ====> JTYPE = 47  --  ITAB = 17 <====
   3193  
   3194       DATA  MEIS91  /
   3195 C       NITE   -10    15    30    60  Solar Angle
   3196 C        ___   ___   ___   ___   ___
   3197 C LEVEL
   3198      1 -10.8,  -.7,  -.7, -5.3, -6.0,
   3199      2  -9.9,  5.5,  5.5, -4.4, -7.2,
   3200      3  -4.7,  6.8,  6.8, -4.7, -4.7,
   3201      4  -4.7, -2.9, -2.9, -4.1,   .2,
   3202      5  -1.5, -1.3, -1.3, -1.3, -2.1,
   3203      6   1.9,   .5,   .5,  2.4,   .9,
   3204      7   5.3,  4.4,  4.4,  5.8,  4.6,
   3205      8   5.2,  8.7,  8.7,  5.2,  3.8,
   3206      9    .8,  6.9,  6.9,   .3,  2.9,
   3207      A  -7.3,  -.7,  -.7, -1.4, -4.9,
   3208      B  -7.5, -3.6, -3.6,  2.0,  8.5,
   3209      C -10.5, -5.9, -5.9, -5.3,  2.1,
   3210      D  -2.9,  -.3,  -.3,  2.1,  3.0,
   3211      E   3.6,  5.0,  5.0,  5.0,  2.8,
   3212      F   1.8,  7.8,  7.8,  3.2,  1.4,
   3213      G -11.0,  6.9,  6.9,  -.4,  1.8/
   3214  
   3215  
   3216 C          (U.S.) VIZ MARK II                  
   3217 C     ====> JTYPE = 49  --  ITAB = 18 <====
   3218  
   3219       DATA  VIZMK2  /
   3220 C       NITE   -10    15    30    60  Solar Angle
   3221 C        ___   ___   ___   ___   ___
   3222 C LEVEL
   3223      1  -1.0, -1.0, -1.0, -1.0, -1.0, !1000
   3224      2  -1.0, -1.0, -1.0, -1.0, -1.0, ! 925
   3225      3  -1.0, -1.0, -1.0, -1.0, -1.0, ! 850
   3226      4  -1.0, -1.0, -1.0, -1.0, -1.0, ! 700
   3227      5  -3.0, -3.0, -3.0, -3.0, -3.0, ! 500
   3228      6  -3.0, -3.0, -3.0, -3.0, -3.0, ! 400
   3229      7  -3.0, -3.0, -3.0, -3.0, -3.0, ! 300
   3230      8  -3.0, -3.0,  3.0,  4.0,  5.0, ! 250
   3231      9  -3.0, -3.0,  3.0,  4.0,  5.0, ! 200
   3232      A  -3.0, -3.0,  5.0,  7.0,  6.0, ! 150
   3233      B  -3.0, -3.0,  5.0,  7.0,  6.0, ! 100
   3234      C  -4.0, -3.0,  7.0,  9.0,  8.0, !  70
   3235      D  -6.0, -4.0,  8.0, 10.0,  9.0, !  50
   3236      E  -8.0, -6.0,  9.0, 11.0, 10.0, !  30
   3237      F -12.0,-10.0,  9.0, 12.0, 10.0, !  20
   3238      G -24.0,-20.0, 11.0, 13.0, 12.0/ !  10
   3239 C  Table above if from UK Met data for summer:
   3240 C  1 April to 30 September.
   3241 
   3242 
   3243 C     DATA  VIZMK2  /
   3244 C       NITE   -10    15    30    60  Solar Angle
   3245 C        ___   ___   ___   ___   ___
   3246 C LEVEL
   3247 C    1   -.2,   .2, -2.8, -3.3,-16.7,

Page 72          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3248 C    2  -1.6,  1.5, -3.2, -1.8, -5.6,
   3249 C    3  -1.7,  -.1, -1.4,   .3,   .5,
   3250 C    4  -1.9, -2.6, -1.1,   .2,   .4,
   3251 C    5  -1.6,   .0,  1.0,  1.0,  3.6,
   3252 C    6  -1.4,   .1,  1.4,  2.0,  2.1,
   3253 C    7    .1,  3.8,  4.2,  4.9,  3.6,
   3254 C    8  -1.0,  2.6,  3.8,  5.1,  4.8,
   3255 C    9  -3.6,   .4,  2.4,  1.2,  6.3,
   3256 C    A  -4.8,   .1,  3.5,  2.3,  9.8,
   3257 C    B  -3.4,  3.0,  6.8,  6.2, 13.3,
   3258 C    C  -2.9,  2.8,  4.1,  6.0,  7.2,
   3259 C    D  -1.7,  2.6,  5.3,  9.0,  6.9,
   3260 C    E  -2.0,  5.6, 12.0, 15.5, 14.5,
   3261 C    F  -6.4,  2.9, 12.0, 17.7, 25.6,
   3262 C    G -10.2,  9.6, 19.7, 13.6, 13.6/
   3263  
   3264  
   3265 C          (GERMANY) GRAW DFM-90               
   3266 C     ====> JTYPE = 50  --  ITAB = 19 <====
   3267  
   3268       DATA  GRAW90  /
   3269 C       NITE   -10    15    30    60  Solar Angle
   3270 C        ___   ___   ___   ___   ___
   3271 C LEVEL
   3272      1  12.6, 12.5, 11.3, -6.7,-13.7,
   3273      2    .7,  4.2,  4.0,  6.2,  -.4,
   3274      3   -.1,  2.7,  2.4,  4.4,  5.8,
   3275      4  -2.5,  1.6,  1.4,  1.4, -1.3,
   3276      5   -.8,  2.2,  4.2,  4.7,  6.9,
   3277      6   -.4,  4.4,  5.6,  8.4, 11.0,
   3278      7   2.3,  9.3, 10.9, 10.5,  9.7,
   3279      8   2.6,  9.7, 10.4,  9.5,  7.2,
   3280      9   3.7,  5.9,  9.0,  8.6,  7.0,
   3281      A   3.0,  5.9, 10.7,  9.2,  9.2,
   3282      B   5.1,  5.8, 12.0, 12.0, 12.0,
   3283      C   7.4, 11.2, 11.4,  9.7,  9.7,
   3284      D   3.3, 11.3,  7.5,  4.2,  4.2,
   3285      E   2.0, 19.4, 10.5,  4.7,  4.7,
   3286      F  -6.5, 19.2, -3.0, -6.5, -6.5,
   3287      G   1.3, 28.6,  6.3, -8.1, -8.1/
   3288  
   3289  
   3290 C          (U.S.) NOAA / VIZ TYPE  B2          
   3291 C     ====> JTYPE = 51  --  ITAB = 20 <====
   3292  
   3293       DATA  USVZB2  /
   3294 C       NITE   -10    15    30    60  Solar Angle
   3295 C        ___   ___   ___   ___   ___
   3296 C LEVEL
   3297      1   -.2, -4.5, -6.4,-14.1, -2.1,
   3298      2   -.4, -3.6, -4.2, -5.7, -3.5,
   3299      3  -1.0, -2.6, -3.1,   .3, -7.0,
   3300      4  -3.5, -3.1, -3.2, -1.8, -4.5,
   3301      5  -2.0,  -.1,   .5,   .3,   .4,
   3302      6  -1.6,   .4,  2.3,  1.4,  6.1,
   3303      7  -1.2,  2.8,  3.5,  3.9,  2.6,
   3304      8    .1,  3.4,  5.5,  3.8,  7.4,

Page 73          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3305      9  -1.5,  -.3,  3.7,  7.4,  9.4,
   3306      A  -2.4,   .2,  6.7,  8.5, 18.6,
   3307      B   -.6,  2.2, 10.1, 13.6, 23.4,
   3308      C  -7.6, -2.4,  4.4,  8.7,  8.4,
   3309      D  -7.6, -1.6,  5.1,  5.6, 10.8,
   3310      E  -9.0, -1.4,  7.3, 10.4, 10.8,
   3311      F  -6.7,  1.6,  9.7,  8.8, 11.8,
   3312      G  -5.5,  8.7, 12.9,  7.9,  7.9/
   3313  
   3314  
   3315 C          VAISALA  RS80/MICROARTS             
   3316 C     ====> JTYPE = 52  --  ITAB = 21 <====
   3317  
   3318       DATA  MICROA  /
   3319 C       NITE   -10    15    30    60  Solar Angle
   3320 C        ___   ___   ___   ___   ___
   3321 C LEVEL
   3322      1  -6.6, -2.0, -3.8,  3.6,  -.4,
   3323      2  -3.7, -6.4, -6.2,   .1, -2.2,
   3324      3  -1.5, -4.9, -5.9,  -.4, -4.2,
   3325      4  -1.9, -4.4, -5.7, -2.6, -2.9,
   3326      5  -2.2, -2.5, -3.1, -3.5, -7.6,
   3327      6  -1.9, -1.7, -2.0, -3.7, -7.8,
   3328      7  -1.5,  -.8, -1.8, -4.2, -3.9,
   3329      8  -1.7,   .1, -2.1, -5.1, -5.6,
   3330      9  -2.1, -2.5, -4.4, -2.5,-11.4,
   3331      A  -4.1, -3.4, -5.7, -4.5,-11.2,
   3332      B   -.3, -2.6, -2.3,  1.1, -6.8,
   3333      C  -1.3, -4.8, -6.7, -1.2,   .6,
   3334      D   -.1, -3.4, -5.1, -3.2,  3.6,
   3335      E   1.6, -1.4, -2.3, -4.0,  -.6,
   3336      F   4.8,  1.4, -1.5, -7.4, -3.9,
   3337      G   2.3,   .9,  2.4, -1.5,-12.4/
   3338  
   3339  
   3340 C          VAISALA  RS80/MICROCORA             
   3341 C     ====> JTYPE = 60  --  ITAB = 22 <====
   3342  
   3343       DATA  MICORA  /
   3344 C       NITE   -10    15    30    60  Solar Angle
   3345 C        ___   ___   ___   ___   ___
   3346 C LEVEL
   3347      1    .7, -1.2, -7.8, -1.5,  3.8,
   3348      2   4.2,  3.3, -3.7, -5.1,  5.7,
   3349      3  -1.7,  1.8, -2.0, -3.6,   .3,
   3350      4    .6,  5.6,  4.5,   .7,   .3,
   3351      5   1.5,  3.9,  3.6,   .6,  4.0,
   3352      6   2.3,  2.3,  1.3,   .3,  2.7,
   3353      7   1.8,  3.5,   .4,   .7,  4.2,
   3354      8   1.8,  2.8,  -.5,   .6,  3.3,
   3355      9   2.7,  2.9, -1.2,   .9,  4.1,
   3356      A   4.5,  7.4, -1.3,  1.4, 14.2,
   3357      B  -4.1,  1.0, -2.3, -5.7,  9.6,
   3358      C  -9.5,  -.9, -6.7, -9.4, -2.4,
   3359      D  -3.4,  -.5,  1.7, -3.6, -2.2,
   3360      E   4.1, -6.1, -1.5, -3.9, -5.0,
   3361      F   6.8, -5.4,  5.3, -3.6, -9.7,

Page 74          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3362      G   3.7,  9.2,  8.3,  4.0,  8.6/
   3363  
   3364  
   3365 C          VAISALA  RS80/DIGICORA  OR MARWIN   
   3366 C     ====> JTYPE = 61  --  ITAB = 23 <====
   3367  
   3368       DATA  DICORA  /
   3369 C       NITE   -10    15    30    60  Solar Angle
   3370 C        ___   ___   ___   ___   ___
   3371 C LEVEL
   3372      1   2.1,  2.6,  1.0,   .0,  -.9,
   3373      2   1.0,  2.8,  1.0,   .8,   .2,
   3374      3   1.0,  2.7,  1.7,   .6,   .4,
   3375      4    .5,  1.8,   .9,   .1,   .0,
   3376      5    .4,   .9,   .0,   .1,   .5,
   3377      6    .2,   .4,  -.1,   .2,   .0,
   3378      7    .1,   .0,  -.3,  -.4,  -.2,
   3379      8    .2,  -.4,   .1,  -.1, -1.0,
   3380      9    .4,  1.6,  1.6,  1.3, -1.0,
   3381      A   1.0,  1.6,  2.2,  2.4,  1.1,
   3382      B   1.0,  1.9,  2.3,  2.8,  2.5,
   3383      C   -.5,  2.1,  2.3,   .6,   .5,
   3384      D   -.9,  1.5,   .5,  -.7,   .2,
   3385      E  -1.3,   .4,  -.3, -1.7, -1.5,
   3386      F  -1.0, -1.3, -1.1,  -.2,  -.6,
   3387      G    .2, -1.2, -1.3,   .0,  5.4/
   3388  
   3389  
   3390 C          VAISALA  RS80/PCCORA                
   3391 C     ====> JTYPE = 62  --  ITAB = 24 <====
   3392  
   3393       DATA  PCCORA  /
   3394 C       NITE   -10    15    30    60  Solar Angle
   3395 C        ___   ___   ___   ___   ___
   3396 C LEVEL
   3397      1   2.6, -1.8,   .2, -3.2,  3.8,
   3398      2   1.0, -1.2,  1.6,  -.3,  3.2,
   3399      3   -.4, -1.1,   .6,  -.1,  -.7,
   3400      4   -.4,   .5,   .6,  -.1, -3.9,
   3401      5    .8,  1.3,  1.5,   .8,   .5,
   3402      6    .6,  1.1,   .9,   .8,   .0,
   3403      7   -.2,  2.2,  1.3,   .5,  -.5,
   3404      8   -.9,  2.1,   .5,   .2,   .0,
   3405      9    .9,   .1,   .8,  1.2,  5.2,
   3406      A   1.3,  2.0,   .8,   .1,  5.6,
   3407      B   1.9,  1.2,   .2,   .3,  3.8,
   3408      C   3.4,  2.5,  1.8,  1.2,   .7,
   3409      D   1.5,  1.6,   .8,  -.2, -3.4,
   3410      E    .0,  1.6,  1.1,   .5, -3.9,
   3411      F  -4.0,  -.4,   .0, -1.4, -4.7,
   3412      G  -5.6,  6.1,  1.1,  1.1,  5.5/
   3413  
   3414  
   3415 C          VAISALA  RS80/STAR                  
   3416 C     ====> JTYPE = 63  --  ITAB = 25 <====
   3417  
   3418       DATA  VASTAR  /

Page 75          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3419 C       NITE   -10    15    30    60  Solar Angle
   3420 C        ___   ___   ___   ___   ___
   3421 C LEVEL
   3422      1  -6.8,  1.4,  2.3,  5.5,  1.9,
   3423      2  -3.0, 10.0,  3.2, -1.0, -1.7,
   3424      3  -1.9,  6.3,  2.3,   .6,   .0,
   3425      4   -.1, 10.5,  3.4,  1.1,  1.1,
   3426      5  -1.0,  4.7,  1.3,  -.3,  -.2,
   3427      6    .1,  1.9,   .9,  -.1,   .8,
   3428      7   2.8, -3.0,  3.3,  2.2,  1.8,
   3429      8   4.2, -5.6,  3.9,  2.3,  3.6,
   3430      9    .9, -2.6, -1.0, -3.5,  3.3,
   3431      A  -1.7,  6.7,   .5, -4.7,  -.1,
   3432      B  -4.4,  5.5,  -.5, -7.2, -1.8,
   3433      C   2.1,  8.8,   .6,   .9,  1.5,
   3434      D   3.2,  5.6,  3.4,  3.3,  -.9,
   3435      E   1.0,  8.5,  6.7,  5.5,  1.9,
   3436      F  -7.6,  9.3,  1.5,  1.9, -5.7,
   3437      G  -2.7,  9.2,-11.1, -3.0, -3.0/
   3438  
   3439  
   3440 C          UNKNOWN TYPE                        
   3441 C     ====> JTYPE = 90  --  ITAB = 26 <====
   3442  
   3443       DATA  UNKN90  /
   3444 C       NITE   -10    15    30    60  Solar Angle
   3445 C        ___   ___   ___   ___   ___
   3446 C LEVEL
   3447      1  -3.9,-17.9,-15.7,-32.5,-32.5,
   3448      2  -6.6,-11.5,-10.5,-22.5,-22.5,
   3449      3  -3.8, -5.8, -4.1,-17.6,-17.6,
   3450      4  -5.3, -1.1, -3.0,-15.1,-15.1,
   3451      5  -3.0, -1.2, -2.7,-14.1,-14.1,
   3452      6  -2.2,  2.4,   .5,-11.9,-11.9,
   3453      7  -3.0,  6.9,  4.5, -4.3, -4.3,
   3454      8  -2.2,  9.7,  5.8, -4.1, -4.1,
   3455      9  -2.3,  5.5,  -.5,-12.0,-12.0,
   3456      A  -3.1,  9.5, -5.8,-17.1,-17.1,
   3457      B  -6.7, 10.8, -6.7,-17.9,-17.9,
   3458      C  -7.4,  9.2, -2.5,  4.2,  4.2,
   3459      D  -8.0,  6.0, 12.2,  3.0,  3.0,
   3460      E  -7.8,   .8, 27.6, 16.6, 16.6,
   3461      F  -7.0, 17.2, 23.8, 15.4, 15.4,
   3462      G -15.8,  2.4, 15.0,  6.2,  6.2/
   3463  
   3464  
   3465 C           PRESSURE ONLY PLUS TRANSPONDER     
   3466 C     ====> JTYPE = 92  --  ITAB = 27 <====
   3467  
   3468       DATA  TYPE92  /
   3469 C       NITE   -10    15    30    60  Solar Angle
   3470 C        ___   ___   ___   ___   ___
   3471 C LEVEL
   3472      1  16.1,  3.3,  3.3,  3.3,  3.3,
   3473      2  16.1,  3.3, 18.6, 18.6, 18.6,
   3474      3  -1.3,   .2,  9.9,  9.9,  9.9,
   3475      4   2.6, -4.6, -4.2, -4.2, -4.2,

Page 76          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3476      5  -2.8,  1.9,  4.6,  4.6,  4.6,
   3477      6  -1.5,   .6,  9.6,  9.6,  9.6,
   3478      7   5.1,  7.5,  8.0,  8.0,  8.0,
   3479      8   1.6,  7.2, 12.3, 12.3, 12.3,
   3480      9    .7,  4.8, -1.1, -1.1, -1.1,
   3481      A  -6.7,  1.0, 23.2, 23.2, 23.2,
   3482      B  -1.7,  5.6, 17.4, 17.4, 17.4,
   3483      C   2.1,  5.5,  8.1,  8.1,  8.1,
   3484      D   -.4,  6.3,  8.6,  8.6,  8.6,
   3485      E  -2.6,  5.2, 11.8, 11.8, 11.8,
   3486      F  -1.8,  6.5,  9.3,  9.3,  9.3,
   3487      G  17.2,  8.9, 12.0, 12.0, 12.0/
   3488  
   3489 
   3490 C-----------------------------------------------------------------------
   3491 C-----------------------------------------------------------------------
   3492 
   3493       IRET = 0
   3494 
   3495 C  EACH TIME THROUGH, COMPUTE LOGS OF PRESSURE RATIOS
   3496 C  --------------------------------------------------
   3497 
   3498       ALP(1) = 0.0
   3499       DO I=2,16
   3500          ALP(I) = ALOG(PRES(I-1)/PRES(I))
   3501       ENDDO
   3502 
   3503 C  GET TABLE INDEX FROM RAOB TYPE - CHECK FOR VALID CORR. PARAMETERS
   3504 C  -----------------------------------------------------------------
   3505 
   3506       ITAB = 0
   3507       IF(JTYPE.GT.0.AND.JTYPE.LT.256) THEN
   3508          ITAB = ITYPTT(JTYPE)
   3509          IF(ITAB.EQ.0)  THEN
   3510             IRET = -1
   3511             RETURN
   3512          ELSE  IF(ITAB.LT.0)  THEN
   3513             WRITE(6,1)  SID(IS),JTYPE
   3514             WRITE(68,1) SID(IS),JTYPE
   3515             IRET = -1
   3516             RETURN
   3517          END IF
   3518       ELSE
   3519          WRITE(6,1)  SID(IS),JTYPE
   3520          WRITE(68,1) SID(IS),JTYPE
   3521 1        FORMAT(5X,'* * *  STN. ID ',A8,' HAS AN INVALID RAOB TYPE ',
   3522      .    'DESIGNATION (BUFR/ON29 CODE ',I8,') - NO CORRECTION ',
   3523      .    'POSSIBLE')
   3524          IRET = -1
   3525          if(jtype.eq.20000)  iret = -99
   3526          RETURN
   3527       ENDIF
   3528 
   3529 C  GET SOLAR ELEVATION ANGLE ON ALL VALID MANDATORY LEVELS
   3530 C  -------------------------------------------------------
   3531 
   3532       CALL SOELAN(SOLAR)

Page 77          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3533 
   3534 C  APPLY TEMPERATURE AND HEIGHT ADJUSTMENTS
   3535 C  DO NOT APPLY AN ADJUSTMENT BELOW 700 HPA
   3536 C  ----------------------------------------
   3537 
   3538       DTS = 0
   3539       DHS = 0
   3540       DO ILEV=4,16
   3541          ANGLE(2)  = CUTOFF(ILEV)
   3542 
   3543          IF(SOLAR(ILEV).GE.CUTOFF(ILEV))  THEN
   3544             IF(SOLAR(ILEV).LT.ANGLE(5)) THEN
   3545                DO K=3,5
   3546                   IF(SOLAR(ILEV).LT.ANGLE(K)) THEN
   3547                      TABU = TTAB(K  ,ILEV,ITAB)
   3548                      TABD = TTAB(K-1,ILEV,ITAB)
   3549                      DSUN=(SOLAR(ILEV)-ANGLE(K-1))/(ANGLE(K)-ANGLE(K-1))
   3550                      DTS(ILEV) = TABD + DSUN*(TABU-TABD)
   3551                      GO TO 10
   3552                   ENDIF
   3553                ENDDO
   3554             ELSE
   3555                DTS(ILEV) = TTAB(5,ILEV,ITAB)
   3556             ENDIF
   3557          ELSE
   3558 
   3559 C  IF ANGLE < CUTOFF (NIGHT), CORRECTION FROM 'NIGHT' VALUE IN TBL
   3560 C  --------------------------------------------------------------------
   3561 
   3562             DTS(ILEV) = TTAB(1,ILEV,ITAB)
   3563          ENDIF
   3564 
   3565 C  The constant is (R/(20*g)) = 1.46355
   3566 C  ------------------------------------
   3567 
   3568    10    CONTINUE
   3569          HYF = 1.46355*ALP(ILEV)
   3570          IF(ILEV.EQ.1) THEN
   3571             DHS(ILEV) = HYF*DTS(ILEV)
   3572          ELSE
   3573             DHS(ILEV) = DHS(ILEV-1) + HYF*(10.*DTS(ILEV-1)+DTS(ILEV))
   3574          ENDIF
   3575 
   3576 C  CORRECT DTS BY A FACTOR OF 10
   3577 C  -----------------------------
   3578 
   3579          DTS(ILEV) = .1*DTS(ILEV)
   3580 
   3581 C  SAVE AND APPLY THE CORRECTIONS
   3582 C  ------------------------------
   3583 
   3584          DHT(ILEV) = -DHS(ILEV)
   3585          DTP(ILEV) = -DTS(ILEV)
   3586 
   3587          IF(HGT(ILEV).LT.BMISS) HGT(ILEV) = HGT(ILEV) + DHT(ILEV)
   3588          IF(TMP(ILEV).LT.BMISS) TMP(ILEV) = TMP(ILEV) + DTP(ILEV)
   3589 

Page 78          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3590       ENDDO
   3591 
   3592       RETURN
   3593       END


ENTRY POINTS

  Name              
                    
 radt4_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  3521                                                           3513,3514,3519,3520               
 10                         Label  3568                                                           3551                              
 AIRR80                     Local  2734     R(4)            4     2     80       SAVE             3144                              
 ALOG                       Func   3500                                 scalar                    3500                              
 ALP                        Local  2729     R(4)            4     1     16                        3498,3500,3569                    
 ANGLE                      Local  2729     R(4)            4     1     5                         2757,3541,3544,3546,3549          
 BAL_DRIFT                  Scalar 2723     R(4)            4           scalar   COM                                                
 BMISS                      Scalar 2717     R(8)            8           scalar   COM              3587,3588                         
 BUFRLIB_MISSING            Common 2726                                 16                                                          
 CANVZA                     Local  2733     R(4)            4     2     80       SAVE             3068                              
 CHINSR                     Local  2733     R(4)            4     2     80       SAVE             3093                              
 CUTOFF                     Local  2728     R(4)            4     1     16                        2758,3541,3543                    
 DHR                        Scalar 2719     R(4)            4     1     999      COM                                                
 DHS                        Local  2729     R(4)            4     1     16                        3539,3571,3573,3584               
 DHT                        Scalar 2722     R(4)            4     1     16       COM              3584,3587                         
 DICORA                     Local  2737     R(4)            4     2     80       SAVE             3368                              
 DSUN                       Local  3549     R(4)            4           scalar                    3549,3550                         
 DTP                        Scalar 2722     R(4)            4     1     16       COM              3585,3588                         
 DTS                        Local  2729     R(4)            4     1     16                        3538,3550,3555,3562,3571,3573,3579
                                                                                                  ,3585                             
 ELV                        Scalar 2720     R(4)            4     1     999      COM                                                
 GRAW60                     Local  2731     R(4)            4     2     80       SAVE             2893                              
 GRAW90                     Local  2735     R(4)            4     2     80       SAVE             3268                              
 HEADER                     Common 2719                                 35980                                                       
 HGT                        Scalar 2722     R(4)            4     1     16       COM              3587                              
 HGTTBL                     Scalar 2723     L(4)            4           scalar   COM                                                
 HYF                        Local  3569     R(4)            4           scalar                    3569,3571,3573                    
 I                          Local  3499     I(4)            4           scalar                    3499,3500                         
 ILEV                       Local  3540     I(4)            4           scalar                    3540,3541,3543,3544,3546,3547,3548
                                                                                                  ,3549,3550,3555,3562,3569,3570,357
                                                                                                  1,3573,3579,3584,3585,3587,3588   
 IMISS                      Scalar 2726     I(4)            4           scalar   COM                                                
 INDMK3                     Local  2731     R(4)            4     2     80       SAVE             2918                              
 INM                        Scalar 2724     I(4)            4     1     16       COM                                                
 IRCTBL                     Scalar 2723     I(4)            4           scalar   COM                                                
 IRET                       Dummy  2714     I(4)            4           scalar   ARG,INOUT        3493,3510,3515,3524,3525          
 IS                         Scalar 2725     I(4)            4           scalar   COM              3513,3514,3519,3520               
 ISF                        Scalar 2721     I(4)            4     1     999      COM                                                
 ITAB                       Local  3506     I(4)            4           scalar                    3506,3508,3509,3512,3547,3548,3555
                                                                                                  ,3562                             

Page 79          Source Listing                  RADT4
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ITP                        Scalar 2720     I(4)            4     1     999      COM                                                
 ITYPTT                     Local  2739     I(4)            4     1     255                       2768,3508                         
 JTYPE                      Scalar 2722     I(4)            4           scalar   COM              3507,3508,3513,3514,3519,3520,3525
 K                          Local  3545     I(4)            4           scalar                    3545,3546,3547,3548,3549          
 KMAX                       Scalar 2724     I(4)            4           scalar   COM                                                
 KMIN                       Scalar 2724     I(4)            4           scalar   COM                                                
 KORMK1                     Local  2731     R(4)            4     2     80       SAVE             2943                              
 LEVRAD                     Scalar 2723     I(4)            4           scalar   COM                                                
 LWCORR                     Scalar 2723     I(4)            4           scalar   COM                                                
 MEIS80                     Local  2732     R(4)            4     2     80       SAVE             2968                              
 MEIS91                     Local  2735     R(4)            4     2     80       SAVE             3194                              
 MICORA                     Local  2736     R(4)            4     2     80       SAVE             3343                              
 MICROA                     Local  2736     R(4)            4     2     80       SAVE             3318                              
 NEV                        Scalar 2721     I(4)            4           scalar   COM                                                
 NLV                        Scalar 2720     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 2721     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 2721     I(4)            4           scalar   COM                                                
 NST                        Param  2715     I(4)            4           scalar                    2719,2720,2721                    
 PCCORA                     Local  2737     R(4)            4     2     80       SAVE             3393                              
 PMAND                      Common 2724                                 136                                                         
 PRES                       Scalar 2724     R(4)            4     1     16       COM              3500                              
 RADCOM                     Common 2722                                 260                                                         
 RADT4                      Subr   2714                                                                                             
 RUSAVK                     Local  2732     R(4)            4     2     80       SAVE             2993                              
 RUSZ21                     Local  2732     R(4)            4     2     80       SAVE             3018                              
 RUSZ22                     Local  2733     R(4)            4     2     80       SAVE             3043                              
 SID                        Scalar 2719     CHAR            8     1     999      COM              3513,3514,3519,3520               
 SOELAN                     Subr   3532                                                           3532                              
 SOLAR                      Local  2729     R(4)            4     1     16                        3532,3543,3544,3546,3549          
 SQN                        Scalar 2720     R(4)            4     1     999      COM                                                
 STN                        Common 2725                                 4                                                           
 SWITCH                     Common 2723                                 20                                                          
 TABD                       Local  3548     R(4)            4           scalar                    3548,3550                         
 TABU                       Local  3547     R(4)            4           scalar                    3547,3550                         
 TMP                        Scalar 2722     R(4)            4     1     16       COM              3588                              
 TTAB                       Local  2728     R(4)            4     3     2160                      3547,3548,3555,3562               
 TYPE92                     Local  2738     R(4)            4     2     80       SAVE             3468                              
 UNKN09                     Local  2738     R(4)            4     2     80       SAVE             2793                              
 UNKN90                     Local  2738     R(4)            4     2     80       SAVE             3443                              
 USRSMS                     Local  2734     R(4)            4     2     80       SAVE             3169                              
 USSDCP                     Local  2730     R(4)            4     2     80       SAVE             2868                              
 USVIZA                     Local  2730     R(4)            4     2     80       SAVE             2818                              
 USVIZB                     Local  2730     R(4)            4     2     80       SAVE             2843                              
 USVZB2                     Local  2736     R(4)            4     2     80       SAVE             3293                              
 VARS80                     Local  2734     R(4)            4     2     80       SAVE             3118                              
 VASTAR                     Local  2737     R(4)            4     2     80       SAVE             3418                              
 VIZMK2                     Local  2735     R(4)            4     2     80       SAVE             3219                              
 XMISS                      Scalar 2726     R(4)            4           scalar   COM                                                
 XOB                        Scalar 2719     R(4)            4     1     999      COM                                                
 YOB                        Scalar 2719     R(4)            4     1     999      COM                                                

Page 80          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3594 
   3595 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3596 C
   3597 C SUBPROGRAM:    RADT5       APPLIES NEWEST SET OF RADIATION CORRECTNS
   3598 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2008-11-19
   3599 C
   3600 C ABSTRACT: THIS SUBROUTINE APPLIES RADIATION CORRECTIONS TO THE
   3601 C   OBSERVED RADIOSONDE HEIGHTS AND TEMPERATURES ON THE BOTTOM 16
   3602 C   MANDATORY PRESSURE LEVELS.  DATA ARE PASSED THROUGH COMMON
   3603 C   /RADCOM/.  THE CORRECTION OF RAOBS FOR BOTH SHORT- AND LONG-WAVE
   3604 C   EFFECTS IN ACCOMPLISHED BY READING IN TABLES OF NUMBERS WHICH ARE
   3605 C   DEPENDENT ON THE RADIOSONDE TYPE. CALLED FOR ONE REPORT AT A TIME.
   3606 C
   3607 C PROGRAM HISTORY LOG:
   3608 C 1999-06-02  W. COLLINS (W/NP22) -- ORIGINAL AUTHOR
   3609 C 2002-07-22  D. A. KEYSER -- CALLS NEW ROUTINE SOELAN TO CALCULATE SUN
   3610 C     ANGLE ON VALID MANDATORY LEVELS RATHER THAN DOING CALCULATION IN
   3611 C     THIS SUBROUTINE
   3612 C 2004-03-17  D. A. KEYSER --  UPDATED DOCBLOCK AND ADDED NEW
   3613 C     RADIOSONDE TYPES SINCE THE LAST TIME IT WAS UPDATED (NONE OF THE
   3614 C     NEW TYPES RECEIVE CORRECTIONS)
   3615 C 2005-08-03  D. A. KEYSER --  REVISED CORRECTION TABLE FOR CHINA'S
   3616 C     SHANGHAI RADIO SONDE (BUFR TYPE 32), AFTER 12/31/00 NO
   3617 C     CORRECTIONS ARE MADE BETWEEN 700 AND 50 MB, INCLUSIVE BECAUSE
   3618 C     THIS SONDE IS BEING CORRECTED ON SITE (THIS WILL REMOVE COLD BIAS
   3619 C     FOUND IN THESE SONDES VS. GUESS BELOW 50 MB) (NOTE 1: NO
   3620 C     CORRECTIONS ARE MADE BELOW 700 MB FOR ANY SONDES, NOTE 2: PRIOR
   3621 C     TO 1/1/01, THE PREVIOUS CORRECTION TABLE IS STILL USED FOR THIS
   3622 C     SONDE BECAUSE, ACCORDING TO YUETANG YHANG OF THE CHINESE NMC,
   3623 C     THIS IS WHEN THE ON-SITE CORRECTIONS STARTED); ADDED NEW
   3624 C     RADIOSONDE TYPES IN DOCBLOCK SINCE THE LAST TIME IT WAS UPDATED
   3625 C 2007-09-14  D. KEYSER    -- MINOR CODE CORRECTIONS SUGGESTED BY PAT
   3626 C     PAULEY (CORRECTS PROBLEMS THAT COULD OCCUR ON SOME REMOTE
   3627 C     MACHINES)
   3628 C 2008-04-10  D. A. KEYSER --  UPDATED DOCBLOCK AND ADDED NEW
   3629 C     RADIOSONDE TYPES SINCE THE LAST TIME IT WAS UPDATED (NONE OF THE
   3630 C     NEW TYPES RECEIVE CORRECTIONS); CAN HANDLE RADIOSONDE TYPES > 99
   3631 C     WHICH WILL SOON BE INTRODUCED INTO THE BUFR DATABASE (BASED ON
   3632 C     NOVEMBER 2007 WMO BUFR UPDATE)
   3633 C 2008-10-08  D. A. KEYSER -- UPDATED LIST OF RADIOSONDE TYPES TO
   3634 C     CONFORM WITH LATEST (NOV. 2007) WMO BUFR CODE TABLE 0-02-011
   3635 C 2008-11-19  D. A. KEYSER -- UPDATED LIST OF RADIOSONDE TYPES TO
   3636 C     CONFORM WITH LATEST (NOV. 2008) WMO BUFR CODE TABLE 0-02-011;
   3637 C     MORE SPECIFIC DIAGNOSTIC PRINT RELATED TO RADIOSONDE TYPES
   3638 C     ENCOUNTERED (I.E., INVALID, OBSOLETE, VACANT, ETC.)
   3639 C
   3640 C USAGE:    CALL RADT5(IRET)
   3641 C   OUTPUT ARGUMENT LIST:
   3642 C     IRET     - RETURN CODE
   3643 C                  =   0 - CORRECTIONS
   3644 C                  =  -1 - NO CORRECTIONS
   3645 C                  = -99 - BIG PROBLEM
   3646 C
   3647 C   OUTPUT FILES:
   3648 C     UNIT 06  - PRINTOUT
   3649 C     UNIT 68  - RADCOR INFORMATION FILE
   3650 C

Page 81          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3651 C REMARKS: THESE CORRECTIONS USE THE BUFR CODE FIGURE FOR RADIOSONDE
   3652 C   TYPE OBTAINED FROM BUFR-FM94 TABLE 0 02 011.  THE NMC UPPER-AIR
   3653 C   DICTIONARY ALSO CONTAINS THIS BUFR CODE FIGURE FOR RADIOSONDE
   3654 C   TYPE.  CALLED BY SUBROUTINE "RADEVN".
   3655 C
   3656 C
   3657 C   KEY FOR RADIOSONDE TYPES USED HERE (EFFECTIVE 11/2008):
   3658 C
   3659 C  JTYPE       KEY         DESCRIPTION                      TABLE NUMBER
   3660 C          ("*" in use 11/2008) 
   3661 C < 000                    Invalid
   3662 C  000                     Reserved
   3663 C  001          *          (U.S.) iMet-1-BB
   3664 C 002 to 006               Not used for radiosondes
   3665 C  007          *          (U.S.) iMet-1-AB
   3666 C  008                     Not used for radiosondes
   3667 C  009          *          No radiosonde - system unknown or
   3668 C                          unspecified
   3669 C  010                     (U.S.) VIZ type A pressure-commutated  2
   3670 C  011                     (U.S.) VIZ type B time-commutated      3 
   3671 C  012          *          (U.S.) RS SDC (Space Data Corp.)       4
   3672 C  013                     (Australia) Astor
   3673 C  014                     (U.S.) VIZ Mark I MICROSONDE
   3674 C  015                     (U.S.) EEC Company type 23
   3675 C  016                     (Austria) Elin
   3676 C  017          *          (Germany) Graw G
   3677 C  018          *          (Germany) Graw DFM-06
   3678 C  019          *          (Germany) Graw M60                     
   3679 C  020          *          Indian Met. Service Type  MK3          5
   3680 C  021          *          (S. Korea) VIZ/Jin Yang Mark I         6
   3681 C                          MICROSONDE                             
   3682 C  022          *          (Japan) Meisei RS2-80                  7
   3683 C  023                     (France) Mesural FMO 1950A
   3684 C  024                     (France) Mesural FMO 1945A
   3685 C  025                     (France) Mesural MH73A
   3686 C  026          *          (Switzerland) Meteolabor Basora        8
   3687 C  027          *          (Russia) AVK-MRZ                       9
   3688 C  028          *          (Russia) Meteorit Marz2-1             10
   3689 C  029          *          (Russia) Meteorit Marz2-2             11
   3690 C  030                     (Japan) OKI RS2-80
   3691 C  031                     (Canada) VIZ/Valcom type A pressure-
   3692 C                          commutated
   3693 C  032          *          (China) Shanghai Radio
   3694 C                                     prior to 01/01/01          12
   3695 C                                     after    12/31/00          28
   3696 C  033                     (U.K.) UK Met Office MK3    
   3697 C  034                     (Czechoslovakia) Vinohrady
   3698 C  035                     Vaisala RS18
   3699 C  036          *          Vaisala RS21
   3700 C  037          *          Vaisala RS80                          13
   3701 C  038                     (U.S.) VIZ LOCATE (Loran-C)
   3702 C  039                     (Germany) Sprenger E076
   3703 C  040                     (Germany) Sprenger E084
   3704 C  041                     (Germany) Sprenger E085
   3705 C  042                     (Germany) Sprenger E086
   3706 C  043                     (U.S.) AIR IS-4A-1680                 14
   3707 C  044                     (U.S.) AIR IS-4A-1680 X               15 

Page 82          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3708 C  045                     (U.S.) RS MSS                         15 
   3709 C  046                     (U.S.) AIR IS-4A-403                  16
   3710 C  047          *          (Japan) Meisei RS2-91                 17 
   3711 C  048                     (Canada) VALCOM
   3712 C  049          *          (U.S.) VIZ MARK II                    18
   3713 C  050          *          (Germany) GRAW DFM-90                 19
   3714 C  051          *          (U.S.) VIZ-B2                         20
   3715 C  052          *          Vaisala RS8-57H                       21
   3716 C  053          *          (Russia) AVK-RF95
   3717 C  054          *          (Germany) GRAW DFM-97
   3718 C  055          *          (Japan) Meisei RS-016
   3719 C  056          *          (France) M2K2
   3720 C  057          *          (France) M2K2-P
   3721 C  058          *          (Russia) AVK-BAR
   3722 C  059          *          (France) Modem M2K2-R 1680 MHz RDF
   3723 C                          with pressure sensor chip
   3724 C  060          *          Vaisala RS80/MicroCora                22
   3725 C  061          *          Vaisala RS80/Loran/Digicora I,II or
   3726 C                          Marwin (baseline)
   3727 C  062          *          Vaisala RS80/PCCora                   24
   3728 C  063          *          Vaisala RS80/Star                     25
   3729 C  064                     (U.S.) Orbital Sciences Corp. Space
   3730 C                          Data Division, transponder
   3731 C                          radiosonde, type 909-11-xx (where xx
   3732 C                          corresponds to the model of the
   3733 C                          instrument)
   3734 C  065                     (U.S.) VIZ transponder radiosonde,
   3735 C                          model number 1499-520
   3736 C  066          *          Vaisala RS80/Autosonde
   3737 C  067          *          Vaisala RS80/Digicora III
   3738 C  068          *          (Russia) AVK-RZM-2
   3739 C  069          *          (Russia) MARL-A or Vektor-M-RZM-2
   3740 C  070          *          Vaisala RS92/Star
   3741 C  071          *          Vaisala RS90/Digicora I,II or Marwin  26
   3742 C  072          *          Vaisala RS90/PC-Cora
   3743 C  073          *          Vaisala RS90/Autosonde
   3744 C  074          *          Vaisala RS90/Star                        
   3745 C  075          *          (Russia) AVK-MRZ-ARMA             
   3746 C  076          *          (Russia) AVK-RF95-ARMA                27
   3747 C  077                     (France) GEOLINK GPSonde GL98
   3748 C  078          *          Vaisala RS90/Digicora III
   3749 C  079          *          Vaisala RS92/Digicora I,II or Marwin
   3750 C  080          *          Vaisala RS92/Digicora III
   3751 C  081          *          Vaisala RS92/Autosonde
   3752 C  082          *          (U.S.) Sippican MK2 GPS/STAR with
   3753 C                          rod thermistor, carbon element and
   3754 C                          derived pressure
   3755 C  083          *          (U.S.) Sippican MK2 GPS/W9000 with
   3756 C                          rod thermistor, carbon element and
   3757 C                          derived pressure
   3758 C  084          *          (U.S.) Sippican MARK II with chip
   3759 C                          thermistor, carbon element and
   3760 C                          derived pressure from GPS height
   3761 C  085          *          (U.S.) Sippican MARK IIA with chip
   3762 C                          thermistor, carbon element and
   3763 C                          derived pressure from GPS height
   3764 C  086          *          (U.S.) Sippican MARK II with chip

Page 83          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3765 C                          thermistor, pressure and carbon
   3766 C                          element
   3767 C  087          *          (U.S.) Sippican MARK IIA with chip
   3768 C                          thermistor, pressure and carbon
   3769 C                          element
   3770 C  088          *          (Russia) MARL-A or Vektor-M-MRZ
   3771 C  089          *          (RUSSIA) MARL-A or Vektor-M-BAR
   3772 C  090          *          Radiosonde not specified or unknown
   3773 C  091                     Pressure-only radiosonde
   3774 C  092                     Pressure-only radiosonde plus
   3775 C                          transponder
   3776 C  093                     Pressure-only radiosonde plus radar-
   3777 C                          reflector
   3778 C  094                     No-pressure radiosonde plus
   3779 C                          transponder
   3780 C  095                     No-pressure radiosonde plus radar-
   3781 C                          reflector
   3782 C  096          *          Descending radiosonde
   3783 C  097          *          (S. Africa) BAT-16P
   3784 C  098          *          (S. Africa) BAT-16G
   3785 C  099          *          (S. Africa) BAT-4G
   3786 C  100                     Reserved
   3787 C  101                     Not vacant
   3788 C 102 TO 106               Reserved
   3789 C  107                     Not vacant
   3790 C 108 TO 109               Reserved
   3791 C  110          *          (U.S.) Sippican LMS5 w/Chip
   3792 C                          Thermistor, duct mounted
   3793 C                          capacitance relative humidity sensor,
   3794 C                          and derived pressure from GPS height
   3795 C  111          *          (U.S.) Sippican LMS6 w/Chip
   3796 C                          Thermistor, external boom mounted
   3797 C                          capacitance relative humidity sensor,
   3798 C                          and derived pressure from GPS height
   3799 C  112                     Not vacant
   3800 C 113 TO 116               Vacant
   3801 C 117 TO 122               Not vacant
   3802 C 123 TO 125               Vacant
   3803 C 126 TO 129               Not vacant
   3804 C 130 TO 131               Vacant
   3805 C  132                     Not vacant
   3806 C 133 TO 135               Vacant
   3807 C 136 TO 137               Not vacant
   3808 C 138 TO 146               Vacant
   3809 C  147                     Not vacant
   3810 C  148                     Vacant
   3811 C 149 TO 163               Not vacant
   3812 C 164 TO 165               Vacant
   3813 C 166 TO 176               Not vacant
   3814 C  177                     Vacant
   3815 C 178 TO 189               Not vacant
   3816 C 190 TO 196               Reserved
   3817 C 197 TO 199               Not vacant
   3818 C 200 TO 254               Reserved
   3819 C  255                     Missing value
   3820 C >255                     Invalid
   3821 C

Page 84          Source Listing                  RADT4
2017-04-18 11:07                                 radcor.f

   3822 C
   3823 C   KEY FOR LEVELS IN DATA (CORRECTION) TABLES:
   3824 C
   3825 C     1 - 1000 MB
   3826 C     2 -- 925 MB
   3827 C     3 -- 850 MB
   3828 C     4 -- 700 MB
   3829 C     5 -- 500 MB
   3830 C     6 -- 400 MB
   3831 C     7 -- 300 MB
   3832 C     8 -- 250 MB
   3833 C     9 -- 200 MB
   3834 C     A -- 150 MB
   3835 C     B -- 100 MB
   3836 C     C --  70 MB
   3837 C     D --  50 MB
   3838 C     E --  30 MB
   3839 C     F --  20 MB
   3840 C     G --  10 MB
   3841 C
   3842 C
   3843 C   THE RADIATION CORRECTION TABLES ARE BASED UPON
   3844 C   OBSERVED INCREMENTS FROM NWP ASSIMILATION.  THE ADJUSTMENTS
   3845 C   ARE TO MAKE ALL SONDE TYPES COMPARE WITH THE VAISALA
   3846 C   RS80 DIGICORA SONDE.
   3847 C
   3848 C
   3849 C   THE CUTOFF ANGLE AT EACH LEVEL CALCULATED USING THE RELATION:
   3850 C              CUTOFF ANGLE = -1.76459 * (Z**.40795) ,
   3851 C   WHERE Z IS A REFERENCE HEIGHT FOR THE LEVEL (IN KILOMETERS)
   3852 C   (SEE NMC OFFICE NOTE 306, TABLE 4 FOR LIST OF REFERENCE HEIGHTS.)
   3853 C
   3854 C
   3855 C ATTRIBUTES:
   3856 C   LANGUAGE: FORTRAN 90
   3857 C   MACHINE:  NCEP WCOSS
   3858 C
   3859 C$$$
   3860       SUBROUTINE RADT5(IRET)
   3861       PARAMETER (NST=999)
   3862 
   3863       REAL(8) BMISS
   3864 
   3865       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   3866      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   3867      &                 NEV, ISF(NST), NLVM, NLVW
   3868       COMMON /RADCOM/ HGT(16),TMP(16),DHT(16),DTP(16),JTYPE
   3869       COMMON /SWITCH/ LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
   3870       COMMON /PMAND / PRES(16),KMIN,KMAX,INM(16)
   3871       COMMON /STN/     IS
   3872       COMMON /DATE_IDT/IDT
   3873       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   3874 
   3875       REAL        TTAB(5,16,29),CUTOFF(16),
   3876      .            SOLAR(16),ANGLE(5),ALP(16),DTS(16),DHS(16),
   3877      .            USVIZA(5,16), USVIZB(5,16), USSDCP(5,16),
   3878      .            AVKR95(5,16), INDMK3(5,16), KORMK1(5,16),

Page 85          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   3879      .            MEIS80(5,16), RUSAVK(5,16), RUSZ21(5,16),
   3880      .            RUSZ22(5,16), CHINSR(5,16),
   3881      .            VARS80(5,16), AIRR80(5,16), USRSMS(5,16),
   3882      .            MEIS91(5,16), VIZMK2(5,16), GRAW90(5,16),
   3883      .            USVZB2(5,16), MICROA(5,16), MICORA(5,16),
   3884      .            DICORA(5,16), PCCORA(5,16), VASTAR(5,16),
   3885      .            UNKN90(5,16), UNKN09(5,16), CHINSX(5,16),
   3886      .            METEOB(5,16), AIR403(5,16), VARS90(5,16)
   3887       INTEGER     ITYPTT(255)
   3888       EQUIVALENCE (TTAB(1,1, 1),UNKN09(1,1)),(TTAB(1,1, 2),USVIZA(1,1)),
   3889      .            (TTAB(1,1, 3),USVIZB(1,1)),(TTAB(1,1, 4),USSDCP(1,1)),
   3890      .            (TTAB(1,1, 5),INDMK3(1,1)),(TTAB(1,1, 6),KORMK1(1,1)),
   3891      .            (TTAB(1,1, 7),MEIS80(1,1)),(TTAB(1,1, 8),METEOB(1,1)),
   3892      .            (TTAB(1,1, 9),RUSAVK(1,1)),(TTAB(1,1,10),RUSZ21(1,1)),
   3893      .            (TTAB(1,1,11),RUSZ22(1,1)),(TTAB(1,1,12),CHINSR(1,1)),
   3894      .            (TTAB(1,1,13),VARS80(1,1)),(TTAB(1,1,14),AIRR80(1,1)),
   3895      .            (TTAB(1,1,15),USRSMS(1,1)),(TTAB(1,1,16),AIR403(1,1)),
   3896      .            (TTAB(1,1,17),MEIS91(1,1)),(TTAB(1,1,18),VIZMK2(1,1)),
   3897      .            (TTAB(1,1,19),GRAW90(1,1)),(TTAB(1,1,20),USVZB2(1,1)),
   3898      .            (TTAB(1,1,21),MICROA(1,1)),(TTAB(1,1,22),MICORA(1,1)),
   3899      .            (TTAB(1,1,23),DICORA(1,1)),(TTAB(1,1,24),PCCORA(1,1)),
   3900      .            (TTAB(1,1,25),VASTAR(1,1)),(TTAB(1,1,26),VARS90(1,1)),
   3901      .            (TTAB(1,1,27),AVKR95(1,1)),(TTAB(1,1,28),CHINSX(1,1)),
   3902      .            (TTAB(1,1,29),UNKN90(1,1))
   3903       LOGICAL     HGTTBL
   3904       CHARACTER*8 SID
   3905 
   3906       DATA  ANGLE  / -90, -10, 15, 30, 60/
   3907       DATA  CUTOFF / -.73, -1.58, -2.06, -2.77,
   3908      .              -3.56, -3.95, -4.36, -4.58,
   3909      .              -4.83, -5.12, -5.49, -5.79,
   3910      .              -6.06, -6.43, -6.72, -7.17/
   3911 
   3912 C  ITYPTT ASSIGNS PROPER TEMPERATURE CORRECTION TABLE TO INST. TYPES
   3913 C  -----------------------------------------------------------------
   3914 C    Key:  = 1-29
   3915 C               -- This is a valid radiosonde type in 11/2008 and it
   3916 C                  uses the correction table noted by the key value.
   3917 C          = 101-129
   3918 C               -- This is an obsolete radiosonde type in 11/2008 and
   3919 C                  will never again be used, none-the-less there is a
   3920 C                  correction table available for it noted by the key
   3921 C                  value minus 100.
   3922 C          =  0 -- This is a valid radiosonde type in 11/2008 but
   3923 C                  there is no correction table available for it.
   3924 C          = -1 -- This is an obsolete radiosonde type in 11/2008 and
   3925 C                  will never again be used (no correction is made).
   3926 C          = -2 -- This is a vacant radiosonde type in 11/2008 but
   3927 C                  it may become a valid radiosonde type at some point
   3928 C                  after that date (no correction is made).
   3929 C          = -3 -- This is, and always has been, an invalid radiosonde
   3930 C                  type (no correction is made).
   3931 
   3932 C  ===> JTYPE:       1   2   3   4   5   6   7   8   9 *10 *11  12  13
   3933 
   3934       DATA  ITYPTT/  0, -3, -3, -3, -3, -3,  0, -3,  0,102,103,  4, -1,
   3935 

Page 86          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   3936 C  ===> JTYPE:      14  15  16  17  18  19  20  21  22  23  24  25  26
   3937 
   3938      $              -1, -1, -1,  0,  0,  0,  5,  6,  7, -1, -1, -1,  8,
   3939 
   3940 C  ===> JTYPE:      27  28  29  30  31  32  33  34  35  36  37  38  39
   3941 
   3942      $               9, 10, 11, -1, -1, 12, -1, -1, -1,  0, 13, -1, -1,
   3943 
   3944 C  ===> JTYPE:      40  41  42 *43 *44 *45 *46  47  48  49  50  51  52
   3945 
   3946      $              -1, -1, -1,114,115,115,116, 17, -1, 18, 19, 20, 21,
   3947 
   3948 C  ===> JTYPE:      53  54  55  56  57  58  59  60  61  62  63  64  65
   3949 
   3950      $               0,  0,  0,  0,  0,  0,  0, 22,  0, 24, 25, -1, -1,
   3951 
   3952 C  ===> JTYPE:      66  67  68  69  70  71  72  73  74  75  76  77  78
   3953      $               0,  0,  0,  0,  0, 26,  0,  0,  0,  0, 27, -1,  0,
   3954 
   3955 C  ===> JTYPE:      79  80  81  82  83  84  85  86  87  88  89  90  91
   3956      $               0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
   3957 
   3958 C  ===> JTYPE:      92  93  94  94  96  97  98  99  100-109  110  111
   3959      $               0,  0,  0,  0,  0,  0,  0,  0,   10*-3,   0,   0,
   3960 
   3961 C  ===> JTYPE:      112  113-116  117-122  123-125  126-129  130  131
   3962      $               -3,    4*-2,    6*-3,    3*-2,    4*-3,  -2,  -2,
   3963 
   3964 C  ===> JTYPE:      132  133-135  136  137  138-146  147  148  149-163
   3965      $               -3,    3*-2,  -3,  -3,    9*-2,  -3,  -2,   15*-3,
   3966 
   3967 C  ===> JTYPE:      164  165  166-176  177  178-255 
   3968      $               -2,  -2,   11*-3,  -2,   78*-3/
   3969 
   3970 
   3971 
   3972 C  TEMPERATURE CORRECTION TABLES ( * 10 K) FOR RADIATIVE EFFECTS
   3973 C  -------------------------------------------------------------
   3974  
   3975 C  This set of tables is modified to insert reasonable
   3976 C  numbers for entries with 0 or small count. Data 
   3977 C  are for all available for 1999.
   3978 C  Values are smoothed with single pass of weighted
   3979 C  1-2-1 smoother in the vertical.
   3980 C  Values are increment differences between given
   3981 C  type and Vaisala RS-80 Digicora (type 61).
   3982  
   3983 C  NO RADIOSONDE - SYSTEM UNKNOWN OR UNSPECIFIED
   3984 C     ====> JTYPE =  009  --  ITAB = X  <====
   3985 C            (no longer corrected)
   3986  
   3987       DATA  UNKN09  /
   3988 C       NITE   -10    15    30    60  Solar Angle
   3989 C        ___   ___   ___   ___   ___
   3990 C LEVEL
   3991      1    .9,   .1, -7.0, -8.4,-16.6,
   3992      2  -1.2,  -.7, -2.1,  -.7, -3.5,

Page 87          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   3993      3    .3,  2.1,   .6,  2.6,  2.2,
   3994      4   1.7,  3.4,   .8,  2.5,  3.0,
   3995      5   2.3,  3.3,   .7,  2.1,   .0,
   3996      6   2.5,  3.7,  2.9,  3.3,  -.1,
   3997      7   3.0,  4.6,  6.4,  5.7,  3.1,
   3998      8   3.4,  5.9,  7.0,  6.8,  3.9,
   3999      9   1.5,  6.7,  3.1,  4.2,  -.7,
   4000      A  -2.0,  6.7, -1.9, -1.1, -8.8,
   4001      B  -3.9,  2.0, -3.4, -4.3,-14.5,
   4002      C  -2.6, -6.2,  2.2,   .5,-10.2,
   4003      D   -.7, -7.4,  8.9,  7.9,  3.6,
   4004      E   -.4,  -.5, 13.3, 11.4,  5.2,
   4005      F   1.2,  7.8, 18.6, 10.7, -1.3,
   4006      G   9.5, 15.3, 21.2, 10.0, 10.0/
   4007  
   4008  
   4009 C     (U.S.) VIZ TYPE A PRESSURE-COMMUTATED
   4010 C     ====> JTYPE = 010  --  ITAB = 2  <====
   4011  
   4012       DATA  USVIZA  /
   4013 C       NITE   -10    15    30    60  Solar Angle
   4014 C        ___   ___   ___   ___   ___
   4015 C LEVEL
   4016      1   3.7, -9.9, -8.2,-14.9,   .5,
   4017      2   -.1,  -.7,  -.3, -1.1,  7.1,
   4018      3    .9,  3.0,  2.4,  3.1,  5.5,
   4019      4   1.5,  2.2,  1.7,  5.3,  1.2,
   4020      5    .0,   .0,  -.6,  5.3,   .0,
   4021      6  -1.3,  -.1,  -.4,  6.3,  1.3,
   4022      7   -.5,  1.9,  2.4,  9.4,  4.3,
   4023      8   1.5,  1.7,  1.5, 11.8,  6.3,
   4024      9   3.0, -1.3, -4.6, 10.9,  5.3,
   4025      A    .9, -1.2,-10.9,  6.5,   .9,
   4026      B  -3.1,   .1, -9.3,  4.3, -3.0,
   4027      C  -1.3, -1.7,  3.4,  8.7,  3.7,
   4028      D   1.9,  1.2, 14.0, 14.5, 11.0,
   4029      E   3.4,  5.5, 21.1, 20.3, 11.4,
   4030      F  13.3,  7.5, 25.8, 22.5,   .9,
   4031      G  27.5, 28.0, 29.0, 22.5, 22.5/
   4032  
   4033  
   4034 C       (U.S.) VIZ TYPE B TIME-COMMUTATED
   4035 C     ====> JTYPE = 011  --  ITAB = 3  <====
   4036  
   4037       DATA  USVIZB  /
   4038 C       NITE   -10    15    30    60  Solar Angle
   4039 C        ___   ___   ___   ___   ___
   4040 C LEVEL
   4041      1  -9.5,  2.9,  1.6,-22.5,-22.5,
   4042      2  -5.1, -1.8,  1.2, -1.9, -1.9,
   4043      3  -2.9, -1.2,   .6,  1.6,  1.6,
   4044      4  -2.1, -1.0,  -.1,  -.4,  -.4,
   4045      5  -2.1, -1.6,  -.9,  2.1,  2.1,
   4046      6  -2.2,  -.7,   .1,  4.6,  4.6,
   4047      7   -.8,  1.7,  2.8,  3.1,  3.1,
   4048      8    .0,  1.0,  3.4,  2.1,  2.1,
   4049      9  -1.5, -2.7,   .8, -2.5, -2.5,

Page 88          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4050      A  -3.4, -2.5,  1.7, -3.0, -3.0,
   4051      B  -4.0, -1.0,  6.7,   .4,   .4,
   4052      C  -3.3,   .3,  9.3, -5.0, -5.0,
   4053      D  -3.5,  2.8, 13.4, -1.6, -1.6,
   4054      E  -6.3,  4.9, 20.0, 20.4, 20.4,
   4055      F  -8.9,  8.2, 24.8, 34.6, 34.6,
   4056      G  -8.9, 10.0, 26.2, 34.6, 34.6/
   4057  
   4058  
   4059 C        (U.S.) RS SDC (SPACE DATA CORP.)
   4060 C     ====> JTYPE = 012  --  ITAB = 4  <====
   4061  
   4062       DATA  USSDCP  /
   4063 C       NITE   -10    15    30    60  Solar Angle
   4064 C        ___   ___   ___   ___   ___
   4065 C LEVEL
   4066      1  -7.4,-28.8,-34.4,-35.8,-35.8,
   4067      2   1.3,-13.4, -3.5,  3.6,  3.6,
   4068      3    .6, -4.3,  1.2,  3.2,  3.2,
   4069      4   -.8,  3.2, -2.1,  -.5,  -.5,
   4070      5  -2.1,  4.8, -2.5,  -.9,  -.9,
   4071      6  -4.1,  4.6, -2.0,   .8,   .8,
   4072      7  -4.0, 10.0,  -.2,  3.9,  3.9,
   4073      8  -2.1, 15.5,  1.8,  7.8,  7.8,
   4074      9   2.9, 17.8,  4.8, 12.7, 12.7,
   4075      A   9.0, 22.3, 11.9, 15.8, 15.8,
   4076      B   6.4, 20.5, 10.5, 10.2, 10.2,
   4077      C   1.5,  7.8,  2.5,  4.5,  4.5,
   4078      D  -2.3,  2.0,  1.5,  4.6,  4.6,
   4079      E  -3.5,  9.0,  4.3, 10.6, 10.6,
   4080      F   1.5, 25.6,  8.0,  8.0,  8.0,
   4081      G  12.0, 18.4, 21.0, 21.0, 21.0/
   4082  
   4083  
   4084 C          INDIAN MET. SERVICE TYPE MK3
   4085 C     ====> JTYPE = 020  --  ITAB = 5  <====
   4086  
   4087       DATA  INDMK3  /
   4088 C       NITE   -10    15    30    60  Solar Angle
   4089 C        ___   ___   ___   ___   ___
   4090 C LEVEL
   4091      1  -3.7,  -.8,  4.3, 19.2, 19.2,
   4092      2  -3.5, -1.4,  2.3,  9.7,  9.7,
   4093      3    .1,  1.4,  3.5,  9.7,  9.7,
   4094      4   -.5,  1.9,  4.3, 11.0, 11.0,
   4095      5  -5.9,   .1,  3.6, 10.4, 10.4,
   4096      6  -8.7,   .5,  4.4, 10.8, 10.8,
   4097      7  -8.9,  3.8,  7.7, 16.2, 16.2,
   4098      8 -10.8,  3.4,  9.2, 19.7, 19.7,
   4099      9 -13.8, -2.1,  6.1, 16.1, 16.1,
   4100      A -15.9, -5.0,  3.1,  8.8,  8.8,
   4101      B -12.4,  -.6,  5.7,  4.3,  4.3,
   4102      C   -.6, 10.9, 14.4,  9.8,  9.8,
   4103      D   5.5, 19.5, 21.5, 19.2, 19.2,
   4104      E   1.8, 17.5, 19.2, 13.6, 13.6,
   4105      F  -3.6, 12.9, 13.0,  1.0,  1.0,
   4106      G  -1.6, 14.3, 11.4, -3.1, -3.1/

Page 89          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4107  
   4108  
   4109 C         (S. KOREA) VIZ/JIN YANG MARK I
   4110 C     ====> JTYPE = 021  --  ITAB = 6  <====
   4111  
   4112       DATA  KORMK1  /
   4113 C       NITE   -10    15    30    60  Solar Angle
   4114 C        ___   ___   ___   ___   ___
   4115 C LEVEL
   4116      1  -7.6, -3.5,-16.0,   .9,   .9,
   4117      2  -5.1, -2.6, -5.2,  -.1,  -.1,
   4118      3  -3.9, -2.1, -3.6,  -.9,  -.9,
   4119      4  -2.9, -3.5, -3.2,   .2,   .2,
   4120      5  -1.8, -3.8,  -.3,  2.8,  2.8,
   4121      6    .3,   .8,  3.7,  6.2,  6.2,
   4122      7   3.1, 13.6,  4.1,  9.9,  9.9,
   4123      8   4.3, 21.7,  5.1, 11.9, 11.9,
   4124      9    .8, 16.8,  7.0, 11.0, 11.0,
   4125      A  -4.7,  9.1,  4.4, 10.2, 10.2,
   4126      B  -7.4,  5.2,  1.3,  9.3,  9.3,
   4127      C  -7.6,  9.7,   .3,  6.2,  6.2,
   4128      D  -6.3, 11.4,  2.4,  6.6,  6.6,
   4129      E  -3.8, 13.7,  7.5, 11.3, 11.3,
   4130      F  -3.7, 17.1, 16.3, 15.8, 15.8,
   4131      G  -6.9, 13.0, 25.8, 18.6, 14.7/
   4132  
   4133  
   4134 C           (JAPAN) MEISEI RS2-80 
   4135 C     ====> JTYPE = 022  --  ITAB = 7  <====
   4136  
   4137       DATA  MEIS80  /
   4138 C       NITE   -10    15    30    60  Solar Angle
   4139 C        ___   ___   ___   ___   ___
   4140 C LEVEL
   4141      1 -10.6, 16.0,-14.7, -7.5,   .9,
   4142      2 -10.4, 14.5, -6.4, -3.1, -9.3,
   4143      3  -7.5,  1.4, -3.3, -1.6, -6.6,
   4144      4  -4.1, -4.7, -3.8,  -.1,   .8,
   4145      5  -2.1, -4.9, -2.9,  1.2,  3.1,
   4146      6  -1.1, -6.7, -1.5,  2.8,  3.4,
   4147      7    .1,-12.6,  1.1,  5.6,  5.6,
   4148      8  -1.0,-15.9,  5.0,  6.9,  7.4,
   4149      9  -5.1,-13.2,  5.8,  6.2,  7.1,
   4150      A  -8.2, -6.9,  5.5,  7.0,  7.5,
   4151      B  -8.7, -8.9,  4.3,  7.7,  7.7,
   4152      C  -7.2, -8.6,  4.0,  6.6,  4.6,
   4153      D  -1.3, -5.5,  6.8,  9.1,  4.4,
   4154      E   3.6, -6.4,  5.4, 11.9,  5.5,
   4155      F   4.9, -7.9,  1.6, 11.2,  6.2,
   4156      G   6.0,   .7,  6.8, 12.8, 12.8/
   4157  
   4158  
   4159 C        (SWITZERLAND) METEOLABOR BASORA
   4160 C     ====> JTYPE = 026  --  ITAB = 8  <====
   4161  
   4162       DATA  METEOB  /
   4163 C       NITE   -10    15    30    60  Solar Angle

Page 90          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4164 C        ___   ___   ___   ___   ___
   4165 C LEVEL
   4166      1  12.1,  4.4,  6.2, -9.7,-11.3,
   4167      2  12.1,  4.4,  6.2, -9.7,-11.3,
   4168      3   2.2,  2.3,  2.6, -3.7, -7.3,
   4169      4  -2.7,  1.0,  -.4, -1.4, -3.7,
   4170      5  -1.4,  1.8,  -.6,   .0,   .3,
   4171      6   -.4,  3.0,   .6,  1.7,  2.6,
   4172      7  -1.2,  3.2,  1.0,  1.4,  2.3,
   4173      8   -.8,  1.3,  1.2,   .8,  3.5,
   4174      9   -.6, -1.4,  3.4,  2.5,  9.1,
   4175      A  -1.7, -1.6,  4.7,  5.7, 14.0,
   4176      B   -.8,  -.7,  3.6,  6.4, 11.6,
   4177      C    .3,  -.6,  2.9,  4.3,  2.7,
   4178      D  -2.5, -1.0,  2.6,  1.2, -3.1,
   4179      E  -5.1,  1.9,  3.5,  1.0, -2.4,
   4180      F  -4.2,  3.9,  2.7,  3.7,  -.7,
   4181      G  -2.8,   .3, -4.6,  5.3,  1.0/
   4182  
   4183  
   4184 C            (RUSSIA) AVK-MRZ
   4185 C     ====> JTYPE = 027  --  ITAB = 9  <====
   4186  
   4187       DATA  RUSAVK  /
   4188 C       NITE   -10    15    30    60  Solar Angle
   4189 C        ___   ___   ___   ___   ___
   4190 C LEVEL
   4191      1   4.2, -2.2,  4.7,   .4,  -.4,
   4192      2  -1.6,   .1,  1.7,  -.4,  -.4,
   4193      3  -3.1,  1.7,  1.0,  -.3,  -.3,
   4194      4  -1.8,  2.0,  2.4,  1.4,  1.4,
   4195      5   -.3,  2.5,  4.8,  4.7,  4.7,
   4196      6    .0,  2.9,  5.5,  6.9,  9.3,
   4197      7   -.2,  1.1,  4.3,  6.1,  5.7,
   4198      8    .4,   .1,  4.7,  7.4,  5.6,
   4199      9   2.7,  3.3, 10.7, 14.2, 14.9,
   4200      A   4.2,  6.0, 14.6, 18.0, 22.6,
   4201      B   4.4,  5.9, 13.6, 16.8, 23.7,
   4202      C   3.2,  4.7, 11.3, 11.8, 11.8,
   4203      D   1.3,  4.1, 10.7,  8.0,  8.0,
   4204      E   -.1,  3.5, 12.5,  6.9,  6.9,
   4205      F  -1.0,  2.8, 15.5,  6.4,  6.4,
   4206      G   1.5,  6.1, 19.2,  7.6,  7.6/
   4207  
   4208  
   4209 C           (RUSSIA) METEORIT MARZ2-1 
   4210 C     ====> JTYPE = 028  --  ITAB = 10  <====
   4211  
   4212       DATA  RUSZ21  /
   4213 C       NITE   -10    15    30    60  Solar Angle
   4214 C        ___   ___   ___   ___   ___
   4215 C LEVEL
   4216      1  -3.3,  1.3, 10.2,  -.3,  -.3,
   4217      2  -3.1,  -.1,   .8,  2.5,  2.5,
   4218      3  -2.2,  1.8,  -.2,  1.4,  1.4,
   4219      4    .0,  3.6,  1.6,  1.7,  1.7,
   4220      5   2.7,  4.2,  3.6,  4.4,  4.4,

Page 91          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4221      6   4.1,  4.1,  3.8,  6.0,  6.0,
   4222      7   2.8,  1.9,  2.9,  5.5,  5.5,
   4223      8    .8,  -.7,  6.2,  9.9,  9.9,
   4224      9   1.4,  2.0, 14.1, 21.1, 21.1,
   4225      A   3.9,  5.8, 17.3, 26.3, 26.3,
   4226      B   5.5,  6.3, 16.7, 25.6, 25.6,
   4227      C   3.9,  6.4, 14.4, 22.7, 22.7,
   4228      D   -.4,  6.0, 12.1, 21.9, 21.9,
   4229      E  -5.1,  4.8, 11.6, 21.5, 21.5,
   4230      F  -8.3,  5.4, 12.9, 21.8, 21.8,
   4231      G  -6.3, 10.1, 17.9, 24.3, 24.3/
   4232  
   4233  
   4234 C          (RUSSIA) METEORIT MARZ2-2 
   4235 C     ====> JTYPE = 029  --  ITAB = 11  <====
   4236  
   4237       DATA  RUSZ22  /
   4238 C       NITE   -10    15    30    60  Solar Angle
   4239 C        ___   ___   ___   ___   ___
   4240 C LEVEL
   4241      1 -14.2,  1.9, -2.0, 11.0, 11.0,
   4242      2  -1.9, -5.1, -7.8,  5.3,  5.3,
   4243      3   3.1, -2.9, -3.8,  3.2,  3.2,
   4244      4   6.5,   .3,  2.3,  3.5,  3.5,
   4245      5   5.6,  2.2,  5.8,  6.3,  6.3,
   4246      6  -1.6,  1.3,  5.3,  8.7,  9.7,
   4247      7  -9.0, -2.2,   .9,  9.5,  9.5,
   4248      8  -9.1, -1.4,   .0, 11.4, 11.4,
   4249      9  -1.1,  4.8,  6.9, 16.0, 16.0,
   4250      A   4.5,  7.5, 11.2, 18.7, 18.7,
   4251      B   4.7,  6.9, 13.7, 17.6, 17.6,
   4252      C   1.9,  7.0, 16.0, 13.4, 13.4,
   4253      D  -1.2,  8.2, 15.5, 11.2, 11.2,
   4254      E  -3.1,  8.4, 12.1, 11.3, 14.4,
   4255      F  -1.9,  6.7,  6.4,  7.3,  7.3,
   4256      G   0.9,  7.7,  4.1,  1.8,  1.8/
   4257  
   4258  
   4259 C   (CHINA) SHANGHAI RADIO - PRIOR TO 1/1/2001
   4260 C     ====> JTYPE = 032  --  ITAB = 12  <====
   4261  
   4262       DATA  CHINSR  /
   4263 C       NITE   -10    15    30    60  Solar Angle
   4264 C        ___   ___   ___   ___   ___
   4265 C LEVEL
   4266      1  -4.1,  3.0,  2.3, -9.0, -9.0,
   4267      2   -.9,   .2,   .8, -2.9, -2.9,
   4268      3    .9,  2.0,  1.8,  1.2,  1.2,
   4269      4   2.9,  3.6,  4.9,  6.1,  6.1,
   4270      5   4.5,  5.1,  8.8, 11.2, 11.2,
   4271      6   5.2,  7.2, 11.3, 14.4, 14.4,
   4272      7   5.2,  8.0, 11.3, 14.6, 14.6,
   4273      8   5.1,  7.3, 10.7, 13.0, 13.0,
   4274      9   6.8,  7.2, 10.2, 12.2, 12.2,
   4275      A   7.6,  7.2,  8.4, 13.3, 13.3,
   4276      B   3.2,  3.9,  2.4,  9.3,  9.3,
   4277      C  -4.4, -2.7, -5.9,  -.1,  -.1,

Page 92          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4278      D  -8.7, -5.1, -8.1, -3.5, -3.5,
   4279      E -10.4,   .4, -3.4, -1.1, -1.1,
   4280      F -10.9,  8.8,  3.2,  1.4,  1.4,
   4281      G  -6.6, 17.0,  9.2,  5.0,  5.0/
   4282  
   4283  
   4284 C                VAISALA RS80
   4285 C     ====> JTYPE = 037  --  ITAB = 13  <====
   4286  
   4287       DATA  VARS80  /
   4288 C       NITE   -10    15    30    60  Solar Angle
   4289 C        ___   ___   ___   ___   ___
   4290 C LEVEL
   4291      1  -2.4,  3.4, -1.2,  2.0, -1.5,
   4292      2   3.5, -3.6,   .9,  4.5,  1.1,
   4293      3   3.6,  -.7,  1.0,  4.1,  1.3,
   4294      4    .9,  -.3,  1.0,  2.3,  2.0,
   4295      5   -.7,  -.2,   .7,  2.1,  2.7,
   4296      6   -.6,  1.0,   .6,  3.4,  3.2,
   4297      7    .5,  1.1,  1.2,  5.4,  4.5,
   4298      8   1.4, -1.0,  1.0,  6.8,  5.2,
   4299      9   1.2, -2.2,  1.1,  6.4,  5.3,
   4300      A  -1.0,  -.5,  2.9,  4.9,  3.7,
   4301      B  -3.5,   .7,  2.7,  3.2, -1.4,
   4302      C  -2.0,   .4,  -.5,  3.6, -3.8,
   4303      D   1.5,  -.1,  -.2,  6.3,  1.3,
   4304      E   1.5,  -.2,  4.7,  7.5,  8.8,
   4305      F  -1.1,  1.0,  5.3,  4.8, 16.8,
   4306      G   -.6,  5.4, -1.7,  5.2, 16.4/
   4307  
   4308  
   4309 C            (U.S.) AIR IS-4A-1680
   4310 C     ====> JTYPE = 043  --  ITAB = 14  <====
   4311  
   4312       DATA  AIRR80  /
   4313 C       NITE   -10    15    30    60  Solar Angle
   4314 C        ___   ___   ___   ___   ___
   4315 C LEVEL
   4316      1  -6.2,  4.6,  8.6, -8.9, -8.9,
   4317      2  -2.7, 10.0,   .7, -1.3, -1.3,
   4318      3   -.8,  8.0,   .8,   .9,   .9,
   4319      4   -.6,  4.7,  1.5,  4.0,  4.0,
   4320      5  -1.9,  -.2,   .2,  6.9,  6.9,
   4321      6  -3.4, -4.8,  -.1,  8.2,  8.2,
   4322      7  -3.8, -7.5,   .2,  9.2,  9.2,
   4323      8  -4.2, -5.8,  -.5, 10.5, 10.5,
   4324      9  -6.3,   .6, -3.7, 10.7, 10.7,
   4325      A  -7.4,  5.4, -8.6, 12.5, 12.5,
   4326      B  -5.7,  6.5, -8.1, 16.6, 16.6,
   4327      C  -1.5,  6.4,  2.4, 20.9, 20.3,
   4328      D   8.5,  6.0, 15.7, 27.7, 27.8,
   4329      E  20.9,  4.8, 23.3, 37.1, 37.1,
   4330      F  20.9, 18.3, 26.3, 45.2, 45.2,
   4331      G  20.9, 18.3, 26.3, 45.2, 45.2/
   4332  
   4333  
   4334 C            (U.S.) AIR IS-4A-1680 X 

Page 93          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4335 C     ====> JTYPE = 044  --  ITAB = 15  <====
   4336 C               (U.S.) RS MSS 
   4337 C     ====> JTYPE = 045  --  ITAB = 15  <====
   4338  
   4339       DATA  USRSMS  /
   4340 C       NITE   -10    15    30    60  Solar Angle
   4341 C        ___   ___   ___   ___   ___
   4342 C LEVEL
   4343      1  -5.7, -5.9, -9.5,  1.3,  6.3,
   4344      2  -3.0, -2.3,  2.3,  5.1,  5.9,
   4345      3    .0,  -.7,  1.0,  4.3,  2.4,
   4346      4  -1.3, -2.1,   .0,  1.6,   .0,
   4347      5  -3.1, -3.4,   .8,   .4, -2.2,
   4348      6  -3.3, -3.4,   .9,  -.5, -2.8,
   4349      7  -2.9, -2.3,  1.2, -1.2, -1.8,
   4350      8  -3.2, -2.6,  1.9, -1.3, -1.5,
   4351      9  -4.6, -4.3,  3.0, -1.4, -2.5,
   4352      A  -7.3, -3.8,  4.8, -1.7, -2.4,
   4353      B  -8.8, -3.8,  3.9,  1.9,  -.5,
   4354      C  -5.6, -2.9,  1.7, 14.2,  3.7,
   4355      D   -.3,   .5,  3.4, 15.1, 10.7,
   4356      E   2.8,  4.9,  8.2,  2.1, 15.1,
   4357      F   2.6, 10.5, 14.8, -9.8, 14.7,
   4358      G   4.1, 19.1, 29.1, -1.6, 16.9/
   4359  
   4360  
   4361 C             (U.S.) AIR IS-4A-403
   4362 C     ====> JTYPE = 046  --  ITAB = 16  <====
   4363  
   4364       DATA  AIR403  /
   4365 C       NITE   -10    15    30    60  Solar Angle
   4366 C        ___   ___   ___   ___   ___
   4367 C LEVEL
   4368      1  -9.4, 13.2, -2.1, -2.6, -2.6,
   4369      2   -.9,  1.0, -2.4,  1.8,  1.8,
   4370      3    .8,  -.5,  1.1,  3.8, 15.0,
   4371      4    .1,  2.7,   .8,  4.3, 14.4,
   4372      5   -.3,  5.3,  2.4,  5.0, 11.8,
   4373      6    .0,  5.0,  3.7,  5.1, 18.0,
   4374      7    .2,  3.7,  1.5,  4.9, 22.6,
   4375      8   1.3,  5.1, -1.1,  6.1, 21.8,
   4376      9   4.1,  6.6, -2.8,  7.7, 23.1,
   4377      A   4.2,  5.3, -4.1, 10.3, 27.7,
   4378      B   1.5,  3.2, -5.0, 13.5, 32.4,
   4379      C   1.3,  2.9, -6.9, 15.3, 15.3,
   4380      D   6.4,  5.7,  4.3, 20.6, 20.6,
   4381      E  15.1, 10.4, 21.5, 28.6, 28.6,
   4382      F  21.7, 14.0, 25.2, 30.3, 30.3,
   4383      G  27.5, 13.8, 21.4, 32.2, 32.2/
   4384  
   4385  
   4386 C             (JAPAN) MEISEI RS2-91
   4387 C     ====> JTYPE = 047  --  ITAB = 17  <====
   4388  
   4389       DATA  MEIS91  /
   4390 C       NITE   -10    15    30    60  Solar Angle
   4391 C        ___   ___   ___   ___   ___

Page 94          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4392 C LEVEL
   4393      1  -5.9, -6.7,  -.4,   .4,  -.6,
   4394      2  -4.3,  3.2,  2.8,  -.7, -1.6,
   4395      3  -2.7,   .9,  -.6, -2.1, -1.3,
   4396      4  -2.2, -2.3, -5.9, -2.3,  -.7,
   4397      5   -.9, -3.9, -4.4, -1.0, -3.0,
   4398      6   1.9, -5.7, -2.3,  1.3, -1.2,
   4399      7   4.7, -8.5, -2.3,  3.9,  2.9,
   4400      8   5.2, -6.1,   .1,  5.4,  4.3,
   4401      9   2.3,  1.1,  3.1,  4.6,  3.5,
   4402      A  -2.4,  1.9,  2.2,  3.7,  4.8,
   4403      B  -6.8, -1.5, -3.5,  1.7,  5.6,
   4404      C  -8.6, -4.5, -7.3, -2.1,  1.5,
   4405      D  -6.2, -7.3, -9.2, -2.0,   .4,
   4406      E  -3.0, -9.4,  -.8,   .3,  1.1,
   4407      F  -5.4, -9.4, 22.1,  1.5, -1.1,
   4408      G  -8.6, -7.5, 39.3,  4.7,   .0/
   4409  
   4410  
   4411 C               (U.S.) VIZ MARK II
   4412 C     ====> JTYPE = 049  --  ITAB = 18 <====
   4413  
   4414       DATA  VIZMK2  /
   4415 C       NITE   -10    15    30    60  Solar Angle
   4416 C        ___   ___   ___   ___   ___
   4417 C LEVEL
   4418      1   5.0, -1.8,  3.9,  3.2, -8.4,
   4419      2   3.0, -1.7,  2.4,  4.1, -3.0,
   4420      3    .5, -1.8,   .8,  3.5,  -.8,
   4421      4  -1.7, -1.7,  -.2,  2.3,  -.7,
   4422      5  -2.9,  -.5,   .5,  2.2,  -.1,
   4423      6  -2.5,  1.6,  1.7,  3.4,  1.3,
   4424      7  -1.9,  3.4,  2.7,  5.1,  2.7,
   4425      8  -1.7,  2.1,  2.7,  5.2,  3.4,
   4426      9  -1.2,  -.7,  1.9,  3.6,  2.3,
   4427      A  -2.1,  -.8,  3.2,  3.2,   .4,
   4428      B  -4.2,   .3,  4.5,  4.1,   .7,
   4429      C  -4.2,   .6,  4.3,  5.3,  5.4,
   4430      D  -3.2,   .9,  5.8,  8.5, 10.1,
   4431      E  -3.7,  1.9, 10.2, 14.0, 12.4,
   4432      F  -7.5,  3.0, 13.7, 17.9, 14.3,
   4433      G  -9.0,  4.8, 11.6, 16.4, 18.0/
   4434  
   4435  
   4436 C             (GERMANY) GRAW DFM-90
   4437 C     ====> JTYPE = 050  --  ITAB = 19  <====
   4438  
   4439       DATA  GRAW90  /
   4440 C       NITE   -10    15    30    60  Solar Angle
   4441 C        ___   ___   ___   ___   ___
   4442 C LEVEL
   4443      1   -.3,  2.6,  2.2,-10.1,-20.9,
   4444      2   -.3, -2.1,  4.6,  5.9, -3.7,
   4445      3  -1.3, -2.0,  2.4,  4.7, -2.0,
   4446      4  -2.7,  -.9,  1.6,  2.9, -1.2,
   4447      5  -2.8,  1.0,  3.3,  4.2,  3.6,
   4448      6   -.7,  4.0,  5.8,  7.2,  7.2,

Page 95          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4449      7   2.8,  7.0,  7.6,  9.3,  8.5,
   4450      8   4.0,  6.9,  7.8,  8.9,  9.4,
   4451      9   2.4,  4.5,  7.1,  8.5,  8.5,
   4452      A   1.8,  3.9,  7.7, 10.7, 10.7,
   4453      B   2.7,  4.3,  8.5, 11.3, 11.3,
   4454      C   2.8,  5.4,  8.9,  7.8,  7.8,
   4455      D   2.7,  9.7, 10.4,  4.5,  4.5,
   4456      E   2.2, 15.3, 12.0,  2.8,  2.8,
   4457      F   1.4, 19.6, 10.5,  1.1,  1.1,
   4458      G   4.7, 25.1,  8.5,  1.1,  1.1/
   4459  
   4460  
   4461 C                 (U.S.) VIZ-B2
   4462 C     ====> JTYPE = 051  --  ITAB = 20  <====
   4463  
   4464       DATA  USVZB2  /
   4465 C       NITE   -10    15    30    60  Solar Angle
   4466 C        ___   ___   ___   ___   ___
   4467 C LEVEL
   4468      1   -.7,   .8, -1.3,  2.7,  5.3,
   4469      2  -3.1, -2.5, -1.0,  4.4,  5.9,
   4470      3  -4.0, -2.1, -1.9,  2.9,  3.4,
   4471      4  -4.6, -1.9, -1.6,  -.8,   .6,
   4472      5  -4.5, -1.5,  -.1, -2.0, -1.7,
   4473      6  -3.9,   .0,  1.5,  -.8,  -.1,
   4474      7  -2.7,  1.8,  3.1,  1.9,  3.7,
   4475      8  -1.8,  1.4,  4.3,  4.0,  3.8,
   4476      9  -1.9,   .8,  5.7,  5.2,  2.0,
   4477      A  -1.1,  2.4,  8.6,  9.1,  3.4,
   4478      B  -1.5,  2.0,  9.0, 11.3,  7.4,
   4479      C  -4.8,  -.5,  6.8,  9.8, 11.3,
   4480      D  -8.2, -1.8,  6.0, 10.6, 14.5,
   4481      E -11.0,  -.3,  7.6, 13.0, 14.6,
   4482      F -11.6,  3.0,  9.9, 12.7,  8.2,
   4483      G  -8.4,  7.4, 12.8,  9.3,  -.3/
   4484  
   4485  
   4486 C               VAISALA RS8-57H
   4487 C     ====> JTYPE = 052  --  ITAB = 21  <====
   4488  
   4489       DATA  MICROA  /
   4490 C       NITE   -10    15    30    60  Solar Angle
   4491 C        ___   ___   ___   ___   ___
   4492 C LEVEL
   4493      1   5.5,  1.3,  1.3,  3.9,  5.3,
   4494      2   -.8, -3.1,  -.7,  1.8,  2.5,
   4495      3  -3.5, -3.5, -3.2,   .1,   .4,
   4496      4  -3.7, -3.2, -3.7, -1.6, -2.0,
   4497      5  -2.6, -2.5, -2.9, -2.7, -5.1,
   4498      6  -1.7, -1.1, -2.4, -2.9, -4.9,
   4499      7   -.9,   .6, -2.0, -3.0, -2.2,
   4500      8    .2,   .0, -2.1, -3.6, -2.5,
   4501      9   1.4, -1.7, -2.9, -4.0, -6.4,
   4502      A   2.2,  -.9, -2.4, -1.3, -8.8,
   4503      B    .5, -2.3, -3.3,  1.5, -7.3,
   4504      C  -3.6, -5.5, -7.0, -1.2, -3.5,
   4505      D  -6.0, -6.7, -9.1, -5.4,  -.8,

Page 96          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4506      E  -6.2, -5.3, -7.8, -6.6,   .1,
   4507      F  -4.7, -1.9, -4.7, -5.5, -7.8,
   4508      G    .0,  3.1,  -.4, -2.2,-16.4/
   4509  
   4510  
   4511 C             VAISALA RS80/MICROCORA
   4512 C     ====> JTYPE = 060  --  ITAB = 22  <====
   4513  
   4514       DATA  MICORA  /
   4515 C       NITE   -10    15    30    60  Solar Angle
   4516 C        ___   ___   ___   ___   ___
   4517 C LEVEL
   4518      1    .4,  -.2,  8.5,  2.2, -5.9,
   4519      2  -2.7, -4.8, -1.2, -5.7, -4.1,
   4520      3  -3.9, -1.5,  1.3, -2.9, -4.5,
   4521      4  -1.5,  4.6,  4.6,   .3, -2.6,
   4522      5    .9,  5.1,  3.4,  1.0,   .8,
   4523      6   1.2,  2.1,  -.1,   .6,  1.3,
   4524      7    .6, -2.1, -3.7,   .8,   .2,
   4525      8   1.2, -7.1, -7.0,  1.0,  2.3,
   4526      9   2.0, -8.9, -9.4,   .1,  4.4,
   4527      A  -1.3, -6.4, -7.8, -3.3,  2.6,
   4528      B  -6.2, -5.2, -8.1, -8.1, -2.2,
   4529      C  -3.7, -3.2, -8.2, -7.6, -7.6,
   4530      D   1.3, -1.5, -3.5, -3.6, -3.6,
   4531      E   2.7,   .0,  1.8, -1.2, -1.2,
   4532      F   3.4,  3.2,  6.4,  1.4,  1.4,
   4533      G   5.5,  7.7, 14.3,  5.2,  5.2/
   4534  
   4535  
   4536 C     VAISALA RS80/LORAN/DIGICORA OR MARWIN
   4537 C     ====> JTYPE = 061  --  ITAB = X  <====
   4538 C       (baseline for all corrections)
   4539  
   4540       DATA  DICORA  /
   4541 C       NITE   -10    15    30    60  Solar Angle
   4542 C        ___   ___   ___   ___   ___
   4543 C LEVEL
   4544      1    .0,   .0,   .0,   .0,   .0,
   4545      2    .0,   .0,   .0,   .0,   .0,
   4546      3    .0,   .0,   .0,   .0,   .0,
   4547      4    .0,   .0,   .0,   .0,   .0,
   4548      5    .0,   .0,   .0,   .0,   .0,
   4549      6    .0,   .0,   .0,   .0,   .0,
   4550      7    .0,   .0,   .0,   .0,   .0,
   4551      8    .0,   .0,   .0,   .0,   .0,
   4552      9    .0,   .0,   .0,   .0,   .0,
   4553      A    .0,   .0,   .0,   .0,   .0,
   4554      B    .0,   .0,   .0,   .0,   .0,
   4555      C    .0,   .0,   .0,   .0,   .0,
   4556      D    .0,   .0,   .0,   .0,   .0,
   4557      E    .0,   .0,   .0,   .0,   .0,
   4558      F    .0,   .0,   .0,   .0,   .0,
   4559      G    .0,   .0,   .0,   .0,   .0/
   4560  
   4561  
   4562 C              VAISALA RS80/PCCORA

Page 97          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4563 C     ====> JTYPE = 062  --  ITAB = 24  <====
   4564  
   4565       DATA  PCCORA  /
   4566 C       NITE   -10    15    30    60  Solar Angle
   4567 C        ___   ___   ___   ___   ___
   4568 C LEVEL
   4569      1  -4.5, -5.0, -5.3, -3.3, -7.7,
   4570      2  -1.4, -3.7, -3.3, -1.1, -4.2,
   4571      3  -1.0, -2.1, -2.0,  -.2, -3.8,
   4572      4  -1.1, -1.1,  -.8,  -.5, -2.0,
   4573      5   -.5,  -.3,  -.3,  -.1,   .3,
   4574      6    .4,   .9,  -.3,  1.3,  2.5,
   4575      7    .9,  2.6,   .1,  2.3,  3.5,
   4576      8    .7,  2.3,   .2,  2.3,  3.2,
   4577      9    .5,   .3,  -.8,   .7,  3.0,
   4578      A    .0, -1.0, -2.9, -1.4,  2.0,
   4579      B    .2, -1.5, -4.3, -2.4, -1.7,
   4580      C   1.3, -1.2, -3.1, -2.1, -6.0,
   4581      D   1.6,  -.4,  -.7, -1.6, -7.0,
   4582      E    .7,  1.7,  2.8,  -.4, -6.6,
   4583      F  -1.6,  4.5,  6.0,  1.0, -4.9,
   4584      G   -.9,  8.6,  6.8,  4.4,  1.8/
   4585  
   4586  
   4587 C              VAISALA RS80/STAR 
   4588 C     ====> JTYPE = 063  --  ITAB = 25  <====
   4589  
   4590       DATA  VASTAR  /
   4591 C       NITE   -10    15    30    60  Solar Angle
   4592 C        ___   ___   ___   ___   ___
   4593 C LEVEL
   4594      1  -1.1, -2.4,  8.3, 10.8,  4.6,
   4595      2   -.6,  1.3,  6.0,  4.1,   .7,
   4596      3  -1.0,  1.9,  3.4,  1.9,   .4,
   4597      4  -1.2,  1.8,  1.6,   .5,   .7,
   4598      5  -1.0,  1.7,   .7,  -.2,   .6,
   4599      6    .4,  1.4,   .6,  -.5,   .8,
   4600      7   2.9,  1.5,  1.4,  -.5,  2.1,
   4601      8   3.9,  1.2,  1.1, -1.2,  2.9,
   4602      9   1.4,  1.2,  -.4, -3.2,  1.2,
   4603      A  -1.5,  2.3, -1.1, -4.6, -2.3,
   4604      B  -1.1,  2.5, -1.2, -2.8, -2.8,
   4605      C   2.3,  2.5,   .0,   .8,   .4,
   4606      D   4.7,  3.1,  3.0,  2.8,  1.2,
   4607      E   2.6,  4.4,  6.8,  5.2,   .0,
   4608      F  -2.4,  7.3, 11.3,  8.1,  -.5,
   4609      G  -1.3, 14.2, 15.7, 13.1,  4.3/
   4610  
   4611  
   4612 C       VAISALA RS90/DIGICORA I,II OR MARWIN
   4613 C     ====> JTYPE = 071  --  ITAB = 26  <====
   4614  
   4615       DATA  VARS90  /
   4616 C       NITE   -10    15    30    60  Solar Angle
   4617 C        ___   ___   ___   ___   ___
   4618 C LEVEL
   4619      1  -3.6,  -.1, -3.8,-13.5, -6.9,

Page 98          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4620      2  -4.0, -2.9, -3.4, -6.7, -4.8,
   4621      3  -4.5, -2.3, -3.4, -5.3, -5.9,
   4622      4  -3.7, -1.4, -2.2, -4.7, -5.5,
   4623      5  -2.5,  -.9, -1.5, -3.6, -3.7,
   4624      6  -2.6,  -.2, -1.2, -2.0, -2.0,
   4625      7  -2.6,   .9,  -.4,  -.1, -1.1,
   4626      8   -.6,   .7,   .2,  2.1,   .5,
   4627      9   1.8,   .0,  1.3,  5.1,  4.5,
   4628      A   1.7,   .0,  3.2,  7.5,  9.1,
   4629      B    .7,  -.4,  2.9,  6.6, 11.5,
   4630      C   -.4, -1.3,   .4,  1.1,  6.0,
   4631      D  -1.7, -1.4,  -.6, -1.7,  1.6,
   4632      E  -3.7,  -.4,  1.7,  1.7,  2.6,
   4633      F  -4.0,  1.5,  5.7,  7.1,  6.1,
   4634      G   2.7,  7.4, 12.6, 14.3, 14.1/
   4635  
   4636  
   4637 C            (RUSSIA) AVK-RF95-ARMA
   4638 C     ====> JTYPE = 076  --  ITAB = 27  <====
   4639  
   4640       DATA  AVKR95  /
   4641 C       NITE   -10    15    30    60  Solar Angle
   4642 C        ___   ___   ___   ___   ___
   4643 C LEVEL
   4644      1  -2.1,  1.6, -7.8, 11.8, 11.8,
   4645      2  -6.2, -1.2, -4.1,  4.8,  4.8,
   4646      3  -4.7,  1.2, -1.2,  1.5,  1.5,
   4647      4  -3.0,  2.3,  1.5,  -.6,  -.6,
   4648      5  -3.9,  1.5,  1.7, -1.1, -1.1,
   4649      6  -2.8,   .0, -2.1, -2.3, -2.3,
   4650      7  -1.0, -3.1, -8.9, -5.3, -5.3,
   4651      8    .6, -4.1,-13.3, -2.3, -2.3,
   4652      9   3.3,  -.5, -2.6,  7.1,  7.1,
   4653      A   3.8,   .5,  7.4, 11.2, 11.2,
   4654      B   3.2,  1.4, 10.8, 12.3, 12.3,
   4655      C   -.9,  2.3,  9.8,  8.5,  8.5,
   4656      D  -4.1,   .7,  6.9,  3.8,  3.8,
   4657      E   -.5, -2.4,  4.2,  1.1,  4.4,
   4658      F   2.6, -5.8,  1.3, -1.0,  8.0,
   4659      G   2.6, -5.9,  1.3,  1.9, 16.2/
   4660 
   4661 
   4662 C    (CHINA) SHANGHAI RADIO - AFTER 12/31/2000
   4663 C     ====> JTYPE = 032  --  ITAB = 28  <====
   4664 
   4665       DATA  CHINSX  /
   4666 C       NITE   -10    15    30    60  Solar Angle
   4667 C        ___   ___   ___   ___   ___
   4668 C LEVEL
   4669      1  -4.1,  3.0,  2.3, -9.0, -9.0,
   4670      2   -.9,   .2,   .8, -2.9, -2.9,
   4671      3    .9,  2.0,  1.8,  1.2,  1.2,
   4672      4    .0,   .0,   .0,   .0,   .0,
   4673      5    .0,   .0,   .0,   .0,   .0,
   4674      6    .0,   .0,   .0,   .0,   .0,
   4675      7    .0,   .0,   .0,   .0,   .0,
   4676      8    .0,   .0,   .0,   .0,   .0,

Page 99          Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4677      9    .0,   .0,   .0,   .0,   .0,
   4678      A    .0,   .0,   .0,   .0,   .0,
   4679      B    .0,   .0,   .0,   .0,   .0,
   4680      C    .0,   .0,   .0,   .0,   .0,
   4681      D    .0,   .0,   .0,   .0,   .0,
   4682      E -10.4,   .4, -3.4, -1.1, -1.1,
   4683      F -10.9,  8.8,  3.2,  1.4,  1.4,
   4684      G  -6.6, 17.0,  9.2,  5.0,  5.0/
   4685  
   4686  
   4687 C      RADIOSONDE NOT SPECIFIED OR UNKNOWN
   4688 C     ====> JTYPE = 090  --  ITAB = X  <====
   4689 C            (no longer corrected)
   4690  
   4691       DATA  UNKN90  /
   4692 C       NITE   -10    15    30    60  Solar Angle
   4693 C        ___   ___   ___   ___   ___
   4694 C LEVEL
   4695      1  11.2,   .4, -9.9,-15.6,-15.6,
   4696      2   3.9,  1.5, -2.2, -8.9, -8.9,
   4697      3  -1.6,   .5,  -.7, -4.6, -4.6,
   4698      4  -3.2, -2.9, -1.0, -3.4, -3.4,
   4699      5  -3.1, -2.4,  -.1, -2.4, -2.4,
   4700      6  -3.1,  -.2,  1.0,  -.9,  -.9,
   4701      7  -3.0,  1.7,  2.1,  1.4,  1.4,
   4702      8  -1.2,  1.4,  3.0,  4.1,  4.1,
   4703      9   2.9,   .8,  4.1,  6.0,  6.0,
   4704      A   4.0,  4.4,  6.7,  7.0,  7.0,
   4705      B   -.2,  5.8,  8.9,  7.3,  7.3,
   4706      C  -4.1,  3.9,  9.0,  7.0,  6.3,
   4707      D  -7.2,  2.6,  8.9,  9.2, 10.8,
   4708      E  -8.1,  6.0, 12.2, 15.0, 15.0,
   4709      F  -3.5,  9.5, 16.3, 19.0, 19.0,
   4710      G   4.5,  8.0, 15.6, 21.7, 21.7/
   4711  
   4712 
   4713 C-----------------------------------------------------------------------
   4714 C-----------------------------------------------------------------------
   4715 
   4716       IRET = 0
   4717 
   4718 C  EACH TIME THROUGH, COMPUTE LOGS OF PRESSURE RATIOS
   4719 C  --------------------------------------------------
   4720 
   4721       ALP(1) = 0.0
   4722       DO I=2,16
   4723          ALP(I) = ALOG(PRES(I-1)/PRES(I))
   4724       ENDDO
   4725 
   4726 C  GET TABLE INDEX FROM RAOB TYPE - CHECK FOR VALID CORR. PARAMETERS
   4727 C  -----------------------------------------------------------------
   4728 
   4729       ITAB = 0
   4730       IF(JTYPE.GT.000.AND.JTYPE.LT.256) THEN
   4731          ITAB = ITYPTT(JTYPE)
   4732          IF(ITAB.LT.-3 .OR. (ITAB.GT.29.AND.ITAB.LT.101) .OR.
   4733      .      ITAB.GT.129)  THEN

Page 100         Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4734             WRITE(6,4)  SID(IS),JTYPE,ITAB
   4735             WRITE(68,4) SID(IS),JTYPE,ITAB
   4736 4        FORMAT(2X,'* * * STN ',A8,' WITH RAOB TYPE ',I5.3,' HAS AN ',
   4737      .    'INVALID CORRECTION TABLE ASSIGNMENT OF ',I5,' - NO ',
   4738      .    'CORRECTION POSSIBLE')
   4739             IRET = -1
   4740             RETURN
   4741          ELSE  IF(ITAB.EQ.0)  THEN
   4742             IRET = -1
   4743             RETURN
   4744          ELSE  IF(ITAB.EQ.-2)  THEN
   4745             WRITE(6,3)  SID(IS),JTYPE
   4746             WRITE(68,3) SID(IS),JTYPE
   4747 3        FORMAT(2X,'* * * STN ',A8,' HAS A VACANT RAOB TYPE ',I5.3,
   4748      .    ' BASED ON 11/2008 BUFR C. TBL (IT MAY NOW BE ASSIGNED?) - ',
   4749      .    'NO CORRECTION POSSIBLE')
   4750             IRET = -1
   4751             RETURN
   4752          ELSE  IF(ITAB.EQ.-1)  THEN
   4753             WRITE(6,2)  SID(IS),JTYPE
   4754             WRITE(68,2) SID(IS),JTYPE
   4755 2        FORMAT(2X,'* * * STN ',A8,' HAS OBSOLETE RAOB TYPE ',I5.3,
   4756      .    ' BASED ON 11/2008 BUFR C. TBL (WILL NEVER AGAIN BE USED) - ',
   4757      .    'NO CORRECTION POSSIBLE')
   4758             IRET = -1
   4759             RETURN
   4760          ELSE  IF(ITAB.EQ.-3)  THEN
   4761             WRITE(6,1)  SID(IS),JTYPE
   4762             WRITE(68,1) SID(IS),JTYPE
   4763             IRET = -1
   4764             RETURN
   4765          ELSE  IF(ITAB.GT.100)  THEN
   4766             WRITE(6,5)  SID(IS),JTYPE,ITAB-100
   4767             WRITE(68,5) SID(IS),JTYPE,ITAB-100
   4768 5        FORMAT(2X,'* * * STN ',A8,' HAS OBSOLETE RAOB TYPE ',I5.3,
   4769      .    ' BASED ON 11/2008 BUFR C. TBL (NEVER AGAIN USED), STILL IT ',
   4770      .    'USES CORR. TABLE ',I2)
   4771             ITAB = ITAB - 100
   4772          END IF
   4773          IF(ITAB.EQ.12 .AND. IDT.GE.12097440) THEN
   4774 
   4775 C  AFTER 12/31/00 USE CORRECTION TBL 28 FOR CHINA SHANGHAI RADIO SONDES
   4776 C  --------------------------------------------------------------------
   4777 
   4778             ITAB = 28
   4779          END IF
   4780       ELSE
   4781          WRITE(6,1)  SID(IS),JTYPE
   4782          WRITE(68,1) SID(IS),JTYPE
   4783 1        FORMAT(2X,'* * * STN ',A8,' HAS AN INVALID RAOB TYPE ',I8.3,
   4784      .    ' - NO CORRECTION POSSIBLE')
   4785          IRET = -1
   4786          if(jtype.eq.20000)  iret = -99
   4787          RETURN
   4788       ENDIF
   4789 
   4790 C  GET SOLAR ELEVATION ANGLE ON ALL VALID MANDATORY LEVELS

Page 101         Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4791 C  -------------------------------------------------------
   4792 
   4793       CALL SOELAN(SOLAR)
   4794 
   4795 C  APPLY TEMPERATURE AND HEIGHT ADJUSTMENTS
   4796 C  DO NOT APPLY AN ADJUSTMENT BELOW 700 HPA
   4797 C  ----------------------------------------
   4798 
   4799       DTS = 0.
   4800       DHS = 0.
   4801       DO ILEV=4,16
   4802          ANGLE(2)  = CUTOFF(ILEV)
   4803 
   4804          IF(SOLAR(ILEV).GE.CUTOFF(ILEV))  THEN
   4805             IF(SOLAR(ILEV).LT.ANGLE(5)) THEN
   4806                DO K=3,5
   4807                   IF(SOLAR(ILEV).LT.ANGLE(K)) THEN
   4808                      TABU = TTAB(K  ,ILEV,ITAB)
   4809                      TABD = TTAB(K-1,ILEV,ITAB)
   4810                      DSUN=(SOLAR(ILEV)-ANGLE(K-1))/(ANGLE(K)-ANGLE(K-1))
   4811                      DTS(ILEV) = TABD + DSUN*(TABU-TABD)
   4812                      GO TO 10
   4813                   ENDIF
   4814                ENDDO
   4815             ELSE
   4816                DTS(ILEV) = TTAB(5,ILEV,ITAB)
   4817             ENDIF
   4818          ELSE
   4819 
   4820 C  IF ANGLE < CUTOFF (NIGHT), CORRECTION FROM 'NIGHT' VALUE IN TBL
   4821 C  --------------------------------------------------------------------
   4822 
   4823             DTS(ILEV) = TTAB(1,ILEV,ITAB)
   4824          ENDIF
   4825 
   4826 C  The constant is (R/(20*g)) = 1.46355
   4827 C  ------------------------------------
   4828 
   4829    10    CONTINUE
   4830          HYF = 1.46355*ALP(ILEV)
   4831          IF(ILEV.EQ.1) THEN
   4832             DHS(ILEV) = HYF*DTS(ILEV)
   4833          ELSE
   4834             DHS(ILEV) = DHS(ILEV-1) + HYF*(10.*DTS(ILEV-1)+DTS(ILEV))
   4835          ENDIF
   4836 
   4837 C  CORRECT DTS BY A FACTOR OF 10
   4838 C  -----------------------------
   4839 
   4840          DTS(ILEV) = .1*DTS(ILEV)
   4841 
   4842 C  SAVE AND APPLY THE CORRECTIONS
   4843 C  ------------------------------
   4844 
   4845          DHT(ILEV) = -DHS(ILEV)
   4846          DTP(ILEV) = -DTS(ILEV)
   4847 

Page 102         Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4848          IF(HGT(ILEV).LT.BMISS) HGT(ILEV) = HGT(ILEV) + DHT(ILEV)
   4849          IF(TMP(ILEV).LT.BMISS) TMP(ILEV) = TMP(ILEV) + DTP(ILEV)
   4850 
   4851       ENDDO
   4852 
   4853       RETURN
   4854       END


ENTRY POINTS

  Name              
                    
 radt5_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  4783                                                           4761,4762,4781,4782               
 10                         Label  4829                                                           4812                              
 2                          Label  4755                                                           4753,4754                         
 3                          Label  4747                                                           4745,4746                         
 4                          Label  4736                                                           4734,4735                         
 5                          Label  4768                                                           4766,4767                         
 AIR403                     Local  3886     R(4)            4     2     80       SAVE             4364                              
 AIRR80                     Local  3881     R(4)            4     2     80       SAVE             4312                              
 ALOG                       Func   4723                                 scalar                    4723                              
 ALP                        Local  3876     R(4)            4     1     16                        4721,4723,4830                    
 ANGLE                      Local  3876     R(4)            4     1     5                         3906,4802,4805,4807,4810          
 AVKR95                     Local  3878     R(4)            4     2     80       SAVE             4640                              
 BAL_DRIFT                  Scalar 3869     R(4)            4           scalar   COM                                                
 BMISS                      Scalar 3863     R(8)            8           scalar   COM              4848,4849                         
 BUFRLIB_MISSING            Common 3873                                 16                                                          
 CHINSR                     Local  3880     R(4)            4     2     80       SAVE             4262                              
 CHINSX                     Local  3885     R(4)            4     2     80       SAVE             4665                              
 CUTOFF                     Local  3875     R(4)            4     1     16                        3907,4802,4804                    
 DATE_IDT                   Common 3872                                 4                                                           
 DHR                        Scalar 3865     R(4)            4     1     999      COM                                                
 DHS                        Local  3876     R(4)            4     1     16                        4800,4832,4834,4845               
 DHT                        Scalar 3868     R(4)            4     1     16       COM              4845,4848                         
 DICORA                     Local  3884     R(4)            4     2     80       SAVE             4540                              
 DSUN                       Local  4810     R(4)            4           scalar                    4810,4811                         
 DTP                        Scalar 3868     R(4)            4     1     16       COM              4846,4849                         
 DTS                        Local  3876     R(4)            4     1     16                        4799,4811,4816,4823,4832,4834,4840
                                                                                                  ,4846                             
 ELV                        Scalar 3866     R(4)            4     1     999      COM                                                
 GRAW90                     Local  3882     R(4)            4     2     80       SAVE             4439                              
 HEADER                     Common 3865                                 35980                                                       
 HGT                        Scalar 3868     R(4)            4     1     16       COM              4848                              
 HGTTBL                     Scalar 3869     L(4)            4           scalar   COM                                                
 HYF                        Local  4830     R(4)            4           scalar                    4830,4832,4834                    
 I                          Local  4722     I(4)            4           scalar                    4722,4723                         
 IDT                        Scalar 3872     I(4)            4           scalar   COM              4773                              
 ILEV                       Local  4801     I(4)            4           scalar                    4801,4802,4804,4805,4807,4808,4809
                                                                                                  ,4810,4811,4816,4823,4830,4831,483

Page 103         Source Listing                  RADT5
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  2,4834,4840,4845,4846,4848,4849   
 IMISS                      Scalar 3873     I(4)            4           scalar   COM                                                
 INDMK3                     Local  3878     R(4)            4     2     80       SAVE             4087                              
 INM                        Scalar 3870     I(4)            4     1     16       COM                                                
 IRCTBL                     Scalar 3869     I(4)            4           scalar   COM                                                
 IRET                       Dummy  3860     I(4)            4           scalar   ARG,INOUT        4716,4739,4742,4750,4758,4763,4785
                                                                                                  ,4786                             
 IS                         Scalar 3871     I(4)            4           scalar   COM              4734,4735,4745,4746,4753,4754,4761
                                                                                                  ,4762,4766,4767,4781,4782         
 ISF                        Scalar 3867     I(4)            4     1     999      COM                                                
 ITAB                       Local  4729     I(4)            4           scalar                    4729,4731,4732,4733,4734,4735,4741
                                                                                                  ,4744,4752,4760,4765,4766,4767,477
                                                                                                  1,4773,4778,4808,4809,4816,4823   
 ITP                        Scalar 3866     I(4)            4     1     999      COM                                                
 ITYPTT                     Local  3887     I(4)            4     1     255                       3934,4731                         
 JTYPE                      Scalar 3868     I(4)            4           scalar   COM              4730,4731,4734,4735,4745,4746,4753
                                                                                                  ,4754,4761,4762,4766,4767,4781,478
                                                                                                  2,4786                            
 K                          Local  4806     I(4)            4           scalar                    4806,4807,4808,4809,4810          
 KMAX                       Scalar 3870     I(4)            4           scalar   COM                                                
 KMIN                       Scalar 3870     I(4)            4           scalar   COM                                                
 KORMK1                     Local  3878     R(4)            4     2     80       SAVE             4112                              
 LEVRAD                     Scalar 3869     I(4)            4           scalar   COM                                                
 LWCORR                     Scalar 3869     I(4)            4           scalar   COM                                                
 MEIS80                     Local  3879     R(4)            4     2     80       SAVE             4137                              
 MEIS91                     Local  3882     R(4)            4     2     80       SAVE             4389                              
 METEOB                     Local  3886     R(4)            4     2     80       SAVE             4162                              
 MICORA                     Local  3883     R(4)            4     2     80       SAVE             4514                              
 MICROA                     Local  3883     R(4)            4     2     80       SAVE             4489                              
 NEV                        Scalar 3867     I(4)            4           scalar   COM                                                
 NLV                        Scalar 3866     I(4)            4           scalar   COM                                                
 NLVM                       Scalar 3867     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 3867     I(4)            4           scalar   COM                                                
 NST                        Param  3861     I(4)            4           scalar                    3865,3866,3867                    
 PCCORA                     Local  3884     R(4)            4     2     80       SAVE             4565                              
 PMAND                      Common 3870                                 136                                                         
 PRES                       Scalar 3870     R(4)            4     1     16       COM              4723                              
 RADCOM                     Common 3868                                 260                                                         
 RADT5                      Subr   3860                                                                                             
 RUSAVK                     Local  3879     R(4)            4     2     80       SAVE             4187                              
 RUSZ21                     Local  3879     R(4)            4     2     80       SAVE             4212                              
 RUSZ22                     Local  3880     R(4)            4     2     80       SAVE             4237                              
 SID                        Scalar 3865     CHAR            8     1     999      COM              4734,4735,4745,4746,4753,4754,4761
                                                                                                  ,4762,4766,4767,4781,4782         
 SOELAN                     Subr   4793                                                           4793                              
 SOLAR                      Local  3876     R(4)            4     1     16                        4793,4804,4805,4807,4810          
 SQN                        Scalar 3866     R(4)            4     1     999      COM                                                
 STN                        Common 3871                                 4                                                           
 SWITCH                     Common 3869                                 20                                                          
 TABD                       Local  4809     R(4)            4           scalar                    4809,4811                         
 TABU                       Local  4808     R(4)            4           scalar                    4808,4811                         
 TMP                        Scalar 3868     R(4)            4     1     16       COM              4849                              
 TTAB                       Local  3875     R(4)            4     3     2320                      4808,4809,4816,4823               
 UNKN09                     Local  3885     R(4)            4     2     80       SAVE             3987                              
 UNKN90                     Local  3885     R(4)            4     2     80       SAVE             4691                              

Page 104         Source Listing                  RADT5
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 USRSMS                     Local  3881     R(4)            4     2     80       SAVE             4339                              
 USSDCP                     Local  3877     R(4)            4     2     80       SAVE             4062                              
 USVIZA                     Local  3877     R(4)            4     2     80       SAVE             4012                              
 USVIZB                     Local  3877     R(4)            4     2     80       SAVE             4037                              
 USVZB2                     Local  3883     R(4)            4     2     80       SAVE             4464                              
 VARS80                     Local  3881     R(4)            4     2     80       SAVE             4287                              
 VARS90                     Local  3886     R(4)            4     2     80       SAVE             4615                              
 VASTAR                     Local  3884     R(4)            4     2     80       SAVE             4590                              
 VIZMK2                     Local  3882     R(4)            4     2     80       SAVE             4414                              
 XMISS                      Scalar 3873     R(4)            4           scalar   COM                                                
 XOB                        Scalar 3865     R(4)            4     1     999      COM                                                
 YOB                        Scalar 3865     R(4)            4     1     999      COM                                                

Page 105         Source Listing                  RADT5
2017-04-18 11:07                                 radcor.f

   4855 
   4856 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4857 C
   4858 C SUBPROGRAM:    RSTATS      ACCUMS STATS FOR INTERSONDE CORRECTIONS
   4859 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2002-07-22
   4860 C
   4861 C ABSTRACT: ACCUMULATES STATISTICS INCLUDING BIAS, RMS AND MAXIMUM
   4862 C   DIFFERENCE FOR EACH UNCORRECTED VS. CORRECTED "ADPUPA" MASS
   4863 C   REPORT'S HEIGHT OR TEMPERATURE ON ALL MANDATORY PRESSURE LEVELS.
   4864 C   ENTRY LSTATS COMPUTES THE THE ABOVE STATISTICS FOR PRINT OUTPUT.
   4865 C
   4866 C PROGRAM HISTORY LOG:
   4867 C   UNKNOWN   G. D. DIMEGO
   4868 C 1990-12-06  D. A. KEYSER --  CONVERTED TO VS FORTRAN (77) AND
   4869 C     RESTRUCTURED; COMBINED OLD SUBR. RSTATS AND TSTATS WHICH DID
   4870 C     HGHT AND TEMP. CALC. SEPARATELY
   4871 C 2002-07-22  D. A. KEYSER --  CORRECTED ERROR WHICH DID NOT ADJUST
   4872 C     SCALE FOR TEMPERATURE MEAN AND RMS AND HEIGHT RMS IN FINAL
   4873 C     PRINTOUT WHEN THERE WAS ONLY ONE STATION IN SAMPLE
   4874 C
   4875 C USAGE:    CALL RSTATS(IVAR,ZIN,ZOUT,XI,YJ,KP)
   4876 C   INPUT ARGUMENT LIST:
   4877 C     IVAR     - INTEGER INDICATING VARIABLE FOR WHICH STATS ARE
   4878 C              - GENERATED (=1-HEIGHT; =2-TEMPERATURE)
   4879 C     ZIN      - REAL UNCORRECTED VARIABLE {HGHT(M), TEMP(*10 DEG. C)}
   4880 C     ZOUT     - REAL CORRECTED VARIABLE {HGHT(M), TEMP(*10 DEG. C)}
   4881 C     XI       - REAL STATION LONGITUDE (DEG. WEST *100)
   4882 C     YJ       - REAL STATION LATITUDE (DEG. NORTH *100)
   4883 C     KP       - INTEGER MANDATORY PRESSURE LEVEL (MB)
   4884 C
   4885 C   OUTPUT FILES:
   4886 C     UNIT 06  - PRINTOUT
   4887 C     UNIT 68  - RADCOR INFORMATION FILE
   4888 C
   4889 C REMARKS: CALLED BY SUBROUTINE "RADEVN".  ENTRY LSTATS CALLED BY
   4890 C   SUBROUTINE "DMA22".
   4891 C
   4892 C ATTRIBUTES:
   4893 C   LANGUAGE: FORTRAN 90
   4894 C   MACHINE:  NCEP WCOSS
   4895 C
   4896 C$$$
   4897       SUBROUTINE RSTATS(IVAR,ZIN,ZOUT,XI,YJ,KP)
   4898       LOGICAL  INIT
   4899       REAL(8) BMISS
   4900       REAL  STATS(8,21,2)
   4901       INTEGER  IMAX(21,2),JMAX(21,2),IPMAND(21)
   4902 
   4903       COMMON/SWITCH/LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
   4904       COMMON /TESTS/   TEST
   4905       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   4906 
   4907       LOGICAL HGTTBL, TEST
   4908       DATA  INIT/.TRUE./,IPMAND/1000,925,850,700,500,400,300,250,200,
   4909      $ 150,100,70,50,30,20,10,7,5,3,2,1/
   4910       SAVE INIT,STATS,IMAX,JMAX,IPMAND
   4911 

Page 106         Source Listing                  RSTATS
2017-04-18 11:07                                 radcor.f

   4912 C  FIRST TIME THRU SET ALL STATISTICAL VARIABLES TO ZERO
   4913 C  -----------------------------------------------------
   4914 
   4915       IF(INIT)  THEN
   4916         DO K=1,2
   4917           DO J=1,21
   4918             IMAX(J,K) = 0.0
   4919             JMAX(J,K) = 0.0
   4920           ENDDO
   4921         ENDDO
   4922         DO K=1,2
   4923           DO J=1,21
   4924             DO I=1,8
   4925               STATS(I,J,K) = 0.0
   4926             ENDDO
   4927           ENDDO
   4928         ENDDO
   4929         INIT = .FALSE.
   4930       END IF
   4931 
   4932       DO I=1,21
   4933          K = I
   4934          IF(KP.GE.IPMAND(I))  GO TO 11
   4935       ENDDO
   4936       RETURN
   4937    11 CONTINUE
   4938 
   4939 C  ACCUMULATE COUNT AND VARIOUS SUMS
   4940 C  ---------------------------------
   4941 
   4942       IF(ABS(ZOUT)+ABS(ZIN).GE.0.5*BMISS) RETURN
   4943       ZDIF = ZOUT - ZIN
   4944       STATS(8,K,IVAR) = STATS(8,K,IVAR) + 1.
   4945       STATS(1,K,IVAR) = STATS(1,K,IVAR) + ZIN
   4946       STATS(2,K,IVAR) = STATS(2,K,IVAR) + ZOUT
   4947       STATS(3,K,IVAR) = STATS(3,K,IVAR) + ZDIF
   4948       STATS(4,K,IVAR) = STATS(4,K,IVAR) + (ZIN * ZIN)
   4949       STATS(5,K,IVAR) = STATS(5,K,IVAR) + (ZOUT * ZOUT)
   4950       STATS(6,K,IVAR) = STATS(6,K,IVAR) + (ZDIF * ZDIF)
   4951 
   4952 C  FIND REPORT WITH MAXIMUM DIFFERENCE
   4953 C  -----------------------------------
   4954 
   4955       IF(ABS(ZDIF).GT.STATS(7,K,IVAR)) THEN
   4956          STATS(7,K,IVAR) = ABS(ZDIF)
   4957          IMAX(K,IVAR) = REAL(XI)
   4958          JMAX(K,IVAR) = REAL(YJ)
   4959       ENDIF
   4960       RETURN
   4961 
   4962 C  COMPUTE AND PRINT OUT STATISTICS -- ENTRY LSTATS
   4963 C  ------------------------------------------------
   4964 
   4965          ENTRY LSTATS(IVAR)
   4966 
   4967       IF(IVAR.EQ.1) THEN
   4968          PRINT 20

Page 107         Source Listing                  RSTATS
2017-04-18 11:07                                 radcor.f

   4969          WRITE(68,20)
   4970          SCALE = 1.0
   4971       ELSE
   4972          PRINT 920
   4973          WRITE(68,920)
   4974          SCALE = 10.0
   4975       ENDIF
   4976 
   4977       DO K=1,21
   4978 
   4979          COUNT = AMAX1(1.0,STATS(8,K,IVAR))
   4980 cdakcdak IF(COUNT.GT.1.) THEN
   4981          IF(COUNT.GT.0.) THEN
   4982            COUNT = 1.0/COUNT
   4983            DO I=1,3
   4984              IF(STATS(I,K,IVAR) * COUNT .NE. 0.)
   4985      &       STATS(I,K,IVAR)   = (STATS(I,K,IVAR) * COUNT)/SCALE
   4986              IF(STATS(I+3,K,IVAR) * COUNT .NE. 0.)
   4987      &       STATS(I+3,K,IVAR) = (SQRT(STATS(I+3,K,IVAR)*COUNT))/SCALE
   4988            ENDDO
   4989            IF(STATS(7,K,IVAR) .NE. 0.)
   4990      &     STATS(7,K,IVAR) = STATS(7,K,IVAR)/SCALE
   4991          ENDIF
   4992       ENDDO
   4993 
   4994       DO K=21,1,-1
   4995          IF(K.GE.LEVRAD) THEN
   4996             KNT = IFIX(STATS(8,K,IVAR))
   4997             PRINT 30, KNT,IPMAND(K),(STATS(I,K,IVAR),I=1,3),
   4998      $       (STATS(I,K,IVAR),I=6,7),IMAX(K,IVAR),JMAX(K,IVAR)
   4999             WRITE(68,30) KNT,IPMAND(K),(STATS(I,K,IVAR),I=1,3),
   5000      $       (STATS(I,K,IVAR),I=6,7),IMAX(K,IVAR),JMAX(K,IVAR)
   5001          ENDIF
   5002       ENDDO
   5003 
   5004       RETURN
   5005 
   5006    20 FORMAT(//27X,'***** STATISTICAL ANALYSIS BY PRESSURE FOR INTERSO',
   5007      $ 'NDE HEIGHT CORRECTIONS *****'//3X,'COUNT',5X,'PRESSURE',3X,'UN',
   5008      $ 'CORR. MEAN',3X,'CORRECTED MEAN',7X,'BIAS',12X,'RMS',10X,'MAXDI',
   5009      $ 'F',4X,'AT',4X,'LON*100',8X,'LAT*100',/,15X,'(MB)',11X,'(M)',12X,
   5010      $ '(M)',13X,'(M)',12X,'(M)',12X,'(M)',10X,'(DEG. W)',7X,'(DEG. N)')
   5011   920 FORMAT(//24X,'***** STATISTICAL ANALYSIS BY PRESSURE FOR INTERSO',
   5012      $ 'NDE TEMPERATURE CORRECTIONS *****',//,3X,'COUNT',5X,'PRESSURE',
   5013      $ 3X,'UNCORR. MEAN',3X,'CORRECTED MEAN',7X,'BIAS',12X,'RMS',10X,
   5014      $ 'MAXDIF',4X,'AT',4X,'LON*100',8X,'LAT*100',
   5015      $ /,15X,'(MB)',8X,'(DEG. C)',7X,'(DEG. C)',8X,'(DEG. C)',
   5016      $ 7X,'(DEG. C)',7X,'(DEG. C)',8X,'(DEG. W)',7X,'(DEG. N)')
   5017    30 FORMAT(I7,5X,I6,7X,5(F10.3,5X),3X,2(I7,8X))
   5018 
   5019       END

Page 108         Source Listing                  RSTATS
2017-04-18 11:07 Entry Points                    radcor.f



ENTRY POINTS

  Name                  Name               
                                           
 lstats_               rstats_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  4937                                                           4934                              
 20                         Label  5006                                                           4968,4969                         
 30                         Label  5017                                                           4997,4999                         
 920                        Label  5011                                                           4972,4973                         
 ABS                        Func   4942                                 scalar                    4942,4955,4956                    
 AMAX1                      Func   4979                                 scalar                    4979                              
 BAL_DRIFT                  Scalar 4903     R(4)            4           scalar   COM                                                
 BMISS                      Scalar 4899     R(8)            8           scalar   COM              4942                              
 BUFRLIB_MISSING            Common 4905                                 16                                                          
 COUNT                      Local  4979     R(4)            4           scalar                    4979,4981,4982,4984,4985,4986,4987
 HGTTBL                     Scalar 4903     L(4)            4           scalar   COM                                                
 I                          Local  4924     I(4)            4           scalar                    4924,4925,4932,4933,4934,4983,4984
                                                                                                  ,4985,4986,4987,4997,4998,4999,500
                                                                                                  0                                 
 IFIX                       Func   4996                                 scalar                    4996                              
 IMAX                       Local  4901     I(4)            4     2     42       SAVE             4918,4957,4998,5000               
 IMISS                      Scalar 4905     I(4)            4           scalar   COM                                                
 INIT                       Local  4898     L(4)            4           scalar   SAVE             4908,4915,4929                    
 IPMAND                     Local  4901     I(4)            4     1     21       SAVE             4908,4934,4997,4999               
 IRCTBL                     Scalar 4903     I(4)            4           scalar   COM                                                
 IVAR                       Dummy  4897     I(4)            4           scalar   ARG,INOUT        4944,4945,4946,4947,4948,4949,4950
                                                                                                  ,4955,4956,4957,4958,4967,4979,498
                                                                                                  4,4985,4986,4987,4989,4990,4996,49
                                                                                                  97,4998,4999,5000                 
 J                          Local  4917     I(4)            4           scalar                    4917,4918,4919,4923,4925          
 JMAX                       Local  4901     I(4)            4     2     42       SAVE             4919,4958,4998,5000               
 K                          Local  4916     I(4)            4           scalar                    4916,4918,4919,4922,4925,4933,4944
                                                                                                  ,4945,4946,4947,4948,4949,4950,495
                                                                                                  5,4956,4957,4958,4977,4979,4984,49
                                                                                                  85,4986,4987,4989,4990,4994,4995,4
                                                                                                  996,4997,4998,4999,5000           
 KNT                        Local  4996     I(4)            4           scalar                    4996,4997,4999                    
 KP                         Dummy  4897     I(4)            4           scalar   ARG,INOUT        4934                              
 LEVRAD                     Scalar 4903     I(4)            4           scalar   COM              4995                              
 LSTATS                     Subr   4965                                                                                             
 LWCORR                     Scalar 4903     I(4)            4           scalar   COM                                                
 REAL                       Func   4957                                 scalar                    4957,4958                         
 RSTATS                     Subr   4897                                                                                             
 SCALE                      Local  4970     R(4)            4           scalar                    4970,4974,4985,4987,4990          
 SQRT                       Func   4987                                 scalar                    4987                              
 STATS                      Local  4900     R(4)            4     3     336      SAVE             4925,4944,4945,4946,4947,4948,4949
                                                                                                  ,4950,4955,4956,4979,4984,4985,498
                                                                                                  6,4987,4989,4990,4996,4997,4998,49
                                                                                                  99,5000                           

Page 109         Source Listing                  RSTATS
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SWITCH                     Common 4903                                 20                                                          
 TEST                       Scalar 4904     L(4)            4           scalar   COM                                                
 TESTS                      Common 4904                                 4                                                           
 XI                         Dummy  4897     R(4)            4           scalar   ARG,INOUT        4957                              
 XMISS                      Scalar 4905     R(4)            4           scalar   COM                                                
 YJ                         Dummy  4897     R(4)            4           scalar   ARG,INOUT        4958                              
 ZDIF                       Local  4943     R(4)            4           scalar                    4943,4947,4950,4955,4956          
 ZIN                        Dummy  4897     R(4)            4           scalar   ARG,INOUT        4942,4943,4945,4948               
 ZOUT                       Dummy  4897     R(4)            4           scalar   ARG,INOUT        4942,4943,4946,4949               

Page 110         Source Listing                  RSTATS
2017-04-18 11:07                                 radcor.f

   5020 
   5021 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
   5022 C
   5023 C SUBPROGRAM: PILNLNP        PRESSURE INTERPOLATION LINEAR IN LOG P
   5024 C   PRGMMR: WOOLLEN          ORG: W/NMC22    DATE: 92-07-29
   5025 C
   5026 C ABSTRACT: FUNCTION WHICH GIVEN AN PROFILE OF DESCENDING PRESSURES
   5027 C   AND A PROFILE OF QUANTITIES VALID AT THOSE PRESSURES, RETURNS
   5028 C   AN INTERPOLATED QUANTITY VALID AT A GIVEN ARBITRARY PRESSURE.
   5029 C
   5030 C PROGRAM HISTORY LOG:
   5031 C   86-03-21  G. DIMEGO
   5032 C   88-11-24  D. DEAVEN RECODED FOR CYBER 205
   5033 C
   5034 C USAGE:    X = PILNLNP(P,PARAY,QARAY,KMAX)
   5035 C
   5036 C   INPUT ARGUMENTS:
   5037 C     P       - PRESSURE TO INTERPOLATE TO
   5038 C     PARAY   - GIVEN PRESSURE PROFILE
   5039 C     QARAY   - QUANTITIES VALID FOR PRESSURE PROFILE
   5040 C     KMAX    - LENGTH OF PROFILE
   5041 C
   5042 C   FUNCTION RETURN VALUE
   5043 C     PILNLNP - INTERPOLATED QUANTITY
   5044 C
   5045 C ATTRIBUTES:
   5046 C   LANGUAGE: FORTRAN 90
   5047 C   MACHINE:  NCEP WCOSS
   5048 C
   5049 C$$$
   5050       FUNCTION PILNLNP(P,PARAY,QARAY,KMAX)
   5051 
   5052       REAL(8) BMISS
   5053 
   5054       DIMENSION PARAY(KMAX),QARAY(KMAX)
   5055 
   5056       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5057 
   5058       PILNLNP = 0.
   5059 
   5060 C  FIND ADJACENT LEVELS
   5061 C  --------------------
   5062 
   5063       DO LA=1,KMAX
   5064          IF(P.GE.PARAY(LA)) EXIT
   5065       END DO
   5066 
   5067       IF(LA.GT.KMAX) THEN
   5068          LA = KMAX
   5069          LB = KMAX
   5070       ELSE IF(LA.EQ.1) THEN
   5071          LA = 1
   5072          LB = 1
   5073       ELSE
   5074          LB = LA-1
   5075       ENDIF
   5076 

Page 111         Source Listing                  PILNLNP
2017-04-18 11:07                                 radcor.f

   5077 C  INTERPOLATE IF BOTH ADJACENT VALUES PRESENT
   5078 C  -------------------------------------------
   5079 
   5080       IF(QARAY(LA).LT.BMISS .AND. QARAY(LB).LT.BMISS) THEN
   5081          PA = PARAY(LA)
   5082          PB = PARAY(LB)
   5083          IF(PA.NE.PB) THEN
   5084             WK = LOG(P/PB) / LOG(PA/PB)
   5085          ELSE
   5086             WK = 0.
   5087          ENDIF
   5088          PILNLNP = QARAY(LB) + (QARAY(LA)-QARAY(LB)) * WK
   5089       ENDIF
   5090 
   5091       RETURN
   5092       END


ENTRY POINTS

  Name                
                      
 pilnlnp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 5052     R(8)            8           scalar   COM              5080                              
 BUFRLIB_MISSING            Common 5056                                 16                                                          
 IMISS                      Scalar 5056     I(4)            4           scalar   COM                                                
 KMAX                       Dummy  5050     I(4)            4           scalar   ARG,INOUT        5054,5063,5067,5068,5069          
 LA                         Local  5063     I(4)            4           scalar                    5063,5064,5067,5068,5070,5071,5074
                                                                                                  ,5080,5081,5088                   
 LB                         Local  5069     I(4)            4           scalar                    5069,5072,5074,5080,5082,5088     
 LOG                        Func   5084                                 scalar                    5084                              
 P                          Dummy  5050     R(4)            4           scalar   ARG,INOUT        5064,5084                         
 PA                         Local  5081     R(4)            4           scalar                    5081,5083,5084                    
 PARAY                      Dummy  5050     R(4)            4     1     0        ARG,INOUT        5064,5081,5082                    
 PB                         Local  5082     R(4)            4           scalar                    5082,5083,5084                    
 PILNLNP                    Func   5050     R(4)            4           scalar                    5058,5088                         
 PILNLNP@0                  Local  5050     R(4)            4           scalar                                                      
 QARAY                      Dummy  5050     R(4)            4     1     0        ARG,INOUT        5080,5088                         
 WK                         Local  5084     R(4)            4           scalar                    5084,5086,5088                    
 XMISS                      Scalar 5056     R(4)            4           scalar   COM                                                

Page 112         Source Listing                  PILNLNP
2017-04-18 11:07                                 radcor.f

   5093 
   5094 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5095 C
   5096 C SUBPROGRAM:    SOELAN
   5097 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2008-10-08
   5098 C
   5099 C ABSTRACT: DETERMINES THE SOLAR ELEVATION ANGLE ON ALL OBSERVED
   5100 C   MANDATORY PRESSURE LEVELS FOR A REPORT BASED ON THE TIME THE
   5101 C   BALLOON CROSSES THE MANDATORY LEVEL (BASED ON THE ESTIMATED
   5102 C   BALLOON DRIFT DELTA-TIME ON LEVEL, THE DAY OF THE YEAR FOR
   5103 C   THE CURRENT DAY, THE NUMBER OF DAYS IN THE YEAR FOR THE CURRENT
   5104 C   YEAR, AND THE LATITUDE AND LONGITUDE OF THE BALLOON WHEN IT
   5105 C   CROSSES THE MANDATORY LEVEL (BASED ON THE ESTIMATED BALLOON DRIFT
   5106 C   COORDINATES ON THE LEVEL).  WHEN BALLOON DRIFT TIME AND LOCATION
   5107 C   COORDINATES ARE NOT AVAILABLE (AS FOR "OLDER" DATA), THE SUN
   5108 C   ANGLE IS ESTIMATED AT BOTH THE LOWEST POSSIBLE CORRECTED
   5109 C   MANDATORY LEVEL (EITHER 100 MB OR 700 MB DEPENDING UPON
   5110 C   WHICH TABLES ARE BEING USED) AND AT 10 MB, BASED ON AN
   5111 C   ESTIMATED BALLOON CROSSING TIME (FROM OBS. TIME AND CONSTANT
   5112 C   TIME DIFFERENCE VALUE) AND OBS. LAT/LON., AND THE SUN ANGLE IS
   5113 C   INTERPOLATED TO THE REMAINING MANDATORY LEVELS.
   5114 C
   5115 C PROGRAM HISTORY LOG:
   5116 C 2002-07-19  D. A. KEYSER -- ORIGINAL AUTHOR
   5117 C 2008-10-08  D. KEYSER    -- MODIFIED TO RE-INDEX ARRAY "SOLAR" (SUN
   5118 C     ANGLE ON MAND. LVLS) FOR CASES INVOLVING THE OLDEST SET OF
   5119 C     CORRECTIONS AND WHERE BALLOON DRIFT INFORMATION WAS NOT
   5120 C     AVAILABLE SO THAT PROPER VALUES ARE RETURNED TO CALLING SUBR.
   5121 C     RADT1 (ONLY APPLIES TO REANALYSIS SINCE SUBR. RADT1 IS NEVER
   5122 C     CALLED IN CURRENT REAL-TIME RUNS);
   5123 C
   5124 C USAGE:    CALL SOELAN(SOLAR)
   5125 C   OUTPUT ARGUMENT LIST:
   5126 C     SOLAR    - 16-WORD ARRAY CONTAINING SOLAR ELEVATION ANGLE ON
   5127 C                ALL MANDATORY PRESSURE LEVELS OVER WHICH CORRECTIONS
   5128 C                ARE MADE
   5129 C
   5130 C   OUTPUT FILES:
   5131 C     UNIT 06  - PRINTOUT
   5132 C     UNIT 68  - RADCOR INFORMATION FILE
   5133 C
   5134 C REMARKS: CALLED BY SUBROUTINES "RADT1", "RADT2", "RADT3", "RADT4"
   5135 C   AND "RADT5".
   5136 C
   5137 C
   5138 C ATTRIBUTES:
   5139 C   LANGUAGE: FORTRAN 90
   5140 C   MACHINE:  NCEP WCOSS
   5141 C
   5142 C$$$
   5143       SUBROUTINE SOELAN(SOLAR)
   5144 
   5145       PARAMETER (NST=999)
   5146 
   5147       REAL(8) BMISS
   5148 
   5149       COMMON /STN/     IS

Page 113         Source Listing                  SOELAN
2017-04-18 11:07                                 radcor.f

   5150       COMMON /HEADER/  SID(NST), DHR(NST), XOB(NST), YOB(NST),
   5151      &                 ELV(NST), SQN(NST), ITP(NST), NLV,
   5152      &                 NEV, ISF(NST), NLVM, NLVW
   5153       COMMON /PMAND /  PRES(16),KMIN,KMAX,INM(16)
   5154       COMMON /SUNNY /  IDAYR,IDAYSY,TSNOON
   5155       COMMON /ALLSND/  POB(255), PFC(255), PQM(255), PRC(255),
   5156      &                 ZOB(255), ZFC(255), ZQM(255), ZRC(255),
   5157      &                 TOB(255), TFC(255), TQM(255), TRC(255),
   5158      &                 TDO(255), TDFC(255),TVO(255),
   5159      &                 QOB(255), QFC(255), QQM(255), QRC(255),
   5160      &                 CAT(255), IND(255), LEVTYP(255),
   5161      &                 PS(NST),  GESPS(NST),LST(255), HRDR(255),
   5162      &                 YDR(255), XDR(255)
   5163       COMMON /DATEX/   IDATE(5), CDATE
   5164       COMMON/SWITCH/   LWCORR,LEVRAD,IRCTBL,HGTTBL,BAL_DRIFT
   5165       COMMON /BUFRLIB_MISSING/BMISS,XMISS,IMISS
   5166 
   5167       LOGICAL BAL_DRIFT
   5168       REAL    SOLAR(16)
   5169 
   5170       CHARACTER*8      SID
   5171       CHARACTER*10     CDATE
   5172 
   5173       SOLAR = BMISS
   5174 
   5175       DO M=KMIN,KMAX
   5176          IF(.NOT.BAL_DRIFT .OR. (INM(M).GT.0 .AND. INM(M).LE.NLV)) THEN
   5177             ADDTIM = BMISS
   5178             IF(BAL_DRIFT)  THEN
   5179                ADDTIM = HRDR(INM(M)) ! Balloon est. to cross this pres.
   5180                XLON = XDR(INM(M))    !  lvl at balloon-drift d-time on
   5181                YLAT = YDR(INM(M))    !  lvl (rel. to BUFR message hour)
   5182                                      !  and at balloon-drift lat/lon
   5183             ELSE
   5184 
   5185 C  WHEN BALLOON DRIFT COORDINATES ARE NOT AVAILABLE (BAL_DRIFT=F),
   5186 C   MUST DETERMINE SUN ANGLE VIA "OLD" METHOD: THIS MEANS COMPUTING
   5187 C   SOLAR ELEVATION ANGLE AT LOWEST CORRECTED LEVEL AND AT 10 MB LEVEL
   5188 C   THEN INTERPOLATING BETWEEN THE TWO
   5189 C  -------------------------------------------------------------------
   5190 C
   5191                IF(PRES(M).EQ.100. .AND. IRCTBL.EQ.1)  THEN
   5192                   ADDTIM = DHR(IS) - 0.5  ! For IRCTBL=1 corrections
   5193                                           !  start at 100mb - balloon
   5194                                           !  est. to cross this lvl at
   5195                                           !  obs. d-time (rel. to BUFR
   5196                                           !  message hour) plus 0.5
   5197                                           !  hours
   5198                ELSE  IF(PRES(M).EQ.700. .AND. IRCTBL.GT.1)  THEN
   5199                   ADDTIM = DHR(IS) - 0.2  ! For IRCTBL>1 corrections
   5200                                           !  start at 700mb (1000mb for
   5201                                           !  IRCTBL=3) - balloon est.
   5202                                           !  to cross 700mb at obs.
   5203                                           !  d-time minus 0.2 hours
   5204                ELSE  IF(PRES(M).EQ.10.)  THEN
   5205                   ADDTIM = DHR(IS) + 1.3  ! For all tables, corrections
   5206                                           !  end at 10mb - balloon est.

Page 114         Source Listing                  SOELAN
2017-04-18 11:07                                 radcor.f

   5207                                           !  to cross this lvl at obs.
   5208                                           !  d-time plus 1.3 hours
   5209                END IF
   5210                XLON = XOB(IS)    !  Balloon lat/lon on this lvl is
   5211                YLAT = YOB(IS)    !   obs. lat/lon
   5212             END IF
   5213             IF(ADDTIM.GE.BMISS)  CYCLE
   5214             BALTM = IDATE(5) + ADDTIM
   5215 
   5216 C  AFY is angular fraction of year
   5217 C  -------------------------------
   5218 
   5219             AFY = 6.2831853 *(REAL(IDAYR)-1. + (BALTM/24.))/REAL(IDAYSY)
   5220             SAFY = SIN(AFY)
   5221             CAFY = COS(AFY)
   5222 
   5223 C  SSOD is sine of solar declination
   5224 C  ---------------------------------
   5225 
   5226             SSOD = .3978492 * SIN(4.88578 + AFY + (.033420 * SAFY)
   5227      &             - (.001388 * CAFY) + (.000696 * SAFY * CAFY)
   5228      &             + (.000028 * (SAFY**2 - CAFY**2)))
   5229             ALON  = MOD(720.+360.-XLON,360.)
   5230 
   5231 C  SHA is solar hour angle
   5232 C  -----------------------
   5233 
   5234             SHA = .0174532925 * ((15. * (TSNOON + BALTM + 36.)) - ALON)
   5235             RLAT  = .0174532925 * YLAT
   5236             SOLAR(M) = 57.29578 * ASIN((SSOD * SIN(RLAT)) +
   5237      &               (SQRT(1.0 - SSOD**2) * COS(RLAT) * COS(SHA)))
   5238 cppppp
   5239             write(68,722) pres(m),addtim,ylat,xlon,baltm,solar(m),
   5240      &                    sid(is)
   5241   722       FORMAT(' pres=',F6.1,' addtim=',F8.3,' ylat=',F6.2,' xlon=',
   5242      &             F6.2,' baltm=',F8.3,' solar=',F6.2,' id=',A8)
   5243 cppppp
   5244          ENDIF
   5245       ENDDO
   5246 
   5247       IF(BAL_DRIFT)  RETURN
   5248 
   5249 C  "OLD" METHOD: INTERPOLATE SOLAR ELEVATION ANGLES BETWEEN AT
   5250 C  MANDATORY LEVELS (BASED ON SPANNING LEVELS CALC. ABOVE)
   5251 C  -------------------------------------------------------------------
   5252 
   5253       IF(IRCTBL.EQ.1)  THEN
   5254          SUNBA = SOLAR(16)-SOLAR(11) ! For IRCTBL=1 between 100 & 10 mb
   5255          SOLAR(12) = SOLAR(11) + (0.15252 * SUNBA)
   5256          SOLAR(13) = SOLAR(11) + (0.29520 * SUNBA)
   5257          SOLAR(14) = SOLAR(11) + (0.51538 * SUNBA)
   5258          SOLAR(15) = SOLAR(11) + (0.69250 * SUNBA)
   5259       ELSE
   5260          SUNBA = SOLAR(16)-SOLAR(4) ! For IRCTBL>1 between 700 and 10 mb
   5261                                     !  NOTE: SOLAR(1)-SOLAR(3) are
   5262                                     !  crude est. at 1000, 925 & 850 mb
   5263                                     !  (based on ratio of higher lvl

Page 115         Source Listing                  SOELAN
2017-04-18 11:07                                 radcor.f

   5264                                     !  values to diff in reference hght)
   5265                                     !  (these are needed for IRCTBL=3)
   5266          SOLAR(1 ) = SOLAR(4) - (.0826254 * SUNBA)
   5267          SOLAR(2 ) = SOLAR(4) - (.0647634 * SUNBA)
   5268          SOLAR(3 ) = SOLAR(4) - (.0456353 * SUNBA)
   5269          SOLAR(5 ) = SOLAR(4) + (.0791979 * SUNBA)
   5270          SOLAR(6 ) = SOLAR(4) + (.1317209 * SUNBA)
   5271          SOLAR(7 ) = SOLAR(4) + (.1994348 * SUNBA)
   5272          SOLAR(8 ) = SOLAR(4) + (.2423491 * SUNBA)
   5273          SOLAR(9 ) = SOLAR(4) + (.2948721 * SUNBA)
   5274          SOLAR(10) = SOLAR(4) + (.3625860 * SUNBA)
   5275          SOLAR(11) = SOLAR(4) + (.4580233 * SUNBA)
   5276          SOLAR(12) = SOLAR(4) + (.5419766 * SUNBA)
   5277          SOLAR(13) = SOLAR(4) + (.6211745 * SUNBA)
   5278          SOLAR(14) = SOLAR(4) + (.7414114 * SUNBA)
   5279          SOLAR(15) = SOLAR(4) + (.8308487 * SUNBA)
   5280       END IF
   5281 
   5282       RETURN
   5283 
   5284       END


ENTRY POINTS

  Name               
                     
 soelan_             

Page 116         Source Listing                  SOELAN
2017-04-18 11:07 Symbol Table                    radcor.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 722                        Label  5241                                                           5239                              
 ADDTIM                     Local  5177     R(4)            4           scalar                    5177,5179,5192,5199,5205,5213,5214
                                                                                                  ,5239                             
 AFY                        Local  5219     R(4)            4           scalar                    5219,5220,5221,5226               
 ALLSND                     Common 5155                                 34512                                                       
 ALON                       Local  5229     R(4)            4           scalar                    5229,5234                         
 ASIN                       Func   5236                                 scalar                    5236                              
 BALTM                      Local  5214     R(4)            4           scalar                    5214,5219,5234,5239               
 BAL_DRIFT                  Scalar 5164     L(4)            4           scalar   COM              5176,5178,5247                    
 BMISS                      Scalar 5147     R(8)            8           scalar   COM              5173,5177,5213                    
 BUFRLIB_MISSING            Common 5165                                 16                                                          
 CAFY                       Local  5221     R(4)            4           scalar                    5221,5227,5228                    
 CAT                        Scalar 5160     R(4)            4     1     255      COM                                                
 CDATE                      Scalar 5163     CHAR            10          scalar   COM                                                
 COS                        Func   5221                                 scalar                    5221,5237                         
 DATEX                      Common 5163                                 30                                                          
 DHR                        Scalar 5150     R(4)            4     1     999      COM              5192,5199,5205                    
 ELV                        Scalar 5151     R(4)            4     1     999      COM                                                
 GESPS                      Scalar 5161     R(4)            4     1     999      COM                                                
 HEADER                     Common 5150                                 35980                                                       
 HGTTBL                     Scalar 5164     R(4)            4           scalar   COM                                                
 HRDR                       Scalar 5161     R(4)            4     1     255      COM              5179                              
 IDATE                      Scalar 5163     I(4)            4     1     5        COM              5214                              
 IDAYR                      Scalar 5154     I(4)            4           scalar   COM              5219                              
 IDAYSY                     Scalar 5154     I(4)            4           scalar   COM              5219                              
 IMISS                      Scalar 5165     I(4)            4           scalar   COM                                                
 IND                        Scalar 5160     I(4)            4     1     255      COM                                                
 INM                        Scalar 5153     I(4)            4     1     16       COM              5176,5179,5180,5181               
 IRCTBL                     Scalar 5164     I(4)            4           scalar   COM              5191,5198,5253                    
 IS                         Scalar 5149     I(4)            4           scalar   COM              5192,5199,5205,5210,5211,5240     
 ISF                        Scalar 5152     I(4)            4     1     999      COM                                                
 ITP                        Scalar 5151     I(4)            4     1     999      COM                                                
 KMAX                       Scalar 5153     I(4)            4           scalar   COM              5175                              
 KMIN                       Scalar 5153     I(4)            4           scalar   COM              5175                              
 LEVRAD                     Scalar 5164     I(4)            4           scalar   COM                                                
 LEVTYP                     Scalar 5160     I(4)            4     1     255      COM                                                
 LST                        Scalar 5161     I(4)            4     1     255      COM                                                
 LWCORR                     Scalar 5164     I(4)            4           scalar   COM                                                
 M                          Local  5175     I(4)            4           scalar                    5175,5176,5179,5180,5181,5191,5198
                                                                                                  ,5204,5236,5239                   
 MOD                        Func   5229                                 scalar                    5229                              
 NEV                        Scalar 5152     I(4)            4           scalar   COM                                                
 NLV                        Scalar 5151     I(4)            4           scalar   COM              5176                              
 NLVM                       Scalar 5152     I(4)            4           scalar   COM                                                
 NLVW                       Scalar 5152     I(4)            4           scalar   COM                                                
 NST                        Param  5145     I(4)            4           scalar                    5150,5151,5152,5161               
 PFC                        Scalar 5155     R(4)            4     1     255      COM                                                
 PMAND                      Common 5153                                 136                                                         
 POB                        Scalar 5155     R(4)            4     1     255      COM                                                
 PQM                        Scalar 5155     R(4)            4     1     255      COM                                                
 PRC                        Scalar 5155     R(4)            4     1     255      COM                                                

Page 117         Source Listing                  SOELAN
2017-04-18 11:07 Symbol Table                    radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PRES                       Scalar 5153     R(4)            4     1     16       COM              5191,5198,5204,5239               
 PS                         Scalar 5161     R(4)            4     1     999      COM                                                
 QFC                        Scalar 5159     R(4)            4     1     255      COM                                                
 QOB                        Scalar 5159     R(4)            4     1     255      COM                                                
 QQM                        Scalar 5159     R(4)            4     1     255      COM                                                
 QRC                        Scalar 5159     R(4)            4     1     255      COM                                                
 REAL                       Func   5219                                 scalar                    5219                              
 RLAT                       Local  5235     R(4)            4           scalar                    5235,5236,5237                    
 SAFY                       Local  5220     R(4)            4           scalar                    5220,5226,5227,5228               
 SHA                        Local  5234     R(4)            4           scalar                    5234,5237                         
 SID                        Scalar 5150     CHAR            8     1     999      COM              5240                              
 SIN                        Func   5220                                 scalar                    5220,5226,5236                    
 SOELAN                     Subr   5143                                                                                             
 SOLAR                      Dummy  5143     R(4)            4     1     16       ARG,INOUT        5173,5236,5239,5254,5255,5256,5257
                                                                                                  ,5258,5260,5266,5267,5268,5269,527
                                                                                                  0,5271,5272,5273,5274,5275,5276,52
                                                                                                  77,5278,5279                      
 SQN                        Scalar 5151     R(4)            4     1     999      COM                                                
 SQRT                       Func   5237                                 scalar                    5237                              
 SSOD                       Local  5226     R(4)            4           scalar                    5226,5236,5237                    
 STN                        Common 5149                                 4                                                           
 SUNBA                      Local  5254     R(4)            4           scalar                    5254,5255,5256,5257,5258,5260,5266
                                                                                                  ,5267,5268,5269,5270,5271,5272,527
                                                                                                  3,5274,5275,5276,5277,5278,5279   
 SUNNY                      Common 5154                                 12                                                          
 SWITCH                     Common 5164                                 20                                                          
 TDFC                       Scalar 5158     R(4)            4     1     255      COM                                                
 TDO                        Scalar 5158     R(4)            4     1     255      COM                                                
 TFC                        Scalar 5157     R(4)            4     1     255      COM                                                
 TOB                        Scalar 5157     R(4)            4     1     255      COM                                                
 TQM                        Scalar 5157     R(4)            4     1     255      COM                                                
 TRC                        Scalar 5157     R(4)            4     1     255      COM                                                
 TSNOON                     Scalar 5154     R(4)            4           scalar   COM              5234                              
 TVO                        Scalar 5158     R(4)            4     1     255      COM                                                
 XDR                        Scalar 5162     R(4)            4     1     255      COM              5180                              
 XLON                       Local  5180     R(4)            4           scalar                    5180,5210,5229,5239               
 XMISS                      Scalar 5165     R(4)            4           scalar   COM                                                
 XOB                        Scalar 5150     R(4)            4     1     999      COM              5210                              
 YDR                        Scalar 5162     R(4)            4     1     255      COM              5181                              
 YLAT                       Local  5181     R(4)            4           scalar                    5181,5211,5235,5239               
 YOB                        Scalar 5150     R(4)            4     1     999      COM              5211                              
 ZFC                        Scalar 5156     R(4)            4     1     255      COM                                                
 ZOB                        Scalar 5156     R(4)            4     1     255      COM                                                
 ZQM                        Scalar 5156     R(4)            4     1     255      COM                                                
 ZRC                        Scalar 5156     R(4)            4     1     255      COM                                                

Page 118         Source Listing                  SOELAN
2017-04-18 11:07                                 radcor.f

   5285 
   5286 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5287 C
   5288 C SUBPROGRAM:    TAB         COUNTS RADIOSONDE TYPES FOR "ADPUPA" MASS
   5289 C   PRGMMR: D. A. KEYSER     ORG: W/NMC22    DATE: 90-12-06
   5290 C
   5291 C ABSTRACT: ACCUMULATES DATA COUNTS FOR ALL "ADPUPA" MASS RADIOSONDE
   5292 C   TYPES.  ALSO ACCUMULATES DATA COUNTS FOR ALL RADIOSONDE TYPES
   5293 C   LUMPED TOGETHER.  INPUT RADIOSONDE TYPES ARE ASSIGNED TO A VARIABLE
   5294 C   READ IN VIA COMMON BLOCK /COUNT/.  THE DATA COUNTER IS ALSO READ IN
   5295 C   VIA THIS COMMON BLOCK.
   5296 C
   5297 C PROGRAM HISTORY LOG:
   5298 C   UNKNOWN   G. D. DIMEGO
   5299 C   90-12-05  D. A. KEYSER -- CONVERTED TO VS FORTRAN(77)& RESTRUCTURED
   5300 C
   5301 C USAGE:    CALL TAB(ID)
   5302 C   INPUT ARGUMENT LIST:
   5303 C     ID       - INTEGER INTRUMENT TYPE CODE
   5304 C
   5305 C REMARKS: CALLED BY SUBROUTINE "RADEVN".
   5306 C
   5307 C ATTRIBUTES:
   5308 C   LANGUAGE: FORTRAN 90
   5309 C   MACHINE:  NCEP WCOSS
   5310 C
   5311 C$$$
   5312       SUBROUTINE TAB(ID)
   5313       PARAMETER (NRID=800) ! max # of raob ids listed per inst. type
   5314       CHARACTER*8  SIDNOR, SIDRAD
   5315       COMMON/COUNT/   NTYPE(69),KTYPE(69),SIDNOR(2000),SIDRAD(NRID,255),
   5316      &                IICNT,JJCNT(255)
   5317       DO I=1,68
   5318          IF(NTYPE(I).EQ.99999)   GO TO 40
   5319          IF(NTYPE(I).EQ.ID)  GO TO 50
   5320       ENDDO
   5321       NTYPE(69) = ID
   5322       GO TO 60
   5323    40 CONTINUE
   5324       NTYPE(I) = ID
   5325    50 CONTINUE
   5326       KTYPE(I) = KTYPE(I) + 1
   5327    60 CONTINUE
   5328       KTYPE(69) = KTYPE(69) + 1
   5329       RETURN
   5330       END

Page 119         Source Listing                  TAB
2017-04-18 11:07 Entry Points                    radcor.f



ENTRY POINTS

  Name            
                  
 tab_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 40                         Label  5323                                                           5318                              
 50                         Label  5325                                                           5319                              
 60                         Label  5327                                                           5322                              
 COUNT                      Common 5315                                 1649576                                                     
 I                          Local  5317     I(4)            4           scalar                    5317,5318,5319,5324,5326          
 ID                         Dummy  5312     I(4)            4           scalar   ARG,INOUT        5319,5321,5324                    
 IICNT                      Scalar 5316     I(4)            4           scalar   COM                                                
 JJCNT                      Scalar 5316     I(4)            4     1     255      COM                                                
 KTYPE                      Scalar 5315     I(4)            4     1     69       COM              5326,5328                         
 NRID                       Param  5313     I(4)            4           scalar                    5315                              
 NTYPE                      Scalar 5315     I(4)            4     1     69       COM              5318,5319,5321,5324               
 SIDNOR                     Scalar 5314     CHAR            8     1     2000     COM                                                
 SIDRAD                     Scalar 5314     CHAR            8     2     204000   COM                                                
 TAB                        Subr   5312                                                                                             

Page 120         Source Listing                  TAB
2017-04-18 11:07                                 radcor.f

   5331 

Page 121         Source Listing                  TAB
2017-04-18 11:07 Subprograms/Common Blocks       radcor.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLSND                     Common 94                                   34512                                                       
 ALLSND                     Common 5155                                 34512                                                       
 BUFRLIB_MISSING            Common 121                                  16                                                          
 BUFRLIB_MISSING            Common 707                                  16                                                          
 BUFRLIB_MISSING            Common 1059                                 16                                                          
 BUFRLIB_MISSING            Common 1980                                 16                                                          
 BUFRLIB_MISSING            Common 2726                                 16                                                          
 BUFRLIB_MISSING            Common 3873                                 16                                                          
 BUFRLIB_MISSING            Common 4905                                 16                                                          
 BUFRLIB_MISSING            Common 5056                                 16                                                          
 BUFRLIB_MISSING            Common 5165                                 16                                                          
 COUNT                      Common 113                                  1649576                                                     
 COUNT                      Common 5315                                 1649576                                                     
 DATEX                      Common 115                                  30                                                          
 DATEX                      Common 1058                                 30                                                          
 DATEX                      Common 5163                                 30                                                          
 DATE_IDT                   Common 120                                  4                                                           
 DATE_IDT                   Common 477                                  4                                                           
 DATE_IDT                   Common 3872                                 4                                                           
 EVNSND                     Common 103                                  26520                                                       
 FILES                      Common 116                                  24                                                          
 HEADER                     Common 90                                   35980                                                       
 HEADER                     Common 1051                                 35980                                                       
 HEADER                     Common 1973                                 35980                                                       
 HEADER                     Common 2719                                 35980                                                       
 HEADER                     Common 3865                                 35980                                                       
 HEADER                     Common 5150                                 35980                                                       
 PARAMS                     Common 117                                  148                                                         
 PILNLNP                    Func   5050     R(4)            4           scalar                    5058,5088                         
 PMAND                      Common 112                                  136                                                         
 PMAND                      Common 1056                                 136                                                         
 PMAND                      Common 1978                                 136                                                         
 PMAND                      Common 2724                                 136                                                         
 PMAND                      Common 3870                                 136                                                         
 PMAND                      Common 5153                                 136                                                         
 PREP                       Subr   473                                                                                              
 RADCOM                     Common 110                                  260                                                         
 RADCOM                     Common 705                                  260                                                         
 RADCOM                     Common 1054                                 260                                                         
 RADCOM                     Common 1976                                 260                                                         
 RADCOM                     Common 2722                                 260                                                         
 RADCOM                     Common 3868                                 260                                                         
 RADEVN                     Subr   84                                                                                               
 RADT1                      Subr   701                                                                                              
 RADT2                      Subr   1046                                                                                             
 RADT3                      Subr   1968                                                                                             
 RADT4                      Subr   2714                                                                                             
 RADT5                      Subr   3860                                                                                             
 RSTATS                     Subr   4897                                                                                             
 SOELAN                     Subr   5143                                                                                             
 STN                        Common 93                                   4                                                           

Page 122         Source Listing                  TAB
2017-04-18 11:07 Subprograms/Common Blocks       radcor.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 STN                        Common 1057                                 4                                                           
 STN                        Common 1979                                 4                                                           
 STN                        Common 2725                                 4                                                           
 STN                        Common 3871                                 4                                                           
 STN                        Common 5149                                 4                                                           
 SUNNY                      Common 476                                  12                                                          
 SUNNY                      Common 5154                                 12                                                          
 SWITCH                     Common 111                                  20                                                          
 SWITCH                     Common 475                                  20                                                          
 SWITCH                     Common 706                                  20                                                          
 SWITCH                     Common 1055                                 20                                                          
 SWITCH                     Common 1977                                 20                                                          
 SWITCH                     Common 2723                                 20                                                          
 SWITCH                     Common 3869                                 20                                                          
 SWITCH                     Common 4903                                 20                                                          
 SWITCH                     Common 5164                                 20                                                          
 TAB                        Subr   5312                                                                                             
 TESTS                      Common 119                                  4                                                           
 TESTS                      Common 4904                                 4                                                           

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape

Page 123         Source Listing                  TAB
2017-04-18 11:07                                 radcor.f

       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,

Page 124         Source Listing                  TAB
2017-04-18 11:07                                 radcor.f

           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : radcor.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
