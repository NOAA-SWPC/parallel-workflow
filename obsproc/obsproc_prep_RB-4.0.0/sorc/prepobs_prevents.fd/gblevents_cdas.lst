Page 1           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

      1 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      2 C
      3 C SUBPROGRAM:    GBLEVENTS_CDAS  PRE/POST PROCESSING OF PREPBUFR EVENTS 
      4 C   PRGMMR: J.Whiting        ORG: EMC        DATE: 2014-01-24
      5 C
      6 C ABSTRACT: THIS IS A FROZEN VERSION OF THE 2006-07-14 VERSION OF W3LIB
      7 C   (LATER W3NCO) ROUTINE GBLEVENTS (OTHER THAN CHANGES TO RENAME
      8 C   GBLEVENTS TO GBLEVENTS_CDAS).  IT IS NEEDED TO READ THE CDAS-STYLE
      9 C   SIGMA FIRST GUESS {THE NEW SIGIO VERSION OF W3LIB (LATER W3NCO)
     10 C   ROUTINE GBLEVENTS CANNOT READ THE OLD CDAS-STYLE SIGMA FIRST
     11 C   GUESS}.  THE REMAINDER OF THIS DOCBLOCK IS JUST A COPY FROM THE
     12 C   2006-07-14 VERSION OF ROUTINE GBLEVENTS.
     13 C           RUNS IN TWO MODES: "PREVENTS" AND "POSTEVENTS".  IN THE
     14 C   PREVENTS MODE, PREPARES OBSERVATIONAL PREPBUFR REPORTS FOR
     15 C   SUBSEQUENT QUALITY CONTROL AND ANALYSIS PROGRAMS.  THIS IS DONE
     16 C   THROUGH THE FOLLOWING: INTERPOLATION OF GLOBAL SPECTRAL SIMGA
     17 C   FIRST GUESS TO PREPBUFR OBSERVATION LOCATIONS WITH ENCODING OF
     18 C   FIRST GUESS VALUES INTO PREPBUFR REPORTS; ENCODING OF "PREVENT"
     19 C   AND/OR "VIRTMP" EVENTS INTO PREPBUFR REPORTS; AND ENCODING OF
     20 C   OBSERVATION ERRORS FROM THE ERROR SPECIFICATION FILE INTO
     21 C   PREPBUFR REPORTS.  IN THE POSTEVENTS MODE, AFTER ALL QUALITY
     22 C   CONTROL AND ANALYSIS PROGRAMS HAVE RUN, INTERPOLATES THE GLOBAL
     23 C   SPECTRAL SIMGA ANALYSIS TO PREPBUFR OBSERVATION LOCATIONS AND
     24 C   ENCODES THESE ANALYZED VALUES INTO PREPBUFR REPORTS.  THE
     25 C   REMAINDER OF THIS ABSTRACT APPLIES ONLY TO THE PREVENTS MODE.
     26 C   THE "PREVENT" EVENT CAN CHANGE A QUALITY MARKER TO FLAG AN
     27 C   OBSERVATION DATUM FOR NON-USE BY SUBSEQUENT QC AND ANALYSIS
     28 C   PROGRAMS (FILTERING).  EXAMPLES WHERE THIS SUBROUTINE WILL WRITE
     29 C   AN EVENT TO FLAG A DATUM INCLUDE: THE OBSERVATION ERROR FOR THAT
     30 C   DATUM IS READ IN AS MISSING IN THE INPUT ERROR FILE, THE DATUM
     31 C   ITSELF VIOLATES A GROSS OR "SANITY" CHECK, OR THE OBSERVED
     32 C   PRESSURE DATUM IS MORE THAN 100 MB BELOW THE GUESS SURFACE
     33 C   PRESSURE.  THE "VIRTMP" EVENT CAN CHANGE THE SPECIFIC HUMIDITY
     34 C   OBSERVATION (RE-CALCULATED) AS WELL AS THE TEMPERATURE
     35 C   OBSERVATION (FROM SENSIBLE TO VIRTUAL TEMPERATURE, BASED ON
     36 C   JUST-CALCULATED SPECIFIC HUMIDITY).  CURRENTLY THIS APPLIES ONLY
     37 C   TO SURFACE (LAND, MARINE AND MESONET) DATA TYPES, POSSIBLY TO
     38 C   RAOB, DROP AND MULTI-LEVEL RECCO DAA TYPES IF THE SWITCH
     39 C   "ADPUPA_VIRT" IS TRUE (NORMALLY, HOWEVER IT IS FALSE) [OTHER DATA
     40 C   TYPES WITH REPORTED SENSIBLE TEMPERATURE EITHER HAVE MISSING
     41 C   MOISTURE (E.G., ALL AIRCRAFT TYPES EXCEPT FOR SOME ACARS, SATELLITE
     42 C   WIND TYPES), FLAGGED MOISTURE (E.G., SOME ACARS) OR CALCULATE
     43 C   SPECIFIC HUMIDITY/VIRTUAL TEMPERATURE IN SUBSEQUENT PROGRAMS (E.G.,
     44 C   RAOBS, DROPS AND MULTI-LEVEL RECCOS WHICH CALCULATE THESE IN
     45 C   PROGRAM "CQCBUFR", IN WHICH CASE THE SWITCH "ADPUPA_VIRT" HERE MUST
     46 C   BE FALSE!)]. FOR CASES WHERE THE SWITCH "DOBERR" IS FALSE, THE
     47 C   OBSERVATION ERROR FOR ALL DATA REMAINS MISSING IN THE PREPBUFR
     48 C   FILE.  IN THIS CASE, THE INPUT ERROR FILE IS USUALLY A NULL FILE
     49 C   AND THE "PREVENT" EVENT TO FLAG THE DATUM IS NOT INVOKED.  FOR
     50 C   CASES WHERE THE SWITCH "DOFCST" IS FALSE, IF THE SWITCH "SOME_FCST"
     51 C   IS ALSO FALSE, THEN FORECAST VALUES ARE NOT ENCODED FOR ANY MESSAGE
     52 C   TYPE; IF "SOME_FCST" IS TRUE THEN FORECAST VALUES ARE ENCODED, BUT
     53 C   ONLY FOR REPORTS IN THOSE MESSAGE TYPES FOR WHICH A GUESS VALUE IS
     54 C   NEEDED BY SUBSEQUENT QC PROGRAMS.  IT SHOULD BE NOTED THAT THE
     55 C   FILTERING OF DATA ASSOCIATED WITH THE "PREVENT" EVENT PROCESSING IS
     56 C   NOT INVOKED IF ALL THREE ARE TRUE: DOBERR= FALSE, THE FORECAST
     57 C   VALUES ARE MISSING (DOFCST=FALSE & SOME_FCST=TRUE & MESSAGE TYPE IS

Page 2           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

     58 C   NOT "ADPUPA", "AIRCFT", "AIRCAR", "PROFLR", OR "VADWND" -- OR  --
     59 C   DOFCST=FALSE & SOME_FCST=FALSE), AND "VIRTMP" EVENT PROCESSING IS
     60 C   NOT INVOKED (EITHER MESSAGE TYPE IS NOT "ADPSFC", "SFCSHP" OR
     61 C   "MSONET" WHEN "ADPUPA_VIRT" IS FALSE, OR MESSAGE TYPE IS NOT
     62 C   "ADPSFC", "SFCSHP", "MSONET" OR "ADPUPA" WHEN "ADPUPA_VIRT" IS
     63 C   TRUE).
     64 C
     65 C PROGRAM HISTORY LOG:
     66 C
     67 C AS W3LIB (LATER W3NCO) ROUTINE GBLEVENTS:
     68 C
     69 C 1999-07-01 D. A. KEYSER -- ORIGINAL AUTHOR (ADAPTED FROM PREVENTS
     70 C     SUBROUTINE IN PREPDATA PROGRAM, BUT NOW GENERALIZED FOR
     71 C     POSTEVENTS MODE)
     72 C 1999-07-12 D. A. KEYSER -- MODIFIED TO INTERPOLATE MODEL SPECIFIC
     73 C     HUMIDITY TO OBSERVATION LOCATION WHEN OBS. SPECIFIC HUMIDITY IS
     74 C     MISSING AS LONG AS OBS. TEMPERATURE IS NON-MISSING
     75 C 1999-09-09 D. A. KEYSER -- ADDED "VADWND" TO THE LIST OF MESSAGE
     76 C     TYPES FOR WHICH FORECAST VALUES MUST BE ENCODED, EVEN WHEN
     77 C     DOFCST=FALSE (NECESSARY BECAUSE THE NEW PROGRAM CQCVAD NEEDS THE
     78 C     BACKGROUND DATA)
     79 C 1999-09-09 D. A. KEYSER -- CHANGES TO MAKE CODE MORE PORTABLE; 
     80 C     'TFC' NOW GENERATED FOR VADWND MESSAGE TYPES EVEN THOUGH TOB IS
     81 C     MISSING (NEEDED BY CQCVAD PROGRAM)
     82 C 1999-12-01 D. A. KEYSER -- SPEC. HUMIDITY AND VIRT. TEMPERATURE ARE
     83 C     NOW CALCULATED WHEN SPEC. HUMIDITY QUAL. MARKER IS BAD (SUBJECT
     84 C     TO A SANITY CHECK), HOWEVER THE VIRT. TEMPERATURE GETS A BAD
     85 C     QUAL. MARKER (8)
     86 C 2000-09-21 D. A. KEYSER -- THE PRESSURE LEVEL ABOVE WHICH ALL SPEC.
     87 C     HUMIDITY QUAL. MARKERS ARE "REJECTED" (Q.M. SET TO 9) IS NOW READ
     88 C     IN AS A N-LIST SWITCH (QTOP_REJ), BEFORE IT WAS HARDWIRED TO 300
     89 C     MB
     90 C 2000-12-13 D. A. KEYSER -- WILL NO LONGER PERFORM VIRTUAL TEMPERATURE
     91 C     PROCESSING FOR ACARS DATA SINCE MOISTURE IS FLAGGED RIGHT NOW
     92 C     (ACARS MOISTURE ONLY WRITTEN INTO PREPBUFR FILE FOR STATISTICAL
     93 C     REASONS)
     94 C 2001-02-02 D. A. KEYSER -- RESTORED LEGACY LOGIC TO FLAG CERTAIN
     95 C     SATELLITE TEMPERATURE SOUNDINGS EITHER BELOW 100 MB (TEMP. OBS)
     96 C     OR ON ALL LEVELS (SPEC. HUM. OBS), CONTROLLED BY NEW NAMELIST
     97 C     SWITCH "SATMQC"
     98 C 2001-09-27 D. A. KEYSER -- 'TFC' AND 'QFC' NOW GENERATED FOR REPORT
     99 C     TYPE 111 (SYNDAT REPORTS AT STORM CENTER) EVEN THOUGH "TOB" AND
    100 C     "QOB" ARE MISSING (NEEDED BY SYNDATA PROGRAM); IN PREPARATION FOR
    101 C     CHANGE FROM T170L42 TO T254L64 SGES, NOW MAKES COEFFICIENT ARRAYS
    102 C     ALLOCATABLE TO ALLOW THEM TO OBTAIN MEMORY FROM "HEAP" RATHER
    103 C     THAN FROM "STACK", ALSO HAVE INCREASED THE MAX NUMBER OF LEVELS
    104 C     IN ARRAYS FROM 42 TO 64, FINALLY ALSO NO LONGER STOPS WITH C.
    105 C     CODE 70 IF EVEN NUMBER OF LONGITUDES IN SIGMA GUESS (IMAX,
    106 C     HARDWIRED TO 384) IS .LT. SPECTRAL RESOLUTION (JCAP) * 2
    107 C 2001-10-10 D. A. KEYSER -- AT PREPBUFR CENTER DATES WITH AN HOUR THAT
    108 C     IS NOT A MULTIPLE OF 3 (WHEN A GLOBAL SIGMA GUESS/ANAL FILE IS
    109 C     NOT AVAILABLE; E.G., IN RUC2A RUNS) NOW PERFORMS A LINEAR
    110 C     INTERPOLATION BETWEEN SPECTRAL COEFFICIENTS IN 2 SPANNING SIGMA
    111 C     GUESS/ANAL FILES 3-HRS APART TO CENERATE A GUESS/ANAL FILE VALID
    112 C     AT THE PREPBUFR CENTER TIME
    113 C 2002-05-10 D. A. KEYSER -- ADDED "AIRCAR" TO THE LIST OF TABLE A
    114 C     MESSAGE TYPES THAT WILL STILL HAVE THE BACKGROUND ENCODED WHEN

Page 3           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    115 C     DOFCST IS FALSE (BECAUSE ACARS ARE NOW Q.C.'d IN PREPOBS_ACARSQC
    116 C     PROGRAM)
    117 C 2003-09-02 D. A. KEYSER -- ADDED "MSONET" TO THE LIST OF TABLE A
    118 C     MESSAGE TYPES THAT WILL HAVE THE VIRTUAL TEMPERATURE CALCULATED;
    119 C     DOES NOT CALL UFBINT FOR OUTPUTTING DATA IF "NLEV" (4'TH
    120 C     ARGUMENT) IS ZERO (NOW CAN ONLY HAPPEN FOR GOESND FORECAST DATA
    121 C     WHEN ONLY RADIANCES ARE PRESENT)
    122 C 2004-08-30 D. A. KEYSER -- NOW INCLUDES THE 4 LAYER PWATERS, THESE
    123 C     GET AN OBS. ERROR (EACH THE SAME AS TOTAL PWATER) AND AN EVENT
    124 C     IS GENERATED WITH A REJECTED Q.M. FOR THE 4 LAYER PWATERS IF THE
    125 C     PWATER OBS. ERROR READ IN IS MISSING (THIS CHANGE ALLOWS THE ETA/
    126 C     GSI TO PROCESS OBS. ERRORS IN THE PREPBUFR FILE THE SAME AS THE
    127 C     ETA/3DVAR DID WHEN READING THE OBS. ERRORS FROM AN EXTERNAL
    128 C     FILE); FOR "RASSDA" TYPES, ENCODES A SIMPLE COPY OF THE REPORTED
    129 C     (VIRTUAL) TEMPERATURE AS A "VIRTMP" EVENT IF DOVTMP IS TRUE, GETS
    130 C     NEW REASON CODE 3
    131 C 2004-09-10 D. T. KLEIST -- ADDED CAPABILITY TO READ GUESS FIELDS FROM
    132 C     EITHER HYBRID OR, AS BEFORE, SIGMA GLOBAL FORECAST FILES
    133 C 2005-01-03 D. A. KEYSER -- FIXED ERROR READING CDAS SGES FILE WHICH
    134 C     STILL HAS A 207-WORD HEADER (T62) {2004-09-10 CHANGE ASSUMED ALL
    135 C     SGES FILES HAD A 226-WORD HEADER (T254), BUT THIS IS VALID ONLY
    136 C     FOR GFS SGES)
    137 C 2006-05-05 R. E. TREADON -- CHANGE VERTICAL INTERPOLATION TO DIRECTLY
    138 C     USE PRESSURE PROFILE, NOT PRESSURE PROFILE CONVERTED TO SIGMA.  
    139 C     THIS CHANGE IS IN SUBROUTINE CGBLEVN03.  AS A RESULT OF THIS 
    140 C     CHANGE, SUBROUTINE CGBLEVN07 WAS REMOVED.
    141 C 2006-07-14 D. A. KEYSER -- ADDED NEW NAMELIST SWITCH "SOME_FCST"
    142 C     WHICH APPLIES ONLY WHEN EXISTING SWITCH "DOFCST" IS FALSE: IF
    143 C     DOFCST=F AND SOME_FCST=T THEN, JUST AS BEFORE WHEN DOFCST=F, A
    144 C     FORECAST WILL STILL BE ENCODED FOR REPORTS IN CERTAIN MESSAGE
    145 C     TYPES USED IN SUBSEQUENT Q.C. PROGRAMS (I.E, "ADPUPA", "AIRCFT",
    146 C     "AIRCAR", "PROFLR" OR "VADWND") (THE DEFAULT FOR SOME_FCST IS
    147 C     TRUE); HOWEVER IF DOFCST=F AND SOME_FCST=F THEN A FORECAST WILL
    148 C     NOT BE ENCODED INTO REPORTS IN ANY MESSAGE TYPE (THIS ALLOWS
    149 C     THIS PROGRAM TO ENCODE OBS ERRORS AND/OR VIRTUAL TEMPERATURE
    150 C     EVENTS INTO A PREPBUFR FILE WITHOUT ENCODING A FORECAST); ADDED
    151 C     NEW NAMELIST SWITCH "ADPUPA_VIRT" WHICH, WHEN TRUE, INCLUDES
    152 C     REPORTS IN MESSAGE TYPE ADPUPA (I.E., RAOBS, DROPS, MULTI-LEVEL
    153 C     RECCOS) IN THE "VIRTMP" PROCESSING (PROCESSING THEM WITH SAME
    154 C     LOGIC AS IN SUBROUTINE VTPEVN OF PROGRAM PREPOBS_CQCBUFR)
    155 C     {NORMALLY "ADPUPA_VIRT" IS FALSE (DEFAULT) BECAUSE SUBSEQUENT
    156 C     PROGRAM PREPOBS_CQCBUFR PERFORMS THIS FUNCTION}
    157 C 2012-11-20  J. WOOLLEN  INITIAL PORT TO WCOSS 
    158 C
    159 C AS IN-LINE ROUTINE GBLEVENTS_CDAS:
    160 C
    161 C 2007-11-20 D. A. KEYSER -- RENAMED FROZEN 2006-07-14 VERSION OF W3LIB
    162 C     ROUTINE GBLEVENTS TO GBLEVENTS_CDAS AND ADDED AS IN-LINE ROUTINE
    163 C     TO PROGRAM PREPOBS_PREVENTS, IT IS NEEDED TO READ THE CDAS-STYLE
    164 C     SIGMA FIRST GUESS (THE NEW SIGIO VERSION OF W3LIB ROUTINE
    165 C     GBLEVENTS CANNOT READ THE OLD CDAS-STYLE SIGMA FIRST GUESS)
    166 C 2012-11-20  J. WOOLLEN   -- INITIAL PORT TO WCOSS
    167 C 2013-02-13  D. A. KEYSER -- FINAL CHANGES TO RUN ON WCOSS: OBTAINS
    168 C     BUFRLIB MISSING (BMISS) VIA CALL TO GETBMISS RATHER THAN
    169 C     HARDWIRING IT TO 10E10 (10E10 CAN CAUSE INTEGER OVERFLOW ON
    170 C     WCOSS - SEE CALLING PROGRAM FOR MORE INFO); USE FORMATTED PRINT
    171 C     STATEMENTS WHERE PREVIOUSLY UNFORMATTED PRINT WAS > 80

Page 4           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    172 C     CHARACTERS; RENAME ALL REAL(8) VARIABLES AS *_8
    173 C 2014-01-24 JWhiting - added logic to trap input XOB=360.0 values and
    174 C     reset them to zero; left untrapped, this value leads to out of 
    175 c     bounds referencing of IAR_8 array in the CGBLEVN06() subroutine.
    176 C
    177 C USAGE:    CALL GBLEVENTS_CDAS(IDATEP,IUNITF,IUNITE,IUNITP,IUNITS,
    178 C          $                    SUBSET,NEWTYP)
    179 C   INPUT ARGUMENT LIST:
    180 C     IDATEP   - CENTER DATE FOR PREPBUFR FILE IN THE FORM YYYYMMDDHH
    181 C     IUNITF   - 2-WORD ARRAY:
    182 C              - WORD 1 - UNIT NUMBER OF FIRST INPUT SPECTRAL (GLOBAL)
    183 C              - SIGMA FILE (EITHER FIRST GUESS OR ANALYSIS); IF HH IN
    184 C              - IDATEP IS A MULTIPLE OF 3 THEN THIS FILE IS VALID AT
    185 C              - THE DATE IN IDATEP, IF HH IN IDATEP IS NOT A
    186 C              - MULTIPLE OF 3 THEN THIS FILE IS VALID AT THE CLOSEST
    187 C              - TIME PRIOR TO THE DATE IN IDATEP THAT IS A MULTIPLE
    188 C              - OF 3
    189 C              - WORD 2 - UNIT NUMBER OF SECOND INPUT SPECTRAL (GLOBAL)
    190 C              - SIGMA FILE (EITHER FIRST GUESS OR ANALYSIS); IF HH IN
    191 C              - IDATEP IS A MULTIPLE OF 3 THEN THIS FILE IS EMPTY, IF
    192 C              - HH IN IDATEP IS NOT A MULTIPLE OF 3 THEN THIS FILE IS
    193 C              - VALID AT THE CLOSEST TIME AFTER THE DATE IN IDATEP
    194 C              - THAT IS A MULTIPLE OF 3
    195 C     IUNITE   - UNIT NUMBER OF INPUT OBSERVATION ERROR FILE
    196 C              - (USED ONLY IN PREVENTS MODE)
    197 C     IUNITP   - UNIT NUMBER OF OUTPUT PREPBUFR DATA SET
    198 C     IUNITS   - UNIT NUMBER OF "PREVENT" EVENTS DATA FILTERING
    199 C              - SUMMARY PRINT FILE
    200 C              - (USED ONLY IN PREVENTS MODE)
    201 C     SUBSET   - THE BUFR MESSAGE TABLE A ENTRY FOR THE PARTICULAR
    202 C              - REPORT BEING PROCESSED
    203 C     NEWTYP   - INDICATOR IF THE BUFR MESSAGE TABLE A ENTRY HAS
    204 C              - CHANGED FROM THAT OF THE PREVIOUS REPORT (=0 - NO,
    205 C              - =1 - YES)
    206 C                
    207 C
    208 C   INPUT FILES:
    209 C     UNIT 05  - STANDARD INPUT (DATA CARDS - SEE NAMELIST
    210 C                DOCUMENTATION BELOW)
    211 C                (NOTE: IF STANDARD INPUT FILE IS NULL, THEN THIS
    212 C                       SUBROUTINE RUNS IN POSTEVENTS MODE)
    213 C     UNIT AA  - PREPBUFR DATA SET
    214 C              - (WHERE AA IS UNIT NUMBER DEFINED AS IUNITP IN
    215 C              - INPUT ARGUMENT LIST)
    216 C     UNIT BB  - SPECTRAL (GLOBAL) SIGMA GUESS (PREVENTS MODE) OR
    217 C              - ANALYSIS (POSTEVENTS MODE) FILE
    218 C              - (WHERE BB IS UNIT NUMBER DEFINED AS IUNITF(1) IN
    219 C              - INPUT ARGUMENT LIST)
    220 C     UNIT CC  - SPECTRAL (GLOBAL) SIGMA GUESS (PREVENTS MODE) OR
    221 C              - ANALYSIS (POSTEVENTS MODE) FILE
    222 C              - (WHERE CC IS UNIT NUMBER DEFINED AS IUNITF(2) IN
    223 C              - INPUT ARGUMENT LIST)
    224 C     UNIT DD  - OBSERVATION ERROR FILE (WHERE DD IS UNIT NUMBER
    225 C              - DEFINED AS IUNITE IN INPUT ARGUMENT LIST)
    226 C              - (USED ONLY IN PREVENTS MODE)
    227 C
    228 C   OUTPUT FILES:

Page 5           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    229 C     UNIT 06  - STANDARD OUTPUT PRINT
    230 C     UNIT AA  - PREPBUFR DATA SET
    231 C              - (WHERE AA IS UNIT NUMBER DEFINED AS IUNITP IN
    232 C              - INPUT ARGUMENT LIST)
    233 C     UNIT DD  - "PREVENT" EVENTS DATA FILTERING SUMMARY PRINT FILE
    234 C              - (WHERE DD IS UNIT NUMBER DEFINED AS IUNITS IN
    235 C              - INPUT ARGUMENT LIST)
    236 C              - (USED ONLY IN PREVENTS MODE)
    237 C
    238 C   SUBPROGRAMS CALLED:
    239 C     UNIQUE:      CGBLEVN01 CGBLEVN02   CGBLEVN03    CGBLEVN04
    240 C                  CGBLEVN05 CGBLEVN06   OEFG01_C
    241 C                  CGBLEVN08 CGBLEVN09   CGBLEVN10    CGBLEVN11
    242 C                  ZSG01_C   CGBLEVN12   PSG01_C      CGBLEVN13
    243 C                  TG01_C    CGBLEVN14   UG01_C       CGBLEVN15
    244 C                  VG01_C    CGBLEVN16   QG01_C       CGBLEVN17
    245 C     LIBRARY:
    246 C       SPLIB    - SPTEZM   SPTEZMV
    247 C       W3NCO    - W3MOVDAT ERREXIT
    248 C       BUFRLIB  - UFBINT   UFBQCD   GETBMISS
    249 C
    250 C   EXIT STATES:
    251 C     COND =   0 - SUCCESSFUL RUN
    252 C     COND =  60 - OBSERVATION ERROR TABLE EMPTY OR DOES NOT EXIST
    253 C     COND =  61 - VARIABLE NLTD .NE. VARIABLE NLEV
    254 C     COND =  62 - VARIABLE NLTQ .NE. VARIABLE NLEV
    255 C     COND =  63 - VARIABLE NLQQ .NE. VARIABLE NLEV
    256 C     COND =  64 - END OF FILE READING SIGMA FIRST GUESS OR ANALYSIS
    257 C                - - UNABLE TO TRANSFORM FIRST GUESS OR ANALYSIS
    258 C     COND =  65 - ERROR READING FIRST GUESS OR ANALYSIS - UNABLE TO
    259 C                - TRANSFORM FIRST GUESS OR ANALYSIS
    260 C     COND =  66 - VARIABLE IDIM NOT FACTORABLE - UNABLE TO TRANSFORM
    261 C                  FIRST GUESS OR ANALYSIS
    262 C     COND =  67 - BAD OR MISSING FIRST GUESS OR ANALYSIS FILE(S)
    263 C     COND =  68 - DATE OF FIRST GUESS/ANALYSIS FILE(S) DOES NOT MATCH,
    264 C                - OR AT LEAST SPAN, THE CENTER DATE FOR THE PREPBUFR
    265 C                - FILE
    266 C     COND =  69 - VARIABLE KMAX TOO BIG - UNABLE TO TRANSFORM FIRST
    267 C                - GUESS OR ANALYSIS FILE(S)
    268 C     COND =  70 - VARIABLE IMAX TOO SMALL - UNABLE TO TRANSFORM FIRST
    269 C                - GUESS OR ANALYSIS FILE(S) (NOTE: Effective 9/27/01
    270 C                - this can never occur)
    271 C     COND =  71 - ONE OR MORE HEADER VALUES DO NOT MATCH WHEN TWO
    272 C                - SIGMA FILES SPANNING THE CENTER DATE FOR THE
    273 C                - PREPBUFR FILE ARE READ
    274 C
    275 C
    276 C REMARKS: THIS ROUTINE PROCESSES ONE REPORT AT A TIME.  IT EXPECTS
    277 C     THAT THE CALLING PROGRAM HAS ALREADY ENCODED THE REPORT INTO
    278 C     THE PREPBUFR FILE VIA THE UFBINT OR UFBCPY ROUTINES.  THE CALLING
    279 C     PROGRAM SHOULD THEN CALL THIS ROUTINE AND, UPON ITS RETURN, THE
    280 C     CALLING PROGRAM SHOULD CALL WRITSB TO ACTUALLY WRITE THE UPDATED
    281 C     SUBSET (REPORT) INTO THE BUFR MESSAGE.
    282 CC
    283 C  ***** VARIABLES IN NAMELIST PREVDATA READ IN BY THIS SUBROUTINE *****
    284 C               (NOTE: IF STANDARD INPUT FILE IS NULL, THEN THIS
    285 C                      SUBROUTINE RUNS IN POSTEVENTS MODE - DOANLS=TRUE

Page 6           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    286 C                      AND ALL OTHER VARIABLES ARE SET TO FALSE)
    287 CC
    288 CC
    289 C    DOVTMP & ADPUPA_VIRT:
    290 C      DOVTMP  - WRITE VIRTUAL TEMPERATURE EVENT FOR THE FOLLOWING
    291 C                TYPES OF REPORTS:
    292 C                ADPUPA_VIRT = .FALSE.  ---> SURFACE LAND, MARINE,
    293 C                                             MESONET AND RASS REPORTS?
    294 C                ADPUPA_VIRT = .TRUE.   ---> SURFACE LAND, MARINE,
    295 C                                             MESONET RASS, RAOB, DROP
    296 C                                             AND MULTI-LEVEL RECCO
    297 C                                             REPORTS?
    298 C              FOR ALL TYPES EXCEPT RASS, THIS WILL ATTEMPT TO
    299 C              CALCULATE VIRTUAL TEMPERATURE FROM SENSIBLE TEMPERATURE
    300 C              AND ENCODE IT AS A STACKED EVENT IN THE PREPBUFR FILE.
    301 C              FOR RASS REPORTS THIS WILL JUST ENCODE THE REPORTED
    302 C              TEMPERATURE AS A STACKED EVENT IN THE PREPBUFR FILE
    303 C              SINCE THE REPORTED TEMPERATURE IS ALREADY VIRTUAL.
    304 C                DOVTMP = .TRUE.  ---> YES                     (DEFAULT)
    305 C                DOVTMP = .FALSE. ---> NO
    306 C      {NOTE1: FOR SURFACE LAND, MARINE AND MESONET REPORTS, (AND
    307 C              RAOB, DROP AND MULTI-LEVEL RECCO REPORTS IF
    308 C              "ADPUPA_VIRT"=TRUE) DOVTMP=FALSE WILL STILL RE-CALCULATE
    309 C              SPECIFIC HUMIDITY AND ENCODE IT AS A STACKED EVENT IN
    310 C              THE PREPBUFR FILE UNLESS DOANLS IS TRUE.)
    311 C      (NOTE2: DOES NOT APPLY TO ANY REPORT TYPES OTHER THAN THOSE
    312 C              MENTIONED ABOVE)
    313 C      (NOTE3: IF DOANLS=TRUE, THEN DOVTMP IS NOT ONLY FORCED TO BE
    314 C              FALSE, BUT ALSO SPECIFIC HUMIDITY IS NOT RE-CALCULATED.)
    315 C      (NOTE4: ADPUPA_VIRT DEFAULTS TO FALSE.)
    316 C
    317 C    DOFCST & SOME_FCST:
    318 C      DOFCST  - ENCODE FORECAST (FIRST GUESS) VALUES, INTERPOLATED
    319 C                FROM THE SPECTRAL SIGMA GUESS FILE, INTO THE PREPBUFR
    320 C                FILE FOR ALL MESSAGE TYPES OR AT LEAST SOME MESSAGE
    321 C                TYPES?
    322 C                DOFCST = .TRUE.  ---> YES, ENCODE FORECST FOR ALL
    323 C                                       MESSAGE TYPES          (DEFAULT)
    324 C                DOFCST = .FALSE.
    325 C                  SOME_FCST = .FALSE. ---> NO, DO NOT ENCODE FORECAST
    326 C                                            FOR ANY MESSAGE TYPE
    327 C                                            (VALUES REMAIN MISSING)
    328 C                  SOME_FCST = .TRUE.  ---> YES, BUT ONLY FOR MESSAGE
    329 C                                            TYPES "ADPUPA", "AIRCFT",
    330 C                                            "AIRCAR", "PROFLR" OR
    331 C                                            "VADWND" (VALUES REMAIN
    332 C                                            MISSING FOR ALL OTHER
    333 C                                            MESSAGE TYPES)
    334 C      (NOTE1: THE CASE DOFCST=FALSE & SOME_FCST=TRUE WRITES THE
    335 C              FORECAST VALUES FOR THE TYPES MENTIONED ABOVE BECAUSE
    336 C              THEY ARE NEEDED BY SUBSEQUENT QUALITY CONTROL PROGRAMS.)
    337 C      (NOTE2: THIS WAS ADDED AS A TIME SAVING FEATURE IN THE
    338 C              NON-GLOBAL VERSIONS SINCE ONLY THE GLOBAL-SSI REQUIRES
    339 C              A FIRST GUESS TO BE PRESENT FOR ALL CONVENTIONAL MESSAGE
    340 C              TYPES IN THE PREPBUFR FILE.)
    341 C      (NOTE3: IF DOANLS=TRUE, THEN DOFCST & SOME_FCST ARE FORCED TO BE
    342 C              FALSE, MEANING A GUESS WILL NOT BE ENCODED FOR ANY

Page 7           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    343 C              MESSAGE TYPE.)
    344 C      (NOTE4: IF DOFCST=TRUE, THEN SOME_FCST IS MEANINGLESS.)
    345 C      (NOTE5: SOME_FCST DEFAULTS TO TRUE.)
    346 C
    347 C    DOANLS  - ENCODE ANALYZED VALUES, INTERPOLATED FROM THE SPECTRAL
    348 C              SIGMA ANALYSIS FILE, INTO THE PREPBUFR FILE - POSTEVENTS
    349 C              MODE - ?
    350 C              DOANLS = .TRUE.  ---> YES, FOR ALL MESSAGE TYPES
    351 C              DOANLS = .FALSE. ---> NO,  FOR ALL MESSAGE TYPES
    352 C                                          - PREVENTS MODE -   (DEFAULT)
    353 C      (NOTE:  DOANLS=TRUE WILL OVERRIDE AND FORCE TO FALSE ALL OTHER
    354 C              SWITCHES. IN ADDITION, THE FORECAST VALUES WILL NOT
    355 C              BE ENCODED FOR ANY MESSAGE TYPE AND SPECIFIC HUMIDITY
    356 C              WILL NOT BE RE-CALCULATED.)
    357 C
    358 C    DOBERR  - ENCODE OBSERVATIONAL ERROR VALUES, AS READ FROM OBS.
    359 C              ERROR FILE, INTO THE PREPBUFR FILE?
    360 C              DOBERR = .TRUE.  ---> YES                       (DEFAULT)
    361 C              DOBERR = .FALSE. ---> NO (VALUES REMAIN MISSING)
    362 C      (NOTE1: THIS WAS ADDED AS A TIME SAVING FEATURE IN THE
    363 C              RAP -AND PREVIOUS RUC- VERSION SINCE IT DOES NOT REQUIRE
    364 C              OBSERVATIONAL ERRORS TO BE PRESENT IN THE PREPBUFR FILE.)
    365 C      (NOTE2: IF DOANLS=TRUE, THEN DOBERR IS FORCED TO BE FALSE.)
    366 C
    367 C    QTOP_REJ  - THE PRESSURE LEVEL (IN MB) ABOVE WHICH ALL SPECIFIC
    368 C                HUMIDITY QUALITY MARKERS ARE "REJECTED" (THE QUALITY
    369 C                MARKER IS SET TO 9 ON ALL PRESSURE LEVELS LESS THAN
    370 C                THIS LEVEL)                              (DEFAULT=300.)
    371 C
    372 C    SATMQC  - PERFORM SPECIAL QUALITY CONTROL ON SATELLITE TEMPERATURE
    373 C              SOUNDINGS IN REPORT TYPES 160-179?
    374 C              SATMQC = .TRUE.  ---> YES
    375 C              SATMQC = .FALSE. ---> NO                        (DEFAULT)
    376 C      (NOTE: THIS APPLIES ONLY TO THE CDAS OR HISTORICAL RE-RUNS
    377 C             WITH TEMPERATURE SOUNDINGS IN THESE REPORT TYPES)
    378 C
    379 CC
    380 C
    381 C ATTRIBUTES:
    382 C   LANGUAGE: FORTRAN 90
    383 C   MACHINE:  NCEP WCOSS
    384 C
    385 C$$$
    386       SUBROUTINE GBLEVENTS_CDAS(IDATEP,IUNITF,IUNITE,IUNITP,IUNITS,
    387      $                         SUBSET,NEWTYP)
    388 
    389       CHARACTER*80 HEADR,OBSTR,FCSTR,OESTR,ANSTR
    390       CHARACTER*8  SUBSET
    391       REAL(8)      OBS_8,BAK_8,SID_8,HDR_8(10)
    392       REAL(8)      BMISS,GETBMISS
    393       LOGICAL      DOVTMP,DOFCST,SOME_FCST,DOBERR,FCST,VIRT,DOANLS,
    394      $             SATMQC,ADPUPA_VIRT
    395 
    396       DIMENSION    IUNITF(2)
    397 
    398       COMMON /CGBEVAA/ SID_8,OBS_8(12,255),BAK_8(12,255),NLEV,XOB,YOB,
    399      $ DHR,TYP

Page 8           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    400       COMMON /CGBEVBB/ PVCD,VTCD
    401       COMMON /CGBEVCC/ DOVTMP,DOFCST,SOME_FCST,DOBERR,FCST,VIRT,
    402      $ QTOP_REJ,SATMQC,ADPUPA_VIRT
    403       COMMON /CGBEVDD/ ERRS(300,33,6)
    404       COMMON /CGBEVGG/ BMISS
    405 
    406       SAVE
    407 
    408       DATA IFIRST/0/
    409 
    410       DATA HEADR /
    411      $ 'SID XOB YOB DHR TYP                                  '/
    412       DATA OBSTR /
    413      $ 'POB QOB TOB ZOB UOB VOB PWO  PW1O PW2O PW3O PW4O CAT '/
    414       DATA FCSTR /
    415      $ 'PFC QFC TFC ZFC UFC VFC PWF  PW1F PW2F PW3F PW4F NUL '/
    416       DATA ANSTR /
    417      $ 'PAN QAN TAN ZAN UAN VAN PWA  PW1A PW2A PW3A PW4A NUL '/
    418       DATA OESTR /
    419      $ 'POE QOE TOE ZOE WOE PWE PW1E PW2E PW3E PW4E NUL  NUL '/
    420 
    421       NAMELIST /PREVDATA/DOVTMP,DOFCST,SOME_FCST,DOBERR,DOANLS,
    422      $ QTOP_REJ,SATMQC,ADPUPA_VIRT
    423 
    424 C----------------------------------------------------------------------
    425 C----------------------------------------------------------------------
    426 
    427       IF(IFIRST.EQ.0)  THEN
    428 
    429 C -------------------------------
    430 C FIRST TIME IN DO A FEW THINGS...
    431 C -------------------------------
    432 
    433          IFIRST = 1
    434          PRINT 700
    435   700 FORMAT(/1X,100('#')/' =====> SUBROUTINE GBLEVENTS_CDAS INVOKED ',
    436      $ 'FOR THE FIRST TIME - VERSION LAST UPDATED 2014-01-24'/)
    437 
    438 C  INITIALIZE NAMELIST SWITCHES TO DEFAULT VALUES
    439 C  ----------------------------------------------
    440 
    441          DOVTMP      = .TRUE.
    442          DOFCST      = .TRUE.
    443          SOME_FCST   = .TRUE.
    444          DOBERR      = .TRUE.
    445          DOANLS      = .FALSE.
    446          QTOP_REJ    = 300.
    447          SATMQC      = .FALSE.
    448          ADPUPA_VIRT = .FALSE.
    449          READ(5,PREVDATA,ERR=101,END=102)
    450          GO TO 103
    451 C-----------------------------------------------------------------------
    452   101    CONTINUE
    453 
    454 C  ERROR READING STANDARD INPUT - THIS DEFAULTS TO POSTEVENTS MODE
    455 C  ---------------------------------------------------------------
    456 

Page 9           Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    457          PRINT 7013
    458  7013 FORMAT(/' ##> GBLEVENTS_CDAS: ERROR READING STANDARD INPUT DATA ',
    459      $ 'CARDS -- DEFAULTS TO "POSTEVENTS" MODE'/)
    460          DOANLS = .TRUE.
    461          GO TO 103
    462 
    463 C-----------------------------------------------------------------------
    464   102    CONTINUE
    465 
    466 C  STANDARD INPUT IS EMPTY - THIS DEFAULTS TO POSTEVENTS MODE
    467 C  ----------------------------------------------------------
    468 
    469          PRINT 7014
    470  7014 FORMAT(/' ##> GBLEVENTS_CDAS: STANDARD INPUT DATA CARDS DO NOT ',
    471      $ 'EXIST -- DEFAULTS TO "POSTEVENTS" MODE'/)
    472          DOANLS = .TRUE.
    473 
    474 C-----------------------------------------------------------------------
    475   103    CONTINUE
    476          IF(DOANLS) THEN
    477             DOVTMP      = .FALSE.
    478             DOFCST      = .FALSE.
    479             SOME_FCST   = .FALSE.
    480             DOBERR      = .FALSE.
    481             ADPUPA_VIRT = .FALSE.
    482          ENDIF
    483          WRITE (6,PREVDATA)
    484 
    485          BMISS = GETBMISS()
    486          print *
    487          print'(" BUFRLIB value for missing passed into GBLEVENTS_CDAS",
    488      $    " is: ",G0)', bmiss
    489 cccc $    " is: ",F21.5)', bmiss
    490          print *
    491 
    492          FCST = DOFCST
    493          VIRT = .FALSE.
    494 
    495          FCST = DOFCST
    496          VIRT = .FALSE.
    497 
    498 C  CHECK VALID-TIME DATE OF GUESS/ANALYSIS FILE(S) AGAINST THE CENTER
    499 C   DATE FOR THE PREPBUFR FILE AND OBTAIN THE FIRST GUESS/ANALYSIS
    500 C   UNLESS ALL OF DOFCST, SOME_FCST, DOANLS ARE FALSE
    501 C  ------------------------------------------------------------------
    502 
    503          IF(.NOT.DOANLS)  THEN
    504             IF(.NOT.DOFCST.AND..NOT.SOME_FCST)  THEN
    505                PRINT 901
    506   901 FORMAT(/' --> GBLEVENTS_CDAS: PREVENTS MODE - FIRST GUESS NOT ',
    507      $ 'READ IN'/)
    508             ELSE
    509                PRINT 701
    510   701 FORMAT(/' --> GBLEVENTS_CDAS: PREVENTS MODE - DATE CHECK AND ',
    511      $ 'TRANSFORM THE FIRST GUESS'/)
    512             END IF
    513          ELSE

Page 10          Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    514             PRINT 7701
    515  7701 FORMAT(/' --> GBLEVENTS_CDAS: POSTEVENTS MODE - DATE CHECK AND ',
    516      $ 'TRANSFORM THE ANALYSIS'/)
    517          END IF
    518 
    519          IF(DOFCST .OR. SOME_FCST .OR. DOANLS)
    520      $    CALL CGBLEVN10(IUNITF,IDATEP)
    521 
    522          IF(DOBERR)  THEN
    523 
    524 C  IF REQUESTED, READ ERROR FILES (ONLY POSSIBLE IN PREVENTS MODE)
    525 C  ---------------------------------------------------------------
    526 
    527             PRINT 702
    528   702 FORMAT(/' --> GBLEVENTS_CDAS: READ ERROR FILES'/)
    529 
    530             CALL CGBLEVN01(IUNITE)
    531 
    532          ELSE
    533 
    534             ERRS = 0
    535             IF(.NOT.DOANLS)  PRINT 3702
    536  3702 FORMAT(/' --> GBLEVENTS_CDAS: OBS. ERROR NOT ENCODED IN PREPBUFR',
    537      $ ' (BY CHOICE)'/)
    538 
    539          END IF
    540 
    541 C  OBTAIN NECESSARY PROGRAM CODES (ONLY USED IN PREVENTS MODE)
    542 C  -----------------------------------------------------------
    543 
    544          CALL UFBQCD(IUNITP,'PREVENT',PVCD)
    545          CALL UFBQCD(IUNITP,'VIRTMP ',VTCD)
    546 
    547          PRINT 703
    548   703 FORMAT(/1X,100('#')/)
    549 
    550 C  SET-UP OUTPUT "PREVENT" EVENTS DATA FILTERING SUMMARY PRINT FILE
    551 C  (ONLY USED IN PREVENTS MODE)
    552 C  ----------------------------------------------------------------
    553 
    554          IF(.NOT.DOANLS)  WRITE(IUNITS,1701) IDATEP
    555  1701 FORMAT(//130('#')//38X,'*** "PREVENT" EVENTS DATA FILTERING ',
    556      $ 'SUMMARY ***'/35X,'--> CENTER DATE FOR PREPBUFR FILE IS: ',I10,
    557      $ ' <--'//)
    558 
    559 C----------------------------------------------------------------------
    560 C----------------------------------------------------------------------
    561 
    562       END IF
    563 
    564       IF(.NOT.DOANLS)  THEN
    565 
    566          IF(NEWTYP.EQ.1)  WRITE(IUNITS,1702)  SUBSET
    567  1702 FORMAT(130('-')/39X,'--> SUMMARY FOR TABLE A ENTRY "',A8,'" <--'/)
    568 
    569          IF(.NOT.DOFCST .AND. SOME_FCST)  FCST = (SUBSET.EQ.'ADPUPA  '
    570      $    .OR.SUBSET.EQ.'PROFLR  '.OR.SUBSET .EQ.'AIRCFT  '.OR.SUBSET

Page 11          Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    571      $    .EQ.'AIRCAR  '.OR.SUBSET .EQ.'VADWND  ')
    572 
    573 C   Will not subject ACARS reports to virtual temp. processing until
    574 C    spec. humidity is used in production
    575 
    576 ccccc    VIRT = (SUBSET.EQ.'ADPSFC  '.OR.SUBSET.EQ.'SFCSHP  '.OR.
    577 ccccc$           SUBSET.EQ.'MSONET  '.OR.SUBSET.EQ.'AIRCAR  '.OR.
    578 ccccc$           SUBSET.EQ.'RASSDA  '.OR.(SUBSET.EQ.'ADPUPA  '.AND.
    579 ccccc$           ADPUPA_VIRT)))
    580          VIRT = (SUBSET.EQ.'ADPSFC  '.OR.SUBSET.EQ.'SFCSHP  '.OR.
    581      $           SUBSET.EQ.'MSONET  '.OR.SUBSET.EQ.'RASSDA  '.OR.
    582      $           (SUBSET.EQ.'ADPUPA  '.AND.ADPUPA_VIRT))
    583 
    584 
    585          IF(.NOT.(FCST.OR.DOBERR.OR.VIRT)) THEN
    586             IF(NEWTYP.EQ.1)  WRITE(IUNITS,1703)
    587  1703 FORMAT(/'  ==> DATA FILTERING NOT PERFORMED FOR THIS TABLE A ',
    588      $ 'ENTRY -- FORECAST, OBS ERROR, "VIRTMP" PROCESSING NOT DONE'/)
    589             RETURN
    590          ENDIF
    591 
    592       END IF
    593 
    594 C  READY TO RETRIEVE NECESSARY INFORMATION OUT OF THE NEXT REPORT WHICH
    595 C  HAS BEEN "UFB" ENCODED INTO THE PREPBUFR FILE BY THE CALLING PROGRAM
    596 C  (USE NEGATIVE UNIT NUMBER HERE SINCE FILE OPEN FOR OUTPUT)
    597 C  (NOTE: THE CALLING PROGRAM HAS NOT YET WRIITEN THE REPORT INTO
    598 C         THE PREPBUFR FILE VIA WRITSB!)
    599 C  ----------------------------------------------------------------
    600 
    601       CALL UFBINT(-IUNITP,OBS_8,12,255,NLEV,OBSTR)
    602       CALL UFBINT(-IUNITP,HDR_8,10,  1,IRET,HEADR)
    603       SID_8 = HDR_8(1)
    604       XOB   = HDR_8(2)
    605 
    606 c Trap cases where XOB comes in w/ a value of 360.0 and reset to 0.0
    607       fuzzy_bound = XOB-360.0
    608       if (fuzzy_bound .ge. -0.0001 .and. fuzzy_bound .le. .0001) then 
    609 c        print*, 'xob fuzzb:',xob,fuzzy_bound
    610 c        write(*,*) 'failed the fuzzy check', xob
    611          XOB=0.0
    612       endif
    613 
    614       YOB   = HDR_8(3)
    615       DHR   = HDR_8(4)
    616       TYP   = HDR_8(5)
    617 
    618       IF(FCST.OR.DOANLS)  THEN
    619 
    620 C  PREVENTS MODE:   ENCODE FIRST GUESS VALUES INTO PREPBUFR FILE
    621 C  ------------------------------------------------------------
    622 
    623 C  POSTEVENTS MODE: ENCODE ANALYSIS VALUES INTO REPORT AND RETURN TO
    624 C                   CALLING PROGRAM TO WRITE GBL-EVENTED REPORT
    625 C                   (SUBSET) INTO PREPBUFR FILE
    626 C  -----------------------------------------------------------------
    627 

Page 12          Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    628          CALL CGBLEVN03(SUBSET)
    629          IF(NLEV.GT.0)  THEN
    630             IF(FCST)   THEN
    631                CALL UFBINT(IUNITP,BAK_8,12,NLEV,IRET,FCSTR)
    632             ELSE
    633                CALL UFBINT(IUNITP,BAK_8,12,NLEV,IRET,ANSTR)
    634                RETURN
    635             END IF
    636          END IF
    637       END IF
    638 
    639 C  --------------------------------------------------------------------
    640 C  LOGIC FROM HERE ON PERTAINS ONLY TO PREVENTS MODE OF THIS SUBROUTINE
    641 C  --------------------------------------------------------------------
    642 
    643 
    644       IF(DOBERR)  THEN
    645 
    646 C  ENCODE OBSERVATION ERRORS INTO REPORT
    647 C  -------------------------------------
    648 
    649          CALL CGBLEVN04
    650          IF(NLEV.GT.0)  CALL UFBINT(IUNITP,BAK_8,12,NLEV,IRET,OESTR)
    651       END IF
    652 
    653 C  MAKE THE GBLEVENTS_CDAS EVENTS AND ENCODE INTO REPORT
    654 C  -----------------------------------------------------
    655 
    656       IF(.NOT.FCST)  THEN
    657          IF(NEWTYP.EQ.1)  WRITE(IUNITS,1704)
    658  1704 FORMAT(/'  ==> FORECAST VALUES NOT ENCODED FOR THIS TABLE A ',
    659      $ 'ENTRY'//'  ==> FILTERING VIA POB VS. GESS PSFC TEST NOT ',
    660      $ 'PERFORMED FOR THIS TABLE A ENTRY SINCE FORECAST VALUES NOT ',
    661      $ 'PROCESSED/STORED'/)
    662       ELSE
    663          IF(NEWTYP.EQ.1)  WRITE(IUNITS,1708)
    664  1708 FORMAT(/'  ==> FORECAST VALUES ARE ENCODED FOR THIS TABLE A ',
    665      $ 'ENTRY'//'  ==> FILTERING VIA POB VS. GESS PSFC TEST IS  ',
    666      $ 'PERFORMED FOR THIS TABLE A ENTRY SINCE FORECAST VALUES ARE ',
    667      $ 'PROCESSED/STORED'/)
    668       ENDIF
    669 
    670       IF(.NOT.DOBERR)  THEN
    671          IF(NEWTYP.EQ.1)  WRITE(IUNITS,1705)
    672  1705 FORMAT(/'  ==> FILTERING VIA MISSING OBS ERROR TEST NOT POSSIBLE',
    673      $ ' FOR THIS TABLE A ENTRY SINCE OBS ERROR VALUES NOT PROCESSED/',
    674      $ 'STORED'/)
    675       ENDIF
    676 
    677       CALL CGBLEVN02(IUNITP,IUNITS,NEWTYP)
    678 
    679 C  MAKE THE VIRTUAL TEMPERATURE EVENTS AND ENCODE INTO REPORT
    680 C  ----------------------------------------------------------
    681 
    682       IF(.NOT.VIRT)  THEN
    683          IF(NEWTYP.EQ.1)  WRITE(IUNITS,1706)
    684  1706 FORMAT(/'  ==> "VIRTMP" EVENT PROCESSING NOT PERFORMED FOR THIS ',

Page 13          Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    685      $ 'TABLE A ENTRY'/)
    686       ELSE
    687          IF(NEWTYP.EQ.1)  WRITE(IUNITS,1707)
    688  1707 FORMAT(/'  ==> "VIRTMP" EVENT PROCESSING IS  PERFORMED FOR THIS ',
    689      $ 'TABLE A ENTRY'/)
    690          CALL CGBLEVN08(IUNITP,SUBSET)
    691       ENDIF
    692 
    693 C  RETURN TO CALLING PROGRAM TO WRITE GBL-EVENTED REPORT (SUBSET) INTO
    694 C   PREPBUFR FILE
    695 C  -------------------------------------------------------------------
    696 
    697       RETURN
    698 
    699       END


ENTRY POINTS

  Name                       
                             
 gblevents_cdas_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  452                                                            449                               
 102                        Label  464                                                            449                               
 103                        Label  475                                                            450,461                           
 1701                       Label  555                                                            554                               
 1702                       Label  567                                                            566                               
 1703                       Label  587                                                            586                               
 1704                       Label  658                                                            657                               
 1705                       Label  672                                                            671                               
 1706                       Label  684                                                            683                               
 1707                       Label  688                                                            687                               
 1708                       Label  664                                                            663                               
 3702                       Label  536                                                            535                               
 700                        Label  435                                                            434                               
 701                        Label  510                                                            509                               
 7013                       Label  458                                                            457                               
 7014                       Label  470                                                            469                               
 702                        Label  528                                                            527                               
 703                        Label  548                                                            547                               
 7701                       Label  515                                                            514                               
 901                        Label  506                                                            505                               
 ADPUPA_VIRT                Scalar 394      L(4)            4           scalar   COM              422,448,481,582                   
 ANSTR                      Local  389      CHAR            80          scalar   SAVE             416,633                           
 BAK_8                      Scalar 391      R(8)            8     2     3060     COM              631,633,650                       
 BMISS                      Scalar 392      R(8)            8           scalar   COM              485,488                           
 CGBEVAA                    Common 398                                  48988    SAVE                                               
 CGBEVBB                    Common 400                                  8        SAVE                                               
 CGBEVCC                    Common 401                                  36       SAVE                                               
 CGBEVDD                    Common 403                                  237600   SAVE                                               
 CGBEVGG                    Common 404                                  8        SAVE                                               

Page 14          Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBLEVN01                  Subr   530                                                            530                               
 CGBLEVN02                  Subr   677                                                            677                               
 CGBLEVN03                  Subr   628                                                            628                               
 CGBLEVN04                  Subr   649                                                            649                               
 CGBLEVN08                  Subr   690                                                            690                               
 CGBLEVN10                  Subr   520                                                            520                               
 DHR                        Scalar 399      R(4)            4           scalar   COM              615                               
 DOANLS                     Local  393      L(4)            4           scalar   SAVE             421,445,460,472,476,503,519,535,55
                                                                                                  4,564,618                         
 DOBERR                     Scalar 393      L(4)            4           scalar   COM              421,444,480,522,585,644,670       
 DOFCST                     Scalar 393      L(4)            4           scalar   COM              421,442,478,492,495,504,519,569   
 DOVTMP                     Scalar 393      L(4)            4           scalar   COM              421,441,477                       
 ERRS                       Scalar 403      R(4)            4     3     59400    COM              534                               
 FCST                       Scalar 393      L(4)            4           scalar   COM              492,495,569,585,618,630,656       
 FCSTR                      Local  389      CHAR            80          scalar   SAVE             414,631                           
 FUZZY_BOUND                Local  607      R(4)            4           scalar   SAVE             607,608                           
 GBLEVENTS_CDAS             Subr   386                                                                                              
 GETBMISS                   Func   392      R(8)            8           scalar                    485                               
 HDR_8                      Local  391      R(8)            8     1     10       SAVE             602,603,604,614,615,616           
 HEADR                      Local  389      CHAR            80          scalar   SAVE             410,602                           
 IDATEP                     Dummy  386      I(4)            4           scalar   ARG,INOUT        520,554                           
 IFIRST                     Local  408      I(4)            4           scalar   SAVE             408,427,433                       
 IRET                       Local  602      I(4)            4           scalar   SAVE             602,631,633,650                   
 IUNITE                     Dummy  386      I(4)            4           scalar   ARG,INOUT        530                               
 IUNITF                     Dummy  386      I(4)            4     1     2        ARG,INOUT        520                               
 IUNITP                     Dummy  386      I(4)            4           scalar   ARG,INOUT        544,545,601,602,631,633,650,677,69
                                                                                                  0                                 
 IUNITS                     Dummy  386      I(4)            4           scalar   ARG,INOUT        554,566,586,657,663,671,677,683,68
                                                                                                  7                                 
 NEWTYP                     Dummy  387      I(4)            4           scalar   ARG,INOUT        566,586,657,663,671,677,683,687   
 NLEV                       Scalar 398      I(4)            4           scalar   COM              601,629,631,633,650               
 OBSTR                      Local  389      CHAR            80          scalar   SAVE             412,601                           
 OBS_8                      Scalar 391      R(8)            8     2     3060     COM              601                               
 OESTR                      Local  389      CHAR            80          scalar   SAVE             418,650                           
 PREVDATA                   Local  421                                  scalar                    449,483                           
 PVCD                       Scalar 400      R(4)            4           scalar   COM              544                               
 QTOP_REJ                   Scalar 402      R(4)            4           scalar   COM              422,446                           
 SATMQC                     Scalar 394      L(4)            4           scalar   COM              422,447                           
 SID_8                      Scalar 391      R(8)            8           scalar   COM              603                               
 SOME_FCST                  Scalar 393      L(4)            4           scalar   COM              421,443,479,504,519,569           
 SUBSET                     Dummy  387      CHAR            8           scalar   ARG,INOUT        566,569,570,571,580,581,582,628,69
                                                                                                  0                                 
 TYP                        Scalar 399      R(4)            4           scalar   COM              616                               
 UFBINT                     Subr   601                                                            601,602,631,633,650               
 UFBQCD                     Subr   544                                                            544,545                           
 VIRT                       Scalar 393      L(4)            4           scalar   COM              493,496,580,585,682               
 VTCD                       Scalar 400      R(4)            4           scalar   COM              545                               
 XOB                        Scalar 398      R(4)            4           scalar   COM              604,607,611                       
 YOB                        Scalar 398      R(4)            4           scalar   COM              614                               

Page 15          Source Listing                  GBLEVENTS_CDAS
2017-04-18 11:09                                 gblevents_cdas.f

    700 C***********************************************************************
    701 C***********************************************************************
    702       SUBROUTINE CGBLEVN01(IUNITE) ! FORMERLY SUBROUTINE ETABLE
    703 
    704       COMMON /CGBEVDD/ ERRS(300,33,6)
    705 
    706 C  READ THE OBSERVATION ERROR TABLES
    707 C  ---------------------------------
    708 
    709       REWIND IUNITE
    710 
    711       IREC = 0
    712 
    713    10 CONTINUE
    714       READ(IUNITE,'(1X,I3)',END=100) KX
    715       IREC = IREC + 1
    716       DO K=1,33
    717          READ(IUNITE,'(1X,6E12.5)') (ERRS(KX,K,M),M=1,6)
    718       ENDDO
    719       GO TO 10
    720 
    721   100 CONTINUE
    722       IF(IREC.EQ.0) THEN
    723          PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN01 - OBS. ERROR TABLE EMPTY",
    724      $    " OR DOES NOT EXIST - STOP 60")'
    725          CALL ERREXIT(60)
    726       END IF
    727 
    728       RETURN
    729 
    730       END

Page 16          Source Listing                  CGBLEVN01
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                  
                        
 cgblevn01_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  713                                                            719                               
 100                        Label  721                                                            714                               
 CGBEVDD                    Common 704                                  237600                                                      
 CGBLEVN01                  Subr   702                                                                                              
 ERREXIT                    Subr   725                                                            725                               
 ERRS                       Scalar 704      R(4)            4     3     59400    COM              717                               
 IREC                       Local  711      I(4)            4           scalar                    711,715,722                       
 IUNITE                     Dummy  702      I(4)            4           scalar   ARG,INOUT        709,714,717                       
 K                          Local  716      I(4)            4           scalar                    716,717                           
 KX                         Local  714      I(4)            4           scalar                    714,717                           
 M                          Local  717      I(4)            4           scalar                    717                               

Page 17          Source Listing                  CGBLEVN01
2017-04-18 11:09                                 gblevents_cdas.f

    731 C***********************************************************************
    732 C***********************************************************************
    733       SUBROUTINE CGBLEVN02(IUNITP,IUNITS,NEWTYP)
    734                                          ! FORMERLY SUBROUTINE FILTAN
    735 
    736       DIMENSION    NFLGRT(100:299,12)
    737       CHARACTER*8  STNID
    738       CHARACTER*40 PEVN,QEVN,TEVN,WEVN,PWVN,PW1VN,PW2VN,PW3VN,PW4VN
    739       REAL(8)      PEV_8(4,255),QEV_8(4,255),TEV_8(4,255),WEV_8(5,255),
    740      $             PWV_8(4,255),PW1V_8(4,255),PW2V_8(4,255),
    741      $             PW3V_8(4,255),PW4V_8(4,255),OBS_8,BAK_8,SID_8
    742       REAL(8)      BMISS
    743       LOGICAL      FCST,DN2FAR,REJPS,REJT,REJQ,REJW,REJPW,REJPW1,REJPW2,
    744      $             REJPW3,REJPW4,SATMQC,SATEMP,SOLN60,SOLS60
    745 
    746       COMMON /CGBEVAA/ SID_8,OBS_8(12,255),BAK_8(12,255),NLEV,XOB,YOB,
    747      $ DHR,TYP
    748       COMMON /CGBEVBB/ PVCD,VTCD
    749       COMMON /CGBEVCC/ DOVTMP,DOFCST,SOME_FCST,DOBERR,FCST,VIRT,
    750      $ QTOP_REJ,SATMQC,ADPUPA_VIRT
    751       COMMON /CGBEVEE/PSG01_C,ZSG01_C,TG01_C(100),UG01_C(100),
    752      x     VG01_C(100),QG01_C(100),zint(100),pint(100),pintlog(100),
    753      x     plev(100),plevlog(100)
    754       COMMON /CGBEVGG/ BMISS
    755 
    756       EQUIVALENCE (SID_8,STNID)
    757 
    758       DATA PEVN  /'POB  PQM  PPC  PRC      '/
    759       DATA QEVN  /'QOB  QQM  QPC  QRC      '/
    760       DATA TEVN  /'TOB  TQM  TPC  TRC      '/
    761       DATA WEVN  /'UOB  VOB  WQM  WPC  WRC '/
    762       DATA PWVN  /'PWO  PWQ  PWP  PWR      '/
    763       DATA PW1VN /'PW1O PW1Q PW1P PW1R     '/
    764       DATA PW2VN /'PW2O PW2Q PW2P PW2R     '/
    765       DATA PW3VN /'PW3O PW3Q PW3P PW3R     '/
    766       DATA PW4VN /'PW4O PW4Q PW4P PW4R     '/
    767 
    768       DATA NFLGRT/2400*0/
    769 
    770       NI  = MOD((NINT(TYP)/10),10)
    771 
    772       IF(NEWTYP.EQ.1)  NFLGRT = 0
    773 
    774 C  LOGICAL SWITCHES FOR OBSERVATION LOCATION FILTERING
    775 C  ---------------------------------------------------
    776 
    777       SATEMP = ((TYP.GE.160.AND.TYP.LE.179).AND.SATMQC)
    778       SOLN60 = ((TYP.GE.160.AND.TYP.LE.163).AND.YOB.GE.-60.AND.SATMQC)
    779       SOLS60 = ((TYP.EQ.160.OR.TYP.EQ.162.OR.TYP.EQ.163).AND.YOB.LT.-60
    780      $ .AND.SATMQC)
    781 
    782 C  CLEAR THE EVENT ARRAYS
    783 C  ----------------------
    784 
    785       PEV_8  = BMISS
    786       QEV_8  = BMISS
    787       TEV_8  = BMISS

Page 18          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

    788       WEV_8  = BMISS
    789       PWV_8  = BMISS
    790       PW1V_8 = BMISS
    791       PW2V_8 = BMISS
    792       PW3V_8 = BMISS
    793       PW4V_8 = BMISS
    794 
    795       MAXPEV  = 0
    796       MAXQEV  = 0
    797       MAXTEV  = 0
    798       MAXWEV  = 0
    799       MAXPWV  = 0
    800       MAXPW1V = 0
    801       MAXPW2V = 0
    802       MAXPW3V = 0
    803       MAXPW4V = 0
    804 
    805 C  LOOP OVER LEVELS APPLYING UNDERGROUND FILTERING AND SPECIAL RULES
    806 C  -----------------------------------------------------------------
    807 
    808       IF(NLEV.GT.0)  THEN
    809       DO L=1,NLEV
    810 
    811          POB  = OBS_8( 1,L)
    812          QOB  = OBS_8( 2,L)
    813          TOB  = OBS_8( 3,L)
    814          UOB  = OBS_8( 5,L)
    815          VOB  = OBS_8( 6,L)
    816          PWO  = OBS_8( 7,L)
    817          PW1O = OBS_8( 8,L)
    818          PW2O = OBS_8( 9,L)
    819          PW3O = OBS_8(10,L)
    820          PW4O = OBS_8(11,L)
    821          CAT  = OBS_8(12,L)
    822 
    823          DN2FAR = .FALSE.
    824          REJ = 9
    825          RCD = 9
    826 
    827 C  -------------------------------------------------------------------
    828 C  RULES FOR PRESSURE (ON ANY LEVEL) -- ALL DATA ON LEVEL REJECTED IF:
    829 C    - PRESSURE MORE THAN 100 MB BELOW MODEL (GUESS) SURFACE PRESSURE
    830 C       (AND SWITCH FCST=TRUE) -- "PREVENT" PGM REASON CODE 1
    831 C    - PRESSURE IS ZERO OR IS NEGATIVE -- "PREVENT" PGM REASON CODE 2
    832 C  REJECTION MEANS Q.M. SET TO 8
    833 C  -------------------------------------------------------------------
    834 
    835          IF(POB.LT.BMISS)  THEN
    836             IF(.NOT.FCST)  PSG01_C = POB
    837             IF(POB-PSG01_C.GE.100. .OR. POB.LE.0.) THEN
    838                IF(POB.LE.0.) THEN
    839                   IF(NI.EQ.8)  THEN
    840                      WRITE(IUNITS,302) STNID,NINT(TYP),YOB,XOB,POB
    841   302 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    842      $'E, REJECT ALL DATA ON SFC LVL - POB=',F6.1,' MB, FAILS SANITY ',
    843      $'CHECK')
    844                   ELSE

Page 19          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

    845                      WRITE(IUNITS,101) STNID,NINT(TYP),YOB,XOB,POB
    846   101 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    847      $'E, REJECT ALL DATA ON LVL - POB=',F6.1,' MB, FAILS SANITY CHECK')
    848                   ENDIF
    849                   RCD = 2
    850                ELSE
    851                   IF(NI.EQ.8)  THEN
    852                      WRITE(IUNITS,303) STNID,NINT(TYP),YOB,XOB,POB,
    853      $                PSG01_C
    854   303 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    855      $ 'E, REJECT ALL DATA ON SFC LVL - POB=',F6.1,' MB, > 100 MB ',
    856      $ 'BELOW GES PSFC(=',F6.1,'MB)')
    857                   ELSE
    858                      WRITE(IUNITS,102) STNID,NINT(TYP),YOB,XOB,POB,
    859      $                PSG01_C
    860   102 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    861      $ 'E, REJECT ALL DATA ON LVL - POB=',F6.1,' MB, > 100 MB BELOW ',
    862      $ 'GES PSFC(=',F6.1,' MB)')
    863                   ENDIF
    864                   RCD = 1
    865                END IF
    866                REJ = 8
    867                DN2FAR = .TRUE.
    868                PEV_8(1,L) = POB
    869                PEV_8(2,L) = REJ
    870                PEV_8(3,L) = PVCD
    871                PEV_8(4,L) = RCD
    872                MAXPEV = L
    873             ENDIF
    874          ENDIF
    875 
    876 C  -------------------------------------------------------------------
    877 C  RULES FOR SURFACE PRESSURE -- ALL DATA ON SURFACE LEVEL REJECTED IF:
    878 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
    879 C       "PREVENT" PGM REASON CODE 3
    880 C    - PRESSURE IS MORE THAN 100 MB ABOVE OR BELOW MODEL (GUESS)
    881 C       SURFACE PRESSURE (AND SWITCH FCST=TRUE) -- 
    882 C       "PREVENT" PGM REASON CODE 4
    883 C    - PRESSURE IS REPORTED ABOVE 450 MB OR BELOW 1100 MB -- "PREVENT"
    884 C       PGM REASON CODE 2
    885 C    - PRESSURE VIOLATES RULES FOR PRESSURE ON ANY LEVEL (SEE ABOVE)
    886 C  REJECTION FOR ALL BUT LAST RULE MEANS Q.M. SET TO 9
    887 C  REJECTION FOR LAST RULE MEANS Q.M. SET TO 8
    888 C  -------------------------------------------------------------------
    889 
    890          IF(POB.LT.BMISS .AND. CAT.EQ.0) THEN
    891             IF(.NOT.FCST)  PSG01_C = POB
    892             REJPS = OEFG01_C(POB,TYP,5).GE.BMISS          .OR.
    893      $              ABS(POB-PSG01_C).GE.100.              .OR.
    894      $              POB.LE.450.                           .OR.
    895      $              POB.GE.1100.
    896             IF(REJPS.OR.DN2FAR) THEN
    897                IF(.NOT.DN2FAR)  THEN
    898                   IF(OEFG01_C(POB,TYP,5).GE.BMISS)  THEN
    899                      IF(NFLGRT(NINT(TYP),1).EQ.0)  THEN
    900                         WRITE(IUNITS,201) NINT(TYP)
    901   201 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',

Page 20          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

    902      $ 'ALL DATA ON SURFACE LEVEL DUE TO MISSING SFC-P OBS ERROR'/)
    903                         NFLGRT(NINT(TYP),1) = 1
    904                      ENDIF
    905 CDAK CDAK CDAK CDAK  WRITE(IUNITS,103) STNID,NINT(TYP),YOB,XOB,POB
    906 CD103 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    907 CDAK $ 'E, REJECT ALL DATA ON SFC LVL - POB=',F6.1,'MB, MISSING OBS.',
    908 CDAK $ ' ERROR')
    909                      RCD = 3
    910                   ELSE  IF(ABS(POB-PSG01_C).GE.100.)  THEN
    911                      WRITE(IUNITS,104) STNID,NINT(TYP),YOB,XOB,POB,
    912      $                PSG01_C
    913   104 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    914      $ 'E, REJECT ALL DATA ON SFC LVL - POB=',F6.1,' MB, > 100 MB ',
    915      $ 'ABOVE GES PSFC(=',F6.1,'MB)')
    916                      RCD = 4
    917                   ELSE
    918                      WRITE(IUNITS,105) STNID,NINT(TYP),YOB,XOB,POB
    919   105 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    920      $ 'E, REJECT ALL DATA ON SFC LVL - POB=',F6.1,' MB, FAILS SANITY ',
    921      $ 'CHECK')
    922                      RCD = 2
    923                   ENDIF
    924                ENDIF
    925                DN2FAR = .TRUE.
    926                PEV_8(1,L) = POB
    927                PEV_8(2,L) = REJ
    928                PEV_8(3,L) = PVCD
    929                PEV_8(4,L) = RCD
    930                MAXPEV = L
    931             ENDIF
    932          ENDIF
    933 
    934 C  -------------------------------------------------------------------
    935 C  RULES FOR TEMPERATURE -- TOB AND QOB ON LEVEL REJECTED IF:
    936 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
    937 C       "PREVENT" PGM REASON CODE 3
    938 C    - REPORT IS TYPE 160-163 (LAND TOVS/RTOVS/ATOVS TEMPERATURE
    939 C       SOUNDINGS, ALL PATHS), AND IS AT OR NORTH OF 60 DEGREES SOUTH
    940 C       LATITUDE, AND PRESSURE ON LEVEL IS AT OR BELOW 100 MB (AND
    941 C       SWITCH SATMQC=TRUE)  -- "PREVENT" PGM REASON CODE 6
    942 C    - REPORT IS TYPE 160,162,163 (LAND TOVS/RTOVS/ATOVS TEMPERATURE
    943 C       SOUNDINGS, ALL PATHS BUT CLEAR), AND IS SOUTH OF 60 DEGREES
    944 C       SOUTH LATITUDE, AND PRESSURE ON LEVEL IS BELOW 100 MB (AND
    945 C       SWITCH SATMQC=TRUE) -- "PREVENT" PGM REASON CODE 6
    946 C    - THIS IS SFC LEVEL AND PRESSURE VIOLATES RULES FOR SFC PRESSURE
    947 C       (SEE ABOVE)
    948 C    - PRESSURE ON LEVEL VIOLATES RULES FOR PRESSURE (SEE ABOVE)
    949 C  REJECTION FOR ALL BUT LAST RULE MEANS Q.M. SET TO 9
    950 C  REJECTION FOR LAST RULE MEANS Q.M. SET TO 8
    951 C  -------------------------------------------------------------------
    952 
    953          IF(TOB.LT.BMISS) THEN
    954             REJT = OEFG01_C(POB,TYP,2).GE.BMISS         .OR. 
    955      $             (SOLN60.AND.NINT(POB*10.).GE.1000)   .OR.
    956      $             (SOLS60.AND.NINT(POB*10.).GT.1000)
    957             IF(REJT.OR.DN2FAR) THEN
    958                IF(.NOT.DN2FAR)  THEN

Page 21          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

    959                   IF(OEFG01_C(POB,TYP,2).GE.BMISS)  THEN
    960                      IF(NFLGRT(NINT(TYP),2).EQ.0)  THEN
    961                         IF(NI.EQ.8)  THEN
    962                            WRITE(IUNITS,304) NINT(TYP)
    963   304 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
    964      $ 'TOB/QOB ON SFC LVL DUE TO MISSING OBS ERROR'/)
    965                         ELSE
    966                            WRITE(IUNITS,202) NINT(TYP)
    967   202 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
    968      $ 'TOB/QOB ON AT LEAST ONE LVL (IF AVAILABLE ON THAT LVL) DUE TO ',
    969      $ 'MISSING OBS ERROR'/)
    970                         ENDIF
    971                         NFLGRT(NINT(TYP),2) = 1
    972 cdak cdak cdak cdak cdakWRITE(IUNITS,106) STNID,NINT(TYP),YOB,XOB,TOB
    973 cd106 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
    974 cdak $ 'E, REJECT TOB/QOB ON LVL - TOB=',F5.1,'C, MISSING OBS. ERROR')
    975                      ENDIF
    976                      RCD = 3
    977                   ELSE  IF(SOLN60.AND.NINT(POB*10.).GE.1000)  THEN
    978                      IF(NFLGRT(NINT(TYP),6).EQ.0)  THEN
    979                         WRITE(IUNITS,7304) NINT(TYP)
    980  7304 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
    981      $'TOB/QOB AT AND BELOW 100 MB IF REPORT IS NORTH OF 60S LATITUDE'/)
    982                         NFLGRT(NINT(TYP),6) = 1
    983                      ENDIF
    984                      RCD = 6
    985                   ELSE  IF(SOLS60.AND.NINT(POB*10.).GT.1000)  THEN
    986                      IF(NFLGRT(NINT(TYP),7).EQ.0)  THEN
    987                         WRITE(IUNITS,7305) NINT(TYP)
    988  7305 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
    989      $ 'TOB/QOB BELOW 100 MB IF REPORT IS SOUTH OF 60S LATITUDE'/)
    990                         NFLGRT(NINT(TYP),7) = 1
    991                      ENDIF
    992                      RCD = 6
    993                   ENDIF
    994                ENDIF
    995                TEV_8(1,L) = TOB
    996                TEV_8(2,L) = REJ
    997                TEV_8(3,L) = PVCD
    998                TEV_8(4,L) = RCD
    999                MAXTEV = L
   1000             ENDIF
   1001          ENDIF
   1002 
   1003 C  -------------------------------------------------------------------
   1004 C  RULES FOR SPECIFIC HUMIDITY -- QOB ON LEVEL REJECTED IF:
   1005 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1006 C       "PREVENT" PGM REASON CODE 3
   1007 C    - TEMPERATURE ON LEVEL IS MISSING OR IS LESS THAN -150 DEG. C --
   1008 C       "PREVENT" PGM REASON CODE 2
   1009 C    - PRESSURE ON LEVEL IS ABOVE "QTOP_REJ" MB {WHERE QTOP_REJ IS
   1010 C       READ IN FROM NAMELIST "PREVDATA" (SEE DOCBLOCK)} -- "PREVENT"
   1011 C       PGM REASON CODE 5
   1012 C    - SPECIFIC HUMIDITY IS ZERO OR IS NEGATIVE -- "PREVENT" PGM REASON
   1013 C       CODE 2
   1014 C    - REPORT IS TYPE 160-179 (SATELLITE TEMPERATURE SOUNDINGS, ALL
   1015 C       TYPES, ALL PATHS, LAND AND SEA), ALL PRESSURE LEVELS (AND

Page 22          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

   1016 C       SWITCH SATMQC=TRUE) -- "PREVENT" PGM REASON CODE 7
   1017 C    - TEMPERATURE ON LEVEL VIOLATES RULES FOR TEMPERATURE (SEE ABOVE)
   1018 C    - THIS IS SFC LEVEL AND PRESSURE VIOLATES RULES FOR SFC PRESSURE
   1019 C       (SEE ABOVE)
   1020 C    - PRESSURE ON LEVEL VIOLATES RULES FOR PRESSURE (SEE ABOVE)
   1021 C  REJECTION FOR ALL BUT LAST RULE MEANS Q.M. SET TO 9
   1022 C  REJECTION FOR LAST RULE MEANS Q.M. SET TO 8
   1023 C  -------------------------------------------------------------------
   1024 
   1025          IF(QOB.LT.BMISS) THEN
   1026             REJQ = OEFG01_C(POB,TYP,3).GE.BMISS               .OR.
   1027      $             TOB.GE.BMISS                               .OR.
   1028      $             TOB.LE.-150.                               .OR.
   1029      $             NINT(POB * 10.).LT.NINT(QTOP_REJ * 10.)    .OR.
   1030      $             QOB.LE.0.                                  .OR.
   1031      $             SATEMP                                     .OR.
   1032      $             REJT
   1033             IF(REJQ.OR.DN2FAR) THEN
   1034                IF(.NOT.DN2FAR.AND..NOT.REJT)  THEN
   1035                   IF(OEFG01_C(POB,TYP,3).GE.BMISS)  THEN
   1036                      IF(NFLGRT(NINT(TYP),3).EQ.0)  THEN
   1037                         IF(NI.EQ.8)  THEN
   1038                            WRITE(IUNITS,305) NINT(TYP)
   1039   305 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1040      $ 'QOB ON SFC LVL DUE TO MISSING OBS ERROR'/)
   1041                         ELSE
   1042                            WRITE(IUNITS,203) NINT(TYP)
   1043   203 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1044      $ 'QOB ON AT LEAST ONE LEVEL (IF AVAILABLE ON THAT LEVEL) DUE TO ',
   1045      $ 'MISSING OBS ERROR'/)
   1046                         ENDIF
   1047                         NFLGRT(NINT(TYP),3) = 1
   1048                      ENDIF
   1049 cdak cdak cdak cdak  WRITE(IUNITS,108) STNID,NINT(TYP),YOB,XOB,QOB/1000.
   1050 cd108 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1051 cdak $'E, REJECT QOB ON LVL - QOB=',F6.3,'G/KG, MISSING OBS. ERROR')
   1052                   ELSE  IF(NINT(POB*10.).LT.NINT(QTOP_REJ*10.))  THEN
   1053                      WRITE(IUNITS,109) STNID,NINT(TYP),YOB,XOB,
   1054      $                QOB/1000.,QTOP_REJ,POB
   1055   109 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1056      $ 'E, REJECT QOB ON LVL - QOB=',F6.3,' G/KG, ABOVE ',F6.1,
   1057      $ 'MB (POB=',F6.1,' MB)')
   1058                      RCD = 5
   1059                   ELSE  IF(SATEMP)  THEN
   1060                      IF(NFLGRT(NINT(TYP),8).EQ.0)  THEN
   1061                         WRITE(IUNITS,7306) NINT(TYP)
   1062  7306 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1063      $ 'QOB ON ALL LEVELS'/)
   1064                         NFLGRT(NINT(TYP),8) = 1
   1065                      ENDIF
   1066                      RCD = 7
   1067                   ELSE
   1068                      WRITE(IUNITS,111) STNID,NINT(TYP),YOB,XOB,
   1069      $                QOB/1000.,TOB
   1070   111 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1071      $ 'E, REJECT QOB ON LVL - QOB=',F6.3,' G/KG, FAILS SANITY CHECK ',
   1072      $ '(TOB=',F5.1,' C)')

Page 23          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

   1073                      RCD = 2
   1074                   ENDIF
   1075                ENDIF
   1076                QEV_8(1,L) = QOB
   1077                QEV_8(2,L) = REJ
   1078                QEV_8(3,L) = PVCD
   1079                QEV_8(4,L) = RCD
   1080                MAXQEV = L
   1081             ENDIF
   1082          ENDIF
   1083 
   1084 C  -------------------------------------------------------------------
   1085 C  RULES FOR WINDS -- UOB AND VOB ON LEVEL REJECTED IF:
   1086 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1087 C       "PREVENT" PGM REASON CODE 3
   1088 C    - THIS IS SFC LEVEL AND PRESSURE VIOLATES RULES FOR SFC PRESSURE
   1089 C       (SEE ABOVE)
   1090 C    - PRESSURE ON LEVEL VIOLATES RULES FOR PRESSURE (SEE ABOVE)
   1091 C  REJECTION FOR ALL BUT LAST RULE MEANS Q.M. SET TO 9
   1092 C  REJECTION FOR LAST RULE MEANS Q.M. SET TO 8
   1093 C  -------------------------------------------------------------------
   1094 
   1095          IF(MIN(UOB,VOB).LT.BMISS) THEN
   1096             REJW = OEFG01_C(POB,TYP,4).GE.BMISS
   1097             IF(REJW.OR.DN2FAR) THEN
   1098                IF(.NOT.DN2FAR)  THEN
   1099                   IF(NFLGRT(NINT(TYP),4).EQ.0)  THEN
   1100                      IF(NI.EQ.8)  THEN
   1101                         WRITE(IUNITS,1304) NINT(TYP)
   1102  1304 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1103      $ 'UOB/VOB ON SFC LVL DUE TO MISSING OBS ERROR'/)
   1104                      ELSE
   1105                         WRITE(IUNITS,204) NINT(TYP)
   1106   204 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1107      $ 'UOB/VOB ON AT LEAST ONE LVL (IF AVAILABLE ON THAT LVL) DUE TO ',
   1108      $ 'MISSING OBS ERROR'/)
   1109                      ENDIF
   1110                      NFLGRT(NINT(TYP),4) = 1
   1111                   ENDIF
   1112 cdak cdak cdak    WRITE(IUNITS,112) STNID,NINT(TYP),YOB,XOB
   1113 cd112 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1114 cdak $'E, REJECT UOB/VOB ON LVL - MISSING OBS. ERROR')
   1115                   RCD = 3
   1116                ENDIF
   1117                WEV_8(1,L) = UOB
   1118                WEV_8(2,L) = VOB
   1119                WEV_8(3,L) = REJ
   1120                WEV_8(4,L) = PVCD
   1121                WEV_8(5,L) = RCD
   1122                MAXWEV = L
   1123             ENDIF
   1124          ENDIF
   1125 
   1126 C  -------------------------------------------------------------------
   1127 C  RULES FOR TOTAL COLUMN PRECIPITABLE WATER -- PWO REJECTED IF:
   1128 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1129 C       "PREVENT" PGM REASON CODE 3

Page 24          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

   1130 C  REJECTION MEANS Q.M. SET TO 9
   1131 C  -------------------------------------------------------------------
   1132 
   1133          IF(PWO.LT.BMISS) THEN
   1134             REJPW = OEFG01_C(POB,TYP,6).GE.BMISS
   1135             IF(REJPW) THEN
   1136                IF(NFLGRT(NINT(TYP),5).EQ.0)  THEN
   1137                   WRITE(IUNITS,205) NINT(TYP)
   1138   205 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1139      $ 'PWO DUE TO MISSING OBS ERROR'/)
   1140                   NFLGRT(NINT(TYP),5) = 1
   1141                ENDIF
   1142 cdakcdakcdak   WRITE(IUNITS,113) STNID,NINT(TYP),YOB,XOB,PWO
   1143 cd113 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1144 cdak $'E, REJECT PWO ON LVL - PWO=',F5.1,'MM, MISSING OBS. ERROR')
   1145                PWV_8(1,L) = PWO
   1146                PWV_8(2,L) = 9
   1147                PWV_8(3,L) = PVCD
   1148                PWV_8(4,L) = 3
   1149                MAXPWV = L
   1150             ENDIF
   1151          ENDIF
   1152 
   1153 C  -------------------------------------------------------------------
   1154 C  RULES FOR LAYER 1 PRECIPITABLE WATER -- PW1O REJECTED IF:
   1155 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1156 C       "PREVENT" PGM REASON CODE 3
   1157 C  REJECTION MEANS Q.M. SET TO 9
   1158 C  -------------------------------------------------------------------
   1159 
   1160          IF(PW1O.LT.BMISS) THEN
   1161             REJPW1 = OEFG01_C(POB,TYP,6).GE.BMISS
   1162             IF(REJPW1) THEN
   1163                IF(NFLGRT(NINT(TYP),9).EQ.0)  THEN
   1164                   WRITE(IUNITS,206) NINT(TYP)
   1165   206 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1166      $ 'PW1O DUE TO MISSING OBS ERROR'/)
   1167                   NFLGRT(NINT(TYP),9) = 1
   1168                ENDIF
   1169 cdakcdakcdak   WRITE(IUNITS,114) STNID,NINT(TYP),YOB,XOB,PW1O
   1170 cd114 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1171 cdak $'E, REJECT PW1O ON LVL - PW1O=',F5.1,'MM, MISSING OBS. ERROR')
   1172                PW1V_8(1,L) = PW1O
   1173                PW1V_8(2,L) = 9
   1174                PW1V_8(3,L) = PVCD
   1175                PW1V_8(4,L) = 3
   1176                MAXPW1V = L
   1177             ENDIF
   1178          ENDIF
   1179 
   1180 C  -------------------------------------------------------------------
   1181 C  RULES FOR LAYER 2 PRECIPITABLE WATER -- PW2O REJECTED IF:
   1182 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1183 C       "PREVENT" PGM REASON CODE 3
   1184 C  REJECTION MEANS Q.M. SET TO 9
   1185 C  -------------------------------------------------------------------
   1186 

Page 25          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

   1187          IF(PW2O.LT.BMISS) THEN
   1188             REJPW2 = OEFG01_C(POB,TYP,6).GE.BMISS
   1189             IF(REJPW2) THEN
   1190                IF(NFLGRT(NINT(TYP),10).EQ.0)  THEN
   1191                   WRITE(IUNITS,207) NINT(TYP)
   1192   207 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1193      $ 'PW2O DUE TO MISSING OBS ERROR'/)
   1194                   NFLGRT(NINT(TYP),10) = 1
   1195                ENDIF
   1196 cdakcdakcdak   WRITE(IUNITS,115) STNID,NINT(TYP),YOB,XOB,PW2O
   1197 cd115 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1198 cdak $'E, REJECT PW2O ON LVL - PW2O=',F5.1,'MM, MISSING OBS. ERROR')
   1199                PW2V_8(1,L) = PW2O
   1200                PW2V_8(2,L) = 9
   1201                PW2V_8(3,L) = PVCD
   1202                PW2V_8(4,L) = 3
   1203                MAXPW2V = L
   1204             ENDIF
   1205          ENDIF
   1206 
   1207 C  -------------------------------------------------------------------
   1208 C  RULES FOR LAYER 3 PRECIPITABLE WATER -- PW3O REJECTED IF:
   1209 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1210 C       "PREVENT" PGM REASON CODE 3
   1211 C  REJECTION MEANS Q.M. SET TO 9
   1212 C  -------------------------------------------------------------------
   1213 
   1214          IF(PW3O.LT.BMISS) THEN
   1215             REJPW3 = OEFG01_C(POB,TYP,6).GE.BMISS
   1216             IF(REJPW3) THEN
   1217                IF(NFLGRT(NINT(TYP),11).EQ.0)  THEN
   1218                   WRITE(IUNITS,208) NINT(TYP)
   1219   208 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1220      $ 'PW3O DUE TO MISSING OBS ERROR'/)
   1221                   NFLGRT(NINT(TYP),11) = 1
   1222                ENDIF
   1223 cdakcdakcdak   WRITE(IUNITS,116) STNID,NINT(TYP),YOB,XOB,PW3O
   1224 cd116 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1225 cdak $'E, REJECT PW3O ON LVL - PW3O=',F5.1,'MM, MISSING OBS. ERROR')
   1226                PW3V_8(1,L) = PW3O
   1227                PW3V_8(2,L) = 9
   1228                PW3V_8(3,L) = PVCD
   1229                PW3V_8(4,L) = 3
   1230                MAXPW3V = L
   1231             ENDIF
   1232          ENDIF
   1233 
   1234 C  -------------------------------------------------------------------
   1235 C  RULES FOR LAYER 4 PRECIPITABLE WATER -- PW4O REJECTED IF:
   1236 C    - OBSERVATION ERROR IS MISSING (AND SWITCH DOBERR=TRUE) --
   1237 C       "PREVENT" PGM REASON CODE 3
   1238 C  REJECTION MEANS Q.M. SET TO 9
   1239 C  -------------------------------------------------------------------
   1240 
   1241          IF(PW4O.LT.BMISS) THEN
   1242             REJPW4 = OEFG01_C(POB,TYP,6).GE.BMISS
   1243             IF(REJPW4) THEN

Page 26          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

   1244                IF(NFLGRT(NINT(TYP),12).EQ.0)  THEN
   1245                   WRITE(IUNITS,209) NINT(TYP)
   1246   209 FORMAT(/' --> FOR ALL REPORTS WITH REPORT TYPE ',I3,', REJECT ',
   1247      $ 'PW4O DUE TO MISSING OBS ERROR'/)
   1248                   NFLGRT(NINT(TYP),12) = 1
   1249                ENDIF
   1250 cdakcdakcdak   WRITE(IUNITS,117) STNID,NINT(TYP),YOB,XOB,PW4O
   1251 cd117 FORMAT(' ~~> ID ',A8,' (RTP ',I3,'), LAT=',F6.2,'N, LON=',F6.2,
   1252 cdak $'E, REJECT PW4O ON LVL - PW4O=',F5.1,'MM, MISSING OBS. ERROR')
   1253                PW4V_8(1,L) = PW4O
   1254                PW4V_8(2,L) = 9
   1255                PW4V_8(3,L) = PVCD
   1256                PW4V_8(4,L) = 3
   1257                MAXPW4V = L
   1258             ENDIF
   1259          ENDIF
   1260 
   1261       ENDDO
   1262       ENDIF
   1263 
   1264 C  APPLY THE PROPER EVENTS
   1265 C  -----------------------
   1266 
   1267       IF(MAXPEV .GT.0) CALL UFBINT(IUNITP,PEV_8, 4,MAXPEV, IRET,PEVN)
   1268       IF(MAXQEV .GT.0) CALL UFBINT(IUNITP,QEV_8, 4,MAXQEV, IRET,QEVN)
   1269       IF(MAXTEV .GT.0) CALL UFBINT(IUNITP,TEV_8, 4,MAXTEV, IRET,TEVN)
   1270       IF(MAXWEV .GT.0) CALL UFBINT(IUNITP,WEV_8, 5,MAXWEV, IRET,WEVN)
   1271       IF(MAXPWV .GT.0) CALL UFBINT(IUNITP,PWV_8, 4,MAXPWV, IRET,PWVN)
   1272       IF(MAXPW1V.GT.0) CALL UFBINT(IUNITP,PW1V_8,4,MAXPW1V,IRET,PW1VN)
   1273       IF(MAXPW2V.GT.0) CALL UFBINT(IUNITP,PW2V_8,4,MAXPW2V,IRET,PW2VN)
   1274       IF(MAXPW3V.GT.0) CALL UFBINT(IUNITP,PW3V_8,4,MAXPW3V,IRET,PW3VN)
   1275       IF(MAXPW4V.GT.0) CALL UFBINT(IUNITP,PW4V_8,4,MAXPW4V,IRET,PW4VN)
   1276 
   1277       RETURN
   1278       END

Page 27          Source Listing                  CGBLEVN02
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                  
                        
 cgblevn02_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  846                                                            845                               
 102                        Label  860                                                            858                               
 104                        Label  913                                                            911                               
 105                        Label  919                                                            918                               
 109                        Label  1055                                                           1053                              
 111                        Label  1070                                                           1068                              
 1304                       Label  1102                                                           1101                              
 201                        Label  901                                                            900                               
 202                        Label  967                                                            966                               
 203                        Label  1043                                                           1042                              
 204                        Label  1106                                                           1105                              
 205                        Label  1138                                                           1137                              
 206                        Label  1165                                                           1164                              
 207                        Label  1192                                                           1191                              
 208                        Label  1219                                                           1218                              
 209                        Label  1246                                                           1245                              
 302                        Label  841                                                            840                               
 303                        Label  854                                                            852                               
 304                        Label  963                                                            962                               
 305                        Label  1039                                                           1038                              
 7304                       Label  980                                                            979                               
 7305                       Label  988                                                            987                               
 7306                       Label  1062                                                           1061                              
 ABS                        Func   893                                  scalar                    893,910                           
 ADPUPA_VIRT                Scalar 750      R(4)            4           scalar   COM                                                
 BAK_8                      Scalar 741      R(8)            8     2     3060     COM                                                
 BMISS                      Scalar 742      R(8)            8           scalar   COM              785,786,787,788,789,790,791,792,79
                                                                                                  3,835,890,892,898,953,954,959,1025
                                                                                                  ,1026,1027,1035,1095,1096,1133,113
                                                                                                  4,1160,1161,1187,1188,1214,1215,12
                                                                                                  41,1242                           
 CAT                        Local  821      R(4)            4           scalar                    821,890                           
 CGBEVAA                    Common 746                                  48988                                                       
 CGBEVBB                    Common 748                                  8                                                           
 CGBEVCC                    Common 749                                  36                                                          
 CGBEVEE                    Common 751                                  3608                                                        
 CGBEVGG                    Common 754                                  8                                                           
 CGBLEVN02                  Subr   733                                                                                              
 DHR                        Scalar 747      R(4)            4           scalar   COM                                                
 DN2FAR                     Local  743      L(4)            4           scalar                    823,867,896,897,925,957,958,1033,1
                                                                                                  034,1097,1098                     
 DOBERR                     Scalar 749      R(4)            4           scalar   COM                                                
 DOFCST                     Scalar 749      R(4)            4           scalar   COM                                                
 DOVTMP                     Scalar 749      R(4)            4           scalar   COM                                                

Page 28          Source Listing                  CGBLEVN02
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FCST                       Scalar 743      L(4)            4           scalar   COM              836,891                           
 IRET                       Local  1267     I(4)            4           scalar                    1267,1268,1269,1270,1271,1272,1273
                                                                                                  ,1274,1275                        
 IUNITP                     Dummy  733      I(4)            4           scalar   ARG,INOUT        1267,1268,1269,1270,1271,1272,1273
                                                                                                  ,1274,1275                        
 IUNITS                     Dummy  733      I(4)            4           scalar   ARG,INOUT        840,845,852,858,900,911,918,962,96
                                                                                                  6,979,987,1038,1042,1053,1061,1068
                                                                                                  ,1101,1105,1137,1164,1191,1218,124
                                                                                                  5                                 
 L                          Local  809      I(4)            4           scalar                    809,811,812,813,814,815,816,817,81
                                                                                                  8,819,820,821,868,869,870,871,872,
                                                                                                  926,927,928,929,930,995,996,997,99
                                                                                                  8,999,1076,1077,1078,1079,1080,111
                                                                                                  7,1118,1119,1120,1121,1122,1145,11
                                                                                                  46,1147,1148,1149,1172,1173,1174,1
                                                                                                  175,1176,1199,1200,1201,1202,1203,
                                                                                                  1226,1227,1228,1229,1230,1253,1254
                                                                                                  ,1255,1256,1257                   
 MAXPEV                     Local  795      I(4)            4           scalar                    795,872,930,1267                  
 MAXPW1V                    Local  800      I(4)            4           scalar                    800,1176,1272                     
 MAXPW2V                    Local  801      I(4)            4           scalar                    801,1203,1273                     
 MAXPW3V                    Local  802      I(4)            4           scalar                    802,1230,1274                     
 MAXPW4V                    Local  803      I(4)            4           scalar                    803,1257,1275                     
 MAXPWV                     Local  799      I(4)            4           scalar                    799,1149,1271                     
 MAXQEV                     Local  796      I(4)            4           scalar                    796,1080,1268                     
 MAXTEV                     Local  797      I(4)            4           scalar                    797,999,1269                      
 MAXWEV                     Local  798      I(4)            4           scalar                    798,1122,1270                     
 MIN                        Func   1095                                 scalar                    1095                              
 MOD                        Func   770                                  scalar                    770                               
 NEWTYP                     Dummy  733      I(4)            4           scalar   ARG,INOUT        772                               
 NFLGRT                     Local  736      I(4)            4     2     2400                      768,772,899,903,960,971,978,982,98
                                                                                                  6,990,1036,1047,1060,1064,1099,111
                                                                                                  0,1136,1140,1163,1167,1190,1194,12
                                                                                                  17,1221,1244,1248                 
 NI                         Local  770      I(4)            4           scalar                    770,839,851,961,1037,1100         
 NINT                       Func   770                                  scalar                    770,840,845,852,858,899,900,903,91
                                                                                                  1,918,955,956,960,962,966,971,977,
                                                                                                  978,979,982,985,986,987,990,1029,1
                                                                                                  036,1038,1042,1047,1052,1053,1060,
                                                                                                  1061,1064,1068,1099,1101,1105,1110
                                                                                                  ,1136,1137,1140,1163,1164,1167,119
                                                                                                  0,1191,1194,1217,1218,1221,1244,12
                                                                                                  45,1248                           
 NLEV                       Scalar 746      I(4)            4           scalar   COM              808,809                           
 OBS_8                      Scalar 741      R(8)            8     2     3060     COM              811,812,813,814,815,816,817,818,81
                                                                                                  9,820,821                         
 OEFG01_C                   Func   892      R(4)            4           scalar                    892,898,954,959,1026,1035,1096,113
                                                                                                  4,1161,1188,1215,1242             
 PEVN                       Local  738      CHAR            40          scalar                    758,1267                          
 PEV_8                      Local  739      R(8)            8     2     1020                      785,868,869,870,871,926,927,928,92
                                                                                                  9,1267                            
 PINT                       Scalar 752      R(4)            4     1     100      COM                                                
 PINTLOG                    Scalar 752      R(4)            4     1     100      COM                                                
 PLEV                       Scalar 753      R(4)            4     1     100      COM                                                
 PLEVLOG                    Scalar 753      R(4)            4     1     100      COM                                                

Page 29          Source Listing                  CGBLEVN02
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 POB                        Local  811      R(4)            4           scalar                    811,835,836,837,838,840,845,852,85
                                                                                                  8,868,890,891,892,893,894,895,898,
                                                                                                  910,911,918,926,954,955,956,959,97
                                                                                                  7,985,1026,1029,1035,1052,1054,109
                                                                                                  6,1134,1161,1188,1215,1242        
 PSG01_C                    Scalar 751      R(4)            4           scalar   COM              836,837,853,859,891,893,910,912   
 PVCD                       Scalar 748      R(4)            4           scalar   COM              870,928,997,1078,1120,1147,1174,12
                                                                                                  01,1228,1255                      
 PW1O                       Local  817      R(4)            4           scalar                    817,1160,1172                     
 PW1VN                      Local  738      CHAR            40          scalar                    763,1272                          
 PW1V_8                     Local  740      R(8)            8     2     1020                      790,1172,1173,1174,1175,1272      
 PW2O                       Local  818      R(4)            4           scalar                    818,1187,1199                     
 PW2VN                      Local  738      CHAR            40          scalar                    764,1273                          
 PW2V_8                     Local  740      R(8)            8     2     1020                      791,1199,1200,1201,1202,1273      
 PW3O                       Local  819      R(4)            4           scalar                    819,1214,1226                     
 PW3VN                      Local  738      CHAR            40          scalar                    765,1274                          
 PW3V_8                     Local  741      R(8)            8     2     1020                      792,1226,1227,1228,1229,1274      
 PW4O                       Local  820      R(4)            4           scalar                    820,1241,1253                     
 PW4VN                      Local  738      CHAR            40          scalar                    766,1275                          
 PW4V_8                     Local  741      R(8)            8     2     1020                      793,1253,1254,1255,1256,1275      
 PWO                        Local  816      R(4)            4           scalar                    816,1133,1145                     
 PWVN                       Local  738      CHAR            40          scalar                    762,1271                          
 PWV_8                      Local  740      R(8)            8     2     1020                      789,1145,1146,1147,1148,1271      
 QEVN                       Local  738      CHAR            40          scalar                    759,1268                          
 QEV_8                      Local  739      R(8)            8     2     1020                      786,1076,1077,1078,1079,1268      
 QG01_C                     Scalar 752      R(4)            4     1     100      COM                                                
 QOB                        Local  812      R(4)            4           scalar                    812,1025,1030,1054,1069,1076      
 QTOP_REJ                   Scalar 750      R(4)            4           scalar   COM              1029,1052,1054                    
 RCD                        Local  825      R(4)            4           scalar                    825,849,864,871,909,916,922,929,97
                                                                                                  6,984,992,998,1058,1066,1073,1079,
                                                                                                  1115,1121                         
 REJ                        Local  824      R(4)            4           scalar                    824,866,869,927,996,1077,1119     
 REJPS                      Local  743      L(4)            4           scalar                    892,896                           
 REJPW                      Local  743      L(4)            4           scalar                    1134,1135                         
 REJPW1                     Local  743      L(4)            4           scalar                    1161,1162                         
 REJPW2                     Local  743      L(4)            4           scalar                    1188,1189                         
 REJPW3                     Local  744      L(4)            4           scalar                    1215,1216                         
 REJPW4                     Local  744      L(4)            4           scalar                    1242,1243                         
 REJQ                       Local  743      L(4)            4           scalar                    1026,1033                         
 REJT                       Local  743      L(4)            4           scalar                    954,957,1032,1034                 
 REJW                       Local  743      L(4)            4           scalar                    1096,1097                         
 SATEMP                     Local  744      L(4)            4           scalar                    777,1031,1059                     
 SATMQC                     Scalar 744      L(4)            4           scalar   COM              777,778,780                       
 SID_8                      Scalar 741      R(8)            8           scalar   COM                                                
 SOLN60                     Local  744      L(4)            4           scalar                    778,955,977                       
 SOLS60                     Local  744      L(4)            4           scalar                    779,956,985                       
 SOME_FCST                  Scalar 749      R(4)            4           scalar   COM                                                
 STNID                      Scalar 737      CHAR            8           scalar   COM              840,845,852,858,911,918,1053,1068 
 TEVN                       Local  738      CHAR            40          scalar                    760,1269                          
 TEV_8                      Local  739      R(8)            8     2     1020                      787,995,996,997,998,1269          
 TG01_C                     Scalar 751      R(4)            4     1     100      COM                                                
 TOB                        Local  813      R(4)            4           scalar                    813,953,995,1027,1028,1069        
 TYP                        Scalar 747      R(4)            4           scalar   COM              770,777,778,779,840,845,852,858,89
                                                                                                  2,898,899,900,903,911,918,954,959,
                                                                                                  960,962,966,971,978,979,982,986,98

Page 30          Source Listing                  CGBLEVN02
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  7,990,1026,1035,1036,1038,1042,104
                                                                                                  7,1053,1060,1061,1064,1068,1096,10
                                                                                                  99,1101,1105,1110,1134,1136,1137,1
                                                                                                  140,1161,1163,1164,1167,1188,1190,
                                                                                                  1191,1194,1215,1217,1218,1221,1242
                                                                                                  ,1244,1245,1248                   
 UFBINT                     Subr   1267                                                           1267,1268,1269,1270,1271,1272,1273
                                                                                                  ,1274,1275                        
 UG01_C                     Scalar 751      R(4)            4     1     100      COM                                                
 UOB                        Local  814      R(4)            4           scalar                    814,1095,1117                     
 VG01_C                     Scalar 752      R(4)            4     1     100      COM                                                
 VIRT                       Scalar 749      R(4)            4           scalar   COM                                                
 VOB                        Local  815      R(4)            4           scalar                    815,1095,1118                     
 VTCD                       Scalar 748      R(4)            4           scalar   COM                                                
 WEVN                       Local  738      CHAR            40          scalar                    761,1270                          
 WEV_8                      Local  739      R(8)            8     2     1275                      788,1117,1118,1119,1120,1121,1270 
 XOB                        Scalar 746      R(4)            4           scalar   COM              840,845,852,858,911,918,1053,1068 
 YOB                        Scalar 746      R(4)            4           scalar   COM              778,779,840,845,852,858,911,918,10
                                                                                                  53,1068                           
 ZINT                       Scalar 752      R(4)            4     1     100      COM                                                
 ZSG01_C                    Scalar 751      R(4)            4           scalar   COM                                                

Page 31          Source Listing                  CGBLEVN02
2017-04-18 11:09                                 gblevents_cdas.f

   1279 C***********************************************************************
   1280 C***********************************************************************
   1281 C  CGBLEVN03 - INTERPOLATE MODEL DATA (FIRST GUESS OR ANALYSIS) TO OB
   1282 C              LOCATIONS
   1283 C-----------------------------------------------------------------------
   1284       SUBROUTINE CGBLEVN03(SUBSET) ! FORMERLY SUBROUTINE GETFC
   1285 
   1286       REAL(8)   OBS_8,BAK_8,SID_8
   1287       REAL(8)   BMISS
   1288       CHARACTER*8  SUBSET
   1289 
   1290       COMMON /CGBEVAA/ SID_8,OBS_8(12,255),BAK_8(12,255),NLEV,XOB,YOB,
   1291      $ DHR,TYP
   1292       COMMON /CGBEVFF/IMAX,JMAX,KMAX,kmaxs,DLAT,DLON,IDVC,SL(100),
   1293      x     SI(101)
   1294       COMMON /CGBEVEE/PSG01_C,ZSG01_C,TG01_C(100),UG01_C(100),
   1295      x     VG01_C(100),QG01_C(100),zint(100),pint(100),pintlog(100),
   1296      x     plev(100),plevlog(100)
   1297       COMMON /CGBEVGG/ BMISS
   1298 
   1299 
   1300       DATA TZERO / 273.15 /
   1301       DATA BETAP / .0552  /
   1302       DATA BETA  / .00650 /
   1303       DATA ROG   / 29.261 /
   1304 
   1305 C  CLEAR THE BACKGROUND EVENT ARRAY
   1306 C  --------------------------------
   1307 
   1308       BAK_8 = BMISS
   1309 
   1310 C  GET GUESS PROFILE AT OB LOCATION
   1311 C  --------------------------------
   1312       CALL CGBLEVN06(XOB,YOB)
   1313 
   1314       
   1315 C  INTERPOLATE GUESS PROFILES TO OB PRESSURES
   1316 C  ------------------------------------------
   1317 
   1318       IF(NLEV.GT.0)  THEN
   1319       DO 10 L=1,NLEV
   1320 
   1321          POB  = OBS_8( 1,L)
   1322          QOB  = OBS_8( 2,L)
   1323          TOB  = OBS_8( 3,L)
   1324          ZOB  = OBS_8( 4,L)
   1325          UOB  = OBS_8( 5,L)
   1326          VOB  = OBS_8( 6,L)
   1327          PWO  = OBS_8( 7,L)
   1328          PW1O = OBS_8( 8,L)
   1329          PW2O = OBS_8( 9,L)
   1330          PW3O = OBS_8(10,L)
   1331          PW4O = OBS_8(11,L)
   1332          CAT  = OBS_8(12,L)
   1333 
   1334          IF(POB.LE.0. .OR. POB.GE.BMISS) GOTO 10
   1335 

Page 32          Source Listing                  CGBLEVN03
2017-04-18 11:09                                 gblevents_cdas.f

   1336          poblog = log(pob)
   1337          
   1338          la = -999
   1339          lb = -999
   1340          do k=1,kmax-1
   1341             if (poblog<=plevlog(k) .and. poblog>plevlog(k+1)) then
   1342                la = k
   1343                lb = k+1
   1344                exit
   1345             endif
   1346          end do
   1347          if (la > 0) then
   1348             wt = (poblog-plevlog(lb)) / (plevlog(la)-plevlog(lb))
   1349          else
   1350             la = 1
   1351             lb = la+1
   1352             wt = 0.0
   1353          endif
   1354          
   1355          li=0
   1356          do k=1,kmax-1
   1357             if (poblog<=pintlog(k) .and. poblog>pintlog(k+1)) then
   1358                li = k
   1359                exit
   1360             endif
   1361          end do
   1362 
   1363 C  SURFACE PRESSURE
   1364 C  ----------------
   1365 
   1366          IF(CAT.EQ.0 .AND. ZOB.LT.BMISS) THEN
   1367             TS = TG01_C(1) + (PSG01_C-PLEV(1))*BETAP
   1368             DZ  = ZOB-ZSG01_C
   1369             TM  = TS - DZ*BETA*.5
   1370             PFC = PSG01_C*EXP(-DZ/(TM*ROG))
   1371          ELSE
   1372             PFC = BMISS
   1373          ENDIF
   1374 
   1375 C  SPECIFIC HUMIDITY
   1376 C  -----------------
   1377 
   1378          IF(QOB.LT.BMISS.OR.TOB.LT.BMISS.OR.TYP.EQ.111) THEN
   1379 
   1380 C  (QFC NEEDED BY SYNDATA PROGRAM BUT ONLY FOR REPORT TYPE 111)
   1381 
   1382             QOB = QG01_C(LB) + (QG01_C(LA)-QG01_C(LB))*WT
   1383          ENDIF
   1384 
   1385 C  TEMPERATURE
   1386 C  -----------
   1387 
   1388          IF(TOB.LT.BMISS.OR.SUBSET.EQ.'VADWND  '.OR.TYP.EQ.111) THEN
   1389 
   1390 C  (TFC NEEDED BY CQCVAD AND SYNDATA PROGRAMS, LATTER ONLY FOR REPORT
   1391 C   TYPE 111)
   1392 

Page 33          Source Listing                  CGBLEVN03
2017-04-18 11:09                                 gblevents_cdas.f

   1393             IF(POB.GT.PLEV(1)) THEN
   1394                TOB = TG01_C(1) + (POB-PLEV(1))*BETAP
   1395             ELSE
   1396                TOB = TG01_C(LB) + (TG01_C(LA)-TG01_C(LB))*WT
   1397             ENDIF
   1398             TOB = TOB - TZERO
   1399          ENDIF
   1400 
   1401 C  HEIGHT
   1402 C  ------
   1403 
   1404          IF(ZOB.LT.BMISS) THEN
   1405             IF(POB.GT.PLEV(1)) THEN
   1406                TM = TG01_C(1) + (.5*(PINT(1)+POB)-PLEV(1))*BETAP
   1407                ZOB = ZINT(1) - ROG*TM*LOG(POB/PINT(1))
   1408             ELSE if(li.gt.0) then
   1409 ! DAK: 2/14/13: added test for LI = 0 as this can happen and cause
   1410 !               zint array to go out of bounds when WCOSS debugging
   1411 !               turned on - now if LI = 0, zob-gess is stored as
   1412 !               missing rather than as -infinity
   1413                TM = TG01_C(LB) + (TG01_C(LA)-TG01_C(LB))*WT
   1414                ZOB = ZINT(LI) - ROG*TM*LOG(POB/PINT(LI))
   1415             else
   1416                zob = bmiss
   1417             ENDIF
   1418          ENDIF
   1419 
   1420 C  U AND V COMPONENTS
   1421 C  ------------------
   1422 
   1423          IF(UOB.LT.BMISS .OR. VOB.LT.BMISS) THEN
   1424             UOB = UG01_C(LB) + (UG01_C(LA)-UG01_C(LB))*WT
   1425             VOB = VG01_C(LB) + (VG01_C(LA)-VG01_C(LB))*WT
   1426          ENDIF
   1427 
   1428 
   1429 C  PRECIPITABLE WATER
   1430 C  ------------------
   1431 
   1432          PWO  = BMISS
   1433          PW1O = BMISS
   1434          PW2O = BMISS
   1435          PW3O = BMISS
   1436          PW4O = BMISS
   1437 
   1438 C  RELATIVE HUMIDITY
   1439 C  -----------------
   1440 
   1441          RHO = BMISS
   1442 
   1443 C  SCATTER THE PROPER FIRST GUESS/ANALYSIS VALUES
   1444 C  ----------------------------------------------
   1445 
   1446          BAK_8(1,L)  = PFC
   1447          BAK_8(2,L)  = QOB
   1448          BAK_8(3,L)  = TOB
   1449          BAK_8(4,L)  = ZOB

Page 34          Source Listing                  CGBLEVN03
2017-04-18 11:09                                 gblevents_cdas.f

   1450          BAK_8(5,L)  = UOB
   1451          BAK_8(6,L)  = VOB
   1452          BAK_8(7,L)  = PWO
   1453          BAK_8(8,L)  = PW1O
   1454          BAK_8(9,L)  = PW2O
   1455          BAK_8(10,L) = PW3O
   1456          BAK_8(11,L) = PW4O
   1457          BAK_8(12,L) = RHO
   1458 
   1459    10 ENDDO
   1460       ENDIF
   1461 
   1462       RETURN
   1463       END


ENTRY POINTS

  Name                  
                        
 cgblevn03_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1459                                                           1319,1334                         
 BAK_8                      Scalar 1286     R(8)            8     2     3060     COM              1308,1446,1447,1448,1449,1450,1451
                                                                                                  ,1452,1453,1454,1455,1456,1457    
 BETA                       Local  1302     R(4)            4           scalar                    1302,1369                         
 BETAP                      Local  1301     R(4)            4           scalar                    1301,1367,1394,1406               
 BMISS                      Scalar 1287     R(8)            8           scalar   COM              1308,1334,1366,1372,1378,1388,1404
                                                                                                  ,1416,1423,1432,1433,1434,1435,143
                                                                                                  6,1441                            
 CAT                        Local  1332     R(4)            4           scalar                    1332,1366                         
 CGBEVAA                    Common 1290                                 48988                                                       
 CGBEVEE                    Common 1294                                 3608                                                        
 CGBEVFF                    Common 1292                                 832                                                         
 CGBEVGG                    Common 1297                                 8                                                           
 CGBLEVN03                  Subr   1284                                                                                             
 CGBLEVN06                  Subr   1312                                                           1312                              
 DHR                        Scalar 1291     R(4)            4           scalar   COM                                                
 DLAT                       Scalar 1292     R(4)            4           scalar   COM                                                
 DLON                       Scalar 1292     R(4)            4           scalar   COM                                                
 DZ                         Local  1368     R(4)            4           scalar                    1368,1369,1370                    
 EXP                        Func   1370                                 scalar                    1370                              
 IDVC                       Scalar 1292     I(4)            4           scalar   COM                                                
 IMAX                       Scalar 1292     I(4)            4           scalar   COM                                                
 JMAX                       Scalar 1292     I(4)            4           scalar   COM                                                
 K                          Local  1340     I(4)            4           scalar                    1340,1341,1342,1343,1356,1357,1358
 KMAX                       Scalar 1292     I(4)            4           scalar   COM              1340,1356                         
 KMAXS                      Scalar 1292     I(4)            4           scalar   COM                                                
 L                          Local  1319     I(4)            4           scalar                    1319,1321,1322,1323,1324,1325,1326
                                                                                                  ,1327,1328,1329,1330,1331,1332,144
                                                                                                  6,1447,1448,1449,1450,1451,1452,14
                                                                                                  53,1454,1455,1456,1457            

Page 35          Source Listing                  CGBLEVN03
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LA                         Local  1338     I(4)            4           scalar                    1338,1342,1347,1348,1350,1351,1382
                                                                                                  ,1396,1413,1424,1425              
 LB                         Local  1339     I(4)            4           scalar                    1339,1343,1348,1351,1382,1396,1413
                                                                                                  ,1424,1425                        
 LI                         Local  1355     I(4)            4           scalar                    1355,1358,1408,1414               
 LOG                        Func   1336                                 scalar                    1336,1407,1414                    
 NLEV                       Scalar 1290     I(4)            4           scalar   COM              1318,1319                         
 OBS_8                      Scalar 1286     R(8)            8     2     3060     COM              1321,1322,1323,1324,1325,1326,1327
                                                                                                  ,1328,1329,1330,1331,1332         
 PFC                        Local  1370     R(4)            4           scalar                    1370,1372,1446                    
 PINT                       Scalar 1295     R(4)            4     1     100      COM              1406,1407,1414                    
 PINTLOG                    Scalar 1295     R(4)            4     1     100      COM              1357                              
 PLEV                       Scalar 1296     R(4)            4     1     100      COM              1367,1393,1394,1405,1406          
 PLEVLOG                    Scalar 1296     R(4)            4     1     100      COM              1341,1348                         
 POB                        Local  1321     R(4)            4           scalar                    1321,1334,1336,1393,1394,1405,1406
                                                                                                  ,1407,1414                        
 POBLOG                     Local  1336     R(4)            4           scalar                    1336,1341,1348,1357               
 PSG01_C                    Scalar 1294     R(4)            4           scalar   COM              1367,1370                         
 PW1O                       Local  1328     R(4)            4           scalar                    1328,1433,1453                    
 PW2O                       Local  1329     R(4)            4           scalar                    1329,1434,1454                    
 PW3O                       Local  1330     R(4)            4           scalar                    1330,1435,1455                    
 PW4O                       Local  1331     R(4)            4           scalar                    1331,1436,1456                    
 PWO                        Local  1327     R(4)            4           scalar                    1327,1432,1452                    
 QG01_C                     Scalar 1295     R(4)            4     1     100      COM              1382                              
 QOB                        Local  1322     R(4)            4           scalar                    1322,1378,1382,1447               
 RHO                        Local  1441     R(4)            4           scalar                    1441,1457                         
 ROG                        Local  1303     R(4)            4           scalar                    1303,1370,1407,1414               
 SI                         Scalar 1293     R(4)            4     1     101      COM                                                
 SID_8                      Scalar 1286     R(8)            8           scalar   COM                                                
 SL                         Scalar 1292     R(4)            4     1     100      COM                                                
 SUBSET                     Dummy  1284     CHAR            8           scalar   ARG,INOUT        1388                              
 TG01_C                     Scalar 1294     R(4)            4     1     100      COM              1367,1394,1396,1406,1413          
 TM                         Local  1369     R(4)            4           scalar                    1369,1370,1406,1407,1413,1414     
 TOB                        Local  1323     R(4)            4           scalar                    1323,1378,1388,1394,1396,1398,1448
 TS                         Local  1367     R(4)            4           scalar                    1367,1369                         
 TYP                        Scalar 1291     R(4)            4           scalar   COM              1378,1388                         
 TZERO                      Local  1300     R(4)            4           scalar                    1300,1398                         
 UG01_C                     Scalar 1294     R(4)            4     1     100      COM              1424                              
 UOB                        Local  1325     R(4)            4           scalar                    1325,1423,1424,1450               
 VG01_C                     Scalar 1295     R(4)            4     1     100      COM              1425                              
 VOB                        Local  1326     R(4)            4           scalar                    1326,1423,1425,1451               
 WT                         Local  1348     R(4)            4           scalar                    1348,1352,1382,1396,1413,1424,1425
 XOB                        Scalar 1290     R(4)            4           scalar   COM              1312                              
 YOB                        Scalar 1290     R(4)            4           scalar   COM              1312                              
 ZINT                       Scalar 1295     R(4)            4     1     100      COM              1407,1414                         
 ZOB                        Local  1324     R(4)            4           scalar                    1324,1366,1368,1404,1407,1414,1416
                                                                                                  ,1449                             
 ZSG01_C                    Scalar 1294     R(4)            4           scalar   COM              1368                              

Page 36          Source Listing                  CGBLEVN03
2017-04-18 11:09                                 gblevents_cdas.f

   1464 C***********************************************************************
   1465 C***********************************************************************
   1466       SUBROUTINE CGBLEVN04 ! FORMERLY SUBROUTINE GETOE
   1467 
   1468       REAL(8)   OBS_8,BAK_8,SID_8
   1469       REAL(8)   BMISS
   1470 
   1471       COMMON /CGBEVAA/ SID_8,OBS_8(12,255),BAK_8(12,255),NLEV,XOB,YOB,
   1472      $ DHR,TYP
   1473       COMMON /CGBEVGG/ BMISS
   1474 
   1475 C  CLEAR THE EVENT ARRAY
   1476 C  ---------------------
   1477 
   1478       BAK_8 = BMISS
   1479 
   1480 C  LOOP OVER LEVELS LOOKING UP THE OBSERVATION ERROR
   1481 C  -------------------------------------------------
   1482 
   1483       IF(NLEV.GT.0)  THEN
   1484       DO L=1,NLEV
   1485 
   1486          POB  = OBS_8( 1,L)
   1487          QOB  = OBS_8( 2,L)
   1488          TOB  = OBS_8( 3,L)
   1489          WOB  = MAX(OBS_8(5,L),OBS_8(6,L))
   1490          PWO  = OBS_8( 7,L)
   1491          PW1O = OBS_8( 8,L)
   1492          PW2O = OBS_8( 9,L)
   1493          PW3O = OBS_8(10,L)
   1494          PW4O = OBS_8(11,L)
   1495          CAT  = OBS_8(12,L)
   1496 
   1497          IF(CAT .EQ.0    ) BAK_8( 1,L) = OEFG01_C(POB,TYP,5)
   1498          IF(QOB .LT.BMISS) BAK_8( 2,L) = OEFG01_C(POB,TYP,3)
   1499          IF(TOB .LT.BMISS) BAK_8( 3,L) = OEFG01_C(POB,TYP,2)
   1500          IF(WOB .LT.BMISS) BAK_8( 5,L) = OEFG01_C(POB,TYP,4)
   1501          IF(PWO .LT.BMISS) BAK_8( 6,L) = OEFG01_C(POB,TYP,6)
   1502          IF(PW1O.LT.BMISS) BAK_8( 7,L) = OEFG01_C(POB,TYP,6)
   1503          IF(PW2O.LT.BMISS) BAK_8( 8,L) = OEFG01_C(POB,TYP,6)
   1504          IF(PW3O.LT.BMISS) BAK_8( 9,L) = OEFG01_C(POB,TYP,6)
   1505          IF(PW4O.LT.BMISS) BAK_8(10,L) = OEFG01_C(POB,TYP,6)
   1506 
   1507       ENDDO
   1508       ENDIF
   1509 
   1510       RETURN
   1511       END

Page 37          Source Listing                  CGBLEVN04
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                  
                        
 cgblevn04_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BAK_8                      Scalar 1468     R(8)            8     2     3060     COM              1478,1497,1498,1499,1500,1501,1502
                                                                                                  ,1503,1504,1505                   
 BMISS                      Scalar 1469     R(8)            8           scalar   COM              1478,1498,1499,1500,1501,1502,1503
                                                                                                  ,1504,1505                        
 CAT                        Local  1495     R(4)            4           scalar                    1495,1497                         
 CGBEVAA                    Common 1471                                 48988                                                       
 CGBEVGG                    Common 1473                                 8                                                           
 CGBLEVN04                  Subr   1466                                                                                             
 DHR                        Scalar 1472     R(4)            4           scalar   COM                                                
 L                          Local  1484     I(4)            4           scalar                    1484,1486,1487,1488,1489,1490,1491
                                                                                                  ,1492,1493,1494,1495,1497,1498,149
                                                                                                  9,1500,1501,1502,1503,1504,1505   
 MAX                        Func   1489                                 scalar                    1489                              
 NLEV                       Scalar 1471     I(4)            4           scalar   COM              1483,1484                         
 OBS_8                      Scalar 1468     R(8)            8     2     3060     COM              1486,1487,1488,1489,1490,1491,1492
                                                                                                  ,1493,1494,1495                   
 OEFG01_C                   Func   1497     R(4)            4           scalar                    1497,1498,1499,1500,1501,1502,1503
                                                                                                  ,1504,1505                        
 POB                        Local  1486     R(4)            4           scalar                    1486,1497,1498,1499,1500,1501,1502
                                                                                                  ,1503,1504,1505                   
 PW1O                       Local  1491     R(4)            4           scalar                    1491,1502                         
 PW2O                       Local  1492     R(4)            4           scalar                    1492,1503                         
 PW3O                       Local  1493     R(4)            4           scalar                    1493,1504                         
 PW4O                       Local  1494     R(4)            4           scalar                    1494,1505                         
 PWO                        Local  1490     R(4)            4           scalar                    1490,1501                         
 QOB                        Local  1487     R(4)            4           scalar                    1487,1498                         
 SID_8                      Scalar 1468     R(8)            8           scalar   COM                                                
 TOB                        Local  1488     R(4)            4           scalar                    1488,1499                         
 TYP                        Scalar 1472     R(4)            4           scalar   COM              1497,1498,1499,1500,1501,1502,1503
                                                                                                  ,1504,1505                        
 WOB                        Local  1489     R(4)            4           scalar                    1489,1500                         
 XOB                        Scalar 1471     R(4)            4           scalar   COM                                                
 YOB                        Scalar 1471     R(4)            4           scalar   COM                                                

Page 38          Source Listing                  CGBLEVN04
2017-04-18 11:09                                 gblevents_cdas.f

   1512 C***********************************************************************
   1513 C***********************************************************************
   1514 C  SUBROUTINE CGBLEVN05 - GUSER (CGBLEVN10) USER INTERFACE FOR
   1515 C                         PREPFIT (PSG01_C,ZSG01_C,TG01_C,UG01_C,VG01_C)
   1516 C-----------------------------------------------------------------------
   1517       SUBROUTINE CGBLEVN05(GRD,IQ,LEV) ! FORMERLY SUBROUTINE GUSER
   1518 
   1519       COMMON /CGBEVFF/IMAX,JMAX,KMAX,kmaxs,DLAT,DLON,IDVC,SL(100),
   1520      x     SI(101)
   1521 
   1522       DIMENSION   GRD(IMAX,JMAX,2)
   1523 
   1524 C  PACK 2D FIRST GUESS/ANALYSIS FIELD INTO BIT PACKED ARRAYS
   1525 C  ---------------------------------------------------------
   1526 
   1527       IF(IQ.EQ.1) THEN
   1528          DO J=1,JMAX
   1529             DO I=1,IMAX
   1530                CALL CGBLEVN12(I,J,GRD(I,J,1))
   1531             ENDDO
   1532          ENDDO
   1533       ELSEIF(IQ.EQ.2) THEN
   1534          DO J=1,JMAX
   1535             DO I=1,IMAX
   1536                CALL CGBLEVN13(I,J,GRD(I,J,1))
   1537             ENDDO
   1538          ENDDO
   1539       ELSEIF(IQ.EQ.3) THEN
   1540          DO J=1,JMAX
   1541             DO I=1,IMAX
   1542                CALL CGBLEVN14(I,J,LEV,GRD(I,J,1))
   1543             ENDDO
   1544          ENDDO
   1545       ELSEIF(IQ.EQ.4) THEN
   1546          DO J=1,JMAX
   1547             DO I=1,IMAX
   1548                CALL CGBLEVN15(I,J,LEV,GRD(I,J,1))
   1549                CALL CGBLEVN16(I,J,LEV,GRD(I,J,2))
   1550             ENDDO
   1551          ENDDO
   1552       ELSEIF(IQ.EQ.5) THEN
   1553          DO J=1,JMAX
   1554             DO I=1,IMAX
   1555                CALL CGBLEVN17(I,J,LEV,MAX(0.,GRD(I,J,1))*1E6)
   1556             ENDDO
   1557          ENDDO
   1558       ENDIF
   1559 
   1560       RETURN
   1561       END

Page 39          Source Listing                  CGBLEVN05
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                  
                        
 cgblevn05_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVFF                    Common 1519                                 832                                                         
 CGBLEVN05                  Subr   1517                                                                                             
 CGBLEVN12                  Subr   1530                                                           1530                              
 CGBLEVN13                  Subr   1536                                                           1536                              
 CGBLEVN14                  Subr   1542                                                           1542                              
 CGBLEVN15                  Subr   1548                                                           1548                              
 CGBLEVN16                  Subr   1549                                                           1549                              
 CGBLEVN17                  Subr   1555                                                           1555                              
 DLAT                       Scalar 1519     R(4)            4           scalar   COM                                                
 DLON                       Scalar 1519     R(4)            4           scalar   COM                                                
 GRD                        Dummy  1517     R(4)            4     3     0        ARG,INOUT        1530,1536,1542,1548,1549,1555     
 I                          Local  1529     I(4)            4           scalar                    1529,1530,1535,1536,1541,1542,1547
                                                                                                  ,1548,1549,1554,1555              
 IDVC                       Scalar 1519     I(4)            4           scalar   COM                                                
 IMAX                       Scalar 1519     I(4)            4           scalar   COM              1522,1529,1535,1541,1547,1554     
 IQ                         Dummy  1517     I(4)            4           scalar   ARG,INOUT        1527,1533,1539,1545,1552          
 J                          Local  1528     I(4)            4           scalar                    1528,1530,1534,1536,1540,1542,1546
                                                                                                  ,1548,1549,1553,1555              
 JMAX                       Scalar 1519     I(4)            4           scalar   COM              1522,1528,1534,1540,1546,1553     
 KMAX                       Scalar 1519     I(4)            4           scalar   COM                                                
 KMAXS                      Scalar 1519     I(4)            4           scalar   COM                                                
 LEV                        Dummy  1517     I(4)            4           scalar   ARG,INOUT        1542,1548,1549,1555               
 MAX                        Func   1555                                 scalar                    1555                              
 SI                         Scalar 1520     R(4)            4     1     101      COM                                                
 SL                         Scalar 1519     R(4)            4     1     100      COM                                                

Page 40          Source Listing                  CGBLEVN05
2017-04-18 11:09                                 gblevents_cdas.f

   1562 C***********************************************************************
   1563 C***********************************************************************
   1564 C  SUBROUTINE CGBLEVN06 - 2D LINEAR HORIZONTAL INTERPOLATION
   1565 C-----------------------------------------------------------------------
   1566       SUBROUTINE CGBLEVN06(XOB,YOB) ! FORMERLY SUBROUTINE HTERP
   1567       REAL KAP1,KAPR
   1568 
   1569 
   1570       COMMON /CGBEVFF/IMAX,JMAX,KMAX,kmaxs,DLAT,DLON,IDVC,SL(100),
   1571      x     SI(101)
   1572       COMMON /CGBEVEE/ PSI,ZSI,TI(100),UI(100),VI(100),QI(100),
   1573      x     zint(100),pint(100),pintlog(100),plev(100),plevlog(100)
   1574 
   1575       DATA ROG   / 29.261 /
   1576       DATA KAP1 / 1.2857 /, KAPR / 3.4997 /
   1577 
   1578 
   1579 C  CALCULATE HORIZONTAL WEIGHTS AND INTERPOLATE
   1580 C  --------------------------------------------
   1581 
   1582       WX = XOB/DLON + 1.0
   1583       I0 = WX
   1584       I1 = MOD(I0,IMAX) + 1
   1585       WX = WX-I0
   1586 
   1587       WY = (YOB+90.)/DLAT + 1.0
   1588       J0 = WY
   1589       J1 = MIN(J0+1,JMAX)
   1590       WY = WY-J0
   1591 
   1592 C  HTERP FOR SURFACE HEIGHT
   1593 C  ------------------------
   1594 
   1595       P1  = ZSG01_C(I0,J0)
   1596       P2  = ZSG01_C(I0,J1)
   1597       P3  = ZSG01_C(I1,J0)
   1598       P4  = ZSG01_C(I1,J1)
   1599       P5  = P1+(P2-P1)*WY
   1600       P6  = P3+(P4-P3)*WY
   1601       ZSI = P5+(P6-P5)*WX
   1602 
   1603 C  HTERP FOR SURFACE PRESSURE
   1604 C  --------------------------
   1605 
   1606       P1  = PSG01_C(I0,J0)
   1607       P2  = PSG01_C(I0,J1)
   1608       P3  = PSG01_C(I1,J0)
   1609       P4  = PSG01_C(I1,J1)
   1610       P5  = P1+(P2-P1)*WY
   1611       P6  = P3+(P4-P3)*WY
   1612       PSI = P5+(P6-P5)*WX
   1613 
   1614 C  HTERP FOR UPA T,U,V,Q
   1615 C  ---------------------
   1616 
   1617       DO K=1,KMAX
   1618 

Page 41          Source Listing                  CGBLEVN06
2017-04-18 11:09                                 gblevents_cdas.f

   1619          P1 = TG01_C(I0,J0,K)
   1620          P2 = TG01_C(I0,J1,K)
   1621          P3 = TG01_C(I1,J0,K)
   1622          P4 = TG01_C(I1,J1,K)
   1623          P5 = P1+(P2-P1)*WY
   1624          P6 = P3+(P4-P3)*WY
   1625          TI(K) = P5+(P6-P5)*WX
   1626 
   1627          P1 = UG01_C(I0,J0,K)
   1628          P2 = UG01_C(I0,J1,K)
   1629          P3 = UG01_C(I1,J0,K)
   1630          P4 = UG01_C(I1,J1,K)
   1631          P5 = P1+(P2-P1)*WY
   1632          P6 = P3+(P4-P3)*WY
   1633          UI(K) = P5+(P6-P5)*WX
   1634 
   1635          P1 = VG01_C(I0,J0,K)
   1636          P2 = VG01_C(I0,J1,K)
   1637          P3 = VG01_C(I1,J0,K)
   1638          P4 = VG01_C(I1,J1,K)
   1639          P5 = P1+(P2-P1)*WY
   1640          P6 = P3+(P4-P3)*WY
   1641          VI(K) = P5+(P6-P5)*WX
   1642 
   1643          P1 = QG01_C(I0,J0,K)
   1644          P2 = QG01_C(I0,J1,K)
   1645          P3 = QG01_C(I1,J0,K)
   1646          P4 = QG01_C(I1,J1,K)
   1647          P5 = P1+(P2-P1)*WY
   1648          P6 = P3+(P4-P3)*WY
   1649          QI(K) = P5+(P6-P5)*WX
   1650 
   1651       ENDDO
   1652 
   1653 c     Compute interface pressures and heights
   1654       zint(1) = zsi
   1655       pint(1) = psi
   1656       pintlog(1) = log(pint(1))
   1657       do k=2,kmax
   1658         k0 = k-1
   1659          if(idvc.eq.1) then
   1660             pint(k) = psi*si(k)
   1661          else if(idvc.eq.2) then
   1662             pint(k)=si(k)+sl(k)*psi
   1663          end if
   1664          zint(k) = zint(k0) - rog*ti(k0)*log(pint(k)/pint(k0))
   1665          pintlog(k) = log(pint(k))
   1666       enddo
   1667       pint(kmax+1) = 0.0
   1668 
   1669 C     Compute pressure at layer midpoints
   1670       do k=1,kmax
   1671          if (idvc.eq.1) then
   1672             plev(k) = psi*sl(k)
   1673          else if (idvc.eq.2) then
   1674             plev(k) = ((PINT(k)**KAP1-PINT(k+1)**KAP1)/
   1675      $           (KAP1*(PINT(k)-PINT(k+1))))**KAPR

Page 42          Source Listing                  CGBLEVN06
2017-04-18 11:09                                 gblevents_cdas.f

   1676          endif
   1677          plevlog(k) = log(plev(k))
   1678       end do
   1679 
   1680 
   1681       RETURN
   1682       END


ENTRY POINTS

  Name                  
                        
 cgblevn06_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVEE                    Common 1572                                 3608                                                        
 CGBEVFF                    Common 1570                                 832                                                         
 CGBLEVN06                  Subr   1566                                                                                             
 DLAT                       Scalar 1570     R(4)            4           scalar   COM              1587                              
 DLON                       Scalar 1570     R(4)            4           scalar   COM              1582                              
 I0                         Local  1583     I(4)            4           scalar                    1583,1584,1585,1595,1596,1606,1607
                                                                                                  ,1619,1620,1627,1628,1635,1636,164
                                                                                                  3,1644                            
 I1                         Local  1584     I(4)            4           scalar                    1584,1597,1598,1608,1609,1621,1622
                                                                                                  ,1629,1630,1637,1638,1645,1646    
 IDVC                       Scalar 1570     I(4)            4           scalar   COM              1659,1661,1671,1673               
 IMAX                       Scalar 1570     I(4)            4           scalar   COM              1584                              
 J0                         Local  1588     I(4)            4           scalar                    1588,1589,1590,1595,1597,1606,1608
                                                                                                  ,1619,1621,1627,1629,1635,1637,164
                                                                                                  3,1645                            
 J1                         Local  1589     I(4)            4           scalar                    1589,1596,1598,1607,1609,1620,1622
                                                                                                  ,1628,1630,1636,1638,1644,1646    
 JMAX                       Scalar 1570     I(4)            4           scalar   COM              1589                              
 K                          Local  1617     I(4)            4           scalar                    1617,1619,1620,1621,1622,1625,1627
                                                                                                  ,1628,1629,1630,1633,1635,1636,163
                                                                                                  7,1638,1641,1643,1644,1645,1646,16
                                                                                                  49,1657,1658,1660,1662,1664,1665,1
                                                                                                  670,1672,1674,1675,1677           
 K0                         Local  1658     I(4)            4           scalar                    1658,1664                         
 KAP1                       Local  1567     R(4)            4           scalar                    1576,1674,1675                    
 KAPR                       Local  1567     R(4)            4           scalar                    1576,1675                         
 KMAX                       Scalar 1570     I(4)            4           scalar   COM              1617,1657,1667,1670               
 KMAXS                      Scalar 1570     I(4)            4           scalar   COM                                                
 LOG                        Func   1656                                 scalar                    1656,1664,1665,1677               
 MIN                        Func   1589                                 scalar                    1589                              
 MOD                        Func   1584                                 scalar                    1584                              
 P1                         Local  1595     R(4)            4           scalar                    1595,1599,1606,1610,1619,1623,1627
                                                                                                  ,1631,1635,1639,1643,1647         
 P2                         Local  1596     R(4)            4           scalar                    1596,1599,1607,1610,1620,1623,1628
                                                                                                  ,1631,1636,1639,1644,1647         
 P3                         Local  1597     R(4)            4           scalar                    1597,1600,1608,1611,1621,1624,1629
                                                                                                  ,1632,1637,1640,1645,1648         

Page 43          Source Listing                  CGBLEVN06
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 P4                         Local  1598     R(4)            4           scalar                    1598,1600,1609,1611,1622,1624,1630
                                                                                                  ,1632,1638,1640,1646,1648         
 P5                         Local  1599     R(4)            4           scalar                    1599,1601,1610,1612,1623,1625,1631
                                                                                                  ,1633,1639,1641,1647,1649         
 P6                         Local  1600     R(4)            4           scalar                    1600,1601,1611,1612,1624,1625,1632
                                                                                                  ,1633,1640,1641,1648,1649         
 PINT                       Scalar 1573     R(4)            4     1     100      COM              1655,1656,1660,1662,1664,1665,1667
                                                                                                  ,1674,1675                        
 PINTLOG                    Scalar 1573     R(4)            4     1     100      COM              1656,1665                         
 PLEV                       Scalar 1573     R(4)            4     1     100      COM              1672,1674,1677                    
 PLEVLOG                    Scalar 1573     R(4)            4     1     100      COM              1677                              
 PSG01_C                    Func   1606     R(4)            4           scalar                    1606,1607,1608,1609               
 PSI                        Scalar 1572     R(4)            4           scalar   COM              1612,1655,1660,1662,1672          
 QG01_C                     Func   1643     R(4)            4           scalar                    1643,1644,1645,1646               
 QI                         Scalar 1572     R(4)            4     1     100      COM              1649                              
 ROG                        Local  1575     R(4)            4           scalar                    1575,1664                         
 SI                         Scalar 1571     R(4)            4     1     101      COM              1660,1662                         
 SL                         Scalar 1570     R(4)            4     1     100      COM              1662,1672                         
 TG01_C                     Func   1619     R(4)            4           scalar                    1619,1620,1621,1622               
 TI                         Scalar 1572     R(4)            4     1     100      COM              1625,1664                         
 UG01_C                     Func   1627     R(4)            4           scalar                    1627,1628,1629,1630               
 UI                         Scalar 1572     R(4)            4     1     100      COM              1633                              
 VG01_C                     Func   1635     R(4)            4           scalar                    1635,1636,1637,1638               
 VI                         Scalar 1572     R(4)            4     1     100      COM              1641                              
 WX                         Local  1582     R(4)            4           scalar                    1582,1583,1585,1601,1612,1625,1633
                                                                                                  ,1641,1649                        
 WY                         Local  1587     R(4)            4           scalar                    1587,1588,1590,1599,1600,1610,1611
                                                                                                  ,1623,1624,1631,1632,1639,1640,164
                                                                                                  7,1648                            
 XOB                        Dummy  1566     R(4)            4           scalar   ARG,INOUT        1582                              
 YOB                        Dummy  1566     R(4)            4           scalar   ARG,INOUT        1587                              
 ZINT                       Scalar 1573     R(4)            4     1     100      COM              1654,1664                         
 ZSG01_C                    Func   1595     R(4)            4           scalar                    1595,1596,1597,1598               
 ZSI                        Scalar 1572     R(4)            4           scalar   COM              1601,1654                         

Page 44          Source Listing                  CGBLEVN06
2017-04-18 11:09                                 gblevents_cdas.f

   1683 C***********************************************************************
   1684 C***********************************************************************
   1685       FUNCTION OEFG01_C(P,TYP,IE) ! FORMERLY FUNCTION OEF
   1686 
   1687       REAL(8) BMISS
   1688 
   1689       COMMON /CGBEVDD/ERRS(300,33,6)
   1690       COMMON /CGBEVGG/ BMISS
   1691 
   1692       OEFG01_C = BMISS
   1693       KX  = TYP
   1694 
   1695 C  LOOK UP ERRORS FOR PARTICULAR OB TYPES
   1696 C  --------------------------------------
   1697 
   1698       IF(IE.GE.2 .AND. IE.LE.4) THEN
   1699          DO LA=1,33
   1700             IF(P.GE.ERRS(KX,LA,1)) GOTO 10
   1701          ENDDO
   1702    10    CONTINUE
   1703          LB = LA-1
   1704          IF(LB.EQ.33) LA = 6
   1705          IF(LB.EQ.33) LB = 5
   1706          IF(LB.EQ. 0) THEN
   1707             OEFG01_C = ERRS(KX,1,IE)
   1708          ELSE
   1709             DEL = (P-ERRS(KX,LB,1))/(ERRS(KX,LA,1)-ERRS(KX,LB,1))
   1710             OEFG01_C = (1.-DEL)*ERRS(KX,LB,IE) + DEL*ERRS(KX,LA,IE)
   1711          ENDIF
   1712       ELSEIF(IE.EQ.5) THEN
   1713          OEFG01_C = ERRS(KX,1,5)
   1714       ELSEIF(IE.EQ.6) THEN
   1715          OEFG01_C = ERRS(KX,1,6)
   1716       ENDIF
   1717 
   1718 C  SET MISSING ERROR VALUE TO "BMISS"
   1719 C  ----------------------------------
   1720 
   1721       IF(OEFG01_C.GE.5E5) OEFG01_C = BMISS
   1722 
   1723       RETURN
   1724       END

Page 45          Source Listing                  OEFG01_C
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                 
                       
 oefg01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1702                                                           1700                              
 BMISS                      Scalar 1687     R(8)            8           scalar   COM              1692,1721                         
 CGBEVDD                    Common 1689                                 237600                                                      
 CGBEVGG                    Common 1690                                 8                                                           
 DEL                        Local  1709     R(4)            4           scalar                    1709,1710                         
 ERRS                       Scalar 1689     R(4)            4     3     59400    COM              1700,1707,1709,1710,1713,1715     
 IE                         Dummy  1685     I(4)            4           scalar   ARG,INOUT        1698,1707,1710,1712,1714          
 KX                         Local  1693     I(4)            4           scalar                    1693,1700,1707,1709,1710,1713,1715
 LA                         Local  1699     I(4)            4           scalar                    1699,1700,1703,1704,1709,1710     
 LB                         Local  1703     I(4)            4           scalar                    1703,1704,1705,1706,1709,1710     
 OEFG01_C                   Func   1685     R(4)            4           scalar                    1692,1707,1710,1713,1715,1721     
 OEFG01_C@0                 Local  1685     R(4)            4           scalar                                                      
 P                          Dummy  1685     R(4)            4           scalar   ARG,INOUT        1700,1709                         
 TYP                        Dummy  1685     R(4)            4           scalar   ARG,INOUT        1693                              

Page 46          Source Listing                  OEFG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   1725 
   1726 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1727 C
   1728 C SUBPROGRAM:    CGBLEVN08   CALCULATE SPEC. HUMIDITY AND VIRTUAL TEMP
   1729 C   PRGMMR: D.A. KEYSER      ORG: NP22       DATE: 2006-07-14
   1730 C
   1731 C ABSTRACT: CREATE VIRTUAL TEMPERATURE EVENTS WITHIN GBLEVENTS_CDAS
   1732 C   SUBROUTINE.  FOR ALL TYPES EXCEPT RASS, THIS CONSISTS OF FIRST RE-
   1733 C   CALCULATING THE SPECIFIC HUMIDITY FROM THE REPORTED DEWPOINT
   1734 C   TEMPERATURE AND PRESSURE, FOLLOWED BY THE CALCULATION OF VIRTUAL
   1735 C   TEMPERATURE FROM THE JUST-CALCULATED SPECIFIC HUMIDITY AND THE
   1736 C   REPORTED (SENSIBLE) TEMPERATURE.  THE RE-CALCULATED SPECIFIC
   1737 C   HUMIDITY IS THEN ENCODED AS A STACKED EVENT TO BE LATER WRITTEN
   1738 C   INTO THE PREPBUFR FILE (UNDER PROGRAM "VIRTMP", REASON CODE 0).
   1739 C   IF THE NAMELIST SWITCH DOVTMP IS TRUE, THEN THE JUST-CALCULATED
   1740 C   VIRTUAL TEMPERATURE IS THEN ALSO ENCODED AS A STACKED EVENT TO BE
   1741 C   LATER WRITTEN INTO THE PREPBUFR FILE (UNDER PROGRAM "VIRTMP",
   1742 C   REASON CODE 0, 2 OR 6).  FOR RASS DATA, SPECIFIC HUMIDITY IS
   1743 C   MISSING HOWEVER IF THE NAMELIST SWITCH DOVTMP IS TRUE, A SIMPLE
   1744 C   COPY OF THE REPORTED (VIRTUAL) TEMPERATURE IS ENCODED AS A STACKED
   1745 C   EVENT TO BE LATER WRITTEN INTO THE PREPBUFR FILE (UNDER PROGRAM
   1746 C   "VIRTMP", REASON CODE 3).  THIS SUBROUTINE IS CURRENTLY ONLY
   1747 C   CALLED FOR SURFACE LAND ("ADPSFC"), MARINE ("SFCSHP"), MESONET
   1748 C   ("MSONET") OR RASS ("RASSDA") DATA TYPES WHEN SWITCH "ADPUPA_VIRT"
   1749 C   IS FALSE AND ONLY FOR SURFACE LAND ("ADPSFC"), MARINE ("SFCSHP"),
   1750 C   MESONET ("MSONET"), RASS ("RASSDA"), RAOB/DROP/MULTI-LVL RECCO
   1751 C   ("ADPUPA") DATA TYPES WHEN SWITCH "ADPUPA_VIRT" IS TRUE.  IT IS
   1752 C   ALSO ONLY CALLED IN THE PREVENTS MODE.  THIS ROUTINE IS CALLED ONCE
   1753 C   FOR EACH VALID REPORT IN THE PREPBUFR FILE.
   1754 C
   1755 C PROGRAM HISTORY LOG:
   1756 C 1995-05-17  J. WOOLLEN (NP20) - ORIGINAL AUTHOR
   1757 C 1997-06-01  D.A. KEYSER - STREAMLINED, ADDED SWITCH DOVTMP
   1758 C 1999-12-01 D. A. KEYSER -- SPEC. HUMIDITY AND VIRT. TEMPERATURE ARE
   1759 C     NOW CALCULATED WHEN SPEC. HUMIDITY QUAL. MARKER IS BAD (SUBJECT
   1760 C     TO A SANITY CHECK), HOWEVER THE VIRT. TEMPERATURE GETS A BAD
   1761 C     QUAL. MARKER (8)
   1762 C 2004-08-30 D. A. KEYSER -- FOR "RASSDA" TYPES, ENCODES A SIMPLE COPY
   1763 C     OF THE REPORTED (VIRTUAL) TEMPERATURE AS A "VIRTMP" EVENT IF
   1764 C     DOVTMP IS TRUE, GETS NEW REASON CODE 3
   1765 C 2006-07-14 D. A. KEYSER --  PROCESSES REPORTS IN MESSAGE TYPE ADPUPA
   1766 C     (I.E., RAOBS, DROPS, MULTI-LEVEL RECCOS) WITH SAME LOGIC AS IN
   1767 C     SUBROUTINE VTPEVN OF PROGRAM PREPOBS_CQCBUFR WHEN NEW NAMELIST
   1768 C     SWITCH "ADPUPA_VIRT" IS TRUE {NORMALLY "ADPUPA_VIRT" IS FALSE
   1769 C     (DEFAULT) BECAUSE SUBSEQUENT PROGRAM PREPOBS_CQCBUFR PERFORMS
   1770 C     THIS FUNCTION}
   1771 C
   1772 C USAGE:    CALL CGBLEVN08(IUNITP)
   1773 C   INPUT ARGUMENT LIST:
   1774 C     IUNITP   - BUFR OUTPUT FILE UNIT
   1775 C     SUBSET   - THE BUFR MESSAGE TABLE A ENTRY FOR THE PARTICULAR
   1776 C              - REPORT BEING PROCESSED
   1777 C
   1778 C REMARKS: WILL IMMEDIATELY RETURN TO CALLING PROGRAM IF ANY OF THE
   1779 C   FOLLOWING CONDITIONS EXIST: THERE ARE NO LEVELS OF VALID DEWPOINT,
   1780 C   OBS, TEMPERATURE Q.M. OR SPEC. HUMIDITY Q.M. IN THE INPUT PREPBUFR
   1781 C   FILE FOR THE REPORT.  WILL NOT ATTEMPT EITHER SPEC. HUMIDITY NOR

Page 47          Source Listing                  OEFG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   1782 C   VIRT. TEMP CALC. ON A GIVEN LEVEL IF ANY OF THE FOLLOWING
   1783 C   CONDITIONS EXIST: REPORTED PRESSURE OBS IS MISSING, REPORTED
   1784 C   (SENSIBLE) TEMPERATURE OBS IS MISSING, OR REPORTED DEWPOINT OBS IS
   1785 C   MISSING.
   1786 C 
   1787 C ATTRIBUTES:
   1788 C   LANGUAGE: FORTRAN 90
   1789 C   MACHINE:  NCEP WCOSS
   1790 C
   1791 C$$$
   1792       SUBROUTINE CGBLEVN08(IUNITP,SUBSET) ! FORMERLY SUBROUTINE VTPEVN
   1793 
   1794       CHARACTER*80 EVNSTQ,EVNSTV
   1795       CHARACTER*8  SUBSET
   1796       REAL(8)      TDP_8(255),TQM_8(255),QQM_8(255),BAKQ_8(4,255),
   1797      $             BAKV_8(4,255),OBS_8,BAK_8,SID_8
   1798       REAL(8)      BMISS
   1799 
   1800       LOGICAL      EVNQ,EVNV,DOVTMP,TROP
   1801 
   1802       COMMON /CGBEVAA/ SID_8,OBS_8(12,255),BAK_8(12,255),NLEV,XOB,YOB,
   1803      $ DHR,TYP
   1804       COMMON /CGBEVBB/ PVCD,VTCD
   1805       COMMON /CGBEVCC/ DOVTMP,DOFCST,SOME_FCST,DOBERR,FCST,VIRT,
   1806      $ QTOP_REJ,SATMQC,ADPUPA_VIRT
   1807       COMMON /CGBEVGG/ BMISS
   1808 
   1809       DATA EVNSTQ /'QOB QQM QPC QRC'/
   1810       DATA EVNSTV /'TOB TQM TPC TRC'/
   1811 
   1812 C-----------------------------------------------------------------------
   1813 C FCNS BELOW CONVERT TEMP/TD (K) & PRESS (MB) INTO SAT./ SPEC. HUM.(G/G)
   1814 C-----------------------------------------------------------------------
   1815       ES(T) = 6.1078*EXP((17.269*(T - 273.16))/((T - 273.16)+237.3))
   1816       QS(T,P) = (0.622*ES(T))/(P-(0.378*ES(T)))
   1817 C-----------------------------------------------------------------------
   1818 
   1819 C  CLEAR TEMPERATURE AND SPECIFIC HUMIDITY EVENTS
   1820 C  ----------------------------------------------
   1821 
   1822       EVNQ   = .FALSE.
   1823       EVNV   = .FALSE.
   1824       BAKQ_8 = BMISS
   1825       BAKV_8 = BMISS
   1826       TROP   = .FALSE.
   1827 
   1828 C  GET DEWPOINT TEMPERATURE AND CURRENT T,Q QUALITY MARKERS
   1829 C  --------------------------------------------------------
   1830 
   1831       CALL UFBINT(-IUNITP,TDP_8,1,255,NLTD,'TDO')
   1832       CALL UFBINT(-IUNITP,QQM_8,1,255,NLQQ,'QQM')
   1833       CALL UFBINT(-IUNITP,TQM_8,1,255,NLTQ,'TQM')
   1834       IF(SUBSET.NE.'RASSDA  ') THEN
   1835          IF(NLTD.EQ.0) RETURN
   1836          IF(NLQQ.EQ.0) RETURN
   1837       END IF
   1838       IF(NLTQ.EQ.0) RETURN

Page 48          Source Listing                  CGBLEVN08
2017-04-18 11:09                                 gblevents_cdas.f

   1839       IF(SUBSET.NE.'RASSDA  ') THEN
   1840          IF(NLTD.NE.NLEV) THEN
   1841             PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN08 - NLTD .NE. NLEV - ",
   1842      $       "STOP 61")'
   1843             CALL ERREXIT(61)
   1844          END IF
   1845          IF(NLQQ.NE.NLEV) THEN
   1846             PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN08 - NLQQ .NE. NLEV - ",
   1847      $       "STOP 63")'
   1848             CALL ERREXIT(63)
   1849          END IF
   1850       END IF
   1851       IF(NLTQ.NE.NLEV) THEN
   1852          PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN08 - NLTQ .NE. NLEV - STOP ",
   1853      $    "62")'
   1854          CALL ERREXIT(62)
   1855       END IF
   1856 
   1857 C  COMPUTE VIRTUAL TEMPERATURE AND SPECIFIC HUMIDITY USING REPORTED DEWP
   1858 C  ---------------------------------------------------------------------
   1859 
   1860       IF(NLEV.GT.0)  THEN
   1861       DO L=1,NLEV
   1862          POB = OBS_8(1,L)
   1863          TDO = TDP_8(L)
   1864          TOB = OBS_8(3,L)
   1865          CAT = OBS_8(12,L)
   1866          IF(DOVTMP) THEN
   1867             IF(SUBSET.EQ.'RASSDA  ') THEN
   1868                IF(TOB.LT.BMISS) THEN
   1869                   BAKV_8(1,L) = TOB
   1870                   BAKV_8(2,L) = TQM_8(L)
   1871                   BAKV_8(3,L) = VTCD
   1872                   BAKV_8(4,L) = 3
   1873                   EVNV = .TRUE.
   1874                   CYCLE
   1875                END IF
   1876             END IF
   1877          END IF
   1878          IF(POB.LT.BMISS .AND. TOB.LT.BMISS
   1879      $                   .AND. TDO.LT.BMISS) THEN
   1880             IF(QQM_8(L).GT.3) THEN
   1881 C  Don't update q or calculate Tv if bad moisture obs fails sanity check
   1882 cdak           IF(TDO.LT.-103.15 .OR. TDO.GT.46.83 .OR. POB.LT.0.1 .OR.
   1883 cdak $          POB.GT.1100.)
   1884 cdak $ print *, '&&& bad QM fails sanity check'
   1885                IF(TDO.LT.-103.15 .OR. TDO.GT.46.83 .OR. POB.LT.0.1 .OR.
   1886      $          POB.GT.1100.)  CYCLE
   1887             ENDIF
   1888             QOB = QS(TDO+273.16,POB)
   1889             BAKQ_8(1,L) = QOB*1E6
   1890             BAKQ_8(2,L) = QQM_8(L)  ! Moist qm same as before for
   1891                                     !  re-calc. q
   1892             BAKQ_8(3,L) = VTCD
   1893             BAKQ_8(4,L) = 0     ! Re-calc. q gets unique reason code 0
   1894             EVNQ = .TRUE.
   1895 C  If message type ADPUPA, test this level to see if at or above trop

Page 49          Source Listing                  CGBLEVN08
2017-04-18 11:09                                 gblevents_cdas.f

   1896 C   (trop must be above 500 mb to pass test; if no trop level found
   1897 C   assume it's at 80 mb)
   1898 C  Don't calculate Tv on this level if at or above trop (doesn't affect
   1899 C   q calculation)
   1900             TROP = (SUBSET.EQ.'ADPUPA  ' .AND.
   1901      $       ((CAT.EQ.5 .AND. POB.LT.500.) .OR. POB.LT. 80. .OR. TROP))
   1902             IF(DOVTMP .AND. .NOT.TROP) THEN
   1903                BAKV_8(1,L) = (TOB+273.16)*(1.+.61*QOB)-273.16
   1904                BAKV_8(3,L) = VTCD
   1905                IF(SUBSET.EQ.'ADPUPA  ') THEN
   1906 C  Message type ADPUPA comes here
   1907                   IF(QQM_8(L).LT.4 .OR. TQM_8(L).EQ.0 .OR.
   1908      $             TQM_8(L).GT.3 .OR. POB.LE.700.) THEN
   1909                      BAKV_8(2,L) = TQM_8(L) ! Tv qm same as for T when
   1910                                             !  q ok
   1911                      BAKV_8(4,L) = 0    ! Tv gets unique reason code 0
   1912                   ELSE
   1913                      BAKV_8(2,L) = 3    !Tv qm susp for bad moist below
   1914                                         ! 700 mb
   1915                      BAKV_8(4,L) = 6 !Tv gets unique reason code 6
   1916                   ENDIF
   1917                ELSE
   1918 C  All other message types come here
   1919                   IF(QQM_8(L).LT.4) THEN
   1920                      BAKV_8(2,L) = TQM_8(L) ! Tv qm same as for T when
   1921                                             !  q ok
   1922                      BAKV_8(4,L) = 0    ! Tv gets unique reason code 0
   1923                   ELSE
   1924 cdak  print *, '%%% process tvirt on lvl ',l,' for bad QQM case'
   1925                      BAKV_8(2,L) = 8 ! Tv qm bad for bad moist
   1926                      BAKV_8(4,L) = 2 ! Tv gets unique reason code 2
   1927                   ENDIF
   1928                ENDIF
   1929                EVNV = .TRUE.
   1930             ENDIF
   1931          ENDIF
   1932       ENDDO
   1933       ENDIF
   1934 
   1935 C  ENCODE EVENTS INTO REPORT
   1936 C  -------------------------
   1937 
   1938       IF(NLEV.GT.0)  THEN
   1939          IF(EVNQ) CALL UFBINT(IUNITP,BAKQ_8,4,NLEV,IRET,EVNSTQ)
   1940          IF(EVNV) CALL UFBINT(IUNITP,BAKV_8,4,NLEV,IRET,EVNSTV)
   1941       ENDIF
   1942 
   1943       RETURN
   1944       END

Page 50          Source Listing                  CGBLEVN08
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                  
                        
 cgblevn08_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ADPUPA_VIRT                Scalar 1806     R(4)            4           scalar   COM                                                
 BAKQ_8                     Local  1796     R(8)            8     2     1020                      1824,1889,1890,1892,1893,1939     
 BAKV_8                     Local  1797     R(8)            8     2     1020                      1825,1869,1870,1871,1872,1903,1904
                                                                                                  ,1909,1911,1913,1915,1920,1922,192
                                                                                                  5,1926,1940                       
 BAK_8                      Scalar 1797     R(8)            8     2     3060     COM                                                
 BMISS                      Scalar 1798     R(8)            8           scalar   COM              1824,1825,1868,1878,1879          
 CAT                        Local  1865     R(4)            4           scalar                    1865,1901                         
 CGBEVAA                    Common 1802                                 48988                                                       
 CGBEVBB                    Common 1804                                 8                                                           
 CGBEVCC                    Common 1805                                 36                                                          
 CGBEVGG                    Common 1807                                 8                                                           
 CGBLEVN08                  Subr   1792                                                                                             
 DHR                        Scalar 1803     R(4)            4           scalar   COM                                                
 DOBERR                     Scalar 1805     R(4)            4           scalar   COM                                                
 DOFCST                     Scalar 1805     R(4)            4           scalar   COM                                                
 DOVTMP                     Scalar 1800     L(4)            4           scalar   COM              1866,1902                         
 ERREXIT                    Subr   1843                                                           1843,1848,1854                    
 ES                         Local  1815     R(4)            4           scalar                    1816                              
 EVNQ                       Local  1800     L(4)            4           scalar                    1822,1894,1939                    
 EVNSTQ                     Local  1794     CHAR            80          scalar                    1809,1939                         
 EVNSTV                     Local  1794     CHAR            80          scalar                    1810,1940                         
 EVNV                       Local  1800     L(4)            4           scalar                    1823,1873,1929,1940               
 EXP                        Func   1815                                 scalar                    1815                              
 FCST                       Scalar 1805     R(4)            4           scalar   COM                                                
 IRET                       Local  1939     I(4)            4           scalar                    1939,1940                         
 IUNITP                     Dummy  1792     I(4)            4           scalar   ARG,INOUT        1831,1832,1833,1939,1940          
 L                          Local  1861     I(4)            4           scalar                    1861,1862,1863,1864,1865,1869,1870
                                                                                                  ,1871,1872,1880,1889,1890,1892,189
                                                                                                  3,1903,1904,1907,1908,1909,1911,19
                                                                                                  13,1915,1919,1920,1922,1925,1926  
 NLEV                       Scalar 1802     I(4)            4           scalar   COM              1840,1845,1851,1860,1861,1938,1939
                                                                                                  ,1940                             
 NLQQ                       Local  1832     I(4)            4           scalar                    1832,1836,1845                    
 NLTD                       Local  1831     I(4)            4           scalar                    1831,1835,1840                    
 NLTQ                       Local  1833     I(4)            4           scalar                    1833,1838,1851                    
 OBS_8                      Scalar 1797     R(8)            8     2     3060     COM              1862,1864,1865                    
 POB                        Local  1862     R(4)            4           scalar                    1862,1878,1885,1886,1888,1901,1908
 PVCD                       Scalar 1804     R(4)            4           scalar   COM                                                
 QOB                        Local  1888     R(4)            4           scalar                    1888,1889,1903                    
 QQM_8                      Local  1796     R(8)            8     1     255                       1832,1880,1890,1907,1919          
 QS                         Local  1816     R(4)            4           scalar                    1888                              
 QTOP_REJ                   Scalar 1806     R(4)            4           scalar   COM                                                
 SATMQC                     Scalar 1806     R(4)            4           scalar   COM                                                

Page 51          Source Listing                  CGBLEVN08
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SID_8                      Scalar 1797     R(8)            8           scalar   COM                                                
 SOME_FCST                  Scalar 1805     R(4)            4           scalar   COM                                                
 SUBSET                     Dummy  1792     CHAR            8           scalar   ARG,INOUT        1834,1839,1867,1900,1905          
 TDO                        Local  1863     R(4)            4           scalar                    1863,1879,1885,1888               
 TDP_8                      Local  1796     R(8)            8     1     255                       1831,1863                         
 TOB                        Local  1864     R(4)            4           scalar                    1864,1868,1869,1878,1903          
 TQM_8                      Local  1796     R(8)            8     1     255                       1833,1870,1907,1908,1909,1920     
 TROP                       Local  1800     L(4)            4           scalar                    1826,1900,1901,1902               
 TYP                        Scalar 1803     R(4)            4           scalar   COM                                                
 UFBINT                     Subr   1831                                                           1831,1832,1833,1939,1940          
 VIRT                       Scalar 1805     R(4)            4           scalar   COM                                                
 VTCD                       Scalar 1804     R(4)            4           scalar   COM              1871,1892,1904                    
 XOB                        Scalar 1802     R(4)            4           scalar   COM                                                
 YOB                        Scalar 1802     R(4)            4           scalar   COM                                                

Page 52          Source Listing                  CGBLEVN08
2017-04-18 11:09                                 gblevents_cdas.f

   1945 C#######################
   1946 C#######################
   1947 C#######################
   1948 C#######################
   1949 C#######################
   1950 C#######################
   1951 C***********************************************************************
   1952 C***********************************************************************
   1953       SUBROUTINE CGBLEVN10(IUNITF,IDATEP) ! FORMERLY SUBROUTINE GESRES
   1954  
   1955       COMMON /CGBEVFF/IMAX,JMAX,KMAX,kmaxs,DLAT,DLON,IDVC,SL(100),
   1956      x     SI(101)
   1957       COMMON /CGBEVHH/ JCAP,JCAP1,JCAP2,JCAP1X2,MDIMA,MDIMB,MDIMC
   1958 
   1959       DIMENSION  IDATE(8,2),JDATE(8,2),KDATE(8,2),IUNITF(2),FHR(2),
   1960      $           KINDX(2)
   1961  
   1962       DIMENSION HEADR2(226,2)
   1963 
   1964       REAL RINC(5)
   1965 
   1966       CHARACTER*6 COORD(2)
   1967 
   1968       DATA COORD /'SIGMA ','HYBRID'/
   1969 
   1970       IF(MOD(MOD(IDATEP,100),3).EQ.0)  THEN
   1971          KFILES = 1
   1972          KINDX = 0
   1973          PRINT 331, MOD(IDATEP,100)
   1974   331    FORMAT(/' --> GBLEVENTS_CDAS: THE PREPBUFR CENTER HOUR (',I2.2,
   1975      $    ') IS A MULTIPLE OF 3 - ONLY ONE GLOBAL SIGMA FILE IS READ,'/
   1976      $    21X,'NO INTERPOLATION OF SPECTRAL COEFFICIENTS IS PERFORMED'/)
   1977       ELSE
   1978          KFILES = 2
   1979          KINDX(1) = MOD(MOD(IDATEP,100),3)
   1980          KINDX(2) = KINDX(1) - 3
   1981          PRINT 332, MOD(IDATEP,100)
   1982   332    FORMAT(/' --> GBLEVENTS_CDAS: THE PREPBUFR CENTER HOUR (',I2.2,
   1983      $    ') IS NOT A MULTIPLE OF 3 - TWO SPANNING GLOBAL SIGMA FILES'/
   1984      $    21X,'ARE READ AND THE SPECTRAL COEFFICIENTS ARE INTERPOLATED',
   1985      $    ' TO THE PREPBUFR CENTER TIME'/)
   1986       END IF
   1987 
   1988 C  GET VALID-TIME DATE OF SIGMA FILE(S), ALSO READ HEADERS
   1989 C  -------------------------------------------------------
   1990 
   1991       JFILE = 0
   1992       RINC  = 0
   1993       DO IFILE=1,KFILES
   1994          JFILE = IFILE
   1995          REWIND IUNITF(IFILE)
   1996          READ(IUNITF(IFILE),ERR=900) DUMMY
   1997          IDATE(:,IFILE) = 0
   1998          READ(IUNITF(IFILE),END=800,ERR=800) FHR(IFILE),idate(5,IFILE),
   1999      $    idate(2,IFILE),idate(3,IFILE),idate(1,IFILE),HEADR2(:,IFILE)
   2000          IHEADR2_SIZE = 226
   2001 cppppp

Page 53          Source Listing                  CGBLEVN10
2017-04-18 11:09                                 gblevents_cdas.f

   2002       print *
   2003       print *, '##GBLEVENTS_CDAS/CGBLEVN10 - Guess file has a 226 word',
   2004      $ ' header'
   2005       print *
   2006 cppppp
   2007          GO TO 801
   2008   800    CONTINUE
   2009          REWIND IUNITF(IFILE)
   2010          READ(IUNITF(IFILE),ERR=900) DUMMY
   2011          IDATE(:,IFILE) = 0
   2012          READ(IUNITF(IFILE),END=900,ERR=900) FHR(IFILE),idate(5,IFILE),
   2013      $    idate(2,IFILE),idate(3,IFILE),idate(1,IFILE),
   2014      $    HEADR2(1:207,IFILE)
   2015          IHEADR2_SIZE = 207
   2016 cppppp
   2017       print *
   2018       print *, '##GBLEVENTS_CDAS/CGBLEVN10 - Guess file has a 207 word',
   2019      $ ' header'
   2020       print *, '                           - most likely a CDAS sges ',
   2021      $ 'file'
   2022       print *
   2023 cppppp
   2024   801    CONTINUE
   2025          IF(IDATE(1,IFILE).LT.100)  THEN
   2026 
   2027 C IF 2-DIGIT YEAR FOUND IN GLOBAL SIMGA FILE INITIAL DATE
   2028 C  (IDATE(1,IFILE)), MUST USE "WINDOWING" TECHNIQUE TO CREATE A 4-DIGIT
   2029 C  YEAR (NOTE: THE T170 IMPLEMENTATION IN JUNE 1998 WAS TO INCLUDE THE
   2030 C  WRITING OF A 4-DIGIT YEAR HERE.  PRIOR TO THIS, THE YEAR HERE WAS
   2031 C  2-DIGIT.)
   2032 
   2033             PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10 - 2-DIGIT YEAR FOUND ",
   2034      $       "IN GLOBAL SIGMA FILE ",I0,"; INITIAL DATE (YEAR IS: ",I0,
   2035      $       ") - USE WINDOWING TECHNIQUE TO OBTAIN 4-DIGIT YEAR")',
   2036      $       IFILE,idate(1,IFILE)
   2037             IF(IDATE(1,IFILE).GT.20)  THEN
   2038                IDATE(1,IFILE) = 1900 + IDATE(1,IFILE)
   2039             ELSE
   2040                IDATE(1,IFILE) = 2000 + IDATE(1,IFILE)
   2041             ENDIF
   2042             PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10 - CORRECTED 4-DIGIT ",
   2043      $       "YEAR IS NOW: ",I0)', IDATE(1,IFILE)
   2044          ENDIF
   2045          RINC(2) = ANINT(FHR(IFILE))
   2046          CALL W3MOVDAT(RINC,IDATE(:,IFILE),JDATE(:,IFILE))
   2047          PRINT 1, IFILE,ANINT(FHR(IFILE)),(IDATE(II,IFILE),II=1,3),
   2048      $    IDATE(5,IFILE),(JDATE(II,IFILE),II=1,3),JDATE(5,IFILE)
   2049     1    FORMAT(' --> GBLEVENTS_CDAS: GLOBAL SIGMA FILE',I2,' HERE IS ',
   2050      $    'A ',F5.1,' HOUR FORECAST FROM ',I5.4,3I3.2,' VALID AT ',I5.4,
   2051      $    3I3.2)
   2052          KDATE(:,IFILE) = JDATE(:,IFILE)
   2053          IF(KFILES.EQ.2) THEN
   2054             RINC(2) = REAL(KINDX(IFILE))
   2055             CALL W3MOVDAT(RINC,JDATE(:,IFILE),KDATE(:,IFILE))
   2056          ENDIF
   2057          IDATGS_COR = (KDATE(1,IFILE) * 1000000) + (KDATE(2,IFILE) *
   2058      $    10000) + (KDATE(3,IFILE) * 100) + KDATE(5,IFILE)

Page 54          Source Listing                  CGBLEVN10
2017-04-18 11:09                                 gblevents_cdas.f

   2059 
   2060 C  VALID DATES MUST MATCH
   2061 C  ----------------------
   2062 
   2063          IF(IDATEP.NE.IDATGS_COR)  GO TO 901
   2064 
   2065       ENDDO
   2066 
   2067       IF(KFILES.EQ.2)  THEN
   2068 
   2069 C  IF THERE ARE TWO SIGMA FILES, THEIR HEADERS MUST MATCH
   2070 C  -------------------------------------------------------
   2071 
   2072          JNDEX = 0
   2073          DO  INDEX=1,IHEADR2_SIZE
   2074             JNDEX = INDEX
   2075             IF(HEADR2(INDEX,1).NE.HEADR2(INDEX,2)) GO TO 904
   2076          ENDDO
   2077       ENDIF
   2078 
   2079 C  EXTRACT HEADER INFO
   2080 C  -------------------
   2081  
   2082       JCAP  = HEADR2(202,1)
   2083       KMAX  = HEADR2(203,1)
   2084       IF(IHEADR2_SIZE.EQ.226) THEN
   2085          IDVC  = HEADR2(220,1)
   2086       ELSE
   2087          IDVC=0
   2088       END IF
   2089       kmaxs = 2*kmax+2
   2090 
   2091       if(idvc.eq.0)  idvc = 1  ! Reset IDVC=0 to 1 (sigma coord.)
   2092       IF(IDVC.NE.1.AND.IDVC.NE.2) THEN
   2093          PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10: INVALID VERT COORD ID ",
   2094      $    "(=",I0,"), DEFAULTING TO SIGMA COORD, RESETTING IDVC = 1")',
   2095      $    IDVC
   2096         IDVC = 1
   2097       END IF
   2098 
   2099       IF(KMAX.GT.100) GO TO 902
   2100  
   2101       IF(IDVC.EQ.1) THEN
   2102 
   2103 C  SIGMA COORDINATE COEFFICIENTS
   2104 C  -----------------------------
   2105 
   2106          DO  L = 1,KMAX
   2107             SI(L) = HEADR2(L,1)
   2108             SL(L) = HEADR2(KMAX+1+L,1)
   2109          ENDDO
   2110          SI(KMAX+1) = HEADR2(KMAX+1,1)
   2111       ELSEIF(IDVC.EQ.2) THEN
   2112 
   2113 C  HYBRID COORDINATE COEFFICIENTS
   2114 C  ------------------------------
   2115 

Page 55          Source Listing                  CGBLEVN10
2017-04-18 11:09                                 gblevents_cdas.f

   2116          DO  L = 1,KMAX+1
   2117 
   2118 C  Convert AK HYBRID coeff for use in HPA
   2119 C  --------------------------------------
   2120 
   2121             SI(L) = (0.01)*HEADR2(L,1)
   2122             SL(L) = HEADR2(KMAX+1+L,1)
   2123          END DO
   2124       END IF
   2125 
   2126 C  DEFINE THE OTHER RESOLUTION PARAMETERS
   2127 C  --------------------------------------
   2128  
   2129       JCAP1   = JCAP+1
   2130       JCAP2   = JCAP+2
   2131       JCAP1X2 = JCAP1*2
   2132       MDIMA   = JCAP1*JCAP2
   2133       MDIMB   = MDIMA/2+JCAP1
   2134       MDIMC   = MDIMB*2
   2135       IMAX    = 384
   2136       JMAX    = IMAX/2+1
   2137  
   2138 cdak  IF(IMAX.LT.JCAP1X2) GO TO 903   ! commented out 9/27/01
   2139  
   2140       DLAT  = 180./(JMAX-1)
   2141       DLON  = 360./IMAX
   2142  
   2143       PRINT 2, JCAP,KMAX,kmaxs,DLAT,DLON,COORD(IDVC)
   2144     2 FORMAT(/' --> GBLEVENTS_CDAS: GLOBAL MODEL SPECS: T',I3,' ',I3,
   2145      $ ' LEVELS ',I3,' SCALARS -------> ',F5.2,' X ',F5.2,' VERT. ',
   2146      $ 'COORD: ',A)
   2147  
   2148       CALL CGBLEVN09(IUNITF,KINDX)
   2149  
   2150       RETURN
   2151 
   2152   900 CONTINUE
   2153       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10 - BAD OR MISSING GLOBAL ",
   2154      $ "SIGMA FILE ",I0," - STOP 67")', JFILE
   2155       CALL ERREXIT(67)
   2156   901 CONTINUE
   2157       PRINT 9901, JFILE,(JDATE(II,JFILE),II=1,3),JDATE(5,JFILE),IDATEP
   2158  9901 FORMAT(/' ##GBLEVENTS_CDAS/CGBLEVN10 - SIGMA FILE',I2,' DATE (',
   2159      $ I4.4,3(I2.2),'), DOES NOT MATCH -OR SPAN- PREPBUFR FILE CENTER ',
   2160      $ 'DATE (',I10,') -STOP 68'/)
   2161       CALL ERREXIT(68)
   2162   902 CONTINUE
   2163       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10 - KMAX TOO BIG = ",I0," - ",
   2164      $ "UNABLE TO TRANSFORM GLOBAL SIGMA FILE(S) - STOP 69")', KMAX
   2165       CALL ERREXIT(69)
   2166   903 CONTINUE
   2167       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10 - IMAX TOO SMALL = ",I0," - ",
   2168      $ "UNABLE TO TRANSFORM GLOBAL SIGMA FILE(S) - STOP 70")', IMAX
   2169       CALL ERREXIT(70)
   2170   904 CONTINUE
   2171       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN10 - HEADER INDEX ",I0," FOR ",
   2172      $ "SIGMA FILE 1 (=",F8.3,") DOES NOT MATCH THAT FOR SIGMA FILE 2 ",

Page 56          Source Listing                  CGBLEVN10
2017-04-18 11:09                                 gblevents_cdas.f

   2173      $ "(=",F8.3," - STOP 71")', JNDEX,HEADR2(JNDEX,1),HEADR2(JNDEX,2)
   2174       CALL ERREXIT(71)
   2175       END


ENTRY POINTS

  Name                  
                        
 cgblevn10_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  2049                                                           2047                              
 2                          Label  2144                                                           2143                              
 331                        Label  1974                                                           1973                              
 332                        Label  1982                                                           1981                              
 800                        Label  2008                                                           1998                              
 801                        Label  2024                                                           2007                              
 900                        Label  2152                                                           1996,2010,2012                    
 901                        Label  2156                                                           2063                              
 902                        Label  2162                                                           2099                              
 903                        Label  2166                                                                                             
 904                        Label  2170                                                           2075                              
 9901                       Label  2158                                                           2157                              
 ANINT                      Func   2045                                 scalar                    2045,2047                         
 CGBEVFF                    Common 1955                                 832                                                         
 CGBEVHH                    Common 1957                                 28                                                          
 CGBLEVN09                  Subr   2148                                                           2148                              
 CGBLEVN10                  Subr   1953                                                                                             
 COORD                      Local  1966     CHAR            6     1     2                         1968,2143                         
 DLAT                       Scalar 1955     R(4)            4           scalar   COM              2140,2143                         
 DLON                       Scalar 1955     R(4)            4           scalar   COM              2141,2143                         
 DUMMY                      Local  1996     R(4)            4           scalar                    1996,2010                         
 ERREXIT                    Subr   2155                                                           2155,2161,2165,2169,2174          
 FHR                        Local  1959     R(4)            4     1     2                         1998,2012,2045,2047               
 HEADR2                     Local  1962     R(4)            4     2     452                       1999,2014,2075,2082,2083,2085,2107
                                                                                                  ,2108,2110,2121,2122,2173         
 IDATE                      Local  1959     I(4)            4     2     16                        1997,1998,1999,2011,2012,2013,2025
                                                                                                  ,2036,2037,2038,2040,2043,2046,204
                                                                                                  7,2048                            
 IDATEP                     Dummy  1953     I(4)            4           scalar   ARG,INOUT        1970,1973,1979,1981,2063,2157     
 IDATGS_COR                 Local  2057     I(4)            4           scalar                    2057,2063                         
 IDVC                       Scalar 1955     I(4)            4           scalar   COM              2085,2087,2091,2092,2095,2096,2101
                                                                                                  ,2111,2143                        
 IFILE                      Local  1993     I(4)            4           scalar                    1993,1994,1995,1996,1997,1998,1999
                                                                                                  ,2009,2010,2011,2012,2013,2014,202
                                                                                                  5,2036,2037,2038,2040,2043,2045,20
                                                                                                  46,2047,2048,2052,2054,2055,2057,2
                                                                                                  058                               
 IHEADR2_SIZE               Local  2000     I(4)            4           scalar                    2000,2015,2073,2084               
 II                         Local  2047     I(4)            4           scalar                    2047,2048,2157                    
 IMAX                       Scalar 1955     I(4)            4           scalar   COM              2135,2136,2141,2168               
 INDEX                      Local  2073     I(4)            4           scalar                    2073,2074,2075                    

Page 57          Source Listing                  CGBLEVN10
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IUNITF                     Dummy  1953     I(4)            4     1     2        ARG,INOUT        1995,1996,1998,2009,2010,2012,2148
 JCAP                       Scalar 1957     I(4)            4           scalar   COM              2082,2129,2130,2143               
 JCAP1                      Scalar 1957     I(4)            4           scalar   COM              2129,2131,2132,2133               
 JCAP1X2                    Scalar 1957     I(4)            4           scalar   COM              2131                              
 JCAP2                      Scalar 1957     I(4)            4           scalar   COM              2130,2132                         
 JDATE                      Local  1959     I(4)            4     2     16                        2046,2048,2052,2055,2157          
 JFILE                      Local  1991     I(4)            4           scalar                    1991,1994,2154,2157               
 JMAX                       Scalar 1955     I(4)            4           scalar   COM              2136,2140                         
 JNDEX                      Local  2072     I(4)            4           scalar                    2072,2074,2173                    
 KDATE                      Local  1959     I(4)            4     2     16                        2052,2055,2057,2058               
 KFILES                     Local  1971     I(4)            4           scalar                    1971,1978,1993,2053,2067          
 KINDX                      Local  1960     I(4)            4     1     2                         1972,1979,1980,2054,2148          
 KMAX                       Scalar 1955     I(4)            4           scalar   COM              2083,2089,2099,2106,2108,2110,2116
                                                                                                  ,2122,2143,2164                   
 KMAXS                      Scalar 1955     I(4)            4           scalar   COM              2089,2143                         
 L                          Local  2106     I(4)            4           scalar                    2106,2107,2108,2116,2121,2122     
 MDIMA                      Scalar 1957     I(4)            4           scalar   COM              2132,2133                         
 MDIMB                      Scalar 1957     I(4)            4           scalar   COM              2133,2134                         
 MDIMC                      Scalar 1957     I(4)            4           scalar   COM              2134                              
 MOD                        Func   1970                                 scalar                    1970,1973,1979,1981               
 REAL                       Func   2054                                 scalar                    2054                              
 RINC                       Local  1964     R(4)            4     1     5                         1992,2045,2046,2054,2055          
 SI                         Scalar 1956     R(4)            4     1     101      COM              2107,2110,2121                    
 SL                         Scalar 1955     R(4)            4     1     100      COM              2108,2122                         
 W3MOVDAT                   Subr   2046                                                           2046,2055                         

Page 58          Source Listing                  CGBLEVN10
2017-04-18 11:09                                 gblevents_cdas.f

   2176 C***********************************************************************
   2177 C***********************************************************************
   2178       SUBROUTINE CGBLEVN09(IUNITF,KINDX)
   2179                                          ! FORMERLY SUBROUTINE COF2GRD
   2180  
   2181       parameter (PI180=.0174532)
   2182 
   2183       COMMON /CGBEVFF/IMAX,JMAX,KMAX,kmaxs,DLAT,DLON,IDVC,SL(100),
   2184      x     SI(101)
   2185       COMMON /CGBEVHH/ JCAP,JCAP1,JCAP2,JCAP1X2,MDIMA,MDIMB,MDIMC
   2186  
   2187       DIMENSION IUNITF(2),KINDX(2)
   2188 
   2189 C Changes below allocates arrays from "heap" rather than "stack"
   2190 C     real      cofs(mdima,kmaxs), cofv(mdima,kmax,2)
   2191 C     real      cofs_f(mdima,kmaxs,2), cofv_f(mdima,kmax,2,2)
   2192 C     real      grds(IMAX,JMAX,kmaxs), grdv(IMAX,JMAX,kmax,2)
   2193 C     real      grd2(IMAX,JMAX,2)
   2194       real,allocatable:: cofs(:,:), cofv(:,:,:)
   2195       real,allocatable:: cofs_f(:,:,:), cofv_f(:,:,:,:)
   2196       real,allocatable:: grds(:,:,:), grdv(:,:,:,:)
   2197       real,allocatable:: grd2(:,:,:)
   2198 
   2199 C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   2200 
   2201 C USAGE:    CALL SPTEZM(IROMB,MAXWV,IDRT,IMAX,JMAX,KMAX,WAVE,GRID,IDIR)
   2202 C   INPUT ARGUMENTS:
   2203 C     IROMB    - INTEGER SPECTRAL DOMAIN SHAPE
   2204 C                (0 FOR TRIANGULAR, 1 FOR RHOMBOIDAL)
   2205 C     MAXWV    - INTEGER SPECTRAL TRUNCATION
   2206 C     IDRT     - INTEGER GRID IDENTIFIER
   2207 C                (IDRT=4 FOR GAUSSIAN GRID,
   2208 C                 IDRT=0 FOR EQUALLY-SPACED GRID INCLUDING POLES,
   2209 C                 IDRT=256 FOR EQUALLY-SPACED GRID EXCLUDING POLES)
   2210 C     IMAX     - INTEGER EVEN NUMBER OF LONGITUDES
   2211 C     JMAX     - INTEGER NUMBER OF LATITUDES
   2212 C     KMAX     - INTEGER NUMBER OF FIELDS TO TRANSFORM
   2213 C     WAVE     - REAL (2*MX,KMAX) WAVE FIELD IF IDIR>0
   2214 C                WHERE MX=(MAXWV+1)*((IROMB+1)*MAXWV+2)/2
   2215 C     GRID     - REAL (IMAX,JMAX,KMAX) GRID FIELD (E->W,N->S) IF IDIR<0
   2216 C     IDIR     - INTEGER TRANSFORM FLAG
   2217 C                (IDIR>0 FOR WAVE TO GRID, IDIR<0 FOR GRID TO WAVE)
   2218 C   OUTPUT ARGUMENTS:
   2219 C     WAVE     - REAL (2*MX,KMAX) WAVE FIELD IF IDIR<0
   2220 C                WHERE MX=(MAXWV+1)*((IROMB+1)*MAXWV+2)/2
   2221 C     GRID     - REAL (IMAX,JMAX,KMAX) GRID FIELD (E->W,N->S) IF IDIR>0
   2222 
   2223 
   2224 C USAGE:    CALL SPTEZMV(IROMB,MAXWV,IDRT,IMAX,JMAX,KMAX,
   2225 C    &                   WAVED,WAVEZ,GRIDU,GRIDV,IDIR)
   2226 C   INPUT ARGUMENTS:
   2227 C     WAVED    - REAL (2*MX,KMAX) WAVE DIVERGENCE FIELD IF IDIR>0
   2228 C                WHERE MX=(MAXWV+1)*((IROMB+1)*MAXWV+2)/2
   2229 C     WAVEZ    - REAL (2*MX,KMAX) WAVE VORTICITY FIELD IF IDIR>0
   2230 C                WHERE MX=(MAXWV+1)*((IROMB+1)*MAXWV+2)/2
   2231 C     GRIDU    - REAL (IMAX,JMAX,KMAX) GRID U-WIND (E->W,N->S) IF IDIR<0
   2232 C     GRIDV    - REAL (IMAX,JMAX,KMAX) GRID V-WIND (E->W,N->S) IF IDIR<0

Page 59          Source Listing                  CGBLEVN09
2017-04-18 11:09                                 gblevents_cdas.f

   2233 C   OUTPUT ARGUMENTS:
   2234 C     WAVED    - REAL (2*MX,KMAX) WAVE DIVERGENCE FIELD IF IDIR<0
   2235 C                WHERE MX=(MAXWV+1)*((IROMB+1)*MAXWV+2)/2
   2236 C     WAVEZ    - REAL (2*MX,KMAX) WAVE VORTICITY FIELD IF IDIR>0
   2237 C                WHERE MX=(MAXWV+1)*((IROMB+1)*MAXWV+2)/2
   2238 C     GRIDU    - REAL (IMAX,JMAX,KMAX) GRID U-WIND (E->W,N->S) IF IDIR>0
   2239 C     GRIDV    - REAL (IMAX,JMAX,KMAX) GRID V-WIND (E->W,N->S) IF IDIR>0
   2240 
   2241 C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   2242 
   2243       allocate (cofs(mdima,kmaxs), cofv(mdima,kmax,2))
   2244       allocate (cofs_f(mdima,kmaxs,2), cofv_f(mdima,kmax,2,2))
   2245       allocate (grds(IMAX,JMAX,kmaxs), grdv(IMAX,JMAX,kmax,2))
   2246       allocate (grd2(IMAX,JMAX,2))
   2247 
   2248       IROMB=0
   2249       MAXWV=JCAP
   2250       IDRT=0
   2251       IDIR=1
   2252 
   2253 
   2254       IF(KINDX(1).EQ.0)  THEN
   2255          KFILES = 1
   2256       ELSE
   2257          KFILES = 2
   2258       ENDIF
   2259 
   2260       DO IFILE=1,KFILES
   2261          ns=1
   2262          DO I=1,5
   2263             if (i.ne.4) then
   2264                 LEV = KMAX
   2265                 IF(I.LE.2) LEV = 1
   2266                 DO L=1,LEV
   2267                   READ(IUNITF(IFILE),END=900,ERR=901)
   2268      $             (COFS_f(II,NS,IFILE),II=1,MDIMA)
   2269                   ns=ns+1
   2270                 enddo
   2271             else
   2272                 NRD = 2
   2273                 DO L=1,LEV
   2274                    DO K=1,NRD
   2275                       READ(IUNITF(IFILE),END=900,ERR=901)
   2276      $                 (COFV_f(II,L,K,IFILE),II=1,MDIMA)
   2277                    ENDDO
   2278                 enddo
   2279              endif
   2280          enddo
   2281       ENDDO
   2282 
   2283       IF(KFILES.EQ.1)  THEN
   2284          DO I = 1,MDIMA
   2285             COFS(I,1:KMAXS) = COFS_f(I,1:KMAXS,1)
   2286             COFV(I,1:KMAX,1:2) = COFV_f(I,1:KMAX,1:2,1)
   2287          ENDDO
   2288 
   2289       ELSE

Page 60          Source Listing                  CGBLEVN09
2017-04-18 11:09                                 gblevents_cdas.f

   2290          COFS=
   2291      $   ((ABS(KINDX(2))*COFS_f(:,:,1))  +(KINDX(1)*COFS_f(:,:,2)))/3.
   2292          COFV=
   2293      $   ((ABS(KINDX(2))*COFV_f(:,:,:,1))+(KINDX(1)*COFV_f(:,:,:,2)))/3.
   2294       ENDIF
   2295 
   2296       CALL SPTEZM(IROMB,MAXWV,IDRT,IMAX,JMAX,KMAXS,COFS,GRDS,IDIR)
   2297       CALL SPTEZMV(IROMB,MAXWV,IDRT,IMAX,JMAX,KMAX,
   2298      &         COFV(1,1,1),COFV(1,1,2),GRDV(1,1,1,1),GRDV(1,1,1,2),IDIR)
   2299       ns=1
   2300       DO I=1,5
   2301          if (i.ne.4) then
   2302              LEV = KMAX
   2303              IF(I.LE.2) LEV = 1
   2304              DO L=1,LEV
   2305                  call cgblevn11(imax,jmax,grds(1,1,ns))
   2306                  if (ns.eq.2) then
   2307                      DO J=1,JMAX
   2308                          DO II=1,IMAX
   2309                              GRDS(II,J,NS) = 10.*EXP(GRDS(II,J,NS))
   2310                          ENDDO
   2311                      ENDDO
   2312                  endif
   2313                  !print'(2i5,2e13.6)',i,l,grds(1,1,ns),GRDs(1,jmax/2,ns)
   2314                  CALL CGBLEVN05(GRDS(1,1,NS),I,L)
   2315                  ns=ns+1
   2316              enddo
   2317          else
   2318              NRD = 2
   2319              DO L=1,LEV
   2320                 DO K=1,NRD
   2321                     call cgblevn11(imax,jmax,grdv(1,1,l,k))
   2322                     do J=1,jmax
   2323                         grd2(1:imax,j,k)=grdv(1:imax,j,l,k)
   2324                     enddo
   2325                 enddo
   2326                 !print'(2i5,2e13.6)',i,l,grd2(1,1,1),GRD2(1,jmax/2,1)
   2327                 CALL CGBLEVN05(GRD2,I,L)
   2328              enddo
   2329          endif
   2330       enddo
   2331  
   2332       deallocate (cofs, cofv)
   2333       deallocate (cofs_f, cofv_f)
   2334       deallocate (grds, grdv)
   2335       deallocate (grd2)
   2336 
   2337       RETURN
   2338 
   2339   900 CONTINUE
   2340       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN09 - EOF READING GLOBAL SIGMA ",
   2341      $ "FILE - UNABLE TO TRANSFORM GLOBAL SIGMA FILE - STOP 64")'
   2342       CALL ERREXIT(64)
   2343   901 CONTINUE
   2344       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN09 - ERROR READING GLOBAL SIGMA",
   2345      $ " FILE - UNABLE TO TRANSFORM GLOBAL SIGMA FILE - STOP 65")'
   2346       CALL ERREXIT(65)

Page 61          Source Listing                  CGBLEVN09
2017-04-18 11:09                                 gblevents_cdas.f

   2347   902 CONTINUE
   2348       PRINT'(" ##GBLEVENTS_CDAS/CGBLEVN09 - IDIM NOT FACTORABLE - ",
   2349      $ "UNABLE TO TRANSFORM GLOBAL SIGMA FILE - STOP 66")'
   2350       CALL ERREXIT(66)
   2351       END


ENTRY POINTS

  Name                  
                        
 cgblevn09_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 900                        Label  2339                                                           2267,2275                         
 901                        Label  2343                                                           2267,2275                         
 902                        Label  2347                                                                                             
 ABS                        Func   2291                                 scalar                    2291,2293                         
 CGBEVFF                    Common 2183                                 832                                                         
 CGBEVHH                    Common 2185                                 28                                                          
 CGBLEVN05                  Subr   2314                                                           2314,2327                         
 CGBLEVN09                  Subr   2178                                                                                             
 CGBLEVN11                  Subr   2305                                                           2305,2321                         
 COFS                       Local  2194     R(4)            4     2     1        ALC              2243,2285,2290,2296,2332          
 COFS_F                     Local  2195     R(4)            4     3     1        ALC              2244,2268,2285,2291,2333          
 COFV                       Local  2194     R(4)            4     3     1        ALC              2243,2286,2292,2298,2332          
 COFV_F                     Local  2195     R(4)            4     4     1        ALC              2244,2276,2286,2293,2333          
 DLAT                       Scalar 2183     R(4)            4           scalar   COM                                                
 DLON                       Scalar 2183     R(4)            4           scalar   COM                                                
 ERREXIT                    Subr   2342                                                           2342,2346,2350                    
 EXP                        Func   2309                                 scalar                    2309                              
 GRD2                       Local  2197     R(4)            4     3     1        ALC              2246,2323,2327,2335               
 GRDS                       Local  2196     R(4)            4     3     1        ALC              2245,2296,2305,2309,2314,2334     
 GRDV                       Local  2196     R(4)            4     4     1        ALC              2245,2298,2321,2323,2334          
 I                          Local  2262     I(4)            4           scalar                    2262,2263,2265,2284,2285,2286,2300
                                                                                                  ,2301,2303,2314,2327              
 IDIR                       Local  2251     I(4)            4           scalar                    2251,2296,2298                    
 IDRT                       Local  2250     I(4)            4           scalar                    2250,2296,2297                    
 IDVC                       Scalar 2183     I(4)            4           scalar   COM                                                
 IFILE                      Local  2260     I(4)            4           scalar                    2260,2267,2268,2275,2276          
 II                         Local  2268     I(4)            4           scalar                    2268,2276,2308,2309               
 IMAX                       Scalar 2183     I(4)            4           scalar   COM              2245,2246,2296,2297,2305,2308,2321
                                                                                                  ,2323                             
 IROMB                      Local  2248     I(4)            4           scalar                    2248,2296,2297                    
 IUNITF                     Dummy  2178     I(4)            4     1     2        ARG,INOUT        2267,2275                         
 J                          Local  2307     I(4)            4           scalar                    2307,2309,2322,2323               
 JCAP                       Scalar 2185     I(4)            4           scalar   COM              2249                              
 JCAP1                      Scalar 2185     I(4)            4           scalar   COM                                                
 JCAP1X2                    Scalar 2185     I(4)            4           scalar   COM                                                
 JCAP2                      Scalar 2185     I(4)            4           scalar   COM                                                
 JMAX                       Scalar 2183     I(4)            4           scalar   COM              2245,2246,2296,2297,2305,2307,2321
                                                                                                  ,2322                             
 K                          Local  2274     I(4)            4           scalar                    2274,2276,2320,2321,2323          

Page 62          Source Listing                  CGBLEVN09
2017-04-18 11:09 Symbol Table                    gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KFILES                     Local  2255     I(4)            4           scalar                    2255,2257,2260,2283               
 KINDX                      Dummy  2178     I(4)            4     1     2        ARG,INOUT        2254,2291,2293                    
 KMAX                       Scalar 2183     I(4)            4           scalar   COM              2243,2244,2245,2264,2286,2297,2302
 KMAXS                      Scalar 2183     I(4)            4           scalar   COM              2243,2244,2245,2285,2296          
 L                          Local  2266     I(4)            4           scalar                    2266,2273,2276,2304,2314,2319,2321
                                                                                                  ,2323,2327                        
 LEV                        Local  2264     I(4)            4           scalar                    2264,2265,2266,2273,2302,2303,2304
                                                                                                  ,2319                             
 MAXWV                      Local  2249     I(4)            4           scalar                    2249,2296,2297                    
 MDIMA                      Scalar 2185     I(4)            4           scalar   COM              2243,2244,2268,2276,2284          
 MDIMB                      Scalar 2185     I(4)            4           scalar   COM                                                
 MDIMC                      Scalar 2185     I(4)            4           scalar   COM                                                
 NRD                        Local  2272     I(4)            4           scalar                    2272,2274,2318,2320               
 NS                         Local  2261     I(4)            4           scalar                    2261,2268,2269,2299,2305,2306,2309
                                                                                                  ,2314,2315                        
 PI180                      Param  2181     R(4)            4           scalar                                                      
 SI                         Scalar 2184     R(4)            4     1     101      COM                                                
 SL                         Scalar 2183     R(4)            4     1     100      COM                                                
 SPTEZM                     Subr   2296                                                           2296                              
 SPTEZMV                    Subr   2297                                                           2297                              

Page 63          Source Listing                  CGBLEVN09
2017-04-18 11:09                                 gblevents_cdas.f

   2352 C***********************************************************************
   2353 C***********************************************************************
   2354       subroutine cgblevn11(imax,jmax,grid)! formerly subroutine n_s_swap
   2355       real grid(imax,jmax)
   2356       real temp (imax)
   2357 
   2358       do j=1,jmax/2
   2359           jj=jmax-j+1
   2360           temp(1:imax)   =grid(1:imax,j)
   2361           grid(1:imax,j) =grid(1:imax,jj)
   2362           grid(1:imax,jj)=temp(1:imax)
   2363       enddo
   2364       return
   2365       end


ENTRY POINTS

  Name                  
                        
 cgblevn11_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBLEVN11                  Subr   2354                                                                                             
 GRID                       Dummy  2354     R(4)            4     2     0        ARG,INOUT        2360,2361,2362                    
 IMAX                       Dummy  2354     I(4)            4           scalar   ARG,INOUT        2355,2356,2360,2361,2362          
 J                          Local  2358     I(4)            4           scalar                    2358,2359,2360,2361               
 JJ                         Local  2359     I(4)            4           scalar                    2359,2361,2362                    
 JMAX                       Dummy  2354     I(4)            4           scalar   ARG,INOUT        2355,2358,2359                    
 TEMP                       Local  2356     R(4)            4     1     0                         2360,2362                         

Page 64          Source Listing                  CGBLEVN11
2017-04-18 11:09                                 gblevents_cdas.f

   2366 C####################
   2367 C####################
   2368 C####################
   2369 C####################
   2370 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
   2371 C                                                                  C
   2372 C ==============================================================   C
   2373 C | DESCRIPTION | NAME   | BITS | MAX VALUE  | DIMENSIONS      |   C
   2374 C |=============*========*======*============*=================|   C
   2375 C | ZSG01_C     | ZSG01_C| WORD | REAL       | 384,193         |   C
   2376 C |-------------+--------+------+------------+-----------------|   C
   2377 C | PSG01_C     | PSG01_C| WORD | REAL       | 384,193         |   C
   2378 C |-------------+--------+------+------------+-----------------|   C
   2379 C | TG01_C      | TG01_C | WORD | REAL       | 384,193,64      |   C
   2380 C |-------------+--------+------+------------+-----------------|   C
   2381 C | UG01_C      | UG01_C | WORD | REAL       | 384,193,64      |   C
   2382 C |-------------+--------+------+------------+-----------------|   C
   2383 C | VG01_C      | VG01_C | WORD | REAL       | 384,193,64      |   C
   2384 C |-------------+--------+------+------------+-----------------|   C
   2385 C | QG01_C      | QG01_C | WORD | REAL       | 384,193,64      |   C
   2386 C ==============^========^======^============^==================   C
   2387 C                                                                  C
   2388 C***********************************************************************
   2389 C***********************************************************************
   2390       FUNCTION ZSG01_C(I,J) ! FORMERLY FUNCTION ZS
   2391       PARAMETER (IM = 384)
   2392       PARAMETER (JM = 193)
   2393       COMMON /CGBEVJJ/IAR_8(IM,JM)
   2394       REAL(8) IAR_8
   2395       REAL ZSG01_C
   2396       ZSG01_C = IAR_8(I,J)
   2397       RETURN
   2398       END

Page 65          Source Listing                  ZSG01_C
2017-04-18 11:09 Entry Points                    gblevents_cdas.f



ENTRY POINTS

  Name                
                      
 zsg01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVJJ                    Common 2393                                 592896                                                      
 I                          Dummy  2390     I(4)            4           scalar   ARG,INOUT        2396                              
 IAR_8                      Scalar 2393     R(8)            8     2     74112    COM              2396                              
 IM                         Param  2391     I(4)            4           scalar                    2393                              
 J                          Dummy  2390     I(4)            4           scalar   ARG,INOUT        2396                              
 JM                         Param  2392     I(4)            4           scalar                    2393                              
 ZSG01_C                    Func   2390     R(4)            4           scalar                    2396                              
 ZSG01_C@0                  Local  2390     R(4)            4           scalar                                                      

Page 66          Source Listing                  ZSG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   2399 C***********************************************************************
   2400 C***********************************************************************
   2401       SUBROUTINE CGBLEVN12(I,J,V) ! FORMERLY SUBROUTINE ZSP
   2402       PARAMETER (IM = 384)
   2403       PARAMETER (JM = 193)
   2404       COMMON /CGBEVJJ/IAR_8(IM,JM)
   2405       REAL(8) IAR_8
   2406       REAL V
   2407       IAR_8(I,J) = V
   2408       RETURN
   2409       END


ENTRY POINTS

  Name                  
                        
 cgblevn12_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVJJ                    Common 2404                                 592896                                                      
 CGBLEVN12                  Subr   2401                                                                                             
 I                          Dummy  2401     I(4)            4           scalar   ARG,INOUT        2407                              
 IAR_8                      Scalar 2404     R(8)            8     2     74112    COM              2407                              
 IM                         Param  2402     I(4)            4           scalar                    2404                              
 J                          Dummy  2401     I(4)            4           scalar   ARG,INOUT        2407                              
 JM                         Param  2403     I(4)            4           scalar                    2404                              
 V                          Dummy  2401     R(4)            4           scalar   ARG,INOUT        2407                              

Page 67          Source Listing                  CGBLEVN12
2017-04-18 11:09                                 gblevents_cdas.f

   2410 C***********************************************************************
   2411 C***********************************************************************
   2412       FUNCTION PSG01_C(I,J) ! FORMERLY FUNCTION PS
   2413       PARAMETER (IM = 384)
   2414       PARAMETER (JM = 193)
   2415       COMMON /CGBEVKK/IAR_8(IM,JM)
   2416       REAL(8) IAR_8
   2417       REAL PSG01_C
   2418       PSG01_C = IAR_8(I,J)
   2419       RETURN
   2420       END


ENTRY POINTS

  Name                
                      
 psg01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVKK                    Common 2415                                 592896                                                      
 I                          Dummy  2412     I(4)            4           scalar   ARG,INOUT        2418                              
 IAR_8                      Scalar 2415     R(8)            8     2     74112    COM              2418                              
 IM                         Param  2413     I(4)            4           scalar                    2415                              
 J                          Dummy  2412     I(4)            4           scalar   ARG,INOUT        2418                              
 JM                         Param  2414     I(4)            4           scalar                    2415                              
 PSG01_C                    Func   2412     R(4)            4           scalar                    2418                              
 PSG01_C@0                  Local  2412     R(4)            4           scalar                                                      

Page 68          Source Listing                  PSG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   2421 C***********************************************************************
   2422 C***********************************************************************
   2423       SUBROUTINE CGBLEVN13(I,J,V) ! FORMERLY SUBROUTINE PSP
   2424       PARAMETER (IM = 384)
   2425       PARAMETER (JM = 193)
   2426       COMMON /CGBEVKK/IAR_8(IM,JM)
   2427       REAL(8) IAR_8
   2428       REAL V
   2429       IAR_8(I,J) = V
   2430       RETURN
   2431       END


ENTRY POINTS

  Name                  
                        
 cgblevn13_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVKK                    Common 2426                                 592896                                                      
 CGBLEVN13                  Subr   2423                                                                                             
 I                          Dummy  2423     I(4)            4           scalar   ARG,INOUT        2429                              
 IAR_8                      Scalar 2426     R(8)            8     2     74112    COM              2429                              
 IM                         Param  2424     I(4)            4           scalar                    2426                              
 J                          Dummy  2423     I(4)            4           scalar   ARG,INOUT        2429                              
 JM                         Param  2425     I(4)            4           scalar                    2426                              
 V                          Dummy  2423     R(4)            4           scalar   ARG,INOUT        2429                              

Page 69          Source Listing                  CGBLEVN13
2017-04-18 11:09                                 gblevents_cdas.f

   2432 C***********************************************************************
   2433 C***********************************************************************
   2434       FUNCTION TG01_C(I,J,K) ! FORMERLY FUNCTION T
   2435       PARAMETER (IM = 384)
   2436       PARAMETER (JM = 193)
   2437       PARAMETER (KM = 64)
   2438       COMMON /CGBEVLL/IAR_8(IM,JM,KM)
   2439       REAL(8) IAR_8
   2440       REAL TG01_C
   2441       TG01_C = IAR_8(I,J,K)
   2442       RETURN
   2443       END


ENTRY POINTS

  Name               
                     
 tg01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVLL                    Common 2438                                 37945344                                                    
 I                          Dummy  2434     I(4)            4           scalar   ARG,INOUT        2441                              
 IAR_8                      Scalar 2438     R(8)            8     3     4743168  COM              2441                              
 IM                         Param  2435     I(4)            4           scalar                    2438                              
 J                          Dummy  2434     I(4)            4           scalar   ARG,INOUT        2441                              
 JM                         Param  2436     I(4)            4           scalar                    2438                              
 K                          Dummy  2434     I(4)            4           scalar   ARG,INOUT        2441                              
 KM                         Param  2437     I(4)            4           scalar                    2438                              
 TG01_C                     Func   2434     R(4)            4           scalar                    2441                              
 TG01_C@0                   Local  2434     R(4)            4           scalar                                                      

Page 70          Source Listing                  TG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   2444 C***********************************************************************
   2445 C***********************************************************************
   2446       SUBROUTINE CGBLEVN14(I,J,K,V) ! FORMERLY SUBROUTINE TP
   2447       PARAMETER (IM = 384)
   2448       PARAMETER (JM = 193)
   2449       PARAMETER (KM = 64)
   2450       COMMON /CGBEVLL/IAR_8(IM,JM,KM)
   2451       REAL(8) IAR_8
   2452       REAL V
   2453       IAR_8(I,J,K) = V
   2454       RETURN
   2455       END


ENTRY POINTS

  Name                  
                        
 cgblevn14_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVLL                    Common 2450                                 37945344                                                    
 CGBLEVN14                  Subr   2446                                                                                             
 I                          Dummy  2446     I(4)            4           scalar   ARG,INOUT        2453                              
 IAR_8                      Scalar 2450     R(8)            8     3     4743168  COM              2453                              
 IM                         Param  2447     I(4)            4           scalar                    2450                              
 J                          Dummy  2446     I(4)            4           scalar   ARG,INOUT        2453                              
 JM                         Param  2448     I(4)            4           scalar                    2450                              
 K                          Dummy  2446     I(4)            4           scalar   ARG,INOUT        2453                              
 KM                         Param  2449     I(4)            4           scalar                    2450                              
 V                          Dummy  2446     R(4)            4           scalar   ARG,INOUT        2453                              

Page 71          Source Listing                  CGBLEVN14
2017-04-18 11:09                                 gblevents_cdas.f

   2456 C***********************************************************************
   2457 C***********************************************************************
   2458       FUNCTION UG01_C(I,J,K) ! FORMERLY FUNCTION U
   2459       PARAMETER (IM = 384)
   2460       PARAMETER (JM = 193)
   2461       PARAMETER (KM = 64)
   2462       COMMON /CGBEVMM/IAR_8(IM,JM,KM)
   2463       REAL(8) IAR_8
   2464       REAL UG01_C
   2465       UG01_C = IAR_8(I,J,K)
   2466       RETURN
   2467       END


ENTRY POINTS

  Name               
                     
 ug01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVMM                    Common 2462                                 37945344                                                    
 I                          Dummy  2458     I(4)            4           scalar   ARG,INOUT        2465                              
 IAR_8                      Scalar 2462     R(8)            8     3     4743168  COM              2465                              
 IM                         Param  2459     I(4)            4           scalar                    2462                              
 J                          Dummy  2458     I(4)            4           scalar   ARG,INOUT        2465                              
 JM                         Param  2460     I(4)            4           scalar                    2462                              
 K                          Dummy  2458     I(4)            4           scalar   ARG,INOUT        2465                              
 KM                         Param  2461     I(4)            4           scalar                    2462                              
 UG01_C                     Func   2458     R(4)            4           scalar                    2465                              
 UG01_C@0                   Local  2458     R(4)            4           scalar                                                      

Page 72          Source Listing                  UG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   2468 C***********************************************************************
   2469 C***********************************************************************
   2470       SUBROUTINE CGBLEVN15(I,J,K,V) ! FORMERLY SUBROUTINE UP
   2471       PARAMETER (IM = 384)
   2472       PARAMETER (JM = 193)
   2473       PARAMETER (KM = 64)
   2474       COMMON /CGBEVMM/IAR_8(IM,JM,KM)
   2475       REAL(8) IAR_8
   2476       REAL V
   2477       IAR_8(I,J,K) = V
   2478       RETURN
   2479       END


ENTRY POINTS

  Name                  
                        
 cgblevn15_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVMM                    Common 2474                                 37945344                                                    
 CGBLEVN15                  Subr   2470                                                                                             
 I                          Dummy  2470     I(4)            4           scalar   ARG,INOUT        2477                              
 IAR_8                      Scalar 2474     R(8)            8     3     4743168  COM              2477                              
 IM                         Param  2471     I(4)            4           scalar                    2474                              
 J                          Dummy  2470     I(4)            4           scalar   ARG,INOUT        2477                              
 JM                         Param  2472     I(4)            4           scalar                    2474                              
 K                          Dummy  2470     I(4)            4           scalar   ARG,INOUT        2477                              
 KM                         Param  2473     I(4)            4           scalar                    2474                              
 V                          Dummy  2470     R(4)            4           scalar   ARG,INOUT        2477                              

Page 73          Source Listing                  CGBLEVN15
2017-04-18 11:09                                 gblevents_cdas.f

   2480 C***********************************************************************
   2481 C***********************************************************************
   2482       FUNCTION VG01_C(I,J,K) ! FORMERLY FUNCTION V
   2483       PARAMETER (IM = 384)
   2484       PARAMETER (JM = 193)
   2485       PARAMETER (KM = 64)
   2486       COMMON /CGBEVNN/IAR_8(IM,JM,KM)
   2487       REAL(8) IAR_8
   2488       REAL VG01_C
   2489       VG01_C = IAR_8(I,J,K)
   2490       RETURN
   2491       END


ENTRY POINTS

  Name               
                     
 vg01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVNN                    Common 2486                                 37945344                                                    
 I                          Dummy  2482     I(4)            4           scalar   ARG,INOUT        2489                              
 IAR_8                      Scalar 2486     R(8)            8     3     4743168  COM              2489                              
 IM                         Param  2483     I(4)            4           scalar                    2486                              
 J                          Dummy  2482     I(4)            4           scalar   ARG,INOUT        2489                              
 JM                         Param  2484     I(4)            4           scalar                    2486                              
 K                          Dummy  2482     I(4)            4           scalar   ARG,INOUT        2489                              
 KM                         Param  2485     I(4)            4           scalar                    2486                              
 VG01_C                     Func   2482     R(4)            4           scalar                    2489                              
 VG01_C@0                   Local  2482     R(4)            4           scalar                                                      

Page 74          Source Listing                  VG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   2492 C***********************************************************************
   2493 C***********************************************************************
   2494       SUBROUTINE CGBLEVN16(I,J,K,V) ! FORMERLY SUBROUTINE VP
   2495       PARAMETER (IM = 384)
   2496       PARAMETER (JM = 193)
   2497       PARAMETER (KM = 64)
   2498       COMMON /CGBEVNN/IAR_8(IM,JM,KM)
   2499       REAL(8) IAR_8
   2500       REAL V
   2501       IAR_8(I,J,K) = V
   2502       RETURN
   2503       END


ENTRY POINTS

  Name                  
                        
 cgblevn16_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVNN                    Common 2498                                 37945344                                                    
 CGBLEVN16                  Subr   2494                                                                                             
 I                          Dummy  2494     I(4)            4           scalar   ARG,INOUT        2501                              
 IAR_8                      Scalar 2498     R(8)            8     3     4743168  COM              2501                              
 IM                         Param  2495     I(4)            4           scalar                    2498                              
 J                          Dummy  2494     I(4)            4           scalar   ARG,INOUT        2501                              
 JM                         Param  2496     I(4)            4           scalar                    2498                              
 K                          Dummy  2494     I(4)            4           scalar   ARG,INOUT        2501                              
 KM                         Param  2497     I(4)            4           scalar                    2498                              
 V                          Dummy  2494     R(4)            4           scalar   ARG,INOUT        2501                              

Page 75          Source Listing                  CGBLEVN16
2017-04-18 11:09                                 gblevents_cdas.f

   2504 C***********************************************************************
   2505 C***********************************************************************
   2506       FUNCTION QG01_C(I,J,K) ! FORMERLY FUNCTION Q
   2507       PARAMETER (IM = 384)
   2508       PARAMETER (JM = 193)
   2509       PARAMETER (KM = 64)
   2510       COMMON /CGBEVOO/IAR_8(IM,JM,KM)
   2511       REAL(8) IAR_8
   2512       REAL QG01_C
   2513       QG01_C = IAR_8(I,J,K)
   2514       RETURN
   2515       END


ENTRY POINTS

  Name               
                     
 qg01_c_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVOO                    Common 2510                                 37945344                                                    
 I                          Dummy  2506     I(4)            4           scalar   ARG,INOUT        2513                              
 IAR_8                      Scalar 2510     R(8)            8     3     4743168  COM              2513                              
 IM                         Param  2507     I(4)            4           scalar                    2510                              
 J                          Dummy  2506     I(4)            4           scalar   ARG,INOUT        2513                              
 JM                         Param  2508     I(4)            4           scalar                    2510                              
 K                          Dummy  2506     I(4)            4           scalar   ARG,INOUT        2513                              
 KM                         Param  2509     I(4)            4           scalar                    2510                              
 QG01_C                     Func   2506     R(4)            4           scalar                    2513                              
 QG01_C@0                   Local  2506     R(4)            4           scalar                                                      

Page 76          Source Listing                  QG01_C
2017-04-18 11:09                                 gblevents_cdas.f

   2516 C***********************************************************************
   2517 C***********************************************************************
   2518       SUBROUTINE CGBLEVN17(I,J,K,V) ! FORMERLY SUBROUTINE QP
   2519       PARAMETER (IM = 384)
   2520       PARAMETER (JM = 193)
   2521       PARAMETER (KM = 64)
   2522       COMMON /CGBEVOO/IAR_8(IM,JM,KM)
   2523       REAL(8) IAR_8
   2524       REAL V
   2525       IAR_8(I,J,K) = V
   2526       RETURN
   2527       END


ENTRY POINTS

  Name                  
                        
 cgblevn17_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVOO                    Common 2522                                 37945344                                                    
 CGBLEVN17                  Subr   2518                                                                                             
 I                          Dummy  2518     I(4)            4           scalar   ARG,INOUT        2525                              
 IAR_8                      Scalar 2522     R(8)            8     3     4743168  COM              2525                              
 IM                         Param  2519     I(4)            4           scalar                    2522                              
 J                          Dummy  2518     I(4)            4           scalar   ARG,INOUT        2525                              
 JM                         Param  2520     I(4)            4           scalar                    2522                              
 K                          Dummy  2518     I(4)            4           scalar   ARG,INOUT        2525                              
 KM                         Param  2521     I(4)            4           scalar                    2522                              
 V                          Dummy  2518     R(4)            4           scalar   ARG,INOUT        2525                              

Page 77          Source Listing                  CGBLEVN17
2017-04-18 11:09 Subprograms/Common Blocks       gblevents_cdas.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBEVAA                    Common 398                                  48988    SAVE                                               
 CGBEVAA                    Common 746                                  48988                                                       
 CGBEVAA                    Common 1290                                 48988                                                       
 CGBEVAA                    Common 1471                                 48988                                                       
 CGBEVAA                    Common 1802                                 48988                                                       
 CGBEVBB                    Common 400                                  8        SAVE                                               
 CGBEVBB                    Common 748                                  8                                                           
 CGBEVBB                    Common 1804                                 8                                                           
 CGBEVCC                    Common 401                                  36       SAVE                                               
 CGBEVCC                    Common 749                                  36                                                          
 CGBEVCC                    Common 1805                                 36                                                          
 CGBEVDD                    Common 403                                  237600   SAVE                                               
 CGBEVDD                    Common 704                                  237600                                                      
 CGBEVDD                    Common 1689                                 237600                                                      
 CGBEVEE                    Common 751                                  3608                                                        
 CGBEVEE                    Common 1294                                 3608                                                        
 CGBEVEE                    Common 1572                                 3608                                                        
 CGBEVFF                    Common 1292                                 832                                                         
 CGBEVFF                    Common 1519                                 832                                                         
 CGBEVFF                    Common 1570                                 832                                                         
 CGBEVFF                    Common 1955                                 832                                                         
 CGBEVFF                    Common 2183                                 832                                                         
 CGBEVGG                    Common 404                                  8        SAVE                                               
 CGBEVGG                    Common 754                                  8                                                           
 CGBEVGG                    Common 1297                                 8                                                           
 CGBEVGG                    Common 1473                                 8                                                           
 CGBEVGG                    Common 1690                                 8                                                           
 CGBEVGG                    Common 1807                                 8                                                           
 CGBEVHH                    Common 1957                                 28                                                          
 CGBEVHH                    Common 2185                                 28                                                          
 CGBEVJJ                    Common 2393                                 592896                                                      
 CGBEVJJ                    Common 2404                                 592896                                                      
 CGBEVKK                    Common 2415                                 592896                                                      
 CGBEVKK                    Common 2426                                 592896                                                      
 CGBEVLL                    Common 2438                                 37945344                                                    
 CGBEVLL                    Common 2450                                 37945344                                                    
 CGBEVMM                    Common 2462                                 37945344                                                    
 CGBEVMM                    Common 2474                                 37945344                                                    
 CGBEVNN                    Common 2486                                 37945344                                                    
 CGBEVNN                    Common 2498                                 37945344                                                    
 CGBEVOO                    Common 2510                                 37945344                                                    
 CGBEVOO                    Common 2522                                 37945344                                                    
 CGBLEVN01                  Subr   702                                                                                              
 CGBLEVN02                  Subr   733                                                                                              
 CGBLEVN03                  Subr   1284                                                                                             
 CGBLEVN04                  Subr   1466                                                                                             
 CGBLEVN05                  Subr   1517                                                                                             
 CGBLEVN06                  Subr   1566                                                                                             
 CGBLEVN08                  Subr   1792                                                                                             
 CGBLEVN09                  Subr   2178                                                                                             
 CGBLEVN10                  Subr   1953                                                                                             

Page 78          Source Listing                  CGBLEVN17
2017-04-18 11:09 Subprograms/Common Blocks       gblevents_cdas.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CGBLEVN11                  Subr   2354                                                                                             
 CGBLEVN12                  Subr   2401                                                                                             
 CGBLEVN13                  Subr   2423                                                                                             
 CGBLEVN14                  Subr   2446                                                                                             
 CGBLEVN15                  Subr   2470                                                                                             
 CGBLEVN16                  Subr   2494                                                                                             
 CGBLEVN17                  Subr   2518                                                                                             
 GBLEVENTS_CDAS             Subr   386                                                                                              
 OEFG01_C                   Func   1685     R(4)            4           scalar                    1692,1707,1710,1713,1715,1721     
 PSG01_C                    Func   2412     R(4)            4           scalar                    2418                              
 QG01_C                     Func   2506     R(4)            4           scalar                    2513                              
 TG01_C                     Func   2434     R(4)            4           scalar                    2441                              
 UG01_C                     Func   2458     R(4)            4           scalar                    2465                              
 VG01_C                     Func   2482     R(4)            4           scalar                    2489                              
 ZSG01_C                    Func   2390     R(4)            4           scalar                    2396                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape
       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600

Page 79          Source Listing                  CGBLEVN17
2017-04-18 11:09                                 gblevents_cdas.f

       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : gblevents_cdas.lst

Page 80          Source Listing                  CGBLEVN17
2017-04-18 11:09                                 gblevents_cdas.f

       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
