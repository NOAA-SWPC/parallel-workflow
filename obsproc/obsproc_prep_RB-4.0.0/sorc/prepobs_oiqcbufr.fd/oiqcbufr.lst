Page 1           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

      1 C$$$  MAIN PROGRAM DOCUMENTATION BLOCK
      2 C
      3 C MAIN PROGRAM:  PREPOBS_OIQCBUFR
      4 C   PRGMMR: WOOLLEN/KEYSER   ORG: NP20        DATE: 2013-06-19
      5 C
      6 C ABSTRACT: QUALITY CONTROLS OBSERVATIONS TO BE USED IN THE GLOBAL
      7 C   ANALYSIS-FORECAST SYSTEM. OBSERVATIONAL DATASET GENERATED BY
      8 C   THE GESTEMP PREPROCESSOR IS INPUT TO OIQC WHICH THEN PERFORMS
      9 C   A "COMPLEX" QUALITY CONTROL (FROM GANDIN,1985) EMPLOYING
     10 C   MULTIVARIATE OI TO CHECK ALL OBSERVATIONS AGAINST NEARBY
     11 C   NEIGHBORS. SEVERAL ITERATIONS OF THE BASIC SCHEME ARE REQUIRED
     12 C   TO COMPLETE THE PROCESS. DURING EACH ITERATION ALL OBSERVATIONS
     13 C   ARE SUBJETED TO FIVE INTERPOLATION CHECKS. CHECK #1 INTERPOLATES
     14 C   COMPARISON VALUES FROM NEARBY TEMPERATURE DATA. CHECK #2 AND CHECK
     15 C   #3 INTERPOLATE COMPARISON VALUES FROM NEARBY ZONAL AND LONGITUDINAL
     16 C   WIND COMPONENTS RESPECTIVELY. CHECK #4 IS AN INTERPOLATION
     17 C   FROM THE NEAREST OBS IN THE SAME PROFILE AS THE ONE BEING CHECKED.
     18 C   A WEIGHTED COMBINATION OF THE OUTCOME OF THESE FOUR CHECKS IS
     19 C   PRODUCED ON THE BASIS OF FACTORS WHICH DETERMINE WHICH
     20 C   OF THE INTERPOLATIONS (IF ANY) MIGHT BE EXPECTED TO BE MORE
     21 C   RELEVANT THAN THE OTHERS; FOR EXAMPLE THE NUMBER AND LOCATION
     22 C   IN SPACE AND TIME OF OBSERVATIONS USED IN A GIVEN CHECK
     23 C   AS WELL AS RELATIVE QUALITY OF THE OBSERVATIONS INVOLVED IS USED TO
     24 C   INDICATE WHICH OF THE OUTCOMES SHOULD BE RELIED MORE HEAVILY UPON
     25 C   TO MAKE A DECISION IN A PARTICULAR CASE. CHECK #5 INTERPOLATES
     26 C   A VALUE FROM THE MULTIVARIATE SET OF OBS USED IN CHECKS #1-#3,
     27 C   WHICH IS USED TO MEASURE HOW THE ANALYSIS WOULD DRAW (OR NOT DRAW)
     28 C   TO THE OB BEING CHECKED. THE TOLERANCE ALLOWED FOR DEVIATION FROM
     29 C   THE EXPECTED OUTCOME OF THE INTERPOLATION CHECKS IS PROPORTIONAL
     30 C   TO A MEASURE OF THE DRAW COMPUTED USING THE RESULT OF CHECK #5.
     31 C   DURING EACH ITERATION EACH OBSEVATION EITHER PASSES OR FAILS THE
     32 C   COMPLEX OF CHECKS JUST DESCRIBED. A "PASS" MEANS THAT OB MAY BE
     33 C   USED FOR CHECKING OBS DURING THE SUBSEQUENT ITERATION. A "FAIL"
     34 C   INDICATES THE OPPOSITE. THE SYSTEM IS ITERATED UNTIL IDENTICAL
     35 C   RESULTS IN TERMS OF OBS THAT PASS AND FAIL ARE OBTAINED IN TWO
     36 C   CONSEQUETIVE ITERATIONS UP TO FOUR COMPLETE ITERATIONS AT WHICH
     37 C   POINT A FINAL ARBITRATION PROCEDURE IS INVOKED TO RESOLVE A (SMALL)
     38 C   NUMBER OF AMBIGUOUS CASES WHICH ARE PREVENTING CONVERGENCE OF THE
     39 C   SYSTEM.
     40 C
     41 C PROGRAM HISTORY LOG:
     42 C 1990-11-06  J. WOOLLEN  ORIGINAL VERSION FOR IMPLEMENTATION
     43 C 1990-04-23  J. WOOLLEN  VERSION FOR IMPLEMENTATION W/ SPECTRAL OI
     44 C 1998-09-25  J. WOOLLEN  Y2K VERSION & RETURN CODE 4 FOR TOO MUCH DATA
     45 C 1999-09-27  J. WOOLLEN  IBM-SP MPI/OMP VERSION IMPLEMENTED
     46 C 1999-12-21  J. WOOLLEN  FIX FOR RECEIVE PROBLEM WITH TOO MUCH DATA
     47 C 2004-09-09  D. KEYSER   CHANGE CALL FROM BUFRLIB ROUTINE BORT TO
     48 C         W3LIB ROUTINE ERREXIT; BUMPED UP MAXREP FROM 200K TO 300K
     49 C         (AND ALL ASSOC. ARRAYS), BUMPED UP MAXLEV FROM 300K TO 400K
     50 C         (AND ALL ASSOC. ARRAYS) - NEEDED TO HANDLE METAR RPTS IN R.
     51 C         TYPE 187; IMPROVED DOCBLOCKS
     52 C 2006-06-06  D. KEYSER   BUMPED UP MAXREP FROM 300K TO 600K (AND ALL
     53 C         ASSOC. ARRAYS), BUMPED UP MAXLEV FROM 400K TO 800K (AND ALL
     54 C         ASSOC. ARRAYS) - NEEDED TO HANDLE WINDSAT RPTS IN R. TYPE
     55 C         289
     56 C 2007-04-23  D. KEYSER   BUMPED UP MAXREP FROM 600K TO 900K (AND ALL
     57 C         ASSOC. ARRAYS), BUMPED UP MAXLEV FROM 800K TO 1100K (AND ALL

Page 2           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

     58 C         ASSOC. ARRAYS) - NEEDED TO HANDLE WINDSAT RPTS IN R. TYPE
     59 C         289
     60 C 2007-04-23  J. WOOLLEN  FIX IN SUBR NDDSPLIT TO AVOID LOAD BALANCING
     61 C         ERROR MADE IN UNUSUAL SITUATIONS WITH SMALL AMOUNTS OF DATA
     62 C 2012-08-31  J. WOOLLEN  FIX IN SUBR SEARCHS AND FCN LTX TO AVOID
     63 C         ARRAY OVERFLOW IN IMAP FOR CERTAIN LAT/LON VALUES
     64 C 2012-11-20  J. WOOLLEN  INITIAL PORT TO WCOSS: REMOVE ALL THREADING
     65 C         SO CODE BECOMES STRICTLY MPI FOR SIMPLER AND BETTER LOAD
     66 C         BALANCING
     67 C 2013-03-26  J. WOOLLEN  FIX IN SUBR. PREPQM ADDRESSING ALIGNMENT
     68 C         PROBLEM WHEN THE LAST BUFR MESSAGE CONTAINS NO DATA WHICH IS
     69 C         OIQC PROCESSED
     70 C 2013-03-26  D. KEYSER   FINAL CHANGES TO RUN ON WCOSS
     71 C 2013-06-19  J. WOOLLEN  FIX SUBR. SYNCNDD TO PREVENT HANGUP IN
     72 C         RECEIVE BY A PROCESSOR WHEN THERE IS VERY LITTLE DATA OF A
     73 C         CERTAIN TYPE
     74 C
     75 C USAGE:
     76 C   INPUT FILES:
     77 C     UNIT 11  - NCEP PRODUCTION DATE FILE
     78 C     UNIT 14  - OBSERVATION (PREPBUFR) PRIOR TO UPDATED QUALITY MARKS
     79 C     UNIT 17  - OBSERVATION ERROR TABLE FILE SPECIFIC TO THIS PROGRAM
     80 C                (THIS IS NOT THE ANALYSIS OBSERVATION ERROR FILE -
     81 C                 THOSE DATA ARE READ FROM THE PREPBUFR FILE)
     82 C     UNIT 18  - LIST OF IPOINTS FOR DETAILED PRINT IN UNITS 71-80
     83 C     UNIT 20  - TOLERANCE LEVELS (FOR EXPERIMENTATION)
     84 C
     85 C   OUTPUT FILES:
     86 C     UNIT 06  - STANDARD OUTPUT PRINT
     87 C     UNIT 61  - DETAILED TOSSLIST FOR SURFACE HEIGHTS
     88 C     UNIT 62  - DETAILED TOSSLIST FOR TEMPS AND WINDS
     89 C     UNIT 63  - DETAILED TOSSLIST FOR SAT TEMPS
     90 C     UNIT 64  - DETAILED TOSSLIST FOR SSMI WIND SPEEDS
     91 C     UNIT 65  - OFFICIAL OPERATIONAL TOSSLIST
     92 C     UNIT 70  - OBSERVATION (PREPBUFR) FILE WITH UPDATED QUALITY MARKS
     93 C     UNIT 71  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
     94 C     UNIT 72  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
     95 C     UNIT 73  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
     96 C     UNIT 74  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
     97 C     UNIT 75  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
     98 C     UNIT 76  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
     99 C     UNIT 77  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
    100 C     UNIT 78  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
    101 C     UNIT 79  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
    102 C     UNIT 80  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
    103 C     UNIT 81  - SUMMARY OF QC RESULTS (ASCII)
    104 C     UNIT 82  - SUMMARY OF QC RESULTS (BINARY)
    105 C
    106 C   SUBPROGRAMS CALLED:   (*AUTOTASKED)
    107 C     UNIQUE:    - SETCON   RDOBER   STORE    STOERR   *COOR2
    108 C                  MAKEAMAP SEARCH   CHDIST   QCLOOP   QCPTS
    109 C                  SATPTS   *SELDAT  *QCOI    *COOR1   *DRCTSL
    110 C                  *VSOLVE  *OUTPUT  *SATPUT  OBOGRAM  TOSSLIST
    111 C                  PREPQM   SYNCSTOR MPISPLIT SSMIPUT  SRTPRS
    112 C                  SEARCHS  SSMIPTS  SYNCNDD
    113 C     LIBRARY:
    114 C       MPI      - MPI_BCST MPI_RECV MPI_SEND MPI_INIT

Page 3           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

    115 C                  MPI_COMM_RANK     MPI_COMM_SIZE
    116 C                  MPI_FINALIZE
    117 C       MASS     - VSCOS
    118 C       W3NCO    - W3TAGB   W3TAGE   ERREXIT
    119 C       BUFRLIB  - DATEBF   CLOSBF   UFBCPY   OPENMB   IREADMM
    120 C                  OPENBF   UFBQCD   UFBINT   WRITSB   UFBCNT
    121 C                  CLOSMG   COPYMG   ICOPYSB  UFBMEM   IREADSB
    122 C                  READMM
    123 C
    124 C   EXIT STATES:
    125 C     COND =   0 - SUCCESSFUL RUN
    126 C     COND =   4 - TOO MUCH DATA, NOT ALL WAS CHECKED - NORMAL
    127 C                  TERMINATION
    128 C     COND =  99 - DISASTOROUS PROBLEM SITUATION DETECTED - ABNORMAL
    129 C                  TERMINATION
    130 C
    131 C
    132 C REMARKS: NONE.
    133 C
    134 C ATTRIBUTES:
    135 C   LANGUAGE: FORTRAN 90
    136 C   MACHINE:  NCEP WCOSS
    137 C
    138 C$$$
    139 C-----------------------------------------------------------------------
    140 CTREE GETFCER
    141 CTREE PILNLNP
    142 CTREE SATPTS
    143 CTREE SATPUT
    144 C-----------------------------------------------------------------------
    145       PROGRAM PREPOBS_OIQCBUFR
    146 
    147       PARAMETER (MAXREP=900000)
    148       PARAMETER (MAXLEV=1100000)
    149 
    150       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
    151      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
    152      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
    153      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
    154      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
    155      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
    156      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
    157      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
    158       CHARACTER*3 FOC
    159 
    160       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
    161       COMMON /CKLIST  / NDD,INDD(MAXLEV)
    162       COMMON /TOSSUNIT/ ITUNIT
    163       COMMON /RETCODE/ IRETCODE
    164       REAL*8 SID
    165 
    166       EXTERNAL          QCPTS,SATPTS
    167 
    168       DATA LUDAT /11/
    169       DATA LUBFI /14/
    170       DATA LUQCE /17/
    171       DATA LUBFQ /70/

Page 4           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

    172       DATA ITERS /6/
    173 
    174       include "mpif.h"
    175 
    176 C-----------------------------------------------------------------------
    693       IRETCODE = 0
    694 C-----------------------------------------------------------------------
    695 C  UNIFIED QC ANALYSIS SETUP PROCEDURE IS AS FOLLOWS:
    696 C  -------------------------------------------------
    697 C    -1) IRETCODE - INITIALLY 0, MAY BE CHANGED TO 4 IF TOO MUCH DATA
    698 C     0) W3TAGB   - WRITE AN OPERATIONS START MESSAGE
    699 C     1) SETCON   - SET CONSTANTS AND PARAMETERS
    700 C     2) STORE    - READ IN FERR (OB/INCREMENT) FILE AND STORE IT
    701 C     3) RDOBER   - READ IN THE OBSERVATION ERRORS
    702 C     4) STOERR   - STORE THE OB AND FC ERRORS WITH EACH REPORT LEVEL
    703 C     5) MAKEAMAP - MAKE AN OB POINTER LIST SORTED BY LAT-LON
    704 C-----------------------------------------------------------------------
    705 
    706 
    707       call mpi_init(ierr)
    708       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
    709       call mpi_comm_size(MPI_COMM_WORLD,nprc,ierr)
    710       if(myid.eq.0) then
    711       print*
    712       print*,'nprocs = ',nprc
    713       print*
    714       CALL W3TAGB('PREPOBS_OIQCBUFR',2013,0170,0088,'NP22')
    715       print*
    716       print*
    717       print*, '--> WELCOME TO PREPOBS_OIQCBUFR - VERSION 06-19-2013'
    718       print*
    719       print*
    720       endif
    721 
    722       CALL SETCON
    723       CALL STORE(LUDAT,LUBFI)
    724       CALL RDOBER (LUQCE)
    725       CALL STOERR
    726       CALL MAKEAMAP
    727 
    728 C  OIQC CHECKS OF SURFACE HEIGHT/PRESSURE DATA
    729 C  -------------------------------------------
    730 
    731       NDD = 0
    732 
    733       DO IREP=1,NREP
    734       USEFLG = ABS(FQL(IREP))
    735       FQL(IREP) = -USEFLG
    736       IF(FOC(IREP).EQ.'SFC') THEN
    737          FNL(IREP) = 1
    738          ILEV      = FLV(IREP)+1
    739          IF(FOE(ILEV).GT.0.) THEN
    740             NDD       = NDD+1
    741             INDD(NDD) = ILEV
    742             FQL(IREP) = USEFLG
    743             FLV(IREP) = ILEV
    744          ENDIF

Page 5           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

    745       ENDIF
    746       ENDDO
    747 
    748       IF(NDD.GT.0) THEN
    749          if(myid.eq.0) then
    750             WRITE(6 ,*)' CHECKING SURFACE HEIGHT DATA ',NDD,' OBS'
    751          endif
    752          ITUNIT = 61
    753          CALL SEARCH          
    754          CALL QCLOOP(QCPTS,ITERS)
    755          DO N=1,NDD
    756          IREP = FHD(INDD(N))
    757          FLV(IREP) = INDD(N)-1
    758          ENDDO
    759       ENDIF
    760 
    761 C  OIQC CHECKS OF UPA AND SFC TEMP AND WIND DATA
    762 C  -------------------------------------------
    763 
    764       NDD = 0
    765 
    766       DO IREP=1,NREP
    767       USEFLG = ABS(FQL(IREP))
    768       FQL(IREP) = -USEFLG
    769       IF(FOC(IREP).EQ.'UPA' .OR. FOC(IREP).EQ.'SFC') THEN
    770          FQL(IREP) = USEFLG
    771          ILEV  = FLV(IREP)
    772          KLEV  = ILEV+FNL(IREP)-1
    773          DO JLEV=ILEV,KLEV
    774          IF(FOE(JLEV).GT.0.) THEN
    775             NDD = NDD+1
    776             INDD(NDD) = JLEV
    777          ENDIF
    778          ENDDO
    779       ENDIF
    780       ENDDO
    781 
    782       IF(NDD.GT.0) THEN
    783          if(myid.eq.0) then
    784             WRITE(6 ,*)' CHECKING TEMP AND WIND DATA ',NDD,' OBS'
    785          endif
    786          ITUNIT = 62
    787          CALL SEARCH             
    788          CALL QCLOOP(QCPTS,ITERS) 
    789       ENDIF
    790 
    791 C  OIQC CHECKS OF SATEM DATA
    792 C  -------------------------
    793 
    794       NDD = 0
    795 
    796       DO IREP=1,NREP
    797       USEFLG = ABS(FQL(IREP))
    798       IF(FOC(IREP).EQ.'SAT') THEN
    799          FQL(IREP) = 1.
    800          ILEV  = FLV(IREP)
    801          KLEV  = ILEV+FNL(IREP)-1

Page 6           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

    802          DO JLEV=ILEV,KLEV
    803          IF(FOE(JLEV).GT.0.) THEN
    804             NDD = NDD+1
    805             INDD(NDD) = JLEV
    806          ENDIF
    807          ENDDO
    808       ELSE
    809          FQL(IREP) = -USEFLG
    810       ENDIF
    811       ENDDO
    812 
    813       IF(NDD.GT.0) THEN
    814          if(myid.eq.0) then
    815             WRITE(6 ,*)' CHECKING SAT TEMP DATA ',NDD,' OBS'
    816          endif
    817          ITUNIT = 63
    818          CALL SEARCH
    819          CALL QCLOOP(SATPTS,1)
    820       ENDIF
    821 
    822 C  DIRECTION ASSIGNMENT AND OIQC CHECKS FOR SSMI DATA
    823 C  --------------------------------------------------
    824 
    825       NDD = 0
    826 
    827       DO IREP=1,NREP
    828       USEFLG = ABS(FQL(IREP))
    829       IF(FOC(IREP).EQ.'SMI') THEN
    830          ILEV  = FLV(IREP)
    831          IF(FOE(ILEV).GT.0.) THEN
    832             NDD = NDD+1
    833             INDD(NDD) = ILEV
    834             FQL(IREP) = USEFLG
    835          ENDIF
    836       ELSE IF(FOC(IREP).EQ.'SAT') THEN
    837          FQL(IREP) = -USEFLG
    838       ELSE
    839          FQL(IREP) = 0.
    840       ENDIF
    841       ENDDO
    842 
    843       IF(NDD.GT.0) THEN
    844          if(myid.eq.0) then
    845             WRITE(6 ,*)' CHECKING SSMI DATA ',NDD,' OBS'
    846          endif
    847          ITUNIT = 64
    848          CALL SSMIPTS
    849          call syncndd(fob(1,1),nlev,mpi_real)
    850          call syncndd(fob(1,2),nlev,mpi_real)
    851          CALL SEARCH
    852          CALL QCLOOP(QCPTS,ITERS)
    853       ENDIF
    854 
    855 C  COMPUTE STATISTICS, WRITE LISTS, UPDATE QUALITY MARKS
    856 C  -----------------------------------------------------
    857 
    858       call mpi_barrier(mpi_comm_world,ier)

Page 7           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

    859       if(myid.eq.0) then
    860          CALL OBOGRAM  (11,81,82)
    861          CALL TOSSLIST (65)
    862          CALL PREPQM   (LUBFI,LUBFQ)
    863          CALL W3TAGE('PREPOBS_OIQCBUFR')
    864       endif
    865 
    866 C  TIE IT TOGETHER AND END UP
    867 C  --------------------------
    868 
    869       call mpi_finalize(mret)
    870       IF(IRETCODE.NE.0) THEN
    871          CALL ERREXIT(IRETCODE)
    872       ELSE
    873          STOP
    874       ENDIF
    875 
    876       END


ENTRY POINTS

  Name              
                    
 MAIN__             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   218                                  scalar                    218,251,281,312                   
 CKLIST                     Common 161                                  4400004                                                     
 ERREXIT                    Subr   355                                                            355                               
 FFE                        Scalar 156      R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 153      R(4)            4     1     1100000  COM              240                               
 FKX                        Scalar 151      R(4)            4     1     900000   COM                                                
 FLN                        Scalar 151      R(4)            4     1     900000   COM                                                
 FLT                        Scalar 150      R(4)            4     1     900000   COM                                                
 FLV                        Scalar 150      R(4)            4     1     900000   COM              222,227,241,255,284,314           
 FMS                        Scalar 152      R(4)            4     1     900000   COM                                                
 FMW                        Scalar 152      R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 152      R(4)            4     1     900000   COM              221,256,285                       
 FOB                        Scalar 155      R(4)            4     2     2200000  COM              333,334                           
 FOC                        Scalar 157      CHAR            3     1     900000   COM              220,253,282,313,320               
 FOE                        Scalar 156      R(4)            4     1     1100000  COM              223,258,287,315                   
 FOI                        Scalar 155      R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 157      R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 154      R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 154      R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 154      R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 153      R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 153      R(4)            4     1     900000   COM              218,219,226,251,252,254,281,283,29
                                                                                                  3,312,318,321,323                 
 FQM                        Scalar 155      R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 151      R(4)            4     1     900000   COM                                                
 FTW                        Scalar 157      R(4)            4     3     22000000 COM                                                

Page 8           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FTZ                        Scalar 156      R(4)            4     1     1100000  COM                                                
 IER                        Local  342      I(4)            4           scalar                    342                               
 IERR                       Local  191      I(4)            4           scalar                    191,192,193                       
 ILEV                       Local  222      I(4)            4           scalar                    222,223,225,227,255,256,257,284,28
                                                                                                  5,286,314,315,317                 
 IMAP                       Scalar 160      I(4)            4     2     65160    COM                                                
 INDD                       Scalar 161      I(4)            4     1     1100000  COM              225,240,241,260,289,317           
 INOB                       Scalar 160      I(4)            4     1     900000   COM                                                
 IREP                       Local  217      I(4)            4           scalar                    217,218,219,220,221,222,226,227,24
                                                                                                  0,241,250,251,252,253,254,255,256,
                                                                                                  280,281,282,283,284,285,293,311,31
                                                                                                  2,313,314,318,320,321,323         
 IRETCODE                   Scalar 163      I(4)            4           scalar   COM              177,354,355                       
 ITERS                      Local  172      I(4)            4           scalar                    172,238,272,336                   
 ITUNIT                     Scalar 162      I(4)            4           scalar   COM              236,270,301,331                   
 JLEV                       Local  257      I(4)            4           scalar                    257,258,260,286,287,289           
 KLEV                       Local  256      I(4)            4           scalar                    256,257,285,286                   
 LUBFI                      Local  169      I(4)            4           scalar                    169,207,346                       
 LUBFQ                      Local  171      I(4)            4           scalar                    171,346                           
 LUDAT                      Local  168      I(4)            4           scalar                    168,207                           
 LUQCE                      Local  170      I(4)            4           scalar                    170,208                           
 MAKEAMAP                   Subr   210                                                            210                               
 MAXLEV                     Param  148      I(4)            4           scalar                    153,154,155,156,157,161           
 MAXREP                     Param  147      I(4)            4           scalar                    150,151,152,153,157,160           
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BARRIER                Subr   342                                                            342                               
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      

Page 9           Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   192                                                            192                               
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   193                                                            193                               
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    192,193,342                       
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      

Page 10          Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      

Page 11          Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FINALIZE               Subr   353                                                            353                               
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INIT                   Subr   191                                                            191                               
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      

Page 12          Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                    333,334                           
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      

Page 13          Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MRET                       Local  353      I(4)            4           scalar                    353                               
 MYID                       Local  192      I(4)            4           scalar                    192,194,233,267,298,328,343       
 N                          Local  239      I(4)            4           scalar                    239,240,241                       
 NDD                        Scalar 161      I(4)            4           scalar   COM              215,224,225,232,234,239,248,259,26
                                                                                                  0,266,268,278,288,289,297,299,309,
                                                                                                  316,317,327,329                   
 NLEV                       Scalar 160      I(4)            4           scalar   COM              333,334                           
 NPRC                       Local  193      I(4)            4           scalar                    193,196                           
 NREP                       Scalar 160      I(4)            4           scalar   COM              217,250,280,311                   
 OBOGRAM                    Subr   344                                                            344                               
 OBS                        Common 160                                  11060648                                                    
 OIQCDATA                   Common 150                                  22790000                                                    
                                                                        0                                                           
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 PREPOBS_OIQCBUFR           Prog   145                                                                                              
 PREPQM                     Subr   346                                                            346                               
 QCLOOP                     Subr   238                                                            238,272,303,336                   
 QCPTS                      Subr   166                                  scalar                    238,272,336                       
 RDOBER                     Subr   208                                                            208                               
 RETCODE                    Common 163                                  4                                                           

Page 14          Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SATPTS                     Subr   166                                  scalar                    303                               
 SEARCH                     Subr   237                                                            237,271,302,335                   
 SETCON                     Subr   206                                                            206                               
 SID                        Scalar 160      R(8)            8     1     900000   COM                                                
 SSMIPTS                    Subr   332                                                            332                               
 STOERR                     Subr   209                                                            209                               
 STORE                      Subr   207                                                            207                               
 SYNCNDD                    Subr   333                                                            333,334                           
 TOSSLIST                   Subr   345                                                            345                               
 TOSSUNIT                   Common 162                                  4                                                           
 USEFLG                     Local  218      R(4)            4           scalar                    218,219,226,251,252,254,281,293,31
                                                                                                  2,318,321                         
 W3TAGB                     Subr   198                                                            198                               
 W3TAGE                     Subr   347                                                            347                               

Page 15          Source Listing                  PREPOBS_OIQCBUFR
2017-04-18 11:07                                 oiqcbufr.f

    877 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    878 C
    879 C SUBPROGRAM:    CHDIST
    880 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
    881 C
    882 C ABSTRACT: COMPUTES CHORD LENGTH DISTANCE FROM A FIXED POINT TO AN
    883 C   ARRAY OF POINTS USING THE FORMULA:
    884 C     S**2/2 = 1 - COS(Y1-Y2) + COS(Y1)*COS(Y2)*(1-COS(X1-X2)).
    885 C   ALSO THE DIRECTION OF EACH POINT IS COMPUTED WITH RESPECT TO THE
    886 C   FIXED POINT AND RETURNED AS WELL.
    887 C
    888 C PROGRAM HISTORY LOG:
    889 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
    890 C
    891 C USAGE:    CALL CHDIST(X1,Y1,X2,Y2,DIST,DIRN,NIND,NP)
    892 C   INPUT ARGUMENT LIST:
    893 C     X1       - X-COORDINATE  (LONGITUDE) OF FIXED POINT
    894 C     Y1       - Y-COORDINATE  (LATITUDE ) OF FIXED POINT
    895 C     X2       - X-COORDINATES (LONGITUDE) FOR SET OF POINTS
    896 C     Y2       - Y-COORDINATES (LATITUDE ) FOR SET OF POINTS
    897 C     NP       - NUMBER OF OUTPUTS REQUESTED
    898 C
    899 C   OUTPUT ARGUMENT LIST:
    900 C     DIST     - CHORD LENGTH DISTANCES FROM FIXED POINT (KM)
    901 C     DIRN     - DIRECTION FROM FIXED POINT (DEG)
    902 C
    903 C REMARKS: NONE.
    904 C
    905 C
    906 C ATTRIBUTES:
    907 C   LANGUAGE: FORTRAN 90
    908 C   MACHINE:  NCEP WCOSS
    909 C
    910 C$$$
    911       SUBROUTINE CHDIST(X1,Y1,X2,Y2,DIST,DIRN,NIND,NP)
    912 
    913       DIMENSION  X2(NP),Y2(NP),DIST(NP),DIRN(NP),NIND(NP)
    914       dimension  cosy2(np),cosdx(np),cosdy(np)
    915 
    916       DATA PI180/.0174532 /,RADE/6371./
    917       SAVE PI180,RADE
    918 
    919 C----------------------------------------------------------------------
    920       !itab(x) = nint(mod(x+360.,360.)*100.)
    921 C----------------------------------------------------------------------
    922 
    923       IF(NP.EQ.0) RETURN
    924 
    925 C  COMPUTE THE DISTANCE
    926 C  --------------------
    927 
    928       COSY1 = cos(y1*pi180) 
    929       do i=1,np
    930       cosy2(i) = cos(y2(i)*pi180)
    931       cosdx(i) = cos((x1-x2(i))*pi180)
    932       cosdy(i) = cos((y1-y2(i))*pi180)
    933       enddo

Page 16          Source Listing                  CHDIST
2017-04-18 11:07                                 oiqcbufr.f

    934 
    935       !call vscos(cosy2,cosy2,np)
    936       !call vscos(cosdx,cosdx,np)
    937       !call vscos(cosdy,cosdy,np)
    938 
    939       DO I=1,NP
    940       S = 1.0-COSDY(I)+COSY1*COSY2(I)*(1.0-COSDX(I))
    941       S = SQRT(2.*S)
    942       IF(S.LE..002) S = 0.
    943       DIST(I) = S*RADE
    944       ENDDO       
    945 
    946 C  COMPUTE DIRECTIONS
    947 C  ------------------
    948 
    949       DO I=1,NP
    950       DX = (X2(I)-X1)*COSY1
    951       DY = (Y2(I)-Y1)
    952       IF(DX.GT.0.) THEN
    953          DIRN(I) = 0. + ATAN(DY/DX)/PI180
    954       ELSE IF(DX.LT.0.) THEN
    955          DIRN(I) = 180. + ATAN(DY/DX)/PI180
    956       ELSE IF(DX.EQ.0.) THEN
    957          DIRN(I) = SIGN(90.,DY)
    958       ENDIF
    959       IF(DIRN(I).LT.0.) DIRN(I) = DIRN(I) + 360.
    960       ENDDO
    961 
    962       RETURN
    963       END

Page 17          Source Listing                  CHDIST
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name               
                     
 chdist_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ATAN                       Func   437                                  scalar                    437,439                           
 CHDIST                     Subr   395                                                                                              
 COS                        Func   412                                  scalar                    412,414,415,416                   
 COSDX                      Local  398      R(4)            4     1     0                         415,424                           
 COSDY                      Local  398      R(4)            4     1     0                         416,424                           
 COSY1                      Local  412      R(4)            4           scalar                    412,424,434                       
 COSY2                      Local  398      R(4)            4     1     0                         414,424                           
 DIRN                       Dummy  395      R(4)            4     1     0        ARG,INOUT        437,439,441,443                   
 DIST                       Dummy  395      R(4)            4     1     0        ARG,INOUT        427                               
 DX                         Local  434      R(4)            4           scalar                    434,436,437,438,439,440           
 DY                         Local  435      R(4)            4           scalar                    435,437,439,441                   
 I                          Local  413      I(4)            4           scalar                    413,414,415,416,423,424,427,433,43
                                                                                                  4,435,437,439,441,443             
 NIND                       Dummy  395      I(4)            4     1     0        ARG,INOUT                                          
 NP                         Dummy  395      I(4)            4           scalar   ARG,INOUT        397,398,407,413,423,433           
 PI180                      Local  401      R(4)            4           scalar   SAVE             400,412,414,415,416,437,439       
 RADE                       Local  401      R(4)            4           scalar   SAVE             400,427                           
 S                          Local  424      R(4)            4           scalar                    424,425,426,427                   
 SIGN                       Func   441                                  scalar                    441                               
 SQRT                       Func   425                                  scalar                    425                               
 X1                         Dummy  395      R(4)            4           scalar   ARG,INOUT        415,434                           
 X2                         Dummy  395      R(4)            4     1     0        ARG,INOUT        415,434                           
 Y1                         Dummy  395      R(4)            4           scalar   ARG,INOUT        412,416,435                       
 Y2                         Dummy  395      R(4)            4     1     0        ARG,INOUT        414,416,435                       

Page 18          Source Listing                  CHDIST
2017-04-18 11:07                                 oiqcbufr.f

    964 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    965 C
    966 C SUBPROGRAM:    COOR1
    967 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
    968 C
    969 C ABSTRACT: COMPUTES CHORD LENGTH DISTANCE FOR A MATRIX OF LOCATIONS
    970 C   <(X,Y)I,(X,Y)J> USING THE NORMAL ANGLE  FORMULA:
    971 C     S**2/2 = 1 - COS(Y1-Y2) + COS(Y1)*COS(Y2)*(1-COS(X1-X2))
    972 C   DERIVATIVES OF DISTANCE WITH RESPECT TO LAT AND LON ARE ALSO
    973 C   COMPUTED AND COMBINED WITH APPROPRIATE CORRELATION FUNCTIONS AND
    974 C   DERIVATIVES WITH RESPECT TO DISTANCE TO FORM THE MULTI-VARIATE
    975 C   CORRELATIONS FOR THE HEIGHT WIND ANALYSIS.
    976 C
    977 C PROGRAM HISTORY LOG:
    978 C 1990-11-06  J. WOOLLEN - ORINGIAL AUTHOR
    979 C
    980 C USAGE:    CALL COOR1(NP,CH,FL,TZ,X1,Y1,K1,X2,Y2,K2,D,C1,C2)
    981 C   INPUT ARGUMENT LIST:
    982 C     NP       - NUMBER OF OUTPUTS REQUESTED
    983 C     CH       - VECTOR OF CONSTANTS FOR THE GAUSSIAN LENGTH SCALE
    984 C     X1       - X-COORDINATES (LONGITUDE) FOR POINT 1
    985 C     Y1       - Y-COORDINATES (LATITUDE ) FOR POINT 1
    986 C     K1       - VARIABLE TYPE AT POINT 1  (I.E. 1-Z , 2-U , 3-V)
    987 C     X2       - X-COORDINATES (LONGITUDE) FOR POINT 2
    988 C     Y2       - Y-COORDINATES (LATITUDE ) FOR POINT 2
    989 C     K2       - VARIABLE TYPE AT POINT 2  (I.E. 1-Z , 2-U , 3-V)
    990 C     FL       - DECOUPLING FACTOR
    991 C     TZ       - HEIGHT-TEMPERATURE FACTOR
    992 C
    993 C   OUTPUT ARGUMENT LIST:
    994 C     D        - DISTANCES BETWEEN ARRAYS OF POINTS IN RADIANS
    995 C     C1       - CORRELATION COEFFICIENTS AS SPECIFIED
    996 C     C2       - CORRELATION COEFFICIENTS AS SPECIFIED
    997 C
    998 C REMARKS: THIS PROGRAM COMPUTES A GAUSSIAN CORRELATION WITH
    999 C   LENGTH SCALE GIVEN BY THE CHTWV INPUT ARGUMENT.
   1000 C
   1001 C
   1002 C ATTRIBUTES:
   1003 C   LANGUAGE: FORTRAN 90
   1004 C   MACHINE:  NCEP WCOSS
   1005 C
   1006 C$$$
   1007 
   1008       SUBROUTINE COOR1(NP,CH,FL,TZ,X1,Y1,K1,X2,Y2,K2,D,C1,C2)
   1009 
   1010       DIMENSION  CH(NP),FL(NP),TZ(NP)
   1011       DIMENSION  X1(NP),Y1(NP),K1(NP)
   1012       DIMENSION  X2(NP),Y2(NP),K2(NP)
   1013       DIMENSION  D (NP),C1(NP),C2(NP)
   1014 
   1015       LOGICAL ZZ,ZU,ZV,UZ,UU,UV,VZ,VU,VV
   1016 
   1017       DATA PI180 /.0174532 /, SMIN/.002/
   1018 
   1019 C----------------------------------------------------------------------
   1020 C----------------------------------------------------------------------

Page 19          Source Listing                  COOR1
2017-04-18 11:07                                 oiqcbufr.f

   1021 
   1022       IF(NP.EQ.0) RETURN
   1023 
   1024 C  LOOP OVER SET OF INPUT POINTS
   1025 C  -----------------------------
   1026 
   1027       DO 20 I=1,NP
   1028 
   1029       C1(I) = 0.
   1030       C2(I) = 0.
   1031 
   1032 C  DETERMINE CORRELATION TYPE
   1033 C  --------------------------
   1034 
   1035       ZZ = K1(I).EQ.1 .AND. K2(I).EQ.1
   1036       ZU = K1(I).EQ.1 .AND. K2(I).EQ.2
   1037       ZV = K1(I).EQ.1 .AND. K2(I).EQ.3
   1038       UZ = K1(I).EQ.2 .AND. K2(I).EQ.1
   1039       UU = K1(I).EQ.2 .AND. K2(I).EQ.2
   1040       UV = K1(I).EQ.2 .AND. K2(I).EQ.3
   1041       VZ = K1(I).EQ.3 .AND. K2(I).EQ.1
   1042       VU = K1(I).EQ.3 .AND. K2(I).EQ.2
   1043       VV = K1(I).EQ.3 .AND. K2(I).EQ.3
   1044 
   1045 C  COMPUTE THE MATRIX OF SINES AND COSINES
   1046 C  ---------------------------------------
   1047 
   1048       COSY1 = COS(Y1(I)*PI180)
   1049       COSY2 = COS(Y2(I)*PI180)
   1050       SINY1 = SIN(Y1(I)*PI180)
   1051       SINY2 = SIN(Y2(I)*PI180)
   1052       COSDX = COS((X1(I)-X2(I))*PI180)
   1053       COSDY = COS((Y1(I)-Y2(I))*PI180)
   1054       SINDX = SIN((X1(I)-X2(I))*PI180)
   1055       SINDY = SIN((Y1(I)-Y2(I))*PI180)
   1056 
   1057 C  COMPUTE THE NORMAL ANGLE
   1058 C  ------------------------
   1059 
   1060       S = 1.0-COSDY+COSY1*COSY2*(1.0-COSDX)
   1061       S = SQRT(2.*S)
   1062 
   1063 C  CALCULATE THE FIRST PARTIALS WITH RESPECT TO X1 AND Y1
   1064 C  ------------------------------------------------------
   1065 
   1066       SI  =  MAX(S,SMIN)
   1067       SI  =  1./SI
   1068       DY1 =  SI*(SINDY-SINY1*COSY2*(1.0-COSDX))
   1069       DX1 =  SI*(COSY1*COSY2*SINDX)
   1070       DY2 = -SI*(SINDY+COSY1*SINY2*(1.0-COSDX))
   1071       DX2 = -DX1
   1072 
   1073 C  CALCULATE THE MIXED PARTIAL DERIVATIVES
   1074 C  ---------------------------------------
   1075 
   1076       DY1Y2=  SI*(SINY1*SINY2*(1.0-COSDX)-COSDY-DY1*DY2)
   1077       DY1X2=  SI*(SINY1*COSY2*SINDX-DY1*DX2)

Page 20          Source Listing                  COOR1
2017-04-18 11:07                                 oiqcbufr.f

   1078       DX1X2= -SI*(COSY1*COSY2*COSDX+DX1*DX2)
   1079       DX1Y2= -SI*(COSY1*SINY2*SINDX+DX1*DY2)
   1080 
   1081 C  COMPUTE THE VARIOUS CORRELATIONS
   1082 C  --------------------------------
   1083 
   1084       RHO   = EXP(-CH(I)*S*S)
   1085       DRHO  = -2.*CH(I)*S*RHO
   1086       D2RHO = -2.*CH(I)*(RHO+S*DRHO)
   1087 
   1088       WW0   = 2.*CH(I)
   1089       SRWW0 = SQRT(WW0)
   1090 
   1091       D(I)  = S
   1092 
   1093       IF(S.LT.SMIN) THEN
   1094          IF(ZZ) C1(I) = 1.
   1095          IF(UU) C1(I) = 1.
   1096          IF(VV) C1(I) = 1.
   1097          D(I) = 0.
   1098       ELSE IF(ZZ) THEN
   1099          C1(I) = RHO
   1100       ELSE IF(ZU) THEN
   1101          C1(I) = FL(I)*TZ(I) * DRHO*DY2*SIGN(1.,-SINY2)/SRWW0
   1102       ELSE IF(ZV) THEN
   1103          C1(I) = FL(I)*TZ(I) * DRHO*DX2*SIGN(1., SINY2)/(SRWW0*COSY2)
   1104       ELSE IF(UZ) THEN
   1105          C1(I) = FL(I)*TZ(I) * DRHO*DY1*SIGN(1.,-SINY1)/SRWW0
   1106       ELSE IF(UU) THEN
   1107          C1(I) = DY1*DY2*D2RHO+DY1Y2*DRHO
   1108          C1(I) = C1(I)*SIGN(1., SINY1*SINY2)/WW0
   1109          C1(I) = C1(I)*FL(I)  + RHO*(1.-FL(I))
   1110       ELSE IF(UV) THEN
   1111          C1(I) = DY1*DX2*D2RHO+DY1X2*DRHO
   1112          C1(I) = FL(I) * C1(I)*SIGN(1.,-SINY1*SINY2)/(WW0*COSY2)
   1113       ELSE IF(VZ) THEN
   1114          C1(I) = FL(I)*TZ(I) * DRHO*DX1*SIGN(1., SINY1)/(SRWW0*COSY1)
   1115       ELSE IF(VU) THEN
   1116          C1(I) = DX1*DY2*D2RHO+DX1Y2*DRHO
   1117          C1(I) = FL(I) * C1(I)*SIGN(1.,-SINY1*SINY2)/(WW0*COSY1)
   1118       ELSE IF(VV) THEN
   1119          C1(I) = DX1*DX2*D2RHO+DX1X2*DRHO
   1120          C1(I) = C1(I)*SIGN(1., SINY1*SINY2)/(WW0*COSY1*COSY2)
   1121          C1(I) = C1(I)*FL(I)  + RHO*(1.-FL(I))
   1122       ENDIF
   1123 
   1124 20    CONTINUE
   1125 
   1126       RETURN
   1127       END

Page 21          Source Listing                  COOR1
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name              
                    
 coor1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  608                                                            511                               
 C1                         Dummy  492      R(4)            4     1     0        ARG,INOUT        513,578,579,580,583,585,587,589,59
                                                                                                  1,592,593,595,596,598,600,601,603,
                                                                                                  604,605                           
 C2                         Dummy  492      R(4)            4     1     0        ARG,INOUT        514                               
 CH                         Dummy  492      R(4)            4     1     0        ARG,INOUT        568,569,570,572                   
 COOR1                      Subr   492                                                                                              
 COS                        Func   532                                  scalar                    532,533,536,537                   
 COSDX                      Local  536      R(4)            4           scalar                    536,544,552,554,560,562           
 COSDY                      Local  537      R(4)            4           scalar                    537,544,560                       
 COSY1                      Local  532      R(4)            4           scalar                    532,544,553,554,562,563,598,601,60
                                                                                                  4                                 
 COSY2                      Local  533      R(4)            4           scalar                    533,544,552,553,561,562,587,596,60
                                                                                                  4                                 
 D                          Dummy  492      R(4)            4     1     0        ARG,INOUT        575,581                           
 D2RHO                      Local  570      R(4)            4           scalar                    570,591,595,600,603               
 DRHO                       Local  569      R(4)            4           scalar                    569,570,585,587,589,591,595,598,60
                                                                                                  0,603                             
 DX1                        Local  553      R(4)            4           scalar                    553,555,562,563,598,600,603       
 DX1X2                      Local  562      R(4)            4           scalar                    562,603                           
 DX1Y2                      Local  563      R(4)            4           scalar                    563,600                           
 DX2                        Local  555      R(4)            4           scalar                    555,561,562,587,595,603           
 DY1                        Local  552      R(4)            4           scalar                    552,560,561,589,591,595           
 DY1X2                      Local  561      R(4)            4           scalar                    561,595                           
 DY1Y2                      Local  560      R(4)            4           scalar                    560,591                           
 DY2                        Local  554      R(4)            4           scalar                    554,560,563,585,591,600           
 EXP                        Func   568                                  scalar                    568                               
 FL                         Dummy  492      R(4)            4     1     0        ARG,INOUT        585,587,589,593,596,598,601,605   
 I                          Local  511      I(4)            4           scalar                    511,513,514,519,520,521,522,523,52
                                                                                                  4,525,526,527,532,533,534,535,536,
                                                                                                  537,538,539,568,569,570,572,575,57
                                                                                                  8,579,580,581,583,585,587,589,591,
                                                                                                  592,593,595,596,598,600,601,603,60
                                                                                                  4,605                             
 K1                         Dummy  492      I(4)            4     1     0        ARG,INOUT        519,520,521,522,523,524,525,526,52
                                                                                                  7                                 
 K2                         Dummy  492      I(4)            4     1     0        ARG,INOUT        519,520,521,522,523,524,525,526,52
                                                                                                  7                                 
 MAX                        Func   550                                  scalar                    550                               
 NP                         Dummy  492      I(4)            4           scalar   ARG,INOUT        494,495,496,497,506,511           
 PI180                      Local  501      R(4)            4           scalar                    501,532,533,534,535,536,537,538,53
                                                                                                  9                                 
 RHO                        Local  568      R(4)            4           scalar                    568,569,570,583,593,605           
 S                          Local  544      R(4)            4           scalar                    544,545,550,568,569,570,575,577   

Page 22          Source Listing                  COOR1
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SI                         Local  550      R(4)            4           scalar                    550,551,552,553,554,560,561,562,56
                                                                                                  3                                 
 SIGN                       Func   585                                  scalar                    585,587,589,592,596,598,601,604   
 SIN                        Func   534                                  scalar                    534,535,538,539                   
 SINDX                      Local  538      R(4)            4           scalar                    538,553,561,563                   
 SINDY                      Local  539      R(4)            4           scalar                    539,552,554                       
 SINY1                      Local  534      R(4)            4           scalar                    534,552,560,561,589,592,596,598,60
                                                                                                  1,604                             
 SINY2                      Local  535      R(4)            4           scalar                    535,554,560,563,585,587,592,596,60
                                                                                                  1,604                             
 SMIN                       Local  501      R(4)            4           scalar                    501,550,577                       
 SQRT                       Func   545                                  scalar                    545,573                           
 SRWW0                      Local  573      R(4)            4           scalar                    573,585,587,589,598               
 TZ                         Dummy  492      R(4)            4     1     0        ARG,INOUT        585,587,589,598                   
 UU                         Local  499      L(4)            4           scalar                    523,579,590                       
 UV                         Local  499      L(4)            4           scalar                    524,594                           
 UZ                         Local  499      L(4)            4           scalar                    522,588                           
 VU                         Local  499      L(4)            4           scalar                    526,599                           
 VV                         Local  499      L(4)            4           scalar                    527,580,602                       
 VZ                         Local  499      L(4)            4           scalar                    525,597                           
 WW0                        Local  572      R(4)            4           scalar                    572,573,592,596,601,604           
 X1                         Dummy  492      R(4)            4     1     0        ARG,INOUT        536,538                           
 X2                         Dummy  492      R(4)            4     1     0        ARG,INOUT        536,538                           
 Y1                         Dummy  492      R(4)            4     1     0        ARG,INOUT        532,534,537,539                   
 Y2                         Dummy  492      R(4)            4     1     0        ARG,INOUT        533,535,537,539                   
 ZU                         Local  499      L(4)            4           scalar                    520,584                           
 ZV                         Local  499      L(4)            4           scalar                    521,586                           
 ZZ                         Local  499      L(4)            4           scalar                    519,578,582                       

Page 23          Source Listing                  COOR1
2017-04-18 11:07                                 oiqcbufr.f

   1128 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1129 C
   1130 C SUBPROGRAM:    COOR2
   1131 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   1132 C
   1133 C ABSTRACT: COMPUTES CHORD LENGTH DISTANCE FOR A MATRIX OF LOCATIONS
   1134 C   <(X,Y)I,(X,Y)J> USING THE NORMAL ANGLE  FORMULA:
   1135 C     S**2/2 = 1 - COS(Y1-Y2) + COS(Y1)*COS(Y2)*(1-COS(X1-X2))
   1136 C   DERIVATIVES OF DISTANCE WITH RESPECT TO LAT AND LON ARE ALSO
   1137 C   COMPUTED AND COMBINED WITH APPROPRIATE CORRELATION FUNCTIONS AND
   1138 C   DERIVATIVES WITH RESPECT TO DISTANCE TO FORM THE MULTI-VARIATE
   1139 C   CORRELATIONS FOR THE HEIGHT WIND ANALYSIS.
   1140 C
   1141 C PROGRAM HISTORY LOG:
   1142 C 1990-11-06  J. WOOLLEN - ORINGIAL AUTHOR
   1143 C
   1144 C USAGE:    CALL COOR2(NP,CH,FL,TZ,X1,Y1,K1,X2,Y2,K2,D,C1,C2)
   1145 C   INPUT ARGUMENT LIST:
   1146 C     NP       - NUMBER OF OUTPUTS REQUESTED
   1147 C     CH       - VECTOR OF CONSTANTS FOR THE GAUSSIAN LENGTH SCALE
   1148 C     X1       - X-COORDINATES (LONGITUDE) FOR POINT 1
   1149 C     Y1       - Y-COORDINATES (LATITUDE ) FOR POINT 1
   1150 C     K1       - VARIABLE TYPE AT POINT 1  (I.E. 1-Z , 2-U , 3-V)
   1151 C     X2       - X-COORDINATES (LONGITUDE) FOR POINT 2
   1152 C     Y2       - Y-COORDINATES (LATITUDE ) FOR POINT 2
   1153 C     K2       - VARIABLE TYPE AT POINT 2  (I.E. 1-Z , 2-U , 3-V)
   1154 C     FL       - DECOUPLING FACTOR
   1155 C     TZ       - HEIGHT-TEMPERATURE FACTOR
   1156 C
   1157 C   OUTPUT ARGUMENT LIST:
   1158 C     D        - DISTANCES BETWEEN ARRAYS OF POINTS IN RADIANS
   1159 C     C1       - CORRELATION COEFFICIENTS AS SPECIFIED
   1160 C     C2       - CORRELATION COEFFICIENTS AS SPECIFIED
   1161 C
   1162 C REMARKS: THIS PROGRAM COMPUTES A GAUSSIAN CORRELATION WITH
   1163 C   LENGTH SCALE GIVEN BY THE CHTWV INPUT ARGUMENT.
   1164 C
   1165 C
   1166 C ATTRIBUTES:
   1167 C   LANGUAGE: FORTRAN 90
   1168 C   MACHINE:  NCEP WCOSS
   1169 C
   1170 C$$$
   1171       SUBROUTINE COOR2(NP,CH,FL,TZ,X1,Y1,K1,X2,Y2,K2,D,C1,C2)
   1172 
   1173 
   1174       DIMENSION  CH(NP),FL(NP),TZ(NP)
   1175       DIMENSION  X1(NP),Y1(NP),K1(NP)
   1176       DIMENSION  X2(NP),Y2(NP),K2(NP)
   1177       DIMENSION  D (NP),C1(NP),C2(NP)
   1178 
   1179       LOGICAL ZZ,ZU,ZV,UZ,UU,UV,VZ,VU,VV
   1180 
   1181       DATA PI180 /.0174532 /, SMIN/.002/
   1182 
   1183 C----------------------------------------------------------------------
   1184 C----------------------------------------------------------------------

Page 24          Source Listing                  COOR2
2017-04-18 11:07                                 oiqcbufr.f

   1185 
   1186       IF(NP.EQ.0) RETURN
   1187 
   1188 C  LOOP OVER SET OF INPUT POINTS
   1189 C  -----------------------------
   1190 
   1191       DO 20 I=1,NP
   1192 
   1193       C1(I) = 0.
   1194       C2(I) = 0.
   1195 
   1196 C  DETERMINE CORRELATION TYPE
   1197 C  --------------------------
   1198 
   1199       ZZ = K1(I).EQ.1 .AND. K2(I).EQ.1
   1200       ZU = K1(I).EQ.1 .AND. K2(I).EQ.2
   1201       ZV = K1(I).EQ.1 .AND. K2(I).EQ.3
   1202       UZ = K1(I).EQ.2 .AND. K2(I).EQ.1
   1203       UU = K1(I).EQ.2 .AND. K2(I).EQ.2
   1204       UV = K1(I).EQ.2 .AND. K2(I).EQ.3
   1205       VZ = K1(I).EQ.3 .AND. K2(I).EQ.1
   1206       VU = K1(I).EQ.3 .AND. K2(I).EQ.2
   1207       VV = K1(I).EQ.3 .AND. K2(I).EQ.3
   1208 
   1209 C  COMPUTE THE MATRIX OF SINES AND COSINES
   1210 C  ---------------------------------------
   1211 
   1212       COSY1 = COS(Y1(I)*PI180)
   1213       COSY2 = COS(Y2(I)*PI180)
   1214       SINY1 = SIN(Y1(I)*PI180)
   1215       SINY2 = SIN(Y2(I)*PI180)
   1216       COSDX = COS((X1(I)-X2(I))*PI180)
   1217       COSDY = COS((Y1(I)-Y2(I))*PI180)
   1218       SINDX = SIN((X1(I)-X2(I))*PI180)
   1219       SINDY = SIN((Y1(I)-Y2(I))*PI180)
   1220 
   1221 C  COMPUTE THE NORMAL ANGLE
   1222 C  ------------------------
   1223 
   1224       S = 1.0-COSDY+COSY1*COSY2*(1.0-COSDX)
   1225       S = SQRT(2.*S)
   1226 
   1227 C  CALCULATE THE FIRST PARTIALS WITH RESPECT TO X1 AND Y1
   1228 C  ------------------------------------------------------
   1229 
   1230       SI  =  MAX(S,SMIN)
   1231       SI  =  1./SI
   1232       DY1 =  SI*(SINDY-SINY1*COSY2*(1.0-COSDX))
   1233       DX1 =  SI*(COSY1*COSY2*SINDX)
   1234       DY2 = -SI*(SINDY+COSY1*SINY2*(1.0-COSDX))
   1235       DX2 = -DX1
   1236 
   1237 C  CALCULATE THE MIXED PARTIAL DERIVATIVES
   1238 C  ---------------------------------------
   1239 
   1240       DY1Y2=  SI*(SINY1*SINY2*(1.0-COSDX)-COSDY-DY1*DY2)
   1241       DY1X2=  SI*(SINY1*COSY2*SINDX-DY1*DX2)

Page 25          Source Listing                  COOR2
2017-04-18 11:07                                 oiqcbufr.f

   1242       DX1X2= -SI*(COSY1*COSY2*COSDX+DX1*DX2)
   1243       DX1Y2= -SI*(COSY1*SINY2*SINDX+DX1*DY2)
   1244 
   1245 C  COMPUTE THE VARIOUS CORRELATIONS
   1246 C  --------------------------------
   1247 
   1248       RHO   = EXP(-CH(I)*S*S)
   1249       DRHO  = -2.*CH(I)*S*RHO
   1250       D2RHO = -2.*CH(I)*(RHO+S*DRHO)
   1251 
   1252       WW0   = 2.*CH(I)
   1253       SRWW0 = SQRT(WW0)
   1254 
   1255       D(I)  = S
   1256 
   1257       IF(S.LT.SMIN) THEN
   1258          IF(ZZ) C1(I) = 1.
   1259          IF(ZZ) C2(I) = 1.
   1260          IF(UU) C1(I) = 1.
   1261          IF(VV) C1(I) = 1.
   1262          IF(VU) C2(I) = 1.
   1263          D(I) = 0.
   1264       ELSE IF(ZZ) THEN
   1265          C1(I) = RHO
   1266          C2(I) = C1(I)
   1267       ELSE IF(ZU) THEN
   1268          C1(I) = FL(I)*TZ(I) * DRHO*DY2*SIGN(1.,-SINY2)/SRWW0
   1269          C2(I) = FL(I)*TZ(I) * DRHO*DX2*SIGN(1., SINY2)/(SRWW0*COSY2)
   1270       ELSE IF(ZV) THEN
   1271          C1(I) = FL(I)*TZ(I) * DRHO*DX2*SIGN(1., SINY2)/(SRWW0*COSY2)
   1272          C2(I) = C1(I)
   1273       ELSE IF(UZ) THEN
   1274          C1(I) = FL(I)*TZ(I) * DRHO*DY1*SIGN(1.,-SINY1)/SRWW0
   1275          C2(I) = C1(I)
   1276       ELSE IF(UU) THEN
   1277          C1(I) = DY1*DY2*D2RHO+DY1Y2*DRHO
   1278          C1(I) = C1(I)*SIGN(1., SINY1*SINY2)/WW0
   1279          C1(I) = C1(I)*FL(I)  + RHO*(1.-FL(I))
   1280          C2(I) = DY1*DX2*D2RHO+DY1X2*DRHO
   1281          C2(I) = FL(I) * C2(I)*SIGN(1.,-SINY1*SINY2)/(WW0*COSY2)
   1282       ELSE IF(UV) THEN
   1283          C1(I) = DY1*DX2*D2RHO+DY1X2*DRHO
   1284          C1(I) = FL(I) * C1(I)*SIGN(1.,-SINY1*SINY2)/(WW0*COSY2)
   1285          C2(I) = C1(I)
   1286       ELSE IF(VZ) THEN
   1287          C1(I) = FL(I)*TZ(I) * DRHO*DX1*SIGN(1., SINY1)/(SRWW0*COSY1)
   1288          C2(I) = C1(I)
   1289       ELSE IF(VU) THEN
   1290          C1(I) = DX1*DY2*D2RHO+DX1Y2*DRHO
   1291          C1(I) = FL(I) * C1(I)*SIGN(1.,-SINY1*SINY2)/(WW0*COSY1)
   1292          C2(I) = DX1*DX2*D2RHO+DX1X2*DRHO
   1293          C2(I) = C2(I)*SIGN(1., SINY1*SINY2)/(WW0*COSY1*COSY2)
   1294          C2(I) = C2(I)*FL(I)  + RHO*(1.-FL(I))
   1295       ELSE IF(VV) THEN
   1296          C1(I) = DX1*DX2*D2RHO+DX1X2*DRHO
   1297          C1(I) = C1(I)*SIGN(1., SINY1*SINY2)/(WW0*COSY1*COSY2)
   1298          C1(I) = C1(I)*FL(I)  + RHO*(1.-FL(I))

Page 26          Source Listing                  COOR2
2017-04-18 11:07                                 oiqcbufr.f

   1299          C2(I) = C1(I)
   1300       ENDIF
   1301 
   1302 20    CONTINUE
   1303 
   1304       RETURN
   1305       END


ENTRY POINTS

  Name              
                    
 coor2_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  786                                                            675                               
 C1                         Dummy  655      R(4)            4     1     0        ARG,INOUT        677,742,744,745,749,750,752,755,75
                                                                                                  6,758,759,761,762,763,767,768,769,
                                                                                                  771,772,774,775,780,781,782,783   
 C2                         Dummy  655      R(4)            4     1     0        ARG,INOUT        678,743,746,750,753,756,759,764,76
                                                                                                  5,769,772,776,777,778,783         
 CH                         Dummy  655      R(4)            4     1     0        ARG,INOUT        732,733,734,736                   
 COOR2                      Subr   655                                                                                              
 COS                        Func   696                                  scalar                    696,697,700,701                   
 COSDX                      Local  700      R(4)            4           scalar                    700,708,716,718,724,726           
 COSDY                      Local  701      R(4)            4           scalar                    701,708,724                       
 COSY1                      Local  696      R(4)            4           scalar                    696,708,717,718,726,727,771,775,77
                                                                                                  7,781                             
 COSY2                      Local  697      R(4)            4           scalar                    697,708,716,717,725,726,753,755,76
                                                                                                  5,768,777,781                     
 D                          Dummy  655      R(4)            4     1     0        ARG,INOUT        739,747                           
 D2RHO                      Local  734      R(4)            4           scalar                    734,761,764,767,774,776,780       
 DRHO                       Local  733      R(4)            4           scalar                    733,734,752,753,755,758,761,764,76
                                                                                                  7,771,774,776,780                 
 DX1                        Local  717      R(4)            4           scalar                    717,719,726,727,771,774,776,780   
 DX1X2                      Local  726      R(4)            4           scalar                    726,776,780                       
 DX1Y2                      Local  727      R(4)            4           scalar                    727,774                           
 DX2                        Local  719      R(4)            4           scalar                    719,725,726,753,755,764,767,776,78
                                                                                                  0                                 
 DY1                        Local  716      R(4)            4           scalar                    716,724,725,758,761,764,767       
 DY1X2                      Local  725      R(4)            4           scalar                    725,764,767                       
 DY1Y2                      Local  724      R(4)            4           scalar                    724,761                           
 DY2                        Local  718      R(4)            4           scalar                    718,724,727,752,761,774           
 EXP                        Func   732                                  scalar                    732                               
 FL                         Dummy  655      R(4)            4     1     0        ARG,INOUT        752,753,755,758,763,765,768,771,77
                                                                                                  5,778,782                         
 I                          Local  675      I(4)            4           scalar                    675,677,678,683,684,685,686,687,68
                                                                                                  8,689,690,691,696,697,698,699,700,
                                                                                                  701,702,703,732,733,734,736,739,74
                                                                                                  2,743,744,745,746,747,749,750,752,
                                                                                                  753,755,756,758,759,761,762,763,76
                                                                                                  4,765,767,768,769,771,772,774,775,

Page 27          Source Listing                  COOR2
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  776,777,778,780,781,782,783       
 K1                         Dummy  655      I(4)            4     1     0        ARG,INOUT        683,684,685,686,687,688,689,690,69
                                                                                                  1                                 
 K2                         Dummy  655      I(4)            4     1     0        ARG,INOUT        683,684,685,686,687,688,689,690,69
                                                                                                  1                                 
 MAX                        Func   714                                  scalar                    714                               
 NP                         Dummy  655      I(4)            4           scalar   ARG,INOUT        658,659,660,661,670,675           
 PI180                      Local  665      R(4)            4           scalar                    665,696,697,698,699,700,701,702,70
                                                                                                  3                                 
 RHO                        Local  732      R(4)            4           scalar                    732,733,734,749,763,778,782       
 S                          Local  708      R(4)            4           scalar                    708,709,714,732,733,734,739,741   
 SI                         Local  714      R(4)            4           scalar                    714,715,716,717,718,724,725,726,72
                                                                                                  7                                 
 SIGN                       Func   752                                  scalar                    752,753,755,758,762,765,768,771,77
                                                                                                  5,777,781                         
 SIN                        Func   698                                  scalar                    698,699,702,703                   
 SINDX                      Local  702      R(4)            4           scalar                    702,717,725,727                   
 SINDY                      Local  703      R(4)            4           scalar                    703,716,718                       
 SINY1                      Local  698      R(4)            4           scalar                    698,716,724,725,758,762,765,768,77
                                                                                                  1,775,777,781                     
 SINY2                      Local  699      R(4)            4           scalar                    699,718,724,727,752,753,755,762,76
                                                                                                  5,768,775,777,781                 
 SMIN                       Local  665      R(4)            4           scalar                    665,714,741                       
 SQRT                       Func   709                                  scalar                    709,737                           
 SRWW0                      Local  737      R(4)            4           scalar                    737,752,753,755,758,771           
 TZ                         Dummy  655      R(4)            4     1     0        ARG,INOUT        752,753,755,758,771               
 UU                         Local  663      L(4)            4           scalar                    687,744,760                       
 UV                         Local  663      L(4)            4           scalar                    688,766                           
 UZ                         Local  663      L(4)            4           scalar                    686,757                           
 VU                         Local  663      L(4)            4           scalar                    690,746,773                       
 VV                         Local  663      L(4)            4           scalar                    691,745,779                       
 VZ                         Local  663      L(4)            4           scalar                    689,770                           
 WW0                        Local  736      R(4)            4           scalar                    736,737,762,765,768,775,777,781   
 X1                         Dummy  655      R(4)            4     1     0        ARG,INOUT        700,702                           
 X2                         Dummy  655      R(4)            4     1     0        ARG,INOUT        700,702                           
 Y1                         Dummy  655      R(4)            4     1     0        ARG,INOUT        696,698,701,703                   
 Y2                         Dummy  655      R(4)            4     1     0        ARG,INOUT        697,699,701,703                   
 ZU                         Local  663      L(4)            4           scalar                    684,751                           
 ZV                         Local  663      L(4)            4           scalar                    685,754                           
 ZZ                         Local  663      L(4)            4           scalar                    683,742,743,748                   

Page 28          Source Listing                  COOR2
2017-04-18 11:07                                 oiqcbufr.f

   1306 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1307 C
   1308 C SUBPROGRAM:    DRCTSL
   1309 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   1310 C
   1311 C ABSTRACT: DRIVER FOR CHOLESKY TYPE LINEAR EQUATION SOLVER.
   1312 C
   1313 C PROGRAM HISTORY LOG:
   1314 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   1315 C
   1316 C USAGE:    CALL DRCTSL(FA,RA,DP,NDIM,NXXYY)
   1317 C   INPUT ARGUMENT LIST:
   1318 C     FAALL    - ARRAY OF SYMMETRIC MATRIXES
   1319 C     RAALL    - ARRAY OF MATRIX RIGHT HAND SIDES
   1320 C     NDIM     - ARRAY OF MATRIX RANKS
   1321 C     MAXDIM   - MAXIMUM RANK MATRIX IN MATRIX ARRAY
   1322 C     NXXYY    - NUMBER OF MATRIXES IN MATRIX ARRAY
   1323 C     NFT      - NUMBER OF RIGHT HAND SIDE VECTORS PER MATRIX
   1324 C   OUTPUT ARGUMENT LIST:
   1325 C     RAALL    - ARRAY OF MATRIX SOLUTIONS
   1326 C     DOTPRD   - ARRAY OF DOT PRODUCTS OF RHS VECTORS WITH MATRIX
   1327 C                SOLUTIONS
   1328 C   OUTPUT FILES:
   1329 C     UNIT 06  - STANDARD OUTPUT PRINT
   1330 C
   1331 C REMARKS: ILL CONDITIONED OR NON POSITIVE DEFINITE MATRIXES ARE
   1332 C   IDENTIFIED BY DOT PRODUCTS GT 1 OR LT 0 OR BY A MESSAGE FROM
   1333 C   VSOLVE. FIVE ATTEMPTS ARE MADE TO SOLVE BAD ONES, BY RIDGE
   1334 C   REGRESSION, AFTER WHICH A NULL SOLUTION IS RETURNED.
   1335 C
   1336 C ATTRIBUTES:
   1337 C   LANGUAGE: FORTRAN 90
   1338 C   MACHINE:  NCEP WCOSS
   1339 C
   1340 C$$$
   1341       SUBROUTINE DRCTSL(FA,RA,DP,NDIM,NXXYY)
   1342 
   1343       PARAMETER( NMX  =  64        ,
   1344      .           NN   =  10*(10+1)/2 ,
   1345      .           N    =  10          )
   1346 
   1347       DIMENSION FA(NMX,NN), RA(NMX,N,2),  DP(NMX,2), NDIM(NXXYY)
   1348       DIMENSION A (NMX,NN), B (NMX,N,2)
   1349       DIMENSION BAD(NMX), SMOOTH(6)
   1350       LOGICAL   BAD
   1351 
   1352       DATA SMOOTH /1.00,1.01,1.02,1.05,1.10,2.00/
   1353 
   1354 C----------------------------------------------------------------------
   1355 C----------------------------------------------------------------------
   1356 
   1357 C  LOOP FOR POSSIBILITY OF BAD MATRIXS
   1358 C  -----------------------------------
   1359 
   1360       DO 50 ITRY=1,6
   1361       NBAD = 0
   1362 

Page 29          Source Listing                  DRCTSL
2017-04-18 11:07                                 oiqcbufr.f

   1363 C  FIND THE LARGEST MATRIX IN THE STACK
   1364 C  ------------------------------------
   1365 
   1366       MAXDIM = 0
   1367       DO 5 I=1,NXXYY
   1368       MAXDIM = MAX(MAXDIM,NDIM(I))
   1369 5     CONTINUE
   1370 
   1371       IF(MAXDIM.EQ.0) RETURN
   1372 
   1373 C  INITIALIZE THE WORKING ARRAYS
   1374 C  -----------------------------
   1375 
   1376       DO 10 J=1,MAXDIM*(MAXDIM+1)/2
   1377       DO 10 I=1,NXXYY
   1378       A(I,J) = FA(I,J)
   1379 10    CONTINUE
   1380 
   1381       DO 11 J=1,MAXDIM
   1382       DO 11 I=1,NXXYY
   1383       B(I,J,1) = RA(I,J,1)
   1384       B(I,J,2) = RA(I,J,2)
   1385 11    CONTINUE
   1386 
   1387       DO 12 I=1,NXXYY
   1388       DP(I,1) = 0.
   1389       DP(I,2) = 0.
   1390 12    CONTINUE
   1391 
   1392       DO 13 J=1,MAXDIM
   1393       JJ = J*(J+1)/2
   1394       DO 13 I=1,NXXYY
   1395       A(I,JJ) = FA(I,JJ)*SMOOTH(ITRY)
   1396 13    CONTINUE
   1397 
   1398 C  CALL THE MATRIX SOLVER
   1399 C  ----------------------
   1400 
   1401       CALL VSOLVE (A,B,NDIM,BAD,NXXYY,MAXDIM)
   1402 
   1403 C  MAKE THE DOT PRODUCTS OF SOLUTIONS WITH RIGHT HAND SIDES
   1404 C  --------------------------------------------------------
   1405 
   1406       DO 20 J=1,MAXDIM
   1407       DO 20 I=1,NXXYY
   1408       DP(I,1) = DP(I,1) + RA(I,J,1)*B(I,J,1)
   1409       DP(I,2) = DP(I,2) + RA(I,J,2)*B(I,J,2)
   1410 20    CONTINUE
   1411 
   1412 C  NORMALIZE THE WEIGHTS IF THEY ARE TOO BIG
   1413 C  -----------------------------------------
   1414 
   1415       DO 25 I=1,NXXYY
   1416       IF(DP(I,1).GT.1. .OR. DP(I,2).GT.1.) THEN
   1417          DO 24 J=1,MAXDIM
   1418          B(I,J,1) = B(I,J,1)/DP(I,1)
   1419          B(I,J,2) = B(I,J,2)/DP(I,2)

Page 30          Source Listing                  DRCTSL
2017-04-18 11:07                                 oiqcbufr.f

   1420 24       CONTINUE
   1421          DP(I,1) = 1.
   1422          DP(I,2) = 1.
   1423       ENDIF
   1424 25    CONTINUE
   1425 
   1426 C  CHECK FOR BAD ONES - DO IT AGAIN IF NECESSARY
   1427 C  ---------------------------------------------
   1428 
   1429       DO 30 I=1,NXXYY
   1430       BAD(I) = BAD(I) .OR. DP(I,1).LT.0. .OR. DP(I,2).LT.0.
   1431       BAD(I) = BAD(I) .OR. DP(I,1).GT.1. .OR. DP(I,2).GT.1.
   1432 30    CONTINUE
   1433 
   1434       DO 40 I=1,NXXYY
   1435       IF(BAD(I)) THEN
   1436          DP(I,1) = 0.
   1437          DP(I,2) = 0.
   1438          DO 35 J=1,MAXDIM
   1439          B(I,J,1) = 0.
   1440          B(I,J,2) = 0.
   1441 35       CONTINUE
   1442          NBAD = NBAD + 1
   1443       ENDIF
   1444 40    CONTINUE
   1445 
   1446       IF(NBAD.NE.0) PRINT*, 'NBAD=',NBAD,' ON TRY ',ITRY
   1447       IF(NBAD.EQ.0) GOTO 55
   1448 
   1449 50    CONTINUE
   1450 
   1451 C  COPY SOLUTIONS INTO OUTPUT ARRAY - ZERO BAD ONES OUT
   1452 C  ----------------------------------------------------
   1453 
   1454 55    DO 60 J=1,MAXDIM
   1455       DO 60 I=1,NXXYY
   1456       RA(I,J,1) = B(I,J,1)
   1457       RA(I,J,2) = B(I,J,2)
   1458 60    CONTINUE
   1459 
   1460       RETURN
   1461       END

Page 31          Source Listing                  DRCTSL
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name               
                     
 drctsl_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  863                                                            860,861                           
 11                         Label  869                                                            865,866                           
 12                         Label  874                                                            871                               
 13                         Label  880                                                            876,878                           
 20                         Label  894                                                            890,891                           
 24                         Label  904                                                            901                               
 25                         Label  908                                                            899                               
 30                         Label  916                                                            913                               
 35                         Label  925                                                            922                               
 40                         Label  928                                                            918                               
 5                          Label  853                                                            851                               
 50                         Label  933                                                            844                               
 55                         Label  938                                                            931                               
 60                         Label  942                                                            938,939                           
 A                          Local  832      R(4)            4     2     3520                      862,879,885                       
 B                          Local  832      R(4)            4     3     1280                      867,868,885,892,893,902,903,923,92
                                                                                                  4,940,941                         
 BAD                        Local  833      L(4)            4     1     64                        885,914,915,919                   
 DP                         Dummy  825      R(4)            4     2     128      ARG,INOUT        872,873,892,893,900,902,903,905,90
                                                                                                  6,914,915,920,921                 
 DRCTSL                     Subr   825                                                                                              
 FA                         Dummy  825      R(4)            4     2     3520     ARG,INOUT        862,879                           
 I                          Local  851      I(4)            4           scalar                    851,852,861,862,866,867,868,871,87
                                                                                                  2,873,878,879,891,892,893,899,900,
                                                                                                  902,903,905,906,913,914,915,918,91
                                                                                                  9,920,921,923,924,939,940,941     
 ITRY                       Local  844      I(4)            4           scalar                    844,879,930                       
 J                          Local  860      I(4)            4           scalar                    860,862,865,867,868,876,877,890,89
                                                                                                  2,893,901,902,903,922,923,924,938,
                                                                                                  940,941                           
 JJ                         Local  877      I(4)            4           scalar                    877,879                           
 MAX                        Func   852                                  scalar                    852                               
 MAXDIM                     Local  850      I(4)            4           scalar                    850,852,855,860,865,876,885,890,90
                                                                                                  1,922,938                         
 N                          Param  829      I(4)            4           scalar                    831,832                           
 NBAD                       Local  845      I(4)            4           scalar                    845,926,930,931                   
 NDIM                       Dummy  825      I(4)            4     1     0        ARG,INOUT        852,885                           
 NMX                        Param  827      I(4)            4           scalar                    831,832,833                       
 NN                         Param  828      I(4)            4           scalar                    831,832                           
 NXXYY                      Dummy  825      I(4)            4           scalar   ARG,INOUT        831,851,861,866,871,878,885,891,89
                                                                                                  9,913,918,939                     
 RA                         Dummy  825      R(4)            4     3     1280     ARG,INOUT        867,868,892,893,940,941           
 SMOOTH                     Local  833      R(4)            4     1     6                         836,879                           
 VSOLVE                     Subr   885                                                            885                               

Page 32          Source Listing                  DRCTSL
2017-04-18 11:07                                 oiqcbufr.f

   1462 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1463 C
   1464 C SUBPROGRAM:    GETFCER
   1465 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1992-07-29
   1466 C
   1467 C ABSTRACT: FUNCTION WHICH RETURNS A FORECAST ERROR IN THE FORCAST
   1468 C   HEIGHT OR WIND FIELD FOR A GIVEN LAT, LON, PRESSURE. ENTRY POINTS
   1469 C   GETZER AND GETWER RETURN ERROR VALUES; GETFCER RETURNS 0.
   1470 C
   1471 C PROGRAM HISTORY LOG:
   1472 C 1992-07-29  J. WOOLLEN - ORIGINAL AUTHOR
   1473 C
   1474 C USAGE:    CALL GETZER(SLAT,SLON,PRES)  -  (RETURNS HEIGHT ERROR)
   1475 C           CALL GETWER(SLAT,SLON,PRES)  -  (RETURNS WIND   ERROR)
   1476 C   INPUT ARGUMENT LIST:
   1477 C     SLAT     - LATITUDE
   1478 C     SLON     - LONGITUDE
   1479 C     PRES     - PRESSURE
   1480 C
   1481 C   FUNCTION RETURN VALUE:
   1482 C     GETZER   - FORECAST HEIGHT ERROR
   1483 C     GETWER   - FORECAST WIND   ERROR
   1484 C
   1485 C REMARKS: NONE.
   1486 C
   1487 C
   1488 C ATTRIBUTES:
   1489 C   LANGUAGE: FORTRAN 90
   1490 C   MACHINE:  NCEP WCOSS
   1491 C
   1492 C$$$
   1493       FUNCTION GETFCER(SLAT,SLON,PRES)
   1494 
   1495       COMMON /OBERRS/ QIKE(21,300),PMAND(21),P50(21),CHL(21)
   1496       COMMON /CORP  / CHLP(1500),CVC,FFLAT(91),IFA(10,10)
   1497       COMMON /FCRATS/ RATION(21),RATIOS(21),TROPUV(21)
   1498 
   1499       LOGICAL WIND
   1500 
   1501       DATA PI180 /  .0174532  /
   1502       DATA OMEGA /  .72921E-4 /
   1503       DATA RADE  / 6.371E6    /
   1504       DATA GRAV  / 9.8        /
   1505 
   1506 C---------------------------------------------------------------------
   1507 C---------------------------------------------------------------------
   1508 
   1509       GETFCER = 0.
   1510       RETURN
   1511 
   1512       ENTRY GETZER(SLAT,SLON,PRES)
   1513       WIND = .FALSE.
   1514       GOTO 10
   1515 
   1516       ENTRY GETWER(SLAT,SLON,PRES)
   1517       WIND = .TRUE.
   1518 

Page 33          Source Listing                  GETFCER
2017-04-18 11:07                                 oiqcbufr.f

   1519 C  COMPUTE A HEIGHT ERROR PROPORTIONAL TO RAWINSONDE ERROR
   1520 C  -------------------------------------------------------
   1521 
   1522 10    RAWZER = PILNLNP(PRES,PMAND,QIKE(1,120),21)
   1523 
   1524       IF(SLAT.LT.0.) THEN
   1525          ZER = RAWZER/SQRT(PILNLNP(PRES,PMAND,RATIOS,21)) * 1.1
   1526       ELSE
   1527          ZER = RAWZER/SQRT(PILNLNP(PRES,PMAND,RATION,21))
   1528       ENDIF
   1529 
   1530       IF(.NOT.WIND) THEN
   1531          GETZER = ZER
   1532          RETURN
   1533       ENDIF
   1534 
   1535 C  COMPUTE THE GEOSTROPHIC WIND ERROR FOR GETWER
   1536 C  ---------------------------------------------
   1537 
   1538       TRPWER = PILNLNP(PRES,PMAND,TROPUV,21)
   1539       SRWW0  = SQRT(2.0*CHLP(IFIX(PRES)))
   1540       IF(SLAT.EQ.0.) ALPHA = 0.
   1541       IF(SLAT.NE.0.) ALPHA  = GRAV/(2.*OMEGA*SIN(ABS(SLAT)*PI180)*RADE)
   1542       IY = ABS(SLAT)+1.5
   1543       G = FFLAT(IY)
   1544       GETWER = G*ZER*ALPHA*SRWW0 + (1-G)*TRPWER
   1545 
   1546       RETURN
   1547       END

Page 34          Source Listing                  GETFCER
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                   Name                   Name                
                                                                    
 getfcer_               getwer_                getzer_              


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1006                                                           998                               
 ABS                        Func   1025                                 scalar                    1025,1026                         
 ALPHA                      Local  1024     R(4)            4           scalar                    1024,1025,1028                    
 CHL                        Scalar 979      R(4)            4     1     21       COM                                                
 CHLP                       Scalar 980      R(4)            4     1     1500     COM              1023                              
 CORP                       Common 980                                  6768                                                        
 CVC                        Scalar 980      R(4)            4           scalar   COM                                                
 FCRATS                     Common 981                                  252                                                         
 FFLAT                      Scalar 980      R(4)            4     1     91       COM              1027                              
 G                          Local  1027     R(4)            4           scalar                    1027,1028                         
 GETFCER                    Func   977      R(4)            4           scalar                    993                               
 GETFCER@0                  Local  977      R(4)            4           scalar                                                      
 GETWER                     Func   1000     R(4)            4           scalar                    1028                              
 GETZER                     Func   996      R(4)            4           scalar                    1015                              
 GRAV                       Local  988      R(4)            4           scalar                    988,1025                          
 IFA                        Scalar 980      I(4)            4     2     100      COM                                                
 IFIX                       Func   1023                                 scalar                    1023                              
 IY                         Local  1026     I(4)            4           scalar                    1026,1027                         
 OBERRS                     Common 979                                  25452                                                       
 OMEGA                      Local  986      R(4)            4           scalar                    986,1025                          
 P50                        Scalar 979      R(4)            4     1     21       COM                                                
 PI180                      Local  985      R(4)            4           scalar                    985,1025                          
 PILNLNP                    Func   1006     R(4)            4           scalar                    1006,1009,1011,1022               
 PMAND                      Scalar 979      R(4)            4     1     21       COM              1006,1009,1011,1022               
 PRES                       Dummy  977      R(4)            4           scalar   ARG,INOUT        1006,1009,1011,1022,1023          
 QIKE                       Scalar 979      R(4)            4     2     6300     COM              1006                              
 RADE                       Local  987      R(4)            4           scalar                    987,1025                          
 RATION                     Scalar 981      R(4)            4     1     21       COM              1011                              
 RATIOS                     Scalar 981      R(4)            4     1     21       COM              1009                              
 RAWZER                     Local  1006     R(4)            4           scalar                    1006,1009,1011                    
 SIN                        Func   1025                                 scalar                    1025                              
 SLAT                       Dummy  977      R(4)            4           scalar   ARG,INOUT        1008,1024,1025,1026               
 SLON                       Dummy  977      R(4)            4           scalar   ARG,INOUT                                          
 SQRT                       Func   1009                                 scalar                    1009,1011,1023                    
 SRWW0                      Local  1023     R(4)            4           scalar                    1023,1028                         
 TROPUV                     Scalar 981      R(4)            4     1     21       COM              1022                              
 TRPWER                     Local  1022     R(4)            4           scalar                    1022,1028                         
 WIND                       Local  983      L(4)            4           scalar                    997,1001,1014                     
 ZER                        Local  1009     R(4)            4           scalar                    1009,1011,1015,1028               

Page 35          Source Listing                  GETFCER
2017-04-18 11:07                                 oiqcbufr.f

   1548 C-----------------------------------------------------------------------
   1549 C
   1550 C-----------------------------------------------------------------------
   1551       SUBROUTINE MAKEAMAP
   1552 
   1553       PARAMETER (MAXREP=900000)
   1554       PARAMETER (MAXLEV=1100000)
   1555 
   1556       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   1557      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   1558      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   1559      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   1560      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   1561      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   1562      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   1563      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   1564       CHARACTER*3 FOC
   1565 
   1566 
   1567       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   1568       COMMON /CKLIST/ NDD,INDD(MAXLEV)
   1569       REAL*8 SID
   1570 
   1571 C-----------------------------------------------------------------------
   1572 C-----------------------------------------------------------------------
   1573 
   1574 C  MAKE SURE NONE OF THE LONGITUDES EQUAL 360.
   1575 C  -------------------------------------------
   1576 
   1577       DO 1 N=1,NREP
   1578       IF(FLN(N).EQ.360.) FLN(N) = 0.
   1579 1     CONTINUE
   1580 
   1581 C  LONGITUDE SORT
   1582 C  --------------
   1583 
   1584       NN = 0
   1585       DO 10 NX=1,360
   1586       DO 10 N=1,NREP
   1587       IX = FLN(N)+1.
   1588       IF(IX.EQ.NX) THEN
   1589          NN = NN+1
   1590          INDD(NN) = N
   1591       ENDIF
   1592 10    CONTINUE
   1593 
   1594 C  LATITUDE SORT
   1595 C  -------------
   1596 
   1597       NOB = 0
   1598       DO 20 NY=1,181
   1599       DO 20 N=1,NN
   1600       IY = FLT(INDD(N))+91.
   1601       IF(IY.EQ.NY) THEN
   1602          NOB = NOB+1
   1603          INOB(NOB) = INDD(N)
   1604       ENDIF

Page 36          Source Listing                  MAKEAMAP
2017-04-18 11:07                                 oiqcbufr.f

   1605 20    CONTINUE
   1606 
   1607 C  CHECK TO MAKE SURE ALL REPS ARE ACCOUNTED FOR
   1608 C  ---------------------------------------------
   1609 
   1610       IF(NREP.NE.NN .OR. NREP.NE.NOB) THEN
   1611          PRINT*
   1612          PRINT*,'*****************************************************'
   1613          PRINT*,'** WARNING*WARNING*WARNING*WARNING*WARNING*WARNING **'
   1614          PRINT*,'*****************************************************'
   1615          PRINT*,'** IN MAKEAMAP ALL REPORTS HAVE NOT BEEN PROCESSED **'
   1616          PRINT*,'*****************************************************'
   1617          PRINT*,'** WARNING*WARNING*WARNING*WARNING*WARNING*WARNING **'
   1618          PRINT*,'*****************************************************'
   1619          PRINT*
   1620       ENDIF
   1621 
   1622 C  INITIALIZE IMAP ARRAY
   1623 C  ---------------------
   1624 
   1625       IMAP = 0
   1626 
   1627       DO 30 N=1,NOB
   1628       NX = FLN(INOB(N)) + 1.
   1629       NY = FLT(INOB(N)) + 91.
   1630       IF(IMAP(NX,NY).EQ.0) IMAP(NX,NY) = N
   1631 30    CONTINUE
   1632 
   1633 C  FILL GAPS IN IMAP FOR CONTINUITY (BACKWARDS)
   1634 C  --------------------------------------------
   1635 
   1636       LASTN = NOB
   1637       DO 40 NY=181,1,-1
   1638       DO 40 NX=360,1,-1
   1639       IF(IMAP(NX,NY).EQ.0) THEN
   1640          IMAP(NX,NY) = LASTN
   1641       ELSE
   1642          LASTN = IMAP(NX,NY)
   1643       ENDIF
   1644 40    CONTINUE
   1645 
   1646       RETURN
   1647       END

Page 37          Source Listing                  MAKEAMAP
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                 
                       
 makeamap_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  1063                                                           1061                              
 10                         Label  1076                                                           1069,1070                         
 20                         Label  1089                                                           1082,1083                         
 30                         Label  1115                                                           1111                              
 40                         Label  1128                                                           1121,1122                         
 CKLIST                     Common 1052                                 4400004                                                     
 FFE                        Scalar 1046     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 1043     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 1041     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 1041     R(4)            4     1     900000   COM              1062,1071,1112                    
 FLT                        Scalar 1040     R(4)            4     1     900000   COM              1084,1113                         
 FLV                        Scalar 1040     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 1042     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 1042     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 1042     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 1045     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 1047     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 1046     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 1045     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 1047     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 1044     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 1044     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 1044     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 1043     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 1043     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 1045     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 1041     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 1047     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 1046     R(4)            4     1     1100000  COM                                                
 IMAP                       Scalar 1051     I(4)            4     2     65160    COM              1109,1114,1123,1124,1126          
 INDD                       Scalar 1052     I(4)            4     1     1100000  COM              1074,1084,1087                    
 INOB                       Scalar 1051     I(4)            4     1     900000   COM              1087,1112,1113                    
 IX                         Local  1071     I(4)            4           scalar                    1071,1072                         
 IY                         Local  1084     I(4)            4           scalar                    1084,1085                         
 LASTN                      Local  1120     I(4)            4           scalar                    1120,1124,1126                    
 MAKEAMAP                   Subr   1035                                                                                             
 MAXLEV                     Param  1038     I(4)            4           scalar                    1043,1044,1045,1046,1047,1052     
 MAXREP                     Param  1037     I(4)            4           scalar                    1040,1041,1042,1043,1047,1051     
 N                          Local  1061     I(4)            4           scalar                    1061,1062,1070,1071,1074,1083,1084
                                                                                                  ,1087,1111,1112,1113,1114         
 NDD                        Scalar 1052     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 1051     I(4)            4           scalar   COM                                                
 NN                         Local  1068     I(4)            4           scalar                    1068,1073,1074,1083,1094          
 NOB                        Local  1081     I(4)            4           scalar                    1081,1086,1087,1094,1111,1120     

Page 38          Source Listing                  MAKEAMAP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NREP                       Scalar 1051     I(4)            4           scalar   COM              1061,1070,1094                    
 NX                         Local  1069     I(4)            4           scalar                    1069,1072,1112,1114,1122,1123,1124
                                                                                                  ,1126                             
 NY                         Local  1082     I(4)            4           scalar                    1082,1085,1113,1114,1121,1123,1124
                                                                                                  ,1126                             
 OBS                        Common 1051                                 11060648                                                    
 OIQCDATA                   Common 1040                                 22790000                                                    
                                                                        0                                                           
 SID                        Scalar 1051     R(8)            8     1     900000   COM                                                

Page 39          Source Listing                  MAKEAMAP
2017-04-18 11:07                                 oiqcbufr.f

   1648 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1649 C
   1650 C SUBPROGRAM:    OBOGRAM
   1651 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   1652 C
   1653 C ABSTRACT: EXAMINES THE RESULTS OF FINAL QC DECISIONS AND MAKES TABLES
   1654 C   OF STATISTICS FOR ACCEPTED AND REJECTED REPORTS BY REPORT TYPE AND
   1655 C   LEVEL.
   1656 C
   1657 C PROGRAM HISTORY LOG:
   1658 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   1659 C
   1660 C USAGE:    CALL OBOGRAM(LDAT,LASC,LBIN)
   1661 C   INPUT ARGUMENT LIST:
   1662 C     LDAT     - LOGICAL UNIT FOR NCEP PRODUCTION DATE FILE
   1663 C     LASC     - LOGICAL UNIT FOR OUTPUT ASCII FILE
   1664 C     LBIN     - LOGICAL UNIT FOR OUTPUT BINARY FILE
   1665 C
   1666 C   INPUT FILES:
   1667 C     UNIT LDAT  - NCEP PRODUCTION DATE FILE
   1668 C
   1669 C   OUTPUT FILES:
   1670 C     UNIT 06    - STANDARD OUTPUT PRINT
   1671 C     UNIT LASC  - SUMMARY OF QC RESULTS (ASCII)
   1672 C     UNIT LBIN  - SUMMARY OF QC RESULTS (BINARY)
   1673 C
   1674 C REMARKS: NONE.
   1675 C
   1676 C ATTRIBUTES:
   1677 C   LANGUAGE: FORTRAN 90
   1678 C   MACHINE:  NCEP WCOSS
   1679 C
   1680 C$$$
   1681       SUBROUTINE OBOGRAM(LDAT,LASC,LBIN)
   1682 
   1683       PARAMETER (MAXREP=900000)
   1684       PARAMETER (MAXLEV=1100000)
   1685 
   1686       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   1687      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   1688      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   1689      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   1690      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   1691      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   1692      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   1693      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   1694       CHARACTER*3 FOC
   1695 
   1696 
   1697       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   1698       COMMON /OBERRS/ QIKE(21,300),PMAND(21),P50(21),CHL(21)
   1699 
   1700       CHARACTER*3 AR(2),TAG
   1701       DIMENSION STAT(300,15,6,2,2,3),IOBS(300),RZONE(6)
   1702       LOGICAL QOBS(300,6)
   1703       REAL*8 SID
   1704 

Page 40          Source Listing                  OBOGRAM
2017-04-18 11:07                                 oiqcbufr.f

   1705       DATA AR/'ACC','REJ'/
   1706       DATA XMSG/32767./
   1707 
   1708 C----------------------------------------------------------------------
   1709 C-----------------------------------------------------------------------
   1710 
   1711       REWIND (LDAT)
   1712       READ(LDAT,1) NMCDATE
   1713 1     FORMAT(8X,I8)
   1714       WRITE(LASC,*)
   1715       WRITE(LASC,*)' STATS FOR OBS CHECKED ',NMCDATE
   1716       WRITE(LASC,*)
   1717 
   1718 C  START UP
   1719 C  --------
   1720 
   1721       QOBS = .FALSE.
   1722       STAT = 0
   1723 
   1724 C  GO THROUGH THE BIG BUFFER TO COUNT OBS FOR OBOGRAM
   1725 C  --------------------------------------------------
   1726 
   1727       DO 10 IREP=1,NREP
   1728       X     = FLN(IREP)
   1729       Y     = FLT(IREP)
   1730       KX    = FKX(IREP)
   1731       KK    = KX/100
   1732       LB    = MIN(IFIX((Y+90.)/30.+1.),6)
   1733 
   1734       TAG   = FOC(IREP)
   1735       IF(TAG.EQ.'SFC')  FNL(IREP) = 2
   1736 
   1737       ILEV  = FLV(IREP)
   1738       KLEV  = ILEV+FNL(IREP)-1
   1739 
   1740 C  GO THROUGH LEVELS FOR ACCEPT REJECT STATISTICS
   1741 C  ----------------------------------------------
   1742 
   1743       DO 10 JLEV=ILEV,KLEV
   1744       IF(FOI(JLEV).NE.0) THEN
   1745 
   1746          IF(FOI(JLEV).EQ.1) THEN
   1747             IAR = 1
   1748          ELSE IF(FOI(JLEV).EQ.-1) THEN
   1749             IAR = 2
   1750          ELSE
   1751             GOTO 10
   1752          ENDIF
   1753 
   1754          BUFF11 = FOB(JLEV,1)
   1755          BUFF12 = FOB(JLEV,2)
   1756 
   1757          IF(TAG.EQ.'SFC' .AND. JLEV.EQ.KLEV) THEN
   1758             KX = KX - 100
   1759          ELSE
   1760             IF(KK.EQ.1) BUFF12 = BUFF11
   1761          ENDIF

Page 41          Source Listing                  OBOGRAM
2017-04-18 11:07                                 oiqcbufr.f

   1762 
   1763          QOBS(KX,LB) = .TRUE.
   1764 
   1765          PP = FPR(JLEV)
   1766 
   1767          DO 5 L=1,15
   1768          IF(L.EQ.1) THEN
   1769             IF(PP.GT.(PMAND(L)+PMAND(L+1))/2.) GOTO 6
   1770          ELSE IF(L.EQ.15) THEN
   1771             IF(PP.LE.(PMAND(L)+PMAND(L-1))/2.) GOTO 6
   1772          ELSE
   1773             IF(PP.GT.(PMAND(L)+PMAND(L+1))/2. .AND.
   1774      .         PP.LE.(PMAND(L)+PMAND(L-1))/2.) GOTO 6
   1775          ENDIF
   1776 5        CONTINUE
   1777          PRINT *, 'OBOGRAM - UNABLE TO LOCATE DATA LEVEL'
   1778          CALL W3TAGE('PREPOBS_OIQCBUFR')
   1779          CALL ERREXIT(99)
   1780 6        CONTINUE
   1781 
   1782          IF(KK.EQ.1) THEN
   1783             STAT(KX,L,LB,IAR,1,1) = STAT(KX,L,LB,IAR,1,1) + 1.
   1784             STAT(KX,L,LB,IAR,1,2) = STAT(KX,L,LB,IAR,1,2) + BUFF12
   1785             STAT(KX,L,LB,IAR,1,3) = STAT(KX,L,LB,IAR,1,3) + BUFF12**2
   1786          ELSE
   1787             STAT(KX,L,LB,IAR,1,1) = STAT(KX,L,LB,IAR,1,1) + 1.
   1788             STAT(KX,L,LB,IAR,1,2) = STAT(KX,L,LB,IAR,1,2) + BUFF11
   1789             STAT(KX,L,LB,IAR,1,3) = STAT(KX,L,LB,IAR,1,3) + BUFF11**2
   1790             STAT(KX,L,LB,IAR,2,1) = STAT(KX,L,LB,IAR,2,1) + 1.
   1791             STAT(KX,L,LB,IAR,2,2) = STAT(KX,L,LB,IAR,2,2) + BUFF12
   1792             STAT(KX,L,LB,IAR,2,3) = STAT(KX,L,LB,IAR,2,3) + BUFF12**2
   1793          ENDIF
   1794 
   1795       ENDIF
   1796 
   1797 10    CONTINUE
   1798 
   1799 C  COMPUTE THE AVERAGES FOR MEAN AND RMS'S (VECTOR SUMS FOR WINDS)
   1800 C  ---------------------------------------------------------------
   1801 
   1802       DO 20 KX=1,299
   1803       KK = MAX(KX/100,1)
   1804       DO 20 L=1,15
   1805       DO 20 LB=1,6
   1806       DO 20 IAR=1,2
   1807       DO 20 KKX=1,KK
   1808       N = STAT(KX,L,LB,IAR,KKX,1)
   1809       IF(N.NE.0) THEN
   1810          BIAS = STAT(KX,L,LB,IAR,KKX,2)/N
   1811          STAT(KX,L,LB,IAR,KKX,2) = BIAS
   1812          RMS  = SQRT(STAT(KX,L,LB,IAR,KKX,3)/N)
   1813          STAT(KX,L,LB,IAR,KKX,3) = RMS
   1814          IF(KKX.EQ.2) THEN
   1815          STAT(KX,L,LB,IAR,1,2) = SQRT(STAT(KX,L,LB,IAR,1,2)**2+BIAS**2)
   1816          STAT(KX,L,LB,IAR,1,3) = SQRT(STAT(KX,L,LB,IAR,1,3)**2+ RMS**2)
   1817          ENDIF
   1818       ENDIF

Page 42          Source Listing                  OBOGRAM
2017-04-18 11:07                                 oiqcbufr.f

   1819 20    CONTINUE
   1820 
   1821 C  PRINT THE TOTAL, MEAN, AND RMS FOR ACCEPTS AND REJECTS
   1822 C  ------------------------------------------------------
   1823 
   1824       DO 35 KX=1,300
   1825       DO 35 LB=1,6
   1826       IF(QOBS(KX,LB)) THEN
   1827          KK = KX/100
   1828          WRITE(LASC,*)'------ZONE ',LB,' KX ',KX,' VAR ',KK,'------'
   1829          DO 30 IAR=1,2
   1830          WRITE(LASC,2000) AR(IAR),(STAT(KX,L,LB,IAR,1,1),L=1,15)
   1831          WRITE(LASC,2001) AR(IAR),(STAT(KX,L,LB,IAR,1,2),L=1,15)
   1832          WRITE(LASC,2002) AR(IAR),(STAT(KX,L,LB,IAR,1,3),L=1,15)
   1833          WRITE(LASC,2003)
   1834 30       CONTINUE
   1835       ENDIF
   1836 35    CONTINUE
   1837 
   1838 C  PRINT THE TOTAL REJECTED OB BY TYPE ZONE LEVEL
   1839 C  ----------------------------------------------
   1840 
   1841       WRITE(LASC,*)
   1842       WRITE(LASC,*) ' NUMBER OF OBS REJECTED BY OB TYPE, AND ZONE'
   1843       WRITE(LASC,*)
   1844 
   1845       DO 45 KX=1,300
   1846       IF(QOBS(KX,1).OR.QOBS(KX,2).OR.QOBS(KX,3).OR.QOBS(KX,4).OR.
   1847      .   QOBS(KX,5).OR.QOBS(KX,6)) THEN
   1848          RZONE = 0
   1849          DO 40 LB=1,6
   1850          DO 40 L=1,15
   1851          RZONE(LB) = STAT(KX,L,LB,2,1,1) + RZONE(LB)
   1852 40       CONTINUE
   1853          WRITE(LASC,2004)KX,(RZONE(LB),LB=1,6)
   1854       ENDIF
   1855 45    CONTINUE
   1856 
   1857 C  WRITE A BINARY VERSION OF THE OBOGRAM
   1858 C  -------------------------------------
   1859 
   1860       I = 0
   1861       DO 55 KX=1,300
   1862       DO 50 LB=1,6
   1863       IF(QOBS(KX,LB)) THEN
   1864          I = I+1
   1865          IOBS(I) = KX
   1866          GOTO 55
   1867       ENDIF
   1868 50    CONTINUE
   1869 55    CONTINUE
   1870 
   1871       WRITE(LBIN) NMCDATE,
   1872      .          I,(IOBS(II),((((STAT(IOBS(II),LEV,LB,IAR,1,IST),
   1873      .          LEV=1,15),
   1874      .          IST=1,3),
   1875      .          IAR=1,2),

Page 43          Source Listing                  OBOGRAM
2017-04-18 11:07                                 oiqcbufr.f

   1876      .          LB=1,6),
   1877      .          II=1,I)
   1878 
   1879 C  FORMAT STATEMENTS FOR THE OBOGRAM
   1880 C  ---------------------------------
   1881 
   1882 2000  FORMAT('TOTAL ',A3,15F6.1)
   1883 2001  FORMAT('MEAN  ',A3,15F6.1)
   1884 2002  FORMAT('RMS   ',A3,15F6.1)
   1885 2003  FORMAT('        ')
   1886 2004  FORMAT(I5,6F8.1)
   1887 
   1888       RETURN
   1889       END


ENTRY POINTS

  Name                
                      
 obogram_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  1197                                                           1196                              
 10                         Label  1281                                                           1211,1227,1235                    
 20                         Label  1303                                                           1286,1288,1289,1290,1291          
 2000                       Label  1366                                                           1314                              
 2001                       Label  1367                                                           1315                              
 2002                       Label  1368                                                           1316                              
 2003                       Label  1369                                                           1317                              
 2004                       Label  1370                                                           1337                              
 30                         Label  1318                                                           1313                              
 35                         Label  1320                                                           1308,1309                         
 40                         Label  1336                                                           1333,1334                         
 45                         Label  1339                                                           1329                              
 5                          Label  1260                                                           1251                              
 50                         Label  1352                                                           1346                              
 55                         Label  1353                                                           1345,1350                         
 6                          Label  1264                                                           1253,1255,1258                    
 AR                         Local  1184     CHAR            3     1     2                         1189,1314,1315,1316               
 BIAS                       Local  1294     R(4)            4           scalar                    1294,1295,1299                    
 BUFF11                     Local  1238     R(4)            4           scalar                    1238,1244,1272,1273               
 BUFF12                     Local  1239     R(4)            4           scalar                    1239,1244,1268,1269,1275,1276     
 CHL                        Scalar 1182     R(4)            4     1     21       COM                                                
 ERREXIT                    Subr   1263                                                           1263                              
 FFE                        Scalar 1176     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 1173     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 1171     R(4)            4     1     900000   COM              1214                              
 FLN                        Scalar 1171     R(4)            4     1     900000   COM              1212                              
 FLT                        Scalar 1170     R(4)            4     1     900000   COM              1213                              
 FLV                        Scalar 1170     R(4)            4     1     900000   COM              1221                              
 FMS                        Scalar 1172     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 1172     R(4)            4     2     1800000  COM                                                

Page 44          Source Listing                  OBOGRAM
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FNL                        Scalar 1172     R(4)            4     1     900000   COM              1219,1222                         
 FOB                        Scalar 1175     R(4)            4     2     2200000  COM              1238,1239                         
 FOC                        Scalar 1177     CHAR            3     1     900000   COM              1218                              
 FOE                        Scalar 1176     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 1175     R(4)            4     1     1100000  COM              1228,1230,1232                    
 FPF                        Scalar 1177     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 1174     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 1174     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 1174     R(4)            4     1     1100000  COM              1249                              
 FPRC                       Scalar 1173     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 1173     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 1175     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 1171     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 1177     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 1176     R(4)            4     1     1100000  COM                                                
 I                          Local  1344     I(4)            4           scalar                    1344,1348,1349,1356,1361          
 IAR                        Local  1231     I(4)            4           scalar                    1231,1233,1267,1268,1269,1271,1272
                                                                                                  ,1273,1274,1275,1276,1290,1292,129
                                                                                                  4,1295,1296,1297,1299,1300,1313,13
                                                                                                  14,1315,1316,1356,1359            
 IFIX                       Func   1216                                 scalar                    1216                              
 II                         Local  1356     I(4)            4           scalar                    1356,1361                         
 ILEV                       Local  1221     I(4)            4           scalar                    1221,1222,1227                    
 IMAP                       Scalar 1181     I(4)            4     2     65160    COM                                                
 INOB                       Scalar 1181     I(4)            4     1     900000   COM                                                
 IOBS                       Local  1185     I(4)            4     1     300                       1349,1356                         
 IREP                       Local  1211     I(4)            4           scalar                    1211,1212,1213,1214,1218,1219,1221
                                                                                                  ,1222                             
 IST                        Local  1356     I(4)            4           scalar                    1356,1358                         
 JLEV                       Local  1227     I(4)            4           scalar                    1227,1228,1230,1232,1238,1239,1241
                                                                                                  ,1249                             
 KK                         Local  1215     I(4)            4           scalar                    1215,1244,1266,1287,1291,1311,1312
 KKX                        Local  1291     I(4)            4           scalar                    1291,1292,1294,1295,1296,1297,1298
 KLEV                       Local  1222     I(4)            4           scalar                    1222,1227,1241                    
 KX                         Local  1214     I(4)            4           scalar                    1214,1215,1242,1247,1267,1268,1269
                                                                                                  ,1271,1272,1273,1274,1275,1276,128
                                                                                                  6,1287,1292,1294,1295,1296,1297,12
                                                                                                  99,1300,1308,1310,1311,1312,1314,1
                                                                                                  315,1316,1329,1330,1331,1335,1337,
                                                                                                  1345,1347,1349                    
 L                          Local  1251     I(4)            4           scalar                    1251,1252,1253,1254,1255,1257,1258
                                                                                                  ,1267,1268,1269,1271,1272,1273,127
                                                                                                  4,1275,1276,1288,1292,1294,1295,12
                                                                                                  96,1297,1299,1300,1314,1315,1316,1
                                                                                                  334,1335                          
 LASC                       Dummy  1165     I(4)            4           scalar   ARG,INOUT        1198,1199,1200,1312,1314,1315,1316
                                                                                                  ,1317,1325,1326,1327,1337         
 LB                         Local  1216     I(4)            4           scalar                    1216,1247,1267,1268,1269,1271,1272
                                                                                                  ,1273,1274,1275,1276,1289,1292,129
                                                                                                  4,1295,1296,1297,1299,1300,1309,13
                                                                                                  10,1312,1314,1315,1316,1333,1335,1
                                                                                                  337,1346,1347,1356,1360           
 LBIN                       Dummy  1165     I(4)            4           scalar   ARG,INOUT        1355                              
 LDAT                       Dummy  1165     I(4)            4           scalar   ARG,INOUT        1195,1196                         
 LEV                        Local  1356     I(4)            4           scalar                    1356,1357                         

Page 45          Source Listing                  OBOGRAM
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAX                        Func   1287                                 scalar                    1287                              
 MAXLEV                     Param  1168     I(4)            4           scalar                    1173,1174,1175,1176,1177          
 MAXREP                     Param  1167     I(4)            4           scalar                    1170,1171,1172,1173,1177,1181     
 MIN                        Func   1216                                 scalar                    1216                              
 N                          Local  1292     I(4)            4           scalar                    1292,1293,1294,1296               
 NLEV                       Scalar 1181     I(4)            4           scalar   COM                                                
 NMCDATE                    Local  1196     I(4)            4           scalar                    1196,1199,1355                    
 NREP                       Scalar 1181     I(4)            4           scalar   COM              1211                              
 OBERRS                     Common 1182                                 25452                                                       
 OBOGRAM                    Subr   1165                                                                                             
 OBS                        Common 1181                                 11060648                                                    
 OIQCDATA                   Common 1170                                 22790000                                                    
                                                                        0                                                           
 P50                        Scalar 1182     R(4)            4     1     21       COM                                                
 PMAND                      Scalar 1182     R(4)            4     1     21       COM              1253,1255,1257,1258               
 PP                         Local  1249     R(4)            4           scalar                    1249,1253,1255,1257,1258          
 QIKE                       Scalar 1182     R(4)            4     2     6300     COM                                                
 QOBS                       Local  1186     L(4)            4     2     1800                      1205,1247,1310,1330,1331,1347     
 RMS                        Local  1296     R(4)            4           scalar                    1296,1297,1300                    
 RZONE                      Local  1185     R(4)            4     1     6                         1332,1335,1337                    
 SID                        Scalar 1181     R(8)            8     1     900000   COM                                                
 SQRT                       Func   1296                                 scalar                    1296,1299,1300                    
 STAT                       Local  1185     R(4)            4     6     324000                    1206,1267,1268,1269,1271,1272,1273
                                                                                                  ,1274,1275,1276,1292,1294,1295,129
                                                                                                  6,1297,1299,1300,1314,1315,1316,13
                                                                                                  35,1356                           
 TAG                        Local  1184     CHAR            3           scalar                    1218,1219,1241                    
 W3TAGE                     Subr   1262                                                           1262                              
 X                          Local  1212     R(4)            4           scalar                    1212                              
 XMSG                       Local  1190     R(4)            4           scalar                    1190                              
 Y                          Local  1213     R(4)            4           scalar                    1213,1216                         

Page 46          Source Listing                  OBOGRAM
2017-04-18 11:07                                 oiqcbufr.f

   1890 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1891 C
   1892 C SUBPROGRAM:    OUTPUT
   1893 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   1894 C
   1895 C ABSTRACT: EXAMINES OUTPUTS FROM OI QUALITY CONTROL INTERPOLATION AND
   1896 C   MAKES DECISION WHETHER AN OB PASSES OR FAILS THE CHECKS. ALSO
   1897 C   PROVIDES FOR A DETAILED PRINT TRACING ALL DECISIONS MADE IN REGARD
   1898 C   TO SPECIFIED OBSERVATIONS IN THE QC PROCESS.
   1899 C
   1900 C PROGRAM HISTORY LOG:
   1901 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   1902 C
   1903 C USAGE:    CALL OUTPUT
   1904 C   OUTPUT FILES:
   1905 C     UNIT 06  - STANDARD OUTPUT PRINT
   1906 C     UNIT 71  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1907 C     UNIT 72  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1908 C     UNIT 73  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1909 C     UNIT 74  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1910 C     UNIT 75  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1911 C     UNIT 76  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1912 C     UNIT 77  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1913 C     UNIT 78  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1914 C     UNIT 79  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1915 C     UNIT 80  - DETAILED PRINTOUTS FOR QC DIAGNOSIS (IPOINT IN UNIT 18)
   1916 C     UNIT ITUNIT  - DETAILED TOSSLIST (SEE REMARKS)
   1917 C
   1918 C REMARKS: POSSIBLE VALUES FOR ITUNIT (PASSED IN VIA COMMMON
   1919 C   /TOSSUNIT/):
   1920 C     61 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR SURFACE HEIGHTS
   1921 C     62 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR TEMPS AND WINDS
   1922 C     63 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR SAT TEMPS
   1923 C     64 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR SSMI WIND SPEEDS
   1924 C
   1925 C ATTRIBUTES:
   1926 C   LANGUAGE: FORTRAN 90
   1927 C   MACHINE:  NCEP WCOSS
   1928 C
   1929 C$$$
   1930       SUBROUTINE OUTPUT
   1931 
   1932       PARAMETER (MAXREP=900000)
   1933       PARAMETER (MAXLEV=1100000)
   1934 
   1935       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   1936      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   1937      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   1938      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   1939      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   1940      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   1941      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   1942      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   1943       CHARACTER*3 FOC
   1944 
   1945       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   1946      .                     MDIM(64,4),AA(64,4,2),

Page 47          Source Listing                  OUTPUT
2017-04-18 11:07                                 oiqcbufr.f

   1947      .                     AE(64,4,2),WT(64,10,4,2),
   1948      .                     FE(64,3)
   1949 
   1950       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   1951       COMMON /TOLLER  / ITER,TB,TZ,TSAT,TWND,TJET
   1952       COMMON /OBPRT   / NPT,SIDP(10),PRP(10),KXP(10)
   1953       COMMON /TOSSUNIT/ ITUNIT
   1954 
   1955 
   1956       DIMENSION IOMF(3),D(4),DRES(4),NDIM(4),STR(2)
   1957       DIMENSION DU(4),DV(4),TWT(4),TWU(4),TWV(4)
   1958       CHARACTER*8 CKEEP,CHECK(5)
   1959       CHARACTER*3 TAG
   1960       CHARACTER*1 VAR2(2),VAR3(3)
   1961       LOGICAL KEEP
   1962       REAL*8 SID,CKSTA
   1963 
   1964       DATA CHECK/'Z MATRIX','U MATRIX','V MATRIX','VERTICAL','MULTIVAR'/
   1965       DATA VAR2 / 'Z' , 'W' /
   1966       DATA VAR3 / 'Z' , 'U' , 'V' /
   1967       DATA IOMF /  2  ,  1  ,  2  /
   1968 
   1969 
   1970       CHARACTER*1 PLUMIN
   1971       DATA PI180/.017453/
   1972 
   1973 C----------------------------------------------------------------------
   1974 C----------------------------------------------------------------------
   1975 
   1976       D   = 0.
   1977       DU  = 0.
   1978       DV  = 0.
   1979       TWT = 0.
   1980       TWU = 0.
   1981       TWV = 0.
   1982 
   1983 C  LOOP OVER EACH OB CHECKED IN THIS GROUP
   1984 C  ---------------------------------------
   1985 
   1986       DO 50 N=1,NXXYY
   1987       I     = MCHK(N,1)
   1988       J     = MCHK(N,2)
   1989       II    = FHD(I)
   1990       PRES  = FPR(I)
   1991       OBER  = FOE(I)
   1992       CKSTA = SID(II)
   1993       CLON  = FLN(II)
   1994       CLAT  = FLT(II)
   1995       KX    = FKX(II)
   1996       TAG   = FOC(II)
   1997 
   1998 C  LOOK FOR A KEEP FLAG
   1999 C  --------------------
   2000 
   2001       IQM = FQM(I)
   2002       IF(IQM.EQ.0) THEN
   2003          KEEP  = .TRUE.

Page 48          Source Listing                  OUTPUT
2017-04-18 11:07                                 oiqcbufr.f

   2004          CKEEP = '  KEEP'
   2005       ELSE
   2006          KEEP = .FALSE.
   2007          CKEEP = ' '
   2008       ENDIF
   2009 
   2010 C  LOOP OVER THE VARIABLE(S) IN EACH OB
   2011 C  ------------------------------------
   2012 
   2013       DO 45 K=J,2*J-1
   2014       KK     = K-J+1
   2015       OMF    = FOB(I,IOMF(K))
   2016       AMFSUM = 0.
   2017       SUMWTS = 0.
   2018       QC     = 0.
   2019 
   2020 C  LOOP OVER THE OUTCOME OF EACH TYPE OF CHECK (MICRO DECISION MAKER)
   2021 C  ------------------------------------------------------------------
   2022 
   2023       DO 20 L=1,4
   2024       AER = AE(N,L,KK)
   2025       FER = FE(N,K)
   2026       AMF = AA(N,L,KK)
   2027       DRES(L) = OMF-AMF
   2028       D(L) = DRES(L)/SQRT(OBER**2+AER**2)
   2029       AWT = 1.-(AER/FER)**2
   2030       TWT(L) = MAX(.01,AWT)
   2031       QC     = QC     + TWT(L)*D(L)**2
   2032       SUMWTS = SUMWTS + TWT(L)
   2033       IF(L.LT.4) AMFSUM = AMFSUM + TWT(L)*AMF
   2034 20    CONTINUE
   2035 
   2036       AMFSUM = AMFSUM/(SUMWTS-TWT(4))
   2037       QC     = SQRT(QC/SUMWTS)
   2038       TWT    = TWT/SUMWTS
   2039 
   2040 C  FOR WINDS CHECK THE VECTOR SUM OF AGAINST THE REFERENCE
   2041 C  -------------------------------------------------------
   2042 
   2043       IF(K.EQ.1) THEN
   2044          OMA = OMF - AMFSUM
   2045       ELSE
   2046          IF(K.EQ.2) THEN
   2047             DU  = D
   2048             TWU = TWT
   2049             QCU = QC
   2050             OMAU = OMF - AMFSUM
   2051             OMFU = OMF
   2052             GOTO 45
   2053          ELSE IF(K.EQ.3) THEN
   2054             DV   = D
   2055             TWV  = TWT
   2056             QCV  = QC
   2057             OMAV = OMF - AMFSUM
   2058             OMFV = OMF
   2059             D    = SQRT(DU**2+DV**2)
   2060             TWT  = SQRT(TWU**2+TWV**2)

Page 49          Source Listing                  OUTPUT
2017-04-18 11:07                                 oiqcbufr.f

   2061             QC   = SQRT(QCU**2+QCV**2)
   2062             OMA  = SQRT(OMAU**2+OMAV**2)
   2063             OMF  = SQRT(OMFU**2+OMFV**2)
   2064          ELSE
   2065             PRINT *, 'OUTPUT - K<>1,2,OR,3'
   2066             CALL W3TAGE('PREPOBS_OIQCBUFR')
   2067             CALL ERREXIT(99)
   2068          ENDIF
   2069       ENDIF
   2070 
   2071 C  ADJUST THE TOLERANCE BY LOCATION AND VARIABLE
   2072 C  ---------------------------------------------
   2073 
   2074       IF(K.EQ.1) THEN
   2075          SINLAT = (SIN(ABS(CLAT)*PI180))
   2076          TT = TB*TZ*SINLAT
   2077          TMIN = 2.0
   2078       ELSE
   2079          GNP = MIN(ABS(CLAT/30.),1.)
   2080          IF(PRES.LE.400. .AND. PRES.GE.150.) THEN
   2081             TT = TB*TJET*GNP
   2082          ELSE
   2083             TT = TB*TWND*GNP
   2084          ENDIF
   2085          TMIN = 3.
   2086       ENDIF
   2087 
   2088       TT = MAX(TMIN,TT)
   2089 
   2090       IF(TAG.EQ.'SMI') TT = TT/SQRT(2.)
   2091 
   2092 C  COMPUTE THE MULTIVARIATE REDUCTION RATIO AND ADJUST THE SUM
   2093 C  -----------------------------------------------------------
   2094 
   2095       IF(OMF.NE.0.) THEN
   2096          QCPC = MIN(MAX(ABS(OMA/OMF),.1),1.)
   2097          TTT = TT/QCPC
   2098       ELSE
   2099          TTT = TT
   2100       ENDIF
   2101 
   2102 C  COMPUTE THE NORMALIZED DEVIATION FROM THE FIRST GUESS
   2103 C  -----------------------------------------------------
   2104 
   2105       SDOMF = SQRT(OMF**2/(OBER**2+FER**2))
   2106 
   2107 C  MAKE A MESO DECISION FOR THIS ITERATION
   2108 C  ---------------------------------------
   2109 
   2110       IF(QC.GT.TTT) THEN
   2111          KEEP = KEEP .AND. QC.LT.25.
   2112          IF(.NOT.KEEP) THEN
   2113             FOI(I) = -1
   2114             PLUMIN = '-'
   2115          ELSE
   2116             FOI(I) = 1
   2117             PLUMIN = '+'

Page 50          Source Listing                  OUTPUT
2017-04-18 11:07                                 oiqcbufr.f

   2118          ENDIF
   2119          WRITE(ITUNIT,100)CKSTA,KX,CLON,CLAT,PRES,VAR2(J),OMF,SDOMF,
   2120      .                    (D(L),TWT(L),L=1,4),QC,TTT,CKEEP,PLUMIN
   2121       ELSE
   2122          FOI(I) = 1
   2123          PLUMIN = '+'
   2124       ENDIF
   2125 
   2126 C  THIS WRITES DETAILED INFO ABOUT AN OB
   2127 C  -------------------------------------
   2128 
   2129       DO 41 NN=1,NPT
   2130       LU = 70 + NN
   2131       pdif = abs(pres-prp(nn))
   2132       IF(CKSTA.EQ.SIDP(NN).AND.pdif.lt..1.AND.KX.EQ.KXP(NN)) THEN
   2133          WRITE(LU,100)CKSTA,KX,CLON,CLAT,PRES,VAR2(J),OMF,SDOMF,
   2134      .                (D(L),TWT(L),L=1,4),QC,TTT,CKEEP,PLUMIN
   2135          DO 44 KK=J,J*2-1
   2136          WRITE(LU,*) 'ITERATION=',ITER,' CHECK ON ',VAR3(KK)
   2137          IF(KK.EQ.2) THEN
   2138             SDOMF = SQRT(OMFU**2/(OBER**2+FER**2))
   2139             IF(TT.EQ.TTT) TTTT = TT
   2140             IF(TT.NE.TTT) TTTT = TT/ABS(OMAU/OMFU)
   2141             WRITE(LU,100)CKSTA,KX,CLON,CLAT,PRES,VAR3(KK),OMFU,SDOMF,
   2142      .                   (DU(L),TWU(L),L=1,4),QCU,TTTT,CKEEP
   2143          ELSE IF(KK.EQ.3) THEN
   2144             SDOMF = SQRT(OMFV**2/(OBER**2+FER**2))
   2145             IF(TT.EQ.TTT) TTTT = TT
   2146             IF(TT.NE.TTT) TTTT = TT/ABS(OMAV/OMFV)
   2147             WRITE(LU,100)CKSTA,KX,CLON,CLAT,PRES,VAR3(KK),OMFV,SDOMF,
   2148      .                   (DV(L),TWV(L),L=1,4),QCV,TTTT,CKEEP
   2149          ENDIF
   2150          DO 44 L=1,4
   2151          WRITE(LU,*)CHECK(L),' FOR CHECK ON ',VAR3(KK),' DATUM '
   2152          SOINC = 0.
   2153          DO 43 IOB=1,MDIM(N,L)
   2154          ILEV = MOBS(N,IOB,L,1)
   2155          KIV  = MOBS(N,IOB,L,2)
   2156          KI2  = MAX(KIV-1,1)
   2157          IREP = FHD(ILEV)
   2158          X  = FLN(IREP)
   2159          Y  = FLT(IREP)
   2160          KIX  = FKX(IREP)
   2161          PPP  = FPR(ILEV)
   2162          OMF0 = FOB(ILEV,IOMF(KIV))
   2163          OIWT = WT(N,IOB,L,KI2)
   2164          OINC = OIWT*OMF0
   2165          OMA0 = AA(N,L,KI2)
   2166          AER0 = AE(N,L,KI2)
   2167          WRITE(LU,102)SID(IREP),KIX,X,Y,PPP,VAR3(KIV),OMF0,OIWT,OINC,
   2168      .                OMA0,AER0
   2169          SOINC  = SOINC+OINC
   2170  43      CONTINUE
   2171          WRITE(LU,*) 'INTERPOLATED VALUE=',SOINC
   2172  44      CONTINUE
   2173       ENDIF
   2174  41   CONTINUE

Page 51          Source Listing                  OUTPUT
2017-04-18 11:07                                 oiqcbufr.f

   2175 
   2176 
   2177 45    CONTINUE
   2178 50    CONTINUE
   2179 
   2180 100   FORMAT(A8,I4,2F7.2,F8.2,A4,2F8.2,4(' *',F6.1,' (',F5.2,')' ),
   2181      .       ' *',2F6.2,A6,A1)
   2182 101   FORMAT(A8,I4,2F7.2,F8.2,A4,2F8.2,4(' *',F6.1,2X,I2),' *',2F6.2,A6,
   2183      . A1)
   2184 102   FORMAT(A8,I4,2F7.2,F8.2,A4,6F8.2)
   2185 
   2186       RETURN
   2187       END


ENTRY POINTS

  Name               
                     
 output_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1664                                                           1603,1617,1625,1631               
 101                        Label  1666                                                                                             
 102                        Label  1668                                                           1651                              
 20                         Label  1518                                                           1507                              
 41                         Label  1658                                                           1613                              
 43                         Label  1654                                                           1637                              
 44                         Label  1656                                                           1619,1634                         
 45                         Label  1661                                                           1497,1536                         
 50                         Label  1662                                                           1470                              
 AA                         Scalar 1430     R(4)            4     3     512      COM              1510,1649                         
 ABS                        Func   1559                                 scalar                    1559,1563,1580,1615,1624,1630     
 AE                         Scalar 1431     R(4)            4     3     512      COM              1508,1650                         
 AER                        Local  1508     R(4)            4           scalar                    1508,1512,1513                    
 AER0                       Local  1650     R(4)            4           scalar                    1650,1652                         
 AMF                        Local  1510     R(4)            4           scalar                    1510,1511,1517                    
 AMFSUM                     Local  1500     R(4)            4           scalar                    1500,1517,1520,1528,1534,1541     
 AWT                        Local  1513     R(4)            4           scalar                    1513,1514                         
 CHECK                      Local  1442     CHAR            8     1     5                         1448,1635                         
 CKEEP                      Local  1442     CHAR            8           scalar                    1488,1491,1604,1618,1626,1632     
 CKSTA                      Local  1446     R(8)            8           scalar                    1476,1603,1616,1617,1625,1631     
 CLAT                       Local  1478     R(4)            4           scalar                    1478,1559,1563,1603,1617,1625,1631
 CLON                       Local  1477     R(4)            4           scalar                    1477,1603,1617,1625,1631          
 D                          Local  1440     R(4)            4     1     4                         1460,1512,1515,1531,1538,1543,1604
                                                                                                  ,1618                             
 DRES                       Local  1440     R(4)            4     1     4                         1511,1512                         
 DU                         Local  1441     R(4)            4     1     4                         1461,1531,1543,1626               
 DV                         Local  1441     R(4)            4     1     4                         1462,1538,1543,1632               
 ERREXIT                    Subr   1551                                                           1551                              
 FE                         Scalar 1432     R(4)            4     2     192      COM              1509                              
 FER                        Local  1509     R(4)            4           scalar                    1509,1513,1589,1622,1628          
 FFE                        Scalar 1425     R(4)            4     2     2200000  COM                                                

Page 52          Source Listing                  OUTPUT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FHD                        Scalar 1422     R(4)            4     1     1100000  COM              1473,1641                         
 FKX                        Scalar 1420     R(4)            4     1     900000   COM              1479,1644                         
 FLN                        Scalar 1420     R(4)            4     1     900000   COM              1477,1642                         
 FLT                        Scalar 1419     R(4)            4     1     900000   COM              1478,1643                         
 FLV                        Scalar 1419     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 1421     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 1421     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 1421     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 1424     R(4)            4     2     2200000  COM              1499,1646                         
 FOC                        Scalar 1426     CHAR            3     1     900000   COM              1480                              
 FOE                        Scalar 1425     R(4)            4     1     1100000  COM              1475                              
 FOI                        Scalar 1424     R(4)            4     1     1100000  COM              1597,1600,1606                    
 FPF                        Scalar 1426     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 1423     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 1423     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 1423     R(4)            4     1     1100000  COM              1474,1645                         
 FPRC                       Scalar 1422     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 1422     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 1424     R(4)            4     1     1100000  COM              1485                              
 FTM                        Scalar 1420     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 1426     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 1425     R(4)            4     1     1100000  COM                                                
 GNP                        Local  1563     R(4)            4           scalar                    1563,1565,1567                    
 HVECT                      Common 1429                                 47364                                                       
 I                          Local  1471     I(4)            4           scalar                    1471,1473,1474,1475,1485,1499,1597
                                                                                                  ,1600,1606                        
 II                         Local  1473     I(4)            4           scalar                    1473,1476,1477,1478,1479,1480     
 ILEV                       Local  1638     I(4)            4           scalar                    1638,1641,1645,1646               
 IMAP                       Scalar 1434     I(4)            4     2     65160    COM                                                
 INOB                       Scalar 1434     I(4)            4     1     900000   COM                                                
 IOB                        Local  1637     I(4)            4           scalar                    1637,1638,1639,1647               
 IOMF                       Local  1440     I(4)            4     1     3                         1451,1499,1646                    
 IQM                        Local  1485     I(4)            4           scalar                    1485,1486                         
 IREP                       Local  1641     I(4)            4           scalar                    1641,1642,1643,1644,1651          
 ITER                       Scalar 1435     I(4)            4           scalar   COM              1620                              
 ITUNIT                     Scalar 1437     I(4)            4           scalar   COM              1603                              
 J                          Local  1472     I(4)            4           scalar                    1472,1497,1498,1603,1617,1619     
 K                          Local  1497     I(4)            4           scalar                    1497,1498,1499,1509,1527,1530,1537
                                                                                                  ,1558                             
 KEEP                       Local  1445     L(4)            4           scalar                    1487,1490,1595,1596               
 KI2                        Local  1640     I(4)            4           scalar                    1640,1647,1649,1650               
 KIV                        Local  1639     I(4)            4           scalar                    1639,1640,1646,1651               
 KIX                        Local  1644     I(4)            4           scalar                    1644,1651                         
 KK                         Local  1498     I(4)            4           scalar                    1498,1508,1510,1619,1620,1621,1625
                                                                                                  ,1627,1631,1635                   
 KX                         Local  1479     I(4)            4           scalar                    1479,1603,1616,1617,1625,1631     
 KXP                        Scalar 1436     I(4)            4     1     10       COM              1616                              
 L                          Local  1507     I(4)            4           scalar                    1507,1508,1510,1511,1512,1514,1515
                                                                                                  ,1516,1517,1604,1618,1626,1632,163
                                                                                                  4,1635,1637,1638,1639,1647,1649,16
                                                                                                  50                                
 LU                         Local  1614     I(4)            4           scalar                    1614,1617,1620,1625,1631,1635,1651
                                                                                                  ,1655                             
 MAX                        Func   1514                                 scalar                    1514,1572,1580,1640               
 MAXLEV                     Param  1417     I(4)            4           scalar                    1422,1423,1424,1425,1426          

Page 53          Source Listing                  OUTPUT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAXREP                     Param  1416     I(4)            4           scalar                    1419,1420,1421,1422,1426,1434     
 MCHK                       Scalar 1429     I(4)            4     2     128      COM              1471,1472                         
 MDIM                       Scalar 1430     I(4)            4     2     256      COM              1637                              
 MIN                        Func   1563                                 scalar                    1563,1580                         
 MOBS                       Scalar 1429     I(4)            4     4     5120     COM              1638,1639                         
 N                          Local  1470     I(4)            4           scalar                    1470,1471,1472,1508,1509,1510,1637
                                                                                                  ,1638,1639,1647,1649,1650         
 NDIM                       Local  1440     I(4)            4     1     4                                                           
 NLEV                       Scalar 1434     I(4)            4           scalar   COM                                                
 NN                         Local  1613     I(4)            4           scalar                    1613,1614,1615,1616               
 NPT                        Scalar 1436     I(4)            4           scalar   COM              1613                              
 NREP                       Scalar 1434     I(4)            4           scalar   COM                                                
 NXXYY                      Scalar 1429     I(4)            4           scalar   COM              1470                              
 OBER                       Local  1475     R(4)            4           scalar                    1475,1512,1589,1622,1628          
 OBPRT                      Common 1436                                 124                                                         
 OBS                        Common 1434                                 11060648                                                    
 OINC                       Local  1648     R(4)            4           scalar                    1648,1651,1653                    
 OIQCDATA                   Common 1419                                 22790000                                                    
                                                                        0                                                           
 OIWT                       Local  1647     R(4)            4           scalar                    1647,1648,1651                    
 OMA                        Local  1528     R(4)            4           scalar                    1528,1546,1580                    
 OMA0                       Local  1649     R(4)            4           scalar                    1649,1652                         
 OMAU                       Local  1534     R(4)            4           scalar                    1534,1546,1624                    
 OMAV                       Local  1541     R(4)            4           scalar                    1541,1546,1630                    
 OMF                        Local  1499     R(4)            4           scalar                    1499,1511,1528,1534,1535,1541,1542
                                                                                                  ,1547,1579,1580,1589,1603,1617    
 OMF0                       Local  1646     R(4)            4           scalar                    1646,1648,1651                    
 OMFU                       Local  1535     R(4)            4           scalar                    1535,1547,1622,1624,1625          
 OMFV                       Local  1542     R(4)            4           scalar                    1542,1547,1628,1630,1631          
 OUTPUT                     Subr   1414                                                                                             
 PDIF                       Local  1615     R(4)            4           scalar                    1615,1616                         
 PI180                      Local  1455     R(4)            4           scalar                    1455,1559                         
 PLUMIN                     Local  1454     CHAR            1           scalar                    1598,1601,1604,1607,1618          
 PPP                        Local  1645     R(4)            4           scalar                    1645,1651                         
 PRES                       Local  1474     R(4)            4           scalar                    1474,1564,1603,1615,1617,1625,1631
 PRP                        Scalar 1436     R(4)            4     1     10       COM              1615                              
 QC                         Local  1502     R(4)            4           scalar                    1502,1515,1521,1533,1540,1545,1594
                                                                                                  ,1595,1604,1618                   
 QCPC                       Local  1580     R(4)            4           scalar                    1580,1581                         
 QCU                        Local  1533     R(4)            4           scalar                    1533,1545,1626                    
 QCV                        Local  1540     R(4)            4           scalar                    1540,1545,1632                    
 SDOMF                      Local  1589     R(4)            4           scalar                    1589,1603,1617,1622,1625,1628,1631
 SID                        Scalar 1434     R(8)            8     1     900000   COM              1476,1651                         
 SIDP                       Scalar 1436     R(4)            4     1     10       COM              1616                              
 SIN                        Func   1559                                 scalar                    1559                              
 SINLAT                     Local  1559     R(4)            4           scalar                    1559,1560                         
 SOINC                      Local  1636     R(4)            4           scalar                    1636,1653,1655                    
 SQRT                       Func   1512                                 scalar                    1512,1521,1543,1544,1545,1546,1547
                                                                                                  ,1574,1589,1622,1628              
 STR                        Local  1440     R(4)            4     1     2                                                           
 SUMWTS                     Local  1501     R(4)            4           scalar                    1501,1516,1520,1521,1522          
 TAG                        Local  1443     CHAR            3           scalar                    1480,1574                         
 TB                         Scalar 1435     R(4)            4           scalar   COM              1560,1565,1567                    
 TJET                       Scalar 1435     R(4)            4           scalar   COM              1565                              
 TMIN                       Local  1561     R(4)            4           scalar                    1561,1569,1572                    

Page 54          Source Listing                  OUTPUT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TOLLER                     Common 1435                                 24                                                          
 TOSSUNIT                   Common 1437                                 4                                                           
 TSAT                       Scalar 1435     R(4)            4           scalar   COM                                                
 TT                         Local  1560     R(4)            4           scalar                    1560,1565,1567,1572,1574,1581,1583
                                                                                                  ,1623,1624,1629,1630              
 TTT                        Local  1581     R(4)            4           scalar                    1581,1583,1594,1604,1618,1623,1624
                                                                                                  ,1629,1630                        
 TTTT                       Local  1623     R(4)            4           scalar                    1623,1624,1626,1629,1630,1632     
 TWND                       Scalar 1435     R(4)            4           scalar   COM              1567                              
 TWT                        Local  1441     R(4)            4     1     4                         1463,1514,1515,1516,1517,1520,1522
                                                                                                  ,1532,1539,1544,1604,1618         
 TWU                        Local  1441     R(4)            4     1     4                         1464,1532,1544,1626               
 TWV                        Local  1441     R(4)            4     1     4                         1465,1539,1544,1632               
 TZ                         Scalar 1435     R(4)            4           scalar   COM              1560                              
 VAR2                       Local  1444     CHAR            1     1     2                         1449,1603,1617                    
 VAR3                       Local  1444     CHAR            1     1     3                         1450,1620,1625,1631,1635,1651     
 W3TAGE                     Subr   1550                                                           1550                              
 WT                         Scalar 1431     R(4)            4     4     5120     COM              1647                              
 X                          Local  1642     R(4)            4           scalar                    1642,1651                         
 Y                          Local  1643     R(4)            4           scalar                    1643,1651                         

Page 55          Source Listing                  OUTPUT
2017-04-18 11:07                                 oiqcbufr.f

   2188 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
   2189 C
   2190 C SUBPROGRAM:    PILNLNP
   2191 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1992-07-29
   2192 C
   2193 C ABSTRACT: FUNCTION WHICH GIVEN AN PROFILE OF DESCENDING PRESSURES AND
   2194 C   A PROFILE OF QUANTITIES VALID AT THOSE PRESSURES, RETURNS AN
   2195 C   INTERPOLATED QUANTITY VALID AT A GIVEN ARBITRARY PRESSURE.
   2196 C
   2197 C PROGRAM HISTORY LOG:
   2198 C 1986-03-21  G. DIMEGO  - ORINIGAL AUTHOR
   2199 C 1988-11-24  D. DEAVEN  - RECODED FOR CYBER 205
   2200 C 1992-07-29  J. WOOLLEN - UPDATED FOR OIQC
   2201 C
   2202 C USAGE:    CALL = PILNLNP(P,PARAY,QARAY,KMAX)
   2203 C   INPUT ARGUMENT LIST:
   2204 C     P        - PRESSURE TO INTERPOLATE TO
   2205 C     PARAY    - GIVEN PRESSURE PROFILE
   2206 C     QARAY    - QUANTITIES VALID FOR PRESSURE PROFILE
   2207 C     KMAX     - LENGTH OF PROFILE
   2208 C
   2209 C   FUNCTION RETURN VALUE
   2210 C     PILNLNP  - INTERPOLATED QUANTITY
   2211 C
   2212 C ATTRIBUTES:
   2213 C   LANGUAGE: FORTRAN 90
   2214 C   MACHINE:  NCEP WCOSS
   2215 C
   2216 C$$$
   2217       FUNCTION PILNLNP(P,PARAY,QARAY,KMAX)
   2218 
   2219       DIMENSION PARAY(KMAX),QARAY(KMAX)
   2220 
   2221       DO 10 LA=1,KMAX
   2222       IF(P.GE.PARAY(LA)) GOTO 11
   2223 10    CONTINUE
   2224 11    IF(LA.GT.KMAX) THEN
   2225          LA = KMAX
   2226          LB = KMAX
   2227       ELSE IF(LA.EQ.1) THEN
   2228          LA = 1
   2229          LB = 1
   2230       ELSE
   2231          LB = LA-1
   2232       ENDIF
   2233       PA = PARAY(LA)
   2234       PB = PARAY(LB)
   2235       IF(PA.NE.PB) THEN
   2236          WK = LOG(P/PB) / LOG(PA/PB)
   2237       ELSE
   2238          WK = 0.
   2239       ENDIF
   2240       PILNLNP = QARAY(LB) + (QARAY(LA)-QARAY(LB)) * WK
   2241 
   2242       RETURN
   2243       END

Page 56          Source Listing                  PILNLNP
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                
                      
 pilnlnp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1707                                                           1705                              
 11                         Label  1708                                                           1706                              
 KMAX                       Dummy  1701     I(4)            4           scalar   ARG,INOUT        1703,1705,1708,1709,1710          
 LA                         Local  1705     I(4)            4           scalar                    1705,1706,1708,1709,1711,1712,1715
                                                                                                  ,1717,1724                        
 LB                         Local  1710     I(4)            4           scalar                    1710,1713,1715,1718,1724          
 LOG                        Func   1720                                 scalar                    1720                              
 P                          Dummy  1701     R(4)            4           scalar   ARG,INOUT        1706,1720                         
 PA                         Local  1717     R(4)            4           scalar                    1717,1719,1720                    
 PARAY                      Dummy  1701     R(4)            4     1     0        ARG,INOUT        1706,1717,1718                    
 PB                         Local  1718     R(4)            4           scalar                    1718,1719,1720                    
 PILNLNP                    Func   1701     R(4)            4           scalar                    1724                              
 PILNLNP@0                  Local  1701     R(4)            4           scalar                                                      
 QARAY                      Dummy  1701     R(4)            4     1     0        ARG,INOUT        1724                              
 WK                         Local  1720     R(4)            4           scalar                    1720,1722,1724                    

Page 57          Source Listing                  PILNLNP
2017-04-18 11:07                                 oiqcbufr.f

   2244 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2245 C
   2246 C SUBPROGRAM:    PREPQM
   2247 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 2013-03-26
   2248 C
   2249 C ABSTRACT: REWRITES THE PREPBUFR FILE WITH UPDATED QUALITY MARKS.
   2250 C
   2251 C PROGRAM HISTORY LOG:
   2252 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   2253 C 2013-03-26  J. WOOLLEN  INITIAL PORT TO WCOSS: FIX ADDRESSING
   2254 C         ALIGNMENT PROBLEM WHEN THE LAST BUFR MESSAGE CONTAINS NO DATA
   2255 C         WHICH IS OIQC PROCESSED
   2256 C
   2257 C USAGE:    CALL PREPQM(LUBIN,LUBOT)
   2258 C   INPUT ARGUMENT LIST:
   2259 C     LUBIN    - LOGICAL UNIT FOR OBSERVATION (PREPBUFR) PRIOR TO
   2260 C                UPDATED QUALITY MARKS
   2261 C     LUBOT    - LOGICAL UNIT FOR OBSERVATION (PREPBUFR) WITH UPDATED
   2262 C                QUALITY MARKS
   2263 C
   2264 C   INPUT FILES:
   2265 C     UNIT LUBIN - OBSERVATION (PREPBUFR) PRIOR TO UPDATED QUALITY
   2266 C                  MARKS
   2267 C
   2268 C   OUTPUT FILES:
   2269 C     UNIT 06    - STANDARD OUTPUT PRINT
   2270 C     UNIT LUBOT - OBSERVATION (PREPBUFR) FILE WITH UPDATED QUALITY
   2271 C                  MARKS
   2272 C
   2273 C REMARKS: NONE.
   2274 C
   2275 C
   2276 C ATTRIBUTES:
   2277 C   LANGUAGE: FORTRAN 90
   2278 C   MACHINE:  NCEP WCOSS
   2279 C
   2280 C$$$
   2281       SUBROUTINE PREPQM(LUBIN,LUBOT)
   2282  
   2283       PARAMETER (MAXREP=900000)
   2284       PARAMETER (MAXLEV=1100000)
   2285 
   2286       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   2287      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   2288      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   2289      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   2290      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   2291      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   2292      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   2293      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   2294       CHARACTER*3 FOC
   2295  
   2296  
   2297       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   2298       COMMON /DATAZZ/ KLEV,HDR(5),
   2299      .                OBS(8,255),QMS(6,255),PCS(6,255),RCS(6,255),
   2300      .                OBE(8,255),QME(6,255),OES(6,255),FES(6,255),

Page 58          Source Listing                  PREPQM
2017-04-18 11:07                                 oiqcbufr.f

   2301      .                FCS(7,255)
   2302  
   2303       CHARACTER*30 OSTR,QSTR,PSTR,RSTR
   2304       CHARACTER*8  SUBSET
   2305       CHARACTER*3  TAG
   2306       LOGICAL      EVENT1,EVENTN,SMI,SFC
   2307       REAL*8       OBS,QMS,OBE,QME,PCS,RCS,SID
   2308  
   2309       DATA OSTR /'POB TOB UOB VOB QOB'/
   2310       DATA QSTR /'PQM TQM WQM NUL QQM'/
   2311       DATA PSTR /'PPC TPC WPC NUL QPC'/
   2312       DATA RSTR /'PRC TRC WRC NUL QRC'/
   2313  
   2314       DATA VMAX /10E10/
   2315  
   2316 C-----------------------------------------------------------------------
   2317 C-----------------------------------------------------------------------
   2318  
   2319       PRINT*
   2320       PRINT*,'******WRITE THE PREPBUFR FILE*******'
   2321       PRINT*
   2322  
   2323 C  OPEN THE INPUT AND OUTPUT FILES
   2324 C  -------------------------------
   2325  
   2326 C     CALL OPENBF(LUBIN,'IN',LUBIN)
   2327       CALL UFBQCD(LUBIN,'OIQC',QCD)
   2328       CALL OPENBF(LUBOT,'OUT',LUBIN)
   2329       imsg = 1
   2330       irec = 1
   2331       ifld = 1
   2332  
   2333 C  LOOP OVER THE OBS CHECKED BY OIQC
   2334 C  ---------------------------------
   2335  
   2336       DO 100 ILEV=1,NLEV
   2337  
   2338       IREP = FHD(ILEV)
   2339       OBM  = FOI(ILEV)
   2340       TAG  = FOC(IREP)
   2341       KX   = FKX(IREP)
   2342       QM   = FQM(ILEV)
   2343  
   2344       SFC = TAG.EQ.'SFC'
   2345       SMI = TAG.EQ.'SMI'
   2346  
   2347       JREC = FPRC(ILEV)
   2348       JFLD = FPFD(ILEV)
   2349       JLEV = FPLV(ILEV)
   2350  
   2351       IF(SFC.AND.FLV(IREP).NE.ILEV) THEN
   2352          JUPD = 1
   2353       ELSE
   2354          JUPD = KX/100+1
   2355       ENDIF
   2356  
   2357 C  SEE IF THERE IS AN EVENT TO WRITE AND WHICH KIND IT WOULD BE

Page 59          Source Listing                  PREPQM
2017-04-18 11:07                                 oiqcbufr.f

   2358 C  ------------------------------------------------------------
   2359  
   2360       QMN = QM
   2361       IF(OBM.EQ.-1 .AND. QM.GE.0 .AND. QM.LE.3) QMN = QM + 4
   2362       IF(OBM.EQ. 1 .AND. QM.GE.4 .AND. QM.LE.7) QMN = QM - 4
   2363  
   2364       EVENT1 = QMN.NE.QM .OR. SMI
   2365       EVENTN = EVENT1 .AND. IREC.EQ.JREC .AND. IFLD.EQ.JFLD
   2366       EVENT1 = EVENT1 .AND. .NOT.EVENTN
   2367 
   2368 C-----------------------------------------------------------------------
   2369 C  DECIDE HOW TO PROCEED FOR THIS OB/EVENT:
   2370 C     IF THE FIRST OB, SYNCHRONIZE THE FILES;
   2371 C     IF A SUBSEQUENT OB:
   2372 C        FOR THE FIRST EVENT IN A REPORT, POSITION THE OUTPUT FILE
   2373 C        FOR SUBSEQUENT EVENTS IN A REPORT, SKIP THE POSITIONING
   2374 C        FOR NO EVENT AT ALL, CONTINUE THE LOOP
   2375 C-----------------------------------------------------------------------
   2376  
   2377       IF(ILEV.EQ.1) GOTO 49
   2378       IF(EVENT1   ) GOTO 10
   2379       IF(EVENTN   ) GOTO 50
   2380       IF(ILEV.LT.NLEV) CYCLE
   2381  
   2382 C  FLUSH A COMPLETED SET OF EVENTS BEFORE POSITIONING THE OUTPUT FILE
   2383 C  ------------------------------------------------------------------
   2384  
   2385 10    CONTINUE
   2386       CALL UFBINT(LUBOT,OBE,8,KLEV,IRET,OSTR)
   2387       CALL UFBINT(LUBOT,QME,6,KLEV,IRET,QSTR)
   2388       CALL UFBINT(LUBOT,PCS,6,KLEV,IRET,PSTR)
   2389       CALL UFBINT(LUBOT,RCS,6,KLEV,IRET,RSTR)
   2390       CALL WRITSB(LUBOT)
   2391  
   2392 C  WIND AND COPY OBS UP TO THE NEXT EVENTED MESSAGE AND SUBSET
   2393 C  -----------------------------------------------------------
   2394  
   2395       IF(IREC.LT.JREC.OR.ILEV.EQ.NLEV) THEN
   2396          DO WHILE(ICOPYSB(LUBIN,LUBOT).EQ.0)
   2397          ENDDO
   2398          IF(IREADMM(imsg,SUBSET,IDATE).ne.0) THEN
   2399             IF(ilev.lt.nlev) GOTO 900
   2400             goto 100
   2401          endif
   2402          CALL UFBCNT(LUBIN,IREC,IFLD)
   2403          DO WHILE(IREC.LT.JREC.OR.ILEV.EQ.NLEV)
   2404             CALL CLOSMG(LUBOT)
   2405             CALL COPYMG(LUBIN,LUBOT)
   2406             IF(IREADMM(imsg ,SUBSET,IDATE).NE.0) GOTO 100
   2407             CALL UFBCNT(LUBIN,IREC,IFLD)
   2408          ENDDO
   2409       ENDIF
   2410 
   2411       DO WHILE(IFLD.LT.JFLD-1)
   2412          CALL OPENMB(LUBOT,SUBSET,IDATE)
   2413          IF(ICOPYSB(LUBIN,LUBOT).NE.0) GOTO 901
   2414          CALL UFBCNT(LUBIN,IREC,IFLD)

Page 60          Source Listing                  PREPQM
2017-04-18 11:07                                 oiqcbufr.f

   2415       ENDDO
   2416  
   2417 C  READ THE NEXT SUBSET TO RECEIVE EVENTS
   2418 C  --------------------------------------
   2419  
   2420 49    CONTINUE
   2421       IF(IREADSB(LUBIN).NE.0) then        
   2422          IF(IREADMM(imsg,SUBSET,IDATE).NE.0) GOTO 100
   2423          goto 49
   2424       endif
   2425       CALL UFBINT(LUBIN,OBS,8,255,KLEV,OSTR)
   2426       CALL UFBINT(LUBIN,QMS,6,255,KLEV,QSTR)
   2427       CALL OPENMB(LUBOT,SUBSET,IDATE)
   2428       CALL UFBCNT(LUBIN,IREC,IFLD)
   2429       CALL UFBCPY(LUBIN,LUBOT)
   2430       OBE =  VMAX
   2431       QME =  VMAX
   2432       PCS =  VMAX
   2433       RCS =  VMAX
   2434 50    CONTINUE
   2435  
   2436 C  ADD AN EVENT IF THE OIQC QM <> DATA QM
   2437 C  --------------------------------------
   2438  
   2439       IF(QMS(JUPD,JLEV).NE.QMN) THEN
   2440          IF(JUPD.LE.3) OBE(JUPD,JLEV) = OBS(JUPD,JLEV)
   2441          IF(JUPD.EQ.3) OBE(   4,JLEV) = OBS(   4,JLEV)
   2442          QME(JUPD,JLEV) = QMN
   2443          PCS(JUPD,JLEV) = QCD
   2444          RCS(JUPD,JLEV) = QMN
   2445       ENDIF
   2446  
   2447 C  LINK THE MOISTURE QM TO THE PRESSURE/TEMPERATURE QM
   2448 C  ---------------------------------------------------
   2449  
   2450       IF(QMN.GE.4 .AND. QMS(5,JLEV).LT.4) THEN
   2451          OBE(5,JLEV) = OBS(5,JLEV)
   2452          QME(5,JLEV) = QMS(5,JLEV)+4
   2453          PCS(5,JLEV) = QCD
   2454          RCS(5,JLEV) = QMS(5,JLEV)+4
   2455       ENDIF
   2456  
   2457 C  ADD AN EVENT CONTAINING ANALYSED SSMI WIND DIRECTION
   2458 C  ----------------------------------------------------
   2459  
   2460       IF(SMI) THEN
   2461          OBE(3,JLEV) = FMW(IREP,1) + FOB(ILEV,1)
   2462          OBE(4,JLEV) = FMW(IREP,2) + FOB(ILEV,2)
   2463          QME(3,JLEV) = QM
   2464          PCS(3,JLEV) = QCD
   2465          RCS(3,JLEV) = QM
   2466       ENDIF
   2467  
   2468 C  TRAP THE LAST OIQC RESULT IN ORDER TO COMPLETE THE OUTPUT FILE
   2469 C  --------------------------------------------------------------
   2470  
   2471 100   CONTINUE

Page 61          Source Listing                  PREPQM
2017-04-18 11:07                                 oiqcbufr.f

   2472  
   2473 C  CLOSE OUT THE FILES AND EXIT
   2474 C  ----------------------------
   2475  
   2476       call ufbcnt(lubot,ireo,iflo)
   2477       PRINT*,'PREPQM READ ',IREC,' WROTE ',IREO,' PREPBUFR RECORDS'
   2478       CALL CLOSBF(LUBIN)
   2479       CALL CLOSBF(LUBOT)
   2480       RETURN
   2481 900   PRINT *, 'PREPQM - READMG ALIGNMENT PROBLEM'
   2482       CALL W3TAGE('PREPOBS_OIQCBUFR')
   2483       CALL ERREXIT(99)
   2484 901   PRINT *, 'PREPQM - COPYSB ALIGNMENT PROBLEM'
   2485       CALL W3TAGE('PREPOBS_OIQCBUFR')
   2486       CALL ERREXIT(99)
   2487 902   PRINT *, 'PREPQM - READMM ALIGNMENT PROBLEM'
   2488       CALL W3TAGE('PREPOBS_OIQCBUFR')
   2489       CALL ERREXIT(99)
   2490       END


ENTRY POINTS

  Name               
                     
 prepqm_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  1869                                                           1862                              
 100                        Label  1955                                                           1820,1884,1890,1906               
 49                         Label  1904                                                           1861,1907                         
 50                         Label  1918                                                           1863                              
 900                        Label  1965                                                           1883                              
 901                        Label  1968                                                           1897                              
 902                        Label  1971                                                                                             
 CLOSBF                     Subr   1962                                                           1962,1963                         
 CLOSMG                     Subr   1888                                                           1888                              
 COPYMG                     Subr   1889                                                           1889                              
 DATAZZ                     Common 1782                                 101004                                                      
 ERREXIT                    Subr   1967                                                           1967,1970,1973                    
 EVENT1                     Local  1790     L(4)            4           scalar                    1848,1849,1850,1862               
 EVENTN                     Local  1790     L(4)            4           scalar                    1849,1850,1863                    
 FCS                        Scalar 1785     R(4)            4     2     1785     COM                                                
 FES                        Scalar 1784     R(4)            4     2     1530     COM                                                
 FFE                        Scalar 1776     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 1773     R(4)            4     1     1100000  COM              1822                              
 FKX                        Scalar 1771     R(4)            4     1     900000   COM              1825                              
 FLN                        Scalar 1771     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 1770     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 1770     R(4)            4     1     900000   COM              1835                              
 FMS                        Scalar 1772     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 1772     R(4)            4     2     1800000  COM              1945,1946                         
 FNL                        Scalar 1772     R(4)            4     1     900000   COM                                                

Page 62          Source Listing                  PREPQM
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FOB                        Scalar 1775     R(4)            4     2     2200000  COM              1945,1946                         
 FOC                        Scalar 1777     CHAR            3     1     900000   COM              1824                              
 FOE                        Scalar 1776     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 1775     R(4)            4     1     1100000  COM              1823                              
 FPF                        Scalar 1777     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 1774     R(4)            4     1     1100000  COM              1832                              
 FPLV                       Scalar 1774     R(4)            4     1     1100000  COM              1833                              
 FPR                        Scalar 1774     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 1773     R(4)            4     1     1100000  COM              1831                              
 FQL                        Scalar 1773     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 1775     R(4)            4     1     1100000  COM              1826                              
 FTM                        Scalar 1771     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 1777     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 1776     R(4)            4     1     1100000  COM                                                
 HDR                        Scalar 1782     R(4)            4     1     5        COM                                                
 ICOPYSB                    Func   1880     I(4)            4           scalar                    1880,1897                         
 IDATE                      Local  1882     I(4)            4           scalar                    1882,1890,1896,1906,1911          
 IFLD                       Local  1815     I(4)            4           scalar                    1815,1849,1886,1891,1895,1898,1912
 IFLO                       Local  1960     I(4)            4           scalar                    1960                              
 ILEV                       Local  1820     I(4)            4           scalar                    1820,1822,1823,1826,1831,1832,1833
                                                                                                  ,1835,1861,1864,1879,1883,1887,194
                                                                                                  5,1946                            
 IMAP                       Scalar 1781     I(4)            4     2     65160    COM                                                
 IMSG                       Local  1813     I(4)            4           scalar                    1813,1882,1890,1906               
 INOB                       Scalar 1781     I(4)            4     1     900000   COM                                                
 IREADMM                    Func   1882     I(4)            4           scalar                    1882,1890,1906                    
 IREADSB                    Func   1905     I(4)            4           scalar                    1905                              
 IREC                       Local  1814     I(4)            4           scalar                    1814,1849,1879,1886,1887,1891,1898
                                                                                                  ,1912,1961                        
 IREO                       Local  1960     I(4)            4           scalar                    1960,1961                         
 IREP                       Local  1822     I(4)            4           scalar                    1822,1824,1825,1835,1945,1946     
 IRET                       Local  1870     I(4)            4           scalar                    1870,1871,1872,1873               
 JFLD                       Local  1832     I(4)            4           scalar                    1832,1849,1895                    
 JLEV                       Local  1833     I(4)            4           scalar                    1833,1923,1924,1925,1926,1927,1928
                                                                                                  ,1934,1935,1936,1937,1938,1945,194
                                                                                                  6,1947,1948,1949                  
 JREC                       Local  1831     I(4)            4           scalar                    1831,1849,1879,1887               
 JUPD                       Local  1836     I(4)            4           scalar                    1836,1838,1923,1924,1925,1926,1927
                                                                                                  ,1928                             
 KLEV                       Scalar 1782     I(4)            4           scalar   COM              1870,1871,1872,1873,1909,1910     
 KX                         Local  1825     I(4)            4           scalar                    1825,1838                         
 LUBIN                      Dummy  1765     I(4)            4           scalar   ARG,INOUT        1811,1812,1880,1886,1889,1891,1897
                                                                                                  ,1898,1905,1909,1910,1912,1913,196
                                                                                                  2                                 
 LUBOT                      Dummy  1765     I(4)            4           scalar   ARG,INOUT        1812,1870,1871,1872,1873,1874,1880
                                                                                                  ,1888,1889,1896,1897,1911,1913,196
                                                                                                  0,1963                            
 MAXLEV                     Param  1768     I(4)            4           scalar                    1773,1774,1775,1776,1777          
 MAXREP                     Param  1767     I(4)            4           scalar                    1770,1771,1772,1773,1777,1781     
 NLEV                       Scalar 1781     I(4)            4           scalar   COM              1820,1864,1879,1883,1887          
 NREP                       Scalar 1781     I(4)            4           scalar   COM                                                
 OBE                        Scalar 1784     R(8)            8     2     2040     COM              1870,1914,1924,1925,1935,1945,1946
 OBM                        Local  1823     R(4)            4           scalar                    1823,1845,1846                    
 OBS                        Common 1781                                 11060648                                                    
 OBS                        Scalar 1783     R(8)            8     2     2040     COM              1909,1924,1925,1935               

Page 63          Source Listing                  PREPQM
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 OES                        Scalar 1784     R(4)            4     2     1530     COM                                                
 OIQCDATA                   Common 1770                                 22790000                                                    
                                                                        0                                                           
 OPENBF                     Subr   1812                                                           1812                              
 OPENMB                     Subr   1896                                                           1896,1911                         
 OSTR                       Local  1787     CHAR            30          scalar                    1793,1870,1909                    
 PCS                        Scalar 1783     R(8)            8     2     1530     COM              1872,1916,1927,1937,1948          
 PREPQM                     Subr   1765                                                                                             
 PSTR                       Local  1787     CHAR            30          scalar                    1795,1872                         
 QCD                        Local  1811     R(4)            4           scalar                    1811,1927,1937,1948               
 QM                         Local  1826     R(4)            4           scalar                    1826,1844,1845,1846,1848,1947,1949
 QME                        Scalar 1784     R(8)            8     2     1530     COM              1871,1915,1926,1936,1947          
 QMN                        Local  1844     R(4)            4           scalar                    1844,1845,1846,1848,1923,1926,1928
                                                                                                  ,1934                             
 QMS                        Scalar 1783     R(8)            8     2     1530     COM              1910,1923,1934,1936,1938          
 QSTR                       Local  1787     CHAR            30          scalar                    1794,1871,1910                    
 RCS                        Scalar 1783     R(8)            8     2     1530     COM              1873,1917,1928,1938,1949          
 RSTR                       Local  1787     CHAR            30          scalar                    1796,1873                         
 SFC                        Local  1790     L(4)            4           scalar                    1828,1835                         
 SID                        Scalar 1781     R(8)            8     1     900000   COM                                                
 SMI                        Local  1790     L(4)            4           scalar                    1829,1848,1944                    
 SUBSET                     Local  1788     CHAR            8           scalar                    1882,1890,1896,1906,1911          
 TAG                        Local  1789     CHAR            3           scalar                    1824,1828,1829                    
 UFBCNT                     Subr   1886                                                           1886,1891,1898,1912,1960          
 UFBCPY                     Subr   1913                                                           1913                              
 UFBINT                     Subr   1870                                                           1870,1871,1872,1873,1909,1910     
 UFBQCD                     Subr   1811                                                           1811                              
 VMAX                       Local  1798     R(4)            4           scalar                    1798,1914,1915,1916,1917          
 W3TAGE                     Subr   1966                                                           1966,1969,1972                    
 WRITSB                     Subr   1874                                                           1874                              

Page 64          Source Listing                  PREPQM
2017-04-18 11:07                                 oiqcbufr.f

   2491 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2492 C
   2493 C SUBPROGRAM:    QCLOOP
   2494 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   2495 C
   2496 C ABSTRACT: ITERATES THE QC DECSION MAKING PROCESS UNTIL ALL DECISIONS
   2497 C   IN TWO CONSEQUETIVE ITERATIONS ARE THE SAME. AFTER FOUR ITERATIONS
   2498 C   ONLY REPORTS THAT FAIL THE CHECKS ARE CHECKED FURTHER.
   2499 C
   2500 C PROGRAM HISTORY LOG:
   2501 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   2502 C
   2503 C USAGE:    CALL QCLOOP(QCPTS,MAXTRY)
   2504 C   INPUT ARGUMENT LIST:
   2505 C     QCPTS    - NAME OF SUBROUTINE TO CALL
   2506 C     MAXTRY   - MAXIMUM NUMBER OF TRIES
   2507 C
   2508 C   INPUT FILES:
   2509 C     UNIT 20  - TOLERANCE LEVELS (FOR EXPERIMENTATION)
   2510 C
   2511 C   OUTPUT FILES:
   2512 C     UNIT 06  - STANDARD OUTPUT PRINT
   2513 C
   2514 C REMARKS: NONE.
   2515 C
   2516 C ATTRIBUTES:
   2517 C   LANGUAGE: FORTRAN 90
   2518 C   MACHINE:  NCEP WCOSS
   2519 C
   2520 C$$$
   2521       SUBROUTINE QCLOOP(QCPTS,MAXTRY)
   2522 
   2523       PARAMETER (MAXREP=900000)
   2524       PARAMETER (MAXLEV=1100000)
   2525 
   2526       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   2527       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   2528      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   2529      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   2530      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   2531      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   2532      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   2533      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   2534      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   2535       CHARACTER*3 FOC
   2536 
   2537 
   2538       COMMON /FPLIST  / NFL,INFL(MAXLEV)
   2539       COMMON /CKLIST  / NDD,INDD(MAXLEV)
   2540       COMMON /TOLLER  / ITER,T,TZ,TSAT,TWND,TJET
   2541       COMMON /TOSSUNIT/ ITUNIT
   2542       NAMELIST /TOLLS   / TB,TZ,TSAT,TWND,TJET
   2543 
   2544       LOGICAL DONE
   2545 
   2546       include "mpif.h"
   3063       dimension istat(mpi_status_size)

Page 65          Source Listing                  QCLOOP
2017-04-18 11:07                                 oiqcbufr.f

   3064       dimension ireq(100)
   3065 
   3066 C----------------------------------------------------------------------
   3067       call mpi_comm_rank(mpi_comm_world,myid,ierr)
   3068       call mpi_comm_size(mpi_comm_world,nprc,ierr)
   3069       mdtp = mpi_real
   3070       mdes = 0
   3071       mcom = mpi_comm_world
   3072 C-----------------------------------------------------------------------
   3073 
   3074       IF(NDD.EQ.0) THEN
   3075          PRINT*,'QCLOOP - NDD = 0'
   3076          RETURN
   3077       ENDIF
   3078 
   3079       ITRY = 1
   3080       ITER = 1
   3081       IFLIP = 0
   3082 
   3083 C  SET UP THE TOLERANCES
   3084 C  ---------------------
   3085 
   3086       TB   = 4.
   3087       TZ   = 5.0
   3088       TSAT = 5.0
   3089       TWND = 4.5
   3090       TJET = 5.5
   3091       REWIND (20)
   3092       READ(20,TOLLS,END=1,err=1)
   3093 1     if(myid.eq.0) then
   3094 C        WRITE(6,TOLLS)
   3095       endif
   3096       TZ   = TZ/TB
   3097       TSAT = TSAT/TB
   3098       TWND = TWND/TB
   3099       TJET = TJET/TB
   3100       T = TB
   3101 
   3102 C  DO THE QCOI CHECKS ON LIST IN COMMON /CKLIST/
   3103 C  ---------------------------------------------
   3104 
   3105 10    continue            
   3106 C     REWIND(ITUNIT)
   3107       CALL QCPTS
   3108       call syncndd(foi,nlev,mpi_real)
   3109 
   3110 C  SET OB ERRS TO REFLECT LAST ROUND OF CHECKS - RECORD FLIPS
   3111 C  ----------------------------------------------------------
   3112 
   3113       NBB = 0
   3114       NCK = 0
   3115       NFG = 0
   3116       NFB = 0
   3117       NFL = 0
   3118 
   3119       DO 20 N=1,NDD      
   3120       ILEV  = INDD(N)

Page 66          Source Listing                  QCLOOP
2017-04-18 11:07                                 oiqcbufr.f

   3121       OBER  = FOE(ILEV)
   3122 
   3123       IF(OBER.NE.0) THEN
   3124          IF(FOI(ILEV).EQ.1) THEN
   3125             FOE(ILEV) = ABS(OBER)
   3126             IF(OBER.LT.0) THEN
   3127                NFG = NFG + 1
   3128                NFL = NFL + 1
   3129                INFL(NFL) = ILEV
   3130             ENDIF
   3131          ELSE IF(FOI(ILEV).EQ.-1) THEN
   3132             FOE(ILEV) = -ABS(OBER)
   3133             IF(OBER.GT.0) THEN
   3134                NFB = NFB + 1
   3135                NFL = NFL  + 1
   3136                INFL(NFL) = ILEV
   3137             ENDIF
   3138             NBB = NBB + 1
   3139          ENDIF
   3140          NCK = NCK + 1
   3141       ENDIF
   3142 
   3143 20    CONTINUE
   3144 
   3145 C  CHECK STATUS AND WRITE ITERATION REPORT
   3146 C  ---------------------------------------
   3147 
   3148       DONE = NFL.EQ.0 .OR. ITRY.EQ.MAXTRY
   3149 
   3150       if(myid.eq.0) then
   3151          WRITE(6 ,30)ITRY,NFG,NFB,NFL,NBB,NCK
   3152       endif
   3153 
   3154 30    FORMAT('ITERATION ',I2,' : NFLIP=',3I6,' NBAD=',I6,' NTOT=',I6)
   3155 
   3156 C  FINISHED YET?
   3157 C  -------------
   3158 
   3159       IF(.NOT.DONE) THEN
   3160          ITRY = ITRY+1
   3161          IF(ITRY.LT.MAXTRY) THEN
   3162             ITER = ITRY
   3163             GOTO 10
   3164          ELSE
   3165             ITER = ITRY
   3166             DO 40 N=1,NFL
   3167             FOE(INFL(N)) = -ABS(FOE(INFL(N)))
   3168 40          CONTINUE
   3169             GOTO 10
   3170          ENDIF
   3171       ENDIF
   3172 
   3173 C  FINAL REPORT AND AWAY
   3174 C  ---------------------
   3175 
   3176       NBAD = NBB
   3177 

Page 67          Source Listing                  QCLOOP
2017-04-18 11:07                                 oiqcbufr.f

   3178       if(myid.eq.0) then
   3179          WRITE(6 ,*)' TOTAL BAD OBS=',NBAD
   3180          WRITE(6 ,*)
   3181       endif
   3182 
   3183       ITRY = 0
   3184       ITER = 0
   3185 
   3186       RETURN
   3187       END


ENTRY POINTS

  Name               
                     
 qcloop_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  2061                                                           2060                              
 10                         Label  2073                                                           2131,2137                         
 20                         Label  2111                                                           2087                              
 30                         Label  2122                                                           2119                              
 40                         Label  2136                                                           2134                              
 ABS                        Func   2093                                 scalar                    2093,2100,2135                    
 CKLIST                     Common 2023                                 4400004                                                     
 DONE                       Local  2028     L(4)            4           scalar                    2116,2127                         
 FFE                        Scalar 2017     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 2014     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 2012     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 2012     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 2011     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 2011     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 2013     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 2013     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 2013     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 2016     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 2018     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 2017     R(4)            4     1     1100000  COM              2089,2093,2100,2135               
 FOI                        Scalar 2016     R(4)            4     1     1100000  COM              2076,2092,2099                    
 FPF                        Scalar 2018     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 2015     R(4)            4     1     1100000  COM                                                
 FPLIST                     Common 2022                                 4400004                                                     
 FPLV                       Scalar 2015     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 2015     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 2014     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 2014     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 2016     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 2012     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 2018     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 2017     R(4)            4     1     1100000  COM                                                
 IERR                       Local  2035     I(4)            4           scalar                    2035,2036                         
 IFLIP                      Local  2049     I(4)            4           scalar                    2049                              

Page 68          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ILEV                       Local  2088     I(4)            4           scalar                    2088,2089,2092,2093,2097,2099,2100
                                                                                                  ,2104                             
 IMAP                       Scalar 2010     I(4)            4     2     65160    COM                                                
 INDD                       Scalar 2023     I(4)            4     1     1100000  COM              2088                              
 INFL                       Scalar 2022     I(4)            4     1     1100000  COM              2097,2104,2135                    
 INOB                       Scalar 2010     I(4)            4     1     900000   COM                                                
 IREQ                       Local  2032     I(4)            4     1     100                                                         
 ISTAT                      Local  2031     I(4)            4     1     5                                                           
 ITER                       Scalar 2024     I(4)            4           scalar   COM              2048,2130,2133,2152               
 ITRY                       Local  2047     I(4)            4           scalar                    2047,2116,2119,2128,2129,2130,2133
                                                                                                  ,2151                             
 ITUNIT                     Scalar 2025     I(4)            4           scalar   COM                                                
 MAXLEV                     Param  2008     I(4)            4           scalar                    2014,2015,2016,2017,2018,2022,2023
 MAXREP                     Param  2007     I(4)            4           scalar                    2010,2011,2012,2013,2014,2018     
 MAXTRY                     Dummy  2005     I(4)            4           scalar   ARG,INOUT        2116,2129                         
 MCOM                       Local  2039     I(4)            4           scalar                    2039                              
 MDES                       Local  2038     I(4)            4           scalar                    2038                              
 MDTP                       Local  2037     I(4)            4           scalar                    2037                              
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      

Page 69          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   2035                                                           2035                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   2036                                                           2036                              
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    2035,2036,2039                    
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      

Page 70          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      

Page 71          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      

Page 72          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                    2037,2076                         
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14,2031                        
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      

Page 73          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  2035     I(4)            4           scalar                    2035,2061,2118,2146               
 N                          Local  2087     I(4)            4           scalar                    2087,2088,2134,2135               
 NBAD                       Local  2144     I(4)            4           scalar                    2144,2147                         
 NBB                        Local  2081     I(4)            4           scalar                    2081,2106,2119,2144               
 NCK                        Local  2082     I(4)            4           scalar                    2082,2108,2119                    
 NDD                        Scalar 2023     I(4)            4           scalar   COM              2042,2087                         
 NFB                        Local  2084     I(4)            4           scalar                    2084,2102,2119                    
 NFG                        Local  2083     I(4)            4           scalar                    2083,2095,2119                    
 NFL                        Scalar 2022     I(4)            4           scalar   COM              2085,2096,2097,2103,2104,2116,2119
                                                                                                  ,2134                             
 NLEV                       Scalar 2010     I(4)            4           scalar   COM              2076                              
 NPRC                       Local  2036     I(4)            4           scalar                    2036                              
 NREP                       Scalar 2010     I(4)            4           scalar   COM                                                
 OBER                       Local  2089     R(4)            4           scalar                    2089,2091,2093,2094,2100,2101     
 OBS                        Common 2010                                 7460648                                                     
 OIQCDATA                   Common 2011                                 22790000                                                    
                                                                        0                                                           
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 QCLOOP                     Subr   2005                                                                                             
 QCPTS                      Subr   2005                                          ARG,INOUT        2075                              
 SID                        Scalar 2010     R(4)            4     1     900000   COM                                                
 SYNCNDD                    Subr   2076                                                           2076                              
 T                          Scalar 2024     R(4)            4           scalar   COM              2068                              
 TB                         Local  2026     R(4)            4           scalar                    2026,2054,2064,2065,2066,2067,2068
 TJET                       Scalar 2024     R(4)            4           scalar   COM              2026,2058,2067                    
 TOLLER                     Common 2024                                 24                                                          
 TOLLS                      Local  2026                                 scalar                    2060                              
 TOSSUNIT                   Common 2025                                 4                                                           
 TSAT                       Scalar 2024     R(4)            4           scalar   COM              2026,2056,2065                    

Page 74          Source Listing                  QCLOOP
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TWND                       Scalar 2024     R(4)            4           scalar   COM              2026,2057,2066                    
 TZ                         Scalar 2024     R(4)            4           scalar   COM              2026,2055,2064                    

Page 75          Source Listing                  QCLOOP
2017-04-18 11:07                                 oiqcbufr.f

   3188 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
   3189 C
   3190 C SUBPROGRAM:    QCOI
   3191 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-03-24
   3192 C
   3193 C ABSTRACT: COMPUTES AND SETS UP THE COEFFICIENT MATRIX AND RIGHT HAND
   3194 C   SIDES.  SOLVES THE MATRIX PROBLEMS. APPLIES THE COMPUTED WEIGHTS TO
   3195 C   THE RESIDUALS TO OBTAIN THE ANALYSIS INCREMENTS AND ANALYSIS
   3196 C   ERRORS.
   3197 C
   3198 C PROGRAM HISTORY LOG:
   3199 C 1988-02-05  DEAVEN     - ORIGINAL AUTHOR
   3200 C 1990-03-24  J. WOOLLEN - UPDATED FOR OIQC
   3201 C
   3202 C USAGE:    CALL QCOI
   3203 C
   3204 C REMARKS: INPUT INFORMATION IN COMMON /HVECT/:
   3205 C     NXXYY    - NUMBER OF OBS IN PACKAGE
   3206 C     XX       - LONGITUDES OF OBS IN PACKAGE
   3207 C     YY       - LATITUDES OF OBS IN PACKAGE
   3208 C     PP       - PRESSURES OF OBS IN PACKAGE
   3209 C     II       - INDEXES OF OBS IN PACKAGE
   3210 C     LL       - REPORT LEVEL OF OBS IN PACKAGE
   3211 C     FESD     - FORECAST ERRORS AT OB LOCATIONS
   3212 C     MKOBS    - LIST OF OB INDEXES USED IN EACH INTERPOLATION
   3213 C     NDIM     - NUMBER OF OBS USED IN EACH INTERPOLATION
   3214 C     JVMAX    - NUMBER OF INTERPOLATING OBS FOR EACH CHECK IN
   3215 C                EACH PACKAGE
   3216 C
   3217 C   OUTPUT INFORMATION IN COMMON /HVECT/:
   3218 C     AA       - INTERPOLATED VALUE OF OBS IN PACKAGE
   3219 C     AESD     - ANALYSIS ERRORS AT OB LOCATIONS
   3220 C
   3221 C ATTRIBUTES:
   3222 C   LANGUAGE: FORTRAN 90
   3223 C   MACHINE:  NCEP WCOSS
   3224 C
   3225 C$$$
   3226       SUBROUTINE QCOI
   3227 
   3228       PARAMETER (MAXREP=900000)
   3229       PARAMETER (MAXLEV=1100000)
   3230 
   3231       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   3232      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   3233      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   3234      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   3235      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   3236      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   3237      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   3238      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   3239       CHARACTER*3 FOC
   3240 
   3241 
   3242       PARAMETER( NQC  =  4         ,
   3243      .           NMX  =  64         ,
   3244      .           NN   =  10*(10+1)/2  ,

Page 76          Source Listing                  QCOI
2017-04-18 11:07                                 oiqcbufr.f

   3245      .           N    =  10           ,
   3246      .           LVEC =  64*10      ,
   3247      .           LMAT =  64*NN      )
   3248 
   3249       COMMON /CORP/ CHLP(1500),CVC,FFLAT(91),IFA(N,N)
   3250 
   3251       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   3252      .                     MDIM(64,4),AA(64,4,2),
   3253      .                     AE(64,4,2),WT(64,10,4,2),
   3254      .                     FE(64,3)
   3255 
   3256       DIMENSION    CHLS(LVEC) , XXCP(LVEC) , XXOB(LVEC) , C1(LMAT) ,
   3257      .             FLAT(LVEC) , YYCP(LVEC) , YYOB(LVEC) , C2(LMAT) ,
   3258      .             TZFA(LVEC) , KKCP(LVEC) , KKOB(LVEC) , DD(LMAT) ,
   3259      .             NGRP(LVEC) , PPCP(LVEC) , PPOB(LVEC) , XI(LMAT) ,
   3260      .             NIOB(LVEC) ,              OEOB(LVEC) , YI(LMAT) ,
   3261      .                                       OBOB(LVEC) , KI(LMAT) ,
   3262      .                                                    PI(LMAT) ,
   3263      .                                                    XJ(LMAT) ,
   3264      .                                                    YJ(LMAT) ,
   3265      .                                                    KJ(LMAT) ,
   3266      .                                                    PJ(LMAT) ,
   3267      .                                                    CH(LMAT) ,
   3268      .                                                    FL(LMAT) ,
   3269      .                                                    TZ(LMAT) ,
   3270      .                                                    NG(LMAT) ,
   3271      .                                                    NI(LMAT) ,
   3272      .                                                    NJ(LMAT)
   3273 
   3274       DIMENSION FA(NMX,NN), RA(NMX,N,2), DP(NMX,2), IVAR(3)
   3275 
   3276       DATA IVAR/2,1,2/
   3277 
   3278 C-----------------------------------------------------------------------
   3279 C-----------------------------------------------------------------------
   3280 
   3281       IF(NXXYY.EQ.0) RETURN
   3282 
   3283       AA = 0.
   3284       AE = 0.
   3285       WT = 0.
   3286 
   3287 C  LOOP THRU EACH TYPE OF QC CHECK
   3288 C  -------------------------------
   3289 
   3290       DO 100 IQ=1,NQC
   3291       IVMAX = 0
   3292 
   3293 C  CLEAR THE MATRIX ARRAYS
   3294 C  -----------------------
   3295 
   3296       FA = 0.
   3297       RA = 0.
   3298       DP = 0.
   3299 
   3300 C  SET UP VECTORS WITH INFORMATION ABOUT EACH OB TO BE CHECKED
   3301 C  -----------------------------------------------------------

Page 77          Source Listing                  QCOI
2017-04-18 11:07                                 oiqcbufr.f

   3302 
   3303       DO 15 IGRP=1,NXXYY
   3304       NDIM = MDIM(IGRP,IQ)
   3305       IF(NDIM.EQ.0) GOTO 15
   3306 
   3307       ILEV = MCHK(IGRP,1)
   3308       IREP = FHD(ILEV)
   3309 
   3310       TZF = FTZ(ILEV)
   3311       XXC = FLN(IREP)
   3312       YYC = FLT(IREP)
   3313       PPC = FPR(ILEV)
   3314       KKC = MCHK(IGRP,2)
   3315       CHL = CHLP(INT(MIN(PPC,1500.)))
   3316       FLA = FFLAT(INT(ABS(YYC)+1.51))
   3317       PPC = LOG(PPC)
   3318 
   3319       DO 10 IOB=1,NDIM
   3320 
   3321       JLEV  = MOBS(IGRP,IOB,IQ,1)
   3322       JTYP  = MOBS(IGRP,IOB,IQ,2)
   3323       JREP  = FHD(JLEV)
   3324       IVMAX = IVMAX+1
   3325 
   3326       CHLS(IVMAX) = CHL
   3327       FLAT(IVMAX) = FLA
   3328       TZFA(IVMAX) = TZF
   3329       XXCP(IVMAX) = XXC
   3330       YYCP(IVMAX) = YYC
   3331       KKCP(IVMAX) = KKC
   3332       PPCP(IVMAX) = PPC
   3333 
   3334       XXOB(IVMAX) = FLN(JREP)
   3335       YYOB(IVMAX) = FLT(JREP)
   3336       PPOB(IVMAX) = LOG(FPR(JLEV))
   3337       KKOB(IVMAX) = JTYP
   3338       OEOB(IVMAX) = FOE(JLEV)
   3339       OBOB(IVMAX) = FOB(JLEV,IVAR(JTYP))
   3340 
   3341       NGRP(IVMAX) = IGRP
   3342       NIOB(IVMAX) = IOB
   3343 
   3344 10    CONTINUE
   3345 15    CONTINUE
   3346 
   3347       IF(IVMAX.EQ.0) GOTO 61
   3348 
   3349 C  COMPUTE THE RIGHT HAND SIDES
   3350 C  ----------------------------
   3351 
   3352       CALL COOR2(IVMAX,CHLS,FLAT,TZFA,XXOB,YYOB,KKOB,XXCP,YYCP,KKCP,
   3353      .           DD,C1,C2)
   3354 
   3355       DO 20 I=1,IVMAX
   3356       IGRP = NGRP(I)
   3357       IOB  = NIOB(I)
   3358       VCOR = 1./(1.+CVC*(PPOB(I)-PPCP(I))**2)

Page 78          Source Listing                  QCOI
2017-04-18 11:07                                 oiqcbufr.f

   3359       RA(IGRP,IOB,1) = C1(I)*VCOR
   3360       RA(IGRP,IOB,2) = C2(I)*VCOR
   3361 20    CONTINUE
   3362 
   3363 C  COMPUTE THE OFF-DIAGONAL MATRIX TERMS
   3364 C  -------------------------------------
   3365 
   3366       K = 0
   3367       L = 0
   3368 
   3369       DO 40 IGRP=1,NXXYY
   3370       NDIM = MDIM(IGRP,IQ)
   3371       DO 30 IOB = 1,NDIM-1
   3372       DO 30 JOB = IOB+1,NDIM
   3373       I = IOB+K
   3374       J = JOB+K
   3375       L = L+1
   3376 
   3377       XI(L) = XXOB(I)
   3378       YI(L) = YYOB(I)
   3379       KI(L) = KKOB(I)
   3380       PI(L) = PPOB(I)
   3381       XJ(L) = XXOB(J)
   3382       YJ(L) = YYOB(J)
   3383       KJ(L) = KKOB(J)
   3384       PJ(L) = PPOB(J)
   3385       CH(L) = CHLS(I)
   3386       FL(L) = FLAT(I)
   3387       TZ(L) = TZFA(I)
   3388       NG(L) = NGRP(I)
   3389       NI(L) = NIOB(I)
   3390       NJ(L) = NIOB(J)
   3391 
   3392 30    CONTINUE
   3393 
   3394       K = K+NDIM
   3395 40    CONTINUE
   3396 
   3397       CALL COOR1(L,CH,FL,TZ,XI,YI,KI,XJ,YJ,KJ,DD,C1,C2)
   3398 
   3399 C  STORE OFF-DIAGONAL MATRIX TERMS IN THE SOLVER ARRAY
   3400 C  ---------------------------------------------------
   3401 
   3402       DO 50 I=1,L
   3403       IGRP = NG(I)
   3404       IOB  = IFA(NI(I),NJ(I))
   3405       FA(IGRP,IOB) = C1(I)/(1.+CVC*(PI(I)-PJ(I))**2)
   3406 50    CONTINUE
   3407 
   3408 C  COMPUTE AND STORE THE ON-DIAGONAL MATRIX TERMS
   3409 C  ----------------------------------------------
   3410 
   3411       DO 55 I=1,IVMAX
   3412       IGRP = NGRP(I)
   3413       IOB  = IFA(NIOB(I),NIOB(I))
   3414       FA(IGRP,IOB) = 1. + (OEOB(I)/FE(IGRP,KKOB(I)))**2
   3415 55    CONTINUE

Page 79          Source Listing                  QCOI
2017-04-18 11:07                                 oiqcbufr.f

   3416 
   3417 C  SOLVE THE LINEAR INTERPOLATION EQUATIONS
   3418 C  ----------------------------------------
   3419 
   3420       CALL DRCTSL(FA,RA,DP,MDIM(1,IQ),NXXYY)
   3421 
   3422 C  COMPUTE AND STORE ANALYSIS INCREMENTS AND ERRORS
   3423 C  ------------------------------------------------
   3424 
   3425       DO 60 I=1,IVMAX
   3426       IGRP              = NGRP(I)
   3427       IOB               = NIOB(I)
   3428       FERAT             = FE(IGRP,KKCP(I))/FE(IGRP,KKOB(I))
   3429       WT(IGRP,IOB,IQ,1) = RA(IGRP,IOB,1) * FERAT
   3430       WT(IGRP,IOB,IQ,2) = RA(IGRP,IOB,2) * FERAT
   3431       AA(IGRP,IQ,1)     = AA(IGRP,IQ,1) + OBOB(I)*WT(IGRP,IOB,IQ,1)
   3432       AA(IGRP,IQ,2)     = AA(IGRP,IQ,2) + OBOB(I)*WT(IGRP,IOB,IQ,2)
   3433 60    CONTINUE
   3434 
   3435 61    DO 65 I=1,NXXYY
   3436       AE(I,IQ,1) = FE(I,MCHK(I,2)) * SQRT(1.-DP(I,1))
   3437       AE(I,IQ,2) = FE(I,MCHK(I,2)) * SQRT(1.-DP(I,2))
   3438 65    CONTINUE
   3439 
   3440 C  END OF LOOP OVER EACH QC CHECK
   3441 C  ------------------------------
   3442 
   3443 100   CONTINUE
   3444 
   3445       RETURN
   3446       END

Page 80          Source Listing                  QCOI
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name             
                   
 qcoi_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  2312                                                           2287                              
 100                        Label  2411                                                           2258                              
 15                         Label  2313                                                           2271,2273                         
 20                         Label  2329                                                           2323                              
 30                         Label  2360                                                           2339,2340                         
 40                         Label  2363                                                           2337                              
 50                         Label  2374                                                           2370                              
 55                         Label  2383                                                           2379                              
 60                         Label  2401                                                           2393                              
 61                         Label  2403                                                           2315                              
 65                         Label  2406                                                           2403                              
 AA                         Scalar 2220     R(4)            4     3     512      COM              2251,2399,2400                    
 ABS                        Func   2284                                 scalar                    2284                              
 AE                         Scalar 2221     R(4)            4     3     512      COM              2252,2404,2405                    
 C1                         Local  2224     R(4)            4     1     3520                      2321,2327,2365,2373               
 C2                         Local  2225     R(4)            4     1     3520                      2321,2328,2365                    
 CH                         Local  2235     R(4)            4     1     3520                      2353,2365                         
 CHL                        Local  2283     R(4)            4           scalar                    2283,2294                         
 CHLP                       Scalar 2217     R(4)            4     1     1500     COM              2283                              
 CHLS                       Local  2224     R(4)            4     1     640                       2294,2320,2353                    
 COOR1                      Subr   2365                                                           2365                              
 COOR2                      Subr   2320                                                           2320                              
 CORP                       Common 2217                                 6768                                                        
 CVC                        Scalar 2217     R(4)            4           scalar   COM              2326,2373                         
 DD                         Local  2226     R(4)            4     1     3520                      2321,2365                         
 DP                         Local  2242     R(4)            4     2     128                       2266,2388,2404,2405               
 DRCTSL                     Subr   2388                                                           2388                              
 FA                         Local  2242     R(4)            4     2     3520                      2264,2373,2382,2388               
 FE                         Scalar 2222     R(4)            4     2     192      COM              2382,2396,2404,2405               
 FERAT                      Local  2396     R(4)            4           scalar                    2396,2397,2398                    
 FFE                        Scalar 2205     R(4)            4     2     2200000  COM                                                
 FFLAT                      Scalar 2217     R(4)            4     1     91       COM              2284                              
 FHD                        Scalar 2202     R(4)            4     1     1100000  COM              2276,2291                         
 FKX                        Scalar 2200     R(4)            4     1     900000   COM                                                
 FL                         Local  2236     R(4)            4     1     3520                      2354,2365                         
 FLA                        Local  2284     R(4)            4           scalar                    2284,2295                         
 FLAT                       Local  2225     R(4)            4     1     640                       2295,2320,2354                    
 FLN                        Scalar 2200     R(4)            4     1     900000   COM              2279,2302                         
 FLT                        Scalar 2199     R(4)            4     1     900000   COM              2280,2303                         
 FLV                        Scalar 2199     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 2201     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 2201     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 2201     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 2204     R(4)            4     2     2200000  COM              2307                              

Page 81          Source Listing                  QCOI
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FOC                        Scalar 2206     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 2205     R(4)            4     1     1100000  COM              2306                              
 FOI                        Scalar 2204     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 2206     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 2203     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 2203     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 2203     R(4)            4     1     1100000  COM              2281,2304                         
 FPRC                       Scalar 2202     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 2202     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 2204     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 2200     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 2206     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 2205     R(4)            4     1     1100000  COM              2278                              
 HVECT                      Common 2219                                 47364                                                       
 I                          Local  2323     I(4)            4           scalar                    2323,2324,2325,2326,2327,2328,2341
                                                                                                  ,2345,2346,2347,2348,2353,2354,235
                                                                                                  5,2356,2357,2370,2371,2372,2373,23
                                                                                                  79,2380,2381,2382,2393,2394,2395,2
                                                                                                  396,2399,2400,2403,2404,2405      
 IFA                        Scalar 2217     I(4)            4     2     100      COM              2372,2381                         
 IGRP                       Local  2271     I(4)            4           scalar                    2271,2272,2275,2282,2289,2290,2309
                                                                                                  ,2324,2327,2328,2337,2338,2371,237
                                                                                                  3,2380,2382,2394,2396,2397,2398,23
                                                                                                  99,2400                           
 ILEV                       Local  2275     I(4)            4           scalar                    2275,2276,2278,2281               
 INT                        Func   2283                                 scalar                    2283,2284                         
 IOB                        Local  2287     I(4)            4           scalar                    2287,2289,2290,2310,2325,2327,2328
                                                                                                  ,2339,2340,2341,2372,2373,2381,238
                                                                                                  2,2395,2397,2398,2399,2400        
 IQ                         Local  2258     I(4)            4           scalar                    2258,2272,2289,2290,2338,2388,2397
                                                                                                  ,2398,2399,2400,2404,2405         
 IREP                       Local  2276     I(4)            4           scalar                    2276,2279,2280                    
 IVAR                       Local  2242     I(4)            4     1     3                         2244,2307                         
 IVMAX                      Local  2259     I(4)            4           scalar                    2259,2292,2294,2295,2296,2297,2298
                                                                                                  ,2299,2300,2302,2303,2304,2305,230
                                                                                                  6,2307,2309,2310,2315,2320,2323,23
                                                                                                  79,2393                           
 J                          Local  2342     I(4)            4           scalar                    2342,2349,2350,2351,2352,2358     
 JLEV                       Local  2289     I(4)            4           scalar                    2289,2291,2304,2306,2307          
 JOB                        Local  2340     I(4)            4           scalar                    2340,2342                         
 JREP                       Local  2291     I(4)            4           scalar                    2291,2302,2303                    
 JTYP                       Local  2290     I(4)            4           scalar                    2290,2305,2307                    
 K                          Local  2334     I(4)            4           scalar                    2334,2341,2342,2362               
 KI                         Local  2229     I(4)            4     1     3520                      2347,2365                         
 KJ                         Local  2233     I(4)            4     1     3520                      2351,2365                         
 KKC                        Local  2282     I(4)            4           scalar                    2282,2299                         
 KKCP                       Local  2226     I(4)            4     1     640                       2299,2320,2396                    
 KKOB                       Local  2226     I(4)            4     1     640                       2305,2320,2347,2351,2382,2396     
 L                          Local  2335     I(4)            4           scalar                    2335,2343,2345,2346,2347,2348,2349
                                                                                                  ,2350,2351,2352,2353,2354,2355,235
                                                                                                  6,2357,2358,2365,2370             
 LMAT                       Param  2215     I(4)            4           scalar                    2224,2225,2226,2227,2228,2229,2230
                                                                                                  ,2231,2232,2233,2234,2235,2236,223
                                                                                                  7,2238,2239,2240                  
 LOG                        Func   2285                                 scalar                    2285,2304                         

Page 82          Source Listing                  QCOI
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LVEC                       Param  2214     I(4)            4           scalar                    2224,2225,2226,2227,2228,2229     
 MAXLEV                     Param  2197     I(4)            4           scalar                    2202,2203,2204,2205,2206          
 MAXREP                     Param  2196     I(4)            4           scalar                    2199,2200,2201,2202,2206          
 MCHK                       Scalar 2219     I(4)            4     2     128      COM              2275,2282,2404,2405               
 MDIM                       Scalar 2220     I(4)            4     2     256      COM              2272,2338,2388                    
 MIN                        Func   2283                                 scalar                    2283                              
 MOBS                       Scalar 2219     I(4)            4     4     5120     COM              2289,2290                         
 N                          Param  2213     I(4)            4           scalar                    2217,2242                         
 NDIM                       Local  2272     I(4)            4           scalar                    2272,2273,2287,2338,2339,2340,2362
 NG                         Local  2238     I(4)            4     1     3520                      2356,2371                         
 NGRP                       Local  2227     I(4)            4     1     640                       2309,2324,2356,2380,2394          
 NI                         Local  2239     I(4)            4     1     3520                      2357,2372                         
 NIOB                       Local  2228     I(4)            4     1     640                       2310,2325,2357,2358,2381,2395     
 NJ                         Local  2240     I(4)            4     1     3520                      2358,2372                         
 NMX                        Param  2211     I(4)            4           scalar                    2242                              
 NN                         Param  2212     I(4)            4           scalar                    2215,2242                         
 NQC                        Param  2210     I(4)            4           scalar                    2258                              
 NXXYY                      Scalar 2219     I(4)            4           scalar   COM              2249,2271,2337,2388,2403          
 OBOB                       Local  2229     R(4)            4     1     640                       2307,2399,2400                    
 OEOB                       Local  2228     R(4)            4     1     640                       2306,2382                         
 OIQCDATA                   Common 2199                                 22790000                                                    
                                                                        0                                                           
 PI                         Local  2230     R(4)            4     1     3520                      2348,2373                         
 PJ                         Local  2234     R(4)            4     1     3520                      2352,2373                         
 PPC                        Local  2281     R(4)            4           scalar                    2281,2283,2285,2300               
 PPCP                       Local  2227     R(4)            4     1     640                       2300,2326                         
 PPOB                       Local  2227     R(4)            4     1     640                       2304,2326,2348,2352               
 QCOI                       Subr   2194                                                                                             
 RA                         Local  2242     R(4)            4     3     1280                      2265,2327,2328,2388,2397,2398     
 SQRT                       Func   2404                                 scalar                    2404,2405                         
 TZ                         Local  2237     R(4)            4     1     3520                      2355,2365                         
 TZF                        Local  2278     R(4)            4           scalar                    2278,2296                         
 TZFA                       Local  2226     R(4)            4     1     640                       2296,2320,2355                    
 VCOR                       Local  2326     R(4)            4           scalar                    2326,2327,2328                    
 WT                         Scalar 2221     R(4)            4     4     5120     COM              2253,2397,2398,2399,2400          
 XI                         Local  2227     R(4)            4     1     3520                      2345,2365                         
 XJ                         Local  2231     R(4)            4     1     3520                      2349,2365                         
 XXC                        Local  2279     R(4)            4           scalar                    2279,2297                         
 XXCP                       Local  2224     R(4)            4     1     640                       2297,2320                         
 XXOB                       Local  2224     R(4)            4     1     640                       2302,2320,2345,2349               
 YI                         Local  2228     R(4)            4     1     3520                      2346,2365                         
 YJ                         Local  2232     R(4)            4     1     3520                      2350,2365                         
 YYC                        Local  2280     R(4)            4           scalar                    2280,2284,2298                    
 YYCP                       Local  2225     R(4)            4     1     640                       2298,2320                         
 YYOB                       Local  2225     R(4)            4     1     640                       2303,2320,2346,2350               

Page 83          Source Listing                  QCOI
2017-04-18 11:07                                 oiqcbufr.f

   3447 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3448 C
   3449 C SUBPROGRAM:    QCPTS
   3450 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   3451 C
   3452 C ABSTRACT: PUTS TOGETHER PACKAGES OF OBSERVATIONS TO BE CHECKED IN A
   3453 C   GIVEN ITERATION AND INVOKES AUTOTASKING OF THE DATA SELECTION, OI,
   3454 C   AND DECISION MAKING PROCEDURES.
   3455 C
   3456 C PROGRAM HISTORY LOG:
   3457 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   3458 C
   3459 C USAGE:    CALL QCPTS
   3460 C
   3461 C REMARKS: INPUT INFORMATION IN COMMON /CKLIST/:
   3462 C     NDD     - NUMBER OF OBSERVATIONS TO CHECK
   3463 C     INDD    - ARRAY OF OBSERVATION INDEXES TO CHECK
   3464 C
   3465 C
   3466 C ATTRIBUTES:
   3467 C   LANGUAGE: FORTRAN 90
   3468 C   MACHINE:  NCEP WCOSS
   3469 C
   3470 C$$$
   3471       SUBROUTINE QCPTS
   3472 
   3473       PARAMETER (MAXLEV=1100000)
   3474 
   3475       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   3476      .                     MDIM(64,4),AA(64,4,2),
   3477      .                     AE(64,4,2),WTS(64,10,4,2),
   3478      .                     FE(64,3)
   3479 
   3480       common /nddspt/ nd1(0:100),nd2(0:100)
   3481       COMMON /CKLIST/ NDD,INDD(MAXLEV)
   3482       DATA NMX /64/
   3483 
   3484       include "mpif.h"
   3485 
   3486 C-----------------------------------------------------------------------
   4003       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   4004 c     call nddsplit(myid,nd1,nd2)
   4005 C-----------------------------------------------------------------------
   4006 
   4007 C  MULTI-PROCESS QC OB LISTS
   4008 C  -------------------------
   4009 
   4010       DO I=nd1(myid),nd2(myid),nmx
   4011       CALL SELDAT(i,min(nmx,nd2(myid)-i+1))
   4012       CALL QCOI
   4013       CALL OUTPUT
   4014       ENDDO
   4015 
   4016       RETURN
   4017       END

Page 84          Source Listing                  QCPTS
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name              
                    
 qcpts_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AA                         Scalar 2444     R(4)            4     3     512      COM                                                
 AE                         Scalar 2445     R(4)            4     3     512      COM                                                
 CKLIST                     Common 2449                                 4400004                                                     
 FE                         Scalar 2446     R(4)            4     2     192      COM                                                
 HVECT                      Common 2443                                 47364                                                       
 I                          Local  2462     I(4)            4           scalar                    2462,2463                         
 IERR                       Local  2455     I(4)            4           scalar                    2455                              
 INDD                       Scalar 2449     I(4)            4     1     1100000  COM                                                
 MAXLEV                     Param  2441     I(4)            4           scalar                    2449                              
 MCHK                       Scalar 2443     I(4)            4     2     128      COM                                                
 MDIM                       Scalar 2444     I(4)            4     2     256      COM                                                
 MIN                        Func   2463                                 scalar                    2463                              
 MOBS                       Scalar 2443     I(4)            4     4     5120     COM                                                
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      

Page 85          Source Listing                  QCPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   2455                                                           2455                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    2455                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      

Page 86          Source Listing                  QCPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      

Page 87          Source Listing                  QCPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      

Page 88          Source Listing                  QCPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      

Page 89          Source Listing                  QCPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  2455     I(4)            4           scalar                    2455,2462,2463                    
 ND1                        Scalar 2448     I(4)            4     1     101      COM              2462                              
 ND2                        Scalar 2448     I(4)            4     1     101      COM              2462,2463                         
 NDD                        Scalar 2449     I(4)            4           scalar   COM                                                
 NDDSPT                     Common 2448                                 808                                                         
 NMX                        Local  2450     I(4)            4           scalar                    2450,2462,2463                    
 NXXYY                      Scalar 2443     I(4)            4           scalar   COM                                                
 OUTPUT                     Subr   2465                                                           2465                              
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 QCOI                       Subr   2464                                                           2464                              
 QCPTS                      Subr   2439                                                                                             
 SELDAT                     Subr   2463                                                           2463                              
 WTS                        Scalar 2445     R(4)            4     4     5120     COM                                                

Page 90          Source Listing                  QCPTS
2017-04-18 11:07                                 oiqcbufr.f

   4018 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
   4019 C
   4020 C SUBPROGRAM:    RDOBER
   4021 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1992-07-29
   4022 C
   4023 C ABSTRACT: INITIALIZES ARRAY 'QIKE' WITH OBSERVATION ERRORS FOR ALL
   4024 C   KINDS OF OBSERVATION TYPES LISTED IN THE OBSERVATION ERROR FILE.
   4025 C
   4026 C PROGRAM HISTORY LOG:
   4027 C 1986-03-21  G. DIMEGO  - ORIGINAL AUTHOR
   4028 C 1988-11-24  D. DEAVEN  - RECODED FOR CYBER 205
   4029 C 1992-07-29  J. WOOLLEN - UPDATED FOR OIQC
   4030 C
   4031 C USAGE:    CALL RDOBER(LU)
   4032 C   INPUT ARGUMENT LIST:
   4033 C     LU       - LOGICAL UNIT FOR OBSERVATION ERROR TABLE FILE SPECIFIC
   4034 C                TO THIS PROGRAM
   4035 C
   4036 C   INPUT FILES:
   4037 C     UNIT LU  - OBSERVATION ERROR TABLE FILE SPECIFIC TO THIS PROGRAM
   4038 C                (THIS IS NOT THE ANALYSIS OBSERVATION ERROR FILE -
   4039 C                 THOSE DATA ARE READ FROM THE PREPBUFR FILE)
   4040 C   OUTPUT FILES:
   4041 C     UNIT 06  - STANDARD OUTPUT PRINT
   4042 C
   4043 C ATTRIBUTES:
   4044 C   LANGUAGE: FORTRAN 90
   4045 C   MACHINE:  NCEP WCOSS
   4046 C
   4047 C$$$
   4048       SUBROUTINE RDOBER(LU)
   4049 
   4050       COMMON /OBERRS/ QIKE(21,300),PMAND(21),P50(21),CHL(21)
   4051       COMMON /OBDESC/ DESC(300)
   4052       COMMON /GETOE/  USEOE
   4053 
   4054       CHARACTER*80 CKX,DESC
   4055       DIMENSION    RAWERR(21)
   4056       LOGICAL      USEOE
   4057 
   4058       DATA RAWERR /  7.0 ,  7.5 ,  8.5 , 11.0 , 13.7 , 15.2 , 16.0 ,
   4059      .              16.1 , 17.5 , 19.1 , 20.5 , 24.0 , 24.0 , 24.0 ,
   4060      .              24.0 , 24.0 , 24.0 , 24.0 , 24.0 , 24.0 , 24.0 /
   4061 
   4062       DATA DUMMY/0./
   4063 
   4064 C----------------------------------------------------------------------
   4065 C----------------------------------------------------------------------
   4066 
   4067 C  DEFAULT VALUES FOR OB DESCRIPTIONS AND ERRORS
   4068 C  ---------------------------------------------
   4069 
   4070       DO 1 I=1,300
   4071       DESC(I) = ' '
   4072       DO 1 L=1,21
   4073       QIKE(L,I) = 0.
   4074       IF(I.EQ.120) QIKE(L,I) = RAWERR(L)

Page 91          Source Listing                  RDOBER
2017-04-18 11:07                                 oiqcbufr.f

   4075 1     CONTINUE
   4076 
   4077       USEOE = .FALSE.
   4078 
   4079 C  READ OB ERROR VALUES FROM OB ERROR FILE
   4080 C  ---------------------------------------
   4081 
   4082 10    READ(LU,'(A80)',END=20) CKX
   4083       IF(CKX(1:1).EQ.' ') GOTO 10
   4084       READ(CKX,'(I3)',ERR=15) KX
   4085       IF(KX.GT.0 .AND. KX.LT.300) THEN
   4086          READ(LU,'(7F8.2)',END=20) (QIKE(L,KX),L=1,21)
   4087          DESC(KX) = CKX
   4088          USEOE = .TRUE.
   4089          GOTO 10
   4090       ENDIF
   4091 
   4092 15    PRINT*,'******************************************************'
   4093       PRINT*,'*******  UNRECOGNISED RECORD IN OBERRS FILE  *********'
   4094       PRINT*,                        CKX
   4095       PRINT*,'******************************************************'
   4096       GOTO 10
   4097 
   4098 20    RETURN
   4099       END


ENTRY POINTS

  Name               
                     
 rdober_             

Page 92          Source Listing                  RDOBER
2017-04-18 11:07 Symbol Table                    oiqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  2527                                                           2522,2524                         
 10                         Label  2534                                                           2535,2541,2548                    
 15                         Label  2544                                                           2536                              
 20                         Label  2550                                                           2534,2538                         
 CHL                        Scalar 2502     R(4)            4     1     21       COM                                                
 CKX                        Local  2506     CHAR            80          scalar                    2534,2535,2536,2539,2546          
 DESC                       Scalar 2503     CHAR            80    1     300      COM              2523,2539                         
 DUMMY                      Local  2514     R(4)            4           scalar                    2514                              
 GETOE                      Common 2504                                 4                                                           
 I                          Local  2522     I(4)            4           scalar                    2522,2523,2525,2526               
 KX                         Local  2536     I(4)            4           scalar                    2536,2537,2538,2539               
 L                          Local  2524     I(4)            4           scalar                    2524,2525,2526,2538               
 LU                         Dummy  2500     I(4)            4           scalar   ARG,INOUT        2534,2538                         
 OBDESC                     Common 2503                                 24000                                                       
 OBERRS                     Common 2502                                 25452                                                       
 P50                        Scalar 2502     R(4)            4     1     21       COM                                                
 PMAND                      Scalar 2502     R(4)            4     1     21       COM                                                
 QIKE                       Scalar 2502     R(4)            4     2     6300     COM              2525,2526,2538                    
 RAWERR                     Local  2507     R(4)            4     1     21                        2510,2526                         
 RDOBER                     Subr   2500                                                                                             
 USEOE                      Scalar 2504     L(4)            4           scalar   COM              2529,2540                         

Page 93          Source Listing                  RDOBER
2017-04-18 11:07                                 oiqcbufr.f

   4100 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4101 C
   4102 C SUBPROGRAM:    SATPTS
   4103 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   4104 C
   4105 C ABSTRACT: PUTS TOGETHER PACKAGES OF OBSERVATIONS TO BE CHECKED IN A
   4106 C   GIVEN ITERATION AND INVOKES AUTOTASKING OF THE DATA SELECTION, OI,
   4107 C   AND DECISION MAKING PROCEDURES.
   4108 C
   4109 C PROGRAM HISTORY LOG:
   4110 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   4111 C
   4112 C USAGE:    CALL SATPTS
   4113 C   OUTPUT FILES:
   4114 C     UNIT 06  - STANDARD OUTPUT PRINT
   4115 C
   4116 C REMARKS: INPUT INFORMATION IN COMMON /CKLIST/:
   4117 C     NDD     - NUMBER OF OBSERVATIONS TO CHECK
   4118 C     INDD    - ARRAY OF OBSERVATION INDEXES TO CHECK
   4119 C
   4120 C
   4121 C ATTRIBUTES:
   4122 C   LANGUAGE: FORTRAN 90
   4123 C   MACHINE:  NCEP WCOSS
   4124 C
   4125 C$$$
   4126       SUBROUTINE SATPTS
   4127 
   4128       PARAMETER (MAXREP=900000)
   4129       PARAMETER (MAXLEV=1100000)
   4130 
   4131       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   4132      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   4133      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   4134      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   4135      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   4136      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   4137      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   4138      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   4139       CHARACTER*3 FOC
   4140 
   4141 
   4142       common /nddspt/ nd1(0:100),nd2(0:100)
   4143       COMMON /CKLIST/ NDD,INDD(MAXLEV)
   4144       DIMENSION IND(5000),NXY(5000)
   4145       DATA NMX /64/
   4146 
   4147       include "mpif.h"
   4148 
   4149 C-----------------------------------------------------------------------
   4666       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   4667 c     call nddsplit(myid,nd1,nd2)
   4668 C-----------------------------------------------------------------------
   4669 
   4670 C  ASSEMBLE LISTS OF OBS FOR MULTI PROCESSING
   4671 C  ------------------------------------------
   4672 

Page 94          Source Listing                  SATPTS
2017-04-18 11:07                                 oiqcbufr.f

   4673       IND(1) = 1
   4674       NXY    = 0
   4675       IPK    = 1
   4676       NPK    = 0
   4677       LREP   = 0
   4678 
   4679       DO 5 I=nd1(myid),nd2(myid)
   4680       ILEV = INDD(I)
   4681       IREP = FHD(ILEV)
   4682       IF(IREP.NE.LREP) THEN
   4683          LREP = IREP
   4684          KLEV = FNL(IREP)
   4685          IF(NXY(IPK)+KLEV.GT.NMX) THEN
   4686             IF(IPK+1.GT.5000) THEN
   4687                PRINT *, 'QCPTS - IPK > MAXPAK'
   4688                CALL W3TAGE('PREPOBS_OIQCBUFR')
   4689                CALL ERREXIT(99)
   4690             ENDIF
   4691             IPK = IPK+1
   4692             IND(IPK) = I
   4693             NXY(IPK) = KLEV
   4694          ELSE
   4695             NXY(IPK) = NXY(IPK) + KLEV
   4696          ENDIF
   4697       ENDIF
   4698 5     CONTINUE
   4699 
   4700 C  MULTI-PROCESS QC OB LISTS
   4701 C  -------------------------
   4702 
   4703       DO 10 I=1,IPK
   4704       CALL SELDAT(IND(I),NXY(I))
   4705       CALL QCOI
   4706       CALL SATPUT
   4707 10    CONTINUE
   4708 
   4709       RETURN
   4710       END

Page 95          Source Listing                  SATPTS
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name               
                     
 satpts_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  2643                                                           2639                              
 5                          Label  2634                                                           2615                              
 CKLIST                     Common 2595                                 4400004                                                     
 ERREXIT                    Subr   2625                                                           2625                              
 FFE                        Scalar 2589     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 2586     R(4)            4     1     1100000  COM              2617                              
 FKX                        Scalar 2584     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 2584     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 2583     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 2583     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 2585     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 2585     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 2585     R(4)            4     1     900000   COM              2620                              
 FOB                        Scalar 2588     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 2590     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 2589     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 2588     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 2590     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 2587     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 2587     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 2587     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 2586     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 2586     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 2588     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 2584     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 2590     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 2589     R(4)            4     1     1100000  COM                                                
 I                          Local  2615     I(4)            4           scalar                    2615,2616,2628,2639,2640          
 IERR                       Local  2602     I(4)            4           scalar                    2602                              
 ILEV                       Local  2616     I(4)            4           scalar                    2616,2617                         
 IND                        Local  2596     I(4)            4     1     5000                      2609,2628,2640                    
 INDD                       Scalar 2595     I(4)            4     1     1100000  COM              2616                              
 IPK                        Local  2611     I(4)            4           scalar                    2611,2621,2622,2627,2628,2629,2631
                                                                                                  ,2639                             
 IREP                       Local  2617     I(4)            4           scalar                    2617,2618,2619,2620               
 KLEV                       Local  2620     I(4)            4           scalar                    2620,2621,2629,2631               
 LREP                       Local  2613     I(4)            4           scalar                    2613,2618,2619                    
 MAXLEV                     Param  2581     I(4)            4           scalar                    2586,2587,2588,2589,2590,2595     
 MAXREP                     Param  2580     I(4)            4           scalar                    2583,2584,2585,2586,2590          
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               

Page 96          Source Listing                  SATPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      

Page 97          Source Listing                  SATPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_COMM_RANK              Subr   2602                                                           2602                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    2602                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      

Page 98          Source Listing                  SATPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      

Page 99          Source Listing                  SATPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      

Page 100         Source Listing                  SATPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  2602     I(4)            4           scalar                    2602,2615                         

Page 101         Source Listing                  SATPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ND1                        Scalar 2594     I(4)            4     1     101      COM              2615                              
 ND2                        Scalar 2594     I(4)            4     1     101      COM              2615                              
 NDD                        Scalar 2595     I(4)            4           scalar   COM                                                
 NDDSPT                     Common 2594                                 808                                                         
 NMX                        Local  2597     I(4)            4           scalar                    2597,2621                         
 NPK                        Local  2612     I(4)            4           scalar                    2612                              
 NXY                        Local  2596     I(4)            4     1     5000                      2610,2621,2629,2631,2640          
 OIQCDATA                   Common 2583                                 22790000                                                    
                                                                        0                                                           
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 QCOI                       Subr   2641                                                           2641                              
 SATPTS                     Subr   2578                                                                                             
 SATPUT                     Subr   2642                                                           2642                              
 SELDAT                     Subr   2640                                                           2640                              
 W3TAGE                     Subr   2624                                                           2624                              

Page 102         Source Listing                  SATPTS
2017-04-18 11:07                                 oiqcbufr.f

   4711 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4712 C
   4713 C SUBPROGRAM:    SATPUT
   4714 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   4715 C
   4716 C ABSTRACT: EXAMINES OUTPUTS FROM OI QUALITY CONTROL INTERPOLATION AND
   4717 C   MAKES DECISION WHETHER A SATELLITE PASSES OR FAILS THE CHECKS. DUE
   4718 C   TO SPECIFIC CHARACTERISTIC DIFFERENCES OF SATELLITE RETRIEVALS FROM
   4719 C   CONVENTIONAL 'IN-SITU' OBSERVATIONS, A SPECIAL ALGORITHM IS
   4720 C   EMPLOYED IN JUDGING THE OUTCOMES OF THE QC CHECKS. ALSO PROVIDES
   4721 C   FOR A DETAILED PRINT TRACING ALL DECISIONS MADE IN REGARD TO
   4722 C   SPECIFIED OBSERVATIONS IN THE QC PROCESS.
   4723 C
   4724 C PROGRAM HISTORY LOG:
   4725 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   4726 C
   4727 C USAGE:    CALL SATPUT
   4728 C
   4729 C   OUTPUT FILES:
   4730 C     UNIT 06  - STANDARD OUTPUT PRINT
   4731 C     UNIT ITUNIT  - DETAILED TOSSLIST (SEE REMARKS)
   4732 C
   4733 C REMARKS: POSSIBLE VALUES FOR ITUNIT (PASSED IN VIA COMMMON
   4734 C   /TOSSUNIT/):
   4735 C     61 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR SURFACE HEIGHTS
   4736 C     62 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR TEMPS AND WINDS
   4737 C     63 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR SAT TEMPS
   4738 C     64 - UNIT FOR FILE HOLDING DETAILED TOSSLIST FOR SSMI WIND SPEEDS
   4739 C
   4740 C INPUT INFORMATION IN COMMON /HVECT/:
   4741 C     NXXYY    - NUMBER OF OBS IN PACKAGE
   4742 C     XX       - LONGITUDES OF OBS IN PACKAGE
   4743 C     YY       - LATITUDES OF OBS IN PACKAGE
   4744 C     PP       - PRESSURES OF OBS IN PACKAGE
   4745 C     II       - INDEXES OF OBS IN PACKAGE
   4746 C     LL       - REPORT LEVEL OF OBS IN PACKAGE
   4747 C     FESD     - FORECAST ERRORS AT OB LOCATIONS
   4748 C     AA       - INTERPOLATED VALUE OF OBS IN PACKAGE
   4749 C     AESD     - ANALYSIS ERRORS AT OB LOCATIONS
   4750 C     MKOBS    - LIST OF OB INDEXES USED IN EACH INTERPOLATION
   4751 C     NDIM     - NUMBER OF OBS USED IN EACH INTERPOLATION
   4752 C     JVMAX    - NUMBER OF INTERPOLATING OBS FOR EACH CHECK IN
   4753 C                EACH PACKAGE
   4754 C
   4755 C   OUTPUT INFORMATION IN COMMON /OBMARK/:
   4756 C     OBIND    - CONTAINS QC OUTCOME FOR EACH REPORT AND LEVEL:
   4757 C                   -2 = BELOW MODEL SURFACE (SET IN SUB PSFILE)
   4758 C                   -1 = FAILED OI CHECKS
   4759 C                    0 = NO DATA IN REPORT
   4760 C                    1 = PASSED OI CHECKS
   4761 C
   4762 C ATTRIBUTES:
   4763 C   LANGUAGE: FORTRAN 90
   4764 C   MACHINE:  NCEP WCOSS
   4765 C
   4766 C$$$
   4767       SUBROUTINE SATPUT

Page 103         Source Listing                  SATPUT
2017-04-18 11:07                                 oiqcbufr.f

   4768 
   4769       PARAMETER (MAXREP=900000)
   4770       PARAMETER (MAXLEV=1100000)
   4771 
   4772       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   4773      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   4774      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   4775      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   4776      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   4777      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   4778      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   4779      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   4780       CHARACTER*3 FOC
   4781 
   4782 
   4783       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   4784      .                     MDIM(64,4),AA(64,4,2),
   4785      .                     AE(64,4,2),WTS(64,10,4,2),
   4786      .                     FE(64,3)
   4787 
   4788       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   4789       COMMON /CORP    / CHLP(1500),CVC,FFLAT(91),IFA(10,10)
   4790       COMMON /SATCOR  / EPSCOR(20)
   4791       COMMON /TOLLER  / ITER,TB,TZ,TSAT,TWND,TJET
   4792       COMMON /TOSSUNIT/ ITUNIT
   4793 
   4794       CHARACTER*8 SEG(2)
   4795       DIMENSION   OMA1(50),OMA2(50),EPV1(50),EPV2(50),QCT(50),QCS(50)
   4796       DIMENSION   ASD(50,2)
   4797       DIMENSION   RAF(50,2)
   4798       DIMENSION   OMA(50,2)
   4799       DIMENSION   LEV(50,2)
   4800       DIMENSION   OSD(50,2)
   4801       DIMENSION   FSD(50,2)
   4802       DIMENSION   PRS(50,2)
   4803       DIMENSION   NSEG(2)
   4804       REAL*8      SID,STAID
   4805 
   4806       DATA SEG/'1000-100','099 - 00'/
   4807 
   4808       LOGICAL LAST
   4809       DATA PI180/.017453/, MAXNSEG/50/
   4810 
   4811 C----------------------------------------------------------------------
   4812 C----------------------------------------------------------------------
   4813 
   4814       LLEV = MCHK(1,1)
   4815       LREP = FHD(LLEV)
   4816       NSEG = 0
   4817 
   4818 C  LOOP OVER EACH SAT LEVEL IN THIS GROUP
   4819 C  --------------------------------------
   4820 
   4821       DO 50 I=1,NXXYY
   4822       LAST = I.EQ.NXXYY
   4823       ILEV = MCHK(I,1)
   4824       IREP = FHD(ILEV)

Page 104         Source Listing                  SATPUT
2017-04-18 11:07                                 oiqcbufr.f

   4825 
   4826 C  ITEMIZE COMPLETE PROFILES INTO SEGMENTS
   4827 C  ---------------------------------------
   4828 
   4829 10    IF(IREP.EQ.LREP) THEN
   4830          PRES = FPR(ILEV)
   4831          OBER = FOE(ILEV)
   4832          OMF  = FOB(ILEV,2)
   4833 
   4834          IF(PRES.LE.2000. .AND. PRES.GE.100.) THEN
   4835             K = 1
   4836          ELSE IF(PRES.LT.100. .AND. PRES.GT.0.) THEN
   4837             K = 2
   4838          ENDIF
   4839 
   4840          NSEG(K) = NSEG(K) + 1
   4841          IF(NSEG(K).GT.MAXNSEG) THEN
   4842             PRINT *, 'SATPUT - MAX NSEG EXCEEDED'
   4843             CALL W3TAGE('PREPOBS_OIQCBUFR')
   4844             CALL ERREXIT(99)
   4845          ENDIF
   4846          J = NSEG(K)
   4847 
   4848 C  STORE THE RESULTS OF THE CHECKS
   4849 C  -------------------------------
   4850 
   4851          ASD(J,K) = 0.
   4852          OMA(J,K) = 0.
   4853          SWT      = 0.
   4854 
   4855          DO 20 L=1,3
   4856          AER = AE(I,L,1)
   4857          FER = FE(I,1)
   4858          AMF = AA(I,L,1)
   4859          WT = MAX(.01,1.-(AER/FER)**2)
   4860          ASD(J,K) = ASD(J,K) + WT*AER**2
   4861          OMA(J,K) = OMA(J,K) + (OMF-AMF)*WT
   4862          SWT = SWT + WT
   4863 20       CONTINUE
   4864 
   4865          ASD(J,K) = SQRT(ASD(J,K)/SWT)
   4866          OMA(J,K) = OMA(J,K)/SWT
   4867          RAF(J,K) = ASD(J,K)/FER
   4868          LEV(J,K) = ILEV
   4869          FSD(J,K) = FER
   4870          OSD(J,K) = OBER
   4871          PRS(J,K) = PRES
   4872          IF(.NOT.LAST) GOTO 50
   4873       ENDIF
   4874 
   4875 C  A REPORT IS ITEMIZED AND READY TO JUDGE
   4876 C  ---------------------------------------
   4877 
   4878       STAID = SID(LREP)
   4879       CLAT  = FLT(LREP)
   4880       CLON  = FLN(LREP)
   4881       KX    = FKX(LREP)

Page 105         Source Listing                  SATPUT
2017-04-18 11:07                                 oiqcbufr.f

   4882       LREP  = IREP
   4883 
   4884 C  COMPUTE THE TOLERANCE VALUE
   4885 C  ---------------------------
   4886 
   4887       SINLAT = SIN(ABS(CLAT)*PI180)
   4888       TT     = TB*TSAT*SINLAT
   4889       TMIN   = 2.0
   4890       TT     = MAX(TMIN,TT)
   4891 
   4892 C  SUM THE RESULTS OVER THE PROFILE SEGMENTS - MAKE AND STORE DECISION
   4893 C  -------------------------------------------------------------------
   4894 
   4895       DO 35 K=1,2
   4896       IF (NSEG(K).EQ.0) GOTO 35
   4897       QC1 = 0.
   4898       QC2 = 0.
   4899       QCT = 0.
   4900       QCS = 0.
   4901       OMA1 = 0.
   4902       OMA2 = 0.
   4903       EPV1 = 0.
   4904       EPV2 = 0.
   4905       TADJ = 0.
   4906 
   4907       DO 30 J=1,NSEG(K)
   4908       TADJ = TADJ + MAX(1.,(OSD(J,K)/FSD(J,K))**2)
   4909       DT = OMA(J,K)**2
   4910       EPV = (ASD(J,K)**2+OSD(J,K)**2)
   4911       OMA1(J) = DT
   4912       EPV1(J) = EPV
   4913       QCT(J) = SQRT(DT/EPV)
   4914       QC1 = MAX(QC1,QCT(J))
   4915 
   4916       IF(J.GT.1) THEN
   4917          RPLN = LOG(PRS(J-1,K)/PRS(J,K))
   4918          PL=20.*RPLN + 1.001
   4919          IF(PL.LT.20.) THEN
   4920             KP=PL
   4921             XP=PL-KP
   4922             OBCOR = (1.-XP)*EPSCOR(KP) + XP*EPSCOR(KP+1)
   4923          ELSE
   4924             OBCOR = 0.
   4925          ENDIF
   4926          COVO = OSD(J-1,K)*OSD(J,K)*OBCOR
   4927          FCCOR = 1./(1.+CVC*RPLN**2)
   4928          COVA = ASD(J-1,K)*ASD(J,K)*FCCOR
   4929          STAB = (OMA(J-1,K)-OMA(J,K))**2
   4930          ESTAB  = EPV+EPV0 - 2.*(COVO+COVA)
   4931          OMA2(J-1) = STAB
   4932          EPV2(J-1) = ESTAB
   4933          QCS(J-1) = SQRT(STAB/ESTAB)
   4934          QC2 = MAX(QC2,QCS(J-1))
   4935       ENDIF
   4936       EPV0 = EPV
   4937 30    CONTINUE
   4938 

Page 106         Source Listing                  SATPUT
2017-04-18 11:07                                 oiqcbufr.f

   4939       TADJ = SQRT(TADJ/NSEG(K))
   4940       TTT = TT/TADJ
   4941 
   4942       QC = MAX(QC1,QC2)
   4943       IQC = SIGN(1.,TTT-QC)
   4944 
   4945       IF(IQC.EQ.-1) THEN
   4946          WRITE(ITUNIT,31)STAID,KX,CLON,CLAT,SEG(K),QC1,QC2,QC,TTT
   4947 31       FORMAT(A6,I4,2F8.2,A10,4F8.2)
   4948       ENDIF
   4949 
   4950       DO 32 J=1,NSEG(K)
   4951       KIQC = IQC
   4952       IF(CLAT.LT.0. .OR. PRS(J,K).LE.100.) THEN
   4953          QC = MAX(QCT(J),QCS(J))
   4954          KIQC = SIGN(1.,TTT-QC)
   4955       ENDIF
   4956       FOI(LEV(J,K)) = KIQC
   4957 32    CONTINUE
   4958 
   4959 35    CONTINUE
   4960 
   4961 C  WRAP BACK TO START THE NEXT PROFILE
   4962 C  -----------------------------------
   4963 
   4964       IF(.NOT.LAST) THEN
   4965          NSEG = 0
   4966          GOTO 10
   4967       ENDIF
   4968 
   4969 C  END OF LOOP OVER LEVELS
   4970 C  -----------------------
   4971 
   4972 50    CONTINUE
   4973 
   4974       RETURN
   4975       END

Page 107         Source Listing                  SATPUT
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name               
                     
 satput_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  2765                                                           2902                              
 20                         Label  2799                                                           2791                              
 30                         Label  2873                                                           2843                              
 31                         Label  2883                                                           2882                              
 32                         Label  2893                                                           2886                              
 35                         Label  2895                                                           2831,2832                         
 50                         Label  2908                                                           2757,2808                         
 AA                         Scalar 2720     R(4)            4     3     512      COM              2794                              
 ABS                        Func   2823                                 scalar                    2823                              
 AE                         Scalar 2721     R(4)            4     3     512      COM              2792                              
 AER                        Local  2792     R(4)            4           scalar                    2792,2795,2796                    
 AMF                        Local  2794     R(4)            4           scalar                    2794,2797                         
 ASD                        Local  2732     R(4)            4     2     100                       2787,2796,2801,2803,2846,2864     
 CHLP                       Scalar 2725     R(4)            4     1     1500     COM                                                
 CLAT                       Local  2815     R(4)            4           scalar                    2815,2823,2882,2888               
 CLON                       Local  2816     R(4)            4           scalar                    2816,2882                         
 CORP                       Common 2725                                 6768                                                        
 COVA                       Local  2864     R(4)            4           scalar                    2864,2866                         
 COVO                       Local  2862     R(4)            4           scalar                    2862,2866                         
 CVC                        Scalar 2725     R(4)            4           scalar   COM              2863                              
 DT                         Local  2845     R(4)            4           scalar                    2845,2847,2849                    
 EPSCOR                     Scalar 2726     R(4)            4     1     20       COM              2858                              
 EPV                        Local  2846     R(4)            4           scalar                    2846,2848,2849,2866,2872          
 EPV0                       Local  2866     R(4)            4           scalar                    2866,2872                         
 EPV1                       Local  2731     R(4)            4     1     50                        2839,2848                         
 EPV2                       Local  2731     R(4)            4     1     50                        2840,2868                         
 ERREXIT                    Subr   2780                                                           2780                              
 ESTAB                      Local  2866     R(4)            4           scalar                    2866,2868,2869                    
 FCCOR                      Local  2863     R(4)            4           scalar                    2863,2864                         
 FE                         Scalar 2722     R(4)            4     2     192      COM              2793                              
 FER                        Local  2793     R(4)            4           scalar                    2793,2795,2803,2805               
 FFE                        Scalar 2714     R(4)            4     2     2200000  COM                                                
 FFLAT                      Scalar 2725     R(4)            4     1     91       COM                                                
 FHD                        Scalar 2711     R(4)            4     1     1100000  COM              2751,2760                         
 FKX                        Scalar 2709     R(4)            4     1     900000   COM              2817                              
 FLN                        Scalar 2709     R(4)            4     1     900000   COM              2816                              
 FLT                        Scalar 2708     R(4)            4     1     900000   COM              2815                              
 FLV                        Scalar 2708     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 2710     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 2710     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 2710     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 2713     R(4)            4     2     2200000  COM              2768                              
 FOC                        Scalar 2715     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 2714     R(4)            4     1     1100000  COM              2767                              

Page 108         Source Listing                  SATPUT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FOI                        Scalar 2713     R(4)            4     1     1100000  COM              2892                              
 FPF                        Scalar 2715     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 2712     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 2712     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 2712     R(4)            4     1     1100000  COM              2766                              
 FPRC                       Scalar 2711     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 2711     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 2713     R(4)            4     1     1100000  COM                                                
 FSD                        Local  2737     R(4)            4     2     100                       2805,2844                         
 FTM                        Scalar 2709     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 2715     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 2714     R(4)            4     1     1100000  COM                                                
 HVECT                      Common 2719                                 47364                                                       
 I                          Local  2757     I(4)            4           scalar                    2757,2758,2759,2792,2793,2794     
 IFA                        Scalar 2725     I(4)            4     2     100      COM                                                
 ILEV                       Local  2759     I(4)            4           scalar                    2759,2760,2766,2767,2768,2804     
 IMAP                       Scalar 2724     I(4)            4     2     65160    COM                                                
 INOB                       Scalar 2724     I(4)            4     1     900000   COM                                                
 IQC                        Local  2879     I(4)            4           scalar                    2879,2881,2887                    
 IREP                       Local  2760     I(4)            4           scalar                    2760,2765,2818                    
 ITER                       Scalar 2727     I(4)            4           scalar   COM                                                
 ITUNIT                     Scalar 2728     I(4)            4           scalar   COM              2882                              
 J                          Local  2782     I(4)            4           scalar                    2782,2787,2788,2796,2797,2801,2802
                                                                                                  ,2803,2804,2805,2806,2807,2843,284
                                                                                                  4,2845,2846,2847,2848,2849,2850,28
                                                                                                  52,2853,2862,2864,2865,2867,2868,2
                                                                                                  869,2870,2886,2888,2889,2892      
 K                          Local  2771     I(4)            4           scalar                    2771,2773,2776,2777,2782,2787,2788
                                                                                                  ,2796,2797,2801,2802,2803,2804,280
                                                                                                  5,2806,2807,2831,2832,2843,2844,28
                                                                                                  45,2846,2853,2862,2864,2865,2875,2
                                                                                                  882,2886,2888,2892                
 KIQC                       Local  2887     I(4)            4           scalar                    2887,2890,2892                    
 KP                         Local  2856     I(4)            4           scalar                    2856,2857,2858                    
 KX                         Local  2817     I(4)            4           scalar                    2817,2882                         
 L                          Local  2791     I(4)            4           scalar                    2791,2792,2794                    
 LAST                       Local  2744     L(4)            4           scalar                    2758,2808,2900                    
 LEV                        Local  2735     I(4)            4     2     100                       2804,2892                         
 LLEV                       Local  2750     I(4)            4           scalar                    2750,2751                         
 LOG                        Func   2853                                 scalar                    2853                              
 LREP                       Local  2751     I(4)            4           scalar                    2751,2765,2814,2815,2816,2817,2818
 MAX                        Func   2795                                 scalar                    2795,2826,2844,2850,2870,2878,2889
 MAXLEV                     Param  2706     I(4)            4           scalar                    2711,2712,2713,2714,2715          
 MAXNSEG                    Local  2745     I(4)            4           scalar                    2745,2777                         
 MAXREP                     Param  2705     I(4)            4           scalar                    2708,2709,2710,2711,2715,2724     
 MCHK                       Scalar 2719     I(4)            4     2     128      COM              2750,2759                         
 MDIM                       Scalar 2720     I(4)            4     2     256      COM                                                
 MOBS                       Scalar 2719     I(4)            4     4     5120     COM                                                
 NLEV                       Scalar 2724     I(4)            4           scalar   COM                                                
 NREP                       Scalar 2724     I(4)            4           scalar   COM                                                
 NSEG                       Local  2739     I(4)            4     1     2                         2752,2776,2777,2782,2832,2843,2875
                                                                                                  ,2886,2901                        
 NXXYY                      Scalar 2719     I(4)            4           scalar   COM              2757,2758                         
 OBCOR                      Local  2858     R(4)            4           scalar                    2858,2860,2862                    
 OBER                       Local  2767     R(4)            4           scalar                    2767,2806                         

Page 109         Source Listing                  SATPUT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 OBS                        Common 2724                                 11060648                                                    
 OIQCDATA                   Common 2708                                 22790000                                                    
                                                                        0                                                           
 OMA                        Local  2734     R(4)            4     2     100                       2788,2797,2802,2845,2865          
 OMA1                       Local  2731     R(4)            4     1     50                        2837,2847                         
 OMA2                       Local  2731     R(4)            4     1     50                        2838,2867                         
 OMF                        Local  2768     R(4)            4           scalar                    2768,2797                         
 OSD                        Local  2736     R(4)            4     2     100                       2806,2844,2846,2862               
 PI180                      Local  2745     R(4)            4           scalar                    2745,2823                         
 PL                         Local  2854     R(4)            4           scalar                    2854,2855,2856,2857               
 PRES                       Local  2766     R(4)            4           scalar                    2766,2770,2772,2807               
 PRS                        Local  2738     R(4)            4     2     100                       2807,2853,2888                    
 QC                         Local  2878     R(4)            4           scalar                    2878,2879,2882,2889,2890          
 QC1                        Local  2833     R(4)            4           scalar                    2833,2850,2878,2882               
 QC2                        Local  2834     R(4)            4           scalar                    2834,2870,2878,2882               
 QCS                        Local  2731     R(4)            4     1     50                        2836,2869,2870,2889               
 QCT                        Local  2731     R(4)            4     1     50                        2835,2849,2850,2889               
 RAF                        Local  2733     R(4)            4     2     100                       2803                              
 RPLN                       Local  2853     R(4)            4           scalar                    2853,2854,2863                    
 SATCOR                     Common 2726                                 80                                                          
 SATPUT                     Subr   2703                                                                                             
 SEG                        Local  2730     CHAR            8     1     2                         2742,2882                         
 SID                        Scalar 2724     R(8)            8     1     900000   COM              2814                              
 SIGN                       Func   2879                                 scalar                    2879,2890                         
 SIN                        Func   2823                                 scalar                    2823                              
 SINLAT                     Local  2823     R(4)            4           scalar                    2823,2824                         
 SQRT                       Func   2801                                 scalar                    2801,2849,2869,2875               
 STAB                       Local  2865     R(4)            4           scalar                    2865,2867,2869                    
 STAID                      Local  2740     R(8)            8           scalar                    2814,2882                         
 SWT                        Local  2789     R(4)            4           scalar                    2789,2798,2801,2802               
 TADJ                       Local  2841     R(4)            4           scalar                    2841,2844,2875,2876               
 TB                         Scalar 2727     R(4)            4           scalar   COM              2824                              
 TJET                       Scalar 2727     R(4)            4           scalar   COM                                                
 TMIN                       Local  2825     R(4)            4           scalar                    2825,2826                         
 TOLLER                     Common 2727                                 24                                                          
 TOSSUNIT                   Common 2728                                 4                                                           
 TSAT                       Scalar 2727     R(4)            4           scalar   COM              2824                              
 TT                         Local  2824     R(4)            4           scalar                    2824,2826,2876                    
 TTT                        Local  2876     R(4)            4           scalar                    2876,2879,2882,2890               
 TWND                       Scalar 2727     R(4)            4           scalar   COM                                                
 TZ                         Scalar 2727     R(4)            4           scalar   COM                                                
 W3TAGE                     Subr   2779                                                           2779                              
 WT                         Local  2795     R(4)            4           scalar                    2795,2796,2797,2798               
 WTS                        Scalar 2721     R(4)            4     4     5120     COM                                                
 XP                         Local  2857     R(4)            4           scalar                    2857,2858                         

Page 110         Source Listing                  SATPUT
2017-04-18 11:07                                 oiqcbufr.f

   4976 C-----------------------------------------------------------------------
   4977 C-----------------------------------------------------------------------
   4978       SUBROUTINE SEARCH
   4979 
   4980       PARAMETER (MAXREP=900000)
   4981       PARAMETER (MAXLEV=1100000)
   4982 
   4983       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   4984      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   4985      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   4986      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   4987      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   4988      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   4989      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   4990      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   4991       CHARACTER*3 FOC
   4992 
   4993       REAL XTW(MAXLEV,10,2),XPF(MAXLEV,5,2)
   4994 
   4995       PARAMETER (MAXLV=255)
   4996       PARAMETER (MTOTH=10 )
   4997       PARAMETER (MTOTV=5  )
   4998 
   4999       common /nddspt/ nd1(0:100),nd2(0:100)
   5000       COMMON /CKLIST/ NDD,INDD(MAXLEV)
   5001       COMMON /OBS/    NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   5002       REAL*8          SID
   5003 
   5004       include "mpif.h"
   5005 
   5006 C-----------------------------------------------------------------------
   5523       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   5524       call mpi_comm_size(MPI_COMM_WORLD,nprc,ierr)
   5525 C-----------------------------------------------------------------------
   5526 
   5527 !  -------------------------------------------------------
   5528 !  divide the obs to check into equal parts for the solver
   5529 !  -------------------------------------------------------
   5530 
   5531       npart=ndd/nprc
   5532       do i=0,nprc-1
   5533       n1=(i*npart)+1
   5534       n2=n1+npart-1
   5535       if(i==nprc-1) n2=ndd
   5536       nd1(i)=n1;nd2(i)=n2
   5537       enddo
   5538 
   5539 C  ------------------------------------------------------------
   5540 C  farm out iterations of the search loop to processors in turn
   5541 C  ------------------------------------------------------------
   5542 
   5543       ftw = 0
   5544       fpf = 0
   5545 
   5546       np1=fhd(indd(1))
   5547       np2=fhd(indd(ndd))
   5548 

Page 111         Source Listing                  SEARCH
2017-04-18 11:07                                 oiqcbufr.f

   5549       DO N=np1,np2
   5550       IF(MOD(N,NPRC)/=MYID) CYCLE
   5551       IF(FQL(N)>0) CALL SEARCHS(n)
   5552       ENDDO
   5553 
   5554 c  -------------------------------------------------------------
   5555 c  each process puts its result in a section of the global array
   5556 c  -------------------------------------------------------------
   5557 c  this code combines (reduces) all sections to one for all
   5558 c  --------------------------------------------------------
   5559 
   5560 
   5561       nftw=maxlev*10*2;nfpf=maxlev*5*2;mcomm=mpi_comm_world
   5562       call mpi_allreduce(ftw,xtw,nftw,mpi_real,mpi_sum,mcomm,ier1)
   5563       call mpi_allreduce(fpf,xpf,nfpf,mpi_real,mpi_sum,mcomm,ier2)
   5564       ftw=xtw; fpf=xpf ! copy the reduction back where it belongs
   5565 
   5566       RETURN
   5567       END


ENTRY POINTS

  Name               
                     
 search_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CKLIST                     Common 2936                                 4400004                                                     
 FFE                        Scalar 2925     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 2922     R(4)            4     1     1100000  COM              2966,2967                         
 FKX                        Scalar 2920     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 2920     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 2919     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 2919     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 2921     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 2921     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 2921     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 2924     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 2926     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 2925     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 2924     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 2926     R(4)            4     3     11000000 COM              2964,2983,2984                    
 FPFD                       Scalar 2923     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 2923     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 2923     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 2922     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 2922     R(4)            4     1     900000   COM              2971                              
 FQM                        Scalar 2924     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 2920     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 2926     R(4)            4     3     22000000 COM              2963,2982,2984                    
 FTZ                        Scalar 2925     R(4)            4     1     1100000  COM                                                
 I                          Local  2952     I(4)            4           scalar                    2952,2953,2955,2956               

Page 112         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IER1                       Local  2982     I(4)            4           scalar                    2982                              
 IER2                       Local  2983     I(4)            4           scalar                    2983                              
 IERR                       Local  2943     I(4)            4           scalar                    2943,2944                         
 IMAP                       Scalar 2937     I(4)            4     2     65160    COM                                                
 INDD                       Scalar 2936     I(4)            4     1     1100000  COM              2966,2967                         
 INOB                       Scalar 2937     I(4)            4     1     900000   COM                                                
 MAXLEV                     Param  2917     I(4)            4           scalar                    2922,2923,2924,2925,2926,2929,2936
                                                                                                  ,2981                             
 MAXLV                      Param  2931     I(4)            4           scalar                                                      
 MAXREP                     Param  2916     I(4)            4           scalar                    2919,2920,2921,2922,2926,2937     
 MCOMM                      Local  2981     I(4)            4           scalar                    2981,2982,2983                    
 MOD                        Func   2970                                 scalar                    2970                              
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ALLREDUCE              Subr   2982                                                           2982,2983                         
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      

Page 113         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   2943                                                           2943                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   2944                                                           2944                              
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    2943,2944,2981                    
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      

Page 114         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      

Page 115         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      

Page 116         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                    2982,2983                         
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                    2982,2983                         
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      

Page 117         Source Listing                  SEARCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MTOTH                      Param  2932     I(4)            4           scalar                                                      
 MTOTV                      Param  2933     I(4)            4           scalar                                                      
 MYID                       Local  2943     I(4)            4           scalar                    2943,2970                         
 N                          Local  2969     I(4)            4           scalar                    2969,2970,2971                    
 N1                         Local  2953     I(4)            4           scalar                    2953,2954,2956                    
 N2                         Local  2954     I(4)            4           scalar                    2954,2955,2956                    
 ND1                        Scalar 2935     I(4)            4     1     101      COM              2956                              
 ND2                        Scalar 2935     I(4)            4     1     101      COM              2956                              
 NDD                        Scalar 2936     I(4)            4           scalar   COM              2951,2955,2967                    
 NDDSPT                     Common 2935                                 808                                                         
 NFPF                       Local  2981     I(4)            4           scalar                    2981,2983                         
 NFTW                       Local  2981     I(4)            4           scalar                    2981,2982                         
 NLEV                       Scalar 2937     I(4)            4           scalar   COM                                                
 NP1                        Local  2966     I(4)            4           scalar                    2966,2969                         
 NP2                        Local  2967     I(4)            4           scalar                    2967,2969                         
 NPART                      Local  2951     I(4)            4           scalar                    2951,2953,2954                    
 NPRC                       Local  2944     I(4)            4           scalar                    2944,2951,2952,2955,2970          
 NREP                       Scalar 2937     I(4)            4           scalar   COM                                                
 OBS                        Common 2937                                 11060648                                                    
 OIQCDATA                   Common 2919                                 22790000                                                    
                                                                        0                                                           
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 SEARCH                     Subr   2914                                                                                             
 SEARCHS                    Subr   2971                                                           2971                              
 SID                        Scalar 2937     R(8)            8     1     900000   COM                                                
 XPF                        Local  2929     R(4)            4     3     11000000                  2983,2984                         
 XTW                        Local  2929     R(4)            4     3     22000000                  2982,2984                         

Page 118         Source Listing                  SEARCH
2017-04-18 11:07                                 oiqcbufr.f

   5568 C-----------------------------------------------------------------------
   5569 C-----------------------------------------------------------------------
   5570       SUBROUTINE SEARCHS(NPTR)
   5571  
   5572       PARAMETER (MAXREP=900000)
   5573       PARAMETER (MAXLEV=1100000)
   5574 
   5575       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   5576      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   5577      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   5578      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   5579      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   5580      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   5581      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   5582      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   5583       CHARACTER*3 FOC
   5584  
   5585       COMMON /OBS / NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   5586       COMMON /OBHEIR/ QUALOB(300),binqadj
   5587       common /trigs/ llnd(-10:10),rcos(181),prln(0:1100)
   5588  
   5589       PARAMETER(IDMX=8)
   5590       PARAMETER(JDMX=5)
   5591       PARAMETER(KDMX=2)
   5592       PARAMETER(PMAX=.5)
   5593       PARAMETER(MXLV=255)
   5594       PARAMETER(MTOTH=10)
   5595       PARAMETER(MTOTV=5)
   5596  
   5597       CHARACTER*8 SID
   5598       CHARACTER*3 TAG
   5599       DIMENSION   NIND(MAXREP),RLAT(MAXREP),RLON(MAXREP),
   5600      .            RDIS(MAXREP),RDIR(MAXREP),INL(MXLV),INI(MXLV),
   5601      .            PATX(IDMX,JDMX,KDMX,MXLV),
   5602      .            MATX(IDMX,JDMX,KDMX,MXLV),NTOT(KDMX)
   5603       LOGICAL     SAME
   5604 
   5605       DATA PI180  /.0174532/
   5606       DATA RADE   /6371./
   5607       DATA RSCAN  /1000./
   5608       data mmrep/MAXREP/
   5609       SAVE PI180,RADE,MMREP,RSCAN,SAME
   5610  
   5611 C----------------------------------------------------------------------
   5612 C----------------------------------------------------------------------
   5613 
   5614  
   5615 C  COPY SOME DETAILS ABOUT EACH OBSERVATION TO CHECK
   5616 C  -------------------------------------------------
   5617  
   5618       PATX = 9999     
   5619       MATX = 0
   5620  
   5621       RCDR = 1./( 360./FLOAT(IDMX))
   5622       RCDS = 1./(RSCAN/FLOAT(JDMX))
   5623       IPTR = FLV(NPTR)
   5624       JPTR = FLV(NPTR)+FNL(NPTR)-1

Page 119         Source Listing                  SEARCHS
2017-04-18 11:07                                 oiqcbufr.f

   5625       NLVL = FNL(NPTR)
   5626       BLON = FLN(NPTR)
   5627       BLAT = FLT(NPTR)
   5628       BINQ = FQL(NPTR)+binqadj
   5629       NBKX = FKX(NPTR)
   5630       TAG  = FOC(NPTR)
   5631 
   5632 C  MAKE SPECIAL CASE ADJUSTMENTS (RECCOS,SATEMP)
   5633 C  ---------------------------------------------
   5634  
   5635       IF(MOD(NBKX,100).EQ.32) NC = 3
   5636       IF(MOD(NBKX,100).NE.32) NC = 8
   5637       IF(TAG.EQ.'SAT') BINQ = BINQ - 1.
   5638  
   5639 C  ITEMIZE REPORTS IN THE SEACH CYLINDER
   5640 C  -------------------------------------
   5641  
   5642       NPRF = 0
   5643       NOBS = 0
   5644  
   5645       lon = ifix(blon)+1
   5646       lat = ifix(blat)+91.
   5647       lscan = nint(rscan*.01)
   5648 
   5649       do ltd=-lscan,+lscan
   5650       ltt = lat+ltd
   5651       if(ltt.ge.1.and.ltt.le.181) then
   5652          lnd = min(ceiling(llnd(ltd)*rcos(ltt)),180)
   5653          ln1 = lon-lnd
   5654          ln2 = lon+lnd               
   5655          lt1 = ltx(ln1,ltt)
   5656          lt2 = ltx(ln2,ltt)
   5657          DO N=IMAP(ln1,lt1),IMAP(ln2,lt2)
   5658          NN  = INOB(N)
   5659          QLA = FQL(NN)
   5660          IF(QLA.GE.0. .AND. QLA.LE.BINQ .and. nprf+1.le.mmrep) THEN
   5661             NPRF = NPRF+1
   5662             NIND(NPRF) = NN
   5663             RLON(NPRF) = FLN(NN)
   5664             RLAT(NPRF) = FLT(NN)
   5665          ENDIF
   5666          ENDDO
   5667       endif
   5668       enddo
   5669  
   5670 C  COMPUTE DISTANCE AND DIRECTION FROM THE CYLINDER CENTER
   5671 C  ------------------------------------------------------
   5672  
   5673       CALL CHDIST(BLON,BLAT,RLON,RLAT,RDIS,RDIR,NIND,NPRF)
   5674  
   5675 C  LOOP OVER OBSERVATION PROFILES TO BE USED FOR CHECKING
   5676 C  ------------------------------------------------------
   5677  
   5678       DO N=1,NPRF
   5679       SAME = SID(NPTR)(1:NC).EQ.SID(NIND(N))(1:NC)
   5680       IF(RDIS(N).LT.RSCAN.AND..NOT.SAME) THEN
   5681         IDIR = IFIX(RDIR(N)*RCDR)+1

Page 120         Source Listing                  SEARCHS
2017-04-18 11:07                                 oiqcbufr.f

   5682         JDIS = IFIX(RDIS(N)*RCDS)+1
   5683         LTYP = IFIX(FKX(NIND(N))*.01)
   5684         IIND  = FLV(NIND(N))
   5685         JIND  = FLV(NIND(N))+FNL(NIND(N))-1
   5686         DO LIND=IIND,JIND
   5687         IF(FOI(LIND).GT.0) THEN
   5688           DO LPTR=IPTR,JPTR
   5689           plog1 = prln(nint(fpr(lptr)))
   5690           plog2 = prln(nint(fpr(lind)))
   5691           PDIF = ABS(plog1-plog2)             
   5692           LEVL = LPTR-IPTR+1
   5693           
   5694               J = JDIS
   5695               DO WHILE(PDIF.GT.PATX(IDIR,J,LTYP,LEVL).AND.J.LE.JDMX)
   5696               J = J+1
   5697                  if(j.gt.jdmx) exit ! DAK: 3/27/13 - prevents overflow
   5698                                     !      in subscript 2 (J) of array
   5699                                     !      PATX
   5700               ENDDO
   5701               if(j.le.jdmx) then
   5702                  MATX(IDIR,J,LTYP,LEVL) = LIND
   5703                  PATX(IDIR,J,LTYP,LEVL) = PDIF
   5704               endif
   5705          
   5706           ENDDO
   5707         ENDIF
   5708         ENDDO
   5709       ENDIF
   5710       ENDDO
   5711  
   5712 C  STORE THE DATA INDEXES SELECTED FOR THE HORIZONTAL AND VERTICAL CHECKS
   5713 C  ----------------------------------------------------------------------
   5714  
   5715       DO LPTR=IPTR,JPTR
   5716       LEVL = LPTR-IPTR+1
   5717       NTOT = 0
   5718       DO K=1,KDMX
   5719       IF(NTOT(K).LT.MTOTH) THEN
   5720          DO J=1,JDMX
   5721          DO I=1,IDMX
   5722          LIND = MATX(I,J,K,LEVL)
   5723          IF(LIND.GT.0 .AND. NTOT(K).LT.MTOTH) THEN
   5724             NTOT(K) = NTOT(K)+1
   5725             FTW(LPTR,NTOT(K),K) = LIND
   5726          ENDIF
   5727          ENDDO
   5728          ENDDO
   5729       ENDIF
   5730       ENDDO
   5731       IF(TAG.EQ.'UPA') THEN
   5732          IF(LEVL.EQ.1) CALL SRTPRS(IPTR,NLVL,INL,INI)
   5733          DO J=1,MTOTV
   5734          IF(INL(LEVL)-J.GT.0   ) FPF(LPTR,J,1) = INI(INL(LEVL)-J)
   5735          IF(INL(LEVL)+J.LE.NLVL) FPF(LPTR,J,2) = INI(INL(LEVL)+J)
   5736          ENDDO
   5737       ENDIF
   5738       ENDDO

Page 121         Source Listing                  SEARCHS
2017-04-18 11:07                                 oiqcbufr.f

   5739  
   5740 C  END OF INDEPENDENT LOOP ITERATIONS
   5741 C  ----------------------------------
   5742  
   5743 100   CONTINUE
   5744  
   5745       RETURN
   5746       END


ENTRY POINTS

  Name                
                      
 searchs_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  3163                                                                                             
 ABS                        Func   3111                                 scalar                    3111                              
 BINQ                       Local  3048     R(4)            4           scalar                    3048,3057,3080                    
 BINQADJ                    Scalar 3006     R(4)            4           scalar   COM              3048                              
 BLAT                       Local  3047     R(4)            4           scalar                    3047,3066,3093                    
 BLON                       Local  3046     R(4)            4           scalar                    3046,3065,3093                    
 CEILING                    Func   3072                                 scalar                    3072                              
 CHDIST                     Subr   3093                                                           3093                              
 FFE                        Scalar 3001     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 2998     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 2996     R(4)            4     1     900000   COM              3049,3103                         
 FLN                        Scalar 2996     R(4)            4     1     900000   COM              3046,3083                         
 FLOAT                      Func   3041                                 scalar                    3041,3042                         
 FLT                        Scalar 2995     R(4)            4     1     900000   COM              3047,3084                         
 FLV                        Scalar 2995     R(4)            4     1     900000   COM              3043,3044,3104,3105               
 FMS                        Scalar 2997     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 2997     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 2997     R(4)            4     1     900000   COM              3044,3045,3105                    
 FOB                        Scalar 3000     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 3002     CHAR            3     1     900000   COM              3050                              
 FOE                        Scalar 3001     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 3000     R(4)            4     1     1100000  COM              3107                              
 FPF                        Scalar 3002     R(4)            4     3     11000000 COM              3154,3155                         
 FPFD                       Scalar 2999     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 2999     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 2999     R(4)            4     1     1100000  COM              3109,3110                         
 FPRC                       Scalar 2998     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 2998     R(4)            4     1     900000   COM              3048,3079                         
 FQM                        Scalar 3000     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 2996     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 3002     R(4)            4     3     22000000 COM              3145                              
 FTZ                        Scalar 3001     R(4)            4     1     1100000  COM                                                
 I                          Local  3141     I(4)            4           scalar                    3141,3142                         
 IDIR                       Local  3101     I(4)            4           scalar                    3101,3115,3122,3123               
 IDMX                       Param  3009     I(4)            4           scalar                    3021,3022,3041,3141               
 IFIX                       Func   3065                                 scalar                    3065,3066,3101,3102,3103          

Page 122         Source Listing                  SEARCHS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IIND                       Local  3104     I(4)            4           scalar                    3104,3106                         
 IMAP                       Scalar 3005     I(4)            4     2     65160    COM              3077                              
 INI                        Local  3020     I(4)            4     1     255                       3152,3154,3155                    
 INL                        Local  3020     I(4)            4     1     255                       3152,3154,3155                    
 INOB                       Scalar 3005     I(4)            4     1     900000   COM              3078                              
 IPTR                       Local  3043     I(4)            4           scalar                    3043,3108,3112,3135,3136,3152     
 J                          Local  3114     I(4)            4           scalar                    3114,3115,3116,3117,3121,3122,3123
                                                                                                  ,3140,3142,3153,3154,3155         
 JDIS                       Local  3102     I(4)            4           scalar                    3102,3114                         
 JDMX                       Param  3010     I(4)            4           scalar                    3021,3022,3042,3115,3117,3121,3140
 JIND                       Local  3105     I(4)            4           scalar                    3105,3106                         
 JPTR                       Local  3044     I(4)            4           scalar                    3044,3108,3135                    
 K                          Local  3138     I(4)            4           scalar                    3138,3139,3142,3143,3144,3145     
 KDMX                       Param  3011     I(4)            4           scalar                    3021,3022,3138                    
 LAT                        Local  3066     I(4)            4           scalar                    3066,3070                         
 LEVL                       Local  3112     I(4)            4           scalar                    3112,3115,3122,3123,3136,3142,3152
                                                                                                  ,3154,3155                        
 LIND                       Local  3106     I(4)            4           scalar                    3106,3107,3110,3122,3142,3143,3145
 LLND                       Scalar 3007     I(4)            4     1     21       COM              3072                              
 LN1                        Local  3073     I(4)            4           scalar                    3073,3075,3077                    
 LN2                        Local  3074     I(4)            4           scalar                    3074,3076,3077                    
 LND                        Local  3072     I(4)            4           scalar                    3072,3073,3074                    
 LON                        Local  3065     I(4)            4           scalar                    3065,3073,3074                    
 LPTR                       Local  3108     I(4)            4           scalar                    3108,3109,3112,3135,3136,3145,3154
                                                                                                  ,3155                             
 LSCAN                      Local  3067     I(4)            4           scalar                    3067,3069                         
 LT1                        Local  3075     I(4)            4           scalar                    3075,3077                         
 LT2                        Local  3076     I(4)            4           scalar                    3076,3077                         
 LTD                        Local  3069     I(4)            4           scalar                    3069,3070,3072                    
 LTT                        Local  3070     I(4)            4           scalar                    3070,3071,3072,3075,3076          
 LTX                        Func   3075     I(4)            4           scalar                    3075,3076                         
 LTYP                       Local  3103     I(4)            4           scalar                    3103,3115,3122,3123               
 MATX                       Local  3022     I(4)            4     4     20400                     3039,3122,3142                    
 MAXLEV                     Param  2993     I(4)            4           scalar                    2998,2999,3000,3001,3002          
 MAXREP                     Param  2992     I(4)            4           scalar                    2995,2996,2997,2998,3002,3005,3019
                                                                                                  ,3020,3028                        
 MIN                        Func   3072                                 scalar                    3072                              
 MMREP                      Local  3029     I(4)            4           scalar   SAVE             3028,3080                         
 MOD                        Func   3055                                 scalar                    3055,3056                         
 MTOTH                      Param  3014     I(4)            4           scalar                    3139,3143                         
 MTOTV                      Param  3015     I(4)            4           scalar                    3153                              
 MXLV                       Param  3013     I(4)            4           scalar                    3020,3021,3022                    
 N                          Local  3077     I(4)            4           scalar                    3077,3078,3098,3099,3100,3101,3102
                                                                                                  ,3103,3104,3105                   
 NBKX                       Local  3049     I(4)            4           scalar                    3049,3055,3056                    
 NC                         Local  3055     I(4)            4           scalar                    3055,3056,3099                    
 NIND                       Local  3019     I(4)            4     1     900000                    3082,3093,3099,3103,3104,3105     
 NINT                       Func   3067                                 scalar                    3067,3109,3110                    
 NLEV                       Scalar 3005     I(4)            4           scalar   COM                                                
 NLVL                       Local  3045     I(4)            4           scalar                    3045,3152,3155                    
 NN                         Local  3078     I(4)            4           scalar                    3078,3079,3082,3083,3084          
 NOBS                       Local  3063     I(4)            4           scalar                    3063                              
 NPRF                       Local  3062     I(4)            4           scalar                    3062,3080,3081,3082,3083,3084,3093
                                                                                                  ,3098                             
 NPTR                       Dummy  2990     I(4)            4           scalar   ARG,INOUT        3043,3044,3045,3046,3047,3048,3049

Page 123         Source Listing                  SEARCHS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,3050,3099                        
 NREP                       Scalar 3005     I(4)            4           scalar   COM                                                
 NTOT                       Local  3022     I(4)            4     1     2                         3137,3139,3143,3144,3145          
 OBHEIR                     Common 3006                                 1204                                                        
 OBS                        Common 3005                                 11060648                                                    
 OIQCDATA                   Common 2995                                 22790000                                                    
                                                                        0                                                           
 PATX                       Local  3021     R(4)            4     4     20400                     3038,3115,3123                    
 PDIF                       Local  3111     R(4)            4           scalar                    3111,3115,3123                    
 PI180                      Local  3029     R(4)            4           scalar   SAVE             3025                              
 PLOG1                      Local  3109     R(4)            4           scalar                    3109,3111                         
 PLOG2                      Local  3110     R(4)            4           scalar                    3110,3111                         
 PMAX                       Param  3012     R(4)            4           scalar                                                      
 PRLN                       Scalar 3007     R(4)            4     1     1101     COM              3109,3110                         
 QLA                        Local  3079     R(4)            4           scalar                    3079,3080                         
 QUALOB                     Scalar 3006     R(4)            4     1     300      COM                                                
 RADE                       Local  3029     R(4)            4           scalar   SAVE             3026                              
 RCDR                       Local  3041     R(4)            4           scalar                    3041,3101                         
 RCDS                       Local  3042     R(4)            4           scalar                    3042,3102                         
 RCOS                       Scalar 3007     R(4)            4     1     181      COM              3072                              
 RDIR                       Local  3020     R(4)            4     1     900000                    3093,3101                         
 RDIS                       Local  3020     R(4)            4     1     900000                    3093,3100,3102                    
 RLAT                       Local  3019     R(4)            4     1     900000                    3084,3093                         
 RLON                       Local  3019     R(4)            4     1     900000                    3083,3093                         
 RSCAN                      Local  3029     R(4)            4           scalar   SAVE             3027,3042,3067,3100               
 SAME                       Local  3023     L(4)            4           scalar   SAVE             3099,3100                         
 SEARCHS                    Subr   2990                                                                                             
 SID                        Scalar 3005     CHAR            8     1     900000   COM              3099                              
 SRTPRS                     Subr   3152                                                           3152                              
 TAG                        Local  3018     CHAR            3           scalar                    3050,3057,3151                    
 TRIGS                      Common 3007                                 5212                                                        

Page 124         Source Listing                  SEARCHS
2017-04-18 11:07                                 oiqcbufr.f

   5747 C-----------------------------------------------------------------------
   5748 C-----------------------------------------------------------------------
   5749       SUBROUTINE SRTPRS(ILEV,NLV,INL,INI)
   5750 
   5751       PARAMETER (MAXREP=900000)
   5752       PARAMETER (MAXLEV=1100000)
   5753 
   5754       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   5755      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   5756      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   5757      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   5758      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   5759      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   5760      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   5761      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   5762       CHARACTER*3 FOC
   5763 
   5764 
   5765       DIMENSION INL(NLV),INI(NLV),PRS(NLV),SRT(NLV)
   5766 
   5767 C-----------------------------------------------------------------------
   5768 C-----------------------------------------------------------------------
   5769 
   5770       DO L=1,NLV
   5771       ILV = ILEV+L-1
   5772       INI(L) = ILV
   5773       PRS(L) = FPR(ILV)
   5774       SRT(L) = PRS(L)
   5775       ENDDO
   5776 
   5777 C  SORT INDEXES IN DESCENDING ORDER OF PRESSURE
   5778 C  --------------------------------------------
   5779 
   5780       DO I=1  ,NLV
   5781       DO J=I+1,NLV
   5782       IF(SRT(I).LT.SRT(J)) THEN
   5783          STMP   = SRT(I)
   5784          SRT(I) = SRT(J)
   5785          SRT(J) = STMP
   5786          ITMP   = INI(I)
   5787          INI(I) = INI(J)
   5788          INI(J) = ITMP
   5789       ENDIF
   5790       ENDDO
   5791       ENDDO
   5792 
   5793 C  MAKE A SET OF LOOK BACK POINTERS
   5794 C  --------------------------------
   5795 
   5796       DO 10 I=1,NLV
   5797       INL(I) = I
   5798       IF(PRS(I).NE.SRT(I)) THEN
   5799          DO J=1,NLV
   5800          IF(PRS(I).EQ.SRT(J)) THEN
   5801             INL(I) = J
   5802             GOTO 10
   5803          ENDIF

Page 125         Source Listing                  SRTPRS
2017-04-18 11:07                                 oiqcbufr.f

   5804          ENDDO
   5805          PRINT *, 'SRTPRS - SORTED PRESSURE NO FOUND'
   5806          CALL W3TAGE('PREPOBS_OIQCBUFR')
   5807          CALL ERREXIT(99)
   5808       ENDIF
   5809 10    ENDDO
   5810 
   5811       RETURN
   5812       END


ENTRY POINTS

  Name               
                     
 srtprs_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3229                                                           3216,3222                         
 ERREXIT                    Subr   3227                                                           3227                              
 FFE                        Scalar 3180     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 3177     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 3175     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 3175     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 3174     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 3174     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 3176     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 3176     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 3176     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 3179     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 3181     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 3180     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 3179     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 3181     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 3178     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 3178     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 3178     R(4)            4     1     1100000  COM              3193                              
 FPRC                       Scalar 3177     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 3177     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 3179     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 3175     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 3181     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 3180     R(4)            4     1     1100000  COM                                                
 I                          Local  3200     I(4)            4           scalar                    3200,3201,3202,3203,3204,3206,3207
                                                                                                  ,3216,3217,3218,3220,3221         
 ILEV                       Dummy  3169     I(4)            4           scalar   ARG,INOUT        3191                              
 ILV                        Local  3191     I(4)            4           scalar                    3191,3192,3193                    
 INI                        Dummy  3169     I(4)            4     1     0        ARG,INOUT        3192,3206,3207,3208               
 INL                        Dummy  3169     I(4)            4     1     0        ARG,INOUT        3217,3221                         
 ITMP                       Local  3206     I(4)            4           scalar                    3206,3208                         
 J                          Local  3201     I(4)            4           scalar                    3201,3202,3204,3205,3207,3208,3219
                                                                                                  ,3220,3221                        
 L                          Local  3190     I(4)            4           scalar                    3190,3191,3192,3193,3194          

Page 126         Source Listing                  SRTPRS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAXLEV                     Param  3172     I(4)            4           scalar                    3177,3178,3179,3180,3181          
 MAXREP                     Param  3171     I(4)            4           scalar                    3174,3175,3176,3177,3181          
 NLV                        Dummy  3169     I(4)            4           scalar   ARG,INOUT        3185,3190,3200,3201,3216,3219     
 OIQCDATA                   Common 3174                                 22790000                                                    
                                                                        0                                                           
 PRS                        Local  3185     R(4)            4     1     0                         3193,3194,3218,3220               
 SRT                        Local  3185     R(4)            4     1     0                         3194,3202,3203,3204,3205,3218,3220
 SRTPRS                     Subr   3169                                                                                             
 STMP                       Local  3203     R(4)            4           scalar                    3203,3205                         
 W3TAGE                     Subr   3226                                                           3226                              

Page 127         Source Listing                  SRTPRS
2017-04-18 11:07                                 oiqcbufr.f

   5813 C----------------------------------------------------------------------
   5814 C----------------------------------------------------------------------
   5815       SUBROUTINE SELDAT(IND,NXY)
   5816 
   5817       PARAMETER (MAXREP=900000)
   5818       PARAMETER (MAXLEV=1100000)
   5819 
   5820       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   5821      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   5822      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   5823      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   5824      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   5825      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   5826      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   5827      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   5828       CHARACTER*3 FOC
   5829 
   5830 
   5831       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   5832      .                     MDIM(64,4),AA(64,4,2),
   5833      .                     AE(64,4,2),WT(64,10,4,2),
   5834      .                     FE(64,3)
   5835       COMMON      /CKLIST/ NDD,INDD(MAXLEV)
   5836 
   5837       DIMENSION MAXPIC(4),MAXN(4)
   5838       DATA MAXPIC/10,10,5,5/ , MAXN/10,10,1,1/ , NMX/64/
   5839 
   5840 C----------------------------------------------------------------------
   5841 C----------------------------------------------------------------------
   5842 
   5843       MDIM = 0
   5844       M    = 0
   5845 
   5846       DO 50 NPTR=IND,IND+NXY-1
   5847       I  = INDD(NPTR)
   5848       J  = FHD(I)
   5849       KX = FKX(J)/100
   5850 
   5851       DO 45 K=KX,KX
   5852       M = M + 1
   5853       MCHK(M,1) = I
   5854       MCHK(M,2) = K
   5855       FE  (M,1) = FFE(I,1)
   5856       FE  (M,2) = FFE(I,2)
   5857       FE  (M,3) = FE (M,2)
   5858 
   5859 C  PICK DATA FROM T AND W GROUPS
   5860 C  -----------------------------
   5861 
   5862       DO 20 IG=1,2
   5863       NPIC = 0
   5864       DO 15 IP=1,MAXPIC(IG)
   5865       IF(NPIC.EQ.MAXN(IG)) GOTO 20
   5866       IPIC = FTW(I,IP,IG)
   5867       IF(IPIC.EQ.0) GOTO 20
   5868       IF(FOE(IPIC).GT.0) THEN
   5869          NPIC = NPIC+1

Page 128         Source Listing                  SELDAT
2017-04-18 11:07                                 oiqcbufr.f

   5870          DO 10 IQ=IG,IG*2-1
   5871          MDIM(M,IQ)        = NPIC
   5872          MOBS(M,NPIC,IQ,1) = IPIC
   5873          MOBS(M,NPIC,IQ,2) = IQ
   5874 10       CONTINUE
   5875       ENDIF
   5876 15    CONTINUE
   5877 20    CONTINUE
   5878 
   5879 C  PICK DATA FROM SAME PROFILE
   5880 C  ---------------------------
   5881 
   5882       NPIC = 0
   5883 
   5884       DO 30 IG=1,2
   5885       DO 25 IP=1,5
   5886       IPIC = FPF(I,IP,IG)
   5887       IF(IPIC.EQ.0) GOTO 30
   5888       IF(FOE(IPIC).GT.0) THEN
   5889          DO 24 KK=K,K*2-1
   5890          NPIC             = NPIC+1
   5891          MDIM(M,4)        = NPIC
   5892          MOBS(M,NPIC,4,1) = IPIC
   5893          MOBS(M,NPIC,4,2) = KK
   5894 24       CONTINUE
   5895          GOTO 30
   5896       ENDIF
   5897 25    CONTINUE
   5898 30    CONTINUE
   5899 
   5900 45    CONTINUE
   5901 50    CONTINUE
   5902 
   5903 C  CHECK THE NUMBER OF OBS TO STORE
   5904 C  --------------------------------
   5905 
   5906       IF(M.GT.NMX) THEN
   5907          PRINT *, 'SELDAT - M GT NMX'
   5908          CALL W3TAGE('PREPOBS_OIQCBUFR')
   5909          CALL ERREXIT(99)
   5910       ENDIF
   5911 
   5912 C  STORE THE NUMBER OF OBS TO CHECK
   5913 C  --------------------------------
   5914 
   5915       NXXYY = M
   5916 
   5917       RETURN
   5918       END

Page 129         Source Listing                  SELDAT
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name               
                     
 seldat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3294                                                           3290                              
 15                         Label  3296                                                           3284                              
 20                         Label  3297                                                           3282,3285,3287                    
 24                         Label  3314                                                           3309                              
 25                         Label  3317                                                           3305                              
 30                         Label  3318                                                           3304,3307,3315                    
 45                         Label  3320                                                           3271                              
 50                         Label  3321                                                           3266                              
 AA                         Scalar 3252     R(4)            4     3     512      COM                                                
 AE                         Scalar 3253     R(4)            4     3     512      COM                                                
 CKLIST                     Common 3255                                 4400004                                                     
 ERREXIT                    Subr   3329                                                           3329                              
 FE                         Scalar 3254     R(4)            4     2     192      COM              3275,3276,3277                    
 FFE                        Scalar 3246     R(4)            4     2     2200000  COM              3275,3276                         
 FHD                        Scalar 3243     R(4)            4     1     1100000  COM              3268                              
 FKX                        Scalar 3241     R(4)            4     1     900000   COM              3269                              
 FLN                        Scalar 3241     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 3240     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 3240     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 3242     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 3242     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 3242     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 3245     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 3247     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 3246     R(4)            4     1     1100000  COM              3288,3308                         
 FOI                        Scalar 3245     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 3247     R(4)            4     3     11000000 COM              3306                              
 FPFD                       Scalar 3244     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 3244     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 3244     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 3243     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 3243     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 3245     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 3241     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 3247     R(4)            4     3     22000000 COM              3286                              
 FTZ                        Scalar 3246     R(4)            4     1     1100000  COM                                                
 HVECT                      Common 3251                                 47364                                                       
 I                          Local  3267     I(4)            4           scalar                    3267,3268,3273,3275,3276,3286,3306
 IG                         Local  3282     I(4)            4           scalar                    3282,3284,3285,3286,3290,3304,3306
 IND                        Dummy  3235     I(4)            4           scalar   ARG,INOUT        3266                              
 INDD                       Scalar 3255     I(4)            4     1     1100000  COM              3267                              
 IP                         Local  3284     I(4)            4           scalar                    3284,3286,3305,3306               
 IPIC                       Local  3286     I(4)            4           scalar                    3286,3287,3288,3292,3306,3307,3308
                                                                                                  ,3312                             

Page 130         Source Listing                  SELDAT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IQ                         Local  3290     I(4)            4           scalar                    3290,3291,3292,3293               
 J                          Local  3268     I(4)            4           scalar                    3268,3269                         
 K                          Local  3271     I(4)            4           scalar                    3271,3274,3309                    
 KK                         Local  3309     I(4)            4           scalar                    3309,3313                         
 KX                         Local  3269     I(4)            4           scalar                    3269,3271                         
 M                          Local  3264     I(4)            4           scalar                    3264,3272,3273,3274,3275,3276,3277
                                                                                                  ,3291,3292,3293,3311,3312,3313,332
                                                                                                  6,3335                            
 MAXLEV                     Param  3238     I(4)            4           scalar                    3243,3244,3245,3246,3247,3255     
 MAXN                       Local  3257     I(4)            4     1     4                         3258,3285                         
 MAXPIC                     Local  3257     I(4)            4     1     4                         3258,3284                         
 MAXREP                     Param  3237     I(4)            4           scalar                    3240,3241,3242,3243,3247          
 MCHK                       Scalar 3251     I(4)            4     2     128      COM              3273,3274                         
 MDIM                       Scalar 3252     I(4)            4     2     256      COM              3263,3291,3311                    
 MOBS                       Scalar 3251     I(4)            4     4     5120     COM              3292,3293,3312,3313               
 NDD                        Scalar 3255     I(4)            4           scalar   COM                                                
 NMX                        Local  3258     I(4)            4           scalar                    3258,3326                         
 NPIC                       Local  3283     I(4)            4           scalar                    3283,3285,3289,3291,3292,3293,3302
                                                                                                  ,3310,3311,3312,3313              
 NPTR                       Local  3266     I(4)            4           scalar                    3266,3267                         
 NXXYY                      Scalar 3251     I(4)            4           scalar   COM              3335                              
 NXY                        Dummy  3235     I(4)            4           scalar   ARG,INOUT        3266                              
 OIQCDATA                   Common 3240                                 22790000                                                    
                                                                        0                                                           
 SELDAT                     Subr   3235                                                                                             
 W3TAGE                     Subr   3328                                                           3328                              
 WT                         Scalar 3253     R(4)            4     4     5120     COM                                                

Page 131         Source Listing                  SELDAT
2017-04-18 11:07                                 oiqcbufr.f

   5919 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
   5920 C
   5921 C SUBPROGRAM:    SETCON
   5922 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1992-07-29
   5923 C
   5924 C ABSTRACT: INITIALIZES CONSTANTS AND PARAMETERS USING DATA STATEMENTS.
   5925 C   ALSO READS A FILE OF OBSERVATION ERRORS FROM UNIT 15.
   5926 C
   5927 C PROGRAM HISTORY LOG:
   5928 C 1986-03-21  G. DIMEGO  - ORIGINAL AUTHOR
   5929 C 1988-11-24  D. DEAVEN  - CODED FOR CYBER 205
   5930 C 1992-07-29  J. WOOLLEN - UPDATED VERSION FOR OIQC
   5931 C
   5932 C USAGE:    CALL SETCON
   5933 C   INPUT FILES:
   5934 C     UNIT 18  - LIST OF IPOINTS FOR DETAILED PRINT IN UNITS 71-80
   5935 C
   5936 C   OUTPUT FILES:
   5937 C     UNIT 06  - STANDARD OUTPUT PRINT
   5938 C
   5939 C ATTRIBUTES:
   5940 C   LANGUAGE: FORTRAN 90
   5941 C   MACHINE:  NCEP WCOSS
   5942 C
   5943 C$$$
   5944       SUBROUTINE SETCON
   5945 
   5946       COMMON /CORP  / CHLP(1500),CVC,FFLAT(91),IFA(10,10)
   5947       COMMON /FCRATS/ RATION(21),RATIOS(21),TROPUV(21)
   5948       COMMON /OBERRS/ QIKE(21,300),PMAND(21),P50(21),CHL(21)
   5949       COMMON /OBHEIR/ QUALOB(300),binqadj
   5950       COMMON /OBPRT / NPT,IDSTA(10),PSTA(10),KXSTA(10)
   5951       common /trigs/  llnd(-10:10),rcos(181),prln(0:1100)
   5952 
   5953 
   5954       CHARACTER*8     IDSTA
   5955 
   5956       DATA PI180  /.0174532 /
   5957 
   5958 C-------------------------------------------------------------------
   5959 C-------------------------------------------------------------------
   5960 
   5961 c  compute trig lookup tables for searching data
   5962 c  ---------------------------------------------
   5963 
   5964       do i=-10,10
   5965       llnd(i) = sqrt(float(100-i*i))
   5966       enddo
   5967 
   5968       do i=1,181
   5969       rcos(i) = abs(1./cos((float(i)-90.01)*pi180))
   5970       enddo
   5971 
   5972       do i=1,1100
   5973       prln(i) = log(float(i))
   5974       enddo 
   5975       prln(0) = prln(1)

Page 132         Source Listing                  SETCON
2017-04-18 11:07                                 oiqcbufr.f

   5976 
   5977 C  STORE A SYMMETRIC MATRIX MAP
   5978 C  ----------------------------
   5979 
   5980       LLL = 1
   5981       DO 10 I = 1,10
   5982       DO 10 J = 1,I
   5983       IFA(I,J) = LLL
   5984       IFA(J,I) = LLL
   5985       LLL = LLL + 1
   5986 10    CONTINUE
   5987 
   5988 C  MAKE A TABLE OF LENGTH SCALES BY MILIBARS
   5989 C  -----------------------------------------
   5990 
   5991       DO 20 I=1,1500
   5992       CHLP(I) = PILNLNP(FLOAT(I),PMAND,CHL,21)
   5993 20    CONTINUE
   5994 
   5995 C  READ IN SOME POINTS TO PRINT
   5996 C  ----------------------------
   5997 
   5998       DO 30 I=1,10
   5999       READ(18,'(A6,I5,I4)',END=35,err=35) IDSTA(I),IP,KXSTA(I)
   6000       PSTA(I) = IP
   6001       PRINT'(A6,I5,I4)',IDSTA(I),IP,KXSTA(I)
   6002 30    CONTINUE
   6003 35    NPT = I-1
   6004 
   6005 C  SET UP SOME DATA PRIORITIES
   6006 C  ---------------------------
   6007 
   6008       binqadj = 0
   6009 
   6010       DO 5 I=1,300
   6011 5     QUALOB(I) = 2.
   6012 
   6013       QUALOB(120) = 1.
   6014       QUALOB(132) = 1.
   6015       QUALOB(220) = 1.
   6016       QUALOB(221) = 1.
   6017       QUALOB(230) = 1.
   6018       QUALOB(231) = 1.
   6019       QUALOB(232) = 1.
   6020       QUALOB(233) = 1.
   6021 
   6022       QUALOB(283) = 3.
   6023 
   6024       QUALOB(161) = 3.
   6025       QUALOB(162) = 4.
   6026       QUALOB(163) = 5.
   6027       QUALOB(166) = 3.
   6028       QUALOB(167) = 4.
   6029       QUALOB(168) = 5.
   6030 
   6031       QUALOB(171) = 3.
   6032       QUALOB(172) = 4.

Page 133         Source Listing                  SETCON
2017-04-18 11:07                                 oiqcbufr.f

   6033       QUALOB(173) = 5.
   6034       QUALOB(176) = 3.
   6035       QUALOB(177) = 4.
   6036       QUALOB(178) = 5.
   6037 
   6038 C  SO LONG FOR NOW
   6039 C  ---------------
   6040 
   6041       RETURN
   6042       END


ENTRY POINTS

  Name               
                     
 setcon_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3406                                                           3401,3402                         
 20                         Label  3413                                                           3411                              
 30                         Label  3422                                                           3418                              
 35                         Label  3423                                                           3419                              
 5                          Label  3431                                                           3430                              
 ABS                        Func   3389                                 scalar                    3389                              
 BINQADJ                    Scalar 3369     R(4)            4           scalar   COM              3428                              
 CHL                        Scalar 3368     R(4)            4     1     21       COM              3412                              
 CHLP                       Scalar 3366     R(4)            4     1     1500     COM              3412                              
 CORP                       Common 3366                                 6768                                                        
 COS                        Func   3389                                 scalar                    3389                              
 CVC                        Scalar 3366     R(4)            4           scalar   COM                                                
 FCRATS                     Common 3367                                 252                                                         
 FFLAT                      Scalar 3366     R(4)            4     1     91       COM                                                
 FLOAT                      Func   3385                                 scalar                    3385,3389,3393,3412               
 I                          Local  3384     I(4)            4           scalar                    3384,3385,3388,3389,3392,3393,3401
                                                                                                  ,3402,3403,3404,3411,3412,3418,341
                                                                                                  9,3420,3421,3423,3430,3431        
 IDSTA                      Scalar 3370     CHAR            8     1     10       COM              3419,3421                         
 IFA                        Scalar 3366     I(4)            4     2     100      COM              3403,3404                         
 IP                         Local  3419     I(4)            4           scalar                    3419,3420,3421                    
 J                          Local  3402     I(4)            4           scalar                    3402,3403,3404                    
 KXSTA                      Scalar 3370     I(4)            4     1     10       COM              3419,3421                         
 LLL                        Local  3400     I(4)            4           scalar                    3400,3403,3404,3405               
 LLND                       Scalar 3371     I(4)            4     1     21       COM              3385                              
 LOG                        Func   3393                                 scalar                    3393                              
 NPT                        Scalar 3370     I(4)            4           scalar   COM              3423                              
 OBERRS                     Common 3368                                 25452                                                       
 OBHEIR                     Common 3369                                 1204                                                        
 OBPRT                      Common 3370                                 164                                                         
 P50                        Scalar 3368     R(4)            4     1     21       COM                                                
 PI180                      Local  3376     R(4)            4           scalar                    3376,3389                         
 PILNLNP                    Func   3412     R(4)            4           scalar                    3412                              
 PMAND                      Scalar 3368     R(4)            4     1     21       COM              3412                              

Page 134         Source Listing                  SETCON
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PRLN                       Scalar 3371     R(4)            4     1     1101     COM              3393,3395                         
 PSTA                       Scalar 3370     R(4)            4     1     10       COM              3420                              
 QIKE                       Scalar 3368     R(4)            4     2     6300     COM                                                
 QUALOB                     Scalar 3369     R(4)            4     1     300      COM              3431,3433,3434,3435,3436,3437,3438
                                                                                                  ,3439,3440,3442,3444,3445,3446,344
                                                                                                  7,3448,3449,3451,3452,3453,3454,34
                                                                                                  55,3456                           
 RATION                     Scalar 3367     R(4)            4     1     21       COM                                                
 RATIOS                     Scalar 3367     R(4)            4     1     21       COM                                                
 RCOS                       Scalar 3371     R(4)            4     1     181      COM              3389                              
 SETCON                     Subr   3364                                                                                             
 SQRT                       Func   3385                                 scalar                    3385                              
 TRIGS                      Common 3371                                 5212                                                        
 TROPUV                     Scalar 3367     R(4)            4     1     21       COM                                                

Page 135         Source Listing                  SETCON
2017-04-18 11:07                                 oiqcbufr.f

   6043 C-----------------------------------------------------------------------
   6044 C-----------------------------------------------------------------------
   6045       BLOCKDATA SETCONS
   6046 
   6047       COMMON /OBERRS/ QIKE(21,300),PMAND(21),P50(21),CHL(21)
   6048       COMMON /CORP  / CHLP(1500),CVC,FFLAT(91),IFA(10,10)
   6049       COMMON /FCRATS/ RATION(21),RATIOS(21),TROPUV(21)
   6050       COMMON /OBPRT / NPT,IDSTA(10),PSTA(10),KXSTA(10)
   6051       COMMON /OBHEIR/ QUALOB(300),binqadj
   6052       COMMON /SATCOR/ EPSCOR(20)
   6053 
   6054       CHARACTER*8     IDSTA
   6055 
   6056       DATA RATION /   .7 ,   .7 ,   .7 ,   .7 ,   .7 ,   .7 ,   .7 ,
   6057      .                .7 ,   .7 ,   .7 ,   .6 ,   .5 ,   .5 ,   .5 ,
   6058      .                .5 ,   .5 ,   .5 ,   .5 ,   .5 ,   .5 ,   .5 /
   6059 
   6060       DATA RATIOS /   .7 ,   .7 ,   .7 ,   .7 ,   .7 ,   .7 ,   .7 ,
   6061      .                .7 ,   .7 ,   .7 ,   .6 ,   .5 ,   .5 ,   .5 ,
   6062      .                .5 ,   .5 ,   .5 ,   .5 ,   .5 ,   .5 ,   .5 /
   6063 
   6064       DATA TROPUV /  4.0 ,  4.0 ,  4.5 ,  6.5 ,  8.0 ,  8.0 ,  9.0 ,
   6065      .              10.0 , 13.0 , 13.0 , 11.0 ,  8.0 ,  8.0 ,  8.0 ,
   6066      .               8.0 ,  8.0 ,  8.0 ,  8.0 ,  8.0 ,  8.0 ,  8.0 /
   6067 
   6068       DATA CHL    / 120. , 100. ,  80. ,  80. ,  80. ,  80. ,  80. ,
   6069      .               80. ,  80. ,  60. ,  60. ,  40. ,  40. ,  40. ,
   6070      .               40. ,  40. ,  40. ,  40. ,  40. ,  40. ,  40. /
   6071 
   6072       DATA FFLAT  / 11*0 , .035 ,  .06 ,  .12 ,  .18 ,  .26 ,  .35 ,
   6073      .               .45 ,  .54 ,  .63 ,  .72 ,  .80 ,  .86 ,  .92 ,
   6074      .               .97 , 66*1 /
   6075 
   6076       DATA PMAND  / 1000 ,  850 ,  700 ,  500 ,  400 ,  300 ,  250 ,
   6077      .               200 ,  150 ,  100 ,   70 ,   50 ,   30 ,   20 ,
   6078      .                10 ,    7 ,    5 ,    3 ,    2 ,    1 ,   .4 /
   6079 
   6080       DATA P50    / 1000 ,  950 ,  900 ,  850 ,  800 ,  750 ,  700 ,
   6081      .               650 ,  600 ,  550 ,  500 ,  450 ,  400 ,  350 ,
   6082      .               300 ,  250 ,  200 ,  150 ,  100 ,   50 ,   .4 /
   6083 
   6084       DATA EPSCOR/ .99, .88,. 61, .36, .18, .05,-.05,-.12,-.15,-.14,
   6085      .            -.11,-.08,-.05,-.03,-.02,-.02,-.01,-.01,  0.,  0./
   6086 
   6087       DATA  CVC   /  5.0 /
   6088 
   6089       END

Page 136         Source Listing                  SETCONS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BINQADJ                    Scalar 3471     R(4)            4           scalar   COM                                                
 CHL                        Scalar 3467     R(4)            4     1     21       COM,SAVE         3488                              
 CHLP                       Scalar 3468     R(4)            4     1     1500     COM                                                
 CORP                       Common 3468                                 6768                                                        
 CVC                        Scalar 3468     R(4)            4           scalar   COM,SAVE         3507                              
 EPSCOR                     Scalar 3472     R(4)            4     1     20       COM,SAVE         3504                              
 FCRATS                     Common 3469                                 252                                                         
 FFLAT                      Scalar 3468     R(4)            4     1     91       COM,SAVE         3492                              
 IDSTA                      Scalar 3470     CHAR            8     1     10       COM                                                
 IFA                        Scalar 3468     I(4)            4     2     100      COM                                                
 KXSTA                      Scalar 3470     I(4)            4     1     10       COM                                                
 NPT                        Scalar 3470     I(4)            4           scalar   COM                                                
 OBERRS                     Common 3467                                 25452                                                       
 OBHEIR                     Common 3471                                 1204                                                        
 OBPRT                      Common 3470                                 164                                                         
 P50                        Scalar 3467     R(4)            4     1     21       COM,SAVE         3500                              
 PMAND                      Scalar 3467     R(4)            4     1     21       COM,SAVE         3496                              
 PSTA                       Scalar 3470     R(4)            4     1     10       COM                                                
 QIKE                       Scalar 3467     R(4)            4     2     6300     COM                                                
 QUALOB                     Scalar 3471     R(4)            4     1     300      COM                                                
 RATION                     Scalar 3469     R(4)            4     1     21       COM,SAVE         3476                              
 RATIOS                     Scalar 3469     R(4)            4     1     21       COM,SAVE         3480                              
 SATCOR                     Common 3472                                 80                                                          
 SETCONS                    Block  3465                                 scalar                                                      
 TROPUV                     Scalar 3469     R(4)            4     1     21       COM,SAVE         3484                              

Page 137         Source Listing                  SETCONS
2017-04-18 11:07                                 oiqcbufr.f

   6090 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6091 C
   6092 C SUBPROGRAM:    SSMIPTS
   6093 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   6094 C
   6095 C ABSTRACT: PUTS TOGETHER PACKAGES OF SSMI OBSERVATION LOCATIONS,
   6096 C   PERFORMS A MULTIVARIATE SURFACE WIND ANALYSIS, AND ASSIGNS ANALYSED
   6097 C   DIRECTION TO THE SSMI WIND SPEED OBSERVATION TO PRODUCE AN SSMI
   6098 C   WIND VECTOR TO BE CHECKED BY OIQC AND PASSED ON THE OBJECTIVE
   6099 C   ANALLYSIS PROGRAM.
   6100 C
   6101 C PROGRAM HISTORY LOG:
   6102 C 1990-11-06  J. WOOLLEN - ORIGNIAL AUTHOR
   6103 C
   6104 C USAGE:    CALL SSMIPTS
   6105 C
   6106 C REMARKS: NONE.
   6107 C
   6108 C ATTRIBUTES:
   6109 C   LANGUAGE: FORTRAN 90
   6110 C   MACHINE:  NCEP WCOSS
   6111 C
   6112 C$$$
   6113       SUBROUTINE SSMIPTS
   6114 
   6115       PARAMETER (MAXLEV=1100000)
   6116 
   6117       common /nddspt/ nd1(0:100),nd2(0:100)
   6118       COMMON /CKLIST/ NDD,INDD(MAXLEV)
   6119       COMMON /OBHEIR/ QUALOB(300),binqadj
   6120       DATA NMX /64/
   6121 
   6122       include "mpif.h"
   6123 
   6124 C-----------------------------------------------------------------------
   6641       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   6642 c     call nddsplit(myid,nd1,nd2)
   6643 C-----------------------------------------------------------------------
   6644 
   6645       binqadj = -1
   6646 
   6647 C  MULTI-PROCESS QC OB LISTS
   6648 C  -------------------------
   6649 
   6650       CALL SEARCH
   6651 
   6652       DO I=nd1(myid),nd2(myid),nmx
   6653       CALL SELDAT(i,min(nmx,nd2(myid)-i+1))
   6654       CALL QCOI
   6655       CALL SSMIPUT
   6656       ENDDO
   6657 
   6658       binqadj = 0
   6659 
   6660       RETURN
   6661       END

Page 138         Source Listing                  SSMIPTS
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                
                      
 ssmipts_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BINQADJ                    Scalar 3539     R(4)            4           scalar   COM              3549,3562                         
 CKLIST                     Common 3538                                 4400004                                                     
 I                          Local  3556     I(4)            4           scalar                    3556,3557                         
 IERR                       Local  3545     I(4)            4           scalar                    3545                              
 INDD                       Scalar 3538     I(4)            4     1     1100000  COM                                                
 MAXLEV                     Param  3535     I(4)            4           scalar                    3538                              
 MIN                        Func   3557                                 scalar                    3557                              
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      

Page 139         Source Listing                  SSMIPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   3545                                                           3545                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    3545                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      

Page 140         Source Listing                  SSMIPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      

Page 141         Source Listing                  SSMIPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      

Page 142         Source Listing                  SSMIPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      

Page 143         Source Listing                  SSMIPTS
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  3545     I(4)            4           scalar                    3545,3556,3557                    
 ND1                        Scalar 3537     I(4)            4     1     101      COM              3556                              
 ND2                        Scalar 3537     I(4)            4     1     101      COM              3556,3557                         
 NDD                        Scalar 3538     I(4)            4           scalar   COM                                                
 NDDSPT                     Common 3537                                 808                                                         
 NMX                        Local  3540     I(4)            4           scalar                    3540,3556,3557                    
 OBHEIR                     Common 3539                                 1204                                                        
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 QCOI                       Subr   3558                                                           3558                              
 QUALOB                     Scalar 3539     R(4)            4     1     300      COM                                                
 SEARCH                     Subr   3554                                                           3554                              
 SELDAT                     Subr   3557                                                           3557                              
 SSMIPTS                    Subr   3533                                                                                             
 SSMIPUT                    Subr   3559                                                           3559                              

Page 144         Source Listing                  SSMIPTS
2017-04-18 11:07                                 oiqcbufr.f

   6662 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6663 C
   6664 C SUBPROGRAM:    SSMIPUT
   6665 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1992-10-06
   6666 C
   6667 C ABSTRACT: USES THE OUTPUT OF A MULTIVARIATE INTERPOLATION OF NEARBY
   6668 C   OBSERVATIONS TO ASSIGN DIRECTIONS TO SSMI WIND SPEED DATA. ALSO
   6669 C   PROVIDES FOR A DETAILED PRINT SHOWING OBSERVATIONS USED IN THE
   6670 C   INTERPOLATION ALONG WITH THE WEIGHTS AND INCREMENTS RESULTING.
   6671 C
   6672 C PROGRAM HISTORY LOG:
   6673 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   6674 C
   6675 C USAGE:    CALL SSMIPUT
   6676 C
   6677 C REMARKS: NONE.
   6678 C
   6679 C ATTRIBUTES:
   6680 C   LANGUAGE: FORTRAN 90
   6681 C   MACHINE:  NCEP WCOSS
   6682 C
   6683 C$$$
   6684       SUBROUTINE SSMIPUT
   6685 
   6686       PARAMETER (MAXREP=900000)
   6687       PARAMETER (MAXLEV=1100000)
   6688 
   6689       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   6690      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   6691      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   6692      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   6693      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   6694      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   6695      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   6696      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   6697       CHARACTER*3 FOC
   6698 
   6699 
   6700       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   6701      .                     MDIM(64,4),AA(64,4,2),
   6702      .                     AE(64,4,2),WT(64,10,4,2),
   6703      .                     FE(64,3)
   6704 
   6705       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   6706       COMMON /OBPRT   / NPT,SIDP(10),PRP(10),KXP(10)
   6707 
   6708       DIMENSION IOMF(3)
   6709       CHARACTER*1 VAR2(2),VAR3(3)
   6710       REAL*8 SID,CKSTA
   6711 
   6712       DATA VAR2 / 'Z' , 'W' /
   6713       DATA VAR3 / 'Z' , 'U' , 'V' /
   6714       DATA IOMF /  2  ,  1  ,  2  /
   6715 
   6716       CHARACTER*1 PLUMIN
   6717       DATA PI180/.017453/
   6718 

Page 145         Source Listing                  SSMIPUT
2017-04-18 11:07                                 oiqcbufr.f

   6719 C----------------------------------------------------------------------
   6720 C----------------------------------------------------------------------
   6721 
   6722 C  LOOP OVER EACH OB CHECKED IN THIS GROUP
   6723 C  ---------------------------------------
   6724 
   6725       DO 50 N=1,NXXYY
   6726       ILEV  = MCHK(N,1)
   6727       IREP  = FHD(ILEV)
   6728       PRES  = FPR(ILEV)
   6729       OBER  = FOE(ILEV)
   6730       CKSTA = SID(IREP)
   6731       CLON  = FLN(IREP)
   6732       CLAT  = FLT(IREP)
   6733       KX    = FKX(IREP)
   6734       GESU  = FMW(IREP,1)
   6735       GESV  = FMW(IREP,2)
   6736 
   6737 C  COMPUTE THE ANALYSED WIND DIRECTION AT THIS OB
   6738 C  ----------------------------------------------
   6739 
   6740       ANAU = GESU + AA(N,1,1)
   6741       ANAV = GESV + AA(N,1,2)
   6742 
   6743       IF(ANAU.GT.0.) THEN
   6744          ANADIR = ATAN(ANAV/ANAU)
   6745       ELSE IF(ANAU.LT.0.) THEN
   6746          ANADIR = ATAN(ANAV/ANAU) + 180.*PI180
   6747       ELSE IF(ANAU.EQ.0.) THEN
   6748          ANADIR = SIGN(90.*PI180,ANAV)
   6749       ENDIF
   6750 
   6751 C  COMBINE THE ANA DIRECTION WITH THE SSMI SPEED
   6752 C  ---------------------------------------------
   6753 
   6754       SSMISPD = ABS(FOB(ILEV,2))
   6755       SSMIU = SSMISPD*COS(ANADIR)
   6756       SSMIV = SSMISPD*SIN(ANADIR)
   6757 
   6758 C  COMPUTE THE OBSERVED INCREMENT AND STORE IN THE PROPER PLACE
   6759 C  ------------------------------------------------------------
   6760 
   6761       FOB(ILEV,1) = SSMIU-GESU
   6762       FOB(ILEV,2) = SSMIV-GESV
   6763 
   6764 50    CONTINUE
   6765 
   6766 100   FORMAT(A6,I4,3F8.2,A4,2F8.2,4(' *',F6.1,' (',F5.2,')' ),
   6767      .       ' *',2F6.2,A6,A1)
   6768 101   FORMAT(A6,I4,3F8.2,A4,2F8.2,4(' *',F6.1,2X,I2),' *',2F6.2,A6,A1)
   6769 102   FORMAT(A6,I4,3F8.2,A4,6F8.2)
   6770 
   6771       RETURN
   6772       END

Page 146         Source Listing                  SSMIPUT
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                
                      
 ssmiput_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  3670                                                                                             
 101                        Label  3672                                                                                             
 102                        Label  3673                                                                                             
 50                         Label  3668                                                           3629                              
 AA                         Scalar 3605     R(4)            4     3     512      COM              3644,3645                         
 ABS                        Func   3658                                 scalar                    3658                              
 AE                         Scalar 3606     R(4)            4     3     512      COM                                                
 ANADIR                     Local  3648     R(4)            4           scalar                    3648,3650,3652,3659,3660          
 ANAU                       Local  3644     R(4)            4           scalar                    3644,3647,3648,3649,3650,3651     
 ANAV                       Local  3645     R(4)            4           scalar                    3645,3648,3650,3652               
 ATAN                       Func   3648                                 scalar                    3648,3650                         
 CKSTA                      Local  3614     R(8)            8           scalar                    3634                              
 CLAT                       Local  3636     R(4)            4           scalar                    3636                              
 CLON                       Local  3635     R(4)            4           scalar                    3635                              
 COS                        Func   3659                                 scalar                    3659                              
 FE                         Scalar 3607     R(4)            4     2     192      COM                                                
 FFE                        Scalar 3599     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 3596     R(4)            4     1     1100000  COM              3631                              
 FKX                        Scalar 3594     R(4)            4     1     900000   COM              3637                              
 FLN                        Scalar 3594     R(4)            4     1     900000   COM              3635                              
 FLT                        Scalar 3593     R(4)            4     1     900000   COM              3636                              
 FLV                        Scalar 3593     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 3595     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 3595     R(4)            4     2     1800000  COM              3638,3639                         
 FNL                        Scalar 3595     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 3598     R(4)            4     2     2200000  COM              3658,3665,3666                    
 FOC                        Scalar 3600     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 3599     R(4)            4     1     1100000  COM              3633                              
 FOI                        Scalar 3598     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 3600     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 3597     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 3597     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 3597     R(4)            4     1     1100000  COM              3632                              
 FPRC                       Scalar 3596     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 3596     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 3598     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 3594     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 3600     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 3599     R(4)            4     1     1100000  COM                                                
 GESU                       Local  3638     R(4)            4           scalar                    3638,3644,3665                    
 GESV                       Local  3639     R(4)            4           scalar                    3639,3645,3666                    
 HVECT                      Common 3604                                 47364                                                       
 ILEV                       Local  3630     I(4)            4           scalar                    3630,3631,3632,3633,3658,3665,3666
 IMAP                       Scalar 3609     I(4)            4     2     65160    COM                                                

Page 147         Source Listing                  SSMIPUT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INOB                       Scalar 3609     I(4)            4     1     900000   COM                                                
 IOMF                       Local  3612     I(4)            4     1     3                         3618                              
 IREP                       Local  3631     I(4)            4           scalar                    3631,3634,3635,3636,3637,3638,3639
 KX                         Local  3637     I(4)            4           scalar                    3637                              
 KXP                        Scalar 3610     I(4)            4     1     10       COM                                                
 MAXLEV                     Param  3591     I(4)            4           scalar                    3596,3597,3598,3599,3600          
 MAXREP                     Param  3590     I(4)            4           scalar                    3593,3594,3595,3596,3600,3609     
 MCHK                       Scalar 3604     I(4)            4     2     128      COM              3630                              
 MDIM                       Scalar 3605     I(4)            4     2     256      COM                                                
 MOBS                       Scalar 3604     I(4)            4     4     5120     COM                                                
 N                          Local  3629     I(4)            4           scalar                    3629,3630,3644,3645               
 NLEV                       Scalar 3609     I(4)            4           scalar   COM                                                
 NPT                        Scalar 3610     I(4)            4           scalar   COM                                                
 NREP                       Scalar 3609     I(4)            4           scalar   COM                                                
 NXXYY                      Scalar 3604     I(4)            4           scalar   COM              3629                              
 OBER                       Local  3633     R(4)            4           scalar                    3633                              
 OBPRT                      Common 3610                                 124                                                         
 OBS                        Common 3609                                 11060648                                                    
 OIQCDATA                   Common 3593                                 22790000                                                    
                                                                        0                                                           
 PI180                      Local  3621     R(4)            4           scalar                    3621,3650,3652                    
 PLUMIN                     Local  3620     CHAR            1           scalar                                                      
 PRES                       Local  3632     R(4)            4           scalar                    3632                              
 PRP                        Scalar 3610     R(4)            4     1     10       COM                                                
 SID                        Scalar 3609     R(8)            8     1     900000   COM              3634                              
 SIDP                       Scalar 3610     R(4)            4     1     10       COM                                                
 SIGN                       Func   3652                                 scalar                    3652                              
 SIN                        Func   3660                                 scalar                    3660                              
 SSMIPUT                    Subr   3588                                                                                             
 SSMISPD                    Local  3658     R(4)            4           scalar                    3658,3659,3660                    
 SSMIU                      Local  3659     R(4)            4           scalar                    3659,3665                         
 SSMIV                      Local  3660     R(4)            4           scalar                    3660,3666                         
 VAR2                       Local  3613     CHAR            1     1     2                         3616                              
 VAR3                       Local  3613     CHAR            1     1     3                         3617                              
 WT                         Scalar 3606     R(4)            4     4     5120     COM                                                

Page 148         Source Listing                  SSMIPUT
2017-04-18 11:07                                 oiqcbufr.f

   6773 C-----------------------------------------------------------------------
   6774 C
   6775 C-----------------------------------------------------------------------
   6776       SUBROUTINE SSMISRCH(IND,NXY)
   6777 
   6778       PARAMETER (MAXREP=900000)
   6779       PARAMETER (MAXLEV=1100000)
   6780 
   6781       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   6782      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   6783      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   6784      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   6785      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   6786      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   6787      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   6788      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   6789       CHARACTER*3 FOC
   6790 
   6791 
   6792       COMMON /CKLIST/ NDD,INDD(MAXLEV)
   6793       COMMON /CORP  / CHLP(1500),CVC,FFLAT(91),IFA(10,10)
   6794       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   6795 
   6796       COMMON /HVECT / NXXYY,MCHK(64,2),MOBS(64,10,4,2),
   6797      .                     MDIM(64,4),AA(64,4,2),
   6798      .                     AE(64,4,2),WT(64,10,4,2),
   6799      .                     FE(64,3)
   6800 
   6801       CHARACTER*3 TAG
   6802 
   6803       DIMENSION   NIND(MAXREP),RLAT(MAXREP),RLON(MAXREP),
   6804      .            DIST(MAXREP),DIRN(MAXREP),
   6805      .            LIND(50000),LTYP(50000),PRES(50000),
   6806      .            ICOR(50000),IDIR(50000),
   6807      .            IPIC(10),CATCOR(101)
   6808 
   6809       LOGICAL   CAT(50000,4,4),NONE(4,4),MORE,GO
   6810 
   6811       REAL*8 SID
   6812 
   6813       DATA CATCOR /21*5.,30*4.,20*3.,20*2.,10*1./
   6814       DATA PI180  /.0174532/, RADE /6371./, RSCAN /1000./
   6815       DATA MAXCYL /50000/
   6816       DATA MTOTH  /10/ , MTOTV /5/
   6817 
   6818 
   6819 C----------------------------------------------------------------------
   6820 C----------------------------------------------------------------------
   6821 
   6822       NXXYY = 0
   6823       MDIM  = 0
   6824 
   6825 C  LOOP OVER PROFILES TO BE CHECKED
   6826 C  --------------------------------
   6827 
   6828       DO 60 NPT=IND,IND+NXY-1
   6829       MPTR = INDD(NPT)

Page 149         Source Listing                  SSMISRCH
2017-04-18 11:07                                 oiqcbufr.f

   6830       NPTR = FHD(MPTR)
   6831       BLON = FLN(NPTR)
   6832       BLAT = FLT(NPTR)
   6833       BINQ = FQL(NPTR)-1
   6834       TAG  = FOC(NPTR)
   6835       IF(TAG.NE.'SMI') THEN
   6836          PRINT *, 'SSMISRCH - SEARCHING NON SSMI DATA'
   6837          CALL W3TAGE('PREPOBS_OIQCBUFR')
   6838          CALL ERREXIT(99)
   6839       ENDIF
   6840 
   6841 C  OUTLINE THE SEARCH AREA
   6842 C  -----------------------
   6843 
   6844       DELLAT = RSCAN/(PI180*RADE)
   6845       COSLAT = COS(BLAT*PI180)
   6846       DELLON = MIN(DELLAT/COSLAT,180.0)
   6847       X1 = BLON-DELLON
   6848       X2 = BLON+DELLON
   6849       Y1 = BLAT-DELLAT
   6850       Y2 = BLAT+DELLAT
   6851       IF(X1.LT.  0.) X1 = X1 + 360.
   6852       IF(X2.GE.360.) X2 = X2 - 360.
   6853       IF(Y1.LT.-90.) Y1 = -90.
   6854       IF(Y2.GT. 90.) Y2 = 90.
   6855 
   6856 C  ITEMIZE REPORTS IN THE SEACH CYLINDER
   6857 C  -------------------------------------
   6858 
   6859       NPRF = 0
   6860       NOBS = 0
   6861 
   6862       I1 = X1 + 1.
   6863       I2 = X2 + 1.
   6864       J1 = Y1 + 91.
   6865       J2 = Y2 + 91.
   6866 
   6867       DO 10 K=1,2
   6868       IA = I1
   6869       IB = I2
   6870       IF(I1.GT.I2) THEN
   6871          IF(K.EQ.1) IB = 360
   6872          IF(K.EQ.2) IA = 1
   6873       ELSE
   6874          IF(K.EQ.2) GOTO 11
   6875       ENDIF
   6876 
   6877       DO 10 J=J1,J2
   6878       DO 10 N=IMAP(IA,J),IMAP(IB,J)
   6879       NN  = INOB(N)
   6880       QLA = FQL(NN)
   6881       IF(QLA.GE.0. .AND. QLA.LE.BINQ) THEN
   6882          NPRF = NPRF+1
   6883          NIND(NPRF) = NN
   6884          RLON(NPRF) = FLN(NN)
   6885          RLAT(NPRF) = FLT(NN)
   6886       ENDIF

Page 150         Source Listing                  SSMISRCH
2017-04-18 11:07                                 oiqcbufr.f

   6887 10    CONTINUE
   6888 
   6889 11    IF(NPRF.GT.MAXREP) THEN
   6890          PRINT *, 'SSMISRCH - NPRF > MAXREP'
   6891          CALL W3TAGE('PREPOBS_OIQCBUFR')
   6892          CALL ERREXIT(99)
   6893       ENDIF
   6894 
   6895 C  COMPUTE DISTANCE AND DIRECTION FROM THE CYLINDER CENTER
   6896 C  -------------------------------------------------------
   6897 
   6898       CALL CHDIST(BLON,BLAT,RLON,RLAT,DIST,DIRN,NIND,NPRF)
   6899 
   6900 C  STORE ALL LEVELS OF EACH REPORT LOCATED IN THE CYLINDER
   6901 C  -------------------------------------------------------
   6902 
   6903       DO 21 N=1,NPRF
   6904       IF(DIST(N).LE.RSCAN .AND. SID(NPTR).NE.SID(NIND(N))) THEN
   6905          ILEV  = FLV(NIND(N))
   6906          KLEV  = ILEV+FNL(NIND(N))-1
   6907          KX    = FKX(NIND(N))
   6908          DO 20 JLEV=ILEV,KLEV
   6909          IF(FOI(JLEV).GT.0) THEN
   6910             NOBS = NOBS+1
   6911             LIND(NOBS) = JLEV
   6912             PRES(NOBS) = LOG(FPR(JLEV))
   6913             DIST(NOBS) = (DIST(N)/RADE)**2
   6914             DIRN(NOBS) = AMOD(DIRN(N)/90.,4.) + 1.01
   6915             LTYP(NOBS) = KX/100
   6916          ENDIF
   6917 20       CONTINUE
   6918 
   6919          IF(NOBS.GT.MAXCYL) THEN
   6920             PRINT *, 'SSMISRCH - NOBS>MAXCYL'
   6921             CALL W3TAGE('PREPOBS_OIQCBUFR')
   6922             CALL ERREXIT(99)
   6923          ENDIF
   6924       ENDIF
   6925 21    CONTINUE
   6926 
   6927 C  LOOP OVER THE OBSERVATION LEVELS TO BE CHECKED
   6928 C  ----------------------------------------------
   6929 
   6930       ILEV = FLV(NPTR)
   6931       KLEV = ILEV+FNL(NPTR)-1
   6932 
   6933       DO 50 IL=ILEV,KLEV
   6934 
   6935       BPRS = FPR(IL)
   6936       IPRS = BPRS
   6937       BPRS = LOG(BPRS)
   6938 
   6939 C  INITIALIZE THE SLECTION ARRAYS
   6940 C  ------------------------------
   6941 
   6942       NXXYY = NXXYY + 1
   6943       MCHK(NXXYY,1) = IL

Page 151         Source Listing                  SSMISRCH
2017-04-18 11:07                                 oiqcbufr.f

   6944       MCHK(NXXYY,2) = 2
   6945       FE  (NXXYY,1) = FFE(IL,1)
   6946       FE  (NXXYY,2) = FFE(IL,2)
   6947       FE  (NXXYY,3) = FFE(IL,2)
   6948 
   6949       IF(NOBS.EQ.0) GOTO 50
   6950 
   6951 C  COMPUTE ZZ HRZ AND VRT CORRELATIONS FOR EACH OB AND CATEGORIZE
   6952 C  --------------------------------------------------------------
   6953 
   6954       DO 24 N=1,NOBS
   6955       CHRZ    = EXP(-CHLP(IPRS)*(DIST(N)))
   6956       CVRT    = 1./(1.+ CVC*(BPRS-PRES(N))**2)
   6957       IC      = CHRZ*CVRT*100.+1.
   6958       ICOR(N) = CATCOR(IC)
   6959       IDIR(N) = DIRN(N)
   6960 24    CONTINUE
   6961 
   6962       DO 25 J=1,4
   6963       DO 25 I=1,4
   6964       DO 25 N=1,NOBS
   6965       CAT(N,I,J) = ICOR(N).EQ.J .AND. IDIR(N).EQ.I
   6966 25    CONTINUE
   6967 
   6968 C  PICK THE CLOSEST 10 (MULTIVARIATE) HORIZONTAL OBSERVATIONS
   6969 C  ----------------------------------------------------------
   6970 
   6971       DO 28 J=1,4
   6972       DO 28 I=1,4
   6973       NONE(I,J) = .FALSE.
   6974 28    CONTINUE
   6975 
   6976       NTOT = 0
   6977       NPIC = 0
   6978 
   6979       DO 35 J=1,4
   6980 30    MORE = .FALSE.
   6981       DO 34 I=1,4
   6982       IF(NPIC.GE.MTOTH) GOTO 36
   6983       IF(NONE(I,J)   ) GOTO 34
   6984       DO 32 N=1,NOBS
   6985       IF(CAT(N,I,J)) THEN
   6986          NTOT = NTOT+1
   6987          IPIC(NTOT) = N
   6988          NPIC = NPIC+LTYP(N)
   6989          CAT(N,I,J) = .FALSE.
   6990          MORE = .TRUE.
   6991          GOTO 34
   6992       ENDIF
   6993 32    CONTINUE
   6994       NONE(I,J) = .TRUE.
   6995 34    CONTINUE
   6996       IF(MORE) GOTO 30
   6997 35    CONTINUE
   6998 36    IF(NPIC.GT.MTOTH) NTOT = NTOT-1
   6999 
   7000 C  STORE THE DATA INDEXES SELECTED FOR HORIZONTAL CHECKS

Page 152         Source Listing                  SSMISRCH
2017-04-18 11:07                                 oiqcbufr.f

   7001 C  -----------------------------------------------------
   7002 
   7003       NPIC = 0
   7004 
   7005       DO 40 N=1,NTOT
   7006       NN = IPIC(N)
   7007       KK = LTYP(NN)
   7008       DO 40 K=KK,KK*2-1
   7009       NPIC = NPIC+1
   7010       MDIM(NXXYY,1) = MDIM(NXXYY,1) + 1
   7011       MOBS(NXXYY,NPIC,1,1) = LIND(NN)
   7012       MOBS(NXXYY,NPIC,1,2) = K
   7013 40    CONTINUE
   7014 
   7015 50    CONTINUE
   7016 
   7017 60    CONTINUE
   7018 
   7019       RETURN
   7020       END


ENTRY POINTS

  Name                 
                       
 ssmisrch_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3791                                                           3771,3781,3782                    
 11                         Label  3793                                                           3778                              
 20                         Label  3821                                                           3812                              
 21                         Label  3829                                                           3807                              
 24                         Label  3864                                                           3858                              
 25                         Label  3870                                                           3866,3867,3868                    
 28                         Label  3878                                                           3875,3876                         
 30                         Label  3884                                                           3900                              
 32                         Label  3897                                                           3888                              
 34                         Label  3899                                                           3885,3887,3895                    
 35                         Label  3901                                                           3883                              
 36                         Label  3902                                                           3886                              
 40                         Label  3917                                                           3909,3912                         
 50                         Label  3919                                                           3837,3853                         
 60                         Label  3921                                                           3732                              
 AA                         Scalar 3701     R(4)            4     3     512      COM                                                
 AE                         Scalar 3702     R(4)            4     3     512      COM                                                
 AMOD                       Func   3818                                 scalar                    3818                              
 BINQ                       Local  3737     R(4)            4           scalar                    3737,3785                         
 BLAT                       Local  3736     R(4)            4           scalar                    3736,3749,3753,3754,3802          
 BLON                       Local  3735     R(4)            4           scalar                    3735,3751,3752,3802               
 BPRS                       Local  3839     R(4)            4           scalar                    3839,3840,3841,3860               
 CAT                        Local  3713     L(4)            4     3     800000                    3869,3889,3893                    
 CATCOR                     Local  3711     R(4)            4     1     101                       3717,3862                         

Page 153         Source Listing                  SSMISRCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHDIST                     Subr   3802                                                           3802                              
 CHLP                       Scalar 3697     R(4)            4     1     1500     COM              3859                              
 CHRZ                       Local  3859     R(4)            4           scalar                    3859,3861                         
 CKLIST                     Common 3696                                 4400004                                                     
 CORP                       Common 3697                                 6768                                                        
 COS                        Func   3749                                 scalar                    3749                              
 COSLAT                     Local  3749     R(4)            4           scalar                    3749,3750                         
 CVC                        Scalar 3697     R(4)            4           scalar   COM              3860                              
 CVRT                       Local  3860     R(4)            4           scalar                    3860,3861                         
 DELLAT                     Local  3748     R(4)            4           scalar                    3748,3750,3753,3754               
 DELLON                     Local  3750     R(4)            4           scalar                    3750,3751,3752                    
 DIRN                       Local  3708     R(4)            4     1     900000                    3802,3818,3863                    
 DIST                       Local  3708     R(4)            4     1     900000                    3802,3808,3817,3859               
 ERREXIT                    Subr   3742                                                           3742,3796,3826                    
 EXP                        Func   3859                                 scalar                    3859                              
 FE                         Scalar 3703     R(4)            4     2     192      COM              3849,3850,3851                    
 FFE                        Scalar 3691     R(4)            4     2     2200000  COM              3849,3850,3851                    
 FFLAT                      Scalar 3697     R(4)            4     1     91       COM                                                
 FHD                        Scalar 3688     R(4)            4     1     1100000  COM              3734                              
 FKX                        Scalar 3686     R(4)            4     1     900000   COM              3811                              
 FLN                        Scalar 3686     R(4)            4     1     900000   COM              3735,3788                         
 FLT                        Scalar 3685     R(4)            4     1     900000   COM              3736,3789                         
 FLV                        Scalar 3685     R(4)            4     1     900000   COM              3809,3834                         
 FMS                        Scalar 3687     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 3687     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 3687     R(4)            4     1     900000   COM              3810,3835                         
 FOB                        Scalar 3690     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 3692     CHAR            3     1     900000   COM              3738                              
 FOE                        Scalar 3691     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 3690     R(4)            4     1     1100000  COM              3813                              
 FPF                        Scalar 3692     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 3689     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 3689     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 3689     R(4)            4     1     1100000  COM              3816,3839                         
 FPRC                       Scalar 3688     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 3688     R(4)            4     1     900000   COM              3737,3784                         
 FQM                        Scalar 3690     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 3686     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 3692     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 3691     R(4)            4     1     1100000  COM                                                
 GO                         Local  3713     L(4)            4           scalar                                                      
 HVECT                      Common 3700                                 47364                                                       
 I                          Local  3867     I(4)            4           scalar                    3867,3869,3876,3877,3885,3887,3889
                                                                                                  ,3893,3898                        
 I1                         Local  3766     I(4)            4           scalar                    3766,3772,3774                    
 I2                         Local  3767     I(4)            4           scalar                    3767,3773,3774                    
 IA                         Local  3772     I(4)            4           scalar                    3772,3776,3782                    
 IB                         Local  3773     I(4)            4           scalar                    3773,3775,3782                    
 IC                         Local  3861     I(4)            4           scalar                    3861,3862                         
 ICOR                       Local  3710     I(4)            4     1     50000                     3862,3869                         
 IDIR                       Local  3710     I(4)            4     1     50000                     3863,3869                         
 IFA                        Scalar 3697     I(4)            4     2     100      COM                                                
 IL                         Local  3837     I(4)            4           scalar                    3837,3839,3847,3849,3850,3851     
 ILEV                       Local  3809     I(4)            4           scalar                    3809,3810,3812,3834,3835,3837     
 IMAP                       Scalar 3698     I(4)            4     2     65160    COM              3782                              

Page 154         Source Listing                  SSMISRCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IND                        Dummy  3680     I(4)            4           scalar   ARG,INOUT        3732                              
 INDD                       Scalar 3696     I(4)            4     1     1100000  COM              3733                              
 INOB                       Scalar 3698     I(4)            4     1     900000   COM              3783                              
 IPIC                       Local  3711     I(4)            4     1     10                        3891,3910                         
 IPRS                       Local  3840     I(4)            4           scalar                    3840,3859                         
 J                          Local  3781     I(4)            4           scalar                    3781,3782,3866,3869,3875,3877,3883
                                                                                                  ,3887,3889,3893,3898              
 J1                         Local  3768     I(4)            4           scalar                    3768,3781                         
 J2                         Local  3769     I(4)            4           scalar                    3769,3781                         
 JLEV                       Local  3812     I(4)            4           scalar                    3812,3813,3815,3816               
 K                          Local  3771     I(4)            4           scalar                    3771,3775,3776,3778,3912,3916     
 KK                         Local  3911     I(4)            4           scalar                    3911,3912                         
 KLEV                       Local  3810     I(4)            4           scalar                    3810,3812,3835,3837               
 KX                         Local  3811     I(4)            4           scalar                    3811,3819                         
 LIND                       Local  3709     I(4)            4     1     50000                     3815,3915                         
 LOG                        Func   3816                                 scalar                    3816,3841                         
 LTYP                       Local  3709     I(4)            4     1     50000                     3819,3892,3911                    
 MAXCYL                     Local  3719     I(4)            4           scalar                    3719,3823                         
 MAXLEV                     Param  3683     I(4)            4           scalar                    3688,3689,3690,3691,3692,3696     
 MAXREP                     Param  3682     I(4)            4           scalar                    3685,3686,3687,3688,3692,3698,3707
                                                                                                  ,3708,3793                        
 MCHK                       Scalar 3700     I(4)            4     2     128      COM              3847,3848                         
 MDIM                       Scalar 3701     I(4)            4     2     256      COM              3727,3914                         
 MIN                        Func   3750                                 scalar                    3750                              
 MOBS                       Scalar 3700     I(4)            4     4     5120     COM              3915,3916                         
 MORE                       Local  3713     L(4)            4           scalar                    3884,3894,3900                    
 MPTR                       Local  3733     I(4)            4           scalar                    3733,3734                         
 MTOTH                      Local  3720     I(4)            4           scalar                    3720,3886,3902                    
 MTOTV                      Local  3720     I(4)            4           scalar                    3720                              
 N                          Local  3782     I(4)            4           scalar                    3782,3783,3807,3808,3809,3810,3811
                                                                                                  ,3817,3818,3858,3859,3860,3862,386
                                                                                                  3,3868,3869,3888,3889,3891,3892,38
                                                                                                  93,3909,3910                      
 NDD                        Scalar 3696     I(4)            4           scalar   COM                                                
 NIND                       Local  3707     I(4)            4     1     900000                    3787,3802,3808,3809,3810,3811     
 NLEV                       Scalar 3698     I(4)            4           scalar   COM                                                
 NN                         Local  3783     I(4)            4           scalar                    3783,3784,3787,3788,3789,3910,3911
                                                                                                  ,3915                             
 NOBS                       Local  3764     I(4)            4           scalar                    3764,3814,3815,3816,3817,3818,3819
                                                                                                  ,3823,3853,3858,3868,3888         
 NONE                       Local  3713     L(4)            4     2     16                        3877,3887,3898                    
 NPIC                       Local  3881     I(4)            4           scalar                    3881,3886,3892,3902,3907,3913,3915
                                                                                                  ,3916                             
 NPRF                       Local  3763     I(4)            4           scalar                    3763,3786,3787,3788,3789,3793,3802
                                                                                                  ,3807                             
 NPT                        Local  3732     I(4)            4           scalar                    3732,3733                         
 NPTR                       Local  3734     I(4)            4           scalar                    3734,3735,3736,3737,3738,3808,3834
                                                                                                  ,3835                             
 NREP                       Scalar 3698     I(4)            4           scalar   COM                                                
 NTOT                       Local  3880     I(4)            4           scalar                    3880,3890,3891,3902,3909          
 NXXYY                      Scalar 3700     I(4)            4           scalar   COM              3726,3846,3847,3848,3849,3850,3851
                                                                                                  ,3914,3915,3916                   
 NXY                        Dummy  3680     I(4)            4           scalar   ARG,INOUT        3732                              
 OBS                        Common 3698                                 11060648                                                    
 OIQCDATA                   Common 3685                                 22790000                                                    

Page 155         Source Listing                  SSMISRCH
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                        0                                                           
 PI180                      Local  3718     R(4)            4           scalar                    3718,3748,3749                    
 PRES                       Local  3709     R(4)            4     1     50000                     3816,3860                         
 QLA                        Local  3784     R(4)            4           scalar                    3784,3785                         
 RADE                       Local  3718     R(4)            4           scalar                    3718,3748,3817                    
 RLAT                       Local  3707     R(4)            4     1     900000                    3789,3802                         
 RLON                       Local  3707     R(4)            4     1     900000                    3788,3802                         
 RSCAN                      Local  3718     R(4)            4           scalar                    3718,3748,3808                    
 SID                        Scalar 3698     R(8)            8     1     900000   COM              3808                              
 SSMISRCH                   Subr   3680                                                                                             
 TAG                        Local  3705     CHAR            3           scalar                    3738,3739                         
 W3TAGE                     Subr   3741                                                           3741,3795,3825                    
 WT                         Scalar 3702     R(4)            4     4     5120     COM                                                
 X1                         Local  3751     R(4)            4           scalar                    3751,3755,3766                    
 X2                         Local  3752     R(4)            4           scalar                    3752,3756,3767                    
 Y1                         Local  3753     R(4)            4           scalar                    3753,3757,3768                    
 Y2                         Local  3754     R(4)            4           scalar                    3754,3758,3769                    

Page 156         Source Listing                  SSMISRCH
2017-04-18 11:07                                 oiqcbufr.f

   7021 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7022 C
   7023 C SUBPROGRAM:    STOERR
   7024 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   7025 C
   7026 C ABSTRACT: INTERPOLATES TO AND STORES FORECAST AND OBSERVATION ERRORS
   7027 C   WITH EACH OBSERVATION IN THE DATASET IN COMMON /DUMMY/.  ALSO MAKES
   7028 C   A LIST OF OBS BY 2D LOCATION IN COMMON /TGRID/ IN ORDER TO EXPEDITE
   7029 C   VARIOUS DATA SEARCH PROCEDURES. SOME CHECKING ON THE PLAUSIBILITY
   7030 C   OF OB COORDINATES IS PERFORMED AS WELL.
   7031 C
   7032 C PROGRAM HISTORY LOG:
   7033 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   7034 C
   7035 C USAGE:    CALL STOERR
   7036 C   OUTPUT FILES:
   7037 C     UNIT 06  - STANDARD OUTPUT PRINT
   7038 C
   7039 C REMARKS:
   7040 C   OUTPUT INFORMATION IN COMMON /TGRID/:
   7041 C     NREP       - NUMBER OF REPORT LOCATIONS
   7042 C     XQC        - ARRAY OF REPORT LONGITUDES
   7043 C     YQC        - ARRAY OF REPORT LATITUDES
   7044 C     IQC        - ARRAY OF REPORT INDEXES INTO THE BUFFS ARRAY
   7045 C     TQC        - ARRAY OF REPORT TYPES (HEIGHT OR WIND)
   7046 C     FERR       - ARRAY OF FORECAST ERRORS AT REPORT LOCATIONS
   7047 C
   7048 C
   7049 C ATTRIBUTES:
   7050 C   LANGUAGE: FORTRAN 90
   7051 C   MACHINE:  NCEP WCOSS
   7052 C
   7053 C$$$
   7054       SUBROUTINE STOERR
   7055 
   7056       PARAMETER (MAXREP=900000)
   7057       PARAMETER (MAXLEV=1100000)
   7058 
   7059       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   7060      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   7061      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   7062      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   7063      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   7064      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   7065      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   7066      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   7067       CHARACTER*3 FOC
   7068 
   7069 
   7070       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   7071       COMMON /OBERRS/ QIKE(21,300),PMAND(21),P50(21),CHL(21)
   7072       COMMON /CORP  / CHLP(1500),CVC,FFLAT(91),IFA(10,10)
   7073       COMMON /GETOE / USEOE
   7074 
   7075       CHARACTER*3  CLASS
   7076       LOGICAL      USEOE
   7077       REAL*8       SID,STID

Page 157         Source Listing                  STOERR
2017-04-18 11:07                                 oiqcbufr.f

   7078 
   7079       DATA XMSG/32700./
   7080 
   7081       include "mpif.h"
   7082 
   7083 C----------------------------------------------------------------------
   7600       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   7601 C-----------------------------------------------------------------------
   7602 
   7603 C  GO THROUGH ALL THE STORED DATA
   7604 C  ------------------------------
   7605 
   7606       DO 30 IREP=1,NREP
   7607 
   7608       ILEV  = FLV(IREP)
   7609       CLASS = FOC(IREP)
   7610       STID  = SID(IREP)
   7611       DDLAT = FLT(IREP)
   7612       DDLON = FLN(IREP)
   7613       KLEV  = FNL(IREP)
   7614       KX    = FKX(IREP)
   7615       KKX   = KX/100
   7616 
   7617       IF(KLEV.EQ.0) GOTO 30
   7618 
   7619 C  CHECK FOR UNNATURAL INFORMATION IN THE HEADER
   7620 C  ---------------------------------------------
   7621 
   7622       IF(
   7623      .  ( KX.LT.120 .OR. KX.GT.299         ) .OR.
   7624      .  ( KLEV.LE.0                        ) .OR.
   7625      .  ( DDLAT.LT.-90.  .OR. DDLAT.GT.90. ) .OR.
   7626      .  ( DDLON.LT.-180. .OR. DDLON.GT.360.)
   7627      .                                     ) THEN
   7628          PRINT*,'FROM STOERR---SKIP THIS MESS---FROM STOERR'
   7629          PRINT'(''STATION= '',A8)',STID
   7630          PRINT*,'LAT    = ',DDLAT
   7631          PRINT*,'LON    = ',DDLON
   7632          PRINT*,'KX     = ',KX
   7633          PRINT*,'NLEVS  = ',KLEV
   7634          PRINT*,'FROM STOERR---SKIP THIS MESS---FROM STOERR'
   7635          GOTO 30
   7636       ENDIF
   7637 
   7638 C  LOOP THRU THE REPORT LEVELS
   7639 C  ---------------------------
   7640 
   7641       DO 20 KL=1,KLEV
   7642       L = ILEV+KL-1
   7643 
   7644 C  CHECK TO SEE IF A SURFACE OBSERVATION IS PRESENT
   7645 C  ------------------------------------------------
   7646 
   7647       IF(FOE(L).EQ.0.) THEN
   7648          GOTO 20
   7649       ENDIF
   7650 

Page 158         Source Listing                  STOERR
2017-04-18 11:07                                 oiqcbufr.f

   7651 C  GET FORECAST ERRORS FOR THIS REPORT
   7652 C  -----------------------------------
   7653 
   7654       DELP  = FPR(L)*.053
   7655       DDPRS = FPR(L)
   7656       DDPRA = DDPRS - DELP
   7657       DDPRB = DDPRS + DELP
   7658 
   7659       ZERA  = GETZER(DDLAT,DDLON,DDPRA)
   7660       ZERB  = GETZER(DDLAT,DDLON,DDPRB)
   7661       WERR  = GETWER(DDLAT,DDLON,DDPRS)
   7662 
   7663 C  FIND THE OB ERROR FOR THIS REPORT
   7664 C  ---------------------------------
   7665 
   7666       IF(KKX.EQ.1) THEN
   7667          OBERA = PILNLNP(DDPRA,PMAND,QIKE(1,KX),21)
   7668          OBERB = PILNLNP(DDPRB,PMAND,QIKE(1,KX),21)
   7669          FPE   = 1./(1.+CVC*LOG(DDPRA/DDPRB)**2)
   7670          OBER  = SQRT(OBERA**2 + OBERB**2 - 2*OBERA*OBERB*FPE)
   7671       ELSE IF(KKX.EQ.2) THEN
   7672          OBER  = PILNLNP(DDPRS,P50,QIKE(1,KX),21)
   7673       ENDIF
   7674 
   7675 C  STORE THE ERRORS IN THEIR RIGHTFUL PLACE
   7676 C  ----------------------------------------
   7677 
   7678       IF(ZERA.EQ.0 .OR. ZERB.EQ.0. .OR. WERR.EQ.0.) THEN
   7679          PRINT *, 'STOERR - FORECAST ERROR IS ZERO'
   7680          CALL W3TAGE('PREPOBS_OIQCBUFR')
   7681          CALL ERREXIT(99)
   7682       ENDIF
   7683 
   7684       FPE  = 1./(1.+CVC*LOG(DDPRA/DDPRB)**2)
   7685       TER  = SQRT(ZERA**2+ZERB**2-2*ZERA*ZERB*FPE)
   7686       WER  = WERR
   7687       FPE1 = 1./(1.+CVC*LOG(DDPRA/DDPRS)**2)
   7688       FPE2 = 1./(1.+CVC*LOG(DDPRB/DDPRS)**2)
   7689       TZF  = MAX((ZERA*FPE1 - ZERB*FPE2),0.) / TER
   7690 
   7691       FFE(L,1) = TER
   7692       FFE(L,2) = WER
   7693       FTZ(L)   = TZF
   7694 
   7695 C  SPECIAL TREATMENT FOR SPECIAL CASES
   7696 C  -----------------------------------
   7697 
   7698       IF(CLASS.EQ.'SFC' .AND. KL.EQ.2) THEN
   7699          FFE(L,1) = (ZERA+ZERB)/2.
   7700          OBER = (OBERA+OBERB)/2.
   7701          FTZ(L) = 1.
   7702       ENDIF
   7703 
   7704       IF(CLASS.NE.'SAT' .AND. DDPRS.GT.700.) THEN
   7705          UPERR = 1.5*DDPRS/700.
   7706          FFE(L,1) = FFE(L,1)*UPERR
   7707       ENDIF

Page 159         Source Listing                  STOERR
2017-04-18 11:07                                 oiqcbufr.f

   7708 
   7709 C  STORE AN OIQC OBSERVATION ERROR MAYBE
   7710 C  -------------------------------------
   7711 
   7712       IF(USEOE) FOE(L) = OBER
   7713 
   7714 C  END OF THE LOOPS
   7715 C  ----------------
   7716 
   7717 20    CONTINUE
   7718 30    CONTINUE
   7719 
   7720       IF(MYID.EQ.0) PRINT*,' IN STORERR - NREP=',NREP
   7721       IF(MYID.EQ.0) PRINT*
   7722 
   7723       RETURN
   7724       END


ENTRY POINTS

  Name               
                     
 stoerr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  4105                                                           4029,4036                         
 30                         Label  4106                                                           3994,4005,4023                    
 CHL                        Scalar 3975     R(4)            4     1     21       COM                                                
 CHLP                       Scalar 3976     R(4)            4     1     1500     COM                                                
 CLASS                      Local  3979     CHAR            3           scalar                    3997,4086,4092                    
 CORP                       Common 3976                                 6768                                                        
 CVC                        Scalar 3976     R(4)            4           scalar   COM              4057,4072,4075,4076               
 DDLAT                      Local  3999     R(4)            4           scalar                    3999,4013,4018,4047,4048,4049     
 DDLON                      Local  4000     R(4)            4           scalar                    4000,4014,4019,4047,4048,4049     
 DDPRA                      Local  4044     R(4)            4           scalar                    4044,4047,4055,4057,4072,4075     
 DDPRB                      Local  4045     R(4)            4           scalar                    4045,4048,4056,4057,4072,4076     
 DDPRS                      Local  4043     R(4)            4           scalar                    4043,4044,4045,4049,4060,4075,4076
                                                                                                  ,4092,4093                        
 DELP                       Local  4042     R(4)            4           scalar                    4042,4044,4045                    
 ERREXIT                    Subr   4069                                                           4069                              
 FFE                        Scalar 3969     R(4)            4     2     2200000  COM              4079,4080,4087,4094               
 FFLAT                      Scalar 3976     R(4)            4     1     91       COM                                                
 FHD                        Scalar 3966     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 3964     R(4)            4     1     900000   COM              4002                              
 FLN                        Scalar 3964     R(4)            4     1     900000   COM              4000                              
 FLT                        Scalar 3963     R(4)            4     1     900000   COM              3999                              
 FLV                        Scalar 3963     R(4)            4     1     900000   COM              3996                              
 FMS                        Scalar 3965     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 3965     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 3965     R(4)            4     1     900000   COM              4001                              
 FOB                        Scalar 3968     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 3970     CHAR            3     1     900000   COM              3997                              

Page 160         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FOE                        Scalar 3969     R(4)            4     1     1100000  COM              4035,4100                         
 FOI                        Scalar 3968     R(4)            4     1     1100000  COM                                                
 FPE                        Local  4057     R(4)            4           scalar                    4057,4058,4072,4073               
 FPE1                       Local  4075     R(4)            4           scalar                    4075,4077                         
 FPE2                       Local  4076     R(4)            4           scalar                    4076,4077                         
 FPF                        Scalar 3970     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 3967     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 3967     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 3967     R(4)            4     1     1100000  COM              4042,4043                         
 FPRC                       Scalar 3966     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 3966     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 3968     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 3964     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 3970     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 3969     R(4)            4     1     1100000  COM              4081,4089                         
 GETOE                      Common 3977                                 4                                                           
 GETWER                     Func   4049     R(4)            4           scalar                    4049                              
 GETZER                     Func   4047     R(4)            4           scalar                    4047,4048                         
 IERR                       Local  3988     I(4)            4           scalar                    3988                              
 IFA                        Scalar 3976     I(4)            4     2     100      COM                                                
 ILEV                       Local  3996     I(4)            4           scalar                    3996,4030                         
 IMAP                       Scalar 3974     I(4)            4     2     65160    COM                                                
 INOB                       Scalar 3974     I(4)            4     1     900000   COM                                                
 IREP                       Local  3994     I(4)            4           scalar                    3994,3996,3997,3998,3999,4000,4001
                                                                                                  ,4002                             
 KKX                        Local  4003     I(4)            4           scalar                    4003,4054,4059                    
 KL                         Local  4029     I(4)            4           scalar                    4029,4030,4086                    
 KLEV                       Local  4001     I(4)            4           scalar                    4001,4005,4012,4021,4029          
 KX                         Local  4002     I(4)            4           scalar                    4002,4003,4011,4020,4055,4056,4060
 L                          Local  4030     I(4)            4           scalar                    4030,4035,4042,4043,4079,4080,4081
                                                                                                  ,4087,4089,4094,4100              
 LOG                        Func   4057                                 scalar                    4057,4072,4075,4076               
 MAX                        Func   4077                                 scalar                    4077                              
 MAXLEV                     Param  3961     I(4)            4           scalar                    3966,3967,3968,3969,3970          
 MAXREP                     Param  3960     I(4)            4           scalar                    3963,3964,3965,3966,3970,3974     
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      

Page 161         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   3988                                                           3988                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    3988                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               

Page 162         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      

Page 163         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      

Page 164         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      

Page 165         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  3988     I(4)            4           scalar                    3988,4108,4109                    
 NLEV                       Scalar 3974     I(4)            4           scalar   COM                                                
 NREP                       Scalar 3974     I(4)            4           scalar   COM              3994,4108                         
 OBER                       Local  4058     R(4)            4           scalar                    4058,4060,4088,4100               
 OBERA                      Local  4055     R(4)            4           scalar                    4055,4058,4088                    
 OBERB                      Local  4056     R(4)            4           scalar                    4056,4058,4088                    
 OBERRS                     Common 3975                                 25452                                                       
 OBS                        Common 3974                                 11060648                                                    
 OIQCDATA                   Common 3963                                 22790000                                                    
                                                                        0                                                           
 P50                        Scalar 3975     R(4)            4     1     21       COM              4060                              
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PILNLNP                    Func   4055     R(4)            4           scalar                    4055,4056,4060                    
 PMAND                      Scalar 3975     R(4)            4     1     21       COM              4055,4056                         
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      

Page 166         Source Listing                  STOERR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 QIKE                       Scalar 3975     R(4)            4     2     6300     COM              4055,4056,4060                    
 SID                        Scalar 3974     R(8)            8     1     900000   COM              3998                              
 SQRT                       Func   4058                                 scalar                    4058,4073                         
 STID                       Local  3981     R(8)            8           scalar                    3998,4017                         
 STOERR                     Subr   3958                                                                                             
 TER                        Local  4073     R(4)            4           scalar                    4073,4077,4079                    
 TZF                        Local  4077     R(4)            4           scalar                    4077,4081                         
 UPERR                      Local  4093     R(4)            4           scalar                    4093,4094                         
 USEOE                      Scalar 3977     L(4)            4           scalar   COM              4100                              
 W3TAGE                     Subr   4068                                                           4068                              
 WER                        Local  4074     R(4)            4           scalar                    4074,4080                         
 WERR                       Local  4049     R(4)            4           scalar                    4049,4066,4074                    
 XMSG                       Local  3983     R(4)            4           scalar                    3983                              
 ZERA                       Local  4047     R(4)            4           scalar                    4047,4066,4073,4077,4087          
 ZERB                       Local  4048     R(4)            4           scalar                    4048,4066,4073,4077,4087          

Page 167         Source Listing                  STOERR
2017-04-18 11:07                                 oiqcbufr.f

   7725 C$$$  SUBPROGRAM DOCUMENTATION  BLOCK
   7726 C
   7727 C SUBPROGRAM:    STORE
   7728 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1992-07-28
   7729 C
   7730 C ABSTRACT: STORES ALL DATA AND CORRESPONDING INDEX FOR LATER USE IN
   7731 C   DATA COLLECT AND SEARCH ROUTINES.
   7732 C
   7733 C PROGRAM HISTORY LOG:
   7734 C 1986-03-21  G. DIMEGO  - ORIGINAL AUTHOR
   7735 C 1988-11-24  D. DEAVEN  - CODED FOR CYBER 205
   7736 C 1990-11-06  J. WOOLLEN - MODIFIED COMMON /BUFFS/ FOR QCOI
   7737 C 1992-07-28  J. WOOLLEN - MODIFIED FOR STORSTAR VERSION
   7738 C
   7739 C USAGE:    CALL STORE(LUDAT,LUBFI)
   7740 C   INPUT ARGUMENT LIST:
   7741 C     LUDAT    - LOGICAL UNIT FOR NCEP PRODCUTION DATE FILE
   7742 C     LUBFI    - LOGICAL UNIT FOR OBSERVATION (PREPBUFR) PRIOR TO
   7743 C                UPDATED QUALITY MARKS
   7744 C
   7745 C   INPUT FILES:
   7746 C     UNIT LUDAT - NCEP PRODUTION DATE FILE
   7747 C     UNIT LUBFI - OBSERVATION (PREPBUFR) PRIOR TO UPDATED QUALITY
   7748 C                  MARKS
   7749 C
   7750 C   OUTPUT FILES:
   7751 C     UNIT 06    - STANDARD OUTPUT PRINT
   7752 C     UNIT LUDAT - NCEP PRODUTION DATE FILE
   7753 C
   7754 C ATTRIBUTES:
   7755 C   LANGUAGE: FORTRAN 90
   7756 C   MACHINE:  NCEP WCOSS
   7757 C
   7758 C$$$
   7759       SUBROUTINE STORE(LUDAT,LUBFI)
   7760  
   7761       PARAMETER (MAXREP=900000)
   7762       PARAMETER (MAXLEV=1100000)
   7763 
   7764       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   7765      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   7766      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   7767      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   7768      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   7769      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   7770      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   7771      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   7772       CHARACTER*3 FOC
   7773  
   7774  
   7775       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   7776       COMMON /OBHEIR/ QUALOB(300),binqadj
   7777       COMMON /RETCODE/ IRETCODE
   7778  
   7779       CHARACTER*80 SUCCESS(3),WARNING(3)
   7780       CHARACTER*80 HDSTR,OBSTR,FCSTR,OESTR,QMSTR
   7781       CHARACTER*8  SUBSET

Page 168         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   7782       CHARACTER*3  TAG
   7783       DIMENSION    HDR(5),OBS(7,255),FCS(6,255),QMS(5,255),OES(5,255)
   7784       LOGICAL      QX(300),STUCK,PCHK
   7785       REAL*8       HDR,OBS,FCS,QMS,OES,SID
   7786  
   7787       DATA SUCCESS/'**************************************************',
   7788      .             '**************** STORE SUCCESSFUL ****************',
   7789      .             '**************************************************'/
   7790       DATA WARNING/'**************************************************',
   7791      .             '!!  WARNING: NOT ALL OBS CAN BE STORED :WARNING !!',
   7792      .             '**************************************************'/
   7793  
   7794  
   7795       DATA HDSTR /'SID XOB YOB DHR TYP                   '/
   7796       DATA OBSTR /'POB QOB TOB ZOB UOB VOB CAT           '/
   7797       DATA FCSTR /'PFC QFC TFC ZFC UFC VFC               '/
   7798       DATA QMSTR /'PQM QQM TQM ZQM WQM                   '/
   7799       DATA OESTR /'POE QOE TOE ZOE WOE                   '/
   7800  
   7801       DATA VMAX   / 10E10     /
   7802       DATA ROG    / 29.261    /
   7803       DATA QX     / 300*.TRUE./
   7804  
   7805       include "mpif.h"
   7806 
   7807 C----------------------------------------------------------------------
   8324       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   8325 C----------------------------------------------------------------------
   8326  
   8327 C  INITIALIZE
   8328 C  ----------
   8329  
   8330       STUCK   = .FALSE.
   8331       NREP0   = 0
   8332       NLEV0   = 0
   8333       MAXNLEV = 0
   8334  
   8335 C  CHECK THE DATA DATE - PROCEED ANYWAY IF NO NMCDATE FILE TO BE FOUND
   8336 C  -------------------------------------------------------------------
   8337  
   8338       CALL DATEBF(LUBFI,IY,IM,ID,IH,IDATE)
   8339       READ(LUDAT,'(8X,I8)',END=1,ERR=900) JDATE
   8340       IF(IDATE.NE.JDATE) GOTO 901     
   8341 1     IF(IDATE.NE.JDATE) THEN         
   8342          REWIND LUDAT
   8343          WRITE(LUDAT,'(8X,I8)') IDATE
   8344       ENDIF
   8345 
   8346 C  GET READY TO READ BUFR
   8347 C  ----------------------
   8348 
   8349       call ufbmem(lubfi,0,nmsg,iunit)
   8350       call mpisplit(myid,nmsg,m1,m2)
   8351       imsg = m1
   8352  
   8353       if(myid.eq.0) then
   8354          PRINT*

Page 169         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   8355          PRINT*,'******  READING DATA IN STORE  ******'
   8356          PRINT*
   8357       endif
   8358  
   8359 C  LOOP THROUGH THE INPUT MESSAGES - READ THE NEXT SUBSET
   8360 C  ------------------------------------------------------
   8361  
   8362       DO M=M1,M2
   8363       CALL READMM(IMSG,SUBSET,IDATE,IRET)
   8364 10    do while(IREADSB(LUBFI).EQ.0) 
   8365  
   8366       CALL UFBINT(LUBFI,HDR,5,  1,IRET,HDSTR)
   8367       CALL UFBINT(LUBFI,OBS,7,255,KLEV,OBSTR)
   8368       CALL UFBINT(LUBFI,FCS,6,255,KLEV,FCSTR)
   8369       CALL UFBINT(LUBFI,QMS,5,255,KLEV,QMSTR)
   8370       CALL UFBINT(LUBFI,OES,5,255,KLEV,OESTR)
   8371       CALL UFBCNT(LUBFI,IREC,IFLD)
   8372  
   8373 C  DECIDE WHETHER OIQC SHOULD PROCESS - SET A TAG
   8374 C  ----------------------------------------------
   8375  
   8376       KX = HDR(5)
   8377  
   8378       IF(QX(KX)) THEN
   8379          IF(KX.GE.180 .AND. KX.LE.199) THEN
   8380             TAG = 'SFC'
   8381          ELSEIF(KX.GE.160 .AND. KX.LE.179) THEN
   8382             TAG = 'SAT'
   8383          ELSEIF(KX.EQ.283) THEN
   8384             TAG = 'SMI'
   8385          ELSE
   8386             TAG = 'UPA'
   8387          ENDIF
   8388       ELSE
   8389          GOTO 10
   8390       ENDIF
   8391  
   8392 C  STORE THE HEADER
   8393 C  ----------------
   8394  
   8395       NREP0 = NREP0+1
   8396       ILEV = 0
   8397  
   8398       IF(NREP0.LE.MAXREP .AND. .NOT.STUCK) THEN
   8399          NREP = NREP0
   8400          NLEV = NLEV0
   8401          SID(NREP) = HDR(1)
   8402          FLN(NREP) = HDR(2)
   8403          FLT(NREP) = HDR(3)
   8404          FTM(NREP) = HDR(4)
   8405          FKX(NREP) = KX
   8406          FNL(NREP) = ILEV
   8407          FLV(NREP) = NLEV+1
   8408          FOC(NREP) = TAG
   8409          FQL(NREP) = QUALOB(KX)
   8410       ELSE
   8411          STUCK = .TRUE.

Page 170         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   8412       ENDIF
   8413  
   8414 C  STORE THE OB LEVELS
   8415 C  -------------------
   8416  
   8417       DO 20 LEV=1,KLEV
   8418  
   8419       POB = OBS(1,LEV)
   8420       TOB = OBS(3,LEV)
   8421       ZOB = OBS(4,LEV)
   8422       UOB = OBS(5,LEV)
   8423       VOB = OBS(6,LEV)
   8424       CAT = OBS(7,LEV)
   8425  
   8426       PFC = FCS(1,LEV)
   8427       TFC = FCS(3,LEV)
   8428       ZFC = FCS(4,LEV)
   8429       UFC = FCS(5,LEV)
   8430       VFC = FCS(6,LEV)
   8431  
   8432       PQM = QMS(1,LEV)
   8433       TQM = QMS(3,LEV)
   8434       ZQM = QMS(4,LEV)
   8435       WQQ = QMS(5,LEV)
   8436  
   8437       POE = OES(1,LEV)
   8438       TOE = OES(3,LEV)
   8439       ZOE = OES(4,LEV)
   8440       WER = OES(5,LEV)
   8441  
   8442       IF(PQM.GE.8) GOTO 20
   8443       IF(PQM.EQ.8) TQM = MAX(PQM,TQM)
   8444       IF(PQM.EQ.8) ZQM = MAX(PQM,ZQM)
   8445       IF(PQM.EQ.8) WQQ = MAX(PQM,WQQ)
   8446  
   8447       PCHK = TAG.EQ.'SFC'
   8448  
   8449       IQM = 0
   8450       OB1 = 0
   8451       OB2 = 0
   8452       IOI = 0
   8453       OER = 0
   8454  
   8455       IF(TQM.LT.8) THEN
   8456          IQM = TQM
   8457          PRG = .053*POB
   8458          PA  = POB - PRG
   8459          PB  = POB + PRG
   8460          OB1 = TOB-TFC
   8461          OB2 = ROG*OB1*LOG(PB/PA)
   8462          OER = 1
   8463          IOI = 1
   8464       ELSEIF(TQM.EQ.8) THEN
   8465          IOI = -2
   8466       ELSEIF(WQQ.LT.8) THEN
   8467          IQM = WQQ
   8468          OB1 = UOB-UFC

Page 171         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   8469          OB2 = VOB-VFC
   8470          OER = 1
   8471          IOI = 1
   8472       ELSEIF(WQQ.EQ.8) THEN
   8473          IOI = -2
   8474       ELSEIF(.NOT.PCHK) THEN
   8475          GOTO 20
   8476       ENDIF
   8477  
   8478 15    CONTINUE
   8479       ILEV = ILEV+1
   8480       NLEV0 = NLEV0+1
   8481       IF(NLEV0.LE.MAXLEV .AND. .NOT.STUCK) THEN
   8482          NLEV = NLEV0
   8483          IF(TAG.EQ.'SMI') THEN
   8484             FMW(NREP,1) = UFC
   8485             FMW(NREP,2) = VFC
   8486             OB1  = 0.
   8487             OB2  = SQRT(UOB**2+VOB**2)
   8488          ENDIF
   8489          IF(ABS(OB1).GT.3000.) OB1 = 3000.
   8490          IF(ABS(OB2).GT.3000.) OB2 = 3000.
   8491          FNL  (NREP) =   ILEV
   8492          FHD  (NLEV) =   NREP
   8493          FPRC (NLEV) =   IREC
   8494          FPFD (NLEV) =   IFLD
   8495          FPLV (NLEV) =   LEV
   8496          FPR  (NLEV) =   POB
   8497          FOB  (NLEV,1) = OB1
   8498          FOB  (NLEV,2) = OB2
   8499          FQM  (NLEV) =   IQM
   8500          FOE  (NLEV) =   OER
   8501          FOI  (NLEV) =   IOI
   8502       ELSE
   8503          STUCK = .TRUE.
   8504       ENDIF
   8505  
   8506       IF(PCHK) THEN
   8507          PCHK = .FALSE.
   8508          IQM  = MAX(PQM,ZQM)
   8509          IF(IQM.LT.8) THEN
   8510             IOI  = 1
   8511             OB1  = 0
   8512             OB2  = ZOB-ZFC
   8513             OER  = 1
   8514          ELSEIF(IQM.EQ.8) THEN
   8515             IOI = -2
   8516             OB1 = 0
   8517             OB2 = 0
   8518             OER = 0
   8519          ELSE
   8520             IOI = 0
   8521             OB1 = 0
   8522             OB2 = 0
   8523             OER = 0
   8524          ENDIF
   8525          GOTO 15

Page 172         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   8526       ENDIF
   8527  
   8528 20    CONTINUE
   8529  
   8530 C  KEEP TRACK OF MAX LEVELS - GO READ ANOTHER REPORT
   8531 C  -------------------------------------------------
   8532  
   8533       MAXNLEV = MAX(ILEV,MAXNLEV)
   8534       IF(ILEV.EQ.0) THEN
   8535          NREP0 = NREP0-1
   8536          IF(.NOT.STUCK) NREP = NREP-1
   8537       ENDIF
   8538 
   8539       ENDDO     
   8540       ENDDO
   8541  
   8542 c  syncronize the input buffers
   8543 c  ----------------------------
   8544  
   8545       call syncstor(nrep0,nlev0,maxnlev)
   8546  
   8547 C  all procs do the following - set tags 
   8548 C  -------------------------------------
   8549  
   8550       DO I=1,NREP
   8551       KX = FKX(I)
   8552       IF(KX.GE.180 .AND. KX.LE.199) THEN
   8553          TAG = 'SFC'
   8554       ELSEIF(KX.GE.160 .AND. KX.LE.179) THEN
   8555          TAG = 'SAT'
   8556       ELSEIF(KX.EQ.283) THEN
   8557          TAG = 'SMI'
   8558       ELSE
   8559          TAG = 'UPA'
   8560       ENDIF
   8561       FOC(I) = TAG
   8562       ENDDO
   8563  
   8564 C  ALL DONE - RECORD THE OUTCOME
   8565 C  -----------------------------
   8566  
   8567       IF(MYID.EQ.0) THEN
   8568          IF(NREP.EQ.NREP0 .AND. NLEV.EQ.NLEV0) IRETCODE = 0
   8569          IF(NREP.NE.NREP0 .OR . NLEV.NE.NLEV0) IRETCODE = 4
   8570                            WRITE(6,'(A80)')
   8571          IF(IRETCODE.NE.0) WRITE(6,'(A80)') WARNING
   8572          IF(IRETCODE.EQ.0) WRITE(6,'(A80)') SUCCESS
   8573                            WRITE(6,101    ) NMSG
   8574                            WRITE(6,102    ) NREP0,NREP
   8575                            WRITE(6,103    ) NLEV0,NLEV
   8576                            WRITE(6,104    ) MAXNLEV
   8577          IF(IRETCODE.NE.0) WRITE(6,'(A80)') WARNING
   8578          IF(IRETCODE.EQ.0) WRITE(6,'(A80)') SUCCESS
   8579                            WRITE(6,'(A80)')
   8580       ENDIF
   8581  
   8582 101   FORMAT('TOTAL RECORDS: ',I6)

Page 173         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   8583 102   FORMAT('TOTAL REPORTS: ',I6,'  ---  STORED: ',I6)
   8584 103   FORMAT('TOTAL OBS    : ',I6,'  ---  STORED: ',I6)
   8585 104   FORMAT('MAX OBS/PRFLE: ',I6)
   8586 105   CONTINUE
   8587  
   8588       RETURN
   8589 900   PRINT *, 'STORE - BAD OR MISSING NCEP DATE FILE'
   8590       CALL W3TAGE('PREPOBS_OIQCBUFR')
   8591       CALL ERREXIT(99)
   8592 901   PRINT *, 'STORE - BUFR AND NCEP DATES DONT MATCH'
   8593       PRINT902,IDATE,JDATE
   8594       CALL W3TAGE('PREPOBS_OIQCBUFR')
   8595       CALL ERREXIT(99)
   8596 902   FORMAT(' BUFR DATE= ',I10.8,' NCEP DATE= ',I10.8)
   8597       END


ENTRY POINTS

  Name              
                    
 store_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  4213                                                           4211                              
 10                         Label  4236                                                           4261                              
 101                        Label  4454                                                           4445                              
 102                        Label  4455                                                           4446                              
 103                        Label  4456                                                           4447                              
 104                        Label  4457                                                           4448                              
 105                        Label  4458                                                                                             
 15                         Label  4350                                                           4397                              
 20                         Label  4400                                                           4289,4314,4347                    
 900                        Label  4461                                                           4211                              
 901                        Label  4464                                                           4212                              
 902                        Label  4468                                                           4465                              
 ABS                        Func   4361                                 scalar                    4361,4362                         
 BINQADJ                    Scalar 4164     R(4)            4           scalar   COM                                                
 CAT                        Local  4296     R(4)            4           scalar                    4296                              
 DATEBF                     Subr   4210                                                           4210                              
 ERREXIT                    Subr   4463                                                           4463,4467                         
 FCS                        Local  4171     R(8)            8     2     1530                      4240,4298,4299,4300,4301,4302     
 FCSTR                      Local  4168     CHAR            80          scalar                    4185,4240                         
 FFE                        Scalar 4158     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 4155     R(4)            4     1     1100000  COM              4364                              
 FKX                        Scalar 4153     R(4)            4     1     900000   COM              4277,4423                         
 FLN                        Scalar 4153     R(4)            4     1     900000   COM              4274                              
 FLT                        Scalar 4152     R(4)            4     1     900000   COM              4275                              
 FLV                        Scalar 4152     R(4)            4     1     900000   COM              4279                              
 FMS                        Scalar 4154     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 4154     R(4)            4     2     1800000  COM              4356,4357                         
 FNL                        Scalar 4154     R(4)            4     1     900000   COM              4278,4363                         
 FOB                        Scalar 4157     R(4)            4     2     2200000  COM              4369,4370                         

Page 174         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FOC                        Scalar 4159     CHAR            3     1     900000   COM              4280,4433                         
 FOE                        Scalar 4158     R(4)            4     1     1100000  COM              4372                              
 FOI                        Scalar 4157     R(4)            4     1     1100000  COM              4373                              
 FPF                        Scalar 4159     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 4156     R(4)            4     1     1100000  COM              4366                              
 FPLV                       Scalar 4156     R(4)            4     1     1100000  COM              4367                              
 FPR                        Scalar 4156     R(4)            4     1     1100000  COM              4368                              
 FPRC                       Scalar 4155     R(4)            4     1     1100000  COM              4365                              
 FQL                        Scalar 4155     R(4)            4     1     900000   COM              4281                              
 FQM                        Scalar 4157     R(4)            4     1     1100000  COM              4371                              
 FTM                        Scalar 4153     R(4)            4     1     900000   COM              4276                              
 FTW                        Scalar 4159     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 4158     R(4)            4     1     1100000  COM                                                
 HDR                        Local  4171     R(8)            8     1     5                         4238,4248,4273,4274,4275,4276     
 HDSTR                      Local  4168     CHAR            80          scalar                    4183,4238                         
 I                          Local  4422     I(4)            4           scalar                    4422,4423,4433                    
 ID                         Local  4210     I(4)            4           scalar                    4210                              
 IDATE                      Local  4210     I(4)            4           scalar                    4210,4212,4213,4215,4235,4465     
 IERR                       Local  4196     I(4)            4           scalar                    4196                              
 IFLD                       Local  4243     I(4)            4           scalar                    4243,4366                         
 IH                         Local  4210     I(4)            4           scalar                    4210                              
 ILEV                       Local  4268     I(4)            4           scalar                    4268,4278,4351,4363,4405,4406     
 IM                         Local  4210     I(4)            4           scalar                    4210                              
 IMAP                       Scalar 4163     I(4)            4     2     65160    COM                                                
 IMSG                       Local  4223     I(4)            4           scalar                    4223,4235                         
 INOB                       Scalar 4163     I(4)            4     1     900000   COM                                                
 IOI                        Local  4324     I(4)            4           scalar                    4324,4335,4337,4343,4345,4373,4382
                                                                                                  ,4387,4392                        
 IQM                        Local  4321     I(4)            4           scalar                    4321,4328,4339,4371,4380,4381,4386
 IREADSB                    Func   4236     I(4)            4           scalar                    4236                              
 IREC                       Local  4243     I(4)            4           scalar                    4243,4365                         
 IRET                       Local  4235     I(4)            4           scalar                    4235,4238                         
 IRETCODE                   Scalar 4165     I(4)            4           scalar   COM              4440,4441,4443,4444,4449,4450     
 IUNIT                      Local  4221     I(4)            4           scalar                    4221                              
 IY                         Local  4210     I(4)            4           scalar                    4210                              
 JDATE                      Local  4211     I(4)            4           scalar                    4211,4212,4213,4465               
 KLEV                       Local  4239     I(4)            4           scalar                    4239,4240,4241,4242,4289          
 KX                         Local  4248     I(4)            4           scalar                    4248,4250,4251,4253,4255,4277,4281
                                                                                                  ,4423,4424,4426,4428              
 LEV                        Local  4289     I(4)            4           scalar                    4289,4291,4292,4293,4294,4295,4296
                                                                                                  ,4298,4299,4300,4301,4302,4304,430
                                                                                                  5,4306,4307,4309,4310,4311,4312,43
                                                                                                  67                                
 LOG                        Func   4333                                 scalar                    4333                              
 LUBFI                      Dummy  4147     I(4)            4           scalar   ARG,INOUT        4210,4221,4236,4238,4239,4240,4241
                                                                                                  ,4242,4243                        
 LUDAT                      Dummy  4147     I(4)            4           scalar   ARG,INOUT        4211,4214,4215                    
 M                          Local  4234     I(4)            4           scalar                    4234                              
 M1                         Local  4222     I(4)            4           scalar                    4222,4223,4234                    
 M2                         Local  4222     I(4)            4           scalar                    4222,4234                         
 MAX                        Func   4315                                 scalar                    4315,4316,4317,4380,4405          
 MAXLEV                     Param  4150     I(4)            4           scalar                    4155,4156,4157,4158,4159,4353     
 MAXNLEV                    Local  4205     I(4)            4           scalar                    4205,4405,4417,4448               
 MAXREP                     Param  4149     I(4)            4           scalar                    4152,4153,4154,4155,4159,4163,4270
 MPIFCMB1                   Common 506                                  20       SAVE                                               

Page 175         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPISPLIT                   Subr   4222                                                           4222                              
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      

Page 176         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   4196                                                           4196                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    4196                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      

Page 177         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      

Page 178         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      

Page 179         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      

Page 180         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  4196     I(4)            4           scalar                    4196,4222,4225,4439               
 NLEV                       Scalar 4163     I(4)            4           scalar   COM              4272,4279,4354,4364,4365,4366,4367
                                                                                                  ,4368,4369,4370,4371,4372,4373,444
                                                                                                  0,4441,4447                       
 NLEV0                      Local  4204     I(4)            4           scalar                    4204,4272,4352,4353,4354,4417,4440
                                                                                                  ,4441,4447                        
 NMSG                       Local  4221     I(4)            4           scalar                    4221,4222,4445                    
 NREP                       Scalar 4163     I(4)            4           scalar   COM              4271,4273,4274,4275,4276,4277,4278
                                                                                                  ,4279,4280,4281,4356,4357,4363,436
                                                                                                  4,4408,4422,4440,4441,4446        
 NREP0                      Local  4203     I(4)            4           scalar                    4203,4267,4270,4271,4407,4417,4440
                                                                                                  ,4441,4446                        
 OB1                        Local  4322     R(4)            4           scalar                    4322,4332,4333,4340,4358,4361,4369
                                                                                                  ,4383,4388,4393                   
 OB2                        Local  4323     R(4)            4           scalar                    4323,4333,4341,4359,4362,4370,4384
                                                                                                  ,4389,4394                        
 OBHEIR                     Common 4164                                 1204                                                        
 OBS                        Common 4163                                 11060648                                                    
 OBS                        Local  4171     R(8)            8     2     1785                      4239,4291,4292,4293,4294,4295,4296
 OBSTR                      Local  4168     CHAR            80          scalar                    4184,4239                         
 OER                        Local  4325     R(4)            4           scalar                    4325,4334,4342,4372,4385,4390,4395
 OES                        Local  4171     R(8)            8     2     1275                      4242,4309,4310,4311,4312          
 OESTR                      Local  4168     CHAR            80          scalar                    4187,4242                         
 OIQCDATA                   Common 4152                                 22790000                                                    
                                                                        0                                                           
 PA                         Local  4330     R(4)            4           scalar                    4330,4333                         
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PB                         Local  4331     R(4)            4           scalar                    4331,4333                         
 PCHK                       Local  4172     L(4)            4           scalar                    4319,4346,4378,4379               
 PFC                        Local  4298     R(4)            4           scalar                    4298                              
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 POB                        Local  4291     R(4)            4           scalar                    4291,4329,4330,4331,4368          
 POE                        Local  4309     R(4)            4           scalar                    4309                              
 PQM                        Local  4304     R(4)            4           scalar                    4304,4314,4315,4316,4317,4380     
 PRG                        Local  4329     R(4)            4           scalar                    4329,4330,4331                    
 QMS                        Local  4171     R(8)            8     2     1275                      4241,4304,4305,4306,4307          
 QMSTR                      Local  4168     CHAR            80          scalar                    4186,4241                         
 QUALOB                     Scalar 4164     R(4)            4     1     300      COM              4281                              
 QX                         Local  4172     L(4)            4     1     300                       4191,4250                         
 READMM                     Subr   4235                                                           4235                              
 RETCODE                    Common 4165                                 4                                                           
 ROG                        Local  4190     R(4)            4           scalar                    4190,4333                         
 SID                        Scalar 4163     R(8)            8     1     900000   COM              4273                              
 SQRT                       Func   4359                                 scalar                    4359                              
 STORE                      Subr   4147                                                                                             
 STUCK                      Local  4172     L(4)            4           scalar                    4202,4270,4283,4353,4375,4408     
 SUBSET                     Local  4169     CHAR            8           scalar                    4235                              
 SUCCESS                    Local  4167     CHAR            80    1     3                         4175,4444,4450                    
 SYNCSTOR                   Subr   4417                                                           4417                              

Page 181         Source Listing                  STORE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TAG                        Local  4170     CHAR            3           scalar                    4252,4254,4256,4258,4280,4319,4355
                                                                                                  ,4425,4427,4429,4431,4433         
 TFC                        Local  4299     R(4)            4           scalar                    4299,4332                         
 TOB                        Local  4292     R(4)            4           scalar                    4292,4332                         
 TOE                        Local  4310     R(4)            4           scalar                    4310                              
 TQM                        Local  4305     R(4)            4           scalar                    4305,4315,4327,4328,4336          
 UFBCNT                     Subr   4243                                                           4243                              
 UFBINT                     Subr   4238                                                           4238,4239,4240,4241,4242          
 UFBMEM                     Subr   4221                                                           4221                              
 UFC                        Local  4301     R(4)            4           scalar                    4301,4340,4356                    
 UOB                        Local  4294     R(4)            4           scalar                    4294,4340,4359                    
 VFC                        Local  4302     R(4)            4           scalar                    4302,4341,4357                    
 VMAX                       Local  4189     R(4)            4           scalar                    4189                              
 VOB                        Local  4295     R(4)            4           scalar                    4295,4341,4359                    
 W3TAGE                     Subr   4462                                                           4462,4466                         
 WARNING                    Local  4167     CHAR            80    1     3                         4178,4443,4449                    
 WER                        Local  4312     R(4)            4           scalar                    4312                              
 WQQ                        Local  4307     R(4)            4           scalar                    4307,4317,4338,4339,4344          
 ZFC                        Local  4300     R(4)            4           scalar                    4300,4384                         
 ZOB                        Local  4293     R(4)            4           scalar                    4293,4384                         
 ZOE                        Local  4311     R(4)            4           scalar                    4311                              
 ZQM                        Local  4306     R(4)            4           scalar                    4306,4316,4380                    

Page 182         Source Listing                  STORE
2017-04-18 11:07                                 oiqcbufr.f

   8598 C-----------------------------------------------------------------------
   8599 C-----------------------------------------------------------------------
   8600       SUBROUTINE MPISPLIT(MYID,NSPLIT,NS1,NS2)
   8601  
   8602       include "mpif.h"
   8603  
   8604 C-----------------------------------------------------------------------
   9121       call mpi_comm_size(MPI_COMM_WORLD,nprc,ierr)
   9122 C-----------------------------------------------------------------------
   9123  
   9124       npart = nsplit/nprc + min(mod(nsplit,nprc),1)
   9125       ns1 = npart*myid+1
   9126       ns2 = min(npart*(myid+1),nsplit)
   9127       return
   9128       end


ENTRY POINTS

  Name                 
                       
 mpisplit_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IERR                       Local  4477     I(4)            4           scalar                    4477                              
 MIN                        Func   4480                                 scalar                    4480,4482                         
 MOD                        Func   4480                                 scalar                    4480                              
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPISPLIT                   Subr   4472                                                                                             
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                

Page 183         Source Listing                  MPISPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   4477                                                           4477                              
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    4477                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      

Page 184         Source Listing                  MPISPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      

Page 185         Source Listing                  MPISPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      

Page 186         Source Listing                  MPISPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      

Page 187         Source Listing                  MPISPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Dummy  4472     I(4)            4           scalar   ARG,INOUT        4481,4482                         
 NPART                      Local  4480     I(4)            4           scalar                    4480,4481,4482                    
 NPRC                       Local  4477     I(4)            4           scalar                    4477,4480                         
 NS1                        Dummy  4472     I(4)            4           scalar   ARG,INOUT        4481                              
 NS2                        Dummy  4472     I(4)            4           scalar   ARG,INOUT        4482                              
 NSPLIT                     Dummy  4472     I(4)            4           scalar   ARG,INOUT        4480,4482                         
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      

Page 188         Source Listing                  MPISPLIT
2017-04-18 11:07                                 oiqcbufr.f

   9129 C-----------------------------------------------------------------------
   9130 C-----------------------------------------------------------------------
   9131       SUBROUTINE syncstor(nrep0,nlev0,maxnlev)
   9132  
   9133       PARAMETER (MAXREP=900000)
   9134       PARAMETER (MAXLEV=1100000)
   9135 
   9136       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   9137      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   9138      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   9139      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   9140      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   9141      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   9142      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   9143      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   9144       CHARACTER*3 FOC
   9145  
   9146       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   9147       real*8 sid
   9148 
   9149       dimension nreps(5)
   9150 
   9151       data mrep/MAXREP/,mlev/MAXLEV/
   9152  
   9153       include "mpif.h"
   9670       dimension istat(mpi_status_size)
   9671       dimension dummy(MAXLEV)
   9672       real*8 dummy
   9673  
   9674 C-----------------------------------------------------------------------
   9675       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
   9676       call mpi_comm_size(MPI_COMM_WORLD,nprc,ierr)
   9677       mcom = mpi_comm_world
   9678       mrea = mpi_real
   9679       mre8 = mpi_real8
   9680       mint = mpi_integer
   9681       mchr = mpi_character
   9682       mdes = 0
   9683 C-----------------------------------------------------------------------
   9684 
   9685       nreps(1) = nrep
   9686       nreps(2) = nlev
   9687       nreps(3) = nrep0
   9688       nreps(4) = nlev0
   9689       nreps(5) = maxnlev
   9690 
   9691       if(myid.ne.mdes) then
   9692          call mpi_send(nreps,5,mint,mdes,myid,mcom,ierr)
   9693          call mpi_send(sid     ,nrep,mre8,mdes,myid,mcom,ierr)
   9694          call mpi_send(flv     ,nrep,mrea,mdes,myid,mcom,ierr)
   9695          call mpi_send(flt     ,nrep,mrea,mdes,myid,mcom,ierr)
   9696          call mpi_send(fln     ,nrep,mrea,mdes,myid,mcom,ierr)
   9697          call mpi_send(ftm     ,nrep,mrea,mdes,myid,mcom,ierr)
   9698          call mpi_send(fkx     ,nrep,mrea,mdes,myid,mcom,ierr)
   9699          call mpi_send(fnl     ,nrep,mrea,mdes,myid,mcom,ierr)
   9700          call mpi_send(fms     ,nrep,mrea,mdes,myid,mcom,ierr)
   9701          call mpi_send(fmw(1,1),nrep,mrea,mdes,myid,mcom,ierr)

Page 189         Source Listing                  SYNCSTOR
2017-04-18 11:07                                 oiqcbufr.f

   9702          call mpi_send(fmw(1,2),nrep,mrea,mdes,myid,mcom,ierr)
   9703          call mpi_send(fql     ,nrep,mrea,mdes,myid,mcom,ierr)
   9704          call mpi_send(fhd     ,nlev,mrea,mdes,myid,mcom,ierr)
   9705          call mpi_send(fprc    ,nlev,mrea,mdes,myid,mcom,ierr)
   9706          call mpi_send(fpfd    ,nlev,mrea,mdes,myid,mcom,ierr)
   9707          call mpi_send(fplv    ,nlev,mrea,mdes,myid,mcom,ierr)
   9708          call mpi_send(fpr     ,nlev,mrea,mdes,myid,mcom,ierr)
   9709          call mpi_send(fqm     ,nlev,mrea,mdes,myid,mcom,ierr)
   9710          call mpi_send(foi     ,nlev,mrea,mdes,myid,mcom,ierr)
   9711          call mpi_send(foe     ,nlev,mrea,mdes,myid,mcom,ierr)
   9712          call mpi_send(fob(1,1),nlev,mrea,mdes,myid,mcom,ierr)
   9713          call mpi_send(fob(1,2),nlev,mrea,mdes,myid,mcom,ierr)
   9714       else
   9715          do i=1,nprc-1
   9716          call mpi_recv(nreps,5,mint,i,i,mcom,istat,ierr)
   9717          jrep = nreps(1)   
   9718          jlev = nreps(2)
   9719          nrep0 = nrep0+nreps(3)
   9720          nlev0 = nlev0+nreps(4)
   9721          maxnlev = max(maxnlev,nreps(5))
   9722          if(nrep+jrep.le.mrep .and. nlev+jlev.le.mlev) then
   9723             k = nrep+1
   9724             l = nlev+1
   9725             call mpi_recv(sid (k  )   ,jrep,mre8,i,i,mcom,istat,ierr)
   9726             call mpi_recv(flv (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9727             call mpi_recv(flt (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9728             call mpi_recv(fln (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9729             call mpi_recv(ftm (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9730             call mpi_recv(fkx (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9731             call mpi_recv(fnl (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9732             call mpi_recv(fms (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9733             call mpi_recv(fmw (k,1)   ,jrep,mrea,i,i,mcom,istat,ierr)
   9734             call mpi_recv(fmw (k,2)   ,jrep,mrea,i,i,mcom,istat,ierr)
   9735             call mpi_recv(fql (k  )   ,jrep,mrea,i,i,mcom,istat,ierr)
   9736             call mpi_recv(fhd (l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9737             call mpi_recv(fprc(l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9738             call mpi_recv(fpfd(l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9739             call mpi_recv(fplv(l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9740             call mpi_recv(fpr (l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9741             call mpi_recv(fqm (l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9742             call mpi_recv(foi (l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9743             call mpi_recv(foe (l  )   ,jlev,mrea,i,i,mcom,istat,ierr)
   9744             call mpi_recv(fob (l,1)   ,jlev,mrea,i,i,mcom,istat,ierr)
   9745             call mpi_recv(fob (l,2)   ,jlev,mrea,i,i,mcom,istat,ierr)
   9746             flv(k:nrep+jrep) = flv(k:nrep+jrep)+l-1
   9747             fhd(l:nlev+jlev) = fhd(l:nlev+jlev)+k-1
   9748             nrep = nrep+jrep
   9749             nlev = nlev+jlev
   9750          else
   9751             call mpi_recv(dummy(1),jrep,mre8,i,i,mcom,istat,ierr)
   9752             do n=1,20
   9753             call mpi_recv(dummy(1),jlev,mrea,i,i,mcom,istat,ierr)
   9754             enddo
   9755          endif
   9756          enddo
   9757       endif
   9758  

Page 190         Source Listing                  SYNCSTOR
2017-04-18 11:07                                 oiqcbufr.f

   9759       call mpi_bcast(nrep,1,mint,mdes,mcom,ierr)
   9760       call mpi_bcast(nlev,1,mint,mdes,mcom,ierr)
   9761       call mpi_bcast(sid     ,nrep,mre8,mdes,mcom,ierr)
   9762       call mpi_bcast(flv     ,nrep,mrea,mdes,mcom,ierr)
   9763       call mpi_bcast(flt     ,nrep,mrea,mdes,mcom,ierr)
   9764       call mpi_bcast(fln     ,nrep,mrea,mdes,mcom,ierr)
   9765       call mpi_bcast(ftm     ,nrep,mrea,mdes,mcom,ierr)
   9766       call mpi_bcast(fkx     ,nrep,mrea,mdes,mcom,ierr)
   9767       call mpi_bcast(fnl     ,nrep,mrea,mdes,mcom,ierr)
   9768       call mpi_bcast(fms     ,nrep,mrea,mdes,mcom,ierr)
   9769       call mpi_bcast(fmw(1,1),nrep,mrea,mdes,mcom,ierr)
   9770       call mpi_bcast(fmw(1,2),nrep,mrea,mdes,mcom,ierr)
   9771       call mpi_bcast(fql     ,nrep,mrea,mdes,mcom,ierr)
   9772       call mpi_bcast(fhd     ,nlev,mrea,mdes,mcom,ierr)
   9773       call mpi_bcast(fprc    ,nlev,mrea,mdes,mcom,ierr)
   9774       call mpi_bcast(fpfd    ,nlev,mrea,mdes,mcom,ierr)
   9775       call mpi_bcast(fplv    ,nlev,mrea,mdes,mcom,ierr)
   9776       call mpi_bcast(fpr     ,nlev,mrea,mdes,mcom,ierr)
   9777       call mpi_bcast(fqm     ,nlev,mrea,mdes,mcom,ierr)
   9778       call mpi_bcast(foi     ,nlev,mrea,mdes,mcom,ierr)
   9779       call mpi_bcast(foe     ,nlev,mrea,mdes,mcom,ierr)
   9780       call mpi_bcast(fob(1,1),nlev,mrea,mdes,mcom,ierr)
   9781       call mpi_bcast(fob(1,2),nlev,mrea,mdes,mcom,ierr)
   9782  
   9783       RETURN
   9784       END


ENTRY POINTS

  Name                 
                       
 syncstor_             

Page 191         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DUMMY                      Local  4511     R(8)            8     1     1100000                   4591,4593                         
 FFE                        Scalar 4498     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 4495     R(4)            4     1     1100000  COM              4544,4576,4587,4612               
 FKX                        Scalar 4493     R(4)            4     1     900000   COM              4538,4570,4606                    
 FLN                        Scalar 4493     R(4)            4     1     900000   COM              4536,4568,4604                    
 FLT                        Scalar 4492     R(4)            4     1     900000   COM              4535,4567,4603                    
 FLV                        Scalar 4492     R(4)            4     1     900000   COM              4534,4566,4586,4602               
 FMS                        Scalar 4494     R(4)            4     1     900000   COM              4540,4572,4608                    
 FMW                        Scalar 4494     R(4)            4     2     1800000  COM              4541,4542,4573,4574,4609,4610     
 FNL                        Scalar 4494     R(4)            4     1     900000   COM              4539,4571,4607                    
 FOB                        Scalar 4497     R(4)            4     2     2200000  COM              4552,4553,4584,4585,4620,4621     
 FOC                        Scalar 4499     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 4498     R(4)            4     1     1100000  COM              4551,4583,4619                    
 FOI                        Scalar 4497     R(4)            4     1     1100000  COM              4550,4582,4618                    
 FPF                        Scalar 4499     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 4496     R(4)            4     1     1100000  COM              4546,4578,4614                    
 FPLV                       Scalar 4496     R(4)            4     1     1100000  COM              4547,4579,4615                    
 FPR                        Scalar 4496     R(4)            4     1     1100000  COM              4548,4580,4616                    
 FPRC                       Scalar 4495     R(4)            4     1     1100000  COM              4545,4577,4613                    
 FQL                        Scalar 4495     R(4)            4     1     900000   COM              4543,4575,4611                    
 FQM                        Scalar 4497     R(4)            4     1     1100000  COM              4549,4581,4617                    
 FTM                        Scalar 4493     R(4)            4     1     900000   COM              4537,4569,4605                    
 FTW                        Scalar 4499     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 4498     R(4)            4     1     1100000  COM                                                
 I                          Local  4555     I(4)            4           scalar                    4555,4556,4565,4566,4567,4568,4569
                                                                                                  ,4570,4571,4572,4573,4574,4575,457
                                                                                                  6,4577,4578,4579,4580,4581,4582,45
                                                                                                  83,4584,4585,4591,4593            
 IERR                       Local  4515     I(4)            4           scalar                    4515,4516,4532,4533,4534,4535,4536
                                                                                                  ,4537,4538,4539,4540,4541,4542,454
                                                                                                  3,4544,4545,4546,4547,4548,4549,45
                                                                                                  50,4551,4552,4553,4556,4565,4566,4
                                                                                                  567,4568,4569,4570,4571,4572,4573,
                                                                                                  4574,4575,4576,4577,4578,4579,4580
                                                                                                  ,4581,4582,4583,4584,4585,4591,459
                                                                                                  3,4599,4600,4601,4602,4603,4604,46
                                                                                                  05,4606,4607,4608,4609,4610,4611,4
                                                                                                  612,4613,4614,4615,4616,4617,4618,
                                                                                                  4619,4620,4621                    
 IMAP                       Scalar 4502     I(4)            4     2     65160    COM                                                
 INOB                       Scalar 4502     I(4)            4     1     900000   COM                                                
 ISTAT                      Local  4510     I(4)            4     1     5                         4556,4565,4566,4567,4568,4569,4570
                                                                                                  ,4571,4572,4573,4574,4575,4576,457
                                                                                                  7,4578,4579,4580,4581,4582,4583,45
                                                                                                  84,4585,4591,4593                 
 JLEV                       Local  4558     I(4)            4           scalar                    4558,4562,4576,4577,4578,4579,4580
                                                                                                  ,4581,4582,4583,4584,4585,4587,458
                                                                                                  9,4593                            
 JREP                       Local  4557     I(4)            4           scalar                    4557,4562,4565,4566,4567,4568,4569
                                                                                                  ,4570,4571,4572,4573,4574,4575,458
                                                                                                  6,4588,4591                       

Page 192         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 K                          Local  4563     I(4)            4           scalar                    4563,4565,4566,4567,4568,4569,4570
                                                                                                  ,4571,4572,4573,4574,4575,4586,458
                                                                                                  7                                 
 L                          Local  4564     I(4)            4           scalar                    4564,4576,4577,4578,4579,4580,4581
                                                                                                  ,4582,4583,4584,4585,4586,4587    
 MAX                        Func   4561                                 scalar                    4561                              
 MAXLEV                     Param  4490     I(4)            4           scalar                    4495,4496,4497,4498,4499,4507,4511
 MAXNLEV                    Dummy  4487     I(4)            4           scalar   ARG,INOUT        4529,4561                         
 MAXREP                     Param  4489     I(4)            4           scalar                    4492,4493,4494,4495,4499,4502,4507
 MCHR                       Local  4521     I(4)            4           scalar                    4521                              
 MCOM                       Local  4517     I(4)            4           scalar                    4517,4532,4533,4534,4535,4536,4537
                                                                                                  ,4538,4539,4540,4541,4542,4543,454
                                                                                                  4,4545,4546,4547,4548,4549,4550,45
                                                                                                  51,4552,4553,4556,4565,4566,4567,4
                                                                                                  568,4569,4570,4571,4572,4573,4574,
                                                                                                  4575,4576,4577,4578,4579,4580,4581
                                                                                                  ,4582,4583,4584,4585,4591,4593,459
                                                                                                  9,4600,4601,4602,4603,4604,4605,46
                                                                                                  06,4607,4608,4609,4610,4611,4612,4
                                                                                                  613,4614,4615,4616,4617,4618,4619,
                                                                                                  4620,4621                         
 MDES                       Local  4522     I(4)            4           scalar                    4522,4531,4532,4533,4534,4535,4536
                                                                                                  ,4537,4538,4539,4540,4541,4542,454
                                                                                                  3,4544,4545,4546,4547,4548,4549,45
                                                                                                  50,4551,4552,4553,4599,4600,4601,4
                                                                                                  602,4603,4604,4605,4606,4607,4608,
                                                                                                  4609,4610,4611,4612,4613,4614,4615
                                                                                                  ,4616,4617,4618,4619,4620,4621    
 MINT                       Local  4520     I(4)            4           scalar                    4520,4532,4556,4599,4600          
 MLEV                       Local  4507     I(4)            4           scalar                    4507,4562                         
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                

Page 193         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BCAST                  Subr   4599                                                           4599,4600,4601,4602,4603,4604,4605
                                                                                                  ,4606,4607,4608,4609,4610,4611,461
                                                                                                  2,4613,4614,4615,4616,4617,4618,46
                                                                                                  19,4620,4621                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                    4521                              
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   4515                                                           4515                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   4516                                                           4516                              
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    4515,4516,4517                    
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               

Page 194         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      

Page 195         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                    4520                              
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      

Page 196         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                    4518                              
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                    4519                              
 MPI_RECV                   Subr   4556                                                           4556,4565,4566,4567,4568,4569,4570
                                                                                                  ,4571,4572,4573,4574,4575,4576,457
                                                                                                  7,4578,4579,4580,4581,4582,4583,45
                                                                                                  84,4585,4591,4593                 
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SEND                   Subr   4532                                                           4532,4533,4534,4535,4536,4537,4538
                                                                                                  ,4539,4540,4541,4542,4543,4544,454
                                                                                                  5,4546,4547,4548,4549,4550,4551,45
                                                                                                  52,4553                           
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      

Page 197         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14,4510                        
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MRE8                       Local  4519     I(4)            4           scalar                    4519,4533,4565,4591,4601          
 MREA                       Local  4518     I(4)            4           scalar                    4518,4534,4535,4536,4537,4538,4539
                                                                                                  ,4540,4541,4542,4543,4544,4545,454
                                                                                                  6,4547,4548,4549,4550,4551,4552,45
                                                                                                  53,4566,4567,4568,4569,4570,4571,4
                                                                                                  572,4573,4574,4575,4576,4577,4578,
                                                                                                  4579,4580,4581,4582,4583,4584,4585
                                                                                                  ,4593,4602,4603,4604,4605,4606,460

Page 198         Source Listing                  SYNCSTOR
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  7,4608,4609,4610,4611,4612,4613,46
                                                                                                  14,4615,4616,4617,4618,4619,4620,4
                                                                                                  621                               
 MREP                       Local  4507     I(4)            4           scalar                    4507,4562                         
 MYID                       Local  4515     I(4)            4           scalar                    4515,4531,4532,4533,4534,4535,4536
                                                                                                  ,4537,4538,4539,4540,4541,4542,454
                                                                                                  3,4544,4545,4546,4547,4548,4549,45
                                                                                                  50,4551,4552,4553                 
 N                          Local  4592     I(4)            4           scalar                    4592                              
 NLEV                       Scalar 4502     I(4)            4           scalar   COM              4526,4544,4545,4546,4547,4548,4549
                                                                                                  ,4550,4551,4552,4553,4562,4564,458
                                                                                                  7,4589,4600,4612,4613,4614,4615,46
                                                                                                  16,4617,4618,4619,4620,4621       
 NLEV0                      Dummy  4487     I(4)            4           scalar   ARG,INOUT        4528,4560                         
 NPRC                       Local  4516     I(4)            4           scalar                    4516,4555                         
 NREP                       Scalar 4502     I(4)            4           scalar   COM              4525,4533,4534,4535,4536,4537,4538
                                                                                                  ,4539,4540,4541,4542,4543,4562,456
                                                                                                  3,4586,4588,4599,4601,4602,4603,46
                                                                                                  04,4605,4606,4607,4608,4609,4610,4
                                                                                                  611                               
 NREP0                      Dummy  4487     I(4)            4           scalar   ARG,INOUT        4527,4559                         
 NREPS                      Local  4505     I(4)            4     1     5                         4525,4526,4527,4528,4529,4532,4556
                                                                                                  ,4557,4558,4559,4560,4561         
 OBS                        Common 4502                                 11060648                                                    
 OIQCDATA                   Common 4492                                 22790000                                                    
                                                                        0                                                           
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 SID                        Scalar 4502     R(8)            8     1     900000   COM              4533,4565,4601                    
 SYNCSTOR                   Subr   4487                                                                                             

Page 199         Source Listing                  SYNCSTOR
2017-04-18 11:07                                 oiqcbufr.f

   9785 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9786 C
   9787 C SUBPROGRAM:    TOSSLIST
   9788 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   9789 C
   9790 C ABSTRACT: WRITES A LIST OF REJECTED OBSERVATIONS PLUS A SUMMARY.
   9791 C
   9792 C PROGRAM HISTORY LOG:
   9793 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   9794 C
   9795 C USAGE:    CALL TOSSLIST(LO)
   9796 C   INPUT ARGUMENT LIST:
   9797 C     LO       - LOGICAL UNIT FOR TOSSLIST OUTPUT
   9798 C
   9799 C   OUTPUT FILES:
   9800 C     UNIT 06  - STANDARD OUTPUT PRINT
   9801 C     UNIT LO  - OFFICIAL OPERATIONAL TOSSLIST
   9802 C
   9803 C REMARKS: NONE.
   9804 C
   9805 C ATTRIBUTES:
   9806 C   LANGUAGE: FORTRAN 90
   9807 C   MACHINE:  NCEP WCOSS
   9808 C
   9809 C$$$
   9810       SUBROUTINE TOSSLIST(LO)
   9811 
   9812       PARAMETER (MAXREP=900000)
   9813       PARAMETER (MAXLEV=1100000)
   9814 
   9815       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
   9816      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
   9817      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
   9818      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
   9819      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
   9820      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
   9821      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
   9822      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
   9823       CHARACTER*3 FOC
   9824 
   9825 
   9826       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
   9827 
   9828       CHARACTER*3 TAG
   9829       DIMENSION   IBAD(30,3),ITOT(30),ISFZ(30),PZ(30),PU(30),PT(30)
   9830       LOGICAL     SFZ,SAT
   9831       REAL*8      SID,STAID
   9832 
   9833       DATA XMSG/32767./
   9834 
   9835 C----------------------------------------------------------------------
   9836 C-----------------------------------------------------------------------
   9837 
   9838 C  START UP
   9839 C  --------
   9840 
   9841       IBAD = 0

Page 200         Source Listing                  TOSSLIST
2017-04-18 11:07                                 oiqcbufr.f

   9842       ITOT = 0
   9843       ISFZ = 0
   9844       PZ   = 0
   9845       PU   = 0
   9846       PT   = 0
   9847 
   9848 C  COUNT BAD DATA IN THE BIG BUFFER - WRITE THE TOSSLIST
   9849 C  -----------------------------------------------------
   9850 
   9851       N   = 0
   9852 
   9853       DO 10 IREP=1,NREP
   9854       X      = FLN(IREP)
   9855       Y      = FLT(IREP)
   9856       STAID  = SID(IREP)
   9857       KX     = FKX(IREP)
   9858       TAG    = FOC(IREP)
   9859       ILEV   = FLV(IREP)
   9860       KLEV   = ILEV+FNL(IREP)-1
   9861 
   9862       DO 10 JLEV=ILEV,KLEV
   9863 
   9864       SFZ = TAG.EQ.'SFC' .AND. JLEV.EQ.KLEV
   9865       SAT = TAG.EQ.'SAT'
   9866 
   9867       IF(FOI(JLEV).NE.0) THEN
   9868          IF(SFZ) THEN
   9869             ISFZ(KX/10) = ISFZ(KX/10) + 1
   9870          ELSE
   9871             ITOT(KX/10) = ITOT(KX/10) + 1
   9872          ENDIF
   9873       ENDIF
   9874 
   9875       IF(FOI(JLEV).LT.0) THEN
   9876          IP     = FPR(JLEV)
   9877          IQ     = FQM(JLEV)
   9878          OBER   = FOE(JLEV)
   9879          BUFF11 = FOB(JLEV,1)
   9880          BUFF12 = FOB(JLEV,2)
   9881          IF(FOI(JLEV).EQ.-1) THEN
   9882             IF(SFZ) THEN
   9883                N = N+1
   9884                WRITE(LO,2002) N,STAID,X,Y,IP,KX,IQ,OBER,BUFF11,BUFF12
   9885                IBAD(KX/10,3) = IBAD(KX/10,3) + 1
   9886             ELSE
   9887                IF(.NOT.SAT) THEN
   9888                   N = N+1
   9889                   WRITE(LO,2000) N,STAID,X,Y,IP,KX,IQ,OBER,BUFF11,BUFF12
   9890                ENDIF
   9891                IBAD(KX/10,1) = IBAD(KX/10,1) + 1
   9892             ENDIF
   9893          ELSE IF(FOI(JLEV).EQ.-2) THEN
   9894             N = N+1
   9895             WRITE(LO,2001) N,STAID,X,Y,IP,KX,IQ,OBER,BUFF11,BUFF12
   9896             IBAD(KX/10,2) = IBAD(KX/10,2) + 1
   9897          ENDIF
   9898       ENDIF

Page 201         Source Listing                  TOSSLIST
2017-04-18 11:07                                 oiqcbufr.f

   9899 10    CONTINUE
   9900 
   9901 C  COMPUTE GROSS PERCENTAGE OF TOSSES
   9902 C  ----------------------------------
   9903 
   9904       DO 20 I=10,29
   9905       IF(ISFZ(I).GT.0) THEN
   9906          PZ(I) = FLOAT(IBAD(I,3))/FLOAT(ISFZ(I))
   9907       ENDIF
   9908       IF(ITOT(I).GT.0) THEN
   9909          PU(I) = FLOAT(IBAD(I,2))/FLOAT(ITOT(I))
   9910          PT(I) = FLOAT(IBAD(I,1))/FLOAT(ITOT(I))
   9911       ENDIF
   9912 20    CONTINUE
   9913 
   9914 C  WRITE A SHORT SUMMARY OF TOSSES
   9915 C  -------------------------------
   9916 
   9917       WRITE( 6,2003)(I,I=100,290,10),(IBAD(I,3),I=10,29),(PZ(I),I=10,29)
   9918       WRITE( 6,2004)(I,I=100,290,10),(IBAD(I,2),I=10,29),(PU(I),I=10,29)
   9919       WRITE( 6,2005)(I,I=100,290,10),(IBAD(I,1),I=10,29),(PT(I),I=10,29)
   9920 
   9921 C  FORMAT STATEMENTS FOR THE TOSS LIST
   9922 C  -----------------------------------
   9923 
   9924 2000  FORMAT(' ',I5,1X,'J',3X,A8,2X,4X,2F10.2,I9,2X,2I5,F8.1,F13.1,
   9925      .           5X,F13.1,10X,F6.1)
   9926 2001  FORMAT(' ',I5,1X,'P',3X,A8,2X,4X,2F10.2,I9,2X,2I5,F8.1,F13.1,
   9927      .           5X,F13.1,10X,F6.1)
   9928 2002  FORMAT(' ',I5,1X,'Z',3X,A8,2X,4X,2F10.2,I9,2X,2I5,F8.1,F13.1,
   9929      .           5X,F13.1,10X,F6.1)
   9930 2003  FORMAT(/' SURFACE Z TOSSES   '/20I5/20I5/20F5.2)
   9931 2004  FORMAT(/' BELOW GROUND TOSSES'/20I5/20I5/20F5.2)
   9932 2005  FORMAT(/' QC OI TOSSES       '/20I5/20I5/20F5.2)
   9933 
   9934       RETURN
   9935       END

Page 202         Source Listing                  TOSSLIST
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                 
                       
 tosslist_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  4739                                                           4693,4702                         
 20                         Label  4752                                                           4744                              
 2000                       Label  4764                                                           4729                              
 2001                       Label  4766                                                           4735                              
 2002                       Label  4768                                                           4724                              
 2003                       Label  4770                                                           4757                              
 2004                       Label  4771                                                           4758                              
 2005                       Label  4772                                                           4759                              
 BUFF11                     Local  4719     R(4)            4           scalar                    4719,4724,4729,4735               
 BUFF12                     Local  4720     R(4)            4           scalar                    4720,4724,4729,4735               
 FFE                        Scalar 4661     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 4658     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 4656     R(4)            4     1     900000   COM              4697                              
 FLN                        Scalar 4656     R(4)            4     1     900000   COM              4694                              
 FLOAT                      Func   4746                                 scalar                    4746,4749,4750                    
 FLT                        Scalar 4655     R(4)            4     1     900000   COM              4695                              
 FLV                        Scalar 4655     R(4)            4     1     900000   COM              4699                              
 FMS                        Scalar 4657     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 4657     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 4657     R(4)            4     1     900000   COM              4700                              
 FOB                        Scalar 4660     R(4)            4     2     2200000  COM              4719,4720                         
 FOC                        Scalar 4662     CHAR            3     1     900000   COM              4698                              
 FOE                        Scalar 4661     R(4)            4     1     1100000  COM              4718                              
 FOI                        Scalar 4660     R(4)            4     1     1100000  COM              4707,4715,4721,4733               
 FPF                        Scalar 4662     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 4659     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 4659     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 4659     R(4)            4     1     1100000  COM              4716                              
 FPRC                       Scalar 4658     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 4658     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 4660     R(4)            4     1     1100000  COM              4717                              
 FTM                        Scalar 4656     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 4662     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 4661     R(4)            4     1     1100000  COM                                                
 I                          Local  4744     I(4)            4           scalar                    4744,4745,4746,4748,4749,4750,4757
                                                                                                  ,4758,4759                        
 IBAD                       Local  4669     I(4)            4     2     90                        4681,4725,4731,4736,4746,4749,4750
                                                                                                  ,4757,4758,4759                   
 ILEV                       Local  4699     I(4)            4           scalar                    4699,4700,4702                    
 IMAP                       Scalar 4666     I(4)            4     2     65160    COM                                                
 INOB                       Scalar 4666     I(4)            4     1     900000   COM                                                
 IP                         Local  4716     I(4)            4           scalar                    4716,4724,4729,4735               
 IQ                         Local  4717     I(4)            4           scalar                    4717,4724,4729,4735               
 IREP                       Local  4693     I(4)            4           scalar                    4693,4694,4695,4696,4697,4698,4699

Page 203         Source Listing                  TOSSLIST
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,4700                             
 ISFZ                       Local  4669     I(4)            4     1     30                        4683,4709,4745,4746               
 ITOT                       Local  4669     I(4)            4     1     30                        4682,4711,4748,4749,4750          
 JLEV                       Local  4702     I(4)            4           scalar                    4702,4704,4707,4715,4716,4717,4718
                                                                                                  ,4719,4720,4721,4733              
 KLEV                       Local  4700     I(4)            4           scalar                    4700,4702,4704                    
 KX                         Local  4697     I(4)            4           scalar                    4697,4709,4711,4724,4725,4729,4731
                                                                                                  ,4735,4736                        
 LO                         Dummy  4650     I(4)            4           scalar   ARG,INOUT        4724,4729,4735                    
 MAXLEV                     Param  4653     I(4)            4           scalar                    4658,4659,4660,4661,4662          
 MAXREP                     Param  4652     I(4)            4           scalar                    4655,4656,4657,4658,4662,4666     
 N                          Local  4691     I(4)            4           scalar                    4691,4723,4724,4728,4729,4734,4735
 NLEV                       Scalar 4666     I(4)            4           scalar   COM                                                
 NREP                       Scalar 4666     I(4)            4           scalar   COM              4693                              
 OBER                       Local  4718     R(4)            4           scalar                    4718,4724,4729,4735               
 OBS                        Common 4666                                 11060648                                                    
 OIQCDATA                   Common 4655                                 22790000                                                    
                                                                        0                                                           
 PT                         Local  4669     R(4)            4     1     30                        4686,4750,4759                    
 PU                         Local  4669     R(4)            4     1     30                        4685,4749,4758                    
 PZ                         Local  4669     R(4)            4     1     30                        4684,4746,4757                    
 SAT                        Local  4670     L(4)            4           scalar                    4705,4727                         
 SFZ                        Local  4670     L(4)            4           scalar                    4704,4708,4722                    
 SID                        Scalar 4666     R(8)            8     1     900000   COM              4696                              
 STAID                      Local  4671     R(8)            8           scalar                    4696,4724,4729,4735               
 TAG                        Local  4668     CHAR            3           scalar                    4698,4704,4705                    
 TOSSLIST                   Subr   4650                                                                                             
 X                          Local  4694     R(4)            4           scalar                    4694,4724,4729,4735               
 XMSG                       Local  4673     R(4)            4           scalar                    4673                              
 Y                          Local  4695     R(4)            4           scalar                    4695,4724,4729,4735               

Page 204         Source Listing                  TOSSLIST
2017-04-18 11:07                                 oiqcbufr.f

   9936 CCBREAKCC
   9937 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9938 C
   9939 C SUBPROGRAM:    VSOLVE
   9940 C   PRGMMR: WOOLLEN          ORG: NP20       DATE: 1990-11-06
   9941 C
   9942 C ABSTRACT: CHOLESKY TYPE SOLUTION FOR ARRAYS OF POSITIVE DEFINITE
   9943 C   SYMMETRIC MATRIXES.
   9944 C
   9945 C PROGRAM HISTORY LOG:
   9946 C 1990-11-06  J. WOOLLEN - ORIGINAL AUTHOR
   9947 C
   9948 C USAGE:    CALL VSOLVE(A,B,NDIM,BAD,NS,MAXDIM)
   9949 C   INPUT ARGUMENT LIST:
   9950 C     A        - ARRAY OF SYMMETRIC MATRIXES
   9951 C     B        - ARRAY OF RIGHT HAND SIDE VECTORS
   9952 C     NDIM     - ARRAY OF MATRIX RANKS
   9953 C     BAD      - BAD MATRIX INDICATOR
   9954 C     NFT      - NUMBER OF RIGHT HAND SIDES PER MATRIX
   9955 C     NS       - NUMBER OF MATRIXES TO SOLVE
   9956 C     MAXDIM   - LARGEST RANK MATRIX IN STACK
   9957 C
   9958 C   OUTPUT ARGUMENT LIST:
   9959 C     B        - CONTAINS THE SOLUTIONS UPON RETURN
   9960 C
   9961 C REMARKS: TRIANGULAR REPRESENTATION LISTS ELEMENTS TOWARDS THE
   9962 C   DIAGONAL. ALGORITHM FROM H.CARUS.
   9963 C
   9964 C ATTRIBUTES:
   9965 C   LANGUAGE: FORTRAN 90
   9966 C   MACHINE:  NCEP WCOSS
   9967 C
   9968 C$$$
   9969 
   9970       SUBROUTINE VSOLVE (A,B,NDIM,BAD,NS,MAXDIM)
   9971 
   9972       PARAMETER( NMX  =  64        ,
   9973      .           NN   =  10*(10+1)/2 ,
   9974      .           N    =  10          )
   9975 
   9976       DIMENSION A(NMX,NN),B(NMX,N,2),NDIM(NMX),BAD(NMX)
   9977       LOGICAL BAD
   9978 
   9979       DIMENSION T(NMX)
   9980 
   9981       DATA CNUM/1.E-15/, NFT/2/
   9982 
   9983 C----------------------------------------------------------------------
   9984       IX (I,J) = I*(I-1)/2 + J
   9985 C----------------------------------------------------------------------
   9986 
   9987       DO 1 M=1,NS
   9988 1     BAD(M) = .FALSE.
   9989 
   9990 C  DECOMPOSE THE MATRIXES
   9991 C  ----------------------
   9992 

Page 205         Source Listing                  VSOLVE
2017-04-18 11:07                                 oiqcbufr.f

   9993       DO 10 I=1,MAXDIM
   9994       DO 10 J=1,I
   9995 
   9996       DO 2 M=1,NS
   9997 2     T(M) = A(M,IX(I,J))
   9998 
   9999       DO 3 K=1,J-1
  10000       DO 3 M=1,NS
  10001 3     T(M) = T(M) - A(M,IX(I,K)) * A(M,IX(J,K))
  10002 
  10003       IF(I.GT.J) THEN
  10004          DO 4 M=1,NS
  10005 4        A(M,IX(I,J)) = T(M) * A(M,IX(J,J))
  10006       ELSE
  10007          DO 5 M=1,NS
  10008          IF(T(M).LT.CNUM .AND. NDIM(M).GE.I) BAD(M) = .TRUE.
  10009          IF(T(M).LE.0) T(M) = 1.
  10010 5        CONTINUE
  10011 
  10012          DO 6 M=1,NS
  10013 6        A(M,IX(I,I)) = 1./SQRT(T(M))
  10014       ENDIF
  10015 
  10016 10    CONTINUE
  10017 
  10018 C  SOLVE FOR ALL RIGHT HAND SIDES
  10019 C  ------------------------------
  10020 
  10021       DO 40 NF=1,NFT
  10022 
  10023 C  FORWARD SUBSTITUTION
  10024 C  --------------------
  10025 
  10026       DO 20 I=1,MAXDIM
  10027 
  10028       DO 11 M=1,NS
  10029 11    T(M) = B(M,I,NF)
  10030 
  10031       DO 12 J=1,I-1
  10032       DO 12 M=1,NS
  10033 12    T(M) = T(M) - A(M,IX(I,J)) * B(M,J,NF)
  10034 
  10035       DO 20 M=1,NS
  10036 20    B(M,I,NF) = T(M) * A(M,IX(I,I))
  10037 
  10038 C  BACKWARD SUBSTITUTION
  10039 C  ---------------------
  10040 
  10041       DO 30 I=MAXDIM,1,-1
  10042 
  10043       DO 21 M=1,NS
  10044 21    T(M) = B(M,I,NF)
  10045 
  10046       IF(I.NE.MAXDIM) THEN
  10047          DO 22 J=I+1,MAXDIM
  10048          DO 22 M=1,NS
  10049 22       T(M) = T(M) - A(M,IX(J,I)) * B(M,J,NF)

Page 206         Source Listing                  VSOLVE
2017-04-18 11:07                                 oiqcbufr.f

  10050       ENDIF
  10051 
  10052       DO 30 M=1,NS
  10053 30    B(M,I,NF) = T(M) * A(M,IX(I,I))
  10054 
  10055 40    CONTINUE
  10056 
  10057       RETURN
  10058       END


ENTRY POINTS

  Name               
                     
 vsolve_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  4828                                                           4827                              
 10                         Label  4856                                                           4833,4834                         
 11                         Label  4869                                                           4868                              
 12                         Label  4873                                                           4871,4872                         
 2                          Label  4837                                                           4836                              
 20                         Label  4876                                                           4866,4875                         
 21                         Label  4884                                                           4883                              
 22                         Label  4889                                                           4887,4888                         
 3                          Label  4841                                                           4839,4840                         
 30                         Label  4893                                                           4881,4892                         
 4                          Label  4845                                                           4844                              
 40                         Label  4895                                                           4861                              
 5                          Label  4850                                                           4847                              
 6                          Label  4853                                                           4852                              
 A                          Dummy  4810     R(4)            4     2     3520     ARG,INOUT        4837,4841,4845,4853,4873,4876,4889
                                                                                                  ,4893                             
 B                          Dummy  4810     R(4)            4     3     1280     ARG,INOUT        4869,4873,4876,4884,4889,4893     
 BAD                        Dummy  4810     L(4)            4     1     64       ARG,INOUT        4828,4848                         
 CNUM                       Local  4821     R(4)            4           scalar                    4821,4848                         
 I                          Local  4833     I(4)            4           scalar                    4833,4834,4837,4841,4843,4845,4848
                                                                                                  ,4853,4866,4869,4871,4873,4876,488
                                                                                                  1,4884,4886,4887,4889,4893        
 IX                         Local  4824     I(4)            4           scalar                    4837,4841,4845,4853,4873,4876,4889
                                                                                                  ,4893                             
 J                          Local  4834     I(4)            4           scalar                    4834,4837,4839,4841,4843,4845,4871
                                                                                                  ,4873,4887,4889                   
 K                          Local  4839     I(4)            4           scalar                    4839,4841                         
 M                          Local  4827     I(4)            4           scalar                    4827,4828,4836,4837,4840,4841,4844
                                                                                                  ,4845,4847,4848,4849,4852,4853,486
                                                                                                  8,4869,4872,4873,4875,4876,4883,48
                                                                                                  84,4888,4889,4892,4893            
 MAXDIM                     Dummy  4810     I(4)            4           scalar   ARG,INOUT        4833,4866,4881,4886,4887          
 N                          Param  4814     I(4)            4           scalar                    4816                              
 NDIM                       Dummy  4810     I(4)            4     1     64       ARG,INOUT        4848                              
 NF                         Local  4861     I(4)            4           scalar                    4861,4869,4873,4876,4884,4889,4893

Page 207         Source Listing                  VSOLVE
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NFT                        Local  4821     I(4)            4           scalar                    4821,4861                         
 NMX                        Param  4812     I(4)            4           scalar                    4816,4819                         
 NN                         Param  4813     I(4)            4           scalar                    4816                              
 NS                         Dummy  4810     I(4)            4           scalar   ARG,INOUT        4827,4836,4840,4844,4847,4852,4868
                                                                                                  ,4872,4875,4883,4888,4892         
 SQRT                       Func   4853                                 scalar                    4853                              
 T                          Local  4819     R(4)            4     1     64                        4837,4841,4845,4848,4849,4853,4869
                                                                                                  ,4873,4876,4884,4889,4893         
 VSOLVE                     Subr   4810                                                                                             

Page 208         Source Listing                  VSOLVE
2017-04-18 11:07                                 oiqcbufr.f

  10059 C-----------------------------------------------------------------------
  10060 C-----------------------------------------------------------------------
  10061       SUBROUTINE syncndd(arr,n,mdtp)
  10062 
  10063       PARAMETER (MAXLEV=1100000)
  10064 
  10065       common /nddspt/ nd1(0:100),nd2(0:100)
  10066       COMMON /CKLIST/ NDD,INDD(MAXLEV)
  10067 
  10068       dimension arr(n)
  10069 
  10070       include "mpif.h"
  10587       dimension istat(mpi_status_size)
  10588       dimension ireq(100)
  10589 
  10590 C-----------------------------------------------------------------------
  10591       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr)
  10592       call mpi_comm_size(MPI_COMM_WORLD,nprc,ierr)
  10593       mcom = mpi_comm_world
  10594       mdes = 0
  10595 C-----------------------------------------------------------------------
  10596 
  10597       if(myid.ne.mdes) then
  10598          ib = indd(nd1(myid))
  10599          ie = indd(nd2(myid))
  10600          mlen = ie-ib+1
  10601          if(nd2(myid).gt.0) 
  10602      .   call mpi_send(arr(ib),mlen,mdtp,mdes,myid,mcom,ierr)
  10603       else
  10604          do i=1,nprc-1
  10605          ib = indd(nd1(i))
  10606          ie = indd(nd2(i))
  10607          mlen = ie-ib+1
  10608          if(nd2(i).gt.0) 
  10609      .   call mpi_recv(arr(ib),mlen,mdtp,i,i,mcom,istat,ierr)
  10610          enddo
  10611       endif
  10612     
  10613       call mpi_bcast (arr,n,mdtp,mdes,mcom,ierr) 
  10614 
  10615       RETURN
  10616       END

Page 209         Source Listing                  SYNCNDD
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name                
                      
 syncndd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARR                        Dummy  4901     R(4)            4     1     0        ARG,INOUT        4926,4933,4937                    
 CKLIST                     Common 4906                                 4400004                                                     
 I                          Local  4928     I(4)            4           scalar                    4928,4929,4930,4932,4933          
 IB                         Local  4922     I(4)            4           scalar                    4922,4924,4926,4929,4931,4933     
 IE                         Local  4923     I(4)            4           scalar                    4923,4924,4930,4931               
 IERR                       Local  4915     I(4)            4           scalar                    4915,4916,4926,4933,4937          
 INDD                       Scalar 4906     I(4)            4     1     1100000  COM              4922,4923,4929,4930               
 IREQ                       Local  4912     I(4)            4     1     100                                                         
 ISTAT                      Local  4911     I(4)            4     1     5                         4933                              
 MAXLEV                     Param  4903     I(4)            4           scalar                    4906                              
 MCOM                       Local  4917     I(4)            4           scalar                    4917,4926,4933,4937               
 MDES                       Local  4918     I(4)            4           scalar                    4918,4921,4926,4937               
 MDTP                       Dummy  4901     I(4)            4           scalar   ARG,INOUT        4926,4933,4937                    
 MLEN                       Local  4924     I(4)            4           scalar                    4924,4926,4931,4933               
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BCAST                  Subr   4937                                                           4937                              
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                

Page 210         Source Listing                  SYNCNDD
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   4915                                                           4915                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   4916                                                           4916                              
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    4915,4916,4917                    
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      

Page 211         Source Listing                  SYNCNDD
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      

Page 212         Source Listing                  SYNCNDD
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      

Page 213         Source Listing                  SYNCNDD
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_RECV                   Subr   4933                                                           4933                              
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SEND                   Subr   4926                                                           4926                              
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14,4911                        
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      

Page 214         Source Listing                  SYNCNDD
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  4915     I(4)            4           scalar                    4915,4921,4922,4923,4925,4926     
 N                          Dummy  4901     I(4)            4           scalar   ARG,INOUT        4908,4937                         
 ND1                        Scalar 4905     I(4)            4     1     101      COM              4922,4929                         
 ND2                        Scalar 4905     I(4)            4     1     101      COM              4923,4925,4930,4932               
 NDD                        Scalar 4906     I(4)            4           scalar   COM                                                
 NDDSPT                     Common 4905                                 808                                                         
 NPRC                       Local  4916     I(4)            4           scalar                    4916,4928                         
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 SYNCNDD                    Subr   4901                                                                                             

Page 215         Source Listing                  SYNCNDD
2017-04-18 11:07                                 oiqcbufr.f

  10617 C-----------------------------------------------------------------------
  10618 C-----------------------------------------------------------------------
  10619       SUBROUTINE NDDSPLIT(MYID,nd1,nd2)
  10620  
  10621       PARAMETER (MAXREP=900000)
  10622       PARAMETER (MAXLEV=1100000)
  10623 
  10624       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
  10625      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
  10626      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
  10627      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
  10628      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
  10629      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
  10630      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
  10631      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
  10632       CHARACTER*3 FOC
  10633  
  10634  
  10635       COMMON /CKLIST/ NDD,INDD(MAXLEV)
  10636  
  10637       include "mpif.h"
  10638  
  10639 C-----------------------------------------------------------------------
  11156       call mpi_comm_size(MPI_COMM_WORLD,nprc,ierr)
  11157 C-----------------------------------------------------------------------
  11158  
  11159 C  SUM THE REPORTS PER AMAP BOX
  11160 C  ----------------------------
  11161  
  11162       JTOT = 0
  11163       DO N=1,NDD
  11164       JTOT = JTOT+JNDD(N)
  11165       ENDDO
  11166 
  11167 C  COMPUTE THE range within the FREQUENCY DISTRIBUTION
  11168 C  ---------------------------------------------------
  11169  
  11170       npart = jtot/nprc + min(mod(jtot,nprc),1)
  11171       ns1 = min(npart*myid,jtot)
  11172       ns2 = min(npart*(myid+1),jtot)
  11173 c     print*,'ns',ns1,ns2
  11174 
  11175 c  pick the start and end points for this processor
  11176 c  ------------------------------------------------
  11177  
  11178       jntt = 0
  11179       do n=1,ndd
  11180       nd1 = n
  11181       jntt = jntt+jndd(n)
  11182 c     print*,'n',n,jntt,ndd
  11183       if(jntt.ge.ns1) then
  11184          do m=min(n+1,ndd),ndd
  11185          nd2 = m
  11186          jntt = jntt+jndd(m)
  11187 c        print*,'m',m,jntt,ns2
  11188          if(jntt.ge.ns2) return
  11189          enddo

Page 216         Source Listing                  NDDSPLIT
2017-04-18 11:07                                 oiqcbufr.f

  11190          if(ndd.eq.1) return
  11191          PRINT *, 'nddsplit inside alignment error'
  11192          CALL W3TAGE('PREPOBS_OIQCBUFR')
  11193          CALL ERREXIT(99)
  11194       endif
  11195       enddo
  11196  
  11197 c  bad news if it gets this far!
  11198 c  -----------------------------
  11199  
  11200       PRINT *, 'nddsplit outside alignment error'
  11201       CALL W3TAGE('PREPOBS_OIQCBUFR')
  11202       CALL ERREXIT(99)
  11203       end


ENTRY POINTS

  Name                 
                       
 nddsplit_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CKLIST                     Common 4959                                 4400004                                                     
 ERREXIT                    Subr   5001                                                           5001,5010                         
 FFE                        Scalar 4954     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 4951     R(4)            4     1     1100000  COM                                                
 FKX                        Scalar 4949     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 4949     R(4)            4     1     900000   COM                                                
 FLT                        Scalar 4948     R(4)            4     1     900000   COM                                                
 FLV                        Scalar 4948     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 4950     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 4950     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 4950     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 4953     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 4955     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 4954     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 4953     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 4955     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 4952     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 4952     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 4952     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 4951     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 4951     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 4953     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 4949     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 4955     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 4954     R(4)            4     1     1100000  COM                                                
 IERR                       Local  4964     I(4)            4           scalar                    4964                              
 INDD                       Scalar 4959     I(4)            4     1     1100000  COM                                                
 JNDD                       Func   4972     I(4)            4           scalar                    4972,4989,4994                    
 JNTT                       Local  4986     I(4)            4           scalar                    4986,4989,4991,4994,4996          
 JTOT                       Local  4970     I(4)            4           scalar                    4970,4972,4978,4979,4980          

Page 217         Source Listing                  NDDSPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 M                          Local  4992     I(4)            4           scalar                    4992,4993,4994                    
 MAXLEV                     Param  4946     I(4)            4           scalar                    4951,4952,4953,4954,4955,4959     
 MAXREP                     Param  4945     I(4)            4           scalar                    4948,4949,4950,4951,4955          
 MIN                        Func   4978                                 scalar                    4978,4979,4980,4992               
 MOD                        Func   4978                                 scalar                    4978                              
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      

Page 218         Source Listing                  NDDSPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_SIZE              Subr   4964                                                           4964                              
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    4964                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      

Page 219         Source Listing                  NDDSPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      

Page 220         Source Listing                  NDDSPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      

Page 221         Source Listing                  NDDSPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      

Page 222         Source Listing                  NDDSPLIT
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Dummy  4943     I(4)            4           scalar   ARG,INOUT        4979,4980                         
 N                          Local  4971     I(4)            4           scalar                    4971,4972,4987,4988,4989,4992     
 ND1                        Dummy  4943     I(4)            4           scalar   ARG,INOUT        4988                              
 ND2                        Dummy  4943     I(4)            4           scalar   ARG,INOUT        4993                              
 NDD                        Scalar 4959     I(4)            4           scalar   COM              4971,4987,4992,4998               
 NDDSPLIT                   Subr   4943                                                                                             
 NPART                      Local  4978     I(4)            4           scalar                    4978,4979,4980                    
 NPRC                       Local  4964     I(4)            4           scalar                    4964,4978                         
 NS1                        Local  4979     I(4)            4           scalar                    4979,4991                         
 NS2                        Local  4980     I(4)            4           scalar                    4980,4996                         
 OIQCDATA                   Common 4948                                 22790000                                                    
                                                                        0                                                           
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 W3TAGE                     Subr   5000                                                           5000,5009                         

Page 223         Source Listing                  NDDSPLIT
2017-04-18 11:07                                 oiqcbufr.f

  11204 C-----------------------------------------------------------------------
  11205 C-----------------------------------------------------------------------
  11206       function jndd(n)
  11207  
  11208       PARAMETER (MAXREP=900000)
  11209       PARAMETER (MAXLEV=1100000)
  11210 
  11211       COMMON /OIQCDATA/   FLV (MAXREP     ) , FLT (MAXREP     ) ,
  11212      .FLN (MAXREP     ) , FTM (MAXREP     ) , FKX (MAXREP     ) ,
  11213      .FNL (MAXREP     ) , FMS (MAXREP     ) , FMW (MAXREP,2   ) ,
  11214      .FQL (MAXREP     ) , FHD (MAXLEV     ) , FPRC(MAXLEV     ) ,
  11215      .FPFD(MAXLEV     ) , FPLV(MAXLEV     ) , FPR (MAXLEV     ) ,
  11216      .FQM (MAXLEV     ) , FOI (MAXLEV     ) , FOB (MAXLEV,2   ) ,
  11217      .FOE (MAXLEV     ) , FFE (MAXLEV,2   ) , FTZ (MAXLEV     ) ,
  11218      .FTW (MAXLEV,10,2) , FPF (MAXLEV,5,2 ) , FOC (MAXREP     )
  11219       CHARACTER*3 FOC
  11220  
  11221  
  11222       COMMON /OBS/ NREP,NLEV,SID(MAXREP),INOB(MAXREP),IMAP(360,181)
  11223       COMMON /CKLIST/ NDD,INDD(MAXLEV)
  11224       REAL*8 SID
  11225  
  11226       DATA PI180  /.0174532/
  11227 
  11228       save iold,jold
  11229 
  11230 C-----------------------------------------------------------------------
  11231       !ltb(l) = min(max(1,l),181)
  11232       !lnb(l) = min(max(1,l),360)
  11233 C-----------------------------------------------------------------------
  11234  
  11235       if(n.eq.1) iold = 0
  11236       irep = fhd(indd(n))
  11237       if(iold.eq.irep) then
  11238          jndd = jold
  11239          return
  11240       else
  11241          iold = irep
  11242          jndd = 1
  11243       endif
  11244 
  11245       lon = ifix(fln(irep))+1
  11246       lat = ifix(flt(irep))+91.
  11247       ldn = 10
  11248       do ltt=lat-5,lat+5
  11249       if(ltt.ge.2.and.ltt.le.180) then
  11250          ln1 = lon-ldn
  11251          ln2 = lon+ldn               
  11252          lt1 = ltx(ln1,ltt)
  11253          lt2 = ltx(ln2,ltt)
  11254          jndd = jndd+min(abs(imap(ln1,lt1)-imap(ln2,lt2)),ldn*100)
  11255       endif
  11256       enddo
  11257 
  11258       jold = jndd
  11259       return
  11260       end

Page 224         Source Listing                  JNDD
2017-04-18 11:07 Entry Points                    oiqcbufr.f



ENTRY POINTS

  Name             
                   
 jndd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   5062                                 scalar                    5062                              
 CKLIST                     Common 5031                                 4400004                                                     
 FFE                        Scalar 5025     R(4)            4     2     2200000  COM                                                
 FHD                        Scalar 5022     R(4)            4     1     1100000  COM              5044                              
 FKX                        Scalar 5020     R(4)            4     1     900000   COM                                                
 FLN                        Scalar 5020     R(4)            4     1     900000   COM              5053                              
 FLT                        Scalar 5019     R(4)            4     1     900000   COM              5054                              
 FLV                        Scalar 5019     R(4)            4     1     900000   COM                                                
 FMS                        Scalar 5021     R(4)            4     1     900000   COM                                                
 FMW                        Scalar 5021     R(4)            4     2     1800000  COM                                                
 FNL                        Scalar 5021     R(4)            4     1     900000   COM                                                
 FOB                        Scalar 5024     R(4)            4     2     2200000  COM                                                
 FOC                        Scalar 5026     CHAR            3     1     900000   COM                                                
 FOE                        Scalar 5025     R(4)            4     1     1100000  COM                                                
 FOI                        Scalar 5024     R(4)            4     1     1100000  COM                                                
 FPF                        Scalar 5026     R(4)            4     3     11000000 COM                                                
 FPFD                       Scalar 5023     R(4)            4     1     1100000  COM                                                
 FPLV                       Scalar 5023     R(4)            4     1     1100000  COM                                                
 FPR                        Scalar 5023     R(4)            4     1     1100000  COM                                                
 FPRC                       Scalar 5022     R(4)            4     1     1100000  COM                                                
 FQL                        Scalar 5022     R(4)            4     1     900000   COM                                                
 FQM                        Scalar 5024     R(4)            4     1     1100000  COM                                                
 FTM                        Scalar 5020     R(4)            4     1     900000   COM                                                
 FTW                        Scalar 5026     R(4)            4     3     22000000 COM                                                
 FTZ                        Scalar 5025     R(4)            4     1     1100000  COM                                                
 IFIX                       Func   5053                                 scalar                    5053,5054                         
 IMAP                       Scalar 5030     I(4)            4     2     65160    COM              5062                              
 INDD                       Scalar 5031     I(4)            4     1     1100000  COM              5044                              
 INOB                       Scalar 5030     I(4)            4     1     900000   COM                                                
 IOLD                       Local  5036     I(4)            4           scalar   SAVE             5043,5045,5049                    
 IREP                       Local  5044     I(4)            4           scalar                    5044,5045,5049,5053,5054          
 JNDD                       Func   5014     I(4)            4           scalar                    5046,5050,5062,5066               
 JNDD@0                     Local  5014     I(4)            4           scalar                                                      
 JOLD                       Local  5036     I(4)            4           scalar   SAVE             5046,5066                         
 LAT                        Local  5054     I(4)            4           scalar                    5054,5056                         
 LDN                        Local  5055     I(4)            4           scalar                    5055,5058,5059,5062               
 LN1                        Local  5058     I(4)            4           scalar                    5058,5060,5062                    
 LN2                        Local  5059     I(4)            4           scalar                    5059,5061,5062                    
 LON                        Local  5053     I(4)            4           scalar                    5053,5058,5059                    
 LT1                        Local  5060     I(4)            4           scalar                    5060,5062                         
 LT2                        Local  5061     I(4)            4           scalar                    5061,5062                         
 LTT                        Local  5056     I(4)            4           scalar                    5056,5057,5060,5061               
 LTX                        Func   5060     I(4)            4           scalar                    5060,5061                         
 MAXLEV                     Param  5017     I(4)            4           scalar                    5022,5023,5024,5025,5026,5031     

Page 225         Source Listing                  JNDD
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAXREP                     Param  5016     I(4)            4           scalar                    5019,5020,5021,5022,5026,5030     
 MIN                        Func   5062                                 scalar                    5062                              
 N                          Dummy  5014     I(4)            4           scalar   ARG,INOUT        5043,5044                         
 NDD                        Scalar 5031     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 5030     I(4)            4           scalar   COM                                                
 NREP                       Scalar 5030     I(4)            4           scalar   COM                                                
 OBS                        Common 5030                                 11060648                                                    
 OIQCDATA                   Common 5019                                 22790000                                                    
                                                                        0                                                           
 PI180                      Local  5034     R(4)            4           scalar                    5034                              
 SID                        Scalar 5030     R(8)            8     1     900000   COM                                                

Page 226         Source Listing                  JNDD
2017-04-18 11:07                                 oiqcbufr.f

  11261 C-----------------------------------------------------------------------
  11262 C-----------------------------------------------------------------------
  11263       function ltx(lon,lat)
  11264 C-----------------------------------------------------------------------
  11265       ltb(l) = min(max(1,l),181)
  11266 C-----------------------------------------------------------------------
  11267       if(lon.lt.1) then
  11268          do while(lon<1);lon=360+lon;enddo
  11269          ltx = ltb(lat-1)
  11270       elseif(lon.gt.360) then
  11271          do while(lon>360);lon=lon-360;enddo
  11272          ltx = ltb(lat+1)
  11273       else
  11274          ltx = lat
  11275       endif
  11276       return
  11277       end


ENTRY POINTS

  Name            
                  
 ltx_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LAT                        Dummy  5071     I(4)            4           scalar   ARG,INOUT        5077,5080,5082                    
 LON                        Dummy  5071     I(4)            4           scalar   ARG,INOUT        5075,5076,5078,5079               
 LTB                        Local  5073     I(4)            4           scalar                    5077,5080                         
 LTX                        Func   5071     I(4)            4           scalar                    5077,5080,5082                    
 LTX@0                      Local  5071     I(4)            4           scalar                                                      
 MAX                        Func   5073                                 scalar                    5073                              
 MIN                        Func   5073                                 scalar                    5073                              

Page 227         Source Listing                  LTX
2017-04-18 11:07                                 oiqcbufr.f

  11278 c-----------------------------------------------------------------------------------
  11279 c-----------------------------------------------------------------------------------
  11280       subroutine prttime(title)
  11281       character(*) title
  11282       data t0/0.00/
  11283       data t1/0.00/
  11284       save t0,t1
  11285 c-----------------------------------------------------------------------------------
  11286       include "mpif.h"
  11287 c-----------------------------------------------------------------------------------
  11804       call mpi_comm_rank(MPI_COMM_WORLD,myid,ierr);if(myid/=0)return
  11805 c-----------------------------------------------------------------------------------
  11806       if(t0==0.00) t0=secnds(t0)
  11807       print1,title,secnds(t0)-t1,secnds(t0)
  11808       t1=secnds(t0)
  11809 1     format('time>>>',a20,3(2x,f8.2))
  11810       return
  11811       end


ENTRY POINTS

  Name                
                      
 prttime_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  5101                                                           5099                              
 IERR                       Local  5096     I(4)            4           scalar                    5096                              
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPIX_COMBINER_HINDEXED_BLO                                                                                                         
 CK                         Param  420      I(4)            4           scalar                                                      
 MPIX_COMM_TYPE_SHARED      Param  438      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NO_PROC       Param  442      I(4)            4           scalar                                                      
 MPIX_MESSAGE_NULL          Param  440      I(4)            4           scalar                                                      
 MPI_2COMPLEX               Param  266      I(4)            4           scalar                                                      
 MPI_2DOUBLE_COMPLEX        Param  272      I(4)            4           scalar                                                      
 MPI_2DOUBLE_PRECISION      Param  268      I(4)            4           scalar                                                      
 MPI_2INT                   Param  350      I(4)            4           scalar                                                      
 MPI_2INTEGER               Param  264      I(4)            4           scalar                                                      
 MPI_2REAL                  Param  270      I(4)            4           scalar                                                      
 MPI_ADDRESS_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_AINT                   Param  380      I(4)            4           scalar                                                      
 MPI_ANY_SOURCE             Param  232      I(4)            4           scalar                                                      
 MPI_ANY_TAG                Param  234      I(4)            4           scalar                                                      
 MPI_APPNUM                 Param  202      I(4)            4           scalar                                                      

Page 228         Source Listing                  PRTTIME
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ARGVS_NULL             Scalar 16       CHAR            1     2     1        COM                                                
 MPI_ARGV_NULL              Scalar 17       CHAR            1     1     1        COM                                                
 MPI_BAND                   Param  150      I(4)            4           scalar                                                      
 MPI_BOR                    Param  154      I(4)            4           scalar                                                      
 MPI_BOTTOM                 Scalar 490      I(4)            4           scalar   COM                                                
 MPI_BSEND_OVERHEAD         Param  228      I(4)            4           scalar                                                      
 MPI_BXOR                   Param  158      I(4)            4           scalar                                                      
 MPI_BYTE                   Param  276      I(4)            4           scalar                                                      
 MPI_CART                   Param  240      I(4)            4           scalar                                                      
 MPI_CHAR                   Param  310      I(4)            4           scalar                                                      
 MPI_CHARACTER              Param  274      I(4)            4           scalar                                                      
 MPI_COMBINER_CONTIGUOUS    Param  388      I(4)            4           scalar                                                      
 MPI_COMBINER_DARRAY        Param  410      I(4)            4           scalar                                                      
 MPI_COMBINER_DUP           Param  386      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_COMPLEX   Param  414      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_INTEGER   Param  416      I(4)            4           scalar                                                      
 MPI_COMBINER_F90_REAL      Param  412      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED      Param  400      I(4)            4           scalar                                                      
 MPI_COMBINER_HINDEXED_INTE                                                                                                         
 GER                        Param  398      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR       Param  394      I(4)            4           scalar                                                      
 MPI_COMBINER_HVECTOR_INTEG                                                                                                         
 ER                         Param  392      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED       Param  396      I(4)            4           scalar                                                      
 MPI_COMBINER_INDEXED_BLOCK Param  402      I(4)            4           scalar                                                      
 MPI_COMBINER_NAMED         Param  384      I(4)            4           scalar                                                      
 MPI_COMBINER_RESIZED       Param  418      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT        Param  406      I(4)            4           scalar                                                      
 MPI_COMBINER_STRUCT_INTEGE                                                                                                         
 R                          Param  404      I(4)            4           scalar                                                      
 MPI_COMBINER_SUBARRAY      Param  408      I(4)            4           scalar                                                      
 MPI_COMBINER_VECTOR        Param  390      I(4)            4           scalar                                                      
 MPI_COMM_DUP_FN            Subr   494                                  scalar                                                      
 MPI_COMM_NULL              Param  172      I(4)            4           scalar                                                      
 MPI_COMM_NULL_COPY_FN      Subr   495                                  scalar                                                      
 MPI_COMM_NULL_DELETE_FN    Subr   494                                  scalar                                                      
 MPI_COMM_RANK              Subr   5096                                                           5096                              
 MPI_COMM_SELF              Param  168      I(4)            4           scalar                                                      
 MPI_COMM_WORLD             Param  166      I(4)            4           scalar                    5096                              
 MPI_COMPLEX                Param  252      I(4)            4           scalar                                                      
 MPI_COMPLEX16              Param  302      I(4)            4           scalar                                                      
 MPI_COMPLEX32              Param  304      I(4)            4           scalar                                                      
 MPI_COMPLEX8               Param  300      I(4)            4           scalar                                                      
 MPI_CONGRUENT              Param  134      I(4)            4           scalar                                                      
 MPI_CONVERSION_FN_NULL     Subr   500                                  scalar                                                      
 MPI_C_BOOL                 Param  370      I(4)            4           scalar                                                      
 MPI_C_COMPLEX              Param  374      I(4)            4           scalar                                                      
 MPI_C_DOUBLE_COMPLEX       Param  376      I(4)            4           scalar                                                      
 MPI_C_FLOAT_COMPLEX        Param  372      I(4)            4           scalar                                                      
 MPI_C_LONG_DOUBLE_COMPLEX  Param  378      I(4)            4           scalar                                                      
 MPI_DATATYPE_NULL          Param  182      I(4)            4           scalar                    293                               
 MPI_DISPLACEMENT_CURRENT   Param  488      I(8)            8           scalar                                                      
 MPI_DISTRIBUTE_BLOCK       Param  480      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_CYCLIC      Param  482      I(4)            4           scalar                                                      
 MPI_DISTRIBUTE_DFLT_DARG   Param  486      I(4)            4           scalar                                                      

Page 229         Source Listing                  PRTTIME
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_DISTRIBUTE_NONE        Param  484      I(4)            4           scalar                                                      
 MPI_DIST_GRAPH             Param  242      I(4)            4           scalar                                                      
 MPI_DOUBLE                 Param  332      I(4)            4           scalar                                                      
 MPI_DOUBLE_COMPLEX         Param  254      I(4)            4           scalar                                                      
 MPI_DOUBLE_INT             Param  344      I(4)            4           scalar                                                      
 MPI_DOUBLE_PRECISION       Param  260      I(4)            4           scalar                                                      
 MPI_DUP_FN                 Subr   491                                  scalar                                                      
 MPI_ERRCODES_IGNORE        Scalar 15       I(4)            4     1     1        COM                                                
 MPI_ERRHANDLER_NULL        Param  186      I(4)            4           scalar                                                      
 MPI_ERROR                  Param  9        I(4)            4           scalar                                                      
 MPI_ERRORS_ARE_FATAL       Param  128      I(4)            4           scalar                                                      
 MPI_ERRORS_RETURN          Param  130      I(4)            4           scalar                                                      
 MPI_ERR_ACCESS             Param  70       I(4)            4           scalar                                                      
 MPI_ERR_AMODE              Param  118      I(4)            4           scalar                                                      
 MPI_ERR_ARG                Param  88       I(4)            4           scalar                                                      
 MPI_ERR_ASSERT             Param  38       I(4)            4           scalar                                                      
 MPI_ERR_BAD_FILE           Param  60       I(4)            4           scalar                                                      
 MPI_ERR_BASE               Param  80       I(4)            4           scalar                                                      
 MPI_ERR_BUFFER             Param  94       I(4)            4           scalar                                                      
 MPI_ERR_COMM               Param  44       I(4)            4           scalar                                                      
 MPI_ERR_CONVERSION         Param  74       I(4)            4           scalar                                                      
 MPI_ERR_COUNT              Param  22       I(4)            4           scalar                                                      
 MPI_ERR_DIMS               Param  122      I(4)            4           scalar                                                      
 MPI_ERR_DISP               Param  98       I(4)            4           scalar                                                      
 MPI_ERR_DUP_DATAREP        Param  30       I(4)            4           scalar                                                      
 MPI_ERR_FILE               Param  78       I(4)            4           scalar                                                      
 MPI_ERR_FILE_EXISTS        Param  40       I(4)            4           scalar                                                      
 MPI_ERR_FILE_IN_USE        Param  114      I(4)            4           scalar                                                      
 MPI_ERR_GROUP              Param  102      I(4)            4           scalar                                                      
 MPI_ERR_INFO               Param  110      I(4)            4           scalar                                                      
 MPI_ERR_INFO_KEY           Param  86       I(4)            4           scalar                                                      
 MPI_ERR_INFO_NOKEY         Param  36       I(4)            4           scalar                                                      
 MPI_ERR_INFO_VALUE         Param  54       I(4)            4           scalar                                                      
 MPI_ERR_INTERN             Param  126      I(4)            4           scalar                                                      
 MPI_ERR_IN_STATUS          Param  82       I(4)            4           scalar                                                      
 MPI_ERR_IO                 Param  68       I(4)            4           scalar                                                      
 MPI_ERR_KEYVAL             Param  46       I(4)            4           scalar                                                      
 MPI_ERR_LASTCODE           Param  96       I(4)            4           scalar                                                      
 MPI_ERR_LOCKTYPE           Param  26       I(4)            4           scalar                                                      
 MPI_ERR_NAME               Param  48       I(4)            4           scalar                                                      
 MPI_ERR_NOT_SAME           Param  108      I(4)            4           scalar                                                      
 MPI_ERR_NO_MEM             Param  58       I(4)            4           scalar                                                      
 MPI_ERR_NO_SPACE           Param  72       I(4)            4           scalar                                                      
 MPI_ERR_NO_SUCH_FILE       Param  124      I(4)            4           scalar                                                      
 MPI_ERR_OP                 Param  28       I(4)            4           scalar                                                      
 MPI_ERR_OTHER              Param  20       I(4)            4           scalar                                                      
 MPI_ERR_PENDING            Param  42       I(4)            4           scalar                                                      
 MPI_ERR_PORT               Param  100      I(4)            4           scalar                                                      
 MPI_ERR_QUOTA              Param  62       I(4)            4           scalar                                                      
 MPI_ERR_RANK               Param  120      I(4)            4           scalar                                                      
 MPI_ERR_READ_ONLY          Param  90       I(4)            4           scalar                                                      
 MPI_ERR_REQUEST            Param  50       I(4)            4           scalar                                                      
 MPI_ERR_RMA_CONFLICT       Param  84       I(4)            4           scalar                                                      
 MPI_ERR_RMA_SYNC           Param  56       I(4)            4           scalar                                                      
 MPI_ERR_ROOT               Param  64       I(4)            4           scalar                                                      

Page 230         Source Listing                  PRTTIME
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_ERR_SERVICE            Param  66       I(4)            4           scalar                                                      
 MPI_ERR_SIZE               Param  92       I(4)            4           scalar                                                      
 MPI_ERR_SPAWN              Param  24       I(4)            4           scalar                                                      
 MPI_ERR_TAG                Param  106      I(4)            4           scalar                                                      
 MPI_ERR_TOPOLOGY           Param  104      I(4)            4           scalar                                                      
 MPI_ERR_TRUNCATE           Param  34       I(4)            4           scalar                                                      
 MPI_ERR_TYPE               Param  52       I(4)            4           scalar                                                      
 MPI_ERR_UNKNOWN            Param  112      I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_DATARE                                                                                                         
 P                          Param  32       I(4)            4           scalar                                                      
 MPI_ERR_UNSUPPORTED_OPERAT                                                                                                         
 ION                        Param  116      I(4)            4           scalar                                                      
 MPI_ERR_WIN                Param  76       I(4)            4           scalar                                                      
 MPI_FILE_NULL              Param  176      I(4)            4           scalar                                                      
 MPI_FLOAT                  Param  330      I(4)            4           scalar                                                      
 MPI_FLOAT_INT              Param  342      I(4)            4           scalar                                                      
 MPI_GRAPH                  Param  238      I(4)            4           scalar                                                      
 MPI_GROUP_EMPTY            Param  170      I(4)            4           scalar                                                      
 MPI_GROUP_NULL             Param  178      I(4)            4           scalar                                                      
 MPI_HOST                   Param  192      I(4)            4           scalar                                                      
 MPI_IDENT                  Param  132      I(4)            4           scalar                                                      
 MPI_INFO_NULL              Param  188      I(4)            4           scalar                                                      
 MPI_INT                    Param  322      I(4)            4           scalar                                                      
 MPI_INT16_T                Param  356      I(4)            4           scalar                                                      
 MPI_INT32_T                Param  358      I(4)            4           scalar                                                      
 MPI_INT64_T                Param  360      I(4)            4           scalar                                                      
 MPI_INT8_T                 Param  354      I(4)            4           scalar                                                      
 MPI_INTEGER                Param  262      I(4)            4           scalar                                                      
 MPI_INTEGER1               Param  284      I(4)            4           scalar                                                      
 MPI_INTEGER16              Param  292      I(4)            4           scalar                                                      
 MPI_INTEGER2               Param  286      I(4)            4           scalar                                                      
 MPI_INTEGER4               Param  288      I(4)            4           scalar                                                      
 MPI_INTEGER8               Param  290      I(4)            4           scalar                                                      
 MPI_INTEGER_KIND           Param  306      I(4)            4           scalar                                                      
 MPI_IN_PLACE               Scalar 490      I(4)            4           scalar   COM                                                
 MPI_IO                     Param  194      I(4)            4           scalar                                                      
 MPI_KEYVAL_INVALID         Param  226      I(4)            4           scalar                                                      
 MPI_LAND                   Param  148      I(4)            4           scalar                                                      
 MPI_LASTUSEDCODE           Param  200      I(4)            4           scalar                                                      
 MPI_LB                     Param  280      I(4)            4           scalar                                                      
 MPI_LOCK_EXCLUSIVE         Param  248      I(4)            4           scalar                                                      
 MPI_LOCK_SHARED            Param  250      I(4)            4           scalar                                                      
 MPI_LOGICAL                Param  256      I(4)            4           scalar                                                      
 MPI_LONG                   Param  326      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE            Param  334      I(4)            4           scalar                                                      
 MPI_LONG_DOUBLE_INT        Param  352      I(4)            4           scalar                                                      
 MPI_LONG_INT               Param  346      I(4)            4           scalar                                                      
 MPI_LONG_LONG              Param  340      I(4)            4           scalar                                                      
 MPI_LONG_LONG_INT          Param  336      I(4)            4           scalar                                                      
 MPI_LOR                    Param  152      I(4)            4           scalar                                                      
 MPI_LXOR                   Param  156      I(4)            4           scalar                                                      
 MPI_MAX                    Param  140      I(4)            4           scalar                                                      
 MPI_MAXLOC                 Param  162      I(4)            4           scalar                                                      
 MPI_MAX_DATAREP_STRING     Param  222      I(4)            4           scalar                                                      
 MPI_MAX_ERROR_STRING       Param  210      I(4)            4           scalar                                                      

Page 231         Source Listing                  PRTTIME
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_MAX_INFO_KEY           Param  216      I(4)            4           scalar                                                      
 MPI_MAX_INFO_VAL           Param  218      I(4)            4           scalar                                                      
 MPI_MAX_OBJECT_NAME        Param  214      I(4)            4           scalar                                                      
 MPI_MAX_PORT_NAME          Param  212      I(4)            4           scalar                                                      
 MPI_MAX_PROCESSOR_NAME     Param  220      I(4)            4           scalar                                                      
 MPI_MIN                    Param  142      I(4)            4           scalar                                                      
 MPI_MINLOC                 Param  160      I(4)            4           scalar                                                      
 MPI_MODE_APPEND            Param  466      I(4)            4           scalar                                                      
 MPI_MODE_CREATE            Param  462      I(4)            4           scalar                                                      
 MPI_MODE_DELETE_ON_CLOSE   Param  458      I(4)            4           scalar                                                      
 MPI_MODE_EXCL              Param  464      I(4)            4           scalar                                                      
 MPI_MODE_NOCHECK           Param  428      I(4)            4           scalar                                                      
 MPI_MODE_NOPRECEDE         Param  434      I(4)            4           scalar                                                      
 MPI_MODE_NOPUT             Param  432      I(4)            4           scalar                                                      
 MPI_MODE_NOSTORE           Param  430      I(4)            4           scalar                                                      
 MPI_MODE_NOSUCCEED         Param  436      I(4)            4           scalar                                                      
 MPI_MODE_RDONLY            Param  452      I(4)            4           scalar                                                      
 MPI_MODE_RDWR              Param  454      I(4)            4           scalar                                                      
 MPI_MODE_SEQUENTIAL        Param  468      I(4)            4           scalar                                                      
 MPI_MODE_UNIQUE_OPEN       Param  460      I(4)            4           scalar                                                      
 MPI_MODE_WRONLY            Param  456      I(4)            4           scalar                                                      
 MPI_NULL_COPY_FN           Subr   491                                  scalar                                                      
 MPI_NULL_DELETE_FN         Subr   491                                  scalar                                                      
 MPI_OFFSET                 Param  382      I(4)            4           scalar                                                      
 MPI_OFFSET_KIND            Param  306      I(4)            4           scalar                                                      
 MPI_OP_NULL                Param  180      I(4)            4           scalar                                                      
 MPI_ORDER_C                Param  476      I(4)            4           scalar                                                      
 MPI_ORDER_FORTRAN          Param  478      I(4)            4           scalar                                                      
 MPI_PACKED                 Param  282      I(4)            4           scalar                                                      
 MPI_PROC_NULL              Param  230      I(4)            4           scalar                                                      
 MPI_PROD                   Param  146      I(4)            4           scalar                                                      
 MPI_REAL                   Param  258      I(4)            4           scalar                                                      
 MPI_REAL16                 Param  298      I(4)            4           scalar                                                      
 MPI_REAL4                  Param  294      I(4)            4           scalar                                                      
 MPI_REAL8                  Param  296      I(4)            4           scalar                                                      
 MPI_REPLACE                Param  164      I(4)            4           scalar                                                      
 MPI_REQUEST_NULL           Param  184      I(4)            4           scalar                    441                               
 MPI_ROOT                   Param  236      I(4)            4           scalar                                                      
 MPI_SEEK_CUR               Param  472      I(4)            4           scalar                                                      
 MPI_SEEK_END               Param  474      I(4)            4           scalar                                                      
 MPI_SEEK_SET               Param  470      I(4)            4           scalar                                                      
 MPI_SHORT                  Param  318      I(4)            4           scalar                                                      
 MPI_SHORT_INT              Param  348      I(4)            4           scalar                                                      
 MPI_SIGNED_CHAR            Param  312      I(4)            4           scalar                                                      
 MPI_SIMILAR                Param  136      I(4)            4           scalar                                                      
 MPI_SOURCE                 Param  9        I(4)            4           scalar                                                      
 MPI_STATUSES_IGNORE        Scalar 14       I(4)            4     2     5        COM                                                
 MPI_STATUS_IGNORE          Scalar 13       I(4)            4     1     5        COM                                                
 MPI_STATUS_SIZE            Param  11       I(4)            4           scalar                    13,14                             
 MPI_SUBVERSION             Param  246      I(4)            4           scalar                                                      
 MPI_SUCCESS                Param  18       I(4)            4           scalar                                                      
 MPI_SUM                    Param  144      I(4)            4           scalar                                                      
 MPI_TAG                    Param  9        I(4)            4           scalar                                                      
 MPI_TAG_UB                 Param  190      I(4)            4           scalar                                                      
 MPI_THREAD_FUNNELED        Param  446      I(4)            4           scalar                                                      

Page 232         Source Listing                  PRTTIME
2017-04-18 11:07 Symbol Table                    oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPI_THREAD_MULTIPLE        Param  450      I(4)            4           scalar                                                      
 MPI_THREAD_SERIALIZED      Param  448      I(4)            4           scalar                                                      
 MPI_THREAD_SINGLE          Param  444      I(4)            4           scalar                                                      
 MPI_TYPECLASS_COMPLEX      Param  426      I(4)            4           scalar                                                      
 MPI_TYPECLASS_INTEGER      Param  424      I(4)            4           scalar                                                      
 MPI_TYPECLASS_REAL         Param  422      I(4)            4           scalar                                                      
 MPI_TYPE_DUP_FN            Subr   498                                  scalar                                                      
 MPI_TYPE_NULL_COPY_FN      Subr   499                                  scalar                                                      
 MPI_TYPE_NULL_DELETE_FN    Subr   498                                  scalar                                                      
 MPI_UB                     Param  278      I(4)            4           scalar                                                      
 MPI_UINT16_T               Param  364      I(4)            4           scalar                                                      
 MPI_UINT32_T               Param  366      I(4)            4           scalar                                                      
 MPI_UINT64_T               Param  368      I(4)            4           scalar                                                      
 MPI_UINT8_T                Param  362      I(4)            4           scalar                                                      
 MPI_UNDEFINED              Param  224      I(4)            4           scalar                                                      
 MPI_UNEQUAL                Param  138      I(4)            4           scalar                                                      
 MPI_UNIVERSE_SIZE          Param  198      I(4)            4           scalar                                                      
 MPI_UNSIGNED               Param  324      I(4)            4           scalar                                                      
 MPI_UNSIGNED_CHAR          Param  314      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG          Param  328      I(4)            4           scalar                                                      
 MPI_UNSIGNED_LONG_LONG     Param  338      I(4)            4           scalar                                                      
 MPI_UNSIGNED_SHORT         Param  320      I(4)            4           scalar                                                      
 MPI_UNWEIGHTED             Scalar 490      I(4)            4           scalar   COM                                                
 MPI_VERSION                Param  244      I(4)            4           scalar                                                      
 MPI_WCHAR                  Param  316      I(4)            4           scalar                                                      
 MPI_WIN_BASE               Param  204      I(4)            4           scalar                                                      
 MPI_WIN_DISP_UNIT          Param  208      I(4)            4           scalar                                                      
 MPI_WIN_DUP_FN             Subr   496                                  scalar                                                      
 MPI_WIN_NULL               Param  174      I(4)            4           scalar                                                      
 MPI_WIN_NULL_COPY_FN       Subr   497                                  scalar                                                      
 MPI_WIN_NULL_DELETE_FN     Subr   496                                  scalar                                                      
 MPI_WIN_SIZE               Param  206      I(4)            4           scalar                                                      
 MPI_WTICK                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME                  Func   492      R(8)            8           scalar                                                      
 MPI_WTIME_IS_GLOBAL        Param  196      I(4)            4           scalar                                                      
 MYID                       Local  5096     I(4)            4           scalar                    5096                              
 PADS_A                     Scalar 505      CHAR            1     1     3        COM                                                
 PADS_B                     Scalar 505      CHAR            1     1     3        COM                                                
 PMPI_WTICK                 Func   493      R(8)            8           scalar                                                      
 PMPI_WTIME                 Func   493      R(8)            8           scalar                                                      
 PRTTIME                    Subr   5088                                                                                             
 SECNDS                     Func   5098                                 scalar                    5098,5099,5100                    
 T0                         Local  5092     R(4)            4           scalar   SAVE             5090,5098,5099,5100               
 T1                         Local  5092     R(4)            4           scalar   SAVE             5091,5099,5100                    
 TITLE                      Dummy  5088     CHAR                        scalar   ARG,INOUT        5099                              

Page 233         Source Listing                  PRTTIME
2017-04-18 11:07                                 oiqcbufr.f

  11812 

Page 234         Source Listing                  PRTTIME
2017-04-18 11:07 Subprograms/Common Blocks       oiqcbufr.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHDIST                     Subr   395                                                                                              
 CKLIST                     Common 161                                  4400004                                                     
 CKLIST                     Common 1052                                 4400004                                                     
 CKLIST                     Common 2023                                 4400004                                                     
 CKLIST                     Common 2449                                 4400004                                                     
 CKLIST                     Common 2595                                 4400004                                                     
 CKLIST                     Common 2936                                 4400004                                                     
 CKLIST                     Common 3255                                 4400004                                                     
 CKLIST                     Common 3538                                 4400004                                                     
 CKLIST                     Common 3696                                 4400004                                                     
 CKLIST                     Common 4906                                 4400004                                                     
 CKLIST                     Common 4959                                 4400004                                                     
 CKLIST                     Common 5031                                 4400004                                                     
 COOR1                      Subr   492                                                                                              
 COOR2                      Subr   655                                                                                              
 CORP                       Common 980                                  6768                                                        
 CORP                       Common 2217                                 6768                                                        
 CORP                       Common 2725                                 6768                                                        
 CORP                       Common 3366                                 6768                                                        
 CORP                       Common 3468                                 6768                                                        
 CORP                       Common 3697                                 6768                                                        
 CORP                       Common 3976                                 6768                                                        
 DATAZZ                     Common 1782                                 101004                                                      
 DRCTSL                     Subr   825                                                                                              
 FCRATS                     Common 981                                  252                                                         
 FCRATS                     Common 3367                                 252                                                         
 FCRATS                     Common 3469                                 252                                                         
 FPLIST                     Common 2022                                 4400004                                                     
 GETFCER                    Func   977      R(4)            4           scalar                    993                               
 GETOE                      Common 2504                                 4                                                           
 GETOE                      Common 3977                                 4                                                           
 HVECT                      Common 1429                                 47364                                                       
 HVECT                      Common 2219                                 47364                                                       
 HVECT                      Common 2443                                 47364                                                       
 HVECT                      Common 2719                                 47364                                                       
 HVECT                      Common 3251                                 47364                                                       
 HVECT                      Common 3604                                 47364                                                       
 HVECT                      Common 3700                                 47364                                                       
 JNDD                       Func   5014     I(4)            4           scalar                    5046,5050,5062,5066               
 LTX                        Func   5071     I(4)            4           scalar                    5077,5080,5082                    
 MAKEAMAP                   Subr   1035                                                                                             
 MPIFCMB1                   Common 506                                  20       SAVE                                               
 MPIFCMB2                   Common 507                                  20       SAVE                                               
 MPIFCMB3                   Common 508                                  4        SAVE                                               
 MPIFCMB4                   Common 509                                  4        SAVE                                               
 MPIFCMB5                   Common 510                                  4        SAVE                                               
 MPIFCMB6                   Common 511                                  4        SAVE                                               
 MPIFCMB7                   Common 512                                  4        SAVE                                               
 MPIFCMB8                   Common 513                                  4        SAVE                                               
 MPISPLIT                   Subr   4472                                                                                             
 NDDSPLIT                   Subr   4943                                                                                             

Page 235         Source Listing                  PRTTIME
2017-04-18 11:07 Subprograms/Common Blocks       oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NDDSPT                     Common 2448                                 808                                                         
 NDDSPT                     Common 2594                                 808                                                         
 NDDSPT                     Common 2935                                 808                                                         
 NDDSPT                     Common 3537                                 808                                                         
 NDDSPT                     Common 4905                                 808                                                         
 OBDESC                     Common 2503                                 24000                                                       
 OBERRS                     Common 979                                  25452                                                       
 OBERRS                     Common 1182                                 25452                                                       
 OBERRS                     Common 2502                                 25452                                                       
 OBERRS                     Common 3368                                 25452                                                       
 OBERRS                     Common 3467                                 25452                                                       
 OBERRS                     Common 3975                                 25452                                                       
 OBHEIR                     Common 3006                                 1204                                                        
 OBHEIR                     Common 3369                                 1204                                                        
 OBHEIR                     Common 3471                                 1204                                                        
 OBHEIR                     Common 3539                                 1204                                                        
 OBHEIR                     Common 4164                                 1204                                                        
 OBOGRAM                    Subr   1165                                                                                             
 OBPRT                      Common 1436                                 124                                                         
 OBPRT                      Common 3370                                 164                                                         
 OBPRT                      Common 3470                                 164                                                         
 OBPRT                      Common 3610                                 124                                                         
 OBS                        Common 160                                  11060648                                                    
 OBS                        Common 1051                                 11060648                                                    
 OBS                        Common 1181                                 11060648                                                    
 OBS                        Common 1434                                 11060648                                                    
 OBS                        Common 1781                                 11060648                                                    
 OBS                        Common 2010                                 7460648                                                     
 OBS                        Common 2724                                 11060648                                                    
 OBS                        Common 2937                                 11060648                                                    
 OBS                        Common 3005                                 11060648                                                    
 OBS                        Common 3609                                 11060648                                                    
 OBS                        Common 3698                                 11060648                                                    
 OBS                        Common 3974                                 11060648                                                    
 OBS                        Common 4163                                 11060648                                                    
 OBS                        Common 4502                                 11060648                                                    
 OBS                        Common 4666                                 11060648                                                    
 OBS                        Common 5030                                 11060648                                                    
 OIQCDATA                   Common 150                                  22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 1040                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 1170                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 1419                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 1770                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 2011                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 2199                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 2583                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 2708                                 22790000                                                    

Page 236         Source Listing                  PRTTIME
2017-04-18 11:07 Subprograms/Common Blocks       oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                        0                                                           
 OIQCDATA                   Common 2919                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 2995                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 3174                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 3240                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 3593                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 3685                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 3963                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 4152                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 4492                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 4655                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 4948                                 22790000                                                    
                                                                        0                                                           
 OIQCDATA                   Common 5019                                 22790000                                                    
                                                                        0                                                           
 OUTPUT                     Subr   1414                                                                                             
 PILNLNP                    Func   1701     R(4)            4           scalar                    1724                              
 PREPOBS_OIQCBUFR           Prog   145                                                                                              
 PREPQM                     Subr   1765                                                                                             
 PRTTIME                    Subr   5088                                                                                             
 QCLOOP                     Subr   2005                                                                                             
 QCOI                       Subr   2194                                                                                             
 QCPTS                      Subr   2439                                                                                             
 RDOBER                     Subr   2500                                                                                             
 RETCODE                    Common 163                                  4                                                           
 RETCODE                    Common 4165                                 4                                                           
 SATCOR                     Common 2726                                 80                                                          
 SATCOR                     Common 3472                                 80                                                          
 SATPTS                     Subr   2578                                                                                             
 SATPUT                     Subr   2703                                                                                             
 SEARCH                     Subr   2914                                                                                             
 SEARCHS                    Subr   2990                                                                                             
 SELDAT                     Subr   3235                                                                                             
 SETCON                     Subr   3364                                                                                             
 SETCONS                    Block  3465                                 scalar                                                      
 SRTPRS                     Subr   3169                                                                                             
 SSMIPTS                    Subr   3533                                                                                             
 SSMIPUT                    Subr   3588                                                                                             
 SSMISRCH                   Subr   3680                                                                                             
 STOERR                     Subr   3958                                                                                             
 STORE                      Subr   4147                                                                                             
 SYNCNDD                    Subr   4901                                                                                             
 SYNCSTOR                   Subr   4487                                                                                             
 TOLLER                     Common 1435                                 24                                                          
 TOLLER                     Common 2024                                 24                                                          

Page 237         Source Listing                  PRTTIME
2017-04-18 11:07 Subprograms/Common Blocks       oiqcbufr.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TOLLER                     Common 2727                                 24                                                          
 TOSSLIST                   Subr   4650                                                                                             
 TOSSUNIT                   Common 162                                  4                                                           
 TOSSUNIT                   Common 1437                                 4                                                           
 TOSSUNIT                   Common 2025                                 4                                                           
 TOSSUNIT                   Common 2728                                 4                                                           
 TRIGS                      Common 3007                                 5212                                                        
 TRIGS                      Common 3371                                 5212                                                        
 VSOLVE                     Subr   4810                                                                                             

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape
       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64

Page 238         Source Listing                  PRTTIME
2017-04-18 11:07                                 oiqcbufr.f

       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g0
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/mkl/include/,/usr/local/include/,.f,./.f,/opt/ibmhpc/pe13012/mpich2/intel/include64/.f,
           /opt/ibmhpc/pe13012/base/include64/.f,/usrx/local/intel/2016SP3/ipp/include/.f,/usrx/local/intel/2016SP3/mkl/include/.f,
           /usrx/local/intel/2016SP3/tbb/include/.f,/usrx/local/intel/2016SP3/daal/include/.f,/gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.f,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.f,/usr/local/include/.f,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.f,/usr/include/.f,/usr/include/.f,/usr/include/.f
       -list filename : oiqcbufr.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
