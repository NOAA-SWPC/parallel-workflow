Page 1           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

      1 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      2 C
      3 C SUBPROGRAM:    W3XTOVSEDS
      4 C   PRGMMR: KEYSER           ORG: NP22       DATE: 2014-11-25
      5 C
      6 C ABSTRACT: READS AND UNPACKS ONE REPORT FROM INPUT RTOVS OR ATOVS
      7 C   RETRIEVAL BUFR (DUMP) FILE INTO SPECIFIED FORMAT. RETURNS
      8 C   INFORMATION IN THE FORMAT OF AN UNPACKED NMCEDS FILE. ONLY THOSE
      9 C   ELEMENTS OF NMCEDS NEEDED BY THE PREPDATA PROGRAM ARE ACTUALLY
     10 C   PROCESSED INTO NMCEDS FORMAT, THE REMAINING WORDS OF THE 140-WORD
     11 C   ARRAY ARE SET TO 7777 "MISSING". THERE IS SOME OTHER RETRIEVAL
     12 C   INFORMATION RETURNED. ALSO, INFORMATION ABOUT THE INPUT DATA SET
     13 C   ITSELF (NAME, CENTER DATE, DUMP TIME) IS RETURNED.
     14 C
     15 C PROGRAM HISTORY LOG:
     16 C 1998-03-10  BERT B. KATZ
     17 C 1998-05-05  D.A. KEYSER/NP22 -- STREAMLINED, CORRECTED ERRORS
     18 C 1998-06-15  D.A. KEYSER/NP22 -- ADDED CALL TO W3FI04 FIRST TIME IN
     19 C      TO OBTAIN MACHINE WORD LENGTH (USED TO HARDWIRE WORD LENGTH
     20 C      OF 8 BYTES AS USED IN XMOVEX SUBROUTINE); FILTER FLAG RETURNED
     21 C      IN IBUFTN(20) NOW HAS SAME MEANING AS FOR TOVS (250KM SUB-
     22 C      SAMPLING), IT'S ACTUAL VALUE IS NOW RETURNED (WAS HARDWIRED
     23 C      TO 0)
     24 C 1998-09-21  D.A. KEYSER/NP22 -- SUBROUTINE NOW Y2K AND FORTRAN 90
     25 C      COMPLIANT
     26 C 1999-01-20 D. A. KEYSER -- INCORPORATED BOB KISTLER'S CHANGES NEEDED
     27 C      TO PORT THE CODE TO THE IBM SP
     28 C 1999-11-02  D. A. KEYSER -- CHANGES TO MAKE CODE MORE PORTABLE
     29 C 1999-11-19  D. A. KEYSER -- INCLUDES NOAA-15 ATOVS DATA (AS WELL AS
     30 C      RTOVS DATA)
     31 C 2000-02-17 D. A. KEYSER -- IF DATE OF INPUT FILE IS PRIOR TO
     32 C      7/1/1998 (CAN ONLY BE RTOVS), THEN DOES NOT USE "TOFF" TO GET
     33 C      FILTER FLAG (NOT VALID AT THIS TIME), RATHER SETS OUTPUT
     34 C      FILTER FLAG TO "-99" WHICH ALERTS CALLING PROGRAM TO PROCESS
     35 C      ONLY EVERY 4'TH RTOVS RETRIEVAL AND EVERY 11'TH ATOVS RETRIEVAL
     36 C      TO SIMULATE 250KM SAMPLING (NEEDED FOR HISTORICAL CDAS RUNS)
     37 C 2000-12-05  D.A. KEYSER/NP22 -- ACCOUNTS FOR NESDIS ERROR IN SCALING
     38 C      BOTTOM PRESSURE VALUE (AND WILL STILL WORK RIGHT IF THEY FIX
     39 C      IT);  PERFORMS A SANITY CHECK ON THE BOTTOM PRESSURE VALUE
     40 C      (ATOVS ONLY); IF FILTER FLAG NOT FOUND FOR ATOVS, SET OUTPUT
     41 C      FILTER FLAG TO "-99" WHICH ALERTS CALLING PROGRAM TO PROCESS
     42 C      ONLY EVERY 11'TH RETRIEVAL TO SIMULATE 250KM SAMPLING (NEEDED
     43 C      FOR CDAS RUNS), WAS SET TO 0
     44 C 2001-07-16  D.A. KEYSER/NP22 -- CONSIDERS ATOVS RETRIEVALS WITH BOTH
     45 C      CLEAR AND CLOUDY BIT "OFF" (=0) IN SATELLITE DATA PROCESSING
     46 C      TECHNIQUE TO BE CLOUDY (BEFORE THEY WERE UNKNOWN - RTOVS ARE
     47 C      STILL UNKNOWN IN THIS CASE)
     48 C 2008-03-10  D.A. KEYSER/NP22 -- HANDLES METOP-2 SATELLITE (BUFR
     49 C      SATELLITE ID 004)
     50 C 2012-11-30  J. WOOLLEN      --  INITIAL PORT TO WCOSS; RESET BMISS TO
     51 C      A VALUE (10E08) WHICH WILL NOT CAUSE INTEGER OVERFLOW WHICH CAN
     52 C      BE UNPREDICTABLE (PRIOR BMISS VALUE WAS 10E10)
     53 C 2013-02-14  D. A. KEYSER -- FINAL CHANGES TO RUN ON WCOSS;  OBTAIN
     54 C      VALUE OF BMISS SET IN CALLING PROGRAM VIA CALL TO BUFRLIB
     55 C      ROUTINE GETBMISS RATHER THAN HARDWIRING IT TO 10E08 (OR 10E10);
     56 C      USE BUFRLIB FUNCTION IBFMS TO DETERMINE IF A VARIABLE READ FROM
     57 C      BUFR FILE IS MISSING (I.E. RETURNED AS BMISS); ADDED BMISS AS

Page 2           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

     58 C      INPUT ARGUMENT TO SUBROUTINE XTOVSEDS02; USE FORMATTED PRINT
     59 C      STATEMENTS WHERE PREVIOUSLY UNFORMATTED PRINT WAS USED (WCOSS
     60 C      SPLITS UNFORMATTED PRINT AT 80 CHARACTERS)
     61 C 2014-11-25  D. A. KEYSER -- HANDLES NEW SATELLITES METOP-1 (BUFR
     62 C      SATELLITE ID 3, CONVERTED TO LOCAL SATELLITE ID 10), NOAA-19
     63 C      (BUFR SATELLITE ID 223, CONVERTED TO LOCAL SATELLITE ID 9), AND
     64 C      NPP (BUFR SATELLITE ID 224, CONVERTED TO LOCAL SATELLITE ID 11);
     65 C      NOW ENCODES BUFR SATELLITE ID VALUE (CODE TABLE 0-01-007) INTO
     66 C      IBUFTN(2) (PREVIOUSLY A SPARE SET TO MISSING) FOR DIRECT USE BY
     67 C      SUBROUTINE W3CNVXTOVS
     68 C
     69 C USAGE :   CALL W3XTOVSEDS(IUNIT,IBDATE,IBUFTN,ISATOB,PBOT,DSNAME,
     70 C                           IDSDAT,IDSDMP_8,IERR)
     71 C   INPUT ARGUMENT LIST:
     72 C     IUNIT    - UNIT NUMBER OF INPUT FILE CONTAINING RETRIEVAL DATA
     73 C              - IN BUFR FORMAT.
     74 C     DSNAME   - CHARACTER*8 DATA SET NAME (SAME FOR ALL REPORTS IN
     75 C              - A COMMON INPUT DATA SET - SEE REMARKS FOR IERR=1)
     76 C              - (NOTE: ONLY DEFINED AFTER FIRST CALL TO THIS
     77 C              - SUBROUTINE)
     78 C
     79 C   OUTPUT ARGUMENT LIST:
     80 C     IBDATE   - DATE IN SECTION 1 OF BUFR MESSAGE CONTAINING THIS
     81 C              - RETRIEVAL (IN FORM YYYYMMDDHH)
     82 C     IBUFTN   - CONTAINS A SINGLE DECODED RETRIEVAL IN NMCEDS FORMAT
     83 C              - (140 MACHINE WORD LENGTH INTEGER WORDS)
     84 C     ISATOB   - 3-WORD INTEGER ARRAY CONTAINING RETURNED DATA
     85 C              - (SEE REMARKS FOR CONTENTS)
     86 C     PBOT     - FIRST ABOVE-GROUND RTOVS/ATOVS PRESSURE LEVEL IN MB
     87 C              - (MISSING IS 99999.)
     88 C     DSNAME   - CHARACTER*8 DATA SET NAME (SAME FOR ALL REPORTS IN
     89 C              - A COMMON INPUT DATA SET - SEE REMARKS FOR IERR=1)
     90 C     IDSDAT   - INTEGER DATA SET CENTER DATE IN FORM YYYYMMDDHH (SAME
     91 C              - FOR ALL REPORTS IN A COMMON INPUT DATA SET - SEE
     92 C              - REMARKS FOR IERR=1)
     93 C     IDSDMP_8 - INTEGER*8 DATA SET DUMP TIME IN FORM YYYYMMDDHHMM
     94 C              - (SAME FOR ALL REPORTS IN A COMMON INPUT DATA SET - SEE
     95 C              - REMARKS FOR IERR=1)
     96 C     IERR     - ERROR RETURN CODE
     97 C                 =  0 OBSERVATION READ AND UNPACKED INTO LOCATIONS
     98 C                        'IBUFTN', 'ISATOB', AND 'PBOT'.  SEE REMARKS
     99 C                        FOR CONTENTS. NEXT CALL TO W3XTOVSEDS WILL
    100 C                        RETURN NEXT OBSERVATION IN DATA SET.
    101 C                 =  1 INFORMATION ABOUT THE BUFR DATASET IS RETURNED
    102 C                        IN THE OUTPUT ARGUMENTS DSNAME, IDSDAT,
    103 C                        IDSDMP_8 (SEE OUTPUT ARGUMENT LIST ABOVE)
    104 C
    105 C                        THIS SHOULD ALWAYS OCCUR AFTER THE FIRST CALL
    106 C                        TO THIS SUBROUTINE.  NO REPORT IS UNPACKED AT
    107 C                        THIS POINT, AND ONLY DSNAME, IDSDAT, AND
    108 C                        IDSDMP_8 CONTAIN INFORMATION.  ALL SUBSEQUENT
    109 C                        CALLS TO W3XTOVSEDS SHOULD RETURN THE
    110 C                        OBSERVATIONS IN THIS DATA SET, SEQUENTIALLY,
    111 C                        (IERR=0) UNTIL THE END OF FILE IS ENCOUNTERED
    112 C                        (IERR=2).  THE VALUES STORED IN DSNAME,
    113 C                        IDSDAT, AND IDSDMP_8 WILL CONTINUE TO BE
    114 C                        RETURNED ALONG WITH EACH REPORT WHEN IERR = 0.

Page 3           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    115 C                 =  2 FOR NORMAL END-OF-FILE ENCOUNTERED.)
    116 C                 = -1 FOR END-OF-FILE ON FIRST READ -- EMPTY FILE
    117 C                 = -2 FOR INPUT BUFR FILE NOT Y2K COMPLIANT -- NO
    118 C                        PROCESSING DONE
    119 C                 = -3 CENTER DATE COULD NOT BE OBTAINED FROM INPUT
    120 C                        FILE -- NO PROCESSING DONE
    121 C
    122 C   INPUT FILES:
    123 C     UNIT "IUNIT" - FILE CONTAINING BUFR RTOVS OR ATOVS DATA
    124 C
    125 C   OUTPUT FILES:
    126 C     UNIT 06 - STANDARD OUTPUT PRINT
    127 C
    128 C   SUBPROGRAMS CALLED:
    129 C     UNIQUE        - XTOVSEDS02 WORDLENGTH
    130 C     LIBRARY:
    131 C       W3NCO       - GBYTES   W3DIFDAT
    132 C       BUFRLIB     - DATELEN  DUMPBF   OPENBF   READMG   READSB
    133 C                   - UFBINT   UFBREP   CLOSBF   GETBMISS IBFMS
    134 C
    135 C REMARKS:
    136 C
    137 C     CONTENTS OF OUTPUT ARGUMENT IBUFTN {140 INTEGER WORDS - IN NMCEDS
    138 C       FORMAT EXCEPT WHERE NOTED -- ONLY THE WORDS NOTED BELOW
    139 C       ARE FILLED WITH DATA (THAT NEEDED BY THE PREPDATA PROGRAM) -
    140 C       ALL OTHER WORDS ARE SET TO MISSING - 7777)}:
    141 C        WORD 1 - "Local" or "NESDIS" Satellite ID:
    142 C                   NOAA-08 -----  6
    143 C                   NOAA-09 -----  7
    144 C                   NOAA-10 -----  8
    145 C                   NOAA-11 -----  1
    146 C                   NOAA-12 -----  2
    147 C                   NOAA-14 -----  3
    148 C                   NOAA-15 -----  4
    149 C                   NOAA-16 -----  5
    150 C                   NOAA-17 -----  6
    151 C                   NOAA-18 -----  7
    152 C                   NOAA-19 -----  9
    153 C                   METOP-1(B) -- 10
    154 C                   METOP-2(A) --  8
    155 C                   NPP --------- 11
    156 C        * -  2 - BUFR Satellite ID (from Code Table 0-01-007):
    157 C                   NOAA-08 ---- 200
    158 C                   NOAA-09 ---- 201
    159 C                   NOAA-10 ---- 202
    160 C                   NOAA-11 ---- 203
    161 C                   NOAA-12 ---- 204
    162 C                   NOAA-14 ---- 205
    163 C                   NOAA-15 ---- 206
    164 C                   NOAA-16 ---- 207
    165 C                   NOAA-17 ---- 208
    166 C                   NOAA-18 ---- 209
    167 C                   NOAA-19 ---- 223
    168 C                   METOP-1(B) -   3
    169 C                   METOP-2(A) -   4
    170 C                   NPP -------- 224
    171 C             3 - Day of month * 256 plus hour of day (UTC)

Page 4           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    172 C             4 - Minute * 256 plus second (UTC)
    173 C             5 - Latitude (degrees * 100, N+, S-)
    174 C             6 - Longitude (degrees * 100, E+, W-)
    175 C             8 - Land/sea indicator (Land - elev in meters, Sea - 0)
    176 C             9 - Surface (skin) temperature (K * 10)
    177 C            12 - Retrieval method
    178 C        * - 16 - Nadir proximity indicator (Range: 1-9, where 1
    179 C                  is at Nadir and 9 is at limb)
    180 C            20 - Filter Flag {good = 0; redundant = 1;
    181 C                  prior to 07/01/1998 (RTOVS) or missing (ATOVS only)
    182 C                  = -99}
    183 C            23 - Layer 1 - pressure at lower boundary (mb * 10)
    184 C            24 - Layer 1 - pressure at upper boundary (mb * 10)
    185 C            25 - Layer 1 - mean virtual temperature (K * 10)
    186 C            26 - Layer 1 - always missing (7777)
    187 C            27 - 82 - Repeat 23-27 for Layers 2 - 15
    188 C
    189 C        * - Definition changed from original NMCEDS documentation
    190 C         Missings are set to 7777
    191 C
    192 C     CONTENTS OF OUTPUT ARGUMENT ISATOB (3 INTEGER WORDS) FOR EACH
    193 C      RETRIEVAL:
    194 C        WORD  1 - ORBIT NUMBER
    195 C              2 - DAY/NIGHT QUALIFIER (=0 FOR NIGHT)
    196 C                                      (=1 FOR DAY)
    197 C                                      (BUFR C.T. 0-08-013)
    198 C              3 - SNOW/ICE FLAGS (TERRAIN TYPE)
    199 C                                      (RTOVS: BUFR C.T. 0-13-209)
    200 C                                      (ATOVS: BUFR C.T. 0-13-039)
    201 C         Missings are set to XMISS (99999.)
    202 C
    203 C ATTRIBUTES:
    204 C   LANGUAGE: FORTRAN 90
    205 C   MACHINE:  NCEP WCOSS
    206 C
    207 C$$$
    208       SUBROUTINE W3XTOVSEDS(IUNIT,IBDATE,IBUFTN,ISATOB,PBOT,DSNAME,
    209      $ IDSDAT,IDSDMP_8,IERR)
    210 
    211       DATA IFIRST/0/,JFIRST/0/,IUNITL/-99/,KOUNTR/0/,LWI/0/,LWR/0/,
    212      $ ITOFF/0/, MFIRST/0/,nfirst/0/
    213 
    214       REAL GEOOPR(18),TLAYER(15),PLAYER(16),RINC(5)
    215 
    216       INTEGER IBUFTN(140),ISATOB(3),JDATE(5),JDUMP(5),IBIT(2)
    217 
    218       INTEGER(8) IDSDMP_8,JDUMP_8(5),KDATE(8),LDATE(8)
    219 
    220       CHARACTER*8 SUBSET,DSNAME
    221       DATA NUMLVL/0/,ISTLVL/0/
    222 
    223       CHARACTER*50 IDTSTR
    224       DATA IDTSTR/'FOVN SAID CLAT CLON DAYS HOUR MINU SECO ORBN DNQL '/
    225 
    226       CHARACTER*10 IDTST2
    227       DATA IDTST2/'TOFF OBQL '/
    228 

Page 5           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    229       CHARACTER*10 SATSTR
    230       DATA SATSTR/'SDPT LSQL '/
    231 
    232       CHARACTER*20 SRFSTR
    233       DATA SRFSTR/'PRES SELV TERR TERN '/
    234 
    235       CHARACTER*12 RTVSTR,ATVSTR
    236       DATA RTVSTR/'TMDB   MIXR '/
    237       DATA ATVSTR/'TMDBST MIXR '/
    238 
    239       REAL(8) XIDENT_8(12),SATDAT_8(2),SRFDAT_8(4),RETDAT_8(2,41),
    240      $        AMAXIMUM_8,WOPR_8(15),TMP_8,TMPOPR_8(40)
    241       REAL(8) BMISS,GETBMISS
    242 
    243       REAL TOVLEV(40)
    244 
    245       SAVE
    246 
    247       DATA TOVLEV/0.1,0.2,0.5,1.0,1.5,2.0,3.0,4.0,5.0,7.0,10.0,15.0,
    248      $            20.0,25.0,30.0,50.0,60.0,70.0,85.0,100.0,115.0,135.0,
    249      $            150.0,200.0,250.0,300.0,350.0,400.0,430.0,475.0,500.0,
    250      $            570.0,620.0,670.0,700.0,780.0,850.0,920.0,950.0,
    251      $            1000.0/
    252       DATA  XMISS/99999./,IMISS/99999/
    253 
    254 C  FCN PR GETS STD. ATMOS. PRESSURE (MB) FROM HEIGHT (M) (HGHT < 11000M)
    255 C  ---------------------------------------------------------------------
    256 
    257       PR(HGHT) = 1013.25 * (((288.15 - (.0065 * HGHT))/288.15)**5.256)
    258 
    259       IF(IFIRST.EQ.0) THEN
    260 
    261 C  FIRST TIME IN, SET DATELEN, GET WORDLENGTH FOR INTEGERS AND REALS,
    262 C   AND GET VALUE FOR "BMISS"
    263 C  ------------------------------------------------------------------
    264 
    265          IFIRST = 1
    266          call datelen(10)
    267          CALL WORDLENGTH(LWI,LWR)
    268          PRINT 678, LWI,LWR
    269   678 FORMAT('  ===> W3XTOVEDS: MACHINE WORD LENGTH: INTEGERS - ',I1,
    270      $ '; REALS - ',I1/)
    271 
    272       END IF
    273 
    274       IF(IUNIT.NE.IUNITL)  JFIRST = 0
    275       IF(IUNIT.NE.IUNITL)  MFIRST = 0
    276       IF(IUNIT.NE.IUNITL)  NFIRST = 0
    277 
    278 
    279       IF(JFIRST.EQ.0) THEN
    280 
    281 C  FIRST TIME IN FOR A NEW INPUT FILE, GET CENTER AND DUMP TIME FOR
    282 C   FILE AND TEST FOR CENTER FILE DATE PRIOR TO 07/01/1998
    283 C  -----------------------------------------------------------------
    284 
    285          PRINT'("  ==> W3XTOVSEDS -- WCOSS VERSION 11-25-2014")'

Page 6           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    286          JFIRST = 1
    287          IUNITL = IUNIT
    288          CALL DUMPBF(IUNIT,JDATE,JDUMP)
    289          print'(" CENTER DATE (JDATE) = ",5(I0,1X))', jdate
    290          print'(" DUMP DATE   (JDUMP) = ",5(I0,1X))', jdump
    291          print'(1X)'
    292          IF(JDATE(1).LE.0)  then
    293             PRINT'(" ##W3XTOVSEDS - CENTER DATE COULD NOT BE OBTAINED ",
    294      $       "FROM INPUT FILE ON UNIT ",I0," -- IERR = -3")', IUNIT
    295             ierr = -3
    296             return
    297          END IF
    298          IF(JDATE(1).LT.100)  THEN
    299 
    300 C IF 2-DIGIT YEAR RETURNED IN JDATE(1), MUST USE "WINDOWING" TECHNIQUE
    301 C  TO CREATE A 4-DIGIT YEAR
    302 
    303 C IMPORTANT: IF DATELEN(10) IS CALLED, THE DATE HERE SHOULD ALWAYS
    304 C            CONTAIN A 4-DIGIT YEAR, EVEN IF INPUT FILE IS NOT
    305 C            Y2K COMPLIANT (BUFRLIB DOES THE WINDOWING HERE)
    306 
    307             PRINT'(" ##W3XTOVSEDS - THE FOLLOWING SHOULD NEVER ",
    308      $       "HAPPEN!!!!!")'
    309             PRINT'(" ##W3XTOVSEDS - 2-DIGIT YEAR IN JDATE(1) RETURNED ",
    310      $       "FROM DUMPBF (JDATE IS: ",I5,4I3,") - USE WINDOWING ",
    311      $       "TECHNIQUE TO OBTAIN 4-DIGIT YEAR")', JDATE
    312             IF(JDATE(1).GT.20)  THEN
    313                JDATE(1) = 1900 + JDATE(1)
    314             ELSE
    315                JDATE(1) = 2000 + JDATE(1)
    316             ENDIF
    317             PRINT'(" ##W3XTOVSEDS - CORRECTED JDATE(1) WITH 4-DIGIT ",
    318      $       "YEAR, JDATE NOW IS: ",I5,4I3)', JDATE
    319          ENDIF
    320          IDSDAT = JDATE(1)*1000000+JDATE(2)*10000+JDATE(3)*100+JDATE(4)
    321          IF(JDUMP(1).LE.0)  THEN
    322             IDSDMP_8 = 999999999999_8
    323          ELSE
    324             IF(JDUMP(1).LT.100)  THEN
    325 
    326 C IF 2-DIGIT YEAR RETURNED IN JDUMP(1), MUST USE "WINDOWING" TECHNIQUE
    327 C  TO CREATE A 4-DIGIT YEAR
    328 
    329 C IMPORTANT: IF DATELEN(10) IS CALLED, THE DATE HERE SHOULD ALWAYS
    330 C            CONTAIN A 4-DIGIT YEAR, EVEN IF INPUT FILE IS NOT
    331 C            Y2K COMPLIANT (BUFRLIB DOES THE WINDOWING HERE)
    332 
    333                PRINT'(" ##W3XTOVSEDS - THE FOLLOWING SHOULD NEVER ",
    334      $          "HAPPEN!!!!!")'
    335                PRINT'(" ##W3XTOVSEDS - 2-DIGIT YEAR IN JDUMP(1) ",
    336      $          "RETURNED FROM DUMPBF (JDUMP IS: ",I5,4I3,") - USE ",
    337      $          "WINDOWING TECHNIQUE TO OBTAIN 4-DIGIT YEAR")', JDUMP
    338                IF(JDUMP(1).GT.20)  THEN
    339                   JDUMP(1) = 1900 + JDUMP(1)
    340                ELSE
    341                   JDUMP(1) = 2000 + JDUMP(1)
    342                ENDIF

Page 7           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    343                PRINT'(" ##W3XTOVSEDS - CORRECTED JDUMP(1) WITH 4-DIGIT",
    344      $          " YEAR, JDUMP NOW IS: ",I5,4I3)', JDUMP
    345             END IF
    346             JDUMP_8 = JDUMP
    347             IDSDMP_8 = JDUMP_8(1)*100000000+JDUMP_8(2)*1000000+
    348      $       JDUMP_8(3)*10000+JDUMP_8(4)*100+JDUMP_8(5)
    349          ENDIF
    350 c-----------------------------------------------------------------------
    351 c This logic is needed only because SUBSET is not returned in DUMPBF
    352 c  and we need it in order to return dsname - after dsname is retrieved
    353 c  close data set ..
    354          call openbf(iunit,'IN',iunit)
    355          call readmg(iunit,subset,ibdate,iret)
    356          if(subset.eq.'NC003102')  then
    357             dsname = 'RTOVS   '
    358             numlvl = 40
    359             istlvl =  1
    360          else if(subset.eq.'NC003104')  then
    361             dsname = 'ATOVS   '
    362             numlvl = 41
    363             istlvl =  2
    364          else
    365             dsname = '????????'
    366          end if
    367          call closbf(iunit)
    368 c-----------------------------------------------------------------------
    369          KDATE(1:3) = JDATE(1:3)
    370          KDATE(4)   = 0
    371          KDATE(5:6) = JDATE(4:5)
    372          KDATE(7:8) = 0
    373          LDATE(1)   = 1998
    374          LDATE(2)   = 07
    375          LDATE(3)   = 01
    376          LDATE(4:8) = 0
    377          CALL W3DIFDAT(KDATE,LDATE,1,RINC)
    378          IF(RINC(1).LT.0.0)  THEN
    379             WRITE(6,3004)
    380  3004       FORMAT(/'##W3XTOVSEDS - DATE OF INPUT FILE IS PRIOR TO ',
    381      $       '07/01/1998 - VALUE IN "TOFF" NOT RELATED TO FILTER FLAG ',
    382      $       'SO SET'/15X,'OUTPUT FILTER FLAG TO -99 FOR ALL REPORTS'/)
    383             ITOFF = 1
    384          END IF
    385 c-----------------------------------------------------------------------
    386 
    387 C  GET VALUE FOR "BMISS"
    388 C  --------------------
    389 
    390          BMISS = GETBMISS()
    391          print'(1X)'
    392          print'(" BUFRLIB value for missing passed into W3XTOVSEDS is:",
    393      $    1X,G0)', bmiss
    394          print'(1X)'
    395 c-----------------------------------------------------------------------
    396 
    397          IERR = 1
    398          RETURN
    399       ELSE  IF(JFIRST.EQ.1) THEN

Page 8           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    400 
    401 C  SECOND TIME IN FOR A NEW INPUT FILE , OPEN BUFR DATASET FOR INPUT
    402 C   AND DECODE FIRST MESSAGE
    403 C  -----------------------------------------------------------------
    404 
    405          JFIRST = 2
    406          CALL OPENBF(IUNIT,'IN',IUNIT)
    407          CALL READMG(IUNIT,SUBSET,IBDATE,IRET)
    408          IF(IRET.NE.0) THEN
    409             WRITE(6,1009) IUNIT
    410  1009       FORMAT('##W3XTOVSEDS ERROR: EMPTY FILE IN UNIT ',I5)
    411             IERR = -1
    412             RETURN
    413          ENDIF
    414          IF(IBDATE.LT.100000000)  THEN
    415 c IF INPUT BUFR FILE DOES NOT RETURN MESSAGES WITH A 4-DIGIT YEAR,
    416 c  SOMETHING IS WRONG (EVEN NON-COMPLIANT BUFR MESSAGES SHOULD
    417 c  CONSTRUCT A 4-DIGIT YEAR AS LONG AS DATELEN(10) HAS BEEN CALLED
    418             WRITE(6,1209) IUNIT
    419  1209       FORMAT('##W3XTOVSEDS ERROR: A 10-DIGIT SECT. 1 BUFR ',
    420      $       'MESSAGE DATE WAS NOT RETURNED IN UNIT',I5,' - PROBLEM ',
    421      $       'WITH BUFR FILE')
    422             IERR = -2
    423             RETURN
    424          END IF
    425 
    426       ENDIF
    427 
    428  1000 CONTINUE
    429 
    430 C  EACH CALL TO READSB INCREASES "KOUNTR" BY 1 (REGARDLESS OF RESULT)
    431 C  ------------------------------------------------------------------
    432 
    433       KOUNTR = KOUNTR + 1
    434 
    435       CALL READSB(IUNIT,IRET)
    436       IF(IRET.NE.0) THEN
    437          CALL READMG(IUNIT,SUBSET,IBDATE,IRET)
    438          IF(IRET.NE.0) THEN
    439 
    440 C  ALL BUFR MESSAGES HAVE BEEN READ AND DECODED -- ALL DONE
    441 C  --------------------------------------------------------
    442 
    443             WRITE(6,1001) IUNIT
    444  1001 FORMAT(//' ==> W3XTOVSEDS: END OF FILE ON UNIT',I3,' -- ALL DONE'
    445      $ /)
    446             IERR = 2
    447             RETURN
    448          ENDIF
    449          IF(IBDATE.LT.100000000)  THEN
    450 c IF INPUT BUFR FILE DOES NOT RETURN MESSAGES WITH A 4-DIGIT YEAR,
    451 c  SOMETHING IS WRONG (EVEN NON-COMPLIANT BUFR MESSAGES SHOULD
    452 c  CONSTRUCT A 4-DIGIT YEAR AS LONG AS DATELEN(10) HAS BEEN CALLED
    453             WRITE(6,1209) IUNIT
    454             IERR = -2
    455             RETURN
    456          END IF

Page 9           Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    457          GO TO 1000
    458       ENDIF
    459 
    460       IBUFTN = 7777
    461 cppppp
    462 cdak  print'(" INITIALLY -- IBUFTN = .....")'
    463 cdak  print, IBUFTN
    464 cppppp
    465 
    466       PBOT = XMISS
    467       ISATOB = IMISS
    468 
    469       XIDENT_8 = BMISS
    470       CALL UFBINT(IUNIT,XIDENT_8,12, 1,IRET,IDTSTR//IDTST2)
    471 
    472       SATDAT_8 = BMISS
    473       CALL UFBINT(IUNIT,SATDAT_8,2, 1,IRET,SATSTR)
    474 
    475       SRFDAT_8 = BMISS
    476       CALL UFBINT(IUNIT,SRFDAT_8,4, 1,IRET,SRFSTR)
    477 
    478       RETDAT_8 = BMISS
    479       IF(DSNAME.EQ.'RTOVS   ')  THEN
    480          CALL UFBINT(IUNIT,RETDAT_8,2,40,NLEV,RTVSTR)
    481       ELSE
    482          CALL UFBREP(IUNIT,RETDAT_8,2,41,NLEV,ATVSTR)
    483       END IF
    484 
    485 C  NADIR PROXIMITY INDICATOR {IBUFTN(16)}
    486 C  --------------------------------------
    487 
    488       IF(IBFMS(XIDENT_8(1)).EQ.0)  THEN
    489          NADIR = INT(ABS(FLOAT(NINT(XIDENT_8(1))) - 28.5)) / 3
    490          IF(NADIR.LT.9) NADIR = NADIR + 1
    491       ENDIF
    492       IF(NADIR.GT.0.AND.NADIR.LT.10)  THEN
    493          IBUFTN(16) = NADIR
    494       ELSE
    495          WRITE(6,2070) KOUNTR,NADIR
    496  2070 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    497      $ ' AN INVALID NADIR PROX. IND. (=',I5,') - SKIP IT')
    498          GO TO 1000
    499       ENDIF
    500 
    501 C  BUFR SATELLITE IDENTIFIER (CODE TABLE 0-01-007) - IBUFTN(2)
    502 C  -----------------------------------------------------------
    503 C  LOCAL OR NESDIS SATELLITE IDENTIFIER -- IBUFTN(1)
    504 C  -------------------------------------------------
    505 
    506       IF(IBFMS(XIDENT_8(2)).EQ.0)  THEN
    507          IBUFTN(2) = XIDENT_8(2)
    508          IF(NINT(XIDENT_8(2)).EQ.4)  THEN
    509             IBUFTN(1) =  8  ! METOP-A(2)
    510          ELSE IF(NINT(XIDENT_8(2)).EQ.223) THEN
    511             IBUFTN(1) =  9  ! NOAA-19
    512          ELSE IF(NINT(XIDENT_8(2)).EQ.3)  THEN
    513             IBUFTN(1) = 10  ! METOP-B(1)

Page 10          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    514          ELSE IF(NINT(XIDENT_8(2)).EQ.224)  THEN
    515             IBUFTN(1) = 11  ! NPP
    516          ELSE IF(NINT(XIDENT_8(2)).GT.199.AND.
    517      $           NINT(XIDENT_8(2)).LT.203)  THEN
    518             IBUFTN(1) = NINT(XIDENT_8(2)) - 194
    519                             ! NOAA-08 to 10
    520          ELSE IF(NINT(XIDENT_8(2)).GT.202.AND.
    521      $           NINT(XIDENT_8(2)).LT.210) THEN
    522                             ! NOAA-11 to 18
    523             IBUFTN(1) = NINT(XIDENT_8(2)) - 202
    524          ELSE
    525             WRITE(6,2071) KOUNTR,IBUFTN(2)
    526  2071 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    527      $ ' AN UNRECOGNIZED BUFR SATELLITE ID (=',I7,') - SKIP IT')
    528             GO TO 1000
    529          ENDIF
    530       ELSE
    531          WRITE(6,2072) KOUNTR
    532  2072 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    533      $ ' A MISSING BUFR SATELLITE ID - SKIP IT')
    534          GO TO 1000
    535       ENDIF
    536 
    537 C  LATITUDE {IBUFTN(5)}
    538 C  --------------------
    539 
    540       IF(IBFMS(XIDENT_8(3)).EQ.0)  THEN
    541          IBUFTN(5)  = NINT(XIDENT_8(3) * 100.)
    542       ELSE
    543          WRITE(6,2073) KOUNTR
    544  2073 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    545      $ ' A MISSING LATITUDE - SKIP IT')
    546          GO TO 1000
    547       ENDIF
    548 
    549 C  LONGITUDE {IBUFTN(6)}
    550 C  ---------------------
    551 
    552       IF(IBFMS(XIDENT_8(4)).EQ.0)  THEN
    553          IBUFTN(6)  = NINT(XIDENT_8(4) * 100.)
    554       ELSE
    555          WRITE(6,2074) KOUNTR
    556  2074 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    557      $ ' A MISSING LONGITUDE - SKIP IT')
    558          GO TO 1000
    559       ENDIF
    560 
    561       AMAXIMUM_8 = MAX(XIDENT_8(5),XIDENT_8(6),XIDENT_8(7),XIDENT_8(8))
    562       IF(IBFMS(AMAXIMUM_8).EQ.0) THEN
    563 
    564 C  DAY OF MONTH (* 256) + HOUR (UTC) {IBUFTN(3)}
    565 C  ---------------------------------------------
    566 
    567          IBUFTN(3)  = (256 * NINT(XIDENT_8(5))) + NINT(XIDENT_8(6))
    568 
    569 C  MINUTE (* 256) + SECOND (UTC) {IBUFTN(4)}
    570 C  -----------------------------------------

Page 11          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    571 
    572          IBUFTN(4)  = (256 * NINT(XIDENT_8(7))) + NINT(XIDENT_8(8))
    573       ELSE
    574          WRITE(6,2075) KOUNTR
    575  2075 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    576      $ ' ONE OR MORE MISSING TIME UNITS - SKIP IT')
    577          GO TO 1000
    578       ENDIF
    579 
    580 C  RETRIEVAL METHOD {IBUFTN(12)}
    581 C  -----------------------------
    582 
    583       IF(IBFMS(SATDAT_8(1)).EQ.0)  THEN
    584          ISDPT = NINT(SATDAT_8(1))
    585          IOFF = (LWI * 8) - 6
    586          CALL GBYTES(ISDPT,IBIT,IOFF,1,1,2)
    587 cppppp
    588 cdak     print'(" ISDPT,IBIT,ICLR,ICDY:",4(I0,1X))',ISDPT,IBIT,ICLR,ICDY
    589 cppppp
    590       ELSE
    591          WRITE(6,2076) KOUNTR
    592  2076 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    593      $ ' A MISSING SATELLITE DATA PROCESSING TECHNIQUE - SKIP IT')
    594          GO TO 1000
    595       ENDIF
    596 
    597       IF(IBIT(1).EQ.1.AND.IBIT(2).EQ.0) THEN
    598 
    599 C  --> Clear path
    600 
    601          MCL = 1
    602          ICCMVS = 1
    603       ELSE IF((IBIT(1).EQ.0.AND.IBIT(2).EQ.1).OR.
    604      $        (IBIT(1).EQ.0.AND.IBIT(2).EQ.0.AND.DSNAME.EQ.'ATOVS   '))
    605      $ THEN
    606 
    607 C  --> Cloudy path
    608 
    609          MCL = 2
    610          IF(NINT(SATDAT_8(2)).EQ.1) THEN
    611             ICCMVS = 2
    612          ELSE
    613             ICCMVS = 3
    614          ENDIF
    615       ELSE
    616 
    617 C  --> Unknown path
    618 
    619          WRITE(6,2078) KOUNTR,NINT(SATDAT_8(1)),IBIT
    620  2078 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    621      $ ' AN UNKNOWN SATELLITE DATA PROCESSING TECHNIQUE (=',I5,','/
    622      $ 22X,'WITH ICLR=',I1,' AND ICDY=',I1,') - SKIP IT')
    623          GO TO 1000
    624       ENDIF
    625 
    626       IBUFTN(12) = (256 * MCL) + (16 * MCL) + 1
    627 

Page 12          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    628 C  FILTER FLAG {IBUFTN(20)}
    629 C  ------------------------
    630 
    631       IF(IBFMS(XIDENT_8(11)).EQ.0)  THEN
    632 C  ... for RTOVS and maybe ATOVS if NESDIS starts encoding filter flag
    633 C       in "TOFF"
    634 c  If date of input file is prior to 7/1/1998, then "TOFF" does not
    635 c   indicate filter flag, set filter flag to "-99" (alerts calling
    636 c   program to process only every 4'th RTOVS and every 11'th ATOVS
    637 c   retrieval to simulate 250km sampling - needed for historical cdas
    638 c   runs)
    639          IF(ITOFF.EQ.0)  THEN
    640             IBUFTN(20) = NINT(XIDENT_8(11))
    641          ELSE
    642             IBUFTN(20) = -99
    643          END IF
    644       ELSE IF(IBFMS(XIDENT_8(12)).EQ.0)  THEN
    645 C  ... for ATOVS if NESDIS starts encoding filter flag in "OBQL"
    646          IBUFTN(20) = NINT(XIDENT_8(12))
    647       ELSE
    648          IF(DSNAME.EQ.'RTOVS   ')  THEN
    649             WRITE(6,3075) KOUNTR
    650  3075 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    651      $ ' A MISSING FILTER FLAG - SKIP IT')
    652             GO TO 1000
    653          ELSE
    654 C  Currently filter flag is missing for ATOVS - set to "-99" until
    655 C   NESDIS fixes (alerts calling program to process only every 11'th
    656 C   retrieval to simulate 250km sampling - needed for cdas runs)
    657             if(nfirst.eq.0)  then
    658                write(6,9082)
    659  9082 format(/'##W3XTOVSEDS WARNING: NESDIS HAS NOT STORED A FILTER ',
    660      $ 'FLAG SO SET OUTPUT FILTER FLAG TO -99 FOR ALL REPORTS'/)
    661                nfirst=1
    662             end if
    663             ibuftn(20) = -99
    664          END IF
    665       END IF
    666 
    667 C  LAND/SEA INDICATOR (IF LAND ELEV, IF SEA 0) {IBUFTN(8)}
    668 C  -------------------------------------------------------
    669 
    670       IF(IBFMS(SRFDAT_8(2)).EQ.0)  IBUFTN(8) = NINT(SRFDAT_8(2))
    671       IF(DSNAME.EQ.'RTOVS   ')  THEN
    672 C  ... RTOVS defines "LSQF" incorrectly
    673          IF(NINT(SATDAT_8(2)).EQ.0) IBUFTN(8) = 0
    674       ELSE
    675 C  ... ATOVS defines "LSQF" correctly
    676          IF(NINT(SATDAT_8(2)).EQ.1) IBUFTN(8) = 0
    677       END IF
    678 
    679 C  SURFACE (SKIN) TEMPERATURE {IBUFTN(9)}
    680 C  --------------------------------------
    681 
    682 C Must set to 7777 (missing) - it is used by PREPDATA (subr. W3FA07)
    683 C  only to the extent that if it is missing, then the surface
    684 C  temperature is obtained from the lowest layer mean virtual temp.

Page 13          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    685 c  only, rather than from the avg. of the lowest layer mean virt.
    686 C  temperature and this surface (skin) temp. {IBUFTN(9)}.
    687 C   - This may not be correct, but it is consistent with the TOVS
    688 C     processing from before, where even though the skin temp.
    689 C     in IBUFTN(9) was not missing, the 7'th bit (counting from right,
    690 C     where rightmost bit is position 0) of the value in IBUFTN(11)
    691 C     was always 0 (the largest value for IBUFTN(11) in TOVS was 64).
    692 C
    693 C  This test in W3FA07 is:
    694 C
    695 C      TSFC  = IBUFTN(9)/10.0
    696 C                 ....
    697 C                 ....
    698 C      IF(.NOT.(BTEST(IBUFTN(11),7)).OR.IBUFTN(9).EQ.7777)
    699 C    $ TSFC = TBAR(1) + (.0555 * (IP1(1) - PMID(1)))
    700 C     TSFC = (TSFC + TBAR(1) + (.0555 * (IP1(1) - PMID(1))))/2
    701 C
    702 C  This allows us to ignore IBUFTN(11) here (set to 7777, which
    703 C   actually yields a 0 in bit 7 anyway!!)
    704 
    705       IBUFTN(9) = 7777
    706 
    707       IF(NLEV.EQ.NUMLVL)  THEN
    708 
    709 C  FILL IN THE LEVEL SOUNDING DATA - MUST HAVE 40 TEMP LEVELS TO ACCEPT
    710 C  (Note: For ATOVS, Cloud-top press. is on level 1 - skip to next lvl)
    711 C  --------------------------------------------------------------------
    712 
    713          LL = 0
    714          DO  L = ISTLVL,NLEV
    715             LL = LL + 1
    716             IF(IBFMS(RETDAT_8(1,L)).NE.0) THEN
    717                WRITE(6,2082) KOUNTR
    718  2082 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') ',
    719      $ 'CONTAINS 1 OR MORE MISSING TEMERATURES IN ITS SOUNDING - SKIP ',
    720      $ 'IT')
    721                GO TO 1000
    722             ENDIF
    723             TMPOPR_8(LL) = RETDAT_8(1,L)
    724 cppppp
    725 cdak           print'(" AT L = ",I0,"; RETDAT_8(2,L) = ",G0)',
    726 cdak $          L,RETDAT_8(2,L)
    727 cppppp
    728             TMP_8=RETDAT_8(2,L)*1000._8
    729             IF(LL.GT.25) WOPR_8(LL-25) = MIN(BMISS,TMP_8)
    730          ENDDO
    731          NLEV = 40
    732       ELSE
    733          WRITE(6,2081) KOUNTR,NLEV
    734  2081 FORMAT(/'##W3XTOVSEDS WARNING: DECODED RETR (#',I7,') DOES NOT ',
    735      $ 'CONTAIN 40 SNDG LVLS (PLUS 1 CLOUD-TOP LVL IF ATOVS) (HAS ',I3,
    736      $ ' LVLS)-SKIP IT')
    737          GO TO 1000
    738       ENDIF
    739 
    740       IF(IBFMS(SRFDAT_8(1)).EQ.0)  THEN
    741          PBOT = 0.01 * SRFDAT_8(1)

Page 14          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    742 C --> NESDIS is scaling bottom pressure incorrectly, this accounts for
    743 C      this and for a future fix on their part (fixed on 11/07/2001)
    744          IF(PBOT.LT.200.)  then
    745             IF(MFIRST.EQ.0)  THEN
    746                WRITE(6,9081)
    747  9081 FORMAT(/'##W3XTOVSEDS WARNING: NESDIS IS STORING BOTTOM PRESSURE',
    748      $ ' AS 0.1 PASCALS INSTEAD OF AS PASCALS, THIS SUBROUTINE WILL ',
    749      $ 'CORRECT'/24X,'FOR THIS UNTIL NESDIS FIXES THEIR ERROR'/)
    750                MFIRST=1
    751             END IF
    752             PBOT = 0.1 * SRFDAT_8(1)
    753          end if
    754          IF(DSNAME.EQ.'ATOVS   ')  THEN
    755 
    756 C  For ATOVS (only), do a SANITY check on pressure (NESDIS can have
    757 C   some strange values)
    758 
    759             DVAL = PBOT - PR(REAL(IBUFTN(8)))
    760             IF(DVAL.LE.-75..OR.DVAL.GE.50.)  THEN
    761                WRITE(6,2087) KOUNTR,PBOT,IBUFTN(8)
    762  2087 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    763      $ ' A BAD BOTTOM PRES LVL (PBOT=',F6.1,' MB, ELEV=',I4,' M) - ',
    764      $ 'SKIP IT')
    765                GO TO 1000
    766             ENDIF
    767          ENDIF
    768          DO  L = 40,1,-1
    769             IF(NINT(PBOT*100.).GT.NINT(TOVLEV(L)*100.)) THEN
    770                LST = L
    771                GO TO 1850
    772             ENDIF
    773          ENDDO
    774          WRITE(6,3079) KOUNTR,PBOT
    775  3079 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    776      $ ' A STRANGE BOTTOM PRESSURE (=',F8.2,' MB)  - SKIP IT')
    777          GO TO 1000
    778  1850    CONTINUE
    779          PLST = TOVLEV(LST)
    780       ELSE
    781          WRITE(6,2079) KOUNTR
    782  2079 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') HAS',
    783      $ ' A MISSING BOTTOM PRESSURE - SKIP IT')
    784          GO TO 1000
    785       ENDIF
    786 
    787 C For now set PTRP (trop pressure) to 0.0 as we can't determine this
    788 C  (this means we may not want to throw out superadiabatic retr. as
    789 C   determined by subr. XTOVSEDS02 since the entire column is checked,
    790 C   when the logic expects to only check sfc to trop for supers)
    791 
    792       PTRP = 0.0
    793 cppppp
    794 cdak  print'(" Going into XTOVSEDS02 -- IBUFTN = .....")'
    795 cdak  print, IBUFTN
    796 cdak  print'(" TMPOPR_8 = ",G0)', TMPOPR_8
    797 cdak  print'(" WOPR_8 = ",G0)', WOPR_8
    798 cdak  print'(" PLST = ",G0)', PLST

Page 15          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    799 cdak  print'(" ICCMVS = ",I0)', ICCMVS
    800 cdak  print'(" PTRP = ",G0)', PTRP
    801 cppppp
    802       CALL XTOVSEDS02(TMPOPR_8,WOPR_8,PLST,ICCMVS,PTRP,TLAYER,GEOOPR,
    803      $ PLAYER,ISUPER,BMISS)
    804 
    805       IF(ISUPER.EQ.1)  THEN
    806          WRITE(6,2080) KOUNTR
    807  2080 FORMAT(/'##W3XTOVSEDS WARNING: A DECODED RETRIEVAL (#',I7,') IS ',
    808      $ 'SUPERADIABATIC ACCORDING TO SUBR. XTOVSEDS02- SKIP IT')
    809          GO TO 1000
    810       ENDIF
    811 
    812       DO  L = 1,15
    813         LREV = 16 - L
    814         IF(TLAYER(L).LT.999.99) THEN
    815           IBUFTN(4*L+19) = NINT(PLAYER(LREV+1) * 10.)
    816           IBUFTN(4*L+20) = NINT(PLAYER(LREV) * 10.)
    817           IBUFTN(4*L+21) = NINT((TLAYER(L) * 10.) + 0.0000001)
    818         ENDIF
    819       ENDDO
    820 
    821 C  ORBIT NUMBER
    822 C  ------------
    823 
    824       IF(IBFMS(XIDENT_8(9)).EQ.0)  ISATOB(1) = NINT(XIDENT_8(9))
    825 
    826 C  DAY-NIGHT INDICATOR
    827 C  -------------------
    828 
    829       IF(IBFMS(XIDENT_8(10)).EQ.0)  ISATOB(2) = NINT(XIDENT_8(10))
    830 
    831 C  TERRAIN INDICATOR
    832 C  -----------------
    833 
    834       IF(IBFMS(SRFDAT_8(3)).EQ.0)  THEN
    835 C  ... for RTOVS
    836          ISATOB(3) = NINT(SRFDAT_8(3))
    837       ELSE  IF(IBFMS(SRFDAT_8(4)).EQ.0)  THEN
    838 C  ... for ATOVS
    839          ISATOB(3) = NINT(SRFDAT_8(4))
    840       END IF
    841 
    842       IERR = 0
    843 
    844       RETURN
    845 
    846       END

Page 16          Source Listing                  W3XTOVSEDS
2017-04-18 11:09 Entry Points                    w3xtovseds.f



ENTRY POINTS

  Name                   
                         
 w3xtovseds_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1000                       Label  428                                                            457,498,528,534,546,558,577,594,62
                                                                                                  3,652,721,737,765,777,784,809     
 1001                       Label  444                                                            443                               
 1009                       Label  410                                                            409                               
 1209                       Label  419                                                            418,453                           
 1850                       Label  778                                                            771                               
 2070                       Label  496                                                            495                               
 2071                       Label  526                                                            525                               
 2072                       Label  532                                                            531                               
 2073                       Label  544                                                            543                               
 2074                       Label  556                                                            555                               
 2075                       Label  575                                                            574                               
 2076                       Label  592                                                            591                               
 2078                       Label  620                                                            619                               
 2079                       Label  782                                                            781                               
 2080                       Label  807                                                            806                               
 2081                       Label  734                                                            733                               
 2082                       Label  718                                                            717                               
 2087                       Label  762                                                            761                               
 3004                       Label  380                                                            379                               
 3075                       Label  650                                                            649                               
 3079                       Label  775                                                            774                               
 678                        Label  269                                                            268                               
 9081                       Label  747                                                            746                               
 9082                       Label  659                                                            658                               
 ABS                        Func   489                                  scalar                    489                               
 AMAXIMUM_8                 Local  240      R(8)            8           scalar   SAVE             561,562                           
 ATVSTR                     Local  235      CHAR            12          scalar   SAVE             237,482                           
 BMISS                      Local  241      R(8)            8           scalar   SAVE             390,393,469,472,475,478,729,803   
 CLOSBF                     Subr   367                                                            367                               
 DATELEN                    Subr   266                                                            266                               
 DSNAME                     Dummy  208      CHAR            8           scalar   ARG,INOUT        357,361,365,479,604,648,671,754   
 DUMPBF                     Subr   288                                                            288                               
 DVAL                       Local  759      R(4)            4           scalar   SAVE             759,760                           
 FLOAT                      Func   489                                  scalar                    489                               
 GBYTES                     Subr   586                                                            586                               
 GEOOPR                     Local  214      R(4)            4     1     18       SAVE             802                               
 GETBMISS                   Func   241      R(8)            8           scalar                    390                               
 IBDATE                     Dummy  208      I(4)            4           scalar   ARG,INOUT        355,407,414,437,449               
 IBFMS                      Func   488      I(4)            4           scalar                    488,506,540,552,562,583,631,644,67
                                                                                                  0,716,740,824,829,834,837         
 IBIT                       Local  216      I(4)            4     1     2        SAVE             586,597,603,604,619               
 IBUFTN                     Dummy  208      I(4)            4     1     140      ARG,INOUT        460,493,507,509,511,513,515,518,52
                                                                                                  3,525,541,553,567,572,626,640,642,

Page 17          Source Listing                  W3XTOVSEDS
2017-04-18 11:09 Symbol Table                    w3xtovseds.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  646,663,670,673,676,705,759,761,81
                                                                                                  5,816,817                         
 ICCMVS                     Local  602      I(4)            4           scalar   SAVE             602,611,613,802                   
 IDSDAT                     Dummy  209      I(4)            4           scalar   ARG,INOUT        320                               
 IDSDMP_8                   Dummy  209      I(8)            8           scalar   ARG,INOUT        322,347                           
 IDTST2                     Local  226      CHAR            10          scalar   SAVE             227,470                           
 IDTSTR                     Local  223      CHAR            50          scalar   SAVE             224,470                           
 IERR                       Dummy  209      I(4)            4           scalar   ARG,INOUT        295,397,411,422,446,454,842       
 IFIRST                     Local  211      I(4)            4           scalar   SAVE             211,259,265                       
 IMISS                      Local  252      I(4)            4           scalar   SAVE             252,467                           
 INT                        Func   489                                  scalar                    489                               
 IOFF                       Local  585      I(4)            4           scalar   SAVE             585,586                           
 IRET                       Local  355      I(4)            4           scalar   SAVE             355,407,408,435,436,437,438,470,47
                                                                                                  3,476                             
 ISATOB                     Dummy  208      I(4)            4     1     3        ARG,INOUT        467,824,829,836,839               
 ISDPT                      Local  584      I(4)            4           scalar   SAVE             584,586                           
 ISTLVL                     Local  221      I(4)            4           scalar   SAVE             221,359,363,714                   
 ISUPER                     Local  803      I(4)            4           scalar   SAVE             803,805                           
 ITOFF                      Local  212      I(4)            4           scalar   SAVE             212,383,639                       
 IUNIT                      Dummy  208      I(4)            4           scalar   ARG,INOUT        274,275,276,287,288,294,354,355,36
                                                                                                  7,406,407,409,418,435,437,443,453,
                                                                                                  470,473,476,480,482               
 IUNITL                     Local  211      I(4)            4           scalar   SAVE             211,274,275,276,287               
 JDATE                      Local  216      I(4)            4     1     5        SAVE             288,289,292,298,311,312,313,315,31
                                                                                                  8,320,369,371                     
 JDUMP                      Local  216      I(4)            4     1     5        SAVE             288,290,321,324,337,338,339,341,34
                                                                                                  4,346                             
 JDUMP_8                    Local  218      I(8)            8     1     5        SAVE             346,347,348                       
 JFIRST                     Local  211      I(4)            4           scalar   SAVE             211,274,279,286,399,405           
 KDATE                      Local  218      I(8)            8     1     8        SAVE             369,370,371,372,377               
 KOUNTR                     Local  211      I(4)            4           scalar   SAVE             211,433,495,525,531,543,555,574,59
                                                                                                  1,619,649,717,733,761,774,781,806 
 L                          Local  714      I(4)            4           scalar   SAVE             714,716,723,728,768,769,770,812,81
                                                                                                  3,814,815,816,817                 
 LDATE                      Local  218      I(8)            8     1     8        SAVE             373,374,375,376,377               
 LL                         Local  713      I(4)            4           scalar   SAVE             713,715,723,729                   
 LREV                       Local  813      I(4)            4           scalar   SAVE             813,815,816                       
 LST                        Local  770      I(4)            4           scalar   SAVE             770,779                           
 LWI                        Local  211      I(4)            4           scalar   SAVE             211,267,268,585                   
 LWR                        Local  211      I(4)            4           scalar   SAVE             211,267,268                       
 MAX                        Func   561                                  scalar                    561                               
 MCL                        Local  601      I(4)            4           scalar   SAVE             601,609,626                       
 MFIRST                     Local  212      I(4)            4           scalar   SAVE             212,275,745,750                   
 MIN                        Func   729                                  scalar                    729                               
 NADIR                      Local  489      I(4)            4           scalar   SAVE             489,490,492,493,495               
 NFIRST                     Local  212      I(4)            4           scalar   SAVE             212,276,657,661                   
 NINT                       Func   489                                  scalar                    489,508,510,512,514,516,517,518,52
                                                                                                  0,521,523,541,553,567,572,584,610,
                                                                                                  619,640,646,670,673,676,769,815,81
                                                                                                  6,817,824,829,836,839             
 NLEV                       Local  480      I(4)            4           scalar   SAVE             480,482,707,714,731,733           
 NUMLVL                     Local  221      I(4)            4           scalar   SAVE             221,358,362,707                   
 OPENBF                     Subr   354                                                            354,406                           
 PBOT                       Dummy  208      R(4)            4           scalar   ARG,INOUT        466,741,744,752,759,761,769,774   
 PLAYER                     Local  214      R(4)            4     1     16       SAVE             803,815,816                       

Page 18          Source Listing                  W3XTOVSEDS
2017-04-18 11:09 Symbol Table                    w3xtovseds.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PLST                       Local  779      R(4)            4           scalar   SAVE             779,802                           
 PR                         Local  257      R(4)            4           scalar                    759                               
 PTRP                       Local  792      R(4)            4           scalar   SAVE             792,802                           
 READMG                     Subr   355                                                            355,407,437                       
 READSB                     Subr   435                                                            435                               
 REAL                       Func   759                                  scalar                    759                               
 RETDAT_8                   Local  239      R(8)            8     2     82       SAVE             478,480,482,716,723,728           
 RINC                       Local  214      R(4)            4     1     5        SAVE             377,378                           
 RTVSTR                     Local  235      CHAR            12          scalar   SAVE             236,480                           
 SATDAT_8                   Local  239      R(8)            8     1     2        SAVE             472,473,583,584,610,619,673,676   
 SATSTR                     Local  229      CHAR            10          scalar   SAVE             230,473                           
 SRFDAT_8                   Local  239      R(8)            8     1     4        SAVE             475,476,670,740,741,752,834,836,83
                                                                                                  7,839                             
 SRFSTR                     Local  232      CHAR            20          scalar   SAVE             233,476                           
 SUBSET                     Local  220      CHAR            8           scalar   SAVE             355,356,360,407,437               
 TLAYER                     Local  214      R(4)            4     1     15       SAVE             802,814,817                       
 TMPOPR_8                   Local  240      R(8)            8     1     40       SAVE             723,802                           
 TMP_8                      Local  240      R(8)            8           scalar   SAVE             728,729                           
 TOVLEV                     Local  243      R(4)            4     1     40       SAVE             247,769,779                       
 UFBINT                     Subr   470                                                            470,473,476,480                   
 UFBREP                     Subr   482                                                            482                               
 W3DIFDAT                   Subr   377                                                            377                               
 W3XTOVSEDS                 Subr   208                                                                                              
 WOPR_8                     Local  240      R(8)            8     1     15       SAVE             729,802                           
 WORDLENGTH                 Subr   267                                                            267                               
 XIDENT_8                   Local  239      R(8)            8     1     12       SAVE             469,470,488,489,506,507,508,510,51
                                                                                                  2,514,516,517,518,520,521,523,540,
                                                                                                  541,552,553,561,567,572,631,640,64
                                                                                                  4,646,824,829                     
 XMISS                      Local  252      R(4)            4           scalar   SAVE             252,466                           
 XTOVSEDS02                 Subr   802                                                            802                               

Page 19          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    847 
    848 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    849 C
    850 C SUBPROGRAM:    XTOVSEDS02
    851 C   PRGMMR: KEYSER           ORG: NP22        DATE: 2013-02-14
    852 C
    853 C ABSTRACT: USES RTOVS OR ATOVS 18 MANDATORY-LEVEL GEOPOTENTIAL
    854 C   HEIGHTS AND 40-LEVEL TEMPERATURES TO ARRIVE AT 15-LAYER AVERAGED
    855 C   VIRTUAL TEMPERATURES. IF THE LOW LEVELS ARE MISSING, THEN FILLER
    856 C   (999.99) INSERTED IN PLACE OF THE TEMPERATURES.
    857 C
    858 C PROGRAM HISTORY LOG:
    859 C 1985-06-07  E. BURDSALL (NESDIS)
    860 C 1990-04-30  T. GARDNER (NESDIS/STX)
    861 C 1994-03-22  BERT B. KATZ   ADPATED FOR USE IN CDAS/RE-ANALYSIS
    862 C 2012-11-30  J. WOOLLEN  INITIAL PORT TO WCOSS; RESET BMISS TO A VALUE
    863 C      (10E08) WHICH WILL NOT CAUSE INTEGER OVERFLOW WHICH CAN BE
    864 C      UNPREDICTABLE (PRIOR BMISS VALUE WAS 10E10)
    865 C 2013-02-14  D. A. KEYSER   FINAL CHANGES TO RUN ON WCOSS; BMISS IS
    866 C      NOW PASSED IN FROM CALLING PROGRAM PROGRAM (ADDED AS AN INPUT
    867 C      ARGUMENT HERE)
    868 C
    869 C USAGE:    CALL XTOVSEDS02(TMPOPR_8,WOPR_8,PSFC,ICCMVS,
    870 C                           PTRP,TKLNMC,GPHGT,PNMC,ISUPER,BMISS)
    871 C   INPUT ARGUMENT LIST:
    872 C     TMPOPR_8 - REAL*8 RTOVS/ATOVS 40-LEVEL RETRIEVED TEMPERATURES
    873 C                (DEG. K).
    874 C     WOPR_8   - REAL*8 RTOVS/ATOVS 15-LEVEL RETRIEVED MIXING RATIOS
    875 C                (G / KG).
    876 C     PSFC     - RTOVS/ATOVS MODEL SURFACE LEVEL (MB).
    877 C     ICCMVS   - NESDIS CHANNEL COMBINATION FLAG FOR MVS RETRIEVALS.
    878 C     PTRP     - TROPOPAUSE PRESSURE (MB).
    879 C     BMISS    - REAL*8 BUFRLIB VALUE FOR MISSING
    880 C
    881 C   OUTPUT ARGUMENT LIST:
    882 C     TKLNMC   - RTOVS/ATOVS 15-LAYER RETRIEVED VIRTUAL TEMPS (DEG. K).
    883 C     GPHGT    - RTOVS/ATOVS 18 MANDATORY-LEVEL GEOPOTENTIAL HGHTS (M).
    884 C     PNMC     - PRESSURES AT LAYER INTERFACES (MB).
    885 C     ISUPER   - NESDIS SUPERADIABATIC FLAG.
    886 C
    887 C REMARKS: CALLED BY SUBROUTINE W3XTOVSEDS.
    888 C
    889 C   KEY LOCAL PARAMETERS-
    890 C      VARIABLE                TYPE  FUNCTION
    891 C      --------                ----  --------
    892 C      NPMAN                   I*4   NUMBER OF MANDATORY LEVELS (18)
    893 C      NPRET                   I*4   NUMBER OF RTOVS/ATOVS TEMPERATURE
    894 C                                    RETRIEVAL LEVELS (40)
    895 C      NPMIX                   I*4   NUMBER OF RTOVS/ATOVS MOISTURE
    896 C                                    RETRIEVAL LEVELS (15)
    897 C      C0 - C14                R*4   CONSTANTS USED TO CALCULATE
    898 C                                    LAYER-MEAN TEMPERATURES
    899 C      THK                     R*4   GEOPOTENTIAL THICKNESS (M) BETWEEN
    900 C                                    SELECTED MANDATORY PRESSURE LEVELS
    901 C      PLOC(16)                R*4   NCEP PRESSURE LEVELS
    902 C      NPNMC                   I*4   NUMBER OF NCEP PRESSURE LEVELS (16)
    903 C

Page 20          Source Listing                  W3XTOVSEDS
2017-04-18 11:09                                 w3xtovseds.f

    904 C
    905 C ATTRIBUTES:
    906 C   LANGUAGE: FORTRAN 90
    907 C   MACHINE:  NCEP WCOSS
    908 C
    909 C$$$
    910       SUBROUTINE XTOVSEDS02(TMPOPR_8,WOPR_8,PSFC,ICCMVS,PTRP,TKLNMC,
    911      $ GPHGT,PNMC,ISUPER,BMISS)
    912 
    913       REAL PLOC(16),GPHGT(18),PMAN(18),PRET(40)
    914       REAL DLP(39),TKLNMC(15),PNMC(16),TVIRT(40),ZHGT(40)
    915 
    916       REAL(8)  BMISS,WOPR_8(15),TMPOPR_8(40)
    917 
    918       DATA C0/0.257286585/,C1/0.5/,C2/0.242713415/,C3/0.20751875/,
    919      $ C4/0.5/,C5/0.29248125/,C6/0.3782354/,C7/0.5/,C8/0.1217646/,
    920      $ C9/0.1217646/,C10/0.278746475/,C11/0.3782354/,C12/0.221253525/,
    921      $ C13/0.2435292/,C14/0.034164751/
    922 
    923       LOGICAL L1,L3,L4,L5,L6
    924 
    925       DATA LNMC1/4/,LNMC2/5/,LNMC3/6/,LNMC4/7/,LNMC5/8/,LNMC6/9/,
    926      $ LNMC7/11/,LNMC8/12/,LNMC9/13/,LNMC10/14/
    927       DATA NPRET/40/,NPMAN/18/,NPNMC/16/,NLT/15/,FILL/999.99/,NPMIX/15/
    928       DATA PRET/0.1,0.2,0.5,1.0,1.5,2.0,3.0,4.0,5.0,7.0,10.0,15.0,20.0,
    929      $ 25.0,30.0,50.0,60.0,70.0,85.0,100.0,115.0,135.0,150.0,200.0,
    930      $ 250.0,300.0,350.0,400.0,430.0,475.0,500.0,570.0,620.0,670.0,
    931      $ 700.0,780.0,850.0,920.0,950.0,1000.0/
    932       DATA DLP/0.69315,0.91629,0.69315,0.40546,0.28768,0.40546,
    933      $ 0.28768,0.22314,0.33647,0.35667,0.40546,0.28768,0.22314,0.18232,
    934      $ 0.51083,0.18232,0.15415,0.19416,0.16252,0.13976,0.16034,0.10536,
    935      $ 0.28768,0.22314,0.18232,0.15415,0.13353,0.07232,0.09953,0.05129,
    936      $ 0.13103,0.08408,0.07756,0.04380,0.10821,0.08594,0.07914,0.03209,
    937      $ 0.05129/
    938       DATA PMAN/1.,3.,7.,10.,20.,30.,50.,70.,100.,150.,200.,250.,300.,
    939      $ 400.,500.,700.,850.,1000./
    940       DATA PLOC/0.4,1.0,2.0,5.0,10.0,30.0,50.0,70.0,100.0,200.0,
    941      $ 300.0,400.0,500.0,700.0,850.0,1000.0/
    942 
    943       DATA CONS/14.6435/
    944       DATA TSUPLM/10.0/
    945 
    946       INTEGER CCHLKP(7,2),CCLLKP(7),CCWLKP(7)
    947       DATA CCHLKP/0,2,2,2,6,6,5,0,1,1,1,3,3,4/
    948       DATA CCLLKP/0,1,2,5,4,6,3/
    949       DATA CCWLKP/0,1,0,0,0,0,2/
    950 
    951       INTEGER IDXSUP(18)
    952       DATA IDXSUP/4,7,10,11,13,15,16,18,20,23,24,25,26,28,31,35,37,40/
    953 
    954       DATA NTPRET/0/
    955 
    956       PNMC = PLOC
    957 
    958       L1=ANINT(PSFC).GE.ANINT(PRET(32))
    959 
    960       DO  I = 1,40

Page 21          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

    961          IF(ANINT(PSFC).EQ.ANINT(PRET(I))) THEN
    962            LST = I
    963            EXIT
    964          ENDIF
    965       ENDDO
    966 
    967 C  INITILIZE DO-LOOP LIMITS FOR COMPUTING GEOPOTENTIAL HEIGHTS.
    968 
    969       JSTRT=2
    970       JSTOP=LST
    971 
    972 C  INITIALIZE VIRTUAL TEMPERATURE ARRAY.
    973 
    974       TVIRT = TMPOPR_8
    975 
    976 C  ADJUST GEOPOTENTIAL HEIGHT DO-LOOP LIMITS
    977 
    978       ZHGT = 0.0
    979  
    980       IF(.NOT.L1) THEN
    981          JSTOP=NPRET-NPMIX
    982          GO TO 350
    983       ENDIF
    984 
    985 C  COMPUTE VIRTUAL TEMPERATURES (K).
    986 
    987       LSTART=NPRET-NPMIX+1
    988       DO  L = LSTART,LST
    989 cppppp
    990 cdak  print'(" WOPR_8(L-NPRET+NPMIX)  = ",G0)', WOPR_8(L-NPRET+NPMIX)
    991 cdak  print'(" TVIRT(L) = ",G0)', tvirt(l)
    992 cppppp
    993          IF(WOPR_8(L-NPRET+NPMIX).LT.BMISS) TVIRT(L)=
    994      $    TMPOPR_8(L)*(1.0+.61*WOPR_8(L-NPRET+NPMIX)/
    995      $             (1000.0+WOPR_8(L-NPRET+NPMIX)))
    996 cppppp
    997 cdak  print'(" TVIRT(L) = ",G0)', tvirt(l)
    998 cppppp
    999       ENDDO
   1000 
   1001   350 CONTINUE
   1002 
   1003 C  COMPUTE GEOPOTENTIAL HEIGHTS (METERS) AT RTOVS/ATOVS LEVELS.
   1004 
   1005       DO  J = JSTRT,JSTOP
   1006          I=JSTOP+1-J
   1007          ZHGT(I)=ZHGT(I+1)+(TVIRT(I)+TVIRT(I+1))*DLP(I)*CONS
   1008       ENDDO
   1009 
   1010       GPHGT(1:NPMAN) = ZHGT(IDXSUP(1:NPMAN))
   1011 
   1012       ISUPER=0
   1013       L5=ANINT(PSFC).LT.ANINT(PRET(32))
   1014 
   1015 C  DETERMINE IF NECESSARY TO CHECK FOR SUPERADIABATIC LAPSE RATES.
   1016 
   1017       IF (L5) GO TO 450

Page 22          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1018 
   1019 C  DETERMINE FIRST RTOVS/ATOVS PRESSURE LEVEL HIGHER THAN OR AT THE
   1020 C    TROPOPAUSE PRESSURE.
   1021 
   1022       LTROP=2
   1023       DO  I = 2,LST
   1024          J=NPRET+1-I
   1025          IF (PRET(J).GT.PTRP) CYCLE
   1026          LTROP=J
   1027          EXIT
   1028       ENDDO
   1029 cppppp
   1030 cdak  print'(" After trop loop, LTROP = ",I0," (should be 2)")', LTROP
   1031 cppppp
   1032 
   1033 C  DETERMINE FIRST MANDATORY PRESSURE LEVEL AT OR BELOW THE RTOVS/ATOVS
   1034 C   LEVEL DETERMINED IN THE PREVIOUS STEP.
   1035 
   1036       DO  I = 1,NPMAN
   1037          IF (PMAN(I).LT.PRET(LTROP)) CYCLE
   1038          LTROP=I
   1039          EXIT
   1040       ENDDO
   1041 
   1042 cppppp
   1043 cdak  print'(" After pman loop, LTROP = ",I0," (should be 1)")', LTROP
   1044 cppppp
   1045 
   1046 C DETERMINE FIRST MANDATORY PRESSURE LEVEL AT OR HIGHER THAN THE SURFACE
   1047 C  PRESSURE LEVEL.
   1048 
   1049       DO  I = 1,NPMAN
   1050          J=NPMAN+1-I
   1051          IF (ANINT(PMAN(J)).GT.ANINT(PSFC)) CYCLE
   1052          LSURF=J
   1053          EXIT
   1054       ENDDO
   1055 
   1056 C  CHECK FOR SUPERADIABATIC LAPSE RATES BETWEEN MANDATORY PRESSURE
   1057 C   LEVELS 'LTROP' AND 'LSURF'.
   1058 
   1059       LSTOP=LSURF-1
   1060       DO  J = LTROP,LSTOP
   1061 
   1062 C  IF PRESSURE LEVEL AT OR ABOVE 100MB, CHANGE UNITS OF GEOPOTENTIAL
   1063 C   HEIGHTS FROM DECAMETERS TO METERS.
   1064 
   1065          GPHIGH=GPHGT(J)
   1066          GPLOW=GPHGT(J+1)
   1067          DZ=ABS(GPLOW-GPHIGH)
   1068          IF (DZ.LT.0.000001) CYCLE
   1069          K=J+1
   1070          TMPVAL=(TMPOPR_8(IDXSUP(K))-TMPOPR_8(IDXSUP(J)))*(1000.0/DZ)
   1071          IF (TMPVAL.LE.TSUPLM) CYCLE
   1072          ISUPER=1
   1073          GO TO 450
   1074       ENDDO

Page 23          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1075 
   1076 C  CHECK FOR SUPERADIABATIC LAPSE RATE BETWEEN LEVELS 'LSURF' AND 'LST',
   1077 C   IF NECESSARY.
   1078 
   1079       IF (ANINT(PMAN(LSURF)).GE.ANINT(PSFC)) GO TO 450
   1080       DO  I = 21,LST
   1081          IF (PRET(I).NE.PMAN(LSURF)) CYCLE
   1082          LEVEL=I
   1083          EXIT
   1084   445    CONTINUE
   1085       ENDDO
   1086       DZ=ABS(ZHGT(LEVEL)-ZHGT(LST))
   1087       IF (DZ.LT.0.000001) GO TO 450
   1088       TMPVAL=(TMPOPR_8(LST)-TMPOPR_8(LEVEL))*(1000.0/DZ)
   1089       IF (TMPVAL.LE.TSUPLM) GO TO 450
   1090       ISUPER=1
   1091 
   1092   450 CONTINUE
   1093       IF(ISUPER.EQ.1) RETURN
   1094 
   1095       TKLNMC = FILL
   1096 
   1097       ICCTHI = CCHLKP(ICCMVS+1,2)
   1098       ICCTLO = CCLLKP(ICCMVS+1)
   1099       ICCW = CCWLKP(ICCMVS+1)
   1100       IF(ICCTHI.LT.1 .OR. ICCTHI.GT.6) ICCTHI = 6
   1101       IF(ICCTLO.LT.0 .OR. ICCTLO.GT.6) ICCTLO = 0
   1102       IF(ICCW.LT.0 .OR. ICCW.GT.2) ICCW = 0
   1103       L1=ISUPER.EQ.1
   1104       L3=ICCTLO.EQ.0
   1105       L4=ICCW.EQ.0.AND.ICCTLO.NE.0.AND.LST.LT.32
   1106       L5=ICCTHI.NE.6
   1107       L6=ICCTHI.EQ.6
   1108 
   1109 C  CHECK FOR AVAILABILITY OF GEOPOTENTIAL HEIGHTS FROM THE SURFACE TO
   1110 C   100 MB. IF FOLLOWING TESTS ARE SATISFIED GEOPOTENTIAL HEIGHTS ARE
   1111 C   NOT AVAILABLE.
   1112 
   1113       IF (L1) GO TO 510
   1114 
   1115 C  CHECK IF TROPOSPHERIC TEMPERATURES SOUTH OF 10N ARE NOT TO BE
   1116 C   COMPUTED
   1117 
   1118       IF (L3) GO TO 510
   1119 
   1120 C  CHECK IF SURFACE DATA IS RELIABLE. IF TEST NOT  SATISFIED,
   1121 C   GEOPOTENTIAL HEIGHTS ARE AVAILABLE FROM THE SURFACE TO 0.4 MB.
   1122 
   1123       IF (.NOT.L4) GO TO 530
   1124 
   1125 C  DATA ONLY AVAILABLE TO COMPUTE LAYER-MEAN TEMPERATURES BETWEEN
   1126 C   SELECTED NCEP PRESSURE LEVELS FROM 200 TO 0.4 MB. SET POINTER(NUMT)
   1127 C   DENOTING NUMBER OF LAYER-MEAN TEMPERATURES  TO BE CALCULATED.
   1128 
   1129       NUMT=LNMC6
   1130       NTPRET=NTPRET+1
   1131 

Page 24          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1132 C  SET POINTER(NT) SPECIFYING ATMOSPHERIC LAYER AT WHICH TEMPERATURE
   1133 C   CALCULATIONS BEGIN(100-200MB LAYER).
   1134 
   1135       NT=LNMC4
   1136 
   1137 C  CHECK FOR AVAILABILITY OF RETRIEVAL DATA ABOVE 10 MB.
   1138 
   1139 C  DATA AVAILABLE TO COMPUTE LAYER-MEAN TEMPERATURES ONLY BETWEEN
   1140 C   SELECTED NCEP PRESSURE LEVELS FROM 200 TO 10 MB. RESET POINTER(NUMT)
   1141 C   FOR NUMBER OF MEAN-LAYER TEMPERATURES TO BE CALCULATED.
   1142 
   1143       IF (.NOT.L5) NUMT=LNMC2
   1144       GO TO 570
   1145 
   1146   510 CONTINUE
   1147 
   1148 C  RETRIEVAL DATA IS ONLY AVAILABLE TO COMPUTE LAYER-MEAN TEMPERATURES
   1149 C   BETWEEN SELECTED NCEP PRESSURE LEVELS FROM 100 TO 0.4 MB.  SET
   1150 C   POINTER(NUMT) FOR NUMBER OF LAYER-MEAN TEMPERATURES TO BE CALCULATED
   1151 
   1152       NUMT=LNMC5
   1153       NTPRET=NTPRET+1
   1154 
   1155 C  SET POINTER(NT) SPECIFYING ATMOSPHERIC LAYER AT WHICH TEMPERATURE
   1156 C   CALCULATIONS BEGIN(70-100 MB LAYER).
   1157 
   1158       NT=LNMC5
   1159 
   1160 C  CHECK FOR AVAILABILITY OF RETRIEVAL DATA ABOVE 10 MB.
   1161 
   1162 C  DATA AVAILABLE TO COMPUTE LAYER-MEAN TEMPERATURES ONLY BETWEEN
   1163 C   SELECTED NCEP PRESSURE LEVELS FROM 100 TO 10 MB. RESET POINTER(NUMT)
   1164 C   FOR NUMBER OF TEMPERATURES TO BE CALCULATED.
   1165 
   1166       IF (.NOT.L5) NUMT=LNMC1
   1167 
   1168 C  INITIALIZE POINTER(M): SPECIFIES THE STARTING MANDATORY PRESSURE
   1169 C   LEVEL AT WHICH GEOPOTENTIAL HEIGHT DATA IS USED FOR CALCULATION OF
   1170 C   LAYER-MEAN TEMPERATURES.
   1171 
   1172       M=LNMC6
   1173       GO TO 580
   1174 
   1175   530 CONTINUE
   1176 
   1177 C  DATA AVAILABLE TO COMPUTE LAYER-MEAN TEMPERATURES BETWEEN SELECTED
   1178 C   NCEP PRESSURE LEVELS FROM THE SURFACE TO 0.4 MB. SET POINTER(NUMT)
   1179 C   FOR NUMBER OF LAYER-MEAN TEMPERATURES TO BE CALCULATED.
   1180 
   1181       NUMT=NPNMC-1
   1182 
   1183 C  SET POINTER(NT) SPECIFYING ATMOSPHERIC LAYER AT WHICH TEMPERATURE
   1184 C   CALCULATIONS ARE TO BEGIN(1000-850 MB LAYER).
   1185 
   1186       NT=1
   1187 
   1188 C  CHECK FOR AVAILABILITY OF RETRIEVAL DATA ABOVE 10 MB.

Page 25          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1189 
   1190       IF (.NOT.L5) THEN
   1191 
   1192 C  DATA AVAILABLE TO COMPUTE LAYER-MEAN TEMPERATURES BETWEEN SELECTED
   1193 C   NCEP PRESSURE LEVELS FROM THE SURFACE TO 10 MB.  RESET POINTER(NUMT)
   1194 C   FOR NUMBER OF TEMPERATURES TO BE CALCULATED.
   1195 
   1196          NUMT=LNMC7
   1197       ENDIF
   1198 
   1199 C  INITIALIZE POINTER(M): SPECIFIES STARTING MANDATORY PRESSURE LEVEL
   1200 C   AT WHICH GEOPOTENTIAL HEIGHT DATA IS TO BE USED FOR CALCULATION OF
   1201 C   LAYER-MEAN TEMPERATURES.
   1202 
   1203       M=NPMAN
   1204 
   1205 C  CHECK TO DETERMINE IF SURFACE PRESSURE IS LESS THAN 1000 MB.
   1206 
   1207       IF(ANINT(PNMC(NPNMC)).EQ.ANINT(PSFC)) GO TO 580
   1208 
   1209 C  ADJUST NUMBER OF NCEP PRESSURE LEVELS WHEN SURFACE PRESSURE IS LESS
   1210 C   THAN 1000 MB.
   1211 
   1212       DO  I = 1,NPNMC-1
   1213 
   1214 C  REVERSE ORDERING SEQUENCE OF NCEP PRESSURE LEVELS (START WITH LEVEL
   1215 C   15: E.G. PNMC(15)=850 MB).
   1216 
   1217          J=NPNMC-I
   1218 
   1219 C  RESET POINTER(NT) SPECIFYING FIRST LAYER WHERE LAYER-MEAN TEMPERATURE
   1220 C   CALCULATIONS ARE TO BEGIN.
   1221 
   1222          NT=I
   1223 
   1224 C  CHECK TO DETERMINE NEW NCEP SURFACE PRESSURE.
   1225 
   1226          IF(ANINT(PSFC).GT.ANINT(PNMC(J))) EXIT
   1227       ENDDO
   1228 
   1229 C  DEFINE NEW NCEP SURFACE PRESSURE.
   1230 
   1231       PNMC(J+1)=PSFC
   1232 
   1233 C  RESET POINTER(NUMT) FOR NUMBER OF LAYER-MEAN TEMPERATURES TO BE
   1234 C   CALCULATED.
   1235 
   1236       NUMT=J
   1237       IF (L6) NUMT=NUMT-LNMC1
   1238 
   1239 C  RESET POINTER(M) FOR MANDATORY PRESSURE LEVEL.
   1240 
   1241       M=J+3
   1242       GO TO 580
   1243 
   1244   570 CONTINUE
   1245 

Page 26          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1246 C  RESET POINTER(M) FOR MANDATORY PRESSURE LEVELS( FOR CASES WHEN DATA
   1247 C   ONLY AVAILABLE BETWEEN 200-0.4 OR 200-10 MB.
   1248 
   1249       M=LNMC7
   1250 
   1251   580 CONTINUE
   1252 
   1253 C  DEFINE LOWER AND UPPER DO-LOOP LIMITS FOR ERROR ESTIMATE CALCULATIONS
   1254 C   (USED IN SUBROUTINE CALERR).
   1255 
   1256       NTL=NT
   1257       NTU=NTL+NUMT-1
   1258 
   1259 C  CALCULATE LAYER-MEAN TEMPERATURES
   1260 C  ---------------------------------
   1261 
   1262       DO I = NTL,NTU
   1263 
   1264 C  REVERSE ORDERING SEQUENCE OF NCEP PRESSURE LEVELS.
   1265 
   1266          J=NLT-I+1
   1267 
   1268 C  CHECK FOR SPECIAL CASES WHEN GEOPOTENTIAL THICKNESSES MUST BE SUMMED
   1269 C   TO COMPUTE LAYER-MEAN TEMPERATURES.
   1270 
   1271          IF(I.EQ.LNMC3) GO TO 590
   1272          IF(I.EQ.LNMC4) GO TO 600
   1273          IF(I.EQ.LNMC7) GO TO 610
   1274 
   1275 C  CHECK TO ENSURE IF DATA AVAILABLE ABOVE 10 MB. IF TEST SATISFIED
   1276 C   CALCULATION OF LAYER-MEAN TEMPERATURES NOT REQUIRED USING RETRIEVAL
   1277 C   TEMPERATURE DATA.
   1278 
   1279          IF(L6) GO TO 690
   1280          GO TO 640
   1281 
   1282   590    CONTINUE
   1283 
   1284 C  DEFINE LOWER(ML) AND UPPER(MU) DO-LOOP LIMITS FOR SUMMATION OF
   1285 C   THICKNESSES BETWEEN 300-200 MB LEVELS.
   1286 
   1287          ML=11
   1288          MU=12
   1289          GO TO 620
   1290 
   1291   600    CONTINUE
   1292 
   1293 C  DEFINE ML AND MU FOR SUMMATION OF THICKNESSES BETWEEN 200-100 MB LVLS
   1294 
   1295          ML=9
   1296          MU=10
   1297          GO TO 620
   1298 
   1299   610    CONTINUE
   1300 
   1301 C  DEFINE ML AND MU FOR SUMMATION OF THICKNESSES BETWEEN 30-10 MB LEVELS
   1302 

Page 27          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1303          ML=4
   1304          MU=5
   1305 
   1306   620    CONTINUE
   1307 
   1308 C  INITIALIZE SUMMATION OF THICKNESSES.
   1309 
   1310          SUMTHK=0.
   1311 
   1312 C  SUM THICKNESSES.
   1313 
   1314          DO  L = ML,MU
   1315             THK=GPHGT(L)-GPHGT(L+1)
   1316             SUMTHK=SUMTHK+THK
   1317          ENDDO
   1318          THK=SUMTHK
   1319 
   1320 C  RESET POINTER(M) TO MANDATORY PRESSURE LEVEL FOR NEXT THICKNESS
   1321 C   CALCULATION.
   1322 
   1323          M=M-1
   1324          GO TO 700
   1325 
   1326   640    CONTINUE
   1327 
   1328 C  CHECK FOR SPECIAL CASES WHEN RTOVS/ATOVS RETRIEVAL TEMPERATURES ARE
   1329 C   REQUIRED TO COMPUTE LAYER-MEAN TEMPERATURES.
   1330 
   1331          IF(I.EQ.LNMC8) GO TO 650
   1332          IF(I.EQ.LNMC9) GO TO 660
   1333          IF(I.EQ.LNMC10) GO TO 670
   1334          JJ=NPNMC-1
   1335          IF(I.EQ.JJ) GO TO 680
   1336          GO TO 690
   1337 
   1338   650    CONTINUE
   1339 
   1340 C  COMPUTE LAYER-MEAN TEMPERATURE BETWEEN 10-5 MB LEVELS.
   1341 
   1342          TKLNMC(I)=C0*TMPOPR_8(11)+C1*TMPOPR_8(10)+C2*TMPOPR_8(9)
   1343          GO TO 710
   1344 
   1345   660    CONTINUE
   1346 
   1347 C  COMPUTE LAYER-MEAN TEMPERATURE BETWEEN 5-2 MB LEVELS.
   1348 
   1349          TKLNMC(I)=C9*TMPOPR_8(9)+C10*TMPOPR_8(8)+C11*TMPOPR_8(7)+
   1350      $     C12*TMPOPR_8(6)
   1351          GO TO 710
   1352 
   1353   670    CONTINUE
   1354 
   1355 C  COMPUTE LAYER-MEAN TEMPERATURE BETWEEN 2-1 MB LEVELS.
   1356 
   1357          TKLNMC(I)=C3*TMPOPR_8(6)+C4*TMPOPR_8(5)+C5*TMPOPR_8(4)
   1358          GO TO 710
   1359 

Page 28          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

   1360   680    CONTINUE
   1361 
   1362 C  INTERPOLATE RTOVS/ATOVS RETRIEVAL TEMPERATURE TO 0.4 MB LEVEL.
   1363 
   1364          TEMP=TMPOPR_8(3)+C13*(TMPOPR_8(2)-TMPOPR_8(3))
   1365 
   1366 C  CALCULATE LAYER-MEAN TEMPERATURE BETWEEN 1-0.4 MB LEVEL.
   1367 
   1368          TKLNMC(I)=C6*TMPOPR_8(4)+C7*TMPOPR_8(3)+C8*TEMP
   1369          GO TO 710
   1370 
   1371   690    CONTINUE
   1372 
   1373 C  COMPUTE GEOPOTENTIAL THICKNESSES.
   1374 
   1375          THK=GPHGT(M-1)-GPHGT(M)
   1376 
   1377   700    CONTINUE
   1378 
   1379 C  COMPUTE LAYER-MEAN TEMPERATURE USING HYPSOMETRIC EQUATION.
   1380 
   1381          TKLNMC(I)=-C14*THK*(1./ALOG(PNMC(J)/PNMC(J+1)))
   1382 
   1383   710    CONTINUE
   1384 
   1385 C  RESET POINTER(M) TO MANDATORY PRESSURE LEVEL FOR NEXT THICKNESS
   1386 C   CALCULATION.
   1387 
   1388          M=M-1
   1389       ENDDO
   1390 
   1391       RETURN
   1392 
   1393       END

Page 29          Source Listing                  XTOVSEDS02
2017-04-18 11:09 Entry Points                    w3xtovseds.f



ENTRY POINTS

  Name                   
                         
 xtovseds02_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 350                        Label  1001                                                           982                               
 445                        Label  1084                                                                                             
 450                        Label  1092                                                           1017,1073,1079,1087,1089          
 510                        Label  1146                                                           1113,1118                         
 530                        Label  1175                                                           1123                              
 570                        Label  1244                                                           1144                              
 580                        Label  1251                                                           1173,1207,1242                    
 590                        Label  1282                                                           1271                              
 600                        Label  1291                                                           1272                              
 610                        Label  1299                                                           1273                              
 620                        Label  1306                                                           1289,1297                         
 640                        Label  1326                                                           1280                              
 650                        Label  1338                                                           1331                              
 660                        Label  1345                                                           1332                              
 670                        Label  1353                                                           1333                              
 680                        Label  1360                                                           1335                              
 690                        Label  1371                                                           1279,1336                         
 700                        Label  1377                                                           1324                              
 710                        Label  1383                                                           1343,1351,1358,1369               
 ABS                        Func   1067                                 scalar                    1067,1086                         
 ALOG                       Func   1381                                 scalar                    1381                              
 ANINT                      Func   958                                  scalar                    958,961,1013,1051,1079,1207,1226  
 BMISS                      Dummy  911      R(8)            8           scalar   ARG,INOUT        993                               
 C0                         Local  918      R(4)            4           scalar                    918,1342                          
 C1                         Local  918      R(4)            4           scalar                    918,1342                          
 C10                        Local  920      R(4)            4           scalar                    920,1349                          
 C11                        Local  920      R(4)            4           scalar                    920,1349                          
 C12                        Local  920      R(4)            4           scalar                    920,1350                          
 C13                        Local  921      R(4)            4           scalar                    921,1364                          
 C14                        Local  921      R(4)            4           scalar                    921,1381                          
 C2                         Local  918      R(4)            4           scalar                    918,1342                          
 C3                         Local  918      R(4)            4           scalar                    918,1357                          
 C4                         Local  919      R(4)            4           scalar                    919,1357                          
 C5                         Local  919      R(4)            4           scalar                    919,1357                          
 C6                         Local  919      R(4)            4           scalar                    919,1368                          
 C7                         Local  919      R(4)            4           scalar                    919,1368                          
 C8                         Local  919      R(4)            4           scalar                    919,1368                          
 C9                         Local  920      R(4)            4           scalar                    920,1349                          
 CCHLKP                     Local  946      I(4)            4     2     14                        947,1097                          
 CCLLKP                     Local  946      I(4)            4     1     7                         948,1098                          
 CCWLKP                     Local  946      I(4)            4     1     7                         949,1099                          
 CONS                       Local  943      R(4)            4           scalar                    943,1007                          
 DLP                        Local  914      R(4)            4     1     39                        932,1007                          
 DZ                         Local  1067     R(4)            4           scalar                    1067,1068,1070,1086,1087,1088     

Page 30          Source Listing                  XTOVSEDS02
2017-04-18 11:09 Symbol Table                    w3xtovseds.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FILL                       Local  927      R(4)            4           scalar                    927,1095                          
 GPHGT                      Dummy  911      R(4)            4     1     18       ARG,INOUT        1010,1065,1066,1315,1375          
 GPHIGH                     Local  1065     R(4)            4           scalar                    1065,1067                         
 GPLOW                      Local  1066     R(4)            4           scalar                    1066,1067                         
 I                          Local  960      I(4)            4           scalar                    960,961,962,1006,1007,1023,1024,10
                                                                                                  36,1037,1038,1049,1050,1080,1081,1
                                                                                                  082,1212,1217,1222,1262,1266,1271,
                                                                                                  1272,1273,1331,1332,1333,1335,1342
                                                                                                  ,1349,1357,1368,1381              
 ICCMVS                     Dummy  910      I(4)            4           scalar   ARG,INOUT        1097,1098,1099                    
 ICCTHI                     Local  1097     I(4)            4           scalar                    1097,1100,1106,1107               
 ICCTLO                     Local  1098     I(4)            4           scalar                    1098,1101,1104,1105               
 ICCW                       Local  1099     I(4)            4           scalar                    1099,1102,1105                    
 IDXSUP                     Local  951      I(4)            4     1     18                        952,1010,1070                     
 ISUPER                     Dummy  911      I(4)            4           scalar   ARG,INOUT        1012,1072,1090,1093,1103          
 J                          Local  1005     I(4)            4           scalar                    1005,1006,1024,1025,1026,1050,1051
                                                                                                  ,1052,1060,1065,1066,1069,1070,121
                                                                                                  7,1226,1231,1236,1241,1266,1381   
 JJ                         Local  1334     I(4)            4           scalar                    1334,1335                         
 JSTOP                      Local  970      I(4)            4           scalar                    970,981,1005,1006                 
 JSTRT                      Local  969      I(4)            4           scalar                    969,1005                          
 K                          Local  1069     I(4)            4           scalar                    1069,1070                         
 L                          Local  988      I(4)            4           scalar                    988,993,994,995,1314,1315         
 L1                         Local  923      L(4)            4           scalar                    958,980,1103,1113                 
 L3                         Local  923      L(4)            4           scalar                    1104,1118                         
 L4                         Local  923      L(4)            4           scalar                    1105,1123                         
 L5                         Local  923      L(4)            4           scalar                    1013,1017,1106,1143,1166,1190     
 L6                         Local  923      L(4)            4           scalar                    1107,1237,1279                    
 LEVEL                      Local  1082     I(4)            4           scalar                    1082,1086,1088                    
 LNMC1                      Local  925      I(4)            4           scalar                    925,1166,1237                     
 LNMC10                     Local  926      I(4)            4           scalar                    926,1333                          
 LNMC2                      Local  925      I(4)            4           scalar                    925,1143                          
 LNMC3                      Local  925      I(4)            4           scalar                    925,1271                          
 LNMC4                      Local  925      I(4)            4           scalar                    925,1135,1272                     
 LNMC5                      Local  925      I(4)            4           scalar                    925,1152,1158                     
 LNMC6                      Local  925      I(4)            4           scalar                    925,1129,1172                     
 LNMC7                      Local  926      I(4)            4           scalar                    926,1196,1249,1273                
 LNMC8                      Local  926      I(4)            4           scalar                    926,1331                          
 LNMC9                      Local  926      I(4)            4           scalar                    926,1332                          
 LST                        Local  962      I(4)            4           scalar                    962,970,988,1023,1080,1086,1088,11
                                                                                                  05                                
 LSTART                     Local  987      I(4)            4           scalar                    987,988                           
 LSTOP                      Local  1059     I(4)            4           scalar                    1059,1060                         
 LSURF                      Local  1052     I(4)            4           scalar                    1052,1059,1079,1081               
 LTROP                      Local  1022     I(4)            4           scalar                    1022,1026,1037,1038,1060          
 M                          Local  1172     I(4)            4           scalar                    1172,1203,1241,1249,1323,1375,1388
 ML                         Local  1287     I(4)            4           scalar                    1287,1295,1303,1314               
 MU                         Local  1288     I(4)            4           scalar                    1288,1296,1304,1314               
 NLT                        Local  927      I(4)            4           scalar                    927,1266                          
 NPMAN                      Local  927      I(4)            4           scalar                    927,1010,1036,1049,1050,1203      
 NPMIX                      Local  927      I(4)            4           scalar                    927,981,987,993,994,995           
 NPNMC                      Local  927      I(4)            4           scalar                    927,1181,1207,1212,1217,1334      
 NPRET                      Local  927      I(4)            4           scalar                    927,981,987,993,994,995,1024      
 NT                         Local  1135     I(4)            4           scalar                    1135,1158,1186,1222,1256          
 NTL                        Local  1256     I(4)            4           scalar                    1256,1257,1262                    

Page 31          Source Listing                  XTOVSEDS02
2017-04-18 11:09 Symbol Table                    w3xtovseds.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTPRET                     Local  954      I(4)            4           scalar                    954,1130,1153                     
 NTU                        Local  1257     I(4)            4           scalar                    1257,1262                         
 NUMT                       Local  1129     I(4)            4           scalar                    1129,1143,1152,1166,1181,1196,1236
                                                                                                  ,1237,1257                        
 PLOC                       Local  913      R(4)            4     1     16                        940,956                           
 PMAN                       Local  913      R(4)            4     1     18                        938,1037,1051,1079,1081           
 PNMC                       Dummy  911      R(4)            4     1     16       ARG,INOUT        956,1207,1226,1231,1381           
 PRET                       Local  913      R(4)            4     1     40                        928,958,961,1013,1025,1037,1081   
 PSFC                       Dummy  910      R(4)            4           scalar   ARG,INOUT        958,961,1013,1051,1079,1207,1226,1
                                                                                                  231                               
 PTRP                       Dummy  910      R(4)            4           scalar   ARG,INOUT        1025                              
 SUMTHK                     Local  1310     R(4)            4           scalar                    1310,1316,1318                    
 TEMP                       Local  1364     R(4)            4           scalar                    1364,1368                         
 THK                        Local  1315     R(4)            4           scalar                    1315,1316,1318,1375,1381          
 TKLNMC                     Dummy  910      R(4)            4     1     15       ARG,INOUT        1095,1342,1349,1357,1368,1381     
 TMPOPR_8                   Dummy  910      R(8)            8     1     40       ARG,INOUT        974,994,1070,1088,1342,1349,1350,1
                                                                                                  357,1364,1368                     
 TMPVAL                     Local  1070     R(4)            4           scalar                    1070,1071,1088,1089               
 TSUPLM                     Local  944      R(4)            4           scalar                    944,1071,1089                     
 TVIRT                      Local  914      R(4)            4     1     40                        974,993,1007                      
 WOPR_8                     Dummy  910      R(8)            8     1     15       ARG,INOUT        993,994,995                       
 XTOVSEDS02                 Subr   910                                                                                              
 ZHGT                       Local  914      R(4)            4     1     40                        978,1007,1010,1086                

Page 32          Source Listing                  XTOVSEDS02
2017-04-18 11:09 Subprograms/Common Blocks       w3xtovseds.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 W3XTOVSEDS                 Subr   208                                                                                              
 XTOVSEDS02                 Subr   910                                                                                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape
       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro

Page 33          Source Listing                  XTOVSEDS02
2017-04-18 11:09                                 w3xtovseds.f

       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : w3xtovseds.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
