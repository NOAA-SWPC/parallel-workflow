Page 1           Source Listing                  SPHERP
2017-04-18 11:09                                 syndata.f

syndata.f(29653): remark #5140: Unrecognized directiv
CDIR$ NEXTSCALAR
----------------^

Page 2           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

      1 C$$$  MAIN PROGRAM DOCUMENTATION BLOCK
      2 C
      3 C MAIN PROGRAM: SYNDAT_SYNDATA
      4 C   PRGMMR: KEYSER           ORG: NP22        DATE: 2017-04-03
      5 C
      6 C ABSTRACT: PERFORMS FOUR DISTINCT FUNCTIONS.  THE FIRST IS TO
      7 C   GENERATE TYPE 110/210 TROPICAL CYCLONE BOGUS REPORTS IN THE
      8 C   PREPBUFR FILE (ALTHOUGH ONLY TYPE 210 CAN CURRENTLY BE GENERATED)
      9 C   ADDING BACKGROUND AND OBS. ERROR VALUES FOR THESE DATA.  THE SECOND
     10 C   IS TO GENERATE TYPE 111 TROPICAL CYCLONE BOGUS REPORTS IN THE
     11 C   PREPBUFR FILE ADDING BACKGROUND AND OBS. ERROR VALUES FOR THESE
     12 C   DATA.  THE THIRD IS TO FLAG PRESSURE QUALITY MARKS ON ALL LEVELS
     13 C   FOR MASS REPORTS SUFFICIENTLY CLOSE TO ALL STORMS CURRENTLY IN THE
     14 C   TVCITALS LIST.  THE FOURTH IS TO FLAG WIND QUALITY MARKS ON ALL
     15 C   LEVELS FOR DROPWINSONDE REPORTS SUFFICIENTLY CLOSE TO ALL STORMS
     16 C   CURRENTLY IN THE TVCITALS LIST.  (SEE COMMENTS IN SUBROUTINE EDTPRP
     17 C   FOR DEFINITION OF "SUFFICIENTLY CLOSE" - IT IS DETERMINED
     18 C   DIFFERENTLY FOR MASS REPORT FLAGGING VS. DROPWINSONDE WIND REPORT
     19 C   FLAGGING).  ANY ONE OR ALL OF THESE FUNCTIONS MAY BE PERFORMED
     20 C   BASED ON USER-DEFINED SWITCHES IN EITHER THE STANDARD INPUT
     21 C   NAMELIST, OR FOR DO_BOGUS, OBTAINED VIA CALL TO SYSTEM ROUTINE
     22 C   GETENV.
     23 C
     24 C PROGRAM HISTORY LOG:
     25 C 1991-06-06  S. J. LORD - ORIGINAL AUTHOR
     26 C 1997-09-03  S. J. LORD - UNDOCUMENTED CHANGE
     27 C 1998-12-03  D. A. KEYSER - Y2K/F90 COMPLIANCE, STREAMLINED CODE;
     28 C      ADDED SUBROUTINE "PREVENTS" TO PLACE BACKGROUND AND OBS.
     29 C      ERROR FOR THESE DATA INTO PREPBUFR FILE (CURRENTLY
     30 C      COMMENTED OUT BUT MAY BE USED ON IBM SP TO MAKE DATA
     31 C      PROCESSING MORE EFFICIENT)
     32 C 1999-02-05  D. A. KEYSER - MODIFIED ARGUMENT LIST IN ENTRY
     33 C      "FAVWND" TO EXPLICITLY ADD VARIABLES "MODTYP" AND "JVBOG" -
     34 C      ALTHOUGH THESE SHOULD BE SAVED IN GLOBAL MEMORY, A POSSIBLE
     35 C      F90 BUG LED TO THEIR BEING LOST AFTER THE FIRST CALL TO THIS
     36 C      ENTRY AND THIS CAUSED THE PROGRAM TO FAIL WHEN MORE THAN ONE
     37 C      STORM WAS PROCESSED; CORRECTED MINOR DIFFERENCES DUE TO REAL
     38 C      NUMBER PRECISION IN F90 VS. F77; CORRECTED ERROR IN
     39 C      GENERATING MAXIMUM AND MINIMUM TIME DATE-TIME VALUES IN
     40 C      ENTRY "HURPOS"; MODIFIED SOURCE TO ALLOW IT TO PORT TO THE
     41 C      IBM SP MACHINE; FOR IBM SP-VERSION NOW CALLS SUBROUTINE
     42 C      PREVENTS
     43 C 1999-06-28  D. A. KEYSER - IN SUBR. SURPRP: MADE CODE MORE
     44 C      EFFICIENT BY SKIPPING THE READING OF REPORTS OUT OF BUFR
     45 C      MESSAGES WHICH CAN'T EVER PRODUCE A SEA-LEVEL PRESSURE OR
     46 C      WIND; CORRECTED ERROR WHICH NEVER ALLOWED SURFACE MARINE SEA-
     47 C      LEVEL PRESSURE TO BE USED HERE IN THE VICINITY OF STORM,
     48 C      CORRECTED AN ERROR WHICH USUALLY LED TO 1000 MB PRESSURE/
     49 C      HEIGHT NOT BEING USED HERE TO CALC. SEA-LEVEL PRESSURE IN THE
     50 C      VICINITY OF STORM, NOW CHECKS QUALITY MARK OF PERTINENT
     51 C      VARIABLES IN BOTH MEAN-SEA LEVEL PRESSURE PROCESSING AND WIND
     52 C      PROCESSING FOR REPORTS IN THE VICINITY OF THE STORM - IF Q.M.
     53 C      IS BAD SKIPS PROCESSING (NEVER CHECKED Q.M. BEFORE),
     54 C      CORRECTED ERROR WHICH LED TO REPORT TIME MINUS CYCLE TIME
     55 C      BEING A FACTOR OF 100 TOO SMALL (RESULTED IN INCORRECT STORM
     56 C      ADJUSTMENT IN SUBR. SURPRP); IN SUBR. EDTPRP: MADE CODE MORE
     57 C      EFFICIENT BY SKIPPING THE READING OF REPORTS OUT OF BUFR

Page 3           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

     58 C      MESSAGES WHICH NEVER CONTAIN MASS DATA OR NEVER CONTAIN
     59 C      PRESSURE SINCE THESE DATA ARE NEVER EDITED BY THIS SUBROUTINE,
     60 C      INSTEAD JUST COPIES SUCH MESSAGES DIRECTLY TO OUTPUT PREPBUFR
     61 C      FILE; CORRECTED ERROR WHICH HAD RESULTED IN ONLY REPORTS IN
     62 C      THE VICINITY OF THE FIRST STORM BEING SUBJECT TO EDITING
     63 C      (PRESS. Q.M. FLAGGING); OUTPUT BOGUS REPORTS NOW HAVE UNIQUE
     64 C      STNIDS; IN BOTH SUBR: STREAMLINED CODE TO MAKE IT MORE
     65 C      EFFICIENT; ADDED DOCBLOCK, COMMENTS, AND MORE STDOUT PRINT;
     66 C      MADE A SERIES OF CHANGES TO CORRECT ERRORS IN IBM VERSION;
     67 C      REPLACED CALL TO SUBROUTINE "PREVENTS" WITH CALL TO W3LIB
     68 C      ROUTINE "GBLEVENTS"; ADDED N-LIST SWITCH "PREVEN" WHICH, WHEN
     69 C      FALSE, WILL BYPASS CALL TO "GBLEVENTS"
     70 C 1999-09-22  D. A. KEYSER - THE FLAGGING OF MASS REPORTS IN THE
     71 C       VICINITY OF STORMS IN SUBR. EDTPRP IS NOW CONTROLLED BY NEW
     72 C       N-LIST SWITCH "FLMASS", IF FALSE THEN REPORTS WILL NOT BE
     73 C       FLAGGED
     74 C 1999-09-24  D. A. KEYSER - CHANGES TO MAKE CODE MORE PORTABLE;
     75 C       REPORTS IN SPSSMI MESSAGES NO LONGER PROCESSED IN SUBR.
     76 C       EDTPRP (USELESS BECAUSE NO WIND DIRECTION AVAILABLE); INCR.
     77 C       STORAGE LIMIT FOR OBSERVATIONS IN STORM VICINITY FROM 150
     78 C       TO 500
     79 C 2001-09-27  D. A. KEYSER - OPTION AVAILABLE TO GENERATE A NEW FORM
     80 C       OF MASS BOGUS REPORT WITH REPORT TYPE 111 AT THE STORM
     81 C       LOCATION, FIRST EVENT WRITES REPORTED STORM CENTRAL PRESSURE
     82 C       FOR SURFACE PRESSURE, THIS IS THEN ADJUSTED ACCORDING TO THE
     83 C       FIRST GUESS PRESSURE AND THE STORM CATEGORY ON THE SAFFIR-
     84 C       SIMPSON SCALE AS A SECOND EVENT, THE GUESS TEMPERATURES AND
     85 C       AN ASSUMPTION OF 99% R.H. ARE USED TO GENERATE SPECIFIC
     86 C       HUMIDITY ON ALL LEVELS THROUGHOUT THE DEPTH OF THE STORM,
     87 C       THE OPTION TO PRODUCE THESE NEW MASS BOGUS REPORTS IS
     88 C       CONTROLLED BY THE NEW N-LIST SWITCH "MAK111", IF FALSE THEN
     89 C       REPORTS WILL NOT BE GENERATED
     90 C 2001-10-10  D. A. KEYSER -- MODIFIED TO NOW PASS TWO SPANNING GLOBAL
     91 C       SIGMA GUESS FILES INTO W3LIB ROUTINE GBLEVENTS IN SITUATIONS
     92 C       WHERE THE CENTER DATE FOR THE PREPBUFR FILE HAS AN HOUR THAT
     93 C       IS NOT A MULTIPLE OF 3 (SEE 2001-10-10 CHANGES TO GBLEVENTS);
     94 C       ADDED PROGRAM CODE ("SYNDATA") AND REASON CODE (0) FOR ALL
     95 C       BOGUS DATA CREATED IN REPORT TYPES 210, 100, 111 (FOR TYPE
     96 C       111 THIS CAN BE UPDATED WITH EVENTS - SEE 2001-09-27)
     97 C 2004-09-09  D. A. KEYSER - MODIFIED SUBR. SURPRP TO NOT PROCESS
     98 C        REPORTS IN NEW MESSAGE TYPE GPSIPW SINCE THEY HAVE NEITHER
     99 C        PRESSURE NOR WIND DATA; MODIFIED SUBR. EDTPRP TO NOT READ
    100 C        REPORTS IN NEW MESSAGE TYPE GPSIPW SINCE THEY NEVER CONTAIN
    101 C        MASS DATA OR PRESSURE AND THUS ARE NEVER EDITED BY THIS
    102 C        SUBR. (THEY ARE INCLUDED IN LIST OF MESSAGE TYPES COPIED
    103 C        DIRECTLY TO OUTPUT PREPBUFR FILE)
    104 C 2005-07-01  D. A. KEYSER - ADDED OPTION TO FLAG DROPWINSONDE WINDS
    105 C        ON ALL LEVELS FOR STORMS SUFFICIENTLY CLOSE TO STORMS (IN
    106 C        SUBR. EDTPRP), VIA NEW NAMELIST SWITCH "FLBWND" (DEFAULTS TO
    107 C        TRUE) (SEE COMMENTS IN SUBR. EDTPRP FOR DEFINITION OF
    108 C        "SUFFICIENTLY CLOSE"); ADDED OPTION TO NOT APPEND TYPE 110/210
    109 C        BOGUS REPORTS TO PREPBUFR FILE (IN SUBR. EDTPRP), VIA NEW
    110 C        SCRIPT VARIABLE "DO_BOGUS" (OBTAINED VIA CALL TO SYSTEM
    111 C        ROUTINE GETENV - DEFAULTS TO "YES") -- IF "DO_BOGUS" IS "NO",
    112 C        AND MAK111 IS FALSE, THEN PROGRAM WILL STOP IMMEDIATELY IF
    113 C        "FLBWND" IS "FALSE", ALSO IF "DO_BOGUS" IS "NO", THEN "FLMASS"
    114 C        IS HARDWIRED TO BE "FALSE"; FIXED SOME MEMORY-CLOBBERING BUGS

Page 4           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    115 C        THAT, ON RARE OCCASIONS CAUSED THIS PROGRAM TO STOP
    116 C        ABNORMALLY, BUT SILENTLY, WITH THE "COMMAND TERMINATED
    117 C        ABNORMALLY" STATEMENT; REPLACED CALL TO BUFRLIB ROUTINE BORT
    118 C        WITH CALL TO W3LIB ROUTINE ERREXIT IN SUBR. SURPRP; ADDED
    119 C        SUBR. CHDIST (CALLED BY SUBR. EDTPRP)
    120 C 2005-11-28  D. A. KEYSER - INCREASED THE MAXIMUM NUMBER OF POINTS
    121 C        THAT CAN BE USED TO CONSTRUCT A TEMPLATE SET OF POINTS FOR
    122 C        AVERAGING OVER THE STORM LOCATION FROM 31x31 TO 50x50 TO
    123 C        ACCOUNT FOR TROPICAL STORM DELTA WHICH HAS A RADIUS OF
    124 C        OUTERMOST CLOSED ISOBAR TOO LARGE FOR THE 31x31 ARRAY (CAUSED
    125 C        NON-FATAL TERMINATION)
    126 C 2012-08-31  D. A. KEYSER - REMOVED DEPENDENCY OF MAK111 ON DO_BOGUS,
    127 C        THUS IF DO_BOGUS=NO AND MAK111=TRUE TYPE 111 BOGUS REPORTS
    128 C        WILL BE GENERATED EVEN THOUGH TYPE 110/220 BOGUS REPORTS ARE
    129 C        NOT (BEFORE NEITHER WOULD BE GENERATED IF DO_BOGUS=NO); FIXED
    130 C        STDOUT PRINT ERROR IN SUBR. EDTPRP FOR LIMITING RADIUS
    131 C        OVERWHICH DROPSONDE REPORTS WILL HAVE WIND QM'S FLAGGED
    132 C 2012-11-20  J. WOOLLEN   - INITIAL PORT TO WCOSS - FIXED A NUMBER OF
    133 C        PROBLEMS IDENTIFIED BY THE INTEL COMPILER MAINLY TO DO WITH
    134 C        LOCAL VARIABLE USE WITHIN SUBROUTINE ENTRY POINTS
    135 C 2013-03-26  D. A. KEYSER - FINAL CHANGES TO RUN ON WCOSS: ADDED CALL
    136 C        TO BUFRLIB ROUTINE SETBMISS(10E08_8) TO RESET BMISS TO A VALUE
    137 C        (10E08_8) WHICH WILL NOT CAUSE INTEGER OVERFLOW WHICH CAN BE
    138 C        UNPREDICTABLE (PRIOR BMISS VALUE WAS 10E10_8); REPLACED GETENV
    139 C        WITH MORE STANDARD GET_ENVIRONMENT_VARIABLE; USE FORMATTED
    140 C        PRINT STATEMENTS WHERE PREVIOUSLY UNFORMATTED PRINT WAS > 80
    141 C        CHARACTERS; REPLACED FORMATTED ARRAY SUBROUTINE ARGUMENTS WITH
    142 C        VARIABLES
    143 C 2014-09-05  D. A. KEYSER
    144 C           - CHANGES MADE IN ENTRY VWNCOM TO PREVENT ARRAY OVERFLOW IN
    145 C        2ND ELEMENT OF AXIWND WHEN ENTRY IS CALLED OUT OF SUBROUTINE
    146 C        MM2DVO WHERE NCMPVO IS PASSED IN WITH VALUE OF 1 AND DEBUGGING
    147 C        IS TURNED ON AT RUN TIME (NOTE: MAY NOT BE CORRECT SOLUTION
    148 C        BUT YIELDS SAME OUTPUT BOGUS WINDS AS WHEN THIS CHANGE IS NOT
    149 C        MADE AND CODE RUNS W/O DEBUGGING TURNED ON AT RUN TIME  -->
    150 C        THIS FIX ALLOWS CODE TO RUN TO COMPLETION WHEN DEBUGGING IS
    151 C        TURNED ON AT RUN TIME).
    152 C           - CHANGE IN SUBR. SURPRP: IF EITHER UOB OR VOB (OR BOTH)
    153 C        ARE MISSING, SKIP THE PROCESSING OF INPUT PREPBUFR WIND REPORT
    154 C        LEVEL (UOB AND/OR VOB CAN NOW BE MISSING FOR SURFACE WIND
    155 C        REPORTS SINCE A RECENT IMPLEMENTATION ALLOWS REPORTS WITH ONLY
    156 C        WIND SPEED OR ONLY WIND DIRECTION TO STORE THESE IN SOB AND
    157 C        DDO, RESP. - PRIOR TO THIS FIX IN SYNDATA, MISSING VALUES FOR
    158 C        UOB AND VOB WERE GENERATING NONSENSICAL BOGUS WINDS OR CAUSING
    159 C        PROGRAM TO ABORT).
    160 C           - PARAMETERS LDXDIM AND NDATMX (STORAGE LIMIT FOR NUMBER OF
    161 C        OBSERVATIONS IN STORM VICINITY) INCREASED FROM 500 TO 1000 IN
    162 C        SUBR. CMPSIT.  A TRAP REMAINS SET FOR ARRAYS EXCEEDING LDXDIM
    163 C        IN ENTRY ANLCOM AND FOR ARRAYS EXCEEDING NDATMX IN ENTRY
    164 C        OWNCOM.  HOWEVER, THE TRAP FOR LDXDIM HAD TO BE FIXED AS IT
    165 C        WAS PREVIOUSLY INVOKED ONLY WHEN THE LIMIT WAS EXCEEDED BY 1,
    166 C        TOO LATE FOR ARRAY OVERFLOW (AND PROGRAM TERMINATION WHEN
    167 C        DEBUGGING IS TURNED ON AT RUN TIME).
    168 C 2016-05-18  S. J. LORD
    169 C        ADDRESSED UNINITIALIZED VARIABLES IN SUBR. TEMWT AND MAKVOR.
    170 C        ADDITIONALLY REINSTATED WEIGHT CALCULATION IN SUBR. TEMWT.
    171 C 2016-07-01  D. STOKES

Page 5           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    172 C        REPLACED REWIND WITH CLOSE FOR REUSABLE READ/WRITE FILE IUNTFE 
    173 C        AFTER IT IS UPDATED WITH INFORMATION FOR THE CURRENT STORM BY
    174 C        ROUTINE FENBOG.  THIS PREVENTS INADVERTENT INPUT OF RESIDUAL
    175 C        CONTENT FROM A PREVIOUS STORM WHILE PROCESSING THE INFORMATION
    176 C        FOR THE CURRENT STORM (as can happen with some compilations).
    177 C 2017-04-03  D. A. KEYSER
    178 C           - PARAMETERS LDXDIM AND NDATMX (STORAGE LIMIT FOR NUMBER OF
    179 C        OBSERVATIONS IN STORM VICINITY) INCREASED FROM 1000 TO 8000 IN
    180 C        SUBR. CMPSIT.  LDXDIM INCREASED FROM 71 TO 8000 IN SUBROUTINE
    181 C        MM2DVO, AND FROM 2500 TO 8000 IN SUBROUTINES AS2DVO, XSPLCM,
    182 C        OUTPUTT, SL1GET, AD1EXX and SL1MBO. 
    183 C        BENEFIT: There can be > 1000 obs in the storm vicinity. This
    184 C                 change ensures that all obs are processed and
    185 C                 eliminates partial processing of statistics in cases
    186 C                 where code does not abort but there are > 1000 obs
    187 C                 going into certain subroutines. The value for
    188 C                 parameter LDXDIM is standardized throughout the code
    189 C                 (it was already set to 8000 in many subroutines, but
    190 C                 to 2500 in other subroutines and to 1000 in subr.
    191 C                 CMPSIT before this change).
    192 C           - ADDITIONAL TRAPS SET IN SUBROUTINES MM2DVO AND AS2DVO AND
    193 C             IN ENTRIES FITOBS, STICKD, GETAMR AND GT1AMR TO CATCH
    194 C             CASES WHERE NUMBER OF OBS WOULD EXCEED LDXDIM, AND IN
    195 C             EMTRIES ANLCOM AND OPSCOM TO CATCH CASES WHERE NUMBER OF
    196 C             OBS WOULD EXCEED NDATMX.  DIAGNOSTICS ARE PRINTED WHEN
    197 C             LIMIT HIT.
    198 C        BENEFIT: Prevents array overflow (and program termination when
    199 C                 debugging is turned on at run time). (These traps
    200 C                 should not be hit now since the limits for LDXDIM and
    201 C                 NDATMX have been now been greatly increased).
    202 C
    203 C
    204 C USAGE:
    205 C   INPUT FILES:
    206 C     UNIT 11  - TCVITALS RECORDS
    207 C     UNIT 13  - NCEP DATE
    208 C     UNIT 14  - LAND-SEA MASK
    209 C     UNIT 15  - BOGDOMN WORKING FILE NULL)
    210 C     UNIT 16  - STMTRK WORKING FILE (NULL)
    211 C     UNIT 17  - RAWDAT WORKING FILE (NULL)
    212 C     UNIT 21  - TCVITALS INFORMATION FROM FIRST GUESS
    213 C     UNIT 25  - PREPBUFR FILE PRIOR TO ADDITION OF BOGUS DATA OR ANY
    214 C              - MODIFICATIONS TO NON-BOGUS REPORTS
    215 C     UNIT 30  - FIRST INPUT SPECTRAL (GLOBAL) SIGMA FIRST GUESS FILE;
    216 C              - IF HOUR IN CENTER DATE FOR PREPBUFR FILE IS A MULTIPLE
    217 C              - OF 3 THEN THIS FILE IS VALID AT THE CENTER DATE OF THE
    218 C              - PREPBUFR FILE, IF THE HOUR IN CENTER DATE FOR PREPBUFR
    219 C              - FILE IS NOT A MULTIPLE OF 3 THEN THIS FILE IS VALID AT
    220 C              - THE CLOSEST TIME PRIOR TO THE CENTER DATE OF THE
    221 C              - PREPBUFR FILE THAT IS A MULTIPLE OF 3
    222 C     UNIT 31  - SECOND INPUT SPECTRAL (GLOBAL) SIGMA FIRST GUESS FILE;
    223 C              - IF HOUR IN CENTER DATE FOR PREPBUFR FILE IS A MULTIPLE
    224 C              - OF 3 THEN THIS FILE IS EMPTY, IF THE HOUR IN CENTER
    225 C              - DATE FOR PREPBUFR FILE IS NOT A MULTIPLE OF 3 THEN
    226 C              - THIS FILE IS VALID AT THE CLOSEST TIME AFTER THE
    227 C              - CENTER DATE OF THE PREPBUFR FILE THAT IS A MULTIPLE OF
    228 C              - 3

Page 6           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    229 C     UNIT 32  - OBSERVATION ERROR FILE
    230 C     UNIT 40  - WEIGHTS
    231 C
    232 C   OUTPUT FILES:
    233 C     UNIT 06  - STANDARD OUTPUT PRINT
    234 C     UNIT 19  - BGHISTRY.DIAG FILE
    235 C     UNIT 22  - STKDATB WORKING FILE
    236 C     UNIT 23  - FENVDTA WORKING FILE
    237 C     UNIT 24  - BOGDAT WORKING FILE
    238 C     UNIT 58  - BOGREPT FILE
    239 C     UNIT 59  - DTHISTRY FILE
    240 C     UNIT 61  - PREPBUFR FILE WITH POSSIBLE ADDITION OF BOGUS DATA
    241 C              - AND/OR POSSIBLE MODIFICATIONS TO NON-BOGUS REPORTS
    242 C     UNIT 70  - MATCOEF FILE
    243 C     UNIT 71  - DUMCOEF FILE
    244 C     UNIT 72  - RAWDAT WORKING FILE
    245 C     UNIT 73  - STMTRK WORKING FILE
    246 C     UNIT 74  - ALLDAT FILE
    247 C     UNIT 80  - "PREVENT" EVENTS DATA FILTERING SUMMARY PRINT FILE
    248 C     UNIT 89  - BOGDOMN WORKING FILE
    249 C
    250 C   SUBPROGRAMS CALLED:
    251 C     UNIQUE:    - BOGMTH   GRABMO   SETMOD   SPMODL   TEMPLT   TEMWT
    252 C                  OUTENV   OUTGES   REDSUB   SLDATE   FIXSLM
    253 C                  GAULAT   BSSLZ1   SEARCH   TRKSUB   NEWVIT
    254 C                  DECVAR   GRABVO   SETUP    SETVOR   MM3DVO
    255 C                  MAKVOR   R15FND   OVRLAP   COMBIN   RITSPS
    256 C                  RITCR1   RITCR2   TIMSUB   YTIME    SORTRL
    257 C                  CIRCLE   RFAC     ZNEAR    CHGRES   UVTOZD
    258 C                  RDSUBS   STISUB   ISECND   UVRTCN   UV2DS
    259 C                  ATAN2DEG SINDEG_8 COSDEG_8 DISTSP_8 STDEV
    260 C                  ABRT1    CMPSIT   MM2DVO   AS2DVO   CSWRL6
    261 C                  FCN      ERRF     MAKHRD   FUNINC   SPLDAT
    262 C                  IBM1     XDTSUB   YDTSUB   DIFSUB   PRDLOC
    263 C                  IBM2     WTDAT    RWT      OUTSTT   GETSVF   OUTSV
    264 C                  SLOSUB   STSPBC   IBM3     SLOCCO   IDSSUB   XBF
    265 C                  YBF      MERCAT   IBM5     DOMCHK   COORDS
    266 C                  DTIME    XTIME    WDWSP    BOGUS    LINT
    267 C                  VFIND    DSKNMC   DPREP    PRFSUB   PRFMSC
    268 C                  PRFKMD   MEANV    OUTSUB   QSATW    QSATI
    269 C                  PCKPRW   UPKPRW   OUTSTK   OPNFIL   ENDFIL
    270 C                  SPTDER   OUTREC   SETSCL   HEDCHK   CSGNLN
    271 C                  SIMCON   SETSIM   RNKVRT   STASH    SIZE
    272 C                  SHRINK   ALSAND   CONTST   DOIT     SLARGO
    273 C                  SPLEFW   GAMSUB   SLIQBG   SLADDQ   ADEXXX
    274 C                  CCOSUB   CC2SUB   MLXN9A   PASSUB   PASDSS
    275 C                  ANRTOD   SLIMBO   SLISUB   SPLEFR   SPLINT
    276 C                  SPTINO   MSKDMP   SPTIKA   INVMTX   IERINV
    277 C                  XSPLCM   OUTPUTT  DSGRPH   PRNT     OVRSUB   STSBC1
    278 C                  SL1OVR   ST1KPX   Y1BF     PR1FKM   IBM4     SL1RGO
    279 C                  SL1GET   SL1QBG   SL1ADQ   AD1EXX   PAS1XS
    280 C                  CL1ANS   PASD1R   SL1MBO   SP1LNT   SP1TNO
    281 C                  EDTPRP   SURPRP   CHDIST   SPHERP   LEGENDR2
    282 C     SYSTEM:    - GET_ENVIRONMENT_VARIABLE
    283 C     LIBRARY:
    284 C       W3NCO    - W3TAGB   W3TAGE   W3LOCDAT W3UTCDAT W3DIFDAT
    285 C                  W3MOVDAT ERREXIT

Page 7           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    286 C       W3EMC    - GBLEVENTS
    287 C       BUFRLIB  - DATELEN  OPENBF   OPENMB   OPENMG   READMG
    288 C                  READSB   UFBQCD   UFBCPY   UFBINT   WRITSB
    289 C                  CLOSMG   CLOSBF   SETBMISS GETBMISS IBFMS
    290 C
    291 C   EXIT STATES:
    292 C     COND =   0 - SUCCESSFUL RUN
    293 C          =   4 - ERROR READING TCVITALS FILE
    294 C          =  20 - FATAL ERROR (SEE STDOUT PRINT FOR MORE DETAILS)
    295 C     COND =  60-79 - RESERVED FOR W3LIB ROUTINE GBLEVENTS (SEE
    296 C                      GBLEVENTS DOCBLOCK)
    297 C
    298 C REMARKS: IMPORTANT INFORMATION REGARDING Y2K CONVERSION -
    299 C            KEYSER - 12-03-1998
    300 C
    301 C          THE Y2K-COMPLIANT VERSION IS SET-UP TO READ RECORDS WITH
    302 C          EITHER A 2-DIGIT YEAR STARTING IN COLUMN 20 OR A 4-DIGIT
    303 C          YEAR STARTING IN COLUMN 20.  THIS WILL ALLOW THIS PROGRAM
    304 C          TO RUN PROPERLY WHEN TCVITALS RECORDS TRANSITION TO A
    305 C          4-DIGIT YEAR.
    306 C
    307 C            The following variables have been converted from a value
    308 C              of "YYMMDD" to "YYYYMMDD":
    309 C  (note: all occurrences of "DAY0" changed to "JDAY0")
    310 C  (note: all occurrences of "DATEJ" changed to "IDATEJ")
    311 C  (note: all occurrences of "DAYX" changed to "IDAYX")
    312 C  (note: all occurrences of "DAY0Z" changed to "IDAYZ")
    313 C  (note: all occurrences of "DAYMN" changed to "IDAYMN")
    314 C  (note: all occurrences of "DAYMX" changed to "IDAYMX")
    315 C  (note: all occurrences of "DAYSTM" changed to "IDAYST")
    316 C  (note: all occurrences of "DAYOB" changed to "IDAYOB")
    317 C  (This is because 32-bit words on IBM not large enough to hold
    318 C    floating point version of YYYYMMDD.)
    319 C               IDATEZ, IDTREQ, IDATE, IDATZZ, IVTVAR(1), JDAY0,
    320 C               IDAYZZ, IDAYZ, IDATTK, IDAY0, ISRTDA, IDATEJ, IVALUE,
    321 C               IDAYX, IDAYMN, IDAYMX, IDAYST, IDAYOB, HEAD_8(2)
    322 C            The following variables have been converted from a value
    323 C              of "YY" to "YYYY":
    324 C               IYRREQ, IYRMNS, IYR, IYRWIN, IYZ, IYX, IYMN, IYRZ,
    325 C               IY0, IYMX
    326 C            The following variables have been converted from a value
    327 C              of "YYMMDDHH" to "YYYYMMDDHH":
    328 C               ICHECK, IDAFST, IDATE0, IDATBF
    329 C            The following string variables have been modified to
    330 C               contain a 4-digit year rather than a 2-digit year
    331 C               in the date:
    332 C               BASNID, MTITLE, BUFF, BUFFIN, BUFINZ
    333 C            The following variables are related to the fractional
    334 C               number of days since 365 days prior to 00Z on NCEP
    335 C               date and were not changed:
    336 C               DAY00 (renamed from DAY0 which had a double meaning,
    337 C               see above), DAYMX0 (renamed from DAYMX which had a
    338 C               double meaning, see above), DAYMN0 (renamed from DAYMN
    339 C               which had a double meaning, see above), DAYZ, STMDAY,
    340 C               SRTDAY, STDAY0, DAYPLS, DAYMNS, DAYYR, DAYA, DAY
    341 C                (NOTE: The fractional number of days was based from
    342 C                       12/31/1899 but 32-bit words on IBM are not

Page 8           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    343 C                       large enough to hold this number.)
    344 C            The following unit numbers contain either reads or writes
    345 C               of one or more variables in the first four groups
    346 C               above which have been modified to contain a 4-digit
    347 C               year:
    348 C                unit 02  - write JDAY0  (unformatted)
    349 C                unit 13  - write IDATEJ (from I7 to I9)
    350 C                "IDSPC"  - write IYMN   (from I2 to I4)
    351 C                "IDSPC"  - write IYMX   (from I2 to I4)
    352 C                "IDSPC"  - write IDAY0  (remains I8)
    353 C                 (NOTE: "IDSPC" and "IDSPCZ" length increased from
    354 C                         CHARACTER*121 to CHARACTER*125)
    355 C                "IFILE"  - write MTITLE (from 100 char. to 102 char.)
    356 C                "IOVITL" - read  BUFIN  (from  93 char. to  95 char.)
    357 C                "IUNTBG" - write IDATE0 (from I8 to I10)
    358 C                "IUNTBH" - write IDATBF (unformatted)
    359 C                "IUNTBH" - write IDATE  (from I8 to I10)
    360 C                "IUNTDO" - write IDAYZ  (from I7 to I9)
    361 C                "IUNTFE" - read  MTITLE (from 100 char. to 102 char.)
    362 C                "IUNTDH" - write IDATEZ (from I8 to I10)
    363 C                "IUNTPV" - write JDAY0  (unformatted)
    364 C                "IUNTTK" - write IDAYZ (unformatted)
    365 C                "IUNTVO" - read  IDATEJ (unformatted)
    366 C                "IUNIT"  - read  MTITLE (from 100 char. to 102 char.)
    367 C                "IUNITB" - read  IDATEJ (from I7 to I9)
    368 C                "MSKDA1" - read  IDAYX  (unformatted)
    369 C                "MSKDA2" - read  IDAYST (unformatted)
    370 C                "MSKDA3" - read  HEAD_8(2)(unformatted)
    371 C                "MSKDA3" - write HEAD_8(2)(unformatted)
    372 C                "MSKDA6" - read  IDAYX  (unformatted)
    373 C                "MSKDA8" - read  IDAYX  (unformatted)
    374 C                "MSKDA9" - write JDAY0  (from I7 to I9)
    375 C                "MSKD16" - write JDAY0  (from I7 to I9)
    376 C                "MSKZ"   - write JDAY0  (unformatted)
    377 C
    378 C Switches used to control processing:
    379 C    DO_BOGUS (CHARACTER - obtained via call to system routine
    380 C    GET_ENVIRONMENT_VARIABLE):
    381 C      - Controls processing of type 110/210 bogus reports and
    382 C        subsequent output into PREPBUFR file (although type 110 are
    383 C        never generated)
    384 C      - Either "YES" or "NO"
    385 C      - Defaults to "YES"
    386 C    MAK111 (LOGICAL - obtained via namelist "INPUT"):
    387 C      - Controls processing of type 111 bogus reports and subsequent
    388 C        output into PREPBUFR file
    389 C      - Either "TRUE" or "FALSE"
    390 C      - Defaults to "FALSE"
    391 C    FLMASS (LOGICAL - obtained via namelist "INPUT"):
    392 C      - Controls flagging of pressure quality marks on all levels for
    393 C        all types of mass reports sufficiently close to all storms
    394 C        currently in the TCVITALS list (see commented in subroutine
    395 C        EDTPRP for definition of "sufficiently close") (these are then
    396 C        encoded into output PREPBUFR file)
    397 C      - Either "TRUE" or "FALSE"
    398 C      - Defaults to "TRUE"
    399 C      - NOTE: Hardwired to "FALSE" if DO_BOGUS is "NO"

Page 9           Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    400 C    FLBWND (LOGICAL - obtained via namelist "INPUT"):
    401 C      - Controls flagging of wind quality marks on all levels for
    402 C        dropwinsonde reports sufficiently close to all storms
    403 C        currently in the TCVITALS list (see commented in subroutine
    404 C        EDTPRP for definition of "sufficiently close") (these are then
    405 C        encoded into output PREPBUFR file)
    406 C      - Either "TRUE" or "FALSE"
    407 C      - Defaults to "TRUE"
    408 C
    409 C
    410 C ATTRIBUTES:
    411 C   LANGUAGE: FORTRAN 90
    412 C   MACHINE:  NCEP WCOSS (IBM iDataPlex and Cray XC40)
    413 C
    414 C$$$
    415       PROGRAM SYNDAT_SYNDATA
    416 
    417       PARAMETER(KVDIM= 7)
    418       PARAMETER(KLDIM=12)
    419       PARAMETER (MAXSTM=70)
    420 ccccc PARAMETER (MAXBPT=31,MAXPTS=MAXBPT*MAXBPT)
    421       PARAMETER (MAXBPT=50,MAXPTS=MAXBPT*MAXBPT)
    422       PARAMETER (IQUADX=4)
    423 
    424       LOGICAL OVRFLG,FSTBOG
    425 
    426       REAL(8)   BMISS,GETBMISS
    427 
    428       LOGICAL OUTFIL,QCFILE,ADVORT,APPREP,OKNBGR,VORDIV,SPCIFH,MNIBOG,
    429      1        NOGES,PREVEN,FLMASS,MAK111,FLBWND
    430       CHARACTER RUNID*6
    431       DIMENSION IPREQ(KLDIM),IVREQ(KVDIM),IPREQZ(KLDIM),IVREQZ(KLDIM),
    432      1          IPDUM(KLDIM),IVDUM(KVDIM)
    433       NAMELIST/INPUT/IDATEZ,IUTCZ,QCFILE,MWAVEZ,PTOPAZ,ADVORT,APPREP,
    434      1               IVFLTP,IVOTYP,RUNID,FRACST,IDTTRK,IHRMXT,OUTFIL,
    435      2               ERPOS0,OKNBGR,MODNAM,IHRWIN,VORDIV,SP1DWL,DIVFAC,
    436      3               IMFLTP,SPCIFH,DELTA,DELTAV,MNIBOG,FACRMW,RMXMNB,
    437      4               NOBWMN,NOGES,MODTYP,NPREQ,NVREQ,IPREQ,IVREQ,RLATMN,
    438      5               RLATMX,PREVEN,FLMASS,MAK111,FLBWND
    439 
    440       CHARACTER STMNAM*9,STMID*3,RSMC*4,DO_BOGUS*3
    441 
    442       LOGICAL FSTFLG
    443 
    444       DIMENSION STMNAM(MAXSTM),STMLAT(MAXSTM),STMLON(MAXSTM),
    445      1          STMDIR(MAXSTM),STMSPD(MAXSTM),IDATE(MAXSTM),
    446      2          IUTC(MAXSTM),RMAX(MAXSTM),PENV(MAXSTM),PCEN(MAXSTM),
    447      3          PTOP(MAXSTM),RSMC(MAXSTM),RMW(MAXSTM),VMAX(MAXSTM),
    448      4          R15NW(MAXSTM),R15NE(MAXSTM),R15SE(MAXSTM),R15SW(MAXSTM),
    449      5          STMID(MAXSTM),FSTFLG(MAXSTM),BLATMN(MAXSTM),
    450      6          BLATMX(MAXSTM),BLONMN(MAXSTM),BLONMX(MAXSTM),
    451      7          vmax_save(maxstm)
    452 
    453       DIMENSION RMXSTM(MAXSTM),RMXBOG(MAXSTM),IBMETH(MAXSTM),
    454      1          OVRFLG(MAXSTM),VTBOG(MAXSTM),RMXMNI(MAXSTM)
    455 
    456       DIMENSION RLATP(MAXPTS),RLONP(MAXPTS),WTP(MAXPTS)

Page 10          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    457 
    458       DIMENSION ENVBOG(MAXPTS,2),R15WND(IQUADX)
    459 
    460       COMMON/PREVSW/PREVEN
    461       COMMON/PROCSW/FLMASS,FLBWND,DO_BOGUS
    462       COMMON/T111SW/MAK111
    463       COMMON/BUFRLIB_MISSING/BMISS
    464 
    465       DATA MODTYP/1/,IMFLTP/1/,IVOTYP/1/,IVFLTP/3/,IEFLTP/2/,MXUNTE/1/
    466 
    467       DATA IOVITL/11/,IUNTMO/ 2/,IUNTDT/13/,IUNTSL/14/,IUNTDO/15/,
    468      1     IUNTTK/16/,IUNTPV/17/,IUNTBD/58/,IUNTBH/19/,IUNTDH/59/,
    469      2     IUNTGV/21/,IUNTVD/18/
    470 
    471       DATA IUNTFV/22/,IUNTFE/23/,IUNTRV/39/,IUNTBG/24/
    472 
    473       DATA IUNTPN/25/,IUNTPO/61/
    474 
    475       DATA SPCIFH/.FALSE./,MNIBOG/.FALSE./,IHRWIN/0/
    476 
    477 C  DEGLAT: ONE DEGREE LATITUDE IN METERS
    478 C  IOPTF : SEARCH OPTION FOR LOOKING FOR FIRST STORM
    479 
    480       DATA MWAVE/-99/,PTOPAL/-99.0/,DELTA/1.25/,DEGLAT/111.1775E3/,
    481      1     IOPTF/6/,QCFILE/.FALSE./,IONE/1/,DELTAV/40./,
    482      2     FSTBOG/.TRUE./,FRACST/1.0/,VTDFLT/5.0/,RMXMNB/200./,
    483      3     FACRMW/3.0/,NOBWMN/2/,NOGES/.FALSE./
    484 
    485       DATA IPREQ/1000,850,700,500,400,300,250,200,150,100,70,50/,
    486      1     IVREQ/6,4,5,3,2,1,7/,NPREQ/6/,NVREQ/1/
    487 
    488       DATA LSTORM/0/
    489 
    490 C  *********************************************
    491 C  *********************************************
    492 C  ****                                     ****
    493 C  ****        PROGRAM SYNDATA              ****
    494 C  ****             "YOGI"                  ****
    495 C  ****    A ('SMARTER THAN THE AVERAGE')   ****
    496 C  ****    PROGRAM FOR BOGUSING VORTEX      ****
    497 C  ****    CIRCULATIONS INTO NUMERICAL      ****
    498 C  ****    WEATHER PREDICTION MODELS.       ****
    499 C  ****                                     ****
    500 C  *********************************************
    501 C  *********************************************
    502 
    503 C  CURRENT MODEL AND FILE TYPES ARE:
    504 
    505 C  MODEL TYPE:
    506 
    507 C    MODTYP= 0: MODEL INDEPENDENT BOGUSING
    508 
    509 C    MODTYP= 1: SPECTRAL MODEL
    510 
    511 C    MODTYP=-1: GRID POINT MODEL  *** NOT IMPLEMENTED ***
    512 
    513 C    FILE TYPES:

Page 11          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    514 C         IMFLTP=1: NCEP GLOBAL SPECTRAL MODEL, OPERATIONAL R40 PRESSURE
    515 C                COEFFICIENT FILE == SEE SLVSP1 FOR VERTICAL LEVEL SETUP
    516 C                                    INFORMATION
    517 C                                 == SEE SVRSP1 FOR SETUP INFORMATION ON
    518 C                                    VARIABLES
    519 C         IMFLTP=2: NCEP GLOBAL SPECTRAL MODEL, OPERATIONAL T80 PRESSURE
    520 C                COEFFICIENT FILE == SEE SLVSP2 FOR VERTICAL LEVEL SETUP
    521 C                                    INFORMATION
    522 C                                 == SEE SVRSP2 FOR SETUP INFORMATION ON
    523 C                                    VARIABLES
    524 C         IMFLTP>2: *** NOT IMPLEMENTED ***
    525 
    526 C  CURRENT VORTEX AND FILE TYPES ARE:
    527 
    528 C  VORTEX TYPE:
    529 
    530 C    IVOTYP= 1: NON-DIVERGENT, AXISYMMETRIC
    531 
    532 C    IVOTYP= 2: DIVERGENT, AXISYMMETRIC
    533 
    534 
    535 C    FILE TYPES:
    536 C         IVFLTP= 1: MATHUR 3-D POSTPROCESSED U, V, Z FILE
    537 C                 == SEE SLVVO1 FOR SETUP INFORMATION ON VERTICAL LEVELS
    538 C                 == SEE SVRVO1 FOR SETUP INFORMATION ON VARIABLES
    539 
    540 C         IVFLTP= 2: MATHUR  2-D ITERATIVE VORTEX
    541 
    542 C         IVFLTP= 3: SHAPIRO 2-D ITERATIVE VORTEX (RADIAL AND TANGENTIAL
    543 C                    WIND ARE CREATED)
    544 
    545 C  PRESET AND UPDATE SOME OPTIONS AND READ IN DATE/TIME
    546 
    547       CALL W3TAGB('SYNDAT_SYNDATA',2017,0093,1200,'NP22')
    548 
    549       MWAVEZ   = MWAVE
    550       PTOPAZ   = PTOPAL
    551       ADVORT   = .TRUE.
    552       FLMASS   = .TRUE.
    553       MAK111   = .FALSE.
    554       FLBWND   = .TRUE.
    555       DIVFAC   = 0.0
    556       READ(5,INPUT)
    557       WRITE(6,INPUT)
    558       CALL GET_ENVIRONMENT_VARIABLE('DO_BOGUS',DO_BOGUS)
    559       IF(DO_BOGUS.NE.'YES' .AND. DO_BOGUS.NE.'NO')  DO_BOGUS = 'YES'
    560       WRITE(6,'("DO_BOGUS = ",A)') DO_BOGUS
    561 
    562       IF(IDATEZ .LT. 0 .OR. IUTCZ .LT. 0)  THEN
    563          CALL SLDATE(IUNTDT,IDATEZ,IUTCZ,IOFFT)
    564       ELSE
    565          WRITE(6,431)
    566   431    FORMAT(/'******CURRENTLY IDATEZ OR IUTCZ MUST BE < 0 UPON ',
    567      1    'INPUT BECAUSE SUBR. SLDATE MUST BE CALLED TO GET BASE'/10X,
    568      2    'DATE FOR FRACTIONAL NUMBER OF DAYS CALCULATION'/)
    569          CALL ABRT1(' MAIN  ',431)
    570       END IF

Page 12          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    571 
    572       WRITE(6,1)  MNIBOG,RUNID
    573     1 FORMAT(//20X,'*****************************************'/
    574      1         20X,'*****************************************'/
    575      2         20X,'****   WELCOME TO SYNDATA ("YOGI")   ****'/
    576      3         20X,'****    A SMARTER-THAN-THE-AVERAGE   ****'/
    577      4         20X,'****       BOGUSING PROGRAM FOR      ****'/
    578      5         20X,'****       VORTEX CIRCULATIONS       ****'/
    579      6         20X,'****   MNIBOG=',L1,' RUNID=',A,9X,  '****'/
    580      7         20X,'*****************************************'/
    581      8         20X,'*****************************************'//
    582      9         ' ===> VERSION -- 03 Apr 2017'//)
    583 
    584 C  On WCOSS should always set BUFRLIB missing (BMISS) to 10E8 to avoid
    585 C   overflow when either an INTEGER*4 variable is set to BMISS or a
    586 C   REAL*8 (or REAL*4) variable that is missing is NINT'd
    587 C  -------------------------------------------------------------------
    588 ccccc CALL SETBMISS(10E10_8)
    589       CALL SETBMISS(10E8_8)
    590       BMISS=GETBMISS()
    591       print'(1X)'
    592       print'(" BUFRLIB value for missing is: ",G0)', bmiss
    593       print'(1X)'
    594 
    595       IF(DO_BOGUS.EQ.'NO')  THEN
    596          IF(.NOT.FLBWND .AND. .NOT.MAK111)  THEN
    597 
    598 C  Note that when DO_BOGUS is NO and MAK111 is FALSE, if FLBWND is
    599 C   FALSE the program stops (normal r.c.) because it has nothing to do
    600 C  -------------------------------------------------------------------
    601 
    602             PRINT *
    603             PRINT *, '#####NOTICE: DO_BOGUS IS "NO" AND MAK111 IS ',
    604      $       '"FALSE" AND FLBWND IS "FALSE" -- THIS PROGRAM HAS ',
    605      $       'NOTHING TO DO -- STOP NORMALLY'
    606             PRINT *
    607             CALL W3TAGE('SYNDAT_SYNDATA')
    608             STOP
    609          END IF
    610 
    611 C  Note that when DO_BOGUS is NO, FLMASS is hardwired to FALSE because
    612 C   the assumption is that the ONLY changes to the PREPBUFR file are
    613 C   the flagging of dropwinsonde winds near storm(s) (if FLBWND = TRUE)
    614 C   and/or the generation of type 111 bogus reports (if MAK111 = TRUE)
    615 C   (i.e., mass reports near storms are not flagged)
    616 C  --------------------------------------------------------------------
    617 
    618          PRINT *
    619          PRINT *, '--> NOTE: DO_BOGUS IS "NO", SO HARDWIRE FLMASS TO ',
    620      $    '"FALSE"'
    621          PRINT *
    622          FLMASS = .FALSE.
    623       END IF
    624 
    625       CALL RITCR1(IUNTBD,IUNTBH,IDATEZ,IUTCZ,RUNID)
    626 
    627       CALL VITLST(IOVITL)

Page 13          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    628 
    629 C  LOOK FOR ALL STORMS AT THE DATE/TIME IN QUESTION
    630 
    631       CALL SEARCH(IDATEZ,IUTCZ,IHRWIN,MAXSTM,KSTORM,STMLAT,STMLON,
    632      1            STMDIR,STMSPD,RMAX,PENV,PCEN,PTOP,IDATE,IUTC,VMAX,RMW,
    633      2            R15NE,R15SE,R15SW,R15NW,PTOPAZ,IOVITL,IUNTBH,IERSRC,
    634      3            IERVIT,QCFILE,FSTFLG,RSMC,STMID,STMNAM,ihrreq)
    635       IF(IERSRC .NE. 0 .OR. IERVIT .NE. 0)  THEN
    636          IF(IERVIT .NE. 0)  WRITE(6,3) IERVIT
    637     3    FORMAT('******ERROR',I3,' HAS OCCURRED READING THE VITAL',
    638      1          ' STATISTICS FILE. SYNDATA IS TERMINATED')
    639          IF(IERSRC .NE. 0)  WRITE(6,4) IERSRC
    640     4    FORMAT('******SYNDATA IS TERMINATED DUE TO REASON=',I3)
    641 
    642 C  WRITE THE HEADER RECORD FOR THE PREPBUFR FILE
    643 
    644          CALL W3TAGE('SYNDAT_SYNDATA')
    645          CALL ERREXIT(4)
    646       ENDIF
    647 
    648 C-----------------------------------------------------------------------
    649 
    650 C  CALCULATE THE RADIUS OF THE BOGUSING AREA FOR ALL STORMS.  THE CALL
    651 C    TO FSTOCR DETERMINES IF THE STORM HAS HAD A PREVIOUS HISTORY OF
    652 C    BOGUSING.  IF SO (IBMETH>=1), WE USE A SMALLER RADIUS FOR THE
    653 C    BOGUSING AREA AND, LATER IN COMBIN, WE ELIMINATE ALL DATA BEYOND
    654 C    RMAX.
    655 
    656       DO KST=1,KSTORM
    657 C
    658          CALL FSTOCR(IOVITL,IOPTF,IDATEZ,IUTCZ,STMNAM(KST)//STMID(KST),
    659      1               IBMETH(KST),IERFST,FSTFLG(KST),QCFILE)
    660 
    661 C  COPY IN THE RADIUS OF 15 M/S WINDS IN EACH QUADRANT
    662 
    663          R15WND(1)=R15NE(KST)
    664          R15WND(2)=R15SE(KST)
    665          R15WND(3)=R15SW(KST)
    666          R15WND(4)=R15NW(KST)
    667 
    668 C  BOGUSING METHODS:
    669 
    670 C  MNIBOG=T - A QUICK, MODEL-INDEPENDENT BOGUSING METHOD THAT IS
    671 C             DESIGNED TO GIVE WINDS OUT TO SEVERAL MULTIPLES OF THE
    672 C             RADIUS OF MAXIMUM WIND. MNIBOG SHOULD BE USED IN CASES
    673 C             WHERE THE DATA DENSITY AROUND THE TROPICAL CYCLONE IS
    674 C             RELATIVELY HIGH, SO THAT THE PURPOSE OF THE DATA IS TO
    675 C             LOCATE THE VORTEX CENTER MORE ACCURATELY
    676 C  VORDIV=T - VORTICITY AND DIVERGENCE ARE THE BOGUSING VARIABLES.  AT
    677 C             THE STORM POSITION, VORTICITY AND CONVERGENCE MAXIMA ARE
    678 C             DETERMINED FROM (SHAPIRO'S) VORTEX SUBROUTINE
    679 C  VORDIV=F - THE "CLASSICAL" METHOD USING A WIND BOGUS THAT COVERS AT
    680 C             LEAST THE AREA OF CLOSED CIRCULATION FOR THE VORTEX
    681 
    682 C  SET UP INTERNAL PARAMETERS FOR MINI-BOGUSING
    683 
    684          IF(MNIBOG)  THEN

Page 14          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    685             MODTYP=0
    686             IBMETH(KST)=2
    687             RMXSTM(KST)=RMAX(KST)
    688             VTBOG(KST)=-99.0
    689             MWAVEZ=99
    690             SP1DWL=1.0
    691 
    692 C  LOOK AT THE RESULTS OF THE GUESS SCAN PROGRAM AND UPDATE THE AREAL
    693 C    COVERAGE OF THE BOGUS WINDS. FOR DETAILS, SEE SUBROUTINE BOGMTH.
    694 
    695             IF(.NOT. NOGES)  THEN
    696                CALL BOGMTH(IUNTGV,IUNTBH,MNIBOG,RMXMNB,STMLAT(KST),
    697      1                     STMLON(KST),VTBOG(KST),RMXMNI(KST),IDATEZ,
    698      2                     IBMETH(KST),STMNAM(KST),STMID(KST),ihrreq)
    699 
    700             ELSE
    701                RMXMNI(KST)=RMXMNB
    702             ENDIF
    703 
    704             WRITE(6,13) NOGES,FACRMW,RMXMNB,RMXMNI(KST)
    705    13 FORMAT(/'...MINI-BOGUSING PARAMETERS: NOGES=',L2,', FACRMW=',F5.1,
    706      1       ', ORIGINAL RMXMNB=',F7.1,', UPDATED RMXMNI=',F7.1)
    707 
    708          ELSE
    709 
    710 C  FOR WIND BOGUSING:
    711 C  LOOK AT THE RESULTS OF THE GUESS SCAN PROGRAM AND DECIDE ON THE
    712 C    BOGUSING METHOD.  SEE DETAILS IN SUBROUTINE BOGMTH
    713 
    714             CALL BOGMTH(IUNTGV,IUNTBH,MNIBOG,RMAX(KST),STMLAT(KST),
    715      1                  STMLON(KST),VTBOG(KST),RMXSTM(KST),IDATEZ,
    716      2                  IBMETH(KST),STMNAM(KST),STMID(KST),ihrreq)
    717          ENDIF
    718 
    719          IF(.NOT. VORDIV)  THEN
    720             RMXBOG(KST)=RFAC(IBMETH(KST),RMXSTM(KST))
    721 
    722 C  COPY THE RADIUS OF 15 M/S WINDS BACK OUT IN EACH QUADRANT
    723 
    724             R15NE(KST)=R15WND(1)
    725             R15SE(KST)=R15WND(2)
    726             R15SW(KST)=R15WND(3)
    727             R15NW(KST)=R15WND(4)
    728 
    729 C  VORTICITY AND DIVERGENCE BOGUSING: OVERRIDE THE RESULTS OF BOGMTH
    730 
    731          ELSE
    732             IBMETH(KST)=2
    733 
    734 C  CHANGE APPARENT BOGUSING METHOD FOR VERY WEAK CIRCULATIONS
    735 
    736             IF(PENV(KST)-PCEN(KST) .LT. 4.0)  IBMETH(KST)=2
    737 
    738             RMXSTM(KST)=RMAX(KST)
    739             RMXBOG(KST)=RFAC(IONE,RMXSTM(KST))
    740             IF(VTBOG(KST) .LT. 0.0)  VTBOG(KST)=VTDFLT
    741          ENDIF

Page 15          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    742       ENDDO
    743 
    744 C-----------------------------------------------------------------------
    745 
    746       WRITE(6,51) (KS,STMNAM(KS)//STMID(KS),RMAX(KS),RMXSTM(KS),
    747      1             RMXBOG(KS),KS=1,KSTORM)
    748    51 FORMAT(/'...OBSERVED RMAX, REVISED RMAX, AND RADIUS OF ',
    749      1       'BOGUSING AREA ARE:'/(10X,I3,2X,A12,3X,3F8.1))
    750 
    751 C  CHECK FOR OVERLAP IN BOGUSING AREA FOR ALL STORMS
    752 
    753       ISHAPE=1
    754       CALL OVRLAP(IUNTSL,IUNTBH,KSTORM,MAXPTS,ISHAPE,DELTA,STMLAT,
    755      1            STMLON,RMXBOG,RMAX,RLATP,RLONP,IBMETH,OVRFLG)
    756 
    757 C  SET UP LEVELS AND VARIABLES TO BE BOGUSED
    758 
    759       CALL SETUP(MODTYP,IMFLTP,IVOTYP,IVFLTP,IPREQ,IPREQZ,IPDUM,NPREQ,
    760      1           IVREQ,IVREQZ,IVDUM,NVREQ)
    761 
    762       CALL GRABIM(IPREQ,NPREQ,IVREQ,NVREQ,NPREQM,NVREQM,PTOPAZ)
    763 
    764       CALL GRABIV(IVOTYP,IVFLTP,IPREQ,NPREQM,IVREQ,NVREQM,PTOPAZ)
    765 
    766 C  FOR THE MODEL ENVIRONMENT:
    767 C  PUT ALL NECESSARY MODEL INFORMATION IN THE ARRAY IN PREPARATION FOR
    768 C    INTERPOLATING TO THE TEMPLATE POINTS AND HORIZONTAL AVERAGING.
    769 
    770       IF(.NOT. VORDIV)  THEN
    771          KLVLS=KLDIM
    772          CALL GRABEN(IUNTMO,MODTYP,IMFLTP,KLVLS,JVBOG)
    773       ENDIF
    774 
    775 C-----------------------------------------------------------------------
    776 
    777 C  DO ALL STORMS THAT DO NOT HAVE AN OVERLAP FLAG
    778 
    779       DO KST=1,KSTORM
    780          IF(OVRFLG(KST))  GO TO 1000
    781 
    782 C  SET BOGUS DATA SEPARATION AS APPROPRIATE FOR THE STORM SIZE RMXCMB IS
    783 C    THE MAXIMUM RADIUS FOR WHICH BOGUS DATA WILL BE ADDED TO THE
    784 C    PREPBUFR FILE.  THE SEPARATION IS SET TO A MINIMUM OF 0.4 TIMES
    785 C    RMXCMB.
    786 
    787          IF(MNIBOG)  THEN
    788 CCC         CALL R15FND(R15WND,STMDIR(KST),RMXSTM(KST),R15AVG)
    789 
    790 C**   3/29/92  CHANGED R15AVG TO RMXSTM IN THE FOLLOWING IF BLOCK.
    791 
    792             IF(RMW(KST) .GT. 0)  THEN
    793                RMXCMB=MIN(MAX(FACRMW*RMW(KST),RMXMNI(KST)),RMXSTM(KST))
    794             ELSE
    795                RMXCMB=MIN(RMXMNI(KST),RMXSTM(KST))
    796             ENDIF
    797 
    798          ELSE

Page 16          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    799             RMXCMB=RMXSTM(KST)
    800          ENDIF
    801 
    802          DELSTM=MIN(DELTA,RMXCMB*0.4E3/DEGLAT)
    803 
    804 C  ******  BEGIN ENVIRONMENTAL WIND SECTION  ******
    805 
    806          IF(.NOT. VORDIV)  THEN
    807 
    808 C  CONSTRUCT A TEMPLATE SET OF POINTS FOR AVERAGING OVER THE STORM
    809 C    LOCATION
    810 
    811             ISHAPE=0
    812             DELAVG=MIN(DELSTM,1.0)
    813             CALL TEMPLT(ISHAPE,DELAVG,STMLAT(KST),STMLON(KST),
    814      1                  RMXSTM(KST),MAXPTS,MZZ,NZZ,RLATMN,RLATMX,RLONMN,
    815      2                  RLONMX,RLATP,RLONP,NPTS)
    816 C SJL 4/12/16 added arguments in lower case
    817             CALL TEMWT(stmlat(kst),stmlon(kst),rmxstm(kst),RLATP,RLONP,
    818      1                 WTP,delavg,NPTS)
    819 
    820 C  CALCULATE AVERAGE OF FILTERED ENVIRONMENTAL WIND OVER TEMPLATE POINTS
    821 
    822             WRITE(6,101) STMNAM(KST)//STMID(KST),RMXSTM(KST),PTOP(KST),
    823      1                   MNIBOG
    824             WRITE(IUNTBH,101) STMNAM(KST)//STMID(KST),RMXSTM(KST),
    825      1                        PTOP(KST),MNIBOG
    826   101 FORMAT(///' ...CALLING FAVWND FOR STORM ',A12,' FILTERED, ',
    827      1       'AVERAGE ENVIRONMENTAL WIND WILL BE CALCULATED.'/
    828      2       ' ...RMAX, PTOP,MNIBOG=',2F11.1,L2)
    829             CALL FAVWND(MODTYP,JVBOG,IUNTBH,PTOP(KST),RLONP,RLATP,WTP,
    830      1                  NPTS,MNIBOG)
    831 
    832 C  PICK THE APPROPRIATE TRUNCATION IN HEIGHT AND WAVENUMBER SPACE THAT
    833 C    AGREES WITH THE CURRENT STORM MOTION.  PROVISION IS MADE FOR A
    834 C    PROPAGATION VECTOR THAT IS A DIFFERENCE BETWEEN THE ENVIRONMENTAL
    835 C    FLOW AND THE OBSERVED STORM MOTION.
    836 
    837 C**         UPROP=-1.0
    838 C**         VPROP=1.0
    839             UPROP=0.0
    840             VPROP=0.0
    841             WRITE(6,201) STMNAM(KST)//STMID(KST),UPROP,VPROP,MNIBOG
    842             WRITE(IUNTBH,201) STMNAM(KST)//STMID(KST),UPROP,VPROP,MNIBOG
    843   201 FORMAT(///' ...CALLING SETFEN FOR STORM ',A12,' FILTERED, ',
    844      1       'ENVIRONMENTAL WIND THAT'/4X,'BEST FITS PERSISTENCE MINUS',
    845      2       ' UPROP,VPROP=',2F8.2,' WILL BE CALCULATED.'/4X,'MNIBOG=',
    846      3       L2)
    847             MWENV=MWAVEZ
    848             ITRNCZ=-1
    849             KLSTMZ=0
    850             CALL SETFEN(IUNTBH,STMDIR(KST),STMSPD(KST),UPROP,VPROP,
    851      1                  MWENV,ITRNCZ,KLSTMZ,MNIBOG)
    852 
    853 C  CONSTRUCT A TEMPLATE SET OF POINTS FOR CALCULATING THE BOGUS
    854 C    ENVIRONMENTAL WINDS.
    855 

Page 17          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    856             DELTAB=DELSTM
    857             ISHAPE=1
    858             ZLAT=ZNEAR(STMLAT(KST),DELTAB)
    859             ZLON=ZNEAR(STMLON(KST),DELTAB)
    860             CALL TEMPLT(ISHAPE,DELTAB,ZLAT,ZLON,RMXBOG(KST),MAXPTS,MMX,
    861      1                  NNY,RLATMN,RLATMX,RLONMN,RLONMX,RLATP,RLONP,
    862      2                  NPTS)
    863 
    864 C  SET THE STORM NAME, DATE AND TIME
    865 
    866             CALL SETDTS(IDATEZ,IUTCZ,STMNAM(KST)//STMID(KST))
    867 
    868 C  WRITE THE BOGUS AREA GEOMETRY TO BOGUS DOMAIN FILE
    869 
    870             IF(IBMETH(KST) .EQ. 1) THEN
    871                RMAXZ=RMXBOG(KST)
    872             ELSE
    873                RMAXZ=RMXSTM(KST)
    874             ENDIF
    875 
    876 C  CONSTRUCT BOGUS ENVIRONMENTAL DATA AT ALL TEMPLATE POINTS
    877 
    878 CCCC        IUNTFE=IUNTFE+1
    879             REWIND IUNTFE
    880             CALL FENBOG(IUNTFE,MMX,NNY,IBMETH(KST),RLATMN,RLATMX,RLONMN,
    881      1                  RLONMX,FRACST,ENVBOG,RLATP,RLONP,NPTS,MNIBOG,
    882      2                  modtyp)
    883             CLOSE(UNIT=IUNTFE,STATUS='KEEP')
    884 
    885             CALL RITCR2(IUNTBD,STMLAT(KST),STMLON(KST),RMAXZ,RLATMN,
    886      1                  RLATMX,STMNAM(KST),STMID(KST))
    887 
    888 C  ******  END ENVIRONMENTAL WIND SECTION  ******
    889 
    890          ELSE
    891 
    892 C  WHEN VORDIV=T, WE NEED THE FOLLOWING CALCULATIONS:
    893 C  CONSTRUCT A TEMPLATE SET OF POINTS FOR CALCULATING THE BOGUS
    894 C    ENVIRONMENTAL WINDS.
    895 C  WRITE DOMAIN BOUNDARIES TO THE BORDER FILE
    896 
    897             DELTAB=DELSTM
    898             ISHAPE=1
    899             ZLAT=ZNEAR(STMLAT(KST),DELTAB)
    900             ZLON=ZNEAR(STMLON(KST),DELTAB)
    901             CALL TEMPLT(ISHAPE,DELTAB,ZLAT,ZLON,RMXSTM(KST),MAXPTS,MMX,
    902      1                  NNY,RLATMN,RLATMX,RLONMN,RLONMX,RLATP,RLONP,
    903      2                  NPTS)
    904 
    905             CALL RITCR2(IUNTBD,STMLAT(KST),STMLON(KST),RMXSTM(KST),
    906      1                  RLATMN,RLATMX,STMNAM(KST),STMID(KST))
    907 
    908         ENDIF
    909 
    910 C  NOW, THE VORTEX:
    911 C  CONSTRUCT A VORTEX FOR EACH STORM
    912 C  **** IMPORTANT NOTE: FOR IVFLTP=1, THE VORTEX ALREADY EXISTS ON DISK

Page 18          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    913 C                       (A SEPARATE FILE FOR EACH VORTEX)
    914 C                       THE DATA ARE EXTRACTED IN MAKVOR USING ROUTINE
    915 C                       MM3DVO.
    916 
    917 C  COPY IN THE RADIUS OF 15 M/S WINDS IN EACH QUADRANT
    918 
    919          R15WND(1)=R15NE(KST)
    920          R15WND(2)=R15SE(KST)
    921          R15WND(3)=R15SW(KST)
    922          R15WND(4)=R15NW(KST)
    923          WRITE(6,307) VORDIV,IUNTVD,IUNTDH,SP1DWL,DIVFAC,IBMETH(KST),
    924      1                VTBOG(KST),NOBWMN
    925   307 FORMAT(/'...CALLING MAKVOR WITH VORDIV,IUNTVD,IUNTDH,SP1DWL,',
    926      1       'DIVFAC,IBMETH(KST),VTBOG(KST),NOBWMN='/4X,L2,2I4,F8.1,
    927      2       F6.2,I4,F8.2,I3)
    928          CALL MAKVOR(IDATEZ,IUTCZ,IUNTPN,IUNTPV,IUNTTK,IUNTDO,IUNTRV,
    929      1               IUNTBH,IUNTDH,IUNTVD,IOVITL,IVOTYP,IVFLTP,
    930      2               IBMETH(KST),DELTAB,DELTAV,SP1DWL,RLATMN,RLATMX,
    931      3               RLONMN,RLONMX,STMLAT(KST),STMLON(KST),STMDIR(KST),
    932      4               STMSPD(KST),RMXSTM(KST),PENV(KST),PCEN(KST),
    933      5               PTOP(KST),DIVFAC,PCENF,R15WND,VTBOG(KST),NOBWMN,
    934      6               VORDIV,STMID(KST),STMNAM(KST),ihrreq)
    935 
    936 C  SKIP ALL REMAINING PROCEDURES FOR VORTICITY/DIVERGENCE BOGUSING
    937 
    938          IF(VORDIV)  GO TO 1000
    939 
    940          WRITE(6,407) IUNTFV,IUNTTK,IUNTDO,FSTBOG
    941   407 FORMAT(/'...CALLING PROVOR WITH PROCESSED VORTEX FILE=',I3,
    942      1        ' DUMMY TRACK FILE=',I3,' DUMMY DOMAIN FILE=',I3,
    943      2        ' FSTBOG=',L2)
    944 
    945          CALL PROVOR(IUNTFV,IUNTTK,IUNTDO,FSTBOG)
    946          FSTBOG=.FALSE.
    947 
    948 C  COMBINE VORTEX AND ENVIRONMENTAL BOGUS DATA
    949 
    950          NNY2=2*NNY
    951 
    952 C  SET RADIUS FOR MINI BOGUSING AREA
    953 
    954          LSTORM = LSTORM + 1
    955 
    956          WRITE(IUNTBG,6283) LSTORM
    957  6283 FORMAT(' START HERE FOR STORM',I3)
    958          CALL COMBIN(IEFLTP,IUNTFE,MXUNTE,IUNTFV,ADVORT,IUNTBG,RLATMN,
    959      1               RLATMX,RLONMN,RLONMX,ENVBOG,MMX,NNY2,STMLAT(KST),
    960      2               STMLON(KST),STMDIR(KST),STMSPD(KST),IDATE(KST),
    961      3               IUTC(KST),PCEN(KST),RMXCMB,IBMETH(KST))
    962          WRITE(IUNTBG,6284) LSTORM
    963  6284 FORMAT(' END HERE FOR STORM',I3)
    964 
    965          BLATMN(LSTORM) = RLATMN
    966          BLATMX(LSTORM) = RLATMX
    967          BLONMN(LSTORM) = RLONMN
    968          BLONMX(LSTORM) = RLONMX
    969          vmax_save(lstorm) = vmax(kst)

Page 19          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

    970 
    971  1000    CONTINUE
    972       ENDDO
    973 
    974 C-----------------------------------------------------------------------
    975 
    976       IF(APPREP.AND.LSTORM.GT.0)  THEN
    977 
    978          REWIND IUNTBG
    979 
    980 C  COPY EXISTING PREPBUFR FILE TO A NEW VERSION AND ADD BOGUS DATA FROM
    981 C   ALL STORMS AT ONCE {ALSO CAN FLAG EXISTING PRESSURE DATA IN THE
    982 C   VICINITY OF THE STORM(S)}
    983 
    984          WRITE(6,971)
    985   971 FORMAT(/110('v')/110('v')/'...CALLING EDTPRP')
    986          CALL EDTPRP(BLATMN,BLATMX,BLONMN,BLONMX,RMW,STMLAT,STMLON,
    987      $               IUNTPN,IUNTPO,IUNTBG,LSTORM,vmax_save,stmnam)
    988          WRITE(6,972)
    989   972    FORMAT(/'...LEAVING EDTPRP'/110('a')/110('a')/)
    990       END IF
    991 
    992 C-----------------------------------------------------------------------
    993 
    994       WRITE(6,2003)
    995  2003 FORMAT(////20X,'******************************************'/
    996      1           20X,'******************************************'/
    997      2           20X,'****                                  ****'/
    998      3           20X,'**** SUCCESSFUL COMPLETION OF SYNDATA ****'/
    999      4           20X,'****                                  ****'/
   1000      5           20X,'******************************************'/
   1001      6           20X,'******************************************')
   1002 
   1003       CALL W3TAGE('SYNDAT_SYNDATA')
   1004       STOP
   1005       END

Page 20          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 MAIN__             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  573                                                            572                               
 1000                       Label  971                                                            780,938                           
 101                        Label  826                                                            822,824                           
 13                         Label  705                                                            704                               
 2003                       Label  995                                                            994                               
 201                        Label  843                                                            841,842                           
 3                          Label  637                                                            636                               
 307                        Label  925                                                            923                               
 4                          Label  640                                                            639                               
 407                        Label  941                                                            940                               
 431                        Label  566                                                            565                               
 51                         Label  748                                                            746                               
 6283                       Label  957                                                            956                               
 6284                       Label  963                                                            962                               
 971                        Label  985                                                            984                               
 972                        Label  989                                                            988                               
 ABRT1                      Subr   569                                                            569                               
 ADVORT                     Local  428      L(4)            4           scalar                    433,551,958                       
 APPREP                     Local  428      L(4)            4           scalar                    433,976                           
 BLATMN                     Local  449      R(4)            4     1     70                        965,986                           
 BLATMX                     Local  450      R(4)            4     1     70                        966,986                           
 BLONMN                     Local  450      R(4)            4     1     70                        967,986                           
 BLONMX                     Local  450      R(4)            4     1     70                        968,986                           
 BMISS                      Scalar 426      R(8)            8           scalar   COM              590,592                           
 BOGMTH                     Subr   696                                                            696,714                           
 BUFRLIB_MISSING            Common 463                                  8                                                           
 COMBIN                     Subr   958                                                            958                               
 DEGLAT                     Local  480      R(4)            4           scalar                    480,802                           
 DELAVG                     Local  812      R(4)            4           scalar                    812,813,818                       
 DELSTM                     Local  802      R(4)            4           scalar                    802,812,856,897                   
 DELTA                      Local  436      R(4)            4           scalar                    436,480,754,802                   
 DELTAB                     Local  856      R(4)            4           scalar                    856,858,859,860,897,899,900,901,93
                                                                                                  0                                 
 DELTAV                     Local  436      R(4)            4           scalar                    436,481,930                       
 DIVFAC                     Local  435      R(4)            4           scalar                    435,555,923,933                   
 DO_BOGUS                   Scalar 440      CHAR            3           scalar   COM              558,559,560,595                   
 EDTPRP                     Subr   986                                                            986                               
 ENVBOG                     Local  458      R(4)            4     2     5000                      881,959                           
 ERPOS0                     Local  435      R(4)            4           scalar                    435                               
 ERREXIT                    Subr   645                                                            645                               
 FACRMW                     Local  436      R(4)            4           scalar                    436,483,704,793                   
 FAVWND                     Subr   829                                                            829                               
 FENBOG                     Subr   880                                                            880                               
 FLBWND                     Scalar 429      L(4)            4           scalar   COM              438,554,596                       

Page 21          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FLMASS                     Scalar 429      L(4)            4           scalar   COM              438,552,622                       
 FRACST                     Local  434      R(4)            4           scalar                    434,482,881                       
 FSTBOG                     Local  424      L(4)            4           scalar                    482,940,945,946                   
 FSTFLG                     Local  442      L(4)            4     1     70                        634,659                           
 FSTOCR                     Subr   658                                                            658                               
 GETBMISS                   Func   426      R(8)            8           scalar                    590                               
 GET_ENVIRONMENT_VARIABLE   Intrin 558                                                            558                               
 GRABEN                     Subr   772                                                            772                               
 GRABIM                     Subr   762                                                            762                               
 GRABIV                     Subr   764                                                            764                               
 IBMETH                     Local  453      I(4)            4     1     70                        659,686,698,716,720,732,736,755,87
                                                                                                  0,880,923,930,961                 
 IDATE                      Local  445      I(4)            4     1     70                        632,960                           
 IDATEZ                     Local  433      I(4)            4           scalar                    433,562,563,625,631,658,697,715,86
                                                                                                  6,928                             
 IDTTRK                     Local  434      I(4)            4           scalar                    434                               
 IEFLTP                     Local  465      I(4)            4           scalar                    465,958                           
 IERFST                     Local  659      I(4)            4           scalar                    659                               
 IERSRC                     Local  633      I(4)            4           scalar                    633,635,639                       
 IERVIT                     Local  634      I(4)            4           scalar                    634,635,636                       
 IHRMXT                     Local  434      I(4)            4           scalar                    434                               
 IHRREQ                     Local  634      I(4)            4           scalar                    634,698,716,934                   
 IHRWIN                     Local  435      I(4)            4           scalar                    435,475,631                       
 IMFLTP                     Local  436      I(4)            4           scalar                    436,465,759,772                   
 INPUT                      Local  433                                  scalar                    556,557                           
 IOFFT                      Local  563      I(4)            4           scalar                    563                               
 IONE                       Local  481      I(4)            4           scalar                    481,739                           
 IOPTF                      Local  481      I(4)            4           scalar                    481,658                           
 IOVITL                     Local  467      I(4)            4           scalar                    467,627,633,658,929               
 IPDUM                      Local  432      I(4)            4     1     12                        759                               
 IPREQ                      Local  431      I(4)            4     1     12                        437,485,759,762,764               
 IPREQZ                     Local  431      I(4)            4     1     12                        759                               
 IQUADX                     Param  422      I(4)            4           scalar                    458                               
 ISHAPE                     Local  753      I(4)            4           scalar                    753,754,811,813,857,860,898,901   
 ITRNCZ                     Local  848      I(4)            4           scalar                    848,851                           
 IUNTBD                     Local  468      I(4)            4           scalar                    468,625,885,905                   
 IUNTBG                     Local  471      I(4)            4           scalar                    471,956,958,962,978,987           
 IUNTBH                     Local  468      I(4)            4           scalar                    468,625,633,696,714,754,824,829,84
                                                                                                  2,850,929                         
 IUNTDH                     Local  468      I(4)            4           scalar                    468,923,929                       
 IUNTDO                     Local  467      I(4)            4           scalar                    467,928,940,945                   
 IUNTDT                     Local  467      I(4)            4           scalar                    467,563                           
 IUNTFE                     Local  471      I(4)            4           scalar                    471,879,880,883,958               
 IUNTFV                     Local  471      I(4)            4           scalar                    471,940,945,958                   
 IUNTGV                     Local  469      I(4)            4           scalar                    469,696,714                       
 IUNTMO                     Local  467      I(4)            4           scalar                    467,772                           
 IUNTPN                     Local  473      I(4)            4           scalar                    473,928,987                       
 IUNTPO                     Local  473      I(4)            4           scalar                    473,987                           
 IUNTPV                     Local  468      I(4)            4           scalar                    468,928                           
 IUNTRV                     Local  471      I(4)            4           scalar                    471,928                           
 IUNTSL                     Local  467      I(4)            4           scalar                    467,754                           
 IUNTTK                     Local  468      I(4)            4           scalar                    468,928,940,945                   
 IUNTVD                     Local  469      I(4)            4           scalar                    469,923,929                       
 IUTC                       Local  446      I(4)            4     1     70                        632,961                           
 IUTCZ                      Local  433      I(4)            4           scalar                    433,562,563,625,631,658,866,928   

Page 22          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IVDUM                      Local  432      I(4)            4     1     7                         760                               
 IVFLTP                     Local  434      I(4)            4           scalar                    434,465,759,764,929               
 IVOTYP                     Local  434      I(4)            4           scalar                    434,465,759,764,929               
 IVREQ                      Local  431      I(4)            4     1     7                         437,486,760,762,764               
 IVREQZ                     Local  431      I(4)            4     1     12                        760                               
 JVBOG                      Local  772      I(4)            4           scalar                    772,829                           
 KLDIM                      Param  418      I(4)            4           scalar                    431,432,771                       
 KLSTMZ                     Local  849      I(4)            4           scalar                    849,851                           
 KLVLS                      Local  771      I(4)            4           scalar                    771,772                           
 KS                         Local  746      I(4)            4           scalar                    746,747                           
 KST                        Local  656      I(4)            4           scalar                    656,658,659,663,664,665,666,686,68
                                                                                                  7,688,696,697,698,701,704,714,715,
                                                                                                  716,720,724,725,726,727,732,736,73
                                                                                                  8,739,740,779,780,792,793,795,799,
                                                                                                  813,814,817,822,824,825,829,841,84
                                                                                                  2,850,858,859,860,866,870,871,873,
                                                                                                  880,885,886,899,900,901,905,906,91
                                                                                                  9,920,921,922,923,924,930,931,932,
                                                                                                  933,934,959,960,961,969           
 KSTORM                     Local  631      I(4)            4           scalar                    631,656,747,754,779               
 KVDIM                      Param  417      I(4)            4           scalar                    431,432                           
 LSTORM                     Local  488      I(4)            4           scalar                    488,954,956,962,965,966,967,968,96
                                                                                                  9,976,987                         
 MAK111                     Scalar 429      L(4)            4           scalar   COM              438,553,596                       
 MAKVOR                     Subr   928                                                            928                               
 MAX                        Func   793                                  scalar                    793                               
 MAXBPT                     Param  421      I(4)            4           scalar                    421                               
 MAXPTS                     Param  421      I(4)            4           scalar                    456,458,754,814,860,901           
 MAXSTM                     Param  419      I(4)            4           scalar                    444,445,446,447,448,449,450,451,45
                                                                                                  3,454,631                         
 MIN                        Func   793                                  scalar                    793,795,802,812                   
 MMX                        Local  860      I(4)            4           scalar                    860,880,901,959                   
 MNIBOG                     Local  428      L(4)            4           scalar                    436,475,572,684,696,714,787,823,82
                                                                                                  5,830,841,842,851,881             
 MODNAM                     Local  435      I(4)            4           scalar                    435                               
 MODTYP                     Local  437      I(4)            4           scalar                    437,465,685,759,772,829,882       
 MWAVE                      Local  480      I(4)            4           scalar                    480,549                           
 MWAVEZ                     Local  433      I(4)            4           scalar                    433,549,689,847                   
 MWENV                      Local  847      I(4)            4           scalar                    847,851                           
 MXUNTE                     Local  465      I(4)            4           scalar                    465,958                           
 MZZ                        Local  814      I(4)            4           scalar                    814                               
 NNY                        Local  861      I(4)            4           scalar                    861,880,902,950                   
 NNY2                       Local  950      I(4)            4           scalar                    950,959                           
 NOBWMN                     Local  437      I(4)            4           scalar                    437,483,924,933                   
 NOGES                      Local  429      L(4)            4           scalar                    437,483,695,704                   
 NPREQ                      Local  437      I(4)            4           scalar                    437,486,759,762                   
 NPREQM                     Local  762      I(4)            4           scalar                    762,764                           
 NPTS                       Local  815      I(4)            4           scalar                    815,818,830,862,881,903           
 NVREQ                      Local  437      I(4)            4           scalar                    437,486,760,762                   
 NVREQM                     Local  762      I(4)            4           scalar                    762,764                           
 NZZ                        Local  814      I(4)            4           scalar                    814                               
 OKNBGR                     Local  428      L(4)            4           scalar                    435                               
 OUTFIL                     Local  428      L(4)            4           scalar                    434                               
 OVRFLG                     Local  424      L(4)            4     1     70                        755,780                           
 OVRLAP                     Subr   754                                                            754                               

Page 23          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PCEN                       Local  446      R(4)            4     1     70                        632,736,932,961                   
 PCENF                      Local  933      R(4)            4           scalar                    933                               
 PENV                       Local  446      R(4)            4     1     70                        632,736,932                       
 PREVEN                     Scalar 429      L(4)            4           scalar   COM              438                               
 PREVSW                     Common 460                                  4                                                           
 PROCSW                     Common 461                                  11                                                          
 PROVOR                     Subr   945                                                            945                               
 PTOP                       Local  447      R(4)            4     1     70                        632,822,825,829,933               
 PTOPAL                     Local  480      R(4)            4           scalar                    480,550                           
 PTOPAZ                     Local  433      R(4)            4           scalar                    433,550,633,762,764               
 QCFILE                     Local  428      L(4)            4           scalar                    433,481,634,659                   
 R15NE                      Local  448      R(4)            4     1     70                        633,663,724,919                   
 R15NW                      Local  448      R(4)            4     1     70                        633,666,727,922                   
 R15SE                      Local  448      R(4)            4     1     70                        633,664,725,920                   
 R15SW                      Local  448      R(4)            4     1     70                        633,665,726,921                   
 R15WND                     Local  458      R(4)            4     1     4                         663,664,665,666,724,725,726,727,91
                                                                                                  9,920,921,922,933                 
 RFAC                       Func   720      R(4)            4           scalar                    720,739                           
 RITCR1                     Subr   625                                                            625                               
 RITCR2                     Subr   885                                                            885,905                           
 RLATMN                     Local  437      R(4)            4           scalar                    437,814,861,880,885,902,906,930,95
                                                                                                  8,965                             
 RLATMX                     Local  438      R(4)            4           scalar                    438,814,861,880,886,902,906,930,95
                                                                                                  9,966                             
 RLATP                      Local  456      R(4)            4     1     2500                      755,815,817,829,861,881,902       
 RLONMN                     Local  814      R(4)            4           scalar                    814,861,880,902,931,959,967       
 RLONMX                     Local  815      R(4)            4           scalar                    815,861,881,902,931,959,968       
 RLONP                      Local  456      R(4)            4     1     2500                      755,815,817,829,861,881,902       
 RMAX                       Local  446      R(4)            4     1     70                        632,687,714,738,746,755           
 RMAXZ                      Local  871      R(4)            4           scalar                    871,873,885                       
 RMW                        Local  447      R(4)            4     1     70                        632,792,793,986                   
 RMXBOG                     Local  453      R(4)            4     1     70                        720,739,747,755,860,871           
 RMXCMB                     Local  793      R(4)            4           scalar                    793,795,799,802,961               
 RMXMNB                     Local  436      R(4)            4           scalar                    436,482,696,701,704               
 RMXMNI                     Local  454      R(4)            4     1     70                        697,701,704,793,795               
 RMXSTM                     Local  453      R(4)            4     1     70                        687,715,720,738,739,746,793,795,79
                                                                                                  9,814,817,822,824,873,901,905,932 
 RSMC                       Local  440      CHAR            4     1     70                        634                               
 RUNID                      Local  430      CHAR            6           scalar                    434,572,625                       
 SEARCH                     Subr   631                                                            631                               
 SETBMISS                   Subr   589                                                            589                               
 SETDTS                     Subr   866                                                            866                               
 SETFEN                     Subr   850                                                            850                               
 SETUP                      Subr   759                                                            759                               
 SLDATE                     Subr   563                                                            563                               
 SP1DWL                     Local  435      R(4)            4           scalar                    435,690,923,930                   
 SPCIFH                     Local  428      L(4)            4           scalar                    436,475                           
 STMDIR                     Local  445      R(4)            4     1     70                        632,850,931,960                   
 STMID                      Local  440      CHAR            3     1     70                        634,658,698,716,746,822,824,841,84
                                                                                                  2,866,886,906,934                 
 STMLAT                     Local  444      R(4)            4     1     70                        631,696,714,754,813,817,858,885,89
                                                                                                  9,905,931,959,986                 
 STMLON                     Local  444      R(4)            4     1     70                        631,697,715,755,813,817,859,885,90
                                                                                                  0,905,931,960,986                 
 STMNAM                     Local  440      CHAR            9     1     70                        634,658,698,716,746,822,824,841,84

Page 24          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  2,866,886,906,934,987             
 STMSPD                     Local  445      R(4)            4     1     70                        632,850,932,960                   
 SYNDAT_SYNDATA             Prog   415                                                                                              
 T111SW                     Common 462                                  4                                                           
 TEMPLT                     Subr   813                                                            813,860,901                       
 TEMWT                      Subr   817                                                            817                               
 UPROP                      Local  839      R(4)            4           scalar                    839,841,842,850                   
 VITLST                     Subr   627                                                            627                               
 VMAX                       Local  447      R(4)            4     1     70                        632,969                           
 VMAX_SAVE                  Local  451      R(4)            4     1     70                        969,987                           
 VORDIV                     Local  428      L(4)            4           scalar                    435,719,770,806,923,934,938       
 VPROP                      Local  840      R(4)            4           scalar                    840,841,842,850                   
 VTBOG                      Local  454      R(4)            4     1     70                        688,697,715,740,924,933           
 VTDFLT                     Local  482      R(4)            4           scalar                    482,740                           
 W3TAGB                     Subr   547                                                            547                               
 W3TAGE                     Subr   607                                                            607,644,1003                      
 WTP                        Local  456      R(4)            4     1     2500                      818,829                           
 ZLAT                       Local  858      R(4)            4           scalar                    858,860,899,901                   
 ZLON                       Local  859      R(4)            4           scalar                    859,860,900,901                   
 ZNEAR                      Func   858      R(4)            4           scalar                    858,859,899,900                   

Page 25          Source Listing                  SYNDAT_SYNDATA
2017-04-18 11:09                                 syndata.f

   1006 
   1007 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1008 C                .      .    .                                       .
   1009 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   1010 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   1011 C
   1012 C ABSTRACT: ??????????????????????????????????????????????????????????
   1013 C   ??????????????????????????????????????????????????????????????????
   1014 C
   1015 C PROGRAM HISTORY LOG:
   1016 C ????-??-??  S. J. LORD
   1017 C
   1018 C USAGE:    CALL ????????(????)
   1019 C   INPUT ARGUMENT LIST:
   1020 C     ??????   - ???????????????????????????????????????????????
   1021 C
   1022 C   OUTPUT ARGUMENT LIST:
   1023 C     ??????   - ???????????????????????????????????????????????
   1024 C
   1025 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   1026 C     ??????   - ???????????????????????????????????????????????
   1027 C
   1028 C   OUTPUT FILES:
   1029 C     ??????   - ???????????????????????????????????????????????
   1030 C
   1031 C REMARKS: ?????????????????????????????????????????????????????
   1032 C
   1033 C ATTRIBUTES:
   1034 C   LANGUAGE: FORTRAN 90
   1035 C   MACHINE:  NCEP WCOSS
   1036 C
   1037 C$$$
   1038       SUBROUTINE BOGMTH(IUNTGV,IUNTBH,MNIBOG,RMAXZ,STMLTZ,STMLNZ,VTBOGZ,
   1039      1                  RMXSTZ,IDATEZ,IBMTHZ,STMNMZ,STMIDZ,ihrreq)
   1040 
   1041       PARAMETER (MAXSTM=70)
   1042 
   1043       CHARACTER STMNAM*9,STMID*3,RSMC*4
   1044 
   1045       LOGICAL FSTFLG
   1046 
   1047       REAL(8)  DISTSP_8
   1048 
   1049       DIMENSION STMNAM(MAXSTM),STMLAT(MAXSTM),STMLON(MAXSTM),
   1050      1          STMDIR(MAXSTM),STMSPD(MAXSTM),IDATE(MAXSTM),
   1051      2          IUTC(MAXSTM),RMAX(MAXSTM),PENV(MAXSTM),PCEN(MAXSTM),
   1052      3          PTOP(MAXSTM),RSMC(MAXSTM),RMW(MAXSTM),VMAX(MAXSTM),
   1053      4          R15NW(MAXSTM),R15NE(MAXSTM),R15SE(MAXSTM),R15SW(MAXSTM),
   1054      5          STMID(MAXSTM),FSTFLG(MAXSTM)
   1055 
   1056       CHARACTER STMNMZ*(*),STMIDZ*(*)
   1057       LOGICAL MNIBOG
   1058 
   1059       DATA IOPT/5/,IPRNT/0/,IHRWIN/0/
   1060 
   1061 C  DECISION-MAKING PROGRAM FOR THE BOGUSING METHOD.
   1062 C    IBMETH=1: FIRST TIME STORM, NO CIRCULATION IN GUESS FIELD

Page 26          Source Listing                  BOGMTH
2017-04-18 11:09                                 syndata.f

   1063 C    IBMETH=2: >= SECOND TIME STORM, NO CIRCULATION IN GUESS FIELD
   1064 C    IBMETH=3: >= SECOND TIME STORM, DISPLACED CIRCULATION IN GUESS
   1065 C              FIELD LESS THAN OBSERVED RMAX (EXTENT OF STORM
   1066 C              CIRCULATION
   1067 C    IBMETH=4: > SECOND TIME STORM, DISPLACED CIRCULATION IN GUESS FIELD
   1068 C              GREATER THAN OBSERVED RMAX (EXTENT OF STORM CIRCULATION)
   1069 
   1070 C  PRELIMINARIES
   1071 
   1072       WRITE(6,1) IUNTGV,STMNMZ//STMIDZ,IBMTHZ,RMAXZ
   1073       WRITE(IUNTBH,1) IUNTGV,STMNMZ//STMIDZ,IBMTHZ,RMAXZ
   1074     1 FORMAT(/'...ENTERING BOGMTH AND READING GESVIT FROM UNIT',I3,
   1075      1       ' FOR STORM/ID,FIRST OCR.,OBS.RMAX=',/,4X,A,I3,F7.1)
   1076 
   1077 C  LOOK FOR THE STORM IN THE VITALS STATISTICS FORMAT FILE PRODUCED BY
   1078 C    PROGRAM GESSCN.
   1079 
   1080       IDTREQ  =IDATEZ
   1081       STMID(1)=STMIDZ
   1082       CALL NEWVIT(IUNTGV,IPRNT,IOPT,IERVIT,MAXSTM,KSTORM,IDTREQ,IHRREQ,
   1083      1            IHRWIN,IDATE,IUTC,STMLAT,STMLON,STMDIR,STMSPD,PCEN,
   1084      2            PENV,RMAX,VMAX,RMW,R15NE,R15SE,R15SW,R15NW,PTOP,
   1085      3            FSTFLG,STMNAM,STMID,RSMC)
   1086 
   1087       IF(KSTORM.LE.0)  THEN
   1088          RMXSTZ=RMAXZ
   1089          VTBOGZ=-99.0
   1090          WRITE(6,11)  KSTORM,RMAXZ,VTBOGZ
   1091          WRITE(IUNTBH,11)  KSTORM,RMAXZ,VTBOGZ
   1092    11    FORMAT(/'...KSTORM=',I3,', WHICH MEANS THAT THE STORM COULD ',
   1093      1          'NOT BE IDENTIFIED IN THE GUESS FIELD.'/4X,'RMAX IS ',
   1094      2          'KEPT AT',F7.1,' KM. AND VTBOGZ=',F7.1)
   1095          WRITE(6,641) IBMTHZ,RMAXZ,RMXSTZ,VTBOGZ
   1096          WRITE(IUNTBH,641) IBMTHZ,RMAXZ,RMXSTZ,VTBOGZ
   1097   641    FORMAT('...LEAVING BOGMTH WITH IBMTHZ,RMAXZ,RMXSTZ,VTBOGZ='/4X,
   1098      1          I3,3F8.2)
   1099 
   1100       ELSE
   1101          WRITE(6,7) KSTORM,STMLAT(KSTORM),STMLON(KSTORM)
   1102          WRITE(IUNTBH,7) KSTORM,STMLAT(KSTORM),STMLON(KSTORM)
   1103     7    FORMAT('...GESVIT FILE HAS PRODUCED',I3,' RECORDS WITH ',
   1104      1          'LAT/LON=',2F8.2)
   1105          IF(KSTORM .EQ. 1)  THEN
   1106             WRITE(6,15)
   1107             WRITE(IUNTBH,15)
   1108    15       FORMAT('...CIRCULATION HAS BEEN FOUND IN THE GUESS FIELD.')
   1109 
   1110             GESERR=DISTSP_8(STMLAT(KSTORM),STMLON(KSTORM),STMLTZ,STMLNZ)
   1111      1       * 1.E-3
   1112 
   1113             IF(MNIBOG)  THEN
   1114                WRITE(6,17)  GESERR,RMAXZ
   1115                WRITE(IUNTBH,17)  GESERR,RMAXZ
   1116    17          FORMAT(/'...GUESS ERROR=',F8.1,' KM AND INITIAL MINI-',
   1117      1                'BOGUSING AREA COVERAGE=',F8.1)
   1118                IF(GESERR .GT. RMAXZ)  THEN
   1119                   RMXSTZ=GESERR

Page 27          Source Listing                  BOGMTH
2017-04-18 11:09                                 syndata.f

   1120                   WRITE(6,19)
   1121                   WRITE(IUNTBH,19)
   1122    19             FORMAT('...GUESS ERROR EXCEEDS AREA COVERAGE.  ',
   1123      1                   'COVERAGE EXPANDED.')
   1124                ELSE
   1125                   RMXSTZ=RMAXZ
   1126                   WRITE(6,21)
   1127                   WRITE(IUNTBH,21)
   1128    21             FORMAT('...GUESS ERROR LESS THAN AREA COVERAGE.  ',
   1129      1                   'COVERAGE REMAINS THE SAME.')
   1130                ENDIF
   1131 
   1132 C  STANDARD WIND BOGUSING TECHNIQUE.
   1133 
   1134             ELSE
   1135                IF(GESERR+RMAX(KSTORM) .LE. RMAXZ)  THEN
   1136                   IBMTHZ=3
   1137                   RMXSTZ=RMAXZ
   1138                ELSE
   1139                   IBMTHZ=4
   1140                   RMXSTZ=RMAXZ
   1141                ENDIF
   1142 
   1143                VTBOGZ=VMAX(KSTORM)
   1144             ENDIF
   1145             WRITE(6,41) IBMTHZ,RMAXZ,GESERR,RMAX(KSTORM),RMXSTZ,VTBOGZ
   1146             WRITE(IUNTBH,41) IBMTHZ,RMAXZ,GESERR,RMAX(KSTORM),RMXSTZ,
   1147      1                       VTBOGZ
   1148    41       FORMAT('...LEAVING BOGMTH WITH IBMTHZ,RMAXZ,GESERR,',
   1149      1             'RMAX(KSTORM),RMXSTZ,VTBOGZ=',/,4X,I3,5F8.2)
   1150 
   1151          ELSE
   1152             WRITE(6,31)  KSTORM
   1153    31       FORMAT(/'******KSTORM=',I4,', WHICH IS GREATER THAN ',
   1154      1             'ALLOWED FROM GESSCN.')
   1155             CALL ABRT1(' BOGMTH',31)
   1156          ENDIF
   1157 
   1158       ENDIF
   1159 
   1160       RETURN
   1161       END

Page 28          Source Listing                  BOGMTH
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 bogmth_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  1074                                                           1072,1073                         
 11                         Label  1092                                                           1090,1091                         
 15                         Label  1108                                                           1106,1107                         
 17                         Label  1116                                                           1114,1115                         
 19                         Label  1122                                                           1120,1121                         
 21                         Label  1128                                                           1126,1127                         
 31                         Label  1153                                                           1152                              
 41                         Label  1148                                                           1145,1146                         
 641                        Label  1097                                                           1095,1096                         
 7                          Label  1103                                                           1101,1102                         
 ABRT1                      Subr   1155                                                           1155                              
 BOGMTH                     Subr   1038                                                                                             
 DISTSP_8                   Func   1047     R(8)            8           scalar                    1110                              
 FSTFLG                     Local  1045     L(4)            4     1     70                        1085                              
 GESERR                     Local  1110     R(4)            4           scalar                    1110,1114,1115,1118,1119,1135,1145
                                                                                                  ,1146                             
 IBMTHZ                     Dummy  1039     I(4)            4           scalar   ARG,INOUT        1072,1073,1095,1096,1136,1139,1145
                                                                                                  ,1146                             
 IDATE                      Local  1050     I(4)            4     1     70                        1083                              
 IDATEZ                     Dummy  1039     I(4)            4           scalar   ARG,INOUT        1080                              
 IDTREQ                     Local  1080     I(4)            4           scalar                    1080,1082                         
 IERVIT                     Local  1082     I(4)            4           scalar                    1082                              
 IHRREQ                     Dummy  1039     I(4)            4           scalar   ARG,INOUT        1082                              
 IHRWIN                     Local  1059     I(4)            4           scalar                    1059,1083                         
 IOPT                       Local  1059     I(4)            4           scalar                    1059,1082                         
 IPRNT                      Local  1059     I(4)            4           scalar                    1059,1082                         
 IUNTBH                     Dummy  1038     I(4)            4           scalar   ARG,INOUT        1073,1091,1096,1102,1107,1115,1121
                                                                                                  ,1127,1146                        
 IUNTGV                     Dummy  1038     I(4)            4           scalar   ARG,INOUT        1072,1073,1082                    
 IUTC                       Local  1051     I(4)            4     1     70                        1083                              
 KSTORM                     Local  1082     I(4)            4           scalar                    1082,1087,1090,1091,1101,1102,1105
                                                                                                  ,1110,1135,1143,1145,1146,1152    
 MAXSTM                     Param  1041     I(4)            4           scalar                    1049,1050,1051,1052,1053,1054,1082
 MNIBOG                     Dummy  1038     L(4)            4           scalar   ARG,INOUT        1113                              
 NEWVIT                     Subr   1082                                                           1082                              
 PCEN                       Local  1051     R(4)            4     1     70                        1083                              
 PENV                       Local  1051     R(4)            4     1     70                        1084                              
 PTOP                       Local  1052     R(4)            4     1     70                        1084                              
 R15NE                      Local  1053     R(4)            4     1     70                        1084                              
 R15NW                      Local  1053     R(4)            4     1     70                        1084                              
 R15SE                      Local  1053     R(4)            4     1     70                        1084                              
 R15SW                      Local  1053     R(4)            4     1     70                        1084                              
 RMAX                       Local  1051     R(4)            4     1     70                        1084,1135,1145,1146               
 RMAXZ                      Dummy  1038     R(4)            4           scalar   ARG,INOUT        1072,1073,1088,1090,1091,1095,1096

Page 29          Source Listing                  BOGMTH
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,1114,1115,1118,1125,1135,1137,114
                                                                                                  0,1145,1146                       
 RMW                        Local  1052     R(4)            4     1     70                        1084                              
 RMXSTZ                     Dummy  1039     R(4)            4           scalar   ARG,INOUT        1088,1095,1096,1119,1125,1137,1140
                                                                                                  ,1145,1146                        
 RSMC                       Local  1043     CHAR            4     1     70                        1085                              
 STMDIR                     Local  1050     R(4)            4     1     70                        1083                              
 STMID                      Local  1043     CHAR            3     1     70                        1081,1085                         
 STMIDZ                     Dummy  1039     CHAR                        scalar   ARG,INOUT        1072,1073,1081                    
 STMLAT                     Local  1049     R(4)            4     1     70                        1083,1101,1102,1110               
 STMLNZ                     Dummy  1038     R(4)            4           scalar   ARG,INOUT        1110                              
 STMLON                     Local  1049     R(4)            4     1     70                        1083,1101,1102,1110               
 STMLTZ                     Dummy  1038     R(4)            4           scalar   ARG,INOUT        1110                              
 STMNAM                     Local  1043     CHAR            9     1     70                        1085                              
 STMNMZ                     Dummy  1039     CHAR                        scalar   ARG,INOUT        1072,1073                         
 STMSPD                     Local  1050     R(4)            4     1     70                        1083                              
 VMAX                       Local  1052     R(4)            4     1     70                        1084,1143                         
 VTBOGZ                     Dummy  1038     R(4)            4           scalar   ARG,INOUT        1089,1090,1091,1095,1096,1143,1145
                                                                                                  ,1147                             

Page 30          Source Listing                  BOGMTH
2017-04-18 11:09                                 syndata.f

   1162 
   1163 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1164 C                .      .    .                                       .
   1165 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   1166 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   1167 C
   1168 C ABSTRACT: ??????????????????????????????????????????????????????????
   1169 C   ??????????????????????????????????????????????????????????????????
   1170 C
   1171 C PROGRAM HISTORY LOG:
   1172 C ????-??-??  S. J. LORD
   1173 C
   1174 C USAGE:    CALL ????????(????)
   1175 C   INPUT ARGUMENT LIST:
   1176 C     ??????   - ???????????????????????????????????????????????
   1177 C
   1178 C   OUTPUT ARGUMENT LIST:
   1179 C     ??????   - ???????????????????????????????????????????????
   1180 C
   1181 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   1182 C     ??????   - ???????????????????????????????????????????????
   1183 C
   1184 C   OUTPUT FILES:
   1185 C     ??????   - ???????????????????????????????????????????????
   1186 C
   1187 C REMARKS: ?????????????????????????????????????????????????????
   1188 C
   1189 C ATTRIBUTES:
   1190 C   LANGUAGE: FORTRAN 90
   1191 C   MACHINE:  NCEP WCOSS
   1192 C
   1193 C$$$
   1194 C     *****************************
   1195 C     ****  SUBROUTINE GRABMO  ****
   1196 C     ****     ENTRY GRABIM    ****
   1197 C     ****     ENTRY GRABEN    ****
   1198 C     ****     ENTRY FAVWND    ****
   1199 C     ****     ENTRY SETFEN    ****
   1200 C     ****     ENTRY FENBOG    ****
   1201 C     ****     ENTRY FNDCTR    ****
   1202 C     *****************************
   1203 C
   1204       SUBROUTINE GRABMO(IUNTMO,IUNTBH,MODTYP,IMFLTZ,JVARS,KLVLS,KLSTMZ,
   1205      1                  ENVBOG,JVBOG,RLATP,RLONP,WTP,NPTS,PT,FRACST,
   1206      2                  MWENVZ,ITRNCZ,IMETHZ,MNIBOG,iuntfe,mmx,nny,
   1207      3                  rlatmn,rlatmx,rlonmn,rlonmx,ipreq,ivreq,klmax,
   1208      4                  jvmax,dirstm,spdstm,uprop,vprop)
   1209 
   1210       PARAMETER(MAXBGK=10)
   1211       PARAMETER(MAXBGV= 7)
   1212       PARAMETER (MAXWVT=8)
   1213       PARAMETER (MAXAVL=2*MAXBGK-1)
   1214 
   1215       PARAMETER (MDIM=35,NDIM=35)
   1216       PARAMETER (KLDIM= 8)
   1217       PARAMETER (KDTDIM=5)
   1218       PARAMETER (KDXDIM=KDTDIM*KLDIM)

Page 31          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1219 
   1220       CHARACTER MTITLE*102
   1221 
   1222       LOGICAL MNIBOG
   1223 
   1224       SAVE
   1225 
   1226       DIMENSION IPREQ(KLVLS),ILVL(MAXBGK),INDXP(MAXBGK),IVREQ(JVARS),
   1227      1          IVAR(MAXBGV),INDXV(MAXBGV),IPREQZ(MAXBGK),
   1228      2          IVREQZ(MAXBGV),IWVREQ(MAXWVT),IWVRQZ(MAXWVT)
   1229       DIMENSION RLATP(NPTS),RLONP(NPTS),WTP(NPTS),
   1230      1          STRWND(MAXWVT,MAXAVL,4),PWT(MAXAVL),ILVAV(MAXAVL),
   1231      2          STRDIF(MAXWVT,MAXAVL,2)
   1232       DIMENSION ENVBOG(NPTS,2),CORNR(4,2),ZCORN(4,2),IWVCRN(2),ITCRN(2)
   1233 
   1234       DIMENSION A(KDXDIM,MDIM,NDIM)
   1235 
   1236 C  ****************************************************************
   1237 C  ****************************************************************
   1238 C  ****  IMPORTANT NOTE:  GRABEN IS CALLED ONCE AND FOR ALL    ****
   1239 C  ****  FOR SPECTRAL MODELS SINCE COEFFICIENTS ARE GLOBAL.    ****
   1240 C  ****  HOWEVER, FOR A LIMITED AREA MODEL, CALLS TO STORE     ****
   1241 C  ****  THE MODEL GRID POINTS INTO ARRAY MUST BE DONE ON      ****
   1242 C  ****  ON A STORM BY STORM BASIS.  IMPORTANT CHANGE:         ****
   1243 C  ****  8/22/90: ARRAY MADE LOCAL TO SUBROUTINE SPMODL/GPMODL ****
   1244 C  ****************************************************************
   1245 C  ****************************************************************
   1246 C
   1247 C  KEY TO REQUESTED INPUT LEVELS AND VARIABLES:
   1248 C
   1249 C       INPUT LEVELS ARE CURRENTLY A CHOICE OF MANDATORY PRESSURES
   1250 C         FROM 1000-100 KPA
   1251 C
   1252 C       INPUT VARIABLES ARE:
   1253 C
   1254 C         1) TEMPERATURE
   1255 C         2) RELATIVE HUMIDITY
   1256 C         3) HEIGHT
   1257 C         4) U WIND
   1258 C         5) V WIND
   1259 C         6) VORTICITY (TO GET ROTATIONAL WIND)
   1260 C         7) DIVERGENCE (TO GET DIVERGENT WIND)
   1261 
   1262       DATA IWVREQ/5,6,8,10,20,30,40,80/,NWVRQ1/1/,NWVRQ2/7/,IROMB/1/,
   1263      1     ITRIA/0/,I40WV/40/,IWRITE/6/
   1264 
   1265 C  THIS SUBROUTINE DIRECTS THE GRABBING OF THE PROPER INFORMATION FROM
   1266 C    THE APPROPRIATE FILE CONTAINING THE ENVIRONMENTAL FIELDS.  THERE
   1267 C    ARE SEVERAL STEPS:
   1268 
   1269 C    FIRST: PERFORM SOME BASIC CHECKS FOR SPACE AVAILABILITY FOR BOTH
   1270 C           LEVELS AND NUMBER OF VARIABLES
   1271 
   1272 C    SECOND: DETERMINE THE AVAILABILITY OF VARIOUS VERTICAL LEVELS AND
   1273 C            VARIABLES AND SET UP THE READING INDICES FOR EACH LEVEL
   1274 C            (INDXP) AND EACH VARIABLE (INDXV)
   1275 

Page 32          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1276 C    THIRD: PERFORM SOME BASIC SPACE CHECK ON MODEL HORIZONTAL STORAGE.
   1277 C           THEN READ THE ENVIRONMENTAL FIELD FILE AND PUT THE REQUIRED
   1278 C           INFORMATION INTO ARRAY.  THIS INFORMATION CAN BE EITHER
   1279 C           SPECTRAL COEFFICIENTS OR GRID POINT INFORMATION.
   1280 C           SUFFICIENT STORAGE MUST BE ALLOCATED IN THE CALLING PROGRAM.
   1281 
   1282 C  ENTER THE MAXIMUM LEVEL TO BE CONSIDERED FOR ALL STORMS
   1283 
   1284 C-----------------------------------------------------------------------
   1285 
   1286 C  ++++++++++++++++++++++++
   1287 C  ++++  ENTRY GRABIM  ++++
   1288 C  ++++++++++++++++++++++++
   1289 C
   1290       ENTRY GRABIM(IPREQ,KLVLS,IVREQ,JVARS,KLMAX,JVMAX,PT)
   1291 
   1292 C  FOR PHYSICAL REASONS AS WELL AS COMPUTATIONAL EFFICIENCY, WE
   1293 C    CONSIDER ONLY A SINGLE LEVEL ABOVE THE LEVEL OF THE DEEPEST
   1294 C    CYCLONIC CIRCULATION (PT)
   1295 
   1296       DO KL=1,KLVLS
   1297          NPREQ=KL
   1298          IF(NINT(PT*10.) .GE. IPREQ(KL)*10)  GO TO 2
   1299       ENDDO
   1300     2 CONTINUE
   1301 
   1302       IF(NPREQ .NE. KLVLS)  THEN
   1303       WRITE(6,3) NPREQ,IPREQ(NPREQ),KLVLS,IPREQ(KLVLS)
   1304     3 FORMAT(/'...IN GRABIM, REQUESTED LEVELS HAVE BEEN TRUNCATED ',
   1305      1       'TO CONFORM TO THE HEIGHT OF THE DEEPEST CYCLONIC ',
   1306      2       'CIRCULATION.'/4X,'TRUNCATED, REQUESTED INDEX, PRESSURE ',
   1307      3       'LEVEL ARE',4I5)
   1308       ENDIF
   1309 
   1310 C  STORE REQUESTED PRESSURE LEVELS AND VARIABLES LOCALLY.  THEN PERFORM
   1311 C    SOME BASIC CHECKS FOR SUFFICIENT SPACE, LEVELS THEN VARIABLES
   1312 
   1313 C  STORE LEVELS TO BE BOGUSED HERE
   1314 
   1315       NP=0
   1316       DO 5 NZ=1,NPREQ
   1317 
   1318       IF(NP .LE. MAXBGK)  THEN
   1319       NP=NP+1
   1320       IPREQZ(NP)=IPREQ(NZ)
   1321 
   1322       ELSE
   1323       WRITE(6,4) KLVLS,NPREQ,NP
   1324     4 FORMAT(/'******INSUFFICIENT STORAGE ALLOCATED FOR STORING ',
   1325      1       'LOCATION INDICES IN GRABIM.',/,10X,'REQUESTED SPACE=',
   1326      2       'KLVLS=',I5,' WHILE REQUIRED SPACE=NPREQ=',I5,/,10X,
   1327      3       'LEVELS WILL BE REDUCED TO KLMAX=',I5,' ACCORDINGLY')
   1328       GO TO 6
   1329       ENDIF
   1330 
   1331     5 CONTINUE
   1332 

Page 33          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1333     6 KLMAX=NP
   1334 
   1335 C  STORE VARIABLES TO BE BOGUSED HERE
   1336 
   1337       NV=0
   1338       DO 15 NZ=1,JVARS
   1339       IF(NV .LE. MAXBGV)  THEN
   1340       NV=NV+1
   1341       IVREQZ(NV)=IVREQ(NZ)
   1342 
   1343       ELSE
   1344       WRITE(6,14) JVARS,MAXBGV
   1345    14 FORMAT(/'******INSUFFICIENT STORAGE ALLOCATED FOR STORING ',
   1346      1       'LOCATION INDICES IN GRABIM.',/,10X,'REQUESTED SPACE=',
   1347      2       'JVARS=',I5,' WHILE AVAILABLE SPACE=MAXBGV=',I5,/,10X,
   1348      3       'THEREFORE, WE MUST TERMINATE THE PROGRAM')
   1349       CALL ABRT1(' GRABIM',14)
   1350 
   1351       ENDIF
   1352 
   1353    15 CONTINUE
   1354 
   1355       JVMAX=NV
   1356 
   1357       klmaxx=klmax
   1358       jvmaxx=jvmax
   1359 
   1360       RETURN
   1361 
   1362 C-----------------------------------------------------------------------
   1363 
   1364 C  ++++++++++++++++++++++++
   1365 C  ++++  ENTRY GRABEN  ++++
   1366 C  ++++++++++++++++++++++++
   1367 
   1368       ENTRY GRABEN(IUNTMO,MODTYP,IMFLTZ,KLVLS,JVBOG)
   1369 
   1370 C  SET THE VERTICAL INDEXING FOR EACH MODEL AND FILE TYPE.  MODEL AND
   1371 C    FILE TYPES ARE CATALOGED IN SUBROUTINE SETMOD AND BELOW:
   1372 
   1373 C    CURRENT MODEL AND FILE TYPES ARE:
   1374 C      MODTYP= 0: BOGUSING METHOD IS NOT MODEL DEPENDENT
   1375 C      MODTYP= 1: SPECTRAL MODEL
   1376 
   1377 C    FILE TYPES:
   1378 C      IMFLTP=1: NCEP GLOBAL SPECTRAL MODEL, OPERATIONAL R40 PRESSURE
   1379 C                COEFFICIENT FILE == CALL SLVSP1 TO SET UP VERTICAL
   1380 C                                    LEVELS
   1381 C                                 == CALL SVRSP1 TO SET UP VARIABLES
   1382 C      IMFLTP=2: NCEP GLOBAL SPECTRAL MODEL, OPERATIONAL PRESSURE
   1383 C                COEFFICIENTS OF VORTICITY, DIVERGENCE
   1384 C                                 == CALL SLVSP2 TO SET UP VERTICAL
   1385 C                                    LEVELS
   1386 C                                 == CALL SVRSP2 TO SET UP VARIABLES
   1387 C      IMFLTP>2: NOT IMPLEMENTED
   1388 
   1389 C      MODTYP=-1: GRID POINT MODEL  *** NOT IMPLEMENTED ***

Page 34          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1390 
   1391       IMFLTP=IMFLTZ
   1392       WRITE(6,31)  MODTYP,IMFLTP,KLVLS,NPREQ
   1393    31 FORMAT(/'...ENTERING GRABEN, MODTYP,IMFLTP,KLVLS,NPREQ=',4I6)
   1394       IF(MODTYP .EQ. 0 .OR. MODTYP .EQ. 1)  THEN
   1395       IF(IMFLTP .EQ. 1)  THEN
   1396         CALL SLVSP1(KLMAXx,IPREQZ,ILVL,INDXP,KLBOG)
   1397         CALL SVRSP1(JVMAXx,IVREQZ,IVAR,INDXV,JVBOGZ)
   1398       ELSE IF(IMFLTP .EQ. 2)  THEN
   1399         CALL SLVSP2(KLMAXx,IPREQZ,ILVL,INDXP,KLBOG)
   1400         CALL SVRSP2(JVMAXx,IVREQZ,IVAR,INDXV,JVBOGZ)
   1401       ENDIF
   1402       JVBOG=JVBOGZ
   1403 
   1404       ELSE IF(MODTYP .EQ. -1) THEN
   1405       WRITE(6,51) MODTYP
   1406    51 FORMAT(/'******MODTYP=',I5,' (GRID PT MODEL) IS NOT INSTALLED')
   1407       CALL ABRT1(' GRABEN',51)
   1408       ELSE
   1409       WRITE(6,61) MODTYP
   1410    61 FORMAT(/'******MODTYP=',I5,' (UNKNOWN MODEL) IS NOT INSTALLED')
   1411       CALL ABRT1(' GRABEN',61)
   1412       ENDIF
   1413 C
   1414       WRITE(6,81) (KP,IPREQZ(KP),KP=1,KLMAXx)
   1415    81 FORMAT(/'...REQUESTED PRESSURE LEVELS IN GRABEN ARE:'/(10X,2I5))
   1416       WRITE(6,83) MODTYP,IMFLTP,(KP,ILVL(KP),INDXP(KP),KP=1,KLBOG)
   1417    83 FORMAT(/'...FOR MODEL TYPE=',I3,' AND MODEL FILE TYPE=',I3,','/4X,
   1418      1       'ACTUAL PRESSURE LEVELS AND INDICES IN GRABEN ARE:'/(10X,
   1419      2       3I5))
   1420       WRITE(6,87) (JV,IVREQZ(JV),JV=1,JVMAXx)
   1421    87 FORMAT(/'...REQUESTED VARIABLES IN GRABEN ARE:'/(10X,2I5))
   1422       WRITE(6,89) MODTYP,IMFLTP,(JV,IVAR(JV),INDXV(JV),JV=1,JVBOG)
   1423    89 FORMAT(/'...FOR MODEL TYPE=',I3,' AND MODEL FILE TYPE=',I3,','/4X,
   1424      1        'ACTUAL VARIABLES AND INDICES IN GRABEN ARE:'/(10X,3I5))
   1425 
   1426 C  READ THE ENVIRONMENTAL FIELD FILE
   1427 
   1428       IF(MODTYP .EQ. 1)  THEN
   1429       CALL MODL1(IUNTMO,KLBOG,JVBOG,
   1430      1           MWAVE,INDXP,INDXV)
   1431       IF(IMFLTP .EQ. 1) CALL RDSPP1(IUNTMO,KLBOG,JVBOG,
   1432      1                              MWAVE,INDXP,INDXV)
   1433       IF(IMFLTP .EQ. 2)
   1434      1   CALL RDSPP2(IUNTMO,KLBOG,JVBOG,MWAVE,INDXP,INDXV)
   1435       ENDIF
   1436 
   1437       KLVLS=KLBOG
   1438       RETURN
   1439 
   1440 C-----------------------------------------------------------------------
   1441 
   1442 C  ++++++++++++++++++++++++
   1443 C  ++++  ENTRY FAVWND  ++++
   1444 C  ++++++++++++++++++++++++
   1445 
   1446       ENTRY FAVWND(MODTYP,JVBOG,IUNTBH,PT,RLONP,RLATP,WTP,NPTS,MNIBOG)

Page 35          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1447 
   1448 C  CHOSE WAVE NUMBER TRUNCATION
   1449 
   1450       ITRNC=ITRIA
   1451       MWV=0
   1452       DO 100 MW=NWVRQ1,NWVRQ2
   1453       IF(IWVREQ(MW) .LE. MWAVE)  THEN
   1454       MWV=MWV+1
   1455       IWVRQZ(MWV)=IWVREQ(MW)
   1456       ENDIF
   1457   100 CONTINUE
   1458 
   1459       WRITE(6,101)  JVBOG,KLBOG,MODTYP,IMFLTP,NWVRQ1,NWVRQ2,MWV,MNIBOG,
   1460      1              (IWVRQZ(MM),MM=1,MWV)
   1461   101 FORMAT(/'...IN FAVWND, JVBOG,KLBOG,MODTYP,IMFLTP,NWVRQ1,NWVRQ2,',
   1462      1       'MWV,MNIBOG,REQUESTED TRUNCS=',7I5,L2/10X,(10I5)//)
   1463 
   1464 C  FIND INDEX FOR VORTICITY FIELD
   1465 
   1466       JVWND=-1
   1467       DO 110 JV=1,JVBOG
   1468       IF(IVAR(JV) .EQ. 6)  THEN
   1469       JWNDVR=1
   1470       JVWND=JV
   1471       IPLUS=0
   1472       ENDIF
   1473   110 CONTINUE
   1474 
   1475       IF(JVWND .LT. 0)  THEN
   1476       WRITE(6,111) JVBOG
   1477   111 FORMAT(/'******VORTICITY FIELD COULD NOT BE FOUND. NOW WE LOOK',
   1478      1       ' FOR INDEX OF TOTAL WIND, JVBOG=',I5)
   1479       DO 120 JV=1,JVBOG
   1480       IF(IVAR(JV) .EQ. 4)  THEN
   1481       JWNDVR=2
   1482       JVWND=JV
   1483       IPLUS=1
   1484       ENDIF
   1485   120 CONTINUE
   1486 
   1487       IF(JVWND .LT. 0)  THEN
   1488       WRITE(6,121) JVBOG,(IVAR(JV),JV=1,JVBOG)
   1489   121 FORMAT(/'******SERIOUS ERROR AT #120 IN FAVWND: WIND INDEX ',
   1490      1       ' COULD NOT BE FOUND. JVBOG,IVAR=',I5,/,(9X,10I5))
   1491       CALL ABRT1(' FAVWND',120)
   1492       ENDIF
   1493 
   1494       ENDIF
   1495 
   1496 C  DETERMINE TOP LEVEL FOR EACH STORM
   1497 
   1498       DO 130 KL=1,KLBOG
   1499       KLSTM=KL
   1500       IF(NINT(PT*10.) .GE. ILVL(KL)*10)  GO TO 131
   1501   130 CONTINUE
   1502   131 CONTINUE
   1503       IF(MNIBOG)  RETURN

Page 36          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1504 
   1505 C  LOOP OVER ALL LEVELS AND SPECTRAL TRUNCATIONS FOR ALL TEMPLATE POINTS
   1506 
   1507       DLEV1=0.5*REAL(ILVL(1)-ILVL(2))
   1508       DO 160 KL=1,KLSTM
   1509       IF(KL .LT. KLSTM)  DLEV2=0.5*REAL(ILVL(KL)-ILVL(KL+1))
   1510 
   1511       DO 150 MW=1,MWV
   1512 
   1513       UWND=0.0
   1514       VWND=0.0
   1515 
   1516       DO 145 JWN=1,JWNDVR
   1517 
   1518       WT=0.0
   1519       JVWNDZ=JVWND+JWN-1
   1520 
   1521       IF(MODTYP .EQ. 1)  THEN
   1522       IF(JWN .EQ. 1)  THEN
   1523 
   1524 c  && 4 comments
   1525 CC    WRITE(6,132) KL,JVWNDZ,ILVL(KL),IVAR(JVWNDZ),IWVRQZ(MW),IPLUS,
   1526 CC   1             ITRNC
   1527 CC132 FORMAT(/'...CALLING SETTRN FOR AVERAGE ENVIRONMENTAL WIND: ',
   1528 CC   1       'KL,JVWNDZ,LEVEL,IVAR,MWENV,IPLUS,ITRNC=',7I5)
   1529       CALL SETTRN(KL,JVWNDZ,IWVRQZ(MW),IPLUS,ITRNC)
   1530       ELSE
   1531 c  && 4 comments
   1532 CC    WRITE(6,134) KL,JVWNDZ,ILVL(KL),IVAR(JVWNDZ),IWVRQZ(MW),IPLUS,
   1533 CC   1             ITRNC
   1534 CC134 FORMAT(/'...CALLING SETRES FOR AVERAGE ENVIRONMENTAL WIND: ',
   1535 CC   1       'KL,JVWNDZ,LEVEL,IVAR,MWENV,IPLUS,ITRNC=',7I5)
   1536       CALL SETRES(KL,JVWNDZ,IWVRQZ(MW),IPLUS,ITRNC)
   1537       ENDIF
   1538       ENDIF
   1539 
   1540       DO 140 NP=1,NPTS
   1541 
   1542       XX=RLONP(NP)
   1543       YY=RLATP(NP)
   1544       WT=WT+WTP(NP)
   1545 
   1546       IF(MODTYP .EQ. 1)  THEN
   1547         IF(IVAR(JVWNDZ) .EQ. 6) THEN
   1548         CALL UROSP1(XX,YY,JVWNDZ,KL,IWVRQZ(MW),ITRNC,UOUT)
   1549         CALL VROSP1(XX,YY,JVWNDZ,KL,IWVRQZ(MW),ITRNC,VOUT)
   1550         UWND=UWND+UOUT*WTP(NP)
   1551         VWND=VWND+VOUT*WTP(NP)
   1552         ELSE IF(IVAR(JVWNDZ) .EQ. 4) THEN
   1553         CALL UVWSP1(XX,YY,JVWNDZ,KL,IWVRQZ(MW),IPLUS,ITRNC,UOUT)
   1554         UWND=UWND+UOUT*WTP(NP)
   1555         ELSE IF(IVAR(JVWNDZ) .EQ. 5) THEN
   1556         CALL UVWSP1(XX,YY,JVWNDZ,KL,IWVRQZ(MW),IPLUS,ITRNC,VOUT)
   1557         VWND=VWND+VOUT*WTP(NP)
   1558         ELSE
   1559         WRITE(6,137) JVWNDZ,IVAR(JVWNDZ),MODTYP
   1560   137   FORMAT(/'******WIND INDEX NOT EQUAL TO 6 OR 4 IN FAVWND,',

Page 37          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1561      1         'JVWNDZ,IVAR(JVWNDZ),MODTYP=',/,10X,3I5)
   1562         CALL ABRT1(' FAVWND',137)
   1563         ENDIF
   1564       ELSE
   1565       ENDIF
   1566 
   1567 c  && 2 comments
   1568 CC    WRITE(6,139) YY,XX,IWVRQZ(MW),ILVL(KL),UOUT,VOUT
   1569 CC139 FORMAT('...LAT,LON,WAVE,LEVEL,UOUT,VOUT=',2F10.2,2I5,2F10.3)
   1570 
   1571   140 CONTINUE
   1572 
   1573   145 CONTINUE
   1574       UWND=UWND/WT
   1575       VWND=VWND/WT
   1576       STRWND(MW,KL,1)=UWND
   1577       STRWND(MW,KL,2)=VWND
   1578       CALL UV2DS(UWND,VWND,STRWND(MW,KL,3),STRWND(MW,KL,4))
   1579       ILVAV(KL)=ILVL(KL)
   1580 
   1581   150 CONTINUE
   1582 
   1583       PWT(KL)=DLEV1+DLEV2
   1584       DLEV1=DLEV2
   1585   160 CONTINUE
   1586 
   1587 C  PRESSURE WEIGHTED LAYER AVERAGES
   1588 
   1589       KLAVG=2*KLSTM-1
   1590       DO 190 KLA=1,KLSTM-1
   1591 
   1592       DO 180 MW=1,MWV
   1593 
   1594       WT=0.0
   1595       STRWND(MW,KLA+KLSTM,1)=0.0
   1596       STRWND(MW,KLA+KLSTM,2)=0.0
   1597 
   1598       DO 170 KL=1,KLA+1
   1599       WT=WT+PWT(KL)
   1600       STRWND(MW,KLA+KLSTM,1)=STRWND(MW,KLA+KLSTM,1)+STRWND(MW,KL,1)*
   1601      1                       PWT(KL)
   1602       STRWND(MW,KLA+KLSTM,2)=STRWND(MW,KLA+KLSTM,2)+STRWND(MW,KL,2)*
   1603      1                       PWT(KL)
   1604   170 CONTINUE
   1605       STRWND(MW,KLA+KLSTM,1)=STRWND(MW,KLA+KLSTM,1)/WT
   1606       STRWND(MW,KLA+KLSTM,2)=STRWND(MW,KLA+KLSTM,2)/WT
   1607       CALL UV2DS(STRWND(MW,KLA+KLSTM,1),STRWND(MW,KLA+KLSTM,2),
   1608      1           STRWND(MW,KLA+KLSTM,3),STRWND(MW,KLA+KLSTM,4))
   1609       ILVAV(KLA+KLSTM)=ILVL(1)*1000+ILVL(KLA+1)
   1610 
   1611   180 CONTINUE
   1612   190 CONTINUE
   1613 
   1614       WRITE(6,191) (IWVRQZ(MW),MW=1,MWV)
   1615   191 FORMAT(/20X,'U WIND AT TRUNCATED WAVE NUMBER VS. PRESSURE'/
   1616      1       6X,'K',4X,'PRES',30X,'WAVE TRUNCATION',/,(15X,10I11,/))
   1617       DO 195 KL=1,KLAVG

Page 38          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1618       WRITE(6,193)  KL,ILVAV(KL),(STRWND(MW,KL,1),MW=1,MWV)
   1619   193 FORMAT(/3X,I3,I8,2X,10F11.3)
   1620   195 CONTINUE
   1621 
   1622       WRITE(6,197) (IWVRQZ(MW),MW=1,MWV)
   1623   197 FORMAT(///21X,'V WIND AT TRUNCATED WAVE NUMBER VS. PRESSURE'
   1624      1       ,/,6X,'K',4X,'PRES',30X,'WAVE TRUNCATION',/,(15X,10I11,/))
   1625       DO 200 KL=1,KLAVG
   1626       WRITE(6,199) KL,ILVAV(KL),(STRWND(MW,KL,2),MW=1,MWV)
   1627   199 FORMAT(/3X,I3,I8,2X,10F11.3)
   1628   200 CONTINUE
   1629 
   1630       WRITE(6,217) (IWVRQZ(MW),MW=1,MWV)
   1631       WRITE(IUNTBH,217) (IWVRQZ(MW),MW=1,MWV)
   1632   217 FORMAT(/////,20X,'DIRECTION AT TRUNCATED WAVE NUMBER VS. ',
   1633      1       'PRESSURE',/,6X,'K',4X,'PRES',30X,'WAVE TRUNCATION',/,
   1634      2       (15X,10I11,/))
   1635       DO 220 KL=1,KLAVG
   1636       WRITE(6,219)  KL,ILVAV(KL),(STRWND(MW,KL,3),MW=1,MWV)
   1637       WRITE(IUNTBH,219)  KL,ILVAV(KL),(STRWND(MW,KL,3),MW=1,MWV)
   1638   219 FORMAT(/3X,I3,I8,2X,10F11.3)
   1639   220 CONTINUE
   1640 
   1641       WRITE(6,221) (IWVRQZ(MW),MW=1,MWV)
   1642       WRITE(IUNTBH,221) (IWVRQZ(MW),MW=1,MWV)
   1643   221 FORMAT(///21X,'SPEED AT TRUNCATED WAVE NUMBER VS. PRESSURE'
   1644      1       ,/,6X,'K',4X,'PRES',30X,'WAVE TRUNCATION',/,(15X,10I11,/))
   1645       DO 230 KL=1,KLAVG
   1646       WRITE(6,229) KL,ILVAV(KL),(STRWND(MW,KL,4),MW=1,MWV)
   1647       WRITE(IUNTBH,229) KL,ILVAV(KL),(STRWND(MW,KL,4),MW=1,MWV)
   1648   229 FORMAT(/3X,I3,I8,2X,10F11.3)
   1649   230 CONTINUE
   1650       RETURN
   1651 
   1652 C-----------------------------------------------------------------------
   1653 
   1654 C  ++++++++++++++++++++++++
   1655 C  ++++  ENTRY SETFEN  ++++
   1656 C  ++++++++++++++++++++++++
   1657 
   1658       ENTRY SETFEN(IUNTBH,DIRSTM,SPDSTM,UPROP,VPROP,MWENVZ,ITRNCZ,
   1659      1             KLSTMZ,MNIBOG)
   1660 
   1661 C  THIS ENTRY SELECTS THE LEVEL AND WAVE TRUNCATION INDICES THAT
   1662 C    CORRESPONDS CLOSEST TO THE ENVIRONMENTAL WIND. CURRENTLY THE
   1663 C    ALGORITHM PROCEEDS IN TWO STEPS:
   1664 C         1)  MINIMUM DIRECTION DIFFERENCE BETWEEN THE DEEPEST LAYER
   1665 C             MEAN WIND AND THE STORM MOTION IS FOUND
   1666 C         2)  A NEIGHBORHOOD OF + OR - 1 INDEX IN SPECTRAL TRUNCATION IS
   1667 C             SEARCHED FOR THE BEST AGREEMENT (MINIMUM MAGNITUDE OF
   1668 C             VECTOR DIFFERENCE) BETWEEN THE ENVIRONMENTAL WIND AND THE
   1669 C             STORM MOTION, WITHOUT SIGNIFICANT DEGRADATION IN DIRECTION
   1670 C             DIFFERENCE.
   1671 
   1672       CALL DS2UV(USTMZ,VSTMZ,DIRSTM,SPDSTM)
   1673       USTM=USTMZ
   1674       VSTM=VSTMZ

Page 39          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1675 
   1676       IF(KLSTMZ .GT. 0)  KLSTM=KLSTMZ
   1677       IF(ITRNCZ .GE. 0)  ITRNC=ITRNCZ
   1678 
   1679       WRITE(6,301) DIRSTM,SPDSTM,USTM,VSTM,UPROP,VPROP,KLSTM,MWV,MNIBOG
   1680   301 FORMAT(/'...ENTERING SETFEN WITH DIRSTM,SPDSTM,USTM,VSTM,',
   1681      1       'UPROP,VPROP,KLSTM,MWV,MNIBOG=',/,10X,6F11.4,2I5,L2)
   1682 
   1683       IF(MWENVZ .GT. 0)  GO TO 380
   1684 
   1685       USTM=USTM-UPROP
   1686       VSTM=VSTM-VPROP
   1687       CALL UV2DS(USTM,VSTM,DIRSTM,SPDSTM)
   1688 
   1689       WRITE(6,302) DIRSTM,SPDSTM,USTM,VSTM,UPROP,VPROP
   1690       WRITE(IUNTBH,302) DIRSTM,SPDSTM,USTM,VSTM,UPROP,VPROP
   1691   302 FORMAT(/'...AFTER ADJUSTING FOR PROPAGATION, DIRSTM,SPDSTM,',
   1692      1       'USTM,VSTM,UPROP,VPROP=',/,10X,6F11.4)
   1693 
   1694 C  STEP 1: FIND MINIMUM DIRECTION DIFFERENCE
   1695 
   1696 C  *****  IMPORTANT NOTE: THE MINIMUM DIRECTION DIFFERENCE IS
   1697 C                         NOW SET FOR THE DEEPEST LAYER MEAN  ******
   1698 
   1699       KLADIR=KLAVG
   1700 
   1701       DIFSPD=1.E10
   1702       DIFDIR=1.E10
   1703 
   1704       DO 320 KL=1,KLAVG
   1705       DO 310 MW=1,MWV
   1706 
   1707 C  DIFFERENCE IN SPEED BETWEEN ENVWIROMENTAL WIND AND STORM
   1708 
   1709       DIFSPZ=STRWND(MW,KL,4)-SPDSTM
   1710       STRDIF(MW,KL,1)=DIFSPZ
   1711 
   1712       IF(ABS(DIFSPZ) .LT. DIFSPD)  THEN
   1713       KLASPD=KL
   1714       MWVSPD=MW
   1715       DIFSPD=ABS(DIFSPZ)
   1716       CALL UV2DS(STRWND(MW,KL,1),STRWND(MW,KL,2),DIRSSV,SPDSSV)
   1717       ENDIF
   1718 
   1719 C  DIFFERENCE IN DIRECTIONS
   1720 
   1721       CALL UV2DS(STRWND(MW,KL,1),STRWND(MW,KL,2),DIRENV,SPDENV)
   1722 
   1723       DIFDRZ=DIRENV-DIRSTM
   1724       IF(ABS(DIFDRZ) .GT. 180.)  THEN
   1725 c && 5 comments
   1726 CC    WRITE(6,307) MW,KL,STRWND(MW,KL,1),STRWND(MW,KL,2),DIRENV,SPDENV,
   1727 CC   1             DIRSTM,DIFDRZ
   1728 CC307 FORMAT('...CALCULATING DIRECTION DIFFERENCE BETW ENV WIND AND',
   1729 CC   1       ' STORM MOTION >180 DEG, MW,KL,UENV,VENV,DIRENV,SPDENV,',
   1730 CC   2       'DIRSTM,DIFDRZ=',/,5X,2I5,6F11.4)
   1731 

Page 40          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1732       IF(DIFDRZ .GT. 0.0)  THEN
   1733         DIFDRZ=-(360.-DIFDRZ)
   1734         ELSE
   1735         DIFDRZ=  360.+DIFDRZ
   1736       ENDIF
   1737 
   1738 c && 2 comments
   1739 CC    WRITE(6,309) DIFDRZ
   1740 CC309 FORMAT('     ...RECALCULATING DIFDRZ (GT 180)=',F11.4)
   1741       ENDIF
   1742 
   1743       STRDIF(MW,KL,2)=DIFDRZ
   1744       IF(KL .EQ. KLAVG .AND. ABS(DIFDRZ) .LT. DIFDIR)  THEN
   1745       MWVDIR=MW
   1746       DIFDIR=ABS(DIFDRZ)
   1747       CALL UV2DS(STRWND(MW,KL,1),STRWND(MW,KL,2),DIRDSV,SPDDSV)
   1748       ENDIF
   1749 
   1750   310 CONTINUE
   1751   320 CONTINUE
   1752 
   1753       WRITE(6,331) (IWVRQZ(MW),MW=1,MWV)
   1754       WRITE(IUNTBH,331) (IWVRQZ(MW),MW=1,MWV)
   1755   331 FORMAT(///20X,'SPEED DIFFERENCE (ENV-STM) AT TRUNCATED WAVE ',
   1756      1       'NUMBER VS. PRESSURE'/6X,'K',4X,'PRES',30X,'WAVE ',
   1757      2       'TRUNCATION'/(15X,10I11/))
   1758       DO 335 KL=1,KLAVG
   1759       WRITE(6,333)  KL,ILVAV(KL),(STRDIF(MW,KL,1),MW=1,MWV)
   1760       WRITE(IUNTBH,333)  KL,ILVAV(KL),(STRDIF(MW,KL,1),MW=1,MWV)
   1761   333 FORMAT(/3X,I3,I8,2X,10F11.3)
   1762   335 CONTINUE
   1763 
   1764       WRITE(6,343) (IWVRQZ(MW),MW=1,MWV)
   1765       WRITE(IUNTBH,343) (IWVRQZ(MW),MW=1,MWV)
   1766   343 FORMAT(//21X,'DIRECTION DIFFERENCE (ENV-STM) AT TRUNCATED ',
   1767      1       'WAVE NUMBER VS. PRESSURE',/,6X,'K',4X,'PRES',30X,
   1768      2       'WAVE TRUNCATION',/,(15X,10I11,/))
   1769       DO 345 KL=1,KLAVG
   1770       WRITE(6,344) KL,ILVAV(KL),(STRDIF(MW,KL,2),MW=1,MWV)
   1771       WRITE(IUNTBH,344) KL,ILVAV(KL),(STRDIF(MW,KL,2),MW=1,MWV)
   1772   344 FORMAT(/3X,I3,I8,2X,10F11.3)
   1773   345 CONTINUE
   1774 
   1775 c && 7 comments
   1776 CC    WRITE(6,353) KLASPD,MWVSPD,IWVRQZ(MWVSPD),ILVAV(KLASPD)
   1777 CC353 FORMAT(/'...FOUND MINIMUM WIND SPEED DIFFERENCE AT KLASPD,',
   1778 CC   1       'MWVSPD=',2I5,',',/,4X,'WHICH CORRESPONDS TO A',/,5X,
   1779 CC   2       'WAVENUMBER AND HEIGHT OF',I5,' AND',I8)
   1780 CC    WRITE(6,354) SPDSSV,DIRSSV,SPDSTM,DIRSTM
   1781 CC354 FORMAT(/'...ENVIRONMENTAL WIND SPEED, DIR, AND STORM SPEED, DIR',
   1782 CC   1       ' FOR THIS CHOICE ARE:',/,10X,4F11.3,//)
   1783 
   1784       WRITE(IWRITE,299)
   1785   299 FORMAT(//)
   1786       WRITE(6,357) KLADIR,MWVDIR,IWVRQZ(MWVDIR),ILVAV(KLADIR)
   1787       WRITE(IUNTBH,357) KLADIR,MWVDIR,IWVRQZ(MWVDIR),ILVAV(KLADIR)
   1788   357 FORMAT(/'...FOUND MINIMUM DIRECTION DIFFERENCE OVER DEEPEST LAYER'

Page 41          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1789      1      ,' AT KLADIR, MWVDIR=',2I5,',',/,4X,'WHICH CORRESPONDS ',
   1790      2       'TO A WAVENUMBER AND HEIGHT OF',I5,' AND',I8)
   1791       WRITE(6,358) SPDDSV,DIRDSV,SPDSTM,DIRSTM
   1792       WRITE(IUNTBH,358) SPDDSV,DIRDSV,SPDSTM,DIRSTM
   1793   358 FORMAT(/'...ENVIRONMENTAL WIND SPEED, DIR, AND STORM SPEED, DIR',
   1794      1       ' FOR THIS CHOICE ARE:',/,10X,4F11.3)
   1795 
   1796 C  STEP 2: SCAN NEIGHBORHOOD FOR MINIMUM MAGNITUDE OF VECTOR ERROR
   1797 
   1798       MWV1=MAX(MWVDIR-1,1)
   1799       MWV2=MIN(MWVDIR+1,MWV)
   1800       ANGCRT=5.0
   1801       MWVBST=MWVDIR
   1802       MWVOPT=MWVDIR
   1803       FNLDIR=STRWND(MWVOPT,KLADIR,3)
   1804       FNLSPD=STRWND(MWVOPT,KLADIR,4)
   1805       DFBSTD=SQRT((STRWND(MWVOPT,KLADIR,1)-USTM)**2+
   1806      1            (STRWND(MWVOPT,KLADIR,2)-VSTM)**2)
   1807       DIFOPT=DFBSTD
   1808 
   1809       DO 370 MW=MWV1,MWV2,2
   1810       VESPD=SQRT((STRWND(MW,KLADIR,1)-USTM)**2+
   1811      1           (STRWND(MW,KLADIR,2)-VSTM)**2)
   1812       IF(VESPD .LT. DIFOPT)  THEN
   1813       IF(ABS(STRDIF(MW,KLADIR,2)-STRDIF(MWVBST,KLADIR,2)) .LT. ANGCRT)
   1814      1  THEN
   1815       WRITE(6,361) IWVRQZ(MW),VESPD,DIFOPT
   1816       WRITE(IUNTBH,361) IWVRQZ(MW),VESPD,DIFOPT
   1817   361 FORMAT(/'...SMALLER VECTOR SPEED ERROR FOR TRUNCATION=',I5,
   1818      1       ' NEW, OLD SPEED ERROR=',2F11.4)
   1819       MWVSAV=MWVOPT
   1820       MWVOPT=MW
   1821       DIFOPT=VESPD
   1822       FNLDIR=STRWND(MWVOPT,KLADIR,3)
   1823       FNLSPD=STRWND(MWVOPT,KLADIR,4)
   1824       WRITE(6,363) ANGCRT,MWVSAV,MWVOPT,STRDIF(MWVSAV,KLADIR,2),
   1825      1             STRDIF(MWVOPT,KLADIR,2),STRDIF(MWVSAV,KLADIR,1),
   1826      2             STRDIF(MWVOPT,KLADIR,1)
   1827       WRITE(IUNTBH,363) ANGCRT,MWVSAV,MWVOPT,STRDIF(MWVSAV,KLADIR,2),
   1828      1                 STRDIF(MWVOPT,KLADIR,2),STRDIF(MWVSAV,KLADIR,1),
   1829      2                 STRDIF(MWVOPT,KLADIR,1)
   1830   363 FORMAT(/'...FOUND BETTER SPEED AGREEMENT IN NEIGHBORING ',
   1831      1       'SPECTRAL TRUNCATION WITHOUT SACRIFICING DIRECTION ',
   1832      2       'AGREEMENT MORE THAN ',F6.1,' DEG.',/,6X,'OLD, ',
   1833      3       'NEW TRUNC, OLD,NEW DIRECTION DIFFERENCE=',2I5,2F11.4,/,
   1834      4        6X,'OLD, NEW SPEED DIFFERENCE=',2F11.4)
   1835       ENDIF
   1836       ENDIF
   1837   370 CONTINUE
   1838 
   1839   380 IF(MWENVZ .LE. 0)  THEN
   1840       IF(MWENVZ .EQ. 0)  WRITE(6,383)
   1841   383 FORMAT(/'******WRONG OPTION (=0) FOR WAVELENGTH TRUNCATION, ',
   1842      1       'DEFAULT OPTION OF OPTIMAL WAVELENGTH WILL BE USED.')
   1843       WRITE(6,385) FNLSPD,FNLDIR,SPDSTM,DIRSTM,MWVOPT,IWVRQZ(MWVOPT),
   1844      1             ILVAV(KLADIR)
   1845       WRITE(IUNTBH,385) FNLSPD,FNLDIR,SPDSTM,DIRSTM,MWVOPT,

Page 42          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1846      1                  IWVRQZ(MWVOPT),ILVAV(KLADIR)
   1847   385 FORMAT(/'...FINAL CHOICE OF ENVIRONMENTAL WIND SPEED,  DIR ',
   1848      1       'COMPARED TO STORM SPEED, DIR:'/10X,4F11.3//'...THE FINAL',
   1849      2       ' WAVENUMBER TRUNCATION IS FOR INDEX=',I3,','/4X,'WHICH ',
   1850      3       'CORRESPONDS TO A WAVENUMBER AND HEIGHT OF',I5,' AND',I8)
   1851       MWENV=IWVRQZ(MWVOPT)
   1852 
   1853       ELSE IF(MWENVZ .GT. 0)  THEN
   1854       MWENV=MWENVZ
   1855       WRITE(6,387) MWENV
   1856 CCCC  WRITE(IUNTBH,387) MWENV
   1857   387 FORMAT(/'...SPECIFIED WAVENUMBER TRUNCATION IS:',I5//)
   1858       RETURN
   1859       ENDIF
   1860 
   1861       WRITE(IWRITE,1999)
   1862  1999 FORMAT(//)
   1863       RETURN
   1864 
   1865 C-----------------------------------------------------------------------
   1866 
   1867 
   1868 C  ++++++++++++++++++++++++
   1869 C  ++++  ENTRY FENBOG  ++++
   1870 C  ++++++++++++++++++++++++
   1871 
   1872       ENTRY FENBOG(IUNTFE,MMX,NNY,IMETHZ,RLATMN,RLATMX,RLONMN,RLONMX,
   1873      1             FRACST,ENVBOG,RLATP,RLONP,NPTS,MNIBOG,modtyp)
   1874 
   1875       WRITE(6,401)  MWENV,IMFLTP,IMETHZ,FRACST,KLSTM,JVBOGz,MNIBOG
   1876   401 FORMAT(/'...ENTERING FENBOG TO CALCULATE ENVIRONMENTAL BOGUS',
   1877      1       ' WITH WAVE TRUNCATION=',I4,'. IMFLTP=',I2/4X,'IMETHZ=',I2,
   1878      2       ', FRACST=',F6.2,'KLSTM=',I3,' JVBOGz=',I3,' MNIBOG=',L2)
   1879 
   1880       ICALL=-1
   1881 
   1882 C  SKIP SETUP CALCULATIONS FOR MINI BOGUSING
   1883 
   1884       IF(.NOT. MNIBOG)  THEN
   1885 
   1886 C  SET UP CORNER POINTS FOR CALCULATING HEIGHT OFFSET
   1887 
   1888          DO 405 KK=1,2
   1889             CORNR(2*KK-1,1)=RLATMX
   1890             CORNR(2*KK  ,1)=RLATMN
   1891   405    CONTINUE
   1892          DO 410 KK=1,2
   1893             CORNR(KK  ,2)=RLONMN
   1894             CORNR(KK+2,2)=RLONMX
   1895   410    CONTINUE
   1896          IWVCRN(1)=I40WV
   1897          IWVCRN(2)=MWENV
   1898          ITCRN(1) =IROMB
   1899          ITCRN(2) =ITRIA
   1900       ENDIF
   1901 
   1902       DO 450 KL=1,KLSTM

Page 43          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1903       DO 440 JV=1,JVBOGz
   1904          OFF1=0.0
   1905          OFF2=0.0
   1906 
   1907 C  SKIP SETUP CALCULATIONS FOR MINI BOGUSING
   1908 
   1909          IF(.NOT. MNIBOG)  THEN
   1910 
   1911 C  WAVES FOR U, V WIND ARE 1 MORE THAN FOR SCALARS (VORT, DIV, Z, T, RH)
   1912 
   1913             IF((IVAR(JV).EQ.4 .OR. IVAR(JV).EQ.5).AND.IMFLTP.EQ.1) THEN
   1914                IPLUS=1
   1915             ELSE
   1916                IPLUS=0
   1917             ENDIF
   1918 
   1919 C  CALCULATE HEIGHTS ON THE FOUR CORNERS OF THE DOMAIN FOR BOTH R40 AND
   1920 C    THE CHOSEN WAVENUMBER TRUNCATION, AVERAGE THEM AND CALCULATE AN
   1921 C    OFFSET TO BE APPLIED TO THE ENTIRE HEIGHT FIELD
   1922 
   1923             IF(IVAR(JV) .EQ. 3 .AND. IMFLTP .EQ. 1)  THEN
   1924                DO 420 MWCORN=1,2
   1925                   CALL SETTRN(KL,JV,IWVCRN(MWCORN),IPLUS,ITCRN(MWCORN))
   1926                   CALL SETRES(KL,JV,IWVCRN(MWCORN),IPLUS,ITCRN(MWCORN))
   1927                   DO 415 ICORN=1,4
   1928                      CALL SCASP1(CORNR(ICORN,2),CORNR(ICORN,1),JV,KL,
   1929      1                 IWVCRN(MWCORN),ITCRN(MWCORN),ZCORN(ICORN,MWCORN))
   1930   415             CONTINUE
   1931   420          CONTINUE
   1932 
   1933                AVGR40=0.0
   1934                AVGMWV=0.0
   1935                DO 425 KK=1,4
   1936                   AVGR40=AVGR40+ZCORN(KK,1)
   1937                   AVGMWV=AVGMWV+ZCORN(KK,2)
   1938   425          CONTINUE
   1939                AVGR40=0.25*AVGR40
   1940                AVGMWV=0.25*AVGMWV
   1941                OFFSET=AVGR40-AVGMWV
   1942                OFF1=OFFSET
   1943             ENDIF
   1944 
   1945             IF(KL .EQ. 1 .AND. JV .EQ. 1)  THEN
   1946                WRITE(6,1403) KL,JV,ILVL(KL),IVAR(JV),MWENV,IPLUS,ITRNC,
   1947      1                       NPTS
   1948  1403 FORMAT(/'...CALLING SETTRN FOR ENVIRONMENTAL BOGUS: KL,JV,LEVEL,',
   1949      1       'IVAR,MWENV,IPLUS,ITRNC,NPTS=',8I5)
   1950                CALL SETTRN(KL,JV,MWENV,IPLUS,ITRNC)
   1951             ELSE
   1952                WRITE(6,1404) KL,JV,ILVL(KL),IVAR(JV),MWENV,IPLUS,ITRNC,
   1953      1                       NPTS
   1954  1404 FORMAT(/'...CALLING SETRES FOR ENVIRONMENTAL BOGUS: KL,JV,LEVEL,',
   1955      1       'IVAR,MWENV,IPLUS,ITRNC,NPTS=',8I5)
   1956                CALL SETRES(KL,JV,MWENV,IPLUS,ITRNC)
   1957             ENDIF
   1958 
   1959          ENDIF

Page 44          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   1960 
   1961 C  LOOP FOR ALL POINTS
   1962 
   1963          DO 430 NP=1,NPTS
   1964 
   1965             XX=RLONP(NP)
   1966             YY=RLATP(NP)
   1967 
   1968 C  SCALARS: Z, RH, T
   1969 
   1970             IF(IVAR(JV) .LE. 3)  THEN
   1971                KVMX=1
   1972                IF(IMFLTP .EQ. 1)  THEN
   1973                   CALL SCASP1(XX,YY,JV,KL,MWENV,ITRNC,ENVBOG(NP,KVMX))
   1974                ELSE IF(IMFLTP .EQ. 2)  THEN
   1975                   CALL SCASP1(XX,YY,JV,KL,MWENV,ITRNC,ENVBOG(NP,KVMX))
   1976                ENDIF
   1977                IF(IVAR(JV) .EQ. 3)  ENVBOG(NP,KVMX)=ENVBOG(NP,KVMX)+OFF1
   1978                WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX)
   1979   409 FORMAT('...ENVIRONMENTAL BOGUS, NP,JV,LEVEL,XX,YY,ENVBOG=',3I5,
   1980      1       3F11.4)
   1981 
   1982 C  U WIND:  IMFLTP=1 (U,V COEFFS)
   1983 C           IMFLTP=2 (VORT, DIV. COEFFS) - THE TOTAL (U,V) WIND IS
   1984 C                    CONSTRUCTED IN TWO PIECES.  THE FIRST PIECE IS THE
   1985 C                    ROTATIONAL PART, THE SECOND PART IS THE DIVERGENT
   1986 C                    PART.
   1987 
   1988 C  SET ENVIRONMENTAL WIND EQUAL TO SOME FACTOR OF THE STORM SPEED
   1989 
   1990             ELSE IF(IMETHZ .EQ. 2) THEN
   1991                KVMX=2
   1992                ENVBOG(NP,1)=USTM*FRACST
   1993                ENVBOG(NP,2)=VSTM*FRACST
   1994                OFF1=0.0
   1995                OFF2=0.0
   1996 
   1997             ELSE IF(IMETHZ .GT. 2) THEN
   1998                KVMX=2
   1999                ENVBOG(NP,1)=USTM*FRACST
   2000                ENVBOG(NP,2)=VSTM*FRACST
   2001                OFF1=0.0
   2002                OFF2=0.0
   2003 
   2004             ELSE
   2005                IF(IVAR(JV) .EQ. 4)  THEN
   2006                   KVMX =2
   2007                   IF(IMFLTP .EQ. 1)  THEN
   2008                      CALL UVWSP1(XX,YY,JV,KL,MWENV,IPLUS,ITRNC,
   2009      1                           ENVBOG(NP,KVMX-1))
   2010                   ELSE IF(IMFLTP .EQ. 2)  THEN
   2011                      CALL UVRSP2(XX,YY,JV,KL,MWENV,ITRNC,
   2012      1                           ENVBOG(NP,KVMX-1),ENVBOG(NP,KVMX))
   2013                   ENDIF
   2014 c && 2 comments
   2015 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX-1)
   2016 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX  )

Page 45          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   2017 
   2018 C  V WIND: SEE COMMENTS PERTAINING TO U WIND ABOVE
   2019 
   2020                ELSE IF(IVAR(JV) .EQ. 5)  THEN
   2021 
   2022                   IF(IMFLTP .EQ. 1)  THEN
   2023                      CALL UVWSP1(XX,YY,JV,KL,MWENV,IPLUS,ITRNC,
   2024      1                           ENVBOG(NP,KVMX))
   2025                   ELSE IF(IMFLTP .EQ. 2)  THEN
   2026                      CALL UVDSP2(XX,YY,JV,KL,MWENV,ITRNC,
   2027      1                           ENVBOG(NP,KVMX-1),ENVBOG(NP,KVMX))
   2028                   ENDIF
   2029 c && 2 comments
   2030 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX-1)
   2031 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX  )
   2032 
   2033 C  ROTATIONAL WIND
   2034 
   2035                ELSE IF(IVAR(JV) .EQ. 6)  THEN
   2036                   KVMX=2
   2037                   IF(IMFLTP .EQ. 1)  THEN
   2038                      CALL UROSP1(XX,YY,JV,KL,MWENV,ITRNC,
   2039      1                           ENVBOG(NP,KVMX-1))
   2040                      CALL VROSP1(XX,YY,JV,KL,MWENV,ITRNC,
   2041      1                           ENVBOG(NP,KVMX))
   2042                   ELSE IF(IMFLTP .EQ. 2)  THEN
   2043                      ENVBOG(NP,KVMX-1)=0.0
   2044                      ENVBOG(NP,KVMX  )=0.0
   2045                      CALL UVRSP2(XX,YY,JV,KL,MWENV,ITRNC,
   2046      1                           ENVBOG(NP,KVMX-1),ENVBOG(NP,KVMX))
   2047                   ENDIF
   2048 c && 2 comments
   2049 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX-1)
   2050 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX)
   2051 
   2052 C  DIVERGENT WIND
   2053 
   2054                ELSE IF(IVAR(JV) .EQ. 7)  THEN
   2055                   KVMX=2
   2056                   IF(IMFLTP .EQ. 1)  THEN
   2057                      CALL UDVSP1(XX,YY,JV,KL,MWENV,ITRNC,
   2058      1                           ENVBOG(NP,KVMX-1))
   2059                      CALL VDVSP1(XX,YY,JV,KL,MWENV,ITRNC,
   2060      1                           ENVBOG(NP,KVMX))
   2061                   ELSE IF(IMFLTP .EQ. 2)  THEN
   2062                      ENVBOG(NP,KVMX-1)=0.0
   2063                      ENVBOG(NP,KVMX  )=0.0
   2064                      CALL UVDSP2(XX,YY,JV,KL,MWENV,ITRNC,
   2065      1                           ENVBOG(NP,KVMX-1),ENVBOG(NP,KVMX))
   2066                   ENDIF
   2067 c && 2 comments
   2068 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX-1)
   2069 ccc               WRITE(6,409) NP,JV,ILVL(KL),XX,YY,ENVBOG(NP,KVMX)
   2070                ELSE
   2071                   WRITE(6,429) JV,IVAR(JV)
   2072   429 FORMAT(/'******VARIABLE CANNOT BE DERIVED FROM ENVIRONMENTAL',
   2073      1       ' FIELDS, JV, IVAR(JV)=',2I5)

Page 46          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   2074                ENDIF
   2075             ENDIF
   2076 
   2077   430    CONTINUE
   2078 
   2079 c && 5 comments
   2080 cc       DO KV=1,KVMX
   2081 cc          WRITE(6,431) KV,(ENVBOG(NP,KV),NP=1,NPTS)
   2082 cc431 FORMAT(/'...ENVBOG HAS BEEN STORED IN FENBOG, KV,ENVBOG=',I5,/,
   2083 cc   1       (10F12.5))
   2084 cc       ENDDO
   2085 
   2086 C  CONSTRUCT FILE HEADER AND WRITE TO DISK FOR ALL VARIABLES.
   2087 C    NOTE: U,V WIND DONE TOGETHER
   2088 
   2089          IF(IVAR(JV) .NE. 4)  THEN
   2090 
   2091 c && 3 comments
   2092 cc          WRITE(6,437) MMX,NNY,RLONMN,RLONMX,RLATMN,RLATMX
   2093 cc437 FORMAT(/'...READY TO WRITE ENVBOG ARRAY, MMX,NNY,RLONMN,RLONMX,',
   2094 cc   1       'RLATMN,RLATMX=',/,5X,2I6,4F11.4)
   2095             IF(MODTYP .EQ. 0 .OR. MODTYP .EQ. 1)  THEN
   2096 
   2097                CALL HDRSPP(KL,JV,MWENV,RLATMN,RLATMX,RLONMN,
   2098      1               RLONMX,OFF1,OFF2,MTITLE,NCHAR)
   2099                IF(IMFLTP .EQ. 1)  THEN
   2100 
   2101                   ICALL=ICALL+1
   2102                   CALL OUTENV(IUNTFE,ICALL,ENVBOG,MMX,NNY,KVMX,MTITLE,
   2103      1                        NCHAR)
   2104 
   2105                ELSE IF(IMFLTP .EQ. 2)  THEN
   2106                   WRITE(6,439)  IUNTFE
   2107   439 FORMAT(/'...ENVIRONMENTAL FIELDS WRITTEN TO UNIT=',I3,' IN ',
   2108      1       'CHARACTER FORMAT USING OUTGES.')
   2109 
   2110 C  TEMPORARY OUTPUT FORMAT
   2111 
   2112                   CALL OUTGES(IUNTFE,NPTS,ENVBOG,MTITLE)
   2113                ENDIF
   2114 
   2115 C  RESERVED FOR OTHER MODEL TYPES
   2116 
   2117             ELSE
   2118             ENDIF
   2119 
   2120          ENDIF
   2121 
   2122   440 CONTINUE
   2123   450 CONTINUE
   2124 
   2125       RETURN
   2126       END

Page 47          Source Listing                  GRABMO
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name                  Name                  Name               
                                                                                                                                   
 favwnd_               fenbog_               graben_               grabim_               grabmo_               setfen_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1457                                                           1452                              
 101                        Label  1461                                                           1459                              
 110                        Label  1473                                                           1467                              
 111                        Label  1477                                                           1476                              
 120                        Label  1485                                                           1479                              
 121                        Label  1489                                                           1488                              
 130                        Label  1501                                                           1498                              
 131                        Label  1502                                                           1500                              
 137                        Label  1560                                                           1559                              
 14                         Label  1345                                                           1344                              
 140                        Label  1571                                                           1540                              
 1403                       Label  1948                                                           1946                              
 1404                       Label  1954                                                           1952                              
 145                        Label  1573                                                           1516                              
 15                         Label  1353                                                           1338                              
 150                        Label  1581                                                           1511                              
 160                        Label  1585                                                           1508                              
 170                        Label  1604                                                           1598                              
 180                        Label  1611                                                           1592                              
 190                        Label  1612                                                           1590                              
 191                        Label  1615                                                           1614                              
 193                        Label  1619                                                           1618                              
 195                        Label  1620                                                           1617                              
 197                        Label  1623                                                           1622                              
 199                        Label  1627                                                           1626                              
 1999                       Label  1862                                                           1861                              
 2                          Label  1300                                                           1298                              
 200                        Label  1628                                                           1625                              
 217                        Label  1632                                                           1630,1631                         
 219                        Label  1638                                                           1636,1637                         
 220                        Label  1639                                                           1635                              
 221                        Label  1643                                                           1641,1642                         
 229                        Label  1648                                                           1646,1647                         
 230                        Label  1649                                                           1645                              
 299                        Label  1785                                                           1784                              
 3                          Label  1304                                                           1303                              
 301                        Label  1680                                                           1679                              
 302                        Label  1691                                                           1689,1690                         
 31                         Label  1393                                                           1392                              
 310                        Label  1750                                                           1705                              
 320                        Label  1751                                                           1704                              
 331                        Label  1755                                                           1753,1754                         
 333                        Label  1761                                                           1759,1760                         
 335                        Label  1762                                                           1758                              

Page 48          Source Listing                  GRABMO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 343                        Label  1766                                                           1764,1765                         
 344                        Label  1772                                                           1770,1771                         
 345                        Label  1773                                                           1769                              
 357                        Label  1788                                                           1786,1787                         
 358                        Label  1793                                                           1791,1792                         
 361                        Label  1817                                                           1815,1816                         
 363                        Label  1830                                                           1824,1827                         
 370                        Label  1837                                                           1809                              
 380                        Label  1839                                                           1683                              
 383                        Label  1841                                                           1840                              
 385                        Label  1847                                                           1843,1845                         
 387                        Label  1857                                                           1855                              
 4                          Label  1324                                                           1323                              
 401                        Label  1876                                                           1875                              
 405                        Label  1891                                                           1888                              
 409                        Label  1979                                                           1978                              
 410                        Label  1895                                                           1892                              
 415                        Label  1930                                                           1927                              
 420                        Label  1931                                                           1924                              
 425                        Label  1938                                                           1935                              
 429                        Label  2072                                                           2071                              
 430                        Label  2077                                                           1963                              
 439                        Label  2107                                                           2106                              
 440                        Label  2122                                                           1903                              
 450                        Label  2123                                                           1902                              
 5                          Label  1331                                                           1316                              
 51                         Label  1406                                                           1405                              
 6                          Label  1333                                                           1328                              
 61                         Label  1410                                                           1409                              
 81                         Label  1415                                                           1414                              
 83                         Label  1417                                                           1416                              
 87                         Label  1421                                                           1420                              
 89                         Label  1423                                                           1422                              
 A                          Local  1234     R(4)            4     3     49000    SAVE                                               
 ABRT1                      Subr   1349                                                           1349,1407,1411,1491,1562          
 ABS                        Func   1712                                 scalar                    1712,1715,1724,1744,1746,1813     
 ANGCRT                     Local  1800     R(4)            4           scalar   SAVE             1800,1813,1824,1827               
 AVGMWV                     Local  1934     R(4)            4           scalar   SAVE             1934,1937,1940,1941               
 AVGR40                     Local  1933     R(4)            4           scalar   SAVE             1933,1936,1939,1941               
 CORNR                      Local  1232     R(4)            4     2     8        SAVE             1889,1890,1893,1894,1928          
 DFBSTD                     Local  1805     R(4)            4           scalar   SAVE             1805,1807                         
 DIFDIR                     Local  1702     R(4)            4           scalar   SAVE             1702,1744,1746                    
 DIFDRZ                     Local  1723     R(4)            4           scalar   SAVE             1723,1724,1732,1733,1735,1743,1744
                                                                                                  ,1746                             
 DIFOPT                     Local  1807     R(4)            4           scalar   SAVE             1807,1812,1815,1816,1821          
 DIFSPD                     Local  1701     R(4)            4           scalar   SAVE             1701,1712,1715                    
 DIFSPZ                     Local  1709     R(4)            4           scalar   SAVE             1709,1710,1712,1715               
 DIRDSV                     Local  1747     R(4)            4           scalar   SAVE             1747,1791,1792                    
 DIRENV                     Local  1721     R(4)            4           scalar   SAVE             1721,1723                         
 DIRSSV                     Local  1716     R(4)            4           scalar   SAVE             1716                              
 DIRSTM                     Dummy  1208     R(4)            4           scalar   ARG,INOUT        1672,1679,1687,1689,1690,1723,1791
                                                                                                  ,1792,1843,1845                   
 DLEV1                      Local  1507     R(4)            4           scalar   SAVE             1507,1583,1584                    
 DLEV2                      Local  1509     R(4)            4           scalar   SAVE             1509,1583,1584                    
 DS2UV                      Subr   1672                                                           1672                              

Page 49          Source Listing                  GRABMO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ENVBOG                     Dummy  1205     R(4)            4     2     0        ARG,INOUT        1973,1975,1977,1978,1992,1993,1999
                                                                                                  ,2000,2009,2012,2024,2027,2039,204
                                                                                                  1,2043,2044,2046,2058,2060,2062,20
                                                                                                  63,2065,2102,2112                 
 FAVWND                     Subr   1446                                                                                             
 FENBOG                     Subr   1872                                                                                             
 FNLDIR                     Local  1803     R(4)            4           scalar   SAVE             1803,1822,1843,1845               
 FNLSPD                     Local  1804     R(4)            4           scalar   SAVE             1804,1823,1843,1845               
 FRACST                     Dummy  1205     R(4)            4           scalar   ARG,INOUT        1875,1992,1993,1999,2000          
 GRABEN                     Subr   1368                                                                                             
 GRABIM                     Subr   1290                                                                                             
 GRABMO                     Subr   1204                                                                                             
 HDRSPP                     Subr   2097                                                           2097                              
 I40WV                      Local  1263     I(4)            4           scalar   SAVE             1263,1896                         
 ICALL                      Local  1880     I(4)            4           scalar   SAVE             1880,2101,2102                    
 ICORN                      Local  1927     I(4)            4           scalar   SAVE             1927,1928,1929                    
 ILVAV                      Local  1230     I(4)            4     1     19       SAVE             1579,1609,1618,1626,1636,1637,1646
                                                                                                  ,1647,1759,1760,1770,1771,1786,178
                                                                                                  7,1844,1846                       
 ILVL                       Local  1226     I(4)            4     1     10       SAVE             1396,1399,1416,1500,1507,1509,1579
                                                                                                  ,1609,1946,1952,1978              
 IMETHZ                     Dummy  1206     I(4)            4           scalar   ARG,INOUT        1875,1990,1997                    
 IMFLTP                     Local  1391     I(4)            4           scalar   SAVE             1391,1392,1395,1398,1416,1422,1431
                                                                                                  ,1433,1459,1875,1913,1923,1972,197
                                                                                                  4,2007,2010,2022,2025,2037,2042,20
                                                                                                  56,2061,2099,2105                 
 IMFLTZ                     Dummy  1204     I(4)            4           scalar   ARG,INOUT        1391                              
 INDXP                      Local  1226     I(4)            4     1     10       SAVE             1396,1399,1416,1430,1432,1434     
 INDXV                      Local  1227     I(4)            4     1     7        SAVE             1397,1400,1422,1430,1432,1434     
 IPLUS                      Local  1471     I(4)            4           scalar   SAVE             1471,1483,1529,1536,1553,1556,1914
                                                                                                  ,1916,1925,1926,1946,1950,1952,195
                                                                                                  6,2008,2023                       
 IPREQ                      Dummy  1207     I(4)            4     1     0        ARG,INOUT        1298,1303,1320                    
 IPREQZ                     Local  1227     I(4)            4     1     10       SAVE             1320,1396,1399,1414               
 IROMB                      Local  1262     I(4)            4           scalar   SAVE             1262,1898                         
 ITCRN                      Local  1232     I(4)            4     1     2        SAVE             1898,1899,1925,1926,1929          
 ITRIA                      Local  1263     I(4)            4           scalar   SAVE             1263,1450,1899                    
 ITRNC                      Local  1450     I(4)            4           scalar   SAVE             1450,1529,1536,1548,1549,1553,1556
                                                                                                  ,1677,1946,1950,1952,1956,1973,197
                                                                                                  5,2008,2011,2023,2026,2038,2040,20
                                                                                                  45,2057,2059,2064                 
 ITRNCZ                     Dummy  1206     I(4)            4           scalar   ARG,INOUT        1677                              
 IUNTBH                     Dummy  1204     I(4)            4           scalar   ARG,INOUT        1631,1637,1642,1647,1690,1754,1760
                                                                                                  ,1765,1771,1787,1792,1816,1827,184
                                                                                                  5                                 
 IUNTFE                     Dummy  1206     I(4)            4           scalar   ARG,INOUT        2102,2106,2112                    
 IUNTMO                     Dummy  1204     I(4)            4           scalar   ARG,INOUT        1429,1431,1434                    
 IVAR                       Local  1227     I(4)            4     1     7        SAVE             1397,1400,1422,1468,1480,1488,1547
                                                                                                  ,1552,1555,1559,1913,1923,1946,195
                                                                                                  2,1970,1977,2005,2020,2035,2054,20
                                                                                                  71,2089                           
 IVREQ                      Dummy  1207     I(4)            4     1     0        ARG,INOUT        1341                              
 IVREQZ                     Local  1228     I(4)            4     1     7        SAVE             1341,1397,1400,1420               
 IWRITE                     Local  1263     I(4)            4           scalar   SAVE             1263,1784,1861                    
 IWVCRN                     Local  1232     I(4)            4     1     2        SAVE             1896,1897,1925,1926,1929          

Page 50          Source Listing                  GRABMO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IWVREQ                     Local  1228     I(4)            4     1     8        SAVE             1262,1453,1455                    
 IWVRQZ                     Local  1228     I(4)            4     1     8        SAVE             1455,1460,1529,1536,1548,1549,1553
                                                                                                  ,1556,1614,1622,1630,1631,1641,164
                                                                                                  2,1753,1754,1764,1765,1786,1787,18
                                                                                                  15,1816,1843,1846,1851            
 JV                         Local  1420     I(4)            4           scalar   SAVE             1420,1422,1467,1468,1470,1479,1480
                                                                                                  ,1482,1488,1903,1913,1923,1925,192
                                                                                                  6,1928,1945,1946,1950,1952,1956,19
                                                                                                  70,1973,1975,1977,1978,2005,2008,2
                                                                                                  011,2020,2023,2026,2035,2038,2040,
                                                                                                  2045,2054,2057,2059,2064,2071,2089
                                                                                                  ,2097                             
 JVARS                      Dummy  1204     I(4)            4           scalar   ARG,INOUT        1226,1338,1344                    
 JVBOG                      Dummy  1205     I(4)            4           scalar   ARG,INOUT        1402,1422,1429,1431,1434,1459,1467
                                                                                                  ,1476,1479,1488                   
 JVBOGZ                     Local  1397     I(4)            4           scalar   SAVE             1397,1400,1402,1875,1903          
 JVMAX                      Dummy  1208     I(4)            4           scalar   ARG,INOUT        1355,1358                         
 JVMAXX                     Local  1358     I(4)            4           scalar   SAVE             1358,1397,1400,1420               
 JVWND                      Local  1466     I(4)            4           scalar   SAVE             1466,1470,1475,1482,1487,1519     
 JVWNDZ                     Local  1519     I(4)            4           scalar   SAVE             1519,1529,1536,1547,1548,1549,1552
                                                                                                  ,1553,1555,1556,1559              
 JWN                        Local  1516     I(4)            4           scalar   SAVE             1516,1519,1522                    
 JWNDVR                     Local  1469     I(4)            4           scalar   SAVE             1469,1481,1516                    
 KDTDIM                     Param  1217     I(4)            4           scalar                    1218                              
 KDXDIM                     Param  1218     I(4)            4           scalar                    1234                              
 KK                         Local  1888     I(4)            4           scalar   SAVE             1888,1889,1890,1892,1893,1894,1935
                                                                                                  ,1936,1937                        
 KL                         Local  1296     I(4)            4           scalar   SAVE             1296,1297,1298,1498,1499,1500,1508
                                                                                                  ,1509,1529,1536,1548,1549,1553,155
                                                                                                  6,1576,1577,1578,1579,1583,1598,15
                                                                                                  99,1600,1601,1602,1603,1617,1618,1
                                                                                                  625,1626,1635,1636,1637,1645,1646,
                                                                                                  1647,1704,1709,1710,1713,1716,1721
                                                                                                  ,1743,1744,1747,1758,1759,1760,176
                                                                                                  9,1770,1771,1902,1925,1926,1928,19
                                                                                                  45,1946,1950,1952,1956,1973,1975,1
                                                                                                  978,2008,2011,2023,2026,2038,2040,
                                                                                                  2045,2057,2059,2064,2097          
 KLA                        Local  1590     I(4)            4           scalar   SAVE             1590,1595,1596,1598,1600,1602,1605
                                                                                                  ,1606,1607,1608,1609              
 KLADIR                     Local  1699     I(4)            4           scalar   SAVE             1699,1786,1787,1803,1804,1805,1806
                                                                                                  ,1810,1811,1813,1822,1823,1824,182
                                                                                                  5,1826,1827,1828,1829,1844,1846   
 KLASPD                     Local  1713     I(4)            4           scalar   SAVE             1713                              
 KLAVG                      Local  1589     I(4)            4           scalar   SAVE             1589,1617,1625,1635,1645,1699,1704
                                                                                                  ,1744,1758,1769                   
 KLBOG                      Local  1396     I(4)            4           scalar   SAVE             1396,1399,1416,1429,1431,1434,1437
                                                                                                  ,1459,1498                        
 KLDIM                      Param  1216     I(4)            4           scalar                    1218                              
 KLMAX                      Dummy  1207     I(4)            4           scalar   ARG,INOUT        1333,1357                         
 KLMAXX                     Local  1357     I(4)            4           scalar   SAVE             1357,1396,1399,1414               
 KLSTM                      Local  1499     I(4)            4           scalar   SAVE             1499,1508,1509,1589,1590,1595,1596
                                                                                                  ,1600,1602,1605,1606,1607,1608,160
                                                                                                  9,1676,1679,1875,1902             
 KLSTMZ                     Dummy  1204     I(4)            4           scalar   ARG,INOUT        1676                              

Page 51          Source Listing                  GRABMO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KLVLS                      Dummy  1204     I(4)            4           scalar   ARG,INOUT        1226,1296,1302,1303,1323,1392,1437
 KP                         Local  1414     I(4)            4           scalar   SAVE             1414,1416                         
 KVMX                       Local  1971     I(4)            4           scalar   SAVE             1971,1973,1975,1977,1978,1991,1998
                                                                                                  ,2006,2009,2012,2024,2027,2036,203
                                                                                                  9,2041,2043,2044,2046,2055,2058,20
                                                                                                  60,2062,2063,2065,2102            
 MAX                        Func   1798                                 scalar                    1798                              
 MAXAVL                     Param  1213     I(4)            4           scalar                    1230,1231                         
 MAXBGK                     Param  1210     I(4)            4           scalar                    1213,1226,1227,1318               
 MAXBGV                     Param  1211     I(4)            4           scalar                    1227,1228,1339,1344               
 MAXWVT                     Param  1212     I(4)            4           scalar                    1228,1230,1231                    
 MDIM                       Param  1215     I(4)            4           scalar                    1234                              
 MIN                        Func   1799                                 scalar                    1799                              
 MM                         Local  1460     I(4)            4           scalar   SAVE             1460                              
 MMX                        Dummy  1206     I(4)            4           scalar   ARG,INOUT        2102                              
 MNIBOG                     Dummy  1206     L(4)            4           scalar   ARG,INOUT        1459,1503,1679,1875,1884,1909     
 MODL1                      Subr   1429                                                           1429                              
 MODTYP                     Dummy  1204     I(4)            4           scalar   ARG,INOUT        1392,1394,1404,1405,1409,1416,1422
                                                                                                  ,1428,1459,1521,1546,1559,2095    
 MTITLE                     Local  1220     CHAR            102         scalar   SAVE             2098,2102,2112                    
 MW                         Local  1452     I(4)            4           scalar   SAVE             1452,1453,1455,1511,1529,1536,1548
                                                                                                  ,1549,1553,1556,1576,1577,1578,159
                                                                                                  2,1595,1596,1600,1602,1605,1606,16
                                                                                                  07,1608,1614,1618,1622,1626,1630,1
                                                                                                  631,1636,1637,1641,1642,1646,1647,
                                                                                                  1705,1709,1710,1714,1716,1721,1743
                                                                                                  ,1745,1747,1753,1754,1759,1760,176
                                                                                                  4,1765,1770,1771,1809,1810,1811,18
                                                                                                  13,1815,1816,1820                 
 MWAVE                      Local  1430     I(4)            4           scalar   SAVE             1430,1432,1434,1453               
 MWCORN                     Local  1924     I(4)            4           scalar   SAVE             1924,1925,1926,1929               
 MWENV                      Local  1851     I(4)            4           scalar   SAVE             1851,1854,1855,1875,1897,1946,1950
                                                                                                  ,1952,1956,1973,1975,2008,2011,202
                                                                                                  3,2026,2038,2040,2045,2057,2059,20
                                                                                                  64,2097                           
 MWENVZ                     Dummy  1206     I(4)            4           scalar   ARG,INOUT        1683,1839,1840,1853,1854          
 MWV                        Local  1451     I(4)            4           scalar   SAVE             1451,1454,1455,1459,1460,1511,1592
                                                                                                  ,1614,1618,1622,1626,1630,1631,163
                                                                                                  6,1637,1641,1642,1646,1647,1679,17
                                                                                                  05,1753,1754,1759,1760,1764,1765,1
                                                                                                  770,1771,1799                     
 MWV1                       Local  1798     I(4)            4           scalar   SAVE             1798,1809                         
 MWV2                       Local  1799     I(4)            4           scalar   SAVE             1799,1809                         
 MWVBST                     Local  1801     I(4)            4           scalar   SAVE             1801,1813                         
 MWVDIR                     Local  1745     I(4)            4           scalar   SAVE             1745,1786,1787,1798,1799,1801,1802
 MWVOPT                     Local  1802     I(4)            4           scalar   SAVE             1802,1803,1804,1805,1806,1819,1820
                                                                                                  ,1822,1823,1824,1825,1826,1827,182
                                                                                                  8,1829,1843,1845,1846,1851        
 MWVSAV                     Local  1819     I(4)            4           scalar   SAVE             1819,1824,1825,1827,1828          
 MWVSPD                     Local  1714     I(4)            4           scalar   SAVE             1714                              
 NCHAR                      Local  2098     I(4)            4           scalar   SAVE             2098,2103                         
 NDIM                       Param  1215     I(4)            4           scalar                    1234                              
 NINT                       Func   1298                                 scalar                    1298,1500                         
 NNY                        Dummy  1206     I(4)            4           scalar   ARG,INOUT        2102                              
 NP                         Local  1315     I(4)            4           scalar   SAVE             1315,1318,1319,1320,1323,1333,1540

Page 52          Source Listing                  GRABMO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,1542,1543,1544,1550,1551,1554,155
                                                                                                  7,1963,1965,1966,1973,1975,1977,19
                                                                                                  78,1992,1993,1999,2000,2009,2012,2
                                                                                                  024,2027,2039,2041,2043,2044,2046,
                                                                                                  2058,2060,2062,2063,2065          
 NPREQ                      Local  1297     I(4)            4           scalar   SAVE             1297,1302,1303,1316,1323,1392     
 NPTS                       Dummy  1205     I(4)            4           scalar   ARG,INOUT        1229,1232,1540,1947,1953,1963,2112
 NV                         Local  1337     I(4)            4           scalar   SAVE             1337,1339,1340,1341,1355          
 NWVRQ1                     Local  1262     I(4)            4           scalar   SAVE             1262,1452,1459                    
 NWVRQ2                     Local  1262     I(4)            4           scalar   SAVE             1262,1452,1459                    
 NZ                         Local  1316     I(4)            4           scalar   SAVE             1316,1320,1338,1341               
 OFF1                       Local  1904     R(4)            4           scalar   SAVE             1904,1942,1977,1994,2001,2098     
 OFF2                       Local  1905     R(4)            4           scalar   SAVE             1905,1995,2002,2098               
 OFFSET                     Local  1941     R(4)            4           scalar   SAVE             1941,1942                         
 OUTENV                     Subr   2102                                                           2102                              
 OUTGES                     Subr   2112                                                           2112                              
 PT                         Dummy  1205     R(4)            4           scalar   ARG,INOUT        1298,1500                         
 PWT                        Local  1230     R(4)            4     1     19       SAVE             1583,1599,1601,1603               
 RDSPP1                     Subr   1431                                                           1431                              
 RDSPP2                     Subr   1434                                                           1434                              
 REAL                       Func   1507                                 scalar                    1507,1509                         
 RLATMN                     Dummy  1207     R(4)            4           scalar   ARG,INOUT        1890,2097                         
 RLATMX                     Dummy  1207     R(4)            4           scalar   ARG,INOUT        1889,2097                         
 RLATP                      Dummy  1205     R(4)            4     1     0        ARG,INOUT        1543,1966                         
 RLONMN                     Dummy  1207     R(4)            4           scalar   ARG,INOUT        1893,2097                         
 RLONMX                     Dummy  1207     R(4)            4           scalar   ARG,INOUT        1894,2098                         
 RLONP                      Dummy  1205     R(4)            4     1     0        ARG,INOUT        1542,1965                         
 SCASP1                     Subr   1928                                                           1928,1973,1975                    
 SETFEN                     Subr   1658                                                                                             
 SETRES                     Subr   1536                                                           1536,1926,1956                    
 SETTRN                     Subr   1529                                                           1529,1925,1950                    
 SLVSP1                     Subr   1396                                                           1396                              
 SLVSP2                     Subr   1399                                                           1399                              
 SPDDSV                     Local  1747     R(4)            4           scalar   SAVE             1747,1791,1792                    
 SPDENV                     Local  1721     R(4)            4           scalar   SAVE             1721                              
 SPDSSV                     Local  1716     R(4)            4           scalar   SAVE             1716                              
 SPDSTM                     Dummy  1208     R(4)            4           scalar   ARG,INOUT        1672,1679,1687,1689,1690,1709,1791
                                                                                                  ,1792,1843,1845                   
 SQRT                       Func   1805                                 scalar                    1805,1810                         
 STRDIF                     Local  1231     R(4)            4     3     304      SAVE             1710,1743,1759,1760,1770,1771,1813
                                                                                                  ,1824,1825,1826,1827,1828,1829    
 STRWND                     Local  1230     R(4)            4     3     608      SAVE             1576,1577,1578,1595,1596,1600,1602
                                                                                                  ,1605,1606,1607,1608,1618,1626,163
                                                                                                  6,1637,1646,1647,1709,1716,1721,17
                                                                                                  47,1803,1804,1805,1806,1810,1811,1
                                                                                                  822,1823                          
 SVRSP1                     Subr   1397                                                           1397                              
 SVRSP2                     Subr   1400                                                           1400                              
 UDVSP1                     Subr   2057                                                           2057                              
 UOUT                       Local  1548     R(4)            4           scalar   SAVE             1548,1550,1553,1554               
 UPROP                      Dummy  1208     R(4)            4           scalar   ARG,INOUT        1679,1685,1689,1690               
 UROSP1                     Subr   1548                                                           1548,2038                         
 USTM                       Local  1673     R(4)            4           scalar   SAVE             1673,1679,1685,1687,1689,1690,1805
                                                                                                  ,1810,1992,1999                   
 USTMZ                      Local  1672     R(4)            4           scalar   SAVE             1672,1673                         

Page 53          Source Listing                  GRABMO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UV2DS                      Subr   1578                                                           1578,1607,1687,1716,1721,1747     
 UVDSP2                     Subr   2026                                                           2026,2064                         
 UVRSP2                     Subr   2011                                                           2011,2045                         
 UVWSP1                     Subr   1553                                                           1553,1556,2008,2023               
 UWND                       Local  1513     R(4)            4           scalar   SAVE             1513,1550,1554,1574,1576,1578     
 VDVSP1                     Subr   2059                                                           2059                              
 VESPD                      Local  1810     R(4)            4           scalar   SAVE             1810,1812,1815,1816,1821          
 VOUT                       Local  1549     R(4)            4           scalar   SAVE             1549,1551,1556,1557               
 VPROP                      Dummy  1208     R(4)            4           scalar   ARG,INOUT        1679,1686,1689,1690               
 VROSP1                     Subr   1549                                                           1549,2040                         
 VSTM                       Local  1674     R(4)            4           scalar   SAVE             1674,1679,1686,1687,1689,1690,1806
                                                                                                  ,1811,1993,2000                   
 VSTMZ                      Local  1672     R(4)            4           scalar   SAVE             1672,1674                         
 VWND                       Local  1514     R(4)            4           scalar   SAVE             1514,1551,1557,1575,1577,1578     
 WT                         Local  1518     R(4)            4           scalar   SAVE             1518,1544,1574,1575,1594,1599,1605
                                                                                                  ,1606                             
 WTP                        Dummy  1205     R(4)            4     1     0        ARG,INOUT        1544,1550,1551,1554,1557          
 XX                         Local  1542     R(4)            4           scalar   SAVE             1542,1548,1549,1553,1556,1965,1973
                                                                                                  ,1975,1978,2008,2011,2023,2026,203
                                                                                                  8,2040,2045,2057,2059,2064        
 YY                         Local  1543     R(4)            4           scalar   SAVE             1543,1548,1549,1553,1556,1966,1973
                                                                                                  ,1975,1978,2008,2011,2023,2026,203
                                                                                                  8,2040,2045,2057,2059,2064        
 ZCORN                      Local  1232     R(4)            4     2     8        SAVE             1929,1936,1937                    

Page 54          Source Listing                  GRABMO
2017-04-18 11:09                                 syndata.f

   2127 
   2128 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2129 C                .      .    .                                       .
   2130 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   2131 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   2132 C
   2133 C ABSTRACT: ??????????????????????????????????????????????????????????
   2134 C   ??????????????????????????????????????????????????????????????????
   2135 C
   2136 C PROGRAM HISTORY LOG:
   2137 C ????-??-??  S. J. LORD
   2138 C
   2139 C USAGE:    CALL ????????(????)
   2140 C   INPUT ARGUMENT LIST:
   2141 C     ??????   - ???????????????????????????????????????????????
   2142 C
   2143 C   OUTPUT ARGUMENT LIST:
   2144 C     ??????   - ???????????????????????????????????????????????
   2145 C
   2146 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   2147 C     ??????   - ???????????????????????????????????????????????
   2148 C
   2149 C   OUTPUT FILES:
   2150 C     ??????   - ???????????????????????????????????????????????
   2151 C
   2152 C REMARKS: ?????????????????????????????????????????????????????
   2153 C
   2154 C ATTRIBUTES:
   2155 C   LANGUAGE: FORTRAN 90
   2156 C   MACHINE:  NCEP WCOSS
   2157 C
   2158 C$$$
   2159 
   2160 C  *****************************
   2161 C  ****  SUBROUTINE SETMOD  ****
   2162 C  ****     ENTRY SETDTS    ****
   2163 C  ****     ENTRY SVRSP1    ****
   2164 C  ****     ENTRY SLVSP1    ****
   2165 C  ****     ENTRY SVRSP2    ****
   2166 C  ****     ENTRY SLVSP2    ****
   2167 C  ****     ENTRY HDRSPP    ****
   2168 C  *****************************
   2169 
   2170       SUBROUTINE SETMOD(KLMAX,IPREQ,ILVL,INDXP,KLBOG,JVMAX,IVREQ,IVAR,
   2171      1                  INDXV,JVBOG,idatez,iutcz,stmnmz,klz,jvz,mwenv,
   2172      2                  rlatmn,rlatmx,rlonmn,rlonmx,off1,off2,mtitle,
   2173      3                  nchar)
   2174 
   2175 C**DEB  PARAMETER(KDIM=#PLEVS)  PL1 PARAMETERS ARE A POSSIBILITY HERE
   2176       PARAMETER(KDIMS1=12)
   2177       PARAMETER(JDIMS1= 7)
   2178       PARAMETER(KDIMS2=12)
   2179       PARAMETER(JDIMS2= 7)
   2180 
   2181       CHARACTER STMNAM*(12),STMNMZ*(*),INFL1*2,INFL2*2,MTITLE*102,ANAL*6
   2182 
   2183       SAVE

Page 55          Source Listing                  SETMOD
2017-04-18 11:09                                 syndata.f

   2184 
   2185       DIMENSION IPREQ(KLMAX),ILVL(KLMAX),INDXP(KLMAX),IVREQ(JVMAX),
   2186      1          IVAR(JVMAX),INDXV(JVMAX)
   2187 
   2188       DIMENSION IPFL1(KDIMS1),IVFL1(JDIMS1),INFL1(JDIMS1),IPFL2(KDIMS2),
   2189      1          IVFL2(JDIMS2),INFL2(JDIMS2)
   2190 
   2191       DIMENSION INDXVS(JDIMS1),INDXPS(KDIMS1)
   2192 
   2193       LOGICAL FOUND
   2194 
   2195       DATA IPFL1/1000,850,700,500,400,300,250,200,150,100,70,50/,
   2196      1     IVFL1/3,4,5,6,7,2,1/,
   2197      2     INFL1/'Z ','$ ','$ ','$R','$D','RH','T '/
   2198 
   2199       DATA IPFL2/1000,850,700,500,400,300,250,200,150,100,70,50/,
   2200      1     IVFL2/3,6,7,4,5,2,1/,
   2201      2     INFL2/'Z ','$R','$D','$ ','$ ','RH','T '/
   2202       DATA ANAL/' FANAL'/,NCHARZ/102/
   2203 
   2204 C  THIS SET OF ENTRIES IN SUBROUTINE SETMOD CONTAINS MODEL SPECIFIC
   2205 C    INFORMATION ABOUT THE FILE STRUCTURES.  CURRENT MODEL AND FILE
   2206 C    TYPES ARE:
   2207 C      MODTYP= 0: MODEL INDEPENDENT METHOD DEFAULTS TO SPECTRAL MODEL
   2208 C                 STRUCTURE FOR CONVENIENCE
   2209 C      MODTYP= 1: SPECTRAL MODEL
   2210 C      MODTYP=-1: GRID POINT MODEL
   2211 
   2212 C    FILE TYPES:
   2213 C      IMFLTP=1: NCEP GLOBAL SPECTRAL MODEL, OPERATIONAL R40 PRESSURE
   2214 C                COEFFICIENT FILE == CALL SLVSP1 FOR VERTICAL LEVELS
   2215 C                                  == CALL SVRSP1 FOR VARIABLES
   2216 C      IMFLTP=2: NCEP GLOBAL SPECTRAL MODEL, OPERATIONAL PRESSURE
   2217 C                COEFFICIENTS OF VORTICITY, DIVERGENCE
   2218 C                                 == CALL SLVSP2 FOR VERTICAL LEVELS
   2219 C                                 == CALL SVRSP2 FOR VARIABLES
   2220 C      IMFLTP>2: NOT IMPLEMENTED
   2221 
   2222 C-----------------------------------------------------------------------
   2223 
   2224 C  ++++++++++++++++++++++++
   2225 C  ++++  ENTRY SETDTS  ++++
   2226 C  ++++++++++++++++++++++++
   2227 
   2228       ENTRY SETDTS(IDATEZ,IUTCZ,STMNMZ)
   2229 
   2230       IDATE =IDATEZ
   2231       IUTC  =IUTCZ
   2232       STMNAM=STMNMZ
   2233       RETURN
   2234 
   2235 C-----------------------------------------------------------------------
   2236 
   2237 C  ++++++++++++++++++++++++
   2238 C  ++++  ENTRY SLVSP1  ++++
   2239 C  ++++++++++++++++++++++++
   2240 

Page 56          Source Listing                  SETMOD
2017-04-18 11:09                                 syndata.f

   2241       ENTRY SLVSP1(KLMAX,IPREQ,ILVL,INDXP,KLBOG)
   2242 
   2243       IMFLTP=1
   2244       KL=0
   2245       DO 40 KP=1,KLMAX
   2246       FOUND=.FALSE.
   2247       DO 20 KLF=1,KDIMS1
   2248       IF(IPREQ(KP) .EQ. IPFL1(KLF))   THEN
   2249       FOUND=.TRUE.
   2250       KL=KL+1
   2251       ILVL(KL)=IPFL1(KLF)
   2252       INDXP (KL)=KLF
   2253       INDXPS(KL)=KLF
   2254       ENDIF
   2255    20 CONTINUE
   2256 
   2257       IF(.NOT. FOUND)  THEN
   2258       WRITE(6,21) IPREQ(KP)
   2259    21 FORMAT('###### PRESSSURE LEVEL',I3,' NOT AVAILABLE IN FILE.')
   2260       IPREQ(KP)=-IPREQ(KP)
   2261       ENDIF
   2262 
   2263    40 CONTINUE
   2264       KLBOG=KL
   2265       RETURN
   2266 
   2267 C-----------------------------------------------------------------------
   2268 
   2269 C  ++++++++++++++++++++++++
   2270 C  ++++  ENTRY SLVSP2  ++++
   2271 C  ++++++++++++++++++++++++
   2272 
   2273       ENTRY SLVSP2(KLMAX,IPREQ,ILVL,INDXP,KLBOG)
   2274 
   2275       IMFLTP=2
   2276       KL=0
   2277       DO 140 KP=1,KLMAX
   2278       FOUND=.FALSE.
   2279       DO 120 KLF=1,KDIMS2
   2280       IF(IPREQ(KP) .EQ. IPFL2(KLF))   THEN
   2281       FOUND=.TRUE.
   2282       KL=KL+1
   2283       ILVL(KL)=IPFL2(KLF)
   2284       INDXP (KL)=KLF
   2285       INDXPS(KL)=KLF
   2286       ENDIF
   2287   120 CONTINUE
   2288 
   2289       IF(.NOT. FOUND)  THEN
   2290       WRITE(6,121) IPREQ(KP)
   2291   121 FORMAT('###### PRESSSURE LEVEL',I3,' NOT AVAILABLE IN FILE.')
   2292       IPREQ(KP)=-IPREQ(KP)
   2293       ENDIF
   2294 
   2295   140 CONTINUE
   2296       KLBOG=KL
   2297       RETURN

Page 57          Source Listing                  SETMOD
2017-04-18 11:09                                 syndata.f

   2298 
   2299 C-----------------------------------------------------------------------
   2300 
   2301 C  ++++++++++++++++++++++++
   2302 C  ++++  ENTRY SVRSP1  ++++
   2303 C  ++++++++++++++++++++++++
   2304 
   2305       ENTRY SVRSP1(JVMAX,IVREQ,IVAR,INDXV,JVBOG)
   2306 
   2307       IMFLTP=1
   2308       JV=0
   2309       DO 240 JJ=1,JVMAX
   2310       FOUND=.FALSE.
   2311       DO 220 JLF=1,JDIMS1
   2312       IF(IVREQ(JJ) .EQ. IVFL1(JLF))   THEN
   2313       FOUND=.TRUE.
   2314       JV=JV+1
   2315       IVAR(JV)=IVFL1(JLF)
   2316       INDXV (JV)=JLF
   2317       INDXVS(JV)=JLF
   2318       ENDIF
   2319   220 CONTINUE
   2320 
   2321       IF(.NOT. FOUND)  THEN
   2322       WRITE(6,221) IVREQ(JJ)
   2323   221 FORMAT('###### VARIABLE',I3,' NOT AVAILABLE IN FILE.')
   2324       IVREQ(JJ)=-IVREQ(JJ)
   2325       ENDIF
   2326 
   2327   240 CONTINUE
   2328       JVBOG=JV
   2329       RETURN
   2330 
   2331 C-----------------------------------------------------------------------
   2332 
   2333 C  ++++++++++++++++++++++++
   2334 C  ++++  ENTRY SVRSP2  ++++
   2335 C  ++++++++++++++++++++++++
   2336 
   2337       ENTRY SVRSP2(JVMAX,IVREQ,IVAR,INDXV,JVBOG)
   2338 
   2339       IMFLTP=2
   2340       JV=0
   2341       DO 340 JJ=1,JVMAX
   2342       FOUND=.FALSE.
   2343       DO 320 JLF=1,JDIMS2
   2344       IF(IVREQ(JJ) .EQ. IVFL2(JLF))   THEN
   2345       FOUND=.TRUE.
   2346       JV=JV+1
   2347       IVAR(JV)=IVFL2(JLF)
   2348       INDXV (JV)=JLF
   2349       INDXVS(JV)=JLF
   2350       ENDIF
   2351   320 CONTINUE
   2352 
   2353       IF(.NOT. FOUND)  THEN
   2354       WRITE(6,321) IVREQ(JJ)

Page 58          Source Listing                  SETMOD
2017-04-18 11:09                                 syndata.f

   2355   321 FORMAT('###### VARIABLE',I3,' NOT AVAILABLE IN FILE.')
   2356       IVREQ(JJ)=-IVREQ(JJ)
   2357       ENDIF
   2358 
   2359   340 CONTINUE
   2360       JVBOG=JV
   2361       RETURN
   2362 
   2363 C-----------------------------------------------------------------------
   2364 
   2365 C  ++++++++++++++++++++++++
   2366 C  ++++  ENTRY HDRSPP  ++++
   2367 C  ++++++++++++++++++++++++
   2368 
   2369       ENTRY HDRSPP(KLZ,JVZ,MWENV,RLATMN,RLATMX,RLONMN,RLONMX,OFF1,OFF2,
   2370      1             MTITLE,NCHAR)
   2371 
   2372       NCHAR=NCHARZ
   2373       MTITLE=' '
   2374 
   2375       IF(IMFLTP .EQ. 1)  THEN
   2376       MTITLE(1:2)=INFL1(INDXVS(JVZ))
   2377       WRITE(MTITLE(9:12),201) IPFL1(INDXPS(KLZ))
   2378   201 FORMAT(I4)
   2379       ELSE IF(IMFLTP .EQ. 2)  THEN
   2380       MTITLE(1:2)=INFL2(INDXVS(JVZ))
   2381       WRITE(MTITLE(9:12),201) IPFL2(INDXPS(KLZ))
   2382       ENDIF
   2383 
   2384       MTITLE(13:14)='MB'
   2385       WRITE(MTITLE(16:24),202) IDATE
   2386   202 FORMAT(I9)
   2387       WRITE(MTITLE(26:29),203) IUTC
   2388   203 FORMAT(I4)
   2389       WRITE(MTITLE(31:42),204) STMNAM
   2390   204 FORMAT(A)
   2391       WRITE(MTITLE(47:52),205) ANAL
   2392   205 FORMAT(A6)
   2393       MTITLE(54:56)='MW='
   2394       WRITE(MTITLE(57:59),206) MWENV
   2395   206 FORMAT(I3)
   2396       IRLTMN = NINT(RLATMN*10.)
   2397       RLTMN = IRLTMN*0.1
   2398       IRLTMX = NINT(RLATMX*10.)
   2399       RLTMX = IRLTMX*0.1
   2400       IRLNMN = NINT(RLONMN*10.)
   2401       RLNMN = IRLNMN*0.1
   2402       IRLNMX = NINT(RLONMX*10.)
   2403       RLNMX = IRLNMX*0.1
   2404       WRITE(MTITLE(61:84),207) RLTMN,RLTMX,RLNMN,RLNMX
   2405   207 FORMAT(4F6.1)
   2406       MTITLE(86:92)='OFF1/2='
   2407       IOFF1 = NINT(OFF1*10.)
   2408       ROFF1 = IOFF1*0.1
   2409       IOFF2 = NINT(OFF2*10.)
   2410       ROFF2 = IOFF2*0.1
   2411       WRITE(MTITLE(93:102),208) ROFF1,ROFF2

Page 59          Source Listing                  SETMOD
2017-04-18 11:09                                 syndata.f

   2412   208 FORMAT(2F5.1)
   2413 c && 5 comments
   2414 CC    WRITE(6,211)  KLZ,JVZ,IDATE,IUTC,STMNAM,ANAL,MWENV,RLATMN,RLATMX,
   2415 CC   1              RLONMN,RLONMX,MTITLE
   2416 CC211 FORMAT(/'...WRITING FILE HEADER, KLZ,JVZ,IDATE,IUTC,STMNAM,',
   2417 CC   1       'ANAL,MWENV,RLATMN,RLATMX,RLONMN,RLONMX,MTITLE=',/,5X,
   2418 CC   2       2I5,I9,I6,2X,A12,2X,A6,I5,4F11.4,/,5X,A)
   2419       RETURN
   2420 
   2421       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 hdrspp_               setmod_               slvsp2_               svrsp2_             
 setdts_               slvsp1_               svrsp1_                                   


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 120                        Label  2287                                                           2279                              
 121                        Label  2291                                                           2290                              
 140                        Label  2295                                                           2277                              
 20                         Label  2255                                                           2247                              
 201                        Label  2378                                                           2377,2381                         
 202                        Label  2386                                                           2385                              
 203                        Label  2388                                                           2387                              
 204                        Label  2390                                                           2389                              
 205                        Label  2392                                                           2391                              
 206                        Label  2395                                                           2394                              
 207                        Label  2405                                                           2404                              
 208                        Label  2412                                                           2411                              
 21                         Label  2259                                                           2258                              
 220                        Label  2319                                                           2311                              
 221                        Label  2323                                                           2322                              
 240                        Label  2327                                                           2309                              
 320                        Label  2351                                                           2343                              
 321                        Label  2355                                                           2354                              
 340                        Label  2359                                                           2341                              
 40                         Label  2263                                                           2245                              
 ANAL                       Local  2181     CHAR            6           scalar   SAVE             2202,2391                         
 FOUND                      Local  2193     L(4)            4           scalar   SAVE             2246,2249,2257,2278,2281,2289,2310
                                                                                                  ,2313,2321,2342,2345,2353         
 HDRSPP                     Subr   2369                                                                                             
 IDATE                      Local  2230     I(4)            4           scalar   SAVE             2230,2385                         
 IDATEZ                     Dummy  2171     I(4)            4           scalar   ARG,INOUT        2230                              
 ILVL                       Dummy  2170     I(4)            4     1     0        ARG,INOUT        2251,2283                         
 IMFLTP                     Local  2243     I(4)            4           scalar   SAVE             2243,2275,2307,2339,2375,2379     
 INDXP                      Dummy  2170     I(4)            4     1     0        ARG,INOUT        2252,2284                         
 INDXPS                     Local  2191     I(4)            4     1     12       SAVE             2253,2285,2377,2381               
 INDXV                      Dummy  2171     I(4)            4     1     0        ARG,INOUT        2316,2348                         
 INDXVS                     Local  2191     I(4)            4     1     7        SAVE             2317,2349,2376,2380               
 INFL1                      Local  2181     CHAR            2     1     7        SAVE             2197,2376                         

Page 60          Source Listing                  SETMOD
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INFL2                      Local  2181     CHAR            2     1     7        SAVE             2201,2380                         
 IOFF1                      Local  2407     I(4)            4           scalar   SAVE             2407,2408                         
 IOFF2                      Local  2409     I(4)            4           scalar   SAVE             2409,2410                         
 IPFL1                      Local  2188     I(4)            4     1     12       SAVE             2195,2248,2251,2377               
 IPFL2                      Local  2188     I(4)            4     1     12       SAVE             2199,2280,2283,2381               
 IPREQ                      Dummy  2170     I(4)            4     1     0        ARG,INOUT        2248,2258,2260,2280,2290,2292     
 IRLNMN                     Local  2400     I(4)            4           scalar   SAVE             2400,2401                         
 IRLNMX                     Local  2402     I(4)            4           scalar   SAVE             2402,2403                         
 IRLTMN                     Local  2396     I(4)            4           scalar   SAVE             2396,2397                         
 IRLTMX                     Local  2398     I(4)            4           scalar   SAVE             2398,2399                         
 IUTC                       Local  2231     I(4)            4           scalar   SAVE             2231,2387                         
 IUTCZ                      Dummy  2171     I(4)            4           scalar   ARG,INOUT        2231                              
 IVAR                       Dummy  2170     I(4)            4     1     0        ARG,INOUT        2315,2347                         
 IVFL1                      Local  2188     I(4)            4     1     7        SAVE             2196,2312,2315                    
 IVFL2                      Local  2189     I(4)            4     1     7        SAVE             2200,2344,2347                    
 IVREQ                      Dummy  2170     I(4)            4     1     0        ARG,INOUT        2312,2322,2324,2344,2354,2356     
 JDIMS1                     Param  2177     I(4)            4           scalar                    2188,2191,2311                    
 JDIMS2                     Param  2179     I(4)            4           scalar                    2189,2343                         
 JJ                         Local  2309     I(4)            4           scalar   SAVE             2309,2312,2322,2324,2341,2344,2354
                                                                                                  ,2356                             
 JLF                        Local  2311     I(4)            4           scalar   SAVE             2311,2312,2315,2316,2317,2343,2344
                                                                                                  ,2347,2348,2349                   
 JV                         Local  2308     I(4)            4           scalar   SAVE             2308,2314,2315,2316,2317,2328,2340
                                                                                                  ,2346,2347,2348,2349,2360         
 JVBOG                      Dummy  2171     I(4)            4           scalar   ARG,INOUT        2328,2360                         
 JVMAX                      Dummy  2170     I(4)            4           scalar   ARG,INOUT        2185,2186,2309,2341               
 JVZ                        Dummy  2171     I(4)            4           scalar   ARG,INOUT        2376,2380                         
 KDIMS1                     Param  2176     I(4)            4           scalar                    2188,2191,2247                    
 KDIMS2                     Param  2178     I(4)            4           scalar                    2188,2279                         
 KL                         Local  2244     I(4)            4           scalar   SAVE             2244,2250,2251,2252,2253,2264,2276
                                                                                                  ,2282,2283,2284,2285,2296         
 KLBOG                      Dummy  2170     I(4)            4           scalar   ARG,INOUT        2264,2296                         
 KLF                        Local  2247     I(4)            4           scalar   SAVE             2247,2248,2251,2252,2253,2279,2280
                                                                                                  ,2283,2284,2285                   
 KLMAX                      Dummy  2170     I(4)            4           scalar   ARG,INOUT        2185,2245,2277                    
 KLZ                        Dummy  2171     I(4)            4           scalar   ARG,INOUT        2377,2381                         
 KP                         Local  2245     I(4)            4           scalar   SAVE             2245,2248,2258,2260,2277,2280,2290
                                                                                                  ,2292                             
 MTITLE                     Dummy  2172     CHAR            102         scalar   ARG,INOUT        2373,2376,2377,2380,2381,2384,2385
                                                                                                  ,2387,2389,2391,2393,2394,2404,240
                                                                                                  6,2411                            
 MWENV                      Dummy  2171     I(4)            4           scalar   ARG,INOUT        2394                              
 NCHAR                      Dummy  2173     I(4)            4           scalar   ARG,INOUT        2372                              
 NCHARZ                     Local  2202     I(4)            4           scalar   SAVE             2202,2372                         
 NINT                       Func   2396                                 scalar                    2396,2398,2400,2402,2407,2409     
 OFF1                       Dummy  2172     R(4)            4           scalar   ARG,INOUT        2407                              
 OFF2                       Dummy  2172     R(4)            4           scalar   ARG,INOUT        2409                              
 RLATMN                     Dummy  2172     R(4)            4           scalar   ARG,INOUT        2396                              
 RLATMX                     Dummy  2172     R(4)            4           scalar   ARG,INOUT        2398                              
 RLNMN                      Local  2401     R(4)            4           scalar   SAVE             2401,2404                         
 RLNMX                      Local  2403     R(4)            4           scalar   SAVE             2403,2404                         
 RLONMN                     Dummy  2172     R(4)            4           scalar   ARG,INOUT        2400                              
 RLONMX                     Dummy  2172     R(4)            4           scalar   ARG,INOUT        2402                              
 RLTMN                      Local  2397     R(4)            4           scalar   SAVE             2397,2404                         
 RLTMX                      Local  2399     R(4)            4           scalar   SAVE             2399,2404                         

Page 61          Source Listing                  SETMOD
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ROFF1                      Local  2408     R(4)            4           scalar   SAVE             2408,2411                         
 ROFF2                      Local  2410     R(4)            4           scalar   SAVE             2410,2411                         
 SETDTS                     Subr   2228                                                                                             
 SETMOD                     Subr   2170                                                                                             
 SLVSP1                     Subr   2241                                                                                             
 SLVSP2                     Subr   2273                                                                                             
 STMNAM                     Local  2181     CHAR            12          scalar   SAVE             2232,2389                         
 STMNMZ                     Dummy  2171     CHAR                        scalar   ARG,INOUT        2232                              
 SVRSP1                     Subr   2305                                                                                             
 SVRSP2                     Subr   2337                                                                                             

Page 62          Source Listing                  SETMOD
2017-04-18 11:09                                 syndata.f

   2422 
   2423 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2424 C                .      .    .                                       .
   2425 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   2426 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   2427 C
   2428 C ABSTRACT: ??????????????????????????????????????????????????????????
   2429 C   ??????????????????????????????????????????????????????????????????
   2430 C
   2431 C PROGRAM HISTORY LOG:
   2432 C ????-??-??  S. J. LORD
   2433 C
   2434 C USAGE:    CALL ????????(????)
   2435 C   INPUT ARGUMENT LIST:
   2436 C     ??????   - ???????????????????????????????????????????????
   2437 C
   2438 C   OUTPUT ARGUMENT LIST:
   2439 C     ??????   - ???????????????????????????????????????????????
   2440 C
   2441 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   2442 C     ??????   - ???????????????????????????????????????????????
   2443 C
   2444 C   OUTPUT FILES:
   2445 C     ??????   - ???????????????????????????????????????????????
   2446 C
   2447 C REMARKS: ?????????????????????????????????????????????????????
   2448 C
   2449 C ATTRIBUTES:
   2450 C   LANGUAGE: FORTRAN 90
   2451 C   MACHINE:  NCEP WCOSS
   2452 C
   2453 C$$$
   2454 
   2455 C  *****************************
   2456 C  ****  SUBROUTINE SPMODL  ****
   2457 C  ****     ENTRY MODL1     ****
   2458 C  ****     ENTRY RDSPP1    ****
   2459 C  ****     ENTRY RDSPP2    ****
   2460 C  ****     ENTRY SETTRN    ****
   2461 C  ****     ENTRY SETRES    ****
   2462 C  ****     ENTRY SCASP1    ****
   2463 C  ****     ENTRY UVWSP1    ****
   2464 C  ****     ENTRY UROSP1    ****
   2465 C  ****     ENTRY VROSP1    ****
   2466 C  ****     ENTRY UDVSP1    ****
   2467 C  ****     ENTRY VDVSP1    ****
   2468 C  ****     ENTRY UVWSP2    ****
   2469 C  ****     ENTRY UROSP2    ****
   2470 C  ****     ENTRY VROSP2    ****
   2471 C  ****     ENTRY UDVSP2    ****
   2472 C  ****     ENTRY VDVSP2    ****
   2473 C  *****************************
   2474 
   2475       SUBROUTINE SPMODL(IUNIT,KLBOG,JVBOG,MWAVE,INDXP,INDXV,KLZ,JVZ,MWV,
   2476      1                  IPLUS,IRO,XX,YY,SCOUT,UVOUT,UOUT,VOUT)
   2477 
   2478 C  PARAMETERS FROM H. L. PAN (L3V1.MAP.MAPSORC(PRS)): OPERATIONAL

Page 63          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2479 C    PRESSURE COEFFICIENT FILE FROM GLOBAL SPECTRAL MODEL
   2480 
   2481 CCCC  PARAMETER(NSPACE=3600)
   2482       PARAMETER(MAXBGK=10)
   2483       PARAMETER(MAXBGV= 7)
   2484 
   2485       PARAMETER (NSPACE=3600)
   2486 
   2487       PARAMETER (MAXZWV=40,IROMB=1,MAXUWV=MAXZWV+1,
   2488      2           MZWVD=(MAXZWV+1)*(MAXZWV+2)/2*(1-IROMB)+
   2489      3                (MAXZWV+1)*(MAXZWV+1)*IROMB, MZWVD2=MZWVD*2,
   2490      4           MUWVD=(MAXUWV+1)*(MAXUWV+2)/2*(1-IROMB)+
   2491      5                (MAXUWV+1)*(MAXUWV+1)*IROMB, MUWVD2=MUWVD*2)
   2492       PARAMETER(KDIM=12,KDIMQ=6)
   2493 
   2494       SAVE
   2495 
   2496       REAL(8)  COSDEG_8
   2497 
   2498       DIMENSION WAVE1(MUWVD2),WAVE2(MUWVD2),WAVE3(MUWVD2),WAVEX(MUWVD2),
   2499      1          WAVEZ(MUWVD2),QIMER(MUWVD),FER(MUWVD),IDTSP(4),
   2500      2          fac(MUWVD)  ! dak 7/3/05: fix bounds-check error
   2501       DIMENSION INDXP(KLBOG),INDXV(JVBOG),ARRAY(NSPACE,MAXBGV,MAXBGK)
   2502 
   2503       LOGICAL UVSAVE,VDSAVE
   2504       CHARACTER LAB(4)*8
   2505 
   2506       DATA ER/6371.0E3/
   2507 cc dak 7/3/05      DATA FAC/0.0/
   2508       DATA fac/muwvd*0.0/ !dak 7/3/05: fix bounds-check error
   2509 
   2510 C-----------------------------------------------------------------------
   2511 
   2512       ENTRY MODL1(IUNIT,KLBOG,JVBOG,MWAVE,INDXP,INDXV)
   2513 
   2514 C  FILE READER AND SELECTOR FOR OPERATIONAL PRESSURE COEFFICIENT FILE
   2515 C    FROM NCEP GLOBAL SPECTRAL MODEL
   2516 
   2517       MWAVE=MAXZWV
   2518       MENDZ1=MAXZWV+1
   2519 
   2520 C  OVERHEAD CHORES
   2521 
   2522       ERIV=1.0/ER
   2523       ERSQ=ER*ER
   2524       IF(MAXUWV.NE.MAXZWV) THEN
   2525       MUMAX=(MAXUWV+1)*MAXUWV*2
   2526       ELSE
   2527       MUMAX=MUWVD2
   2528       ENDIF
   2529 
   2530       WRITE(6,11) IUNIT,MZWVD2,MAXZWV,MUWVD2,MUMAX
   2531    11 FORMAT(////,25X,'*** EXTRACTING SPECTRAL COEFFICIENTS FROM',
   2532      1       ' NCEP GLOBAL SPECTRAL MODEL, PRESSURE COEFFICIENT ',
   2533      2       ' FILE ***',/,30X,'IUNIT,MZWVD2,MAXZWV,',
   2534      3       'MUWVD2,MUMAX=',5I7,//)
   2535 

Page 64          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2536       MSPACE=MAX(MZWVD2,MUMAX)
   2537       IF(MSPACE .GT. NSPACE)  THEN
   2538       WRITE(6,21) NSPACE,MSPACE
   2539    21 FORMAT(/'******INSUFFICIENT STORAGE ALLOCATED FOR STORING ',
   2540      1       'VARIABLES IN RDSPP1.',/,10X,'NSPACE=',I5,' WHILE ',
   2541      2       'AVAILABLE SPACE=MSPACE=',I5,/,10X,' THEREFORE, ',
   2542      3       'WE MUST TERMINATE THE PROGRAM.')
   2543       CALL ABRT1(' MODL1 ',21)
   2544       ENDIF
   2545 
   2546 C  SKIP HEADER RECORDS
   2547 
   2548       READ(IUNIT)  LAB
   2549 c && 2 comments
   2550 CC    WRITE(6,23) LAB
   2551 CC 23 FORMAT(/'...INPUT LABEL=',A8,2X,2Z16,2X,A8)
   2552       READ(IUNIT)  FHOUR,IDTSP
   2553       WRITE(6,25) IDTSP,FHOUR
   2554    25 FORMAT('...INPUT DATA DATE, TIME AND FORECAST HOUR:',/,4X,4I5,
   2555      1       F7.1)
   2556 
   2557       RETURN
   2558 
   2559 C-----------------------------------------------------------------------
   2560 
   2561 C  ++++++++++++++++++++++++
   2562 C  ++++  ENTRY RDSPP1  ++++
   2563 C  ++++++++++++++++++++++++
   2564 
   2565       ENTRY RDSPP1(IUNIT,KLBOG,JVBOG,MWAVE,INDXP,INDXV)
   2566 
   2567 C  READ TRIPLET COEFFICIENTS OF Z,U,V
   2568 C    PICK UP WHAT'S NEEDED BY LEVEL AND VARIABLE
   2569 
   2570       KK=1
   2571       DO 100 K=1,KDIM
   2572 
   2573       READ(IUNIT) (WAVE1(NM),NM=1,MZWVD2)
   2574       READ(IUNIT) (WAVE2(NM),NM=1,MUMAX)
   2575       READ(IUNIT) (WAVE3(NM),NM=1,MUMAX)
   2576 
   2577       IF(K .EQ. INDXP(KK))  THEN
   2578 
   2579       UVSAVE=.FALSE.
   2580       VDSAVE=.FALSE.
   2581       DO 80 JV=1,JVBOG
   2582 
   2583 C  HEIGHT
   2584 
   2585       IF(INDXV(JV) .EQ. 1)  THEN
   2586 
   2587       ARRAY(1:MZWVD2,JV,KK)=WAVE1(1:MZWVD2)
   2588 
   2589       WRITE(6,31) JV,KK,K,(WAVE1(NM),NM=1,10)
   2590    31 FORMAT(/'...PICKING UP HEIGHT COEF, STORAGE INDICES JV, KK=',2I5,
   2591      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2592 

Page 65          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2593 C  U WIND
   2594 
   2595       ELSE IF(INDXV(JV) .EQ. 2)  THEN
   2596 
   2597       ARRAY(1:MUMAX,JV,KK)=WAVE2(1:MUMAX)
   2598 
   2599       UVSAVE=.TRUE.
   2600       WRITE(6,41) JV,KK,K,(WAVE2(NM),NM=1,10)
   2601    41 FORMAT(/'...PICKING UP U WIND COEF, STORAGE INDICES JV, KK=',2I5,
   2602      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2603 
   2604 C  V WIND
   2605 
   2606       ELSE IF(INDXV(JV) .EQ. 3)  THEN
   2607 
   2608       IF(.NOT. UVSAVE)  THEN
   2609       WRITE(6,47) JV,KK,K
   2610    47 FORMAT(/'******TRYING TO SAVE V WHEN U NOT SAVED, JV,KK,K=',3I5,/,
   2611      1       15X,'WE IGNORE THIS INPUT')
   2612       GO TO 80
   2613       ENDIF
   2614 
   2615       ARRAY(1:MUMAX,JV,KK)=WAVE3(1:MUMAX)
   2616 
   2617       UVSAVE=.FALSE.
   2618       WRITE(6,51) JV,KK,K,(WAVE3(NM),NM=1,10)
   2619    51 FORMAT(/'...PICKING UP V WIND COEF, STORAGE INDICES JV, KK=',2I5,
   2620      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2621 
   2622 C  ROTATIONAL WIND (VORTICITY COEFFS)
   2623 
   2624       ELSE IF(INDXV(JV) .EQ. 4)  THEN
   2625 
   2626       VDSAVE=.TRUE.
   2627       CALL UVTOZD(WAVE2,WAVE3,WAVE1,WAVEX,MENDZ1,IROMB,ER,MZWVD2,MUMAX)
   2628 
   2629       ARRAY(1:MUMAX,JV,KK)=WAVE1(1:MUMAX)
   2630 
   2631       WRITE(6,61) JV,KK,K,(WAVE1(NM),NM=1,10)
   2632    61 FORMAT(/'...PICKING UP VORT COEFF, STORAGE INDICES JV, KK=',2I5,
   2633      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2634 
   2635 C  DIVERGENT WIND (DIVERGENCE COEFFS)
   2636 
   2637       ELSE IF(INDXV(JV) .EQ. 5)  THEN
   2638 
   2639       IF(.NOT. VDSAVE)
   2640      1 CALL UVTOZD(WAVE2,WAVE3,WAVE1,WAVEX,MENDZ1,IROMB,ER,MZWVD2,MUMAX)
   2641       VDSAVE=.TRUE.
   2642 
   2643       ARRAY(1:MUMAX,JV,KK)=WAVEX(1:MUMAX)
   2644 
   2645       WRITE(6,71) JV,KK,K,(WAVEX(NM),NM=1,10)
   2646    71 FORMAT(/'...PICKING UP DIVG COEFF, STORAGE INDICES JV, KK=',2I5,
   2647      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2648       ENDIF
   2649 

Page 66          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2650    80 CONTINUE
   2651 
   2652 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2653 
   2654         IF(KK .EQ. KLBOG)  THEN
   2655         KZZ=K+1
   2656         WRITE(6,87) KZZ,KDIM
   2657    87   FORMAT(/'...STORING IS NOW TERMINATED FOR HEIGHT AND WINDS. ',
   2658      1         'INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2659         DO 90 KS=KZZ,KDIM
   2660         READ(IUNIT)
   2661         READ(IUNIT)
   2662         READ(IUNIT)
   2663    90   CONTINUE
   2664         GO TO 200
   2665 
   2666         ELSE
   2667         KK=KK+1
   2668         ENDIF
   2669       ENDIF
   2670   100 CONTINUE
   2671 
   2672 C  RELATIVE HUMIDITY
   2673 
   2674   200 KK=1
   2675       DO 250 JV=1,JVBOG
   2676 
   2677       IF(INDXV(JV) .EQ. 6)  THEN
   2678       DO 230 K=1,KDIMQ
   2679       READ(IUNIT) (WAVE1(NM),NM=1,MZWVD2)
   2680 
   2681       IF(K .EQ. INDXP(KK))  THEN
   2682 
   2683       ARRAY(1:MZWVD2,JV,KK)=WAVE1(1:MZWVD2)
   2684 
   2685       WRITE(6,211) JV,KK,K,(WAVE1(NM),NM=1,10)
   2686   211 FORMAT(/'...PICKING UP RELH COEFF, STORAGE INDICES JV, KK=',2I5,
   2687      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2688 
   2689 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2690 
   2691         IF(KK .EQ. KLBOG)  THEN
   2692         KZZ=K+1
   2693         WRITE(6,217) KZZ,KDIMQ
   2694   217   FORMAT(/'...STORING IS NOW TERMINATED FOR RELATIVE HUMIDITY. ',
   2695      1         'K INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2696         DO 220 KS=KZZ,KDIMQ
   2697         READ(IUNIT)
   2698   220   CONTINUE
   2699         GO TO 300
   2700 
   2701         ELSE
   2702         KK=KK+1
   2703         ENDIF
   2704 
   2705       ENDIF
   2706   230 CONTINUE

Page 67          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2707 
   2708       ELSE
   2709         IF(JV .EQ. JVBOG .AND. KK .EQ. 1)  THEN
   2710         DO 240 KSK=1,KDIMQ
   2711         READ(IUNIT)
   2712   240   CONTINUE
   2713         ENDIF
   2714       ENDIF
   2715   250 CONTINUE
   2716 
   2717 C  TEMPERATURE ***NOTE: HISTORICAL CASES PRIOR TO JAN. 1990 HAVE
   2718 C                       STORED VIRTUAL TEMPERATURE ***
   2719 
   2720   300 KK=1
   2721       DO 350 JV=1,JVBOG
   2722 
   2723       IF(INDXV(JV) .EQ. 7)  THEN
   2724       DO 330 K=1,KDIM
   2725       READ(IUNIT) (WAVE1(NM),NM=1,MZWVD2)
   2726 
   2727       IF(K .EQ. INDXP(KK))  THEN
   2728 
   2729       ARRAY(1:MZWVD2,JV,KK)=WAVE1(1:MZWVD2)
   2730 
   2731       WRITE(6,311) JV,KK,K,(WAVE1(NM),NM=1,10)
   2732   311 FORMAT(/'...PICKING UP TEMP COEFF, STORAGE INDICES JV, KK=',2I5,
   2733      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2734 
   2735 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2736 
   2737         IF(KK .EQ. KLBOG)  THEN
   2738         KZZ=K+1
   2739         WRITE(6,317) KZZ,KDIM
   2740   317   FORMAT(/'...STORING IS NOW TERMINATED FOR TEMPERATURE. ',
   2741      1         ' K INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2742         DO 320 KS=KZZ,KDIM
   2743         READ(IUNIT)
   2744   320   CONTINUE
   2745         GO TO 400
   2746 
   2747         ELSE
   2748         KK=KK+1
   2749         ENDIF
   2750 
   2751       ENDIF
   2752   330 CONTINUE
   2753 
   2754       ELSE
   2755         IF(JV .EQ. JVBOG .AND. KK .EQ. 1)  THEN
   2756         DO 340 KSK=1,KDIM
   2757         READ(IUNIT)
   2758   340   CONTINUE
   2759         ENDIF
   2760       ENDIF
   2761   350 CONTINUE
   2762 
   2763   400 CONTINUE

Page 68          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2764 
   2765       RETURN
   2766 
   2767 C-----------------------------------------------------------------------
   2768 
   2769 C  ++++++++++++++++++++++++
   2770 C  ++++  ENTRY RDSPP2  ++++
   2771 C  ++++++++++++++++++++++++
   2772 
   2773       ENTRY RDSPP2(IUNIT,KLBOG,JVBOG,MWAVE,INDXP,INDXV)
   2774 
   2775 C  READ ALL LEVELS OF Z, THEN ALL LEVELS OF VORT/DIV PAIRS PICK UP
   2776 C    WHAT'S NEEDED BY LEVEL AND VARIABLE
   2777 
   2778 C  HEIGHT
   2779 
   2780       KK=1
   2781       DO 1200 JV=1,JVBOG
   2782       IF(INDXV(JV) .EQ. 1)  THEN
   2783       DO 1100 K=1,KDIM
   2784       READ(IUNIT) (WAVE1(NM),NM=1,MZWVD2)
   2785 
   2786       IF(K .EQ. INDXP(KK))  THEN
   2787 
   2788       ARRAY(1:MZWVD2,JV,KK)=WAVE1(1:MZWVD2)
   2789 
   2790       WRITE(6,1051) JV,KK,K,(WAVE1(NM),NM=1,10)
   2791  1051 FORMAT(/'...PICKING UP HEIGHT COEF, STORAGE INDICES JV, KK=',
   2792      1       2I5,' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2793 
   2794 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2795 
   2796         IF(KK .EQ. KLBOG)  THEN
   2797         KZZ=K+1
   2798         WRITE(6,1071) KZZ,KDIM
   2799  1071   FORMAT(/'...STORING IS NOW TERMINATED FOR HEIGHT. ',
   2800      1         'INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2801         DO 1080 KS=KZZ,KDIM
   2802         READ(IUNIT)
   2803  1080   CONTINUE
   2804         GO TO 1210
   2805 
   2806         ELSE
   2807         KK=KK+1
   2808         ENDIF
   2809 
   2810       ENDIF
   2811  1100 CONTINUE
   2812 
   2813       ELSE
   2814         IF(JV .EQ. JVBOG .AND. KK .EQ. 1)  THEN
   2815         DO 1130 KS=1,KDIM
   2816         READ(IUNIT)
   2817  1130   CONTINUE
   2818         ENDIF
   2819       ENDIF
   2820  1200 CONTINUE

Page 69          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2821 
   2822 C  VORTICITY AND DIVERGENCE
   2823 
   2824  1210 KK=1
   2825       DO 1300 K=1,KDIM
   2826 
   2827       READ(IUNIT) (WAVE2(NM),NM=1,MZWVD2)
   2828       READ(IUNIT) (WAVE3(NM),NM=1,MZWVD2)
   2829 
   2830       IF(K .EQ. INDXP(KK))  THEN
   2831 
   2832       VDSAVE=.FALSE.
   2833       DO 1280 JV=1,JVBOG
   2834 
   2835 C  VORTICITY
   2836 
   2837       IF(INDXV(JV) .EQ. 2)  THEN
   2838 
   2839       ARRAY(1:MZWVD2,JV,KK)=WAVE2(1:MZWVD2)
   2840 
   2841       WRITE(6,1241) JV,KK,K,(WAVE2(NM),NM=1,10)
   2842  1241 FORMAT(/'...PICKING UP VORTICITY COEF, STORAGE INDICES JV, ',
   2843      1       'KK=',2I5,' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2844 
   2845 C  DIVERGENCE
   2846 
   2847       ELSE IF(INDXV(JV) .EQ. 3)  THEN
   2848 
   2849       ARRAY(1:MZWVD2,JV,KK)=WAVE3(1:MZWVD2)
   2850 
   2851       WRITE(6,1251) JV,KK,K,(WAVE3(NM),NM=1,10)
   2852  1251 FORMAT(/'...PICKING UP DIVERGENCE COEF, STORAGE INDICES JV, ',
   2853      1       'KK=',2I5,' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2854 
   2855 C  U AND V WINDS REQUIRE BOTH VORTICITY AND DIVERGENCE COEFFS
   2856 
   2857       ELSE IF(INDXV(JV) .EQ. 4 .OR. INDXV(JV) .EQ. 5)  THEN
   2858 
   2859       IF(.NOT. VDSAVE)  THEN
   2860 
   2861       ARRAY(1:MZWVD2,JV  ,KK)=WAVE2(1:MZWVD2)
   2862       ARRAY(1:MZWVD2,JV+1,KK)=WAVE3(1:MZWVD2)
   2863 
   2864       WRITE(6,1261) JV,KK,K,(WAVE2(NM),NM=1,10),(WAVE3(NM),NM=1,10)
   2865  1261 FORMAT(/'...STORING BOTH VORT AND DIV COEFFS FOR U,V: STORAGE ',
   2866      1       'INDICES JV, KK=',2I5,' LEVEL INDEX=',I5,' WAVES(1-10)=',/,
   2867      2       (5X,10E12.4))
   2868       VDSAVE=.TRUE.
   2869       ENDIF
   2870 
   2871       ENDIF
   2872  1280 CONTINUE
   2873 
   2874 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2875 
   2876         IF(KK .EQ. KLBOG)  THEN
   2877         KZZ=K+1

Page 70          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2878         WRITE(6,1287) KZZ,KDIM
   2879  1287   FORMAT(/'...STORING IS NOW TERMINATED FOR HEIGHT AND WINDS. ',
   2880      1         'INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2881         DO 1290 KS=KZZ,KDIM
   2882         READ(IUNIT)
   2883         READ(IUNIT)
   2884  1290   CONTINUE
   2885         GO TO 1310
   2886 
   2887         ELSE
   2888         KK=KK+1
   2889         ENDIF
   2890       ENDIF
   2891  1300 CONTINUE
   2892 
   2893 C  RELATIVE HUMIDITY
   2894 
   2895  1310 KK=1
   2896       DO 1450 JV=1,JVBOG
   2897 
   2898       IF(INDXV(JV) .EQ. 6)  THEN
   2899       DO 1430 K=1,KDIMQ
   2900       READ(IUNIT) (WAVE1(NM),NM=1,MZWVD2)
   2901 
   2902       IF(K .EQ. INDXP(KK))  THEN
   2903 
   2904       ARRAY(1:MZWVD2,JV,KK)=WAVE1(1:MZWVD2)
   2905 
   2906       WRITE(6,1411) JV,KK,K,(WAVE1(NM),NM=1,10)
   2907  1411 FORMAT(/'...PICKING UP RELH COEFF, STORAGE INDICES JV, KK=',2I5,
   2908      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2909 
   2910 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2911 
   2912         IF(KK .EQ. KLBOG)  THEN
   2913         KZZ=K+1
   2914         WRITE(6,1417) KZZ,KDIMQ
   2915  1417   FORMAT(/'...STORING IS NOW TERMINATED FOR RELATIVE HUMIDITY. ',
   2916      1         'K INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2917         DO 1420 KS=KZZ,KDIMQ
   2918         READ(IUNIT)
   2919  1420   CONTINUE
   2920         GO TO 1500
   2921 
   2922         ELSE
   2923         KK=KK+1
   2924         ENDIF
   2925 
   2926       ENDIF
   2927  1430 CONTINUE
   2928 
   2929       ELSE
   2930         IF(JV .EQ. JVBOG .AND. KK .EQ. 1)  THEN
   2931         DO 1440 KSK=1,KDIMQ
   2932         READ(IUNIT)
   2933  1440   CONTINUE
   2934         ENDIF

Page 71          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2935       ENDIF
   2936  1450 CONTINUE
   2937 
   2938 C  TEMPERATURE ***NOTE: HISTORICAL CASES PRIOR TO JAN. 1990 HAVE
   2939 C                       STORED VIRTUAL TEMPERATURE ***
   2940 
   2941  1500 KK=1
   2942       DO 1550 JV=1,JVBOG
   2943 
   2944       IF(INDXV(JV) .EQ. 7)  THEN
   2945       DO 1530 K=1,KDIM
   2946       READ(IUNIT) (WAVE1(NM),NM=1,MZWVD2)
   2947 
   2948       IF(K .EQ. INDXP(KK))  THEN
   2949 
   2950       ARRAY(1:MZWVD2,JV,KK)=WAVE1(1:MZWVD2)
   2951 
   2952       WRITE(6,1511) JV,KK,K,(WAVE1(NM),NM=1,10)
   2953  1511 FORMAT(/'...PICKING UP TEMP COEFF, STORAGE INDICES JV, KK=',2I5,
   2954      1       ' LEVEL INDEX=',I5,' WAVES(1-10)=',/,5X,10E12.4)
   2955 
   2956 C  TERMINATE STORING LEVELS SINCE ARRAY IS FULL FOR LEVELS
   2957 
   2958         IF(KK .EQ. KLBOG)  THEN
   2959         KZZ=K+1
   2960         WRITE(6,1517) KZZ,KDIM
   2961  1517   FORMAT(/'...STORING IS NOW TERMINATED FOR TEMPERATURE. ',
   2962      1         ' K INDICES',I3,' TO',I3,' WILL BE SKIPPED.')
   2963         DO 1520 KS=KZZ,KDIM
   2964         READ(IUNIT)
   2965  1520   CONTINUE
   2966         GO TO 1600
   2967 
   2968         ELSE
   2969         KK=KK+1
   2970         ENDIF
   2971 
   2972       ENDIF
   2973  1530 CONTINUE
   2974 
   2975       ELSE
   2976         IF(JV .EQ. JVBOG)  THEN
   2977         DO 1540 KSK=1,KDIM
   2978         READ(IUNIT)
   2979  1540   CONTINUE
   2980         ENDIF
   2981       ENDIF
   2982  1550 CONTINUE
   2983 
   2984  1600 CONTINUE
   2985 
   2986       RETURN
   2987 
   2988 C-----------------------------------------------------------------------
   2989 
   2990 C  ++++++++++++++++++++++++
   2991 C  ++++  ENTRY SETTRN  ++++

Page 72          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   2992 C  ++++++++++++++++++++++++
   2993 
   2994       ENTRY SETTRN(KLZ,JVZ,MWV,IPLUS,IRO)
   2995 
   2996       MENDZ1=MWV+1
   2997       NM =0
   2998       DO 2020 MM=1,MENDZ1
   2999       M=MM-1
   3000       NEND1=MENDZ1
   3001       IF(IRO.EQ.1) NEND1=MM+MENDZ1-1
   3002       DO 2010 NN=MM,NEND1
   3003       N=NN-1
   3004       X1=-REAL(N*(N+1))
   3005       X4=0.
   3006       IF(N.NE.0) X4=ERSQ/X1
   3007       NM=NM+1
   3008       FER   (NM)=X4*ERIV
   3009       QIMER (NM)=X4*ERIV*REAL(M)
   3010  2010 CONTINUE
   3011  2020 CONTINUE
   3012 
   3013 C-----------------------------------------------------------------------
   3014 
   3015 C  ++++++++++++++++++++++++
   3016 C  ++++  ENTRY SETRES  ++++
   3017 C  ++++++++++++++++++++++++
   3018 
   3019       ENTRY SETRES(KLZ,JVZ,MWV,IPLUS,IRO)
   3020       CALL CHGRES(MWAVE+IPLUS,IROMB,ARRAY(1,JVZ,KLZ),MWV+IPLUS,
   3021      1            IRO,WAVEZ)
   3022       RETURN
   3023 
   3024 C-----------------------------------------------------------------------
   3025 
   3026 C  ++++++++++++++++++++++++
   3027 C  ++++  ENTRY SCASP1  ++++
   3028 C  ++++++++++++++++++++++++
   3029 
   3030       ENTRY SCASP1(XX,YY,JVZ,KLZ,MWV,IRO,SCOUT)
   3031 
   3032       CALL SPHERP(WAVEZ,MWV,IRO,0,0,FAC,YY,XX,SCOUT)
   3033       RETURN
   3034 
   3035 C-----------------------------------------------------------------------
   3036 
   3037 C  ++++++++++++++++++++++++
   3038 C  ++++  ENTRY UVWSP1  ++++
   3039 C  ++++++++++++++++++++++++
   3040 
   3041       ENTRY UVWSP1(XX,YY,JVZ,KLZ,MWV,IPLUS,IRO,UVOUT)
   3042 
   3043       IF(ABS(YY).NE.90.) THEN
   3044         COSLIV=1./COSDEG_8(YY)
   3045       ELSE
   3046         COSLIV=0.
   3047       ENDIF
   3048 

Page 73          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   3049       CALL SPHERP(WAVEZ,MWV+IPLUS,IRO,0,0,FAC,YY,XX,UVOUT)
   3050       UVOUT=UVOUT*COSLIV
   3051       RETURN
   3052 
   3053 C-----------------------------------------------------------------------
   3054 
   3055 C  ++++++++++++++++++++++++
   3056 C  ++++  ENTRY UROSP1  ++++
   3057 C  ++++++++++++++++++++++++
   3058 
   3059       ENTRY UROSP1(XX,YY,JVZ,KLZ,MWV,IRO,UOUT)
   3060 
   3061       IF(ABS(YY).NE.90.) THEN
   3062         COSLIV=1./COSDEG_8(YY)
   3063       ELSE
   3064         COSLIV=0.
   3065       ENDIF
   3066 
   3067       CALL SPHERP(WAVEZ,MWV,IRO,1,1,FER,YY,XX,UOUT)
   3068       UOUT=UOUT*COSLIV
   3069       RETURN
   3070 
   3071 C-----------------------------------------------------------------------
   3072 
   3073 C  ++++++++++++++++++++++++
   3074 C  ++++  ENTRY VROSP1  ++++
   3075 C  ++++++++++++++++++++++++
   3076 
   3077       ENTRY VROSP1(XX,YY,JVZ,KLZ,MWV,IRO,VOUT)
   3078 
   3079       CALL SPHERP(WAVEZ,MWV,IRO,0,-1,QIMER,YY,XX,VOUT)
   3080       VOUT=VOUT*COSLIV
   3081       RETURN
   3082 
   3083 C-----------------------------------------------------------------------
   3084 
   3085 C  ++++++++++++++++++++++++
   3086 C  ++++  ENTRY UDVSP1  ++++
   3087 C  ++++++++++++++++++++++++
   3088 
   3089       ENTRY UDVSP1(XX,YY,JVZ,KLZ,MWV,IRO,UOUT)
   3090 
   3091       IF(ABS(YY).NE.90.) THEN
   3092         COSLIV=1./COSDEG_8(YY)
   3093       ELSE
   3094         COSLIV=0.
   3095       ENDIF
   3096 
   3097       CALL SPHERP(WAVEZ,MWV,IRO,0,-1,QIMER,YY,XX,UOUT)
   3098       UOUT=UOUT*COSLIV
   3099       RETURN
   3100 
   3101 C-----------------------------------------------------------------------
   3102 
   3103 C  ++++++++++++++++++++++++
   3104 C  ++++  ENTRY VDVSP1  ++++
   3105 C  ++++++++++++++++++++++++

Page 74          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   3106 
   3107       ENTRY VDVSP1(XX,YY,JVZ,KLZ,MWV,IRO,VOUT)
   3108 
   3109       CALL SPHERP(WAVEZ,MWV,IRO,1,1,FER,YY,XX,VOUT)
   3110       VOUT=-VOUT*COSLIV
   3111       RETURN
   3112 
   3113 C-----------------------------------------------------------------------
   3114 
   3115 C  ++++++++++++++++++++++++
   3116 C  ++++  ENTRY UVRSP2  ++++
   3117 C  ++++++++++++++++++++++++
   3118 
   3119       ENTRY UVRSP2(XX,YY,JVZ,KLZ,MWV,IRO,UOUT,VOUT)
   3120 
   3121       IF(ABS(YY).NE.90.) THEN
   3122         COSLIV=1./COSDEG_8(YY)
   3123       ELSE
   3124         COSLIV=0.
   3125       ENDIF
   3126 
   3127       CALL SPHERP(WAVEZ,MWV,IRO,1,1,FER,YY,XX,UOUT)
   3128       UOUT=UOUT*COSLIV
   3129       CALL SPHERP(WAVEZ,MWV,IRO,0,-1,QIMER,YY,XX,VOUT)
   3130       VOUT=VOUT*COSLIV
   3131 c && 2 comments
   3132 CC    WRITE(6,1193) MWV,IRO,UOUT,VOUT
   3133 C1193 FORMAT('...MWV,IRO,ROTATIONAL U,V=',2I3,2F12.3)
   3134       RETURN
   3135 
   3136 C-----------------------------------------------------------------------
   3137 
   3138 C  ++++++++++++++++++++++++
   3139 C  ++++  ENTRY UVDSP2  ++++
   3140 C  ++++++++++++++++++++++++
   3141 
   3142       ENTRY UVDSP2(XX,YY,JVZ,KLZ,MWV,IRO,UOUT,VOUT)
   3143 
   3144       IF(ABS(YY).NE.90.) THEN
   3145         COSLIV=1./COSDEG_8(YY)
   3146       ELSE
   3147         COSLIV=0.
   3148       ENDIF
   3149 
   3150       CALL SPHERP(WAVEZ,MWV,IRO,0,-1,QIMER,YY,XX,UOUTZ)
   3151       UOUT=UOUT+UOUTZ*COSLIV
   3152       CALL SPHERP(WAVEZ,MWV,IRO,1,1,FER,YY,XX,VOUTZ)
   3153       VOUT=VOUT-VOUTZ*COSLIV
   3154 c && 2 comments
   3155 CC    WRITE(6,1197) MWV,IRO,UOUTZ,VOUTZ,UOUT,VOUT
   3156 C1197 FORMAT('...MWV,IRO, DIVERGENT,TOTAL U,V=',2I3,4F12.3)
   3157       RETURN
   3158 
   3159       END

Page 75          Source Listing                  SPMODL
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 modl1_                scasp1_               spmodl_               uvdsp2_               vdvsp1_             
 rdspp1_               setres_               udvsp1_               uvrsp2_               vrosp1_             
 rdspp2_               settrn_               urosp1_               uvwsp1_                                   


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  2670                                                           2571                              
 1051                       Label  2791                                                           2790                              
 1071                       Label  2799                                                           2798                              
 1080                       Label  2803                                                           2801                              
 11                         Label  2531                                                           2530                              
 1100                       Label  2811                                                           2783                              
 1130                       Label  2817                                                           2815                              
 1200                       Label  2820                                                           2781                              
 1210                       Label  2824                                                           2804                              
 1241                       Label  2842                                                           2841                              
 1251                       Label  2852                                                           2851                              
 1261                       Label  2865                                                           2864                              
 1280                       Label  2872                                                           2833                              
 1287                       Label  2879                                                           2878                              
 1290                       Label  2884                                                           2881                              
 1300                       Label  2891                                                           2825                              
 1310                       Label  2895                                                           2885                              
 1411                       Label  2907                                                           2906                              
 1417                       Label  2915                                                           2914                              
 1420                       Label  2919                                                           2917                              
 1430                       Label  2927                                                           2899                              
 1440                       Label  2933                                                           2931                              
 1450                       Label  2936                                                           2896                              
 1500                       Label  2941                                                           2920                              
 1511                       Label  2953                                                           2952                              
 1517                       Label  2961                                                           2960                              
 1520                       Label  2965                                                           2963                              
 1530                       Label  2973                                                           2945                              
 1540                       Label  2979                                                           2977                              
 1550                       Label  2982                                                           2942                              
 1600                       Label  2984                                                           2966                              
 200                        Label  2674                                                           2664                              
 2010                       Label  3010                                                           3002                              
 2020                       Label  3011                                                           2998                              
 21                         Label  2539                                                           2538                              
 211                        Label  2686                                                           2685                              
 217                        Label  2694                                                           2693                              
 220                        Label  2698                                                           2696                              
 230                        Label  2706                                                           2678                              
 240                        Label  2712                                                           2710                              
 25                         Label  2554                                                           2553                              
 250                        Label  2715                                                           2675                              

Page 76          Source Listing                  SPMODL
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 300                        Label  2720                                                           2699                              
 31                         Label  2590                                                           2589                              
 311                        Label  2732                                                           2731                              
 317                        Label  2740                                                           2739                              
 320                        Label  2744                                                           2742                              
 330                        Label  2752                                                           2724                              
 340                        Label  2758                                                           2756                              
 350                        Label  2761                                                           2721                              
 400                        Label  2763                                                           2745                              
 41                         Label  2601                                                           2600                              
 47                         Label  2610                                                           2609                              
 51                         Label  2619                                                           2618                              
 61                         Label  2632                                                           2631                              
 71                         Label  2646                                                           2645                              
 80                         Label  2650                                                           2581,2612                         
 87                         Label  2657                                                           2656                              
 90                         Label  2663                                                           2659                              
 ABRT1                      Subr   2543                                                           2543                              
 ABS                        Func   3043                                 scalar                    3043,3061,3091,3121,3144          
 ARRAY                      Local  2501     R(4)            4     3     252000   SAVE             2587,2597,2615,2629,2643,2683,2729
                                                                                                  ,2788,2839,2849,2861,2862,2904,295
                                                                                                  0,3020                            
 CHGRES                     Subr   3020                                                           3020                              
 COSDEG_8                   Func   2496     R(8)            8           scalar                    3044,3062,3092,3122,3145          
 COSLIV                     Local  3044     R(4)            4           scalar   SAVE             3044,3046,3050,3062,3064,3068,3080
                                                                                                  ,3092,3094,3098,3110,3122,3124,312
                                                                                                  8,3130,3145,3147,3151,3153        
 ER                         Local  2506     R(4)            4           scalar   SAVE             2506,2522,2523,2627,2640          
 ERIV                       Local  2522     R(4)            4           scalar   SAVE             2522,3008,3009                    
 ERSQ                       Local  2523     R(4)            4           scalar   SAVE             2523,3006                         
 FAC                        Local  2500     R(4)            4     1     1764     SAVE             2508,3032,3049                    
 FER                        Local  2499     R(4)            4     1     1764     SAVE             3008,3067,3109,3127,3152          
 FHOUR                      Local  2552     R(4)            4           scalar   SAVE             2552,2553                         
 IDTSP                      Local  2499     I(4)            4     1     4        SAVE             2552,2553                         
 INDXP                      Dummy  2475     I(4)            4     1     0        ARG,INOUT        2577,2681,2727,2786,2830,2902,2948
 INDXV                      Dummy  2475     I(4)            4     1     0        ARG,INOUT        2585,2595,2606,2624,2637,2677,2723
                                                                                                  ,2782,2837,2847,2857,2898,2944    
 IPLUS                      Dummy  2476     I(4)            4           scalar   ARG,INOUT        3020,3049                         
 IRO                        Dummy  2476     I(4)            4           scalar   ARG,INOUT        3001,3021,3032,3049,3067,3079,3097
                                                                                                  ,3109,3127,3129,3150,3152         
 IROMB                      Param  2487     I(4)            4           scalar                    2488,2489,2490,2491,2627,2640,3020
 IUNIT                      Dummy  2475     I(4)            4           scalar   ARG,INOUT        2530,2548,2552,2573,2574,2575,2660
                                                                                                  ,2661,2662,2679,2697,2711,2725,274
                                                                                                  3,2757,2784,2802,2816,2827,2828,28
                                                                                                  82,2883,2900,2918,2932,2946,2964,2
                                                                                                  978                               
 JV                         Local  2581     I(4)            4           scalar   SAVE             2581,2585,2587,2589,2595,2597,2600
                                                                                                  ,2606,2609,2615,2618,2624,2629,263
                                                                                                  1,2637,2643,2645,2675,2677,2683,26
                                                                                                  85,2709,2721,2723,2729,2731,2755,2
                                                                                                  781,2782,2788,2790,2814,2833,2837,
                                                                                                  2839,2841,2847,2849,2851,2857,2861
                                                                                                  ,2862,2864,2896,2898,2904,2906,293
                                                                                                  0,2942,2944,2950,2952,2976        
 JVBOG                      Dummy  2475     I(4)            4           scalar   ARG,INOUT        2501,2581,2675,2709,2721,2755,2781

Page 77          Source Listing                  SPMODL
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,2814,2833,2896,2930,2942,2976    
 JVZ                        Dummy  2475     I(4)            4           scalar   ARG,INOUT        3020                              
 K                          Local  2571     I(4)            4           scalar   SAVE             2571,2577,2589,2600,2609,2618,2631
                                                                                                  ,2645,2655,2678,2681,2685,2692,272
                                                                                                  4,2727,2731,2738,2783,2786,2790,27
                                                                                                  97,2825,2830,2841,2851,2864,2877,2
                                                                                                  899,2902,2906,2913,2945,2948,2952,
                                                                                                  2959                              
 KDIM                       Param  2492     I(4)            4           scalar                    2571,2656,2659,2724,2739,2742,2756
                                                                                                  ,2783,2798,2801,2815,2825,2878,288
                                                                                                  1,2945,2960,2963,2977             
 KDIMQ                      Param  2492     I(4)            4           scalar                    2678,2693,2696,2710,2899,2914,2917
                                                                                                  ,2931                             
 KK                         Local  2570     I(4)            4           scalar   SAVE             2570,2577,2587,2589,2597,2600,2609
                                                                                                  ,2615,2618,2629,2631,2643,2645,265
                                                                                                  4,2667,2674,2681,2683,2685,2691,27
                                                                                                  02,2709,2720,2727,2729,2731,2737,2
                                                                                                  748,2755,2780,2786,2788,2790,2796,
                                                                                                  2807,2814,2824,2830,2839,2841,2849
                                                                                                  ,2851,2861,2862,2864,2876,2888,289
                                                                                                  5,2902,2904,2906,2912,2923,2930,29
                                                                                                  41,2948,2950,2952,2958,2969       
 KLBOG                      Dummy  2475     I(4)            4           scalar   ARG,INOUT        2501,2654,2691,2737,2796,2876,2912
                                                                                                  ,2958                             
 KLZ                        Dummy  2475     I(4)            4           scalar   ARG,INOUT        3020                              
 KS                         Local  2659     I(4)            4           scalar   SAVE             2659,2696,2742,2801,2815,2881,2917
                                                                                                  ,2963                             
 KSK                        Local  2710     I(4)            4           scalar   SAVE             2710,2756,2931,2977               
 KZZ                        Local  2655     I(4)            4           scalar   SAVE             2655,2656,2659,2692,2693,2696,2738
                                                                                                  ,2739,2742,2797,2798,2801,2877,287
                                                                                                  8,2881,2913,2914,2917,2959,2960,29
                                                                                                  63                                
 LAB                        Local  2504     CHAR            8     1     4        SAVE             2548                              
 M                          Local  2999     I(4)            4           scalar   SAVE             2999,3009                         
 MAX                        Func   2536                                 scalar                    2536                              
 MAXBGK                     Param  2482     I(4)            4           scalar                    2501                              
 MAXBGV                     Param  2483     I(4)            4           scalar                    2501                              
 MAXUWV                     Param  2487     I(4)            4           scalar                    2490,2491,2524,2525               
 MAXZWV                     Param  2487     I(4)            4           scalar                    2487,2488,2489,2517,2518,2524,2530
 MENDZ1                     Local  2518     I(4)            4           scalar   SAVE             2518,2627,2640,2996,2998,3000,3001
 MM                         Local  2998     I(4)            4           scalar   SAVE             2998,2999,3001,3002               
 MODL1                      Subr   2512                                                                                             
 MSPACE                     Local  2536     I(4)            4           scalar   SAVE             2536,2537,2538                    
 MUMAX                      Local  2525     I(4)            4           scalar   SAVE             2525,2527,2530,2536,2574,2575,2597
                                                                                                  ,2615,2627,2629,2640,2643         
 MUWVD                      Param  2490     I(4)            4           scalar                    2491,2499,2500,2508               
 MUWVD2                     Param  2491     I(4)            4           scalar                    2498,2499,2527,2530               
 MWAVE                      Dummy  2475     I(4)            4           scalar   ARG,INOUT        2517,3020                         
 MWV                        Dummy  2475     I(4)            4           scalar   ARG,INOUT        2996,3020,3032,3049,3067,3079,3097
                                                                                                  ,3109,3127,3129,3150,3152         
 MZWVD                      Param  2488     I(4)            4           scalar                    2489                              
 MZWVD2                     Param  2489     I(4)            4           scalar                    2530,2536,2573,2587,2627,2640,2679
                                                                                                  ,2683,2725,2729,2784,2788,2827,282
                                                                                                  8,2839,2849,2861,2862,2900,2904,29
                                                                                                  46,2950                           

Page 78          Source Listing                  SPMODL
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 N                          Local  3003     I(4)            4           scalar   SAVE             3003,3004,3006                    
 NEND1                      Local  3000     I(4)            4           scalar   SAVE             3000,3001,3002                    
 NM                         Local  2573     I(4)            4           scalar   SAVE             2573,2574,2575,2589,2600,2618,2631
                                                                                                  ,2645,2679,2685,2725,2731,2784,279
                                                                                                  0,2827,2828,2841,2851,2864,2900,29
                                                                                                  06,2946,2952,2997,3007,3008,3009  
 NN                         Local  3002     I(4)            4           scalar   SAVE             3002,3003                         
 NSPACE                     Param  2485     I(4)            4           scalar                    2501,2537,2538                    
 QIMER                      Local  2499     R(4)            4     1     1764     SAVE             3009,3079,3097,3129,3150          
 RDSPP1                     Subr   2565                                                                                             
 RDSPP2                     Subr   2773                                                                                             
 REAL                       Func   3004                                 scalar                    3004,3009                         
 SCASP1                     Subr   3030                                                                                             
 SCOUT                      Dummy  2476     R(4)            4           scalar   ARG,INOUT        3032                              
 SETRES                     Subr   3019                                                                                             
 SETTRN                     Subr   2994                                                                                             
 SPHERP                     Subr   3032                                                           3032,3049,3067,3079,3097,3109,3127
                                                                                                  ,3129,3150,3152                   
 SPMODL                     Subr   2475                                                                                             
 UDVSP1                     Subr   3089                                                                                             
 UOUT                       Dummy  2476     R(4)            4           scalar   ARG,INOUT        3067,3068,3097,3098,3127,3128,3151
 UOUTZ                      Local  3150     R(4)            4           scalar   SAVE             3150,3151                         
 UROSP1                     Subr   3059                                                                                             
 UVDSP2                     Subr   3142                                                                                             
 UVOUT                      Dummy  2476     R(4)            4           scalar   ARG,INOUT        3049,3050                         
 UVRSP2                     Subr   3119                                                                                             
 UVSAVE                     Local  2503     L(4)            4           scalar   SAVE             2579,2599,2608,2617               
 UVTOZD                     Subr   2627                                                           2627,2640                         
 UVWSP1                     Subr   3041                                                                                             
 VDSAVE                     Local  2503     L(4)            4           scalar   SAVE             2580,2626,2639,2641,2832,2859,2868
 VDVSP1                     Subr   3107                                                                                             
 VOUT                       Dummy  2476     R(4)            4           scalar   ARG,INOUT        3079,3080,3109,3110,3129,3130,3153
 VOUTZ                      Local  3152     R(4)            4           scalar   SAVE             3152,3153                         
 VROSP1                     Subr   3077                                                                                             
 WAVE1                      Local  2498     R(4)            4     1     3528     SAVE             2573,2587,2589,2627,2629,2631,2640
                                                                                                  ,2679,2683,2685,2725,2729,2731,278
                                                                                                  4,2788,2790,2900,2904,2906,2946,29
                                                                                                  50,2952                           
 WAVE2                      Local  2498     R(4)            4     1     3528     SAVE             2574,2597,2600,2627,2640,2827,2839
                                                                                                  ,2841,2861,2864                   
 WAVE3                      Local  2498     R(4)            4     1     3528     SAVE             2575,2615,2618,2627,2640,2828,2849
                                                                                                  ,2851,2862,2864                   
 WAVEX                      Local  2498     R(4)            4     1     3528     SAVE             2627,2640,2643,2645               
 WAVEZ                      Local  2499     R(4)            4     1     3528     SAVE             3021,3032,3049,3067,3079,3097,3109
                                                                                                  ,3127,3129,3150,3152              
 X1                         Local  3004     R(4)            4           scalar   SAVE             3004,3006                         
 X4                         Local  3005     R(4)            4           scalar   SAVE             3005,3006,3008,3009               
 XX                         Dummy  2476     R(4)            4           scalar   ARG,INOUT        3032,3049,3067,3079,3097,3109,3127
                                                                                                  ,3129,3150,3152                   
 YY                         Dummy  2476     R(4)            4           scalar   ARG,INOUT        3032,3043,3044,3049,3061,3062,3067
                                                                                                  ,3079,3091,3092,3097,3109,3121,312
                                                                                                  2,3127,3129,3144,3145,3150,3152   

Page 79          Source Listing                  SPMODL
2017-04-18 11:09                                 syndata.f

   3160 
   3161 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3162 C                .      .    .                                       .
   3163 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   3164 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   3165 C
   3166 C ABSTRACT: ??????????????????????????????????????????????????????????
   3167 C   ??????????????????????????????????????????????????????????????????
   3168 C
   3169 C PROGRAM HISTORY LOG:
   3170 C ????-??-??  S. J. LORD
   3171 C
   3172 C USAGE:    CALL ????????(????)
   3173 C   INPUT ARGUMENT LIST:
   3174 C     ??????   - ???????????????????????????????????????????????
   3175 C
   3176 C   OUTPUT ARGUMENT LIST:
   3177 C     ??????   - ???????????????????????????????????????????????
   3178 C
   3179 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3180 C     ??????   - ???????????????????????????????????????????????
   3181 C
   3182 C   OUTPUT FILES:
   3183 C     ??????   - ???????????????????????????????????????????????
   3184 C
   3185 C REMARKS: ?????????????????????????????????????????????????????
   3186 C
   3187 C ATTRIBUTES:
   3188 C   LANGUAGE: FORTRAN 90
   3189 C   MACHINE:  NCEP WCOSS
   3190 C
   3191 C$$$
   3192 
   3193       SUBROUTINE TEMPLT(ISHAPE,DELTA,RLATCZ,RLONCZ,RMAXTP,JPTSMX,MXZ,
   3194      1                  NXZ,RLATMN,RLATMX,RLONMN,RLONMX,RLATP,RLONP,JPT)
   3195 
   3196       SAVE
   3197 
   3198       DIMENSION RLATP(JPTSMX),RLONP(JPTSMX),WTP(JPTSMX)
   3199 
   3200       REAL(8)  DISTSP_8
   3201 
   3202 C  DEGLAT IS ONE DEGREE LATITUDE IN METERS
   3203 
   3204       DATA SQRT2/1.41421/,DEGLAT/111.17E3/
   3205 
   3206 C  DELTA IS DISTANCE BETWEEN EQUALLY-SPACED LAT/LON POINTS IN DEGREES
   3207 C  ISHAPE=0 IS FOR A SET OF POINTS JUST LARGER THAN A CIRCLE
   3208 C  ISHAPE=1 IS FOR POINTS WITHIN A RECTANGLE
   3209 C  ISHAPE=2 IS FOR POINTS COMPLETELY COVERING A RECTANGLE
   3210 C  RMAXTP IS IN KM
   3211 
   3212       HYPOT=DELTA*SQRT2*0.5*DEGLAT
   3213       RMAXM=RMAXTP*1000.
   3214       RLATC=RLATCZ
   3215       RLONC=RLONCZ
   3216       RADD =0.0

Page 80          Source Listing                  TEMPLT
2017-04-18 11:09                                 syndata.f

   3217       IF(ISHAPE .EQ. 2)  RADD =DELTA*1000.
   3218       WRITE(6,9) ISHAPE,DELTA,RLATC,RLONC,RMAXTP
   3219     9 FORMAT(///' ...ENTERING TEMPLT WITH ISHAPE,DELTA,RLATC,RLONC,',
   3220      1       'RMAXTP=',I5,4F11.4)
   3221 
   3222       JPT=0
   3223       MX=0
   3224       NY=0
   3225       MPTSX=NINT(SQRT(REAL(JPTSMX)))
   3226       NPTSX=MPTSX
   3227 
   3228 C  SEARCH OUTWARD FOR BOX THAT CIRCUMSCRIBES RMAXTP.  THE OUTERMOST
   3229 C    POINT WILL BE <= RMAXTP FOR ISHAPE=0,1 AND > RMAXTP FOR ISHAPE=2
   3230 
   3231    10 CONTINUE
   3232       MX=MX+1
   3233       RLONZ=RLONC+MX*DELTA
   3234       RD=DISTSP_8(RLATC,RLONC,RLATC,RLONZ)
   3235       IF(RD .LE. RMAXM+RADD)  GO TO 10
   3236 
   3237    20 CONTINUE
   3238       NY=NY+1
   3239       RLATZ=RLATC+NY*DELTA
   3240       RD=DISTSP_8(RLATC,RLONC,RLATZ,RLONC)
   3241       IF(RD .LE. RMAXM+RADD)  GO TO 20
   3242 
   3243       WRITE(6,21)  MX,NY
   3244    21 FORMAT(/'...IN TEMPLT, VALUES OF MX, NY=',2I5)
   3245 
   3246       MPTS=2*MX+1
   3247       NPTS=2*NY+1
   3248       IF(MPTS .GT. MPTSX)  THEN
   3249       MX=(MPTSX-1)/2
   3250       WRITE(6,31)  MPTS,MPTSX,MX
   3251    31 FORMAT(/'******MAXIMUM VALUE OF LONGITUDINAL POINTS EXCEEDED',
   3252      1       ' FOR TEMPLATE.  MPTS, MPTS=',2I5,/,15X,'MPTS SET TO',
   3253      2       ' MAXIMUM AND MX RECALCULATED TO BE',I5)
   3254       MPTS=MPTSX
   3255       ENDIF
   3256 
   3257       IF(NPTS .GT. NPTSX)  THEN
   3258       NY=(NPTSX-1)/2
   3259       WRITE(6,41)  NPTS,NPTSX,NY
   3260    41 FORMAT(/'******MAXIMUM VALUE OF LATITUDINAL POINTS EXCEEDED',
   3261      1       ' FOR TEMPLATE.  NPTS, NPTS=',2I5,/,15X,'NPTS SET TO',
   3262      2       ' MAXIMUM AND NY RECALCULATED TO BE',I5)
   3263       MPTS=MPTSX
   3264       ENDIF
   3265 
   3266 C  STORE ALL POINTS BEGINNING AT THE ANCHOR POINT ON THE NORTHWEST
   3267 C    CORNER OF THE BOX.  POINTS OUTSIDE THE CIRCLE OF RADIUS RMAXTP ARE
   3268 C    CONSIDERED IF A BOX OF DIMENSION DELTA WOULD INTERSECT THE RMAXTP
   3269 C    CIRCLE.  HOWEVER, THEY ARE GIVEN LESSER WEIGHT THAN FOR INSIDE THE
   3270 C    CIRCLE (=1.0).  WEIGHTS ARE ASSIGNED IN SUBROUTINE TEMWT.
   3271 
   3272       RLATA=RLATC+(NY+1)*DELTA
   3273       RLONA=RLONC-(MX+1)*DELTA

Page 81          Source Listing                  TEMPLT
2017-04-18 11:09                                 syndata.f

   3274 
   3275       DO NNY=1,NPTS
   3276          RLATZ=RLATA-NNY*DELTA
   3277 
   3278          DO MMX=1,MPTS
   3279             RLONZ=RLONA+MMX*DELTA
   3280             RD=DISTSP_8(RLATC,RLONC,RLATZ,RLONZ)
   3281 
   3282             IF(RD-RMAXM .GT. HYPOT .AND. ISHAPE .EQ. 0)  GO TO 50
   3283             JPT=JPT+1
   3284             RLATP(JPT)=RLATZ
   3285             RLONP(JPT)=RLONZ
   3286 c && 2 comments
   3287 CC          WRITE(6,49) JPT,RLATC,RLONC,RLATZ,RLONZ
   3288 CC 49 FORMAT('...STORING JPT,RLATC,RLONC,RLATZ,RLONZ',/,5X,I5,4F11.4)
   3289    50       CONTINUE
   3290          END DO
   3291       END DO
   3292 
   3293       IF(ISHAPE .EQ. 0)  WRITE(6,51) JPT
   3294    51 FORMAT(/'...THE NUMBER OF TEMPLATE POINTS FOR AVERAGING',
   3295      1       ' OVER THE CIRCULAR AREA IS:',I5)
   3296       IF(ISHAPE .EQ. 1)  WRITE(6,53) JPT
   3297    53 FORMAT(/'...THE NUMBER OF TEMPLATE POINTS FOR BOGUSING',
   3298      1       ' OVER THE RECTANGULAR AREA IS:',I5)
   3299 
   3300       IF(JPT .GT. JPTSMX)  THEN
   3301       WRITE(6,57) JPT,JPTSMX
   3302    57 FORMAT(/'******IN TEMPLT, # OF POINTS=',I6,' EXCEEDS AVAILABLE ',
   3303      1       'SPACE=',I6,'. AN OVERWRITING ERROR HAS OCCURRED.',/,7X,
   3304      2       'THE CURRENT OPTION IS TO CONTINUE, BUT SOME GARBAGE ',
   3305      3       'MAY RESULT.')
   3306       JPT=JPTSMX
   3307       ENDIF
   3308 
   3309       MXZ=MPTS
   3310       NXZ=NPTS
   3311       RLATMN= 100.
   3312       RLATMX=-100.
   3313       RLONMN= 361.
   3314       RLONMX=-361.
   3315 
   3316       DO 70 NP=1,MXZ*NXZ
   3317       RLATMN=MIN(RLATMN,RLATP(NP))
   3318       RLATMX=MAX(RLATMX,RLATP(NP))
   3319       RLONMN=MIN(RLONMN,RLONP(NP))
   3320       RLONMX=MAX(RLONMX,RLONP(NP))
   3321    70 CONTINUE
   3322 
   3323       RETURN
   3324 
   3325       END

Page 82          Source Listing                  TEMPLT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 templt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3231                                                           3235                              
 20                         Label  3237                                                           3241                              
 21                         Label  3244                                                           3243                              
 31                         Label  3251                                                           3250                              
 41                         Label  3260                                                           3259                              
 50                         Label  3289                                                           3282                              
 51                         Label  3294                                                           3293                              
 53                         Label  3297                                                           3296                              
 57                         Label  3302                                                           3301                              
 70                         Label  3321                                                           3316                              
 9                          Label  3219                                                           3218                              
 DEGLAT                     Local  3204     R(4)            4           scalar   SAVE             3204,3212                         
 DELTA                      Dummy  3193     R(4)            4           scalar   ARG,INOUT        3212,3217,3218,3233,3239,3272,3273
                                                                                                  ,3276,3279                        
 DISTSP_8                   Func   3200     R(8)            8           scalar                    3234,3240,3280                    
 HYPOT                      Local  3212     R(4)            4           scalar   SAVE             3212,3282                         
 ISHAPE                     Dummy  3193     I(4)            4           scalar   ARG,INOUT        3217,3218,3282,3293,3296          
 JPT                        Dummy  3194     I(4)            4           scalar   ARG,INOUT        3222,3283,3284,3285,3293,3296,3300
                                                                                                  ,3301,3306                        
 JPTSMX                     Dummy  3193     I(4)            4           scalar   ARG,INOUT        3198,3225,3300,3301,3306          
 MAX                        Func   3318                                 scalar                    3318,3320                         
 MIN                        Func   3317                                 scalar                    3317,3319                         
 MMX                        Local  3278     I(4)            4           scalar   SAVE             3278,3279                         
 MPTS                       Local  3246     I(4)            4           scalar   SAVE             3246,3248,3250,3254,3263,3278,3309
 MPTSX                      Local  3225     I(4)            4           scalar   SAVE             3225,3226,3248,3249,3250,3254,3263
 MX                         Local  3223     I(4)            4           scalar   SAVE             3223,3232,3233,3243,3246,3249,3250
                                                                                                  ,3273                             
 MXZ                        Dummy  3193     I(4)            4           scalar   ARG,INOUT        3309,3316                         
 NINT                       Func   3225                                 scalar                    3225                              
 NNY                        Local  3275     I(4)            4           scalar   SAVE             3275,3276                         
 NP                         Local  3316     I(4)            4           scalar   SAVE             3316,3317,3318,3319,3320          
 NPTS                       Local  3247     I(4)            4           scalar   SAVE             3247,3257,3259,3275,3310          
 NPTSX                      Local  3226     I(4)            4           scalar   SAVE             3226,3257,3258,3259               
 NXZ                        Dummy  3194     I(4)            4           scalar   ARG,INOUT        3310,3316                         
 NY                         Local  3224     I(4)            4           scalar   SAVE             3224,3238,3239,3243,3247,3258,3259
                                                                                                  ,3272                             
 RADD                       Local  3216     R(4)            4           scalar   SAVE             3216,3217,3235,3241               
 RD                         Local  3234     R(4)            4           scalar   SAVE             3234,3235,3240,3241,3280,3282     
 REAL                       Func   3225                                 scalar                    3225                              
 RLATA                      Local  3272     R(4)            4           scalar   SAVE             3272,3276                         
 RLATC                      Local  3214     R(4)            4           scalar   SAVE             3214,3218,3234,3239,3240,3272,3280
 RLATCZ                     Dummy  3193     R(4)            4           scalar   ARG,INOUT        3214                              
 RLATMN                     Dummy  3194     R(4)            4           scalar   ARG,INOUT        3311,3317                         
 RLATMX                     Dummy  3194     R(4)            4           scalar   ARG,INOUT        3312,3318                         

Page 83          Source Listing                  TEMPLT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RLATP                      Dummy  3194     R(4)            4     1     0        ARG,INOUT        3284,3317,3318                    
 RLATZ                      Local  3239     R(4)            4           scalar   SAVE             3239,3240,3276,3280,3284          
 RLONA                      Local  3273     R(4)            4           scalar   SAVE             3273,3279                         
 RLONC                      Local  3215     R(4)            4           scalar   SAVE             3215,3218,3233,3234,3240,3273,3280
 RLONCZ                     Dummy  3193     R(4)            4           scalar   ARG,INOUT        3215                              
 RLONMN                     Dummy  3194     R(4)            4           scalar   ARG,INOUT        3313,3319                         
 RLONMX                     Dummy  3194     R(4)            4           scalar   ARG,INOUT        3314,3320                         
 RLONP                      Dummy  3194     R(4)            4     1     0        ARG,INOUT        3285,3319,3320                    
 RLONZ                      Local  3233     R(4)            4           scalar   SAVE             3233,3234,3279,3280,3285          
 RMAXM                      Local  3213     R(4)            4           scalar   SAVE             3213,3235,3241,3282               
 RMAXTP                     Dummy  3193     R(4)            4           scalar   ARG,INOUT        3213,3218                         
 SQRT                       Func   3225                                 scalar                    3225                              
 SQRT2                      Local  3204     R(4)            4           scalar   SAVE             3204,3212                         
 TEMPLT                     Subr   3193                                                                                             
 WTP                        Local  3198     R(4)            4     1     0                                                           

Page 84          Source Listing                  TEMPLT
2017-04-18 11:09                                 syndata.f

   3326 
   3327 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3328 C                .      .    .                                       .
   3329 C SUBPROGRAM:    TEMWT       ?????????????????????????????????????????
   3330 C   PRGMMR: S. J. LORD       ORG: STI        DATE: 2016-05-18
   3331 C
   3332 C ABSTRACT: ??????????????????????????????????????????????????????????
   3333 C   ??????????????????????????????????????????????????????????????????
   3334 C
   3335 C PROGRAM HISTORY LOG:
   3336 C 2016-05-18  S. J. LORD
   3337 C        Added arguments (delta,rlatc,rlonc,rmaxtp), data statement,
   3338 C        hypot calculation, and reinstated weight calculation.
   3339 C        Uninitialized variables addressed.
   3340 C
   3341 C USAGE:    CALL ????????(????)
   3342 C   INPUT ARGUMENT LIST:
   3343 C     ??????   - ???????????????????????????????????????????????
   3344 C
   3345 C   OUTPUT ARGUMENT LIST:
   3346 C     ??????   - ???????????????????????????????????????????????
   3347 C
   3348 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3349 C     ??????   - ???????????????????????????????????????????????
   3350 C
   3351 C   OUTPUT FILES:
   3352 C     ??????   - ???????????????????????????????????????????????
   3353 C
   3354 C REMARKS: ?????????????????????????????????????????????????????
   3355 C
   3356 C ATTRIBUTES:
   3357 C   LANGUAGE: FORTRAN 90
   3358 C   MACHINE:  NCEP WCOSS
   3359 C
   3360 C$$$
   3361 
   3362 C SJL 4/13/16 added arguments in lower case
   3363       SUBROUTINE TEMWT(rlatc,rlonc,rmaxtp,RLATP,RLONP,WTP,delta,JPTSMX)
   3364 
   3365       SAVE
   3366 
   3367       DIMENSION RLATP(JPTSMX),RLONP(JPTSMX),WTP(JPTSMX)
   3368 
   3369       REAL(8)  DISTSP_8
   3370 C SJL 4/13/16 (3 lines)
   3371       DATA SQRT2/1.41421/,DEGLAT/111.17E3/
   3372 
   3373       HYPOT=DELTA*SQRT2*0.5*DEGLAT
   3374       RMAXM=RMAXTP*1000.
   3375       DO 100 NP=1,JPTSMX
   3376       RD=DISTSP_8(RLATC,RLONC,RLATP(NP),RLONP(NP))
   3377 
   3378       IF(RD .LE. RMAXM)  THEN
   3379       WTP(NP)=1.0
   3380       ELSE
   3381 c fixit??
   3382 cc dak 7/3/05    WTP(NP)=1.0-(RD-RMAXM)/HYPOT

Page 85          Source Listing                  TEMWT
2017-04-18 11:09                                 syndata.f

   3383 C      wtp(np)=1.0  ! dak 7/3/05: HYPOT was never defined!!
   3384 C SJL 4/13/16 reinstate weight calculation
   3385       WTP(NP)=1.0-(RD-RMAXM)/HYPOT
   3386       ENDIF
   3387 c && 4 comments
   3388 CC    WRITE(6,99) JPTSMX,NP,RLATC,RLONC,RLATP(NP),RLONP(NP),WTP(NP)
   3389 CC   1           ,RD,RMAXM,HYPOT
   3390 CC 99 FORMAT('  ...JPTSMX,NP,RLATC,RLONC,RLATP(NP),RLONP(NP),WTP(NP)',
   3391 CC   1      ',RD,RMAXM,HYPOT=',/,5X,2I5,8F12.4)
   3392   100 CONTINUE
   3393       RETURN
   3394 
   3395       END


ENTRY POINTS

  Name              
                    
 temwt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  3392                                                           3375                              
 DEGLAT                     Local  3371     R(4)            4           scalar   SAVE             3371,3373                         
 DELTA                      Dummy  3363     R(4)            4           scalar   ARG,INOUT        3373                              
 DISTSP_8                   Func   3369     R(8)            8           scalar                    3376                              
 HYPOT                      Local  3373     R(4)            4           scalar   SAVE             3373,3385                         
 JPTSMX                     Dummy  3363     I(4)            4           scalar   ARG,INOUT        3367,3375                         
 NP                         Local  3375     I(4)            4           scalar   SAVE             3375,3376,3379,3385               
 RD                         Local  3376     R(4)            4           scalar   SAVE             3376,3378,3385                    
 RLATC                      Dummy  3363     R(4)            4           scalar   ARG,INOUT        3376                              
 RLATP                      Dummy  3363     R(4)            4     1     0        ARG,INOUT        3376                              
 RLONC                      Dummy  3363     R(4)            4           scalar   ARG,INOUT        3376                              
 RLONP                      Dummy  3363     R(4)            4     1     0        ARG,INOUT        3376                              
 RMAXM                      Local  3374     R(4)            4           scalar   SAVE             3374,3378,3385                    
 RMAXTP                     Dummy  3363     R(4)            4           scalar   ARG,INOUT        3374                              
 SQRT2                      Local  3371     R(4)            4           scalar   SAVE             3371,3373                         
 TEMWT                      Subr   3363                                                                                             
 WTP                        Dummy  3363     R(4)            4     1     0        ARG,INOUT        3379,3385                         

Page 86          Source Listing                  TEMWT
2017-04-18 11:09                                 syndata.f

   3396 
   3397 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3398 C                .      .    .                                       .
   3399 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   3400 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   3401 C
   3402 C ABSTRACT: ??????????????????????????????????????????????????????????
   3403 C   ??????????????????????????????????????????????????????????????????
   3404 C
   3405 C PROGRAM HISTORY LOG:
   3406 C ????-??-??  S. J. LORD
   3407 C
   3408 C USAGE:    CALL ????????(????)
   3409 C   INPUT ARGUMENT LIST:
   3410 C     ??????   - ???????????????????????????????????????????????
   3411 C
   3412 C   OUTPUT ARGUMENT LIST:
   3413 C     ??????   - ???????????????????????????????????????????????
   3414 C
   3415 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3416 C     ??????   - ???????????????????????????????????????????????
   3417 C
   3418 C   OUTPUT FILES:
   3419 C     ??????   - ???????????????????????????????????????????????
   3420 C
   3421 C REMARKS: ?????????????????????????????????????????????????????
   3422 C
   3423 C ATTRIBUTES:
   3424 C   LANGUAGE: FORTRAN 90
   3425 C   MACHINE:  NCEP WCOSS
   3426 C
   3427 C$$$
   3428 
   3429 C  *****************************
   3430 C  ****  SUBROUTINE OUTENV  ****
   3431 C  *****************************
   3432 
   3433       SUBROUTINE OUTENV(IFILE,ICALL,FIELD,MXX,NXX,KXX,MTITLE,NCHAR)
   3434 
   3435       SAVE
   3436 
   3437       DIMENSION FIELD(MXX,NXX*KXX)
   3438       CHARACTER MTITLE*(*)
   3439 
   3440 C  WRITE A DUMMY HEADER RECORD TO ENSURE CONSISTENCY WITH THE MAP
   3441 C    LAUNCHER FORMAT
   3442 
   3443       IF(ICALL .EQ. 0)  THEN
   3444 
   3445       IDUM=1
   3446   
   3447       WRITE(IFILE) MXX,IDUM,(FIELD(MM,1),MM=1,MXX)
   3448       ENDIF
   3449 
   3450       NXXX=NXX*KXX
   3451 
   3452       WRITE(6,1) IFILE,MXX,NXX,KXX,NXXX,NCHAR,MTITLE(1:NCHAR)

Page 87          Source Listing                  OUTENV
2017-04-18 11:09                                 syndata.f

   3453     1 FORMAT(/'...ENTERING OUTENV WITH IFILE,MXX,NXX,KXX,NXXX,',
   3454      1       'NCHAR,MTITLE=',6I5,/,4X,A)
   3455 
   3456       WRITE(IFILE) MXX,NXXX,((FIELD(MM,NN),MM=1,MXX),NN=1,NXXX),
   3457      1             MTITLE,NCHAR
   3458 
   3459 c && 6 comments
   3460 CC    WRITE(6,7)
   3461 CC  7 FORMAT(/'...FIELD ARRAY PRINTOUT IN OUTENV')
   3462 CC    DO NN=1,NXXX
   3463 CC    WRITE(6,9) NN,(FIELD(MM,NN),MM=1,MXX)
   3464 CC  9 FORMAT(/I4/(1X,10F12.5))
   3465 CC    ENDDO
   3466 
   3467       RETURN
   3468       END


ENTRY POINTS

  Name               
                     
 outenv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  3453                                                           3452                              
 FIELD                      Dummy  3433     R(4)            4     2     0        ARG,INOUT        3447,3456                         
 ICALL                      Dummy  3433     I(4)            4           scalar   ARG,INOUT        3443                              
 IDUM                       Local  3445     I(4)            4           scalar   SAVE             3445,3447                         
 IFILE                      Dummy  3433     I(4)            4           scalar   ARG,INOUT        3447,3452,3456                    
 KXX                        Dummy  3433     I(4)            4           scalar   ARG,INOUT        3437,3450,3452                    
 MM                         Local  3447     I(4)            4           scalar   SAVE             3447,3456                         
 MTITLE                     Dummy  3433     CHAR                        scalar   ARG,INOUT        3452,3457                         
 MXX                        Dummy  3433     I(4)            4           scalar   ARG,INOUT        3437,3447,3452,3456               
 NCHAR                      Dummy  3433     I(4)            4           scalar   ARG,INOUT        3452,3457                         
 NN                         Local  3456     I(4)            4           scalar   SAVE             3456                              
 NXX                        Dummy  3433     I(4)            4           scalar   ARG,INOUT        3437,3450,3452                    
 NXXX                       Local  3450     I(4)            4           scalar   SAVE             3450,3452,3456                    
 OUTENV                     Subr   3433                                                                                             

Page 88          Source Listing                  OUTENV
2017-04-18 11:09                                 syndata.f

   3469 
   3470 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3471 C                .      .    .                                       .
   3472 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   3473 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   3474 C
   3475 C ABSTRACT: ??????????????????????????????????????????????????????????
   3476 C   ??????????????????????????????????????????????????????????????????
   3477 C
   3478 C PROGRAM HISTORY LOG:
   3479 C ????-??-??  S. J. LORD
   3480 C
   3481 C USAGE:    CALL ????????(????)
   3482 C   INPUT ARGUMENT LIST:
   3483 C     ??????   - ???????????????????????????????????????????????
   3484 C
   3485 C   OUTPUT ARGUMENT LIST:
   3486 C     ??????   - ???????????????????????????????????????????????
   3487 C
   3488 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3489 C     ??????   - ???????????????????????????????????????????????
   3490 C
   3491 C   OUTPUT FILES:
   3492 C     ??????   - ???????????????????????????????????????????????
   3493 C
   3494 C REMARKS: ?????????????????????????????????????????????????????
   3495 C
   3496 C ATTRIBUTES:
   3497 C   LANGUAGE: FORTRAN 90
   3498 C   MACHINE:  NCEP WCOSS
   3499 C
   3500 C$$$
   3501 
   3502 C  *****************************
   3503 C  ****  SUBROUTINE OUTGES  ****
   3504 C  *****************************
   3505 
   3506       SUBROUTINE OUTGES(IUNTFE,NPTS,FIELD,MTITLE)
   3507 
   3508       CHARACTER MTITLE*(*)
   3509 
   3510       DIMENSION FIELD(2*NPTS)
   3511 
   3512       WRITE(IUNTFE,1) MTITLE
   3513     1 FORMAT(A)
   3514       WRITE(IUNTFE,3) (FIELD(NP),NP=1,2*NPTS)
   3515     3 FORMAT(10F10.2)
   3516 
   3517       RETURN
   3518       END

Page 89          Source Listing                  OUTGES
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 outges_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  3513                                                           3512                              
 3                          Label  3515                                                           3514                              
 FIELD                      Dummy  3506     R(4)            4     1     0        ARG,INOUT        3514                              
 IUNTFE                     Dummy  3506     I(4)            4           scalar   ARG,INOUT        3512,3514                         
 MTITLE                     Dummy  3506     CHAR                        scalar   ARG,INOUT        3512                              
 NP                         Local  3514     I(4)            4           scalar                    3514                              
 NPTS                       Dummy  3506     I(4)            4           scalar   ARG,INOUT        3510,3514                         
 OUTGES                     Subr   3506                                                                                             

Page 90          Source Listing                  OUTGES
2017-04-18 11:09                                 syndata.f

   3519 
   3520 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3521 C                .      .    .                                       .
   3522 C SUBPROGRAM:    REDSUB      READS VARIOUS BOGUSING FILE FORMATS
   3523 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   3524 C
   3525 C ABSTRACT: READS ENVIRONMENTAL DATA ARRAYS AND BOGUS DATA RECORDS
   3526 C   FOR TROPICAL CYCLONE BOGUSING.  THERE ARE TWO ENTRIES: READA FOR
   3527 C   ENVIRONMENTAL ARRAYS AND READBG FOR BOGUSING RECORDS.  ARGUMENTS
   3528 C   FOR EACH ENTRY ARE LISTED UNDER USAGE.  ENVIRONMENTAL ARRAYS ARE
   3529 C   IN A GENERIC "MAP LAUNCHER" FORMAT, WHILE BOGUS RECORDS ARE
   3530 C   CHARACTER RECORDS.  OUTPUT IS ONE ARRAY OR ONE RECORD AT A TIME.
   3531 C
   3532 C PROGRAM HISTORY LOG:
   3533 C 1991-06-06  S. J. LORD
   3534 C
   3535 C USAGE:    CALL READA(IUNIT,MZ,NZ,F,KL,IV,IEND)
   3536 C           CALL READBG(IUNITB,RLATBG,RLONBG,KL,ZZ,UU,VV,IEND)
   3537 C   INPUT ARGUMENT LIST:
   3538 C     IUNIT    - READ UNIT FOR THE ENVIRONMENTAL ARRAYS
   3539 C     IUNITB   - READ UNIT FOR THE BOGUS DATA
   3540 C     MZ       - ZONAL (X) DIMENSION OF THE ENVIRONMENTAL ARRAY
   3541 C     NZ       - MERIDIONAL (Y) DIMENSION OF THE ENVIRONMENTAL ARRAY
   3542 C              - NOTE: THE Y DIMENSION IS DOUBLED WHEN READING A
   3543 C              - VECTOR VARIABLE (WIND)
   3544 C
   3545 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   3546 C     F        - ENVIRONMENTAL ARRAY
   3547 C     KL       - LEVEL INDEX FOR VARIABLE RETURNED. MANDATORY
   3548 C              - PRESSURE LEVELS ARE ASSUMED WITH KL=1 FOR 1000 MB AND
   3549 C              - KL=10 FOR 100 MB.
   3550 C     IV       - IDENTIFIER FOR ARRAY RETURNED AS FOLLOWS:
   3551 C              - IV=1: TEMPERATURE
   3552 C              - IV=2: RELATIVE HUMIDITY
   3553 C              - IV=3: GEOPOTENTIAL HEIGHT
   3554 C              - IV=4: WIND, BOTH U AND V IN ARRAY F
   3555 C              - IV=6: RELATIVE VORTICITY
   3556 C     ZZ       - BOGUS VALUE OF GEOPOTENTIAL HEIGHT
   3557 C     UU       - BOGUS VALUE OF ZONAL WIND
   3558 C     VV       - BOGUS VALUE OF MERIDIONAL WIND
   3559 C     IEND     - END OF FILE MARKER. =1 IF EOF, =0 OTHERWISE
   3560 C
   3561 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3562 C     DDNAME1  - GENERIC NAME & CONTENT
   3563 C
   3564 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   3565 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   3566 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   3567 C
   3568 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   3569 C
   3570 C ATTRIBUTES:
   3571 C   LANGUAGE: FORTRAN 90
   3572 C   MACHINE:  NCEP WCOSS
   3573 C
   3574 C$$$
   3575 

Page 91          Source Listing                  REDSUB
2017-04-18 11:09                                 syndata.f

   3576       SUBROUTINE REDSUB(IUNIT,IUNITB,MZ,NZ,F,KL,IV,IEND,RLATBG,RLONBG,
   3577      1                  ZZ,UU,VV)
   3578 
   3579       PARAMETER (MAXBGK=10)
   3580       CHARACTER MTITLE*102
   3581       LOGICAL FIRST
   3582 
   3583       COMMON/OVRHED/ITYP,PRES(MAXBGK)
   3584 
   3585       SAVE
   3586 
   3587       DIMENSION F(MZ,NZ),PLEV(MAXBGK)
   3588 
   3589       DATA PLEV/1000.,850.,700.,500.,400.,300.,250.,200.,150.,100./,
   3590      1     EPS/0.1/,FIRST/.TRUE./
   3591 
   3592 C-----------------------------------------------------------------------
   3593 
   3594       ENTRY READAG(IUNIT,MZ,NZ,F,KL,IV,IEND)
   3595 
   3596 C  THIS ENTRY READS A MAP LAUNCHER FORMAT FILE OF GRIDDED FIELDS WHICH
   3597 C    ARE OF LIMITED AREA OR GLOBAL IN EXTENT, BUT HAVE CONSTANT LAT/LON
   3598 C    SPACING.
   3599 
   3600       IF(FIRST)  THEN
   3601       FIRST=.FALSE.
   3602       PRES=PLEV
   3603       ENDIF
   3604 
   3605       IEND=0
   3606       READ(IUNIT,END=30) IMAX,JMAX,((F(I,J),I=1,IMAX),J=1,JMAX),
   3607      1               MTITLE,NCHAR
   3608       if(nchar.le.0) then
   3609          print *
   3610          print *
   3611          print *, '%%%%%% nchar = 0!!!! - this should not happen'
   3612          print *
   3613          print *
   3614       else
   3615          WRITE(6,6) IMAX,JMAX,MTITLE(1:NCHAR)
   3616     6    FORMAT(///' ...IN READA, IMAX,JMAX,MTITLE=',2I5/4X,A)
   3617       end if
   3618 
   3619 C  DIVIDE MTITLE INTO VARIABLE AND PRESSURE LEVEL
   3620 
   3621       IF(MTITLE(1:1) .EQ. 'Z') THEN
   3622       IV=3
   3623       ELSE IF(MTITLE(1:1) .EQ. 'T') THEN
   3624       IV=1
   3625       ELSE IF(MTITLE(1:2) .EQ. 'RH') THEN
   3626       IV=2
   3627       ELSE IF(MTITLE(1:1) .EQ. '$') THEN
   3628       IV=4
   3629       ELSE IF(MTITLE(1:3) .EQ. 'VOT') THEN
   3630       IV=6
   3631       ENDIF
   3632       WRITE(6,9) IV

Page 92          Source Listing                  REDSUB
2017-04-18 11:09                                 syndata.f

   3633     9 FORMAT('...IV=',I5)
   3634 
   3635       WRITE(6,11) MTITLE(9:12)
   3636    11 FORMAT('...MTITLE(9:12)=',A)
   3637       READ(MTITLE(9:12),13) IPRES
   3638    13 FORMAT(I4)
   3639       WRITE(6,15) IPRES
   3640    15 FORMAT('...IPRES=',I5)
   3641       DO 20 K=1,MAXBGK
   3642       KL=K
   3643       IF(ABS(REAL(IPRES)-PRES(K)) .LT. EPS) RETURN
   3644    20 CONTINUE
   3645       WRITE(6,21) PP
   3646    21 FORMAT('******COULD NOT FIND PRESSURE LEVEL IN READA, PP=',
   3647      1       F10.2)
   3648       CALL ABRT1(' READAG',21)
   3649 
   3650    30 IEND=1
   3651       RETURN
   3652 
   3653 C-----------------------------------------------------------------------
   3654 
   3655 C  ENTRY FOR READING BOGUS DATA AND IDENTIFYING VERTICAL LEVEL THE BOGUS
   3656 C    DATA IS READ IN THE FORMAT OF THE LORD/OOYAMA HRD ANALYSIS FORMAT
   3657 C    (EBCDIC/ASCII CHARACTERS)
   3658 
   3659       ENTRY READBG(IUNITB,RLATBG,RLONBG,KL,ZZ,UU,VV,IEND)
   3660       IEND=0
   3661       READ(IUNITB,51,END=100) ITYP,IDATEJ,ITIME,RLATBG,RLONBG,PP,
   3662      1           RMISS,RMISS,ZZ,UU,VV
   3663    51 FORMAT(I2,1X,I9,1X,I4,1X,2(F7.3,1X),3(F6.1,1X),F7.1,
   3664      1       2(F6.1,1X))
   3665 c && 3 comments
   3666 CC    WRITE(6,52) RLATBG,RLONBG,PP,ZZ,UU,VV
   3667 CC 52 FORMAT('...READING BOGUS POINTS AT RLATBG,RLONBG,PP,ZZ,UU,VV=',
   3668 CC   1       3F10.2,3F12.3)
   3669 
   3670       DO 60 K=1,MAXBGK
   3671       KL=K
   3672       IF(ABS(PP-PRES(K)) .LT. EPS) RETURN
   3673    60 CONTINUE
   3674       WRITE(6,61) PP
   3675    61 FORMAT('******COULD NOT FIND PRESSURE LEVEL IN READBG, PP=',
   3676      1       F10.2)
   3677       CALL ABRT1(' READBG',61)
   3678 
   3679   100 IEND=1
   3680       RETURN
   3681       END

Page 93          Source Listing                  REDSUB
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 readag_               readbg_               redsub_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  3679                                                           3661                              
 11                         Label  3636                                                           3635                              
 13                         Label  3638                                                           3637                              
 15                         Label  3640                                                           3639                              
 20                         Label  3644                                                           3641                              
 21                         Label  3646                                                           3645                              
 30                         Label  3650                                                           3606                              
 51                         Label  3663                                                           3661                              
 6                          Label  3616                                                           3615                              
 60                         Label  3673                                                           3670                              
 61                         Label  3675                                                           3674                              
 9                          Label  3633                                                           3632                              
 ABRT1                      Subr   3648                                                           3648,3677                         
 ABS                        Func   3643                                 scalar                    3643,3672                         
 EPS                        Local  3590     R(4)            4           scalar   SAVE             3590,3643,3672                    
 F                          Dummy  3576     R(4)            4     2     0        ARG,INOUT        3606                              
 FIRST                      Local  3581     L(4)            4           scalar   SAVE             3590,3600,3601                    
 I                          Local  3606     I(4)            4           scalar   SAVE             3606                              
 IDATEJ                     Local  3661     I(4)            4           scalar   SAVE             3661                              
 IEND                       Dummy  3576     I(4)            4           scalar   ARG,INOUT        3605,3650,3660,3679               
 IMAX                       Local  3606     I(4)            4           scalar   SAVE             3606,3615                         
 IPRES                      Local  3637     I(4)            4           scalar   SAVE             3637,3639,3643                    
 ITIME                      Local  3661     I(4)            4           scalar   SAVE             3661                              
 ITYP                       Scalar 3583     I(4)            4           scalar   COM              3661                              
 IUNIT                      Dummy  3576     I(4)            4           scalar   ARG,INOUT        3606                              
 IUNITB                     Dummy  3576     I(4)            4           scalar   ARG,INOUT        3661                              
 IV                         Dummy  3576     I(4)            4           scalar   ARG,INOUT        3622,3624,3626,3628,3630,3632     
 J                          Local  3606     I(4)            4           scalar   SAVE             3606                              
 JMAX                       Local  3606     I(4)            4           scalar   SAVE             3606,3615                         
 K                          Local  3641     I(4)            4           scalar   SAVE             3641,3642,3643,3670,3671,3672     
 KL                         Dummy  3576     I(4)            4           scalar   ARG,INOUT        3642,3671                         
 MAXBGK                     Param  3579     I(4)            4           scalar                    3583,3587,3641,3670               
 MTITLE                     Local  3580     CHAR            102         scalar   SAVE             3607,3615,3621,3623,3625,3627,3629
                                                                                                  ,3635,3637                        
 MZ                         Dummy  3576     I(4)            4           scalar   ARG,INOUT        3587                              
 NCHAR                      Local  3607     I(4)            4           scalar   SAVE             3607,3608,3615                    
 NZ                         Dummy  3576     I(4)            4           scalar   ARG,INOUT        3587                              
 OVRHED                     Common 3583                                 44       SAVE                                               
 PLEV                       Local  3587     R(4)            4     1     10       SAVE             3589,3602                         
 PP                         Local  3645     R(4)            4           scalar   SAVE             3645,3661,3672,3674               
 PRES                       Scalar 3583     R(4)            4     1     10       COM              3602,3643,3672                    
 READAG                     Subr   3594                                                                                             
 READBG                     Subr   3659                                                                                             
 REAL                       Func   3643                                 scalar                    3643                              

Page 94          Source Listing                  REDSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 REDSUB                     Subr   3576                                                                                             
 RLATBG                     Dummy  3576     R(4)            4           scalar   ARG,INOUT        3661                              
 RLONBG                     Dummy  3576     R(4)            4           scalar   ARG,INOUT        3661                              
 RMISS                      Local  3662     R(4)            4           scalar   SAVE             3662                              
 UU                         Dummy  3577     R(4)            4           scalar   ARG,INOUT        3662                              
 VV                         Dummy  3577     R(4)            4           scalar   ARG,INOUT        3662                              
 ZZ                         Dummy  3577     R(4)            4           scalar   ARG,INOUT        3662                              

Page 95          Source Listing                  REDSUB
2017-04-18 11:09                                 syndata.f

   3682 
   3683 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3684 C
   3685 C SUBPROGRAM:    SLDATE      RETRIEVES DATE FROM SYSTEM AND DATE FILE
   3686 C   PRGMMR: D. A. KEYSER     ORG: W/NMC22    DATE: 1998-06-05
   3687 C
   3688 C ABSTRACT: RETRIEVES DATE FROM SYSTEM AND FROM A DATE FILE, AND
   3689 C   OBTAINS THE DIFFERENCE BETWEEN THE TWO.  CONSTRUCTS SLORD DATE
   3690 C   FORMAT.
   3691 C
   3692 C PROGRAM HISTORY LOG:
   3693 C 1991-06-06  S. J. LORD
   3694 C 1998-06-05  D. A. KEYSER - Y2K/F90 COMPLIANCE
   3695 C
   3696 C USAGE:    CALL SLDATE(IUNTDT,IDATEZ,IUTCZ,IOFFTM)
   3697 C   INPUT ARGUMENT LIST:
   3698 C     IUNTDT   - UNIT NUMBER FOR FILE CONTAINING DATE LABEL
   3699 C
   3700 C   OUTPUT ARGUMENT LIST:
   3701 C     IDATEZ   - SLORD DATE FORMAT FOR DATE (YYYYMMDD)
   3702 C     IUTCZ    - SLORD DATE FORMAT FOR DATE (HHMM)
   3703 C     IOFFTM   - OFFSET (HOURS *100) BETWEEN SYSTEM DATE AND
   3704 C              - FILE DATE (SYSTEM DATE MINUS FILE DATE)
   3705 C
   3706 C   INPUT FILES:
   3707 C     UNIT "IUNTDT" - FILE CONTAINING NCEP DATE IN 6X,I4,3I2 FORMAT
   3708 C                   - (YYYYMMDDHH)
   3709 C
   3710 C   OUTPUT FILES:
   3711 C     UNIT 06  - STANDARD OUTPUT
   3712 C
   3713 C REMARKS: NONE.
   3714 C
   3715 C ATTRIBUTES:
   3716 C   LANGUAGE: FORTRAN 90
   3717 C   MACHINE:  NCEP WCOSS
   3718 C
   3719 C$$$
   3720       SUBROUTINE SLDATE(IUNTDT,IDATEZ,IUTCZ,IOFFTM)
   3721 
   3722       CHARACTER USRDAT*32
   3723 
   3724       SAVE
   3725 
   3726       DIMENSION IDAT(8),JDAT(8),KDAT(8),RINC(5),RINC2(5)
   3727 
   3728       COMMON/BDATE/LDAT(8)
   3729 
   3730       EQUIVALENCE (IDAT(1),JW3YR),(IDAT(2),JW3MO),(IDAT(3),JW3DA),
   3731      2            (IDAT(5),JW3HR),(IDAT(6),JW3MIN),(IDAT(7),JW3SEC)
   3732 
   3733       DATA ISTYR/7/,ISTMO/11/,ISTDA/13/,ISTHR/15/,ITWO/2/IFOUR/4/
   3734 
   3735       READ(IUNTDT,1) USRDAT
   3736     1 FORMAT(A32)
   3737       WRITE(6,3) USRDAT
   3738     3 FORMAT(/'...',A32,'...')

Page 96          Source Listing                  SLDATE
2017-04-18 11:09                                 syndata.f

   3739 
   3740 C OBTAIN CURRENT SYSTEM DATE - IDAT (UTC)
   3741 
   3742       CALL W3UTCDAT(IDAT)
   3743 
   3744 C DECODE THE DATE LABEL INTO JDAT (UTC)
   3745 
   3746       JDAT = 0
   3747       READ(USRDAT(ISTYR:ISTYR+IFOUR-1),'(I4)') JDAT(1)
   3748       READ(USRDAT(ISTMO:ISTMO+ITWO-1),11) JDAT(2)
   3749       READ(USRDAT(ISTDA:ISTDA+ITWO-1),11) JDAT(3)
   3750       READ(USRDAT(ISTHR:ISTHR+ITWO-1),11) JDAT(5)
   3751    11 FORMAT(I2)
   3752 
   3753 C THIS IS THE TIME ZONE OFFSET (SAME AS FOR IDAT)
   3754 
   3755       JDAT(4) = IDAT(4)
   3756 
   3757       JDAT(6) = 0
   3758 
   3759 C COMBINE YEAR, MONTH, DAY, HOUR, MINUTE TO SLORD FORMAT (YYYYMMDD)
   3760 
   3761       IDATEZ=JDAT(1)*10000+JDAT(2)*100+JDAT(3)
   3762       IUTCZ =JDAT(5)*100+JDAT(6)
   3763 
   3764 C OBTAIN TIME DIFFERENCE (CURRENT TIME - LABEL TIME) IN HOURS * 100
   3765 
   3766       CALL W3DIFDAT(IDAT,JDAT,2,RINC)
   3767       IOFFTM=NINT(RINC(2)*100.)
   3768 
   3769 C OBTAIN BASE DATE FROM WHICH FRACTIONAL NUMBER OF DAYS WILL BE
   3770 C  DETERMINED (ALWAYS 365 DAYS EARLIER THAN 00Z ON NCEP DATE) - LDAT
   3771 
   3772       RINC2 = 0.
   3773       RINC2(1) = -365.
   3774       KDAT = 0
   3775       KDAT(1:3) = JDAT(1:3)
   3776       CALL W3MOVDAT(RINC2,KDAT,LDAT)
   3777 
   3778       WRITE(6,5) JW3YR,JW3MO,JW3DA,JW3HR,JW3MIN,JW3SEC,IOFFTM
   3779     5 FORMAT(/'...CURRENT DATE/TIME FROM W3UTCDAT CALL IS:',/,
   3780      1       'JW3YR=',I5,' JW3MO=',I3,' JW3DA=',I3,' JW3HR=',I5,
   3781      2       ' JW3MIN=',I5,' JW3SEC=',I5,' OFFTIM=',I8)
   3782       WRITE(6,35) LDAT(1),LDAT(2),LDAT(3),LDAT(5),LDAT(6)
   3783    35 FORMAT(/'...BASE DATE FROM WHICH FRACTIONAL NUMBER OF DAYS WILL',
   3784      $ ' BE CALCULATED IS:',I5,4I3/)
   3785 
   3786       WRITE(6,13) IDATEZ,IUTCZ
   3787    13 FORMAT('...IN SLDATE, IDATEZ,IUTCZ=',I10,2X,I4)
   3788 
   3789       RETURN
   3790 
   3791       END

Page 97          Source Listing                  SLDATE
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sldate_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  3736                                                           3735                              
 11                         Label  3751                                                           3748,3749,3750                    
 13                         Label  3787                                                           3786                              
 3                          Label  3738                                                           3737                              
 35                         Label  3783                                                           3782                              
 5                          Label  3779                                                           3778                              
 BDATE                      Common 3728                                 32       SAVE                                               
 IDAT                       Local  3726     I(4)            4     1     8        SAVE             3742,3755,3766                    
 IDATEZ                     Dummy  3720     I(4)            4           scalar   ARG,INOUT        3761,3786                         
 IFOUR                      Local  3733     I(4)            4           scalar   SAVE             3733,3747                         
 IOFFTM                     Dummy  3720     I(4)            4           scalar   ARG,INOUT        3767,3778                         
 ISTDA                      Local  3733     I(4)            4           scalar   SAVE             3733,3749                         
 ISTHR                      Local  3733     I(4)            4           scalar   SAVE             3733,3750                         
 ISTMO                      Local  3733     I(4)            4           scalar   SAVE             3733,3748                         
 ISTYR                      Local  3733     I(4)            4           scalar   SAVE             3733,3747                         
 ITWO                       Local  3733     I(4)            4           scalar   SAVE             3733,3748,3749,3750               
 IUNTDT                     Dummy  3720     I(4)            4           scalar   ARG,INOUT        3735                              
 IUTCZ                      Dummy  3720     I(4)            4           scalar   ARG,INOUT        3762,3786                         
 JDAT                       Local  3726     I(4)            4     1     8        SAVE             3746,3747,3748,3749,3750,3755,3757
                                                                                                  ,3761,3762,3766,3775              
 JW3DA                      Local  3730     I(4)            4           scalar   SAVE             3778                              
 JW3HR                      Local  3731     I(4)            4           scalar   SAVE             3778                              
 JW3MIN                     Local  3731     I(4)            4           scalar   SAVE             3778                              
 JW3MO                      Local  3730     I(4)            4           scalar   SAVE             3778                              
 JW3SEC                     Local  3731     I(4)            4           scalar   SAVE             3778                              
 JW3YR                      Local  3730     I(4)            4           scalar   SAVE             3778                              
 KDAT                       Local  3726     I(4)            4     1     8        SAVE             3774,3775,3776                    
 LDAT                       Scalar 3728     I(4)            4     1     8        COM              3776,3782                         
 NINT                       Func   3767                                 scalar                    3767                              
 RINC                       Local  3726     R(4)            4     1     5        SAVE             3766,3767                         
 RINC2                      Local  3726     R(4)            4     1     5        SAVE             3772,3773,3776                    
 SLDATE                     Subr   3720                                                                                             
 USRDAT                     Local  3722     CHAR            32          scalar   SAVE             3735,3737,3747,3748,3749,3750     
 W3DIFDAT                   Subr   3766                                                           3766                              
 W3MOVDAT                   Subr   3776                                                           3776                              
 W3UTCDAT                   Subr   3742                                                           3742                              

Page 98          Source Listing                  SLDATE
2017-04-18 11:09                                 syndata.f

   3792 
   3793 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3794 C                .      .    .                                       .
   3795 C SUBPROGRAM:    FIXSLM      MODIFIES SEA-LAND MASK
   3796 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1992-04-08
   3797 C
   3798 C ABSTRACT: MODIFIES NCEP GAUSSIAN GRID SEA-LAND MASK.  CONVERTS
   3799 C   SOME SMALL ISLANDS TO OCEAN POINTS.  PROGRAM IS DEPENDENT
   3800 C   ON MODEL RESOLUTION.
   3801 C
   3802 C PROGRAM HISTORY LOG:
   3803 C 1991-06-06  S. J. LORD
   3804 C 1992-04-08  S. J. LORD  CONVERTED TO T126 FROM T80
   3805 C
   3806 C USAGE:    CALL FIXSLM(LONF,LATG2,RLON,RLAT,SLMASK)
   3807 C   INPUT ARGUMENT LIST:
   3808 C     LONF     - NUMBER OF LONGITUDINAL POINTS, FIRST INDEX OF SLMASK
   3809 C     LATG2    - NUMBER OF LATITUDINAL POINTS, SECOND INDEX OF SLMASK
   3810 C     RLON     - LONGITUDES
   3811 C     RLAT     - LATITUDES
   3812 C     SLMASK   - SEA-LAND MASK ON GAUSSIAN GRID
   3813 C
   3814 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   3815 C     SLMASK   - SEA-LAND MASK ON GAUSSIAN GRID
   3816 C
   3817 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   3818 C     FT06F001 - STANDARD PRINTOUT
   3819 C
   3820 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   3821 C
   3822 C ATTRIBUTES:
   3823 C   LANGUAGE: FORTRAN 90
   3824 C   MACHINE:  NCEP WCOSS
   3825 C
   3826 C$$$
   3827       SUBROUTINE FIXSLM(LONF,LATG2,RLON,RLAT,SLMASK)
   3828 
   3829       PARAMETER (MAXSLM=35)
   3830 
   3831       SAVE
   3832 
   3833       DIMENSION RLAT(LATG2),RLON(LONF),SLMASK(LONF,LATG2),IPT(MAXSLM),
   3834      1          JPT(MAXSLM)
   3835 
   3836       DATA NOCEAN/21/,
   3837 C  INDONESIAN ARCHIPELAGO,NEW CALEDONIA
   3838      1     IPT/133,135,129,177,
   3839 C  YUCATAN
   3840      2         290,291,292,289,290,291,289,290,291,
   3841 C  CUBA
   3842      3         299,300,301,302,303,303,304,305,14*0.0/,
   3843 C  INDONESIAN ARCHIPELAGO,NEW CALEDONIA
   3844      1     JPT/106,105,106,118,
   3845 C  YUCATAN
   3846      2         3*73,3*74,3*75,
   3847 C  CUBA
   3848      3         3*72,2*73,3*74,14*0.0/

Page 99          Source Listing                  FIXSLM
2017-04-18 11:09                                 syndata.f

   3849 
   3850 c && 2 comments
   3851 CC    WRITE(6,7)
   3852 CC  7 FORMAT('...CONVERTING LAND TO OCEAN, NPT,IPT,RLON,JPT,RLAT=')
   3853       DO 10 NPT=1,NOCEAN
   3854       SLMASK(IPT(NPT),JPT(NPT))=0.0
   3855 c && 2 comments
   3856 CC    WRITE(6,9) NPT,IPT(NPT),RLON(IPT(NPT)),JPT(NPT),RLAT(JPT(NPT))
   3857 CC  9 FORMAT(5X,2I5,F10.3,I5,F10.3)
   3858    10 CONTINUE
   3859 
   3860       RETURN
   3861       END


ENTRY POINTS

  Name               
                     
 fixslm_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3858                                                           3853                              
 FIXSLM                     Subr   3827                                                                                             
 IPT                        Local  3833     I(4)            4     1     35       SAVE             3838,3854                         
 JPT                        Local  3834     I(4)            4     1     35       SAVE             3844,3854                         
 LATG2                      Dummy  3827     I(4)            4           scalar   ARG,INOUT        3833                              
 LONF                       Dummy  3827     I(4)            4           scalar   ARG,INOUT        3833                              
 MAXSLM                     Param  3829     I(4)            4           scalar                    3833,3834                         
 NOCEAN                     Local  3836     I(4)            4           scalar   SAVE             3836,3853                         
 NPT                        Local  3853     I(4)            4           scalar   SAVE             3853,3854                         
 RLAT                       Dummy  3827     R(4)            4     1     0        ARG,INOUT                                          
 RLON                       Dummy  3827     R(4)            4     1     0        ARG,INOUT                                          
 SLMASK                     Dummy  3827     R(4)            4     2     0        ARG,INOUT        3854                              

Page 100         Source Listing                  FIXSLM
2017-04-18 11:09                                 syndata.f

   3862 
   3863 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3864 C                .      .    .                                       .
   3865 C SUBPROGRAM:    GAULAT      CALCULATES GAUSSIAN GRID LATITUDES
   3866 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   3867 C
   3868 C ABSTRACT: CALCULATES GAUSSIAN GRID LATITUDES
   3869 C
   3870 C PROGRAM HISTORY LOG:
   3871 C 1991-06-06  S. J. LORD - COPIED FROM KANAMITSU LIBRARY
   3872 C
   3873 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   3874 C   INPUT ARGUMENT LIST:
   3875 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   3876 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   3877 C
   3878 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   3879 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   3880 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   3881 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   3882 C
   3883 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3884 C     DDNAME1  - GENERIC NAME & CONTENT
   3885 C
   3886 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   3887 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   3888 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   3889 C
   3890 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   3891 C
   3892 C ATTRIBUTES:
   3893 C   LANGUAGE: FORTRAN 90
   3894 C   MACHINE:  NCEP WCOSS
   3895 C
   3896 C$$$
   3897       SUBROUTINE GAULAT(GAUL,K)
   3898 
   3899       IMPLICIT REAL(8) (A-H,O-Z)
   3900       DIMENSION A(500)
   3901 ccc dak 7/3/05      REAL GAUL(1)
   3902       real gaul(k) ! dak 7/3/05: fix bounds-check error
   3903 
   3904       SAVE
   3905 
   3906       ESP=1.D-14
   3907       C=(1.D0-(2.D0/3.14159265358979D0)**2)*0.25D0
   3908       FK=K
   3909       KK=K/2
   3910       CALL BSSLZ1(A,KK)
   3911       DO 30 IS=1,KK
   3912       XZ=COS(A(IS)/SQRT((FK+0.5D0)**2+C))
   3913       ITER=0
   3914    10 PKM2=1.D0
   3915       PKM1=XZ
   3916       ITER=ITER+1
   3917       IF(ITER.GT.10) GO TO 70
   3918       DO 20 N=2,K

Page 101         Source Listing                  GAULAT
2017-04-18 11:09                                 syndata.f

   3919       FN=N
   3920       PK=((2.D0*FN-1.D0)*XZ*PKM1-(FN-1.D0)*PKM2)/FN
   3921       PKM2=PKM1
   3922       PKM1=PK
   3923    20 CONTINUE
   3924       PKM1=PKM2
   3925       PKMRK=(FK*(PKM1-XZ*PK))/(1.D0-XZ**2)
   3926       SP=PK/PKMRK
   3927       XZ=XZ-SP
   3928       AVSP=ABS(SP)
   3929       IF(AVSP.GT.ESP) GO TO 10
   3930       A(IS)=XZ
   3931    30 CONTINUE
   3932       IF(K.EQ.KK*2) GO TO 50
   3933       A(KK+1)=0.D0
   3934       PK=2.D0/FK**2
   3935       DO 40 N=2,K,2
   3936       FN=N
   3937       PK=PK*FN**2/(FN-1.D0)**2
   3938    40 CONTINUE
   3939    50 CONTINUE
   3940       DO 60 N=1,KK
   3941       L=K+1-N
   3942       A(L)=-A(N)
   3943    60 CONTINUE
   3944 
   3945       RADI=180./(4.*ATAN(1.))
   3946       GAUL(1:K)=ACOS(A(1:K))*RADI
   3947 C && 2 comments
   3948 CC    PRINT *,'GAUSSIAN LAT (DEG) FOR JMAX=',K
   3949 CC    PRINT *,(GAUL(N),N=1,K)
   3950 
   3951       RETURN
   3952    70 WRITE(6,6000)
   3953  6000 FORMAT(//5X,'ERROR IN GAULAT'//)
   3954       CALL ABRT1(' GAULAT',6000)
   3955       END

Page 102         Source Listing                  GAULAT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 gaulat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  3914                                                           3929                              
 20                         Label  3923                                                           3918                              
 30                         Label  3931                                                           3911                              
 40                         Label  3938                                                           3935                              
 50                         Label  3939                                                           3932                              
 60                         Label  3943                                                           3940                              
 6000                       Label  3953                                                           3952                              
 70                         Label  3952                                                           3917                              
 A                          Local  3900     R(8)            8     1     500      SAVE             3910,3912,3930,3933,3942,3946     
 ABRT1                      Subr   3954                                                           3954                              
 ABS                        Func   3928                                 scalar                    3928                              
 ACOS                       Func   3946                                 scalar                    3946                              
 ATAN                       Func   3945                                 scalar                    3945                              
 AVSP                       Local  3928     R(8)            8           scalar   SAVE             3928,3929                         
 BSSLZ1                     Subr   3910                                                           3910                              
 C                          Local  3907     R(8)            8           scalar   SAVE             3907,3912                         
 COS                        Func   3912                                 scalar                    3912                              
 ESP                        Local  3906     R(8)            8           scalar   SAVE             3906,3929                         
 FK                         Local  3908     R(8)            8           scalar   SAVE             3908,3912,3925,3934               
 FN                         Local  3919     R(8)            8           scalar   SAVE             3919,3920,3936,3937               
 GAUL                       Dummy  3897     R(4)            4     1     0        ARG,INOUT        3946                              
 GAULAT                     Subr   3897                                                                                             
 IS                         Local  3911     I(4)            4           scalar   SAVE             3911,3912,3930                    
 ITER                       Local  3913     I(4)            4           scalar   SAVE             3913,3916,3917                    
 K                          Dummy  3897     I(4)            4           scalar   ARG,INOUT        3902,3908,3909,3918,3932,3935,3941
                                                                                                  ,3946                             
 KK                         Local  3909     I(4)            4           scalar   SAVE             3909,3910,3911,3932,3933,3940     
 L                          Local  3941     I(4)            4           scalar   SAVE             3941,3942                         
 N                          Local  3918     I(4)            4           scalar   SAVE             3918,3919,3935,3936,3940,3941,3942
 PK                         Local  3920     R(8)            8           scalar   SAVE             3920,3922,3925,3926,3934,3937     
 PKM1                       Local  3915     R(8)            8           scalar   SAVE             3915,3920,3921,3922,3924,3925     
 PKM2                       Local  3914     R(8)            8           scalar   SAVE             3914,3920,3921,3924               
 PKMRK                      Local  3925     R(8)            8           scalar   SAVE             3925,3926                         
 RADI                       Local  3945     R(8)            8           scalar   SAVE             3945,3946                         
 SP                         Local  3926     R(8)            8           scalar   SAVE             3926,3927,3928                    
 SQRT                       Func   3912                                 scalar                    3912                              
 XZ                         Local  3912     R(8)            8           scalar   SAVE             3912,3915,3920,3925,3927,3930     

Page 103         Source Listing                  GAULAT
2017-04-18 11:09                                 syndata.f

   3956 
   3957 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3958 C                .      .    .                                       .
   3959 C SUBPROGRAM:    BSSLZ1      CALCULATES BESSEL FUNCTIONS
   3960 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   3961 C
   3962 C ABSTRACT: CALCULATES BESSEL FUNCTIONS
   3963 C
   3964 C PROGRAM HISTORY LOG:
   3965 C 1991-06-06  S. J. LORD - COPIED FROM KANAMITSU LIBRARY
   3966 C
   3967 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   3968 C   INPUT ARGUMENT LIST:
   3969 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   3970 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   3971 C
   3972 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   3973 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   3974 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   3975 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   3976 C
   3977 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   3978 C     DDNAME1  - GENERIC NAME & CONTENT
   3979 C
   3980 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   3981 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   3982 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   3983 C
   3984 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   3985 C
   3986 C ATTRIBUTES:
   3987 C   LANGUAGE: FORTRAN 90
   3988 C   MACHINE:  NCEP WCOSS
   3989 C
   3990 C$$$
   3991       SUBROUTINE BSSLZ1(BES,N)
   3992 
   3993       IMPLICIT REAL(8) (A-H,O-Z)
   3994       DIMENSION BES(N)
   3995       DIMENSION BZ(50)
   3996 
   3997       DATA PI/3.14159265358979D0/
   3998       DATA BZ         / 2.4048255577D0, 5.5200781103D0,
   3999      $  8.6537279129D0,11.7915344391D0,14.9309177086D0,18.0710639679D0,
   4000      $ 21.2116366299D0,24.3524715308D0,27.4934791320D0,30.6346064684D0,
   4001      $ 33.7758202136D0,36.9170983537D0,40.0584257646D0,43.1997917132D0,
   4002      $ 46.3411883717D0,49.4826098974D0,52.6240518411D0,55.7655107550D0,
   4003      $ 58.9069839261D0,62.0484691902D0,65.1899648002D0,68.3314693299D0,
   4004      $ 71.4729816036D0,74.6145006437D0,77.7560256304D0,80.8975558711D0,
   4005      $ 84.0390907769D0,87.1806298436D0,90.3221726372D0,93.4637187819D0,
   4006      $ 96.6052679510D0,99.7468198587D0,102.888374254D0,106.029930916D0,
   4007      $ 109.171489649D0,112.313050280D0,115.454612653D0,118.596176630D0,
   4008      $ 121.737742088D0,124.879308913D0,128.020877005D0,131.162446275D0,
   4009      $ 134.304016638D0,137.445588020D0,140.587160352D0,143.728733573D0,
   4010      $ 146.870307625D0,150.011882457D0,153.153458019D0,156.295034268D0/
   4011       NN=N
   4012       IF(N.LE.50) GO TO 12

Page 104         Source Listing                  BSSLZ1
2017-04-18 11:09                                 syndata.f

   4013       BES(50)=BZ(50)
   4014       DO 5 J=51,N
   4015       BES(J)=BES(J-1)+PI
   4016     5 CONTINUE
   4017       NN=49
   4018    12 CONTINUE
   4019       BES(1:NN)=BZ(1:NN)
   4020 
   4021       RETURN
   4022 
   4023       END


ENTRY POINTS

  Name               
                     
 bsslz1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 12                         Label  4018                                                           4012                              
 5                          Label  4016                                                           4014                              
 BES                        Dummy  3991     R(8)            8     1     0        ARG,INOUT        4013,4015,4019                    
 BSSLZ1                     Subr   3991                                                                                             
 BZ                         Local  3995     R(8)            8     1     50                        3998,4013,4019                    
 J                          Local  4014     I(4)            4           scalar                    4014,4015                         
 N                          Dummy  3991     I(4)            4           scalar   ARG,INOUT        3994,4011,4012,4014               
 NN                         Local  4011     I(4)            4           scalar                    4011,4017,4019                    
 PI                         Local  3997     R(8)            8           scalar                    3997,4015                         

Page 105         Source Listing                  BSSLZ1
2017-04-18 11:09                                 syndata.f

   4024 
   4025 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4026 C                .      .    .                                       .
   4027 C SUBPROGRAM:    SEARCH      SEARCHES FOR TCVITALS RECORDS
   4028 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 1998-10-28
   4029 C
   4030 C ABSTRACT: SEARCHES FOR TCVITALS (TROPICAL CYCLONE VITAL
   4031 C   STATISTICS) RECORDS ON A SPECIFIED DATE/TIME.
   4032 C
   4033 C PROGRAM HISTORY LOG:
   4034 C 1991-06-06  S. J. LORD
   4035 C 1998-10-28  D. A. KEYSER - Y2K/F90 COMPLIANCE
   4036 C
   4037 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   4038 C   INPUT ARGUMENT LIST:
   4039 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   4040 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   4041 C
   4042 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   4043 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   4044 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   4045 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   4046 C
   4047 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   4048 C     DDNAME1  - GENERIC NAME & CONTENT
   4049 C
   4050 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   4051 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   4052 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   4053 C
   4054 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   4055 C
   4056 C ATTRIBUTES:
   4057 C   LANGUAGE: FORTRAN 90
   4058 C   MACHINE:  NCEP WCOSS
   4059 C
   4060 C$$$
   4061       SUBROUTINE SEARCH(IDATEZ,IUTCZ,IHRWIN,MAXSTM,KSTORM,STMLAT,STMLON,
   4062      1                  STMDIR,STMSPD,RMAX,PENV,PCEN,PTOP,IDATE,IUTC,
   4063      2                  VMAX,RMW,R15NE,R15SE,R15SW,R15NW,PT,IOVITL,
   4064      3                  IUNTBH,IERSRC,IERVIT,QCFILE,FSTFLG,RSMC,STMID,
   4065      4                  STMNAM,ihrreq)
   4066 
   4067       CHARACTER STMNMZ*9
   4068 
   4069       LOGICAL QCFILE
   4070 
   4071       INTEGER  JDAT(8),KDAT(8)
   4072 
   4073       REAL(8)  COSDEG_8
   4074 
   4075       DIMENSION  RINC(5),RINC2(5)
   4076 
   4077       SAVE
   4078 
   4079       CHARACTER STMNAM*9,STMID*3,RSMC*4
   4080 

Page 106         Source Listing                  SEARCH
2017-04-18 11:09                                 syndata.f

   4081       LOGICAL FSTFLG
   4082 
   4083       DIMENSION STMNAM(MAXSTM),STMLAT(MAXSTM),STMLON(MAXSTM),
   4084      1          STMDIR(MAXSTM),STMSPD(MAXSTM),IDATE(MAXSTM),
   4085      2          IUTC(MAXSTM),RMAX(MAXSTM),PENV(MAXSTM),PCEN(MAXSTM),
   4086      3          PTOP(MAXSTM),RSMC(MAXSTM),RMW(MAXSTM),VMAX(MAXSTM),
   4087      4          R15NW(MAXSTM),R15NE(MAXSTM),R15SE(MAXSTM),R15SW(MAXSTM),
   4088      5          STMID(MAXSTM),FSTFLG(MAXSTM)
   4089 
   4090       COMMON/BDATE/LDAT(8)
   4091 
   4092 C  FACSPD IS CONVERSION FACTOR FOR R(DEG LAT)=V(M/S)*T(FRAC DAY)*FACSPD
   4093 C  FIVMIN IS FIVE MINUTES IN UNITS OF FRACTIONAL DAYS
   4094 
   4095       DATA IPRNT/0/,FACSPD/0.77719/,FIVMIN/3.4722E-3/
   4096 
   4097 C  THIS SUBROUTINE DIRECTS THE SEARCH FOR ALL STORMS AT A SPECIFIED
   4098 C    DATE AND TIME.  IT RETURNS THE NAMES OF ALL STORMS THAT EXIST
   4099 C    TOGETHER WITH LATITUDE, LONGITUDE, DIRECTION, SPEED, RADIUS OF
   4100 C    OUTERMOST CLOSED ISOBAR, ENVIRONMENTAL AND CENTRAL PRESSURE.  THE
   4101 C    FILE QUERIED IS THE SECOND GENERATION VITAL STATISTICS FILE.
   4102 
   4103       IRDVI=0
   4104       IDATZZ=IDATEZ
   4105       IUTCZZ=IUTCZ
   4106       WRITE(6,5) IDATEZ,IUTCZ,IHRWIN,QCFILE
   4107     5 FORMAT(///21X,57('*')/21X,'****',49X,'****'/21X,'**** FINDING ',
   4108      1       'ALL STORMS ON DATE=',I9,'; UTC=',I5,' ****',/,21X,'****',
   4109      2       16X,'WINDOW=',I4,' HOURS',16X,'****',/,21X,'****  A "@" ',
   4110      3       'SIGN INDICATES AN EXTRAPOLATED POSITION  ****',/,21X,
   4111      4       '****',7X,'THE FILE IS QUALITY CONTROLED:',L2,'.',9X,'****'
   4112      5       /21X,'****',49X,'****'/21X,57('*')//)
   4113 
   4114    10 IOPT=1
   4115       IDTREQ=IDATZZ
   4116       IHRREQ=IUTCZZ
   4117 
   4118       CALL NEWVIT(IOVITL,IPRNT,IOPT,IERVIT,MAXSTM,KSTORM,IDTREQ,IHRREQ,
   4119      1            IHRWIN,IDATE,IUTC,STMLAT,STMLON,STMDIR,STMSPD,
   4120      2            PCEN,PENV,RMAX,VMAX,RMW,R15NE,R15SE,R15SW,R15NW,
   4121      3            PTOP,FSTFLG,STMNAM,STMID,RSMC)
   4122 
   4123       IF(KSTORM .GT. 0)  THEN
   4124 
   4125       WRITE(6,13)
   4126       WRITE(IUNTBH,13)
   4127    13 FORMAT(/5X,'NAME',7X,'SID',1X,'FST',1X,'YYYYMMDD',2X,'HHMM',3X,
   4128      1       'LAT',3X,'LONG',3X,'DIR',3X,'SPD',3X,'PCEN',3X,'PENV',4X,
   4129      2       'RMAX',2X,'PTOP',3X,'VMAX',3X,'RMW',3X,'R15NE',2X,
   4130      3       'R15SE',2X,'R15SW',2X,'R15NW'/)
   4131       DO KST=1,KSTORM
   4132       STMNMZ=STMNAM(KST)
   4133       IF(IRDVI .GT. 0 .OR. IHRWIN .GT. 0)  THEN
   4134 
   4135 C  FOR A NON-ZERO TIME WINDOW, MAKE SURE TIME AND POSITION ARE ADJUSTED
   4136 C    TO THE REQUESTED TIME
   4137 

Page 107         Source Listing                  SEARCH
2017-04-18 11:09                                 syndata.f

   4138       IF(IHRWIN .GT. 0)  THEN
   4139       CALL ZTIME(IDATEZ,IUTCZ,IYR,IMO,IDA,IHR,IMIN)
   4140       KDAT = 0
   4141       KDAT(1) = IYR
   4142       KDAT(2) = IMO
   4143       KDAT(3) = IDA
   4144       CALL W3DIFDAT(KDAT,LDAT,1,RINC)
   4145       JDY = NINT(RINC(1))
   4146       CALL FLDAY(JDY,IHR,IMIN,DAYZ)
   4147       CALL ZTIME(IDATE(KST),IUTC(KST),IYR,IMO,IDA,IHR,IMIN)
   4148       KDAT = 0
   4149       KDAT(1) = IYR
   4150       KDAT(2) = IMO
   4151       KDAT(3) = IDA
   4152       CALL W3DIFDAT(KDAT,LDAT,1,RINC)
   4153       JDY = NINT(RINC(1))
   4154       CALL FLDAY(JDY,IHR,IMIN,DAYA)
   4155       DT=DAYZ-DAYA
   4156       ENDIF
   4157 
   4158       CALL DS2UV(USTM,VSTM,STMDIR(KST),STMSPD(KST))
   4159       STMLON(KST)=STMLON(KST)+USTM*DT*FACSPD/COSDEG_8(STMLAT(KST))
   4160       STMLAT(KST)=STMLAT(KST)+VSTM*DT*FACSPD
   4161       IDATE(KST)=IDATEZ
   4162       IUTC(KST) =IUTCZ
   4163       IF(ABS(DT) .GT. FIVMIN)  STMNMZ(9:9)='@'
   4164       ENDIF
   4165 
   4166       WRITE(6,17) KST,STMNMZ,STMID(KST),FSTFLG(KST),IDATE(KST),
   4167      1            IUTC(KST),STMLAT(KST),STMLON(KST),STMDIR(KST),
   4168      2            STMSPD(KST),PCEN(KST),PENV(KST),RMAX(KST),
   4169      3            PTOP(KST),VMAX(KST),RMW(KST),R15NE(KST),
   4170      4            R15SE(KST),R15SW(KST),R15NW(KST)
   4171       WRITE(IUNTBH,17) KST,STMNMZ,STMID(KST),FSTFLG(KST),IDATE(KST),
   4172      1                 IUTC(KST),STMLAT(KST),STMLON(KST),STMDIR(KST),
   4173      2                 STMSPD(KST),PCEN(KST),PENV(KST),RMAX(KST),
   4174      3                 PTOP(KST),VMAX(KST),RMW(KST),R15NE(KST),
   4175      4                 R15SE(KST),R15SW(KST),R15NW(KST)
   4176    17 FORMAT(I3,2X,A9,2X,A3,2X,L1,2X,I8,2X,I4,1X,F5.1,2F7.1,F5.1,1X,
   4177      1       2F7.1,1X,2F6.1,2X,F5.1,5F7.1)
   4178       ENDDO
   4179       print *, ' '
   4180       print *, ' '
   4181 
   4182 C  OPTION 1: SET TOP OF ALL STORMS TO A CONSTANT PRESSURE.
   4183 
   4184       IF(NINT(PT*10.) .GT. 0)  THEN
   4185       PTOP(1:KSTORM)=PT
   4186       WRITE(6,27) PT
   4187    27 FORMAT(/'...NOTE THAT ALL STORMS ARE FORCED TO A MAXIMUM ',
   4188      1       'TOP LEVEL OF',F7.0,' HPA.')
   4189 
   4190 C  OPTION 2: FIND THE DEEPEST CYCLONIC CIRCULATION OF ALL STORMS.
   4191 C            ****IMPORTANT NOTE: WE ASSUME THERE ARE NO MISSING
   4192 C                                VALUES (MISSING CODE=-99.0) ****
   4193 
   4194       ELSE

Page 108         Source Listing                  SEARCH
2017-04-18 11:09                                 syndata.f

   4195       PT=1.E10
   4196       DO KST=1,KSTORM
   4197          PT=MIN(PT,PTOP(KST))
   4198       ENDDO
   4199       WRITE(6,31) PT
   4200    31 FORMAT(/'...PRESSURE LEVEL OF DEEPEST CYCLONIC CIRCULATION IS',
   4201      1       F7.0,' HPA.')
   4202       ENDIF
   4203 
   4204 C  ***  NORMAL RETURN ***
   4205 
   4206       IERSRC=0
   4207       RETURN
   4208 
   4209       ELSE
   4210 
   4211 C  IN THE CASE WHERE NO STORMS CAN BE FOUND, AND THE WINDOW IS ZERO, WE
   4212 C    GO BACK IN TIME ONE HALF A CYCLE (6 H).
   4213 
   4214         IF(IRDVI .GT. 0 .OR. IHRWIN .GT. 0) THEN
   4215         WRITE(6,33)
   4216    33   FORMAT(/'******WE HAVE TRIED TO FIND STORMS BUT FAILED.',
   4217      1         ' THEREFORE WE ARE TERMINATING THIS PROGRAM')
   4218         IERSRC=33
   4219         RETURN
   4220         ENDIF
   4221 
   4222       IRDVI=1
   4223       WRITE(6,41)
   4224    41 FORMAT(/'******THERE WERE NO STORMS FOUND AT THE ORIGINALLY',
   4225      1       ' REQUESTED TIME')
   4226 
   4227       CALL ZTIME(IDATZZ,IUTCZZ,IYR,IMO,IDA,IHR,IMIN)
   4228       KDAT = 0
   4229       KDAT(1) = IYR
   4230       KDAT(2) = IMO
   4231       KDAT(3) = IDA
   4232       CALL W3DIFDAT(KDAT,LDAT,1,RINC)
   4233       JDY = NINT(RINC(1))
   4234       CALL FLDAY(JDY,IHR,IMIN,DAYZ)
   4235 
   4236 c && 3 comments
   4237 CC    WRITE(6,61) IDATZZ,IUTCZZ,IYR,IMO,IDA,IHR,IMIN,JDY,DAYZ
   4238 CC 61 FORMAT(' DEBUGGING DATE/TIME, IDATZZ,IUTCZZ,IYR,IMO,IDA,IHR,',
   4239 CC   1       'IMIN,JDY,DAYZ=',I11,I9,6I5,F11.3)
   4240 
   4241       DT=0.25
   4242       DAY00=DAYZ-DT
   4243 
   4244       RINC2 = 0.
   4245       RINC2(1) = DAY00+FIVMIN
   4246       CALL W3MOVDAT(RINC2,LDAT,JDAT)
   4247       IYR = JDAT(1)
   4248       JMO = JDAT(2)
   4249       JDA = JDAT(3)
   4250       JHR = JDAT(5)
   4251       JMN = JDAT(6)

Page 109         Source Listing                  SEARCH
2017-04-18 11:09                                 syndata.f

   4252 
   4253       WRITE(6,71) IYR,JMO,JDA,JHR,JMN
   4254    71 FORMAT(' CALLING W3MOVDAT IYR,JMO,JDA=',5I5)
   4255 
   4256       IDATZZ=IYR*10000+JMO*100+JDA
   4257       IUTCZZ=JHR*100+JMN
   4258 
   4259       IHRSUB=NINT(DT*24.)
   4260       WRITE(6,81) IHRSUB,IDATZZ,IUTCZZ
   4261    81 FORMAT(/3X,'...DATE/TIME AFTER SUBTRACTING',I4,' HOURS=',
   4262      1       I11,I9,' WE WILL NOW SEARCH FOR STORMS AT THIS DATE/TIME.')
   4263       GO TO 10
   4264       ENDIF
   4265 
   4266       END


ENTRY POINTS

  Name               
                     
 search_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  4114                                                           4263                              
 13                         Label  4127                                                           4125,4126                         
 17                         Label  4176                                                           4166,4171                         
 27                         Label  4187                                                           4186                              
 31                         Label  4200                                                           4199                              
 33                         Label  4216                                                           4215                              
 41                         Label  4224                                                           4223                              
 5                          Label  4107                                                           4106                              
 71                         Label  4254                                                           4253                              
 81                         Label  4261                                                           4260                              
 ABS                        Func   4163                                 scalar                    4163                              
 BDATE                      Common 4090                                 32       SAVE                                               
 COSDEG_8                   Func   4073     R(8)            8           scalar                    4159                              
 DAY00                      Local  4242     R(4)            4           scalar   SAVE             4242,4245                         
 DAYA                       Local  4154     R(4)            4           scalar   SAVE             4154,4155                         
 DAYZ                       Local  4146     R(4)            4           scalar   SAVE             4146,4155,4234,4242               
 DS2UV                      Subr   4158                                                           4158                              
 DT                         Local  4155     R(4)            4           scalar   SAVE             4155,4159,4160,4163,4241,4242,4259
 FACSPD                     Local  4095     R(4)            4           scalar   SAVE             4095,4159,4160                    
 FIVMIN                     Local  4095     R(4)            4           scalar   SAVE             4095,4163,4245                    
 FLDAY                      Subr   4146                                                           4146,4154,4234                    
 FSTFLG                     Dummy  4064     L(4)            4     1     0        ARG,INOUT        4121,4166,4171                    
 IDA                        Local  4139     I(4)            4           scalar   SAVE             4139,4143,4147,4151,4227,4231     
 IDATE                      Dummy  4062     I(4)            4     1     0        ARG,INOUT        4119,4147,4161,4166,4171          
 IDATEZ                     Dummy  4061     I(4)            4           scalar   ARG,INOUT        4104,4106,4139,4161               
 IDATZZ                     Local  4104     I(4)            4           scalar   SAVE             4104,4115,4227,4256,4260          
 IDTREQ                     Local  4115     I(4)            4           scalar   SAVE             4115,4118                         
 IERSRC                     Dummy  4064     I(4)            4           scalar   ARG,INOUT        4206,4218                         
 IERVIT                     Dummy  4064     I(4)            4           scalar   ARG,INOUT        4118                              

Page 110         Source Listing                  SEARCH
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IHR                        Local  4139     I(4)            4           scalar   SAVE             4139,4146,4147,4154,4227,4234     
 IHRREQ                     Dummy  4065     I(4)            4           scalar   ARG,INOUT        4116,4118                         
 IHRSUB                     Local  4259     I(4)            4           scalar   SAVE             4259,4260                         
 IHRWIN                     Dummy  4061     I(4)            4           scalar   ARG,INOUT        4106,4119,4133,4138,4214          
 IMIN                       Local  4139     I(4)            4           scalar   SAVE             4139,4146,4147,4154,4227,4234     
 IMO                        Local  4139     I(4)            4           scalar   SAVE             4139,4142,4147,4150,4227,4230     
 IOPT                       Local  4114     I(4)            4           scalar   SAVE             4114,4118                         
 IOVITL                     Dummy  4063     I(4)            4           scalar   ARG,INOUT        4118                              
 IPRNT                      Local  4095     I(4)            4           scalar   SAVE             4095,4118                         
 IRDVI                      Local  4103     I(4)            4           scalar   SAVE             4103,4133,4214,4222               
 IUNTBH                     Dummy  4064     I(4)            4           scalar   ARG,INOUT        4126,4171                         
 IUTC                       Dummy  4062     I(4)            4     1     0        ARG,INOUT        4119,4147,4162,4167,4172          
 IUTCZ                      Dummy  4061     I(4)            4           scalar   ARG,INOUT        4105,4106,4139,4162               
 IUTCZZ                     Local  4105     I(4)            4           scalar   SAVE             4105,4116,4227,4257,4260          
 IYR                        Local  4139     I(4)            4           scalar   SAVE             4139,4141,4147,4149,4227,4229,4247
                                                                                                  ,4253,4256                        
 JDA                        Local  4249     I(4)            4           scalar   SAVE             4249,4253,4256                    
 JDAT                       Local  4071     I(4)            4     1     8        SAVE             4246,4247,4248,4249,4250,4251     
 JDY                        Local  4145     I(4)            4           scalar   SAVE             4145,4146,4153,4154,4233,4234     
 JHR                        Local  4250     I(4)            4           scalar   SAVE             4250,4253,4257                    
 JMN                        Local  4251     I(4)            4           scalar   SAVE             4251,4253,4257                    
 JMO                        Local  4248     I(4)            4           scalar   SAVE             4248,4253,4256                    
 KDAT                       Local  4071     I(4)            4     1     8        SAVE             4140,4141,4142,4143,4144,4148,4149
                                                                                                  ,4150,4151,4152,4228,4229,4230,423
                                                                                                  1,4232                            
 KST                        Local  4131     I(4)            4           scalar   SAVE             4131,4132,4147,4158,4159,4160,4161
                                                                                                  ,4162,4166,4167,4168,4169,4170,417
                                                                                                  1,4172,4173,4174,4175,4196,4197   
 KSTORM                     Dummy  4061     I(4)            4           scalar   ARG,INOUT        4118,4123,4131,4185,4196          
 LDAT                       Scalar 4090     I(4)            4     1     8        COM              4144,4152,4232,4246               
 MAXSTM                     Dummy  4061     I(4)            4           scalar   ARG,INOUT        4083,4084,4085,4086,4087,4088,4118
 MIN                        Func   4197                                 scalar                    4197                              
 NEWVIT                     Subr   4118                                                           4118                              
 NINT                       Func   4145                                 scalar                    4145,4153,4184,4233,4259          
 PCEN                       Dummy  4062     R(4)            4     1     0        ARG,INOUT        4120,4168,4173                    
 PENV                       Dummy  4062     R(4)            4     1     0        ARG,INOUT        4120,4168,4173                    
 PT                         Dummy  4063     R(4)            4           scalar   ARG,INOUT        4184,4185,4186,4195,4197,4199     
 PTOP                       Dummy  4062     R(4)            4     1     0        ARG,INOUT        4121,4169,4174,4185,4197          
 QCFILE                     Dummy  4064     L(4)            4           scalar   ARG,INOUT        4106                              
 R15NE                      Dummy  4063     R(4)            4     1     0        ARG,INOUT        4120,4169,4174                    
 R15NW                      Dummy  4063     R(4)            4     1     0        ARG,INOUT        4120,4170,4175                    
 R15SE                      Dummy  4063     R(4)            4     1     0        ARG,INOUT        4120,4170,4175                    
 R15SW                      Dummy  4063     R(4)            4     1     0        ARG,INOUT        4120,4170,4175                    
 RINC                       Local  4075     R(4)            4     1     5        SAVE             4144,4145,4152,4153,4232,4233     
 RINC2                      Local  4075     R(4)            4     1     5        SAVE             4244,4245,4246                    
 RMAX                       Dummy  4062     R(4)            4     1     0        ARG,INOUT        4120,4168,4173                    
 RMW                        Dummy  4063     R(4)            4     1     0        ARG,INOUT        4120,4169,4174                    
 RSMC                       Dummy  4064     CHAR            4     1     0        ARG,INOUT        4121                              
 SEARCH                     Subr   4061                                                                                             
 STMDIR                     Dummy  4062     R(4)            4     1     0        ARG,INOUT        4119,4158,4167,4172               
 STMID                      Dummy  4064     CHAR            3     1     0        ARG,INOUT        4121,4166,4171                    
 STMLAT                     Dummy  4061     R(4)            4     1     0        ARG,INOUT        4119,4159,4160,4167,4172          
 STMLON                     Dummy  4061     R(4)            4     1     0        ARG,INOUT        4119,4159,4167,4172               
 STMNAM                     Dummy  4065     CHAR            9     1     0        ARG,INOUT        4121,4132                         
 STMNMZ                     Local  4067     CHAR            9           scalar   SAVE             4132,4163,4166,4171               

Page 111         Source Listing                  SEARCH
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 STMSPD                     Dummy  4062     R(4)            4     1     0        ARG,INOUT        4119,4158,4168,4173               
 USTM                       Local  4158     R(4)            4           scalar   SAVE             4158,4159                         
 VMAX                       Dummy  4063     R(4)            4     1     0        ARG,INOUT        4120,4169,4174                    
 VSTM                       Local  4158     R(4)            4           scalar   SAVE             4158,4160                         
 W3DIFDAT                   Subr   4144                                                           4144,4152,4232                    
 W3MOVDAT                   Subr   4246                                                           4246                              
 ZTIME                      Subr   4139                                                           4139,4147,4227                    

Page 112         Source Listing                  SEARCH
2017-04-18 11:09                                 syndata.f

   4267 
   4268 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4269 C                .      .    .                                       .
   4270 C SUBPROGRAM:    TRKSUB      DETERMINES OBS. TROP. CYCLONE TRACKS
   4271 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   4272 C
   4273 C ABSTRACT: CONTAINS VARIOUS ENTRY POINTS TO DETERMINE TROPICAL
   4274 C   CYCLONE TRACKS, CALCULATE STORM RELATIVE COORDINATE, DETERMINES
   4275 C   FIRST OCCURRENCE OF A PARTICULAR STORM.
   4276 C
   4277 C PROGRAM HISTORY LOG:
   4278 C 1991-06-06  S. J. LORD
   4279 C
   4280 C USAGE:    CALL TRKSUB(IOVITL,IOPTZ,IDATTK,DAY00,DAYMN0,DAYMX0,DAYOFF,
   4281 C    1                  STMDR0,STMSP0,IERSET,IUTCTK,IFSTZ,FSTFGZ,
   4282 C    2                  QCFILE,RLON,RLAT,DAYZ,IHOWFR,ANGLE,STMNTK)
   4283 C           CALL SETTRK(IOVITL,IOPTZ,IDATTK,DAY00,DAYMN0,DAYMX0,DAYOFF,
   4284 C    1                  STMDR0,STMSP0,STMNTK,IERSET,ihrreq)
   4285 C
   4286 C   INPUT ARGUMENT LIST:
   4287 C     DAY00    - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
   4288 C              - 00Z ON NCEP DATE
   4289 C     DAYMX0   - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
   4290 C              - 00Z ON NCEP DATE
   4291 C     DAYMN0   - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
   4292 C              - 00Z ON NCEP DATE
   4293 C
   4294 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   4295 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   4296 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   4297 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   4298 C
   4299 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   4300 C     DDNAME1  - GENERIC NAME & CONTENT
   4301 C
   4302 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   4303 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   4304 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   4305 C
   4306 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   4307 C
   4308 C ATTRIBUTES:
   4309 C   LANGUAGE: FORTRAN 90
   4310 C   MACHINE:  NCEP WCOSS
   4311 C
   4312 C$$$
   4313 
   4314       SUBROUTINE TRKSUB(IOVITL,IOPTZ,IDATTK,DAY00,DAYMN0,DAYMX0,DAYOFF,
   4315      1                  STMDR0,STMSP0,IERSET,IUTCTK,IFSTZ,FSTFGZ,QCFILE,
   4316      2                  RLON,RLAT,DAYZ,IHOWFR,ANGLE,STMNTK)
   4317 
   4318       PARAMETER(NSTM=70,NSTM1=NSTM+1,MAXSTM=NSTM)
   4319 
   4320       LOGICAL NOMIN,NOMAX,EXTRPB,EXTRPF,FSTFGZ,QCFILE,FIRST
   4321       CHARACTER STMNTK*(*)
   4322 
   4323       SAVE

Page 113         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4324 
   4325       DIMENSION  JDAT(8),RINC(5)
   4326 
   4327       REAL(8)  COSDEG_8,DISTSP_8
   4328 
   4329       INTEGER(8) IDAFST_8,ICHECK_8
   4330 
   4331       CHARACTER STMNAM*9,STMID*3,RSMC*4
   4332 
   4333       LOGICAL FSTFLG
   4334 
   4335       DIMENSION STMNAM(MAXSTM),STMLAT(MAXSTM),STMLON(MAXSTM),
   4336      1          STMDIR(MAXSTM),STMSPD(MAXSTM),IDATE(MAXSTM),
   4337      2          IUTC(MAXSTM),RMAX(MAXSTM),PENV(MAXSTM),PCEN(MAXSTM),
   4338      3          PTOP(MAXSTM),RSMC(MAXSTM),RMW(MAXSTM),VMAX(MAXSTM),
   4339      4          R15NW(MAXSTM),R15NE(MAXSTM),R15SE(MAXSTM),R15SW(MAXSTM),
   4340      5          STMID(MAXSTM),FSTFLG(MAXSTM)
   4341 
   4342       PARAMETER (MAXTPC= 3)
   4343 
   4344       DIMENSION STMTPC(0:MAXTPC)
   4345 
   4346       CHARACTER SHALO*1,MEDIUM*1,DEEP*1,STMTPC*1,EXE*1
   4347 
   4348       DIMENSION TRKLTZ(0:NSTM1),TRKLNZ(0:NSTM1),TRKDRZ(0:NSTM1),
   4349      1          TRKSPZ(0:NSTM1),TRKRMX(0:NSTM1),TRKPCN(0:NSTM1),
   4350      2          TRKPEN(0:NSTM1),TRKVMX(0:NSTM1),TRKDPT(0:NSTM1)
   4351 
   4352       DIMENSION STMDAY(0:NSTM1),SRTDAY(NSTM),IDASRT(0:NSTM1),
   4353      1          SRTLAT(NSTM),SRTLON(NSTM),SRTDIR(NSTM),SRTSPD(NSTM),
   4354      2          ISRTDA(NSTM),ISRTUT(NSTM),SRTRMX(NSTM),SRTPCN(NSTM),
   4355      3          SRTPEN(NSTM),SRTVMX(NSTM),SRTDPT(NSTM)
   4356 
   4357       COMMON/BDATE/LDAT(8)
   4358 
   4359       EQUIVALENCE (TRKLTZ(1),STMLAT(1)),(TRKLNZ(1),STMLON(1)),
   4360      1            (TRKDRZ(1),STMDIR(1)),(TRKSPZ(1),STMSPD(1)),
   4361      2            (TRKRMX(1),RMAX  (1)),(TRKPCN(1),PCEN  (1)),
   4362      3            (TRKPEN(1),PENV  (1)),(TRKVMX(1),VMAX  (1)),
   4363      4            (TRKDPT(1),PTOP  (1))
   4364 
   4365       DATA SHALO/'S'/,MEDIUM/'M'/,DEEP/'D'/,EXE/'X'/
   4366 
   4367       EQUIVALENCE (STMTPC(0), EXE),(STMTPC(1),SHALO),(STMTPC(2),MEDIUM),
   4368      1            (STMTPC(3),DEEP)
   4369 
   4370 C  FIVMIN IS FIVE MINUTES IN UNITS OF FRACTIONAL DAYS
   4371 C  FACSPD IS CONVERSION FACTOR FOR R(DEG LAT)=V(M/S)*T(FRAC DAY)*FACSPD
   4372 C  FIRST CONTROLS PRINTOUT FOR ENTRY FSTOCR
   4373 
   4374       DATA IPRNT/0/,FIVMIN/3.4722E-3/,FACSPD/0.77719/,FIRST/.TRUE./
   4375 
   4376 C-----------------------------------------------------------------------
   4377 
   4378       ENTRY SETTRK(IOVITL,IOPTZ,IDATTK,DAY00,DAYMN0,DAYMX0,DAYOFF,
   4379      1             STMDR0,STMSP0,STMNTK,IERSET,ihrreq)
   4380 

Page 114         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4381       IERSET=0
   4382       IOPT=IOPTZ
   4383       IDTREQ=IDATTK
   4384       IF(IOPT .EQ. 5)  THEN
   4385       STMID (1)=STMNTK(1:3)
   4386       ELSE IF(IOPT .EQ. 6)  THEN
   4387       STMNAM(1)=STMNTK(1:9)
   4388       ELSE
   4389       WRITE(6,1) IOPT
   4390     1 FORMAT(/'******ILLEGAL OPTION IN SETTRK=',I4)
   4391       IERSET=1
   4392       RETURN
   4393       ENDIF
   4394 
   4395       WRITE(6,6) IOPT,STMNTK,DAY00,DAYMN0,DAYMX0,IDTREQ,IHRREQ
   4396     6 FORMAT(/'...ENTERING SETTRK, WITH IOPT=',I2,'. LOOKING ',
   4397      1       'FOR ALL FIXES FOR ',A,' WITH CENTRAL TIME=',F12.2,/,5X,
   4398      2       'MIN/MAX TIMES=',2F12.2,' AND REQUESTED DATE/TIME=',I9,I8)
   4399 
   4400       CALL NEWVIT(IOVITL,IPRNT,IOPT,IERVIT,MAXSTM,KSTORM,IDTREQ,IHRREQ,
   4401      1            IHRWIN,IDATE,IUTC,STMLAT,STMLON,STMDIR,STMSPD,PCEN,
   4402      2            PENV,RMAX,VMAX,RMW,R15NE,R15SE,R15SW,R15NW,PTOP,
   4403      3            FSTFLG,STMNAM,STMID,RSMC)
   4404 
   4405 C  CONVERT FIX TIMES TO FLOATING POINT JULIAN DAY
   4406 
   4407       DO KST=1,KSTORM
   4408       CALL ZTIME(IDATE(KST),IUTC(KST),IYR,IMO,IDA,IHR,IMIN)
   4409       JDAT = 0
   4410       JDAT(1) = IYR
   4411       JDAT(2) = IMO
   4412       JDAT(3) = IDA
   4413       CALL W3DIFDAT(JDAT,LDAT,1,RINC)
   4414       JDY = NINT(RINC(1))
   4415       CALL FLDAY(JDY,IHR,IMIN,STMDAY(KST))
   4416       STMDAY(KST)=STMDAY(KST)+DAYOFF
   4417 
   4418 c && 4 comments
   4419 CC    WRITE(6,16) IDATE(KST),IUTC(KST),IYR,IMO,IDA,IHR,IMIN,JDY,
   4420 CC   1            STMDAY(KST)
   4421 CC 16 FORMAT('...STORM FIX TIMES ARE: IDATE,IUTC,IYR,IMO,IDA,IHR,',
   4422 CC   1       'IMIN,JDY,STMDAY',/,4X,8I8,F15.5)
   4423 
   4424       ENDDO
   4425 
   4426       CALL SORTRL(STMDAY(1:NSTM1),IDASRT(1:NSTM1),KSTORM)
   4427 
   4428 c && 2 comments
   4429 CC    WRITE(6,26) (STMDAY(KST),IDASRT(KST),KST=1,KSTORM)
   4430 CC 26 FORMAT(/'...SORTED STORM DAYS AND INDEX ARE:',/,(5X,F15.5,I6))
   4431 
   4432 C  PICK OUT TIMES AND LOCATIONS FROM SORTED LIST OF STORM DAYS
   4433 
   4434       NOMIN=.TRUE.
   4435       NOMAX=.TRUE.
   4436       EXTRPB=.FALSE.
   4437       EXTRPF=.FALSE.

Page 115         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4438       KSRTMN=-1
   4439       KSRTMX=-1
   4440 
   4441       KSRT = 0
   4442       DO KSRT0=1,KSTORM
   4443          KSRT = KSRT + 1
   4444 
   4445          IF(NINT(STMDAY(KSRT)*1000.) .GT. NINT(DAYMN0*1000.) .AND.
   4446      $    NOMIN)  THEN
   4447             NOMIN=.FALSE.
   4448             KSRTMN=KSRT-1
   4449          ENDIF
   4450 
   4451          IF(NINT(STMDAY(KSRT)*1000.) .GT. NINT(DAYMX0*1000.) .AND.
   4452      $    NOMAX)  THEN
   4453             NOMAX=.FALSE.
   4454             KSRTMX=KSRT
   4455          ENDIF
   4456 
   4457       ENDDO
   4458 
   4459       IF(KSRTMN .LE. 0)  THEN
   4460          IF(KSRTMN.EQ.-1)  THEN
   4461 
   4462 C  THERE IS ONLY ONE RECORD FOR THIS PARTICULAR STORM (IT MAY OR MAY
   4463 C   NOT BE EARLIER THAN THE WINDOW MINIMUM TIME).  THERE MAY BE AN
   4464 C   ERROR (UNLIKELY IF THIS CODE IS READING A TCVITALS FILE).
   4465 C   IRREGARDLESS, ALLOW EXTRAPOLATION OF THE OBSERVED MOTION BACK IN
   4466 C   TIME TO THE MINIMUM TIME ESTABLISHED BY THE TIME WINDOW.
   4467 
   4468             WRITE(6,241) KSTORM,KSRT,DAYMN0,(STMDAY(KST),KST=1,KSTORM)
   4469   241 FORMAT(/'######THERE IS ONLY ONE RECORD FOR THIS STORM (IT IS AT',
   4470      1       ' OR EARLIER THAN WINDOW MINIMUM).'/7X,'THERE MAY BE AN ',
   4471      2       'ERROR (UNLIKELY IF THIS CODE IS READING A TCVITALS FILE)',
   4472      3       ' - EXTRAPOLATE.'/7X,'KSTORM,KSRT,DAYMN0,STMDAY=',2I4,
   4473      4       F13.3,/,(5X,10F12.3))
   4474          ELSE
   4475 
   4476 C  WE HAVEN'T BEEN ABLE TO FIND A STMDAY EARLIER THAN THE MINIMUM TIME
   4477 C    ESTABLISHED BY THE TIME WINDOW FOR A PARTICULAR STORM.  EITHER
   4478 C    THIS IS THE FIRST (AND MAYBE ONLY) TIME THIS STORM HAS BEEN RUN OR
   4479 C    THERE MAY BE AN ERROR (UNLIKELY IF THIS CODE IS READING A TCVITALS
   4480 C    FILE).  IRREGARDLESS, ALLOW EXTRAPOLATION OF THE OBSERVED MOTION
   4481 C    BACK IN TIME TO THE MINIMUM TIME ESTABLISHED BY THE TIME WINDOW.
   4482 
   4483             WRITE(6,41) KSTORM,KSRT,DAYMN0,(STMDAY(KST),KST=1,KSTORM)
   4484    41 FORMAT(/'######CANNOT FIND ANY STORM RECORDS EARLIER THAN WINDOW',
   4485      1       ' MINIMUM.'/7X,'THIS IS THE FIRST (AND MAYBE ONLY) RECORD',
   4486      2       ' FOR THIS STORM OR THERE MAY BE AN ERROR (UNLIKELY IF'/7X,
   4487      3       'THIS CODE IS READING A TCVITALS FILE) - EXTRAPOLATE. ',
   4488      4       'KSTORM,KSRT,DAYMN0,STMDAY=',2I4,F13.3,/,(5X,10F12.3))
   4489          END IF
   4490          DT=STMDAY(1)-DAYMN0
   4491          IF(DT .LE. 0.333333)  THEN
   4492 
   4493 C  ... WE COME HERE IF THE EARLIEST STMDAY IS LESS THAN 8-HOURS LATER
   4494 C       THAN THE MINIMUM TIME ESTABLISHED BY THE TIME WINDOW.  IN THIS

Page 116         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4495 C       CASE WE SET AN ERROR FLAG.
   4496 c fixit?? - I (dak) don't see the significance of this
   4497 
   4498             WRITE(6,841)
   4499   841 FORMAT(/'######IN ADDITION TO ABOVE, EARLIEST STORM IS NO MORE ',
   4500      1       'THAN 8-HRS LATER THAN WINDOW MINIMUM.'/7X,'SET IERSET=41')
   4501             IERSET=41
   4502          ENDIF
   4503 
   4504          EXTRPB=.TRUE.
   4505          KSRTMN=0
   4506          ISRT=IDASRT(1)
   4507          IDASRT(KSRTMN)=0
   4508          STMDAY(KSRTMN)=DAYMN0
   4509          TRKDRZ(KSRTMN)=STMDIR(ISRT)
   4510          TRKSPZ(KSRTMN)=STMSPD(ISRT)
   4511          CALL DS2UV(USTM,VSTM,STMDIR(ISRT),STMSPD(ISRT))
   4512          TRKLTZ(KSRTMN)=STMLAT(ISRT)-VSTM*DT*FACSPD
   4513          TRKLNZ(KSRTMN)=STMLON(ISRT)-USTM*DT*FACSPD/
   4514      1    COSDEG_8(STMLAT(ISRT))
   4515          TRKRMX(KSRTMN)=RMAX(ISRT)
   4516          TRKPCN(KSRTMN)=PCEN(ISRT)
   4517          TRKPEN(KSRTMN)=PENV(ISRT)
   4518          TRKVMX(KSRTMN)=VMAX(ISRT)
   4519          TRKDPT(KSRTMN)=PTOP(ISRT)
   4520          WRITE(6,39) ISRT,KSRTMN,STMDAY(KSRTMN),TRKDRZ(KSRTMN),
   4521      1               TRKSPZ(KSRTMN),USTM,VSTM,DT,TRKLTZ(KSRTMN),
   4522      2               TRKLNZ(KSRTMN),STMLAT(ISRT),STMLON(ISRT)
   4523    39 FORMAT(/'...EXTRAPOLATING FIX BACKWARDS IN TIME: ISRT,KSRTMN,',
   4524      1       '(STMDAY,TRKDRZ,TRKSPZ(KSRTMN)),USTM,VSTM,DT,',/,41X,
   4525      2       '(TRKLTZ,TRKLNZ(KSRTMN)),(STMLAT,STMLON(ISRT))=',/,
   4526      3       40X,2I3,6F12.3,/,43X,4F12.3)
   4527       ENDIF
   4528 
   4529       IF(KSRTMX .LE. 0)  THEN
   4530 
   4531 C  WE HAVEN'T BEEN ABLE TO FIND A STMDAY LATER THAN THE MAXIMUM TIME
   4532 C    ESTABLISHED BY THE TIME WINDOW FOR A PARTICULAR STORM.  EITHER
   4533 C    THIS IS THE LAST (AND MAYBE ONLY) RECORD FOR THIS STORM OR THERE
   4534 C    MAY BE AN ERROR (UNLIKELY IF THIS CODE IS READING A TCVITALS
   4535 C    FILE).  IRREGARDLESS, ALLOW EXTRAPOLATION OF THE OBSERVED MOTION
   4536 C    AHEAD IN TIME TO THE MAXIMUM TIME ESTABLISHED BY THE TIME WINDOW.
   4537 
   4538          WRITE(6,51) KSTORM,KSRT,DAYMX0,(STMDAY(KST),KST=1,KSTORM)
   4539    51 FORMAT(/'######CANNOT FIND ANY STORM RECORDS LATER THAN WINDOW ',
   4540      1       'MAXIMUM.'/7X,'THIS IS THE LAST (AND MAYBE ONLY) RECORD ',
   4541      2       'FOR THIS STORM OR THERE MAY BE AN ERROR (UNLIKELY IF ',
   4542      3       'THIS CODE IS READING'/7X,'A TCVITALS FILE) - ',
   4543      4       'EXTRAPOLATE. KSTORM,KSRT,DAYMX0,STMDAY=',2I4,F13.3,/,
   4544      5       (5X,10F12.3))
   4545          DT=DAYMX0-STMDAY(KSTORM)
   4546          IF(DT .LE. 0.333333)  THEN
   4547 
   4548 C  ... WE COME HERE IF THE LATEST STMDAY IS LESS THAN 8-HOURS EARLIER
   4549 C       THAN THE MAXIMUM TIME ESTABLISHED BY THE TIME WINDOW.  IN THIS
   4550 C       CASE WE SET AN ERROR FLAG.
   4551 c fixit?? - I (dak) don't see the significance of this

Page 117         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4552 
   4553             WRITE(6,851)
   4554   851 FORMAT(/'######IN ADDITION TO ABOVE, LATEST STORM IS NO MORE ',
   4555      1       'THAN 8-HRS EARLIER THAN WINDOW MAXIMUM.'/7X,'SET ',
   4556      2       'IERSET=51')
   4557             IERSET=51
   4558          ENDIF
   4559 
   4560          EXTRPF=.TRUE.
   4561          KSRTMX=KSTORM+1
   4562          ISRT=IDASRT(KSTORM)
   4563          IDASRT(KSRTMX)=KSTORM+1
   4564          STMDAY(KSRTMX)=DAYMX0
   4565          TRKDRZ(KSRTMX)=STMDIR(ISRT)
   4566          TRKSPZ(KSRTMX)=STMSPD(ISRT)
   4567          CALL DS2UV(USTM,VSTM,TRKDRZ(ISRT),TRKSPZ(ISRT))
   4568          TRKLTZ(KSRTMX)=STMLAT(ISRT)+VSTM*DT*FACSPD
   4569          TRKLNZ(KSRTMX)=STMLON(ISRT)+USTM*DT*FACSPD/
   4570      1    COSDEG_8(STMLAT(ISRT))
   4571          TRKRMX(KSRTMX)=RMAX(ISRT)
   4572          TRKPCN(KSRTMX)=PCEN(ISRT)
   4573          TRKPEN(KSRTMX)=PENV(ISRT)
   4574          TRKVMX(KSRTMX)=VMAX(ISRT)
   4575          TRKDPT(KSRTMX)=PTOP(ISRT)
   4576          WRITE(6,49) ISRT,STMDAY(KSRTMX),TRKDRZ(KSRTMX),TRKSPZ(KSRTMX),
   4577      1               USTM,VSTM,DT,TRKLTZ(KSRTMX),TRKLNZ(KSRTMX),
   4578      2               STMLAT(ISRT),STMLON(ISRT)
   4579    49 FORMAT(/'...EXTRAPOLATING FIX FORWARDS IN TIME: ISRT,',
   4580      1       '(STMDAY,TRKDIR,TRKSPD(KSRTMX)),USTM,VSTM,DT,',/,41X,
   4581      2       '(TRKLTZ,TRKLNZ(KSRTMX)),(STMLAT,STMLON(ISRT))=',/,
   4582      3       40X,I3,6F12.3,/,43X,4F12.3)
   4583 
   4584       ENDIF
   4585 
   4586       KK=1
   4587       KST0=-1
   4588       TIMMIN=1.E10
   4589 
   4590 C  PUT ALL FIXES THAT DEFINE THE TIME WINDOW INTO ARRAYS SORTED BY TIME.
   4591 C    FIRST, ELIMINATE RECORDS WITH DUPLICATE TIMES.  OUR ARBITRARY
   4592 C    CONVENTION IS TO KEEP THE LATEST RECORD.  ANY FIX TIME WITHIN 5
   4593 C    MINUTES OF ITS PREDECESSOR IN THE SORTED LIST IS CONSIDERED
   4594 C    DUPLICATE.
   4595 
   4596       DO KST=KSRTMN,KSRTMX
   4597       IF(KST .GT. KSRTMN)  THEN
   4598         IF(STMDAY(KST)-SRTDAY(KK) .LT. FIVMIN) THEN
   4599         WRITE(6,53) KST,KK,STMDAY(KST),SRTDAY(KK)
   4600    53   FORMAT(/'...TIME SORTED FIX RECORDS SHOW A DUPLICATE, KST,KK,',
   4601      1         'STMDAY(KST),SRTDAY(KK)=',2I5,2F12.3)
   4602         ELSE
   4603         KK=KK+1
   4604         ENDIF
   4605       ENDIF
   4606 
   4607 C  STORE SORTED LAT/LON, DIRECTION, SPEED FOR FUTURE USE.
   4608 

Page 118         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4609       SRTLAT(KK)=TRKLTZ(IDASRT(KST))
   4610       SRTLON(KK)=TRKLNZ(IDASRT(KST))
   4611       SRTDIR(KK)=TRKDRZ(IDASRT(KST))
   4612       SRTSPD(KK)=TRKSPZ(IDASRT(KST))
   4613       SRTDAY(KK)=STMDAY(KST)
   4614       SRTRMX(KK)=TRKRMX(IDASRT(KST))
   4615       SRTPCN(KK)=TRKPCN(IDASRT(KST))
   4616       SRTPEN(KK)=TRKPEN(IDASRT(KST))
   4617       SRTVMX(KK)=TRKVMX(IDASRT(KST))
   4618       SRTDPT(KK)=TRKDPT(IDASRT(KST))
   4619 c fixit?? - to avoid subscript zero warning on next two lines, I did
   4620 c           the following ....
   4621 cdak  ISRTDA(KK)=IDATE(IDASRT(KST))
   4622 cdak  ISRTUT(KK)=IUTC (IDASRT(KST))
   4623       if(IDASRT(KST).ne.0)  then
   4624          ISRTDA(KK)=IDATE(IDASRT(KST))
   4625          ISRTUT(KK)=IUTC (IDASRT(KST))
   4626       else
   4627          ISRTDA(KK)=0
   4628          ISRTUT(KK)=0
   4629       end if
   4630       IF(ABS(SRTDAY(KK)-DAY00) .LT. TIMMIN)  THEN
   4631       IF(ABS(SRTDAY(KK)-DAY00) .LT. FIVMIN)  KST0=KK
   4632       KSTZ=KK
   4633       TIMMIN=ABS(SRTDAY(KK)-DAY00)
   4634       ENDIF
   4635       ENDDO
   4636 
   4637       KSTMX=KK
   4638 
   4639 C  ZERO OUT EXTRAPOLATED DATE AND TIME AS A REMINDER
   4640 
   4641       IF(EXTRPF)  THEN
   4642       ISRTDA(KSTMX)=0
   4643       ISRTUT(KSTMX)=0
   4644       ENDIF
   4645 
   4646       IF(EXTRPB)  THEN
   4647       ISRTDA(1)=0
   4648       ISRTUT(1)=0
   4649       ENDIF
   4650 
   4651       IF(KSTZ .EQ. KSTMX .AND. .NOT. (EXTRPB .OR. EXTRPF))  THEN
   4652       WRITE(6,61) KSTZ,KSTMX,(SRTDAY(KST),KST=1,KSTMX)
   4653    61 FORMAT(/'******THE REFERENCE STORM INDEX IS THE MAXIMUM ALLOWED',
   4654      1       ' A PROBABLE ERROR HAS OCCURRED',/,8X,
   4655      2       'KSTZ,KSTMX,SRTDAY=',2I5,/,(5X,10F12.3))
   4656       CALL ABRT1(' SETTRK',61)
   4657       ENDIF
   4658 
   4659       IF(KST0 .LE. 0)  THEN
   4660       WRITE(6,72) DAY00,KST0,(SRTDAY(KST),KST=1,KSTMX)
   4661    72 FORMAT(/'******THERE IS NO FIX AT THE ANALYSIS TIME, AN',
   4662      1       ' INTERPOLATED POSITION WILL BE CALCULATED',/,5X,
   4663      2       'DAY00,KST0,SRTDAY=',F12.3,I6,/,(5X,10F12.3))
   4664         IF(DAY00-SRTDAY(KSTZ) .GT. 0.0)  THEN
   4665         RATIO=(DAY00-SRTDAY(KSTZ))/(SRTDAY(KSTZ+1)-SRTDAY(KSTZ))

Page 119         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4666         STLAT0=SRTLAT(KSTZ)+(SRTLAT(KSTZ+1)-SRTLAT(KSTZ))*RATIO
   4667         STLON0=SRTLON(KSTZ)+(SRTLON(KSTZ+1)-SRTLON(KSTZ))*RATIO
   4668         STMDR0=SRTDIR(KSTZ)+(SRTDIR(KSTZ+1)-SRTDIR(KSTZ))*RATIO
   4669         STMSP0=SRTSPD(KSTZ)+(SRTSPD(KSTZ+1)-SRTSPD(KSTZ))*RATIO
   4670         STDAY0=DAY00
   4671         ELSE
   4672         RATIO=(DAY00-SRTDAY(KSTZ-1))/(SRTDAY(KSTZ)-SRTDAY(KSTZ-1))
   4673         STLAT0=SRTLAT(KSTZ-1)+(SRTLAT(KSTZ)-SRTLAT(KSTZ-1))*RATIO
   4674         STLON0=SRTLON(KSTZ-1)+(SRTLON(KSTZ)-SRTLON(KSTZ-1))*RATIO
   4675         STMDR0=SRTDIR(KSTZ-1)+(SRTDIR(KSTZ)-SRTDIR(KSTZ-1))*RATIO
   4676         STMSP0=SRTSPD(KSTZ-1)+(SRTSPD(KSTZ)-SRTSPD(KSTZ-1))*RATIO
   4677         STDAY0=DAY00
   4678         ENDIF
   4679 
   4680       ELSE
   4681       STLAT0=SRTLAT(KST0)
   4682       STLON0=SRTLON(KST0)
   4683       STMDR0=SRTDIR(KST0)
   4684       STMSP0=SRTSPD(KST0)
   4685       STDAY0=SRTDAY(KST0)
   4686       ENDIF
   4687 
   4688       WRITE(6,77) (KSRT,ISRTDA(KSRT),ISRTUT(KSRT),SRTDAY(KSRT),
   4689      1             SRTLAT(KSRT),SRTLON(KSRT),
   4690      2             SRTDIR(KSRT),SRTSPD(KSRT),
   4691      3             SRTPCN(KSRT),SRTPEN(KSRT),SRTRMX(KSRT),
   4692      4             SRTVMX(KSRT),SRTDPT(KSRT),KSRT=1,KSTMX)
   4693    77 FORMAT(/'...FINAL SORTED LIST IS:'/6X,'YYYYMMDD',2X,'HHMM',6X,
   4694      1       'RJDAY',9X,'LAT',9X,'LON',8X,'DIR',9X,'SPEED',7X,'PCEN',8X,
   4695      2       'PENV',8X,'RMAX',5X,'VMAX',4X,'PTOP'
   4696      3       /(1X,I3,2X,I8,2X,I4,8F12.2,2(3X,F5.1)))
   4697 
   4698       WRITE(6,79) STDAY0,STLAT0,STLON0,STMDR0,STMSP0
   4699    79 FORMAT(/'...THE REFERENCE TIME, LATITUDE, LONGITUDE,',
   4700      1       ' DIRECTION AND SPEED ARE:',5F12.3)
   4701 
   4702       WRITE(6,89)
   4703    89 FORMAT(/'...END SETTRK')
   4704 
   4705       RETURN
   4706 
   4707 C-----------------------------------------------------------------------
   4708 
   4709       ENTRY STMADJ(RLON,RLAT,DAYZ)
   4710 
   4711 C  INPUT ARG. DAYZ    - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS
   4712 C                       PRIOR TO 00Z ON NCEP DATE
   4713 
   4714 c && 2 comments
   4715 CC    WRITE(6,101) RLAT,RLON,DAYZ
   4716 CC101 FORMAT(/'...ENTERING STMADJ,    RLAT,RLON,DAYZ=',2F12.2,F12.3)
   4717 
   4718       DO 110 KST=1,KSTMX-1
   4719       KSTZ=KST
   4720       IF(DAYZ .GE. SRTDAY(KST) .AND. DAYZ .LE. SRTDAY(KST+1))  GO TO 120
   4721   110 CONTINUE
   4722       WRITE(6,111) KSTMX,DAYZ,(SRTDAY(KS),KS=1,KSTMX)

Page 120         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4723   111 FORMAT(/'******CANNOT FIND FIX BRACKET IN STMADJ, KSTMX,DAYZ,',
   4724      1       'SRTDAY=',I5,F12.3,/,(5X,10F12.3))
   4725       CALL ABRT1(' STMADJ',111)
   4726 
   4727   120 DTFIX=SRTDAY(KSTZ+1)-SRTDAY(KSTZ)
   4728       DTOB =DAYZ-SRTDAY(KSTZ)
   4729       RATIO=DTOB/DTFIX
   4730 c && 2 comments
   4731 CC    WRITE(6,121) KSTZ,SRTDAY(KSTZ),SRTDAY(KSTZ+1),RATIO
   4732 CC121 FORMAT(/'...KSTZ,SRTDAY(KSTZ),SRTDAY(KSTZ+1),RATIO=',I5,3F12.3)
   4733 
   4734       RLATOB=SRTLAT(KSTZ)+(SRTLAT(KSTZ+1)-SRTLAT(KSTZ))*RATIO
   4735       RLONOB=SRTLON(KSTZ)+(SRTLON(KSTZ+1)-SRTLON(KSTZ))*RATIO
   4736       RLATOF=STLAT0-RLATOB
   4737       RLONOF=STLON0-RLONOB
   4738 c && 5 comments
   4739 CC    WRITE(6,123) SRTLAT(KSTZ),SRTLAT(KSTZ+1),SRTLON(KSTZ),
   4740 CC   1             SRTLON(KSTZ+1),RLATOB,RLONOB,RLATOF,RLONOF
   4741 CC123 FORMAT(/'... SRTLAT(KSTZ),SRTLAT(KSTZ+1),SRTLON(KSTZ),',
   4742 CC   1       'SRTLON(KSTZ+1),RLATOB,RLONOB,RLATOF,RLONOF=',/,
   4743 CC   2       5X,8F12.3)
   4744 
   4745       RLAT=(NINT((RLAT+RLATOF)*100.))/100.
   4746       RLON=(NINT((RLON+RLONOF)*100.))/100.
   4747       DAYZ=STDAY0
   4748 c && 2 comments
   4749 CC    WRITE(6,131)  RLAT,RLON,DAYZ
   4750 CC131 FORMAT('...LEAVING STMADJ, NEW RLAT,RLON,DAYZ=',2F12.2,F12.3)
   4751       RETURN
   4752 
   4753 C-----------------------------------------------------------------------
   4754 
   4755       ENTRY STMCOR(RLAT,RLON,IHOWFR,ANGLE)
   4756 
   4757       DSTNCE=DISTSP_8(RLAT,RLON,STLAT0,STLON0)
   4758 
   4759 C  SINCE RLAT AND RLON HERE ARE ONLY PRECISE TO NEAREST 100'TH DEG,
   4760 C   DSTNCE HERE IS ROUNDED TO NEAREST 10 METERS AND CALLED IHOWFR (M)
   4761 C   (NOTE: PREVIOUSLY, "IHOWFR" WAS "HOWFAR" WHICH WAS A FLOATING
   4762 C          POINT NUMBER CALC. TO FRACTIONAL METERS - THIS WAS
   4763 C          DIFFERENT BY TENS OF METERS IBM VS. CRAY)
   4764 
   4765       IHOWFR = (NINT(DSTNCE/10.)) * 10
   4766       ANGLE= ATAN2DEG(RLON-STLON0,RLAT-STLAT0)
   4767       IF(ANGLE .LT. 0.0) ANGLE=360.+ANGLE
   4768 c && 3 comments
   4769 CC    WRITE(6,141) RLAT,RLON,STLAT0,STLON0,REAL(IHOWFR),ANGLE
   4770 CC141 FORMAT('...IN STMCOR, RLAT,RLON,STLAT0,STLON0,DSTNCE(KM),',
   4771 CC   1       'ANGLE=',/,12X,4F12.2,-3P,F12.3,0P,F12.3)
   4772       RETURN
   4773 
   4774 C-----------------------------------------------------------------------
   4775 
   4776       ENTRY FSTOCR(IOVITL,IOPTZ,IDATTK,IUTCTK,STMNTK,IFSTZ,IERSET,
   4777      1             FSTFGZ,QCFILE)
   4778 
   4779 C  TESTING THE FIRST OCCURRENCE OF A PARTICULAR STORM IS DONE IN ONE OF

Page 121         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4780 C    TWO WAYS:
   4781 
   4782 C    1)  FOR A QUALITY CONTROLLED FILE, A FIRST OCCURRENCE FLAG IS
   4783 C         PRESENT AS A COLON IN COLUMN 19 AND THE VARIABLE FSTFLG IS
   4784 C         SET TRUE OR FALSE ACCORDINGLY.  IN THIS CASE, THIS ROUTINE
   4785 C         JUST TRANSLATES THIS FLAG INTO AN INTEGER.
   4786 
   4787 C    2)  FOR A FILE THAT HAS NOT BEEN QUALITY CONTROLLED, E.G. A
   4788 C         RESEARCH FILE OR OLD HISTORICAL FILE, THE FLAG IS NOT PRESENT
   4789 C         AND WE MUST SEARCH FOR PREVIOUS OCCURRENCES OF THAT PARTICULAR
   4790 C         STORM.
   4791 
   4792 C  OPTION 1: A QUALITY-CONTROLLED FILE
   4793 
   4794       IF(QCFILE)  THEN
   4795 
   4796       IF(FIRST)  WRITE(6,201) QCFILE
   4797   201 FORMAT(/'...ENTERING FSTOCR WITH QCFILE=',L2,' LOGICAL ',
   4798      1       'OCCURRENCE FLAGS WILL BE TRANSFORMED INTO INTEGERS.')
   4799 
   4800       IFSTZ=2
   4801       IF(FSTFGZ) IFSTZ=1
   4802 
   4803 C  OPTION 2: NOT A QUALITY-CONTROLLED FILE
   4804 
   4805       ELSE
   4806       IOPT=IOPTZ
   4807       IDTREQ=IDATTK
   4808       IF(IOPT .EQ. 5)  THEN
   4809       STMID (1)=STMNTK(1:3)
   4810       ELSE IF(IOPT .EQ. 6)  THEN
   4811       STMNAM(1)=STMNTK(1:9)
   4812       ELSE
   4813       WRITE(6,203) IOPT
   4814   203 FORMAT(/'******ILLEGAL OPTION IN FSTOCR=',I4)
   4815       IERSET=1
   4816       RETURN
   4817       ENDIF
   4818 
   4819       IF(FIRST)  WRITE(6,207) QCFILE,IOPT,STMNTK,IDATTK,IUTCTK
   4820   207 FORMAT(/'...ENTERING FSTOCR WITH QCFILE=',L2,' AND IOPT=',I2,
   4821      1       '. LOOKING FOR ALL FIXES FOR ',A,' TO COMPARE WITH DATE=',
   4822      2       I9,' & UTC=',I5)
   4823 
   4824       CALL NEWVIT(IOVITL,IPRNT,IOPT,IERVIT,MAXSTM,KSTORM,IDTREQ,IHRREQ,
   4825      1            IHRWIN,IDATE,IUTC,STMLAT,STMLON,STMDIR,STMSPD,PCEN,
   4826      2            PENV,RMAX,VMAX,RMW,R15NE,R15SE,R15SW,R15NW,PTOP,
   4827      3            FSTFLG,STMNAM,STMID,RSMC)
   4828 
   4829 C  LOOK FOR THE MINIMUM FIX TIME
   4830 C A value of IDAFST > 2149mmddhh exceeds the 32-bit limit!!
   4831 
   4832       IDAFST_8=9999999999_8
   4833       DO KST=1,KSTORM
   4834          ICHECK   = IDATE(KST)*100+IUTC(KST)/100
   4835          ICHECK_8 = ICHECK
   4836          IDAFST_8 = MIN(ICHECK_8,IDAFST_8)

Page 122         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4837          IDAFST   = IDAFST_8
   4838       ENDDO
   4839       WRITE(6,221) IDAFST,IDATTK,IUTCTK
   4840   221 FORMAT(/'...FIRST FIX IS AT YYYYMMDDHH=',I12,'. COMPARING WITH ',
   4841      1       'IDATE,IUTC=',I9,I5)
   4842 
   4843       IF(IDAFST .EQ. IDATTK*100+IUTCTK/100) THEN
   4844       IFSTZ=1
   4845 
   4846       ELSE
   4847       IFSTZ=2
   4848       ENDIF
   4849 
   4850       ENDIF
   4851 
   4852       FIRST=.FALSE.
   4853       IF(IFSTZ .EQ. 1)  WRITE(6,231) STMNTK
   4854   231 FORMAT('...THIS TIME IS THE FIRST OCCURRENCE OF STORM=',A)
   4855       IF(IFSTZ .GE. 2)  WRITE(6,233) STMNTK
   4856   233 FORMAT('...THIS STORM=',A,' HAS HAD PREVIOUS OCCURRENCES.')
   4857 
   4858       RETURN
   4859       END


ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 fstocr_               settrk_               stmadj_               stmcor_               trksub_             

Page 123         Source Listing                  TRKSUB
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  4390                                                           4389                              
 110                        Label  4721                                                           4718                              
 111                        Label  4723                                                           4722                              
 120                        Label  4727                                                           4720                              
 201                        Label  4797                                                           4796                              
 203                        Label  4814                                                           4813                              
 207                        Label  4820                                                           4819                              
 221                        Label  4840                                                           4839                              
 231                        Label  4854                                                           4853                              
 233                        Label  4856                                                           4855                              
 241                        Label  4469                                                           4468                              
 39                         Label  4523                                                           4520                              
 41                         Label  4484                                                           4483                              
 49                         Label  4579                                                           4576                              
 51                         Label  4539                                                           4538                              
 53                         Label  4600                                                           4599                              
 6                          Label  4396                                                           4395                              
 61                         Label  4653                                                           4652                              
 72                         Label  4661                                                           4660                              
 77                         Label  4693                                                           4688                              
 79                         Label  4699                                                           4698                              
 841                        Label  4499                                                           4498                              
 851                        Label  4554                                                           4553                              
 89                         Label  4703                                                           4702                              
 ABRT1                      Subr   4656                                                           4656,4725                         
 ABS                        Func   4630                                 scalar                    4630,4631,4633                    
 ANGLE                      Dummy  4316     R(4)            4           scalar   ARG,INOUT        4766,4767                         
 ATAN2DEG                   Func   4766     R(4)            4           scalar                    4766                              
 BDATE                      Common 4357                                 32       SAVE                                               
 COSDEG_8                   Func   4327     R(8)            8           scalar                    4514,4570                         
 DAY00                      Dummy  4314     R(4)            4           scalar   ARG,INOUT        4395,4630,4631,4633,4660,4664,4665
                                                                                                  ,4670,4672,4677                   
 DAYMN0                     Dummy  4314     R(4)            4           scalar   ARG,INOUT        4395,4445,4468,4483,4490,4508     
 DAYMX0                     Dummy  4314     R(4)            4           scalar   ARG,INOUT        4395,4451,4538,4545,4564          
 DAYOFF                     Dummy  4314     R(4)            4           scalar   ARG,INOUT        4416                              
 DAYZ                       Dummy  4316     R(4)            4           scalar   ARG,INOUT        4720,4722,4728,4747               
 DEEP                       Local  4346     CHAR            1           scalar   SAVE             4365                              
 DISTSP_8                   Func   4327     R(8)            8           scalar                    4757                              
 DS2UV                      Subr   4511                                                           4511,4567                         
 DSTNCE                     Local  4757     R(4)            4           scalar   SAVE             4757,4765                         
 DT                         Local  4490     R(4)            4           scalar   SAVE             4490,4491,4512,4513,4521,4545,4546
                                                                                                  ,4568,4569,4577                   
 DTFIX                      Local  4727     R(4)            4           scalar   SAVE             4727,4729                         
 DTOB                       Local  4728     R(4)            4           scalar   SAVE             4728,4729                         
 EXE                        Local  4346     CHAR            1           scalar   SAVE             4365                              
 EXTRPB                     Local  4320     L(4)            4           scalar   SAVE             4436,4504,4646,4651               
 EXTRPF                     Local  4320     L(4)            4           scalar   SAVE             4437,4560,4641,4651               
 FACSPD                     Local  4374     R(4)            4           scalar   SAVE             4374,4512,4513,4568,4569          
 FIRST                      Local  4320     L(4)            4           scalar   SAVE             4374,4796,4819,4852               
 FIVMIN                     Local  4374     R(4)            4           scalar   SAVE             4374,4598,4631                    
 FLDAY                      Subr   4415                                                           4415                              

Page 124         Source Listing                  TRKSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FSTFGZ                     Dummy  4315     L(4)            4           scalar   ARG,INOUT        4801                              
 FSTFLG                     Local  4333     L(4)            4     1     70       SAVE             4403,4827                         
 FSTOCR                     Subr   4776                                                                                             
 ICHECK                     Local  4834     I(4)            4           scalar   SAVE             4834,4835                         
 ICHECK_8                   Local  4329     I(8)            8           scalar   SAVE             4835,4836                         
 IDA                        Local  4408     I(4)            4           scalar   SAVE             4408,4412                         
 IDAFST                     Local  4837     I(4)            4           scalar   SAVE             4837,4839,4843                    
 IDAFST_8                   Local  4329     I(8)            8           scalar   SAVE             4832,4836,4837                    
 IDASRT                     Local  4352     I(4)            4     1     72       SAVE             4426,4506,4507,4562,4563,4609,4610
                                                                                                  ,4611,4612,4614,4615,4616,4617,461
                                                                                                  8,4623,4624,4625                  
 IDATE                      Local  4336     I(4)            4     1     70       SAVE             4401,4408,4624,4825,4834          
 IDATTK                     Dummy  4314     I(4)            4           scalar   ARG,INOUT        4383,4807,4819,4839,4843          
 IDTREQ                     Local  4383     I(4)            4           scalar   SAVE             4383,4395,4400,4807,4824          
 IERSET                     Dummy  4315     I(4)            4           scalar   ARG,INOUT        4381,4391,4501,4557,4815          
 IERVIT                     Local  4400     I(4)            4           scalar   SAVE             4400,4824                         
 IFSTZ                      Dummy  4315     I(4)            4           scalar   ARG,INOUT        4800,4801,4844,4847,4853,4855     
 IHOWFR                     Dummy  4316     I(4)            4           scalar   ARG,INOUT        4765                              
 IHR                        Local  4408     I(4)            4           scalar   SAVE             4408,4415                         
 IHRREQ                     Dummy  4379     I(4)            4           scalar   ARG,INOUT        4395,4400,4824                    
 IHRWIN                     Local  4401     I(4)            4           scalar   SAVE             4401,4825                         
 IMIN                       Local  4408     I(4)            4           scalar   SAVE             4408,4415                         
 IMO                        Local  4408     I(4)            4           scalar   SAVE             4408,4411                         
 IOPT                       Local  4382     I(4)            4           scalar   SAVE             4382,4384,4386,4389,4395,4400,4806
                                                                                                  ,4808,4810,4813,4819,4824         
 IOPTZ                      Dummy  4314     I(4)            4           scalar   ARG,INOUT        4382,4806                         
 IOVITL                     Dummy  4314     I(4)            4           scalar   ARG,INOUT        4400,4824                         
 IPRNT                      Local  4374     I(4)            4           scalar   SAVE             4374,4400,4824                    
 ISRT                       Local  4506     I(4)            4           scalar   SAVE             4506,4509,4510,4511,4512,4513,4514
                                                                                                  ,4515,4516,4517,4518,4519,4520,452
                                                                                                  2,4562,4565,4566,4567,4568,4569,45
                                                                                                  70,4571,4572,4573,4574,4575,4576,4
                                                                                                  578                               
 ISRTDA                     Local  4354     I(4)            4     1     70       SAVE             4624,4627,4642,4647,4688          
 ISRTUT                     Local  4354     I(4)            4     1     70       SAVE             4625,4628,4643,4648,4688          
 IUTC                       Local  4337     I(4)            4     1     70       SAVE             4401,4408,4625,4825,4834          
 IUTCTK                     Dummy  4315     I(4)            4           scalar   ARG,INOUT        4819,4839,4843                    
 IYR                        Local  4408     I(4)            4           scalar   SAVE             4408,4410                         
 JDAT                       Local  4325     I(4)            4     1     8        SAVE             4409,4410,4411,4412,4413          
 JDY                        Local  4414     I(4)            4           scalar   SAVE             4414,4415                         
 KK                         Local  4586     I(4)            4           scalar   SAVE             4586,4598,4599,4603,4609,4610,4611
                                                                                                  ,4612,4613,4614,4615,4616,4617,461
                                                                                                  8,4624,4625,4627,4628,4630,4631,46
                                                                                                  32,4633,4637                      
 KS                         Local  4722     I(4)            4           scalar   SAVE             4722                              
 KSRT                       Local  4441     I(4)            4           scalar   SAVE             4441,4443,4445,4448,4451,4454,4468
                                                                                                  ,4483,4538,4688,4689,4690,4691,469
                                                                                                  2                                 
 KSRT0                      Local  4442     I(4)            4           scalar   SAVE             4442                              
 KSRTMN                     Local  4438     I(4)            4           scalar   SAVE             4438,4448,4459,4460,4505,4507,4508
                                                                                                  ,4509,4510,4512,4513,4515,4516,451
                                                                                                  7,4518,4519,4520,4521,4522,4596,45
                                                                                                  97                                
 KSRTMX                     Local  4439     I(4)            4           scalar   SAVE             4439,4454,4529,4561,4563,4564,4565
                                                                                                  ,4566,4568,4569,4571,4572,4573,457

Page 125         Source Listing                  TRKSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  4,4575,4576,4577,4596             
 KST                        Local  4407     I(4)            4           scalar   SAVE             4407,4408,4415,4416,4468,4483,4538
                                                                                                  ,4596,4597,4598,4599,4609,4610,461
                                                                                                  1,4612,4613,4614,4615,4616,4617,46
                                                                                                  18,4623,4624,4625,4652,4660,4718,4
                                                                                                  719,4720,4833,4834                
 KST0                       Local  4587     I(4)            4           scalar   SAVE             4587,4631,4659,4660,4681,4682,4683
                                                                                                  ,4684,4685                        
 KSTMX                      Local  4637     I(4)            4           scalar   SAVE             4637,4642,4643,4651,4652,4660,4692
                                                                                                  ,4718,4722                        
 KSTORM                     Local  4400     I(4)            4           scalar   SAVE             4400,4407,4426,4442,4468,4483,4538
                                                                                                  ,4545,4561,4562,4563,4824,4833    
 KSTZ                       Local  4632     I(4)            4           scalar   SAVE             4632,4651,4652,4664,4665,4666,4667
                                                                                                  ,4668,4669,4672,4673,4674,4675,467
                                                                                                  6,4719,4727,4728,4734,4735        
 LDAT                       Scalar 4357     I(4)            4     1     8        COM              4413                              
 MAXSTM                     Param  4318     I(4)            4           scalar                    4335,4336,4337,4338,4339,4340,4400
                                                                                                  ,4824                             
 MAXTPC                     Param  4342     I(4)            4           scalar                    4344                              
 MEDIUM                     Local  4346     CHAR            1           scalar   SAVE             4365                              
 MIN                        Func   4836                                 scalar                    4836                              
 NEWVIT                     Subr   4400                                                           4400,4824                         
 NINT                       Func   4414                                 scalar                    4414,4445,4451,4745,4746,4765     
 NOMAX                      Local  4320     L(4)            4           scalar   SAVE             4435,4452,4453                    
 NOMIN                      Local  4320     L(4)            4           scalar   SAVE             4434,4446,4447                    
 NSTM                       Param  4318     I(4)            4           scalar                    4318,4352,4353,4354,4355          
 NSTM1                      Param  4318     I(4)            4           scalar                    4348,4349,4350,4352,4426          
 PCEN                       Local  4337     R(4)            4     1     70       SAVE             4401,4516,4572,4825               
 PENV                       Local  4337     R(4)            4     1     70       SAVE             4402,4517,4573,4826               
 PTOP                       Local  4338     R(4)            4     1     70       SAVE             4402,4519,4575,4826               
 QCFILE                     Dummy  4315     L(4)            4           scalar   ARG,INOUT        4794,4796,4819                    
 R15NE                      Local  4339     R(4)            4     1     70       SAVE             4402,4826                         
 R15NW                      Local  4339     R(4)            4     1     70       SAVE             4402,4826                         
 R15SE                      Local  4339     R(4)            4     1     70       SAVE             4402,4826                         
 R15SW                      Local  4339     R(4)            4     1     70       SAVE             4402,4826                         
 RATIO                      Local  4665     R(4)            4           scalar   SAVE             4665,4666,4667,4668,4669,4672,4673
                                                                                                  ,4674,4675,4676,4729,4734,4735    
 RINC                       Local  4325     R(4)            4     1     5        SAVE             4413,4414                         
 RLAT                       Dummy  4316     R(4)            4           scalar   ARG,INOUT        4745,4757,4766                    
 RLATOB                     Local  4734     R(4)            4           scalar   SAVE             4734,4736                         
 RLATOF                     Local  4736     R(4)            4           scalar   SAVE             4736,4745                         
 RLON                       Dummy  4316     R(4)            4           scalar   ARG,INOUT        4746,4757,4766                    
 RLONOB                     Local  4735     R(4)            4           scalar   SAVE             4735,4737                         
 RLONOF                     Local  4737     R(4)            4           scalar   SAVE             4737,4746                         
 RMAX                       Local  4337     R(4)            4     1     70       SAVE             4402,4515,4571,4826               
 RMW                        Local  4338     R(4)            4     1     70       SAVE             4402,4826                         
 RSMC                       Local  4331     CHAR            4     1     70       SAVE             4403,4827                         
 SETTRK                     Subr   4378                                                                                             
 SHALO                      Local  4346     CHAR            1           scalar   SAVE             4365                              
 SORTRL                     Subr   4426                                                           4426                              
 SRTDAY                     Local  4352     R(4)            4     1     70       SAVE             4598,4599,4613,4630,4631,4633,4652
                                                                                                  ,4660,4664,4665,4672,4685,4688,472
                                                                                                  0,4722,4727,4728                  
 SRTDIR                     Local  4353     R(4)            4     1     70       SAVE             4611,4668,4675,4683,4690          
 SRTDPT                     Local  4355     R(4)            4     1     70       SAVE             4618,4692                         

Page 126         Source Listing                  TRKSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SRTLAT                     Local  4353     R(4)            4     1     70       SAVE             4609,4666,4673,4681,4689,4734     
 SRTLON                     Local  4353     R(4)            4     1     70       SAVE             4610,4667,4674,4682,4689,4735     
 SRTPCN                     Local  4354     R(4)            4     1     70       SAVE             4615,4691                         
 SRTPEN                     Local  4355     R(4)            4     1     70       SAVE             4616,4691                         
 SRTRMX                     Local  4354     R(4)            4     1     70       SAVE             4614,4691                         
 SRTSPD                     Local  4353     R(4)            4     1     70       SAVE             4612,4669,4676,4684,4690          
 SRTVMX                     Local  4355     R(4)            4     1     70       SAVE             4617,4692                         
 STDAY0                     Local  4670     R(4)            4           scalar   SAVE             4670,4677,4685,4698,4747          
 STLAT0                     Local  4666     R(4)            4           scalar   SAVE             4666,4673,4681,4698,4736,4757,4766
 STLON0                     Local  4667     R(4)            4           scalar   SAVE             4667,4674,4682,4698,4737,4757,4766
 STMADJ                     Subr   4709                                                                                             
 STMCOR                     Subr   4755                                                                                             
 STMDAY                     Local  4352     R(4)            4     1     72       SAVE             4415,4416,4426,4445,4451,4468,4483
                                                                                                  ,4490,4508,4520,4538,4545,4564,457
                                                                                                  6,4598,4599,4613                  
 STMDIR                     Local  4336     R(4)            4     1     70       SAVE             4401,4509,4511,4565,4825          
 STMDR0                     Dummy  4315     R(4)            4           scalar   ARG,INOUT        4668,4675,4683,4698               
 STMID                      Local  4331     CHAR            3     1     70       SAVE             4385,4403,4809,4827               
 STMLAT                     Local  4335     R(4)            4     1     70       SAVE             4401,4512,4514,4522,4568,4570,4578
                                                                                                  ,4825                             
 STMLON                     Local  4335     R(4)            4     1     70       SAVE             4401,4513,4522,4569,4578,4825     
 STMNAM                     Local  4331     CHAR            9     1     70       SAVE             4387,4403,4811,4827               
 STMNTK                     Dummy  4316     CHAR                        scalar   ARG,INOUT        4385,4387,4395,4809,4811,4819,4853
                                                                                                  ,4855                             
 STMSP0                     Dummy  4315     R(4)            4           scalar   ARG,INOUT        4669,4676,4684,4698               
 STMSPD                     Local  4336     R(4)            4     1     70       SAVE             4401,4510,4511,4566,4825          
 STMTPC                     Local  4344     CHAR            1     1     4        SAVE                                               
 TIMMIN                     Local  4588     R(4)            4           scalar   SAVE             4588,4630,4633                    
 TRKDPT                     Local  4350     R(4)            4     1     72       SAVE             4519,4575,4618                    
 TRKDRZ                     Local  4348     R(4)            4     1     72       SAVE             4509,4520,4565,4567,4576,4611     
 TRKLNZ                     Local  4348     R(4)            4     1     72       SAVE             4513,4522,4569,4577,4610          
 TRKLTZ                     Local  4348     R(4)            4     1     72       SAVE             4512,4521,4568,4577,4609          
 TRKPCN                     Local  4349     R(4)            4     1     72       SAVE             4516,4572,4615                    
 TRKPEN                     Local  4350     R(4)            4     1     72       SAVE             4517,4573,4616                    
 TRKRMX                     Local  4349     R(4)            4     1     72       SAVE             4515,4571,4614                    
 TRKSPZ                     Local  4349     R(4)            4     1     72       SAVE             4510,4521,4566,4567,4576,4612     
 TRKSUB                     Subr   4314                                                                                             
 TRKVMX                     Local  4350     R(4)            4     1     72       SAVE             4518,4574,4617                    
 USTM                       Local  4511     R(4)            4           scalar   SAVE             4511,4513,4521,4567,4569,4577     
 VMAX                       Local  4338     R(4)            4     1     70       SAVE             4402,4518,4574,4826               
 VSTM                       Local  4511     R(4)            4           scalar   SAVE             4511,4512,4521,4567,4568,4577     
 W3DIFDAT                   Subr   4413                                                           4413                              
 ZTIME                      Subr   4408                                                           4408                              

Page 127         Source Listing                  TRKSUB
2017-04-18 11:09                                 syndata.f

   4860 
   4861 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   4862 C                .      .    .                                       .
   4863 C SUBPROGRAM:    NEWVIT      READS TROP. CYCLONE VITAL STAT. FILE
   4864 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   4865 C
   4866 C ABSTRACT: GENERAL FILE READER FOR TROPICAL CYCLONE VITAL STATISTICS
   4867 C   FILE.  CAN FIND ALL STORMS OF A PARTICULAR NAME OR ID, ALL
   4868 C   STORMS ON A PARTICULAR DATE/TIME AND VARIOUS COMBINATIONS OF
   4869 C   THE ABOVE.
   4870 C
   4871 C PROGRAM HISTORY LOG:
   4872 C 1991-06-06  S. J. LORD
   4873 C
   4874 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   4875 C   INPUT ARGUMENT LIST:
   4876 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   4877 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   4878 C
   4879 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   4880 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   4881 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   4882 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   4883 C
   4884 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   4885 C     DDNAME1  - GENERIC NAME & CONTENT
   4886 C
   4887 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   4888 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   4889 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   4890 C
   4891 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   4892 C
   4893 C ATTRIBUTES:
   4894 C   LANGUAGE: FORTRAN 90
   4895 C   MACHINE:  NCEP WCOSS
   4896 C
   4897 C$$$
   4898       SUBROUTINE NEWVIT(IOVITL,IPRNT,IOPT,IERVIT,MAXSTM,KSTORM,IDTREQ,
   4899      1                  IHRREQ,IHRWIN,IDATE,IUTC,STMLAT,STMLON,STMDIR,
   4900      2                  STMSPD,PCEN,PENV,RMAX,VMAX,RMW,R15NE,R15SE,
   4901      3                  R15SW,R15NW,PTOP,FSTFLG,STMNAM,STMID,RSMC)
   4902 
   4903       SAVE
   4904 
   4905       DIMENSION  JDAT(8),RINC(5)
   4906 
   4907       CHARACTER STMNAM*9,STMID*3,RSMC*4
   4908 
   4909       LOGICAL FSTFLG
   4910 
   4911       DIMENSION STMNAM(MAXSTM),STMLAT(MAXSTM),STMLON(MAXSTM),
   4912      1          STMDIR(MAXSTM),STMSPD(MAXSTM),IDATE(MAXSTM),
   4913      2          IUTC(MAXSTM),RMAX(MAXSTM),PENV(MAXSTM),PCEN(MAXSTM),
   4914      3          PTOP(MAXSTM),RSMC(MAXSTM),RMW(MAXSTM),VMAX(MAXSTM),
   4915      4          R15NW(MAXSTM),R15NE(MAXSTM),R15SE(MAXSTM),R15SW(MAXSTM),
   4916      5          STMID(MAXSTM),FSTFLG(MAXSTM)

Page 128         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   4917 
   4918       PARAMETER (MAXCHR=95)
   4919       PARAMETER (MAXVIT=15)
   4920       PARAMETER (MAXTPC= 3)
   4921 
   4922       DIMENSION IVTVAR(MAXVIT),VITVAR(MAXVIT),VITFAC(MAXVIT),
   4923      1          ISTVAR(MAXVIT),IENVAR(MAXVIT),STMTOP(0:MAXTPC)
   4924 
   4925       DIMENSION BUFIN(MAXCHR),STMTPC(0:MAXTPC),FMTVIT(MAXVIT)
   4926       DIMENSION BUFY2K(MAXCHR)
   4927 
   4928       CHARACTER BUFIN*1,RSMCZ*4,STMIDZ*3,STMNMZ*9,FSTFLZ*1,STMDPZ*1,
   4929      1          SHALO*1,MEDIUM*1,DEEP*1,LATNS*1,LONEW*1,FMTVIT*6,
   4930      2          BUFINZ*100,STMREQ*9,RELOCZ*1,STMTPC*1,EXE*1
   4931       CHARACTER BUFY2K*1
   4932 
   4933       COMMON/BDATE/LDAT(8)
   4934 
   4935       EQUIVALENCE (BUFIN(1),RSMCZ),(BUFIN(5),RELOCZ),(BUFIN(6),STMIDZ),
   4936      1            (BUFIN(10),STMNMZ),(BUFIN(19),FSTFLZ),
   4937      2            (BUFIN(37),LATNS),(BUFIN(43),LONEW),
   4938      3            (BUFIN(MAXCHR),STMDPZ),(BUFIN(1),BUFINZ)
   4939 
   4940       EQUIVALENCE (IVTVAR(1),IDATEZ),(IVTVAR(2),IUTCZ)
   4941 
   4942       EQUIVALENCE (VITVAR( 3),STMLTZ),(VITVAR( 4),STMLNZ),
   4943      1            (VITVAR( 5),STMDRZ),(VITVAR( 6),STMSPZ),
   4944      2            (VITVAR( 7),PCENZ), (VITVAR( 8),PENVZ),
   4945      3            (VITVAR( 9),RMAXZ), (VITVAR(10),VMAXZ),
   4946      4            (VITVAR(11),RMWZ),  (VITVAR(12),R15NEZ),
   4947      5            (VITVAR(13),R15SEZ),(VITVAR(14),R15SWZ),
   4948      6            (VITVAR(15),R15NWZ)
   4949 
   4950       DATA SHALO/'S'/,MEDIUM/'M'/,DEEP/'D'/,EXE/'X'/,VITFAC/2*1.0,2*0.1,
   4951      1     1.0,0.1,9*1.0/,FMTVIT/'(I8.8)','(I4.4)','(I3.3)','(I4.4)',
   4952      2     2*'(I3.3)',3*'(I4.4)','(I2.2)','(I3.3)',4*'(I4.4)'/,
   4953      3     ISTVAR/20,29,34,39,45,49,53,58,63,68,71,75,80,85,90/,
   4954      4     IENVAR/27,32,36,42,47,51,56,61,66,69,73,78,83,88,93/,
   4955      5     STMTOP/-99.0,700.,400.,200./
   4956 
   4957       EQUIVALENCE (STMTPC(0), EXE),(STMTPC(1),SHALO),(STMTPC(2),MEDIUM),
   4958      1            (STMTPC(3),DEEP)
   4959 
   4960 C  BASIN BOUNDARIES: MIN AND MAX LATITUDES; MIN AND MAX LONGITUDES
   4961 C    NOTE: SOME BOUNDARIES MAY OVERLAP, BUT SCANNING IS IN ORDER OF
   4962 C          DECREASING PRIORITY SO BASINS SHOULD BE CAPTURED PROPERLY
   4963 
   4964 C  FIVMIN IS FIVE MINUTES IN UNITS OF FRACTIONAL DAYS
   4965 
   4966       DATA FIVMIN/3.4722E-3/,IRDERM/20/,NUM/1/
   4967 
   4968 C  THIS SUBROUTINE READS A GLOBAL VITAL STATISTICS FILE FOR TROPICAL
   4969 C    CYCLONES.  THERE ARE A NUMBER OF OPTIONS (IOPT) UNDER WHICH THIS
   4970 C    ROUTINE WILL OPERATE:
   4971 C          1) FIND ALL STORMS ON A SPECIFIED DATE/TIME (+WINDOW)
   4972 C          2) FIND A PARTICULAR STORM NAME ON A SPECIFIED DATE/TIME
   4973 C             (+WINDOW)

Page 129         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   4974 C          3) FIND ALL OCCURRENCES OF A PARTICULAR STORM NAME
   4975 C          4) SAME AS OPTION 2, EXCEPT FOR A PARTICULAR STORM ID
   4976 C          5) SAME AS OPTION 3, EXCEPT FOR A PARTICULAR STORM ID
   4977 C          6) ALL OCCURRENCES OF A PARTICULAR STORM NAME, EVEN BEFORE IT
   4978 C             HAD A NAME (FIND FIRST OCCURRENCE OF STORM NAME,
   4979 C             SUBSTITUE STORM ID, REWIND, THEN EXECUTE OPTION 5
   4980 
   4981 C  STORM ID POSITON CONTAINS THE BASIN IDENTIFIER IN THE LAST CHARACTER.
   4982 C    THESE ABBREVIATIONS ARE:
   4983 C          NORTH ATLANTIC:   L
   4984 C          EAST PACIFIC:     E
   4985 C          CENTRAL PACIFIC:  C
   4986 C          WEST PACIFIC:     W
   4987 C          AUSTRALIAN:       U
   4988 C          SOUTH INDIAN:     S
   4989 C          SOUTH PACIFIC     P
   4990 C          N ARABIAN SEA     A
   4991 C          BAY OF BENGAL     B
   4992 C          SOUTH CHINA SEA   O
   4993 C          EAST CHINA SEA    T
   4994 
   4995 C  CHECK INPUT ARGUMENTS ACCORDING TO OPTION.  ALSO DO OVERHEAD CHORES
   4996 C    IF NECESSARY
   4997 
   4998       IERVIT=0
   4999       STMREQ=' '
   5000       IYRREQ=-9999
   5001 
   5002       IF(IOPT .LE. 2 .OR. IOPT .EQ. 4)  THEN
   5003         IF(IDTREQ .LE. 0)  THEN
   5004         WRITE(6,11) IOPT,IDTREQ,IHRREQ,IHRWIN,MAXSTM,STMNAM(1),STMID(1)
   5005    11   FORMAT(/'****** ILLEGAL DATE IN NEWVIT, IOPT,IDTREQ,IHRREQ,',
   5006      1         'IHRWIN,MAXSTM,STMNAM,STMID=',/,9X,5I10,2X,A9,2X,A3)
   5007         IERVIT=10
   5008         ENDIF
   5009 
   5010         IF(IHRREQ .LT. 0)  THEN
   5011         WRITE(6,21) IOPT,IDTREQ,IHRREQ,IHRWIN,MAXSTM,STMNAM(1),STMID(1)
   5012    21   FORMAT(/'****** ILLEGAL HOUR IN NEWVIT, IOPT,IDTREQ,IHRREQ,',
   5013      1         'IHRWIN,MAXSTM,STMNAM,STMID=',/,9X,5I10,2X,A9,2X,A3)
   5014         IERVIT=20
   5015         ENDIF
   5016 
   5017         IF(IHRWIN .LT. 0)  THEN
   5018         WRITE(6,31) IOPT,IDTREQ,IHRREQ,IHRWIN,MAXSTM,STMNAM(1),STMID(1)
   5019    31   FORMAT(/'****** ILLEGAL WINDOW IN NEWVIT, IOPT,IDTREQ,IHRREQ,',
   5020      1         'IHRWIN,MAXSTM,STMNAM,STMID=',/,9X,5I10,2X,A9,2X,A3)
   5021         IERVIT=30
   5022 
   5023 C  SET UP PARAMETERS FOR TIME WINDOW
   5024 
   5025         ELSE IF(IHRWIN .GT. 0)  THEN
   5026         CALL ZTIME(IDTREQ,IHRREQ,IYRWIN,IMO,IDA,IHR,IMIN)
   5027         JDAT = 0
   5028         JDAT(1) = IYRWIN
   5029         JDAT(2) = IMO
   5030         JDAT(3) = IDA

Page 130         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5031         CALL W3DIFDAT(JDAT,LDAT,1,RINC)
   5032         JDY = NINT(RINC(1))
   5033         CALL FLDAY(JDY,IHR,IMIN,DAY00)
   5034 
   5035 C  NORMAL CASE
   5036 
   5037         WINDOW=REAL(IHRWIN)/24.
   5038         DAYPLS=DAY00+WINDOW+FIVMIN
   5039         DAYMNS=DAY00-WINDOW-FIVMIN
   5040         ENDIF
   5041       ENDIF
   5042 
   5043       IF(IOPT .EQ. 2 .OR. IOPT .EQ. 3 .OR. IOPT .EQ. 6)  THEN
   5044         IF(STMNAM(1) .EQ. ' ')  THEN
   5045         WRITE(6,41) IOPT,IDTREQ,IHRREQ,IHRWIN,MAXSTM,STMNAM(1),STMID(1)
   5046    41   FORMAT(/'****** ILLEGAL STMNAM IN NEWVIT, IOPT,IDTREQ,IHRREQ,',
   5047      1         'IHRWIN,MAXSTM,STMNAM,STMID=',/,9X,5I10,2X,A9,2X,A3)
   5048         IERVIT=40
   5049 
   5050         ELSE
   5051         STMREQ=STMNAM(1)
   5052         ENDIF
   5053 
   5054       ELSE IF(IOPT .EQ. 4 .OR. IOPT .EQ. 5)  THEN
   5055         IF(STMID(1) .EQ. ' ')  THEN
   5056         WRITE(6,51) IOPT,IDTREQ,IHRREQ,IHRWIN,MAXSTM,STMNAM(1),STMID(1)
   5057    51   FORMAT(/'****** ILLEGAL STMID IN NEWVIT, IOPT,IDTREQ,IHRREQ,',
   5058      1         'IHRWIN,MAXSTM,STMNAM,STMID=',/,9X,5I10,2X,A9,2X,A3)
   5059         IERVIT=50
   5060 
   5061         ELSE
   5062         STMREQ=STMID(1)
   5063         ENDIF
   5064 
   5065       ELSE IF(IOPT .NE. 1)  THEN
   5066       WRITE(6,61) IOPT,IDTREQ,IHRREQ,IHRWIN,MAXSTM,STMNAM(1),STMID(1)
   5067    61 FORMAT(/'****** ILLEGAL OPTION IN NEWVIT, IOPT,IDTREQ,IHRREQ,',
   5068      1       'IHRWIN,MAXSTM,STMNAM,STMID=',/,9X,5I10,2X,A9,2X,A3)
   5069       IERVIT=60
   5070       ENDIF
   5071 
   5072 C  FOR OPTIONS 3, 5, 6 (ALL OCCURRENCES OPTIONS), SEARCH IS RESTRICTED
   5073 C    TO A SPECIFIC YEAR WHEN IDTREQ IS POSITIVE
   5074 
   5075       IF(IOPT .EQ. 3 .OR. IOPT .EQ. 5 .OR. IOPT .EQ. 6)
   5076      1                                   IYRREQ=IDTREQ/10000
   5077 
   5078 C  ******  ERROR EXIT  ******
   5079 
   5080       IF(IERVIT .GT. 0)  RETURN
   5081 
   5082 C  INITIALIZE FILE AND COUNTERS
   5083 
   5084    90 REWIND IOVITL
   5085       KREC=0
   5086       KSTORM=0
   5087       NERROR=0

Page 131         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5088 
   5089 C  READ A RECORD INTO BUFFER
   5090 
   5091   100 CONTINUE
   5092 cdak  READ(IOVITL,101,ERR=990,END=200) (BUFIN(NCH),NCH=1,MAXCHR)
   5093       READ(IOVITL,101,ERR=200,END=200) (BUFIN(NCH),NCH=1,MAXCHR) ! Jack
   5094   101 FORMAT(95A1)
   5095 
   5096 C At this point we do not know if a 2-digit year begins in column 20
   5097 C  of the record (old non-y2k compliant form) or if a 4-digit year
   5098 C  begins in column 20 (new y2k compliant form) - test on location of
   5099 C  latitude N/S indicator to find out ...
   5100 
   5101       if(BUFIN(35).eq.'N' .or. BUFIN(35).eq.'S')  then
   5102 
   5103 C ... this record still contains the old 2-digit form of the year -
   5104 C      for example:
   5105 
   5106 C NHC  13L MITCH     981028 1800 164N 0858W 270 010 0957 1008 0371 51 019 0278 0278 0185 0185 D
   5107 C 123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123
   5108 C          1         2         3         4         5         6         7         8         9
   5109 
   5110 C ... this program will convert the record to a 4-digit year using the
   5111 C      "windowing" technique since subsequent logic expects this  - for
   5112 C       example, the above record is converted to:
   5113 
   5114 C NHC  13L MITCH     19981028 1800 164N 0858W 270 010 0957 1008 0371 51 019 0278 0278 0185 0185 D
   5115 C 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
   5116 C          1         2         3         4         5         6         7         8         9
   5117 
   5118 cppppp
   5119          print *, ' '
   5120          print *, '==> Read in RECORD from tcvitals file -- contains a',
   5121      $    ' 2-digit year "',BUFIN(20:21),'"'
   5122          print *, ' '
   5123          print'(" From unit ",I0,"; BUFIN-1: ",95A)', iovitl,bufin
   5124          print *, ' '
   5125 cppppp
   5126          BUFY2K(1:19) = BUFIN(1:19)
   5127          IF(BUFIN(20)//BUFIN(21).GT.'20')  THEN
   5128             BUFY2K(20) = '1'
   5129             BUFY2K(21) = '9'
   5130          ELSE
   5131             BUFY2K(20) = '2'
   5132             BUFY2K(21) = '0'
   5133          ENDIF
   5134          BUFY2K(22:95) = BUFIN(20:93)
   5135          BUFIN = BUFY2K
   5136 cppppp
   5137          print *, ' '
   5138          print *, '==> 2-digit year converted to 4-digit year "',
   5139      $    BUFIN(20:23),'" via windowing technique'
   5140          print *, ' '
   5141          print'(" From unit ",I0,"; BUFIN-1: ",95A)', iovitl,bufin
   5142          print *, ' '
   5143 cppppp
   5144 

Page 132         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5145       else  if(BUFIN(37).eq.'N' .or. BUFIN(37).eq.'S')  then
   5146 
   5147 C ... this record contains the new 4-digit form of the year -
   5148 C      for example:
   5149 
   5150 C NHC  13L MITCH     19981028 1800 164N 0858W 270 010 0957 1008 0371 51 019 0278 0278 0185 0185 D
   5151 C 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
   5152 C          1         2         3         4         5         6         7         8         9
   5153 
   5154 C ... no conversion necessary since this subsequent logic expects this
   5155 
   5156 cppppp
   5157          print *, ' '
   5158          print *, '==> Read in RECORD from tcvitals file -- contains a',
   5159      $    ' 4-digit year "',BUFIN(20:23),'"'
   5160          print *, ' '
   5161          print'(" From unit ",I0,"; BUFIN-1: ",95A)', iovitl,bufin
   5162          print *, ' '
   5163          print *, '==> No conversion necessary'
   5164          print *, ' '
   5165 cppppp
   5166 
   5167       else
   5168 
   5169          print *, ' '
   5170          print *, '***** Cannot determine if this record contains ',
   5171      $    'a 2-digit year or a 4-digit year - skip it and try reading ',
   5172      $    'the next record'
   5173          print *, ' '
   5174          go to 100
   5175 
   5176       end if
   5177 
   5178       KREC=KREC+1
   5179 
   5180 C  DECODE DATE AND TIME
   5181 
   5182       DO 110 IV=1,2
   5183       CALL DECVAR(ISTVAR(IV),IENVAR(IV),IVTVAR(IV),IERDEC,FMTVIT(IV),
   5184      1            BUFINZ)
   5185 CIBM  CALL FFA2I(BUFINZ,ISTVAR(IV),IENVAR(IV)-ISTVAR(IV)+1,
   5186 CIBM 1           NUM,IVTVAR(IV),IERDEC)
   5187 CCRAY CALL DECVAR(ISTVAR(IV),IENVAR(IV),IVTVAR(IV),IERDEC,FMTVIT(IV),
   5188 CCRAY1            BUFINZ)
   5189 c && 4 comments
   5190 CC    WRITE(6,109) IV,ISTVAR(IV),IENVAR(IV),IVTVAR(IV),IERDEC,
   5191 CC   1             FMTVIT(IV)
   5192 CC109 FORMAT(/'...DECODING VARIABLE #',I2,' ISTART,IEND,IVALUE,IER,',
   5193 CC   1       'FMT=',2I4,I10,I3,2X,A10)
   5194   110 CONTINUE
   5195 
   5196 C  FILTER OUT RECORDS THAT ARE NOT GATHERED BY CURRENT OPTION
   5197 
   5198 C  FIRST: DATE/TIME/WINDOW FILTER
   5199 
   5200       IF(IOPT .LE. 2 .OR. IOPT .EQ. 4)  THEN
   5201 

Page 133         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5202 C  EXACT DATE/UTC ARE SPECIFIED
   5203 
   5204         IF(IHRWIN .EQ. 0)  THEN
   5205 c && 2 comments
   5206 CC      WRITE(6,117) IDATEZ,IUTCZ
   5207 CC117   FORMAT(/'...NO WINDOW OPTION: IDATEZ,IUTCZ=',2I10)
   5208           IF(IDTREQ .NE. IDATEZ)  GO TO 100
   5209           IF(IHRREQ .NE. IUTCZ )  GO TO 100
   5210 
   5211         ELSE
   5212         CALL ZTIME(IDATEZ,IUTCZ,IYR,IMO,IDA,IHR,IMIN)
   5213         JDAT = 0
   5214         JDAT(1) = IYR
   5215         JDAT(2) = IMO
   5216         JDAT(3) = IDA
   5217         CALL W3DIFDAT(JDAT,LDAT,1,RINC)
   5218         JDY = NINT(RINC(1))
   5219         CALL FLDAY(JDY,IHR,IMIN,DAYZ)
   5220 
   5221 c && 3 comments
   5222 CC      WRITE(6,119) IYR,IMO,IDA,IHR,IMIN,JDY,DAYZ,DAYMNS,DAYPLS,IYRMNS
   5223 CC119   FORMAT('...DEBUGGING WINDOW TIME SELECTION: IYR,IMO,IDA,',
   5224 CC   1    'IHR,IMIN,JDY,DAYZ,DAYMNS,DAYPLS,IYRMNS=',/,15X,6I5,3F12.4,I5)
   5225 
   5226 C  YEAR WINDOW, THEN FRACTIONAL JULIAN DAY WINDOW
   5227 
   5228         IF(IYR .NE. IYRWIN)  GO TO 100
   5229         IF(DAYZ .LT. DAYMNS .OR. DAYZ .GT. DAYPLS)  GO TO 100
   5230         ENDIF
   5231       ENDIF
   5232 
   5233 C  SECOND: STORM NAME FILTER
   5234 
   5235       IF(IOPT .EQ. 2 .OR. IOPT .EQ. 3 .OR. IOPT .EQ. 6)  THEN
   5236       IF(IPRNT .GT. 0)  WRITE(6,123) STMNMZ,STMREQ
   5237   123 FORMAT('...STORM NAME FILTER, STMNMZ,STMREQ=',A9,2X,A9)
   5238       IF(STMNMZ .NE. STMREQ)  GO TO 100
   5239       IF(IOPT .EQ. 3 .OR. IOPT .EQ. 6)  THEN
   5240       IF(IYRREQ .GT. 0 .AND. IDATEZ/10000 .NE. IYRREQ)  GO TO 100
   5241       ENDIF
   5242 
   5243 C  FOR OPTION 6, BRANCH BACK TO LOOK FOR STORM ID INSTEAD OF STORM NAME
   5244 
   5245         IF(IOPT .EQ. 6)  THEN
   5246         IOPT=5
   5247         STMREQ=STMIDZ
   5248         GO TO 90
   5249         ENDIF
   5250 
   5251       ENDIF
   5252 
   5253 C  THIRD: STORM ID FILTER
   5254 
   5255       IF(IOPT .EQ. 4 .AND.  STMIDZ .NE. STMREQ)  GO TO 100
   5256       IF(IOPT .EQ. 5 .AND. (STMIDZ .NE. STMREQ .OR. (IYRREQ .GT. 0
   5257      1   .AND. IDATEZ/10000 .NE. IYRREQ)))  GO TO 100
   5258 

Page 134         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5259 C  EUREKA
   5260 
   5261       IF(IPRNT .GT. 0)  WRITE(6,137) STMREQ,KREC
   5262   137 FORMAT('...REQUESTED STORM FOUND, NAME/ID=',A9,' AT RECORD #',I6)
   5263 
   5264       DO 140 IV=3,MAXVIT
   5265       CALL DECVAR(ISTVAR(IV),IENVAR(IV),IVTVAR(IV),IERDEC,FMTVIT(IV),
   5266      1            BUFINZ)
   5267 CIBM  CALL FFA2I(BUFINZ,ISTVAR(IV),IENVAR(IV)-ISTVAR(IV)+1,
   5268 CIBM 1           NUM,IVTVAR(IV),IERDEC)
   5269 CCRAY CALL DECVAR(ISTVAR(IV),IENVAR(IV),IVTVAR(IV),IERDEC,FMTVIT(IV),
   5270 CCRAY1            BUFINZ)
   5271       VITVAR(IV)=REAL(IVTVAR(IV))*VITFAC(IV)
   5272   140 CONTINUE
   5273 
   5274 C  DEPTH OF CYCLONIC CIRCULATION
   5275 
   5276       IF(STMDPZ .EQ. SHALO)  THEN
   5277       PTOPZ=STMTOP(1)
   5278       ELSE IF(STMDPZ .EQ. MEDIUM)  THEN
   5279       PTOPZ=STMTOP(2)
   5280       ELSE IF(STMDPZ .EQ. DEEP)  THEN
   5281       PTOPZ=STMTOP(3)
   5282       ELSE IF(STMDPZ .EQ. 'X')  THEN
   5283       PTOPZ=-99.0
   5284 c && 3 comments
   5285 CC    WRITE(6,141) STMDPZ
   5286 CC141 FORMAT('******DEPTH OF CYCLONIC CIRCULATION HAS MISSING CODE=',
   5287 CC   1       A,'.')
   5288       ELSE
   5289       WRITE(6,143) STMDPZ
   5290   143 FORMAT('******ERROR DECODING DEPTH OF CYCLONIC CIRCULATION,',
   5291      1       ' STMDPZ=',A1,'. ERROR RECOVERY NEEDED.')
   5292       ENDIF
   5293 
   5294 C          *****************************************************
   5295 C          *****************************************************
   5296 C          ****            IMPORTANT NOTES:                 ****
   5297 C          ****                                             ****
   5298 C          ****    ALL STORM LONGITUDES CONVERTED TO        ****
   5299 C          ****    0-360 DEGREES, POSITIVE EASTWARD  !!!    ****
   5300 C          ****                                             ****
   5301 C          ****    ALL STORM SPEEDS ARE IN M/SEC            ****
   5302 C          ****                                             ****
   5303 C          ****    ALL DISTANCE DATA ARE IN KM              ****
   5304 C          ****                                             ****
   5305 C          ****    ALL PRESSURE DATA ARE IN HPA (MB)        ****
   5306 C          *****************************************************
   5307 C          *****************************************************
   5308 
   5309 C  SIGN OF LATITUDE AND CONVERT LONGITUDE
   5310 
   5311       IF(LATNS .EQ. 'S')  THEN
   5312       STMLTZ=-STMLTZ
   5313       ELSE IF(LATNS .NE. 'N')  THEN
   5314       WRITE(6,153) STMLTZ,STMLNZ,LATNS
   5315   153 FORMAT('******ERROR DECODING LATNS, ERROR RECOVERY NEEDED.',

Page 135         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5316      1       '  STMLTZ,STMLNZ,LATNS=',2F12.2,2X,A1)
   5317       GO TO 100
   5318       ENDIF
   5319 
   5320       IF(LONEW .EQ. 'W')  THEN
   5321       STMLNZ=360.-STMLNZ
   5322       ELSE IF(LONEW .NE. 'E')  THEN
   5323       WRITE(6,157) STMLTZ,STMLNZ,LATNS
   5324   157 FORMAT('******ERROR DECODING LONEW, ERROR RECOVERY NEEDED.',
   5325      1       '  STMLTZ,STMLNZ,LATNS=',2F12.2,2X,A1)
   5326       ENDIF
   5327 
   5328       IF(IPRNT .EQ. 1)
   5329      1  WRITE(6,161) IDATEZ,IUTCZ,STMLTZ,STMLNZ,STMDRZ,STMSPZ,PENVZ,
   5330      2               PCENZ,RMAXZ,VMAXZ,RMWZ,R15NEZ,R15SEZ,R15SWZ,R15NWZ
   5331   161 FORMAT('...ALL STORM DATA CALCULATED: IDATEZ,IUTCZ,',
   5332      1       'STMLTZ,STMLNZ,STMDRZ,STMSPZ,PENVZ,PCENZ,',
   5333      2       'RMAXZ,VMAXZ,RMWZ,R15NEZ,R15SEZ,R15SWZ,R15NWZ=',/,
   5334      3       5X,2I10,13F8.2)
   5335 
   5336       IF(KSTORM .LT. MAXSTM)  THEN
   5337       KSTORM=KSTORM+1
   5338       IDATE(KSTORM)=IDATEZ
   5339       IUTC(KSTORM)=IUTCZ
   5340       PTOP(KSTORM)=PTOPZ
   5341       STMLAT(KSTORM)=STMLTZ
   5342       STMLON(KSTORM)=STMLNZ
   5343       STMDIR(KSTORM)=STMDRZ
   5344       STMSPD(KSTORM)=STMSPZ
   5345       STMNAM(KSTORM)=STMNMZ
   5346       STMID (KSTORM)=STMIDZ
   5347       RSMC  (KSTORM)=RSMCZ
   5348       RMAX(KSTORM)=RMAXZ
   5349       PENV(KSTORM)=PENVZ
   5350       PCEN(KSTORM)=PCENZ
   5351       VMAX(KSTORM)=VMAXZ
   5352       RMW(KSTORM)=RMWZ
   5353       R15NE(KSTORM)=R15NEZ
   5354       R15SE(KSTORM)=R15SEZ
   5355       R15SW(KSTORM)=R15SWZ
   5356       R15NW(KSTORM)=R15NWZ
   5357 
   5358 C  SET THE FIRST OCCURRENCE FLAG IF PRESENT
   5359 
   5360       IF(FSTFLZ .EQ. ':')  THEN
   5361       FSTFLG(KSTORM)=.TRUE.
   5362       ELSE
   5363       FSTFLG(KSTORM)=.FALSE.
   5364       ENDIF
   5365 
   5366       GO TO 100
   5367 
   5368       ELSE
   5369       GO TO 300
   5370       ENDIF
   5371 
   5372   200 CONTINUE

Page 136         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5373 
   5374       IF(KSTORM .GT. 0)  THEN
   5375 
   5376 C  NORMAL RETURN HAVING FOUND REQUESTED STORM (S) AT DATE/TIME/WINDOW
   5377 
   5378       IF(IPRNT .EQ. 1)  WRITE(6,201) STMREQ,IDTREQ,IHRREQ,KSTORM,
   5379      1                               KREC
   5380   201 FORMAT(/'...FOUND STORM NAME/ID ',A12,' AT DATE, TIME=',
   5381      1       I9,'/',I5,' UTC IN VITALS FILE.',/,4X,I5,' RECORDS FOUND.',
   5382      2       ' TOTAL NUMBER OF RECORDS READ=',I7)
   5383       RETURN
   5384 
   5385 C  UNABLE TO FIND REQUESTED STORM AT DATE/TIME/WINDOW
   5386 
   5387       ELSE
   5388       IF(IOPT .EQ. 1) STMREQ='ALLSTORMS'
   5389       WRITE(6,207) IOPT,STMREQ,STMNMZ
   5390   207 FORMAT(/'****  OPTION=',I3,' CANNOT FIND STORM NAME/ID=',A9,
   5391      1       '... LAST STORM FOUND=',A9)
   5392 
   5393       WRITE(6,209) IDATEZ,IDTREQ,IUTCZ,IHRREQ
   5394   209 FORMAT('****  CANNOT FIND REQUESTED DATE/TIME,',
   5395      1       ' (FOUND, REQUESTED) (DATE/TIME)=',4I10,/)
   5396       IERVIT=210
   5397       RETURN
   5398       ENDIF
   5399 
   5400   300 WRITE(6,301) KSTORM
   5401   301 FORMAT(/'******KSTORM EXCEEDS AVAILABLE SPACE, KSTORM=',I5)
   5402       RETURN
   5403 
   5404 C-----------------------------------------------------------------------
   5405 
   5406       ENTRY VITLST(IOVITL)
   5407 
   5408       REWIND IOVITL
   5409       WRITE(6,401)
   5410   401 FORMAT(//20X,'**** LISTING OF VITAL STATISTICS FILE FOLLOWS ****'
   5411      $ //)
   5412       KREC=0
   5413   410 CONTINUE
   5414       READ(IOVITL,411,ERR=990,END=420) (BUFIN(NCH),NCH=1,MAXCHR)
   5415   411 FORMAT(95A1)
   5416 
   5417 C At this point we do not know if a 2-digit year begins in column 20
   5418 C  of the record (old non-y2k compliant form) or if a 4-digit year
   5419 C  begins in column 20 (new y2k compliant form) - test on location of
   5420 C  latitude N/S indicator to find out ...
   5421 
   5422       if(BUFIN(35).eq.'N' .or. BUFIN(35).eq.'S')  then
   5423 
   5424 C ... this record still contains the old 2-digit form of the year -
   5425 C      for example:
   5426 
   5427 C NHC  13L MITCH     981028 1800 164N 0858W 270 010 0957 1008 0371 51 019 0278 0278 0185 0185 D
   5428 C 123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123
   5429 C          1         2         3         4         5         6         7         8         9

Page 137         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5430 
   5431 C ... this program will convert the record to a 4-digit year using the
   5432 C      "windowing" technique since subsequent logic expects this  - for
   5433 C       example, the above record is converted to:
   5434 
   5435 C NHC  13L MITCH     19981028 1800 164N 0858W 270 010 0957 1008 0371 51 019 0278 0278 0185 0185 D
   5436 C 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
   5437 C          1         2         3         4         5         6         7         8         9
   5438 
   5439 cppppp
   5440          print *, ' '
   5441          print *, '==> Read in RECORD from tcvitals file -- contains a',
   5442      $    ' 2-digit year "',BUFIN(20:21),'"'
   5443          print *, ' '
   5444          print'(" From unit ",I0,"; BUFIN-1: ",95A)', iovitl,bufin
   5445          print *, ' '
   5446 cppppp
   5447          BUFY2K(1:19) = BUFIN(1:19)
   5448          IF(BUFIN(20)//BUFIN(21).GT.'20')  THEN
   5449             BUFY2K(20) = '1'
   5450             BUFY2K(21) = '9'
   5451          ELSE
   5452             BUFY2K(20) = '2'
   5453             BUFY2K(21) = '0'
   5454          ENDIF
   5455          BUFY2K(22:95) = BUFIN(20:93)
   5456          BUFIN = BUFY2K
   5457 cppppp
   5458          print *, ' '
   5459          print *, '==> 2-digit year converted to 4-digit year "',
   5460      $    BUFIN(20:23),'" via windowing technique'
   5461          print *, ' '
   5462          print'(" From unit ",I0,"; BUFIN-1: ",95A)', iovitl,bufin
   5463          print *, ' '
   5464 cppppp
   5465 
   5466       else  if(BUFIN(37).eq.'N' .or. BUFIN(37).eq.'S')  then
   5467 
   5468 C ... this record contains the new 4-digit form of the year -
   5469 C      for example:
   5470 
   5471 C NHC  13L MITCH     19981028 1800 164N 0858W 270 010 0957 1008 0371 51 019 0278 0278 0185 0185 D
   5472 C 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
   5473 C          1         2         3         4         5         6         7         8         9
   5474 
   5475 C ... no conversion necessary since this subsequent logic expects this
   5476 
   5477 cppppp
   5478          print *, ' '
   5479          print *, '==> Read in RECORD from tcvitals file -- contains a',
   5480      $    ' 4-digit year "',BUFIN(20:23),'"'
   5481          print *, ' '
   5482          print'(" From unit ",I0,"; BUFIN-1: ",95A)', iovitl,bufin
   5483          print *, ' '
   5484          print *, '==> No conversion necessary'
   5485          print *, ' '
   5486 cppppp

Page 138         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5487 
   5488       else
   5489 
   5490          print *, ' '
   5491          print *, '***** Cannot determine if this record contains ',
   5492      $    'a 2-digit year or a 4-digit year - consider this a READ ',
   5493      $    'ERROR'
   5494          print *, ' '
   5495          go to 990
   5496 
   5497       end if
   5498 
   5499       KREC=KREC+1
   5500 
   5501       WRITE(6,413) (BUFIN(NCH),NCH=1,MAXCHR)
   5502   413 FORMAT(5X,95A1)
   5503       GO TO 410
   5504 
   5505   420 WRITE(6,421) KREC,MAXCHR
   5506   421 FORMAT(/'...',I5,' RECORDS READ OF',I4,' CHARACTER LENGTH.',///)
   5507       RETURN
   5508 
   5509   990 WRITE(6,991) BUFIN
   5510   991 FORMAT('******ERROR READING STORM RECORD.  BUFIN IS:',/,
   5511      1       ' ******',A95,'******')
   5512       NERROR=NERROR+1
   5513       IF(NERROR .LE. IRDERM)  GO TO 100
   5514       IERVIT=990
   5515       RETURN
   5516       END

Page 139         Source Listing                  NEWVIT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name               
                                           
 newvit_               vitlst_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  5091                                                           5174,5208,5209,5228,5229,5238,5240
                                                                                                  ,5255,5257,5317,5366,5513         
 101                        Label  5094                                                           5093                              
 11                         Label  5005                                                           5004                              
 110                        Label  5194                                                           5182                              
 123                        Label  5237                                                           5236                              
 137                        Label  5262                                                           5261                              
 140                        Label  5272                                                           5264                              
 143                        Label  5290                                                           5289                              
 153                        Label  5315                                                           5314                              
 157                        Label  5324                                                           5323                              
 161                        Label  5331                                                           5329                              
 200                        Label  5372                                                           5093                              
 201                        Label  5380                                                           5378                              
 207                        Label  5390                                                           5389                              
 209                        Label  5394                                                           5393                              
 21                         Label  5012                                                           5011                              
 300                        Label  5400                                                           5369                              
 301                        Label  5401                                                           5400                              
 31                         Label  5019                                                           5018                              
 401                        Label  5410                                                           5409                              
 41                         Label  5046                                                           5045                              
 410                        Label  5413                                                           5503                              
 411                        Label  5415                                                           5414                              
 413                        Label  5502                                                           5501                              
 420                        Label  5505                                                           5414                              
 421                        Label  5506                                                           5505                              
 51                         Label  5057                                                           5056                              
 61                         Label  5067                                                           5066                              
 90                         Label  5084                                                           5248                              
 990                        Label  5509                                                           5414,5495                         
 991                        Label  5510                                                           5509                              
 BDATE                      Common 4933                                 32       SAVE                                               
 BUFIN                      Local  4925     CHAR            1     1     95       SAVE             5093,5101,5121,5123,5126,5127,5134
                                                                                                  ,5135,5139,5141,5145,5159,5161,541
                                                                                                  4,5422,5442,5444,5447,5448,5455,54
                                                                                                  56,5460,5462,5466,5480,5482,5501,5
                                                                                                  509                               
 BUFINZ                     Local  4930     CHAR            100         scalar   SAVE             5184,5266                         
 BUFY2K                     Local  4926     CHAR            1     1     95       SAVE             5126,5128,5129,5131,5132,5134,5135
                                                                                                  ,5447,5449,5450,5452,5453,5455,545
                                                                                                  6                                 
 DAY00                      Local  5033     R(4)            4           scalar   SAVE             5033,5038,5039                    
 DAYMNS                     Local  5039     R(4)            4           scalar   SAVE             5039,5229                         

Page 140         Source Listing                  NEWVIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DAYPLS                     Local  5038     R(4)            4           scalar   SAVE             5038,5229                         
 DAYZ                       Local  5219     R(4)            4           scalar   SAVE             5219,5229                         
 DECVAR                     Subr   5183                                                           5183,5265                         
 DEEP                       Local  4929     CHAR            1           scalar   SAVE             4950,5280                         
 EXE                        Local  4930     CHAR            1           scalar   SAVE             4950                              
 FIVMIN                     Local  4966     R(4)            4           scalar   SAVE             4966,5038,5039                    
 FLDAY                      Subr   5033                                                           5033,5219                         
 FMTVIT                     Local  4925     CHAR            6     1     15       SAVE             4951,5183,5265                    
 FSTFLG                     Dummy  4901     L(4)            4     1     0        ARG,INOUT        5361,5363                         
 FSTFLZ                     Local  4928     CHAR            1           scalar   SAVE             5360                              
 IDA                        Local  5026     I(4)            4           scalar   SAVE             5026,5030,5212,5216               
 IDATE                      Dummy  4899     I(4)            4     1     0        ARG,INOUT        5338                              
 IDATEZ                     Local  4940     I(4)            4           scalar   SAVE             5208,5212,5240,5257,5329,5338,5393
 IDTREQ                     Dummy  4898     I(4)            4           scalar   ARG,INOUT        5003,5004,5011,5018,5026,5045,5056
                                                                                                  ,5066,5076,5208,5378,5393         
 IENVAR                     Local  4923     I(4)            4     1     15       SAVE             4954,5183,5265                    
 IERDEC                     Local  5183     I(4)            4           scalar   SAVE             5183,5265                         
 IERVIT                     Dummy  4898     I(4)            4           scalar   ARG,INOUT        4998,5007,5014,5021,5048,5059,5069
                                                                                                  ,5080,5396,5514                   
 IHR                        Local  5026     I(4)            4           scalar   SAVE             5026,5033,5212,5219               
 IHRREQ                     Dummy  4899     I(4)            4           scalar   ARG,INOUT        5004,5010,5011,5018,5026,5045,5056
                                                                                                  ,5066,5209,5378,5393              
 IHRWIN                     Dummy  4899     I(4)            4           scalar   ARG,INOUT        5004,5011,5017,5018,5025,5037,5045
                                                                                                  ,5056,5066,5204                   
 IMIN                       Local  5026     I(4)            4           scalar   SAVE             5026,5033,5212,5219               
 IMO                        Local  5026     I(4)            4           scalar   SAVE             5026,5029,5212,5215               
 IOPT                       Dummy  4898     I(4)            4           scalar   ARG,INOUT        5002,5004,5011,5018,5043,5045,5054
                                                                                                  ,5056,5065,5066,5075,5200,5235,523
                                                                                                  9,5245,5246,5255,5256,5388,5389   
 IOVITL                     Dummy  4898     I(4)            4           scalar   ARG,INOUT        5084,5093,5123,5141,5161,5408,5414
                                                                                                  ,5444,5462,5482                   
 IPRNT                      Dummy  4898     I(4)            4           scalar   ARG,INOUT        5236,5261,5328,5378               
 IRDERM                     Local  4966     I(4)            4           scalar   SAVE             4966,5513                         
 ISTVAR                     Local  4923     I(4)            4     1     15       SAVE             4953,5183,5265                    
 IUTC                       Dummy  4899     I(4)            4     1     0        ARG,INOUT        5339                              
 IUTCZ                      Local  4940     I(4)            4           scalar   SAVE             5209,5212,5329,5339,5393          
 IV                         Local  5182     I(4)            4           scalar   SAVE             5182,5183,5264,5265,5271          
 IVTVAR                     Local  4922     I(4)            4     1     15       SAVE             5183,5265,5271                    
 IYR                        Local  5212     I(4)            4           scalar   SAVE             5212,5214,5228                    
 IYRREQ                     Local  5000     I(4)            4           scalar   SAVE             5000,5076,5240,5256,5257          
 IYRWIN                     Local  5026     I(4)            4           scalar   SAVE             5026,5028,5228                    
 JDAT                       Local  4905     I(4)            4     1     8        SAVE             5027,5028,5029,5030,5031,5213,5214
                                                                                                  ,5215,5216,5217                   
 JDY                        Local  5032     I(4)            4           scalar   SAVE             5032,5033,5218,5219               
 KREC                       Local  5085     I(4)            4           scalar   SAVE             5085,5178,5261,5379,5412,5499,5505
 KSTORM                     Dummy  4898     I(4)            4           scalar   ARG,INOUT        5086,5336,5337,5338,5339,5340,5341
                                                                                                  ,5342,5343,5344,5345,5346,5347,534
                                                                                                  8,5349,5350,5351,5352,5353,5354,53
                                                                                                  55,5356,5361,5363,5374,5378,5400  
 LATNS                      Local  4929     CHAR            1           scalar   SAVE             5311,5313,5314,5323               
 LDAT                       Scalar 4933     I(4)            4     1     8        COM              5031,5217                         
 LONEW                      Local  4929     CHAR            1           scalar   SAVE             5320,5322                         
 MAXCHR                     Param  4918     I(4)            4           scalar                    4925,4926,4938,5093,5414,5501,5505
 MAXSTM                     Dummy  4898     I(4)            4           scalar   ARG,INOUT        4911,4912,4913,4914,4915,4916,5004
                                                                                                  ,5011,5018,5045,5056,5066,5336    

Page 141         Source Listing                  NEWVIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAXTPC                     Param  4920     I(4)            4           scalar                    4923,4925                         
 MAXVIT                     Param  4919     I(4)            4           scalar                    4922,4923,4925,5264               
 MEDIUM                     Local  4929     CHAR            1           scalar   SAVE             4950,5278                         
 NCH                        Local  5093     I(4)            4           scalar   SAVE             5093,5414,5501                    
 NERROR                     Local  5087     I(4)            4           scalar   SAVE             5087,5512,5513                    
 NEWVIT                     Subr   4898                                                                                             
 NINT                       Func   5032                                 scalar                    5032,5218                         
 NUM                        Local  4966     I(4)            4           scalar   SAVE             4966                              
 PCEN                       Dummy  4900     R(4)            4     1     0        ARG,INOUT        5350                              
 PCENZ                      Local  4944     R(4)            4           scalar   SAVE             5330,5350                         
 PENV                       Dummy  4900     R(4)            4     1     0        ARG,INOUT        5349                              
 PENVZ                      Local  4944     R(4)            4           scalar   SAVE             5329,5349                         
 PTOP                       Dummy  4901     R(4)            4     1     0        ARG,INOUT        5340                              
 PTOPZ                      Local  5277     R(4)            4           scalar   SAVE             5277,5279,5281,5283,5340          
 R15NE                      Dummy  4900     R(4)            4     1     0        ARG,INOUT        5353                              
 R15NEZ                     Local  4946     R(4)            4           scalar   SAVE             5330,5353                         
 R15NW                      Dummy  4901     R(4)            4     1     0        ARG,INOUT        5356                              
 R15NWZ                     Local  4948     R(4)            4           scalar   SAVE             5330,5356                         
 R15SE                      Dummy  4900     R(4)            4     1     0        ARG,INOUT        5354                              
 R15SEZ                     Local  4947     R(4)            4           scalar   SAVE             5330,5354                         
 R15SW                      Dummy  4901     R(4)            4     1     0        ARG,INOUT        5355                              
 R15SWZ                     Local  4947     R(4)            4           scalar   SAVE             5330,5355                         
 REAL                       Func   5037                                 scalar                    5037,5271                         
 RELOCZ                     Local  4930     CHAR            1           scalar   SAVE                                               
 RINC                       Local  4905     R(4)            4     1     5        SAVE             5031,5032,5217,5218               
 RMAX                       Dummy  4900     R(4)            4     1     0        ARG,INOUT        5348                              
 RMAXZ                      Local  4945     R(4)            4           scalar   SAVE             5330,5348                         
 RMW                        Dummy  4900     R(4)            4     1     0        ARG,INOUT        5352                              
 RMWZ                       Local  4946     R(4)            4           scalar   SAVE             5330,5352                         
 RSMC                       Dummy  4901     CHAR            4     1     0        ARG,INOUT        5347                              
 RSMCZ                      Local  4928     CHAR            4           scalar   SAVE             5347                              
 SHALO                      Local  4929     CHAR            1           scalar   SAVE             4950,5276                         
 STMDIR                     Dummy  4899     R(4)            4     1     0        ARG,INOUT        5343                              
 STMDPZ                     Local  4928     CHAR            1           scalar   SAVE             5276,5278,5280,5282,5289          
 STMDRZ                     Local  4943     R(4)            4           scalar   SAVE             5329,5343                         
 STMID                      Dummy  4901     CHAR            3     1     0        ARG,INOUT        5004,5011,5018,5045,5055,5056,5062
                                                                                                  ,5066,5346                        
 STMIDZ                     Local  4928     CHAR            3           scalar   SAVE             5247,5255,5256,5346               
 STMLAT                     Dummy  4899     R(4)            4     1     0        ARG,INOUT        5341                              
 STMLNZ                     Local  4942     R(4)            4           scalar   SAVE             5314,5321,5323,5329,5342          
 STMLON                     Dummy  4899     R(4)            4     1     0        ARG,INOUT        5342                              
 STMLTZ                     Local  4942     R(4)            4           scalar   SAVE             5312,5314,5323,5329,5341          
 STMNAM                     Dummy  4901     CHAR            9     1     0        ARG,INOUT        5004,5011,5018,5044,5045,5051,5056
                                                                                                  ,5066,5345                        
 STMNMZ                     Local  4928     CHAR            9           scalar   SAVE             5236,5238,5345,5389               
 STMREQ                     Local  4930     CHAR            9           scalar   SAVE             4999,5051,5062,5236,5238,5247,5255
                                                                                                  ,5256,5261,5378,5388,5389         
 STMSPD                     Dummy  4900     R(4)            4     1     0        ARG,INOUT        5344                              
 STMSPZ                     Local  4943     R(4)            4           scalar   SAVE             5329,5344                         
 STMTOP                     Local  4923     R(4)            4     1     4        SAVE             4955,5277,5279,5281               
 STMTPC                     Local  4925     CHAR            1     1     4        SAVE                                               
 VITFAC                     Local  4922     R(4)            4     1     15       SAVE             4950,5271                         
 VITLST                     Subr   5406                                                                                             
 VITVAR                     Local  4922     R(4)            4     1     15       SAVE             5271                              
 VMAX                       Dummy  4900     R(4)            4     1     0        ARG,INOUT        5351                              

Page 142         Source Listing                  NEWVIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VMAXZ                      Local  4945     R(4)            4           scalar   SAVE             5330,5351                         
 W3DIFDAT                   Subr   5031                                                           5031,5217                         
 WINDOW                     Local  5037     R(4)            4           scalar   SAVE             5037,5038,5039                    
 ZTIME                      Subr   5026                                                           5026,5212                         

Page 143         Source Listing                  NEWVIT
2017-04-18 11:09                                 syndata.f

   5517 
   5518 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5519 C                .      .    .                                       .
   5520 C SUBPROGRAM:    DECVAR      DECODES VARIALES
   5521 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   5522 C
   5523 C ABSTRACT: DECODES VARIABLES FROM THE TROPICAL CYCLONE VITAL
   5524 C   STATISTICS FILE.  FILE SHOULD BE CHARACTER BASED.
   5525 C
   5526 C PROGRAM HISTORY LOG:
   5527 C 1991-06-06  S. J. LORD
   5528 C
   5529 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   5530 C   INPUT ARGUMENT LIST:
   5531 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   5532 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   5533 C
   5534 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   5535 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   5536 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   5537 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   5538 C
   5539 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   5540 C     DDNAME1  - GENERIC NAME & CONTENT
   5541 C
   5542 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   5543 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   5544 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   5545 C
   5546 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   5547 C
   5548 C ATTRIBUTES:
   5549 C   LANGUAGE: FORTRAN 90
   5550 C   MACHINE:  NCEP WCOSS
   5551 C
   5552 C$$$
   5553       SUBROUTINE DECVAR(ISTART,IEND,IVALUE,IERDEC,FMT,BUFF)
   5554 
   5555       PARAMETER (NCHLIN=130)
   5556 
   5557       CHARACTER FMT*(*),BUFF*(*),OUTLIN*1
   5558 
   5559       SAVE
   5560 
   5561       DIMENSION OUTLIN(NCHLIN)
   5562 
   5563 c && 2 comments
   5564 CC    WRITE(6,1) FMT,BUFF
   5565 CC  1 FORMAT(/'...FMT=',A10,/,' ...BUFF=',A100)
   5566 
   5567       READ(BUFF(ISTART:IEND),FMT,ERR=10)  IVALUE
   5568       IERDEC=0
   5569       RETURN
   5570 
   5571    10 CONTINUE
   5572 
   5573       OUTLIN=' '

Page 144         Source Listing                  DECVAR
2017-04-18 11:09                                 syndata.f

   5574 
   5575       IERDEC=10
   5576       OUTLIN(ISTART:IEND)='*'
   5577 
   5578       WRITE(6,31) (OUTLIN(ICH1),ICH1=1,NCHLIN)
   5579       WRITE(6,32) BUFF
   5580    31 FORMAT(/'******ERROR DECODING, BUFF=',/,130A1)
   5581    32 FORMAT(A130)
   5582 
   5583       RETURN
   5584       END


ENTRY POINTS

  Name               
                     
 decvar_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  5571                                                           5567                              
 31                         Label  5580                                                           5578                              
 32                         Label  5581                                                           5579                              
 BUFF                       Dummy  5553     CHAR                        scalar   ARG,INOUT        5567,5579                         
 DECVAR                     Subr   5553                                                                                             
 FMT                        Dummy  5553     CHAR                        scalar   ARG,INOUT        5567                              
 ICH1                       Local  5578     I(4)            4           scalar   SAVE             5578                              
 IEND                       Dummy  5553     I(4)            4           scalar   ARG,INOUT        5567,5576                         
 IERDEC                     Dummy  5553     I(4)            4           scalar   ARG,INOUT        5568,5575                         
 ISTART                     Dummy  5553     I(4)            4           scalar   ARG,INOUT        5567,5576                         
 IVALUE                     Dummy  5553     I(4)            4           scalar   ARG,INOUT        5567                              
 NCHLIN                     Param  5555     I(4)            4           scalar                    5561,5578                         
 OUTLIN                     Local  5557     CHAR            1     1     130      SAVE             5573,5576,5578                    

Page 145         Source Listing                  DECVAR
2017-04-18 11:09                                 syndata.f

   5585 
   5586 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5587 C                .      .    .                                       .
   5588 C SUBPROGRAM:    GRABVO      HANDLES VORTEX TYPES FOR BOGUSING
   5589 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   5590 C
   5591 C ABSTRACT: UTILITY ROUTINE TO CONTROL EXTRACTION OF VARIABLES
   5592 C   FROM A ROUTINE THAT PRODUCES A BOGUS VORTEX.
   5593 C
   5594 C PROGRAM HISTORY LOG:
   5595 C 1991-06-06  S. J. LORD
   5596 C
   5597 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   5598 C   INPUT ARGUMENT LIST:
   5599 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   5600 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   5601 C
   5602 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   5603 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   5604 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   5605 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   5606 C
   5607 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   5608 C     DDNAME1  - GENERIC NAME & CONTENT
   5609 C
   5610 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   5611 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   5612 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   5613 C
   5614 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   5615 C
   5616 C ATTRIBUTES:
   5617 C   LANGUAGE: FORTRAN 90
   5618 C   MACHINE:  NCEP WCOSS
   5619 C
   5620 C$$$
   5621 
   5622 C  *****************************
   5623 C  ****  SUBROUTINE GRABVO  ****
   5624 C  ****     ENTRY GRABIV    ****
   5625 C  ****     ENTRY GRABIP    ****
   5626 C  ****     ENTRY PROVOR    ****
   5627 C  *****************************
   5628 
   5629       SUBROUTINE GRABVO(IUNTFV,IUNTTK,IUNTDO,IPREQ,IVREQ,KLVLS,JVARS,
   5630      2                  ILVLVO,INDPVO,IVARVO,INDVVO,FSTBOG,IVOTYP,
   5631      3                  IVFLTP,PT,KLBOGZ,JVBOGZ,ONLYWI,ONLYMA,ONLYPS)
   5632 
   5633       PARAMETER(MAXBGK=10)
   5634       PARAMETER(MAXBGV= 7)
   5635 
   5636       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
   5637      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
   5638      2            MSKD15,MSKD16,MSKD17,MSKD18
   5639 
   5640       LOGICAL ONLYWI,ONLYMA,ONLYPS,FSTBOG
   5641 

Page 146         Source Listing                  GRABVO
2017-04-18 11:09                                 syndata.f

   5642       SAVE
   5643 
   5644       DIMENSION IPREQ(KLVLS),ILVL(MAXBGK),INDXP(MAXBGK),IVREQ(JVARS),
   5645      1          IVAR(MAXBGV),INDXV(MAXBGV),IPREQZ(MAXBGK),IVREQZ(MAXBGV)
   5646 
   5647       DIMENSION ILVLS(MAXBGK),INDXPS(MAXBGK),IVARS(MAXBGV),
   5648      1          INDXVS(MAXBGV)
   5649 
   5650       DIMENSION ILVLVO(MAXBGK),INDPVO(MAXBGK),IVARVO(MAXBGV),
   5651      1          INDVVO(MAXBGV)
   5652 
   5653 C  CURRENT VORTEX AND FILE TYPES ARE:
   5654 
   5655 C  VORTEX TYPE:
   5656 
   5657 C       IVOTYP= 1: NON-DIVERGENT, AXISYMMETRIC
   5658 
   5659 C       IVOTYP= 2: DIVERGENT, AXISYMMETRIC
   5660 
   5661 C    FILE TYPES:
   5662 
   5663 C       IVFLTP= 1: MATHUR POSTPROCESSED 3-D U, V, Z FILE
   5664 C                  == SEE SLVVO1 FOR SETUP INFORMATION ON VERTICAL
   5665 C                     LEVELS
   5666 C                  == SEE SVRVO1 FOR SETUP INFORMATION ON VARIABLES
   5667 
   5668 C       IVFLTP= 2: MATHUR 2-D VORTEX
   5669 C                  == SEE SLVVO2 FOR SETUP INFORMATION ON VERTICAL
   5670 C                     LEVELS
   5671 C                  == SEE SVRVO2 FOR SETUP INFORMATION ON VARIABLES
   5672 
   5673 C       IVFLTP= 3: SHAPIRO 2-D ANGULAR MOMENTUM VORTEX
   5674 C                  (ITERATIVE, CREATES RADIAL AND TANGENTIAL WIND)
   5675 C                  == SEE SLVVO3 FOR SETUP INFORMATION ON VERTICAL
   5676 C                     LEVELS
   5677 C                  == SEE SVRVO3 FOR SETUP INFORMATION ON VARIABLES
   5678 
   5679 C-----------------------------------------------------------------------
   5680 
   5681 C  ++++++++++++++++++++++++
   5682 C  ++++  ENTRY GRABIV  ++++
   5683 C  ++++++++++++++++++++++++
   5684 
   5685       ENTRY GRABIV(IVOTYP,IVFLTP,IPREQ,KLVLS,IVREQ,JVARS,PT)
   5686 
   5687 C  AS IN THE ENVIRONMENTAL MODEL (GRABIM), FOR PHYSICAL REASONS AS WELL
   5688 C    AS COMPUTATIONAL EFFICIENCY, WE CONSIDER ONLY A SINGLE LEVEL ABOVE
   5689 C    THE LEVEL OF THE DEEPEST CYCLONIC CIRCULATION (PT)
   5690 
   5691       WRITE(6,1) IVOTYP,IVFLTP,KLVLS,JVARS,PT
   5692     1 FORMAT(/'...ENTERING GRABIV WITH IVOTYP,IVFLTP,KLVLS,JVARS,PT=',
   5693      1       4I5,F10.2)
   5694       WRITE(6,3) (IPREQ(NP),NP=1,KLVLS)
   5695     3 FORMAT(/'...IPREQ=',/,(5X,10I5))
   5696       WRITE(6,5) (IVREQ(NP),NP=1,JVARS)
   5697     5 FORMAT(/'...IVREQ=',/,(5X,10I5))
   5698       DO 10 KL=1,KLVLS

Page 147         Source Listing                  GRABVO
2017-04-18 11:09                                 syndata.f

   5699       NPREQ=KL
   5700       IF(NINT(PT*10.) .GE. IPREQ(KL)*10)  GO TO 11
   5701    10 CONTINUE
   5702    11 CONTINUE
   5703 
   5704       IF(NPREQ .NE. KLVLS)  THEN
   5705       WRITE(6,13) NPREQ,IPREQ(NPREQ),KLVLS,IPREQ(KLVLS)
   5706    13 FORMAT(/'...IN GRABIV, REQUESTED LEVELS HAVE BEEN TRUNCATED TO ',
   5707      1       'CONFORM TO HEIGHT OF THE DEEPEST CYCLONIC CIRCULATION.',/,
   5708      2       4X,'TRUNCATED, REQUESTED INDEX, PRESSURE LEVEL ARE',4I5)
   5709       ENDIF
   5710 
   5711 C  STORE REQUESTED PRESSURE LEVELS AND VARIABLES LOCALLY.  THEN PERFORM
   5712 C    SOME BASIC CHECKS FOR SUFFICIENT SPACE, LEVELS THEN VARIABLES
   5713 
   5714 C  STORE LEVELS TO BE BOGUSSED HERE
   5715 
   5716       NP=0
   5717       DO 15 NZ=1,NPREQ
   5718       NP=NP+1
   5719       IPREQZ(NP)=IPREQ(NZ)
   5720    15 CONTINUE
   5721 
   5722       KLMAX=NP
   5723       IF(KLVLS .LT. KLMAX)   THEN
   5724       WRITE(6,17) KLVLS,KLMAX
   5725    17 FORMAT(/'******INSUFFICIENT STORAGE ALLOCATED FOR STORING ',
   5726      1       'VERTICAL LEVELS IN GRABEN.',/,10X,'KLVLS=',I5,' WHILE ',
   5727      2       'AVAILABLE SPACE=KLMAX=',I5,/,10X,' THE NUMBER OF ',
   5728      3       'LEVELS WILL BE REDUCED ACCORDINGLY')
   5729       KLMAX=KLVLS
   5730       ENDIF
   5731 
   5732 C  STORE VARIABLES TO BE BOGUSSED HERE
   5733 
   5734       NV=0
   5735       DO 20 NZ=1,JVARS
   5736       NV=NV+1
   5737       IVREQZ(NV)=IVREQ(NZ)
   5738    20 CONTINUE
   5739 
   5740       JVMAX=NV
   5741       IF(JVARS .LT. JVMAX)  THEN
   5742       WRITE(6,31) JVMAX,MAXBGV
   5743    31 FORMAT(/'******INSUFFICIENT STORAGE ALLOCATED FOR STORING ',
   5744      1       'VARIABLES IN GRABEN.',/,10X,'JVMAX=',I5,' WHILE ',
   5745      2       'AVAILABLE SPACE=MAXBGV=',I5,/,10X,' THEREFORE, ',
   5746      3       'WE MUST TERMINATE THE PROGRAM')
   5747       CALL ABRT1(' GRABIV',31)
   5748       ENDIF
   5749 
   5750       IF(IVOTYP .EQ. 1)  THEN
   5751         IF(IVFLTP .EQ. 1)  THEN
   5752           CALL SLVVO1(KLMAX,IPREQZ,ILVL,INDXP,KLBOGA)
   5753           CALL SVRVO1(JVMAX,IVREQZ,IVAR,INDXV,JVBOGA)
   5754         ELSE IF(IVFLTP .EQ. 2)  THEN
   5755           CALL SLVVO2(KLMAX,IPREQZ,ILVL,INDXP,KLBOGA)

Page 148         Source Listing                  GRABVO
2017-04-18 11:09                                 syndata.f

   5756           CALL SVRVO2(JVMAX,IVREQZ,IVAR,INDXV,JVBOGA)
   5757         ELSE IF(IVFLTP .EQ. 3)  THEN
   5758           CALL SLVVO3(KLMAX,IPREQZ,ILVL,INDXP,KLBOGA)
   5759           CALL SVRVO3(JVMAX,IVREQZ,IVAR,INDXV,JVBOGA)
   5760         ENDIF
   5761 
   5762       ELSE IF(IVOTYP .EQ. 2)  THEN
   5763         IF(IVFLTP .EQ. 3)  THEN
   5764           CALL SLVVO3(KLMAX,IPREQZ,ILVL,INDXP,KLBOGA)
   5765           CALL SVRVO3(JVMAX,IVREQZ,IVAR,INDXV,JVBOGA)
   5766         ELSE
   5767         WRITE(6,37)  IVFLTP,IVOTYP
   5768    37 FORMAT(/'******ILLEGAL VORTEX FILE TYPE=',I3,' FOR VORTEX ',
   5769      1         'TYPE=',I3)
   5770         CALL ABRT1(' GRABIV',37)
   5771         ENDIF
   5772       ENDIF
   5773       KLBOG=KLBOGA
   5774       JVBOG=JVBOGA
   5775 
   5776       ILVLS (1:KLBOG)=ILVL(1:KLBOG)
   5777       INDXPS(1:KLBOG)=INDXP(1:KLBOG)
   5778 
   5779       WRITE(6,43) (KP,IPREQZ(KP),KP=1,KLMAX)
   5780    43 FORMAT(/'...REQUESTED PRESSURE LEVELS FOR THE VORTEX ARE:',/,
   5781      1       (10X,2I5))
   5782       WRITE(6,44) IVOTYP,IVFLTP,(KP,ILVL(KP),INDXP(KP),KP=1,KLBOG)
   5783    44 FORMAT(/'...FOR VORTEX TYPE=',I3,' AND VORTEX FILE TYPE=',I4,',',
   5784      1       /,4X,'ACTUAL PRESSURE LEVELS AND INDICES FOR THE VORTEX',
   5785      2       ' ARE:',/,(10X,3I5))
   5786 
   5787       IVARS (1:JVBOG)=IVAR(1:JVBOG)
   5788       INDXVS(1:JVBOG)=INDXV(1:JVBOG)
   5789 
   5790       WRITE(6,57) (JV,IVREQZ(JV),JV=1,JVMAX)
   5791    57 FORMAT(/'...REQUESTED VARIABLES FOR THE VORTEX ARE:',/,
   5792      1       (10X,2I5))
   5793       WRITE(6,59) IVOTYP,IVFLTP,(JV,IVAR(JV),INDXV(JV),JV=1,JVBOG)
   5794    59 FORMAT(/'...FOR VORTEX TYPE=',I3,' AND VORTEX FILE TYPE=',I4,',',
   5795      1       /,4X,'ACTUAL VARIABLES AND INDICES FOR THE VORTEX ARE:',/,
   5796      2       (10X,3I5))
   5797 
   5798       RETURN
   5799 
   5800 C-----------------------------------------------------------------------
   5801 
   5802 
   5803 C  ++++++++++++++++++++++++
   5804 C  ++++  ENTRY GRABIP  ++++
   5805 C  ++++++++++++++++++++++++
   5806 
   5807       ENTRY GRABIP(ILVLVO,INDPVO,KLBOGZ,IVARVO,INDVVO,JVBOGZ,ONLYWI,
   5808      1             ONLYMA,ONLYPS)
   5809 
   5810 C  THIS ENTRY DIRECTS THE SELECTION OF COMPOSITED VARIABLES BY SURPRP
   5811 C    (PREPBUFR SCANNER FOR DATA AROUND THE STORM).
   5812 C    ****NOTE: THE CURRENT SETUP IS TO COMPOSITE SURFACE PRESSURE ALL

Page 149         Source Listing                  GRABVO
2017-04-18 11:09                                 syndata.f

   5813 C              THE TIME, NEVER TO COMPOSITE HEIGHT, AND TO COMPOSITE
   5814 C              WINDS IF NEED BE ****
   5815 
   5816       ONLYPS=.TRUE.
   5817       ONLYMA=.FALSE.
   5818       KLBOGZ=KLBOG
   5819       JVBOGZ=JVBOG
   5820       DO 110 JV=1,JVBOG
   5821       IF(IVREQZ(JV) .GE. 4 .AND. IVREQZ(JV) .LE. 7)  ONLYWI=.TRUE.
   5822       IVARVO(JV)=IVARS(JV)
   5823       INDVVO(JV)=INDXVS(JV)
   5824   110 CONTINUE
   5825 
   5826       ILVLVO(1:KLBOG)=ILVLS(1:KLBOG)
   5827       INDPVO(1:KLBOG)=INDXPS(1:KLBOG)
   5828 
   5829       RETURN
   5830 
   5831 C-----------------------------------------------------------------------
   5832 
   5833 C  ++++++++++++++++++++++++
   5834 C  ++++  ENTRY PROVOR  ++++
   5835 C  ++++++++++++++++++++++++
   5836 
   5837       ENTRY PROVOR(IUNTFV,IUNTTK,IUNTDO,FSTBOG)
   5838 
   5839 C  SET UNIT NUMBERS FOR 2-D SPLINE ANALYSIS
   5840 
   5841       MSKDA9=IUNTFV
   5842       MSKD18=IUNTDO
   5843       MSKDA2=IUNTTK
   5844 CCCC  REWIND MSKD18
   5845 
   5846       IF(FSTBOG)  THEN
   5847       CALL SPLDAT
   5848       ELSE
   5849       CALL SPLD1
   5850       ENDIF
   5851 
   5852       WRITE(6,211) MSKD15,IUNTFV
   5853   211 FORMAT(/'...REWINDING MSKD15=',I3,', IUNTFV=',I3,' IN PROVOR.')
   5854       REWIND MSKD15
   5855       REWIND IUNTFV
   5856 
   5857       RETURN
   5858       END

Page 150         Source Listing                  GRABVO
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 grabip_               grabiv_               grabvo_               provor_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  5692                                                           5691                              
 10                         Label  5701                                                           5698                              
 11                         Label  5702                                                           5700                              
 110                        Label  5824                                                           5820                              
 13                         Label  5706                                                           5705                              
 15                         Label  5720                                                           5717                              
 17                         Label  5725                                                           5724                              
 20                         Label  5738                                                           5735                              
 211                        Label  5853                                                           5852                              
 3                          Label  5695                                                           5694                              
 31                         Label  5743                                                           5742                              
 37                         Label  5768                                                           5767                              
 43                         Label  5780                                                           5779                              
 44                         Label  5783                                                           5782                              
 5                          Label  5697                                                           5696                              
 57                         Label  5791                                                           5790                              
 59                         Label  5794                                                           5793                              
 ABRT1                      Subr   5747                                                           5747,5770                         
 DSK                        Common 5636                                 76       SAVE                                               
 FSTBOG                     Dummy  5630     L(4)            4           scalar   ARG,INOUT        5846                              
 GRABIP                     Subr   5807                                                                                             
 GRABIV                     Subr   5685                                                                                             
 GRABVO                     Subr   5629                                                                                             
 ILVL                       Local  5644     I(4)            4     1     10       SAVE             5752,5755,5758,5764,5776,5782     
 ILVLS                      Local  5647     I(4)            4     1     10       SAVE             5776,5826                         
 ILVLVO                     Dummy  5630     I(4)            4     1     10       ARG,INOUT        5826                              
 INDPVO                     Dummy  5630     I(4)            4     1     10       ARG,INOUT        5827                              
 INDVVO                     Dummy  5630     I(4)            4     1     7        ARG,INOUT        5823                              
 INDXP                      Local  5644     I(4)            4     1     10       SAVE             5752,5755,5758,5764,5777,5782     
 INDXPS                     Local  5647     I(4)            4     1     10       SAVE             5777,5827                         
 INDXV                      Local  5645     I(4)            4     1     7        SAVE             5753,5756,5759,5765,5788,5793     
 INDXVS                     Local  5648     I(4)            4     1     7        SAVE             5788,5823                         
 IPREQ                      Dummy  5629     I(4)            4     1     0        ARG,INOUT        5694,5700,5705,5719               
 IPREQZ                     Local  5645     I(4)            4     1     10       SAVE             5719,5752,5755,5758,5764,5779     
 IUNTDO                     Dummy  5629     I(4)            4           scalar   ARG,INOUT        5842                              
 IUNTFV                     Dummy  5629     I(4)            4           scalar   ARG,INOUT        5841,5852,5855                    
 IUNTTK                     Dummy  5629     I(4)            4           scalar   ARG,INOUT        5843                              
 IVAR                       Local  5645     I(4)            4     1     7        SAVE             5753,5756,5759,5765,5787,5793     
 IVARS                      Local  5647     I(4)            4     1     7        SAVE             5787,5822                         
 IVARVO                     Dummy  5630     I(4)            4     1     7        ARG,INOUT        5822                              
 IVFLTP                     Dummy  5631     I(4)            4           scalar   ARG,INOUT        5691,5751,5754,5757,5763,5767,5782
                                                                                                  ,5793                             
 IVOTYP                     Dummy  5630     I(4)            4           scalar   ARG,INOUT        5691,5750,5762,5767,5782,5793     
 IVREQ                      Dummy  5629     I(4)            4     1     0        ARG,INOUT        5696,5737                         

Page 151         Source Listing                  GRABVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IVREQZ                     Local  5645     I(4)            4     1     7        SAVE             5737,5753,5756,5759,5765,5790,5821
 JV                         Local  5790     I(4)            4           scalar   SAVE             5790,5793,5820,5821,5822,5823     
 JVARS                      Dummy  5629     I(4)            4           scalar   ARG,INOUT        5644,5691,5696,5735,5741          
 JVBOG                      Local  5774     I(4)            4           scalar   SAVE             5774,5787,5788,5793,5819,5820     
 JVBOGA                     Local  5753     I(4)            4           scalar   SAVE             5753,5756,5759,5765,5774          
 JVBOGZ                     Dummy  5631     I(4)            4           scalar   ARG,INOUT        5819                              
 JVMAX                      Local  5740     I(4)            4           scalar   SAVE             5740,5741,5742,5753,5756,5759,5765
                                                                                                  ,5790                             
 KL                         Local  5698     I(4)            4           scalar   SAVE             5698,5699,5700                    
 KLBOG                      Local  5773     I(4)            4           scalar   SAVE             5773,5776,5777,5782,5818,5826,5827
 KLBOGA                     Local  5752     I(4)            4           scalar   SAVE             5752,5755,5758,5764,5773          
 KLBOGZ                     Dummy  5631     I(4)            4           scalar   ARG,INOUT        5818                              
 KLMAX                      Local  5722     I(4)            4           scalar   SAVE             5722,5723,5724,5729,5752,5755,5758
                                                                                                  ,5764,5779                        
 KLVLS                      Dummy  5629     I(4)            4           scalar   ARG,INOUT        5644,5691,5694,5698,5704,5705,5723
                                                                                                  ,5724,5729                        
 KP                         Local  5779     I(4)            4           scalar   SAVE             5779,5782                         
 MAXBGK                     Param  5633     I(4)            4           scalar                    5644,5645,5647,5650               
 MAXBGV                     Param  5634     I(4)            4           scalar                    5645,5647,5648,5650,5651,5742     
 MSKD11                     Scalar 5637     I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 5637     I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 5637     I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 5637     I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 5638     I(4)            4           scalar   COM              5852,5854                         
 MSKD16                     Scalar 5638     I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 5638     I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 5638     I(4)            4           scalar   COM              5842                              
 MSKDA1                     Scalar 5636     I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 5636     I(4)            4           scalar   COM              5843                              
 MSKDA3                     Scalar 5636     I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 5636     I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 5636     I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 5636     I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 5637     I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 5637     I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 5637     I(4)            4           scalar   COM              5841                              
 MSKEF                      Scalar 5636     I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 5636     I(4)            4           scalar   COM                                                
 NINT                       Func   5700                                 scalar                    5700                              
 NP                         Local  5694     I(4)            4           scalar   SAVE             5694,5696,5716,5718,5719,5722     
 NPREQ                      Local  5699     I(4)            4           scalar   SAVE             5699,5704,5705,5717               
 NV                         Local  5734     I(4)            4           scalar   SAVE             5734,5736,5737,5740               
 NZ                         Local  5717     I(4)            4           scalar   SAVE             5717,5719,5735,5737               
 ONLYMA                     Dummy  5631     L(4)            4           scalar   ARG,INOUT        5817                              
 ONLYPS                     Dummy  5631     L(4)            4           scalar   ARG,INOUT        5816                              
 ONLYWI                     Dummy  5631     L(4)            4           scalar   ARG,INOUT        5821                              
 PROVOR                     Subr   5837                                                                                             
 PT                         Dummy  5631     R(4)            4           scalar   ARG,INOUT        5691,5700                         
 SLVVO1                     Subr   5752                                                           5752                              
 SLVVO2                     Subr   5755                                                           5755                              
 SLVVO3                     Subr   5758                                                           5758,5764                         
 SPLD1                      Subr   5849                                                           5849                              
 SPLDAT                     Subr   5847                                                           5847                              
 SVRVO1                     Subr   5753                                                           5753                              
 SVRVO2                     Subr   5756                                                           5756                              

Page 152         Source Listing                  GRABVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SVRVO3                     Subr   5759                                                           5759,5765                         

Page 153         Source Listing                  GRABVO
2017-04-18 11:09                                 syndata.f

   5859 
   5860 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   5861 C                .      .    .                                       .
   5862 C SUBPROGRAM:    SETUP       CONTROLS MODEL AND VORTEX SELECTION
   5863 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   5864 C
   5865 C ABSTRACT: CONTROLS SELECTION OF MODEL AND VORTEX TYPE FOR
   5866 C   BOGUSING.  GUARANTEES THAT VARIABLES CHOSEN FOR MODEL AND
   5867 C   VORTEX ARE THE SAME.
   5868 C
   5869 C PROGRAM HISTORY LOG:
   5870 C 1991-06-06  S. J. LORD
   5871 C
   5872 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   5873 C   INPUT ARGUMENT LIST:
   5874 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   5875 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   5876 C
   5877 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   5878 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   5879 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   5880 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   5881 C
   5882 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   5883 C     DDNAME1  - GENERIC NAME & CONTENT
   5884 C
   5885 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   5886 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   5887 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   5888 C
   5889 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   5890 C
   5891 C ATTRIBUTES:
   5892 C   LANGUAGE: FORTRAN 90
   5893 C   MACHINE:  NCEP WCOSS
   5894 C
   5895 C$$$
   5896 
   5897 C  *****************************
   5898 C  ****  SUBROUTINE SETUP   ****
   5899 C  *****************************
   5900 
   5901       SUBROUTINE SETUP(MODTYP,IMFLTP,IVOTYP,IVFLTP,IPREQ,IPREQZ,IPDUM,
   5902      2                 NPREQ,IVREQ,IVREQZ,IVDUM,NVREQ)
   5903 
   5904       SAVE
   5905 
   5906       DIMENSION IPREQ(NPREQ),IPREQZ(NPREQ),IVREQ(NVREQ),IVREQZ(NVREQ),
   5907      1          IPDUM(NPREQ),IVDUM(NVREQ)
   5908 
   5909       WRITE(6,3) MODTYP,IMFLTP,IVOTYP,IVFLTP,NPREQ,NVREQ,
   5910      1           (IPREQ(KP),KP=1,NPREQ)
   5911       WRITE(6,4) (IVREQ(JV),JV=1,NVREQ)
   5912     3 FORMAT(/'...ENTERING SETUP WITH MODTYP,IMFLTP,IVOTYP,IVFLTP,',
   5913      1       'NPREQ,NVREQ=',6I5,/,1X,'...REQUESTED LEVELS, IPREQ',
   5914      2       ', ARE:',/,(5X,10I5))
   5915     4 FORMAT(/'...REQUESTED VARIABLES, IVREQ ARE:',/,(5X,10I5))

Page 154         Source Listing                  SETUP
2017-04-18 11:09                                 syndata.f

   5916 
   5917       IPDUM=0
   5918       IPREQZ=IPREQ
   5919 
   5920       IVDUM=0
   5921       IVREQZ=IVREQ
   5922 
   5923       KLMAX=NPREQ
   5924       JVMAX=NVREQ
   5925 
   5926 C  CALL INDIVIDUAL SET UP ROUTINES FOR MODEL AND VORTEX ENVIRONMENT TO
   5927 C    MAKE SURE REQUESTED VARIABLES AND LEVELS EXIST.  LEVELS AND
   5928 C    VARIABLES SET TO NEGATIVE MEAN THEY ARE NOT PRESENT IN THE
   5929 C    RESPECTIVE FILES.
   5930 
   5931 C  FIRST, THE MODEL:
   5932 
   5933       IF(MODTYP .EQ. 0 .OR. MODTYP .EQ. 1)  THEN
   5934 
   5935 C  ARGUMENTS 3-5 IN SLVSP1,2 SVRSP1,2 SHOULD NOT BE USED HERE
   5936 
   5937         IF(IMFLTP .EQ. 1)  THEN
   5938           CALL SLVSP1(KLMAX,IPREQZ,IPDUM,IPDUM,KLDUM)
   5939           CALL SVRSP1(JVMAX,IVREQZ,IVDUM,IVDUM,JVDUM)
   5940         ELSE IF(IMFLTP .EQ. 2)  THEN
   5941           CALL SLVSP2(KLMAX,IPREQZ,IPDUM,IPDUM,KLDUM)
   5942           CALL SVRSP2(JVMAX,IVREQZ,IVDUM,IVDUM,JVDUM)
   5943         ENDIF
   5944 
   5945       ELSE IF(MODTYP .EQ. -1) THEN
   5946         IF(IMFLTP .NE. -1)  THEN
   5947         WRITE(6,31)  IMFLTP
   5948    31   FORMAT(/'******IMFLTP=',I5,' FOR GRID POINT MODEL IS NOT ',
   5949      1         'INSTALLED')
   5950         CALL ABRT1(' SETUP ',31)
   5951         ENDIF
   5952 
   5953       ELSE
   5954       WRITE(6,33) MODTYP
   5955    33 FORMAT(/'******MODTYP=',I5,' (UNKNOWN MODEL) IS NOT INSTALLED')
   5956       CALL ABRT1(' SETUP ',33)
   5957       ENDIF
   5958 
   5959 C  WEED OUT ALL REQUESTED LEVELS AND VARIABLES THAT WERE NOT FOUND
   5960 
   5961       KK=0
   5962       DO 40 KL=1,KLMAX
   5963       IF(IPREQZ(KL) .GT. 0)  THEN
   5964       KK=KK+1
   5965       IPREQZ(KK)=IPREQZ(KL)
   5966       ENDIF
   5967    40 CONTINUE
   5968 
   5969       JJ=0
   5970       DO 50 JV=1,JVMAX
   5971       IF(IVREQZ(JV) .GT. 0)  THEN
   5972       JJ=JJ+1

Page 155         Source Listing                  SETUP
2017-04-18 11:09                                 syndata.f

   5973       IVREQZ(JJ)=IVREQZ(JV)
   5974       ENDIF
   5975    50 CONTINUE
   5976       KLMAX=KK
   5977       JVMAX=JJ
   5978       WRITE(6,51) KLMAX,JVMAX
   5979    51 FORMAT(/'...AFTER FIRST (ENV) WEEDING, KLMAX,JVMAX=',2I5)
   5980 
   5981 C  SECOND, THE VORTEX:
   5982 
   5983       IF(IVOTYP .EQ. 1 .OR. IVOTYP .EQ. 2)  THEN
   5984 
   5985 C  ARGUMENTS 3-5 IN SLVVO1(2), SVRVO1(2) SHOULD NOT BE USED HERE
   5986 
   5987         IF(IVFLTP .EQ. 1)  THEN
   5988           CALL SLVVO1(KLMAX,IPREQZ,IPDUM,IPDUM,KLDUM)
   5989           CALL SVRVO1(JVMAX,IVREQZ,IVDUM,IVDUM,JVDUM)
   5990         ELSE IF(IVFLTP .EQ. 2)  THEN
   5991           CALL SLVVO2(KLMAX,IPREQZ,IPDUM,IPDUM,KLDUM)
   5992           CALL SVRVO2(JVMAX,IVREQZ,IVDUM,IVDUM,JVDUM)
   5993         ELSE IF(IVFLTP .EQ. 3)  THEN
   5994           CALL SLVVO3(KLMAX,IPREQZ,IPDUM,IPDUM,KLDUM)
   5995           CALL SVRVO3(JVMAX,IVREQZ,IVDUM,IVDUM,JVDUM)
   5996         ELSE
   5997         WRITE(6,111) IVFLTP
   5998   111   FORMAT(/'******IVFLTP=',I5,' IS NOT INSTALLED')
   5999         CALL ABRT1(' SETUP',111)
   6000         ENDIF
   6001 
   6002       ELSE IF(IVOTYP .EQ. -99) THEN
   6003       WRITE(6,113) IVOTYP
   6004   113 FORMAT(/'######IVOTYP=',I5,' VORTEX WILL NOT BE INCLUDED IN ',
   6005      1       'SETUP.')
   6006       ELSE
   6007       WRITE(6,114) IVOTYP
   6008   114 FORMAT(/'******IVOTYP=',I5,' (UNKNOWN VORTEX) IS NOT INSTALLED')
   6009       CALL ABRT1(' SETUP',114)
   6010       ENDIF
   6011 
   6012 C  THE SECOND WEEDING (FOR THE VORTEX AND MODEL ENVIRONMENT COMBINED)
   6013 
   6014       KK=0
   6015       DO 130 KL=1,KLMAX
   6016       IF(IPREQZ(KL) .GT. 0)  THEN
   6017       KK=KK+1
   6018       IPREQZ(KK)=IPREQZ(KL)
   6019       ENDIF
   6020   130 CONTINUE
   6021 
   6022       JJ=0
   6023       DO 140 JV=1,JVMAX
   6024       IF(IVREQZ(JV) .GT. 0)  THEN
   6025       JJ=JJ+1
   6026       IVREQZ(JJ)=IVREQZ(JV)
   6027       ENDIF
   6028   140 CONTINUE
   6029       NPREQ=KK

Page 156         Source Listing                  SETUP
2017-04-18 11:09                                 syndata.f

   6030       NVREQ=JJ
   6031 
   6032       IPREQ=IPREQZ
   6033 
   6034       IVREQ=IVREQZ
   6035 
   6036       IF(NPREQ .NE. KLDUM)  THEN
   6037       WRITE(6,171) NPREQ,KLDUM
   6038   171 FORMAT(/'******A SERIOUS ERROR HAS OCCURRED, NPREQ AND KLDUM ',
   6039      1       'ARE NOT EQUAL IN SETUP.',/,12X,'NPREQ, KLDUM=',2I5)
   6040       ENDIF
   6041 
   6042       IF(NVREQ .NE. JVDUM)  THEN
   6043       WRITE(6,173) NVREQ,JVDUM
   6044   173 FORMAT(/'******A SERIOUS ERROR HAS OCCURRED, NVREQ AND JVDUM ',
   6045      1       'ARE NOT EQUAL IN SETUP.',/,12X,'NVREQ, JVDUM=',2I5)
   6046       CALL ABRT1(' SETUP ',173)
   6047       ENDIF
   6048 
   6049       WRITE(6,181) (KP,IPREQ(KP),KP=1,NPREQ)
   6050   181 FORMAT(/'...REQUESTED AND CHECKED PRESSURE LEVELS IN SETUP ARE:',
   6051      1       /,(10X,2I5))
   6052 
   6053       WRITE(6,183) (JV,IVREQ(JV),JV=1,NVREQ)
   6054   183 FORMAT(/'...REQUESTED AND CHECKED VARIABLES IN SETUP ARE:',/,
   6055      1       (10X,2I5))
   6056 
   6057       RETURN
   6058       END

Page 157         Source Listing                  SETUP
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 setup_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 111                        Label  5998                                                           5997                              
 113                        Label  6004                                                           6003                              
 114                        Label  6008                                                           6007                              
 130                        Label  6020                                                           6015                              
 140                        Label  6028                                                           6023                              
 171                        Label  6038                                                           6037                              
 173                        Label  6044                                                           6043                              
 181                        Label  6050                                                           6049                              
 183                        Label  6054                                                           6053                              
 3                          Label  5912                                                           5909                              
 31                         Label  5948                                                           5947                              
 33                         Label  5955                                                           5954                              
 4                          Label  5915                                                           5911                              
 40                         Label  5967                                                           5962                              
 50                         Label  5975                                                           5970                              
 51                         Label  5979                                                           5978                              
 ABRT1                      Subr   5950                                                           5950,5956,5999,6009,6046          
 IMFLTP                     Dummy  5901     I(4)            4           scalar   ARG,INOUT        5909,5937,5940,5946,5947          
 IPDUM                      Dummy  5901     I(4)            4     1     0        ARG,INOUT        5917,5938,5941,5988,5991,5994     
 IPREQ                      Dummy  5901     I(4)            4     1     0        ARG,INOUT        5910,5918,6032,6049               
 IPREQZ                     Dummy  5901     I(4)            4     1     0        ARG,INOUT        5918,5938,5941,5963,5965,5988,5991
                                                                                                  ,5994,6016,6018,6032              
 IVDUM                      Dummy  5902     I(4)            4     1     0        ARG,INOUT        5920,5939,5942,5989,5992,5995     
 IVFLTP                     Dummy  5901     I(4)            4           scalar   ARG,INOUT        5909,5987,5990,5993,5997          
 IVOTYP                     Dummy  5901     I(4)            4           scalar   ARG,INOUT        5909,5983,6002,6003,6007          
 IVREQ                      Dummy  5902     I(4)            4     1     0        ARG,INOUT        5911,5921,6034,6053               
 IVREQZ                     Dummy  5902     I(4)            4     1     0        ARG,INOUT        5921,5939,5942,5971,5973,5989,5992
                                                                                                  ,5995,6024,6026,6034              
 JJ                         Local  5969     I(4)            4           scalar   SAVE             5969,5972,5973,5977,6022,6025,6026
                                                                                                  ,6030                             
 JV                         Local  5911     I(4)            4           scalar   SAVE             5911,5970,5971,5973,6023,6024,6026
                                                                                                  ,6053                             
 JVDUM                      Local  5939     I(4)            4           scalar   SAVE             5939,5942,5989,5992,5995,6042,6043
 JVMAX                      Local  5924     I(4)            4           scalar   SAVE             5924,5939,5942,5970,5977,5978,5989
                                                                                                  ,5992,5995,6023                   
 KK                         Local  5961     I(4)            4           scalar   SAVE             5961,5964,5965,5976,6014,6017,6018
                                                                                                  ,6029                             
 KL                         Local  5962     I(4)            4           scalar   SAVE             5962,5963,5965,6015,6016,6018     
 KLDUM                      Local  5938     I(4)            4           scalar   SAVE             5938,5941,5988,5991,5994,6036,6037
 KLMAX                      Local  5923     I(4)            4           scalar   SAVE             5923,5938,5941,5962,5976,5978,5988
                                                                                                  ,5991,5994,6015                   
 KP                         Local  5910     I(4)            4           scalar   SAVE             5910,6049                         
 MODTYP                     Dummy  5901     I(4)            4           scalar   ARG,INOUT        5909,5933,5945,5954               
 NPREQ                      Dummy  5902     I(4)            4           scalar   ARG,INOUT        5906,5907,5909,5910,5923,6029,6036

Page 158         Source Listing                  SETUP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,6037,6049                        
 NVREQ                      Dummy  5902     I(4)            4           scalar   ARG,INOUT        5906,5907,5909,5911,5924,6030,6042
                                                                                                  ,6043,6053                        
 SETUP                      Subr   5901                                                                                             
 SLVSP1                     Subr   5938                                                           5938                              
 SLVSP2                     Subr   5941                                                           5941                              
 SLVVO1                     Subr   5988                                                           5988                              
 SLVVO2                     Subr   5991                                                           5991                              
 SLVVO3                     Subr   5994                                                           5994                              
 SVRSP1                     Subr   5939                                                           5939                              
 SVRSP2                     Subr   5942                                                           5942                              
 SVRVO1                     Subr   5989                                                           5989                              
 SVRVO2                     Subr   5992                                                           5992                              
 SVRVO3                     Subr   5995                                                           5995                              

Page 159         Source Listing                  SETUP
2017-04-18 11:09                                 syndata.f

   6059 
   6060 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6061 C                .      .    .                                       .
   6062 C SUBPROGRAM:    SETVOR      PROCESSES VORTEX FILE STRUCTURE
   6063 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   6064 C
   6065 C ABSTRACT: PROCESSES INFORMATION ABOUT VORTEX VARIABLES AND LEVELS
   6066 C   THAT WILL BE MADE BY VARIOUS TYPES OF VORTEX SUBROUTINES.
   6067 C
   6068 C PROGRAM HISTORY LOG:
   6069 C 1991-06-06  S. J. LORD
   6070 C
   6071 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   6072 C   INPUT ARGUMENT LIST:
   6073 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   6074 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   6075 C
   6076 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   6077 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   6078 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   6079 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   6080 C
   6081 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   6082 C     DDNAME1  - GENERIC NAME & CONTENT
   6083 C
   6084 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   6085 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   6086 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   6087 C
   6088 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   6089 C
   6090 C ATTRIBUTES:
   6091 C   LANGUAGE: FORTRAN 90
   6092 C   MACHINE:  NCEP WCOSS
   6093 C
   6094 C$$$
   6095 C
   6096 C     *****************************
   6097 C     ****  SUBROUTINE SETVOR  ****
   6098 C     ****     ENTRY SLVVO1    ****
   6099 C     ****     ENTRY SVRVO1    ****
   6100 C     ****     ENTRY SLVVO2    ****
   6101 C     ****     ENTRY SVRVO2    ****
   6102 C     ****     ENTRY SLVVO3    ****
   6103 C     ****     ENTRY SVRVO3    ****
   6104 C     *****************************
   6105 C
   6106       SUBROUTINE SETVOR(KLMAX,IPREQ,ILVL,INDXP,KLBOG,JVMAX,IVREQ,IVAR,
   6107      1                  INDXV,JVBOG)
   6108 C
   6109 C**DEB  PARAMETER(KDIM=#PLEVS)  PL1 PARAMETERS ARE A POSSIBILITY HERE
   6110       PARAMETER(KDIMV1=10)
   6111       PARAMETER(JDIMV1= 4)
   6112       PARAMETER(KDIMV2=12)
   6113       PARAMETER(JDIMV2= 4)
   6114       PARAMETER(KDIMV3=12)
   6115       PARAMETER(JDIMV3= 5)

Page 160         Source Listing                  SETVOR
2017-04-18 11:09                                 syndata.f

   6116 C
   6117       SAVE
   6118 C
   6119       DIMENSION IPREQ(KLMAX),ILVL(KLMAX),INDXP(KLMAX),IPFL1(KDIMV1),
   6120      1          IVREQ(JVMAX),IVAR(JVMAX),INDXV(JVMAX),IVFL1(JDIMV1),
   6121      2          IPFL2(KDIMV2),IVFL2(JDIMV2),IPFL3(KDIMV3),IVFL3(JDIMV3)
   6122 C
   6123       LOGICAL FOUND
   6124 C
   6125       DATA IPFL1/1000,850,700,500,400,300,250,200,150,100/
   6126       DATA IVFL1/3,4,5,6/
   6127       DATA IPFL2/1000,850,700,500,400,300,250,200,150,100.,70.,50./
   6128       DATA IVFL2/3,4,5,6/
   6129       DATA IPFL3/1000,850,700,500,400,300,250,200,150,100.,70.,50./
   6130       DATA IVFL3/3,4,5,6,7/
   6131 C
   6132 C     THIS SET OF ENTRIES IN SUBROUTINE SETVOR CONTAINS VORTEX SPECIFIC
   6133 C       INFORMATION ABOUT THE FILE STRUCTURES.  CURRENT VORTEX
   6134 C       TYPES ARE:
   6135 C          IVFLTP=1: MATHUR 3-D POSTPROCESSED U,V,Z FILE
   6136 C          IVFLTP=2: MATHUR 2-D VORTEX
   6137 C          IVFLTP=3: SHAPIRO 2-D ANGULAR MOMENTUM VORTEX
   6138 C                    CREATES BOTH RADIAL AND TANGENTIAL WIND
   6139 C
   6140 
   6141 C-----------------------------------------------------------------------
   6142 
   6143 C
   6144 C     ++++++++++++++++++++++++
   6145 C     ++++  ENTRY SLVVO1  ++++
   6146 C     ++++++++++++++++++++++++
   6147 C
   6148       ENTRY SLVVO1(KLMAX,IPREQ,ILVL,INDXP,KLBOG)
   6149 C
   6150       KL=0
   6151       DO 40 KP=1,KLMAX
   6152       FOUND=.FALSE.
   6153       DO 20 KLF=1,KDIMV1
   6154       IF(IPREQ(KP) .EQ. IPFL1(KLF))   THEN
   6155       FOUND=.TRUE.
   6156       KL=KL+1
   6157       ILVL(KL)=IPFL1(KLF)
   6158       INDXP(KL)=KLF
   6159       ENDIF
   6160    20 CONTINUE
   6161 C
   6162       IF(.NOT. FOUND)  THEN
   6163       WRITE(6,21) IPREQ(KP)
   6164    21 FORMAT('###### PRESSSURE LEVEL',I3,' NOT AVAILABLE IN ',
   6165      1       'VORTEX FILE.')
   6166       IPREQ(KP)=-IPREQ(KP)
   6167       ENDIF
   6168 C
   6169    40 CONTINUE
   6170       KLBOG=KL
   6171       RETURN
   6172 

Page 161         Source Listing                  SETVOR
2017-04-18 11:09                                 syndata.f

   6173 C-----------------------------------------------------------------------
   6174 
   6175 C
   6176 C
   6177 C     ++++++++++++++++++++++++
   6178 C     ++++  ENTRY SVRVO1  ++++
   6179 C     ++++++++++++++++++++++++
   6180 C
   6181       ENTRY SVRVO1(JVMAX,IVREQ,IVAR,INDXV,JVBOG)
   6182 C
   6183       JV=0
   6184       DO 140 JJ=1,JVMAX
   6185       FOUND=.FALSE.
   6186       DO 120 JLF=1,JDIMV1
   6187       IF(IVREQ(JJ) .EQ. IVFL1(JLF))   THEN
   6188       FOUND=.TRUE.
   6189       JV=JV+1
   6190       IVAR(JV)=IVFL1(JLF)
   6191       INDXV(JV)=JLF
   6192       ENDIF
   6193   120 CONTINUE
   6194 C
   6195       IF(.NOT. FOUND)  THEN
   6196       WRITE(6,121) IVREQ(JJ)
   6197   121 FORMAT('###### VARIABLE',I3,' NOT AVAILABLE IN VORTEX FILE.')
   6198       IVREQ(JJ)=-IVREQ(JJ)
   6199       ENDIF
   6200 C
   6201   140 CONTINUE
   6202       JVBOG=JV
   6203       RETURN
   6204 
   6205 C-----------------------------------------------------------------------
   6206 
   6207 C
   6208 C     ++++++++++++++++++++++++
   6209 C     ++++  ENTRY SLVVO2  ++++
   6210 C     ++++++++++++++++++++++++
   6211 C
   6212       ENTRY SLVVO2(KLMAX,IPREQ,ILVL,INDXP,KLBOG)
   6213 C
   6214       KL=0
   6215       DO 240 KP=1,KLMAX
   6216       FOUND=.FALSE.
   6217       DO 220 KLF=1,KDIMV2
   6218       IF(IPREQ(KP) .EQ. IPFL2(KLF))   THEN
   6219       FOUND=.TRUE.
   6220       KL=KL+1
   6221       ILVL(KL)=IPFL2(KLF)
   6222       INDXP(KL)=KLF
   6223       ENDIF
   6224   220 CONTINUE
   6225 C
   6226       IF(.NOT. FOUND)  THEN
   6227       WRITE(6,221) IPREQ(KP)
   6228   221 FORMAT('###### PRESSSURE LEVEL',I3,' NOT AVAILABLE IN ',
   6229      1       'VORTEX FILE.')

Page 162         Source Listing                  SETVOR
2017-04-18 11:09                                 syndata.f

   6230       IPREQ(KP)=-IPREQ(KP)
   6231       ENDIF
   6232 C
   6233   240 CONTINUE
   6234       KLBOG=KL
   6235       RETURN
   6236 
   6237 C-----------------------------------------------------------------------
   6238 
   6239 C
   6240 C     ++++++++++++++++++++++++
   6241 C     ++++  ENTRY SVRVO2  ++++
   6242 C     ++++++++++++++++++++++++
   6243 C
   6244       ENTRY SVRVO2(JVMAX,IVREQ,IVAR,INDXV,JVBOG)
   6245 C
   6246       JV=0
   6247       DO 340 JJ=1,JVMAX
   6248       FOUND=.FALSE.
   6249       DO 320 JLF=1,JDIMV2
   6250       IF(IVREQ(JJ) .EQ. IVFL2(JLF))   THEN
   6251       FOUND=.TRUE.
   6252       JV=JV+1
   6253       IVAR(JV)=IVFL2(JLF)
   6254       INDXV(JV)=JLF
   6255       ENDIF
   6256   320 CONTINUE
   6257 C
   6258       IF(.NOT. FOUND)  THEN
   6259       WRITE(6,321) IVREQ(JJ)
   6260   321 FORMAT('###### VARIABLE',I3,' NOT AVAILABLE IN VORTEX FILE.')
   6261       IVREQ(JJ)=-IVREQ(JJ)
   6262       ENDIF
   6263 C
   6264   340 CONTINUE
   6265       JVBOG=JV
   6266       RETURN
   6267 
   6268 C-----------------------------------------------------------------------
   6269 
   6270 C
   6271 C     ++++++++++++++++++++++++
   6272 C     ++++  ENTRY SLVVO3  ++++
   6273 C     ++++++++++++++++++++++++
   6274 C
   6275       ENTRY SLVVO3(KLMAX,IPREQ,ILVL,INDXP,KLBOG)
   6276 C
   6277       KL=0
   6278       DO 440 KP=1,KLMAX
   6279       FOUND=.FALSE.
   6280       DO 420 KLF=1,KDIMV3
   6281       IF(IPREQ(KP) .EQ. IPFL3(KLF))   THEN
   6282       FOUND=.TRUE.
   6283       KL=KL+1
   6284       ILVL(KL)=IPFL3(KLF)
   6285       INDXP(KL)=KLF
   6286       ENDIF

Page 163         Source Listing                  SETVOR
2017-04-18 11:09                                 syndata.f

   6287   420 CONTINUE
   6288 C
   6289       IF(.NOT. FOUND)  THEN
   6290       WRITE(6,421) IPREQ(KP)
   6291   421 FORMAT('###### PRESSSURE LEVEL',I3,' NOT AVAILABLE IN ',
   6292      1       'VORTEX FILE.')
   6293       IPREQ(KP)=-IPREQ(KP)
   6294       ENDIF
   6295 C
   6296   440 CONTINUE
   6297       KLBOG=KL
   6298       RETURN
   6299 
   6300 C-----------------------------------------------------------------------
   6301 
   6302 C
   6303 C     ++++++++++++++++++++++++
   6304 C     ++++  ENTRY SVRVO3  ++++
   6305 C     ++++++++++++++++++++++++
   6306 C
   6307       ENTRY SVRVO3(JVMAX,IVREQ,IVAR,INDXV,JVBOG)
   6308 C
   6309       JV=0
   6310       DO 540 JJ=1,JVMAX
   6311       FOUND=.FALSE.
   6312       DO 520 JLF=1,JDIMV3
   6313       IF(IVREQ(JJ) .EQ. IVFL3(JLF))   THEN
   6314       FOUND=.TRUE.
   6315       JV=JV+1
   6316       IVAR(JV)=IVFL3(JLF)
   6317       INDXV(JV)=JLF
   6318       ENDIF
   6319   520 CONTINUE
   6320 C
   6321       IF(.NOT. FOUND)  THEN
   6322       WRITE(6,521) IVREQ(JJ)
   6323   521 FORMAT('###### VARIABLE',I3,' NOT AVAILABLE IN VORTEX FILE.')
   6324       IVREQ(JJ)=-IVREQ(JJ)
   6325       ENDIF
   6326 C
   6327   540 CONTINUE
   6328       JVBOG=JV
   6329       RETURN
   6330       END

Page 164         Source Listing                  SETVOR
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 setvor_               slvvo2_               svrvo1_               svrvo3_             
 slvvo1_               slvvo3_               svrvo2_                                   


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 120                        Label  6193                                                           6186                              
 121                        Label  6197                                                           6196                              
 140                        Label  6201                                                           6184                              
 20                         Label  6160                                                           6153                              
 21                         Label  6164                                                           6163                              
 220                        Label  6224                                                           6217                              
 221                        Label  6228                                                           6227                              
 240                        Label  6233                                                           6215                              
 320                        Label  6256                                                           6249                              
 321                        Label  6260                                                           6259                              
 340                        Label  6264                                                           6247                              
 40                         Label  6169                                                           6151                              
 420                        Label  6287                                                           6280                              
 421                        Label  6291                                                           6290                              
 440                        Label  6296                                                           6278                              
 520                        Label  6319                                                           6312                              
 521                        Label  6323                                                           6322                              
 540                        Label  6327                                                           6310                              
 FOUND                      Local  6123     L(4)            4           scalar   SAVE             6152,6155,6162,6185,6188,6195,6216
                                                                                                  ,6219,6226,6248,6251,6258,6279,628
                                                                                                  2,6289,6311,6314,6321             
 ILVL                       Dummy  6106     I(4)            4     1     0        ARG,INOUT        6157,6221,6284                    
 INDXP                      Dummy  6106     I(4)            4     1     0        ARG,INOUT        6158,6222,6285                    
 INDXV                      Dummy  6107     I(4)            4     1     0        ARG,INOUT        6191,6254,6317                    
 IPFL1                      Local  6119     I(4)            4     1     10       SAVE             6125,6154,6157                    
 IPFL2                      Local  6121     I(4)            4     1     12       SAVE             6127,6218,6221                    
 IPFL3                      Local  6121     I(4)            4     1     12       SAVE             6129,6281,6284                    
 IPREQ                      Dummy  6106     I(4)            4     1     0        ARG,INOUT        6154,6163,6166,6218,6227,6230,6281
                                                                                                  ,6290,6293                        
 IVAR                       Dummy  6106     I(4)            4     1     0        ARG,INOUT        6190,6253,6316                    
 IVFL1                      Local  6120     I(4)            4     1     4        SAVE             6126,6187,6190                    
 IVFL2                      Local  6121     I(4)            4     1     4        SAVE             6128,6250,6253                    
 IVFL3                      Local  6121     I(4)            4     1     5        SAVE             6130,6313,6316                    
 IVREQ                      Dummy  6106     I(4)            4     1     0        ARG,INOUT        6187,6196,6198,6250,6259,6261,6313
                                                                                                  ,6322,6324                        
 JDIMV1                     Param  6111     I(4)            4           scalar                    6120,6186                         
 JDIMV2                     Param  6113     I(4)            4           scalar                    6121,6249                         
 JDIMV3                     Param  6115     I(4)            4           scalar                    6121,6312                         
 JJ                         Local  6184     I(4)            4           scalar   SAVE             6184,6187,6196,6198,6247,6250,6259
                                                                                                  ,6261,6310,6313,6322,6324         
 JLF                        Local  6186     I(4)            4           scalar   SAVE             6186,6187,6190,6191,6249,6250,6253
                                                                                                  ,6254,6312,6313,6316,6317         
 JV                         Local  6183     I(4)            4           scalar   SAVE             6183,6189,6190,6191,6202,6246,6252

Page 165         Source Listing                  SETVOR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,6253,6254,6265,6309,6315,6316,631
                                                                                                  7,6328                            
 JVBOG                      Dummy  6107     I(4)            4           scalar   ARG,INOUT        6202,6265,6328                    
 JVMAX                      Dummy  6106     I(4)            4           scalar   ARG,INOUT        6120,6184,6247,6310               
 KDIMV1                     Param  6110     I(4)            4           scalar                    6119,6153                         
 KDIMV2                     Param  6112     I(4)            4           scalar                    6121,6217                         
 KDIMV3                     Param  6114     I(4)            4           scalar                    6121,6280                         
 KL                         Local  6150     I(4)            4           scalar   SAVE             6150,6156,6157,6158,6170,6214,6220
                                                                                                  ,6221,6222,6234,6277,6283,6284,628
                                                                                                  5,6297                            
 KLBOG                      Dummy  6106     I(4)            4           scalar   ARG,INOUT        6170,6234,6297                    
 KLF                        Local  6153     I(4)            4           scalar   SAVE             6153,6154,6157,6158,6217,6218,6221
                                                                                                  ,6222,6280,6281,6284,6285         
 KLMAX                      Dummy  6106     I(4)            4           scalar   ARG,INOUT        6119,6151,6215,6278               
 KP                         Local  6151     I(4)            4           scalar   SAVE             6151,6154,6163,6166,6215,6218,6227
                                                                                                  ,6230,6278,6281,6290,6293         
 SETVOR                     Subr   6106                                                                                             
 SLVVO1                     Subr   6148                                                                                             
 SLVVO2                     Subr   6212                                                                                             
 SLVVO3                     Subr   6275                                                                                             
 SVRVO1                     Subr   6181                                                                                             
 SVRVO2                     Subr   6244                                                                                             
 SVRVO3                     Subr   6307                                                                                             

Page 166         Source Listing                  SETVOR
2017-04-18 11:09                                 syndata.f

   6331 
   6332 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6333 C                .      .    .                                       .
   6334 C SUBPROGRAM:    MM3DVO      MUKUT MATHUR POSTPROCESSED VORTEX READER
   6335 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   6336 C
   6337 C ABSTRACT: READS THE FILE FORMAT FOR MUKUT MATHUR'S 3-D VORTEX
   6338 C   WHICH IS USED FOR BOGUSING IN THE QLM.
   6339 C
   6340 C PROGRAM HISTORY LOG:
   6341 C 1991-06-06  S. J. LORD
   6342 C
   6343 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   6344 C   INPUT ARGUMENT LIST:
   6345 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   6346 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   6347 C
   6348 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   6349 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   6350 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   6351 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   6352 C
   6353 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   6354 C     DDNAME1  - GENERIC NAME & CONTENT
   6355 C
   6356 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   6357 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   6358 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   6359 C
   6360 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   6361 C
   6362 C ATTRIBUTES:
   6363 C   LANGUAGE: FORTRAN 90
   6364 C   MACHINE:  NCEP WCOSS
   6365 C
   6366 C$$$
   6367 C
   6368 C     *****************************
   6369 C     ****  SUBROUTINE MM3DVO  ****
   6370 C     *****************************
   6371 C
   6372       SUBROUTINE MM3DVO(IPRNTV,IUNTRV,IUNTPV,IUNTTK,IUNTDO,IUNTBH,IPRES,
   6373      1                  INDXP,KLVLS,IVAR,JVBOG,RMXBOG,DELTA,STMLTZ,
   6374      2                  STMLNZ,RLATMN,RLATMX,RLONMN,RLONMX,IDAYZ,IUTCZ,
   6375      3                  STMNMZ)
   6376 C
   6377       PARAMETER(IDIM=11,JDIM=11,KMDIM=1,JVMDIM=3)
   6378       PARAMETER(ITRKMX=3)
   6379 C
   6380       COMMON/VARS/ RMVARS(IDIM,JDIM,KMDIM,JVMDIM)
   6381 C
   6382       LOGICAL BOGVAR
   6383 C
   6384       SAVE
   6385 C
   6386       CHARACTER FLAG*4,STMNMZ*9
   6387 C

Page 167         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6388       DIMENSION UP(IDIM,JDIM,KMDIM),VP(IDIM,JDIM,KMDIM),
   6389      1          ZP(IDIM,JDIM,KMDIM),RLAT(IDIM,JDIM),RLON(IDIM,JDIM),
   6390      2          IPRES(KLVLS),INDXP(KLVLS),IVAR(JVBOG),BOGVAR(JVMDIM),
   6391      3          IDAYZZ(ITRKMX),IUTCZZ(ITRKMX),STLTZZ(ITRKMX),
   6392      4          STLNZZ(ITRKMX)
   6393 C
   6394       EQUIVALENCE (RMVARS(1,1,1,1),ZP(1,1,1)),(RMVARS(1,1,1,2),
   6395      1             UP(1,1,1)),(RMVARS(1,1,1,3),VP(1,1,1))
   6396 C
   6397       DATA  EPSVP/0.1/,DEGFAC/57.29578/,RMISS/-99.0/,FLAG/'0000'/
   6398 C
   6399 C     SET UP VARIABLES TO BE BOGUSSED.  THE EXPECTED RANGE OF
   6400 C       IVAR IS:
   6401 C                   3  : HEIGHT
   6402 C                   4,5: TOTAL WIND=TANGENTIAL WIND FOR THIS
   6403 C                          AXISYMMETRIC VORTEX
   6404 C                   6  : ROTATIONAL WIND=TOTAL WIND FOR THIS VORTEX
   6405 C
   6406       DO 1 JV=1,JVBOG
   6407       IF(IVAR(JV) .LE. JVMDIM+2)  THEN
   6408       BOGVAR(IVAR(JV)-2)=.TRUE.
   6409       ELSE IF(IVAR(JV) .EQ. 6)  THEN
   6410       BOGVAR(2)=.TRUE.
   6411       BOGVAR(3)=.TRUE.
   6412       ENDIF
   6413     1 CONTINUE
   6414 C
   6415 C     MAKE SURE DIMENSIONS ARE SET CORRECTLY
   6416 C
   6417       IF(IDIM .NE. 111 .OR. JDIM .NE. 111)  THEN
   6418       WRITE(6,3) IDIM,JDIM
   6419     3 FORMAT(/'******DIMENSIONS IN MM3DVO NOT SET CORRECTLY. ',
   6420      1       'IDIM,JDIM=',2I4)
   6421       CALL ABRT1(' MM3DVO',3)
   6422       ENDIF
   6423 C
   6424       NREC=0
   6425       NLEV=0
   6426       ITYP=12
   6427 C
   6428 C     ASSUME MUKUT MATHUR'S MODEL HAS GRID SPACING OF 40 KM.
   6429 C        WE SAMPLE THE MODEL'S DATA OUT TO SOME MULTIPLE OF RMAX
   6430 C        (RMXBOG), AND RMAX IS THE RADIUS OF THE OUTERMOST CLOSED
   6431 C        ISOBAR AND COMES FROM THE VITAL STATISTICS FILE.
   6432 C        OUTSIDE RMAX, THE WINDS ARE ZERO AND THE HEIGHT DEVIATIONS
   6433 C        ARE ZERO.
   6434 C
   6435       DELXMM=40.
   6436       DELYMM=40.
   6437 C
   6438       print *, ' '
   6439       print *, ' '
   6440       WRITE(6,6)
   6441       WRITE(6,6)
   6442       WRITE(6,7)
   6443       WRITE(6,8) STMNMZ,IDAYZ,IUTCZ,STMLTZ,STMLNZ,RMXBOG,RLATMN,
   6444      1           RLATMX,RLONMN,RLONMX

Page 168         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6445       WRITE(6,7)
   6446       WRITE(6,6)
   6447       WRITE(6,6)
   6448       WRITE(IUNTBH,6)
   6449       WRITE(IUNTBH,6)
   6450       WRITE(IUNTBH,7)
   6451       WRITE(IUNTBH,8) STMNMZ,IDAYZ,IUTCZ,STMLTZ,STMLNZ,RMXBOG,RLATMN,
   6452      1                RLATMX,RLONMN,RLONMX
   6453       WRITE(IUNTBH,7)
   6454       WRITE(IUNTBH,6)
   6455       WRITE(IUNTBH,6)
   6456     6 FORMAT(20X,'**********************************************')
   6457     7 FORMAT(20X,'****                                      ****')
   6458     8 FORMAT(20X,'****  MATHUR 3-D VORTEX FROM PPUVZF FILE  ****',/
   6459      1       20X,'****',8X,'STORM:',A13,11X,'****',/
   6460      2       20X,'****',4X,'DATE:',I9,' TIME:',I5,9X,'****',/
   6461      3       20X,'****',5X,'LAT:',F8.2,'  LON:',F8.2,7X,'****',/
   6462      4       20X,'****',5X,'RMXBOG:',F8.1,18X,'****',/
   6463      5       20X,'****',5X,'YNB:',F8.2,'  YNT:',F8.2,7X,'****',/
   6464      6       20X,'****',5X,'XML:',F8.2,'  XMR:',F8.2,7X,'****')
   6465 C
   6466       IRAD=IFIX(RMXBOG/DELXMM)
   6467       JRAD=IFIX(RMXBOG/DELYMM)
   6468       WRITE(6,16) IRAD,JRAD
   6469    16 FORMAT(/'...APPROXIMATE INDICES OF RADIAL EXTENT ARE: IRAD,JRAD=',
   6470      1       2I5)
   6471 C
   6472 C     OPEN FILES
   6473 C
   6474       OPEN(UNIT=IUNTRV,ACCESS='SEQUENTIAL',
   6475      1     STATUS='OLD',FORM='UNFORMATTED')
   6476 CIBM 1     STATUS='OLD',ACTION='READ',FORM='UNFORMATTED')
   6477       OPEN(UNIT=IUNTPV,ACCESS='SEQUENTIAL',
   6478      1     STATUS='OLD',FORM='UNFORMATTED')
   6479 C
   6480       READ(IUNTRV) RLAT
   6481       READ(IUNTRV) RLON
   6482       READ(IUNTRV) UP
   6483       READ(IUNTRV) VP
   6484       READ(IUNTRV) ZP
   6485 C
   6486       DO 30 J=1,JDIM
   6487       DO 20 I=1,IDIM
   6488       RLAT(I,J)=RLAT(I,J)*DEGFAC
   6489       RLON(I,J)=RLON(I,J)*DEGFAC
   6490    20 CONTINUE
   6491    30 CONTINUE
   6492 C
   6493       ICEN=56
   6494       JCEN=56
   6495 C
   6496       WRITE(6,31) ICEN,JCEN
   6497    31 FORMAT(/'...ICEN,JCEN=',2I5//)
   6498       WRITE(6,32) (J,J=1,IDIM)
   6499       WRITE(6,33) (RLAT(ICEN,J),J=1,JDIM)
   6500       print *, ' '
   6501       print *, ' '

Page 169         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6502       WRITE(6,34) (I,I=1,JDIM)
   6503       WRITE(6,33) (RLON(I,JCEN),I=1,IDIM)
   6504    32 FORMAT(/'...CENTER LATITUDES  (ICEN,J) ARE:',/,(13X,10I11))
   6505    34 FORMAT(/'...CENTER LONGITUDES (I,JCEN) ARE:',/,(13X,10I11))
   6506    33 FORMAT(12X,10F11.2)
   6507 C
   6508 C     CHECK THAT THE INPUT LAT/LON POSITION OF THE STORM COINCIDES
   6509 C       WITH THE LAT/LON OF THE VORTEX CENTER AT ICEN,JCEN=56,56
   6510 C
   6511       RLATCZ=RLAT(ICEN,JCEN)
   6512       RLONCZ=360.-RLON(ICEN,JCEN)
   6513 C
   6514       IF(NINT(ABS(STMLTZ-RLAT(ICEN,JCEN))*100.).GT.NINT(EPSVP*100.) .OR.
   6515      1   NINT(ABS(STMLNZ-RLONCZ)*100.)         .GT.NINT(EPSVP*100.))THEN
   6516       WRITE(6,43) STMLTZ,STMLNZ,RLATCZ,RLONCZ
   6517    43 FORMAT(/'******A SEVERE ERROR HAS OCCURRED IN MM3DVO, VORTEX ',
   6518      1       'POSITION AND CENTER OF 3-D VORTEX DO NOT AGREE.',/,7X,
   6519      2       'STMLAT,STMLON,RLAT(ICEN,JCEN),RLON(ICEN,JCEN)=',4F12.4)
   6520       CALL ABRT1(' MM3DVO',43)
   6521       ENDIF
   6522 C
   6523       IMIN=ICEN-IRAD-1
   6524       IMAX=ICEN+IRAD
   6525       JMIN=JCEN-JRAD-1
   6526       JMAX=JCEN+JRAD
   6527       IMAX2=(IMIN+IMAX)/2
   6528       JMAX2=(JMIN+JMAX)/2
   6529 C
   6530    51 XML=RLON(IMIN,JMAX2)
   6531       IF(NINT(XML*100.) .LT. NINT((360.-RLONMN)*100.))  THEN
   6532       IMIN=MAX(1,IMIN-1)
   6533       WRITE(6,511) XML,RLONMN,IMIN
   6534   511 FORMAT('...REVISING ESTIMATE FOR IMIN: XML, RLONMN, NEW IMIN=',
   6535      1       2F12.4,I5)
   6536       GO TO 51
   6537       ENDIF
   6538 C
   6539    52 XMR=RLON(IMAX,JMAX2)
   6540       IF(NINT(XMR*100.) .GT. NINT((360.-RLONMX)*100.))  THEN
   6541       IMAX=MIN(IDIM,IMAX+1)
   6542       WRITE(6,512) XMR,RLONMX,IMAX
   6543   512 FORMAT('...REVISING ESTIMATE FOR IMAX: XMR, RLONMX, NEW IMAX=',
   6544      1       2F12.4,I5)
   6545       GO TO 52
   6546       ENDIF
   6547 C
   6548    53 YNB=RLAT(IMAX2,JMIN)
   6549       IF(NINT(YNB*100.) .GT. NINT(RLATMN*100.))  THEN
   6550       JMIN=MAX(1,JMIN-1)
   6551       WRITE(6,513) YNB,RLATMN,JMIN
   6552   513 FORMAT('...REVISING ESTIMATE FOR JMIN: YNB, RLATMN, NEW JMIN=',
   6553      1       2F12.4,I5)
   6554       GO TO 53
   6555       ENDIF
   6556 C
   6557    54 YNT=RLAT(IMAX2,JMAX)
   6558       IF(NINT(YNT*100.) .LT. NINT(RLATMX*100.))  THEN

Page 170         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6559       JMAX=MIN(JDIM,JMAX+1)
   6560       WRITE(6,514) YNT,RLATMX,JMAX
   6561   514 FORMAT('...REVISING ESTIMATE FOR JMAX: YNT, RLATMX, NEW JMAX=',
   6562      1       2F12.4,I5)
   6563       GO TO 54
   6564       ENDIF
   6565 C
   6566 C     CONVERT LONGITUDES TO DEGREES WEST FOR MATHUR'S PROGRAMS AND
   6567 C       THE 2-D SPLINE ANALYSIS FILTER
   6568 C
   6569       XMLZ=360.-RLONMN
   6570       XMRZ=360.-RLONMX
   6571       YNBZ=RLATMN
   6572       YNTZ=RLATMX
   6573 C
   6574       WRITE(6,57) IDIM,JDIM,IMIN,IMAX,JMIN,JMAX,IMAX2,JMAX2
   6575    57 FORMAT(/'...TOTAL ARRAY SIZE (IDIM,JDIM)=(',I4,',',I4,')',/,
   6576      1       ' ...SAMPLED ARRAY IS (IMIN,IMAX,JMIN,JMAX)=(',I4,',',
   6577      2       I4,',',I4,',',I4,')',/,' ...MIDDLE LON,LAT INDICES ARE',
   6578      3       '(',I4,',',I4,')')
   6579       WRITE(6,59) XMLZ,XMRZ,YNBZ,YNTZ
   6580    59 FORMAT('...CORNER LONGITUDES, LATITUDES ARE:',4F8.2)
   6581 C
   6582 C     SET VARIABLES THAT WILL NOT BE BOGUSSED TO MISSING
   6583 C
   6584       DO 70 JV=1,JVMDIM
   6585 C
   6586       IF(.NOT. BOGVAR(JV))  THEN
   6587       WRITE(6,61)  JV
   6588    61 FORMAT('######VARIABLE INDEX',I3,' IS SET TO MISSING.')
   6589 
   6590       RMVARS(:,:,:,JV)=RMISS
   6591       ENDIF
   6592 C
   6593    70 CONTINUE
   6594 C
   6595       RITYP=REAL(ITYP)
   6596       UTC0=REAL(IUTCZ)
   6597       KK=1
   6598       DO 100 KL=1,KMDIM
   6599       IF(KL .EQ. INDXP(KK))  THEN
   6600         NLEV=NLEV+1
   6601         IF(NLEV .EQ. 1)  THEN
   6602         WRITE(6,81) KL,IPRES(KK),(J,J=1,IDIM)
   6603         WRITE(6,82) (UP(ICEN,J,KL),J=1,JDIM)
   6604         WRITE(6,83) KL,IPRES(KK),(I,I=1,JDIM)
   6605         WRITE(6,82) (VP(I,JCEN,KL),I=1,IDIM)
   6606         WRITE(6,84) KL,IPRES(KK),(I,I=1,JDIM)
   6607         WRITE(6,82) (ZP(I,JCEN,KL),I=1,IDIM)
   6608    81   FORMAT(//'...CENTER ZONAL WINDS (ICEN,J) FOR INDEX,PRES=',
   6609      1         2I5,' ARE:',/,(13X,10I11))
   6610    83   FORMAT(//'...CENTER MERIDIONAL WINDS (ICEN,J) FOR INDEX,PRES=',
   6611      1         2I5,' ARE:',/,(13X,10I11))
   6612    84   FORMAT(//'...CENTER HEIGHT DEVIATIONS (ICEN,J) FOR INDEX,PRES=',
   6613      1         2I5,' ARE:',/,(13X,10I11))
   6614    82   FORMAT(12X,10F11.2)
   6615         print *, ' '

Page 171         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6616         print *, ' '
   6617         ENDIF
   6618 C
   6619         PP=REAL(IPRES(KK))
   6620         DO J=JMIN,JMAX
   6621         DO I=IMIN,IMAX
   6622         RLATZ=RLAT(I,J)
   6623         RLONZ=RLON(I,J)
   6624         IF(IPRNTV .GT. 0)  THEN
   6625         IF(IPRNTV .EQ. 2 .OR. NREC .LE. 1000)  THEN
   6626         WRITE(6,87) ITYP,IDAYZ,IUTCZ,RLATZ,RLONZ,PP,RMISS,RMISS,
   6627      1              ZP(I,J,KL),UP(I,J,KL),VP(I,J,KL),FLAG
   6628    87   FORMAT(1X,I2,1X,I9,1X,I4,1X,2(F7.3,1X),3(F6.1,1X),F7.1,
   6629      1       2(F6.1,1X),A4)
   6630         ENDIF
   6631         ENDIF
   6632         NREC=NREC+1
   6633         WRITE(IUNTPV) RITYP,IDAYZ,IUTCZ,RLATZ,RLONZ,PP,RMISS,RMISS,
   6634      1                ZP(I,J,KL),UP(I,J,KL),VP(I,J,KL),FLAG
   6635         ENDDO
   6636         ENDDO
   6637 C
   6638         KK=KK+1
   6639         IF(KK .GT. KLVLS)  GO TO 101
   6640 C
   6641       ENDIF
   6642   100 CONTINUE
   6643   101 CONTINUE
   6644       NPTS=NREC/NLEV
   6645       IVOTYP=1
   6646       IVFLTP=1
   6647       WRITE(6,103) NREC,NPTS,NLEV,IVOTYP,IVFLTP
   6648   103 FORMAT('...MM3DVO HAS WRITTEN',I7,' RECORDS AT',I6,
   6649      1       ' POINTS AND',I3,' LEVELS FOR IVOTYP, IVFLTP=',2I3)
   6650 C
   6651 C     WRITE NAMELIST UPDATE FILES FOR XSPLDAT ANALYSIS AND STORM
   6652 C       TRACK FILES.
   6653 C       ****NOTE: WE USE A DUMMY TRACK FOR SIMPLICITY HERE ****
   6654 C
   6655       ITRK=3
   6656 
   6657       IDAYZZ(1:ITRK)=IDAYZ
   6658       IUTCZZ(1:ITRK)=IUTCZ
   6659       STLTZZ(1:ITRK)=STMLTZ
   6660       STLNZZ(1:ITRK)=STMLNZ
   6661 C
   6662       CALL RITTRK(ITRK,IUNTTK,IDAYZZ,IUTCZZ,STLTZZ,STLNZZ,STMNMZ)
   6663 C
   6664       ITRK=1
   6665       CALL RITDOM(ITRK,IUNTDO,IDAYZZ,IUTCZZ,XMLZ,XMRZ,YNBZ,YNTZ,DELTA,
   6666      1            STMNMZ)
   6667 C
   6668 C     CLOSE OR REWIND FILES
   6669 C
   6670       REWIND IUNTDO
   6671       REWIND IUNTTK
   6672       CLOSE(UNIT=IUNTRV ,STATUS='KEEP')

Page 172         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6673       CLOSE(UNIT=IUNTPV,STATUS='KEEP')
   6674 C
   6675       RETURN
   6676       END


ENTRY POINTS

  Name               
                     
 mm3dvo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  6413                                                           6406                              
 100                        Label  6642                                                           6598                              
 101                        Label  6643                                                           6639                              
 103                        Label  6648                                                           6647                              
 16                         Label  6469                                                           6468                              
 20                         Label  6490                                                           6487                              
 3                          Label  6419                                                           6418                              
 30                         Label  6491                                                           6486                              
 31                         Label  6497                                                           6496                              
 32                         Label  6504                                                           6498                              
 33                         Label  6506                                                           6499,6503                         
 34                         Label  6505                                                           6502                              
 43                         Label  6517                                                           6516                              
 51                         Label  6530                                                           6536                              
 511                        Label  6534                                                           6533                              
 512                        Label  6543                                                           6542                              
 513                        Label  6552                                                           6551                              
 514                        Label  6561                                                           6560                              
 52                         Label  6539                                                           6545                              
 53                         Label  6548                                                           6554                              
 54                         Label  6557                                                           6563                              
 57                         Label  6575                                                           6574                              
 59                         Label  6580                                                           6579                              
 6                          Label  6456                                                           6440,6441,6446,6447,6448,6449,6454
                                                                                                  ,6455                             
 61                         Label  6588                                                           6587                              
 7                          Label  6457                                                           6442,6445,6450,6453               
 70                         Label  6593                                                           6584                              
 8                          Label  6458                                                           6443,6451                         
 81                         Label  6608                                                           6602                              
 82                         Label  6614                                                           6603,6605,6607                    
 83                         Label  6610                                                           6604                              
 84                         Label  6612                                                           6606                              
 87                         Label  6628                                                           6626                              
 ABRT1                      Subr   6421                                                           6421,6520                         
 ABS                        Func   6514                                 scalar                    6514,6515                         
 BOGVAR                     Local  6382     L(4)            4     1     3        SAVE             6408,6410,6411,6586               
 DEGFAC                     Local  6397     R(4)            4           scalar   SAVE             6397,6488,6489                    
 DELTA                      Dummy  6373     R(4)            4           scalar   ARG,INOUT        6665                              
 DELXMM                     Local  6435     R(4)            4           scalar   SAVE             6435,6466                         

Page 173         Source Listing                  MM3DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DELYMM                     Local  6436     R(4)            4           scalar   SAVE             6436,6467                         
 EPSVP                      Local  6397     R(4)            4           scalar   SAVE             6397,6514,6515                    
 FLAG                       Local  6386     CHAR            4           scalar   SAVE             6397,6627,6634                    
 I                          Local  6487     I(4)            4           scalar   SAVE             6487,6488,6489,6502,6503,6604,6605
                                                                                                  ,6606,6607,6621,6622,6623,6627,663
                                                                                                  4                                 
 ICEN                       Local  6493     I(4)            4           scalar   SAVE             6493,6496,6499,6511,6512,6514,6523
                                                                                                  ,6524,6603                        
 IDAYZ                      Dummy  6374     I(4)            4           scalar   ARG,INOUT        6443,6451,6626,6633,6657          
 IDAYZZ                     Local  6391     I(4)            4     1     3        SAVE             6657,6662,6665                    
 IDIM                       Param  6377     I(4)            4           scalar                    6380,6388,6389,6417,6418,6487,6498
                                                                                                  ,6503,6541,6574,6602,6605,6607    
 IFIX                       Func   6466                                 scalar                    6466,6467                         
 IMAX                       Local  6524     I(4)            4           scalar   SAVE             6524,6527,6539,6541,6542,6574,6621
 IMAX2                      Local  6527     I(4)            4           scalar   SAVE             6527,6548,6557,6574               
 IMIN                       Local  6523     I(4)            4           scalar   SAVE             6523,6527,6530,6532,6533,6574,6621
 INDXP                      Dummy  6373     I(4)            4     1     0        ARG,INOUT        6599                              
 IPRES                      Dummy  6372     I(4)            4     1     0        ARG,INOUT        6602,6604,6606,6619               
 IPRNTV                     Dummy  6372     I(4)            4           scalar   ARG,INOUT        6624,6625                         
 IRAD                       Local  6466     I(4)            4           scalar   SAVE             6466,6468,6523,6524               
 ITRK                       Local  6655     I(4)            4           scalar   SAVE             6655,6657,6658,6659,6660,6662,6664
                                                                                                  ,6665                             
 ITRKMX                     Param  6378     I(4)            4           scalar                    6391,6392                         
 ITYP                       Local  6426     I(4)            4           scalar   SAVE             6426,6595,6626                    
 IUNTBH                     Dummy  6372     I(4)            4           scalar   ARG,INOUT        6448,6449,6450,6451,6453,6454,6455
 IUNTDO                     Dummy  6372     I(4)            4           scalar   ARG,INOUT        6665,6670                         
 IUNTPV                     Dummy  6372     I(4)            4           scalar   ARG,INOUT        6477,6633,6673                    
 IUNTRV                     Dummy  6372     I(4)            4           scalar   ARG,INOUT        6474,6480,6481,6482,6483,6484,6672
 IUNTTK                     Dummy  6372     I(4)            4           scalar   ARG,INOUT        6662,6671                         
 IUTCZ                      Dummy  6374     I(4)            4           scalar   ARG,INOUT        6443,6451,6596,6626,6633,6658     
 IUTCZZ                     Local  6391     I(4)            4     1     3        SAVE             6658,6662,6665                    
 IVAR                       Dummy  6373     I(4)            4     1     0        ARG,INOUT        6407,6408,6409                    
 IVFLTP                     Local  6646     I(4)            4           scalar   SAVE             6646,6647                         
 IVOTYP                     Local  6645     I(4)            4           scalar   SAVE             6645,6647                         
 J                          Local  6486     I(4)            4           scalar   SAVE             6486,6488,6489,6498,6499,6602,6603
                                                                                                  ,6620,6622,6623,6627,6634         
 JCEN                       Local  6494     I(4)            4           scalar   SAVE             6494,6496,6503,6511,6512,6514,6525
                                                                                                  ,6526,6605,6607                   
 JDIM                       Param  6377     I(4)            4           scalar                    6380,6388,6389,6417,6418,6486,6499
                                                                                                  ,6502,6559,6574,6603,6604,6606    
 JMAX                       Local  6526     I(4)            4           scalar   SAVE             6526,6528,6557,6559,6560,6574,6620
 JMAX2                      Local  6528     I(4)            4           scalar   SAVE             6528,6530,6539,6574               
 JMIN                       Local  6525     I(4)            4           scalar   SAVE             6525,6528,6548,6550,6551,6574,6620
 JRAD                       Local  6467     I(4)            4           scalar   SAVE             6467,6468,6525,6526               
 JV                         Local  6406     I(4)            4           scalar   SAVE             6406,6407,6408,6409,6584,6586,6587
                                                                                                  ,6590                             
 JVBOG                      Dummy  6373     I(4)            4           scalar   ARG,INOUT        6390,6406                         
 JVMDIM                     Param  6377     I(4)            4           scalar                    6380,6390,6407,6584               
 KK                         Local  6597     I(4)            4           scalar   SAVE             6597,6599,6602,6604,6606,6619,6638
                                                                                                  ,6639                             
 KL                         Local  6598     I(4)            4           scalar   SAVE             6598,6599,6602,6603,6604,6605,6606
                                                                                                  ,6607,6627,6634                   
 KLVLS                      Dummy  6373     I(4)            4           scalar   ARG,INOUT        6390,6639                         
 KMDIM                      Param  6377     I(4)            4           scalar                    6380,6388,6389,6598               
 MAX                        Func   6532                                 scalar                    6532,6550                         

Page 174         Source Listing                  MM3DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIN                        Func   6541                                 scalar                    6541,6559                         
 MM3DVO                     Subr   6372                                                                                             
 NINT                       Func   6514                                 scalar                    6514,6515,6531,6540,6549,6558     
 NLEV                       Local  6425     I(4)            4           scalar   SAVE             6425,6600,6601,6644,6647          
 NPTS                       Local  6644     I(4)            4           scalar   SAVE             6644,6647                         
 NREC                       Local  6424     I(4)            4           scalar   SAVE             6424,6625,6632,6644,6647          
 PP                         Local  6619     R(4)            4           scalar   SAVE             6619,6626,6633                    
 REAL                       Func   6595                                 scalar                    6595,6596,6619                    
 RITDOM                     Subr   6665                                                           6665                              
 RITTRK                     Subr   6662                                                           6662                              
 RITYP                      Local  6595     R(4)            4           scalar   SAVE             6595,6633                         
 RLAT                       Local  6389     R(4)            4     2     121      SAVE             6480,6488,6499,6511,6514,6548,6557
                                                                                                  ,6622                             
 RLATCZ                     Local  6511     R(4)            4           scalar   SAVE             6511,6516                         
 RLATMN                     Dummy  6374     R(4)            4           scalar   ARG,INOUT        6443,6451,6549,6551,6571          
 RLATMX                     Dummy  6374     R(4)            4           scalar   ARG,INOUT        6444,6452,6558,6560,6572          
 RLATZ                      Local  6622     R(4)            4           scalar   SAVE             6622,6626,6633                    
 RLON                       Local  6389     R(4)            4     2     121      SAVE             6481,6489,6503,6512,6530,6539,6623
 RLONCZ                     Local  6512     R(4)            4           scalar   SAVE             6512,6515,6516                    
 RLONMN                     Dummy  6374     R(4)            4           scalar   ARG,INOUT        6444,6452,6531,6533,6569          
 RLONMX                     Dummy  6374     R(4)            4           scalar   ARG,INOUT        6444,6452,6540,6542,6570          
 RLONZ                      Local  6623     R(4)            4           scalar   SAVE             6623,6626,6633                    
 RMISS                      Local  6397     R(4)            4           scalar   SAVE             6397,6590,6626,6633               
 RMVARS                     Scalar 6380     R(4)            4     4     363      COM              6590                              
 RMXBOG                     Dummy  6373     R(4)            4           scalar   ARG,INOUT        6443,6451,6466,6467               
 STLNZZ                     Local  6392     R(4)            4     1     3        SAVE             6660,6662                         
 STLTZZ                     Local  6391     R(4)            4     1     3        SAVE             6659,6662                         
 STMLNZ                     Dummy  6374     R(4)            4           scalar   ARG,INOUT        6443,6451,6515,6516,6660          
 STMLTZ                     Dummy  6373     R(4)            4           scalar   ARG,INOUT        6443,6451,6514,6516,6659          
 STMNMZ                     Dummy  6375     CHAR            9           scalar   ARG,INOUT        6443,6451,6662,6666               
 UP                         Scalar 6388     R(4)            4     3     121      COM              6482,6603,6627,6634               
 UTC0                       Local  6596     R(4)            4           scalar   SAVE             6596                              
 VARS                       Common 6380                                 1452     SAVE                                               
 VP                         Scalar 6388     R(4)            4     3     121      COM              6483,6605,6627,6634               
 XML                        Local  6530     R(4)            4           scalar   SAVE             6530,6531,6533                    
 XMLZ                       Local  6569     R(4)            4           scalar   SAVE             6569,6579,6665                    
 XMR                        Local  6539     R(4)            4           scalar   SAVE             6539,6540,6542                    
 XMRZ                       Local  6570     R(4)            4           scalar   SAVE             6570,6579,6665                    
 YNB                        Local  6548     R(4)            4           scalar   SAVE             6548,6549,6551                    
 YNBZ                       Local  6571     R(4)            4           scalar   SAVE             6571,6579,6665                    
 YNT                        Local  6557     R(4)            4           scalar   SAVE             6557,6558,6560                    
 YNTZ                       Local  6572     R(4)            4           scalar   SAVE             6572,6579,6665                    
 ZP                         Scalar 6389     R(4)            4     3     121      COM              6484,6607,6627,6634               

Page 175         Source Listing                  MM3DVO
2017-04-18 11:09                                 syndata.f

   6677 
   6678 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   6679 C                .      .    .                                       .
   6680 C SUBPROGRAM:    MAKVOR      CONTROLS BOGUS VORTEX CONSTRUCTION
   6681 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 2016-05-18
   6682 C
   6683 C ABSTRACT: CONTROLS BOGUS VORTEX CONSTRUCTION.  COMPOSITES
   6684 C   OBSERVATIONS FOR COMPARISON WITH BOGUS VORTEX.
   6685 C
   6686 C PROGRAM HISTORY LOG:
   6687 C 1991-06-06  S. J. LORD
   6688 C 1991-10-21  S. J. LORD  MADE DELMMV INPUT ARGUMENT
   6689 C 2016-05-18  S. J. LORD  Defined dayoff=0.0 (was previously
   6690 C        unititialized).  This is passed into subr. SETTRK.
   6691 C
   6692 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   6693 C   INPUT ARGUMENT LIST:
   6694 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   6695 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   6696 C
   6697 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   6698 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   6699 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   6700 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   6701 C
   6702 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   6703 C     DDNAME1  - GENERIC NAME & CONTENT
   6704 C
   6705 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   6706 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   6707 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   6708 C
   6709 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   6710 C
   6711 C ATTRIBUTES:
   6712 C   LANGUAGE: FORTRAN 90
   6713 C   MACHINE:  NCEP WCOSS
   6714 C
   6715 C$$$
   6716 C
   6717 C     *****************************
   6718 C     ****  SUBROUTINE MAKVOR  ****
   6719 C     *****************************
   6720 C
   6721       SUBROUTINE MAKVOR(IDATEZ,IUTCZ,IUNTPN,IUNTPV,IUNTTK,IUNTDO,IUNTRV,
   6722      1                  IUNTBH,IUNTDH,IUNTVD,IOVITL,IVOTYP,IVFLTP,
   6723      2                  IBMETH,DELTA,DELMMV,SP1DWL,RLATMN,RLATMX,
   6724      3                  RLONMN,RLONMX,STMLTZ,STMLNZ,STMDRZ,STMSPZ,RMAXZ,
   6725      4                  PENVZ,PCENZ,PTOPZ,DIVFAC,PCENF,R15WND,
   6726      5                  VTBOGZ,NOBWMN,VORDIV,STMIDZ,STMNMZ,ihrreq)
   6727 C
   6728       PARAMETER (MAXDAT=5)
   6729       PARAMETER (KDTDIM=5)
   6730       PARAMETER (MAXVPT=100,MAXPTS=MAXVPT*MAXVPT)
   6731       PARAMETER (MAXVOP=12)
   6732       PARAMETER (MAXVOV= 3)
   6733       PARAMETER (MAXVOW= 7)

Page 176         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   6734       PARAMETER (MAXVOR=1000)
   6735       PARAMETER (ITRKMX=3)
   6736       PARAMETER (IQUADX=4)
   6737 C
   6738       CHARACTER FLAG*4,STMIDZ*3,STMNMZ*9,STMNZZ*9
   6739       LOGICAL FIRST,VORDIV,ONLYWI,ONLYMA,ONLYPS
   6740 C
   6741       SAVE
   6742 C
   6743       REAL(8) SINDEG_8,COSDEG_8,DISTSP_8,term_8
   6744 
   6745       DIMENSION  JDAT(8),RINC(5)
   6746 
   6747       DIMENSION COMDTA(MAXDAT),NDATA(MAXDAT),INDCOM(MAXDAT)
   6748       DIMENSION RLATP(MAXPTS),RLONP(MAXPTS),DATA(KDTDIM),RADIUS(MAXPTS),
   6749      1          SINTH(MAXPTS),COSTH(MAXPTS)
   6750       DIMENSION A2DVOR(MAXVOR,MAXVOP,MAXVOV),IBOGVR(MAXVOV)
   6751       DIMENSION ILVL(MAXVOP),INDXP(MAXVOP),IVAR(MAXVOW),INDXV(MAXVOW),
   6752      1          IDAYZZ(ITRKMX),IUTCZZ(ITRKMX),STLTZZ(ITRKMX),
   6753      2          STLNZZ(ITRKMX)
   6754       DIMENSION ILVLZ(MAXVOP),INDXPZ(MAXVOP),R15WND(IQUADX)
   6755 C
   6756       COMMON/BDATE/LDAT(8)
   6757 
   6758       EQUIVALENCE (NDATA(1),NUDAT),(NDATA(2),NVDAT),
   6759      1            (NDATA(3),NPSDAT)
   6760 C
   6761 C     COMFAC: FACTOR FOR DETERMINING THE COMPOSITING RADIUS AS A
   6762 C             MULTIPLE OF RMAX
   6763 C     DELMMV: SPACING OF MATHUR 2-D VORTEX (KM)
   6764 C     DEGLAT: ONE DEGREE LATITUDE IN METERS
   6765 C     RMISS : SPLINE ANALYSIS CODE FOR MISSING DATA
   6766 C     ITYP  : SPLINE ANALYSIS DATA TYPE
   6767 C     IFIRST: =0, CODE FOR CALLING RFAC TO RETAIN PREVIOUS
   6768 C             INTERPOLATION FACTORS
   6769 C     SP1DWL : FILTER WAVELENGTH FOR THE 1-D SPLINE FILTERS
   6770 C              FOR THE SURFACE PRESSURE, VORTICITY AND DIVERGENCE
   6771 C              (SEE AS2DVO)
   6772 C
   6773       DATA IPRT/1/,IPRTV/0/,IHRD/0/,NDATA/MAXDAT*0/,FIRST/.TRUE./,
   6774      1     COMFAC/2.0/,DEGLAT/111.1775E3/,RMISS/-99.0/,EPSMIS/1.E-2/,
   6775      2     ITYP/12/,FLAG/'0000'/,IBOGVR/MAXVOV*-1/,IFIRST/0/,DELSP/20./,
   6776      3     DELVD/2./
   6777 C
   6778       DATA R15MPS/15.0/,R15INF/20./,SPDMIN/5.0/
   6779 C
   6780       IOPT=5
   6781       STMNZZ=STMIDZ
   6782       WRITE(6,1) STMNMZ//STMIDZ,VORDIV,IUNTVD,IVOTYP,IVFLTP,IBMETH,
   6783      1           STMLTZ,STMLNZ,RMAXZ,PENVZ,PCENZ,PTOPZ,VTBOGZ
   6784     1 FORMAT(///'...ENTERING MAKVOR FOR STORM ',A,', WITH VORDIV,',
   6785      1       'IUNTVD,IVOTYP,IVFLTP,IBMETH,STMLAT,STMLON,RMAX,PENV,',
   6786      2       'PCEN,PTOP,VTBOGZ=',/,5X,L1,4I5,7F12.3)
   6787       WRITE(IUNTDH,3) IDATEZ,IUTCZ,STMNMZ//STMIDZ,STMLTZ,STMLNZ,RMAXZ,
   6788      1                PENVZ,PCENZ,STMDRZ,STMSPZ,VTBOGZ,IBMETH
   6789     3 FORMAT(' COMPOSITED OBS:',I10,I5,1X,A,8F10.2,I3)
   6790 C

Page 177         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   6791 C     SET UP COMPOSITING VARIABLES AND DO SOME BASIC SPACE CHECKS
   6792 C
   6793       IF(FIRST)  THEN
   6794          FIRST=.FALSE.
   6795          CALL GRABIP(ILVL,INDXP,KLBOG,IVAR,INDXV,JVBOG,
   6796      1               ONLYWI,ONLYMA,ONLYPS)
   6797          WRITE(6,4) ONLYWI,ONLYMA,ONLYPS,KLBOG,JVBOG
   6798     4    FORMAT(/'...SETTING UP COMPOSITING: ONLYWI,ONLYMA,ONLYPS=',3L2,
   6799      1          ' KLBOG,JVBOG=',2I5)
   6800 C
   6801 C     SET UP VARIABLES TO BE BOGUSED.  THE EXPECTED RANGE OF
   6802 C       IVAR IS:
   6803 C                   3  : HEIGHT
   6804 C                   4,5: TOTAL WIND
   6805 C                   6  : ROTATIONAL WIND
   6806 C                   7  : DIVERGENT  WIND
   6807 C
   6808          DO 6 JV=1,JVBOG
   6809             IF(IVAR(JV) .LE. MAXVOV+2)  THEN
   6810 cdak??      IF(IVAR(JV) .LE. MAXVOW+2)  THEN
   6811                IBOGVR(IVAR(JV)-2)=1
   6812             ELSE IF(IVAR(JV) .EQ. 6)  THEN
   6813                IBOGVR(2)=1
   6814                IBOGVR(3)=0
   6815             ELSE IF(IVAR(JV) .EQ. 7)  THEN
   6816                IBOGVR(2)=0
   6817                IBOGVR(3)=1
   6818             ENDIF
   6819     6    CONTINUE
   6820 C
   6821          IF(KLBOG .GT. MAXVOP)  THEN
   6822             WRITE(6,11) IVOTYP,IVFLTP,KLBOG,MAXVOP
   6823    11 FORMAT(/'******INSUFFICIENT SPACE FOR VERTICAL LEVELS OF ',
   6824      1       'AXISYMMETRIC VORTEX, IVOTYP,IVFLTP,KLBOG,MAXVOP=',4I5)
   6825             CALL ABRT1(' MAKVOR',11)
   6826          ENDIF
   6827 C
   6828          IF(JVBOG .GT. MAXVOV)  THEN
   6829 cdak??   IF(JVBOG .GT. MAXVOW)  THEN
   6830             WRITE(6,21) IVOTYP,IVFLTP,JVBOG,MAXVOV
   6831    21 FORMAT(/'******INSUFFICIENT SPACE FOR VORTEX VARIABLES OF ',
   6832      1       'AXISYMMETRIC VORTEX, IVOTYP,IVFLTP,JVBOG,MAXVOV=',4I5)
   6833             CALL ABRT1(' MAKVOR',21)
   6834          ENDIF
   6835 C
   6836          NTODAT=0
   6837          IF(ONLYWI)  THEN
   6838             NUDAT=1
   6839             NVDAT=1
   6840             INDCOM(1)=1
   6841             INDCOM(2)=2
   6842          ENDIF
   6843 C
   6844          IF(ONLYPS)  THEN
   6845             NPSDAT=1
   6846             INDCOM(3)=3
   6847          ENDIF

Page 178         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   6848 C
   6849          DO 40 MDAT=1,MAXDAT
   6850             NTODAT=NTODAT+NDATA(MDAT)
   6851    40    CONTINUE
   6852 C
   6853          DATA=RMISS
   6854 C
   6855          RITYP=REAL(ITYP)
   6856 C
   6857       ENDIF
   6858 C
   6859       CALL ZTIME(IDATEZ,IUTCZ,IYR,IMO,IDA,IHR,IMIN)
   6860       JDAT = 0
   6861       JDAT(1) = IYR
   6862       JDAT(2) = IMO
   6863       JDAT(3) = IDA
   6864       CALL W3DIFDAT(JDAT,LDAT,1,RINC)
   6865       JDY = NINT(RINC(1))
   6866       CALL FLDAY(JDY,IHR,IMIN,DAY00)
   6867 C
   6868 C     ASSUME A SIX HOUR WINDOW FOR FINDING THE TRACK
   6869 C
   6870       WINDOW=0.25
   6871       DAYMX0=DAY00+WINDOW
   6872       DAYMN0=DAY00-WINDOW
   6873 C SJL 4/13/16
   6874       dayoff=0.0
   6875 C
   6876 C     DETERMINE THE VORTEX SIZE: SEE COMMENTS BELOW
   6877 C
   6878       IF(IBMETH .LE. 2)  THEN
   6879 C
   6880       CALL R15FND(R15WND,STMDRZ,RMAXZ,R15AVG)
   6881 C
   6882       IF(R15AVG .LE. RMAXZ)  THEN
   6883       RPOT=R15AVG
   6884       WRITE(6,61) IBMETH,RPOT
   6885    61 FORMAT(/'...FOR IBMETH=',I3,' RPOT=',F7.2,' IS EQUAL TO R15AVG.')
   6886 C
   6887       ELSE
   6888       RPOT=RMAXZ
   6889       WRITE(6,63) IBMETH,RPOT,R15AVG
   6890    63 FORMAT(/'...FOR IBMETH=',I3,' RPOT=',F7.2,' IS EQUAL TO RMAXZ,'/,
   6891      1       4X,' WHILE R15AVG=',F7.2)
   6892 C
   6893       ENDIF
   6894 C
   6895       ELSE
   6896       RPOT=RMAXZ
   6897       ENDIF
   6898 C
   6899 C     SET THE DOMAIN FOR SCANNING DATA AND COMPOSITING
   6900 C
   6901       ISHAPE=1
   6902       ZLAT=ZNEAR(STMLTZ,DELTA)
   6903       ZLON=ZNEAR(STMLNZ,DELTA)
   6904       RMXCOM=MIN(COMFAC*RMAXZ,RFAC(IFIRST,RMAXZ))

Page 179         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   6905       CALL TEMPLT(ISHAPE,DELTA,ZLAT,ZLON,RMXCOM,MAXPTS,MMX,NNY,YNB,YNT,
   6906      1            XML,XMR,RLATP,RLONP,NPTS)
   6907 C
   6908 C
   6909 C     SET UP TRACK AND COMPOSITING ROUTINES. PTOP IS THE UPPERMOST
   6910 C       PRESSURE LEVEL TO BE COMPOSITED. RMXCOM IS THE LARGEST
   6911 C       RADIAL EXTENT OF THE COMPOSITE (HALF THE DIAGONAL DISTANCE
   6912 C       ACROSS THE BOX FOR THE BOGUSING AREA)
   6913 C
   6914       RMXCOM=0.5*DISTSP_8(YNT,XML,YNB,XMR)
   6915       CALL SETTRK(IOVITL,IOPT,IDATEZ,DAY00,DAYMN0,DAYMX0,DAYOFF,STMDRZ,
   6916      1            STMSPZ,STMNZZ,IERSET,ihrreq)
   6917       CALL SETCOM(NTODAT,IUNTDH,STMDRZ,STMSPZ,PTOPZ,RMXCOM,RMAXZ,RPOT,
   6918      1            ONLYWI,ONLYPS,STMNMZ//STMIDZ)
   6919 C
   6920       WRITE(6,971)
   6921   971 FORMAT(/110('V')/110('V'))
   6922       WRITE(6,71)  NTODAT,(INDCOM(NTO),NTO=1,NTODAT)
   6923    71 FORMAT(/'...CALLING SURPRP WITH NTODAT,INDCOM=',10I4)
   6924       CALL SURPRP(IUNTPN,IUNTBH,IUNTDH,PTOPZ,XML,XMR,YNB,YNT,RPOT,
   6925      1            SPDPOT,NOBWMN,IYR,DAY00,NTODAT,COMDTA,IPRT,IHRD,
   6926      2            INDCOM,ONLYWI,ONLYMA,ONLYPS)
   6927       WRITE(6,73) RPOT,NOBWMN,SPDPOT
   6928       WRITE(IUNTBH,73) RPOT,NOBWMN,SPDPOT
   6929    73 FORMAT(/'...FOR RPOT,NOBWMN=',F7.2,I3,' SURPRP HAS FOUND ',
   6930      1       'SPDPOT=',F7.2)
   6931       WRITE(6,972)
   6932   972 FORMAT(/110('A')/110('A')/)
   6933 C
   6934       REWIND IUNTPN
   6935 C
   6936       RMXMMV=RMAXZ
   6937 C
   6938 C     SET UP THE BOGUS VORTEX PARAMETERS DEPENDING ON BOGUS METHOD
   6939 C       IBMETH=1,2: PERTURBATION VORTEX CALIBRATED TO 15 M/S WIND RADIUS
   6940 C                   OR RMAX (WHICHEVER IS SMALLER)
   6941 C                   AND EQUAL TO THE STORM SPEED (STEERING FLOW) AT
   6942 C                   RMAX
   6943 C       IBMETH=3,4: VORTEX CALIBRATED TO AVERAGE TANGENTIAL WIND IN
   6944 C                   THE GUESS FIELD
   6945 C
   6946       IF(IBMETH .LE. 2)  THEN
   6947 C
   6948 C     WE TRY TO MATCH THE PERTURBATION VORTEX TO THE STEERING FLOW
   6949 C       AT RMAX.
   6950 C
   6951       IF(SPDPOT .LE. 0.0)  THEN
   6952       SPDPOT=MAX(STMSPZ+SPDMIN,R15MPS-STMSPZ)
   6953       IF(VORDIV)  SPDPOT=R15MPS
   6954       ENDIF
   6955 C
   6956       UPOT=-SPDPOT*SINDEG_8(R15INF)
   6957       VPOT= SPDPOT*COSDEG_8(R15INF)
   6958       VTBOG=MIN(STMSPZ,R15MPS*0.5)
   6959 C
   6960 C     METHOD=3,4:
   6961 C       VORTEX TO MATCH AZIMUTHALLY-AVERAGED TANGENTIAL WIND AT RMAX

Page 180         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   6962 C         RMAX (VTBOGZ)
   6963 C
   6964       ELSE
   6965       SPDPOT=-99.0
   6966       VPOT=VTBOGZ
   6967       UPOT=-VPOT*SINDEG_8(R15INF)
   6968       ENDIF
   6969 C
   6970       WRITE(6,91)  IBMETH,RPOT,UPOT,VPOT,R15INF,VTBOGZ,STMSPZ,SPDPOT
   6971       WRITE(IUNTBH,91)  IBMETH,RPOT,UPOT,VPOT,R15INF,VTBOGZ,
   6972      1                  STMSPZ,SPDPOT
   6973    91 FORMAT(/'...INPUT PARM FOR MAKVOR: IBMETH,RPOT,UPOT,VPOT,',
   6974      1       'R15INF,VTBOGZ,STMSPZ,SPDPOT=',/,4X,I3,7F9.1)
   6975 C
   6976 C     RADIAL GRID FOR CALCULATING VORTEX PROPERTIES
   6977 C
   6978       IF(VORDIV)  THEN
   6979       DELXVO=DELVD
   6980       ELSE
   6981       DELXVO=DELMMV
   6982       DLMMVM=DELMMV*1000.
   6983       ENDIF
   6984 C
   6985 C     ***************************
   6986 C     ****  MAKE THE VORTEX  ****
   6987 C     ***************************
   6988 C
   6989 C     FIRST, FIND PRESSURE INDEX FOR THE TOP OF THE CYCLONIC
   6990 C       CIRCULATION
   6991 C
   6992       DO 200 KL=1,KLBOG
   6993       IF(ILVL(KL)*10 .LT. NINT(PTOPZ*10.))  GO TO 201
   6994       KLBOGV=KL
   6995       INDXPZ(KL)=INDXP(KL)
   6996       ILVLZ (KL)=ILVL (KL)
   6997   200 CONTINUE
   6998   201 CONTINUE
   6999 C
   7000       IF(IVOTYP .LE. 2) THEN
   7001          IF(IVFLTP .EQ. 1)  THEN
   7002 C
   7003 C     AN INTERACTIVE VORTEX IS NOT ALLOWED FOR MM3DVO (VORTEX ON DISK).
   7004 C       BUT WE MUST CALL RDTITL TO PRESERVE THE CORRECT SEQUENCE OF
   7005 C       DATA READ FROM UNIT 5.
   7006 C
   7007             CALL RDTITL(1)
   7008             RMXBOG=RFAC(IFIRST,RMAXZ)
   7009             WRITE(6,203) STMNMZ//STMIDZ,STMLTZ,STMLNZ,PTOPZ,RMXBOG,
   7010      1                  IDATEZ,IUTCZ,RLATMN,RLATMX,RLONMN,RLONMX
   7011   203 FORMAT(/'...CALLING MM3DVO WITH STMNAM,STMLAT,STMLON,PTOP,',
   7012      1        'RMXBOG,IDATEZ,IUTCZ,RLATMN,RLATMX,RLONMN,RLONMX=',/,
   7013      2        10X,A,4F12.3,I9,I5,4F12.4)
   7014 C
   7015             IUNTRV=IUNTRV+1
   7016             CALL MM3DVO(IPRTV,IUNTRV,IUNTPV,IUNTTK,IUNTDO,IUNTBH,ILVLZ,
   7017      1                  INDXPZ,KLBOGV,IVAR,JVBOG,RMXBOG,DELTA,STMLTZ,
   7018      2                  STMLNZ,RLATMN,RLATMX,RLONMN,RLONMX,IDATEZ,IUTCZ,

Page 181         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   7019      3                  STMNMZ//STMIDZ)
   7020             RETURN
   7021 C
   7022          ELSE IF(IVFLTP .EQ. 2)  THEN
   7023             CALL MM2DVO(IUNTBH,DELXVO,SP1DWL,STMLTZ,STMLNZ,RMXMMV,PCENZ,
   7024      1                  PENVZ,PTOPZ,PCENF,A2DVOR,MAXVOR,MAXVOP,MAXVOV,
   7025      2                  KLEVMX,IRADMX,IDATEZ,IUTCZ,STMNMZ//STMIDZ)
   7026 C
   7027          ELSE IF(IVFLTP .EQ. 3)  THEN
   7028 C
   7029 C     TANGENTIAL AND RADIAL WIND ARE SPECIFIED AT THE RADIUS OF
   7030 C       OBSERVED 15 M/S WINDS.
   7031 C
   7032             CALL AS2DVO(IUNTBH,IUNTVD,IVOTYP,DELXVO,DELSP,SP1DWL,STMLTZ,
   7033      1                  STMLNZ,RMXMMV,PCENZ,PENVZ,PTOPZ,VPOT,UPOT,RPOT,
   7034      2                  VTBOG,DIVFAC,PCENF,A2DVOR,MAXVOR,MAXVOP,MAXVOV,
   7035      3                  KLEVMX,IRADMX,IDATEZ,IUTCZ,IERASV,VORDIV,
   7036      4                  STMNMZ//STMIDZ)
   7037             IF(IERASV .NE. 0)  THEN
   7038                IF(VORDIV)  THEN
   7039                   WRITE(6,211) VORDIV,IERASV
   7040   211 FORMAT(/'******WITH VORDIV=',L1,' ERROR IN SHAPIRO VORTEX=',I3,
   7041      1       ' HAS OCCURRED.  THEREFORE WE MUST CURRENTLY TERMINATE ',
   7042      2  /,7X,'THIS PROGRAM UNTIL VORTICITY/DIVERGENCE OPTION ',
   7043      3       'IS INCLUDED FOR MM2DVO')
   7044                   CALL ABRT1(' MAKVOR',211)
   7045 C
   7046                ELSE
   7047                   CALL MM2DVO(IUNTBH,DELMMV,SP1DWL,STMLTZ,STMLNZ,
   7048      1                        RMXMMV,PCENZ,PENVZ,PTOPZ,PCENF,A2DVOR,
   7049      2                        MAXVOR,MAXVOP,MAXVOV,KLEVMX,IRADMX,
   7050      3                        IDATEZ,IUTCZ,STMNMZ//STMIDZ)
   7051                ENDIF
   7052             ENDIF
   7053          ENDIF
   7054       ELSE
   7055          WRITE(6,213) IVOTYP
   7056   213    FORMAT(/'******VORTEX TYPE=',I3,' NOT YET INSTALLED')
   7057          CALL ABRT1(' MAKVOR',69)
   7058       ENDIF
   7059 C
   7060 C     DO 230 NVAR=1,MAXVOV
   7061 C     WRITE(6,217) NVAR
   7062 C 217 FORMAT(///'...NVAR=',I5)
   7063 C     DO 220 NRAD=1,IRADMX
   7064 C     WRITE(6,218) NRAD
   7065 C 218 FORMAT(///'...NRAD=',I5)
   7066 C     WRITE(6,219) (A2DVOR(NRAD,NPR,NVAR),NPR=1,KLEVMX)
   7067 C 219 FORMAT(1X,12F10.2)
   7068 C 220 CONTINUE
   7069 C 230 CONTINUE
   7070 C
   7071       CALL ANLVOR(ONLYWI,ONLYPS)
   7072 C
   7073       CALL FITOBS(IUNTBH,RMAXZ,PCENZ,PENVZ,ONLYWI,ONLYPS,STMLTZ,STMLNZ,
   7074      1            IDATEZ,IUTCZ,STMNMZ//STMIDZ)
   7075 C

Page 182         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   7076 C     FOR VORTICITY/DIVERGENCE OPTION, WE ARE FINISHED
   7077 C
   7078       IF(VORDIV)  RETURN
   7079 C
   7080 C     CONTINUE FOR WIND BOGUSING OPTION
   7081 C
   7082 C     NOW THAT THE VORTEX IS FINAL, INTERPOLATE THE VORTEX TO
   7083 C       A TEMPLATE OF EQUALLY SPACED (LAT/LON) POINTS THAT COVER
   7084 C       THE BOGUSING AREA.  THE SPACING IS APPROXIMATELY AT
   7085 C       THE LAT/LON INTERVAL CORRESPONDING TO THE DISTANCE DELMMV
   7086 C       CALCULATED AT THE STORM LATITUDE.
   7087 C       **** IMPORTANT NOTE: LONGITUDES ARE CONVERTED TO
   7088 C                            DEGREES WEST IN THIS INSTANCE ****
   7089 C
   7090       ISHAPE=2
   7091       DELXVO=DLMMVM/(DEGLAT*COSDEG_8(STMLTZ))
   7092       ZLAT=ZNEAR(STMLTZ,DELTA)
   7093       ZLON=ZNEAR(STMLNZ,DELTA)
   7094       R1=DISTSP_8(RLATMX,RLONMN,ZLAT,RLONMN)
   7095       R2=DISTSP_8(RLATMN,RLONMN,ZLAT,RLONMN)
   7096       R3=DISTSP_8(ZLAT  ,  ZLON,ZLAT,RLONMX)
   7097       R4=DISTSP_8(ZLAT  ,  ZLON,ZLAT,RLONMN)
   7098       RMXVOR=1.E-3*MAX(R1,R2,R3,R4)
   7099       CALL TEMPLT(ISHAPE,DELXVO,ZLAT,ZLON,RMXVOR,MAXPTS,MXZ,NYZ,YNBZ,
   7100      1            YNTZ,XMLZ,XMRZ,RLATP,RLONP,NPTS)
   7101       YNB=RLATMN
   7102       YNT=RLATMX
   7103       XML=360.-RLONMN
   7104       XMR=360.-RLONMX
   7105 C
   7106       NREC=0
   7107       UTC0=REAL(IUTCZ)
   7108 C
   7109 C     OPEN FILE FOR 2-D SPLINE FORMAT DATA
   7110 C
   7111 C
   7112 C     OPENING IUNTPV NOT PERFORMED ON THE CRAY
   7113 C
   7114 C     OPEN(UNIT=IUNTPV,ACCESS='SEQUENTIAL',
   7115 C    1     STATUS='OLD',FORM='UNFORMATTED')
   7116 C
   7117       WRITE(6,301)  (IVAR(JV),JV=1,JVBOG)
   7118   301 FORMAT(////,1X,'...PREPARING TO CREATE DATA FROM ',
   7119      1       '2-D VORTEX IVAR=',10I4)
   7120       WRITE(6,303) YNB,YNT,XML,XMR,YNBZ,YNTZ,360.-XMLZ,360.-XMRZ
   7121   303 FORMAT('...CORNERS OF BOGUSING AREA (DEG. W) ARE:',4F10.2,/,4X,
   7122      1       'WHILE CORNERS POINTS OF VORTEX DATA ARE:',F8.2,3F10.2)
   7123 C
   7124       DO 350 JV=1,MAXVOV
   7125 C
   7126       IF(IBOGVR(JV) .GT. 0)  GO TO 350
   7127 C
   7128       IF(IBOGVR(JV) .LT. 0)  THEN
   7129       RVALUE=RMISS
   7130       WRITE(6,311) JV
   7131   311 FORMAT(/'...BOGUS VARIABLE',I3,' FROM 2-D VORTEX WILL BE ',
   7132      1       'MADE MISSING')

Page 183         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   7133 C
   7134       ELSE IF(IBOGVR(JV) .EQ. 0)  THEN
   7135       RVALUE=0.0
   7136       WRITE(6,321) JV
   7137   321 FORMAT(/'...BOGUS VARIABLE',I3,' FROM 2-D VORTEX WILL BE ',
   7138      1       'MADE IDENTICALLY ZERO')
   7139       ENDIF
   7140 C
   7141       A2DVOR(1:IRADMX,1:KLEVMX,JV)=RVALUE
   7142 
   7143   350 CONTINUE
   7144 C
   7145       DO 420 NP=1,NPTS
   7146       THETA=ATAN2DEG(RLONP(NP)-STMLNZ,RLATP(NP)-STMLTZ)
   7147 C     RADIUS(NP)=DISTSP_8(RLATP(NP),RLONP(NP),STMLTZ,STMLNZ)
   7148 
   7149 cdak  fix 7/03/05 VVVVVVVVVV
   7150 ccc   RADIUS(NP)=ACOS(COSDEG_8(RLONP(NP)-STMLNZ)*COSDEG_8(RLATP(NP))*
   7151 ccc  1           COSDEG_8(STMLTZ)+SINDEG_8(RLATP(NP))*SINDEG_8(STMLTZ))*
   7152 ccc  2           6.37E6
   7153       term_8=cosdeg_8(rlonp(np)-stmlnz)*cosdeg_8(rlatp(np))*
   7154      1       cosdeg_8(stmltz)+sindeg_8(rlatp(np))*sindeg_8(stmltz)
   7155       term_8=min(term_8,1.0_8)  ! since double precision, term inside
   7156                                 ! ACOS below can exceed 1.0 (just a bit)
   7157                                 ! causing an undefined value for radius
   7158                                 ! -- this makes sure term is never
   7159                                 !    greater than 1.0
   7160       RADIUS(NP)=ACOS(term_8)*6.37E6
   7161 cdak  fix 7/03/05 ^^^^^^^^^^
   7162 
   7163       SINTH(NP)=SINDEG_8(THETA)
   7164       COSTH(NP)=COSDEG_8(THETA)
   7165   420 CONTINUE
   7166 C
   7167       DO 440 NP=1,NPTS
   7168 C
   7169       IRAD=1+RADIUS(NP)/DLMMVM
   7170       DRAD=RADIUS(NP)-REAL(IRAD-1)*DLMMVM
   7171 C
   7172 c && 5 comments
   7173 CC    WRITE(6,423) NP,RLONP(NP),RLATP(NP),STMLTZ,STMLNZ,THETA,RADIUS(NP)
   7174 CC423 FORMAT('...NP,RLONP,RLATP,STMLTZ,STMLNZ,THETA,RADIUS=',/,5X,I5,
   7175 CC   1       5F10.2,F12.2)
   7176 CC    WRITE(6,424) SINTH(NP),COSTH(NP),RADIUS(NP),DRAD
   7177 CC424 FORMAT('...SINTH,COSTH,RADIUS,DRAD=',2F8.4,2F12.2)
   7178 C
   7179 C     **** IMPORTANT NOTE:  LONGITUDE FOR 2-D SPLINE FILE
   7180 C                           IS IN DEGREES WEST ****
   7181 C
   7182       RLATZ=RLATP(NP)
   7183       RLONZ=360.-RLONP(NP)
   7184 C
   7185       DO 430 KL=1,KLBOG
   7186       PP=REAL(ILVL(KL))
   7187 c && 6 comments
   7188 CC    WRITE(6,427) KL,NP,INDXP(KL),IRAD,A2DVOR(IRAD,INDXP(KL),1),
   7189 CC   1             A2DVOR(IRAD+1,INDXP(KL),1),A2DVOR(IRAD,INDXP(KL),2),

Page 184         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   7190 CC   2             A2DVOR(IRAD+1,INDXP(KL),2),A2DVOR(IRAD,INDXP(KL),3),
   7191 CC   3             A2DVOR(IRAD+1,INDXP(KL),3)
   7192 CC427 FORMAT('...INTERPOLATING, KL,NP,INDXP,IRAD,HEIGHT(IRAD,IRAD+1),',
   7193 CC   1       'VTAN(IRAD,IRAD+1),VRAD(IRAD,IRAD+1)=',/,5X,4I5,6F10.2)
   7194 C
   7195       HEIGHT=A2DVOR(IRAD,INDXP(KL),1)+DRAD*(A2DVOR(IRAD+1,INDXP(KL),1)-
   7196      1       A2DVOR(IRAD,INDXP(KL),1))/DLMMVM
   7197       VTAN  =A2DVOR(IRAD,INDXP(KL),2)+DRAD*(A2DVOR(IRAD+1,INDXP(KL),2)-
   7198      1       A2DVOR(IRAD,INDXP(KL),2))/DLMMVM
   7199       VRAD  =A2DVOR(IRAD,INDXP(KL),3)+DRAD*(A2DVOR(IRAD+1,INDXP(KL),3)-
   7200      1       A2DVOR(IRAD,INDXP(KL),3))/DLMMVM
   7201 C
   7202 C     MAKE MISSING HEIGHTS AND WINDS IF NECESSARY
   7203 C
   7204       IF(ABS(HEIGHT-RMISS) .LT. EPSMIS)  HEIGHT=RMISS
   7205       IF(ABS(VTAN-RMISS) .LT. EPSMIS .AND. ABS(VRAD-RMISS) .LT. EPSMIS)
   7206      1  THEN
   7207       UWIND=RMISS
   7208       VWIND=RMISS
   7209       ELSE
   7210       UWIND=VRAD*SINTH(NP)-VTAN*COSTH(NP)
   7211       VWIND=VRAD*COSTH(NP)+VTAN*SINTH(NP)
   7212       ENDIF
   7213 C
   7214       NREC=NREC+1
   7215 c && 3 comments
   7216 CC    IF(NREC .LE. 1000*KLBOG .AND. KL .EQ. 1)
   7217 CC   1   WRITE(6,428) HEIGHT,VTAN,VRAD,UWIND,VWIND
   7218 CC428 FORMAT('...HEIGHT,VTAN,VRAD,UWIND,VWIND=',5F11.4)
   7219       DATA(3)=HEIGHT
   7220       DATA(4)=UWIND
   7221       DATA(5)=VWIND
   7222 C
   7223 C     PRINT OUT THE BOTTOM LEVEL FOR THE FIRST 1000 POINTS
   7224 C
   7225 c && 5 comments
   7226 CC    IF(NREC .LE. 1000*KLBOG .AND. KL .EQ. 1)
   7227 CC   1  WRITE(6,429) ITYP,IDATEZ,IUTCZ,RLATZ,RLONZ,PP,
   7228 CC   2               (DATA(KD),KD=1,KDTDIM),FLAG
   7229 CC429 FORMAT(1X,I2,1X,I9,1X,I4,1X,2(F7.3,1X),3(F6.1,1X),F7.1,
   7230 CC   1       2(F6.1,1X),A4)
   7231       WRITE(IUNTPV) RITYP,IDATEZ,IUTCZ,RLATZ,RLONZ,PP,
   7232      1              (DATA(KD),KD=1,KDTDIM),FLAG
   7233   430 CONTINUE
   7234 C
   7235   440 CONTINUE
   7236       NPTS=NREC/KLBOG
   7237       WRITE(6,441) NREC,NPTS,KLBOG,IVOTYP,IVFLTP
   7238   441 FORMAT('...MAKVOR HAS WRITTEN',I7,' RECORDS AT',I6,
   7239      1       ' POINTS AND',I3,' LEVELS FOR IVOTYP, IVFLTP=',2I3)
   7240 C
   7241 C     WRITE NAMELIST UPDATE FILES FOR XSPLDAT ANALYSIS AND STORM
   7242 C       TRACK FILES.
   7243 C       ****NOTE: WE USE A DUMMY TRACK FOR SIMPLICITY HERE ****
   7244 C
   7245       ITRK=3
   7246 

Page 185         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   7247       IDAYZZ(1:ITRK)=IDATEZ
   7248       IUTCZZ(1:ITRK)=IUTCZ
   7249       STLTZZ(1:ITRK)=STMLTZ
   7250       STLNZZ(1:ITRK)=STMLNZ
   7251 C
   7252       CALL RITTRK(ITRK,IUNTTK,IDAYZZ,IUTCZZ,STLTZZ,STLNZZ,
   7253      1            STMNMZ//STMIDZ)
   7254 C
   7255       ITRK=1
   7256       CALL RITDOM(ITRK,IUNTDO,IDAYZZ,IUTCZZ,XML,XMR,YNB,YNT,DELTA,
   7257      1            STMNMZ//STMIDZ)
   7258 C
   7259 C     CLOSE OR REWIND FILES
   7260 C
   7261 C     REWIND IUNTTK
   7262 C     REWIND IUNTDO
   7263 C     REWIND IUNTPV
   7264       CLOSE(UNIT=IUNTTK,STATUS='KEEP')
   7265       CLOSE(UNIT=IUNTDO,STATUS='KEEP')
   7266       CLOSE(UNIT=IUNTPV,STATUS='KEEP')
   7267 C
   7268       RETURN
   7269       END


ENTRY POINTS

  Name               
                     
 makvor_             

Page 186         Source Listing                  MAKVOR
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  6784                                                           6782                              
 11                         Label  6823                                                           6822                              
 200                        Label  6997                                                           6992                              
 201                        Label  6998                                                           6993                              
 203                        Label  7011                                                           7009                              
 21                         Label  6831                                                           6830                              
 211                        Label  7040                                                           7039                              
 213                        Label  7056                                                           7055                              
 3                          Label  6789                                                           6787                              
 301                        Label  7118                                                           7117                              
 303                        Label  7121                                                           7120                              
 311                        Label  7131                                                           7130                              
 321                        Label  7137                                                           7136                              
 350                        Label  7143                                                           7124,7126                         
 4                          Label  6798                                                           6797                              
 40                         Label  6851                                                           6849                              
 420                        Label  7165                                                           7145                              
 430                        Label  7233                                                           7185                              
 440                        Label  7235                                                           7167                              
 441                        Label  7238                                                           7237                              
 6                          Label  6819                                                           6808                              
 61                         Label  6885                                                           6884                              
 63                         Label  6890                                                           6889                              
 71                         Label  6923                                                           6922                              
 73                         Label  6929                                                           6927,6928                         
 91                         Label  6973                                                           6970,6971                         
 971                        Label  6921                                                           6920                              
 972                        Label  6932                                                           6931                              
 A2DVOR                     Local  6750     R(4)            4     3     36000    SAVE             7024,7034,7048,7141,7195,7196,7197
                                                                                                  ,7198,7199,7200                   
 ABRT1                      Subr   6825                                                           6825,6833,7044,7057               
 ABS                        Func   7204                                 scalar                    7204,7205                         
 ACOS                       Func   7160                                 scalar                    7160                              
 ANLVOR                     Subr   7071                                                           7071                              
 AS2DVO                     Subr   7032                                                           7032                              
 ATAN2DEG                   Func   7146     R(4)            4           scalar                    7146                              
 BDATE                      Common 6756                                 32       SAVE                                               
 COMDTA                     Local  6747     R(4)            4     1     5        SAVE             6925                              
 COMFAC                     Local  6774     R(4)            4           scalar   SAVE             6774,6904                         
 COSDEG_8                   Func   6743     R(8)            8           scalar                    6957,7091,7153,7154,7164          
 COSTH                      Local  6749     R(4)            4     1     10000    SAVE             7164,7210,7211                    
 DATA                       Local  6748     R(4)            4     1     5        SAVE             6853,7219,7220,7221,7232          
 DAY00                      Local  6866     R(4)            4           scalar   SAVE             6866,6871,6872,6915,6925          
 DAYMN0                     Local  6872     R(4)            4           scalar   SAVE             6872,6915                         
 DAYMX0                     Local  6871     R(4)            4           scalar   SAVE             6871,6915                         
 DAYOFF                     Local  6874     R(4)            4           scalar   SAVE             6874,6915                         
 DEGLAT                     Local  6774     R(4)            4           scalar   SAVE             6774,7091                         
 DELMMV                     Dummy  6723     R(4)            4           scalar   ARG,INOUT        6981,6982,7047                    
 DELSP                      Local  6775     R(4)            4           scalar   SAVE             6775,7032                         
 DELTA                      Dummy  6723     R(4)            4           scalar   ARG,INOUT        6902,6903,6905,7017,7092,7093,7256
 DELVD                      Local  6776     R(4)            4           scalar   SAVE             6776,6979                         

Page 187         Source Listing                  MAKVOR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DELXVO                     Local  6979     R(4)            4           scalar   SAVE             6979,6981,7023,7032,7091,7099     
 DISTSP_8                   Func   6743     R(8)            8           scalar                    6914,7094,7095,7096,7097          
 DIVFAC                     Dummy  6725     R(4)            4           scalar   ARG,INOUT        7034                              
 DLMMVM                     Local  6982     R(4)            4           scalar   SAVE             6982,7091,7169,7170,7196,7198,7200
 DRAD                       Local  7170     R(4)            4           scalar   SAVE             7170,7195,7197,7199               
 EPSMIS                     Local  6774     R(4)            4           scalar   SAVE             6774,7204,7205                    
 FIRST                      Local  6739     L(4)            4           scalar   SAVE             6773,6793,6794                    
 FITOBS                     Subr   7073                                                           7073                              
 FLAG                       Local  6738     CHAR            4           scalar   SAVE             6775,7232                         
 FLDAY                      Subr   6866                                                           6866                              
 GRABIP                     Subr   6795                                                           6795                              
 HEIGHT                     Local  7195     R(4)            4           scalar   SAVE             7195,7204,7219                    
 IBMETH                     Dummy  6723     I(4)            4           scalar   ARG,INOUT        6782,6788,6878,6884,6889,6946,6970
                                                                                                  ,6971                             
 IBOGVR                     Local  6750     I(4)            4     1     3        SAVE             6775,6811,6813,6814,6816,6817,7126
                                                                                                  ,7128,7134                        
 IDA                        Local  6859     I(4)            4           scalar   SAVE             6859,6863                         
 IDATEZ                     Dummy  6721     I(4)            4           scalar   ARG,INOUT        6787,6859,6915,7010,7018,7025,7035
                                                                                                  ,7050,7074,7231,7247              
 IDAYZZ                     Local  6752     I(4)            4     1     3        SAVE             7247,7252,7256                    
 IERASV                     Local  7035     I(4)            4           scalar   SAVE             7035,7037,7039                    
 IERSET                     Local  6916     I(4)            4           scalar   SAVE             6916                              
 IFIRST                     Local  6775     I(4)            4           scalar   SAVE             6775,6904,7008                    
 IHR                        Local  6859     I(4)            4           scalar   SAVE             6859,6866                         
 IHRD                       Local  6773     I(4)            4           scalar   SAVE             6773,6925                         
 IHRREQ                     Dummy  6726     I(4)            4           scalar   ARG,INOUT        6916                              
 ILVL                       Local  6751     I(4)            4     1     12       SAVE             6795,6993,6996,7186               
 ILVLZ                      Local  6754     I(4)            4     1     12       SAVE             6996,7016                         
 IMIN                       Local  6859     I(4)            4           scalar   SAVE             6859,6866                         
 IMO                        Local  6859     I(4)            4           scalar   SAVE             6859,6862                         
 INDCOM                     Local  6747     I(4)            4     1     5        SAVE             6840,6841,6846,6922,6926          
 INDXP                      Local  6751     I(4)            4     1     12       SAVE             6795,6995,7195,7196,7197,7198,7199
                                                                                                  ,7200                             
 INDXPZ                     Local  6754     I(4)            4     1     12       SAVE             6995,7017                         
 INDXV                      Local  6751     I(4)            4     1     7        SAVE             6795                              
 IOPT                       Local  6780     I(4)            4           scalar   SAVE             6780,6915                         
 IOVITL                     Dummy  6722     I(4)            4           scalar   ARG,INOUT        6915                              
 IPRT                       Local  6773     I(4)            4           scalar   SAVE             6773,6925                         
 IPRTV                      Local  6773     I(4)            4           scalar   SAVE             6773,7016                         
 IQUADX                     Param  6736     I(4)            4           scalar                    6754                              
 IRAD                       Local  7169     I(4)            4           scalar   SAVE             7169,7170,7195,7196,7197,7198,7199
                                                                                                  ,7200                             
 IRADMX                     Local  7025     I(4)            4           scalar   SAVE             7025,7035,7049,7141               
 ISHAPE                     Local  6901     I(4)            4           scalar   SAVE             6901,6905,7090,7099               
 ITRK                       Local  7245     I(4)            4           scalar   SAVE             7245,7247,7248,7249,7250,7252,7255
                                                                                                  ,7256                             
 ITRKMX                     Param  6735     I(4)            4           scalar                    6752,6753                         
 ITYP                       Local  6775     I(4)            4           scalar   SAVE             6775,6855                         
 IUNTBH                     Dummy  6722     I(4)            4           scalar   ARG,INOUT        6924,6928,6971,7016,7023,7032,7047
                                                                                                  ,7073                             
 IUNTDH                     Dummy  6722     I(4)            4           scalar   ARG,INOUT        6787,6917,6924                    
 IUNTDO                     Dummy  6721     I(4)            4           scalar   ARG,INOUT        7016,7256,7265                    
 IUNTPN                     Dummy  6721     I(4)            4           scalar   ARG,INOUT        6924,6934                         
 IUNTPV                     Dummy  6721     I(4)            4           scalar   ARG,INOUT        7016,7231,7266                    
 IUNTRV                     Dummy  6721     I(4)            4           scalar   ARG,INOUT        7015,7016                         

Page 188         Source Listing                  MAKVOR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IUNTTK                     Dummy  6721     I(4)            4           scalar   ARG,INOUT        7016,7252,7264                    
 IUNTVD                     Dummy  6722     I(4)            4           scalar   ARG,INOUT        6782,7032                         
 IUTCZ                      Dummy  6721     I(4)            4           scalar   ARG,INOUT        6787,6859,7010,7018,7025,7035,7050
                                                                                                  ,7074,7107,7231,7248              
 IUTCZZ                     Local  6752     I(4)            4     1     3        SAVE             7248,7252,7256                    
 IVAR                       Local  6751     I(4)            4     1     7        SAVE             6795,6809,6811,6812,6815,7017,7117
 IVFLTP                     Dummy  6722     I(4)            4           scalar   ARG,INOUT        6782,6822,6830,7001,7022,7027,7237
 IVOTYP                     Dummy  6722     I(4)            4           scalar   ARG,INOUT        6782,6822,6830,7000,7032,7055,7237
 IYR                        Local  6859     I(4)            4           scalar   SAVE             6859,6861,6925                    
 JDAT                       Local  6745     I(4)            4     1     8        SAVE             6860,6861,6862,6863,6864          
 JDY                        Local  6865     I(4)            4           scalar   SAVE             6865,6866                         
 JV                         Local  6808     I(4)            4           scalar   SAVE             6808,6809,6811,6812,6815,7117,7124
                                                                                                  ,7126,7128,7130,7134,7136,7141    
 JVBOG                      Local  6795     I(4)            4           scalar   SAVE             6795,6797,6808,6828,6830,7017,7117
 KD                         Local  7232     I(4)            4           scalar   SAVE             7232                              
 KDTDIM                     Param  6729     I(4)            4           scalar                    6748,7232                         
 KL                         Local  6992     I(4)            4           scalar   SAVE             6992,6993,6994,6995,6996,7185,7186
                                                                                                  ,7195,7196,7197,7198,7199,7200    
 KLBOG                      Local  6795     I(4)            4           scalar   SAVE             6795,6797,6821,6822,6992,7185,7236
                                                                                                  ,7237                             
 KLBOGV                     Local  6994     I(4)            4           scalar   SAVE             6994,7017                         
 KLEVMX                     Local  7025     I(4)            4           scalar   SAVE             7025,7035,7049,7141               
 LDAT                       Scalar 6756     I(4)            4     1     8        COM              6864                              
 MAKVOR                     Subr   6721                                                                                             
 MAX                        Func   6952                                 scalar                    6952,7098                         
 MAXDAT                     Param  6728     I(4)            4           scalar                    6747,6773,6849                    
 MAXPTS                     Param  6730     I(4)            4           scalar                    6748,6749,6905,7099               
 MAXVOP                     Param  6731     I(4)            4           scalar                    6750,6751,6754,6821,6822,7024,7034
                                                                                                  ,7049                             
 MAXVOR                     Param  6734     I(4)            4           scalar                    6750,7024,7034,7049               
 MAXVOV                     Param  6732     I(4)            4           scalar                    6750,6775,6809,6828,6830,7024,7034
                                                                                                  ,7049,7124                        
 MAXVOW                     Param  6733     I(4)            4           scalar                    6751                              
 MAXVPT                     Param  6730     I(4)            4           scalar                    6730                              
 MDAT                       Local  6849     I(4)            4           scalar   SAVE             6849,6850                         
 MIN                        Func   6904                                 scalar                    6904,6958,7155                    
 MM2DVO                     Subr   7023                                                           7023,7047                         
 MM3DVO                     Subr   7016                                                           7016                              
 MMX                        Local  6905     I(4)            4           scalar   SAVE             6905                              
 MXZ                        Local  7099     I(4)            4           scalar   SAVE             7099                              
 NDATA                      Local  6747     I(4)            4     1     5        SAVE             6773,6850                         
 NINT                       Func   6865                                 scalar                    6865,6993                         
 NNY                        Local  6905     I(4)            4           scalar   SAVE             6905                              
 NOBWMN                     Dummy  6726     I(4)            4           scalar   ARG,INOUT        6925,6927,6928                    
 NP                         Local  7145     I(4)            4           scalar   SAVE             7145,7146,7153,7154,7160,7163,7164
                                                                                                  ,7167,7169,7170,7182,7183,7210,721
                                                                                                  1                                 
 NPSDAT                     Local  6759     I(4)            4           scalar   SAVE             6845                              
 NPTS                       Local  6906     I(4)            4           scalar   SAVE             6906,7100,7145,7167,7236,7237     
 NREC                       Local  7106     I(4)            4           scalar   SAVE             7106,7214,7236,7237               
 NTO                        Local  6922     I(4)            4           scalar   SAVE             6922                              
 NTODAT                     Local  6836     I(4)            4           scalar   SAVE             6836,6850,6917,6922,6925          
 NUDAT                      Local  6758     I(4)            4           scalar   SAVE             6838                              
 NVDAT                      Local  6758     I(4)            4           scalar   SAVE             6839                              
 NYZ                        Local  7099     I(4)            4           scalar   SAVE             7099                              

Page 189         Source Listing                  MAKVOR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ONLYMA                     Local  6739     L(4)            4           scalar   SAVE             6796,6797,6926                    
 ONLYPS                     Local  6739     L(4)            4           scalar   SAVE             6796,6797,6844,6918,6926,7071,7073
 ONLYWI                     Local  6739     L(4)            4           scalar   SAVE             6796,6797,6837,6918,6926,7071,7073
 PCENF                      Dummy  6725     R(4)            4           scalar   ARG,INOUT        7024,7034,7048                    
 PCENZ                      Dummy  6725     R(4)            4           scalar   ARG,INOUT        6783,6788,7023,7033,7048,7073     
 PENVZ                      Dummy  6725     R(4)            4           scalar   ARG,INOUT        6783,6788,7024,7033,7048,7073     
 PP                         Local  7186     R(4)            4           scalar   SAVE             7186,7231                         
 PTOPZ                      Dummy  6725     R(4)            4           scalar   ARG,INOUT        6783,6917,6924,6993,7009,7024,7033
                                                                                                  ,7048                             
 R1                         Local  7094     R(4)            4           scalar   SAVE             7094,7098                         
 R15AVG                     Local  6880     R(4)            4           scalar   SAVE             6880,6882,6883,6889               
 R15FND                     Subr   6880                                                           6880                              
 R15INF                     Local  6778     R(4)            4           scalar   SAVE             6778,6956,6957,6967,6970,6971     
 R15MPS                     Local  6778     R(4)            4           scalar   SAVE             6778,6952,6953,6958               
 R15WND                     Dummy  6725     R(4)            4     1     4        ARG,INOUT        6880                              
 R2                         Local  7095     R(4)            4           scalar   SAVE             7095,7098                         
 R3                         Local  7096     R(4)            4           scalar   SAVE             7096,7098                         
 R4                         Local  7097     R(4)            4           scalar   SAVE             7097,7098                         
 RADIUS                     Local  6748     R(4)            4     1     10000    SAVE             7160,7169,7170                    
 RDTITL                     Subr   7007                                                           7007                              
 REAL                       Func   6855                                 scalar                    6855,7107,7170,7186               
 RFAC                       Func   6904     R(4)            4           scalar                    6904,7008                         
 RINC                       Local  6745     R(4)            4     1     5        SAVE             6864,6865                         
 RITDOM                     Subr   7256                                                           7256                              
 RITTRK                     Subr   7252                                                           7252                              
 RITYP                      Local  6855     R(4)            4           scalar   SAVE             6855,7231                         
 RLATMN                     Dummy  6723     R(4)            4           scalar   ARG,INOUT        7010,7018,7095,7101               
 RLATMX                     Dummy  6723     R(4)            4           scalar   ARG,INOUT        7010,7018,7094,7102               
 RLATP                      Local  6748     R(4)            4     1     10000    SAVE             6906,7100,7146,7153,7154,7182     
 RLATZ                      Local  7182     R(4)            4           scalar   SAVE             7182,7231                         
 RLONMN                     Dummy  6724     R(4)            4           scalar   ARG,INOUT        7010,7018,7094,7095,7097,7103     
 RLONMX                     Dummy  6724     R(4)            4           scalar   ARG,INOUT        7010,7018,7096,7104               
 RLONP                      Local  6748     R(4)            4     1     10000    SAVE             6906,7100,7146,7153,7183          
 RLONZ                      Local  7183     R(4)            4           scalar   SAVE             7183,7231                         
 RMAXZ                      Dummy  6724     R(4)            4           scalar   ARG,INOUT        6783,6787,6880,6882,6888,6896,6904
                                                                                                  ,6917,6936,7008,7073              
 RMISS                      Local  6774     R(4)            4           scalar   SAVE             6774,6853,7129,7204,7205,7207,7208
 RMXBOG                     Local  7008     R(4)            4           scalar   SAVE             7008,7009,7017                    
 RMXCOM                     Local  6904     R(4)            4           scalar   SAVE             6904,6905,6914,6917               
 RMXMMV                     Local  6936     R(4)            4           scalar   SAVE             6936,7023,7033,7048               
 RMXVOR                     Local  7098     R(4)            4           scalar   SAVE             7098,7099                         
 RPOT                       Local  6883     R(4)            4           scalar   SAVE             6883,6884,6888,6889,6896,6917,6924
                                                                                                  ,6927,6928,6970,6971,7033         
 RVALUE                     Local  7129     R(4)            4           scalar   SAVE             7129,7135,7141                    
 SETCOM                     Subr   6917                                                           6917                              
 SETTRK                     Subr   6915                                                           6915                              
 SINDEG_8                   Func   6743     R(8)            8           scalar                    6956,6967,7154,7163               
 SINTH                      Local  6749     R(4)            4     1     10000    SAVE             7163,7210,7211                    
 SP1DWL                     Dummy  6723     R(4)            4           scalar   ARG,INOUT        7023,7032,7047                    
 SPDMIN                     Local  6778     R(4)            4           scalar   SAVE             6778,6952                         
 SPDPOT                     Local  6925     R(4)            4           scalar   SAVE             6925,6927,6928,6951,6952,6953,6956
                                                                                                  ,6957,6965,6970,6972              
 STLNZZ                     Local  6753     R(4)            4     1     3        SAVE             7250,7252                         
 STLTZZ                     Local  6752     R(4)            4     1     3        SAVE             7249,7252                         
 STMDRZ                     Dummy  6724     R(4)            4           scalar   ARG,INOUT        6788,6880,6915,6917               

Page 190         Source Listing                  MAKVOR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 STMIDZ                     Dummy  6726     CHAR            3           scalar   ARG,INOUT        6781,6782,6787,6918,7009,7019,7025
                                                                                                  ,7036,7050,7074,7253,7257         
 STMLNZ                     Dummy  6724     R(4)            4           scalar   ARG,INOUT        6783,6787,6903,7009,7018,7023,7033
                                                                                                  ,7047,7073,7093,7146,7153,7250    
 STMLTZ                     Dummy  6724     R(4)            4           scalar   ARG,INOUT        6783,6787,6902,7009,7017,7023,7032
                                                                                                  ,7047,7073,7091,7092,7146,7154,724
                                                                                                  9                                 
 STMNMZ                     Dummy  6726     CHAR            9           scalar   ARG,INOUT        6782,6787,6918,7009,7019,7025,7036
                                                                                                  ,7050,7074,7253,7257              
 STMNZZ                     Local  6738     CHAR            9           scalar   SAVE             6781,6916                         
 STMSPZ                     Dummy  6724     R(4)            4           scalar   ARG,INOUT        6788,6916,6917,6952,6958,6970,6972
 SURPRP                     Subr   6924                                                           6924                              
 TEMPLT                     Subr   6905                                                           6905,7099                         
 TERM_8                     Local  6743     R(8)            8           scalar   SAVE             7153,7155,7160                    
 THETA                      Local  7146     R(4)            4           scalar   SAVE             7146,7163,7164                    
 UPOT                       Local  6956     R(4)            4           scalar   SAVE             6956,6967,6970,6971,7033          
 UTC0                       Local  7107     R(4)            4           scalar   SAVE             7107                              
 UWIND                      Local  7207     R(4)            4           scalar   SAVE             7207,7210,7220                    
 VORDIV                     Dummy  6726     L(4)            4           scalar   ARG,INOUT        6782,6953,6978,7035,7038,7039,7078
 VPOT                       Local  6957     R(4)            4           scalar   SAVE             6957,6966,6967,6970,6971,7033     
 VRAD                       Local  7199     R(4)            4           scalar   SAVE             7199,7205,7210,7211               
 VTAN                       Local  7197     R(4)            4           scalar   SAVE             7197,7205,7210,7211               
 VTBOG                      Local  6958     R(4)            4           scalar   SAVE             6958,7034                         
 VTBOGZ                     Dummy  6726     R(4)            4           scalar   ARG,INOUT        6783,6788,6966,6970,6971          
 VWIND                      Local  7208     R(4)            4           scalar   SAVE             7208,7211,7221                    
 W3DIFDAT                   Subr   6864                                                           6864                              
 WINDOW                     Local  6870     R(4)            4           scalar   SAVE             6870,6871,6872                    
 XML                        Local  6906     R(4)            4           scalar   SAVE             6906,6914,6924,7103,7120,7256     
 XMLZ                       Local  7100     R(4)            4           scalar   SAVE             7100,7120                         
 XMR                        Local  6906     R(4)            4           scalar   SAVE             6906,6914,6924,7104,7120,7256     
 XMRZ                       Local  7100     R(4)            4           scalar   SAVE             7100,7120                         
 YNB                        Local  6905     R(4)            4           scalar   SAVE             6905,6914,6924,7101,7120,7256     
 YNBZ                       Local  7099     R(4)            4           scalar   SAVE             7099,7120                         
 YNT                        Local  6905     R(4)            4           scalar   SAVE             6905,6914,6924,7102,7120,7256     
 YNTZ                       Local  7100     R(4)            4           scalar   SAVE             7100,7120                         
 ZLAT                       Local  6902     R(4)            4           scalar   SAVE             6902,6905,7092,7094,7095,7096,7097
                                                                                                  ,7099                             
 ZLON                       Local  6903     R(4)            4           scalar   SAVE             6903,6905,7093,7096,7097,7099     
 ZNEAR                      Func   6902     R(4)            4           scalar                    6902,6903,7092,7093               
 ZTIME                      Subr   6859                                                           6859                              

Page 191         Source Listing                  MAKVOR
2017-04-18 11:09                                 syndata.f

   7270 
   7271 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7272 C
   7273 C SUBPROGRAM:    R15FND      CALCULATES AVERAGE RADIUS OF 15 M/S WINDS
   7274 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   7275 C
   7276 C ABSTRACT: CALCULATES AVERAGE RADIUS OF 15 M/S WINDS
   7277 C
   7278 C PROGRAM HISTORY LOG:
   7279 C 1991-06-06  S. J. LORD
   7280 C
   7281 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   7282 C   INPUT ARGUMENT LIST:
   7283 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   7284 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   7285 C
   7286 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   7287 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   7288 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   7289 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   7290 C
   7291 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   7292 C     DDNAME1  - GENERIC NAME & CONTENT
   7293 C
   7294 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   7295 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   7296 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   7297 C
   7298 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   7299 C
   7300 C ATTRIBUTES:
   7301 C   LANGUAGE: FORTRAN 90
   7302 C   MACHINE:  NCEP WCOSS
   7303 C
   7304 C$$$
   7305 C
   7306       SUBROUTINE R15FND(R15WND,STMDRZ,RMAXZ,R15AVG)
   7307 C
   7308       PARAMETER (IQUADX=4)
   7309 C
   7310       SAVE
   7311       LOGICAL FIRST
   7312 C
   7313       DIMENSION R15WND(IQUADX),ANGR15(IQUADX)
   7314 C
   7315       DATA FIRST/.TRUE./,ANGR15/45.,135.,225.,315./,R15FAC/0.667/
   7316 C
   7317       IF(FIRST)  THEN
   7318       FIRST=.FALSE.
   7319       ASECTR=360./REAL(IQUADX)
   7320       ENDIF
   7321 C
   7322 C     DETERMINE THE RADIUS OF 15 M/S WINDS IN THE FRONT AND REAR
   7323 C       RIGHT QUADRANTS RELATIVE TO THE STORM MOTION
   7324 C
   7325       NQAVG=0
   7326       R15AVG=0.0

Page 192         Source Listing                  R15FND
2017-04-18 11:09                                 syndata.f

   7327       DO 10 IQ=1,IQUADX
   7328       IF(R15WND(IQ) .GT. 0.0)  THEN
   7329       IQUADZ=IFIX(MOD(360.-STMDRZ+ANGR15(IQ),360.)/ASECTR)+1
   7330 c && 3 comments
   7331 CC    WRITE(6,9) IQ,R15WND(IQ),STMDRZ,ANGR15(IQ),ASECTR,IQUADZ
   7332 CC  9 FORMAT('...IQ,R15WND(IQ),STMDRZ,ANGR15(IQ),ASECTR,IQUADZ=',I3,
   7333 CC   1       4F8.1,I4)
   7334       IF(IQUADZ .EQ. 1 .OR. IQUADZ .EQ. 2)  THEN
   7335       NQAVG=NQAVG+1
   7336       R15AVG=R15AVG+R15WND(IQ)
   7337       ENDIF
   7338       ENDIF
   7339    10 CONTINUE
   7340 C
   7341       IF(NQAVG .GT. 0)  THEN
   7342       R15AVG=R15AVG/REAL(NQAVG)
   7343 C
   7344       ELSE
   7345 C
   7346       R15AVG= R15FAC*RMAXZ
   7347       WRITE(6,11)  R15FAC,RMAXZ,(R15WND(IQ),IQ=1,IQUADX)
   7348    11 FORMAT(/'...RADII OF 15 M/S WINDS ARE MISSING. AN EMPIRICAL ',
   7349      1       'FACTOR OF',F7.3,' WILL BE APPLIED TO RMAX=',F7.1,'.',/,4X,
   7350      2       'R15WND=',4F7.1)
   7351       ENDIF
   7352 C
   7353       RETURN
   7354       END

Page 193         Source Listing                  R15FND
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 r15fnd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  7339                                                           7327                              
 11                         Label  7348                                                           7347                              
 ANGR15                     Local  7313     R(4)            4     1     4        SAVE             7315,7329                         
 ASECTR                     Local  7319     R(4)            4           scalar   SAVE             7319,7329                         
 FIRST                      Local  7311     L(4)            4           scalar   SAVE             7315,7317,7318                    
 IFIX                       Func   7329                                 scalar                    7329                              
 IQ                         Local  7327     I(4)            4           scalar   SAVE             7327,7328,7329,7336,7347          
 IQUADX                     Param  7308     I(4)            4           scalar                    7313,7319,7327,7347               
 IQUADZ                     Local  7329     I(4)            4           scalar   SAVE             7329,7334                         
 MOD                        Func   7329                                 scalar                    7329                              
 NQAVG                      Local  7325     I(4)            4           scalar   SAVE             7325,7335,7341,7342               
 R15AVG                     Dummy  7306     R(4)            4           scalar   ARG,INOUT        7326,7336,7342,7346               
 R15FAC                     Local  7315     R(4)            4           scalar   SAVE             7315,7346,7347                    
 R15FND                     Subr   7306                                                                                             
 R15WND                     Dummy  7306     R(4)            4     1     4        ARG,INOUT        7328,7336,7347                    
 REAL                       Func   7319                                 scalar                    7319,7342                         
 RMAXZ                      Dummy  7306     R(4)            4           scalar   ARG,INOUT        7346,7347                         
 STMDRZ                     Dummy  7306     R(4)            4           scalar   ARG,INOUT        7329                              

Page 194         Source Listing                  R15FND
2017-04-18 11:09                                 syndata.f

   7355 
   7356 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7357 C                .      .    .                                       .
   7358 C SUBPROGRAM:    OVRLAP      OVERLAP BETWEEN TROPICAL CYCLONE CIRCS.
   7359 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1992-10-01
   7360 C
   7361 C ABSTRACT: DETERMINES WHETHER OR NOT AN OVERLAP EXISTS BETWEEN
   7362 C   MULTIPLE TROPICAL CYCONE CIRCULATIONS.
   7363 C
   7364 C PROGRAM HISTORY LOG:
   7365 C 1991-06-06  S. J. LORD
   7366 C 1992-10-01  S. J. LORD FIXED BUG CAUSING FAILURE IN OVERLAP CHECK
   7367 C
   7368 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   7369 C   INPUT ARGUMENT LIST:
   7370 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   7371 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   7372 C
   7373 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   7374 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   7375 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   7376 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   7377 C
   7378 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   7379 C     DDNAME1  - GENERIC NAME & CONTENT
   7380 C
   7381 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   7382 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   7383 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   7384 C
   7385 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   7386 C
   7387 C ATTRIBUTES:
   7388 C   LANGUAGE: FORTRAN 90
   7389 C   MACHINE:  NCEP WCOSS
   7390 C
   7391 C$$$
   7392       SUBROUTINE OVRLAP(IUNTSL,IUNTBH,KSTORM,MAXPTS,ISHAPE,DELTA,STMLTO,
   7393      2                  STMLNO,RMXBOG,RMAX,RLATP,RLONP,IFST,OVRFLG)
   7394 C
   7395       PARAMETER (MAXSTM=70)
   7396       PARAMETER (LATG2=190,LONF=384)
   7397 C
   7398       LOGICAL OVRFLG
   7399 C
   7400       SAVE
   7401 
   7402       REAL(8)  DISTSP_8
   7403 C
   7404       DIMENSION RLAT(LATG2),RLON(LONF),SLMASK(LONF,LATG2)
   7405 C
   7406       DIMENSION STMLTO(KSTORM),STMLNO(KSTORM),RMXBOG(KSTORM),
   7407      1          RMAX(KSTORM),RLATP(MAXPTS),RLONP(MAXPTS),IFST(KSTORM),
   7408      2          OVRFLG(KSTORM)
   7409 C
   7410       DIMENSION RLATMN(MAXSTM),RLATMX(MAXSTM),RLONMN(MAXSTM),
   7411      1          RLONMX(MAXSTM)

Page 195         Source Listing                  OVRLAP
2017-04-18 11:09                                 syndata.f

   7412 C
   7413 C     BUFZON:  WIDTH BETWEEN TWO RECTANGULAR BOGUSING REGIONS
   7414 C              (DEG. LAT.)
   7415 C     EPSLL:   TOLERANCE FOR TESTING QUADRANT (DEG. LAT.)
   7416 C
   7417       DATA BUFZON/1.0/,EPSLL/1.E-2/,DEGLAT/111.1775/
   7418 C
   7419       OVRFLG=.FALSE.
   7420 C
   7421       IF(KSTORM .GT. MAXSTM)  THEN
   7422       WRITE(6,11)  KSTORM,MAXSTM
   7423    11 FORMAT(/'******INSUFFICIENT SPACE ALLOCATED FOR OVERLAP CHECK.',
   7424      1       ' KSTORM, MAXSTM=',2I5,/,7X,'THIS CHECK WILL NOT BE ',
   7425      2       'PERFORMED!!!')
   7426       RETURN
   7427       ENDIF
   7428 C
   7429       DLON=360./REAL(LONF)
   7430       DO 20 ILON=1,LONF
   7431       RLON(ILON)=REAL(ILON-1)*DLON
   7432    20 CONTINUE
   7433 C
   7434       JDIM=LATG2
   7435       CALL GAULAT(RLAT,JDIM)
   7436       DO 30 JLAT=1,JDIM
   7437       RLAT(JLAT)=90.-RLAT(JLAT)
   7438    30 CONTINUE
   7439 C
   7440 c && 4 comments
   7441 CC    WRITE(6,31) (RLON(ILON),ILON=1,LONF)
   7442 CC 31 FORMAT(//'...IN OVRLAP, LONGITUDES ARE:',/,(3X,10F10.3))
   7443 CC    WRITE(6,33) (RLAT(ILAT),ILAT=1,LATG2)
   7444 CC 33 FORMAT(/'...IN OVRLAP, LATITUDES ARE:',/,(3X,10F10.3))
   7445 C
   7446       READ(IUNTSL) SLMASK
   7447 C
   7448 C     MAKE SOME ISLAND POINTS OCEAN SO THAT BOGUSING IS CONTINUOUS
   7449 C       AS CYCLONE PASSES OVER IT
   7450 C
   7451       CALL FIXSLM(LONF,LATG2,RLON,RLAT,SLMASK)
   7452 C
   7453 c && 13 comments
   7454 CC    WRITE(6,38)
   7455 CC    WRITE(6,37)  (J,(IFIX(SLMASK(I,J)),I=1,100),J=1,190)
   7456 CC 37 FORMAT(/'...SLMASK(1-100,1-190)=:',/,(1X,I3,1X,100I1))
   7457 CC    WRITE(6,38)
   7458 CC 38 FORMAT(//)
   7459 CC    WRITE(6,38)
   7460 CC    WRITE(6,39)  (J,(IFIX(SLMASK(I,J)),I=101,200),J=1,190)
   7461 CC 39 FORMAT(/'...SLMASK(101-200,1-190)=:',/,(1X,I3,1X,100I1))
   7462 CC    WRITE(6,41)  (J,(IFIX(SLMASK(I,J)),I=201,300),J=1,190)
   7463 CC 41 FORMAT(/'...SLMASK(201-300,1-190)=:',/,(1X,I3,1X,100I1))
   7464 CC    WRITE(6,38)
   7465 CC    WRITE(6,43)  (J,(IFIX(SLMASK(I,J)),I=301,384),J=1,190)
   7466 CC 43 FORMAT(/'...SLMASK(301-384,1-190)=:',/,(1X,I3,1X,84I1))
   7467 C
   7468       DO 50 KST=1,KSTORM

Page 196         Source Listing                  OVRLAP
2017-04-18 11:09                                 syndata.f

   7469       ZLAT=ZNEAR(STMLTO(KST),DELTA)
   7470       ZLON=ZNEAR(STMLNO(KST),DELTA)
   7471       CALL TEMPLT(ISHAPE,DELTA,ZLAT,ZLON,RMXBOG(KST),MAXPTS,MXZ,NYZ,
   7472      1            RLATMN(KST),RLATMX(KST),RLONMN(KST),RLONMX(KST),
   7473      2            RLATP,RLONP,NPTS)
   7474       WRITE(6,49) KST,RLATMN(KST),RLATMX(KST),RLONMN(KST),RLONMX(KST)
   7475    49 FORMAT('...KST,RLATMN,RLATMX,RLONMN,RLONMX=',I3,4F10.3)
   7476    50 CONTINUE
   7477 C
   7478 C     FIRST, WE CHECK FOR OVERLAP OF THE BOGUSING REGION WITH ANY
   7479 C       LAND POINTS.  IF THERE IS AN OVERLAP, WE BOGUS ONLY WITHIN
   7480 C       RMAX, EVEN IF IT IS THE FIRST TIME OCCURRENCE OF A STORM
   7481 C       ***IMPORTANT NOTE:  THIS METHODOLOGY RELIES ON PREPROCESSING
   7482 C                           BY THE VITCHK QUALITY CONTROL PROGRAM
   7483 C                           THAT ELIMINATES ALL STORMS FROM
   7484 C                           CONSIDERATION IF LAND IS WITHIN RMAX.
   7485 C
   7486       DO 90 KST=1,KSTORM
   7487 C
   7488       DO 70 JLAT=1,LATG2
   7489       IF(NINT(RLAT(JLAT)*100.) .LE. NINT(RLATMX(KST)*100.) .AND.
   7490      1   NINT(RLAT(JLAT)*100.) .GE. NINT(RLATMN(KST)*100.))  THEN
   7491       DO 60 ILON=1,LONF
   7492       IF(NINT(RLON(ILON)*100.) .LE. NINT(RLONMX(KST)*100.) .AND.
   7493      1   NINT(RLON(ILON)*100.) .GE. NINT(RLONMN(KST)*100.)) THEN
   7494 C
   7495       DISTZ=DISTSP_8(STMLTO(KST),STMLNO(KST),RLAT(JLAT),RLON(ILON))*
   7496      1 1.E-3
   7497       IF(DISTZ .LE. RMAX(KST) .AND. SLMASK(ILON,JLAT) .GT. EPSLL) THEN
   7498       WRITE(6,59) KST,STMLTO(KST),STMLNO(KST),RMAX(KST),IFST(KST)
   7499    59 FORMAT(/'###BOGUSING AREA REDUCED TO RMAX DUE TO PROXIMITY TO ',
   7500      1       'LAND.  KST,STMLAT,STMLON,RMAX,IFST=',/,4X,I4,3F10.2,I5)
   7501       IF(IFST(KST) .EQ. 1)  IFST(KST)=2
   7502       GO TO 90
   7503       ENDIF
   7504       ENDIF
   7505    60 CONTINUE
   7506       ENDIF
   7507    70 CONTINUE
   7508 C
   7509    90 CONTINUE
   7510 C
   7511 C     NOW CONSIDER OVERLAPS OF THE BOGUSING AREA BETWEEN DIFFERENT
   7512 C       STORMS.
   7513 C
   7514       IF(KSTORM .EQ. 1)  THEN
   7515       WRITE(6,101)
   7516   101 FORMAT(/'...THERE IS ONLY ONE STORM. NO OVERLAP FLAGS WILL BE ',
   7517      1       'SET.')
   7518       RETURN
   7519 C
   7520       ELSE
   7521       WRITE(6,103) KSTORM,BUFZON
   7522   103 FORMAT(/'...SINCE THERE ARE',I3,' STORMS, WE LOOK FOR POSSIBLE ',
   7523      1       'OVERLAPS BETWEEN THE BOGUSING AREAS. BUFFER ZONE=',F6.1,
   7524      2       ' DEG.')
   7525 C

Page 197         Source Listing                  OVRLAP
2017-04-18 11:09                                 syndata.f

   7526       DO 150 KST1=1,KSTORM-1
   7527       IF(OVRFLG(KST1))  GO TO 150
   7528 C
   7529       IQUAD1=IFIX((RLONMX(KST1)-EPSLL)/90.0)+1
   7530 C
   7531       DO 130 KST2=KST1+1,KSTORM
   7532 C
   7533 C     CHECK OVERLAPS ONLY IF BOTH STORMS HAVE NOT ALREADY BEEN
   7534 C       MARKED OFF BY ASSIGNING AN OVERLAP FLAG
   7535 C
   7536       IF(.NOT. OVRFLG(KST1) .AND. .NOT. OVRFLG(KST2))  THEN
   7537 C
   7538       IQUAD2=IFIX((RLONMX(KST2)-EPSLL)/90.0)+1
   7539 C
   7540 C     STORMS MUST BE IN ADJACENT QUADRANTS FOR THE FOLLOWING TEST
   7541 C       TO APPLY (THE EXCEPTION, STORMS ACROSS GREENWICH, WILL BE
   7542 C       TESTED SEPARATELY
   7543 C
   7544       IF(IABS(IQUAD1-IQUAD2) .LE. 1)  THEN
   7545 C
   7546       IF(NINT((RLATMX(KST1)+BUFZON)*100.).GE.NINT(RLATMN(KST2)*100.)
   7547      1  .AND.
   7548      2  NINT((RLATMN(KST1)-BUFZON)*100.).LE.NINT(RLATMX(KST2)*100.))THEN
   7549 C
   7550       IF(NINT((RLONMX(KST1)+BUFZON)*100.).GE.NINT(RLONMN(KST2)*100.)
   7551      1  .AND.
   7552      2  NINT((RLONMN(KST1)-BUFZON)*100.).LE.NINT(RLONMX(KST2)*100.))THEN
   7553       DISTZ=DISTSP_8(STMLTO(KST1),STMLNO(KST1),
   7554      1             STMLTO(KST2),STMLNO(KST2))*1.E-3
   7555 C
   7556 C     FOR CASES WHERE BOTH STORM HAVE BEEN BOGUSED BEFORE, A MORE
   7557 C       ACCURATE CHECK IS IF THE DISTANCE BETWEEN THE STORM CENTERS
   7558 C       IS LESS THAN THE SUM OF THE RADII OF THE CIRCULATIONS PLUS
   7559 C       THE BUFFER DISTANCE
   7560 C
   7561       IF(IFST(KST1) .GE. 2 .AND. IFST(KST2) .GE. 2 .AND.
   7562      1   DISTZ .GT. RMAX(KST1)+RMAX(KST2)+BUFZON*DEGLAT)  GO TO 130
   7563       WRITE(6,123) IQUAD1,KST1,RLATMN(KST1),RLATMX(KST1),RLONMN(KST1),
   7564      1         RLONMX(KST1),DISTZ,STMLTO(KST1),STMLNO(KST1),IFST(KST1),
   7565      2         IQUAD2,KST2,RLATMN(KST2),RLATMX(KST2),RLONMN(KST2),
   7566      3         RLONMX(KST2),DISTZ,STMLTO(KST2),STMLNO(KST2),IFST(KST2)
   7567       WRITE(IUNTBH,123) IQUAD1,KST1,RLATMN(KST1),RLATMX(KST1),
   7568      1                 RLONMN(KST1),RLONMX(KST1),DISTZ,STMLTO(KST1),
   7569      2                 STMLNO(KST1),IFST(KST1),IQUAD2,KST2,RLATMN(KST2),
   7570      3                 RLATMX(KST2),RLONMN(KST2),RLONMX(KST2),DISTZ,
   7571      4                 STMLTO(KST2),STMLNO(KST2),IFST(KST2)
   7572   123 FORMAT(/'...AN OVERLAP HAS BEEN DETECTED.  IQUAD,KST,RLATMN,',
   7573      1       'RLATMX,RLONMN,RLONMX,DIST,STMLAT,STMLON,IFST(1,2)=',/,
   7574      2       (5X,2I3,7F10.3,I3))
   7575 C
   7576       IF(IFST(KST1) .GE. 2 .AND. IFST(KST2) .GE. 2 .AND.
   7577      1   DISTZ .LT. RMAX(KST1)+RMAX(KST2))  THEN
   7578       WRITE(6,127)  KST1,RMAX(KST1),KST2,RMAX(KST2),DISTZ
   7579   127 FORMAT(/'******OVERLAP BETWEEN VORTEX CIRCULATIONS HAS OCCURRED.',
   7580      1       ' THIS IS AN UNREALISTIC SITUATION.',/,4X,
   7581      2       'THE SMALLER STORM MUST BE DROPPED. KST1,RMAX(KST1)',
   7582      3       'KST2,RMAX(KST2),DISTZ',/,4X,I3,F10.2,I3,2F10.2)

Page 198         Source Listing                  OVRLAP
2017-04-18 11:09                                 syndata.f

   7583         IF(RMAX(KST1) .GE. RMAX(KST2))  THEN
   7584         OVRFLG(KST2)=.TRUE.
   7585         ELSE
   7586         OVRFLG(KST1)=.TRUE.
   7587         ENDIF
   7588 C
   7589       ENDIF
   7590 C
   7591       TOOBIG=MAX(0.5*(RMXBOG(KST1)+RMXBOG(KST2)+BUFZON*DEGLAT-DISTZ),
   7592      1             0.0)
   7593       RMXBOG(KST1)=MAX(RMXBOG(KST1)-TOOBIG,RMAX(KST1))
   7594       RMXBOG(KST2)=MAX(RMXBOG(KST2)-TOOBIG,RMAX(KST2))
   7595       WRITE(6,129)  RMAX(KST1),RMAX(KST2),TOOBIG,BUFZON*DEGLAT,DISTZ,
   7596      1              RMXBOG(KST1),RMXBOG(KST2)
   7597   129 FORMAT(/'...OVERLAP REDUCED BY DECREASING RMXBOG. RMAX(1,2),',
   7598      1       'TOOBIG,BUFZON,DISTZ,NEW RMXBOG(1,2)=',/,20X,7F10.2)
   7599 C
   7600 C     IF AN OVERLAP OCCURS, ONLY ONE OF THE STORMS WILL BE BOGUSED.
   7601 C       TOP PRIORITY IS A STORM THAT HAS NOT BEEN BOGUSED BEFORE
   7602 C       (IFST=1).  PRIORITY THEN PROCEEDS DOWNWARD FROM SMALL TO
   7603 C       LARGE STORMS ON THE SUPPOSITION THAT THE SMALL ONES ARE
   7604 C       HARDER TO KEEP IN THE MODEL.
   7605 C
   7606 C     BOTH STORMS HAVE NOT BEEN BOGUSED BEFORE OR BOTH STORMS HAVE
   7607 C       BEEN BOGUSED BEFORE: DECISION BASED ON SIZE ONLY
   7608 C****NOT USED AS OF 12/18/90
   7609 C     IF((IFST(KST1) .EQ. 1 .AND. IFST(KST2) .EQ. 1) .OR.
   7610 C    1    IFST(KST1) .GE. 2 .AND. IFST(KST2) .GE. 2)  THEN
   7611 C       IF(RMXBOG(KST1) .LT. RMXBOG(KST2))  THEN
   7612 C       OVRFLG(KST2)=.TRUE.
   7613 C       ELSE
   7614 C       OVRFLG(KST1)=.TRUE.
   7615 C       ENDIF
   7616 C     GO TO 130
   7617 C     ENDIF
   7618 C
   7619 C     ONE STORM IS BEING BOGUSED FOR THE FIRST TIME
   7620 C
   7621 C     IF(IFST(KST1) .EQ. 1) THEN
   7622 C     OVRFLG(KST2)=.TRUE.
   7623 C     ELSE
   7624 C     OVRFLG(KST1)=.TRUE.
   7625 C     ENDIF
   7626 C****NOT USED AS OF 12/18/90
   7627 C
   7628       ENDIF
   7629       ENDIF
   7630       ELSE IF(IQUAD1 .EQ. 1 .AND. IQUAD2 .EQ. 4 .OR.
   7631      1        IQUAD1 .EQ. 4 .AND. IQUAD2 .EQ. 1)  THEN
   7632       WRITE(6,137) IQUAD1,IQUAD2
   7633   137 FORMAT(/'...OPTION FOR OVERLAP CHECK ACROSS GREENWICH IS NOT ',
   7634      1       'IMPLEMENTED. IQUAD1,IQUAD2=',2I4)
   7635       ENDIF
   7636       ENDIF
   7637   130 CONTINUE
   7638   150 CONTINUE
   7639       ENDIF

Page 199         Source Listing                  OVRLAP
2017-04-18 11:09                                 syndata.f

   7640 C
   7641       WRITE(6,151) (KST,STMLTO(KST),STMLNO(KST),RMXBOG(KST),
   7642      1            IFST(KST),OVRFLG(KST),KST=1,KSTORM)
   7643       WRITE(IUNTBH,151) (KST,STMLTO(KST),STMLNO(KST),RMXBOG(KST),
   7644      1                  IFST(KST),OVRFLG(KST),KST=1,KSTORM)
   7645   151 FORMAT(/'...SUMMARY OF OVERLAP CALCULATIONS:',/,5X,'KST',4X,
   7646      1       'STMLAT',4X,'STMLON',4X,'RMXBOG',2X,'IFST',2X,'OVRFLG',/,
   7647      2       (5X,I3,3F10.3,2X,I3,4X,L3))
   7648       RETURN
   7649       END


ENTRY POINTS

  Name               
                     
 ovrlap_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  7516                                                           7515                              
 103                        Label  7522                                                           7521                              
 11                         Label  7423                                                           7422                              
 123                        Label  7572                                                           7563,7567                         
 127                        Label  7579                                                           7578                              
 129                        Label  7597                                                           7595                              
 130                        Label  7637                                                           7531,7562                         
 137                        Label  7633                                                           7632                              
 150                        Label  7638                                                           7526,7527                         
 151                        Label  7645                                                           7641,7643                         
 20                         Label  7432                                                           7430                              
 30                         Label  7438                                                           7436                              
 49                         Label  7475                                                           7474                              
 50                         Label  7476                                                           7468                              
 59                         Label  7499                                                           7498                              
 60                         Label  7505                                                           7491                              
 70                         Label  7507                                                           7488                              
 90                         Label  7509                                                           7486,7502                         
 BUFZON                     Local  7417     R(4)            4           scalar   SAVE             7417,7521,7546,7548,7550,7552,7562
                                                                                                  ,7591,7595                        
 DEGLAT                     Local  7417     R(4)            4           scalar   SAVE             7417,7562,7591,7595               
 DELTA                      Dummy  7392     R(4)            4           scalar   ARG,INOUT        7469,7470,7471                    
 DISTSP_8                   Func   7402     R(8)            8           scalar                    7495,7553                         
 DISTZ                      Local  7495     R(4)            4           scalar   SAVE             7495,7497,7553,7562,7564,7566,7568
                                                                                                  ,7570,7577,7578,7591,7595         
 DLON                       Local  7429     R(4)            4           scalar   SAVE             7429,7431                         
 EPSLL                      Local  7417     R(4)            4           scalar   SAVE             7417,7497,7529,7538               
 FIXSLM                     Subr   7451                                                           7451                              
 GAULAT                     Subr   7435                                                           7435                              
 IABS                       Func   7544                                 scalar                    7544                              
 IFIX                       Func   7529                                 scalar                    7529,7538                         
 IFST                       Dummy  7393     I(4)            4     1     0        ARG,INOUT        7498,7501,7561,7564,7566,7569,7571
                                                                                                  ,7576,7642,7644                   
 ILON                       Local  7430     I(4)            4           scalar   SAVE             7430,7431,7491,7492,7493,7495,7497

Page 200         Source Listing                  OVRLAP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IQUAD1                     Local  7529     I(4)            4           scalar   SAVE             7529,7544,7563,7567,7630,7631,7632
 IQUAD2                     Local  7538     I(4)            4           scalar   SAVE             7538,7544,7565,7569,7630,7631,7632
 ISHAPE                     Dummy  7392     I(4)            4           scalar   ARG,INOUT        7471                              
 IUNTBH                     Dummy  7392     I(4)            4           scalar   ARG,INOUT        7567,7643                         
 IUNTSL                     Dummy  7392     I(4)            4           scalar   ARG,INOUT        7446                              
 JDIM                       Local  7434     I(4)            4           scalar   SAVE             7434,7435,7436                    
 JLAT                       Local  7436     I(4)            4           scalar   SAVE             7436,7437,7488,7489,7490,7495,7497
 KST                        Local  7468     I(4)            4           scalar   SAVE             7468,7469,7470,7471,7472,7474,7486
                                                                                                  ,7489,7490,7492,7493,7495,7497,749
                                                                                                  8,7501,7641,7642,7643,7644        
 KST1                       Local  7526     I(4)            4           scalar   SAVE             7526,7527,7529,7531,7536,7546,7548
                                                                                                  ,7550,7552,7553,7561,7562,7563,756
                                                                                                  4,7567,7568,7569,7576,7577,7578,75
                                                                                                  83,7586,7591,7593,7595,7596       
 KST2                       Local  7531     I(4)            4           scalar   SAVE             7531,7536,7538,7546,7548,7550,7552
                                                                                                  ,7554,7561,7562,7565,7566,7569,757
                                                                                                  0,7571,7576,7577,7578,7583,7584,75
                                                                                                  91,7594,7595,7596                 
 KSTORM                     Dummy  7392     I(4)            4           scalar   ARG,INOUT        7406,7407,7408,7421,7422,7468,7486
                                                                                                  ,7514,7521,7526,7531,7642,7644    
 LATG2                      Param  7396     I(4)            4           scalar                    7404,7434,7451,7488               
 LONF                       Param  7396     I(4)            4           scalar                    7404,7429,7430,7451,7491          
 MAX                        Func   7591                                 scalar                    7591,7593,7594                    
 MAXPTS                     Dummy  7392     I(4)            4           scalar   ARG,INOUT        7407,7471                         
 MAXSTM                     Param  7395     I(4)            4           scalar                    7410,7411,7421,7422               
 MXZ                        Local  7471     I(4)            4           scalar   SAVE             7471                              
 NINT                       Func   7489                                 scalar                    7489,7490,7492,7493,7546,7548,7550
                                                                                                  ,7552                             
 NPTS                       Local  7473     I(4)            4           scalar   SAVE             7473                              
 NYZ                        Local  7471     I(4)            4           scalar   SAVE             7471                              
 OVRFLG                     Dummy  7393     L(4)            4     1     0        ARG,INOUT        7419,7527,7536,7584,7586,7642,7644
 OVRLAP                     Subr   7392                                                                                             
 REAL                       Func   7429                                 scalar                    7429,7431                         
 RLAT                       Local  7404     R(4)            4     1     190      SAVE             7435,7437,7451,7489,7490,7495     
 RLATMN                     Local  7410     R(4)            4     1     70       SAVE             7472,7474,7490,7546,7548,7563,7565
                                                                                                  ,7567,7569                        
 RLATMX                     Local  7410     R(4)            4     1     70       SAVE             7472,7474,7489,7546,7548,7563,7565
                                                                                                  ,7567,7570                        
 RLATP                      Dummy  7393     R(4)            4     1     0        ARG,INOUT        7473                              
 RLON                       Local  7404     R(4)            4     1     384      SAVE             7431,7451,7492,7493,7495          
 RLONMN                     Local  7410     R(4)            4     1     70       SAVE             7472,7474,7493,7550,7552,7563,7565
                                                                                                  ,7568,7570                        
 RLONMX                     Local  7411     R(4)            4     1     70       SAVE             7472,7474,7492,7529,7538,7550,7552
                                                                                                  ,7564,7566,7568,7570              
 RLONP                      Dummy  7393     R(4)            4     1     0        ARG,INOUT        7473                              
 RMAX                       Dummy  7393     R(4)            4     1     0        ARG,INOUT        7497,7498,7562,7577,7578,7583,7593
                                                                                                  ,7594,7595                        
 RMXBOG                     Dummy  7393     R(4)            4     1     0        ARG,INOUT        7471,7591,7593,7594,7596,7641,7643
 SLMASK                     Local  7404     R(4)            4     2     72960    SAVE             7446,7451,7497                    
 STMLNO                     Dummy  7393     R(4)            4     1     0        ARG,INOUT        7470,7495,7498,7553,7554,7564,7566
                                                                                                  ,7569,7571,7641,7643              
 STMLTO                     Dummy  7392     R(4)            4     1     0        ARG,INOUT        7469,7495,7498,7553,7554,7564,7566
                                                                                                  ,7568,7571,7641,7643              
 TEMPLT                     Subr   7471                                                           7471                              
 TOOBIG                     Local  7591     R(4)            4           scalar   SAVE             7591,7593,7594,7595               

Page 201         Source Listing                  OVRLAP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ZLAT                       Local  7469     R(4)            4           scalar   SAVE             7469,7471                         
 ZLON                       Local  7470     R(4)            4           scalar   SAVE             7470,7471                         
 ZNEAR                      Func   7469     R(4)            4           scalar                    7469,7470                         

Page 202         Source Listing                  OVRLAP
2017-04-18 11:09                                 syndata.f

   7650 
   7651 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7652 C                .      .    .                                       .
   7653 C SUBPROGRAM:    RITSPS      WRITE INPUT FILES FOR SPLINE ANALYSIS
   7654 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   7655 C
   7656 C ABSTRACT: WRITES INPUT FILES FOR SPLINE ANALYSIS ROUTINES.  INFO
   7657 C   WRITTEN INCLUDE STORM NAME AND TRACK AND DOMAIN FOR THE ANALYSIS
   7658 C
   7659 C PROGRAM HISTORY LOG:
   7660 C 1991-06-06  S. J. LORD
   7661 C
   7662 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   7663 C   INPUT ARGUMENT LIST:
   7664 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   7665 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   7666 C
   7667 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   7668 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   7669 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   7670 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   7671 C
   7672 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   7673 C     DDNAME1  - GENERIC NAME & CONTENT
   7674 C
   7675 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   7676 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   7677 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   7678 C
   7679 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   7680 C
   7681 C ATTRIBUTES:
   7682 C   LANGUAGE: FORTRAN 90
   7683 C   MACHINE:  NCEP WCOSS
   7684 C
   7685 C$$$
   7686       SUBROUTINE RITSPS(INUM,IUNTTK,IUNTDO,IDAYZ,IUTCZ,STMLTZ,STMLNZ,
   7687      1                  XMLZ,XMRZ,YNBZ,YNTZ,DELTA,STMNMZ)
   7688 C
   7689       PARAMETER (MDIM=35,NDIM=35)
   7690 C
   7691       CHARACTER STMNMZ*(*),STNMZZ*12
   7692 C
   7693       SAVE
   7694 C
   7695       DIMENSION IDAYZ(INUM),IUTCZ(INUM),STMLTZ(INUM),STMLNZ(INUM)
   7696 C
   7697       DATA NODPDL/2/
   7698 C
   7699 C     THIS SUBROUTINE WRITES FILES AND NAMELISTS CONTAINING
   7700 C       STORM TRACK AND DOMAIN THAT ARE NEEDED BY XSPLDAT AND THE
   7701 C       ANALYSIS
   7702 
   7703 C-----------------------------------------------------------------------
   7704 
   7705 C
   7706       ENTRY RITTRK(INUM,IUNTTK,IDAYZ,IUTCZ,STMLTZ,STMLNZ,STMNMZ)

Page 203         Source Listing                  RITSPS
2017-04-18 11:09                                 syndata.f

   7707 C
   7708       STNMZZ=STMNMZ
   7709       WRITE(6,11) INUM,IUNTTK,STMNMZ,(IDAYZ(IZ),IUTCZ(IZ),STMLTZ(IZ),
   7710      1            STMLNZ(IZ),IZ=1,INUM)
   7711    11 FORMAT(/'...ENTERING RITTRK, INUM,IUNTTK,STMNMZ,IDAYZ,IUTCZ,',
   7712      1       'STMLTZ,STMLNZ=',
   7713      2       2I5,1X,A,/,(4X,I8,1X,I5,2F10.2))
   7714 C
   7715       WRITE(IUNTTK,21) STNMZZ
   7716    21 FORMAT(A12)
   7717       WRITE(IUNTTK,23)  INUM,INUM
   7718    23 FORMAT('99. 1',2I2)
   7719 C
   7720 C     CONVERT LONGITUDE TO 0-360 POSITIVE WESTWARD
   7721 C
   7722       DO 30 ITR=1,INUM
   7723       STMLNW=360.-STMLNZ(ITR)
   7724       WRITE(IUNTTK,*) STMLNW,STMLTZ(ITR),IDAYZ(ITR),IUTCZ(ITR)
   7725    30 CONTINUE
   7726 C
   7727       WRITE(6,1121) STNMZZ
   7728  1121 FORMAT('...A COPY OF THE STORM TRACK FILE FOLLOWS:',/,1X,A12)
   7729       WRITE(6,1123)  INUM,INUM
   7730  1123 FORMAT(' 99. 1',2I2)
   7731       DO 1130 ITR=1,INUM
   7732       STMLNW=360.-STMLNZ(ITR)
   7733       WRITE(6,*) STMLNW,STMLTZ(ITR),IDAYZ(ITR),IUTCZ(ITR)
   7734  1130 CONTINUE
   7735 C
   7736       REWIND IUNTTK
   7737       RETURN
   7738 
   7739 C-----------------------------------------------------------------------
   7740 
   7741 C
   7742       ENTRY RITDOM(INUM,IUNTDO,IDAYZ,IUTCZ,XMLZ,XMRZ,YNBZ,YNTZ,DELTA,
   7743      1             STMNMZ)
   7744 C
   7745       WRITE(6,101) INUM,IUNTDO,IDAYZ(INUM),IUTCZ(INUM),XMLZ,XMRZ,
   7746      1             YNBZ,YNTZ,DELTA
   7747   101 FORMAT(/'...ENTERING RITDOM, INUM,IUNTDO,IDAYZ,IUTCZ,XMLZ,',
   7748      1       'XMRZ,YNBZ,YNTZ,DELTA=',/,5X,2I5,1X,I8,1X,I5,5F10.2)
   7749 C
   7750       STNMZZ=STMNMZ
   7751       WRITE(IUNTDO,121)  STNMZZ
   7752   121 FORMAT(' &BOGPRM STMNAM=''',A12,''',')
   7753       WRITE(IUNTDO,122)  IDAYZ(INUM),IUTCZ(INUM)
   7754   122 FORMAT('   IDAYZ=',I9,',IUTCZ=',I7,',')
   7755       WRITE(IUNTDO,123) XMLZ,XMRZ,YNBZ,YNTZ
   7756   123 FORMAT('   XMLZ=',F8.3,',XMRZ=',F8.3,',YNBZ=',F8.3,
   7757      1       ',YNTZ=',F8.3,',')
   7758 C
   7759 C     CALCULATE NUMBER OF NODAL POINTS.  NODAL SPACING WILL BE
   7760 C       APPROXIMATELY TWICE THE NUMBER OF SAMPLED ANALYSIS POINTS
   7761 C
   7762       MXZ=MIN(INT((ABS(XMLZ-XMRZ)/DELTA)*REAL(NODPDL)+0.0001),MDIM-1)
   7763       NXZ=MIN(INT((ABS(YNTZ-YNBZ)/DELTA)*REAL(NODPDL)+0.0001),NDIM-1)

Page 204         Source Listing                  RITSPS
2017-04-18 11:09                                 syndata.f

   7764       WRITE(IUNTDO,124) MXZ,NXZ,DELTA
   7765   124 FORMAT('   MXZ=',I5,',NXZ=',I5,',DELSPD=',F6.3)
   7766 C
   7767       WRITE(IUNTDO,131)
   7768   131 FORMAT(' /')
   7769 C
   7770       WRITE(6,151) STNMZZ
   7771   151 FORMAT('...A COPY OF THE BOGUS DOMAIN AND PARM FILE',
   7772      1       ' FOLLOWS:',/,1X,A12)
   7773       WRITE(6,161)  STNMZZ
   7774   161 FORMAT(/' &BOGPRM STMNAM=''',A12,''',')
   7775       WRITE(6,171)  IDAYZ(INUM),IUTCZ(INUM)
   7776   171 FORMAT('    IDAYZ=',I9,',IUTCZ=',I7)
   7777       WRITE(6,181) XMLZ,XMRZ,YNBZ,YNTZ
   7778   181 FORMAT('    XMLZ=',F8.3,',XMRZ=',F8.3,',YNBZ=',F8.3,
   7779      1       ',YNTZ=',F8.3)
   7780       WRITE(6,191) MXZ,NXZ,DELTA
   7781   191 FORMAT('    MXZ=',I5,',NXZ=',I5,',DELSPD=',F6.3)
   7782 C
   7783       WRITE(6,199)
   7784   199 FORMAT('  /')
   7785       REWIND IUNTDO
   7786       RETURN
   7787       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 ritdom_               ritsps_               rittrk_             

Page 205         Source Listing                  RITSPS
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  7747                                                           7745                              
 11                         Label  7711                                                           7709                              
 1121                       Label  7728                                                           7727                              
 1123                       Label  7730                                                           7729                              
 1130                       Label  7734                                                           7731                              
 121                        Label  7752                                                           7751                              
 122                        Label  7754                                                           7753                              
 123                        Label  7756                                                           7755                              
 124                        Label  7765                                                           7764                              
 131                        Label  7768                                                           7767                              
 151                        Label  7771                                                           7770                              
 161                        Label  7774                                                           7773                              
 171                        Label  7776                                                           7775                              
 181                        Label  7778                                                           7777                              
 191                        Label  7781                                                           7780                              
 199                        Label  7784                                                           7783                              
 21                         Label  7716                                                           7715                              
 23                         Label  7718                                                           7717                              
 30                         Label  7725                                                           7722                              
 ABS                        Func   7762                                 scalar                    7762,7763                         
 DELTA                      Dummy  7687     R(4)            4           scalar   ARG,INOUT        7746,7762,7763,7764,7780          
 IDAYZ                      Dummy  7686     I(4)            4     1     0        ARG,INOUT        7709,7724,7733,7745,7753,7775     
 INT                        Func   7762                                 scalar                    7762,7763                         
 INUM                       Dummy  7686     I(4)            4           scalar   ARG,INOUT        7695,7709,7710,7717,7722,7729,7731
                                                                                                  ,7745,7753,7775                   
 ITR                        Local  7722     I(4)            4           scalar   SAVE             7722,7723,7724,7731,7732,7733     
 IUNTDO                     Dummy  7686     I(4)            4           scalar   ARG,INOUT        7745,7751,7753,7755,7764,7767,7785
 IUNTTK                     Dummy  7686     I(4)            4           scalar   ARG,INOUT        7709,7715,7717,7724,7736          
 IUTCZ                      Dummy  7686     I(4)            4     1     0        ARG,INOUT        7709,7724,7733,7745,7753,7775     
 IZ                         Local  7709     I(4)            4           scalar   SAVE             7709,7710                         
 MDIM                       Param  7689     I(4)            4           scalar                    7762                              
 MIN                        Func   7762                                 scalar                    7762,7763                         
 MXZ                        Local  7762     I(4)            4           scalar   SAVE             7762,7764,7780                    
 NDIM                       Param  7689     I(4)            4           scalar                    7763                              
 NODPDL                     Local  7697     I(4)            4           scalar   SAVE             7697,7762,7763                    
 NXZ                        Local  7763     I(4)            4           scalar   SAVE             7763,7764,7780                    
 REAL                       Func   7762                                 scalar                    7762,7763                         
 RITDOM                     Subr   7742                                                                                             
 RITSPS                     Subr   7686                                                                                             
 RITTRK                     Subr   7706                                                                                             
 STMLNW                     Local  7723     R(4)            4           scalar   SAVE             7723,7724,7732,7733               
 STMLNZ                     Dummy  7686     R(4)            4     1     0        ARG,INOUT        7710,7723,7732                    
 STMLTZ                     Dummy  7686     R(4)            4     1     0        ARG,INOUT        7709,7724,7733                    
 STMNMZ                     Dummy  7687     CHAR                        scalar   ARG,INOUT        7708,7709,7750                    
 STNMZZ                     Local  7691     CHAR            12          scalar   SAVE             7708,7715,7727,7750,7751,7770,7773
 XMLZ                       Dummy  7687     R(4)            4           scalar   ARG,INOUT        7745,7755,7762,7777               
 XMRZ                       Dummy  7687     R(4)            4           scalar   ARG,INOUT        7745,7755,7762,7777               
 YNBZ                       Dummy  7687     R(4)            4           scalar   ARG,INOUT        7746,7755,7763,7777               
 YNTZ                       Dummy  7687     R(4)            4           scalar   ARG,INOUT        7746,7755,7763,7777               

Page 206         Source Listing                  RITSPS
2017-04-18 11:09                                 syndata.f

   7788 
   7789 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7790 C                .      .    .                                       .
   7791 C SUBPROGRAM:    RITCR1      WRITES RUN INFO TO LOG FILE
   7792 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   7793 C
   7794 C ABSTRACT: WRITES RUN INFORMATION TO LOG FILE.
   7795 C
   7796 C PROGRAM HISTORY LOG:
   7797 C 1991-06-06  S. J. LORD
   7798 C
   7799 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   7800 C   INPUT ARGUMENT LIST:
   7801 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   7802 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   7803 C
   7804 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   7805 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   7806 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   7807 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   7808 C
   7809 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   7810 C     DDNAME1  - GENERIC NAME & CONTENT
   7811 C
   7812 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   7813 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   7814 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   7815 C
   7816 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   7817 C
   7818 C ATTRIBUTES:
   7819 C   LANGUAGE: FORTRAN 90
   7820 C   MACHINE:  NCEP WCOSS
   7821 C
   7822 C$$$
   7823       SUBROUTINE RITCR1(IUNTBD,IUNTBH,IDAYZ,IUTCZ,RUNID)
   7824 C
   7825       CHARACTER RUNID*(*)
   7826 C
   7827       SAVE
   7828 C
   7829       CALL ZTIME(IDAYZ,IUTCZ,IYR,IMO,IDA,IHR,IMIN)
   7830       WRITE(IUNTBD,1) IDA,IHR
   7831     1 FORMAT(2I12)
   7832       WRITE(6,11) RUNID,IDA,IHR
   7833       WRITE(IUNTBH,11) RUNID,IDA,IHR
   7834    11 FORMAT('######BEGINNING SYNDATA FOR RUNID=',A,', DAY=',I3,
   7835      1       ', HOUR=',I2.2,'######')
   7836       RETURN
   7837       END

Page 207         Source Listing                  RITCR1
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 ritcr1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  7831                                                           7830                              
 11                         Label  7834                                                           7832,7833                         
 IDA                        Local  7829     I(4)            4           scalar   SAVE             7829,7830,7832,7833               
 IDAYZ                      Dummy  7823     I(4)            4           scalar   ARG,INOUT        7829                              
 IHR                        Local  7829     I(4)            4           scalar   SAVE             7829,7830,7832,7833               
 IMIN                       Local  7829     I(4)            4           scalar   SAVE             7829                              
 IMO                        Local  7829     I(4)            4           scalar   SAVE             7829                              
 IUNTBD                     Dummy  7823     I(4)            4           scalar   ARG,INOUT        7830                              
 IUNTBH                     Dummy  7823     I(4)            4           scalar   ARG,INOUT        7833                              
 IUTCZ                      Dummy  7823     I(4)            4           scalar   ARG,INOUT        7829                              
 IYR                        Local  7829     I(4)            4           scalar   SAVE             7829                              
 RITCR1                     Subr   7823                                                                                             
 RUNID                      Dummy  7823     CHAR                        scalar   ARG,INOUT        7832,7833                         
 ZTIME                      Subr   7829                                                           7829                              

Page 208         Source Listing                  RITCR1
2017-04-18 11:09                                 syndata.f

   7838 
   7839 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7840 C                .      .    .                                       .
   7841 C SUBPROGRAM:    RITCR2      WRITES STORM INFO TO MAPPING FILE
   7842 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   7843 C
   7844 C ABSTRACT: WRITES STORM INFO TO FILE FOR LIMITED AREA MAPPING.
   7845 C   INFO ARE STORM LAT/LON, RADIUS OF CIRCULATION, LATITUDINAL
   7846 C   EXTENT OF THE MAP TO BE PLOTTED, AND STORM NAME/ID.
   7847 C
   7848 C PROGRAM HISTORY LOG:
   7849 C 1991-06-06  S. J. LORD
   7850 C
   7851 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   7852 C   INPUT ARGUMENT LIST:
   7853 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   7854 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   7855 C
   7856 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   7857 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   7858 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   7859 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   7860 C
   7861 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   7862 C     DDNAME1  - GENERIC NAME & CONTENT
   7863 C
   7864 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   7865 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   7866 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   7867 C
   7868 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   7869 C
   7870 C ATTRIBUTES:
   7871 C   LANGUAGE: FORTRAN 90
   7872 C   MACHINE:  NCEP WCOSS
   7873 C
   7874 C$$$
   7875       SUBROUTINE RITCR2(IUNTBD,STMLTZ,STMLNZ,RMAXZ,RLATMN,RLATMX,STMNMZ,
   7876      1                  STMIDZ)
   7877 C
   7878       CHARACTER STMNMZ*(*),STMIDZ*3
   7879 C
   7880       SAVE
   7881 C
   7882       RLATEX=RLATMX-RLATMN+2.0
   7883       WRITE(6,202)
   7884   202 FORMAT(/'...ENTERING RITCR2 TO WRITE STORM INFORMATION:')
   7885       WRITE(IUNTBD,203) STMLTZ,STMLNZ,RMAXZ,RLATEX,
   7886      1                  STMNMZ(1:9),STMIDZ(1:3)
   7887       WRITE(6,203) STMLTZ,STMLNZ,RMAXZ,RLATEX,STMNMZ,
   7888      1             STMIDZ
   7889   203 FORMAT(4F10.2,1X,A,1X,A)
   7890       RETURN
   7891       END

Page 209         Source Listing                  RITCR2
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 ritcr2_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 202                        Label  7884                                                           7883                              
 203                        Label  7889                                                           7885,7887                         
 IUNTBD                     Dummy  7875     I(4)            4           scalar   ARG,INOUT        7885                              
 RITCR2                     Subr   7875                                                                                             
 RLATEX                     Local  7882     R(4)            4           scalar   SAVE             7882,7885,7887                    
 RLATMN                     Dummy  7875     R(4)            4           scalar   ARG,INOUT        7882                              
 RLATMX                     Dummy  7875     R(4)            4           scalar   ARG,INOUT        7882                              
 RMAXZ                      Dummy  7875     R(4)            4           scalar   ARG,INOUT        7885,7887                         
 STMIDZ                     Dummy  7876     CHAR            3           scalar   ARG,INOUT        7886,7888                         
 STMLNZ                     Dummy  7875     R(4)            4           scalar   ARG,INOUT        7885,7887                         
 STMLTZ                     Dummy  7875     R(4)            4           scalar   ARG,INOUT        7885,7887                         
 STMNMZ                     Dummy  7875     CHAR                        scalar   ARG,INOUT        7886,7887                         

Page 210         Source Listing                  RITCR2
2017-04-18 11:09                                 syndata.f

   7892 
   7893 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7894 C                .      .    .                                       .
   7895 C SUBPROGRAM:    TIMSUB      PERFORMS TIME CHORES
   7896 C   PRGMMR: D. A. KEYSER     ORG: W/NMC22    DATE: 1998-06-05
   7897 C
   7898 C ABSTRACT: VARIOUS ENTRIES CONVERT 8 DIGIT YYYYMMDD INTO YEAR, MONTH
   7899 C   AND DAY, AND FRACTIONAL JULIAN DAY FROM INTEGER JULIAN DAY, HOUR
   7900 C   AND MINUTE.
   7901 C
   7902 C PROGRAM HISTORY LOG:
   7903 C 1991-06-06  S. J. LORD
   7904 C 1998-06-05  D. A. KEYSER - Y2K/F90 COMPLIANCE
   7905 C
   7906 C USAGE:    CALL TIMSUB(IDATE,IUTC,IYR,IMO,IDA,IHR,IMIN,JDY,DAY)
   7907 C           CALL FLDAY(JDY,IHR,IMIN,DAY)
   7908 C   INPUT ARGUMENT LIST:
   7909 C     IDATE    - DATE IN FORM YYYYMMDD
   7910 C     JDY      - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
   7911 C              - 00Z ON NCEP DATE
   7912 C
   7913 C   OUTPUT ARGUMENT LIST:
   7914 C     IYR      - YEAR IN FORM YYYY
   7915 C     IMO      - MONTH OF YEAR
   7916 C     IDA      - DAY OF MONTH
   7917 C     IHR      - HOUR OF DAY
   7918 C     IMIN     - MINUTE OF HOUR
   7919 C     DAY      - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
   7920 C              - 00Z ON NCEP DATE
   7921 C
   7922 C REMARKS: NONE.
   7923 C
   7924 C ATTRIBUTES:
   7925 C   LANGUAGE: FORTRAN 90
   7926 C   MACHINE:  NCEP WCOSS
   7927 C
   7928 C$$$
   7929       SUBROUTINE TIMSUB(IDATE,IUTC,IYR,IMO,IDA,IHR,IMIN,JDY,DAY)
   7930 
   7931 C-----------------------------------------------------------------------
   7932 
   7933 
   7934       ENTRY ZTIME(IDATE,IUTC,IYR,IMO,IDA,IHR,IMIN)
   7935 
   7936 C PARSE 8 DIGIT YYYYMMDD INTO YEAR MONTH AND DAY
   7937 
   7938       IYR = IDATE/10000
   7939       IMO =(IDATE-IYR*10000)/100
   7940       IDA = IDATE-IYR*10000-IMO*100
   7941       IHR =IUTC/100
   7942       IMIN=IUTC-IHR*100
   7943       RETURN
   7944 
   7945 
   7946 C-----------------------------------------------------------------------
   7947 
   7948 C THIS ENTRY CALCULATES THE FRACTIONAL JULIAN DAY FROM INTEGERS

Page 211         Source Listing                  TIMSUB
2017-04-18 11:09                                 syndata.f

   7949 C  JULIAN DAY, HOUR AND MINUTE (ACUALLY, JDY HERE IS NO. OF DAYS
   7950 C  SINCE 365 DAYS PRIOR TO 00Z ON NCEP DATE)
   7951 
   7952       ENTRY FLDAY(JDY,IHR,IMIN,DAY)
   7953       DAY=REAL(JDY)+(REAL(IHR)*60.+REAL(IMIN))/1440.
   7954       RETURN
   7955       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 flday_                timsub_               ztime_              


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DAY                        Dummy  7929     R(4)            4           scalar   ARG,INOUT        7953                              
 FLDAY                      Subr   7952                                                                                             
 IDA                        Dummy  7929     I(4)            4           scalar   ARG,INOUT        7940                              
 IDATE                      Dummy  7929     I(4)            4           scalar   ARG,INOUT        7938,7939,7940                    
 IHR                        Dummy  7929     I(4)            4           scalar   ARG,INOUT        7941,7942,7953                    
 IMIN                       Dummy  7929     I(4)            4           scalar   ARG,INOUT        7942,7953                         
 IMO                        Dummy  7929     I(4)            4           scalar   ARG,INOUT        7939,7940                         
 IUTC                       Dummy  7929     I(4)            4           scalar   ARG,INOUT        7941,7942                         
 IYR                        Dummy  7929     I(4)            4           scalar   ARG,INOUT        7938,7939,7940                    
 JDY                        Dummy  7929     I(4)            4           scalar   ARG,INOUT        7953                              
 REAL                       Func   7953                                 scalar                    7953                              
 TIMSUB                     Subr   7929                                                                                             
 ZTIME                      Subr   7934                                                                                             

Page 212         Source Listing                  TIMSUB
2017-04-18 11:09                                 syndata.f

   7956 
   7957 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   7958 C                .      .    .                                       .
   7959 C SUBPROGRAM:    YTIME       GETS INTEGER YYYY, YYYYMMDD, HHMM
   7960 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 1998-10-29
   7961 C
   7962 C ABSTRACT: CALCULATES 8-DIGIT INTEGER YYYYMMDD, 4-DIGIT INTEGER YYYY,
   7963 C   AND 4-DIGIT INTEGER HHMM FROM FRACTIONAL NUMBER OF DAYS SINCE
   7964 C   365 DAYS PRIOR TO 00Z ON NCEP DATE
   7965 C
   7966 C PROGRAM HISTORY LOG:
   7967 C 1991-06-06  S. J. LORD
   7968 C 1998-10-29  D. A. KEYSER - Y2K/F90 COMPLIANCE
   7969 C
   7970 C USAGE:    CALL YTIME(IYR,DAYZ,IDATE,IUTC)
   7971 C   INPUT ARGUMENT LIST:
   7972 C     DAYZ     - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
   7973 C              - 00Z ON NCEP DATE
   7974 C
   7975 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   7976 C     IYR      - YEAR (YYYY)
   7977 C     IDATEZ   - SLORD DATE FORMAT FOR DATE (YYYYMMDD)
   7978 C     IUTC     - SLORD DATE FORMAT FOR DATE (HHMM)
   7979 C
   7980 C REMARKS: NONE.
   7981 C
   7982 C ATTRIBUTES:
   7983 C   LANGUAGE: FORTRAN 90
   7984 C   MACHINE:  NCEP WCOSS
   7985 C
   7986 C$$$
   7987       SUBROUTINE YTIME(IYR,DAYZ,IDATE,IUTC)
   7988       DIMENSION JDAT(8),RINC(5)
   7989       COMMON/BDATE/LDAT(8)
   7990 
   7991       RINC = 0.
   7992       RINC(1) = DAYZ
   7993       CALL W3MOVDAT(RINC,LDAT,JDAT)
   7994 
   7995       IYR = JDAT(1)
   7996       IMO = JDAT(2)
   7997       IDA = JDAT(3)
   7998       IHR = JDAT(5)
   7999       IMN = JDAT(6)
   8000 
   8001       IDATE=IDA+(100*IMO)+(10000*IYR)
   8002       IUTC =IMN+100*IHR
   8003       RETURN
   8004       END

Page 213         Source Listing                  YTIME
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 ytime_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BDATE                      Common 7989                                 32                                                          
 DAYZ                       Dummy  7987     R(4)            4           scalar   ARG,INOUT        7992                              
 IDA                        Local  7997     I(4)            4           scalar                    7997,8001                         
 IDATE                      Dummy  7987     I(4)            4           scalar   ARG,INOUT        8001                              
 IHR                        Local  7998     I(4)            4           scalar                    7998,8002                         
 IMN                        Local  7999     I(4)            4           scalar                    7999,8002                         
 IMO                        Local  7996     I(4)            4           scalar                    7996,8001                         
 IUTC                       Dummy  7987     I(4)            4           scalar   ARG,INOUT        8002                              
 IYR                        Dummy  7987     I(4)            4           scalar   ARG,INOUT        7995,8001                         
 JDAT                       Local  7988     I(4)            4     1     8                         7993,7995,7996,7997,7998,7999     
 LDAT                       Scalar 7989     I(4)            4     1     8        COM              7993                              
 RINC                       Local  7988     R(4)            4     1     5                         7991,7992,7993                    
 W3MOVDAT                   Subr   7993                                                           7993                              
 YTIME                      Subr   7987                                                                                             

Page 214         Source Listing                  YTIME
2017-04-18 11:09                                 syndata.f

   8005 
   8006 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8007 C                .      .    .                                       .
   8008 C SUBPROGRAM:    SORTRL      SORTS REAL NUMBERS
   8009 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-04
   8010 C
   8011 C ABSTRACT: SORTS REAL NUMBERS.  OUTPUT ARRAY IS THE INDEX OF
   8012 C   THE INPUT VALUES THAT ARE SORTED.
   8013 C
   8014 C PROGRAM HISTORY LOG:
   8015 C 1991-06-04  S. J. LORD (MODIFIED FROM NCAR CODE)
   8016 C
   8017 C USAGE:    CALL SORTRL(A,LA,NL)
   8018 C   INPUT ARGUMENT LIST:
   8019 C     A        - ARRAY OF ELEMENTS TO BE SORTED.
   8020 C     NL       - NUMBER OF ELEMENTS TO BE SORTED.
   8021 C
   8022 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8023 C     LA       - INTEGER ARRAY CONTAINING THE INDEX OF THE SORTED
   8024 C              - ELEMENTS.  SORTING IS FROM SMALL TO LARGE.  E.G.
   8025 C              - LA(1) CONTAINS THE INDEX OF THE SMALLEST ELEMENT IN
   8026 C              - ARRAY.  LA(NL) CONTAINS THE INDEX OF THE LARGEST.
   8027 C
   8028 C
   8029 C REMARKS: NONE
   8030 C
   8031 C ATTRIBUTES:
   8032 C   LANGUAGE: FORTRAN 90
   8033 C   MACHINE:  NCEP WCOSS
   8034 C
   8035 C$$$
   8036       SUBROUTINE SORTRL(A,LA,NL)
   8037 C
   8038 C          ENTRY SORTRL(A,LA,NL)    SORT UP REAL NUMBERS
   8039 C  ** REVISED (6/13/84) FOR THE USE IN VAX-11
   8040 C     ARGUMENTS ...
   8041 C       A    INPUT ARRAY OF NL ELEMENTS TO BE SORTED OR RE-ORDERED
   8042 C       LA   OUTPUT ARRAY OF NL ELEMENTS IN WHICH THE ORIGINAL LOCATION
   8043 C            OF THE SORTED ELEMENTS OF A ARE SAVED, OR
   8044 C            INPUT ARRAY TO SPECIFY THE REORDERING OF ARRAY A BY SORTED
   8045 C       NL   THE NUMBER OF ELEMENTS TO BE TREATED
   8046 C
   8047       SAVE
   8048 C
   8049       DIMENSION A(NL),LA(NL),LS1(64),LS2(64)
   8050       DATA NSX/64/
   8051 C
   8052 C     SET THE ORIGINAL ORDER IN LA
   8053 C
   8054       DO L=1,NL
   8055       LA(L)=L
   8056       END DO
   8057 C
   8058 C     SEPARATE NEGATIVES FROM POSITIVES
   8059 C
   8060       L = 0
   8061       M = NL + 1

Page 215         Source Listing                  SORTRL
2017-04-18 11:09                                 syndata.f

   8062    12 CONTINUE
   8063       L = L + 1
   8064       IF(L.GE.M) GO TO 19
   8065       IF(A(L).LT.0) GO TO 12
   8066    15 CONTINUE
   8067       M = M - 1
   8068       IF(L.GE.M) GO TO 19
   8069       IF(A(M).GE.0) GO TO 15
   8070       AZ = A(M)
   8071       A(M) = A(L)
   8072       A(L) = AZ
   8073       LZ = LA(M)
   8074       LA(M) = LA(L)
   8075       LA(L) = LZ
   8076       GO TO 12
   8077    19 CONTINUE
   8078       L = L - 1
   8079 C
   8080 C     NOTE THAT MIN AND MAX FOR INTERVAL (1,NL) HAVE NOT BEEN DETERMINED
   8081 C
   8082       LS1(1) = 0
   8083       L2 = NL + 1
   8084       NS = 1
   8085 C
   8086 C     STEP UP
   8087 C
   8088    20 LS1(NS) = LS1(NS) + 1
   8089       LS2(NS) = L
   8090       NS = NS + 1
   8091       IF(NS.GT.NSX) GO TO 80
   8092       L1 = L + 1
   8093       LS1(NS) = L1
   8094       L2 = L2 - 1
   8095       GO TO 40
   8096 C
   8097 C     STEP DOWN
   8098 C
   8099    30 NS=NS-1
   8100       IF (NS.LE.0) GO TO 90
   8101       L1 = LS1(NS)
   8102       L2 = LS2(NS)
   8103    40 IF(L2.LE.L1) GO TO 30
   8104 C
   8105 C     FIND MAX AND MIN OF THE INTERVAL (L1,L2)
   8106 C
   8107       IF (A(L1)-A(L2) .LE. 0) GO TO 52
   8108       AN = A(L2)
   8109       LN = L2
   8110       AX = A(L1)
   8111       LX = L1
   8112       GO TO 54
   8113    52 AN = A(L1)
   8114       LN = L1
   8115       AX = A(L2)
   8116       LX = L2
   8117    54 L1A = L1 + 1
   8118       L2A = L2 - 1

Page 216         Source Listing                  SORTRL
2017-04-18 11:09                                 syndata.f

   8119       IF(L1A.GT.L2A) GO TO 60
   8120 C
   8121       DO 58 L=L1A,L2A
   8122       IF (A(L)-AX .GT. 0) GO TO 56
   8123       IF (A(L)-AN .GE. 0) GO TO 58
   8124       AN = A(L)
   8125       LN = L
   8126       GO TO 58
   8127    56 AX = A(L)
   8128       LX = L
   8129    58 CONTINUE
   8130 C
   8131 C     IF ALL ELEMENTS ARE EQUAL (AN=AX), STEP DOWN
   8132 C
   8133    60 IF (AN .EQ. AX)  GO TO 30
   8134 C
   8135 C     PLACE MIN AT L1, AND MAX AT L2
   8136 C     IF EITHER LN=L2 OR LX=L1, FIRST EXCHANGE L1 AND L2
   8137 C
   8138       IF(LN.EQ.L2.OR.LX.EQ.L1) GO TO 62
   8139       GO TO 64
   8140    62 AZ=A(L1)
   8141       A(L1)=A(L2)
   8142       A(L2)=AZ
   8143       LZ=LA(L1)
   8144       LA(L1)=LA(L2)
   8145       LA(L2)=LZ
   8146 C
   8147 C     MIN TO L1, IF LN IS NOT AT EITHER END
   8148 C
   8149    64 IF(LN.EQ.L1.OR.LN.EQ.L2) GO TO 66
   8150       A(LN)=A(L1)
   8151       A(L1)=AN
   8152       LZ=LA(LN)
   8153       LA(LN)=LA(L1)
   8154       LA(L1)=LZ
   8155 C
   8156 C     MAX TO L2, IF LX IS NOT AT EITHER END
   8157 C
   8158    66 IF(LX.EQ.L2.OR.LX.EQ.L1) GO TO 68
   8159       A(LX)=A(L2)
   8160       A(L2)=AX
   8161       LZ=LA(LX)
   8162       LA(LX)=LA(L2)
   8163       LA(L2)=LZ
   8164 C
   8165 C     IF ONLY THREE ELEMENTS IN (L1,L2), STEP DOWN.
   8166 C
   8167    68 IF(L1A.GE.L2A) GO TO 30
   8168 C
   8169 C     SET A CRITERION TO SPLIT THE INTERVAL (L1A,L2A)
   8170 C     AC IS AN APPROXIMATE ARITHMETIC AVERAGE OF AX AND AN,
   8171 C     PROVIDED THAT AX IS GREATER THAN AN.  (IT IS THE CASE, HERE)
   8172 C     ** IF A IS DISTRIBUTED EXPONENTIALLY, GEOMETRIC MEAN MAY
   8173 C        BE MORE EFFICIENT
   8174 C
   8175       AC = (AX+AN)/2

Page 217         Source Listing                  SORTRL
2017-04-18 11:09                                 syndata.f

   8176 C
   8177 C     MIN AT L1 AND MAX AT L2 ARE OUTSIDE THE INTERVAL
   8178 C
   8179       L = L1
   8180       M = L2
   8181    72 L = L + 1
   8182       IF(L.GE.M) GO TO 78
   8183 C  73 CONTINUE
   8184       IF (A(L)-AC .LE. 0) GO TO 72
   8185    75 M = M - 1
   8186       IF(L.GE.M) GO TO 78
   8187 C  76 CONTINUE
   8188       IF (A(M)-AC .GT. 0) GO TO 75
   8189       AZ = A(M)
   8190       A(M) = A(L)
   8191       A(L) = AZ
   8192       LZ = LA(M)
   8193       LA(M) = LA(L)
   8194       LA(L) = LZ
   8195       GO TO 72
   8196 C
   8197 C     SINCE 75 IS ENTERED ONLY IF 73 IS FALSE, 75 IS NOT TENTATIVE
   8198 C     BUT 72 IS TENTATIVE, AND MUST BE CORRECTED IF NO FALSE 76 OCCURS
   8199 C
   8200    78 L = L - 1
   8201       GO TO 20
   8202    80 WRITE(6,85) NSX
   8203    85 FORMAT(/' === SORTING INCOMPLETE. SPLIT EXCEEDED',I3,' ===',/)
   8204    90 RETURN
   8205       END

Page 218         Source Listing                  SORTRL
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sortrl_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 12                         Label  8062                                                           8065,8076                         
 15                         Label  8066                                                           8069                              
 19                         Label  8077                                                           8064,8068                         
 20                         Label  8088                                                           8201                              
 30                         Label  8099                                                           8103,8133,8167                    
 40                         Label  8103                                                           8095                              
 52                         Label  8113                                                           8107                              
 54                         Label  8117                                                           8112                              
 56                         Label  8127                                                           8122                              
 58                         Label  8129                                                           8121,8123,8126                    
 60                         Label  8133                                                           8119                              
 62                         Label  8140                                                           8138                              
 64                         Label  8149                                                           8139                              
 66                         Label  8158                                                           8149                              
 68                         Label  8167                                                           8158                              
 72                         Label  8181                                                           8184,8195                         
 75                         Label  8185                                                           8188                              
 78                         Label  8200                                                           8182,8186                         
 80                         Label  8202                                                           8091                              
 85                         Label  8203                                                           8202                              
 90                         Label  8204                                                           8100                              
 A                          Dummy  8036     R(4)            4     1     0        ARG,INOUT        8065,8069,8070,8071,8072,8107,8108
                                                                                                  ,8110,8113,8115,8122,8123,8124,812
                                                                                                  7,8140,8141,8142,8150,8151,8159,81
                                                                                                  60,8184,8188,8189,8190,8191       
 AC                         Local  8175     R(4)            4           scalar   SAVE             8175,8184,8188                    
 AN                         Local  8108     R(4)            4           scalar   SAVE             8108,8113,8123,8124,8133,8151,8175
 AX                         Local  8110     R(4)            4           scalar   SAVE             8110,8115,8122,8127,8133,8160,8175
 AZ                         Local  8070     R(4)            4           scalar   SAVE             8070,8072,8140,8142,8189,8191     
 L                          Local  8054     I(4)            4           scalar   SAVE             8054,8055,8060,8063,8064,8065,8068
                                                                                                  ,8071,8072,8074,8075,8078,8089,809
                                                                                                  2,8121,8122,8123,8124,8125,8127,81
                                                                                                  28,8179,8181,8182,8184,8186,8190,8
                                                                                                  191,8193,8194,8200                
 L1                         Local  8092     I(4)            4           scalar   SAVE             8092,8093,8101,8103,8107,8110,8111
                                                                                                  ,8113,8114,8117,8138,8140,8141,814
                                                                                                  3,8144,8149,8150,8151,8153,8154,81
                                                                                                  58,8179                           
 L1A                        Local  8117     I(4)            4           scalar   SAVE             8117,8119,8121,8167               
 L2                         Local  8083     I(4)            4           scalar   SAVE             8083,8094,8102,8103,8107,8108,8109
                                                                                                  ,8115,8116,8118,8138,8141,8142,814
                                                                                                  4,8145,8149,8158,8159,8160,8162,81
                                                                                                  63,8180                           
 L2A                        Local  8118     I(4)            4           scalar   SAVE             8118,8119,8121,8167               

Page 219         Source Listing                  SORTRL
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LA                         Dummy  8036     I(4)            4     1     0        ARG,INOUT        8055,8073,8074,8075,8143,8144,8145
                                                                                                  ,8152,8153,8154,8161,8162,8163,819
                                                                                                  2,8193,8194                       
 LN                         Local  8109     I(4)            4           scalar   SAVE             8109,8114,8125,8138,8149,8150,8152
                                                                                                  ,8153                             
 LS1                        Local  8049     I(4)            4     1     64       SAVE             8082,8088,8093,8101               
 LS2                        Local  8049     I(4)            4     1     64       SAVE             8089,8102                         
 LX                         Local  8111     I(4)            4           scalar   SAVE             8111,8116,8128,8138,8158,8159,8161
                                                                                                  ,8162                             
 LZ                         Local  8073     I(4)            4           scalar   SAVE             8073,8075,8143,8145,8152,8154,8161
                                                                                                  ,8163,8192,8194                   
 M                          Local  8061     I(4)            4           scalar   SAVE             8061,8064,8067,8068,8069,8070,8071
                                                                                                  ,8073,8074,8180,8182,8185,8186,818
                                                                                                  8,8189,8190,8192,8193             
 NL                         Dummy  8036     I(4)            4           scalar   ARG,INOUT        8049,8054,8061,8083               
 NS                         Local  8084     I(4)            4           scalar   SAVE             8084,8088,8089,8090,8091,8093,8099
                                                                                                  ,8100,8101,8102                   
 NSX                        Local  8050     I(4)            4           scalar   SAVE             8050,8091,8202                    
 SORTRL                     Subr   8036                                                                                             

Page 220         Source Listing                  SORTRL
2017-04-18 11:09                                 syndata.f

   8206 
   8207 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8208 C                .      .    .                                       .
   8209 C SUBPROGRAM:    CIRCLE      CALCULATES LAT/LON OF PTS ON CIRCLE
   8210 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   8211 C
   8212 C ABSTRACT: CALCULATES LAT/LON OF POINTS EQUALLY SPACED IN AZIMUTH
   8213 C   ON A CIRCLE OF DESIGNATED RADIUS CENTERED AT A GIVEN LAT/LONG.
   8214 C
   8215 C PROGRAM HISTORY LOG:
   8216 C 1991-06-06  S. J. LORD
   8217 C
   8218 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8219 C   INPUT ARGUMENT LIST:
   8220 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8221 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8222 C
   8223 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8224 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8225 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8226 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8227 C
   8228 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8229 C     DDNAME1  - GENERIC NAME & CONTENT
   8230 C
   8231 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8232 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8233 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8234 C
   8235 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8236 C
   8237 C ATTRIBUTES:
   8238 C   LANGUAGE: FORTRAN 90
   8239 C   MACHINE:  NCEP WCOSS
   8240 C
   8241 C$$$
   8242 C     *****************************
   8243 C     ****  SUBROUTINE CIRCLE  ****
   8244 C     *****************************
   8245 C
   8246       SUBROUTINE CIRCLE(DTHETA,RADIUS,RLATCZ,RLONCZ,JPTSMX,JPT,RLATP,
   8247      1                  RLONP)
   8248 C
   8249       SAVE
   8250 
   8251       REAL(8)  SINDEG_8,COSDEG_8,DISTSP_8
   8252 C
   8253       DIMENSION RLATP(JPTSMX),RLONP(JPTSMX)
   8254 C
   8255 C     DEGLAT IS ONE DEGREE LATITUDE IN METERS
   8256 C
   8257       DATA DEGLAT/111.17E3/,EPSRAD/1.E3/,NITMAX/20/,THTAMX/360./
   8258 C
   8259       RADM  =RADIUS*1000.
   8260       RLATC =RLATCZ
   8261       RLONC =RLONCZ
   8262       WRITE(6,9) RLATC,RLONC,DTHETA,RADIUS

Page 221         Source Listing                  CIRCLE
2017-04-18 11:09                                 syndata.f

   8263     9 FORMAT(///' ...ENTERING CIRCLE WITH RLATC,RLONC,DTHETA,',
   8264      1       'RADIUS(KM)=',4F9.2)
   8265 C
   8266       JPT=0
   8267       THETA=0.0
   8268       DO 100 NPT=1,JPTSMX
   8269       NITER=1
   8270       RLATZ=RLATC
   8271       RLONZ=RLONC
   8272       RADLAT=RADM/DEGLAT
   8273       THETA=THETA+DTHETA
   8274 c && 2 comments
   8275 CC    WRITE(6,7) NPT,THETA,DTHETA
   8276 CC  7 FORMAT('...BEGINNING CIRCLE FOR NPT,THETA,DTHETA=',I5,2F10.2)
   8277 
   8278    10 DLAT=RADLAT*COSDEG_8(THETA)
   8279       DLON=RADLAT*SINDEG_8(THETA)*COSDEG_8(RLATC)
   8280       RLATZ=RLATZ+DLAT
   8281       RLONZ=RLONZ+DLON
   8282       RD=DISTSP_8(RLATC,RLONC,RLATZ,RLONZ)
   8283 c && 3 comments
   8284 CC    WRITE(6,17) NITER,RLATC,RLONC,RLATZ,RLONZ,RADM,RD,DLAT,DLON
   8285 CC 17 FORMAT('...NITER,RLATC,RLONC,RLATZ,RLONZ,RADM,RD,DLAT,DLON=',/,
   8286 CC   1       4X,I5,4F9.2,2F12.1,2F9.4)
   8287 C
   8288       IF(ABS(RD-RADM) .GT. EPSRAD)  THEN
   8289 C
   8290       IF(NITER .EQ. NITMAX) THEN
   8291       WRITE(6,21) NITMAX,THETA,RADIUS,RLATC,RLONC,RLATZ,RLONZ,DLAT,DLON
   8292    21 FORMAT(/'******ITERATION ERROR IN CIRCLE, NITMAX,THETA,RADIUS,',
   8293      1       'RLATC,RLONC,RLATZ,RLONZ,DLAT,DLON=',/,7X,I4,8F12.4)
   8294       CALL ABRT1(' CIRCLE',21)
   8295       ENDIF
   8296 C
   8297       NITER=NITER+1
   8298       RADLAT=(RADM-RD)/DEGLAT
   8299       GO TO 10
   8300       ENDIF
   8301 C
   8302       JPT=JPT+1
   8303       RLATP(JPT)=RLATZ
   8304       RLONP(JPT)=RLONZ
   8305       IF(THETA+DTHETA .GT. THTAMX) THEN
   8306       WRITE(6,93) JPT,THETA,DTHETA
   8307    93 FORMAT(/'...COMPLETED CIRCLE WITH JPT,THETA,DTHETA=',
   8308      1       I5,2F10.2)
   8309       RETURN
   8310       ENDIF
   8311 C
   8312   100 CONTINUE
   8313       WRITE(6,101) JPTSMX,THETA,DTHETA
   8314   101 FORMAT(/'******INSUFFICIENT SPACE TO COMPLETE CIRCLE, JPTSMX,',
   8315      1       'THETA,DTHETA=',I5,2F10.2)
   8316 C
   8317       RETURN
   8318       END

Page 222         Source Listing                  CIRCLE
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 circle_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  8278                                                           8299                              
 100                        Label  8312                                                           8268                              
 101                        Label  8314                                                           8313                              
 21                         Label  8292                                                           8291                              
 9                          Label  8263                                                           8262                              
 93                         Label  8307                                                           8306                              
 ABRT1                      Subr   8294                                                           8294                              
 ABS                        Func   8288                                 scalar                    8288                              
 CIRCLE                     Subr   8246                                                                                             
 COSDEG_8                   Func   8251     R(8)            8           scalar                    8278,8279                         
 DEGLAT                     Local  8257     R(4)            4           scalar   SAVE             8257,8272,8298                    
 DISTSP_8                   Func   8251     R(8)            8           scalar                    8282                              
 DLAT                       Local  8278     R(4)            4           scalar   SAVE             8278,8280,8291                    
 DLON                       Local  8279     R(4)            4           scalar   SAVE             8279,8281,8291                    
 DTHETA                     Dummy  8246     R(4)            4           scalar   ARG,INOUT        8262,8273,8305,8306,8313          
 EPSRAD                     Local  8257     R(4)            4           scalar   SAVE             8257,8288                         
 JPT                        Dummy  8246     I(4)            4           scalar   ARG,INOUT        8266,8302,8303,8304,8306          
 JPTSMX                     Dummy  8246     I(4)            4           scalar   ARG,INOUT        8253,8268,8313                    
 NITER                      Local  8269     I(4)            4           scalar   SAVE             8269,8290,8297                    
 NITMAX                     Local  8257     I(4)            4           scalar   SAVE             8257,8290,8291                    
 NPT                        Local  8268     I(4)            4           scalar   SAVE             8268                              
 RADIUS                     Dummy  8246     R(4)            4           scalar   ARG,INOUT        8259,8262,8291                    
 RADLAT                     Local  8272     R(4)            4           scalar   SAVE             8272,8278,8279,8298               
 RADM                       Local  8259     R(4)            4           scalar   SAVE             8259,8272,8288,8298               
 RD                         Local  8282     R(4)            4           scalar   SAVE             8282,8288,8298                    
 RLATC                      Local  8260     R(4)            4           scalar   SAVE             8260,8262,8270,8279,8282,8291     
 RLATCZ                     Dummy  8246     R(4)            4           scalar   ARG,INOUT        8260                              
 RLATP                      Dummy  8246     R(4)            4     1     0        ARG,INOUT        8303                              
 RLATZ                      Local  8270     R(4)            4           scalar   SAVE             8270,8280,8282,8291,8303          
 RLONC                      Local  8261     R(4)            4           scalar   SAVE             8261,8262,8271,8282,8291          
 RLONCZ                     Dummy  8246     R(4)            4           scalar   ARG,INOUT        8261                              
 RLONP                      Dummy  8247     R(4)            4     1     0        ARG,INOUT        8304                              
 RLONZ                      Local  8271     R(4)            4           scalar   SAVE             8271,8281,8282,8291,8304          
 SINDEG_8                   Func   8251     R(8)            8           scalar                    8279                              
 THETA                      Local  8267     R(4)            4           scalar   SAVE             8267,8273,8278,8279,8291,8305,8306
                                                                                                  ,8313                             
 THTAMX                     Local  8257     R(4)            4           scalar   SAVE             8257,8305                         

Page 223         Source Listing                  CIRCLE
2017-04-18 11:09                                 syndata.f

   8319 
   8320 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8321 C                .      .    .                                       .
   8322 C SUBPROGRAM:    RFAC        MULTIPLICATIVE FACTOR FOR STORM RADIUS
   8323 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-07
   8324 C
   8325 C ABSTRACT: CALCULATES A MULTIPLICATIVE FACTOR BY WHICH THE BOGUSING
   8326 C   AREA EXCEEDS THE STORM RADIUS.
   8327 C
   8328 C PROGRAM HISTORY LOG:
   8329 C 1991-06-07  S. J. LORD
   8330 C
   8331 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8332 C   INPUT ARGUMENT LIST:
   8333 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8334 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8335 C
   8336 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8337 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8338 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8339 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8340 C
   8341 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8342 C     DDNAME1  - GENERIC NAME & CONTENT
   8343 C
   8344 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8345 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8346 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8347 C
   8348 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8349 C
   8350 C ATTRIBUTES:
   8351 C   LANGUAGE: FORTRAN 90
   8352 C   MACHINE:  NCEP WCOSS
   8353 C
   8354 C$$$
   8355 C     *****************************
   8356 C     ****  FUNCTION RFAC      ****
   8357 C     *****************************
   8358 C
   8359       FUNCTION RFAC(IFSTZZ,RADIUS)
   8360 C
   8361       DIMENSION RFAC1(2),RFAC2(2)
   8362 C
   8363       SAVE
   8364 
   8365       DATA RFAC1/4.0,1.5/,RFAC2/1.1,1.05/,RADMIN/150./,RADMAX/750./
   8366       DATA RFMIN/0/,RFMAX/0/
   8367 C
   8368       IFSTZ=MIN(IFSTZZ,2)
   8369 C
   8370       IF(IFSTZ .NE. 0)  THEN
   8371       RFMIN=RFAC1(IFSTZ)*RADMIN
   8372       RFMAX=RFAC2(IFSTZ)*RADMAX
   8373       RFAC1S=RFAC1(IFSTZ)
   8374       RFAC2S=RFAC2(IFSTZ)
   8375       ENDIF

Page 224         Source Listing                  RFAC
2017-04-18 11:09                                 syndata.f

   8376 C
   8377       IF(RADIUS .LE. RADMIN)  THEN
   8378       RFAC=RFAC1S*RADIUS
   8379       ELSE IF(RADIUS .GE. RADMAX)  THEN
   8380       RFAC=RFAC2S*RADIUS
   8381       ELSE
   8382       RFAC=RFMIN+(RFMAX-RFMIN)*(RADIUS-RADMIN)/(RADMAX-RADMIN)
   8383       ENDIF
   8384       RETURN
   8385       END


ENTRY POINTS

  Name             
                   
 rfac_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IFSTZ                      Local  8368     I(4)            4           scalar   SAVE             8368,8370,8371,8372,8373,8374     
 IFSTZZ                     Dummy  8359     I(4)            4           scalar   ARG,INOUT        8368                              
 MIN                        Func   8368                                 scalar                    8368                              
 RADIUS                     Dummy  8359     R(4)            4           scalar   ARG,INOUT        8377,8378,8379,8380,8382          
 RADMAX                     Local  8365     R(4)            4           scalar   SAVE             8365,8372,8379,8382               
 RADMIN                     Local  8365     R(4)            4           scalar   SAVE             8365,8371,8377,8382               
 RFAC                       Func   8359     R(4)            4           scalar                    8378,8380,8382                    
 RFAC1                      Local  8361     R(4)            4     1     2        SAVE             8365,8371,8373                    
 RFAC1S                     Local  8373     R(4)            4           scalar   SAVE             8373,8378                         
 RFAC2                      Local  8361     R(4)            4     1     2        SAVE             8365,8372,8374                    
 RFAC2S                     Local  8374     R(4)            4           scalar   SAVE             8374,8380                         
 RFAC@0                     Local  8359     R(4)            4           scalar   SAVE                                               
 RFMAX                      Local  8366     R(4)            4           scalar   SAVE             8366,8372,8382                    
 RFMIN                      Local  8366     R(4)            4           scalar   SAVE             8366,8371,8382                    

Page 225         Source Listing                  RFAC
2017-04-18 11:09                                 syndata.f

   8386 
   8387 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8388 C                .      .    .                                       .
   8389 C SUBPROGRAM:    ZNEAR       Z NEAREST GRID POINT TO A GIVEN LAT/LON
   8390 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-07
   8391 C
   8392 C ABSTRACT: CALCULATES THE NEAREST LAT OR LON LOCATION TO AN EQUALLY
   8393 C   SPACED GRID OF LAT/LON POINT.
   8394 C
   8395 C PROGRAM HISTORY LOG:
   8396 C 1991-06-07  S. J. LORD
   8397 C
   8398 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8399 C   INPUT ARGUMENT LIST:
   8400 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8401 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8402 C
   8403 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8404 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8405 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8406 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8407 C
   8408 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8409 C     DDNAME1  - GENERIC NAME & CONTENT
   8410 C
   8411 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8412 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8413 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8414 C
   8415 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8416 C
   8417 C ATTRIBUTES:
   8418 C   LANGUAGE: FORTRAN 90
   8419 C   MACHINE:  NCEP WCOSS
   8420 C
   8421 C$$$
   8422 C     *****************************
   8423 C     ****  FUNCTION ZNEAR     ****
   8424 C     *****************************
   8425 C
   8426       FUNCTION ZNEAR(ZIN,DELTA)
   8427 C
   8428       INEAR=NINT(ZIN/DELTA)
   8429       ZNEAR=DELTA*REAL(INEAR)
   8430       RETURN
   8431       END

Page 226         Source Listing                  ZNEAR
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 znear_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DELTA                      Dummy  8426     R(4)            4           scalar   ARG,INOUT        8428,8429                         
 INEAR                      Local  8428     I(4)            4           scalar                    8428,8429                         
 NINT                       Func   8428                                 scalar                    8428                              
 REAL                       Func   8429                                 scalar                    8429                              
 ZIN                        Dummy  8426     R(4)            4           scalar   ARG,INOUT        8428                              
 ZNEAR                      Func   8426     R(4)            4           scalar                    8429                              
 ZNEAR@0                    Local  8426     R(4)            4           scalar                                                      

Page 227         Source Listing                  ZNEAR
2017-04-18 11:09                                 syndata.f

   8432 
   8433 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8434 C                .      .    .                                       .
   8435 C SUBPROGRAM:    CHGRES      CHANGES RESOLUTION OF SPECTRAL COEFFS
   8436 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   8437 C
   8438 C ABSTRACT: STANDARD NCEP GLOBAL SPECTRAL MODEL CHANGE RESOLUTION
   8439 C   CODE.
   8440 C
   8441 C PROGRAM HISTORY LOG:
   8442 C 1991-06-06  S. J. LORD - COPIED FROM KANAMITSU LIBRARY
   8443 C
   8444 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8445 C   INPUT ARGUMENT LIST:
   8446 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8447 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8448 C
   8449 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8450 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8451 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8452 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8453 C
   8454 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8455 C     DDNAME1  - GENERIC NAME & CONTENT
   8456 C
   8457 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8458 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8459 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8460 C
   8461 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8462 C
   8463 C ATTRIBUTES:
   8464 C   LANGUAGE: FORTRAN 90
   8465 C   MACHINE:  NCEP WCOSS
   8466 C
   8467 C$$$
   8468       SUBROUTINE CHGRES(MAXWV,IROMB,WAVE,MAXWVO,IROMBO,WAVEC)
   8469 C
   8470 cc dak 7/3/05      DIMENSION WAVE(1),WAVEC(1)
   8471       dimension wave(*),wavec(*) ! dak 7/3/05: fix bounds-check error
   8472 C
   8473       MDIM=(MAXWV+1)*(MAXWV+1)*2
   8474       IF(IROMB.NE.1) MDIM=(MAXWV+1)*(MAXWV+2)
   8475 C
   8476       NCEP=0
   8477       DO M=1,MAXWVO+1
   8478          NEND=M+MAXWVO
   8479          IF(IROMBO.NE.1) NEND=MAXWVO+1
   8480          DO N=M,NEND
   8481             NCEP=NCEP+1
   8482             NM=(MAXWV+1)*(M-1)+N-M+1
   8483             IF(IROMB.NE.1) NM=M*(MAXWV+1)-(MAXWV+1-N)-(M-1)*M/2
   8484             DO II=1,2
   8485                X=0.
   8486                IF(NM*2-2+II.LE.MDIM) X=WAVE(NM*2-2+II)
   8487                IF(M.GT.MAXWV+1) X=0.
   8488                IF(IROMB.EQ.1) THEN

Page 228         Source Listing                  CHGRES
2017-04-18 11:09                                 syndata.f

   8489                   IF(N.GT.M+MAXWV) X=0.
   8490                ENDIF
   8491                IF(IROMB.EQ.0) THEN
   8492                   IF(N.GT.MAXWV+1) X=0.
   8493                ENDIF
   8494                WAVEC(NCEP*2-2+II)=X
   8495             ENDDO
   8496          ENDDO
   8497       ENDDO
   8498 C
   8499       RETURN
   8500       END


ENTRY POINTS

  Name               
                     
 chgres_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHGRES                     Subr   8468                                                                                             
 II                         Local  8484     I(4)            4           scalar                    8484,8486,8494                    
 IROMB                      Dummy  8468     I(4)            4           scalar   ARG,INOUT        8474,8483,8488,8491               
 IROMBO                     Dummy  8468     I(4)            4           scalar   ARG,INOUT        8479                              
 M                          Local  8477     I(4)            4           scalar                    8477,8478,8480,8482,8483,8487,8489
 MAXWV                      Dummy  8468     I(4)            4           scalar   ARG,INOUT        8473,8474,8482,8483,8487,8489,8492
 MAXWVO                     Dummy  8468     I(4)            4           scalar   ARG,INOUT        8477,8478,8479                    
 MDIM                       Local  8473     I(4)            4           scalar                    8473,8474,8486                    
 N                          Local  8480     I(4)            4           scalar                    8480,8482,8483,8489,8492          
 NCEP                       Local  8476     I(4)            4           scalar                    8476,8481,8494                    
 NEND                       Local  8478     I(4)            4           scalar                    8478,8479,8480                    
 NM                         Local  8482     I(4)            4           scalar                    8482,8483,8486                    
 WAVE                       Dummy  8468     R(4)            4     1     0        ARG,INOUT        8486                              
 WAVEC                      Dummy  8468     R(4)            4     1     0        ARG,INOUT        8494                              
 X                          Local  8485     R(4)            4           scalar                    8485,8486,8487,8489,8492,8494     

Page 229         Source Listing                  CHGRES
2017-04-18 11:09                                 syndata.f

   8501 
   8502 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8503 C                .      .    .                                       .
   8504 C SUBPROGRAM:    UVTOZD      CONVERTS COEFFS OF WIND TO VORT/DIV
   8505 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   8506 C
   8507 C ABSTRACT: STANDARD NCEP SPECTRAL MODEL CODE TO CONVERT COEFFS OF
   8508 C   WIND (U,V) TO COEFFS OF VORTICITY AND DIVERGENCE.
   8509 C
   8510 C PROGRAM HISTORY LOG:
   8511 C 1991-06-06  S. J. LORD - COPIED FROM KANAMITSU LIBRARY
   8512 C
   8513 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8514 C   INPUT ARGUMENT LIST:
   8515 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8516 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8517 C
   8518 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8519 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8520 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8521 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8522 C
   8523 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8524 C     DDNAME1  - GENERIC NAME & CONTENT
   8525 C
   8526 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8527 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8528 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8529 C
   8530 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8531 C
   8532 C ATTRIBUTES:
   8533 C   LANGUAGE: FORTRAN 90
   8534 C   MACHINE:  NCEP WCOSS
   8535 C
   8536 C$$$
   8537       SUBROUTINE UVTOZD(U,V,Z,D,MEND1,IROMB,ER,MWVD2,MUWVD2)
   8538 C
   8539 C  THIS ROUTINE PERFORMS CONVERSION OF PSEUDO-SCALAR U, V TO
   8540 C  TRUE SCALAR VORTICITY (Z) AND DIVERGENCE (D) IN SPECTRAL
   8541 C  SPACE.
   8542 C
   8543 C  CALL UVTOZD(U,V,Z,D,MEND1,IROMB,ER,MWVD2,MUWVD2)
   8544 C
   8545 C  CALLING ARGUEMENTS:
   8546 C
   8547 C  U      ..... PSEUDO SCALAR ZONAL WIND (= UCOS(PHI))
   8548 C  V      .....   ..    ..    MERID WIND (= VCOS(PHI))
   8549 C  Z      ..... OUTPUT OF RELATIVE VORTICITY
   8550 C  D      .....   ..   .. DIVERGENCE
   8551 C  MEND1  ..... ZONAL WAVENUMBER + 1 FOR ZETA AND DIV
   8552 C  ER     ..... RADIUS OF EARTH
   8553 C  MWVD2  ..... DIMENSION OF Z AND D
   8554 C  MUWVD2 ..... DIMENSION OF U AND V
   8555 C
   8556 C  HUA-LU PAN   17 JANUARY 1989
   8557 C

Page 230         Source Listing                  UVTOZD
2017-04-18 11:09                                 syndata.f

   8558       DIMENSION U(MUWVD2), V(MUWVD2), Z(MWVD2), D(MWVD2)
   8559       COMPLEX AI, B(2,1000)
   8560       REAL SUB(2,1000), DIAG(2,1000), SUP(2,1000)
   8561       EPS(N,M) = SQRT(REAL(N*N-M*M)/REAL(4*N*N-1))
   8562       AI = CMPLX(0.,1.)
   8563 C
   8564 C HANDLE M = 0 SEPERATELY
   8565 C
   8566       NM = 0
   8567       NMU = 0
   8568       MM = 1
   8569       M = 0
   8570       NEND1 = MEND1
   8571       IF(IROMB.EQ.1) NEND1 = MM + MEND1 - 1
   8572       D2 = 0.
   8573       DO 100 NN = MM, NEND1
   8574       NM = NM + 1
   8575       NMU = NMU + 1
   8576       NMT2 = NM * 2
   8577       NMUT2 = NMU * 2
   8578       N = NN - 1
   8579       D1 = D2
   8580       IF(N.GT.0) THEN
   8581       D2 = EPS(N,M)
   8582       FAC1 = N / (ER * D2)
   8583       ENDIF
   8584       IF(N.GT.1) FAC2 = (N * D1) / ((N-1) * D2)
   8585       IF(N.EQ.0) THEN
   8586       Z(NMT2-1) = 0.
   8587       Z(NMT2)   = 0.
   8588       D(NMT2-1) = 0.
   8589       D(NMT2)   = 0.
   8590       ELSEIF(N.EQ.1) THEN
   8591       Z(NMT2-1) =  U(NMUT2-3) * FAC1
   8592       Z(NMT2)   =  U(NMUT2-2) * FAC1
   8593       D(NMT2-1) = -V(NMUT2-3) * FAC1
   8594       D(NMT2)   = -V(NMUT2-2) * FAC1
   8595       ELSEIF(N.GT.1) THEN
   8596       Z(NMT2-1) =  U(NMUT2-3) * FAC1 + Z(NMT2-5) * FAC2
   8597       Z(NMT2)   =  U(NMUT2-2) * FAC1 + Z(NMT2-4) * FAC2
   8598       D(NMT2-1) = -V(NMUT2-3) * FAC1 + D(NMT2-5) * FAC2
   8599       D(NMT2)   = -V(NMUT2-2) * FAC1 + D(NMT2-4) * FAC2
   8600       ENDIF
   8601  100  CONTINUE
   8602 C
   8603 C  INCREMENT NMU BY ONE BECAUSE U, V HAVE AN EXTRA WAVENUMBER COMP.
   8604 C
   8605       NMU = NMU + 1
   8606 C
   8607 C  SOLVE LINKED TRIDIAGONAL MATRICES FOR M GT 1
   8608 C  NOTE THAT THE INDEXING IS NOW BASED ON U AND V INSTEAD OF
   8609 C  Z AND D AS IN THE PREVIOUS LOOP
   8610 C
   8611       DO 300 MM = 2, MEND1
   8612       M = MM - 1
   8613       NEND1 = MEND1
   8614       IF(IROMB.EQ.1) NEND1 = MM + MEND1 - 1

Page 231         Source Listing                  UVTOZD
2017-04-18 11:09                                 syndata.f

   8615       NDIM = NEND1 - MM + 1
   8616       D2 = 0.
   8617       NR = 0
   8618       NMOLD = NM
   8619       NMUOLD = NMU
   8620       DO 200 NN = MM, NEND1
   8621       NR = NR + 1
   8622       N = NN - 1
   8623       NM = NM + 1
   8624       NMU = NMU + 1
   8625       NMT2 = NM * 2
   8626       NMUT2 = NMU * 2
   8627       D1 = D2
   8628       D2 = EPS(N+1,M)
   8629       IF(N.EQ.M) THEN
   8630         SUB(1,NR) = 0.
   8631         SUB(2,NR) = 0.
   8632       ELSE
   8633         SUB(1,NR) = -D1 / N
   8634         SUB(2,NR) = -SUB(1,NR)
   8635       ENDIF
   8636       B(1,NR) = CMPLX(U(NMUT2-1),U(NMUT2)) / ER
   8637       B(2,NR) = CMPLX(V(NMUT2-1),V(NMUT2)) / ER
   8638       DIAG(1,NR) = -REAL(M) / REAL(N * (N+1))
   8639       DIAG(2,NR) = DIAG(1,NR)
   8640       IF(NN.EQ.NEND1) THEN
   8641         SUP(1,NR) = 0.
   8642         SUP(2,NR) = 0.
   8643       ELSE
   8644         SUP(1,NR) = D2 / (N+1)
   8645         SUP(2,NR) = -SUP(1,NR)
   8646       ENDIF
   8647  200  CONTINUE
   8648       IF(NDIM.GT.1) THEN
   8649         DO 210 I = 2, NDIM
   8650         SUB(1,I) = SUB(1,I) / DIAG(2,I-1)
   8651         SUB(2,I) = SUB(2,I) / DIAG(1,I-1)
   8652         DIAG(1,I) = DIAG(1,I) + SUB(1,I) * SUP(2,I-1)
   8653         DIAG(2,I) = DIAG(2,I) + SUB(2,I) * SUP(1,I-1)
   8654         B(1,I) = B(1,I) + AI * SUB(1,I) * B(2,I-1)
   8655         B(2,I) = B(2,I) + AI * SUB(2,I) * B(1,I-1)
   8656  210    CONTINUE
   8657       ENDIF
   8658       B(1,NDIM) = -AI * B(1,NDIM) / DIAG(1,NDIM)
   8659       B(2,NDIM) = -AI * B(2,NDIM) / DIAG(2,NDIM)
   8660       IF(NDIM.GT.1) THEN
   8661         DO 220 I = NDIM-1, 1, -1
   8662         B(1,I) = -AI * (B(1,I) - SUP(1,I) * B(2,I+1)) / DIAG(1,I)
   8663         B(2,I) = -AI * (B(2,I) - SUP(2,I) * B(1,I+1)) / DIAG(2,I)
   8664  220    CONTINUE
   8665       ENDIF
   8666       NM = NMOLD
   8667       NMU = NMUOLD
   8668       NR = 0
   8669       DO 230 NN = MM, NEND1
   8670       N = NN - 1
   8671       NM = NM + 1

Page 232         Source Listing                  UVTOZD
2017-04-18 11:09                                 syndata.f

   8672       NMU = NMU + 1
   8673       NR = NR + 1
   8674       NMT2 = NM * 2
   8675       NMUT2 = NMU * 2
   8676       Z(NMT2-1) =  REAL(B(2,NR))
   8677       Z(NMT2)   = AIMAG(B(2,NR))
   8678       D(NMT2-1) =  REAL(B(1,NR))
   8679       D(NMT2)   = AIMAG(B(1,NR))
   8680  230  CONTINUE
   8681       NMU = NMU + 1
   8682  300  CONTINUE
   8683 C
   8684 C  MAKING SURE THAT THE IMAGINARY PART OF THE ZONAL (M=0) COMPONENT
   8685 C  IS ZERO AS WELL AS THE REAL PART OF N=M=0 IS ZERO
   8686 C
   8687       Z(1) = 0.
   8688       D(1) = 0.
   8689       DO 400 N = 1, MEND1
   8690       N2 = N * 2
   8691       Z(N2) = 0.
   8692       D(N2) = 0.
   8693  400  CONTINUE
   8694       RETURN
   8695       END


ENTRY POINTS

  Name               
                     
 uvtozd_             

Page 233         Source Listing                  UVTOZD
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  8601                                                           8573                              
 200                        Label  8647                                                           8620                              
 210                        Label  8656                                                           8649                              
 220                        Label  8664                                                           8661                              
 230                        Label  8680                                                           8669                              
 300                        Label  8682                                                           8611                              
 400                        Label  8693                                                           8689                              
 AI                         Local  8559     C(8)            8           scalar                    8562,8654,8655,8658,8659,8662,8663
 AIMAG                      Func   8677                                 scalar                    8677,8679                         
 B                          Local  8559     C(8)            8     2     2000                      8636,8637,8654,8655,8658,8659,8662
                                                                                                  ,8663,8676,8677,8678,8679         
 CMPLX                      Func   8562                                 scalar                    8562,8636,8637                    
 D                          Dummy  8537     R(4)            4     1     0        ARG,INOUT        8588,8589,8593,8594,8598,8599,8678
                                                                                                  ,8679,8688,8692                   
 D1                         Local  8579     R(4)            4           scalar                    8579,8584,8627,8633               
 D2                         Local  8572     R(4)            4           scalar                    8572,8579,8581,8582,8584,8616,8627
                                                                                                  ,8628,8644                        
 DIAG                       Local  8560     R(4)            4     2     2000                      8638,8639,8650,8651,8652,8653,8658
                                                                                                  ,8659,8662,8663                   
 EPS                        Local  8561     R(4)            4           scalar                    8581,8628                         
 ER                         Dummy  8537     R(4)            4           scalar   ARG,INOUT        8582,8636,8637                    
 FAC1                       Local  8582     R(4)            4           scalar                    8582,8591,8592,8593,8594,8596,8597
                                                                                                  ,8598,8599                        
 FAC2                       Local  8584     R(4)            4           scalar                    8584,8596,8597,8598,8599          
 I                          Local  8649     I(4)            4           scalar                    8649,8650,8651,8652,8653,8654,8655
                                                                                                  ,8661,8662,8663                   
 IROMB                      Dummy  8537     I(4)            4           scalar   ARG,INOUT        8571,8614                         
 M                          Local  8569     I(4)            4           scalar                    8569,8581,8612,8628,8629,8638     
 MEND1                      Dummy  8537     I(4)            4           scalar   ARG,INOUT        8570,8571,8611,8613,8614,8689     
 MM                         Local  8568     I(4)            4           scalar                    8568,8571,8573,8611,8612,8614,8615
                                                                                                  ,8620,8669                        
 MUWVD2                     Dummy  8537     I(4)            4           scalar   ARG,INOUT        8558                              
 MWVD2                      Dummy  8537     I(4)            4           scalar   ARG,INOUT        8558                              
 N                          Local  8578     I(4)            4           scalar                    8578,8580,8581,8582,8584,8585,8590
                                                                                                  ,8595,8622,8628,8629,8633,8638,864
                                                                                                  4,8670,8689,8690                  
 N2                         Local  8690     I(4)            4           scalar                    8690,8691,8692                    
 NDIM                       Local  8615     I(4)            4           scalar                    8615,8648,8649,8658,8659,8660,8661
 NEND1                      Local  8570     I(4)            4           scalar                    8570,8571,8573,8613,8614,8615,8620
                                                                                                  ,8640,8669                        
 NM                         Local  8566     I(4)            4           scalar                    8566,8574,8576,8618,8623,8625,8666
                                                                                                  ,8671,8674                        
 NMOLD                      Local  8618     I(4)            4           scalar                    8618,8666                         
 NMT2                       Local  8576     I(4)            4           scalar                    8576,8586,8587,8588,8589,8591,8592
                                                                                                  ,8593,8594,8596,8597,8598,8599,862
                                                                                                  5,8674,8676,8677,8678,8679        
 NMU                        Local  8567     I(4)            4           scalar                    8567,8575,8577,8605,8619,8624,8626
                                                                                                  ,8667,8672,8675,8681              
 NMUOLD                     Local  8619     I(4)            4           scalar                    8619,8667                         
 NMUT2                      Local  8577     I(4)            4           scalar                    8577,8591,8592,8593,8594,8596,8597
                                                                                                  ,8598,8599,8626,8636,8637,8675    

Page 234         Source Listing                  UVTOZD
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NN                         Local  8573     I(4)            4           scalar                    8573,8578,8620,8622,8640,8669,8670
 NR                         Local  8617     I(4)            4           scalar                    8617,8621,8630,8631,8633,8634,8636
                                                                                                  ,8637,8638,8639,8641,8642,8644,864
                                                                                                  5,8668,8673,8676,8677,8678,8679   
 REAL                       Func   8561                                 scalar                    8561,8638,8676,8678               
 SQRT                       Func   8561                                 scalar                    8561                              
 SUB                        Local  8560     R(4)            4     2     2000                      8630,8631,8633,8634,8650,8651,8652
                                                                                                  ,8653,8654,8655                   
 SUP                        Local  8560     R(4)            4     2     2000                      8641,8642,8644,8645,8652,8653,8662
                                                                                                  ,8663                             
 U                          Dummy  8537     R(4)            4     1     0        ARG,INOUT        8591,8592,8596,8597,8636          
 UVTOZD                     Subr   8537                                                                                             
 V                          Dummy  8537     R(4)            4     1     0        ARG,INOUT        8593,8594,8598,8599,8637          
 Z                          Dummy  8537     R(4)            4     1     0        ARG,INOUT        8586,8587,8591,8592,8596,8597,8676
                                                                                                  ,8677,8687,8691                   

Page 235         Source Listing                  UVTOZD
2017-04-18 11:09                                 syndata.f

   8696 
   8697 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8698 C                .      .    .                                       .
   8699 C SUBPROGRAM:    RDSUBS      READ TITLE OF SPLINE ANALYSIS RUN
   8700 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   8701 C
   8702 C ABSTRACT: READS INPUT CARDS THAT DESCRIBE ANALYSIS RUN OF THE
   8703 C   SPLINE ANALYSIS.
   8704 C
   8705 C PROGRAM HISTORY LOG:
   8706 C 1991-06-06  S. J. LORD
   8707 C
   8708 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8709 C   INPUT ARGUMENT LIST:
   8710 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8711 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8712 C
   8713 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8714 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8715 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8716 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8717 C
   8718 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8719 C     DDNAME1  - GENERIC NAME & CONTENT
   8720 C
   8721 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8722 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8723 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8724 C
   8725 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8726 C
   8727 C ATTRIBUTES:
   8728 C   LANGUAGE: FORTRAN 90
   8729 C   MACHINE:  NCEP WCOSS
   8730 C
   8731 C$$$
   8732       SUBROUTINE RDSUBS(ISUB)
   8733       PARAMETER(ISUBMX=2)
   8734 C
   8735 C          ENTRY DATITL   (SET TIME AND DATE WITHOUT READING A CARD)
   8736 C                         (NOT NEEDED IF RDTITL WAS CALLED EARLIER)
   8737 C          ENTRY PRTITL
   8738 C
   8739       COMMON /TITLE/ JOBID(ISUBMX),JOBH,TODAY,ZTIME
   8740       CHARACTER*48  JOBID*120,TODAY*11,ZTIME*8
   8741 C
   8742       SAVE
   8743 C
   8744 C-----------------------------------------------------------------------
   8745 
   8746       ENTRY RDTITL(ISUB)
   8747 C
   8748 C     INITIALIZE JOBID FOR IBM
   8749 C
   8750       JOBID(ISUB)=' '
   8751       ISUBSV=ISUB
   8752 C

Page 236         Source Listing                  RDSUBS
2017-04-18 11:09                                 syndata.f

   8753 C     READ JOBID
   8754 C
   8755       READ 5,JOBID(ISUB)
   8756     5 FORMAT(A80)
   8757 C
   8758 C
   8759 C     GET THE CURRENT TIME AND DATE
   8760 C
   8761       CALL SPTIME(ZTIME)
   8762       CALL SPDATE(TODAY)
   8763       RETURN
   8764 
   8765 C-----------------------------------------------------------------------
   8766 
   8767       ENTRY PRTITL(ISUB)
   8768 C
   8769 C     WRITE THE JOBID, CURRENT TIME AND CURRENT DATE
   8770 C
   8771       WRITE(6,123) JOBID(ISUB),ZTIME,TODAY
   8772   123 FORMAT(//5X,A120,//,20X,'*TIME=',A8,10X,'*DATE=',A11)
   8773       ISUBSV=ISUB
   8774       RETURN
   8775 C
   8776 
   8777 C-----------------------------------------------------------------------
   8778 
   8779       ENTRY PREND
   8780 C
   8781 C     WRITE THE JOBID, END TIME AND DATE
   8782 C
   8783       CALL SPTIME(ZTIME)
   8784       CALL SPDATE(TODAY)
   8785       WRITE(6,*)  '            ***  NORMAL TERMINATION OF JOB  ***'
   8786       WRITE(6,123) JOBID(ISUBSV),ZTIME,TODAY
   8787       RETURN
   8788 C
   8789       END

Page 237         Source Listing                  RDSUBS
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 prend_                prtitl_               rdsubs_               rdtitl_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 123                        Label  8772                                                           8771,8786                         
 5                          Label  8756                                                           8755                              
 ISUB                       Dummy  8732     I(4)            4           scalar   ARG,INOUT        8750,8751,8755,8771,8773          
 ISUBMX                     Param  8733     I(4)            4           scalar                    8739                              
 ISUBSV                     Local  8751     I(4)            4           scalar   SAVE             8751,8773,8786                    
 JOBH                       Scalar 8739     I(4)            4           scalar   COM                                                
 JOBID                      Scalar 8739     CHAR            120   1     2        COM              8750,8755,8771,8786               
 PREND                      Subr   8779                                                                                             
 PRTITL                     Subr   8767                                                                                             
 RDSUBS                     Subr   8732                                                                                             
 RDTITL                     Subr   8746                                                                                             
 SPDATE                     Subr   8762                                                           8762,8784                         
 SPTIME                     Subr   8761                                                           8761,8783                         
 TITLE                      Common 8739                                 263      SAVE                                               
 TODAY                      Scalar 8739     CHAR            11          scalar   COM              8762,8771,8784,8786               
 ZTIME                      Scalar 8739     CHAR            8           scalar   COM              8761,8771,8783,8786               

Page 238         Source Listing                  RDSUBS
2017-04-18 11:09                                 syndata.f

   8790 
   8791 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8792 C                .      .    .                                       .
   8793 C SUBPROGRAM:    STISUB      TIME SUBROUTINES FOR SPLINE ANALYSIS
   8794 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 1998-07-24
   8795 C
   8796 C ABSTRACT: TIME AND DATE SUBROUTINES FOR THE SPLINE ANALYSIS.
   8797 C
   8798 C PROGRAM HISTORY LOG:
   8799 C 1991-06-06  S. J. LORD
   8800 C 1998-07-24  D. A. KEYSER - Y2K/F90 COMPLIANCE
   8801 C
   8802 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8803 C   INPUT ARGUMENT LIST:
   8804 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8805 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8806 C
   8807 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8808 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8809 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8810 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8811 C
   8812 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8813 C     DDNAME1  - GENERIC NAME & CONTENT
   8814 C
   8815 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8816 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8817 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8818 C
   8819 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8820 C
   8821 C ATTRIBUTES:
   8822 C   LANGUAGE: FORTRAN 90
   8823 C   MACHINE:  NCEP WCOSS
   8824 C
   8825 C$$$
   8826       SUBROUTINE STISUB(ZZDATE,ZZTIME)
   8827 C
   8828       DIMENSION IDT(8)
   8829       CHARACTER ZZDATE*11,ZZTIME*8
   8830 
   8831 C-----------------------------------------------------------------------
   8832 
   8833       ENTRY SPDATE(ZZDATE)
   8834       ZZDATE='    :  :   '
   8835       CALL W3LOCDAT(IDT)
   8836       WRITE(ZZDATE(1: 4),'(I4.4)') IDT(1)
   8837       WRITE(ZZDATE(6: 7),'(I2.2)') IDT(2)
   8838       WRITE(ZZDATE(9:10),'(I2.2)') IDT(3)
   8839       RETURN
   8840 
   8841 C-----------------------------------------------------------------------
   8842 
   8843       ENTRY SPTIME(ZZTIME)
   8844       ZZTIME='  :  :  '
   8845       CALL W3LOCDAT(IDT)
   8846       IHR=IDT(5)

Page 239         Source Listing                  STISUB
2017-04-18 11:09                                 syndata.f

   8847       IMIN=IDT(6)
   8848       ISEC=IDT(7)
   8849       WRITE(ZZTIME(1:2),'(I2.2)') IHR
   8850       WRITE(ZZTIME(4:5),'(I2.2)') IMIN
   8851       WRITE(ZZTIME(7:8),'(I2.2)') ISEC
   8852       RETURN
   8853 
   8854 C-----------------------------------------------------------------------
   8855 
   8856       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 spdate_               sptime_               stisub_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDT                        Local  8828     I(4)            4     1     8                         8835,8836,8837,8838,8845,8846,8847
                                                                                                  ,8848                             
 IHR                        Local  8846     I(4)            4           scalar                    8846,8849                         
 IMIN                       Local  8847     I(4)            4           scalar                    8847,8850                         
 ISEC                       Local  8848     I(4)            4           scalar                    8848,8851                         
 SPDATE                     Subr   8833                                                                                             
 SPTIME                     Subr   8843                                                                                             
 STISUB                     Subr   8826                                                                                             
 W3LOCDAT                   Subr   8835                                                           8835,8845                         
 ZZDATE                     Dummy  8826     CHAR            11          scalar   ARG,INOUT        8834,8836,8837,8838               
 ZZTIME                     Dummy  8826     CHAR            8           scalar   ARG,INOUT        8844,8849,8850,8851               

Page 240         Source Listing                  STISUB
2017-04-18 11:09                                 syndata.f

   8857 
   8858 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8859 C                .      .    .                                       .
   8860 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   8861 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   8862 C
   8863 C ABSTRACT: ??????????????????????????????????????????????????????????
   8864 C   ??????????????????????????????????????????????????????????????????
   8865 C
   8866 C PROGRAM HISTORY LOG:
   8867 C ????-??-??  S. J. LORD
   8868 C
   8869 C USAGE:    CALL ????????(????)
   8870 C   INPUT ARGUMENT LIST:
   8871 C     ??????   - ???????????????????????????????????????????????
   8872 C
   8873 C   OUTPUT ARGUMENT LIST:
   8874 C     ??????   - ???????????????????????????????????????????????
   8875 C
   8876 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8877 C     ??????   - ???????????????????????????????????????????????
   8878 C
   8879 C   OUTPUT FILES:
   8880 C     ??????   - ???????????????????????????????????????????????
   8881 C
   8882 C REMARKS: ?????????????????????????????????????????????????????
   8883 C
   8884 C ATTRIBUTES:
   8885 C   LANGUAGE: FORTRAN 90
   8886 C   MACHINE:  NCEP WCOSS
   8887 C
   8888 C$$$
   8889       FUNCTION ISECND(INSEC)
   8890 
   8891       DIMENSION IDT(8)
   8892       CALL W3LOCDAT(IDT)
   8893       IDT8 = (IDT(5) * 3600) + (IDT(6) * 60) + IDT(7)
   8894       IF(INSEC.LE.0)  THEN
   8895         ISECND=IDT8
   8896       ELSE
   8897         ISECND=IDT8-INSEC
   8898       ENDIF
   8899       RETURN
   8900       END

Page 241         Source Listing                  ISECND
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 isecnd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDT                        Local  8891     I(4)            4     1     8                         8892,8893                         
 IDT8                       Local  8893     I(4)            4           scalar                    8893,8895,8897                    
 INSEC                      Dummy  8889     I(4)            4           scalar   ARG,INOUT        8894,8897                         
 ISECND                     Func   8889     I(4)            4           scalar                    8895,8897                         
 ISECND@0                   Local  8889     I(4)            4           scalar                                                      
 W3LOCDAT                   Subr   8892                                                           8892                              

Page 242         Source Listing                  ISECND
2017-04-18 11:09                                 syndata.f

   8901 
   8902 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8903 C                .      .    .                                       .
   8904 C SUBPROGRAM:    UVRTCN      CARTESIAN U,V TO RAD, TAN WIND
   8905 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   8906 C
   8907 C ABSTRACT: CONVERTS CARTESIAN U,V WINDS TO RADIAL, TANGENTIAL
   8908 C   WIND AND VICE VERSA.
   8909 C
   8910 C PROGRAM HISTORY LOG:
   8911 C 1991-06-06  S. J. LORD
   8912 C
   8913 C USAGE:    CALL UVRTCN(ANGLE,UWIND,VWIND,RADWND,TANWND)
   8914 C   INPUT ARGUMENT LIST:
   8915 C     ANGLE    - AZIMUTHAL ANGLE WITH RESPECT TO CENTER
   8916 C                (0-360 CLOCKWISE FROM NORTH)
   8917 C     UWIND    - WIND IN CARTESIAN X DIRECTION
   8918 C     VWIND    - WIND IN CARTESIAN Y DIRECTION
   8919 C     RADWND   - WIND IN RADIAL DIRECTION (POS. OUTWARD
   8920 C                FROM CENTER)
   8921 C     TANWND   - WIND IN TANGENTIAL DIRECTION [POS. IN THE
   8922 C                COUNTERCLOCKWISE SENSE, WHICH IS CYCLONIC
   8923 C                IN THE NORTHERN HEMISPHERE]
   8924 C
   8925 C   OUTPUT ARGUMENT LIST:   SAME DEFINITIONS AS INPUT LIST
   8926 C
   8927 C REMARKS: SPECIFY UWIND,VWIND USING UVRTCN TO GET RADWND,TANWND
   8928 C          AS OUTPUT.
   8929 C          SPECIFY RADWND,TANWND USING RTUVCN TO GET UWIND,VWIND
   8930 C          AS OUTPUT.
   8931 C          SINDEG_8 AND COSDEG_8 ARE SINE AND COSINE FUNCTIONS WITH
   8932 C          ARGUMENTS IN DEGREES.
   8933 C
   8934 C ATTRIBUTES:
   8935 C   LANGUAGE: FORTRAN 90
   8936 C   MACHINE:  NCEP WCOSS
   8937 C
   8938 C$$$
   8939       SUBROUTINE UVRTCN(ANGLE,UWIND,VWIND,RADWND,TANWND)
   8940 
   8941       REAL(8)  SINDEG_8,COSDEG_8
   8942 
   8943       SINANG=SINDEG_8(ANGLE)
   8944       COSANG=COSDEG_8(ANGLE)
   8945       RADWND= UWIND*SINANG+VWIND*COSANG
   8946       TANWND=-UWIND*COSANG+VWIND*SINANG
   8947       RETURN
   8948       END

Page 243         Source Listing                  UVRTCN
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 uvrtcn_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANGLE                      Dummy  8939     R(4)            4           scalar   ARG,INOUT        8943,8944                         
 COSANG                     Local  8944     R(4)            4           scalar                    8944,8945,8946                    
 COSDEG_8                   Func   8941     R(8)            8           scalar                    8944                              
 RADWND                     Dummy  8939     R(4)            4           scalar   ARG,INOUT        8945                              
 SINANG                     Local  8943     R(4)            4           scalar                    8943,8945,8946                    
 SINDEG_8                   Func   8941     R(8)            8           scalar                    8943                              
 TANWND                     Dummy  8939     R(4)            4           scalar   ARG,INOUT        8946                              
 UVRTCN                     Subr   8939                                                                                             
 UWIND                      Dummy  8939     R(4)            4           scalar   ARG,INOUT        8945,8946                         
 VWIND                      Dummy  8939     R(4)            4           scalar   ARG,INOUT        8945,8946                         

Page 244         Source Listing                  UVRTCN
2017-04-18 11:09                                 syndata.f

   8949 
   8950 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   8951 C                .      .    .                                       .
   8952 C SUBPROGRAM:    UV2DS       CONVERTS U, V MOTION TO DIRECTION/SPEED
   8953 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   8954 C
   8955 C ABSTRACT: CONVERTS ZONAL AND MERIDIONAL MOTION TO DIRECTION AND
   8956 C   SPEED AND VICE VERSA.
   8957 C
   8958 C PROGRAM HISTORY LOG:
   8959 C 1991-06-06  S. J. LORD
   8960 C
   8961 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   8962 C   INPUT ARGUMENT LIST:
   8963 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   8964 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   8965 C
   8966 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   8967 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   8968 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   8969 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   8970 C
   8971 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   8972 C     DDNAME1  - GENERIC NAME & CONTENT
   8973 C
   8974 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   8975 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   8976 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   8977 C
   8978 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   8979 C
   8980 C ATTRIBUTES:
   8981 C   LANGUAGE: FORTRAN 90
   8982 C   MACHINE:  NCEP WCOSS
   8983 C
   8984 C$$$
   8985       SUBROUTINE UV2DS(UZ,VZ,DIRZ,SPDZ)
   8986 
   8987       REAL(8)  SINDEG_8,COSDEG_8
   8988 
   8989       DATA EPS/1.E-5/
   8990 C
   8991 C     THIS ENTRY CALCULATES DIRECTION,SPEED FROM U, V CARTESIAN WINDS
   8992 C        ******  IMPORTANT NOTE: DIRECTION IS DIRECTION WIND IS
   8993 C                BLOWING, THE OPPOSITE OF METEOROLOGICAL CONVENTION  ***
   8994 C
   8995       IF(VZ .NE. -EPS)  VZ=VZ+EPS
   8996       SPDZ=SQRT(UZ**2+VZ**2)
   8997       DIRZ=ATAN2DEG(UZ,VZ)
   8998       IF(DIRZ .LT. -0.000001)  DIRZ=360.+DIRZ
   8999       RETURN
   9000 
   9001 C-----------------------------------------------------------------------
   9002 
   9003       ENTRY DS2UV(UZ,VZ,DIRZ,SPDZ)
   9004 C
   9005 C     THIS ENTRY PRODUCES U, V CARTESIAN WINDS FROM DIRECTION, SPEED

Page 245         Source Listing                  UV2DS
2017-04-18 11:09                                 syndata.f

   9006 C
   9007       UZ=SPDZ*SINDEG_8(DIRZ)
   9008       VZ=SPDZ*COSDEG_8(DIRZ)
   9009       RETURN
   9010       END


ENTRY POINTS

  Name                 Name              
                                         
 ds2uv_               uv2ds_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ATAN2DEG                   Func   8997     R(4)            4           scalar                    8997                              
 COSDEG_8                   Func   8987     R(8)            8           scalar                    9008                              
 DIRZ                       Dummy  8985     R(4)            4           scalar   ARG,INOUT        8997,8998,9007,9008               
 DS2UV                      Subr   9003                                                                                             
 EPS                        Local  8989     R(4)            4           scalar                    8989,8995                         
 SINDEG_8                   Func   8987     R(8)            8           scalar                    9007                              
 SPDZ                       Dummy  8985     R(4)            4           scalar   ARG,INOUT        8996,9007,9008                    
 SQRT                       Func   8996                                 scalar                    8996                              
 UV2DS                      Subr   8985                                                                                             
 UZ                         Dummy  8985     R(4)            4           scalar   ARG,INOUT        8996,8997,9007                    
 VZ                         Dummy  8985     R(4)            4           scalar   ARG,INOUT        8995,8996,8997,9008               

Page 246         Source Listing                  UV2DS
2017-04-18 11:09                                 syndata.f

   9011 
   9012 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9013 C                .      .    .                                       .
   9014 C SUBPROGRAM:    ATAN2DEG    ARC TAN FUNCTION FROM DEGREES INPUT
   9015 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   9016 C
   9017 C ABSTRACT: ARC TAN FUNCTION FROM DEGREES INPUT.
   9018 C
   9019 C PROGRAM HISTORY LOG:
   9020 C 1991-06-06  S. J. LORD
   9021 C
   9022 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   9023 C   INPUT ARGUMENT LIST:
   9024 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   9025 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   9026 C
   9027 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   9028 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   9029 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   9030 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   9031 C
   9032 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   9033 C     DDNAME1  - GENERIC NAME & CONTENT
   9034 C
   9035 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   9036 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   9037 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   9038 C
   9039 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   9040 C
   9041 C ATTRIBUTES:
   9042 C   LANGUAGE: FORTRAN 90
   9043 C   MACHINE:  NCEP WCOSS
   9044 C
   9045 C$$$
   9046       FUNCTION ATAN2DEG(ARG1,ARG2)
   9047 
   9048 C  DEGRAD CONVERTS DEGREES TO RADIANS
   9049 
   9050       DATA DEGRAD/0.017453/
   9051       IF(ARG1 .EQ. 0.0 .AND. ARG2 .EQ. 0.0)  THEN
   9052       ATAN2DEG=0.0
   9053       ELSE
   9054       ATAN2DEG=ATAN2(ARG1,ARG2)/DEGRAD
   9055       ENDIF
   9056       RETURN
   9057       END

Page 247         Source Listing                  ATAN2DEG
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                 
                       
 atan2deg_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARG1                       Dummy  9046     R(4)            4           scalar   ARG,INOUT        9051,9054                         
 ARG2                       Dummy  9046     R(4)            4           scalar   ARG,INOUT        9051,9054                         
 ATAN2                      Func   9054                                 scalar                    9054                              
 ATAN2DEG                   Func   9046     R(4)            4           scalar                    9052,9054                         
 ATAN2DEG@0                 Local  9046     R(4)            4           scalar                                                      
 DEGRAD                     Local  9050     R(4)            4           scalar                    9050,9054                         

Page 248         Source Listing                  ATAN2DEG
2017-04-18 11:09                                 syndata.f

   9058 
   9059 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9060 C                .      .    .                                       .
   9061 C SUBPROGRAM:    SINDEG_8    SINE FUNCTION FROM DEGREES INPUT
   9062 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   9063 C
   9064 C ABSTRACT: SINE FUNCTION FROM DEGREES INPUT.
   9065 C
   9066 C PROGRAM HISTORY LOG:
   9067 C 1991-06-06  S. J. LORD
   9068 C
   9069 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   9070 C   INPUT ARGUMENT LIST:
   9071 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   9072 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   9073 C
   9074 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   9075 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   9076 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   9077 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   9078 C
   9079 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   9080 C     DDNAME1  - GENERIC NAME & CONTENT
   9081 C
   9082 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   9083 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   9084 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   9085 C
   9086 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   9087 C
   9088 C ATTRIBUTES:
   9089 C   LANGUAGE: FORTRAN 90
   9090 C   MACHINE:  NCEP WCOSS
   9091 C
   9092 C$$$
   9093       FUNCTION SINDEG_8(ARG)
   9094 
   9095 C  DEGRAD CONVERTS DEGREES TO RADIANS
   9096 
   9097       REAL(8) SINDEG_8
   9098       DATA DEGRAD/0.017453/
   9099       SINDEG_8=SIN(ARG*DEGRAD)
   9100       RETURN
   9101       END

Page 249         Source Listing                  SINDEG_8
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                 
                       
 sindeg_8_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARG                        Dummy  9093     R(4)            4           scalar   ARG,INOUT        9099                              
 DEGRAD                     Local  9098     R(4)            4           scalar                    9098,9099                         
 SIN                        Func   9099                                 scalar                    9099                              
 SINDEG_8                   Func   9093     R(8)            8           scalar                    9099                              
 SINDEG_8@0                 Local  9093     R(8)            8           scalar                                                      

Page 250         Source Listing                  SINDEG_8
2017-04-18 11:09                                 syndata.f

   9102 
   9103 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9104 C                .      .    .                                       .
   9105 C SUBPROGRAM:    COSDEG_8    COSINE FUNCTION FROM DEGREES INPUT
   9106 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   9107 C
   9108 C ABSTRACT: RETURNS COSINE FUNCTION FROM DEGREES INPUT
   9109 C
   9110 C PROGRAM HISTORY LOG:
   9111 C 1991-06-06  S. J. LORD
   9112 C
   9113 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   9114 C   INPUT ARGUMENT LIST:
   9115 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   9116 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   9117 C
   9118 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   9119 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   9120 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   9121 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   9122 C
   9123 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   9124 C     DDNAME1  - GENERIC NAME & CONTENT
   9125 C
   9126 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   9127 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   9128 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   9129 C
   9130 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   9131 C
   9132 C ATTRIBUTES:
   9133 C   LANGUAGE: FORTRAN 90
   9134 C   MACHINE:  NCEP WCOSS
   9135 C
   9136 C$$$
   9137       FUNCTION COSDEG_8(ARG)
   9138 
   9139 C  DEGRAD CONVERTS DEGREES TO RADIANS
   9140 
   9141       REAL(8) COSDEG_8
   9142       DATA DEGRAD/0.017453/
   9143       COSDEG_8=COS(ARG*DEGRAD)
   9144       RETURN
   9145       END

Page 251         Source Listing                  COSDEG_8
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                 
                       
 cosdeg_8_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARG                        Dummy  9137     R(4)            4           scalar   ARG,INOUT        9143                              
 COS                        Func   9143                                 scalar                    9143                              
 COSDEG_8                   Func   9137     R(8)            8           scalar                    9143                              
 COSDEG_8@0                 Local  9137     R(8)            8           scalar                                                      
 DEGRAD                     Local  9142     R(4)            4           scalar                    9142,9143                         

Page 252         Source Listing                  COSDEG_8
2017-04-18 11:09                                 syndata.f

   9146 
   9147 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9148 C                .      .    .                                       .
   9149 C SUBPROGRAM:    DISTSP_8    DISTANCE ON GREAT CIRCLE
   9150 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   9151 C
   9152 C ABSTRACT: CALCULATES DISTANCE ON GREAT CIRCLE BETWEEN TWO LAT/LON
   9153 C   POINTS.
   9154 C
   9155 C PROGRAM HISTORY LOG:
   9156 C 1991-06-06  S. J. LORD
   9157 C
   9158 C USAGE:    DXY=DISTSP_8(DLAT1,DLON1,DLAT2,DLON2)
   9159 C   INPUT ARGUMENT LIST:
   9160 C     DLAT1    - LATITUDE OF POINT 1 (-90<=LAT<=90)
   9161 C     DLON1    - LONGITUDE OF POINT 1 (-180 TO 180 OR 0 TO 360)
   9162 C     DLAT2    - LATITUDE OF POINT 2 (-90<=LAT<=90)
   9163 C     DLON1    - LONGITUDE OF POINT 2
   9164 C
   9165 C
   9166 C REMARKS: DISTANCE IS IN METERS
   9167 C
   9168 C ATTRIBUTES:
   9169 C   LANGUAGE: FORTRAN 90
   9170 C   MACHINE:  NCEP WCOSS
   9171 C
   9172 C$$$
   9173       FUNCTION DISTSP_8(DLAT1,DLON1,DLAT2,DLON2)
   9174       REAL(8) DISTSP_8,XXM,XXD,YYY,SINDEG_8,COSDEG_8
   9175       DATA REARTH/6.37E6/
   9176 C
   9177       XXD=COSDEG_8(DLON1-DLON2)*COSDEG_8(DLAT1)*COSDEG_8(DLAT2)+
   9178      1    SINDEG_8(DLAT1)*SINDEG_8(DLAT2)
   9179 C
   9180       YYY=MAX(-1.0_8,XXD)
   9181       XXM=MIN(1.0_8,YYY)
   9182 C
   9183       DISTSP_8=ACOS(XXM)*REARTH
   9184       RETURN
   9185       END

Page 253         Source Listing                  DISTSP_8
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                 
                       
 distsp_8_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ACOS                       Func   9183                                 scalar                    9183                              
 COSDEG_8                   Func   9174     R(8)            8           scalar                    9177                              
 DISTSP_8                   Func   9173     R(8)            8           scalar                    9183                              
 DISTSP_8@0                 Local  9173     R(8)            8           scalar                                                      
 DLAT1                      Dummy  9173     R(4)            4           scalar   ARG,INOUT        9177,9178                         
 DLAT2                      Dummy  9173     R(4)            4           scalar   ARG,INOUT        9177,9178                         
 DLON1                      Dummy  9173     R(4)            4           scalar   ARG,INOUT        9177                              
 DLON2                      Dummy  9173     R(4)            4           scalar   ARG,INOUT        9177                              
 MAX                        Func   9180                                 scalar                    9180                              
 MIN                        Func   9181                                 scalar                    9181                              
 REARTH                     Local  9175     R(4)            4           scalar                    9175,9183                         
 SINDEG_8                   Func   9174     R(8)            8           scalar                    9178                              
 XXD                        Local  9174     R(8)            8           scalar                    9177,9180                         
 XXM                        Local  9174     R(8)            8           scalar                    9181,9183                         
 YYY                        Local  9174     R(8)            8           scalar                    9180,9181                         

Page 254         Source Listing                  DISTSP_8
2017-04-18 11:09                                 syndata.f

   9186 
   9187 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9188 C                .      .    .                                       .
   9189 C SUBPROGRAM:    STDEV       STANDARD DEVIATION RMS DIFFERENCE
   9190 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-06
   9191 C
   9192 C ABSTRACT: CALCULATES STANDARD DEVIATIONS AND RMS DIFFERENCES.
   9193 C
   9194 C PROGRAM HISTORY LOG:
   9195 C 1991-06-06  S. J. LORD
   9196 C
   9197 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
   9198 C   INPUT ARGUMENT LIST:
   9199 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
   9200 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
   9201 C
   9202 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
   9203 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
   9204 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
   9205 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
   9206 C
   9207 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   9208 C     DDNAME1  - GENERIC NAME & CONTENT
   9209 C
   9210 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   9211 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
   9212 C     FT06F001 - INCLUDE IF ANY PRINTOUT
   9213 C
   9214 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
   9215 C
   9216 C ATTRIBUTES:
   9217 C   LANGUAGE: FORTRAN 90
   9218 C   MACHINE:  NCEP WCOSS
   9219 C
   9220 C$$$
   9221       SUBROUTINE STDEV(XX,LX,NSAM,AVGX,STDX)
   9222 C
   9223       DIMENSION XX(LX)
   9224 C
   9225       STDX=0.0
   9226 C     N=0
   9227       DO 10 L=1,LX
   9228       STDX=STDX+(XX(L)-AVGX)**2
   9229 C     N=N+1
   9230    10 CONTINUE
   9231       STDX=SQRT(STDX/REAL(NSAM))
   9232       RETURN
   9233       END

Page 255         Source Listing                  STDEV
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 stdev_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  9230                                                           9227                              
 AVGX                       Dummy  9221     R(4)            4           scalar   ARG,INOUT        9228                              
 L                          Local  9227     I(4)            4           scalar                    9227,9228                         
 LX                         Dummy  9221     I(4)            4           scalar   ARG,INOUT        9223,9227                         
 NSAM                       Dummy  9221     I(4)            4           scalar   ARG,INOUT        9231                              
 REAL                       Func   9231                                 scalar                    9231                              
 SQRT                       Func   9231                                 scalar                    9231                              
 STDEV                      Subr   9221                                                                                             
 STDX                       Dummy  9221     R(4)            4           scalar   ARG,INOUT        9225,9228,9231                    
 XX                         Dummy  9221     R(4)            4     1     0        ARG,INOUT        9228                              

Page 256         Source Listing                  STDEV
2017-04-18 11:09                                 syndata.f

   9234 
   9235 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9236 C                .      .    .                                       .
   9237 C SUBPROGRAM:    ABRT1       ERROR EXIT ROUTINE
   9238 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: 1991-06-05
   9239 C
   9240 C ABSTRACT: ERROR TERMINATION ROUTINE THAT LISTS ROUTINE WHERE
   9241 C   ERROR OCCURRED AND THE NEAREST STATEMENT NUMBER.
   9242 C
   9243 C PROGRAM HISTORY LOG:
   9244 C 1991-06-05  S. J. LORD
   9245 C
   9246 C USAGE:    CALL ABRT1(ME(KENTRY,ISTMT)
   9247 C   INPUT ARGUMENT LIST:
   9248 C     KENTRY   - CHARACTER VARIABLE (*7) GIVING PROGRAM OR SUBROUTINE
   9249 C              - WHERE ERROR OCCURRED.
   9250 C     ISTMT    - STATEMENT NUMBER NEAR WHERE ERROR OCCURRED.
   9251 C
   9252 C
   9253 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
   9254 C     FT06F001 - PRINTOUT
   9255 C
   9256 C REMARKS: THIS ROUTINE IS CALLED WHENEVER AN INTERNAL PROBLEM
   9257 C          TO THE CODE IS FOUND. EXAMPLES ARE CALLING PARAMETERS THAT
   9258 C          WILL OVERFLOW ARRAY BOUNDARIES AND OBVIOUS INCONSISTENCIES
   9259 C          IN NUMBERS GENERATED BY THE CODE.
   9260 C
   9261 C ATTRIBUTES:
   9262 C   LANGUAGE: FORTRAN 90
   9263 C   MACHINE:  NCEP WCOSS
   9264 C
   9265 C$$$
   9266       SUBROUTINE ABRT1(KENTRY,ISTMT)
   9267       CHARACTER*(*) KENTRY
   9268       WRITE(6,10) KENTRY,ISTMT
   9269    10 FORMAT(////21X,'*********************************************'/
   9270      1           21X,'*********************************************'/
   9271      2           21X,'****  PROGRAM FAILED DUE TO FATAL ERROR  ****'/
   9272      3           21X,'****  IN ROUTINE ',A,' NEAR            ****'/
   9273      4           21X,'****  STATEMENT NUMBER',I5,'.             ****'/
   9274      5           21X,'*********************************************'/
   9275      6           21X,'*********************************************')
   9276       CALL W3TAGE('SYNDAT_SYNDATA')
   9277       CALL ERREXIT(20)
   9278       END

Page 257         Source Listing                  ABRT1
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 abrt1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  9269                                                           9268                              
 ABRT1                      Subr   9266                                                                                             
 ERREXIT                    Subr   9277                                                           9277                              
 ISTMT                      Dummy  9266     I(4)            4           scalar   ARG,INOUT        9268                              
 KENTRY                     Dummy  9266     CHAR                        scalar   ARG,INOUT        9268                              
 W3TAGE                     Subr   9276                                                           9276                              

Page 258         Source Listing                  ABRT1
2017-04-18 11:09                                 syndata.f

   9279 
   9280 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   9281 C                .      .    .                                       .
   9282 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
   9283 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
   9284 C
   9285 C ABSTRACT: ??????????????????????????????????????????????????????????
   9286 C   ??????????????????????????????????????????????????????????????????
   9287 C
   9288 C PROGRAM HISTORY LOG:
   9289 C ????-??-??  S. J. LORD
   9290 C
   9291 C USAGE:    CALL ????????(????)
   9292 C   INPUT ARGUMENT LIST:
   9293 C     ??????   - ???????????????????????????????????????????????
   9294 C
   9295 C   OUTPUT ARGUMENT LIST:
   9296 C     ??????   - ???????????????????????????????????????????????
   9297 C
   9298 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
   9299 C     ??????   - ???????????????????????????????????????????????
   9300 C
   9301 C   OUTPUT FILES:
   9302 C     ??????   - ???????????????????????????????????????????????
   9303 C
   9304 C REMARKS: ?????????????????????????????????????????????????????
   9305 C
   9306 C ATTRIBUTES:
   9307 C   LANGUAGE: FORTRAN 90
   9308 C   MACHINE:  NCEP WCOSS
   9309 C
   9310 C$$$
   9311       SUBROUTINE CMPSIT(NDATAZ,STMDRZ,STMSPZ,PTOPZ,RMXCOM,RMAXZ,ONLYWI,
   9312      1                  ONLYPS,STMNMZ,IPRTZ,IUNTBH,IHOWFR,ANGLE,RLAT,
   9313      2                  RLON,PRESR,IRTYP,DATA,AXIPS,AXIRAD,NRDSTR,
   9314      3                  NRADVO,NCMPVO,IUNTDH,AXIWND,PRESVO,RMAX,PCEN,
   9315      4                  PENV,RPOT,SPDPOT,NOBWMN,STMLTZ,STMLNZ,IDATEZ,
   9316      5                  IUTCZ)
   9317 C
   9318       PARAMETER (NRADBN=18)
   9319       PARAMETER (NAZIBN= 4)
   9320       PARAMETER (NLVLBN= 4)
   9321       PARAMETER (NCORBN= 2)
   9322       PARAMETER (NVARBN= 3)
   9323 ccccc PARAMETER (NDATMX=1000)
   9324       PARAMETER (NDATMX=8000)
   9325 ccccc PARAMETER (LDXDIM=1000)
   9326       PARAMETER (LDXDIM=8000)
   9327       PARAMETER (NVROUT=16)
   9328       PARAMETER (IOUTMX= 6)
   9329       PARAMETER (NRBNPS=36)
   9330       PARAMETER (NDIM=70)
   9331 C
   9332       CHARACTER STMNMZ*(*)
   9333 C
   9334       LOGICAL FIRST,EQLDR,PRNT,ONLYWI,ONLYPS,YUP
   9335 C

Page 259         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9336       SAVE
   9337 C
   9338       DIMENSION RBIN(0:NRADBN),DATA(NDATAZ),RADBIN(NRADBN),
   9339      1          PBIN(NLVLBN+1),PSET(NLVLBN+1),
   9340      2          COMDAT(NRADBN,NAZIBN,NLVLBN,NCORBN,NVARBN),
   9341      3          NCOMDT(NRADBN,NAZIBN,NLVLBN,NCORBN,NVARBN),
   9342      4          OUTMAP(NAZIBN),OUTPRT(IOUTMX),
   9343      5          RADDAT(NVROUT,NDATMX,NRADBN,NLVLBN),STDZ(NDATMX),
   9344      6          NSTOR(NRADBN,NLVLBN),AZIAVW(NRADBN,NVARBN,NLVLBN,2),
   9345      7          NAZIAV(NRADBN,NLVLBN,2),STDAZW(NRADBN,NVARBN,NLVLBN)
   9346 C
   9347       DIMENSION PSBIN(NRBNPS,2),RPSBIN(NRBNPS),NPSBIN(NRBNPS,2),
   9348      1          PSDAT(NVROUT,NDATMX,NRBNPS),PSCOM(NRBNPS,2),
   9349      2          STDAZP(NRBNPS)
   9350 C
   9351       DIMENSION AXIPS(NRADVO),AXIWND(NRADVO,NCMPVO),AXIRAD(NRADVO),
   9352      1          NRDSTR(NRADVO)
   9353 C
   9354       DIMENSION SPLDTA(LDXDIM),WDZ(LDXDIM),YDZ(LDXDIM),SPLFIT(NDIM+1),
   9355      1          SPLNOD(NDIM+1)
   9356 C
   9357       NAMELIST/COMPRM/DELTAR,RADBIN,NRBIN,NABIN,NLBIN,PBIN
   9358 C
   9359 C     DELRPS IS THE HARDWIRED RADIAL BIN SEPARATION (KM)
   9360 C     HUNDKM IS ONE HUNDRED KM IN METERS
   9361 C     EPSPS IS THE TOLERANCE FOR 1-D FITTED SPLINE FITTED DATA
   9362 C       TO BE CLASSIFIED AS INCREASING OR DECREASING
   9363 C     EPSRD IS SUBTRACTED FROM RADII TO DETERMINE COMPOSITING BIN
   9364 C     IPLVL IS PRINT OUTPUT LEVEL FOR 1-D FILTERED SPLINE: 0=NO PRINT,
   9365 C             - 1: DATA LISTINGS, 2: DATA LISTINGS AND GRAPHS
   9366 C
   9367       DATA PSET/1100.,900.,700.,300.,100./,OUTMAP/4,1,3,2/,DELRPS/50./,
   9368      1     FIRST/.TRUE./,ITMXPS/8/,EPSPS/0.40/,HUNDKM/1.E5/,EPSRD/1.0/,
   9369      2     IPLVL/2/
   9370 C
   9371 C     NRADBN: MAXIMUM NUMBER OF SLOTS RADIALLY
   9372 C     NAZIBN:   "       "    "    "   AZIMUTHALLY
   9373 C     NCORBN:   "       "    "    "   FOR COORDINATES
   9374 C             (1=EARTH ORIENTED: NE, SE, SW, NW
   9375 C              2=STORM DIRECTION ORIENTED: AHEAD RIGHT, BEHIND RIGHT
   9376 C                                          BEHIND LEFT, AHEAD LEFT
   9377 C     NVARBN: MAXIMUM NUMBER OF SLOTS FOR VARIABLES
   9378 C             (1=TANGENTIAL WIND, 2=RADIAL WIND, 3=WIND SPEED)
   9379 C
   9380 C     INPUT DATA IS IN "DATA" ARRAY. CURRENTLY WE EXPECT THREE SLOTS:
   9381 C        1: U (ZONAL WIND)   2: V (MERIDIONAL WIND)  3: SURFACE PRES.
   9382 C
   9383 
   9384 C-----------------------------------------------------------------------
   9385 
   9386       ENTRY SETCOM(NDATAZ,IUNTDH,STMDRZ,STMSPZ,PTOPZ,RMXCOM,RMAXZ,RPOT,
   9387      1             ONLYWI,ONLYPS,STMNMZ)
   9388       NDATA=NDATAZ
   9389 C
   9390 C     SAVE STORM PARAMETERS INCLUDING RMAX, DIRECTION AND SPEED
   9391 C       AT THE COMPOSITING TIME
   9392 C

Page 260         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9393       NOBWND=0
   9394       NOBPS=0
   9395       STMDR0=STMDRZ
   9396       STMSP0=STMSPZ
   9397       PTOP=PTOPZ
   9398       RMAXM=RMAXZ*1.E3
   9399       RPOTM=RPOT*1.E3
   9400       CALL DS2UV(USTM,VSTM,STMDR0,STMSP0)
   9401       WRITE(6,1) STMNMZ,PTOP,USTM,VSTM,STMDR0,STMSP0,RMXCOM,
   9402      1           ONLYWI,ONLYPS
   9403     1 FORMAT(//30X,'***********************************************'/
   9404      1         30X,'***********************************************'/
   9405      2         30X,'****  COMPOSITE ANALYSIS OF OBSERVATIONS   ****'/
   9406      3         30X,'****     WITHIN THE TROPICAL CYCLONE       ****'/
   9407      4         30X,'****     ENVIRONMENT.  STORM=',A,2X,'****'/
   9408      5         30X,'***********************************************'/
   9409      6         30X,'***********************************************'//
   9410      7         ' ...ENTERING SETCOM, PTOP,USTM,VSTM,STMDR0,STMSP0,',
   9411      8         'RMXCOM(KM),ONLYWI,ONLYPS=',5F8.2,-3PF8.2,2L3)
   9412 C
   9413       IF(.NOT. ONLYWI)  GO TO 60
   9414 C
   9415 C     INITIALIZE STORAGE
   9416 C
   9417       COMDAT=0.0
   9418       NCOMDT=0
   9419       NSTOR=0
   9420       NAZIAV=0
   9421       AZIAVW=0.0
   9422 C
   9423 C     SET COUNTER FOR OBS PROCESSED BUT NOT PRINTED IN DATA LIST
   9424 C
   9425       NMSNG=0
   9426 C
   9427 C     DEFAULT BIN SETUP
   9428 C
   9429       NRBIN=NRADBN
   9430       NABIN=4
   9431       NLBIN=4
   9432       NLBIN1=NLBIN+1
   9433       WRITE(6,3)
   9434     3 FORMAT(/'...SETTING UP PRESSURE BINS:')
   9435       DO 5 NL=1,NLBIN1
   9436       PBIN(NL)=PSET(NL)
   9437       WRITE(6,4) NL,PBIN(NL)
   9438     4 FORMAT('...NL,PBIN=',I5,F10.2)
   9439     5 CONTINUE
   9440 C
   9441 C     DEFAULT RADIAL BINS ARE 100 KM EQUALLY DISTANT
   9442 C
   9443       DELTAR=100.E3
   9444 
   9445       RBIN(1:NRADBN)=1.E10
   9446 C
   9447 C     CHANGE BIN SETUP BY READING INPUT NAMELIST
   9448 C
   9449       IF(FIRST)  THEN

Page 261         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9450          READ(5,COMPRM)
   9451          WRITE(6,COMPRM)
   9452       END IF
   9453       FIRST=.FALSE.
   9454 C
   9455 C     DEFINE SECTOR WIDTH
   9456 C
   9457       ASECTR=360./REAL(NABIN)
   9458 C
   9459 C     CHECK NUMBER OF DATA SLOTS ONCE AND FOR ALL
   9460 C
   9461       IF(NDATA .GT. NVARBN)  THEN
   9462       WRITE(6,16) NDATA,NVARBN
   9463    16 FORMAT(/'...NUMBER OF PIECES OF DATA TO BE COMPOSITED EXCEEDS',
   9464      1       ' AVAILABLE SPACE, NDATA, NVARBN=',2I5)
   9465       CALL ABRT1(' SETCOM',16)
   9466       ENDIF
   9467 C
   9468       IF(NRBIN .GT. NRADBN)  THEN
   9469       WRITE(6,17) NRBIN,NRADBN
   9470    17 FORMAT(/'...NUMBER OF RADIAL BINS EXCEEDS AVAILABLE SPACE',
   9471      1       ' NRBIN, NRADBN=',2I5)
   9472       CALL ABRT1(' SETCOM',17)
   9473       ENDIF
   9474 C
   9475       IF(NABIN .GT. NAZIBN)  THEN
   9476       WRITE(6,18) NABIN,NAZIBN
   9477    18 FORMAT(/'...NUMBER OF AZIMUTHAL BINS EXCEEDS AVAILABLE SPACE',
   9478      1       ' NABIN, NAZIBN=',2I5)
   9479       CALL ABRT1(' SETCOM',18)
   9480       ENDIF
   9481 C
   9482 C     WHEN THE INPUT RADIUS INCREMENT IS NEGATIVE, UNEQUAL RADIAL
   9483 C       SPACING IS ASSUMED. INPUT IS VIA NAMELIST
   9484 C
   9485       IF(DELTAR .LE. 0)  THEN
   9486       EQLDR=.FALSE.
   9487 C
   9488       RBIN(0)=0.0
   9489       DO 30 NRB=1,NRBIN
   9490       RBIN(NRB)=RADBIN(NRB)
   9491       IF(NRB .GT. 1)  THEN
   9492         IF(RBIN(NRB) .LE. RBIN(NRB-1))  THEN
   9493         WRITE(6,27) NRB,RBIN(NRB),RBIN(NRB-1)
   9494    27   FORMAT(/'******ERROR IN BIN SETUP, RADII DECREASE OUTWARD,',
   9495      1         ' NRB, RBIN(NRB),RBIN(NRB-1)=',/,10X,I5,2F12.3)
   9496         ENDIF
   9497         CALL ABRT1(' SETCOM',27)
   9498       ENDIF
   9499    30 CONTINUE
   9500       ELSE
   9501       EQLDR=.TRUE.
   9502 C
   9503       DO 40 NRB=0,NRBIN
   9504       RBIN(NRB)=REAL(NRB)*DELTAR
   9505    40 CONTINUE
   9506       ENDIF

Page 262         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9507 C
   9508 C     **** IMPORTANT NOTE: WE RE-DEFINE NUMBER OF RADIAL BINS
   9509 C                          TO MATCH RMXCOM, THE MAXIMUM RADIUS
   9510 C                          WITHIN WHICH COMPOSITING WILL TAKE
   9511 C                          PLACE FOR EACH STORM  ****
   9512 C
   9513       NRBINZ=NRBIN
   9514       NRBRPT=1
   9515       DO 50 NRB=1,NRBINZ
   9516       NRBIN=NRB
   9517 C
   9518 C     FIND THE BIN INDEX CORRESPONDING TO RPOT
   9519 C
   9520       IF(NRB .LT. NRBINZ)  THEN
   9521 c && 3 comments
   9522 CC    WRITE(6,47) NRB,RPOTM,RBIN(NRB),RBIN(NRB+1)
   9523 CC 47 FORMAT('...CHECKING FOR RPOT BIN: NRB,RPOT,RBIN(NRB),',
   9524 CC   1       'RBIN(NRB+1)=',I4,-3P,3F12.1)
   9525       IF(RBIN(NRB) .LE. RPOTM .AND. RBIN(NRB+1) .GT. RPOTM)
   9526      1   NRBRPT=NRB
   9527       ENDIF
   9528 C
   9529       IF(RBIN(NRB) .GT. RMXCOM)  GO TO 55
   9530    50 CONTINUE
   9531       WRITE(6,51) RBIN(NRBIN),RMXCOM,NRBIN
   9532    51 FORMAT(/'######MAXIMUM BIN RADIUS=',-3PF9.2,' KM IS NOT LARGE ',
   9533      1       'ENOUGH TO ENCOMPASS RMXCOM=',F9.2,' KM.',/,8X,'MAKE',
   9534      2       'PARAMETER NRADBN LARGER THAN',I5)
   9535 C
   9536    55 CONTINUE
   9537 C
   9538       WRITE(6,57) (NR,RBIN(NR),NR=1,NRBIN)
   9539    57 FORMAT(/'...SETTING UP RADIAL BINS (KM) FOR WIND:',/,
   9540      1       (' ...NR,RBIN=',I5,-3PF10.2))
   9541       WRITE(6,59) RPOT,NRBRPT
   9542    59 FORMAT(/'...RADIAL BIN INDEX CORRESPONDING TO RPOT=',F7.2,
   9543      1       ' IS',I3)
   9544 C
   9545    60 IF(.NOT. ONLYPS)  RETURN
   9546       PSCLOS =-9999.9
   9547       HOWFMN=1.E10
   9548       DRPSM =DELRPS*1.E3
   9549       NVRPS =6
   9550       NCOMPS=1
   9551       DIFMN =1.E10
   9552 C
   9553       DO 65 NRPS=1,NRBNPS
   9554       NBINPS=NRPS
   9555       RPSBIN(NRPS)=DRPSM*REAL(NRPS)
   9556         IF(ABS(RPSBIN(NRPS)-RMAXM) .LT. DIFMN)  THEN
   9557         NPSRMX=NRPS
   9558         DIFMN=ABS(RPSBIN(NRPS)-RMAXM)
   9559         ENDIF
   9560 C
   9561       PSBIN (NRPS,:)=0.0
   9562       NPSBIN(NRPS,:)=0
   9563 C

Page 263         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9564       IF(RPSBIN(NRPS) .GT. RMXCOM)  GO TO 70
   9565    65 CONTINUE
   9566       WRITE(6,66) NRBNPS,DRPSM,RMXCOM
   9567    66 FORMAT('######WARNING: MAXIMUM NUMBER OF SFC PRES BINS IS ',
   9568      1       'NOT SUFFICIENT TO SPAN RMXCOM.',/,7X,' NO. BINS, DRPSM,',
   9569      2       ' RMXCOM=',I5,2E12.3)
   9570 C
   9571    70 CONTINUE
   9572       NPSRM1=NPSRMX+1
   9573 C
   9574       WRITE(6,73) (NR,RPSBIN(NR),NR=1,NBINPS)
   9575    73 FORMAT(/'...SETTING UP RADIAL BINS (KM) FOR SURFACE PRESSURE:',/,
   9576      1       (' ...NR,RPSBIN=',I5,-3PF10.2))
   9577       RETURN
   9578 C
   9579 
   9580 C-----------------------------------------------------------------------
   9581 
   9582       ENTRY OWNCOM(IPRTZ,IHOWFR,ANGLE,RLAT,RLON,PRESR,IRTYP,NDATAZ,DATA)
   9583       IPRT=IPRTZ
   9584       IF(IPRT .GT. 0)
   9585      1        WRITE(6,101) IHOWFR,ANGLE,PRESR,(DATA(N),N=1,2)
   9586   101 FORMAT('...ENTERING OWNCOM, IHOWFR,ANGLE,PRESR,DATA=',I12,2F12.2/
   9587      1       (14X,5F12.3))
   9588 C
   9589       ANGZ=ANGLE
   9590       DO 170 NCOR=1,NCORBN
   9591 C
   9592 C     NCOR=1 : EARTH COORDINATE SYSTEM
   9593 C     NCOR=2 : STORM-RELATIVE SYSTEM (STORM SPEED SUBTRACTED OUT)
   9594 C
   9595       IF(NCOR .EQ. 1)  THEN
   9596       NAZ =IFIX(ANGZ/ASECTR)+1
   9597 C
   9598       IF(EQLDR)  THEN
   9599         NRA=INT((IHOWFR-NINT(EPSRD))/DELTAR)+1
   9600         IF(NRA .GT. NRADBN)  THEN
   9601         WRITE(6,107) IHOWFR,DELTAR,NRA,NRADBN
   9602   107   FORMAT('******NRA EXCEEDS LIMITS IHOWFR,DELTAR,NRA=',
   9603      1         I13,F13.2,2I7,/,10X,'OBSERVATION WILL NOT BE PROCESSED')
   9604         RETURN
   9605         ENDIF
   9606       ELSE
   9607       DO 110 NRAZ=1,NRBIN
   9608       NRA=NRAZ
   9609       IF(REAL(IHOWFR) .LE. RBIN(NRAZ))  GO TO 115
   9610   110 CONTINUE
   9611       WRITE(6,111) NRA,IHOWFR,RBIN(NRA)
   9612   111 FORMAT('******EXCEEDED FORMAL SETUP OF RADIAL BINS, NRA,',
   9613      1       'IHOWFR,RBIN(NRA)=',I5,I12,F12.3)
   9614       NRA=MIN(NRBIN+1,NRADBN)
   9615       WRITE(6,112) NRA,NRADBN
   9616   112 FORMAT('...THE FIX IS TO PLACE OBS IN BIN=',I5,' WHERE',
   9617      1       ' MAXIMUM BIN=',I5)
   9618 C
   9619       ENDIF
   9620 C

Page 264         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9621   115 DO 130 NLBZ=1,NLBIN
   9622       NLB=NLBZ
   9623       IF(NINT(PRESR*10.) .LT. NINT(PBIN(NLBZ)*10.) .AND.
   9624      $   NINT(PRESR*10.) .GE. NINT(PBIN(NLBZ+1)*10.))  GO TO 140
   9625   130 CONTINUE
   9626       WRITE(6,131) NLB,PRESR,PBIN(NLB)
   9627   131 FORMAT('******EXCEEDED FORMAL SETUP OF VERTICAL BINS, NLB,',
   9628      1       'PRESR,PBIN(NLB)=',I5,2F12.3)
   9629       NLB=MIN(NLBIN1+1,NLVLBN)
   9630       WRITE(6,132) NLB,NLVLBN
   9631   132 FORMAT('...THE FIX IS TO PLACE OBS IN BIN=',I5,' WHERE',
   9632      1       ' MAXIMUM BIN=',I5)
   9633 C
   9634 C     FOR STORM RELATIVE COORDINATE, WE CALCULATE THE ANGLE WITH RESPECT
   9635 C       TO THE STORM MOTION AND SUBTRACT OUT THE STORM MOTION.
   9636 C
   9637       ELSE IF(NCOR .EQ. 2) THEN
   9638       NAZ=IFIX(MOD(360.-STMDR0+ANGZ,360.)/ASECTR)+1
   9639       DATA(1)=DATA(1)-USTM
   9640       DATA(2)=DATA(2)-VSTM
   9641       ELSE
   9642       WRITE(6,137) NCOR,NCORBN
   9643   137 FORMAT(/'******ILLEGAL VALUE OF NCOR=',I5,' NCORBN=',I5)
   9644       CALL ABRT1(' OWNCOM',137)
   9645       ENDIF
   9646 C
   9647   140 CONTINUE
   9648       IF(IPRT .GT. 0)
   9649      1      WRITE(6,151) NCOR,NAZ,NRA,NLB,(DATA(N),N=1,2)
   9650   151 FORMAT('...GOING TO STORE COMPOSITED DATA, NCOR,NAZ,NRA,NLB,',
   9651      1       'DATA=',4I5,/,(10X,5F12.3))
   9652 C
   9653       CALL UVRTCN(ANGZ,DATA(1),DATA(2),VRAD,VTAN)
   9654       IF(IPRT .GT. 0)
   9655      1      WRITE(6,161) NCOR,ANGZ,DATA(1),DATA(2),VRAD,VTAN
   9656   161 FORMAT('...U,V TO RAD, TAN: NCOR,ANGZ,UWIND,VWIND,VRAD,VTAN=',/,
   9657      1       10X,I3,5F12.3)
   9658 C
   9659 C     STORE DATA
   9660 C
   9661       COMDAT(NRA,NAZ,NLB,NCOR,1)=COMDAT(NRA,NAZ,NLB,NCOR,1)+VRAD
   9662       COMDAT(NRA,NAZ,NLB,NCOR,2)=COMDAT(NRA,NAZ,NLB,NCOR,2)+VTAN
   9663       COMDAT(NRA,NAZ,NLB,NCOR,3)=COMDAT(NRA,NAZ,NLB,NCOR,3)+
   9664      1                           SQRT(VRAD**2+VTAN**2)
   9665       NCOMDT(NRA,NAZ,NLB,NCOR,1)=NCOMDT(NRA,NAZ,NLB,NCOR,1)+1
   9666 C
   9667 C     STORE THE DATA VALUES BY RADIAL BIN AND LEVEL
   9668 C
   9669       IF(NCOR .EQ. 1)  THEN
   9670         IF(NSTOR(NRA,NLB) .LT. NDATMX)  THEN
   9671         NSTOR(NRA,NLB)=NSTOR(NRA,NLB)+1
   9672         NOBWND=NOBWND+1
   9673         NCOM=NSTOR(NRA,NLB)
   9674         RADDAT( 1,NCOM,NRA,NLB)=RLAT
   9675         RADDAT( 2,NCOM,NRA,NLB)=RLON
   9676         RADDAT( 3,NCOM,NRA,NLB)=PRESR
   9677         RADDAT( 4,NCOM,NRA,NLB)=REAL(IRTYP)

Page 265         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9678         RADDAT( 5,NCOM,NRA,NLB)=DATA(1)
   9679         RADDAT( 6,NCOM,NRA,NLB)=DATA(2)
   9680         CALL UV2DS(DATA(1),DATA(2),DIRZ,SPDZ)
   9681         RADDAT( 7,NCOM,NRA,NLB)=DIRZ
   9682         RADDAT( 8,NCOM,NRA,NLB)=SPDZ
   9683         RADDAT( 9,NCOM,NRA,NLB)=VRAD
   9684         RADDAT(10,NCOM,NRA,NLB)=VTAN
   9685         RADDAT(11,NCOM,NRA,NLB)=ANGZ
   9686         ELSE
   9687         NMSNG=NMSNG+1
   9688         WRITE(6,169) NRA,NLB,NSTOR(NRA,NLB),NDATMX,NMSNG
   9689   169   FORMAT('******STORAGE FOR OBSERVATIONS EXCEEDED, NRA,NLB,',
   9690      1         'NSTOR,NDATMX,NONPRINTED OBS=',5I6)
   9691         ENDIF
   9692 C
   9693         ELSE
   9694         RADDAT(12,NCOM,NRA,NLB)=SQRT(VRAD**2+VTAN**2)
   9695         RADDAT(13,NCOM,NRA,NLB)=VRAD
   9696         RADDAT(14,NCOM,NRA,NLB)=VTAN
   9697         RADDAT(15,NCOM,NRA,NLB)=MOD(360.-STMDR0+ANGZ,360.)
   9698         RADDAT(16,NCOM,NRA,NLB)=REAL(IHOWFR)
   9699       ENDIF
   9700   170 CONTINUE
   9701       RETURN
   9702 C
   9703 
   9704 C-----------------------------------------------------------------------
   9705 
   9706       ENTRY OPSCOM(IPRTZ,IHOWFR,ANGLE,RLAT,RLON,IRTYP,NDATAZ,DATA)
   9707 C
   9708       IPRT=IPRTZ
   9709       NOBPS=NOBPS+1
   9710       NRAPS=MIN(1+INT(IHOWFR/DRPSM),NBINPS)
   9711       NPSBIN(NRAPS,NCOMPS)=NPSBIN(NRAPS,NCOMPS)+1
   9712       IF(NPSBIN(NRAPS,NCOMPS).GT. NDATMX)  THEN 
   9713          print *, 'NDATMX limit (',NDATMX,') exceeded - ',
   9714      $    'NPSBIN(NRAPS,NCOMPS)=',NPSBIN(NRAPS,NCOMPS),', return'
   9715          return
   9716       endif
   9717       PSBIN(NRAPS,NCOMPS)=PSBIN(NRAPS,NCOMPS)+DATA(3)
   9718       PSDAT(1,NPSBIN(NRAPS,NCOMPS),NRAPS)=RLAT
   9719       PSDAT(2,NPSBIN(NRAPS,NCOMPS),NRAPS)=RLON
   9720       PSDAT(3,NPSBIN(NRAPS,NCOMPS),NRAPS)=REAL(IHOWFR)
   9721       PSDAT(4,NPSBIN(NRAPS,NCOMPS),NRAPS)=ANGLE
   9722       PSDAT(5,NPSBIN(NRAPS,NCOMPS),NRAPS)=REAL(IRTYP)
   9723       PSDAT(6,NPSBIN(NRAPS,NCOMPS),NRAPS)=DATA(3)
   9724 C
   9725 C     PICK UP CLOSEST SURFACE PRESSURE OBSERVATION TO
   9726 C       THE STORM CENTER AND ANGLE
   9727 C
   9728       IF(REAL(IHOWFR) .LT. HOWFMN)  THEN
   9729       HOWFMN=REAL(IHOWFR)
   9730       ANGLMN=ANGLE
   9731       PSCLOS=DATA(3)
   9732       ENDIF
   9733 C
   9734       IF(IPRT .GT. 0) WRITE(6,191) RLAT,RLON,IRTYP,REAL(IHOWFR),DATA(3),

Page 266         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9735      1                 NRAPS,NBINPS,DRPSM,NPSBIN(NRAPS,NCOMPS),
   9736      2                 PSBIN(NRAPS,NCOMPS)
   9737   191 FORMAT('....COMPOSITING PSFC, RLAT,RLON,IRTYP,IHOWFR(KM),',
   9738      1       'DATA(3),NRAPS,NBINPS,DRPSM(KM),NPSBIN(NRAPS,NCOMPS),',
   9739      2       'PSBIN=',/,7X,2F9.2,I5,-3PF10.3,0P,F9.3,2I5,-3PF8.2,I5,
   9740      3       0P,F14.2)
   9741 C
   9742       RETURN
   9743 C
   9744 
   9745 C-----------------------------------------------------------------------
   9746 
   9747       ENTRY VPSCOM(AXIPS,AXIRAD,NRDSTR,NRADVO)
   9748 C
   9749       NCOMPS=2
   9750 C     NRMXPS=-1
   9751 C     NRMXWN=-1
   9752 c && 6 comments
   9753 CC    WRITE(6,201) (AXIPS(NRA),NRA=1,NRADVO)
   9754 CC201 FORMAT(/'...ENTERING VPSCOM WITH SURFACE PRESSURE=',/,
   9755 CC   1       (5X,10F10.2))
   9756 CC    WRITE(6,203) (AXIRAD(NRA),NRA=1,NRADVO)
   9757 CC203 FORMAT(/'...ENTERING VPSCOM WITH RADII=',/,
   9758 CC   1       (5X,10F10.2))
   9759 C
   9760       DO 230 NRADV=1,NRADVO
   9761 C
   9762       NRAPS=MIN(1+IFIX(AXIRAD(NRADV)/DRPSM),NBINPS)
   9763 C     NRMXPS=MAX(NRAPS,NRMXPS)
   9764       NPSBIN(NRAPS,NCOMPS)=NPSBIN(NRAPS,NCOMPS)+1
   9765       PSBIN (NRAPS,NCOMPS)=PSBIN (NRAPS,NCOMPS)+AXIPS(NRADV)
   9766 C
   9767 C     SET RADIAL BIN INDICES FOR WINDS ONCE AND FOR ALL
   9768 C
   9769       IF(EQLDR)  THEN
   9770       NRA=IFIX((AXIRAD(NRADV)-EPSRD)/DELTAR)+1
   9771         IF(NRA .GT. NRADBN)  THEN
   9772         WRITE(6,207) AXIRAD(NRADV),DELTAR,NRA,NRADBN
   9773   207   FORMAT('******NRA EXCEEDS LIMITS FOR COMPOSITING VORTEX, ',
   9774      1         'AXIRAD,DELTAR,NRD=',2F13.2,2I7,/,10X,
   9775      2         'VORTEX DATA WILL NOT BE PROCESSED')
   9776         RETURN
   9777         ENDIF
   9778       ELSE
   9779       DO 210 NRAZ=1,NRBIN
   9780       NRA=NRAZ
   9781       IF(AXIRAD(NRADV) .LE. RBIN(NRAZ))  GO TO 220
   9782   210 CONTINUE
   9783       WRITE(6,211) NRA,IHOWFR,RBIN(NRA)
   9784   211 FORMAT('******EXCEEDED FORMAL SETUP OF RADIAL BINS, NRA,',
   9785      1       'IHOWFR,RBIN(NRA)=',I5,I12,F12.3)
   9786       NRA=MIN(NRBIN+1,NRADBN)
   9787       WRITE(6,212) NRA,NRADBN
   9788   212 FORMAT('...THE FIX IS TO PLACE OBS IN BIN=',I5,' WHERE',
   9789      1       ' MAXIMUM BIN=',I5)
   9790 C
   9791       ENDIF

Page 267         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9792 C
   9793   220 NRDSTR(NRADV)=NRA
   9794 C     NRMXWN=MAX(NRA,NRMXWN)
   9795 C
   9796       IF(IPRT .GT. 0)  WRITE(6,229) NRADV,NRAPS,NPSBIN(NRAPS,NCOMPS),
   9797      1                 AXIRAD(NRADV),AXIPS(NRADV),RPSBIN(NRAPS),
   9798      2                 NRA,NRDSTR(NRADV)
   9799   229 FORMAT('...COMPOSITING VORTEX PSFC: NRADV,NRAPS,NPSBIN,AXIRAD,',
   9800      1       'AXIPS,RPSBIN,NRA,NRDSTR(NRADV)=',/,10X,3I5,3F10.2,2I5)
   9801   230 CONTINUE
   9802       RETURN
   9803 C
   9804 
   9805 C-----------------------------------------------------------------------
   9806 
   9807       ENTRY VWNCOM(NRADVO,NCMPVO,PRESVO,AXIWND,nrdstr)
   9808 C
   9809 c && 6 comments
   9810 CC    WRITE(6,301) NRADVO,NCMPVO,PRESVO
   9811 CC301 FORMAT(/'...ENTERING VWNCOM WITH NRADVO,NCMPVO,PRESVO=',2I5,F9.1)
   9812 CC    DO NC=1,NCMPVO
   9813 CC    WRITE(6,303) NC,(AXIWND(NR,NC),NR=1,NRADVO)
   9814 CC303 FORMAT(/'...NC,AXIWND=',I3,(15F7.1,/))
   9815 CC    ENDDO
   9816 C
   9817       DO 310 NLBZ=1,NLBIN
   9818          NLB=NLBZ
   9819          IF(NINT(PRESVO*10.) .LT. NINT(PBIN(NLBZ)*10.) .AND.
   9820      $      NINT(PRESVO*10.) .GE. NINT(PBIN(NLBZ+1)*10.))  GO TO 320
   9821   310 CONTINUE
   9822       WRITE(6,311) NLB,PRESVO,PBIN(NLB)
   9823   311 FORMAT('******EXCEEDED FORMAL SETUP OF VERTICAL BINS, NLB,',
   9824      1       'PRESVO,PBIN(NLB)=',I5,2F12.3)
   9825       NLB=MIN(NLBIN1+1,NLVLBN)
   9826       WRITE(6,313) NLB,NLVLBN
   9827   313 FORMAT('...THE FIX IS TO PLACE OBS IN BIN=',I5,' WHERE',
   9828      1       ' MAXIMUM BIN=',I5)
   9829 C
   9830   320 CONTINUE
   9831       IF(IPRT .GT. 0)  WRITE(6,321) NLB,PBIN(NLB),PBIN(NLB+1)
   9832   321 FORMAT(/'...COMPOSITING VORTEX WIND: PRESSURE, NLB,PBIN(NLB),',
   9833      1       'PBIN(NLB+1)=',I5,2F10.2)
   9834 C
   9835 C     ****  SET UP FOR COMPOSITING TANGENTIAL WIND ONLY  ****
   9836 C     ****  IMPORTANT NOTE: WE DO NOT COMPOSITE THE CENTRAL WIND
   9837 C                           (INDEX=1) SINCE IT IS IDENTICALLY ZERO
   9838 C
   9839       DO 350 NRADV=2,NRADVO
   9840          NCOM=NRDSTR(NRADV)
   9841          AZIAVW(NCOM,1,NLB,2)=AZIAVW(NCOM,1,NLB,2)+AXIWND(NRADV,1)
   9842 cdak  fix 9/5/14 vvvvvvvvvv
   9843 c---------------------------------------------------------------------
   9844 c changes here to prevent array overflow in 2nd element of AXIWND when
   9845 c  this entry is called out of subroutine MM2DVO where NCMPVO is passed
   9846 c  in with value of 1 and debugging is turned on at run time
   9847 c (Note: may not be correct solution but yields same output bogus winds
   9848 c        as when this change is not made and code runs w/o debugging

Page 268         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9849 c        turned on at run time  --> this fix allows code to run to
   9850 c        completion when debugging is turned on at run time)
   9851 c---------------------------------------------------------------------
   9852 cccccc   AZIAVW(NCOM,2,NLB,2)=AZIAVW(NCOM,2,NLB,2)+AXIWND(NRADV,2)
   9853 cccccc   AZIAVW(NCOM,3,NLB,2)=AZIAVW(NCOM,3,NLB,2)+
   9854 ccccc1                       SQRT(AXIWND(NRADV,1)**2+AXIWND(NRADV,2)**2)
   9855          if(NCMPVO.gt.1) then
   9856             AZIAVW(NCOM,2,NLB,2)=AZIAVW(NCOM,2,NLB,2)+AXIWND(NRADV,2)
   9857             AZIAVW(NCOM,3,NLB,2)=AZIAVW(NCOM,3,NLB,2)+
   9858      1                      SQRT(AXIWND(NRADV,1)**2+AXIWND(NRADV,2)**2)
   9859          endif
   9860          NAZIAV(NCOM,NLB,2)=NAZIAV(NCOM,NLB,2)+1
   9861          IF(IPRT .GT. 0)  THEN
   9862 ccccc       WRITE(6,349) NRADV,NCOM,AXIWND(NRADV,1),AXIWND(NRADV,2)
   9863             if(NCMPVO.gt.1) then
   9864                WRITE(6,349) NRADV,NCOM,AXIWND(NRADV,1),AXIWND(NRADV,2)
   9865             else
   9866                WRITE(6,349) NRADV,NCOM,AXIWND(NRADV,1)
   9867             endif
   9868 cdak  fix 9/5/14 ^^^^^^^^^^
   9869          ENDIF
   9870   349 FORMAT('...COMPOSITING AXISYMMETRIC WIND, NRADV,NCOM,AXIWND=',
   9871      1       2I5,2F10.2)
   9872   350 CONTINUE
   9873 C
   9874       RETURN
   9875 C
   9876 
   9877 C-----------------------------------------------------------------------
   9878 
   9879       ENTRY ANLCOM(RPOT,SPDPOT,NOBWMN,IUNTDH,ONLYWI,ONLYPS)
   9880 C
   9881       SPDPOT=-99.0
   9882       IF(.NOT. ONLYWI)  GO TO 500
   9883 C
   9884       DO NCOR=1,NCORBN
   9885       IF(NCOR .EQ. 1)  WRITE(6,404)
   9886       IF(NCOR .EQ. 2)  WRITE(6,406)
   9887   404 FORMAT(////33X,'**** WIND COMPOSITE: EARTH COORDINATES ****')
   9888   406 FORMAT(////32X,'**** WIND COMPOSITE: STORM RELATIVE COORDINATES ',
   9889      1       '****')
   9890 C
   9891       NAZIAV(1:NRBIN,1:NLBIN,1)=0
   9892       AZIAVW(1:NRBIN,:,1:NLBIN,1)=0.0
   9893 C
   9894       DO  NL=1,NLBIN
   9895       NL1=NL+1
   9896       IF(NINT(PTOP*10.) .GE. NINT(PBIN(NL)*10.))  GO TO 450
   9897       WRITE(6,413) NL,PBIN(NL),PBIN(NL1)
   9898   413 FORMAT(//21X,'*****   NL=',I3,' LAYER BOUNDED BY PRESSURES',F10.1,
   9899      1       ' AND',F10.1,3X,'*****')
   9900 C
   9901       DO 440 NA=1,NABIN,2
   9902       NAZ1=OUTMAP(NA)
   9903       NAZ2=OUTMAP(NA+1)
   9904       DO 430 NR=1,NRBIN
   9905       PRNT=.FALSE.

Page 269         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9906 
   9907       OUTPRT=-9999.9
   9908 
   9909       IF(NCOMDT(NR,NAZ1,NL,NCOR,1) .NE. 0) THEN
   9910       PRNT=.TRUE.
   9911 C
   9912       NAZIAV(NR,NL,1)=NAZIAV(NR,NL,1)+NCOMDT(NR,NAZ1,NL,NCOR,1)
   9913       DO 421 NV=1,NVARBN
   9914       AZIAVW(NR,NV,NL,1)=AZIAVW(NR,NV,NL,1)+COMDAT(NR,NAZ1,NL,NCOR,NV)
   9915   421 CONTINUE
   9916 C
   9917       COMDAT(NR,NAZ1,NL,NCOR,1)=COMDAT(NR,NAZ1,NL,NCOR,1)/
   9918      1                          REAL(NCOMDT(NR,NAZ1,NL,NCOR,1))
   9919       COMDAT(NR,NAZ1,NL,NCOR,2)=COMDAT(NR,NAZ1,NL,NCOR,2)/
   9920      1                          REAL(NCOMDT(NR,NAZ1,NL,NCOR,1))
   9921       COMDAT(NR,NAZ1,NL,NCOR,3)=COMDAT(NR,NAZ1,NL,NCOR,3)/
   9922      1                          REAL(NCOMDT(NR,NAZ1,NL,NCOR,1))
   9923       OUTPRT(1)=COMDAT(NR,NAZ1,NL,NCOR,1)
   9924       OUTPRT(2)=COMDAT(NR,NAZ1,NL,NCOR,2)
   9925       OUTPRT(3)=COMDAT(NR,NAZ1,NL,NCOR,3)
   9926       ENDIF
   9927 C
   9928       IF(NCOMDT(NR,NAZ2,NL,NCOR,1) .NE. 0) THEN
   9929       PRNT=.TRUE.
   9930 C
   9931       NAZIAV(NR,NL,1)=NAZIAV(NR,NL,1)+NCOMDT(NR,NAZ2,NL,NCOR,1)
   9932       DO 423 NV=1,NVARBN
   9933       AZIAVW(NR,NV,NL,1)=AZIAVW(NR,NV,NL,1)+COMDAT(NR,NAZ2,NL,NCOR,NV)
   9934   423 CONTINUE
   9935 C
   9936       COMDAT(NR,NAZ2,NL,NCOR,1)=COMDAT(NR,NAZ2,NL,NCOR,1)/
   9937      1                          REAL(NCOMDT(NR,NAZ2,NL,NCOR,1))
   9938       COMDAT(NR,NAZ2,NL,NCOR,2)=COMDAT(NR,NAZ2,NL,NCOR,2)/
   9939      1                          REAL(NCOMDT(NR,NAZ2,NL,NCOR,1))
   9940       COMDAT(NR,NAZ2,NL,NCOR,3)=COMDAT(NR,NAZ2,NL,NCOR,3)/
   9941      1                          REAL(NCOMDT(NR,NAZ2,NL,NCOR,1))
   9942       OUTPRT(4)=COMDAT(NR,NAZ2,NL,NCOR,1)
   9943       OUTPRT(5)=COMDAT(NR,NAZ2,NL,NCOR,2)
   9944       OUTPRT(6)=COMDAT(NR,NAZ2,NL,NCOR,3)
   9945       ENDIF
   9946       IF(NR .EQ. 1)  WRITE(6,425) NAZ1,NAZ2
   9947   425 FORMAT(/26X,'QUADRANT=',I2,18X,'|',19X,'QUADRANT=',I2,25X,'|',
   9948      1 /,8X,'RADIUS(KM)',4X,'VRAD',6X,'VTAN',5X,'SPEED',3X,'#OBS  |',
   9949      2   8X,'RADIUS(KM)',4X,'VRAD',6X,'VTAN',5X,'SPEED',3X,'#OBS  |')
   9950       IF(PRNT)  WRITE(6,427) NR,RBIN(NR),OUTPRT(1),OUTPRT(2),OUTPRT(3),
   9951      1                       NCOMDT(NR,NAZ1,NL,NCOR,1),
   9952      2                       NR,RBIN(NR),OUTPRT(4),OUTPRT(5),OUTPRT(6),
   9953      3                       NCOMDT(NR,NAZ2,NL,NCOR,1)
   9954   427 FORMAT(4X,I5,-3P,F7.1,0P,3F10.2,3X,I4,'  |',
   9955      1       4X,I5,-3P,F7.1,0P,3F10.2,3X,I4,'  |')
   9956   430 CONTINUE
   9957       WRITE(6,437)
   9958   437 FORMAT(/7X,'________________________________________________|'
   9959      1      ,'_______________________________________________________|')
   9960   440 CONTINUE
   9961 C
   9962       DO 448 NR=1,NRBIN

Page 270         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

   9963 C
   9964       IF(NAZIAV(NR,NL,1) .GT. 0)  THEN
   9965       DO 443 NV=1,NVARBN
   9966       AZIAVW(NR,NV,NL,1)=AZIAVW(NR,NV,NL,1)/REAL(NAZIAV(NR,NL,1))
   9967   443 CONTINUE
   9968 C
   9969 C     CALCULATE STANDARD DEVIATIONS
   9970 C
   9971       INDZ=8
   9972       NSMX=NSTOR(NR,NL)
   9973         IF(NSMX .GE. 2)  THEN
   9974 
   9975         STDZ(1:NSMX)=RADDAT(INDZ,1:NSMX,NR,NL)
   9976 
   9977         CALL STDEV(STDZ,NSMX,NSMX-1,AZIAVW(NR,3,NL,1),STDAZW(NR,3,NL))
   9978 c && 3 comments
   9979 CC      WRITE(6,4445) NR,NL,NSMX,AZIAVW(NR,3,NL,1),STDAZW(NR,3,NL)
   9980 C4445   FORMAT(/'...CALCULATING STANDARD DEVIATION, NR,NL,NSMX,AVG,',
   9981 CC   1         'STDEV=',/,6X,3I5,2F10.2)
   9982 C
   9983         ELSE
   9984         STDAZW(NR,3,NL)=-9999.9
   9985         ENDIF
   9986       ELSE
   9987       STDAZW(NR,3,NL)=-9999.9
   9988       AZIAVW(NR,:,NL,1)=-9999.9
   9989 C
   9990       ENDIF
   9991   448 CONTINUE
   9992 C
   9993 C       EXTRACT THE OBSERVED AZIMUTHALLY AVERAGED LOWEST LEVEL WIND
   9994 C         IF THERE ARE SUFFICIENT OBSERVATIONS
   9995 C
   9996       IF(NL .EQ. 1)  THEN
   9997       IF(NAZIAV(NRBRPT  ,NL,1) .GE. NOBWMN .AND.
   9998      1   NAZIAV(NRBRPT+1,NL,1) .GE. NOBWMN)  THEN
   9999       SPDPOT=AZIAVW(NRBRPT,3,NL,1)+(AZIAVW(NRBRPT+1,3,NL,1)-
  10000      1       AZIAVW(NRBRPT,3,NL,1))*(RPOTM-RBIN(NRBRPT))/
  10001      2       (RBIN(NRBRPT+1)-RBIN(NRBRPT))
  10002       ENDIF
  10003       ENDIF
  10004 C
  10005   450 CONTINUE
  10006       ENDDO
  10007       ENDDO
  10008 C
  10009       WRITE(6,451)
  10010   451 FORMAT(////30X,'**** LISTING OF WIND OBSERVATIONS FOLLOWS ****'/)
  10011       WRITE(IUNTDH,453) NOBWND
  10012   453 FORMAT(' WIND...NUMBER OF OBSERVATIONS=',
  10013      1       I5,/,5X,'LAT',6X,'LONG',3X,'PRESR',2X,'TYPE',3X,'UWIND',
  10014      2       2X,'VWIND',2X,'DIRCTN',3X,'SPD',3X,'VRAD',2X,'VTAN',
  10015      3       3X,'ANGLE',4X,'SPD',3X,'VRAD',3X,'VTAN',2X,'ANGLE',
  10016      4       3X,'DIST',/,64X,2('(E)',4X),'(E)',3X,3('(STR)',2X),'(STR)',
  10017      5       3X,'(KM)')
  10018       DO 480 NL=1,NLBIN
  10019       NL1=NL+1

Page 271         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10020       IF(NINT(PTOP*10.) .GE. NINT(PBIN(NL)*10.))  GO TO 480
  10021       IF(NL .NE. 1)  THEN
  10022          print *, ' '
  10023          print *, ' '
  10024       ENDIF
  10025       WRITE(6,455) NL,PBIN(NL),PBIN(NL1)
  10026   455 FORMAT(//10X,'*****   NL=',I3,' LAYER BOUNDED BY PRESSURES',F10.1,
  10027      1       ' AND',F10.1,3X,'*****')
  10028       DO 460 NRA=1,NRBIN
  10029       IF(NSTOR(NRA,NL) .GT. 0)  THEN
  10030       WRITE(6,457) RBIN(NRA),NSTOR(NRA,NL)
  10031   457 FORMAT(///10X,'R <',-3PF7.1,' KM   ...NUMBER OF OBSERVATIONS=',
  10032      1       I5,/,12X,'LAT',6X,'LONG',3X,'PRESR',2X,'TYPE',3X,'UWIND',
  10033      2       2X,'VWIND',2X,'DIRCTN',3X,'SPD',3X,'VRAD',2X,'VTAN',
  10034      3       3X,'ANGLE',4X,'SPD',3X,'VRAD',3X,'VTAN',2X,'ANGLE',
  10035      4       3X,'DIST',/,72X,2('(E)',4X),'(E)',3X,3('(STR)',2X),'(STR)',
  10036      5       3X,'(KM)')
  10037 C
  10038       WRITE(6,458)  ((RADDAT(NVOUT,NCOM,NRA,NL),NVOUT=1,NVROUT),
  10039      1                NCOM=1,NSTOR(NRA,NL))
  10040   458 FORMAT(5X,'...',F8.3,F9.3,13F7.1,-3P,F8.1,0P)
  10041       WRITE(IUNTDH,459)  ((RADDAT(NVOUT,NCOM,NRA,NL),NVOUT=1,NVROUT),
  10042      1                     NCOM=1,NSTOR(NRA,NL))
  10043   459 FORMAT(1X,F8.3,F9.3,13F7.1,-3P,F8.1,0P)
  10044       ENDIF
  10045   460 CONTINUE
  10046   480 CONTINUE
  10047 C
  10048   500 IF(.NOT. ONLYPS)  RETURN
  10049 C
  10050       DO 550 NRPS=1,NBINPS
  10051       PSCOM(NRPS,1)=-9999.9
  10052       IF(NPSBIN(NRPS,1) .GT. 0)  PSCOM(NRPS,1)=PSBIN(NRPS,1)/
  10053      1                                         REAL(NPSBIN(NRPS,1))
  10054 C
  10055 C     CALCULATE STANDARD DEVIATIONS
  10056 C
  10057       NSMX=NPSBIN(NRPS,1)
  10058       INDZ=6
  10059       INDR=3
  10060       LDXX=0
  10061       YNT=-99.0
  10062 C
  10063       IF(NSMX .GE. 2)  THEN
  10064         DO 544 NS=1,NSMX
  10065         if(ns.GT. NDATMX)  THEN 
  10066            print *, 'NDATMX limit (',NDATMX,') exceeded - NS=',NS,
  10067      $      ', return'
  10068            return
  10069         endif
  10070         
  10071         STDZ(NS)=PSDAT(INDZ,NS,NRPS)
  10072   544   CONTINUE
  10073         CALL STDEV(STDZ,NSMX,NSMX-1,PSCOM(NRPS,1),STDAZP(NRPS))
  10074 c && 3 comments
  10075 CC      WRITE(6,5445) NRPS,NSMX,PSCOM(NRPS,1),STDAZP(NRPS)
  10076 C5445   FORMAT(/'...CALCULATING STANDARD DEVIATION, NR,NSMX,AVG,',

Page 272         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10077 CC   1         'STDEV=',/,6X,2I5,2F10.2)
  10078       ELSE
  10079         STDAZP(NRPS)=-9999.9
  10080       ENDIF
  10081   550 CONTINUE
  10082 C
  10083       WRITE(6,551)
  10084   551 FORMAT(////30X,'****  LISTING OF SURFACE PRESSURE OBSERVATIONS ',
  10085      1       'FOLLOWS  ****'/)
  10086       WRITE(IUNTDH,552) NOBPS
  10087   552 FORMAT(' PSFC...NUMBER OF OBSERVATIONS=',
  10088      1       I5,/,5X,'LAT',7X,'LONG',5X,'DIST.',4X,'ANGLE',5X,
  10089      2       'TYPE',4X,'PRESR')
  10090       DO 570 NRPS=1,NBINPS
  10091 C 
  10092       if(NPSBIN(NRPS,1) .GT. NDATMX)  THEN
  10093          print *, 'NDATMX limit (',NDATMX,') exceeded - ',
  10094      $    'NPSBIN(NRPS,1)=',NPSBIN(NRPS,1),', return'
  10095          return
  10096       endif
  10097 
  10098       IF(NPSBIN(NRPS,1) .NE. 0)  THEN
  10099       WRITE(6,553) RPSBIN(NRPS),NPSBIN(NRPS,1)
  10100   553 FORMAT(///30X,'R <',-3PF7.1,' KM   ...NUMBER OF OBSERVATIONS=',
  10101      1       I5,/,38X,'LAT',7X,'LONG',5X,'DIST.',4X,'ANGLE',5X,
  10102      2       'TYPE',4X,'PRESR')
  10103       WRITE(6,557)  ((PSDAT(NVR,NPS,NRPS),NVR=1,NVRPS),
  10104      1                NPS=1,NPSBIN(NRPS,1))
  10105   557 FORMAT(30X,'...',F8.3,3X,F8.3,2X,-3P,F7.1,2X,0P,F7.1,
  10106      1       2X,F7.0,F10.2//)
  10107       WRITE(IUNTDH,558)  ((PSDAT(NVR,NPS,NRPS),NVR=1,NVRPS),
  10108      1                     NPS=1,NPSBIN(NRPS,1))
  10109   558 FORMAT(F8.3,3X,F8.3,2X,-3P,F7.1,2X,0P,F7.1,2X,F7.0,F10.2)
  10110       ENDIF
  10111 C
  10112 C     STORE OBS FOR SPLINE FITTING
  10113 C
  10114       NMSNG=0
  10115       DO 560 NSPL=1,NPSBIN(NRPS,1)
  10116          IF(LDXX+1 .LE. LDXDIM .and.
  10117      $    nspl.le. ndatmx)  then
  10118             LDXX=LDXX+1
  10119             SPLDTA(LDXX)=PSDAT(INDZ,NSPL,NRPS)
  10120             YDZ(LDXX)=PSDAT(INDR,NSPL,NRPS)*1.E-3
  10121             WDZ(LDXX)=1.0
  10122             YNT=MAX(YNT,YDZ(LDXX))
  10123          ELSE
  10124             NMSNG=NMSNG+1
  10125             WRITE(6,559) LDXDIM,ldxx,NDATMX,nspl,NMSNG
  10126   559 FORMAT(/'######STORAGE LIMIT EXCEEDED FOR SPLINE FITTING,',
  10127      1       ' LDXDIM=',I5,'; LDXX=',i5,'; NDATMX=',i5,'; NSPL =',i5,
  10128      2       '; NONPRINTED OBS=',I5)
  10129          ENDIF
  10130   560 CONTINUE
  10131   570 CONTINUE
  10132 C
  10133       RETURN

Page 273         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10134 C
  10135 
  10136 C-----------------------------------------------------------------------
  10137 
  10138       ENTRY ANLVOR(ONLYWI,ONLYPS)
  10139 C
  10140       DO 620 NRPS=1,NBINPS
  10141       PSCOM(NRPS,2)=-9999.9
  10142       IF(NPSBIN(NRPS,2) .GT. 0)  PSCOM(NRPS,2)=PSBIN(NRPS,2)/
  10143      1                                         REAL(NPSBIN(NRPS,2))
  10144   620 CONTINUE
  10145 C
  10146       DO 680 NL=1,NLBIN
  10147 C
  10148       NL1=NL+1
  10149       IF(NINT(PTOP*10.) .GE. NINT(PBIN(NL)*10.))  GO TO 680
  10150 C
  10151       DO 670 NR=1,NRBIN
  10152 C
  10153       IF(NAZIAV(NR,NL,2) .GT. 0)  THEN
  10154       DO 650 NV=1,NVARBN
  10155       AZIAVW(NR,NV,NL,2)=AZIAVW(NR,NV,NL,2)/REAL(NAZIAV(NR,NL,2))
  10156   650 CONTINUE
  10157 C
  10158       ELSE
  10159 
  10160       AZIAVW(NR,:,NL,2)=-9999.9
  10161 C
  10162       ENDIF
  10163   670 CONTINUE
  10164   680 CONTINUE
  10165 C
  10166       RETURN
  10167 C
  10168 
  10169 C-----------------------------------------------------------------------
  10170 
  10171       ENTRY FITOBS(IUNTBH,RMAX,PCEN,PENV,ONLYWI,ONLYPS,STMLTZ,STMLNZ,
  10172      1             IDATEZ,IUTCZ,STMNMZ)
  10173 C
  10174       WRITE(6,801) STMNMZ,RMAX,PCEN,PENV
  10175   801 FORMAT(///'...ENTERING FITOBS FOR ',A,' WITH RMAX(KM),PCEN,PENV=',
  10176      1       F9.2,2F10.2)
  10177       IF(ONLYPS)  THEN
  10178 C
  10179 C     SPLINE-FIT OBSERVATIONS IF THERE ARE ANY
  10180 C
  10181 C     INITIALIZE SPLFIT
  10182 C
  10183       SPLFIT=-9999.9
  10184 C
  10185       IF(LDXX .GT. 0)  THEN
  10186 C
  10187 C     IF THERE ARE NO SURFACE PRESSURE POINTS WITHIN RMAX,
  10188 C       ADD ONE AT THE CENTER WITH A SMALL COMPARATIVE
  10189 C       WEIGHT TO KEEP THE SPLINE FIT SOMEWHAT WELL BEHAVED
  10190 C

Page 274         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10191       RCRIT=HUNDKM
  10192       IF(HOWFMN .GT. RCRIT)  THEN
  10193       LDXX=LDXX+1
  10194       if(LDXX .GT. LDXDIM)  THEN
  10195          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  10196      $    'LDXX=',LDXX,', return'
  10197          return
  10198       endif
  10199       YDZ(LDXX)=0.0
  10200       WDZ(LDXX)=0.1
  10201       SPLDTA(LDXX)=PCEN
  10202       WRITE(6,811) RCRIT,PCEN,PSCLOS,HOWFMN,RMAXM
  10203   811 FORMAT(/'...DUE TO LACK OF OBSERVATIONS INSIDE RCRIT=',-3PF8.2,
  10204      1       ' KM, WE ARE ADDING CENTRAL SFC. PRESSURE.',/,4X,
  10205      2       'ADDED PRESSURE IS',0P,F8.2,' AT CENTER.',/,4X,
  10206      3       'CLOSEST OBSERVATION IS ',F8.2,' MB AT ',-3PF8.2,
  10207      4       ' KM, WHILE RMAX IS',-3PF8.2,' KM.')
  10208       ENDIF
  10209 C
  10210       IF(HOWFMN .GT. RMAXM)  THEN
  10211       LDXX=LDXX+1
  10212       if(LDXX .GT. LDXDIM)  THEN
  10213          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  10214      $    'LDXX=',LDXX,', return'
  10215          return
  10216       endif
  10217       YDZ(LDXX)=RMAX
  10218       WDZ(LDXX)=0.1
  10219       SPLDTA(LDXX)=PENV
  10220       WRITE(6,813) RMAXM,PENV,PSCLOS,HOWFMN
  10221   813 FORMAT(/'...DUE TO LACK OF OBSERVATIONS INSIDE RMAX=',-3PF8.2,
  10222      1       ' KM, WE ARE ADDING CENTRAL ENVIRONMENTAL ',
  10223      2       'PRESSURE.',/,4X,'ADDED PRESSURE IS ',0P,F8.2,
  10224      3       ' AT RMAX.',/,4X,'CLOSEST OBSERVATION IS ',F8.2,
  10225      4       ' MB AT ',-3PF8.2,' KM.')
  10226       ENDIF
  10227 C
  10228       IVARZ=1
  10229       YNB=0.0
  10230       IYNT=IFIX(YNT/DELRPS)
  10231       YNT=REAL(IYNT+1)*DELRPS
  10232       NX=MIN(IYNT+1,NDIM)
  10233       KYBC1=2
  10234       KYBC2=2
  10235       YBCWL1=3.0
  10236       YBCWL2=3.0
  10237 C
  10238       ITERPS=0
  10239       YDCWL=REAL(NINT(RMAX*0.5/DELRPS))
  10240       YDCWMX=REAL(NX/2)
  10241 C
  10242 C     ITERATE FILTER WAVELENGTH TO PRODUCE AN (ALMOST) INCREASING
  10243 C       FUNCTION WITH RADIUS
  10244 C
  10245   820 CONTINUE
  10246       ITERPS=ITERPS+1
  10247       WRITE(6,823) ITERPS,NX,YNB,YNT,YDCWL

Page 275         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10248   823 FORMAT(/'...CALLING XSPLCM WITH ITERPS,NX,YNB,YNT,YDCWL=',
  10249      1       2I5,2F10.2,F7.1)
  10250 C
  10251 C     SPLINE FITTING WITH DERIVATIVE CONSTRAINT.  INPUT PARAMETERS ARE:
  10252 C       NX - NUMBER OF NODAL INTERVALS. NODES ARE SET UP TO CORRESPOND
  10253 C            TO COMPOSITING BINS FOR THE VARIABLE BEING FITTED, EXCEPT
  10254 C            THAT THE FIRST BIN CORRESPONDS TO RADIUS = 0.
  10255 C       YNB - CENTER, AT RADIUS=0
  10256 C       YNT - MAXIMUM RADIUS (KM)
  10257 C       YDCWL - FILTER WAVELENGTH, UNITS ARE # OF NODAL INTERVALS
  10258 C       KYBC1 - INNER BOUNDARY CONDITION
  10259 C       KYBC2 - OUTER BOUNDARY CONDITION
  10260 C       YBCWL1 - INNER BOUNDARY CONDITION WAVELENGTH
  10261 C       YBCWL2 - OUTER BOUNDARY CONDITION WAVELENGTH
  10262 C       SPLDATA - INPUT DATA, NUMBER=LDXX
  10263 C       YDZ - RADIUS FOR EACH DATUM
  10264 C       WDZ - WEIGHT FOR EACH DATUM
  10265 C       LDXX - NUMBER OF DATA POINTS
  10266 C       SPLFIT - FITTED VALUES AT EACH NODE
  10267 C       SPLNOD - RADIAL DISTANCE (KM) OF EACH NODE
  10268 C       IVARZ - 1 (SURFACE PRESSURE)
  10269 C       STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ - STORM PARAMETERS
  10270 C
  10271       CALL XSPLCM(NX,YNB,YNT,YDCWL,KYBC1,KYBC2,YBCWL1,YBCWL2,SPLDTA,YDZ,
  10272      1            WDZ,LDXX,SPLFIT,SPLNOD,IVARZ,IPLVL,STMLTZ,STMLNZ,
  10273      2            IUTCZ,IDATEZ,STMNMZ)
  10274 C
  10275       WRITE(6,825) (SPLFIT(NN),NN=2,NX+1)
  10276   825 FORMAT(/'...SPLINE FITTED DATA AT EACH COMPOSITE BIN ARE:',/,
  10277      1       (10X,10F12.3))
  10278 C
  10279 C     TEST TO SEE IF FITTED DATA ARE AN INCREASING FUNCTION OF RADIUS
  10280 C
  10281       CALL FUNINC(NX+1,SPLNOD,SPLFIT,MIN((RPSBIN(NPSRMX)+HUNDKM)*1.E-3,
  10282      1            RPSBIN(NBINPS)*1.E-3),EPSPS,NXYUP,YUP)
  10283 C
  10284 C     SOME PRINTOUT
  10285 C
  10286       IF(.NOT. YUP)  THEN
  10287         WRITE(6,827) ITERPS,EPSPS,NXYUP,RPSBIN(NXYUP-1)
  10288   827   FORMAT(/'...ITERATING 1-D FILTER, ITER. #',I3,', SPLINE FIT ',
  10289      1       'NOT MONOTONICALLY INCREASING. IT DECREASES MORE ',
  10290      2       'THAN',F5.1,' MB.',/,4X,'SPLINE FIT INDEX WHERE FIT ',
  10291      3       'DECREASES IS',I3,', WHICH IS AT COMPOSITE RADIUS=',
  10292      4       -3PF8.1,' KM.')
  10293 C
  10294       ELSE
  10295         WRITE(6,829) ITERPS,RPSBIN(NXYUP-1),EPSPS
  10296   829   FORMAT(/'...SUCESSFULLY FINISHED ITERATING 1-D FILTER, ITER.',
  10297      1         '#',I3,/,' ...SPLINE FIT IS MONOTONICALLY INCREASING ',
  10298      2         'OUT TO',-3PF8.1,' KM WITH A TOLERANCE OF',0PF5.1,' MB.')
  10299       ENDIF
  10300 C
  10301 C     ITERATE WITH LARGER WAVELENGTH FILTERS IF FUNCTION DOES NOT
  10302 C       INCREASE
  10303 C
  10304       IF(.NOT. YUP .AND. ITERPS .LT. ITMXPS)  THEN

Page 276         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10305         IF(YDCWL .EQ. YDCWMX)  THEN
  10306         YDCLKM=YDCWL*DELRPS
  10307         WRITE(6,831) YDCWMX,ITERPS,ITMXPS,EPSPS,YDCLKM
  10308   831   FORMAT(/'######WE ARE AT MAX. ALLOWED FILTER WAVELENGTH FOR ',
  10309      1         'SPLINE FITTING SURFACE PRESSURE.',/,7X,'YDCWMX,',
  10310      2         'ITERPS,ITMXPS,EPSPS,YDCLKM=',F7.1,2I5,F6.1,F8.1,' KM')
  10311         GO TO 840
  10312         ENDIF
  10313 C
  10314       YDCWL=YDCWL+1.
  10315       GO TO 820
  10316 C
  10317       ELSE IF(.NOT. YUP .AND. ITERPS .EQ. ITMXPS)  THEN
  10318       YDCLKM=YDCWL*DELRPS
  10319       WRITE(6,833) ITERPS,YDCLKM
  10320   833 FORMAT(/'######WE ARE AT MAXIMUM ALLOWED ITERATIONS FOR ',
  10321      1       'SPLINE FITTING SURFACE PRESSURE.',/,7X,
  10322      2       'ITERPS,YDCLKM=',I5,F8.1,' KM')
  10323 C
  10324       ENDIF
  10325 C
  10326   840 CONTINUE
  10327       WRITE(6,857) STMNMZ,RMAX,PENV,SPLFIT(NPSRM1),NPSRMX
  10328       WRITE(IUNTBH,857) STMNMZ,RMAX,PENV,SPLFIT(NPSRM1),NPSRMX
  10329   857 FORMAT(/'...COMPARING FOR STORM ',A,': PENV WITH COMPOSITED ',
  10330      1       'PSFC AT R=RMAX=',F8.2,' KM.',/,4X,'PENV=',F10.2,' AND ',
  10331      2       'THE 1-D FILTERED PSFC=',F10.2,' AT THE COMPOSITING ',
  10332      3       'INDEX=',I3)
  10333 C
  10334       WRITE(6,858) PCEN,PSCLOS,HOWFMN,ANGLMN
  10335       WRITE(IUNTBH,858) PCEN,PSCLOS,HOWFMN,ANGLMN
  10336   858 FORMAT(/'...COMPARING PARAMETER PCEN WITH MINIMUM OBS. PSFC:',
  10337      1       /,4X,'PCEN=',F10.2,', WHEREAS THE CLOSEST PSFC=',F8.2,
  10338      2       ' IS AT A DISTANCE OF',-3PF9.2,' KM AND AN ANGLE OF',
  10339      3       0P,F7.1,'.')
  10340       WRITE(6,859) SPLFIT(1)
  10341       WRITE(IUNTBH,859) SPLFIT(1)
  10342   859 FORMAT('...THE 1-D FITTED CENTRAL PRESSURE=',F8.2)
  10343 C
  10344 C     THERE ARE NO OBSERVATIONS TO COMPARE WITHIN THE COMPOSITING
  10345 C       DOMAIN, SO THE 1-D FITTING WILL NOT BE CALLED HERE.  HOWEVER,
  10346 C       IT WILL BE CALLED TO FILTER THE VORTEX SURFACE PRESSURE.
  10347 C
  10348       ELSE
  10349       WRITE(6,861)
  10350       WRITE(IUNTBH,861)
  10351   861 FORMAT(/'...THERE ARE NO OBSERVATIONS TO COMPARE TO WITHIN ',
  10352      1       'THE COMPOSITING DOMAIN.  THE VORTEX STANDS.')
  10353       ENDIF
  10354 C
  10355       WRITE(6,871)
  10356       WRITE(IUNTBH,871)
  10357   871 FORMAT(////3X,'**** OBSERVED SURFACE PRESSURE COMPOSITE ',
  10358      1       '****',13X,'**** VORTEX SURFACE PRESSURE COMPOSITE ****',
  10359      2       //,9X,'BIN',2X,'RADIUS',5X,'PSFC',5X,'SPLFIT',4X,'STDEV',
  10360      3       3X,'# OBS',T69,3X,'PSFC',3X,'# COMVAL',3X,'RADIUS(KM)')
  10361       DO 880 NRPS=1,NBINPS

Page 277         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10362       WRITE(6,877) NRPS,RPSBIN(NRPS),PSCOM(NRPS,1),SPLFIT(NRPS+1),
  10363      1             STDAZP(NRPS),NPSBIN(NRPS,1),PSCOM(NRPS,2),
  10364      2             NPSBIN(NRPS,2),RPSBIN(NRPS)
  10365       WRITE(IUNTBH,877) NRPS,RPSBIN(NRPS),PSCOM(NRPS,1),SPLFIT(NRPS+1),
  10366      1                  STDAZP(NRPS),NPSBIN(NRPS,1),PSCOM(NRPS,2),
  10367      2                  NPSBIN(NRPS,2),RPSBIN(NRPS)
  10368   877 FORMAT(2X,'... ',I4,1X,-3P,F7.1,2X,0P,F9.2,1X,F9.2,1X,F9.2,
  10369      1          2X,I4,T62,'... ',3X,0P,F9.2,3X,I4,5X,-3P,F7.1)
  10370   880 CONTINUE
  10371 C
  10372       ENDIF
  10373 C
  10374       IF(ONLYWI)  THEN
  10375 C
  10376 C     AZIMUTHAL WIND AVERAGES FOR EACH LAYER: OBSERVED AND VORTEX
  10377 C
  10378       DO 980 NL=1,NLBIN
  10379 C
  10380       IF(MOD(NL,2) .EQ. 1)  THEN
  10381          print *, ' '
  10382          print *, ' '
  10383       ENDIF
  10384       NL1=NL+1
  10385       IF(NINT(PTOP*10.) .GE. NINT(PBIN(NL)*10.))  GO TO 980
  10386       WRITE(6,455) NL,PBIN(NL),PBIN(NL1)
  10387       WRITE(IUNTBH,455) NL,PBIN(NL),PBIN(NL1)
  10388       WRITE(6,941)
  10389       WRITE(IUNTBH,941)
  10390   941 FORMAT(///5X,'**** OBSERVED AZIMUTHAL AVG. STM. REL. WINDS ****',
  10391      1       T70,'**** SYMMETRIC VORTEX AVERAGES ****',/,
  10392      2       /,6X,'RADIUS(KM)',2X,'# OBS',6X,'VRAD',4X,'VTAN',3X,
  10393      3       'SPEED',3X,'STDEV',5X,'# COMVAL',7X,'VRAD',4X,
  10394      4       'VTAN',3X,'SPEED',5X,'RADIUS(KM)',/)
  10395       DO 950 NR=1,NRBIN
  10396       WRITE(6,943) NR,RBIN(NR),NAZIAV(NR,NL,1),
  10397      1             (AZIAVW(NR,NV,NL,1),NV=1,NVARBN),STDAZW(NR,3,NL),
  10398      2             NAZIAV(NR,NL,2),(AZIAVW(NR,NV,NL,2),NV=1,NVARBN),
  10399      3              RBIN(NR)
  10400       WRITE(IUNTBH,943) NR,RBIN(NR),NAZIAV(NR,NL,1),
  10401      1                 (AZIAVW(NR,NV,NL,1),NV=1,NVARBN),STDAZW(NR,3,NL),
  10402      2                 NAZIAV(NR,NL,2),(AZIAVW(NR,NV,NL,2),NV=1,NVARBN),
  10403      3                 RBIN(NR)
  10404   943 FORMAT('...',I3,2X,-3P,F7.1,3X,I3,3X,0P,4F8.2,
  10405      1       T65,'...',I3,3X,0P,3F8.2,4X,-3P,F7.1)
  10406 C
  10407   950 CONTINUE
  10408 C
  10409   980 CONTINUE
  10410       ENDIF
  10411       RETURN
  10412       END

Page 278         Source Listing                  CMPSIT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 anlcom_               cmpsit_               opscom_               setcom_               vwncom_             
 anlvor_               fitobs_               owncom_               vpscom_                                   


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  9403                                                           9401                              
 101                        Label  9586                                                           9585                              
 107                        Label  9602                                                           9601                              
 110                        Label  9610                                                           9607                              
 111                        Label  9612                                                           9611                              
 112                        Label  9616                                                           9615                              
 115                        Label  9621                                                           9609                              
 130                        Label  9625                                                           9621                              
 131                        Label  9627                                                           9626                              
 132                        Label  9631                                                           9630                              
 137                        Label  9643                                                           9642                              
 140                        Label  9647                                                           9624                              
 151                        Label  9650                                                           9649                              
 16                         Label  9463                                                           9462                              
 161                        Label  9656                                                           9655                              
 169                        Label  9689                                                           9688                              
 17                         Label  9470                                                           9469                              
 170                        Label  9700                                                           9590                              
 18                         Label  9477                                                           9476                              
 191                        Label  9737                                                           9734                              
 207                        Label  9773                                                           9772                              
 210                        Label  9782                                                           9779                              
 211                        Label  9784                                                           9783                              
 212                        Label  9788                                                           9787                              
 220                        Label  9793                                                           9781                              
 229                        Label  9799                                                           9796                              
 230                        Label  9801                                                           9760                              
 27                         Label  9494                                                           9493                              
 3                          Label  9434                                                           9433                              
 30                         Label  9499                                                           9489                              
 310                        Label  9821                                                           9817                              
 311                        Label  9823                                                           9822                              
 313                        Label  9827                                                           9826                              
 320                        Label  9830                                                           9820                              
 321                        Label  9832                                                           9831                              
 349                        Label  9870                                                           9864,9866                         
 350                        Label  9872                                                           9839                              
 4                          Label  9438                                                           9437                              
 40                         Label  9505                                                           9503                              
 404                        Label  9887                                                           9885                              
 406                        Label  9888                                                           9886                              
 413                        Label  9898                                                           9897                              
 421                        Label  9915                                                           9913                              

Page 279         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 423                        Label  9934                                                           9932                              
 425                        Label  9947                                                           9946                              
 427                        Label  9954                                                           9950                              
 430                        Label  9956                                                           9904                              
 437                        Label  9958                                                           9957                              
 440                        Label  9960                                                           9901                              
 443                        Label  9967                                                           9965                              
 448                        Label  9991                                                           9962                              
 450                        Label  10005                                                          9896                              
 451                        Label  10010                                                          10009                             
 453                        Label  10012                                                          10011                             
 455                        Label  10026                                                          10025,10386,10387                 
 457                        Label  10031                                                          10030                             
 458                        Label  10040                                                          10038                             
 459                        Label  10043                                                          10041                             
 460                        Label  10045                                                          10028                             
 480                        Label  10046                                                          10018,10020                       
 5                          Label  9439                                                           9435                              
 50                         Label  9530                                                           9515                              
 500                        Label  10048                                                          9882                              
 51                         Label  9532                                                           9531                              
 544                        Label  10072                                                          10064                             
 55                         Label  9536                                                           9529                              
 550                        Label  10081                                                          10050                             
 551                        Label  10084                                                          10083                             
 552                        Label  10087                                                          10086                             
 553                        Label  10100                                                          10099                             
 557                        Label  10105                                                          10103                             
 558                        Label  10109                                                          10107                             
 559                        Label  10126                                                          10125                             
 560                        Label  10130                                                          10115                             
 57                         Label  9539                                                           9538                              
 570                        Label  10131                                                          10090                             
 59                         Label  9542                                                           9541                              
 60                         Label  9545                                                           9413                              
 620                        Label  10144                                                          10140                             
 65                         Label  9565                                                           9553                              
 650                        Label  10156                                                          10154                             
 66                         Label  9567                                                           9566                              
 670                        Label  10163                                                          10151                             
 680                        Label  10164                                                          10146,10149                       
 70                         Label  9571                                                           9564                              
 73                         Label  9575                                                           9574                              
 801                        Label  10175                                                          10174                             
 811                        Label  10203                                                          10202                             
 813                        Label  10221                                                          10220                             
 820                        Label  10245                                                          10315                             
 823                        Label  10248                                                          10247                             
 825                        Label  10276                                                          10275                             
 827                        Label  10288                                                          10287                             
 829                        Label  10296                                                          10295                             
 831                        Label  10308                                                          10307                             
 833                        Label  10320                                                          10319                             
 840                        Label  10326                                                          10311                             
 857                        Label  10329                                                          10327,10328                       

Page 280         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 858                        Label  10336                                                          10334,10335                       
 859                        Label  10342                                                          10340,10341                       
 861                        Label  10351                                                          10349,10350                       
 871                        Label  10357                                                          10355,10356                       
 877                        Label  10368                                                          10362,10365                       
 880                        Label  10370                                                          10361                             
 941                        Label  10390                                                          10388,10389                       
 943                        Label  10404                                                          10396,10400                       
 950                        Label  10407                                                          10395                             
 980                        Label  10409                                                          10378,10385                       
 ABRT1                      Subr   9465                                                           9465,9472,9479,9497,9644          
 ABS                        Func   9556                                 scalar                    9556,9558                         
 ANGLE                      Dummy  9312     R(4)            4           scalar   ARG,INOUT        9585,9589,9721,9730               
 ANGLMN                     Local  9730     R(4)            4           scalar   SAVE             9730,10334,10335                  
 ANGZ                       Local  9589     R(4)            4           scalar   SAVE             9589,9596,9638,9653,9655,9685,9697
 ANLCOM                     Subr   9879                                                                                             
 ANLVOR                     Subr   10138                                                                                            
 ASECTR                     Local  9457     R(4)            4           scalar   SAVE             9457,9596,9638                    
 AXIPS                      Dummy  9313     R(4)            4     1     0        ARG,INOUT        9765,9797                         
 AXIRAD                     Dummy  9313     R(4)            4     1     0        ARG,INOUT        9762,9770,9772,9781,9797          
 AXIWND                     Dummy  9314     R(4)            4     2     0        ARG,INOUT        9841,9856,9858,9864,9866          
 AZIAVW                     Local  9344     R(4)            4     4     432      SAVE             9421,9841,9856,9857,9892,9914,9933
                                                                                                  ,9966,9977,9988,9999,10000,10155,1
                                                                                                  0160,10397,10398,10401,10402      
 CMPSIT                     Subr   9311                                                                                             
 COMDAT                     Local  9340     R(4)            4     5     1728     SAVE             9417,9661,9662,9663,9914,9917,9919
                                                                                                  ,9921,9923,9924,9925,9933,9936,993
                                                                                                  8,9940,9942,9943,9944             
 COMPRM                     Local  9357                                 scalar                    9450,9451                         
 DATA                       Dummy  9313     R(4)            4     1     0        ARG,INOUT        9585,9639,9640,9649,9653,9655,9678
                                                                                                  ,9679,9680,9717,9723,9731,9734    
 DELRPS                     Local  9367     R(4)            4           scalar   SAVE             9367,9548,10230,10231,10239,10306,
                                                                                                  10318                             
 DELTAR                     Local  9357     R(4)            4           scalar   SAVE             9357,9443,9485,9504,9599,9601,9770
                                                                                                  ,9772                             
 DIFMN                      Local  9551     R(4)            4           scalar   SAVE             9551,9556,9558                    
 DIRZ                       Local  9680     R(4)            4           scalar   SAVE             9680,9681                         
 DRPSM                      Local  9548     R(4)            4           scalar   SAVE             9548,9555,9566,9710,9735,9762     
 DS2UV                      Subr   9400                                                           9400                              
 EPSPS                      Local  9368     R(4)            4           scalar   SAVE             9368,10282,10287,10295,10307      
 EPSRD                      Local  9368     R(4)            4           scalar   SAVE             9368,9599,9770                    
 EQLDR                      Local  9334     L(4)            4           scalar   SAVE             9486,9501,9598,9769               
 FIRST                      Local  9334     L(4)            4           scalar   SAVE             9368,9449,9453                    
 FITOBS                     Subr   10171                                                                                            
 FUNINC                     Subr   10281                                                          10281                             
 HOWFMN                     Local  9547     R(4)            4           scalar   SAVE             9547,9728,9729,10192,10202,10210,1
                                                                                                  0220,10334,10335                  
 HUNDKM                     Local  9368     R(4)            4           scalar   SAVE             9368,10191,10281                  
 IDATEZ                     Dummy  9315     I(4)            4           scalar   ARG,INOUT        10273                             
 IFIX                       Func   9596                                 scalar                    9596,9638,9762,9770,10230         
 IHOWFR                     Dummy  9312     I(4)            4           scalar   ARG,INOUT        9585,9599,9601,9609,9611,9698,9710
                                                                                                  ,9720,9728,9729,9734,9783         
 INDR                       Local  10059    I(4)            4           scalar   SAVE             10059,10120                       
 INDZ                       Local  9971     I(4)            4           scalar   SAVE             9971,9975,10058,10071,10119       
 INT                        Func   9599                                 scalar                    9599,9710                         

Page 281         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IOUTMX                     Param  9328     I(4)            4           scalar                    9342                              
 IPLVL                      Local  9369     I(4)            4           scalar   SAVE             9369,10272                        
 IPRT                       Local  9583     I(4)            4           scalar   SAVE             9583,9584,9648,9654,9708,9734,9796
                                                                                                  ,9831,9861                        
 IPRTZ                      Dummy  9312     I(4)            4           scalar   ARG,INOUT        9583,9708                         
 IRTYP                      Dummy  9313     I(4)            4           scalar   ARG,INOUT        9677,9722,9734                    
 ITERPS                     Local  10238    I(4)            4           scalar   SAVE             10238,10246,10247,10287,10295,1030
                                                                                                  4,10307,10317,10319               
 ITMXPS                     Local  9368     I(4)            4           scalar   SAVE             9368,10304,10307,10317            
 IUNTBH                     Dummy  9312     I(4)            4           scalar   ARG,INOUT        10328,10335,10341,10350,10356,1036
                                                                                                  5,10387,10389,10400               
 IUNTDH                     Dummy  9314     I(4)            4           scalar   ARG,INOUT        10011,10041,10086,10107           
 IUTCZ                      Dummy  9316     I(4)            4           scalar   ARG,INOUT        10273                             
 IVARZ                      Local  10228    I(4)            4           scalar   SAVE             10228,10272                       
 IYNT                       Local  10230    I(4)            4           scalar   SAVE             10230,10231,10232                 
 KYBC1                      Local  10233    I(4)            4           scalar   SAVE             10233,10271                       
 KYBC2                      Local  10234    I(4)            4           scalar   SAVE             10234,10271                       
 LDXDIM                     Param  9326     I(4)            4           scalar                    9354,10116,10125,10194,10195,10212
                                                                                                  ,10213                            
 LDXX                       Local  10060    I(4)            4           scalar   SAVE             10060,10116,10118,10119,10120,1012
                                                                                                  1,10122,10125,10185,10193,10194,10
                                                                                                  196,10199,10200,10201,10211,10212,
                                                                                                  10214,10217,10218,10219,10272     
 MAX                        Func   10122                                scalar                    10122                             
 MIN                        Func   9614                                 scalar                    9614,9629,9710,9762,9786,9825,1023
                                                                                                  2,10281                           
 MOD                        Func   9638                                 scalar                    9638,9697,10380                   
 N                          Local  9585     I(4)            4           scalar   SAVE             9585,9649                         
 NA                         Local  9901     I(4)            4           scalar   SAVE             9901,9902,9903                    
 NABIN                      Local  9357     I(4)            4           scalar   SAVE             9357,9430,9457,9475,9476,9901     
 NAZ                        Local  9596     I(4)            4           scalar   SAVE             9596,9638,9649,9661,9662,9663,9665
 NAZ1                       Local  9902     I(4)            4           scalar   SAVE             9902,9909,9912,9914,9917,9918,9919
                                                                                                  ,9920,9921,9922,9923,9924,9925,994
                                                                                                  6,9951                            
 NAZ2                       Local  9903     I(4)            4           scalar   SAVE             9903,9928,9931,9933,9936,9937,9938
                                                                                                  ,9939,9940,9941,9942,9943,9944,994
                                                                                                  6,9953                            
 NAZIAV                     Local  9345     I(4)            4     3     144      SAVE             9420,9860,9891,9912,9931,9964,9966
                                                                                                  ,9997,9998,10153,10155,10396,10398
                                                                                                  ,10400,10402                      
 NAZIBN                     Param  9319     I(4)            4           scalar                    9340,9341,9342,9475,9476          
 NBINPS                     Local  9554     I(4)            4           scalar   SAVE             9554,9574,9710,9735,9762,10050,100
                                                                                                  90,10140,10282,10361              
 NCMPVO                     Dummy  9314     I(4)            4           scalar   ARG,INOUT        9351,9855,9863                    
 NCOM                       Local  9673     I(4)            4           scalar   SAVE             9673,9674,9675,9676,9677,9678,9679
                                                                                                  ,9681,9682,9683,9684,9685,9694,969
                                                                                                  5,9696,9697,9698,9840,9841,9856,98
                                                                                                  57,9860,9864,9866,10038,10039,1004
                                                                                                  1,10042                           
 NCOMDT                     Local  9341     I(4)            4     5     1728     SAVE             9418,9665,9909,9912,9918,9920,9922
                                                                                                  ,9928,9931,9937,9939,9941,9951,995
                                                                                                  3                                 
 NCOMPS                     Local  9550     I(4)            4           scalar   SAVE             9550,9711,9712,9714,9717,9718,9719
                                                                                                  ,9720,9721,9722,9723,9735,9736,974
                                                                                                  9,9764,9765,9796                  

Page 282         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NCOR                       Local  9590     I(4)            4           scalar   SAVE             9590,9595,9637,9642,9649,9655,9661
                                                                                                  ,9662,9663,9665,9669,9884,9885,988
                                                                                                  6,9909,9912,9914,9917,9918,9919,99
                                                                                                  20,9921,9922,9923,9924,9925,9928,9
                                                                                                  931,9933,9936,9937,9938,9939,9940,
                                                                                                  9941,9942,9943,9944,9951,9953     
 NCORBN                     Param  9321     I(4)            4           scalar                    9340,9341,9590,9642,9884          
 NDATA                      Local  9388     I(4)            4           scalar   SAVE             9388,9461,9462                    
 NDATAZ                     Dummy  9311     I(4)            4           scalar   ARG,INOUT        9338,9388                         
 NDATMX                     Param  9324     I(4)            4           scalar                    9343,9348,9670,9688,9712,9713,1006
                                                                                                  5,10066,10092,10093,10117,10125   
 NDIM                       Param  9330     I(4)            4           scalar                    9354,9355,10232                   
 NINT                       Func   9599                                 scalar                    9599,9623,9624,9819,9820,9896,1002
                                                                                                  0,10149,10239,10385               
 NL                         Local  9435     I(4)            4           scalar   SAVE             9435,9436,9437,9894,9895,9896,9897
                                                                                                  ,9909,9912,9914,9917,9918,9919,992
                                                                                                  0,9921,9922,9923,9924,9925,9928,99
                                                                                                  31,9933,9936,9937,9938,9939,9940,9
                                                                                                  941,9942,9943,9944,9951,9953,9964,
                                                                                                  9966,9972,9975,9977,9984,9987,9988
                                                                                                  ,9996,9997,9998,9999,10000,10018,1
                                                                                                  0019,10020,10021,10025,10029,10030
                                                                                                  ,10038,10039,10041,10042,10146,101
                                                                                                  48,10149,10153,10155,10160,10378,1
                                                                                                  0380,10384,10385,10386,10387,10396
                                                                                                  ,10397,10398,10400,10401,10402    
 NL1                        Local  9895     I(4)            4           scalar   SAVE             9895,9897,10019,10025,10148,10384,
                                                                                                  10386,10387                       
 NLB                        Local  9622     I(4)            4           scalar   SAVE             9622,9626,9629,9630,9649,9661,9662
                                                                                                  ,9663,9665,9670,9671,9673,9674,967
                                                                                                  5,9676,9677,9678,9679,9681,9682,96
                                                                                                  83,9684,9685,9688,9694,9695,9696,9
                                                                                                  697,9698,9818,9822,9825,9826,9831,
                                                                                                  9841,9856,9857,9860               
 NLBIN                      Local  9357     I(4)            4           scalar   SAVE             9357,9431,9432,9621,9817,9891,9892
                                                                                                  ,9894,10018,10146,10378           
 NLBIN1                     Local  9432     I(4)            4           scalar   SAVE             9432,9435,9629,9825               
 NLBZ                       Local  9621     I(4)            4           scalar   SAVE             9621,9622,9623,9624,9817,9818,9819
                                                                                                  ,9820                             
 NLVLBN                     Param  9320     I(4)            4           scalar                    9339,9340,9341,9343,9344,9345,9629
                                                                                                  ,9630,9825,9826                   
 NMSNG                      Local  9425     I(4)            4           scalar   SAVE             9425,9687,9688,10114,10124,10125  
 NN                         Local  10275    I(4)            4           scalar   SAVE             10275                             
 NOBPS                      Local  9394     I(4)            4           scalar   SAVE             9394,9709,10086                   
 NOBWMN                     Dummy  9315     I(4)            4           scalar   ARG,INOUT        9997,9998                         
 NOBWND                     Local  9393     I(4)            4           scalar   SAVE             9393,9672,10011                   
 NPS                        Local  10103    I(4)            4           scalar   SAVE             10103,10104,10107,10108           
 NPSBIN                     Local  9347     I(4)            4     2     72       SAVE             9562,9711,9712,9714,9718,9719,9720
                                                                                                  ,9721,9722,9723,9735,9764,9796,100
                                                                                                  52,10053,10057,10092,10094,10098,1
                                                                                                  0099,10104,10108,10115,10142,10143
                                                                                                  ,10363,10364,10366,10367          
 NPSRM1                     Local  9572     I(4)            4           scalar   SAVE             9572,10327,10328                  
 NPSRMX                     Local  9557     I(4)            4           scalar   SAVE             9557,9572,10281,10327,10328       
 NR                         Local  9538     I(4)            4           scalar   SAVE             9538,9574,9904,9909,9912,9914,9917

Page 283         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,9918,9919,9920,9921,9922,9923,992
                                                                                                  4,9925,9928,9931,9933,9936,9937,99
                                                                                                  38,9939,9940,9941,9942,9943,9944,9
                                                                                                  946,9950,9951,9952,9953,9962,9964,
                                                                                                  9966,9972,9975,9977,9984,9987,9988
                                                                                                  ,10151,10153,10155,10160,10395,103
                                                                                                  96,10397,10398,10399,10400,10401,1
                                                                                                  0402,10403                        
 NRA                        Local  9599     I(4)            4           scalar   SAVE             9599,9600,9601,9608,9611,9614,9615
                                                                                                  ,9649,9661,9662,9663,9665,9670,967
                                                                                                  1,9673,9674,9675,9676,9677,9678,96
                                                                                                  79,9681,9682,9683,9684,9685,9688,9
                                                                                                  694,9695,9696,9697,9698,9770,9771,
                                                                                                  9772,9780,9783,9786,9787,9793,9798
                                                                                                  ,10028,10029,10030,10038,10039,100
                                                                                                  41,10042                          
 NRADBN                     Param  9318     I(4)            4           scalar                    9338,9340,9341,9343,9344,9345,9429
                                                                                                  ,9445,9468,9469,9600,9601,9614,961
                                                                                                  5,9771,9772,9786,9787             
 NRADV                      Local  9760     I(4)            4           scalar   SAVE             9760,9762,9765,9770,9772,9781,9793
                                                                                                  ,9796,9797,9798,9839,9840,9841,985
                                                                                                  6,9858,9864,9866                  
 NRADVO                     Dummy  9314     I(4)            4           scalar   ARG,INOUT        9351,9352,9760,9839               
 NRAPS                      Local  9710     I(4)            4           scalar   SAVE             9710,9711,9712,9714,9717,9718,9719
                                                                                                  ,9720,9721,9722,9723,9735,9736,976
                                                                                                  2,9764,9765,9796,9797             
 NRAZ                       Local  9607     I(4)            4           scalar   SAVE             9607,9608,9609,9779,9780,9781     
 NRB                        Local  9489     I(4)            4           scalar   SAVE             9489,9490,9491,9492,9493,9503,9504
                                                                                                  ,9515,9516,9520,9525,9526,9529    
 NRBIN                      Local  9357     I(4)            4           scalar   SAVE             9357,9429,9468,9469,9489,9503,9513
                                                                                                  ,9516,9531,9538,9607,9614,9779,978
                                                                                                  6,9891,9892,9904,9962,10028,10151,
                                                                                                  10395                             
 NRBINZ                     Local  9513     I(4)            4           scalar   SAVE             9513,9515,9520                    
 NRBNPS                     Param  9329     I(4)            4           scalar                    9347,9348,9349,9553,9566          
 NRBRPT                     Local  9514     I(4)            4           scalar   SAVE             9514,9526,9541,9997,9998,9999,1000
                                                                                                  0,10001                           
 NRDSTR                     Dummy  9313     I(4)            4     1     0        ARG,INOUT        9793,9798,9840                    
 NRPS                       Local  9553     I(4)            4           scalar   SAVE             9553,9554,9555,9556,9557,9558,9561
                                                                                                  ,9562,9564,10050,10051,10052,10053
                                                                                                  ,10057,10071,10073,10079,10090,100
                                                                                                  92,10094,10098,10099,10103,10104,1
                                                                                                  0107,10108,10115,10119,10120,10140
                                                                                                  ,10141,10142,10143,10361,10362,103
                                                                                                  63,10364,10365,10366,10367        
 NS                         Local  10064    I(4)            4           scalar   SAVE             10064,10065,10066,10071           
 NSMX                       Local  9972     I(4)            4           scalar   SAVE             9972,9973,9975,9977,10057,10063,10
                                                                                                  064,10073                         
 NSPL                       Local  10115    I(4)            4           scalar   SAVE             10115,10117,10119,10120,10125     
 NSTOR                      Local  9344     I(4)            4     2     72       SAVE             9419,9670,9671,9673,9688,9972,1002
                                                                                                  9,10030,10039,10042               
 NV                         Local  9913     I(4)            4           scalar   SAVE             9913,9914,9932,9933,9965,9966,1015
                                                                                                  4,10155,10397,10398,10401,10402   
 NVARBN                     Param  9322     I(4)            4           scalar                    9340,9341,9344,9345,9461,9462,9913
                                                                                                  ,9932,9965,10154,10397,10398,10401

Page 284         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,10402                            
 NVOUT                      Local  10038    I(4)            4           scalar   SAVE             10038,10041                       
 NVR                        Local  10103    I(4)            4           scalar   SAVE             10103,10107                       
 NVROUT                     Param  9327     I(4)            4           scalar                    9343,9348,10038,10041             
 NVRPS                      Local  9549     I(4)            4           scalar   SAVE             9549,10103,10107                  
 NX                         Local  10232    I(4)            4           scalar   SAVE             10232,10240,10247,10271,10275,1028
                                                                                                  1                                 
 NXYUP                      Local  10282    I(4)            4           scalar   SAVE             10282,10287,10295                 
 ONLYPS                     Dummy  9312     L(4)            4           scalar   ARG,INOUT        9402,9545,10048,10177             
 ONLYWI                     Dummy  9311     L(4)            4           scalar   ARG,INOUT        9402,9413,9882,10374              
 OPSCOM                     Subr   9706                                                                                             
 OUTMAP                     Local  9342     R(4)            4     1     4        SAVE             9367,9902,9903                    
 OUTPRT                     Local  9342     R(4)            4     1     6        SAVE             9907,9923,9924,9925,9942,9943,9944
                                                                                                  ,9950,9952                        
 OWNCOM                     Subr   9582                                                                                             
 PBIN                       Local  9339     R(4)            4     1     5        SAVE             9357,9436,9437,9623,9624,9626,9819
                                                                                                  ,9820,9822,9831,9896,9897,10020,10
                                                                                                  025,10149,10385,10386,10387       
 PCEN                       Dummy  9314     R(4)            4           scalar   ARG,INOUT        10174,10201,10202,10334,10335     
 PENV                       Dummy  9315     R(4)            4           scalar   ARG,INOUT        10174,10219,10220,10327,10328     
 PRESR                      Dummy  9313     R(4)            4           scalar   ARG,INOUT        9585,9623,9624,9626,9676          
 PRESVO                     Dummy  9314     R(4)            4           scalar   ARG,INOUT        9819,9820,9822                    
 PRNT                       Local  9334     L(4)            4           scalar   SAVE             9905,9910,9929,9950               
 PSBIN                      Local  9347     R(4)            4     2     72       SAVE             9561,9717,9736,9765,10052,10142   
 PSCLOS                     Local  9546     R(4)            4           scalar   SAVE             9546,9731,10202,10220,10334,10335 
 PSCOM                      Local  9348     R(4)            4     2     72       SAVE             10051,10052,10073,10141,10142,1036
                                                                                                  2,10363,10365,10366               
 PSDAT                      Local  9348     R(4)            4     3     4608000  SAVE             9718,9719,9720,9721,9722,9723,1007
                                                                                                  1,10103,10107,10119,10120         
 PSET                       Local  9339     R(4)            4     1     5        SAVE             9367,9436                         
 PTOP                       Local  9397     R(4)            4           scalar   SAVE             9397,9401,9896,10020,10149,10385  
 PTOPZ                      Dummy  9311     R(4)            4           scalar   ARG,INOUT        9397                              
 RADBIN                     Local  9338     R(4)            4     1     18       SAVE             9357,9490                         
 RADDAT                     Local  9343     R(4)            4     4     9216000  SAVE             9674,9675,9676,9677,9678,9679,9681
                                                                                                  ,9682,9683,9684,9685,9694,9695,969
                                                                                                  6,9697,9698,9975,10038,10041      
 RBIN                       Local  9338     R(4)            4     1     19       SAVE             9445,9488,9490,9492,9493,9504,9525
                                                                                                  ,9529,9531,9538,9609,9611,9781,978
                                                                                                  3,9950,9952,10000,10001,10030,1039
                                                                                                  6,10399,10400,10403               
 RCRIT                      Local  10191    R(4)            4           scalar   SAVE             10191,10192,10202                 
 REAL                       Func   9457                                 scalar                    9457,9504,9555,9609,9677,9698,9720
                                                                                                  ,9722,9728,9729,9734,9918,9920,992
                                                                                                  2,9937,9939,9941,9966,10053,10143,
                                                                                                  10155,10231,10239,10240           
 RLAT                       Dummy  9312     R(4)            4           scalar   ARG,INOUT        9674,9718,9734                    
 RLON                       Dummy  9313     R(4)            4           scalar   ARG,INOUT        9675,9719,9734                    
 RMAX                       Dummy  9314     R(4)            4           scalar   ARG,INOUT        10174,10217,10239,10327,10328     
 RMAXM                      Local  9398     R(4)            4           scalar   SAVE             9398,9556,9558,10202,10210,10220  
 RMAXZ                      Dummy  9311     R(4)            4           scalar   ARG,INOUT        9398                              
 RMXCOM                     Dummy  9311     R(4)            4           scalar   ARG,INOUT        9401,9529,9531,9564,9566          
 RPOT                       Dummy  9315     R(4)            4           scalar   ARG,INOUT        9399,9541                         
 RPOTM                      Local  9399     R(4)            4           scalar   SAVE             9399,9525,10000                   
 RPSBIN                     Local  9347     R(4)            4     1     36       SAVE             9555,9556,9558,9564,9574,9797,1009
                                                                                                  9,10281,10282,10287,10295,10362,10

Page 285         Source Listing                  CMPSIT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  364,10365,10367                   
 SETCOM                     Subr   9386                                                                                             
 SPDPOT                     Dummy  9315     R(4)            4           scalar   ARG,INOUT        9881,9999                         
 SPDZ                       Local  9680     R(4)            4           scalar   SAVE             9680,9682                         
 SPLDTA                     Local  9354     R(4)            4     1     8000     SAVE             10119,10201,10219,10271           
 SPLFIT                     Local  9354     R(4)            4     1     71       SAVE             10183,10272,10275,10281,10327,1032
                                                                                                  8,10340,10341,10362,10365         
 SPLNOD                     Local  9355     R(4)            4     1     71       SAVE             10272,10281                       
 SQRT                       Func   9664                                 scalar                    9664,9694,9858                    
 STDAZP                     Local  9349     R(4)            4     1     36       SAVE             10073,10079,10363,10366           
 STDAZW                     Local  9345     R(4)            4     3     216      SAVE             9977,9984,9987,10397,10401        
 STDEV                      Subr   9977                                                           9977,10073                        
 STDZ                       Local  9343     R(4)            4     1     8000     SAVE             9975,9977,10071,10073             
 STMDR0                     Local  9395     R(4)            4           scalar   SAVE             9395,9400,9401,9638,9697          
 STMDRZ                     Dummy  9311     R(4)            4           scalar   ARG,INOUT        9395                              
 STMLNZ                     Dummy  9315     R(4)            4           scalar   ARG,INOUT        10272                             
 STMLTZ                     Dummy  9315     R(4)            4           scalar   ARG,INOUT        10272                             
 STMNMZ                     Dummy  9312     CHAR                        scalar   ARG,INOUT        9401,10174,10273,10327,10328      
 STMSP0                     Local  9396     R(4)            4           scalar   SAVE             9396,9400,9401                    
 STMSPZ                     Dummy  9311     R(4)            4           scalar   ARG,INOUT        9396                              
 USTM                       Local  9400     R(4)            4           scalar   SAVE             9400,9401,9639                    
 UV2DS                      Subr   9680                                                           9680                              
 UVRTCN                     Subr   9653                                                           9653                              
 VPSCOM                     Subr   9747                                                                                             
 VRAD                       Local  9653     R(4)            4           scalar   SAVE             9653,9655,9661,9664,9683,9694,9695
 VSTM                       Local  9400     R(4)            4           scalar   SAVE             9400,9401,9640                    
 VTAN                       Local  9653     R(4)            4           scalar   SAVE             9653,9655,9662,9664,9684,9694,9696
 VWNCOM                     Subr   9807                                                                                             
 WDZ                        Local  9354     R(4)            4     1     8000     SAVE             10121,10200,10218,10272           
 XSPLCM                     Subr   10271                                                          10271                             
 YBCWL1                     Local  10235    R(4)            4           scalar   SAVE             10235,10271                       
 YBCWL2                     Local  10236    R(4)            4           scalar   SAVE             10236,10271                       
 YDCLKM                     Local  10306    R(4)            4           scalar   SAVE             10306,10307,10318,10319           
 YDCWL                      Local  10239    R(4)            4           scalar   SAVE             10239,10247,10271,10305,10306,1031
                                                                                                  4,10318                           
 YDCWMX                     Local  10240    R(4)            4           scalar   SAVE             10240,10305,10307                 
 YDZ                        Local  9354     R(4)            4     1     8000     SAVE             10120,10122,10199,10217,10271     
 YNB                        Local  10229    R(4)            4           scalar   SAVE             10229,10247,10271                 
 YNT                        Local  10061    R(4)            4           scalar   SAVE             10061,10122,10230,10231,10247,1027
                                                                                                  1                                 
 YUP                        Local  9334     L(4)            4           scalar   SAVE             10282,10286,10304,10317           

Page 286         Source Listing                  CMPSIT
2017-04-18 11:09                                 syndata.f

  10413 
  10414 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  10415 C                .      .    .                                       .
  10416 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  10417 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  10418 C
  10419 C ABSTRACT: ??????????????????????????????????????????????????????????
  10420 C   ??????????????????????????????????????????????????????????????????
  10421 C
  10422 C PROGRAM HISTORY LOG:
  10423 C ????-??-??  S. J. LORD
  10424 C
  10425 C USAGE:    CALL ????????(????)
  10426 C   INPUT ARGUMENT LIST:
  10427 C     ??????   - ???????????????????????????????????????????????
  10428 C
  10429 C   OUTPUT ARGUMENT LIST:
  10430 C     ??????   - ???????????????????????????????????????????????
  10431 C
  10432 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  10433 C     ??????   - ???????????????????????????????????????????????
  10434 C
  10435 C   OUTPUT FILES:
  10436 C     ??????   - ???????????????????????????????????????????????
  10437 C
  10438 C REMARKS: ?????????????????????????????????????????????????????
  10439 C
  10440 C ATTRIBUTES:
  10441 C   LANGUAGE: FORTRAN 90
  10442 C   MACHINE:  NCEP WCOSS
  10443 C
  10444 C$$$
  10445       SUBROUTINE MM2DVO(IUNTBH,DELXZ,SP1DWL,XLATC,XLONC,RMAXZ,PCZ,PBZ,
  10446      1                  PTOPZ,PCENF,A2DVOR,MAXVOR,MAXVOP,MAXVOV,MAXPL,
  10447      2                  IMAXP2,IDATEZ,IUTCZ,STMNMZ)
  10448 C
  10449       PARAMETER(MMDIMP=12)
  10450       PARAMETER(MMDIMR=70)
  10451       PARAMETER(NDIM  =70)
  10452 ccccc PARAMETER(LDXDIM=NDIM+1)
  10453       PARAMETER(LDXDIM=8000)
  10454 C
  10455       CHARACTER STMNMZ*(*)
  10456 C
  10457       SAVE
  10458 C
  10459       DIMENSION XMODZ(MMDIMP),PSTD(MMDIMP),A2DVOR(MAXVOR,MAXVOP,MAXVOV)
  10460 C
  10461       DIMENSION PSA(MMDIMR),DPSA(MMDIMR),VT(MMDIMR),
  10462      1          R(MMDIMR),RDR(MMDIMR),NRDSTR(MMDIMR)
  10463 C
  10464       DIMENSION PA(MMDIMR,MMDIMP),RM(MMDIMR,MMDIMP),
  10465      1          VG(MMDIMR,MMDIMP),Z(MMDIMR,MMDIMP)
  10466 C
  10467       DIMENSION SPLDTA(LDXDIM),WDZ(LDXDIM),YDZ(LDXDIM),SPLFIT(NDIM+1),
  10468      1          SPLNOD(NDIM+1)
  10469 C

Page 287         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10470       LOGICAL FIRST
  10471 C
  10472       DATA PSTD/1000.0,850.0,700.0,500.0,400.0,300.0,250.0,200.0,150.0,
  10473      1          100.0,70.0,50.0/
  10474 C
  10475 C     IMPORTANT NOTE:  THE VALUES OF R200, R280 BELOW ARE ERRONEOUS,
  10476 C                      BUT WERE THE ONES USED IN THE BOGUS "PRA"
  10477 C                      RUN.  THEY SHOULD BE CHANGED TO THE CORRECT
  10478 C                      VALUES ONCE COMPARISON TESTS ARE COMPLETED.
  10479 C
  10480       DATA ALFA/100./,DELV/0.00/,PIA/3.1415926/,FIRST/.TRUE./,
  10481      1     VTFAC/1.2/,DEGLAT/111.1775E3/,IONE/1/,IPLVL/2/,
  10482      2     P150/150./,P200/200./,R200/200.E3/,R280/280.E3/
  10483 C
  10484       DATA XMODZ/132.0,1547.0,3182.0,5588.0,7595.0,9682.0,10935.0,
  10485      1           12396.0,14177.0,16568.0,18652.0,20743.0/
  10486 C
  10487 C     PC, PB IN MB  --  RMAXZ IN KM  --   XLATC IN DEGREES
  10488 C
  10489 C
  10490 C     SET UP INITIAL CONSTANTS AND DO SOME SPACE CHECKS
  10491 C
  10492       IF(FIRST)  THEN
  10493       IF(MAXVOR .LT. MMDIMR)  THEN
  10494       WRITE(6,11) MAXVOR,MMDIMR
  10495    11 FORMAT(/'******INSUFFICIENT RADIAL SPACE TO STORE 2-D VORTEX ',
  10496      1       'IN MM2DVO, MAXVOR,MMDIMR=',2I5)
  10497       CALL ABRT1(' MM2DVO',11)
  10498       ENDIF
  10499 C
  10500       IF(MAXVOP .LT. MMDIMP)  THEN
  10501       WRITE(6,13) MAXVOP,MMDIMP
  10502    13 FORMAT(/'******INSUFFICIENT VERTICAL SPACE TO STORE 2-D VORTEX ',
  10503      1       'IN MM2DVO, MAXVOP,MMDIMP=',2I5)
  10504       CALL ABRT1(' MM2DVO',13)
  10505       ENDIF
  10506 C
  10507       TOMEGA=14.58E-5
  10508       PID=PIA/180.0
  10509       MAXPL=MMDIMP
  10510       IMAX=MMDIMR
  10511       IMAXM1=IMAX-1
  10512 C
  10513       EE=2.718
  10514       REE=1.0/EE
  10515 C
  10516       DELX=DELXZ*1000.0
  10517       DXOG =DELX/9.806
  10518 C
  10519       DO 20  I=1,IMAX
  10520       R(I)=(I-1)*DELX
  10521    20 CONTINUE
  10522 c && 2 comments
  10523 CC    WRITE(6,11) DELXZ,ALFA,DELV
  10524 C1016 FORMAT( //'  DELX,ALFA,DELV FOR MM2DVO=',5F10.3)
  10525 C
  10526 c && 2 comments

Page 288         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10527 CC    WRITE(6,13) (XMODZ(K),K=1, MAXPL)
  10528 C1064 FORMAT(/10X,'...MODIFIED XMODZ=',/,(14X,12F8.0))
  10529 C
  10530       ENDIF
  10531 C
  10532       WRITE(6,21) DELXZ,ALFA,DELV,XLATC,VTFAC,STMNMZ
  10533       WRITE(IUNTBH,21) DELXZ,ALFA,DELV,XLATC,VTFAC,STMNMZ
  10534    21 FORMAT(////21X,'*******************************************'
  10535      1          /21X,'*******************************************'
  10536      2          /21X,'****                                   ****'
  10537      3          /21X,'****   MATHUR 2-D VORTEX ROUTINE       ****'
  10538      4          /21X,'****   DELX(KM)=',F6.1,'  ALFA=',F6.1,'    ****'
  10539      5          /21X,'****',3X,'DELV=',F5.1,'  XLATC=',F7.2,7X,'****'
  10540      6          /21X,'****',3X,'VTFAC=',F4.1,2X,'STORM=',A12,'  ****'
  10541      7          /21X,'****                                   ****'
  10542      8          /21X,'*******************************************'
  10543      9          /21X,'*******************************************')
  10544 C
  10545       PB=PBZ
  10546       PC=PCZ
  10547 C
  10548       RMAX=RMAXZ*1000.0
  10549       IMAXA=1+RMAX/DELX
  10550       IMXAP1=IMAXA+1
  10551       IMAXP2=IMAXA+2
  10552 C
  10553       IF(IMAXP2 .GT. MMDIMR)  THEN
  10554       WRITE(6,23) IMAXP2,MMDIMR
  10555    23 FORMAT(/'******VORTEX RADIUS TOO LARGE FOR AVAILABLE ',
  10556      1       'STORAGE IN MM2DVO, IMAXP2,MMDIMR=',2I5)
  10557       CALL ABRT1(' MM2DVO',23)
  10558       ENDIF
  10559 C
  10560       WRITE(6,27) PB,PC,RMAXZ,IMAXA
  10561       WRITE(IUNTBH,27) PB,PC,RMAXZ,IMAXA
  10562    27 FORMAT(/15X,'...PENV=',F8.2,3X,'PCEN=',F8.2,3X,'RMAX(KM)=',F7.1,
  10563      1       3X,'IMAXA=',I4)
  10564 C
  10565       WRITE(6,29) (R(I),I=1,IMXAP1)
  10566    29 FORMAT(/15X,'...RADII ARE ',/,(16X,12(-3PF8.1)))
  10567 C
  10568 C   ***************************
  10569 C   ****  INITIALIZE  PSA  ****
  10570 C   ***************************
  10571 C
  10572 C
  10573       PSA(1:IMAX)=PB
  10574 C
  10575 C --  QLM  TYPE
  10576 C
  10577       DELP=SQRT(1.0+ALFA)
  10578       DELP=(PB-PC)/(1.0-REE/DELP)
  10579 C
  10580       PMAX=PC+DELP
  10581       WRITE(6,33) ALFA,DELP,PMAX,PC,PB
  10582    33 FORMAT(//,16X,'...ALFA,DELP,PMAX,PC,PB=',5F10.4)
  10583 C

Page 289         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10584 C  -- CALC  SFC  PRES
  10585 C
  10586       RDR(1:IMAX)=R(1:IMAX)/RMAX
  10587 C
  10588 c && 2 comments
  10589 CC    WRITE(6,41)(RDR(I),I=2,IMAXA)
  10590 CC 41 FORMAT(//,16X,'...RDR=R/RMAX =',/(2X,11F8.4))
  10591 C
  10592       DO 50 I=1,IMAXA
  10593       RSQ=RDR(I)**2
  10594       PSA(I)=PMAX-DELP*EXP(-RSQ)/SQRT(1.0+ALFA*RSQ)
  10595    50 CONTINUE
  10596 C
  10597       WRITE(6,51) (PSA(I),I=1,IMAXP2)
  10598       WRITE(IUNTBH,51) (PSA(I),I=1,IMAXP2)
  10599    51 FORMAT(//,16X,'...PSA ARE:',/(19X,10F10.2))
  10600 C
  10601 C     WE FILTER THE SURFACE PRESSURE TO CALCULATE A CENTRAL PRESSURE
  10602 C       APPROPRIATE FOR BOGUSING.
  10603 C     SPLINE FITTING WITH DERIVATIVE CONSTRAINT.  INPUT PARAMETERS ARE:
  10604 C       NX - NUMBER OF NODAL INTERVALS. HERE, NODES CORRESPOND TO
  10605 C            GRID POINTS WHERE SURFACE PRESSURE IS DEFINED.  THE FIRST
  10606 C            BIN CORRESPONDS TO RADIUS = 0.
  10607 C       YNB - CENTER, AT RADIUS=0
  10608 C       YNT - MAXIMUM RADIUS (KM)
  10609 C       YDCWL - FILTER WAVELENGTH, UNITS ARE # OF NODAL INTERVALS
  10610 C       KYBC1 - INNER BOUNDARY CONDITION
  10611 C       KYBC2 - OUTER BOUNDARY CONDITION
  10612 C       YBCWL1 - INNER BOUNDARY CONDITION WAVELENGTH
  10613 C       YBCWL2 - OUTER BOUNDARY CONDITION WAVELENGTH
  10614 C       SPLDATA - INPUT DATA, NUMBER=LDXX
  10615 C       YDZ - RADIUS FOR EACH DATUM
  10616 C       WDZ - WEIGHT FOR EACH DATUM
  10617 C       LDXX - NUMBER OF DATA POINTS
  10618 C       SPLFIT - FITTED VALUES AT EACH NODE
  10619 C       SPLNOD - RADIAL DISTANCE (KM) OF EACH NODE
  10620 C       IVARZ - 1: SURFACE PRESSURE
  10621 C       STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ - STORM PARAMETERS
  10622 C       IPLVL - PRINT OUTPUT LEVEL FOR 1-D FILTERED SPLINE: 0=NO PRINT,
  10623 C             - 1: DATA LISTINGS, 2: DATA LISTINGS AND GRAPHS
  10624 C
  10625       IVARZ=1
  10626       STMLTZ=XLATC
  10627       STMLNZ=XLONC
  10628       YNB=0.0
  10629       YNT=R(IMAXA)/1000.
  10630       NX=MIN(IMAXA-1,NDIM)
  10631       DYNODE=R(IMAXA)/REAL(NX)
  10632       KYBC1=21
  10633       KYBC2=21
  10634       YBCWL1=120.E3/DYNODE
  10635       YBCWL2=120.E3/DYNODE
  10636 C
  10637       YDCWL=SP1DWL*DEGLAT/DYNODE
  10638       LDXX=IMAXA
  10639       DO 55 I=1,IMAXA
  10640       if(I .GT. LDXDIM)  THEN

Page 290         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10641          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  10642      $    'I=',I,', return'
  10643          return
  10644       endif
  10645       YDZ(I)=R(I)/1000.
  10646       WDZ(I)=1.0
  10647       SPLDTA(I)=PSA(I)
  10648       SPLNOD(I)=YDZ(I)
  10649    55 CONTINUE
  10650 C
  10651       WRITE(6,57) SP1DWL
  10652    57 FORMAT(/'...CALLING 1-D SPLINE FILTER FOR SURFACE PRESSURE, ',
  10653      1       'FILTER WAVELENGTH IS',F5.1,' DEG. LAT.')
  10654 C
  10655       CALL XSPLCM(NX,YNB,YNT,YDCWL,KYBC1,KYBC2,YBCWL1,YBCWL2,
  10656      1            SPLDTA,YDZ,WDZ,LDXX,SPLFIT,SPLNOD,IVARZ,IPLVL,
  10657      2            STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ)
  10658 C
  10659       PCENF=SPLFIT(1)
  10660       WRITE(6,59) PCENF
  10661    59 FORMAT(/'...1-D SPLINE FILTERED SURFACE PRESSURE=',F8.2,' MB.')
  10662 C
  10663 C   **********************************************************
  10664 C   -- CALC       PRES    DERIVATIVES
  10665 C   **********************************************************
  10666 C
  10667       DPSA(1:IMAX)=0.0
  10668 C
  10669       DO 70 I=2,IMXAP1
  10670 C
  10671       IF(R(I) .GT. RMAX)  GO TO 70
  10672 C
  10673       RSQ=RDR(I)**2
  10674       DRSQ=1+RSQ*ALFA
  10675       UDRSQ=SQRT(DRSQ)
  10676       SMU=RDR(I)*DELP*EXP(-RSQ)/UDRSQ
  10677       DPSA(I)=SMU*(2.+ALFA/DRSQ)/RMAX
  10678    70 CONTINUE
  10679 C
  10680 c && 2 comments
  10681 CC    WRITE(6,71) (DPSA(I   ),I=2,IMAXP2)
  10682 CC 71 FORMAT(///'     DPSA  FIRST DERIVATIVE =',/(2X,5E12.4))
  10683 C
  10684       CORF=ABS(TOMEGA*SIN(XLATC*PID))
  10685       CORFS=CORF**2
  10686 C
  10687       VT(1:IMAX)=0.0
  10688 C
  10689 C
  10690       VT(2:IMAXP2)=VTFAC*(-CORF+(CORFS+4.0*DPSA(2:IMAXP2)*80.0/
  10691      1 R(2:IMAXP2))**.5)/(2.0/R(2:IMAXP2))
  10692 C
  10693       WRITE(6,91) (VT(I  ),I=1,IMAXP2)
  10694       WRITE(IUNTBH,91) (VT(I  ),I=1,IMAXP2)
  10695    91 FORMAT(//,16X,'...VT ARE',/,(19X,10F10.2))
  10696 C
  10697 C     CASE DELV = 0  -   NO ADJUSTMENT OF WIND AT BOUNDARY

Page 291         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10698       IF(DELV .LE. 0.0)  GO TO 150
  10699 C
  10700       DO 100 I=2,IMAXP2
  10701       IK=I
  10702       IF(VT(I)  .LE. 0.1  )   GO TO  120
  10703   100 CONTINUE
  10704       WRITE(6,101)  IK  , VT(IK-1),  VT(IK) , VT(IK+1) ,RMAX
  10705   101 FORMAT( // '  UNABLE TO FIND  ZERO WIND ', I5,2X,4F12.2)
  10706       GO TO 150
  10707 C
  10708   120 CONTINUE
  10709 C
  10710 C     CONSIDER TWO GRID POINTS INSIDE RMAX - NOTE AT RMAX WIND IS ZERO
  10711 C
  10712       IK=IK-1
  10713       I8=VT(IK-1)/DELV
  10714 C
  10715       IKP=IK+I8
  10716       WRITE(6,123) I8,IK,IKP,VT(IK-1), VT(IK),VT(IK+1),RMAX
  10717   123 FORMAT(//'  WIND ZERO FOUND  ',3I4,4F12.2)
  10718       IF(I8 .LT. 1)   GO TO 150
  10719       DO 130 I=IK,IKP
  10720       VT(I)=VT(I-1)-DELV
  10721       IF(VT(I) .LE. 0.0)  VT(I)=0.0
  10722   130 CONTINUE
  10723       WRITE(6,91) (VT(I  ),I=1,IMAXP2)
  10724   150 CONTINUE
  10725 C
  10726 C  **************************************************************
  10727 C     CALC  WINDS  AT  UPPER   LEVELS
  10728 C  **************************************************************
  10729 C
  10730       VG(1:IMAX,1) = VT(1:IMAX)
  10731 C
  10732       DO KK=1,MAXPL
  10733       DO I=1,IMAX
  10734 C
  10735 C -------  NEW  WAY ---    CHANGE  --------------------------
  10736 C
  10737       PA(I,KK)=1./COSH((PSTD(KK)-P150)/P200)
  10738 C
  10739       PA(I,KK)=PA(I,KK)/(COSH((R(I)-R280)/R200))
  10740 C
  10741 C--   RM MAKES VERT GRADIENT CONCENTRATED IN THE UPPER TROP
  10742 C
  10743       XX=PIA*(PSTD(KK)-P150)/P200
  10744 C
  10745       RM(I,KK)=.5*(1.+TANH(XX))-PA(I,KK)
  10746 C
  10747 C     RM(I,KK)=RM(I,KK)-PA(I,KK)
  10748 C
  10749 C     TRANSFER SIGN OF LATITUDE TO OUTPUT VORTEX
  10750 C
  10751       VG(I,KK)=RM(I,KK)*VT(I)
  10752       A2DVOR(I,KK,2)=SIGN(VG(I,KK),XLATC)
  10753 C
  10754 C ------------   END NEW WAY  -----------------

Page 292         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10755 C
  10756       ENDDO
  10757       ENDDO
  10758 C
  10759       WRITE(6,201)   ((VG(I,KK),KK=1,MMDIMP),I=1,IMAXP2)
  10760       WRITE(IUNTBH,201)   ((VG(I,KK),KK=1,MMDIMP),I=1,IMAXP2)
  10761   201 FORMAT(//,'...VG ARE',/(2X,12F10.1))
  10762 C
  10763 C **************************************************************
  10764 C  ---FIND   HEIGHTS OF STND PRESSURE LEVELS
  10765 C **************************************************************
  10766 C
  10767 C
  10768       DO 220 K=1,MAXPL
  10769          Z(1:IMAX,K)= XMODZ(K)
  10770          A2DVOR(1:IMAX,K,1)=XMODZ(K)
  10771   220 CONTINUE
  10772 C
  10773 C     FIND Z USING GRADIENT BALANCE
  10774 C
  10775       IMAXM2= IMAXM1-1
  10776       DO 250 K=1,MAXPL
  10777       DO 240 IR=1,IMAXM2
  10778       I=IMAX-IR
  10779       IP=I+1
  10780       VX=VG(I,K)
  10781       VXS=VX**2
  10782       RX=REAL(I-1)*DELX
  10783 C     RX=RX*DELX
  10784 C
  10785       Z(I,K)=Z(IP,K)-(CORF*VX+(VXS/RX))*DXOG
  10786   240 CONTINUE
  10787       Z(1,K)=Z(2,K)
  10788 C
  10789   250 CONTINUE
  10790 C
  10791 C     CALCULATE D-VALUE
  10792 C
  10793       A2DVOR(1:IMAXP2,1:MMDIMP,1)=Z(1:IMAXP2,1:MMDIMP)
  10794 C
  10795       WRITE(6,261)  ((Z(I,KK),KK=1,MMDIMP),I=1,IMAXP2)
  10796       WRITE(IUNTBH,261)  ((Z(I,KK),KK=1,MMDIMP),I=1,IMAXP2)
  10797   261 FORMAT(//,'...Z ARE',/(2X,12F10.1))
  10798 C
  10799 C     COMPOSITE SURFACE PRESSURE IN THE SAME WAY AS THE OBSERVATIONS
  10800 C     **** WARNING:  RADIAL BIN INDICES ARE STORED IN VPSCOM.
  10801 C                    THEREFORE, VPSCOM MUST BE CALLED FIRST.  ****
  10802 C
  10803       CALL VPSCOM(PSA,R,NRDSTR,IMAXP2)
  10804 C
  10805 C     COMPOSITE WINDS IN THE SAME WAY AS THE OBSERVATIONS
  10806 C
  10807       DO 500 ILV=1,MMDIMP
  10808       IF(NINT(PSTD(ILV)*10.) .GE. NINT(PTOPZ*10.))  THEN
  10809       PRESVO=PSTD(ILV)
  10810       CALL VWNCOM(IMAXP2,IONE,PRESVO,VG(1,ILV),nrdstr)
  10811       ENDIF

Page 293         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10812   500 CONTINUE
  10813 C
  10814       WRITE(6,999)
  10815   999 FORMAT(/'...LEAVING MM2DVO')
  10816       RETURN
  10817       END


ENTRY POINTS

  Name               
                     
 mm2dvo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  10703                                                          10700                             
 101                        Label  10705                                                          10704                             
 11                         Label  10495                                                          10494                             
 120                        Label  10708                                                          10702                             
 123                        Label  10717                                                          10716                             
 13                         Label  10502                                                          10501                             
 130                        Label  10722                                                          10719                             
 150                        Label  10724                                                          10698,10706,10718                 
 20                         Label  10521                                                          10519                             
 201                        Label  10761                                                          10759,10760                       
 21                         Label  10534                                                          10532,10533                       
 220                        Label  10771                                                          10768                             
 23                         Label  10555                                                          10554                             
 240                        Label  10786                                                          10777                             
 250                        Label  10789                                                          10776                             
 261                        Label  10797                                                          10795,10796                       
 27                         Label  10562                                                          10560,10561                       
 29                         Label  10566                                                          10565                             
 33                         Label  10582                                                          10581                             
 50                         Label  10595                                                          10592                             
 500                        Label  10812                                                          10807                             
 51                         Label  10599                                                          10597,10598                       
 55                         Label  10649                                                          10639                             
 57                         Label  10652                                                          10651                             
 59                         Label  10661                                                          10660                             
 70                         Label  10678                                                          10669,10671                       
 91                         Label  10695                                                          10693,10694,10723                 
 999                        Label  10815                                                          10814                             
 A2DVOR                     Dummy  10446    R(4)            4     3     0        ARG,INOUT        10752,10770,10793                 
 ABRT1                      Subr   10497                                                          10497,10504,10557                 
 ABS                        Func   10684                                scalar                    10684                             
 ALFA                       Local  10480    R(4)            4           scalar   SAVE             10480,10532,10533,10577,10581,1059
                                                                                                  4,10674,10677                     
 CORF                       Local  10684    R(4)            4           scalar   SAVE             10684,10685,10690,10785           
 CORFS                      Local  10685    R(4)            4           scalar   SAVE             10685,10690                       
 COSH                       Func   10737                                scalar                    10737,10739                       
 DEGLAT                     Local  10481    R(4)            4           scalar   SAVE             10481,10637                       
 DELP                       Local  10577    R(4)            4           scalar   SAVE             10577,10578,10580,10581,10594,1067

Page 294         Source Listing                  MM2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  6                                 
 DELV                       Local  10480    R(4)            4           scalar   SAVE             10480,10532,10533,10698,10713,1072
                                                                                                  0                                 
 DELX                       Local  10516    R(4)            4           scalar   SAVE             10516,10517,10520,10549,10782     
 DELXZ                      Dummy  10445    R(4)            4           scalar   ARG,INOUT        10516,10532,10533                 
 DPSA                       Local  10461    R(4)            4     1     70       SAVE             10667,10677,10690                 
 DRSQ                       Local  10674    R(4)            4           scalar   SAVE             10674,10675,10677                 
 DXOG                       Local  10517    R(4)            4           scalar   SAVE             10517,10785                       
 DYNODE                     Local  10631    R(4)            4           scalar   SAVE             10631,10634,10635,10637           
 EE                         Local  10513    R(4)            4           scalar   SAVE             10513,10514                       
 EXP                        Func   10594                                scalar                    10594,10676                       
 FIRST                      Local  10470    L(4)            4           scalar   SAVE             10480,10492                       
 I                          Local  10519    I(4)            4           scalar   SAVE             10519,10520,10565,10592,10593,1059
                                                                                                  4,10597,10598,10639,10640,10642,10
                                                                                                  645,10646,10647,10648,10669,10671,
                                                                                                  10673,10676,10677,10693,10694,1070
                                                                                                  0,10701,10702,10719,10720,10721,10
                                                                                                  723,10733,10737,10739,10745,10751,
                                                                                                  10752,10759,10760,10778,10779,1078
                                                                                                  0,10782,10785,10795,10796         
 I8                         Local  10713    I(4)            4           scalar   SAVE             10713,10715,10716,10718           
 IDATEZ                     Dummy  10447    I(4)            4           scalar   ARG,INOUT        10657                             
 IK                         Local  10701    I(4)            4           scalar   SAVE             10701,10704,10712,10713,10715,1071
                                                                                                  6,10719                           
 IKP                        Local  10715    I(4)            4           scalar   SAVE             10715,10716,10719                 
 ILV                        Local  10807    I(4)            4           scalar   SAVE             10807,10808,10809,10810           
 IMAX                       Local  10510    I(4)            4           scalar   SAVE             10510,10511,10519,10573,10586,1066
                                                                                                  7,10687,10730,10733,10769,10770,10
                                                                                                  778                               
 IMAXA                      Local  10549    I(4)            4           scalar   SAVE             10549,10550,10551,10560,10561,1059
                                                                                                  2,10629,10630,10631,10638,10639   
 IMAXM1                     Local  10511    I(4)            4           scalar   SAVE             10511,10775                       
 IMAXM2                     Local  10775    I(4)            4           scalar   SAVE             10775,10777                       
 IMAXP2                     Dummy  10447    I(4)            4           scalar   ARG,INOUT        10551,10553,10554,10597,10598,1069
                                                                                                  0,10691,10693,10694,10700,10723,10
                                                                                                  759,10760,10793,10795,10796,10803,
                                                                                                  10810                             
 IMXAP1                     Local  10550    I(4)            4           scalar   SAVE             10550,10565,10669                 
 IONE                       Local  10481    I(4)            4           scalar   SAVE             10481,10810                       
 IP                         Local  10779    I(4)            4           scalar   SAVE             10779,10785                       
 IPLVL                      Local  10481    I(4)            4           scalar   SAVE             10481,10656                       
 IR                         Local  10777    I(4)            4           scalar   SAVE             10777,10778                       
 IUNTBH                     Dummy  10445    I(4)            4           scalar   ARG,INOUT        10533,10561,10598,10694,10760,1079
                                                                                                  6                                 
 IUTCZ                      Dummy  10447    I(4)            4           scalar   ARG,INOUT        10657                             
 IVARZ                      Local  10625    I(4)            4           scalar   SAVE             10625,10656                       
 K                          Local  10768    I(4)            4           scalar   SAVE             10768,10769,10770,10776,10780,1078
                                                                                                  5,10787                           
 KK                         Local  10732    I(4)            4           scalar   SAVE             10732,10737,10739,10743,10745,1075
                                                                                                  1,10752,10759,10760,10795,10796   
 KYBC1                      Local  10632    I(4)            4           scalar   SAVE             10632,10655                       
 KYBC2                      Local  10633    I(4)            4           scalar   SAVE             10633,10655                       
 LDXDIM                     Param  10453    I(4)            4           scalar                    10467,10640,10641                 
 LDXX                       Local  10638    I(4)            4           scalar   SAVE             10638,10656                       
 MAXPL                      Dummy  10446    I(4)            4           scalar   ARG,INOUT        10509,10732,10768,10776           

Page 295         Source Listing                  MM2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAXVOP                     Dummy  10446    I(4)            4           scalar   ARG,INOUT        10459,10500,10501                 
 MAXVOR                     Dummy  10446    I(4)            4           scalar   ARG,INOUT        10459,10493,10494                 
 MAXVOV                     Dummy  10446    I(4)            4           scalar   ARG,INOUT        10459                             
 MIN                        Func   10630                                scalar                    10630                             
 MM2DVO                     Subr   10445                                                                                            
 MMDIMP                     Param  10449    I(4)            4           scalar                    10459,10464,10465,10500,10501,1050
                                                                                                  9,10759,10760,10793,10795,10796,10
                                                                                                  807                               
 MMDIMR                     Param  10450    I(4)            4           scalar                    10461,10462,10464,10465,10493,1049
                                                                                                  4,10510,10553,10554               
 NDIM                       Param  10451    I(4)            4           scalar                    10467,10468,10630                 
 NINT                       Func   10808                                scalar                    10808                             
 NRDSTR                     Local  10462    I(4)            4     1     70       SAVE             10803,10810                       
 NX                         Local  10630    I(4)            4           scalar   SAVE             10630,10631,10655                 
 P150                       Local  10482    R(4)            4           scalar   SAVE             10482,10737,10743                 
 P200                       Local  10482    R(4)            4           scalar   SAVE             10482,10737,10743                 
 PA                         Local  10464    R(4)            4     2     840      SAVE             10737,10739,10745                 
 PB                         Local  10545    R(4)            4           scalar   SAVE             10545,10560,10561,10573,10578,1058
                                                                                                  1                                 
 PBZ                        Dummy  10445    R(4)            4           scalar   ARG,INOUT        10545                             
 PC                         Local  10546    R(4)            4           scalar   SAVE             10546,10560,10561,10578,10580,1058
                                                                                                  1                                 
 PCENF                      Dummy  10446    R(4)            4           scalar   ARG,INOUT        10659,10660                       
 PCZ                        Dummy  10445    R(4)            4           scalar   ARG,INOUT        10546                             
 PIA                        Local  10480    R(4)            4           scalar   SAVE             10480,10508,10743                 
 PID                        Local  10508    R(4)            4           scalar   SAVE             10508,10684                       
 PMAX                       Local  10580    R(4)            4           scalar   SAVE             10580,10581,10594                 
 PRESVO                     Local  10809    R(4)            4           scalar   SAVE             10809,10810                       
 PSA                        Local  10461    R(4)            4     1     70       SAVE             10573,10594,10597,10598,10647,1080
                                                                                                  3                                 
 PSTD                       Local  10459    R(4)            4     1     12       SAVE             10472,10737,10743,10808,10809     
 PTOPZ                      Dummy  10446    R(4)            4           scalar   ARG,INOUT        10808                             
 R                          Local  10462    R(4)            4     1     70       SAVE             10520,10565,10586,10629,10631,1064
                                                                                                  5,10671,10691,10739,10803         
 R200                       Local  10482    R(4)            4           scalar   SAVE             10482,10739                       
 R280                       Local  10482    R(4)            4           scalar   SAVE             10482,10739                       
 RDR                        Local  10462    R(4)            4     1     70       SAVE             10586,10593,10673,10676           
 REAL                       Func   10631                                scalar                    10631,10782                       
 REE                        Local  10514    R(4)            4           scalar   SAVE             10514,10578                       
 RM                         Local  10464    R(4)            4     2     840      SAVE             10745,10751                       
 RMAX                       Local  10548    R(4)            4           scalar   SAVE             10548,10549,10586,10671,10677,1070
                                                                                                  4,10716                           
 RMAXZ                      Dummy  10445    R(4)            4           scalar   ARG,INOUT        10548,10560,10561                 
 RSQ                        Local  10593    R(4)            4           scalar   SAVE             10593,10594,10673,10674,10676     
 RX                         Local  10782    R(4)            4           scalar   SAVE             10782,10785                       
 SIGN                       Func   10752                                scalar                    10752                             
 SIN                        Func   10684                                scalar                    10684                             
 SMU                        Local  10676    R(4)            4           scalar   SAVE             10676,10677                       
 SP1DWL                     Dummy  10445    R(4)            4           scalar   ARG,INOUT        10637,10651                       
 SPLDTA                     Local  10467    R(4)            4     1     8000     SAVE             10647,10656                       
 SPLFIT                     Local  10467    R(4)            4     1     71       SAVE             10656,10659                       
 SPLNOD                     Local  10468    R(4)            4     1     71       SAVE             10648,10656                       
 SQRT                       Func   10577                                scalar                    10577,10594,10675                 
 STMLNZ                     Local  10627    R(4)            4           scalar   SAVE             10627,10657                       
 STMLTZ                     Local  10626    R(4)            4           scalar   SAVE             10626,10657                       

Page 296         Source Listing                  MM2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 STMNMZ                     Dummy  10447    CHAR                        scalar   ARG,INOUT        10532,10533,10657                 
 TANH                       Func   10745                                scalar                    10745                             
 TOMEGA                     Local  10507    R(4)            4           scalar   SAVE             10507,10684                       
 UDRSQ                      Local  10675    R(4)            4           scalar   SAVE             10675,10676                       
 VG                         Local  10465    R(4)            4     2     840      SAVE             10730,10751,10752,10759,10760,1078
                                                                                                  0,10810                           
 VPSCOM                     Subr   10803                                                          10803                             
 VT                         Local  10461    R(4)            4     1     70       SAVE             10687,10690,10693,10694,10702,1070
                                                                                                  4,10713,10716,10720,10721,10723,10
                                                                                                  730,10751                         
 VTFAC                      Local  10481    R(4)            4           scalar   SAVE             10481,10532,10533,10690           
 VWNCOM                     Subr   10810                                                          10810                             
 VX                         Local  10780    R(4)            4           scalar   SAVE             10780,10781,10785                 
 VXS                        Local  10781    R(4)            4           scalar   SAVE             10781,10785                       
 WDZ                        Local  10467    R(4)            4     1     8000     SAVE             10646,10656                       
 XLATC                      Dummy  10445    R(4)            4           scalar   ARG,INOUT        10532,10533,10626,10684,10752     
 XLONC                      Dummy  10445    R(4)            4           scalar   ARG,INOUT        10627                             
 XMODZ                      Local  10459    R(4)            4     1     12       SAVE             10484,10769,10770                 
 XSPLCM                     Subr   10655                                                          10655                             
 XX                         Local  10743    R(4)            4           scalar   SAVE             10743,10745                       
 YBCWL1                     Local  10634    R(4)            4           scalar   SAVE             10634,10655                       
 YBCWL2                     Local  10635    R(4)            4           scalar   SAVE             10635,10655                       
 YDCWL                      Local  10637    R(4)            4           scalar   SAVE             10637,10655                       
 YDZ                        Local  10467    R(4)            4     1     8000     SAVE             10645,10648,10656                 
 YNB                        Local  10628    R(4)            4           scalar   SAVE             10628,10655                       
 YNT                        Local  10629    R(4)            4           scalar   SAVE             10629,10655                       
 Z                          Local  10465    R(4)            4     2     840      SAVE             10769,10785,10787,10793,10795,1079
                                                                                                  6                                 

Page 297         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10818 
  10819 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  10820 C
  10821 C SUBPROGRAM: AS2DVO         CREATES A 2-DIM (R-Z) BOGUS VORTEX
  10822 C   PRGMMR: S. J. LORD       ORG: NP22        DATE: 1991-07-01
  10823 C
  10824 C ABSTRACT: THIS SUBROUTINE CREATES AN AXISYMMETRIC BOGUS VORTEX. LAT,
  10825 C   CENTRAL PRESSURE OF THE HURRICANE(PC), PRESSURE OF THE OUTERMOST
  10826 C   CLOSE ISOBAR(PB), AND ITS DISTANCE FROM THE CENTER(RMAX) ARE
  10827 C   INPUT PARAMETERS.  THE BULK OF THE PROGRAM IS CONTAINED IN
  10828 C   THE SUBROUTINE CSWRL6 (WHICH CONTAINS ITS OWN ABSTRACT)
  10829 C
  10830 C
  10831 C PROGRAM HISTORY LOG:
  10832 C 1989-10-19  SHAPIRO
  10833 C 1990-10-29  LORD  CONVERT TO SUBROUTINE FOR SYNDATA
  10834 C 1991-07-01  LORD  VORTICITY-DIVERGENCE BOGUSING
  10835 C 2017-04-03  D. A. KEYSER  PARAMETER LDXDIM (STORAGE LIMIT FOR NUMBER
  10836 C        OF OBSERVATIONS IN STORM VICINITY) INCREASED FROM 2500 TO 8000.
  10837 C        BENEFIT: There can be > 1000 obs in the storm vicinity. This
  10838 C                 change ensures that all obs are processed and
  10839 C                 eliminates partial processing of statistics in cases
  10840 C                 where code does not abort but there are > 1000 obs
  10841 C                 going into certain subroutines. The value for
  10842 C                 parameter LDXDIM is standardized throughout the code.
  10843 C
  10844 C USAGE:
  10845 C   INPUT ARGUMENT LIST:
  10846 C     XLATC - LATITUDE OF STORM CENTER
  10847 C     XLONC - LONGITUDE OF STORM CENTER
  10848 C     PC - CENTRAL PRESSURE (HPA)
  10849 C     PB - PRESSURE OF THE OUTERMOST CLOSED ISOBAR (HPA)
  10850 C     RMAX - RADIUS OF OUTERMOST CLOSED ISOBAR (KM)
  10851 C     VPOT - SWIRLING WIND AT R=RMAX
  10852 C     UPOT - RADIAL WIND AT R=RMAX (MUST BE < 0)
  10853 C     DELXZ- GRID INTERVAL (KM) FOR SAMPLING THE WIND FIELDS
  10854 C
  10855 C   OUTPUT FILES:  VELOCITY AND PERTURBATION HEIGHT FIELDS STORED
  10856 C                  ON UNIT 6
  10857 C
  10858 C   SUBPROGRAMS CALLED:
  10859 C     UNIQUE:    - CSWRL6
  10860 C
  10861 C   EXIT STATES: NONE
  10862 C
  10863 C REMARKS: YOU ARE FREE TO TWEAK A NUMBER OF PARAMETERS APPEARING IN
  10864 C          THE MAIN PROGRAM E.G.: TANGENTIAL VELOCITY COMP AT RMAX,
  10865 C          RADIAL VELOCITY COMP AT RMAX. YOU MAY ALSO CHANGE SOME
  10866 C          PARAMETERS APPEARING IN SUBROUTINE CSWRL6, EG. B.L. DEPTH,
  10867 C          DP, CHARACTERISTIC EYE WALL UPDRAFT VELOCITY.  NOTE: IF DP
  10868 C          IS CHANGED IN CSWRL6 IT SHOULD ALSO BE CHANGED WHEN THE
  10869 C          SURFACE PRESSURE IS RECALCULATED ON THE COARSE GRID AFTER
  10870 C          CSWRL6.
  10871 C
  10872 C          YOU MAY ALSO TWEAK A NUMBER OF PARAMETERS APPEARING IN
  10873 C          THE VERTICAL SPECIFICATION OF THE TANGENTIAL AND RADIAL
  10874 C          WIND COMPONENTS.  THESE PARAMETERS APPEAR IN THE MAIN

Page 298         Source Listing                  MM2DVO
2017-04-18 11:09                                 syndata.f

  10875 C          PROGRAM AFTER SUBROUTINE CSWRL6.
  10876 C
  10877 C ATTRIBUTES:
  10878 C   LANGUAGE: FORTRAN 90
  10879 C   MACHINE:  NCEP WCOSS
  10880 C
  10881 C$$$
  10882 C*****************************************************************
  10883       SUBROUTINE AS2DVO(IUNTBH,IUNTVD,IVOTYP,DELXZ,DELSP,SP1DWL,XLATC,
  10884      1                  XLONC,RMAXZ,PCZ,PBZ,PTOPZ,VPOT,UPOT,RPOTZ,VTBOG,
  10885      2                  DIVFAC,PCENF,A2DVOR,MAXVOR,MAXVOP,MAXVOV,MAXPL,
  10886      3                  IMAXA,IDATEZ,IUTCZ,IER,VORDIV,STMNMZ)
  10887 C
  10888       PARAMETER(MMDIMP=12)
  10889       PARAMETER(MMDIMR=1000)
  10890       PARAMETER(NDIM=70)
  10891 ccccc PARAMETER(LDXDIM=2500)
  10892       PARAMETER(LDXDIM=8000)
  10893       PARAMETER(MAXPTS=20)
  10894 C
  10895       SAVE
  10896 C
  10897 C**DIAG
  10898 C     PARAMETER (NCALMX=100)
  10899 C     COMMON/DI/IDT(NCALMX),IUT(NCALMX),PCN(NCALMX),PEN(NCALMX),ICALL,
  10900 C    1          PTP(NCALMX),VORC(NCALMX),DIVC(NCALMX),STMN(NCALMX)
  10901 C     CHARACTER*12 STMN
  10902 C
  10903       CHARACTER STMNMZ*(*)
  10904 C
  10905       LOGICAL FIRST,VORDIV
  10906 C
  10907 
  10908       REAL(8)  SINDEG_8
  10909 
  10910       DIMENSION PSTD(MMDIMP),XMODZ(MMDIMP),R(MMDIMR),NRDSTR(MMDIMR),
  10911      1          PSA(MMDIMR),VT(MMDIMR),URAD(MMDIMR),
  10912      2          VG(MMDIMR,MMDIMP),Z(MMDIMR,MMDIMP),UR(MMDIMR,MMDIMP),
  10913      3          W(MMDIMR,MMDIMP),AXIWND(2*MMDIMR)
  10914 C
  10915       DIMENSION A2DVOR(MAXVOR,MAXVOP,MAXVOV),
  10916      1          VORT(MMDIMR,MMDIMP),DIV(MMDIMR,MMDIMP),
  10917      2          VFCEN(MMDIMP),DFCEN(MMDIMP),RHCEN(MMDIMP)
  10918 C
  10919       DIMENSION SPLDTA(LDXDIM),WDZ(LDXDIM),YDZ(LDXDIM),SPLFIT(NDIM+1),
  10920      1          SPLNOD(NDIM+1),SPLVOR(LDXDIM),SPLDIV(LDXDIM)
  10921 C
  10922       DIMENSION RLATP(MAXPTS),RLONP(MAXPTS)
  10923 C
  10924       DATA PSTD/1000.0,850.0,700.0,500.0,400.0,300.0,250.0,200.0,150.,
  10925      1          100.0,70.0,50.0/
  10926 C
  10927       DATA XMODZ/132.0,1547.0,3182.0,5588.0,7595.0,9682.0,10935.0,
  10928      1           12396.0,14177.0,16568.0,18652.0,20743.0/
  10929 C
  10930 C     DEGLAT: ONE DEGREE LATITUDE IN KM
  10931 C

Page 299         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  10932       DATA PI/3.1415927/,FIRST/.TRUE./,DEGLAT/111.1775/,
  10933      1     ITWO/2/,EE/2.718/,ALFA/200./,VORVAR/5.E-6/,DIVVAR/5.E-6/,
  10934      2     RHVAR/0.2/,DTHETA/45./,RHCEN/MMDIMP*0.9/
  10935 C****************************************************************
  10936 C
  10937 C
  10938 C          XLATC: LATITUDE OF STORM CENTER (DEGREES NORTH)
  10939 C          XLONC: LONGITUDE OF STORM CENTER (DEGREES EAST)
  10940 C          PCZ  : CENTRAL PRESSURE (MB)
  10941 C          PBZ  : PRESSURE OF THE OUTERMOST CLOSED ISOBAR (MB)
  10942 C          RMAXZ: RADIUS OF THE OUTERMOST CLOSED ISOBAR (KM)
  10943 C          RPOTZ: RADIUS FOR BEGINNING OF INWARD INTEGRATION
  10944 C          VPOT : SWIRLING WIND AT RPOT
  10945 C          UPOT : RADIAL INFLOW AT RPOT
  10946 C     ***** IMPORTANT NOTE:  UPOT MUST BE NON-ZERO AND NEGATIVE *****
  10947 C     ***** IMPORTANT NOTE:  XLONC IS IN DEGREES EAST *****
  10948 C          DELX : COARSE GRID SPACING.
  10949 C          IMAXA: NUMBER OF RADIAL GRID POINTS ON COARSE GRID
  10950 C
  10951       IF(FIRST)  THEN
  10952       FIRST=.FALSE.
  10953       PI486 =PI*4.0/86400.
  10954       MAXPL=MMDIMP
  10955       DELX = DELXZ*1000.0
  10956       REE=1.0/EE
  10957       DO 5 I=1,MMDIMR
  10958       R(I)=(I-1)*DELX
  10959     5 CONTINUE
  10960 C
  10961 C     SET UP INITIAL CONSTANTS AND DO SOME SPACE CHECKS
  10962 C
  10963       IF(MAXVOR .LT. MMDIMR)  THEN
  10964       WRITE(6,7) MAXVOR,MMDIMR
  10965     7 FORMAT(/'******INSUFFICIENT RADIAL SPACE TO STORE 2-D VORTEX ',
  10966      1       'IN AS2DVO, MAXVOR,MMDIMR=',2I5)
  10967       CALL ABRT1(' AS2DVO',7)
  10968       ENDIF
  10969 C
  10970       IF(MAXVOP .LT. MMDIMP)  THEN
  10971       WRITE(6,9) MAXVOP,MMDIMP
  10972     9 FORMAT(/'******INSUFFICIENT VERTICAL SPACE TO STORE 2-D VORTEX ',
  10973      1       'IN AS2DVO, MAXVOP,MMDIMP=',2I5)
  10974       CALL ABRT1(' AS2DVO',9)
  10975       ENDIF
  10976 C
  10977 C     WRITE VORTICITY/DIVERGENCE ERROR VARIANCES TO FILE IF
  10978 C       VORTICTY/DIVERGENCE BOGUSING IS IN EFFECT
  10979 C
  10980       IF(VORDIV)  THEN
  10981       WRITE(IUNTVD,*)  VORVAR
  10982       WRITE(IUNTVD,*)  DIVVAR
  10983       WRITE(IUNTVD,*)  RHVAR
  10984       ENDIF
  10985       ENDIF
  10986 C
  10987 C     DEPTH1 AND DEPTH2 ARE E-FOLDING DEPTHS (MB) OF GAUSSIAN
  10988 C     INFLOW AND OUTFLOW LAYERS.  SEE MORE COMPLETE COMMENTS BELOW

Page 300         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  10989 C     REGARDING VERTICAL EXTENSION OF THE VORTEX.
  10990 C
  10991       DEPTH1 = 200.0
  10992       IF(NINT(PTOPZ*10.) .LT. 3000)  THEN
  10993       DEPTH2 = 100.0
  10994       ELSE IF(NINT(PTOPZ*10.) .LT. 5000)  THEN
  10995       DEPTH2 = 200.0
  10996       ELSE
  10997       DEPTH2 = 300.0
  10998       ENDIF
  10999 C
  11000       RMAX = RMAXZ*1000.0
  11001       RPOT = RPOTZ*1000.0
  11002       PC=PCZ
  11003       PB=PBZ
  11004       CORF = PI486*SINDEG_8(XLATC)
  11005       IMAXA = 1 + RMAX/DELX
  11006       IMXPOT= 1 + RPOT/DELX
  11007 C
  11008 C**DIAG
  11009 C     STMN(ICALL)=STMNMZ
  11010 C     PCN(ICALL)=PC
  11011 C     PEN(ICALL)=PB
  11012 C     PTP(ICALL)=PTOPZ
  11013 C
  11014       WRITE(6,11) DELXZ,XLATC,STMNMZ,SP1DWL,DEPTH1,DEPTH2,PTOPZ
  11015       WRITE(IUNTBH,11) DELXZ,XLATC,STMNMZ,SP1DWL,DEPTH1,DEPTH2,PTOPZ
  11016    11 FORMAT(//21X,'*******************************************'
  11017      1        /21X,'*******************************************'
  11018      2        /21X,'****                                   ****'
  11019      3        /21X,'****   SHAPIRO 2-D VORTEX ROUTINE      ****'
  11020      5        /21X,'****',3X,'DELXZ=',F6.1,' KM, XLATC=',F7.2,'  ****'
  11021      6        /21X,'****',3X,'STORM=',A12,' SP1DWL=',F4.1,2X,'****'
  11022      7        /21X,'****',3X,'DEPTH1=',F5.1,' DEPTH2=',F5.1,7X,'****'
  11023      8        /21X,'****',3X,'PTOP=',F5.1,' MB',19X,'****'
  11024      9        /21X,'****                                   ****'
  11025      O        /21X,'*******************************************'
  11026      1        /21X,'*******************************************')
  11027       WRITE(6,13) PB,PC,RMAX,RPOT,XLATC,XLONC,VPOT,UPOT,
  11028      1            IMXPOT,IMAXA
  11029       WRITE(IUNTBH,13) PB,PC,RMAX,RPOT,XLATC,XLONC,VPOT,UPOT,
  11030      1                 IMXPOT,IMAXA
  11031    13 FORMAT(/'...PB=',F6.1,' MB,', 6X, 'PC=',F6.1,' MB,',3X,'RMAX=',
  11032      1       -3PF6.1,' KM,',3X,'RPOT=',F6.1,' KM,',3X,'LAT=',0PF6.1,
  11033      2       ', LON=',F7.1,/,4X,'VPOT=', F6.1,' M/S,', 3X,
  11034      3       'UPOT=', F6.1,' M/S',3X,',IMXPOT=',I3,3X,', IMAXA=',I3)
  11035 C
  11036       IF(IMAXA .GT. MMDIMR)  THEN
  11037          WRITE(6,15) IMAXA,MMDIMR
  11038    15 FORMAT(/'******IMAXA=',I5,' EXCEEDS AVAILABLE SPACE, MMDIMR=',I5)
  11039          CALL ABRT1(' AS2DVO',15)
  11040       ENDIF
  11041 C
  11042 C     INITIALIZE PRESSURE AND VELOCITY FIELDS
  11043 C
  11044       VT= 0.0
  11045       URAD= 0.0

Page 301         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11046       PSA= 0.0
  11047       VG= 0.0
  11048       UR= 0.0
  11049       W= 0.0
  11050       Z= 0.0
  11051       VORT= 0.0
  11052       DIV= 0.0
  11053       AXIWND=0.0
  11054 C
  11055 C     PRELIMINARY ESTIMATE OF SURFACE PRESSURE COMES FROM THE
  11056 C       FUJITA FORMULA AS IMPLEMENTED IN THE QLM.  THE PURPOSE
  11057 C       HERE IS TO PROVIDE AN ESTIMATE AT THE RADIUS OF 15 M/S
  11058 C       WINDS ONLY
  11059 C
  11060       DELP=SQRT(1.0+ALFA)
  11061       DELP=(PB-PC)/(1.0-REE/DELP)
  11062 C
  11063       PMAX=PC+DELP
  11064       WRITE(6,19) ALFA,DELP,PMAX,PC,PB
  11065    19 FORMAT(//,16X,'...ALFA,DELP,PMAX,PC,PB=',5F10.4)
  11066 C
  11067       DO 20 I=1,IMAXA
  11068          RDR=R(I)/RMAX
  11069          RSQ=RDR**2
  11070          PSA(I)=PMAX-DELP*EXP(-RSQ)/SQRT(1.0+ALFA*RSQ)
  11071    20 CONTINUE
  11072 C
  11073       WRITE(6,21) (PSA(I),I=1,IMAXA)
  11074       WRITE(IUNTBH,21) (PSA(I),I=1,IMAXA)
  11075    21 FORMAT(//,16X,'...PRELIMINARY PSA ARE:',/(19X,10F10.2))
  11076 C
  11077 C     SAMPLE PSA AT INDEX IMXPOT
  11078 C
  11079       PPOT=PSA(IMXPOT)
  11080 C
  11081 C     NOW CALL THE SUBROUTINE (CSWRL6) THAT CALCULATES THE SEA LEVEL
  11082 C     VELOCITY FIELD SATISFYING THE RADIAL AND TANGENTIAL EQUATIONS OF
  11083 C     MOTION. THE SUBROUTINE SAMPLES THE VELOCITY PROFILE ON THE
  11084 C     COARSE GRID PRIOR TO OUTPUT.
  11085 C
  11086       CALL CSWRL6(IER,IUNTBH,IMXPOT,UPOT,VPOT,RPOT,PC,PPOT,XLATC,
  11087      1            MMDIMR,DELX,VT,URAD,PSA)
  11088       IF(IER .NE. 0)  THEN
  11089          WRITE(6,23) IER
  11090          WRITE(IUNTBH,23) IER
  11091    23 FORMAT(/'******CSWRL6 HAS UNRECOVERABLE ERROR=',I5,' THEREFORE,',
  11092      1       ' WE CALL MM2DVO AS A BACKUP.')
  11093          RETURN
  11094       ENDIF
  11095 C
  11096 C     VG IS NOW THE SWIRLING WIND COMPONENT AND UR IS THE INFLOW
  11097 C     COMPONENT.
  11098 C     PICK OUT THE RADIUS OF MAXIMUM SWIRLING WIND.
  11099 C
  11100       IMXZRO=0
  11101       VTZZ=0.0
  11102       DO 25 I = 1, IMXPOT

Page 302         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11103          IF(ABS(VT(I)) .GT. VTZZ) THEN
  11104             IMXZRO=I
  11105             VTZ=VT(I)
  11106             VTZZ=ABS(VTZ)
  11107          ENDIF
  11108          VG(I,1) = VT(I)
  11109          UR(I,1) = URAD(I)
  11110    25 CONTINUE
  11111 C
  11112 C     A DIRTY FIX FOR ZERO TANGENTIAL WINDS INSIDE THE RADIUS OF
  11113 C        MAXIMUM WIND: SOLID BODY ROTATION, NO INFLOW OR OUTFLOW
  11114 C     ****IMPORTANT NOTE: TANGENTIAL WINDS CALCULATED BY CSWRL6
  11115 C                         INSIDE THE RADIUS OF MAXIMUM SWIRLING WIND
  11116 C                         ARE OVERWRITTEN BY THE FOLLOWING LOOP!! ****
  11117 C
  11118       DO 30 I=2,IMXZRO-1
  11119          VT(I)=VTZ*REAL(I-1)/REAL(IMXZRO-1)
  11120          VG(I,1) = VT(I)
  11121    30 CONTINUE
  11122 C
  11123 C     EXTEND THE VORTEX RADIALLY OUTWARD (LINEARLY) FROM THE RADIUS OF
  11124 C        15 M/S WINDS TO THE RADIUS OF THE OUTERMOST CLOSED ISOBAR
  11125 C        WHERE THE VORTEX IS VTBOG.  VTBOG IS DEFINED AS THE STORM
  11126 C        SPEED IF THERE IS NO VORTEX IN THE GUESS FIELD, BUT IS
  11127 C        DEFINED FROM THE AZIMUTHAL MEAN WIND IN THE GUESS FIELD IF
  11128 C        THERE IS A VORTEX PRESENT.
  11129 C
  11130       IPTS=IMAXA-IMXPOT
  11131       DO 40 I=IMXPOT+1,IMAXA
  11132          VT(I)  =SIGN(VTBOG+(VPOT-VTBOG)*(IMAXA-I)/REAL(IPTS),CORF)
  11133          URAD(I)=UPOT*(IMAXA-I)/REAL(IPTS)
  11134          VG(I,1) = VT(I)
  11135          UR(I,1) = URAD(I)
  11136    40 CONTINUE
  11137 C
  11138 C     PRINT OUT THE SAMPLED SURFACE PRESSURE AND VELOCITY FIELDS.
  11139 C     (NOTE: THIS SAMPLED SURFACE PRESSURE DISTRIBUTION WILL BE IGNORED
  11140 C     IN FAVOR OF A HEIGHT FIELD IN BALANCE WITH THE SAMPLED VELOCITY
  11141 C     FIELD--TO BE CALCULATED LATER)
  11142 C
  11143       WRITE(6,1100) (PSA(I), I=1, IMAXA)
  11144       WRITE(IUNTBH,1100) (PSA(I), I=1, IMAXA)
  11145 1100  FORMAT(//,16X,'...PSA ARE:',/,(19X,10F10.2))
  11146 C
  11147 C     WE FILTER THE SURFACE PRESSURE TO CALCULATE A CENTRAL PRESSURE
  11148 C       APPROPRIATE FOR BOGUSING.
  11149 C     SPLINE FITTING WITH DERIVATIVE CONSTRAINT.  INPUT PARAMETERS ARE:
  11150 C       NX - NUMBER OF NODAL INTERVALS. HERE, NODES CORRESPOND TO
  11151 C            GRID POINTS WHERE SURFACE PRESSURE IS DEFINED.  THE FIRST
  11152 C            BIN CORRESPONDS TO RADIUS = 0.
  11153 C       YNB - CENTER, AT RADIUS=0
  11154 C       YNT - MAXIMUM RADIUS (KM)
  11155 C       YDCWL - FILTER WAVELENGTH, UNITS ARE # OF NODAL INTERVALS
  11156 C       KYBC1 - INNER BOUNDARY CONDITION
  11157 C       KYBC2 - OUTER BOUNDARY CONDITION
  11158 C       YBCWL1 - INNER BOUNDARY CONDITION WAVELENGTH
  11159 C       YBCWL2 - OUTER BOUNDARY CONDITION WAVELENGTH

Page 303         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11160 C       SPLDATA - INPUT DATA, NUMBER=LDXX
  11161 C       YDZ - RADIUS FOR EACH DATUM
  11162 C       WDZ - WEIGHT FOR EACH DATUM
  11163 C       LDXX - NUMBER OF DATA POINTS
  11164 C       SPLFIT - FITTED VALUES AT EACH NODE
  11165 C       SPLNOD - RADIAL DISTANCE (KM) OF EACH NODE
  11166 C       IVARZ - 1: SURFACE PRESSURE
  11167 C       IPLVL - PRINT OUTPUT LEVEL: 0=NO PRINT, 1:DATA LISTINGS
  11168 C             - 2: DATA LISTINGS AND GRAPHS
  11169 C       STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ - STORM PARAMETERS
  11170 C
  11171       IVARZ=1
  11172       IPLVL=0
  11173       STMLTZ=XLATC
  11174       STMLNZ=XLONC
  11175       YNB=0.0
  11176       YNT=R(IMAXA)/1000.
  11177       DYNODE=DELSP
  11178       YDCWL=SP1DWL*DEGLAT/DYNODE
  11179       KYBC1=21
  11180       KYBC2=21
  11181       YBCWL1=120./DYNODE
  11182       YBCWL2=120./DYNODE
  11183 C
  11184       NX=0
  11185       SPLNOD(1)=0.0
  11186       DO 43 IN=2,IMAXA
  11187          IF(SPLNOD(IN-1) .LE. YNT)  THEN
  11188             SPLNOD(IN)=SPLNOD(IN-1)+DYNODE
  11189             NX=NX+1
  11190 C
  11191             IF(NX .GT. NDIM)  THEN
  11192                WRITE(6,42) NX,NDIM
  11193    42 FORMAT(/'******NUMBER OF NODAL INTERVALS=',I4,' EXCEEDS ',
  11194      1       'PARAMETER NDIM=',I4)
  11195                CALL ABRT1(' AS2DVO',42)
  11196             ENDIF
  11197 C
  11198          ELSE
  11199             GO TO 44
  11200          ENDIF
  11201    43 CONTINUE
  11202    44 CONTINUE
  11203 C
  11204       LDXX=IMAXA
  11205 
  11206       YDZ(1:IMAXA)=R(1:IMAXA)/1000.
  11207       WDZ(1:IMAXA)=1.0
  11208       SPLDTA(1:IMAXA)=PSA(1:IMAXA)
  11209 C
  11210       WRITE(6,47) SP1DWL
  11211    47 FORMAT(/'...CALLING 1-D SPLINE FILTER FOR SURFACE PRESSURE, ',
  11212      1       'FILTER WAVELENGTH IS',F5.1,' DEG. LAT.')
  11213 C
  11214       CALL XSPLCM(NX,YNB,YNT,YDCWL,KYBC1,KYBC2,YBCWL1,YBCWL2,
  11215      1            SPLDTA,YDZ,WDZ,LDXX,SPLFIT,SPLNOD,IVARZ,IPLVL,
  11216      2            STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ)

Page 304         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11217 C
  11218       PCENF=SPLFIT(1)
  11219       WRITE(6,49) PCENF
  11220       WRITE(IUNTBH,49) PCENF
  11221    49 FORMAT(/'...1-D SPLINE FILTERED SURFACE PRESSURE=',F8.2,' MB.')
  11222 C
  11223 c && 1 comment
  11224 CC    WRITE(6,1200) (VT(I), I=1, IMAXA)
  11225 C     WRITE(IUNTBH,1200) (VT(I), I=1, IMAXA)
  11226 c && 2 comments
  11227 C1200 FORMAT(//,16X,'...VT ARE:', /,(19X,10F10.2))
  11228 CC    WRITE(6,1300) (URAD(I), I=1, IMAXA)
  11229 C     WRITE(IUNTBH,1300) (URAD(I), I=1, IMAXA)
  11230 c && 1 comment
  11231 C1300 FORMAT(//,16X,'...URAD ARE:', /,(19X,10F10.2))
  11232 C
  11233 C     EXTEND VORTEX SPECIFICATION THROUGHOUT THE VERTICAL. EPS
  11234 C     IS AN ATTENUATION FACTOR.  IT REDUCES THE CYCLONIC WIND AT THE
  11235 C     PRESSURE LEVEL (KHIGH) AT THE FIRST RADIAL GRID POINT TO A
  11236 C     FRACTION EPS OF ITS SURFACE VALUE.  EPS IN COMBINATION WITH
  11237 C     THE LOW LEVEL ANGULAR MOMENTUM IN THE CORE CONTROLS THE RADIUS
  11238 C     AT WHICH ANTICYCLONIC WINDS FIRST APPEAR AT THE LEVEL KHIGH.
  11239 C     IF YOU WISH TO SPECIFY THIS RADIUS OF SWIRL REVERSAL (CALL
  11240 C     IT RV) THEN EPS SHOULD BE SPECIFIED ACCORDING TO THE FORMULA:
  11241 C     EPS = (CORF*RV**2)/(2.*VT(2)*DELX) BUT NOTE THAT THIS VALUE OF
  11242 C     EPS MAY TURN OUT TO BE GREATER THAN 1 IMPLYING AN INCREASE OF
  11243 C     SWIRL WITH HEIGHT IN THE CORE REGION.
  11244 C
  11245 C
  11246 C     RV = 150.0*1000.
  11247 C     EPS = (CORF*RV*RV)/(2.*VT(2)*DELX)
  11248       EPS = 0.8
  11249       KHIGH = 8
  11250       PHIGH = PSTD(KHIGH)
  11251 C
  11252 C     KINF  IS THE PRESSURE LEVEL NEAR WHICH ANTICYCLONIC WINDS APPEAR
  11253 C
  11254       KINF = KHIGH-1
  11255       PINF = PSTD(KINF)
  11256       PLOW = PSTD(1)
  11257       VG(1,KHIGH) = 0.0
  11258       DO 60 IR = 2, IMAXA
  11259          RR = DELX*(IR-1)
  11260          VG(IR,KHIGH) = ( EPS*VT(2)*DELX + CORF*DELX*DELX/2.0 )/RR
  11261      1                  - CORF*RR/2.0
  11262    60 CONTINUE
  11263 C
  11264 C    FF IS A WEIGHTING FUNCTION TO SPECIFY WINDS BETWEEN LEVEL 1
  11265 C    AND LEVEL KHIGH
  11266 C
  11267       DO 100 K = 1, KHIGH-1
  11268          XNUMER = TANH(PSTD(K)/PINF) - TANH(PLOW/PINF)
  11269          DENOM = TANH(PHIGH/PINF) - TANH(PLOW/PINF)
  11270          FF = XNUMER/DENOM
  11271          DO 90 IR = 1, IMAXA
  11272             VG(IR,K) = (1.0-FF)*VT(IR) + FF*VG(IR,KHIGH)
  11273    90    CONTINUE

Page 305         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11274   100 CONTINUE
  11275 C
  11276 C     CAT IS THE ATTENUATION FACTOR FROM K = KHIGH TO 50 MB.
  11277 C
  11278       CAT = 0.5
  11279       KMAX = MMDIMP
  11280       DO 120 K = KHIGH, KMAX
  11281          DO 110 IR = 1, IMAXA
  11282             VG(IR,K) = VG(IR,KHIGH)*(CAT*KHIGH-KMAX+(1.-CAT)*K)
  11283      1                 /(KHIGH-KMAX)
  11284   110    CONTINUE
  11285   120 CONTINUE
  11286 C
  11287 C     NOW SPECIFY RADIAL WIND. DEPTH1 AND DEPTH2 ARE E-FOLDING
  11288 C     DEPTHS (IN MB) OF GAUSSIAN INFLOW AND OUTFLOW LAYERS.  C3 IS
  11289 C     CHOSEN SO THAT MASS IN = MASS OUT. MAX INFLOW/OUTFLOW ARE
  11290 C     SET TO OCCUR AT PRESSURE LEVELS 1 AND 10 RESPECTIVELY
  11291 C
  11292       C1 = 0.0
  11293       C2 = 0.0
  11294       KKMAX = MMDIMP-1
  11295       DO 150  KK=1,KKMAX
  11296          PSMID = ( PSTD(KK+1) + PSTD(KK) )/2.0
  11297          ARG1 = ABS( (PSMID - PSTD(1))/DEPTH1 )
  11298          ARG1 = ARG1*ARG1
  11299          C1 = C1 + EXP(-ARG1)*( PSTD(KK)-PSTD(KK+1) )
  11300          ARG2 = ABS( (PSMID - PSTD(KHIGH))/DEPTH2 )
  11301          ARG2 = ARG2*ARG2
  11302          C2 = C2 + EXP(-ARG2)*( PSTD(KK)-PSTD(KK+1) )
  11303   150 CONTINUE
  11304       C3 = -C1/C2
  11305 c && 2 comments
  11306 CC    WRITE(6,1400) C1, C2, C3
  11307 C1400 FORMAT('...C1, C2, C3=', 3(3X, E12.5) )
  11308 C
  11309 C     WHICH INDEX CORRESPONDS TO THE REPORTED DEPTH OF THE
  11310 C       CYCLONIC CIRCULATION (PTOPZ)?
  11311 C
  11312       KPTOP=KHIGH
  11313       DO KK=1,MMDIMP
  11314          IF(NINT(PSTD(KK)*10.) .GE. NINT(PTOPZ*10.))   KPTOP=KK
  11315          DO I = 1, IMAXA
  11316             ARG1 = ABS( (PSTD(KK) - PSTD(1))/DEPTH1 )
  11317             ARG1 = ARG1*ARG1
  11318             ARG2 = ABS( (PSTD(KK) - PSTD(KHIGH))/DEPTH2 )
  11319             ARG2 = ARG2*ARG2
  11320             UR(I,KK) = UR(I,1) * ( EXP(-ARG1) + C3*EXP(-ARG2) )
  11321          ENDDO
  11322       ENDDO
  11323 C
  11324 C     CALCULATE HEIGHTS FROM RADIAL EQUATION OF MOTION WITH IMPOSED
  11325 C     MERIDIONAL CIRCULATION. TURBULENT STRESS INCLUDED AT LOWEST
  11326 C     LAYER ONLY.
  11327 C
  11328 C     *********************** IMPORTANT NOTE **********************
  11329 C     THE HEIGHT FIELD Z(I,K) IS REALLY THE PERTURBATION HEIGHT
  11330 C     FIELD, I.E., Z(BOUNDARY,K) = 0. ON THE OTHER HAND, IN THE QLM

Page 306         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11331 C     CODE Z(I,K) IS THE FULL HEIGHT FIELD WITH Z(BOUNDARY,K) = WHATEVER
  11332 C     THE AZIMUTHALLY AVERAGED ANALYSIS SAYS IT SHOULD BE.
  11333 C     *************************************************************
  11334       IMAXM1 = IMAXA - 1
  11335       DO 300 K = 1, MMDIMP
  11336          KM1 = K - 1
  11337          DO 250 IR = 1, IMAXM1
  11338             I = IMAXA - IR
  11339             IP = I + 1
  11340             RX = (I - 1) * DELX
  11341             RXP1 = RX + DELX
  11342             RXSQ = RX * RX
  11343             RXP1SQ = RXP1 * RXP1
  11344             TERM1 = (0.5/9.8) * ( UR(IP,K)*UR(IP,K) - UR(I,K)*UR(I,K) )
  11345 C
  11346             IF(K.EQ.1) THEN
  11347                W(I,K) = 0.0
  11348                TERM2 = 0.0
  11349             ELSE
  11350                DPK = 100.0 * ( PSTD(KM1) - PSTD(K) )
  11351                W(I,K) = W(I,KM1) + DPK * (RXP1 *(UR(IP,KM1) + UR(IP,K))
  11352      1                  - RX * ( UR(I,KM1) + UR(I,K) ) )/(RXP1SQ - RXSQ)
  11353                TERM2 = (0.5*DELX/(9.8*DPK)) * ( W(IP,K)*( UR(IP,KM1)
  11354      1                 - UR(IP,K) ) + W(I,K)*( UR(I,KM1) - UR(I,K) ) )
  11355             END IF
  11356 C
  11357             IF(I.EQ.1) THEN
  11358                TERM3 = - (0.5*DELX/9.8) * ( VG(IP,K)*VG(IP,K)/RXP1 +
  11359      1                  CORF*VG(IP,K) )
  11360             ELSE
  11361                TERM3 = - (0.5*DELX/9.8) * ( VG(IP,K)*VG(IP,K)/RXP1 +
  11362      1               CORF*VG(IP,K) + VG(I,K)*VG(I,K)/RX + CORF*VG(I,K) )
  11363             END IF
  11364 C
  11365             IF(K.EQ.1) THEN
  11366                DZ = 1000.0
  11367                CDRG = 0.001 * ( 0.7 + 0.07*VG(I,K) )
  11368                CDRGP1 = 0.001 * ( 0.7 + 0.07*VG(IP,K) )
  11369                TERM4 = (0.5*DELX/(9.8*DZ)) * ( UR(IP,K)*VG(IP,K)*CDRGP1
  11370      1                 + UR(I,K)*VG(I,K)*CDRG )
  11371             ELSE
  11372                TERM4 = 0.0
  11373             END IF
  11374 C
  11375             Z(I,K)=Z(IP,K)+TERM1+TERM2+TERM3+TERM4
  11376 C
  11377   250    CONTINUE
  11378   300 CONTINUE
  11379 C
  11380 C     GET THE LAT/LON OF POINTS ON A CIRCLE AT R=RMAX
  11381 C
  11382       CALL CIRCLE(DTHETA,RMAXZ,STMLTZ,STMLNZ,MAXPTS,NPTS,RLATP,RLONP)
  11383       WRITE(6,309) DTHETA,(RLATP(NP),RLONP(NP),NP=1,NPTS)
  11384   309 FORMAT(/'...LAT/LON FOR POINTS ON A CIRCLE WITH DTHETA=',F6.1,
  11385      1       ' ARE:',/,(5X,2F9.2))
  11386 C
  11387 C     PREPARE FOR 1-D SPLINE FILTERING OF VORTICITY, DIVERGENCE

Page 307         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11388 C       BASIC GEOMETRY HAS BEEN ESTABLISHED BY FILTERING OF SURFACE
  11389 C       PRESSURE ABOVE
  11390 C
  11391       ZVORT=0.0
  11392       VGMX=-1.E10
  11393 C     VORTMX=-1.E10
  11394       URMX=1.E10
  11395 C     DIVMX=1.E10
  11396       SCLFAC=1.0E5
  11397       KYBC1=1
  11398       KYBC2=0
  11399 C
  11400       DO 470 K=1,KMAX
  11401          DO 400 I=1,IMAXA
  11402             Z(I,K)=Z(I,K)+XMODZ(K)
  11403             A2DVOR(I,K,1)=Z(I,K)
  11404             A2DVOR(I,K,2)=VG(I,K)
  11405             A2DVOR(I,K,3)=UR(I,K)
  11406             IF(I .NE. IMAXA .AND. I .NE. 1)  THEN
  11407                VORT(I,K)=(R(I+1)*VG(I+1,K)-R(I-1)*VG(I-1,K))/
  11408      1                   (2.0*DELX*R(I))
  11409                DIV (I,K)=(R(I+1)*UR(I+1,K)-R(I-1)*UR(I-1,K))/
  11410      1                   (2.0*DELX*R(I))
  11411                IF(VG(I,K) .GE. VGMX)  THEN
  11412                   VGMX=VG(I,K)
  11413                   IVGMX=I
  11414                ENDIF
  11415                IF(UR(I,K) .LE. URMX)  THEN
  11416                   URMX=UR(I,K)
  11417                   IURMX=I
  11418                ENDIF
  11419             ENDIF
  11420   400    CONTINUE
  11421 C
  11422          IF(K .LE. KPTOP)  THEN
  11423 C
  11424             IF(VORDIV)  THEN
  11425                LDXX=0
  11426                DO 410 I=IVGMX,IMAXA-1
  11427                   LDXX=LDXX+1
  11428       if(LDXX .GT. LDXDIM)  THEN
  11429          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  11430      $    'LDXX=',LDXX,', return'
  11431          return
  11432       endif
  11433                   SPLDTA(LDXX)=VORT(I,K)*SCLFAC
  11434                   YDZ(LDXX)=R(I)/1000.
  11435                   WDZ(LDXX)=1.0
  11436   410          CONTINUE
  11437 c && 3 comments
  11438 CC    IF(K .EQ. 1) WRITE(6,413) IFIX(PSTD(K)),(SPLDTA(LD),LD=1,LDXX)
  11439 CC413 FORMAT(/'...',I5,' MB UNFILTERED VORTICITY * 10**5 IS',/,
  11440 CC   1       (4X,10F10.3))
  11441 C
  11442                IVARZ=4
  11443                CALL XSPLCM(NX,YNB,YNT,YDCWL,KYBC1,KYBC2,YBCWL1,YBCWL2,
  11444      1                     SPLDTA,YDZ,WDZ,LDXX,SPLVOR,SPLNOD,IVARZ,

Page 308         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11445      1                     IPLVL,STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ)
  11446 C
  11447                LDXX=0
  11448                DO 430 I=IURMX,IMAXA-1
  11449                   LDXX=LDXX+1
  11450       if(LDXX .GT. LDXDIM)  THEN
  11451          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  11452      $    'LDXX=',LDXX,', return'
  11453          return
  11454       endif
  11455                   SPLDTA(LDXX)=DIV(I,K)*SCLFAC
  11456                   YDZ(LDXX)=R(I)/1000.
  11457                   WDZ(LDXX)=1.0
  11458   430          CONTINUE
  11459 c && 3 comments
  11460 CC    IF(K .EQ. 1) WRITE(6,433) IFIX(PSTD(K)),(SPLDTA(LD),LD=1,LDXX)
  11461 CC433 FORMAT(/'...',I5,' MB UNFILTERED DIVERGENCE * 10**5 IS',/,
  11462 CC   1       (4X,10F10.3))
  11463 C
  11464                IVARZ=5
  11465                CALL XSPLCM(NX,YNB,YNT,YDCWL,KYBC1,KYBC2,YBCWL1,YBCWL2,
  11466      1                     SPLDTA,YDZ,WDZ,LDXX,SPLDIV,SPLNOD,IVARZ,
  11467      1                     IPLVL,STMLTZ,STMLNZ,IUTCZ,IDATEZ,STMNMZ)
  11468 C
  11469 c && 2 comments
  11470 CC             WRITE(6,*) STMLTZ,STMLNZ,PSTD(K),SPLVOR(1)/SCLFAC,
  11471 CC   1                    SPLDIV(1)/SCLFAC,RHCEN(K)
  11472                WRITE(IUNTVD,*) STMLTZ,STMLNZ,PSTD(K),SPLVOR(1)/SCLFAC,
  11473      1                      SPLDIV(1)/SCLFAC,RHCEN(K)
  11474 C              WRITE(IUNTBH,*) STMLTZ,STMLNZ,PSTD(K),SPLVOR(1)/SCLFAC,
  11475 C    1                      SPLDIV(1)/SCLFAC,RHCEN(K)
  11476                VFCEN(K)=SPLVOR(1)
  11477                DFCEN(K)=SPLDIV(1)
  11478 C**DIAG
  11479 C              IF(K .EQ. 1)  THEN
  11480 C                 VORC(ICALL)=SPLVOR(1)
  11481 C                 DIVC(ICALL)=SPLDIV(1)
  11482 C              ENDIF
  11483                DO 450 NP=1,NPTS
  11484 c && 2 comments
  11485 CC                WRITE(6,*) RLATP(NP),RLONP(NP),PSTD(K),ZVORT,
  11486 CC   1                       SPLDIV(1)*DIVFAC/SCLFAC,RHCEN(K)
  11487                   WRITE(IUNTVD,*) RLATP(NP),RLONP(NP),PSTD(K),ZVORT,
  11488      1                            SPLDIV(1)*DIVFAC/SCLFAC,RHCEN(K)
  11489 C                 WRITE(IUNTBH,*) RLATP(NP),RLONP(NP),PSTD(K),ZVORT,
  11490 C    1                            SPLDIV(1)*DIVFAC/SCLFAC,RHCEN(K)
  11491   450          CONTINUE
  11492             ENDIF
  11493          ENDIF
  11494 
  11495   470 CONTINUE
  11496 C
  11497       WRITE(6,471) (PSTD(KK),KK=1,MMDIMP)
  11498 C     WRITE(IUNTBH,471) (PSTD(KK),KK=1,MMDIMP)
  11499   471 FORMAT(/9X,12F10.1)
  11500       WRITE(6,473) (R(I),(VG(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11501 C     WRITE(IUNTBH,473) (R(I),(VG(I,KK), KK=1,MMDIMP),I=1,IMXPOT)

Page 309         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11502   473 FORMAT(/'...VG ARE:', /, (3X,-3P,F6.1,0P,12F10.1))
  11503       WRITE(6,471) (PSTD(KK),KK=1,MMDIMP)
  11504 C     WRITE(IUNTBH,471) (PSTD(KK),KK=1,MMDIMP)
  11505       WRITE(6,475) (R(I),(UR(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11506 C     WRITE(IUNTBH,475) (R(I),(UR(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11507   475 FORMAT(/'...UR ARE:', /, (3X,-3P,F6.1,0P,12F10.1))
  11508       WRITE(6,471) (PSTD(KK),KK=1,MMDIMP)
  11509 C     WRITE(IUNTBH,471) (PSTD(KK),KK=1,MMDIMP)
  11510       WRITE(6,477) (R(I),(Z(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11511 C     WRITE(IUNTBH,477) (R(I),(Z(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11512   477 FORMAT(//, ' Z ARE;', /, (3X,-3P,F6.1,0P,12F10.1))
  11513       IF(VORDIV)  THEN
  11514          WRITE(6,471) (PSTD(KK),KK=1,MMDIMP)
  11515 C        WRITE(IUNTBH,471) (PSTD(KK),KK=1,MMDIMP)
  11516          WRITE(6,479) (R(I),(VORT(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11517 C        WRITE(IUNTBH,479) (R(I),(VORT(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11518   479 FORMAT(//, ' VORTICITY *10**5 ARE;', /, (3X,-3P,F6.1,5P,12F10.1))
  11519          WRITE(6,471) (PSTD(KK),KK=1,MMDIMP)
  11520 C        WRITE(IUNTBH,471) (PSTD(KK),KK=1,MMDIMP)
  11521          WRITE(6,481) (R(I),(DIV(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11522 C        WRITE(IUNTBH,481) (R(I),(DIV(I,KK), KK=1,MMDIMP),I=1,IMXPOT)
  11523   481 FORMAT(//, ' DIVERGENCE *10**5 ARE;', /, (3X,-3P,F6.1,5P,12F10.1))
  11524 C
  11525 C     PRINT PROFILE OF CENTRAL VORTICITY, DIVERGENCE AND REL. HUMIDITY
  11526 C
  11527          WRITE(6,487)
  11528          WRITE(IUNTBH,487)
  11529   487 FORMAT(/3X,'VERTICAL PROFILE OF FILTERED VORTICITY AND ',
  11530      1       'DIVERGENCE',/,9X,'PRES',4X,'REL.HUM.',2X,'VORTICITY',3X,
  11531      2       'DIVERGENCE * 10**5/SEC')
  11532          DO 490 K=KPTOP,1,-1
  11533             WRITE(6,489)  PSTD(K),RHCEN(K),VFCEN(K),DFCEN(K)
  11534             WRITE(IUNTBH,489)  PSTD(K),RHCEN(K),VFCEN(K),DFCEN(K)
  11535   489 FORMAT(5X,F8.1,2F10.1,2X,F10.1)
  11536   490    CONTINUE
  11537       ENDIF
  11538 C
  11539 C     COMPOSITE SURFACE PRESSURE IN THE SAME WAY AS THE OBSERVATIONS
  11540 C     **** WARNING:  RADIAL BIN INDICES ARE STORED IN VPSCOM.
  11541 C                    THEREFORE, VPSCOM MUST BE CALLED FIRST.  ****
  11542 C
  11543       CALL VPSCOM(PSA,R,NRDSTR,IMAXA)
  11544 C
  11545 C     COMPOSITE WINDS IN THE SAME WAY AS THE OBSERVATIONS
  11546 C
  11547       DO 550 ILV=1,KPTOP
  11548          DO 500 I=1,IMAXA
  11549             IF(IVOTYP .EQ. 2)  AXIWND(I)=UR(I,ILV)
  11550             AXIWND(IMAXA+I)=VG(I,ILV)
  11551   500    CONTINUE
  11552          PRESVO=PSTD(ILV)
  11553 c && 2 comments
  11554 CC       WRITE(6,501) (AXIWND(NZ),NZ=1,2*IMAXA)
  11555 CC501 FORMAT(/'...CALLING VWNCOM WITH AXIWND=',/,(3X,12F7.1))
  11556          CALL VWNCOM(IMAXA,ITWO,PRESVO,AXIWND,nrdstr)
  11557   550 CONTINUE
  11558 C

Page 310         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11559       WRITE(6,901)
  11560   901 FORMAT(/'...LEAVING AS2DVO.')
  11561       RETURN
  11562       END


ENTRY POINTS

  Name               
                     
 as2dvo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  11274                                                          11267                             
 11                         Label  11016                                                          11014,11015                       
 110                        Label  11284                                                          11281                             
 1100                       Label  11145                                                          11143,11144                       
 120                        Label  11285                                                          11280                             
 13                         Label  11031                                                          11027,11029                       
 15                         Label  11038                                                          11037                             
 150                        Label  11303                                                          11295                             
 19                         Label  11065                                                          11064                             
 20                         Label  11071                                                          11067                             
 21                         Label  11075                                                          11073,11074                       
 23                         Label  11091                                                          11089,11090                       
 25                         Label  11110                                                          11102                             
 250                        Label  11377                                                          11337                             
 30                         Label  11121                                                          11118                             
 300                        Label  11378                                                          11335                             
 309                        Label  11384                                                          11383                             
 40                         Label  11136                                                          11131                             
 400                        Label  11420                                                          11401                             
 410                        Label  11436                                                          11426                             
 42                         Label  11193                                                          11192                             
 43                         Label  11201                                                          11186                             
 430                        Label  11458                                                          11448                             
 44                         Label  11202                                                          11199                             
 450                        Label  11491                                                          11483                             
 47                         Label  11211                                                          11210                             
 470                        Label  11495                                                          11400                             
 471                        Label  11499                                                          11497,11503,11508,11514,11519     
 473                        Label  11502                                                          11500                             
 475                        Label  11507                                                          11505                             
 477                        Label  11512                                                          11510                             
 479                        Label  11518                                                          11516                             
 481                        Label  11523                                                          11521                             
 487                        Label  11529                                                          11527,11528                       
 489                        Label  11535                                                          11533,11534                       
 49                         Label  11221                                                          11219,11220                       
 490                        Label  11536                                                          11532                             
 5                          Label  10959                                                          10957                             
 500                        Label  11551                                                          11548                             
 550                        Label  11557                                                          11547                             

Page 311         Source Listing                  AS2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 60                         Label  11262                                                          11258                             
 7                          Label  10965                                                          10964                             
 9                          Label  10972                                                          10971                             
 90                         Label  11273                                                          11271                             
 901                        Label  11560                                                          11559                             
 A2DVOR                     Dummy  10885    R(4)            4     3     0        ARG,INOUT        11403,11404,11405                 
 ABRT1                      Subr   10967                                                          10967,10974,11039,11195           
 ABS                        Func   11103                                scalar                    11103,11106,11297,11300,11316,1131
                                                                                                  8                                 
 ALFA                       Local  10933    R(4)            4           scalar   SAVE             10933,11060,11064,11070           
 ARG1                       Local  11297    R(4)            4           scalar   SAVE             11297,11298,11299,11316,11317,1132
                                                                                                  0                                 
 ARG2                       Local  11300    R(4)            4           scalar   SAVE             11300,11301,11302,11318,11319,1132
                                                                                                  0                                 
 AS2DVO                     Subr   10883                                                                                            
 AXIWND                     Local  10913    R(4)            4     1     2000     SAVE             11053,11549,11550,11556           
 C1                         Local  11292    R(4)            4           scalar   SAVE             11292,11299,11304                 
 C2                         Local  11293    R(4)            4           scalar   SAVE             11293,11302,11304                 
 C3                         Local  11304    R(4)            4           scalar   SAVE             11304,11320                       
 CAT                        Local  11278    R(4)            4           scalar   SAVE             11278,11282                       
 CDRG                       Local  11367    R(4)            4           scalar   SAVE             11367,11370                       
 CDRGP1                     Local  11368    R(4)            4           scalar   SAVE             11368,11369                       
 CIRCLE                     Subr   11382                                                          11382                             
 CORF                       Local  11004    R(4)            4           scalar   SAVE             11004,11132,11260,11261,11359,1136
                                                                                                  2                                 
 CSWRL6                     Subr   11086                                                          11086                             
 DEGLAT                     Local  10932    R(4)            4           scalar   SAVE             10932,11178                       
 DELP                       Local  11060    R(4)            4           scalar   SAVE             11060,11061,11063,11064,11070     
 DELSP                      Dummy  10883    R(4)            4           scalar   ARG,INOUT        11177                             
 DELX                       Local  10955    R(4)            4           scalar   SAVE             10955,10958,11005,11006,11087,1125
                                                                                                  9,11260,11340,11341,11353,11358,11
                                                                                                  361,11369,11408,11410             
 DELXZ                      Dummy  10883    R(4)            4           scalar   ARG,INOUT        10955,11014,11015                 
 DENOM                      Local  11269    R(4)            4           scalar   SAVE             11269,11270                       
 DEPTH1                     Local  10991    R(4)            4           scalar   SAVE             10991,11014,11015,11297,11316     
 DEPTH2                     Local  10993    R(4)            4           scalar   SAVE             10993,10995,10997,11014,11015,1130
                                                                                                  0,11318                           
 DFCEN                      Local  10917    R(4)            4     1     12       SAVE             11477,11533,11534                 
 DIV                        Local  10916    R(4)            4     2     12000    SAVE             11052,11409,11455,11521           
 DIVFAC                     Dummy  10885    R(4)            4           scalar   ARG,INOUT        11488                             
 DIVVAR                     Local  10933    R(4)            4           scalar   SAVE             10933,10982                       
 DPK                        Local  11350    R(4)            4           scalar   SAVE             11350,11351,11353                 
 DTHETA                     Local  10934    R(4)            4           scalar   SAVE             10934,11382,11383                 
 DYNODE                     Local  11177    R(4)            4           scalar   SAVE             11177,11178,11181,11182,11188     
 DZ                         Local  11366    R(4)            4           scalar   SAVE             11366,11369                       
 EE                         Local  10933    R(4)            4           scalar   SAVE             10933,10956                       
 EPS                        Local  11248    R(4)            4           scalar   SAVE             11248,11260                       
 EXP                        Func   11070                                scalar                    11070,11299,11302,11320           
 FF                         Local  11270    R(4)            4           scalar   SAVE             11270,11272                       
 FIRST                      Local  10905    L(4)            4           scalar   SAVE             10932,10951,10952                 
 I                          Local  10957    I(4)            4           scalar   SAVE             10957,10958,11067,11068,11070,1107
                                                                                                  3,11074,11102,11103,11104,11105,11
                                                                                                  108,11109,11118,11119,11120,11131,
                                                                                                  11132,11133,11134,11135,11143,1114
                                                                                                  4,11315,11320,11338,11339,11340,11

Page 312         Source Listing                  AS2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  344,11347,11351,11352,11354,11357,
                                                                                                  11362,11367,11370,11375,11401,1140
                                                                                                  2,11403,11404,11405,11406,11407,11
                                                                                                  408,11409,11410,11411,11412,11413,
                                                                                                  11415,11416,11417,11426,11433,1143
                                                                                                  4,11448,11455,11456,11500,11505,11
                                                                                                  510,11516,11521,11548,11549,11550 
 IDATEZ                     Dummy  10886    I(4)            4           scalar   ARG,INOUT        11216,11445,11467                 
 IER                        Dummy  10886    I(4)            4           scalar   ARG,INOUT        11086,11088,11089,11090           
 ILV                        Local  11547    I(4)            4           scalar   SAVE             11547,11549,11550,11552           
 IMAXA                      Dummy  10886    I(4)            4           scalar   ARG,INOUT        11005,11028,11030,11036,11037,1106
                                                                                                  7,11073,11074,11130,11131,11132,11
                                                                                                  133,11143,11144,11176,11186,11204,
                                                                                                  11206,11207,11208,11258,11271,1128
                                                                                                  1,11315,11334,11338,11401,11406,11
                                                                                                  426,11448,11543,11548,11550,11556 
 IMAXM1                     Local  11334    I(4)            4           scalar   SAVE             11334,11337                       
 IMXPOT                     Local  11006    I(4)            4           scalar   SAVE             11006,11028,11030,11079,11086,1110
                                                                                                  2,11130,11131,11500,11505,11510,11
                                                                                                  516,11521                         
 IMXZRO                     Local  11100    I(4)            4           scalar   SAVE             11100,11104,11118,11119           
 IN                         Local  11186    I(4)            4           scalar   SAVE             11186,11187,11188                 
 IP                         Local  11339    I(4)            4           scalar   SAVE             11339,11344,11351,11353,11354,1135
                                                                                                  8,11359,11361,11362,11368,11369,11
                                                                                                  375                               
 IPLVL                      Local  11172    I(4)            4           scalar   SAVE             11172,11215,11445,11467           
 IPTS                       Local  11130    I(4)            4           scalar   SAVE             11130,11132,11133                 
 IR                         Local  11258    I(4)            4           scalar   SAVE             11258,11259,11260,11271,11272,1128
                                                                                                  1,11282,11337,11338               
 ITWO                       Local  10933    I(4)            4           scalar   SAVE             10933,11556                       
 IUNTBH                     Dummy  10883    I(4)            4           scalar   ARG,INOUT        11015,11029,11074,11086,11090,1114
                                                                                                  4,11220,11528,11534               
 IUNTVD                     Dummy  10883    I(4)            4           scalar   ARG,INOUT        10981,10982,10983,11472,11487     
 IURMX                      Local  11417    I(4)            4           scalar   SAVE             11417,11448                       
 IUTCZ                      Dummy  10886    I(4)            4           scalar   ARG,INOUT        11216,11445,11467                 
 IVARZ                      Local  11171    I(4)            4           scalar   SAVE             11171,11215,11442,11444,11464,1146
                                                                                                  6                                 
 IVGMX                      Local  11413    I(4)            4           scalar   SAVE             11413,11426                       
 IVOTYP                     Dummy  10883    I(4)            4           scalar   ARG,INOUT        11549                             
 K                          Local  11267    I(4)            4           scalar   SAVE             11267,11268,11272,11280,11282,1133
                                                                                                  5,11336,11344,11346,11347,11350,11
                                                                                                  351,11352,11353,11354,11358,11359,
                                                                                                  11361,11362,11365,11367,11368,1136
                                                                                                  9,11370,11375,11400,11402,11403,11
                                                                                                  404,11405,11407,11409,11411,11412,
                                                                                                  11415,11416,11422,11433,11455,1147
                                                                                                  2,11473,11476,11477,11487,11488,11
                                                                                                  532,11533,11534                   
 KHIGH                      Local  11249    I(4)            4           scalar   SAVE             11249,11250,11254,11257,11260,1126
                                                                                                  7,11272,11280,11282,11283,11300,11
                                                                                                  312,11318                         
 KINF                       Local  11254    I(4)            4           scalar   SAVE             11254,11255                       
 KK                         Local  11295    I(4)            4           scalar   SAVE             11295,11296,11299,11302,11313,1131
                                                                                                  4,11316,11318,11320,11497,11500,11
                                                                                                  503,11505,11508,11510,11514,11516,

Page 313         Source Listing                  AS2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  11519,11521                       
 KKMAX                      Local  11294    I(4)            4           scalar   SAVE             11294,11295                       
 KM1                        Local  11336    I(4)            4           scalar   SAVE             11336,11350,11351,11352,11353,1135
                                                                                                  4                                 
 KMAX                       Local  11279    I(4)            4           scalar   SAVE             11279,11280,11282,11283,11400     
 KPTOP                      Local  11312    I(4)            4           scalar   SAVE             11312,11314,11422,11532,11547     
 KYBC1                      Local  11179    I(4)            4           scalar   SAVE             11179,11214,11397,11443,11465     
 KYBC2                      Local  11180    I(4)            4           scalar   SAVE             11180,11214,11398,11443,11465     
 LDXDIM                     Param  10892    I(4)            4           scalar                    10919,10920,11428,11429,11450,1145
                                                                                                  1                                 
 LDXX                       Local  11204    I(4)            4           scalar   SAVE             11204,11215,11425,11427,11428,1143
                                                                                                  0,11433,11434,11435,11444,11447,11
                                                                                                  449,11450,11452,11455,11456,11457,
                                                                                                  11466                             
 MAXPL                      Dummy  10885    I(4)            4           scalar   ARG,INOUT        10954                             
 MAXPTS                     Param  10893    I(4)            4           scalar                    10922,11382                       
 MAXVOP                     Dummy  10885    I(4)            4           scalar   ARG,INOUT        10915,10970,10971                 
 MAXVOR                     Dummy  10885    I(4)            4           scalar   ARG,INOUT        10915,10963,10964                 
 MAXVOV                     Dummy  10885    I(4)            4           scalar   ARG,INOUT        10915                             
 MMDIMP                     Param  10888    I(4)            4           scalar                    10910,10912,10913,10916,10917,1093
                                                                                                  4,10954,10970,10971,11279,11294,11
                                                                                                  313,11335,11497,11500,11503,11505,
                                                                                                  11508,11510,11514,11516,11519,1152
                                                                                                  1                                 
 MMDIMR                     Param  10889    I(4)            4           scalar                    10910,10911,10912,10913,10916,1095
                                                                                                  7,10963,10964,11036,11037,11087   
 NDIM                       Param  10890    I(4)            4           scalar                    10919,10920,11191,11192           
 NINT                       Func   10992                                scalar                    10992,10994,11314                 
 NP                         Local  11383    I(4)            4           scalar   SAVE             11383,11483,11487                 
 NPTS                       Local  11382    I(4)            4           scalar   SAVE             11382,11383,11483                 
 NRDSTR                     Local  10910    I(4)            4     1     1000     SAVE             11543,11556                       
 NX                         Local  11184    I(4)            4           scalar   SAVE             11184,11189,11191,11192,11214,1144
                                                                                                  3,11465                           
 PB                         Local  11003    R(4)            4           scalar   SAVE             11003,11027,11029,11061,11064     
 PBZ                        Dummy  10884    R(4)            4           scalar   ARG,INOUT        11003                             
 PC                         Local  11002    R(4)            4           scalar   SAVE             11002,11027,11029,11061,11063,1106
                                                                                                  4,11086                           
 PCENF                      Dummy  10885    R(4)            4           scalar   ARG,INOUT        11218,11219,11220                 
 PCZ                        Dummy  10884    R(4)            4           scalar   ARG,INOUT        11002                             
 PHIGH                      Local  11250    R(4)            4           scalar   SAVE             11250,11269                       
 PI                         Local  10932    R(4)            4           scalar   SAVE             10932,10953                       
 PI486                      Local  10953    R(4)            4           scalar   SAVE             10953,11004                       
 PINF                       Local  11255    R(4)            4           scalar   SAVE             11255,11268,11269                 
 PLOW                       Local  11256    R(4)            4           scalar   SAVE             11256,11268,11269                 
 PMAX                       Local  11063    R(4)            4           scalar   SAVE             11063,11064,11070                 
 PPOT                       Local  11079    R(4)            4           scalar   SAVE             11079,11086                       
 PRESVO                     Local  11552    R(4)            4           scalar   SAVE             11552,11556                       
 PSA                        Local  10911    R(4)            4     1     1000     SAVE             11046,11070,11073,11074,11079,1108
                                                                                                  7,11143,11144,11208,11543         
 PSMID                      Local  11296    R(4)            4           scalar   SAVE             11296,11297,11300                 
 PSTD                       Local  10910    R(4)            4     1     12       SAVE             10924,11250,11255,11256,11268,1129
                                                                                                  6,11297,11299,11300,11302,11314,11
                                                                                                  316,11318,11350,11472,11487,11497,
                                                                                                  11503,11508,11514,11519,11533,1153
                                                                                                  4,11552                           

Page 314         Source Listing                  AS2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PTOPZ                      Dummy  10884    R(4)            4           scalar   ARG,INOUT        10992,10994,11014,11015,11314     
 R                          Local  10910    R(4)            4     1     1000     SAVE             10958,11068,11176,11206,11407,1140
                                                                                                  8,11409,11410,11434,11456,11500,11
                                                                                                  505,11510,11516,11521,11543       
 RDR                        Local  11068    R(4)            4           scalar   SAVE             11068,11069                       
 REAL                       Func   11119                                scalar                    11119,11132,11133                 
 REE                        Local  10956    R(4)            4           scalar   SAVE             10956,11061                       
 RHCEN                      Local  10917    R(4)            4     1     12       SAVE             10934,11473,11488,11533,11534     
 RHVAR                      Local  10934    R(4)            4           scalar   SAVE             10934,10983                       
 RLATP                      Local  10922    R(4)            4     1     20       SAVE             11382,11383,11487                 
 RLONP                      Local  10922    R(4)            4     1     20       SAVE             11382,11383,11487                 
 RMAX                       Local  11000    R(4)            4           scalar   SAVE             11000,11005,11027,11029,11068     
 RMAXZ                      Dummy  10884    R(4)            4           scalar   ARG,INOUT        11000,11382                       
 RPOT                       Local  11001    R(4)            4           scalar   SAVE             11001,11006,11027,11029,11086     
 RPOTZ                      Dummy  10884    R(4)            4           scalar   ARG,INOUT        11001                             
 RR                         Local  11259    R(4)            4           scalar   SAVE             11259,11260,11261                 
 RSQ                        Local  11069    R(4)            4           scalar   SAVE             11069,11070                       
 RX                         Local  11340    R(4)            4           scalar   SAVE             11340,11341,11342,11352,11362     
 RXP1                       Local  11341    R(4)            4           scalar   SAVE             11341,11343,11351,11358,11361     
 RXP1SQ                     Local  11343    R(4)            4           scalar   SAVE             11343,11352                       
 RXSQ                       Local  11342    R(4)            4           scalar   SAVE             11342,11352                       
 SCLFAC                     Local  11396    R(4)            4           scalar   SAVE             11396,11433,11455,11472,11473,1148
                                                                                                  8                                 
 SIGN                       Func   11132                                scalar                    11132                             
 SINDEG_8                   Func   10908    R(8)            8           scalar                    11004                             
 SP1DWL                     Dummy  10883    R(4)            4           scalar   ARG,INOUT        11014,11015,11178,11210           
 SPLDIV                     Local  10920    R(4)            4     1     8000     SAVE             11466,11473,11477,11488           
 SPLDTA                     Local  10919    R(4)            4     1     8000     SAVE             11208,11215,11433,11444,11455,1146
                                                                                                  6                                 
 SPLFIT                     Local  10919    R(4)            4     1     71       SAVE             11215,11218                       
 SPLNOD                     Local  10920    R(4)            4     1     71       SAVE             11185,11187,11188,11215,11444,1146
                                                                                                  6                                 
 SPLVOR                     Local  10920    R(4)            4     1     8000     SAVE             11444,11472,11476                 
 SQRT                       Func   11060                                scalar                    11060,11070                       
 STMLNZ                     Local  11174    R(4)            4           scalar   SAVE             11174,11216,11382,11445,11467,1147
                                                                                                  2                                 
 STMLTZ                     Local  11173    R(4)            4           scalar   SAVE             11173,11216,11382,11445,11467,1147
                                                                                                  2                                 
 STMNMZ                     Dummy  10886    CHAR                        scalar   ARG,INOUT        11014,11015,11216,11445,11467     
 TANH                       Func   11268                                scalar                    11268,11269                       
 TERM1                      Local  11344    R(4)            4           scalar   SAVE             11344,11375                       
 TERM2                      Local  11348    R(4)            4           scalar   SAVE             11348,11353,11375                 
 TERM3                      Local  11358    R(4)            4           scalar   SAVE             11358,11361,11375                 
 TERM4                      Local  11369    R(4)            4           scalar   SAVE             11369,11372,11375                 
 UPOT                       Dummy  10884    R(4)            4           scalar   ARG,INOUT        11027,11029,11086,11133           
 UR                         Local  10912    R(4)            4     2     12000    SAVE             11048,11109,11135,11320,11344,1135
                                                                                                  1,11352,11353,11354,11369,11370,11
                                                                                                  405,11409,11415,11416,11505,11549 
 URAD                       Local  10911    R(4)            4     1     1000     SAVE             11045,11087,11109,11133,11135     
 URMX                       Local  11394    R(4)            4           scalar   SAVE             11394,11415,11416                 
 VFCEN                      Local  10917    R(4)            4     1     12       SAVE             11476,11533,11534                 
 VG                         Local  10912    R(4)            4     2     12000    SAVE             11047,11108,11120,11134,11257,1126
                                                                                                  0,11272,11282,11358,11359,11361,11
                                                                                                  362,11367,11368,11369,11370,11404,
                                                                                                  11407,11411,11412,11500,11550     

Page 315         Source Listing                  AS2DVO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VGMX                       Local  11392    R(4)            4           scalar   SAVE             11392,11411,11412                 
 VORDIV                     Dummy  10886    L(4)            4           scalar   ARG,INOUT        10980,11424,11513                 
 VORT                       Local  10916    R(4)            4     2     12000    SAVE             11051,11407,11433,11516           
 VORVAR                     Local  10933    R(4)            4           scalar   SAVE             10933,10981                       
 VPOT                       Dummy  10884    R(4)            4           scalar   ARG,INOUT        11027,11029,11086,11132           
 VPSCOM                     Subr   11543                                                          11543                             
 VT                         Local  10911    R(4)            4     1     1000     SAVE             11044,11087,11103,11105,11108,1111
                                                                                                  9,11120,11132,11134,11260,11272   
 VTBOG                      Dummy  10884    R(4)            4           scalar   ARG,INOUT        11132                             
 VTZ                        Local  11105    R(4)            4           scalar   SAVE             11105,11106,11119                 
 VTZZ                       Local  11101    R(4)            4           scalar   SAVE             11101,11103,11106                 
 VWNCOM                     Subr   11556                                                          11556                             
 W                          Local  10913    R(4)            4     2     12000    SAVE             11049,11347,11351,11353,11354     
 WDZ                        Local  10919    R(4)            4     1     8000     SAVE             11207,11215,11435,11444,11457,1146
                                                                                                  6                                 
 XLATC                      Dummy  10883    R(4)            4           scalar   ARG,INOUT        11004,11014,11015,11027,11029,1108
                                                                                                  6,11173                           
 XLONC                      Dummy  10884    R(4)            4           scalar   ARG,INOUT        11027,11029,11174                 
 XMODZ                      Local  10910    R(4)            4     1     12       SAVE             10927,11402                       
 XNUMER                     Local  11268    R(4)            4           scalar   SAVE             11268,11270                       
 XSPLCM                     Subr   11214                                                          11214,11443,11465                 
 YBCWL1                     Local  11181    R(4)            4           scalar   SAVE             11181,11214,11443,11465           
 YBCWL2                     Local  11182    R(4)            4           scalar   SAVE             11182,11214,11443,11465           
 YDCWL                      Local  11178    R(4)            4           scalar   SAVE             11178,11214,11443,11465           
 YDZ                        Local  10919    R(4)            4     1     8000     SAVE             11206,11215,11434,11444,11456,1146
                                                                                                  6                                 
 YNB                        Local  11175    R(4)            4           scalar   SAVE             11175,11214,11443,11465           
 YNT                        Local  11176    R(4)            4           scalar   SAVE             11176,11187,11214,11443,11465     
 Z                          Local  10912    R(4)            4     2     12000    SAVE             11050,11375,11402,11403,11510     
 ZVORT                      Local  11391    R(4)            4           scalar   SAVE             11391,11487                       

Page 316         Source Listing                  AS2DVO
2017-04-18 11:09                                 syndata.f

  11563 
  11564 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  11565 C                .      .    .                                       .
  11566 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  11567 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  11568 C
  11569 C ABSTRACT: ??????????????????????????????????????????????????????????
  11570 C   ??????????????????????????????????????????????????????????????????
  11571 C
  11572 C PROGRAM HISTORY LOG:
  11573 C ????-??-??  S. J. LORD
  11574 C
  11575 C USAGE:    CALL ????????(????)
  11576 C   INPUT ARGUMENT LIST:
  11577 C     ??????   - ???????????????????????????????????????????????
  11578 C
  11579 C   OUTPUT ARGUMENT LIST:
  11580 C     ??????   - ???????????????????????????????????????????????
  11581 C
  11582 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  11583 C     ??????   - ???????????????????????????????????????????????
  11584 C
  11585 C   OUTPUT FILES:
  11586 C     ??????   - ???????????????????????????????????????????????
  11587 C
  11588 C REMARKS: ?????????????????????????????????????????????????????
  11589 C
  11590 C ATTRIBUTES:
  11591 C   LANGUAGE: FORTRAN 90
  11592 C   MACHINE:  NCEP WCOSS
  11593 C
  11594 C$$$
  11595       SUBROUTINE CSWRL6(IER,IUNTBH,IMAXA,UPOT,VPOT,RMAX,PC,PB,XLATC,
  11596      1                  MMDIMR,DELRMM,VT,URAD,PSA)
  11597 C
  11598 C
  11599 C     *******************    PROGRAM CSWRL6   *************************
  11600 C
  11601 C     THIS PROGRAM DETERMINES THE STEADY AZIMUTHAL VELOCITY FIELD AND
  11602 C     PRESSURE DISTRIBUTION GENERATED BY A STEADY SPECIFIED MERIDIONAL
  11603 C     CIRCULATION IN A SLAB BOUNDARY LAYER ON AN F-PLANE.  THE
  11604 C     VORTEX IS CONSIDERED TO BE HYDROSTATIC AND AXISYMMETRIC.  THE
  11605 C     MERIDIONAL CIRCULATION IS CHARACTERIZED BY AN ANNULAR GAUSSIAN
  11606 C     UPDRAFT AND AN OUTER REGION OF CONSTANT BOUNDARY LAYER MASS FLUX.
  11607 C     AN AERODYNAMIC DRAG LAW IS USED TO PARAMETERIZE THE TURBULENT
  11608 C     STRESS AT THE SEA SURFACE.  THE AZIMUTHAL VELOCITY IS SET TO ZERO
  11609 C     OR SOME BACKGROUND ENVIRONMENTAL VALUE AT THE STORM RADIUS.  A
  11610 C     SMALL RADIAL INFLOW IS REQUIRED AT THE STORM RADIUS.
  11611 C
  11612 C
  11613 C     THE MODEL VORTEX IS INTENDED AS A "BOGUS" VORTEX CANDIDATE FOR
  11614 C     NUMERICAL HURRICANE MODELS.  INPUT PARAMETERS ARE THE CORIOLIS
  11615 C     PARAMETER, STORM RADIUS (E.G. RADIUS OF OUTERMOST CLOSED ISOBAR),
  11616 C     PRESSURE OF OUTERMOST CLOSED ISOBAR AND CENTRAL PRESSURE.
  11617 C
  11618 C
  11619 C     THE VELOCITY AND PRESSURE FIELDS ARE CALCULATED ON A FINE GRID

Page 317         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11620 C     BY AN ITERATIVE PROCEDURE:
  11621 C     (1) A LARGE VALUE OF UPDRAFT RADIUS IS GUESSED.
  11622 C     (2) RADIAL AND VERTICAL VELOCITY FIELDS ARE COMPUTED
  11623 C     (3) TANGENTIAL WIND IS RECOVERED FROM TANGENTIAL EQUATION OF
  11624 C         MOTION
  11625 C     (4) PRESSURE IS COMPUTED FROM RADIAL EQUATION OF MOTION
  11626 C     (5) COMPUTED CENTRAL PRESSURE IS COMPARED WITH OBSERVED CENTRAL
  11627 C         PRESSURE.  IF THE COMPUTED VALUE IS TOO LARGE THEN THE UPDRAFT
  11628 C         RADIUS IS DECREASED A TINY BIT (SAY 100 M) AND WE GO BACK
  11629 C         TO STEP (1)
  11630 C
  11631 C             **********    NOTE *************
  11632 C     DIMENSIONAL QUANTITIES ARE EXPRESSED IN SI UNITS EXCEPT POSSIBLY
  11633 C     WHEN INPUT TO OR OUTPUT FROM PROGRAM.
  11634 C
  11635 C     THE INDEPENDENT VARIABLE IS:
  11636 C
  11637 C     R: CYLINDRICAL POLAR RADIUS
  11638 C
  11639 C     THE DEPENDENT VARIABLES ARE:
  11640 C
  11641 C     V(R):      AZIMUTHAL "SWIRLING" VELOCITY
  11642 C     U(R):      RADIAL VELOCITY
  11643 C     W(R):      "VERTICAL" VELOCITY, DP/DT
  11644 C     XM(R):     RELATIVE ANGULAR MOMENTUM
  11645 C     P(R):      SEA LEVEL PRESSURE
  11646 C
  11647 C     THE GOVERNING AND DERIVED PARAMETERS ARE:
  11648 C
  11649 C     XLATC:    LATITUDE OF STORM CENTER
  11650 C     F:      CORIOLIS PARAMETER
  11651 C     G:      ACCELERATION DUE TO GRAVITY
  11652 C     CD:     DRAG COEFFICIENT (VARIES LINEARLY WITH WIND SPEED)
  11653 C     DP:     CHARACTERISTIC PRESSURE THICKNESS OF BOUNDARY LAYER
  11654 C     PC:     CENTRAL SEA LEVEL PRESSURE
  11655 C     PB:     SEA LEVEL PRESSURE OF OUTERMOST CLOSED ISOBAR
  11656 C     RHOS:   CHARACTERISTIC SURFACE DENSITY
  11657 C     RMAXU:  RADIUS OF MAXIMUM RADIAL INFLOW
  11658 C     RUP:    UPDRAFT RADIUS
  11659 C     R18:    RADIUS OF 18 M/S WIND
  11660 C     R33:    RADIUS OF 33 M/S WIND (HURRICANE FORCE WIND)
  11661 C     RMW:    RADIUS OF MAXIMUM AZIMUTHAL VELOCITY
  11662 C     RPOT:   POTENTIAL RADIUS.  IN PRACTICE IT MAY BE TAKEN AS THE
  11663 C             RADIUS OF THE OUTERMOST CLOSED ISOBAR.
  11664 C     VPOT:   VELOCITY AT THE POTENTIAL RADIUS.  MAY BE SET TO ZERO
  11665 C             OR SOME MEAN ENVIRONMENTAL VALUE AT RPOT.
  11666 C     VRMW:   V(RMW), PEAK AZIMUTHAL VELOCITY
  11667 C     Q:      MERIDIONAL BOUNDARY LAYER VOLUME FLUX
  11668 C     D:      UPDRAFT DIAMETER: DISTANCE BETWEEN E-FOLDING RADII.
  11669 C     S:      D/(2*SQRT(2))
  11670 C     XK:      A NON-DIMENSIONAL PARAMETER IN THE ODE
  11671 C
  11672 C     ******************************************************************
  11673 C
  11674 C
  11675       SAVE
  11676 C

Page 318         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11677       LOGICAL FIRST
  11678 
  11679       REAL(8)  SINDEG_8
  11680 C
  11681       DIMENSION  R(2001), X(2001), U(2001), E(2001), VV(2001),
  11682      1       V(2001), W(2001), P(2001), SUMCO(2001), SUMCL(2001),
  11683      2       SUMDR(2001), PCO(2001), PMER(2001), PCL(2001), PDR(2001),
  11684      3       XM(2001), VT(MMDIMR), URAD(MMDIMR), PSA(MMDIMR),
  11685      4       VORTFM(2001),DIVFM(2001)
  11686       DATA PI/3.1415927/,FIRST/.TRUE./
  11687 C
  11688 C
  11689 C2500 FORMAT(///, '***** OUTPUT FROM RUNGE-KUTTA SCHEME *****', //)
  11690 C2600 FORMAT(' IX', 7X, 'X(IX)', 11X, 'Y', 9X, //)
  11691 C3900 FORMAT(2X, 'IR', 5X, 'R (KM)', 10X, 'M', 10X, 'V (M/S)', //)
  11692 C
  11693 C
  11694 C     SPECIFY INPUT AND GRID PARAMETERS.  PB, PC, XLATC, AND RMAX ARE
  11695 C     SUPPLIED BY THE MAIN PROGRAM (WHICH GETS THEM FROM THE NATIONAL
  11696 C     HURRICANE CENTER).  PC AND PB WILL BE CONVERTED TO PASCALS FOR USE
  11697 C     IN THIS SUBROUTINE.  PRESSURE WILL BE CONVERTED BACK TO MILLIBARS
  11698 C     AT THE END OF THE SUBROUTINE.
  11699 C
  11700       IF(FIRST)  THEN
  11701       FIRST=.FALSE.
  11702       IOUT = 6
  11703       G = 9.806
  11704       RHOS = 1.1
  11705       RHOSG=RHOS*G
  11706       DP = 0.10E+5
  11707       SQRT2=SQRT(2.)
  11708       SQRPI2=SQRT(PI/2.)
  11709       PI486=4.0*PI/86400.
  11710       ENDIF
  11711 C
  11712       VORTFM=0.0
  11713       DIVFM=0.0
  11714 
  11715       NBLOW=0
  11716       RPOT = RMAX
  11717       NR=NINT(RPOT*1.E-3)
  11718       DELR = RPOT/(NR - 1.)
  11719       PB = PB * 100.
  11720       PC = PC * 100.
  11721       F = ABS(PI486*SINDEG_8(XLATC))
  11722       Q = - UPOT * RPOT
  11723 C
  11724       SQRQBF=SQRT(Q/F)
  11725       SQRFBQ=SQRT(F/Q)
  11726       SQRQTF=SQRT(Q*F)
  11727       XK = SQRQBF*RHOSG/DP
  11728       HDELR=0.5*DELR
  11729 C
  11730 C
  11731 C     THE UPCOMING DO LOOP TAKES UP MOST OF THE PROGRAM.  Q AND THE
  11732 C     MAXIMUM UPDRAFT VELOCITY ARE PRESCRIBED.  THE UPDRAFT WIDTH IS
  11733 C     A FUNCTION OF Q AND THE UPDRAFT RADIUS.  THE UPDRAFT RADIUS

Page 319         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11734 C     IS PRESCRIBED AND THE VELOCITY AND PRESSURE FIELDS ARE CALCULATED.
  11735 C     IF THE COMPUTED CENTRAL SEA LEVEL PRESSURE IS GREATER THAN THE
  11736 C     OBSERVED VALUE THEN THE UPDRAFT RADIUS IS DECREASED AND THE FLOW
  11737 C     RECALCULATED.  THIS PROCESS CONTINUES UNTIL  P(1) = OBSERVED
  11738 C     CENTRAL SEA LEVEL PRESSURE.
  11739 C
  11740 C
  11741  9999 ITER=0
  11742       RESIDO=1.E10
  11743       IF(NBLOW .EQ. 0)  THEN
  11744       RUP = MIN(100.,RPOT*0.50E-3) * 1000.
  11745       RUPSV = RUP
  11746       ENDIF
  11747       PDIF = PB - PC
  11748       IF(PDIF .LT. 10.*100.) THEN
  11749         A = 1.0 * RHOSG/DP
  11750       ELSE
  11751         A = 2.0 * RHOSG/DP
  11752       END IF
  11753       WRITE(IOUT,2000) DELR,NR,F,Q,RUP,PB*0.01
  11754       WRITE(IUNTBH,2000) DELR,NR,F,Q,RUP,PB*0.01
  11755 2000  FORMAT(/'...DELR=',-3PF7.1,' KM',4X,'NR=',I4,4X,'F=',0PE12.5,4X,
  11756      1       'Q=', E12.5,' RUP=',-3PF8.2,' KM, PB=',0PF9.3,' MB.', //)
  11757       DO 30 L = 1, 1000
  11758       ITER=ITER+1
  11759       S = Q/(A*RUP*SQRT(2.*PI))
  11760       D = 2.*SQRT2*S
  11761       XNARG = RUP/(S*SQRT2)
  11762       IF(XNARG.GT.5.) THEN
  11763         C1 = 0.
  11764       ELSE
  11765         C1 = EXP( -XNARG*XNARG )
  11766       END IF
  11767       C2 = - ERRF(XNARG)
  11768       C3 = C1*S - RUP*SQRPI2*(C2 - 1.)
  11769 C
  11770 C
  11771 C     NON-DIMENSIONALIZE (ND) THE VARIABLES.  X IS ND RADIUS.  XUP,
  11772 C     ETC. ARE ND RUP, RMAXU, RPOT, ETC. .
  11773 C
  11774 C
  11775       DELX = DELR * SQRFBQ
  11776       XUP = RUP * SQRFBQ
  11777 C
  11778 C
  11779 C     EVALUATE SPECIFIED DIMENSIONAL MERIDIONAL VELOCITY FIELD.  "VV"
  11780 C     IS THE VERTICAL VELOCITY, DZ/DT (M/S).  ALSO, A USEFUL ND
  11781 C     QUANTITY, E(IX), IS COMPUTED FOR USE THROUGHOUT THE PROGRAM.
  11782 C     SINCE THE COEFFICIENTS IN THE ODE AS WELL AS THE RADIAL VELOCITY
  11783 C     COMPONENT APPROACH INDETERMINATE FORMS 0/0 AS THE RADIUS GOES
  11784 C     TO 0, A TINY NON-ZERO QUANTITY IS USED IN PLACE OF 0.
  11785 C
  11786 C
  11787       X(1) = 0.001 * XUP
  11788       R(1) = SQRQBF * X(1)
  11789       XNARG = ( R(1) - RUP )/(S*SQRT2)
  11790       IF(XNARG.LT.-5.) THEN

Page 320         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11791         E(1) = ( -S*C1 + RUP*SQRPI2*(C2 - ERRF(XNARG)) )/C3
  11792         W(1) = 0.
  11793       ELSE
  11794         E(1) = ( S*( EXP(-XNARG*XNARG) - C1 ) +
  11795      1             RUP*SQRPI2*(C2 - ERRF(XNARG)) )/C3
  11796         W(1) = - A*DP*EXP(-XNARG*XNARG)
  11797       END IF
  11798       U(1) = Q*E(1)/R(1)
  11799       VV(1) = - W(1)/(RHOSG)
  11800       NX = NR
  11801       DO 40 IX = 2, NX
  11802         X(IX) = (IX - 1.)*DELX
  11803         R(IX) = SQRQBF * X(IX)
  11804         XNARG = (R(IX)-RUP)/(S*SQRT2)
  11805         IF(XNARG.GT.5.) THEN
  11806           E(IX) = - 1.0
  11807           W(IX) = 0.0
  11808         ELSE IF(XNARG.LT.-5.) THEN
  11809           E(IX) = ( -S*C1 + RUP*SQRPI2*(C2 - ERRF(XNARG)) )/C3
  11810           W(IX) = 0.0
  11811         ELSE
  11812           E(IX) = ( S*( EXP(-XNARG*XNARG) - C1 ) +
  11813      1             RUP*SQRPI2*(C2 - ERRF(XNARG)) )/C3
  11814           W(IX) = - A*DP*EXP(-XNARG*XNARG)
  11815         END IF
  11816         U(IX) = Q*E(IX)/R(IX)
  11817         VV(IX) = - W(IX)/(RHOSG)
  11818 40      CONTINUE
  11819 C
  11820 C
  11821 C     THE AZIMUTHAL EQUATION OF MOTION IS A FIRST ORDER NONLINEAR ODE
  11822 C     FOR THE ANGULAR MOMENTUM.  A FOURTH ORDER RUNGE-KUTTA SCHEME IS
  11823 C     NOW EMPLOYED TO SOLVE IT NUMERICALLY.
  11824 C
  11825 C
  11826 C     WRITE(IOUT,2500)
  11827 C     WRITE(IOUT,2600)
  11828       Y =  RPOT*VPOT/Q
  11829       H = - DELX
  11830       DO 70 IX = NX, 2, -1
  11831 C       IF( (Y.LT.0.0025).AND. (R(IX) .LT. RPOT/2.) ) THEN
  11832 C       IF(Y.LT.0.0025)  THEN
  11833         IF(E(IX).GT.-1.E-4) THEN
  11834           XM(IX) = 0.
  11835           GO TO 7000
  11836         ELSE
  11837           XM(IX) = Y
  11838         END IF
  11839         ARG = X(IX)
  11840 C       XK1 = H*FCN(ARG, Y, XK, XUP, S, F, Q, C1, C2, C3)
  11841         XK1 = H*FCN(ARG,Y,XK,XUP,S,SQRT2,SQRQBF,SQRQTF,SQRPI2,C1,C2,C3)
  11842         ARG = X(IX) + 0.5*H
  11843 C
  11844 C     ***BLOWUP CATCHERS IN OPERATION****
  11845 C
  11846         IF(Y .LT. 0.0 .OR. ABS(XK1) .GT. 1.E3)  THEN
  11847         NBLOW=NBLOW+1

Page 321         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11848         WRITE(6,8126) NBLOW,ARG,Y,H,XK3,XK2,XK1
  11849         WRITE(IUNTBH,8126) NBLOW,ARG,Y,H,XK3,XK2,XK1
  11850  8126   FORMAT('******BLOWUP AT XK1 CALCULATION, NBLOW,ARG,',
  11851      1         'Y,H,XK3,XK2,XK1=',/,10X,I3,6E16.8)
  11852         RUP=RUPSV*0.5
  11853         IF(NBLOW .EQ. 1)  GO TO 9999
  11854         IER=8126
  11855         RETURN
  11856         ENDIF
  11857         XK2 = H*FCN(ARG, Y + 0.5*H*XK1,XK,XUP,S,SQRT2,SQRQBF,SQRQTF,
  11858      1              SQRPI2,C1,C2,C3)
  11859         IF(Y .LT. 0.0 .OR. ABS(XK2) .GT. 1.E4)  THEN
  11860         NBLOW=NBLOW+1
  11861         WRITE(6,8127) NBLOW,ARG,Y,H,XK3,XK2,XK1
  11862         WRITE(IUNTBH,8127) NBLOW,ARG,Y,H,XK3,XK2,XK1
  11863  8127   FORMAT('******BLOWUP AT XK2 CALCULATION, NBLOW,ARG,',
  11864      1         'Y,H,XK3,XK2,XK1=',/,10X,I3,6E16.8)
  11865         RUP=50.E3
  11866         IF(NBLOW .EQ. 1)  GO TO 9999
  11867         IER=8127
  11868         RETURN
  11869         ENDIF
  11870 C       XK3 = H*FCN(ARG, Y + 0.5*H*XK2, XK, XUP, S, F, Q, C1, C2, C3)
  11871         XK3 = H*FCN(ARG, Y + 0.5*H*XK2,XK,XUP,S,SQRT2,SQRQBF,SQRQTF,
  11872      1              SQRPI2,C1,C2,C3)
  11873         IF(IX.EQ.2) THEN
  11874           ARG = X(1)
  11875         ELSE
  11876           ARG = X(IX) + H
  11877         END IF
  11878 C
  11879         IF(Y .LT. 0.0 .OR. ABS(XK3) .GT. 1.E5)  THEN
  11880         NBLOW=NBLOW+1
  11881         WRITE(6,8128) NBLOW,ARG,Y,H,XK3,XK2,XK1
  11882         WRITE(IUNTBH,8128) NBLOW,ARG,Y,H,XK3,XK2,XK1
  11883  8128   FORMAT('******BLOWUP AT XK4 CALCULATION, NBLOW,ARG,',
  11884      1         'Y,H,XK3,XK2,XK1=',/,10X,I3,6E16.8)
  11885         RUP=50.E3
  11886         IF(NBLOW .EQ. 1)  GO TO 9999
  11887         IER=8128
  11888         RETURN
  11889         ENDIF
  11890 C
  11891         XK4 = H*FCN(ARG, Y + H*XK3,XK,XUP,S,SQRT2,SQRQBF,SQRQTF,
  11892      1              SQRPI2,C1,C2,C3)
  11893 C**DEBUG
  11894 c  && 3 comments
  11895 CC      WRITE(6,6987) IX,ARG,Y,XK4,XK3,XK2,XK1,Y+H*XK3
  11896 C6987   FORMAT('...DEBUGGING, IX,ARG,Y,XK4,XK3,XK2,XK1,Y+H*XK3',/,
  11897 CC   1         I5,7E16.6)
  11898         Y = Y + (XK1+XK4)*0.16666667+(XK2+XK3)*0.3333333
  11899 7000    CONTINUE
  11900 70      CONTINUE
  11901 C
  11902 C
  11903 C     THE TANGENTIAL VELOCITY FIELD AND RELATIVE ANGULAR MOMENTUM ARE
  11904 C     DIMENSIONALIZED AND THEN PRINTED OUT.

Page 322         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11905 C
  11906 C
  11907 C     WRITE(IOUT,3900)
  11908       DO 140 IR = 1, NR
  11909         XM(IR) = Q*XM(IR)
  11910         V(IR) = XM(IR)/R(IR)
  11911 C       WRITE(IOUT,4000) IR, R(IR)/1000, XM(IR), V(IR)
  11912 C4000   FORMAT(I4, 2X, 3(E10.3, 4X))
  11913 140     CONTINUE
  11914 C
  11915 C
  11916 C     COMPUTE SURFACE PRESSURE FIELD FROM RADIAL EQUATION OF MOTION
  11917 C     INTEGRATED OVER RADIUS WITH THE TRAPEZOIDAL FORMULA.  THE PREFIX
  11918 C     "TRAP" IS THE AREA UNDER A TRAPEZOID.  THE PREFIX "SUM" IS THE SUM
  11919 C     OF THE TRAPS.  THE TOTAL PRESSURE, P, IS THE SUM OF THE PRESSURE
  11920 C     WHICH SUPPORTS THE CORIOLIS FORCE, PCO, CENTRIFUGAL FORCE, PCL,
  11921 C     MERIDIONAL CIRCULATION, PMER, AND THE FRICTIONAL DRAG, PDR.
  11922 C
  11923 C
  11924       SUMCO(1) = 0.
  11925       SUMCL(1) = 0.
  11926       SUMDR(1) = 0.
  11927       DO 160 IR = 2, NR
  11928         TRAPCL = HDELR*(V(IR)*V(IR)/R(IR) +   V(IR-1)*V(IR-1)/R(IR-1))
  11929         TRAPCO = HDELR * F*( V(IR) + V(IR-1) )
  11930         TRAPDR = - HDELR*(0.001*RHOSG/DP)*((0.7       +0.07*V(IR))
  11931      1           *V(IR)*U(IR) + (0.7+0.07*V(IR-1))*V(IR-1)*U(IR-1))
  11932         SUMCO(IR) = SUMCO(IR-1) + TRAPCO
  11933         SUMCL(IR) = SUMCL(IR-1) + TRAPCL
  11934         SUMDR(IR) = SUMDR(IR-1) + TRAPDR
  11935 160     CONTINUE
  11936       DO 180 IR = 1, NR
  11937         PCO(IR) = PB + RHOS*( SUMCO(IR) - SUMCO(NR) )
  11938         PCL(IR) = PB + RHOS*( SUMCL(IR) - SUMCL(NR) )
  11939         PDR(IR) = PB + RHOS*( SUMDR(IR) - SUMDR(NR) )
  11940         PMER(IR) = PB + RHOS*( U(NR)*U(NR) - U(IR)*U(IR) )/2.
  11941         P(IR) = PCO(IR) + PCL(IR) + PDR(IR) + PMER(IR) - 3.*PB
  11942 180     CONTINUE
  11943       RESID=P(1)-PC
  11944 C       THE BEST VALUE OF UPDRAFT RADIUS FOR EMPIRICALLY DETERMINED Q
  11945 C       HAS JUST BEEN FOUND SO NOW YOU CAN JUMP OUT OF THE BIG DO LOOP.
  11946       IF(ABS(RESID) .GT. ABS(RESIDO))  GO TO 6000
  11947 C     WRITE(IOUT,2099) ITER, RUP,RPOT,D,RESID
  11948 C2099 FORMAT('...ITER=',I5,' RUP=',-3PF7.1, ' KM', 4X, 'RPOT=', F7.1,
  11949 C    1        ' KM',4X,'D=',F7.1, ' KM  RESID=',F12.3)
  11950 C       THE BEST VALUE OF UPDRAFT RADIUS FOR EMPIRICALLY DETERMINED Q
  11951 C       HAS NOT YET BEEN FOUND.  INCREASE OR DECREASE RUP
  11952 C       AND RECOMPUTE V, P.
  11953       RESIDO=RESID
  11954       IF(RESID .GT. 0.0) THEN
  11955         RUP = RUP - 100.
  11956       ELSE
  11957         RUP=RUP+100.
  11958       END IF
  11959 30    CONTINUE
  11960 6000  CONTINUE
  11961       WRITE(IOUT,2100) ITER, RUP,RPOT,D,RESID

Page 323         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  11962       WRITE(IUNTBH,2100) ITER, RUP,RPOT,D,RESID
  11963  2100 FORMAT('...ITER=',I5,', RUP=',-3PF7.1,' KM,',4X,' RPOT=',F7.1,
  11964      1        ' KM,',4X,'D=',F7.1, ' KM,  RESID=',F12.3)
  11965 C
  11966 C
  11967 C     IDENTIFY RADIUS OF MAXIMUM TANGENTIAL WIND (RMW), RADIUS OF
  11968 C     HURRICANE FORCE WIND, R33, RADIUS OF 18 M/S WIND, R18, ETC., AS
  11969 C     DETERMINED FROM THE SOLUTION.
  11970 C
  11971 C
  11972       DO 190 IR = 2, NR-1
  11973         IF(V(IR).GT.V(IR+1).AND.V(IR).GT.V(IR-1).AND.V(IR).GT.1.)   THEN
  11974           VMAX = V(IR)
  11975           RMW = R(IR)
  11976           WRITE(IOUT,4100) RMW, VMAX
  11977           WRITE(IUNTBH,4100) RMW, VMAX
  11978 4100      FORMAT('...RMW=',-3PF7.1,' KM,',4X,'VMAX=',0PF5.1,' M/S')
  11979         END IF
  11980         IF(V(IR).GE.15..AND.V(IR+1).LT.15.) THEN
  11981           R15 = R(IR)
  11982           WRITE(IOUT,4200) R15
  11983           WRITE(IUNTBH,4200) R15
  11984 4200      FORMAT('...R15=',-3PF7.1,' KM')
  11985         END IF
  11986         IF(V(IR).GE.33..AND.V(IR+1).LT.33.) THEN
  11987           R33 = R(IR)
  11988           WRITE(IOUT,4300) R33
  11989           WRITE(IUNTBH,4300) R33
  11990 4300      FORMAT('...R33=',-3PF7.1,' KM')
  11991         END IF
  11992         IF(U(IR).LT.U(IR+1).AND.U(IR).LT.U(IR-1).AND.U(IR).LT.-1.)THEN
  11993           RMAXU = R(IR)
  11994           WRITE(IOUT,4400) RMAXU
  11995           WRITE(IUNTBH,4400) RMAXU
  11996 4400      FORMAT('...RMAXU=',-3PF7.1, ' KM')
  11997         END IF
  11998 190     CONTINUE
  11999 C     WRITE(IOUT,4500)
  12000 C4500 FORMAT('...R (KM)', 6X, 'U', 7X, 'W (M/S)', 5X, 'V', 6X,
  12001 C    1       'PRES (MB)  VORT      DIV (*10**6)', //)
  12002       DO 200 IR = 1, NR
  12003       IF(IR .GT. 1)  THEN
  12004       IF(ABS(U(IR-1)) .GT. 1.E-2 .AND. ABS(V(IR-1)) .GT. 1.E-2)  THEN
  12005       VORTFM(IR)=(R(IR+1)*V(IR+1)-R(IR-1)*V(IR-1))/(R(IR)*(R(IR+1)-
  12006      1            R(IR-1)))
  12007       DIVFM(IR)=(R(IR+1)*U(IR+1)-R(IR-1)*U(IR-1))/(R(IR)*(R(IR+1)-
  12008      1           R(IR-1)))
  12009 C
  12010 C     GUARANTEE SOME BOUNDARY LAYER CONVERGENCE
  12011 C
  12012       DIVFM(IR)=MIN(DIVFM(IR),-0.1E-5)
  12013       ENDIF
  12014       ENDIF
  12015 C     WRITE(IOUT,4600) R(IR),U(IR),VV(IR),V(IR),P(IR),VORTFM(IR),
  12016 C    1                 DIVFM(IR)
  12017 C4600 FORMAT(-3PF7.1, 3X,0PF7.1,3X, F7.2, 3X, F7.1, 5X,-2PF7.1,6P,
  12018 C    1       2F10.2)

Page 324         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  12019  200  CONTINUE
  12020 C
  12021 C
  12022 C
  12023 C
  12024 C     NOW SAMPLE THE VELOCITY AND PRESSURE PROFILES AT THE APPROPRIATE
  12025 C     QLM GRID SPACING.  CHANGE NOTATION, CONVERT PRESSURE TO MILLIBARS
  12026 C     AND RETURN VARIABLES TO MAIN PROGRAM.
  12027 C
  12028 C
  12029       DO 300 J = 1, IMAXA
  12030 C       IX = 1 + INT( (J - 1.)*(NX - 1.)/(IMAXA - 1.) + .01 )
  12031         IX = 1 + NINT(REAL(J-1)*DELRMM/DELR)
  12032         VT(J) = SIGN(V(IX),XLATC)
  12033         URAD(J) = U(IX)
  12034         PSA(J) = P(IX)/100.
  12035 300     CONTINUE
  12036       IER=0
  12037       RETURN
  12038       END


ENTRY POINTS

  Name               
                     
 cswrl6_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 140                        Label  11913                                                          11908                             
 160                        Label  11935                                                          11927                             
 180                        Label  11942                                                          11936                             
 190                        Label  11998                                                          11972                             
 200                        Label  12019                                                          12002                             
 2000                       Label  11755                                                          11753,11754                       
 2100                       Label  11963                                                          11961,11962                       
 30                         Label  11959                                                          11757                             
 300                        Label  12035                                                          12029                             
 40                         Label  11818                                                          11801                             
 4100                       Label  11978                                                          11976,11977                       
 4200                       Label  11984                                                          11982,11983                       
 4300                       Label  11990                                                          11988,11989                       
 4400                       Label  11996                                                          11994,11995                       
 6000                       Label  11960                                                          11946                             
 70                         Label  11900                                                          11830                             
 7000                       Label  11899                                                          11835                             
 8126                       Label  11850                                                          11848,11849                       
 8127                       Label  11863                                                          11861,11862                       
 8128                       Label  11883                                                          11881,11882                       
 9999                       Label  11741                                                          11853,11866,11886                 
 A                          Local  11749    R(4)            4           scalar   SAVE             11749,11751,11759,11796,11814     
 ABS                        Func   11721                                scalar                    11721,11846,11859,11879,11946,1200
                                                                                                  4                                 

Page 325         Source Listing                  CSWRL6
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARG                        Local  11839    R(4)            4           scalar   SAVE             11839,11841,11842,11848,11849,1185
                                                                                                  7,11861,11862,11871,11874,11876,11
                                                                                                  881,11882,11891                   
 C1                         Local  11763    R(4)            4           scalar   SAVE             11763,11765,11768,11791,11794,1180
                                                                                                  9,11812,11841,11858,11872,11892   
 C2                         Local  11767    R(4)            4           scalar   SAVE             11767,11768,11791,11795,11809,1181
                                                                                                  3,11841,11858,11872,11892         
 C3                         Local  11768    R(4)            4           scalar   SAVE             11768,11791,11795,11809,11813,1184
                                                                                                  1,11858,11872,11892               
 CSWRL6                     Subr   11595                                                                                            
 D                          Local  11760    R(4)            4           scalar   SAVE             11760,11961,11962                 
 DELR                       Local  11718    R(4)            4           scalar   SAVE             11718,11728,11753,11754,11775,1203
                                                                                                  1                                 
 DELRMM                     Dummy  11596    R(4)            4           scalar   ARG,INOUT        12031                             
 DELX                       Local  11775    R(4)            4           scalar   SAVE             11775,11802,11829                 
 DIVFM                      Local  11685    R(4)            4     1     2001     SAVE             11713,12007,12012                 
 DP                         Local  11706    R(4)            4           scalar   SAVE             11706,11727,11749,11751,11796,1181
                                                                                                  4,11930                           
 E                          Local  11681    R(4)            4     1     2001     SAVE             11791,11794,11798,11806,11809,1181
                                                                                                  2,11816,11833                     
 ERRF                       Func   11767    R(4)            4           scalar                    11767,11791,11795,11809,11813     
 EXP                        Func   11765                                scalar                    11765,11794,11796,11812,11814     
 F                          Local  11721    R(4)            4           scalar   SAVE             11721,11724,11725,11726,11753,1175
                                                                                                  4,11929                           
 FCN                        Func   11841    R(4)            4           scalar                    11841,11857,11871,11891           
 FIRST                      Local  11677    L(4)            4           scalar   SAVE             11686,11700,11701                 
 G                          Local  11703    R(4)            4           scalar   SAVE             11703,11705                       
 H                          Local  11829    R(4)            4           scalar   SAVE             11829,11841,11842,11848,11849,1185
                                                                                                  7,11861,11862,11871,11876,11881,11
                                                                                                  882,11891                         
 HDELR                      Local  11728    R(4)            4           scalar   SAVE             11728,11928,11929,11930           
 IER                        Dummy  11595    I(4)            4           scalar   ARG,INOUT        11854,11867,11887,12036           
 IMAXA                      Dummy  11595    I(4)            4           scalar   ARG,INOUT        12029                             
 IOUT                       Local  11702    I(4)            4           scalar   SAVE             11702,11753,11961,11976,11982,1198
                                                                                                  8,11994                           
 IR                         Local  11908    I(4)            4           scalar   SAVE             11908,11909,11910,11927,11928,1192
                                                                                                  9,11930,11931,11932,11933,11934,11
                                                                                                  936,11937,11938,11939,11940,11941,
                                                                                                  11972,11973,11974,11975,11980,1198
                                                                                                  1,11986,11987,11992,11993,12002,12
                                                                                                  003,12004,12005,12006,12007,12008,
                                                                                                  12012                             
 ITER                       Local  11741    I(4)            4           scalar   SAVE             11741,11758,11961,11962           
 IUNTBH                     Dummy  11595    I(4)            4           scalar   ARG,INOUT        11754,11849,11862,11882,11962,1197
                                                                                                  7,11983,11989,11995               
 IX                         Local  11801    I(4)            4           scalar   SAVE             11801,11802,11803,11804,11806,1180
                                                                                                  7,11809,11810,11812,11814,11816,11
                                                                                                  817,11830,11833,11834,11837,11839,
                                                                                                  11842,11873,11876,12031,12032,1203
                                                                                                  3,12034                           
 J                          Local  12029    I(4)            4           scalar   SAVE             12029,12031,12032,12033,12034     
 L                          Local  11757    I(4)            4           scalar   SAVE             11757                             
 MIN                        Func   11744                                scalar                    11744,12012                       
 MMDIMR                     Dummy  11596    I(4)            4           scalar   ARG,INOUT        11684                             
 NBLOW                      Local  11715    I(4)            4           scalar   SAVE             11715,11743,11847,11848,11849,1185

Page 326         Source Listing                  CSWRL6
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,11860,11861,11862,11866,11880,11
                                                                                                  881,11882,11886                   
 NINT                       Func   11717                                scalar                    11717,12031                       
 NR                         Local  11717    I(4)            4           scalar   SAVE             11717,11718,11753,11754,11800,1190
                                                                                                  8,11927,11936,11937,11938,11939,11
                                                                                                  940,11972,12002                   
 NX                         Local  11800    I(4)            4           scalar   SAVE             11800,11801,11830                 
 P                          Local  11682    R(4)            4     1     2001     SAVE             11941,11943,12034                 
 PB                         Dummy  11595    R(4)            4           scalar   ARG,INOUT        11719,11747,11753,11754,11937,1193
                                                                                                  8,11939,11940,11941               
 PC                         Dummy  11595    R(4)            4           scalar   ARG,INOUT        11720,11747,11943                 
 PCL                        Local  11683    R(4)            4     1     2001     SAVE             11938,11941                       
 PCO                        Local  11683    R(4)            4     1     2001     SAVE             11937,11941                       
 PDIF                       Local  11747    R(4)            4           scalar   SAVE             11747,11748                       
 PDR                        Local  11683    R(4)            4     1     2001     SAVE             11939,11941                       
 PI                         Local  11686    R(4)            4           scalar   SAVE             11686,11708,11709,11759           
 PI486                      Local  11709    R(4)            4           scalar   SAVE             11709,11721                       
 PMER                       Local  11683    R(4)            4     1     2001     SAVE             11940,11941                       
 PSA                        Dummy  11596    R(4)            4     1     0        ARG,INOUT        12034                             
 Q                          Local  11722    R(4)            4           scalar   SAVE             11722,11724,11725,11726,11753,1175
                                                                                                  4,11759,11798,11816,11828,11909   
 R                          Local  11681    R(4)            4     1     2001     SAVE             11788,11789,11798,11803,11804,1181
                                                                                                  6,11910,11928,11975,11981,11987,11
                                                                                                  993,12005,12006,12007,12008       
 R15                        Local  11981    R(4)            4           scalar   SAVE             11981,11982,11983                 
 R33                        Local  11987    R(4)            4           scalar   SAVE             11987,11988,11989                 
 REAL                       Func   12031                                scalar                    12031                             
 RESID                      Local  11943    R(4)            4           scalar   SAVE             11943,11946,11953,11954,11961,1196
                                                                                                  2                                 
 RESIDO                     Local  11742    R(4)            4           scalar   SAVE             11742,11946,11953                 
 RHOS                       Local  11704    R(4)            4           scalar   SAVE             11704,11705,11937,11938,11939,1194
                                                                                                  0                                 
 RHOSG                      Local  11705    R(4)            4           scalar   SAVE             11705,11727,11749,11751,11799,1181
                                                                                                  7,11930                           
 RMAX                       Dummy  11595    R(4)            4           scalar   ARG,INOUT        11716                             
 RMAXU                      Local  11993    R(4)            4           scalar   SAVE             11993,11994,11995                 
 RMW                        Local  11975    R(4)            4           scalar   SAVE             11975,11976,11977                 
 RPOT                       Local  11716    R(4)            4           scalar   SAVE             11716,11717,11718,11722,11744,1182
                                                                                                  8,11961,11962                     
 RUP                        Local  11744    R(4)            4           scalar   SAVE             11744,11745,11753,11754,11759,1176
                                                                                                  1,11768,11776,11789,11791,11795,11
                                                                                                  804,11809,11813,11852,11865,11885,
                                                                                                  11955,11957,11961,11962           
 RUPSV                      Local  11745    R(4)            4           scalar   SAVE             11745,11852                       
 S                          Local  11759    R(4)            4           scalar   SAVE             11759,11760,11761,11768,11789,1179
                                                                                                  1,11794,11804,11809,11812,11841,11
                                                                                                  857,11871,11891                   
 SIGN                       Func   12032                                scalar                    12032                             
 SINDEG_8                   Func   11679    R(8)            8           scalar                    11721                             
 SQRFBQ                     Local  11725    R(4)            4           scalar   SAVE             11725,11775,11776                 
 SQRPI2                     Local  11708    R(4)            4           scalar   SAVE             11708,11768,11791,11795,11809,1181
                                                                                                  3,11841,11858,11872,11892         
 SQRQBF                     Local  11724    R(4)            4           scalar   SAVE             11724,11727,11788,11803,11841,1185
                                                                                                  7,11871,11891                     
 SQRQTF                     Local  11726    R(4)            4           scalar   SAVE             11726,11841,11857,11871,11891     

Page 327         Source Listing                  CSWRL6
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SQRT                       Func   11707                                scalar                    11707,11708,11724,11725,11726,1175
                                                                                                  9                                 
 SQRT2                      Local  11707    R(4)            4           scalar   SAVE             11707,11760,11761,11789,11804,1184
                                                                                                  1,11857,11871,11891               
 SUMCL                      Local  11682    R(4)            4     1     2001     SAVE             11925,11933,11938                 
 SUMCO                      Local  11682    R(4)            4     1     2001     SAVE             11924,11932,11937                 
 SUMDR                      Local  11683    R(4)            4     1     2001     SAVE             11926,11934,11939                 
 TRAPCL                     Local  11928    R(4)            4           scalar   SAVE             11928,11933                       
 TRAPCO                     Local  11929    R(4)            4           scalar   SAVE             11929,11932                       
 TRAPDR                     Local  11930    R(4)            4           scalar   SAVE             11930,11934                       
 U                          Local  11681    R(4)            4     1     2001     SAVE             11798,11816,11931,11940,11992,1200
                                                                                                  4,12007,12033                     
 UPOT                       Dummy  11595    R(4)            4           scalar   ARG,INOUT        11722                             
 URAD                       Dummy  11596    R(4)            4     1     0        ARG,INOUT        12033                             
 V                          Local  11682    R(4)            4     1     2001     SAVE             11910,11928,11929,11930,11931,1197
                                                                                                  3,11974,11980,11986,12004,12005,12
                                                                                                  032                               
 VMAX                       Local  11974    R(4)            4           scalar   SAVE             11974,11976,11977                 
 VORTFM                     Local  11685    R(4)            4     1     2001     SAVE             11712,12005                       
 VPOT                       Dummy  11595    R(4)            4           scalar   ARG,INOUT        11828                             
 VT                         Dummy  11596    R(4)            4     1     0        ARG,INOUT        12032                             
 VV                         Local  11681    R(4)            4     1     2001     SAVE             11799,11817                       
 W                          Local  11682    R(4)            4     1     2001     SAVE             11792,11796,11799,11807,11810,1181
                                                                                                  4,11817                           
 X                          Local  11681    R(4)            4     1     2001     SAVE             11787,11788,11802,11803,11839,1184
                                                                                                  2,11874,11876                     
 XK                         Local  11727    R(4)            4           scalar   SAVE             11727,11841,11857,11871,11891     
 XK1                        Local  11841    R(4)            4           scalar   SAVE             11841,11846,11848,11849,11857,1186
                                                                                                  1,11862,11881,11882,11898         
 XK2                        Local  11848    R(4)            4           scalar   SAVE             11848,11849,11857,11859,11861,1186
                                                                                                  2,11871,11881,11882,11898         
 XK3                        Local  11848    R(4)            4           scalar   SAVE             11848,11849,11861,11862,11871,1187
                                                                                                  9,11881,11882,11891,11898         
 XK4                        Local  11891    R(4)            4           scalar   SAVE             11891,11898                       
 XLATC                      Dummy  11595    R(4)            4           scalar   ARG,INOUT        11721,12032                       
 XM                         Local  11684    R(4)            4     1     2001     SAVE             11834,11837,11909,11910           
 XNARG                      Local  11761    R(4)            4           scalar   SAVE             11761,11762,11765,11767,11789,1179
                                                                                                  0,11791,11794,11795,11796,11804,11
                                                                                                  805,11808,11809,11812,11813,11814 
 XUP                        Local  11776    R(4)            4           scalar   SAVE             11776,11787,11841,11857,11871,1189
                                                                                                  1                                 
 Y                          Local  11828    R(4)            4           scalar   SAVE             11828,11837,11841,11846,11848,1184
                                                                                                  9,11857,11859,11861,11862,11871,11
                                                                                                  879,11881,11882,11891,11898       

Page 328         Source Listing                  CSWRL6
2017-04-18 11:09                                 syndata.f

  12039 
  12040 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12041 C                .      .    .                                       .
  12042 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  12043 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  12044 C
  12045 C ABSTRACT: ??????????????????????????????????????????????????????????
  12046 C   ??????????????????????????????????????????????????????????????????
  12047 C
  12048 C PROGRAM HISTORY LOG:
  12049 C ????-??-??  S. J. LORD
  12050 C
  12051 C USAGE:    CALL ????????(????)
  12052 C   INPUT ARGUMENT LIST:
  12053 C     ??????   - ???????????????????????????????????????????????
  12054 C
  12055 C   OUTPUT ARGUMENT LIST:
  12056 C     ??????   - ???????????????????????????????????????????????
  12057 C
  12058 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  12059 C     ??????   - ???????????????????????????????????????????????
  12060 C
  12061 C   OUTPUT FILES:
  12062 C     ??????   - ???????????????????????????????????????????????
  12063 C
  12064 C REMARKS: ?????????????????????????????????????????????????????
  12065 C
  12066 C ATTRIBUTES:
  12067 C   LANGUAGE: FORTRAN 90
  12068 C   MACHINE:  NCEP WCOSS
  12069 C
  12070 C$$$
  12071       FUNCTION FCN(ARG,Y,XK,XUP,S,SQRT2,SQRQBF,SQRQTF,SQRPI2,C1,C2,C3)
  12072 C
  12073       CD = 0.001 * (0.7 + 0.07*SQRQTF*Y/ARG)
  12074       XNARG = SQRQBF*(ARG - XUP)/(S*SQRT2)
  12075       IF(XNARG.GT.5.) THEN
  12076         E = - 1.0
  12077       ELSE IF(XNARG.LT.-5.) THEN
  12078         E = (-S*C1 + SQRQBF*XUP*SQRPI2*(C2 - ERRF(XNARG)) )/C3
  12079       ELSE
  12080         E = ( S*( EXP(-XNARG*XNARG) - C1 ) +
  12081      1            SQRQBF*XUP*SQRPI2*(C2 - ERRF(XNARG)) )/C3
  12082       END IF
  12083       COEFF = -XK*CD/E
  12084       FCN = - ARG + COEFF*Y*Y
  12085       RETURN
  12086       END

Page 329         Source Listing                  FCN
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name            
                  
 fcn_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARG                        Dummy  12071    R(4)            4           scalar   ARG,INOUT        12073,12074,12084                 
 C1                         Dummy  12071    R(4)            4           scalar   ARG,INOUT        12078,12080                       
 C2                         Dummy  12071    R(4)            4           scalar   ARG,INOUT        12078,12081                       
 C3                         Dummy  12071    R(4)            4           scalar   ARG,INOUT        12078,12081                       
 CD                         Local  12073    R(4)            4           scalar                    12073,12083                       
 COEFF                      Local  12083    R(4)            4           scalar                    12083,12084                       
 E                          Local  12076    R(4)            4           scalar                    12076,12078,12080,12083           
 ERRF                       Func   12078    R(4)            4           scalar                    12078,12081                       
 EXP                        Func   12080                                scalar                    12080                             
 FCN                        Func   12071    R(4)            4           scalar                    12084                             
 FCN@0                      Local  12071    R(4)            4           scalar                                                      
 S                          Dummy  12071    R(4)            4           scalar   ARG,INOUT        12074,12078,12080                 
 SQRPI2                     Dummy  12071    R(4)            4           scalar   ARG,INOUT        12078,12081                       
 SQRQBF                     Dummy  12071    R(4)            4           scalar   ARG,INOUT        12074,12078,12081                 
 SQRQTF                     Dummy  12071    R(4)            4           scalar   ARG,INOUT        12073                             
 SQRT2                      Dummy  12071    R(4)            4           scalar   ARG,INOUT        12074                             
 XK                         Dummy  12071    R(4)            4           scalar   ARG,INOUT        12083                             
 XNARG                      Local  12074    R(4)            4           scalar                    12074,12075,12077,12078,12080,1208
                                                                                                  1                                 
 XUP                        Dummy  12071    R(4)            4           scalar   ARG,INOUT        12074,12078,12081                 
 Y                          Dummy  12071    R(4)            4           scalar   ARG,INOUT        12073,12084                       

Page 330         Source Listing                  FCN
2017-04-18 11:09                                 syndata.f

  12087 
  12088 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12089 C                .      .    .                                       .
  12090 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  12091 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  12092 C
  12093 C ABSTRACT: ??????????????????????????????????????????????????????????
  12094 C   ??????????????????????????????????????????????????????????????????
  12095 C
  12096 C PROGRAM HISTORY LOG:
  12097 C ????-??-??  S. J. LORD
  12098 C
  12099 C USAGE:    CALL ????????(????)
  12100 C   INPUT ARGUMENT LIST:
  12101 C     ??????   - ???????????????????????????????????????????????
  12102 C
  12103 C   OUTPUT ARGUMENT LIST:
  12104 C     ??????   - ???????????????????????????????????????????????
  12105 C
  12106 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  12107 C     ??????   - ???????????????????????????????????????????????
  12108 C
  12109 C   OUTPUT FILES:
  12110 C     ??????   - ???????????????????????????????????????????????
  12111 C
  12112 C REMARKS: ?????????????????????????????????????????????????????
  12113 C
  12114 C ATTRIBUTES:
  12115 C   LANGUAGE: FORTRAN 90
  12116 C   MACHINE:  NCEP WCOSS
  12117 C
  12118 C$$$
  12119       FUNCTION ERRF(XNARG)
  12120 C
  12121 C     ERRF IS THE ERROR FUNCTION EVALUATED BY AN APPROXIMATE RATIONAL
  12122 C     EXPRESSION (EQUATION #7.1.26, PG.299, ABRAMOWITZ AND STEGUN).
  12123 C     NOTE THAT FOR NEGATIVE ARGUMENTS, ERRF(-XNARG) = - ERRF(XNARG).
  12124 C
  12125         X = ABS(XNARG)
  12126         P = 0.3275911
  12127         A1 = 0.254829592
  12128         A2 = - 0.284496736
  12129         A3 = 1.421413741
  12130         A4 = - 1.453152027
  12131         A5 = 1.061405429
  12132         T = 1./(1. + P*X)
  12133         T2 = T*T
  12134         T3 = T*T2
  12135         T4 = T*T3
  12136         T5 = T*T4
  12137       IF(XNARG.GT.5.) THEN
  12138         ERRF = 1.
  12139       ELSE IF(XNARG.LE.5. .AND. XNARG.GE.0.) THEN
  12140         ERRF = 1. - (A1*T + A2*T2 + A3*T3 + A4*T4 + A5*T5)*EXP(-X*X)
  12141       ELSE IF(XNARG.GE.-5. .AND. XNARG.LT.0.) THEN
  12142         ERRF = -1. + (A1*T + A2*T2 + A3*T3 + A4*T4 + A5*T5)*EXP(-X*X)
  12143       ELSE IF(XNARG.LT.-5.) THEN

Page 331         Source Listing                  ERRF
2017-04-18 11:09                                 syndata.f

  12144         ERRF = -1.
  12145       END IF
  12146       RETURN
  12147       END


ENTRY POINTS

  Name             
                   
 errf_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A1                         Local  12127    R(4)            4           scalar                    12127,12140,12142                 
 A2                         Local  12128    R(4)            4           scalar                    12128,12140,12142                 
 A3                         Local  12129    R(4)            4           scalar                    12129,12140,12142                 
 A4                         Local  12130    R(4)            4           scalar                    12130,12140,12142                 
 A5                         Local  12131    R(4)            4           scalar                    12131,12140,12142                 
 ABS                        Func   12125                                scalar                    12125                             
 ERRF                       Func   12119    R(4)            4           scalar                    12138,12140,12142,12144           
 ERRF@0                     Local  12119    R(4)            4           scalar                                                      
 EXP                        Func   12140                                scalar                    12140,12142                       
 P                          Local  12126    R(4)            4           scalar                    12126,12132                       
 T                          Local  12132    R(4)            4           scalar                    12132,12133,12134,12135,12136,1214
                                                                                                  0,12142                           
 T2                         Local  12133    R(4)            4           scalar                    12133,12134,12140,12142           
 T3                         Local  12134    R(4)            4           scalar                    12134,12135,12140,12142           
 T4                         Local  12135    R(4)            4           scalar                    12135,12136,12140,12142           
 T5                         Local  12136    R(4)            4           scalar                    12136,12140,12142                 
 X                          Local  12125    R(4)            4           scalar                    12125,12132,12140,12142           
 XNARG                      Dummy  12119    R(4)            4           scalar   ARG,INOUT        12125,12137,12139,12141,12143     

Page 332         Source Listing                  ERRF
2017-04-18 11:09                                 syndata.f

  12148 
  12149 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12150 C
  12151 C SUBPROGRAM: MAKHRD         ??????????????????????????????????
  12152 C   PRGMMR: S. J. LORD       ORG: NP22        DATE: ????-??-??
  12153 C
  12154 C ABSTRACT: ????????????????????????????????????????????????????????
  12155 C   ????????????????????????????????????????????????????????????????
  12156 C
  12157 C
  12158 C PROGRAM HISTORY LOG:
  12159 C ????-??-??  LORD
  12160 C
  12161 C USAGE: CALL MAKHRD(IRTYP,IYR,DAYZ,RLAT,RLON,PRESR,UWIND,VWIND)
  12162 C
  12163 C   INPUT ARGUMENT LIST:
  12164 C     DAYZ     - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
  12165 C              - 00Z ON NCEP DATE
  12166 C
  12167 C   OUTPUT FILES:
  12168 C
  12169 C   SUBPROGRAMS CALLED:
  12170 C     UNIQUE:
  12171 C
  12172 C   EXIT STATES:
  12173 C
  12174 C REMARKS:
  12175 C
  12176 C ATTRIBUTES:
  12177 C   LANGUAGE: FORTRAN 90
  12178 C   MACHINE:  NCEP WCOSS
  12179 C
  12180 C$$$
  12181       SUBROUTINE MAKHRD(IRTYP,IYR,DAYZ,RLAT,RLON,PRESR,UWIND,VWIND)
  12182 C
  12183       SAVE
  12184 C
  12185       CHARACTER FLAG*4
  12186 
  12187       DATA FLAG/'0000'/,RMISS/-99.0/
  12188 C
  12189       CALL YTIME(IYR,DAYZ,IDATE,IUTC)
  12190 C
  12191 C     CONVERT PREPBUFR REPORT TYPE TO HRD DATA TYPE
  12192 C
  12193       IF(IRTYP .EQ. 110 .OR. IRTYP .EQ. 210)  ITYP=12
  12194       IF(IRTYP .EQ. 240 .OR. IRTYP .EQ. 250)  ITYP=24
  12195       IF(IRTYP .EQ. 242 .OR. IRTYP .EQ. 252)  ITYP=27
  12196       IF(IRTYP .EQ. 243 .OR. IRTYP .EQ. 253)  ITYP=28
  12197 C
  12198 C     CONVERT LONGITUDE TO DEG WEST
  12199 C
  12200       RLONW=360.-RLON
  12201 C
  12202       WRITE(6,111) ITYP,IDATE,IUTC,RLAT,RLONW,PRESR,RMISS,RMISS,RMISS,
  12203      1             UWIND,VWIND,FLAG
  12204       WRITE(13,112) ITYP,IDATE,IUTC,RLAT,RLONW,PRESR,RMISS,RMISS,RMISS,

Page 333         Source Listing                  MAKHRD
2017-04-18 11:09                                 syndata.f

  12205      1             UWIND,VWIND,FLAG
  12206   111 FORMAT(1X,I2,1X,I9,1X,I4,1X,F7.3,F8.3,1X,3(F6.1,1X),F7.1,
  12207      1       2(F6.1,1X),A4)
  12208   112 FORMAT(I2,1X,I9,1X,I4,1X,F7.3,F8.3,1X,3(F6.1,1X),F7.1,
  12209      1       2(F6.1,1X),A4)
  12210       RETURN
  12211       END


ENTRY POINTS

  Name               
                     
 makhrd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 111                        Label  12206                                                          12202                             
 112                        Label  12208                                                          12204                             
 DAYZ                       Dummy  12181    R(4)            4           scalar   ARG,INOUT        12189                             
 FLAG                       Local  12185    CHAR            4           scalar   SAVE             12187,12203,12205                 
 IDATE                      Local  12189    I(4)            4           scalar   SAVE             12189,12202,12204                 
 IRTYP                      Dummy  12181    I(4)            4           scalar   ARG,INOUT        12193,12194,12195,12196           
 ITYP                       Local  12193    I(4)            4           scalar   SAVE             12193,12194,12195,12196,12202,1220
                                                                                                  4                                 
 IUTC                       Local  12189    I(4)            4           scalar   SAVE             12189,12202,12204                 
 IYR                        Dummy  12181    I(4)            4           scalar   ARG,INOUT        12189                             
 MAKHRD                     Subr   12181                                                                                            
 PRESR                      Dummy  12181    R(4)            4           scalar   ARG,INOUT        12202,12204                       
 RLAT                       Dummy  12181    R(4)            4           scalar   ARG,INOUT        12202,12204                       
 RLON                       Dummy  12181    R(4)            4           scalar   ARG,INOUT        12200                             
 RLONW                      Local  12200    R(4)            4           scalar   SAVE             12200,12202,12204                 
 RMISS                      Local  12187    R(4)            4           scalar   SAVE             12187,12202,12204                 
 UWIND                      Dummy  12181    R(4)            4           scalar   ARG,INOUT        12203,12205                       
 VWIND                      Dummy  12181    R(4)            4           scalar   ARG,INOUT        12203,12205                       
 YTIME                      Subr   12189                                                          12189                             

Page 334         Source Listing                  MAKHRD
2017-04-18 11:09                                 syndata.f

  12212 
  12213 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12214 C                .      .    .                                       .
  12215 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  12216 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  12217 C
  12218 C ABSTRACT: ??????????????????????????????????????????????????????????
  12219 C   ??????????????????????????????????????????????????????????????????
  12220 C
  12221 C PROGRAM HISTORY LOG:
  12222 C ????-??-??  S. J. LORD
  12223 C
  12224 C USAGE:    CALL ????????(????)
  12225 C   INPUT ARGUMENT LIST:
  12226 C     ??????   - ???????????????????????????????????????????????
  12227 C
  12228 C   OUTPUT ARGUMENT LIST:
  12229 C     ??????   - ???????????????????????????????????????????????
  12230 C
  12231 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  12232 C     ??????   - ???????????????????????????????????????????????
  12233 C
  12234 C   OUTPUT FILES:
  12235 C     ??????   - ???????????????????????????????????????????????
  12236 C
  12237 C REMARKS: ?????????????????????????????????????????????????????
  12238 C
  12239 C ATTRIBUTES:
  12240 C   LANGUAGE: FORTRAN 90
  12241 C   MACHINE:  NCEP WCOSS
  12242 C
  12243 C$$$
  12244       SUBROUTINE FUNINC(NZ,DST,FUNC,DSTMX,EPS,NZYUP,YUP)
  12245 C
  12246       SAVE
  12247 C
  12248       LOGICAL YUP
  12249 C
  12250       DIMENSION FUNC(NZ),DST(NZ)
  12251 C
  12252       CHECK=FUNC(1)
  12253       NZYUP=NZ
  12254       YUP=.TRUE.
  12255       DO 10 N=2,NZ
  12256       IF(DST(N) .GT. DSTMX)  GO TO 20
  12257       IF(FUNC(N)+EPS .LT. CHECK)  THEN
  12258       YUP=.FALSE.
  12259       NZYUP=MIN(NZYUP,N)
  12260       ENDIF
  12261       CHECK=MAX(FUNC(N-1),CHECK)
  12262    10 CONTINUE
  12263       RETURN
  12264 C
  12265    20 CONTINUE
  12266       NZYUP=N
  12267       RETURN
  12268       END

Page 335         Source Listing                  FUNINC
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 funinc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  12262                                                          12255                             
 20                         Label  12265                                                          12256                             
 CHECK                      Local  12252    R(4)            4           scalar   SAVE             12252,12257,12261                 
 DST                        Dummy  12244    R(4)            4     1     0        ARG,INOUT        12256                             
 DSTMX                      Dummy  12244    R(4)            4           scalar   ARG,INOUT        12256                             
 EPS                        Dummy  12244    R(4)            4           scalar   ARG,INOUT        12257                             
 FUNC                       Dummy  12244    R(4)            4     1     0        ARG,INOUT        12252,12257,12261                 
 FUNINC                     Subr   12244                                                                                            
 MAX                        Func   12261                                scalar                    12261                             
 MIN                        Func   12259                                scalar                    12259                             
 N                          Local  12255    I(4)            4           scalar   SAVE             12255,12256,12257,12259,12261,1226
                                                                                                  6                                 
 NZ                         Dummy  12244    I(4)            4           scalar   ARG,INOUT        12250,12253,12255                 
 NZYUP                      Dummy  12244    I(4)            4           scalar   ARG,INOUT        12253,12259,12266                 
 YUP                        Dummy  12244    L(4)            4           scalar   ARG,INOUT        12254,12258                       

Page 336         Source Listing                  FUNINC
2017-04-18 11:09                                 syndata.f

  12269 
  12270 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12271 C                .      .    .                                       .
  12272 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  12273 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  12274 C
  12275 C ABSTRACT: ??????????????????????????????????????????????????????????
  12276 C   ??????????????????????????????????????????????????????????????????
  12277 C
  12278 C PROGRAM HISTORY LOG:
  12279 C ????-??-??  S. J. LORD
  12280 C
  12281 C USAGE:    CALL ????????(????)
  12282 C   INPUT ARGUMENT LIST:
  12283 C     ??????   - ???????????????????????????????????????????????
  12284 C
  12285 C   OUTPUT ARGUMENT LIST:
  12286 C     ??????   - ???????????????????????????????????????????????
  12287 C
  12288 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  12289 C     ??????   - ???????????????????????????????????????????????
  12290 C
  12291 C   OUTPUT FILES:
  12292 C     ??????   - ???????????????????????????????????????????????
  12293 C
  12294 C REMARKS: ?????????????????????????????????????????????????????
  12295 C
  12296 C ATTRIBUTES:
  12297 C   LANGUAGE: FORTRAN 90
  12298 C   MACHINE:  NCEP WCOSS
  12299 C
  12300 C$$$
  12301       SUBROUTINE SPLDAT
  12302 C
  12303 C                     SPLDAT **  06/12/88
  12304 C               MODIFICATION OF XSPLINEX FOR ODW DATA
  12305 C         ++ THE MAIN PROGRAM READS DOMAIN PARAMETERS, DISK I/O AND
  12306 C                  BOUNDARY CONDITIONS IN NAMELIST FORMAT ON DATA
  12307 C                  CARDS IN THE RUN DECK (CARD IMAGES)  ++
  12308 C
  12309       PARAMETER (MDIM=35,NDIM=35)
  12310       PARAMETER (LDXDIM=8000)
  12311       PARAMETER (NFXDIM=20)
  12312       PARAMETER (KLDIM= 8)
  12313 C
  12314       PARAMETER (KVDIM=20,KDTDIM=5)
  12315 C**SGI      PARAMETER (KVDIM= 7,KDTDIM=5)
  12316       PARAMETER (NEXDIM=5)
  12317       PARAMETER (KPXDIM=KVDIM*KLDIM)
  12318       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  12319 C
  12320       COMMON /AFD/A(KDXDIM,MDIM,NDIM),FD(KDXDIM,LDXDIM),
  12321      1            FKMN(KPXDIM,MDIM,NDIM)
  12322       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  12323      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
  12324      2            MSKD15,MSKD16,MSKD17,MSKD18
  12325       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),

Page 337         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12326      1           WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),ELORG,GLORG,
  12327      2           XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  12328       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  12329       COMMON /AZI/ RADFCI,RAD0,NRDMN,NRDMX,THTAMX,DRAD,DTHETA,UVTORT
  12330       COMMON /TMMNMX/ IYMN,IMMN,IDMN,IHMN,IYMX,IMMX,IDMX,IHMX,IY0,IM0,
  12331      1                ID0,HR0
  12332 C
  12333       SAVE
  12334 C
  12335       COMMON/IBMBS/KPLVZ,WRDPTZ,WRDSTZ,WRDEVZ,NESTZ,IHOLEZ,DTAFTZ,
  12336      1             UVSAVZ,NOFLGZ,PDOMNZ,PALLZ,SLECTZ,EXTVRZ,PRDTAZ,
  12337      2             ANAVGZ,ZSRFZ,DVSRTZ,WRRESZ,MERCPZ,LLWLZ,TIMWNZ,UNIQZ,
  12338      3             PRTAZZ,KDATZ,JPDZ,ITPMNZ,ITPMXZ,NEXZ,ITPEXZ,NSTIKZ,
  12339      4             KLSTKZ,ISPTPZ,DXSPDZ,DYSPDZ,KXTOFZ,RADSHZ,THRSHZ,
  12340      5             USTMZ,VSTMZ,MXZ,NXZ,DUTMNZ,DUTMXZ,ISRCDZ,KDCZ,XDCWLZ,
  12341      6             YDCWLZ,XBCL1Z,XBCL2Z,YBCL1Z,YBCL2Z,KXBC1Z,KXBC2Z,
  12342      7             KYBC1Z,KYBC2Z,XSBM0Z,XSBMXZ,YSBM0Z,YSBMXZ,IHCZ,
  12343      8             NSWLNZ,MESHCZ,DPRXZ,STMIDZ,STMNMZ,PRTBGZ
  12344 C
  12345       INTEGER ITPEXZ(NEXDIM),KLSTKZ(KLDIM)
  12346 C
  12347       LOGICAL KPLVZ(KLDIM,KVDIM),WRDPTZ,WRDSTZ,WRDEVZ,NESTZ,IHOLEZ,
  12348      1        DTAFTZ,UVSAVZ,NOFLGZ,PDOMNZ,PALLZ,SLECTZ,EXTVRZ,PRDTAZ,
  12349      2        ANAVGZ,ZSRFZ,DVSRTZ,WRRESZ,MERCPZ,LLWLZ,TIMWNZ,UNIQZ,
  12350      3        PRTAZZ,PRTBGZ
  12351 C
  12352       CHARACTER*12  STMIDZ,STMNMZ
  12353 C
  12354 CIBM  NAMELIST/DATDEF/PART2,KPLV,KDAT,JPD,ITYPMN,ITYPMX,NEX,ITYPEX,
  12355 CIBM 1                WRSPLD,WRSPLV,WRDTPT,WRDSTT,WRDEV,WRNST,NEST,
  12356 CIBM 2                RHANL,SECDER,STICK,NSTICK,KLSTIK,SAMPLD,IHOLE,
  12357 CIBM 3                ISPTYP,DXSPD,DYSPD,DATAFT,UVSAVE,NOFLAG,PDOMAN,
  12358 CIBM 4                PALL,SELECT,EXTVAR,KXTOFF,PRDATA,AZCALC,
  12359 CIBM 5                RMWCLC,NRDMN,NRDMX,RAD0,THTAMX,DRAD,DTHETA,
  12360 CIBM 6                ANNAVG,UVTORT,RADSCH,CENTRF,PRSHT,QUERY,QFIND,
  12361 CIBM 7                ZSURF,DEVSRT,THRSH,USTM,VSTM,AZRESD,WRRES,CYBANL,
  12362 CIBM 8                MERCP,NSWLN,MESHC,SKWT,TIMWIN,CALMCO,UNIQUE,
  12363 CIBM 9                WRCHAR,BOGVOR,IMSKDA
  12364 CIBM  NAMELIST/DOMAIN/MX,NX,XML,XMR,YNB,YNT,ISRCD,JDAY0,UTC0,
  12365 CIBM 1                ELORG,GLORG,DUTCMN,DUTCMX,DPRX
  12366 CIBM  NAMELIST/DSKVAL/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,
  12367 CIBM 1                MSKDA6,MSKDA7,MSKDA8,MSKDA9,MSKD11,
  12368 CIBM 2                MSKD12,MSKD13,MSKD14,MSKD15,MSKD16,MSKD17,MSKD18
  12369 CIBM  NAMELIST/DCBC/KDC,XDCWL,YDCWL,KXBC1,KXBC2,KYBC1,KYBC2,XBCWL1,
  12370 CIBM 1              XBCWL2,YBCWL1,YBCWL2,LLWL
  12371 CIBM  NAMELIST/SUBM/XSBM0,XSBMX,YSBM0,YSBMX
  12372 C
  12373 C     ***** DEFAULT CONSTANTS FOR SLOVER *****     OTHERS MUST BE SET
  12374 C           DEFAULT BOUNDARY CONDITIONS ARE TYPE 21.
  12375 C           DEFAULT FILTER IS 6 DELTA X
  12376 C           DEFAULT NODAL SPACING IS 1 DEG. LONG. AND LAT.
  12377 C           DEFAULT COORDINATE SYSTEM IS EARTH COORDINATES, WITH
  12378 C                 LATITUDE AND LONGITUDE MEASURED IN DEGREES FROM
  12379 C                 SOUTHWEST CORNER.
  12380 C     UNITS FOR RAD0, DRAD ARE IN KM FOR MORE CONVENIENT USER INTERACTIO
  12381 C       THIS IS AN EXCEPTION TO THE STANDARD INTERNAL UNIT, WHICH IS
  12382 C       DEGREES LATITUDE.  RADFCI=1./111.1775 CONVERTS KM TO DEG. LAT.

Page 338         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12383 C     DATA DEFINITION
  12384 C          PARAMETERS:
  12385 C                      PART2        - TRUE IF ONLY SPLINE INTERPOLATION
  12386 C                                     IS DONE WITHOUT REDEFINING
  12387 C                                     GEOMETRY BY ADDING NEW DATA POINTS
  12388 C                      KPLV(KL,KV)  - EACH ELEMENT IS TRUE IF THE LEVEL
  12389 C                                     KL AND THE VARIABLE KV IS TO BE
  12390 C                                     INTERPOLATED AND PRINTED
  12391 C                      KDAT         - MAXIMUM NUMBER OF VARIABLES ON
  12392 C                                     DATA CARDS
  12393 C                      JPD          - CHOICE OF GEOMETRY: MULTILEVEL (SE
  12394 C                                     POSSIBLE)
  12395 C                                        1...VAS AND RAWINSONDES (100-30
  12396 C                                        2...ODW, NOAA P3, RAWINSONDES (
  12397 C                                        3...ODW, NOAA P3, RAWINSONDES (
  12398 C                                        4...ODW, NOAA P3, RAWINSONDES (
  12399 C                                        5...ODW, NOAA P3, RAWINSONDES (
  12400 C                                        6...ODW AND RAWINSONDES (550-10
  12401 C                                        7...SURFACE DATA FROM ANY SOURC
  12402 C                                   - OR SINGLE LEVEL.  HERE, OPTION IS
  12403 C                                        BY SETTING OF PDOMAN AND PALL.
  12404 C                                        (SEE XDTSRT, "PRESSURE SELECTIO
  12405 C                      ITYPMX       - MAXIMUM DATA TYPE ALLOWED (SEE XDT
  12406 C                      ITYPMN       - MINIMUM DATA TYPE ALLOWED (SEE XDT
  12407 C                      ITYPEX       - A MULTIPLE DATA TYPES (UP TO NEXDI
  12408 C                                     MAY BE EXCLUDED (SEE XDTSRT)
  12409 C     DOMAIN PARAMETERS:
  12410 C                       MX   - NUMBER OF NODAL POINTS (LONGITUDE)
  12411 C                       NX   - NUMBER OF NODAL POINTS (LATITUDE)
  12412 C                       XML  - LEFTHAND BOUNDARY (DEG. LONGITUDE)
  12413 C                       XMR  - RIGHTHAND BOUNDARY (DEG. LONGITUDE)
  12414 C                       YNB  - BOTTOM BOUNDARY (DEG. LATITUDE)
  12415 C                       YNT  - TOP BOUNDARY (DEG. LATITUDE)
  12416 C     DISK ID'S:        MSKEF   - MATRIX COEFFICIENTS WRITTEN
  12417 C                       MSKEZ   - WORKING SPACE FOR MATRIX COEFFICIENTS
  12418 C                       MSKDA1  - RAW DATA READ
  12419 C                       MSKDA2  - STORM POSITION DATA READ
  12420 C                       MSKDA3  - COMPLETE DATA FILE, ALL MISSING DATA R
  12421 C                       MSKDA4  - FKMN ARRAYS WRITTEN
  12422 C                       MSKDA5  - (DATA-ANALYSIS) DEVIATIONS WRITTEN
  12423 C                       MSKDA6  - SPLINE-INTERPOLATED DATA READ FOR NEST
  12424 C                                 (ALL WITH RESPECT TO STORM AT TIME T=0
  12425 C                       MSKDA7  - SPLINE-INTERPOLATED DATA WRITTEN FOR N
  12426 C                                 (ALL WITH RESPECT TO STORM AT TIME T=0
  12427 C                       MSKDA8  - DATA POINTS FOR STICKD ARE READ
  12428 C                       MSKDA9  - SPLINE-INTERPOLATED DATA VALUES OR
  12429 C                                 (DATA-ANALYSIS) DIFFERENCES FROM STICK
  12430 C                                 OR DATA VALUES FROM SAMPLD ARE WRITTEN
  12431 C                       MSKD11 - INPUT DECK FOR CYBER (QVANAL)
  12432 C                       MSKD12 - DATA DECK FOR CYBER (QVANAL)
  12433 C                       MSKD13 - JCL FILE FOR SENDING DATA TO CYBER (QVA
  12434 C                       MSKD14 - JCL FILE FOR SENDING INPUT DECK TO CYBE
  12435 C                       MSKD15 - DATA WEIGHTING SCHEME AND RELATIVE
  12436 C                                 WEIGHTS
  12437 C                       MSKD16 - STATISTICS OF DATA-ANALYSIS DEVIATIONS
  12438 C                                 WRITTEN
  12439 C                       MSKD17 - OUTPUT FILE FOR SKEW T/LOG P.

Page 339         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12440 C                       MSKD18 - INPUT FILE FOR DEFINING BOGUS DOMAIN
  12441 C
  12442       DIMENSION DWF(KDXDIM),ITYPEX(NEXDIM),FDSK(MDIM,NDIM,2),
  12443      1          AZAVG(KDXDIM),KLSTIK(KLDIM),FDSKS(MDIM,NDIM),SRC(2)
  12444       LOGICAL PART2,KPLV(KLDIM,KVDIM),WRSPLD,WRSPLV,WRDTPT,WRDSTT,WRDEV,
  12445      1        WRNST,NEST,RHANL,SECDER,STICK,SAMPLD,IHOLE,DATAFT,UVSAVE,
  12446      2        NOFLAG,PDOMAN,PALL,SELECT,EXTVAR,PRDATA,AZCALC,RMWCLC,
  12447      3        PRTAZI,ANNAVG,UVTORT,CENTRF,PRSHT,QUERY,QFIND,ZSURF,
  12448      4        DEVSRT,AZRESD,WRRES,CYBANL,MERCP,LLWL,SKWT,TIMWIN,CALMCO,
  12449      5        UNIQUE,WRCHAR,BOGVOR,IMSKDA,PRTBOG,KPLVS(KLDIM,KVDIM),
  12450      6        FRSTBG
  12451 C
  12452       CHARACTER*125 IDSPC,SRC*19,STMID*12,STMNAM*12
  12453 C
  12454       DATA SRC/' EARTH COORDINATES ','STM-RELATIVE COORDS'/,
  12455      2     STMID/'SSSSSSSSSSSS'/
  12456 C
  12457 C     DATA STATEMENTS FOR NAMELIST DATDEF
  12458 C
  12459 C     THE FOLLOWING INCLUDE IS FOR IBM USE ONLY.
  12460 C
  12461 C
  12462       DATA PART2/.FALSE./,WRSPLD/.FALSE./,WRSPLV/.FALSE./,
  12463      1     WRNST/.FALSE./,WRCHAR/.FALSE./,SECDER/.FALSE./,
  12464      2     STICK/.FALSE./,SAMPLD/.FALSE./,AZCALC/.FALSE./,
  12465      3     RMWCLC/.FALSE./,CENTRF/.FALSE./,PRSHT/.FALSE./,
  12466      4     QUERY/.FALSE./,QFIND/.FALSE./,AZRESD/.FALSE./,
  12467      5     CYBANL/.FALSE./,SKWT/.FALSE./,CALMCO/.TRUE./,BOGVOR/.FALSE./,
  12468      6     IMSKDA/.FALSE./,PRTBOG/.FALSE./,FRSTBG/.TRUE./
  12469 C
  12470 CIBM  NOTE: 'CIBM' INDICATES THAT THE ORIGINAL VAX CODE HAS BEEN
  12471 CIBM               MOVED TO ANOTHER LOCATION USING INCLUDE STMTS AND
  12472 CIBM               BLOCK DATA SUBROUTINES.
  12473 CIBM  THE FOLLOWING DATA INITIALIZATIONS HAVE BEEN MOVED TO BLOCK
  12474 CIBM      DATA BELOW THE MAIN PROGRAM.  SOME ARE IN THE INCLUDE STMT
  12475 CIBM      'IBMPGM' ABOVE
  12476 CIBM  DATA PART2/.FALSE./,KPLV/KPXDIM*.FALSE./,WRSPLD/.FALSE./,
  12477 CIBM 1     WRSPLV/.FALSE./,WRDTPT/.FALSE./,WRDSTT/.FALSE./,
  12478 CIBM 2     WRDEV/.FALSE./,WRNST/.FALSE./,NEST/.FALSE./,
  12479 CIBM 3     RHANL/.TRUE./,SECDER/.FALSE./,STICK/.FALSE./,
  12480 CIBM 4     SAMPLD/.FALSE./,IHOLE/.FALSE./,DATAFT/.FALSE./,
  12481 CIBM 5     UVSAVE/.FALSE./,NOFLAG/.FALSE./,PDOMAN/.FALSE./,
  12482 CIBM 6     PALL/.FALSE./,SELECT/.FALSE./,EXTVAR/.FALSE./,
  12483 CIBM 7     PRDATA/.FALSE./,AZCALC/.FALSE./,RMWCLC/.FALSE./,
  12484 CIBM 8     ANNAVG/.TRUE./,UVTORT/.FALSE./,CENTRF/.FALSE./,
  12485 CIBM 9     PRSHT/.FALSE./,QUERY/.FALSE./,QFIND/.FALSE./,
  12486 CIBM O     ZSURF/.FALSE./,DEVSRT/.FALSE./,AZRESD/.FALSE./,
  12487 CIBM 1     WRRES/.FALSE./,CYBANL/.FALSE./,MERCP/.FALSE./,
  12488 CIBM 2     LLWL/.FALSE./,SKWT/.FALSE./,TIMWIN/.TRUE./,CALMCO/.TRUE./,
  12489 CIBM 3     UNIQUE/.TRUE./
  12490 CIBM  DATA KDAT/5/,JPD/2/,ITYPMN/0/,ITYPMX/4/,NEX/0/,ITYPEX/NEXDIM*0/,
  12491 CIBM 1     NSTICK/1/,KLSTIK/KLDIM*0/,ISPTYP/11/,DXSPD/0.5/,DYSPD/0.5/,
  12492 CIBM 2     KXTOFF/0/NRDMN/1/,NRDMX/1/,RAD0/0.0/,THTAMX/360./,
  12493 CIBM 3     DRAD/1.0/,DTHETA/5.0/,RADSCH/3.0/,THRSH/100./,USTM/0.0/,
  12494 CIBM 4     VSTM/0.0/
  12495 C
  12496 C     DATA STATMENT FOR COMMON DSK, NAMELIST DSKVAL

Page 340         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12497 C
  12498 CIBM  DATA MSKEF/11/,MSKEZ/12/,MSKDA1/13/,MSKDA2/14/,MSKDA3/15/,
  12499 CIBM 1     MSKDA4/16/,MSKDA5/17/,MSKDA6/18/,MSKDA7/19/,MSKDA8/20/,
  12500 CIBM 2     MSKDA9/21/,MSKD11/23/,MSKD12/24/,MSKD13/25/,
  12501 CIBM 3     MSKD14/26/,MSKD15/27/,MSKD16/28/,MSKD17/29/,MSKD18/30/
  12502 C
  12503 C     DATA STATEMENT FOR NAMELIST DOMAIN
  12504 C
  12505 CIBM  DATA MX/20/,NX/20/,ISRCD/0/,JDAY0/-99/,UTC0/-99.0/,DUTCMN/10./,
  12506 CIBM 1     DUTCMX/50./,ELORG/-99.0/,GLORG/-99.0/
  12507 CIBM  INCLUDE 'DPRX/LIST'
  12508 C
  12509 C     DATA STATEMENT FOR NAMELIST DCBC
  12510 C
  12511 CIBM  DATA KDC/3/,XDCWL/6./,YDCWL/6./,KXBC1/21/,KXBC2/21/,KYBC1/21/,
  12512 CIBM 1     KYBC2/21/,XBCWL1/10./,XBCWL2/10./,YBCWL1/10./,YBCWL2/10./
  12513 C
  12514 C     DATA STATEMENT FOR COMMON PRES
  12515 C
  12516 CIBM  DATA ICOOR/1/,IDAT/4/,IDATZ/3/
  12517 C
  12518 C     DATA STATEMENT FOR NAMELIST SUBM
  12519 C
  12520 CIBM  DATA XSBM0/-1.1/,XSBMX/1.2/,YSBM0/-0.8/,YSBMX/1.4/
  12521 C
  12522 C     DATA STATEMENT FOR OTHER VARIABLES
  12523 C
  12524 CIBM  DATA XM1/0.0/,YN1/0.0/,XMXX/20./,YNXX/20./,PRTAZI/.TRUE./,
  12525 CIBM 1     RADFCI/.0089946/,IHC/0/,NSWLN/1/,MESHC/1/
  12526 C
  12527       NAMELIST/DATDEF/PART2,KPLV,KDAT,JPD,ITYPMN,ITYPMX,NEX,ITYPEX,
  12528      1                WRSPLD,WRSPLV,WRDTPT,WRDSTT,WRDEV,WRNST,NEST,
  12529      2                RHANL,SECDER,STICK,NSTICK,KLSTIK,SAMPLD,IHOLE,
  12530      3                ISPTYP,DXSPD,DYSPD,DATAFT,UVSAVE,NOFLAG,PDOMAN,
  12531      4                PALL,SELECT,EXTVAR,KXTOFF,PRDATA,AZCALC,
  12532      5                RMWCLC,NRDMN,NRDMX,RAD0,THTAMX,DRAD,DTHETA,
  12533      6                ANNAVG,UVTORT,RADSCH,CENTRF,PRSHT,QUERY,QFIND,
  12534      7                ZSURF,DEVSRT,THRSH,USTM,VSTM,AZRESD,WRRES,CYBANL,
  12535      8                MERCP,NSWLN,MESHC,SKWT,TIMWIN,CALMCO,UNIQUE,
  12536      9                WRCHAR,BOGVOR,IMSKDA,PRTBOG
  12537       NAMELIST/DOMAIN/MX,NX,XML,XMR,YNB,YNT,ISRCD,JDAY0,UTC0,
  12538      1                ELORG,GLORG,DUTCMN,DUTCMX,DPRX
  12539       NAMELIST/DSKVAL/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,
  12540      1                MSKDA6,MSKDA7,MSKDA8,MSKDA9,MSKD10,MSKD11,MSKD12,
  12541      2                MSKD13,MSKD14,MSKD15,MSKD16,MSKD17,MSKD18
  12542       NAMELIST/DCBC/KDC,XDCWL,YDCWL,KXBC1,KXBC2,KYBC1,KYBC2,XBCWL1,
  12543      1              XBCWL2,YBCWL1,YBCWL2,LLWL
  12544       NAMELIST/BOGPRM/STMNAM,IDAYZ,IUTCZ,XMLZ,XMRZ,YNBZ,YNTZ,MXZ,NXZ,
  12545      1                DELSPD
  12546       NAMELIST/SUBM/XSBM0,XSBMX,YSBM0,YSBMX
  12547 C
  12548 C     **************************************************************
  12549 C     **************************************************************
  12550 C     ***** THE FOLLOWING STATEMENTS ARE FOR INITIALIZATION OF *****
  12551 C     ***** LOCAL VARIABLES PASSED AS ARGUMENTS FROM THE BLOCK *****
  12552 C     ***** DATA ROUTINE BELOW THE MAIN PROGRAM.  THIS PRO-    *****
  12553 C     ***** CEDURE IS NECESSARY FOR IBM FORTRAN, NOT VAX       *****

Page 341         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12554 C     ***** FORTRAN.                                           *****
  12555 C     **************************************************************
  12556 C     **************************************************************
  12557 C
  12558 c fixit??  The following do loop goes out of bounds for both parameters;
  12559 C          I have made the following change which I "think" is correct
  12560 cdak  DO KV=1,KPXDIM
  12561 cdak     KPLV(KV,1)=KPLVZ(KV,1)
  12562 cdak  ENDDO
  12563       kplv=kplvz
  12564 
  12565       WRDTPT=WRDPTZ
  12566       WRDSTT=WRDSTZ
  12567       WRDEV=WRDEVZ
  12568       NEST=NESTZ
  12569       IHOLE=IHOLEZ
  12570       DATAFT=DTAFTZ
  12571       UVSAVE=UVSAVZ
  12572       NOFLAG=NOFLGZ
  12573       PDOMAN=PDOMNZ
  12574       PALL=PALLZ
  12575       SELECT=SLECTZ
  12576       EXTVAR=EXTVRZ
  12577       PRDATA=PRDTAZ
  12578       ANNAVG=ANAVGZ
  12579       ZSURF=ZSRFZ
  12580       DEVSRT=DVSRTZ
  12581       WRRES=WRRESZ
  12582       MERCP=MERCPZ
  12583       LLWL=LLWLZ
  12584       TIMWIN=TIMWNZ
  12585       UNIQUE=UNIQZ
  12586       PRTAZI=PRTAZZ
  12587       PRTBOG=PRTBGZ
  12588       KDAT=KDATZ
  12589       JPD=JPDZ
  12590       ITYPMN=ITPMNZ
  12591       ITYPMX=ITPMXZ
  12592       NEX=NEXZ
  12593       ITYPEX=ITPEXZ(NEXDIM)
  12594       NSTICK=NSTIKZ
  12595       KLSTIK=KLSTKZ
  12596       ISPTYP=ISPTPZ
  12597       DXSPD=DXSPDZ
  12598       DYSPD=DYSPDZ
  12599       KXTOFF=KXTOFZ
  12600       RADSCH=RADSHZ
  12601       THRSH=THRSHZ
  12602       USTM=USTMZ
  12603       VSTM=VSTMZ
  12604       MX=MXZ
  12605       NX=NXZ
  12606       DUTCMN=DUTMNZ
  12607       DUTCMX=DUTMXZ
  12608       ISRCD=ISRCDZ
  12609       KDC=KDCZ
  12610       XDCWL=XDCWLZ

Page 342         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12611       YDCWL=YDCWLZ
  12612       XBCWL1=XBCL1Z
  12613       XBCWL2=XBCL2Z
  12614       YBCWL1=YBCL1Z
  12615       YBCWL2=YBCL2Z
  12616       KXBC1=KXBC1Z
  12617       KXBC2=KXBC2Z
  12618       KYBC1=KYBC1Z
  12619       KYBC2=KYBC2Z
  12620       XSBM0=XSBM0Z
  12621       YSBM0=YSBM0Z
  12622       YSBMX=YSBMXZ
  12623       IHC=IHCZ
  12624       NSWLN=NSWLNZ
  12625       MESHC=MESHCZ
  12626       DPRX=DPRXZ
  12627       STMID=STMIDZ
  12628       STMNAM=STMNMZ
  12629 C
  12630 C
  12631 C     ***** READ AND PRINT A TITLE CARD *****
  12632 C
  12633       CALL RDTITL(1)
  12634       CALL PRTITL(1)
  12635 C
  12636 C     ***** CHANGE INPUT PARAMETERS IF DESIRED
  12637 C
  12638 c**sgiREAD(5,NML=DATDEF)
  12639       READ(5,DATDEF)
  12640       WRITE(6,DATDEF)
  12641 C
  12642 C     ***** CHANGE INPUT PARAMETERS IF DESIRED:  UPDATE DOMAIN CONDITION
  12643 C
  12644 c**sgiREAD(5,NML=DOMAIN)
  12645       READ(5,DOMAIN)
  12646       WRITE(6,DOMAIN)
  12647 C
  12648 C     ***** CHANGE INPUT PARAMETERS IF DESIRED:  UPDATE BOUNDARY CONDITI
  12649 C                                                AND DERIVATIVE CONSTRAI
  12650 c**sgiREAD(5,NML=DCBC)
  12651       READ(5,DCBC)
  12652       WRITE(6,DCBC)
  12653 C
  12654 C     ***** CHANGE DISK UNITS IF DESIRED
  12655 C
  12656 c**sgiIF(IMSKDA)  READ(5,NML=DSKVAL)
  12657       IF(IMSKDA)  THEN
  12658          READ(5,DSKVAL)
  12659          WRITE(6,DSKVAL)
  12660       END IF
  12661       mskd10 = 22
  12662 C
  12663 C     CHECK MAXIMUM NUMBER OF DATA VARIABLES
  12664 C
  12665       IF(KDAT .GT. KDTDIM)  GO TO 990
  12666 C
  12667 

Page 343         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12668 C-----------------------------------------------------------------------
  12669 
  12670 C     ENTRY TO REPEAT ANALYSIS WITH THE SAME PARAMETERS AND VARIABLES
  12671 C       BUT DIFFERENT DATA
  12672 C
  12673       ENTRY SPLD1
  12674 C
  12675 C     OPEN STORM POSITION DATA FILE
  12676 C
  12677 CVAX  OPEN(UNIT=MSKDA2,FILE='STMTRK',STATUS='OLD',READONLY,SHARED)
  12678 CIBM  OPEN(UNIT=MSKDA2,FILE='STMTRK',STATUS='OLD',ACTION='READ')
  12679 C
  12680 C     OPENS ARE NOT USED ON THE CRAY
  12681 C
  12682 C     OPEN(UNIT=MSKDA2,FILE='STMTRK',STATUS='UNKNOWN')
  12683 C
  12684 C     OPEN MATRIX COEFFICIENT FILE (MAY BE NEW FILE OR OLD) AND RAWDAT
  12685 C       FILE
  12686 C
  12687 C
  12688 C     OPEN STATEMENTS FOR MATRIX COEFFICIENT AND RAW DATA FILE
  12689 C       ARE NOT USED FOR THE CRAY
  12690 C
  12691 C
  12692 C     INITIALIZE RELATIVE COORDINATE ORIGINS
  12693 C
  12694       ELORG=-99.0
  12695       GLORG=-99.0
  12696 C
  12697 C     ***** CHANGE INPUT PARAMETERS IF DESIRED:  STORM NAME, DATE, TIME
  12698 C                                                DOMAIN BOUNDARIES FOR
  12699 C                                                BOGUS VORTEX
  12700       IF(BOGVOR)  THEN
  12701 C     OPEN(UNIT=MSKD18,STATUS='OLD',ACTION='READ')
  12702 CIBM  OPEN(UNIT=MSKD18,FILE='BOGDMN',STATUS='OLD',ACTION='READ')
  12703 C
  12704 C     OPENS ARE NOT USED ON THE CRAY
  12705 C
  12706 C     OPEN(UNIT=MSKD18,FILE='BOGDOMN',STATUS='UNKNOWN')
  12707 C     OPEN(UNIT=MSKD18,STATUS='UNKNOWN')
  12708 C     PRTBOG=.FALSE.
  12709       WRITE(6,9835) MSKD18
  12710  9835 FORMAT(/'...READY TO READ BOGPRM NAMELIST ON MSKD18=',I3)
  12711       READ(MSKD18,BOGPRM)
  12712 c**sgiREAD(MSKD18,NML=BOGPRM)
  12713       JDAY0=IDAYZ
  12714       UTC0=REAL(IUTCZ)
  12715       XML=XMLZ
  12716       XMR=XMRZ
  12717       YNB=YNBZ
  12718       YNT=YNTZ
  12719       MX =MXZ
  12720       NX =NXZ
  12721       DXSPD=-DELSPD
  12722       DYSPD=-DELSPD
  12723       WRITE(6,BOGPRM)
  12724 C

Page 344         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12725 C     FIRST, SAVE ORIGINAL KPLV CONFIGURATION FOR SUCCEEDING BOGUS STEPS
  12726 C       FOR ALL SUCCEEDING STEPS, COPY ORIGINAL CONFIGURATION
  12727 C
  12728       IF(FRSTBG)  THEN
  12729          FRSTBG=.FALSE.
  12730          KPLVS=KPLV
  12731       ELSE
  12732          KPLV=KPLVS
  12733       ENDIF
  12734       CLOSE(UNIT=MSKD18,STATUS='KEEP')
  12735       ENDIF
  12736 C
  12737 c**sgiIF(WRNST) READ(5,NML=SUBM)
  12738       IF(WRNST) THEN
  12739          READ(5,SUBM)
  12740          WRITE(6,SUBM)
  12741       END IF
  12742 C
  12743       WRITE(6,5) XML,XMR,YNB,YNT,CYBANL,MESHC,MERCP,NSWLN,LLWL,TIMWIN,
  12744      1           WRSPLD,WRSPLV,WRDTPT,WRDSTT,WRDEV,WRNST,
  12745      2           NEST,DPRX,ZSURF
  12746     5 FORMAT(/'....DOMAIN PARAMETERS:  XML=',F8.3,'  XMR=',F8.3,
  12747      1       '  YNB=',F7.3,'  YNT=',F7.3,/,
  12748      2       ' ....CYBER ANALYSIS (',L1,')  # OF MESHES=',I2,/,
  12749      3       ' ....MERCATOR PROJECTION (',L1,')',
  12750      4       ' SIGN OF WEST LONG.=',I2,', LAT/LON WAVELENGTH (',L1,')',
  12751      5     /,' ....TIME WINDOW USED FOR ALL DATA (',L1,')',
  12752      5     /,' ....FILES WRITTEN:','  WRSPLD=',L3,',  WRSPLV=',L3,
  12753      6       ',  WRDTPT=',L3,',   WRDSTT=',L3,',   WRDEV=',L3,
  12754      7       ',  WRNST=',L3,/,' ....NESTED GRID USED  (',
  12755      8    L1,')',/,' ....VERTICAL DATA ACCEPTANCE WINDOW=',F7.2,/,
  12756      9       ' ....VERTICAL COORDINATE IS NOT PRESSURE (',L1,')')
  12757 C
  12758 C
  12759 C     OPTION FOR HORIZONTAL COORDINATE:  DEFAULT INTERNAL COORDINATE
  12760 C                                        (UNITS) IS LATITUDE/LONGITUDE
  12761 C                                        (DEGREES)
  12762 C                                        OPTION 1 IS MERCATOR (METERS)
  12763 C
  12764 C     CYBER 205 ANALYSIS IS REQUIRED FOR MESHC>1.
  12765 C     MERCATOR IS REQUIRED FOR ANALYSIS ON CYBER 205
  12766 C
  12767       IF(MESHC .GT. 1)  CYBANL=.TRUE.
  12768       IF(CYBANL)  MERCP=.TRUE.
  12769 C
  12770       IF(MERCP) IHC=1
  12771 C
  12772 C     SET UP STORAGE FOR VERTICAL COORDINATE: DEFAULT IS PRESSURE COORDI
  12773 C     THIS MUST BE MODIFIED IF MORE COORDINATE OPTIONS ARE NECESSARY
  12774 C
  12775       IF(.NOT. ZSURF)  GO TO 10
  12776       ICOOR=4
  12777       IDAT=1
  12778 C
  12779 C     READ STORM DAY AND STORM IDENTIFICATION
  12780 C
  12781    10 CALL FNDDAY(STMID,NFIXP,TIMWIN)

Page 345         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12782 C
  12783 C     DEFINE HURRICANE FIX POSITIONS AND TIME T=0 LOCATION FOR
  12784 C     STORM-RELATIVE COORDINATES
  12785 C
  12786       CALL HURPOS(IDAYMX,UTCMX,UTCMN,DUTCMN,DUTCMX)
  12787 C
  12788 C     PUT IDENTIFICATION TAG INTO IDSPC AND PUT VALUE INTO COMMON BLOCK
  12789 C
  12790       WRITE(IDSPC,810) STMID,SRC(ISRCD+1),IDMN,IMMN,IYMN,
  12791      1                 IHMN,IDMX,IMMX,IYMX,IHMX,
  12792      2                 YSTM0,XSTM0,NINT(HR0),ID0,IM0
  12793   810 FORMAT(A12,1X,A19,1X,'FROM ',2(I2.2,'/'),I4.4,',',I3.2,' UTC TO ',
  12794      1       2(I2.2,'/'),I4.4,',',I3.2,' UTC STM POS',F6.1,' LAT,',F5.1,
  12795      2       ' LON AT',I3.2,' UTC ON',I3.2,'/',I2.2)
  12796 C
  12797       CALL STSPID(IDSPC)
  12798 C
  12799 C     PUT DOMAIN AND BOUNDARIES INTO COMMON
  12800 C
  12801       CALL STDOMN(NSWLN,XML,XMR,YNB,YNT,JPD,ISRCD)
  12802 C
  12803 C     SET UP HORIZONTAL COORDINATE:  LAT/LON OR MERCATOR PROJECTION
  12804 C                                    ARE CURRENT OPTIONS.
  12805 C
  12806       CALL CHORC(IHC)
  12807       CALL STHORC(IHC,ELORG,GLORG,XSTM0,YSTM0,LLWL)
  12808 C
  12809 C     INITIALIZE POSSIBILITY OF EXTERNAL VARIABLES
  12810 C
  12811       CALL STEXTV(EXTVAR,KXTOFF)
  12812 C
  12813       IF(PART2)  THEN
  12814 C
  12815 C     ***** READ BACK MSKEF ***** BEGIN PART II *****
  12816 C
  12817          CALL SLEFCD
  12818          GO TO 100
  12819       END IF
  12820 C
  12821 C     BEGIN PART I: DATA READING, COORDINATE TRANSFORMATIONS, AND
  12822 C                   MATRIX COEFFICIENT CALCULATIONS
  12823 C
  12824 C     SET NODES
  12825 C
  12826       CALL STSPND(MX,NX)
  12827 C
  12828 C     PUT BOUNDARY CONDITIONS INTO COMMON
  12829 C
  12830       CALL STSPBC(KXBC1,KXBC2,KYBC1,KYBC2,XBCWL1,XBCWL2,YBCWL1,YBCWL2)
  12831 C
  12832 C     PUT FILTER WAVELENGTHS INTO COMMON
  12833 C
  12834       CALL STSPDC(KDC,XDCWL,YDCWL)
  12835       CALL SLOVER
  12836 C
  12837 C     ***** DEFINE THE DATA POINTS *****
  12838 C

Page 346         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12839       CALL XDTSRT(KPLV,KDAT,DWF,ITYPMN,ITYPMX,NEX,ITYPEX,NEST,
  12840      1             NOFLAG,PDOMAN,PALL,SELECT,PRDATA,DPRX,NSWLN,
  12841      2             UNIQUE)
  12842 C
  12843 C     ***** WRITE MSKEF IF CALMCO SO ORDERS   (NOT EXECUTED FOR CYBER
  12844 C           ANALYSES)  *****
  12845 C
  12846       IF(.NOT. CYBANL)  THEN
  12847          IF(CALMCO)   CALL SLARGO
  12848 C
  12849 C     ***** READ BACK MSKEF ***** BEGIN PART II *****
  12850 C
  12851          CALL SLEFCD
  12852       ENDIF
  12853 
  12854   100 CONTINUE
  12855 C
  12856 C     ***** DEFINE THE DATA FIELDS TO BE INTERPOLATED AND PRINTED  *****
  12857 C
  12858       CALL XDATR(KPLV,KDAT,FD,DWF,KDX,USTM,VSTM,CYBANL)
  12859 CIBM  WRITE(1,105) KDX
  12860       WRITE(6,105) KDX
  12861   105 FORMAT(/'...DATA HAVE BEEN READ BACK FROM DISK, KDX=',I5)
  12862 CIBM  IF(USTM .NE. 0.0 .OR. VSTM .NE. 0.0)  WRITE(1,106)  USTM,VSTM
  12863       IF(USTM .NE. 0.0 .OR. VSTM .NE. 0.0)  WRITE(6,106)  USTM,VSTM
  12864   106 FORMAT('...WINDS ARE WITH RESPECT TO USTM=',F8.3,', VSTM=',F8.3,
  12865      1       /)
  12866 C
  12867 C     ROUTE TO CYBER INPUT PROGRAM, NEVER TO RETURN.
  12868 C
  12869 C*CRAYIF(CYBANL)  CALL VICSPL(MESHC,KDX,FD,LLWL,DPRX,ITYPMN,ITYPMX,
  12870 C*CRA1                        NEX,ITYPEX,NFIXP)
  12871 C
  12872       IF(KDX .GT. KDXDIM)  GO TO 970
  12873       CALL SLIMBO(FD,1,KDX,A)
  12874       CALL SETKPX(KDX)
  12875       CALL PRDSPK(0)
  12876       IF(PRTBOG)  CALL PRFKMD(A,FKMN,1,KDX)
  12877 C     CALL PRFKMD(A,FKMN,1,KDX)
  12878       KPX=KDX
  12879 C
  12880       IF(MERCP)  GO TO 150
  12881 C
  12882 C     SET UP COORDINATE CENTERS FOR POSSIBLE AZIMUTHAL AVERAGE
  12883 C     CALCULATIONS. DEFAULT IS STORM FIX POSITION, OTHER POSSIBILITIES
  12884 C     ARE: 1) ARBITRARY POINT IN DOMAIN (QUERY=.TRUE.) OR 2) MAXIMUM OR
  12885 C     MINIMUM OF A PARTICULAR VARIABLE (QFIND=.TRUE.).
  12886 C
  12887       XZ=XSTM0
  12888       YZ=YSTM0
  12889 C
  12890 C     INTERACTIVE QUERIES FOR POINT VALUES AND LOCAL MINIMA OR MAXIMA
  12891 C
  12892       IF(SKWT)  CALL SPSKWT(A,KDX,XZ,YZ,NSWLN)
  12893       IF(QUERY)  CALL SPTLOC(A,KDX,XZ,YZ,NSWLN)
  12894 C      IF(QFIND)  CALL SPTFND(A,KDX,XZ,YZ,NSWLN)
  12895 C

Page 347         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12896 C     CENTER-FINDING ALGORITHM
  12897 C
  12898 C*CRAYIF(CENTRF)  CALL CTRFND(A,1,KDX,XZ,YZ,RADSCH)
  12899 C
  12900 C     FIND RADIUS OF MAXIMUM WIND
  12901 C
  12902 C*CRAYIF(RMWCLC)   CALL RMXW(A,1,KDX,XZ,YZ,PRTAZI)
  12903 C
  12904 C     AZIMUTHAL AVERAGE CALCULATIONS
  12905 C
  12906 C*CRAYIF(AZCALC)   CALL AZIAVG(A,1,KDX,XZ,YZ,AZAVG,PRTAZI,ANNAVG)
  12907 C
  12908 C     RESIDUALS FROM THE AZIMUTHAL MEAN WIND
  12909 C
  12910 C*CRAYIF(AZRESD)  CALL AZIRSD(A,FKMN,1,KDX,XZ,YZ,AZAVG,KPX,WRRES)
  12911 C
  12912 C     GRIDDED OUTPUT TO DISK (UNFORMATTED HERE, CHARACTER FORM DONE
  12913 C       LATER FOR ALL VARIABLES AT ONCE)
  12914 C
  12915       IF(.NOT. WRCHAR)  THEN
  12916       IF(WRSPLD .AND. .NOT. WRRES)
  12917      1           CALL DSKNMC(FKMN,1,KDX,FDSK,FDSKS,MX+1,NX+1)
  12918       IF(WRRES)  CALL DSKNMC(FKMN,1,KPX,FDSK,FDSKS,MX+1,NX+1)
  12919       ENDIF
  12920 C
  12921 C     (DATA-ANALYSIS) DIFFERENCES
  12922 C
  12923   150 CONTINUE
  12924       IF(MERCP)  GO TO 500
  12925 C
  12926 C     SECONDARY (NON DATA) VARIABLES
  12927 C
  12928       KPZ0=KPX
  12929       CALL OUTVAR(KPLV,A,FKMN,KPX)
  12930       IF(QFIND)  CALL SPTFND(A,KPX,XZ,YZ,NSWLN)
  12931       IF(SECDER)  CALL OUTSDR(KPLV,A,FKMN,KPX)
  12932       IF(KPX .LE. KPZ0)  GO TO 200
  12933       IF(KPX .GT. KPXDIM)  GO TO 980
  12934       CALL SETKPX(KPX)
  12935       CALL PRDSPK(0)
  12936       IF(.NOT. PRSHT)  CALL PRFKMV(FKMN,KPZ0+1,KPX)
  12937       IF(.NOT. WRCHAR)  THEN
  12938       IF(WRSPLV)  CALL DSKNMC(FKMN,KPZ0+1,KPX,FDSK,FDSKS,MX+1,NX+1)
  12939       ELSE
  12940       IF(WRSPLV .OR. WRSPLD)  CALL DSKCHR(FKMN,1,KPX,MX+1,NX+1)
  12941       ENDIF
  12942 C
  12943 C     WRITING SUBMESH
  12944 C
  12945   200 CONTINUE
  12946 C
  12947 C     STICK DATA OPTION
  12948 C
  12949       IF(.NOT. STICK)  GO TO 400
  12950       IF(KLSTIK(1) .EQ. 1 .AND. .NOT. DATAFT) CALL OPNFIL(MSKDA9)
  12951       IF(KLSTIK(1) .NE. 1 .AND. .NOT. DATAFT) CALL ENDFIL(MSKDA9)
  12952       CALL STICKD(KPLV,A,KDAT,KDX,DPRX,NSTICK,KLSTIK,DATAFT,UVSAVE,

Page 348         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12953      1            WRDSTT,PRDATA)
  12954 C
  12955 C     SAMPLED DATA
  12956 C
  12957   400 IF(SAMPLD)   CALL SPTDAT(1,KDX,KPLV,A,KDAT,IHOLE,ISPTYP,
  12958      1                          DXSPD,DYSPD,NSWLN,PRTBOG,STMNAM)
  12959   500 CALL PREND
  12960 CIBM  WRITE(1,501)
  12961 C 501 FORMAT(/'...HORIZONTAL ANALYSIS TERMINATED NORMALLY')
  12962       RETURN
  12963   970 WRITE(6,971)  KDX,KDXDIM
  12964   971 FORMAT(/'***** TOO MANY DATA VARIABLES, KDX=',I6,' WHILE KDAT=',
  12965      1       I6)
  12966       CALL ABRT1('  SPLD1',971)
  12967   980 WRITE(6,981)  KPX,KPXDIM
  12968   981 FORMAT(/'***** TOO MANY PRINTED VARIABLES, KPX=',I6,' WHILE',
  12969      1       ' AVAILABLE SPACE IS KPXDIM=',I6)
  12970       CALL ABRT1('  SPLD1',981)
  12971   990 WRITE(6,991)  KDAT,KDTDIM
  12972   991 FORMAT(/'***** ERROR IN SPLINEX SETTING UP DATA READING...'
  12973      1       ,'  KDAT=',I6,' WHILE AVAILABLE DATA IS',I6)
  12974       CALL ABRT1('  SPLD1',991)
  12975       END


ENTRY POINTS

  Name                  Name               
                                           
 spld1_                spldat_             

Page 349         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  12781                                                          12775                             
 100                        Label  12854                                                          12818                             
 105                        Label  12861                                                          12860                             
 106                        Label  12864                                                          12863                             
 150                        Label  12923                                                          12880                             
 200                        Label  12945                                                          12932                             
 400                        Label  12957                                                          12949                             
 5                          Label  12746                                                          12743                             
 500                        Label  12959                                                          12924                             
 810                        Label  12793                                                          12790                             
 970                        Label  12963                                                          12872                             
 971                        Label  12964                                                          12963                             
 980                        Label  12967                                                          12933                             
 981                        Label  12968                                                          12967                             
 9835                       Label  12710                                                          12709                             
 990                        Label  12971                                                          12665                             
 991                        Label  12972                                                          12971                             
 A                          Scalar 12320    R(4)            4     3     49000    COM              12873,12876,12892,12893,12929,1293
                                                                                                  0,12931,12952,12957               
 ABRT1                      Subr   12966                                                          12966,12970,12974                 
 AFD                        Common 12320                                2260000  SAVE                                               
 ANAVGZ                     Scalar 12337    L(4)            4           scalar   COM              12578                             
 ANNAVG                     Local  12447    L(4)            4           scalar   SAVE             12533,12578                       
 AZAVG                      Local  12443    R(4)            4     1     40       SAVE                                               
 AZCALC                     Local  12446    L(4)            4           scalar   SAVE             12464,12531                       
 AZI                        Common 12329                                32       SAVE                                               
 AZRESD                     Local  12448    L(4)            4           scalar   SAVE             12466,12534                       
 BOGPRM                     Local  12544                                scalar                    12711,12723                       
 BOGVOR                     Local  12449    L(4)            4           scalar   SAVE             12467,12536,12700                 
 CALMCO                     Local  12448    L(4)            4           scalar   SAVE             12467,12535,12847                 
 CENTRF                     Local  12447    L(4)            4           scalar   SAVE             12465,12533                       
 CHORC                      Subr   12806                                                          12806                             
 CYBANL                     Local  12448    L(4)            4           scalar   SAVE             12467,12534,12743,12767,12768,1284
                                                                                                  6,12858                           
 DATAFT                     Local  12445    L(4)            4           scalar   SAVE             12530,12570,12950,12951,12952     
 DATDEF                     Local  12527                                scalar                    12639,12640                       
 DATREC                     Scalar 12328    R(4)            4     1     6        COM                                                
 DCBC                       Local  12542                                scalar                    12651,12652                       
 DELSPD                     Local  12545    R(4)            4           scalar   SAVE             12545,12721,12722                 
 DEVSRT                     Local  12448    L(4)            4           scalar   SAVE             12534,12580                       
 DOMAIN                     Local  12537                                scalar                    12645,12646                       
 DPRX                       Local  12538    R(4)            4           scalar   SAVE             12538,12626,12745,12840,12952     
 DPRXZ                      Scalar 12343    R(4)            4           scalar   COM              12626                             
 DRAD                       Scalar 12329    R(4)            4           scalar   COM              12532                             
 DSK                        Common 12322                                76       SAVE                                               
 DSKCHR                     Subr   12940                                                          12940                             
 DSKNMC                     Subr   12917                                                          12917,12918,12938                 
 DSKVAL                     Local  12539                                scalar                    12658,12659                       
 DTAFTZ                     Scalar 12335    L(4)            4           scalar   COM              12570                             
 DTHETA                     Scalar 12329    R(4)            4           scalar   COM              12532                             
 DUTCMN                     Local  12538    R(4)            4           scalar   SAVE             12538,12606,12786                 

Page 350         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DUTCMX                     Local  12538    R(4)            4           scalar   SAVE             12538,12607,12786                 
 DUTMNZ                     Scalar 12340    R(4)            4           scalar   COM              12606                             
 DUTMXZ                     Scalar 12340    R(4)            4           scalar   COM              12607                             
 DVSRTZ                     Scalar 12337    L(4)            4           scalar   COM              12580                             
 DWF                        Local  12442    R(4)            4     1     40       SAVE             12839,12858                       
 DXSPD                      Local  12530    R(4)            4           scalar   SAVE             12530,12597,12721,12958           
 DXSPDZ                     Scalar 12339    R(4)            4           scalar   COM              12597                             
 DYSPD                      Local  12530    R(4)            4           scalar   SAVE             12530,12598,12722,12958           
 DYSPDZ                     Scalar 12339    R(4)            4           scalar   COM              12598                             
 ELORG                      Scalar 12326    R(4)            4           scalar   COM              12538,12694,12807                 
 ENDFIL                     Subr   12951                                                          12951                             
 EXTVAR                     Local  12446    L(4)            4           scalar   SAVE             12531,12576,12811                 
 EXTVRZ                     Scalar 12336    L(4)            4           scalar   COM              12576                             
 FD                         Scalar 12320    R(4)            4     2     320000   COM              12858,12873                       
 FDSK                       Local  12442    R(4)            4     3     2450     SAVE             12917,12918,12938                 
 FDSKS                      Local  12443    R(4)            4     2     1225     SAVE             12917,12918,12938                 
 FKMN                       Scalar 12321    R(4)            4     3     196000   COM              12876,12917,12918,12929,12931,1293
                                                                                                  6,12938,12940                     
 FNDDAY                     Subr   12781                                                          12781                             
 FRSTBG                     Local  12450    L(4)            4           scalar   SAVE             12468,12728,12729                 
 GLORG                      Scalar 12326    R(4)            4           scalar   COM              12538,12695,12807                 
 HR0                        Scalar 12331    R(4)            4           scalar   COM              12792                             
 HURPOS                     Subr   12786                                                          12786                             
 IBMBS                      Common 12335                                960      SAVE                                               
 ICOOR                      Scalar 12328    I(4)            4           scalar   COM              12776                             
 ID0                        Scalar 12331    I(4)            4           scalar   COM              12792                             
 IDAT                       Scalar 12328    I(4)            4           scalar   COM              12777                             
 IDATZ                      Scalar 12328    I(4)            4           scalar   COM                                                
 IDAYMN                     Scalar 12327    I(4)            4           scalar   COM                                                
 IDAYMX                     Local  12786    I(4)            4           scalar   SAVE             12786                             
 IDAYOB                     Scalar 12325    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 12326    I(4)            4     1     20       COM                                                
 IDAYZ                      Local  12544    I(4)            4           scalar   SAVE             12544,12713                       
 IDMN                       Scalar 12330    I(4)            4           scalar   COM              12790                             
 IDMX                       Scalar 12330    I(4)            4           scalar   COM              12791                             
 IDSPC                      Local  12452    CHAR            125         scalar   SAVE             12790,12797                       
 IHC                        Local  12623    I(4)            4           scalar   SAVE             12623,12770,12806,12807           
 IHCZ                       Scalar 12342    I(4)            4           scalar   COM              12623                             
 IHMN                       Scalar 12330    I(4)            4           scalar   COM              12791                             
 IHMX                       Scalar 12330    I(4)            4           scalar   COM              12791                             
 IHOLE                      Local  12445    L(4)            4           scalar   SAVE             12529,12569,12957                 
 IHOLEZ                     Scalar 12335    L(4)            4           scalar   COM              12569                             
 IM0                        Scalar 12330    I(4)            4           scalar   COM              12792                             
 IMMN                       Scalar 12330    I(4)            4           scalar   COM              12790                             
 IMMX                       Scalar 12330    I(4)            4           scalar   COM              12791                             
 IMSKDA                     Local  12449    L(4)            4           scalar   SAVE             12468,12536,12657                 
 ISPTPZ                     Scalar 12339    I(4)            4           scalar   COM              12596                             
 ISPTYP                     Local  12530    I(4)            4           scalar   SAVE             12530,12596,12957                 
 ISRCD                      Local  12537    I(4)            4           scalar   SAVE             12537,12608,12790,12801           
 ISRCDZ                     Scalar 12340    I(4)            4           scalar   COM              12608                             
 ITPEXZ                     Scalar 12338    I(4)            4     1     5        COM              12593                             
 ITPMNZ                     Scalar 12338    I(4)            4           scalar   COM              12590                             
 ITPMXZ                     Scalar 12338    I(4)            4           scalar   COM              12591                             
 ITYPEX                     Local  12442    I(4)            4     1     5        SAVE             12527,12593,12839                 
 ITYPMN                     Local  12527    I(4)            4           scalar   SAVE             12527,12590,12839                 

Page 351         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ITYPMX                     Local  12527    I(4)            4           scalar   SAVE             12527,12591,12839                 
 IUTCZ                      Local  12544    I(4)            4           scalar   SAVE             12544,12714                       
 IY0                        Scalar 12330    I(4)            4           scalar   COM                                                
 IYMN                       Scalar 12330    I(4)            4           scalar   COM              12790                             
 IYMX                       Scalar 12330    I(4)            4           scalar   COM              12791                             
 JDAY0                      Scalar 12327    I(4)            4           scalar   COM              12537,12713                       
 JPD                        Local  12527    I(4)            4           scalar   SAVE             12527,12589,12801                 
 JPDZ                       Scalar 12338    I(4)            4           scalar   COM              12589                             
 KDAT                       Local  12527    I(4)            4           scalar   SAVE             12527,12588,12665,12839,12858,1295
                                                                                                  2,12957,12971                     
 KDATZ                      Scalar 12338    I(4)            4           scalar   COM              12588                             
 KDC                        Local  12542    I(4)            4           scalar   SAVE             12542,12609,12834                 
 KDCZ                       Scalar 12340    I(4)            4           scalar   COM              12609                             
 KDTDIM                     Param  12314    I(4)            4           scalar                    12318,12328,12665,12971           
 KDX                        Local  12858    I(4)            4           scalar   SAVE             12858,12860,12872,12873,12874,1287
                                                                                                  6,12878,12892,12893,12917,12952,12
                                                                                                  957,12963                         
 KDXDIM                     Param  12318    I(4)            4           scalar                    12320,12442,12443,12872,12963     
 KLDIM                      Param  12312    I(4)            4           scalar                    12317,12318,12328,12345,12347,1244
                                                                                                  3,12444,12449                     
 KLSTIK                     Local  12443    I(4)            4     1     8        SAVE             12529,12595,12950,12951,12952     
 KLSTKZ                     Scalar 12339    I(4)            4     1     8        COM              12595                             
 KPLV                       Local  12444    L(4)            4     2     160      SAVE             12527,12563,12730,12732,12839,1285
                                                                                                  8,12929,12931,12952,12957         
 KPLVS                      Local  12449    L(4)            4     2     160      SAVE             12730,12732                       
 KPLVZ                      Scalar 12335    L(4)            4     2     160      COM              12563                             
 KPX                        Local  12878    I(4)            4           scalar   SAVE             12878,12918,12928,12929,12930,1293
                                                                                                  1,12932,12933,12934,12936,12938,12
                                                                                                  940,12967                         
 KPXDIM                     Param  12317    I(4)            4           scalar                    12321,12933,12967                 
 KPZ0                       Local  12928    I(4)            4           scalar   SAVE             12928,12932,12936,12938           
 KVDIM                      Param  12314    I(4)            4           scalar                    12317,12347,12444,12449           
 KXBC1                      Local  12542    I(4)            4           scalar   SAVE             12542,12616,12830                 
 KXBC1Z                     Scalar 12341    I(4)            4           scalar   COM              12616                             
 KXBC2                      Local  12542    I(4)            4           scalar   SAVE             12542,12617,12830                 
 KXBC2Z                     Scalar 12341    I(4)            4           scalar   COM              12617                             
 KXTOFF                     Local  12531    I(4)            4           scalar   SAVE             12531,12599,12811                 
 KXTOFZ                     Scalar 12339    I(4)            4           scalar   COM              12599                             
 KYBC1                      Local  12542    I(4)            4           scalar   SAVE             12542,12618,12830                 
 KYBC1Z                     Scalar 12342    I(4)            4           scalar   COM              12618                             
 KYBC2                      Local  12542    I(4)            4           scalar   SAVE             12542,12619,12830                 
 KYBC2Z                     Scalar 12342    I(4)            4           scalar   COM              12619                             
 LDXDIM                     Param  12310    I(4)            4           scalar                    12320,12325                       
 LLWL                       Local  12448    L(4)            4           scalar   SAVE             12543,12583,12743,12807           
 LLWLZ                      Scalar 12337    L(4)            4           scalar   COM              12583                             
 MDIM                       Param  12309    I(4)            4           scalar                    12320,12321,12442,12443           
 MERCP                      Local  12448    L(4)            4           scalar   SAVE             12535,12582,12743,12768,12770,1288
                                                                                                  0,12924                           
 MERCPZ                     Scalar 12337    L(4)            4           scalar   COM              12582                             
 MESHC                      Local  12535    I(4)            4           scalar   SAVE             12535,12625,12743,12767           
 MESHCZ                     Scalar 12343    I(4)            4           scalar   COM              12625                             
 MSKD10                     Local  12540    I(4)            4           scalar   SAVE             12540,12661                       
 MSKD11                     Scalar 12323    I(4)            4           scalar   COM              12540                             
 MSKD12                     Scalar 12323    I(4)            4           scalar   COM              12540                             
 MSKD13                     Scalar 12323    I(4)            4           scalar   COM              12541                             

Page 352         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKD14                     Scalar 12323    I(4)            4           scalar   COM              12541                             
 MSKD15                     Scalar 12324    I(4)            4           scalar   COM              12541                             
 MSKD16                     Scalar 12324    I(4)            4           scalar   COM              12541                             
 MSKD17                     Scalar 12324    I(4)            4           scalar   COM              12541                             
 MSKD18                     Scalar 12324    I(4)            4           scalar   COM              12541,12709,12711,12734           
 MSKDA1                     Scalar 12322    I(4)            4           scalar   COM              12539                             
 MSKDA2                     Scalar 12322    I(4)            4           scalar   COM              12539                             
 MSKDA3                     Scalar 12322    I(4)            4           scalar   COM              12539                             
 MSKDA4                     Scalar 12322    I(4)            4           scalar   COM              12539                             
 MSKDA5                     Scalar 12322    I(4)            4           scalar   COM              12539                             
 MSKDA6                     Scalar 12322    I(4)            4           scalar   COM              12540                             
 MSKDA7                     Scalar 12323    I(4)            4           scalar   COM              12540                             
 MSKDA8                     Scalar 12323    I(4)            4           scalar   COM              12540                             
 MSKDA9                     Scalar 12323    I(4)            4           scalar   COM              12540,12950,12951                 
 MSKEF                      Scalar 12322    I(4)            4           scalar   COM              12539                             
 MSKEZ                      Scalar 12322    I(4)            4           scalar   COM              12539                             
 MX                         Local  12537    I(4)            4           scalar   SAVE             12537,12604,12719,12826,12917,1291
                                                                                                  8,12938,12940                     
 MXZ                        Scalar 12340    I(4)            4           scalar   COM              12544,12604,12719                 
 NDIM                       Param  12309    I(4)            4           scalar                    12320,12321,12442,12443           
 NEST                       Local  12445    L(4)            4           scalar   SAVE             12528,12568,12745,12839           
 NESTZ                      Scalar 12335    L(4)            4           scalar   COM              12568                             
 NEX                        Local  12527    I(4)            4           scalar   SAVE             12527,12592,12839                 
 NEXDIM                     Param  12316    I(4)            4           scalar                    12345,12442,12593                 
 NEXZ                       Scalar 12338    I(4)            4           scalar   COM              12592                             
 NFIX0                      Scalar 12327    I(4)            4           scalar   COM                                                
 NFIXP                      Local  12781    I(4)            4           scalar   SAVE             12781                             
 NFXDIM                     Param  12311    I(4)            4           scalar                    12325,12326                       
 NINT                       Func   12792                                scalar                    12792                             
 NOFLAG                     Local  12446    L(4)            4           scalar   SAVE             12530,12572,12840                 
 NOFLGZ                     Scalar 12336    L(4)            4           scalar   COM              12572                             
 NRDMN                      Scalar 12329    I(4)            4           scalar   COM              12532                             
 NRDMX                      Scalar 12329    I(4)            4           scalar   COM              12532                             
 NSTICK                     Local  12529    I(4)            4           scalar   SAVE             12529,12594,12952                 
 NSTIKZ                     Scalar 12338    I(4)            4           scalar   COM              12594                             
 NSWLN                      Local  12535    I(4)            4           scalar   SAVE             12535,12624,12743,12801,12840,1289
                                                                                                  2,12893,12930,12958               
 NSWLNZ                     Scalar 12343    I(4)            4           scalar   COM              12624                             
 NX                         Local  12537    I(4)            4           scalar   SAVE             12537,12605,12720,12826,12917,1291
                                                                                                  8,12938,12940                     
 NXZ                        Scalar 12340    I(4)            4           scalar   COM              12544,12605,12720                 
 OPNFIL                     Subr   12950                                                          12950                             
 OUTSDR                     Subr   12931                                                          12931                             
 OUTVAR                     Subr   12929                                                          12929                             
 PALL                       Local  12446    L(4)            4           scalar   SAVE             12531,12574,12840                 
 PALLZ                      Scalar 12336    L(4)            4           scalar   COM              12574                             
 PART2                      Local  12444    L(4)            4           scalar   SAVE             12462,12527,12813                 
 PDOMAN                     Local  12446    L(4)            4           scalar   SAVE             12530,12573,12840                 
 PDOMNZ                     Scalar 12336    L(4)            4           scalar   COM              12573                             
 PLEV                       Scalar 12328    R(4)            4     1     8        COM                                                
 PRDATA                     Local  12446    L(4)            4           scalar   SAVE             12531,12577,12840,12953           
 PRDSPK                     Subr   12875                                                          12875,12935                       
 PRDTAZ                     Scalar 12336    L(4)            4           scalar   COM              12577                             
 PREND                      Subr   12959                                                          12959                             
 PRES                       Common 12328                                72       SAVE                                               

Page 353         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PRFKMD                     Subr   12876                                                          12876                             
 PRFKMV                     Subr   12936                                                          12936                             
 PRSHT                      Local  12447    L(4)            4           scalar   SAVE             12465,12533,12936                 
 PRTAZI                     Local  12447    L(4)            4           scalar   SAVE             12586                             
 PRTAZZ                     Scalar 12338    L(4)            4           scalar   COM              12586                             
 PRTBGZ                     Scalar 12343    L(4)            4           scalar   COM              12587                             
 PRTBOG                     Local  12449    L(4)            4           scalar   SAVE             12468,12536,12587,12876,12958     
 PRTITL                     Subr   12634                                                          12634                             
 QFIND                      Local  12447    L(4)            4           scalar   SAVE             12466,12533,12930                 
 QUERY                      Local  12447    L(4)            4           scalar   SAVE             12466,12533,12893                 
 RAD0                       Scalar 12329    R(4)            4           scalar   COM              12532                             
 RADFCI                     Scalar 12329    R(4)            4           scalar   COM                                                
 RADSCH                     Local  12533    R(4)            4           scalar   SAVE             12533,12600                       
 RADSHZ                     Scalar 12339    R(4)            4           scalar   COM              12600                             
 RDTITL                     Subr   12633                                                          12633                             
 REAL                       Func   12714                                scalar                    12714                             
 RHANL                      Scalar 12328    L(4)            4           scalar   COM              12529                             
 RMWCLC                     Local  12446    L(4)            4           scalar   SAVE             12465,12532                       
 SAMPLD                     Local  12445    L(4)            4           scalar   SAVE             12464,12529,12957                 
 SECDER                     Local  12445    L(4)            4           scalar   SAVE             12463,12529,12931                 
 SELECT                     Local  12446    L(4)            4           scalar   SAVE             12531,12575,12840                 
 SETKPX                     Subr   12874                                                          12874,12934                       
 SKWT                       Local  12448    L(4)            4           scalar   SAVE             12467,12535,12892                 
 SLARGO                     Subr   12847                                                          12847                             
 SLECTZ                     Scalar 12336    L(4)            4           scalar   COM              12575                             
 SLEFCD                     Subr   12817                                                          12817,12851                       
 SLIMBO                     Subr   12873                                                          12873                             
 SLOVER                     Subr   12835                                                          12835                             
 SPLD1                      Subr   12673                                                                                            
 SPLDAT                     Subr   12301                                                                                            
 SPSKWT                     Subr   12892                                                          12892                             
 SPTDAT                     Subr   12957                                                          12957                             
 SPTFND                     Subr   12930                                                          12930                             
 SPTLOC                     Subr   12893                                                          12893                             
 SRC                        Local  12443    CHAR            19    1     2        SAVE             12454,12790                       
 STDOMN                     Subr   12801                                                          12801                             
 STEXTV                     Subr   12811                                                          12811                             
 STHORC                     Subr   12807                                                          12807                             
 STICK                      Local  12445    L(4)            4           scalar   SAVE             12464,12529,12949                 
 STICKD                     Subr   12952                                                          12952                             
 STMID                      Local  12452    CHAR            12          scalar   SAVE             12455,12627,12781,12790           
 STMIDZ                     Scalar 12343    CHAR            12          scalar   COM              12627                             
 STMNAM                     Local  12452    CHAR            12          scalar   SAVE             12544,12628,12958                 
 STMNMZ                     Scalar 12343    CHAR            12          scalar   COM              12628                             
 STSPBC                     Subr   12830                                                          12830                             
 STSPDC                     Subr   12834                                                          12834                             
 STSPID                     Subr   12797                                                          12797                             
 STSPND                     Subr   12826                                                          12826                             
 SUBM                       Local  12546                                scalar                    12739,12740                       
 THRSH                      Local  12534    R(4)            4           scalar   SAVE             12534,12601                       
 THRSHZ                     Scalar 12339    R(4)            4           scalar   COM              12601                             
 THTAMX                     Scalar 12329    R(4)            4           scalar   COM              12532                             
 TIMWIN                     Local  12448    L(4)            4           scalar   SAVE             12535,12584,12743,12781           
 TIMWNZ                     Scalar 12337    L(4)            4           scalar   COM              12584                             
 TMMNMX                     Common 12330                                48       SAVE                                               

Page 354         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UNIQUE                     Local  12449    L(4)            4           scalar   SAVE             12535,12585,12841                 
 UNIQZ                      Scalar 12337    L(4)            4           scalar   COM              12585                             
 USTM                       Local  12534    R(4)            4           scalar   SAVE             12534,12602,12858,12863           
 USTMZ                      Scalar 12340    R(4)            4           scalar   COM              12602                             
 UTC0                       Scalar 12327    R(4)            4           scalar   COM              12537,12714                       
 UTCMN                      Local  12786    R(4)            4           scalar   SAVE             12786                             
 UTCMX                      Local  12786    R(4)            4           scalar   SAVE             12786                             
 UTCOB                      Scalar 12325    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 12326    R(4)            4     1     20       COM                                                
 UVSAVE                     Local  12445    L(4)            4           scalar   SAVE             12530,12571,12952                 
 UVSAVZ                     Scalar 12336    L(4)            4           scalar   COM              12571                             
 UVTORT                     Scalar 12329    L(4)            4           scalar   COM              12533                             
 VSTM                       Local  12534    R(4)            4           scalar   SAVE             12534,12603,12858,12863           
 VSTMZ                      Scalar 12340    R(4)            4           scalar   COM              12603                             
 WRCHAR                     Local  12449    L(4)            4           scalar   SAVE             12463,12536,12915,12937           
 WRDEV                      Local  12444    L(4)            4           scalar   SAVE             12528,12567,12744                 
 WRDEVZ                     Scalar 12335    L(4)            4           scalar   COM              12567                             
 WRDPTZ                     Scalar 12335    L(4)            4           scalar   COM              12565                             
 WRDSTT                     Local  12444    L(4)            4           scalar   SAVE             12528,12566,12744,12953           
 WRDSTZ                     Scalar 12335    L(4)            4           scalar   COM              12566                             
 WRDTPT                     Local  12444    L(4)            4           scalar   SAVE             12528,12565,12744                 
 WRNST                      Local  12445    L(4)            4           scalar   SAVE             12463,12528,12738,12744           
 WRRES                      Local  12448    L(4)            4           scalar   SAVE             12534,12581,12916,12918           
 WRRESZ                     Scalar 12337    L(4)            4           scalar   COM              12581                             
 WRSPLD                     Local  12444    L(4)            4           scalar   SAVE             12462,12528,12744,12916,12940     
 WRSPLV                     Local  12444    L(4)            4           scalar   SAVE             12462,12528,12744,12938,12940     
 WSTM                       Scalar 12326    R(4)            4     1     20       COM                                                
 XBCL1Z                     Scalar 12341    R(4)            4           scalar   COM              12612                             
 XBCL2Z                     Scalar 12341    R(4)            4           scalar   COM              12613                             
 XBCWL1                     Local  12542    R(4)            4           scalar   SAVE             12542,12612,12830                 
 XBCWL2                     Local  12543    R(4)            4           scalar   SAVE             12543,12613,12830                 
 XDATR                      Subr   12858                                                          12858                             
 XDCWL                      Local  12542    R(4)            4           scalar   SAVE             12542,12610,12834                 
 XDCWLZ                     Scalar 12340    R(4)            4           scalar   COM              12610                             
 XDTSRT                     Subr   12839                                                          12839                             
 XML                        Local  12537    R(4)            4           scalar   SAVE             12537,12715,12743,12801           
 XMLZ                       Local  12544    R(4)            4           scalar   SAVE             12544,12715                       
 XMR                        Local  12537    R(4)            4           scalar   SAVE             12537,12716,12743,12801           
 XMRZ                       Local  12544    R(4)            4           scalar   SAVE             12544,12716                       
 XSBM0                      Local  12546    R(4)            4           scalar   SAVE             12546,12620                       
 XSBM0Z                     Scalar 12342    R(4)            4           scalar   COM              12620                             
 XSBMX                      Local  12546    R(4)            4           scalar   SAVE             12546                             
 XSBMXZ                     Scalar 12342    R(4)            4           scalar   COM                                                
 XSTM                       Scalar 12325    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 12327    R(4)            4           scalar   COM              12792,12807,12887                 
 XYT                        Common 12325                                64432    SAVE                                               
 XZ                         Local  12887    R(4)            4           scalar   SAVE             12887,12892,12893,12930           
 YBCL1Z                     Scalar 12341    R(4)            4           scalar   COM              12614                             
 YBCL2Z                     Scalar 12341    R(4)            4           scalar   COM              12615                             
 YBCWL1                     Local  12543    R(4)            4           scalar   SAVE             12543,12614,12830                 
 YBCWL2                     Local  12543    R(4)            4           scalar   SAVE             12543,12615,12830                 
 YDCWL                      Local  12542    R(4)            4           scalar   SAVE             12542,12611,12834                 
 YDCWLZ                     Scalar 12341    R(4)            4           scalar   COM              12611                             
 YNB                        Local  12537    R(4)            4           scalar   SAVE             12537,12717,12743,12801           
 YNBZ                       Local  12544    R(4)            4           scalar   SAVE             12544,12717                       

Page 355         Source Listing                  SPLDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YNT                        Local  12537    R(4)            4           scalar   SAVE             12537,12718,12743,12801           
 YNTZ                       Local  12544    R(4)            4           scalar   SAVE             12544,12718                       
 YSBM0                      Local  12546    R(4)            4           scalar   SAVE             12546,12621                       
 YSBM0Z                     Scalar 12342    R(4)            4           scalar   COM              12621                             
 YSBMX                      Local  12546    R(4)            4           scalar   SAVE             12546,12622                       
 YSBMXZ                     Scalar 12342    R(4)            4           scalar   COM              12622                             
 YSTM                       Scalar 12325    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 12327    R(4)            4           scalar   COM              12792,12807,12888                 
 YZ                         Local  12888    R(4)            4           scalar   SAVE             12888,12892,12893,12930           
 ZSRFZ                      Scalar 12337    L(4)            4           scalar   COM              12579                             
 ZSURF                      Local  12447    L(4)            4           scalar   SAVE             12534,12579,12745,12775           

Page 356         Source Listing                  SPLDAT
2017-04-18 11:09                                 syndata.f

  12976 
  12977 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  12978 C                .      .    .                                       .
  12979 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  12980 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  12981 C
  12982 C ABSTRACT: ??????????????????????????????????????????????????????????
  12983 C   ??????????????????????????????????????????????????????????????????
  12984 C
  12985 C PROGRAM HISTORY LOG:
  12986 C ????-??-??  S. J. LORD
  12987 C
  12988 C USAGE:    CALL ????????(????)
  12989 C   INPUT ARGUMENT LIST:
  12990 C     ??????   - ???????????????????????????????????????????????
  12991 C
  12992 C   OUTPUT ARGUMENT LIST:
  12993 C     ??????   - ???????????????????????????????????????????????
  12994 C
  12995 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  12996 C     ??????   - ???????????????????????????????????????????????
  12997 C
  12998 C   OUTPUT FILES:
  12999 C     ??????   - ???????????????????????????????????????????????
  13000 C
  13001 C REMARKS: ?????????????????????????????????????????????????????
  13002 C
  13003 C ATTRIBUTES:
  13004 C   LANGUAGE: FORTRAN 90
  13005 C   MACHINE:  NCEP WCOSS
  13006 C
  13007 C$$$
  13008       BLOCK DATA IBM1
  13009       PARAMETER (LDXDIM=8000)
  13010       PARAMETER (NFXDIM=20)
  13011       PARAMETER (KLDIM= 8)
  13012       PARAMETER(KVDIM=20,KDTDIM=5,NEXDIM=5)
  13013 C**SGI      PARAMETER(KVDIM= 7,KDTDIM=5,NEXDIM=5)
  13014       PARAMETER (KPXDIM=KVDIM*KLDIM)
  13015 C
  13016       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  13017      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
  13018      2            MSKD15,MSKD16,MSKD17,MSKD18
  13019 C
  13020       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  13021      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),ELORG,
  13022      2            GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  13023 C
  13024       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  13025 C
  13026       COMMON /AZI/ RADFCI,RAD0,NRDMN,NRDMX,THTAMX,DRAD,DTHETA,UVTORT
  13027 C
  13028       COMMON/IBMBS/KPLVZ,WRDPTZ,WRDSTZ,WRDEVZ,NESTZ,IHOLEZ,DTAFTZ,
  13029      1             UVSAVZ,NOFLGZ,PDOMNZ,PALLZ,SLECTZ,EXTVRZ,PRDTAZ,
  13030      2             ANAVGZ,ZSRFZ,DVSRTZ,WRRESZ,MERCPZ,LLWLZ,TIMWNZ,UNIQZ,
  13031      3             PRTAZZ,KDATZ,JPDZ,ITPMNZ,ITPMXZ,NEXZ,ITPEXZ,NSTIKZ,
  13032      4             KLSTKZ,ISPTPZ,DXSPDZ,DYSPDZ,KXTOFZ,RADSHZ,THRSHZ,

Page 357         Source Listing                  IBM1
2017-04-18 11:09                                 syndata.f

  13033      5             USTMZ,VSTMZ,MXZ,NXZ,DUTMNZ,DUTMXZ,ISRCDZ,KDCZ,XDCWLZ,
  13034      6             YDCWLZ,XBCL1Z,XBCL2Z,YBCL1Z,YBCL2Z,KXBC1Z,KXBC2Z,
  13035      7             KYBC1Z,KYBC2Z,XSBM0Z,XSBMXZ,YSBM0Z,YSBMXZ,IHCZ,
  13036      8             NSWLNZ,MESHCZ,DPRXZ,STMIDZ,STMNMZ,PRTBGZ
  13037 C
  13038       INTEGER ITPEXZ(NEXDIM),KLSTKZ(KLDIM)
  13039 C
  13040       LOGICAL KPLVZ(KLDIM,KVDIM),WRDPTZ,WRDSTZ,WRDEVZ,NESTZ,IHOLEZ,
  13041      1        DTAFTZ,UVSAVZ,NOFLGZ,PDOMNZ,PALLZ,SLECTZ,EXTVRZ,PRDTAZ,
  13042      2        ANAVGZ,ZSRFZ,DVSRTZ,WRRESZ,MERCPZ,LLWLZ,TIMWNZ,UNIQZ,
  13043      3        PRTAZZ,PRTBGZ
  13044 C
  13045       CHARACTER*12  STMIDZ,STMNMZ
  13046 C
  13047       LOGICAL RHANL,UVTORT
  13048 C
  13049       DATA STMIDZ/'SSSSSSSSSSSS'/,STMNMZ/'            '/
  13050 C
  13051       DATA KPLVZ/KPXDIM*.FALSE./,WRDPTZ/.FALSE./,WRDSTZ/.FALSE./,
  13052      1     WRDEVZ/.FALSE./,NESTZ/.FALSE./,RHANL/.TRUE./,IHOLEZ/.FALSE./,
  13053      2     DTAFTZ/.FALSE./,UVSAVZ/.FALSE./,NOFLGZ/.FALSE./,
  13054      3     PDOMNZ/.FALSE./,PALLZ/.FALSE./,SLECTZ/.FALSE./,
  13055      4     EXTVRZ/.FALSE./,PRDTAZ/.FALSE./,ANAVGZ/.TRUE./,
  13056      5     ZSRFZ/.FALSE./,DVSRTZ/.FALSE./,WRRESZ/.FALSE./,
  13057      6     MERCPZ/.FALSE./,LLWLZ/.FALSE./,TIMWNZ/.TRUE./,UNIQZ/.TRUE./,
  13058      7     PRTAZZ/.FALSE./,PRTBGZ/.FALSE./
  13059 C
  13060       DATA KDATZ/5/,JPDZ/2/,ITPMNZ/0/,ITPMXZ/4/,NEXZ/0/,
  13061      1     ITPEXZ/NEXDIM*0/,NSTIKZ/1/,KLSTKZ/KLDIM*0/,ISPTPZ/11/,
  13062      2     DXSPDZ/0.5/,DYSPDZ/0.5/,THRSHZ/100./KXTOFZ/0/,USTMZ/0.0/,
  13063      3     VSTMZ/0.0/
  13064 C
  13065 C     DATA STATMENT FOR COMMON DSK, NAMELIST DSKVAL
  13066 C
  13067       DATA MSKEF/11/,MSKEZ/12/,MSKDA1/13/,MSKDA2/14/,MSKDA3/15/,
  13068      1     MSKDA4/16/,MSKDA5/17/,MSKDA6/18/,MSKDA7/19/,MSKDA8/20/,
  13069      2     MSKDA9/21/,MSKD11/23/,MSKD12/24/,MSKD13/25/,MSKD14/26/,
  13070      3     MSKD15/27/,MSKD16/28/,MSKD17/29/,MSKD18/30/
  13071 C
  13072 C     DATA STATEMENT FOR NAMELIST DOMAIN
  13073 C
  13074       DATA MXZ/20/,NXZ/20/,ISRCDZ/0/,DUTMNZ/10./,DUTMXZ/50./
  13075 CCCC 1     ELORG/-99.0/,GLORG/-99.0/
  13076 C
  13077 C     DATA STATEMENT FOR NAMELIST DCBC
  13078 C
  13079       DATA KDCZ/3/,XDCWLZ/6./,YDCWLZ/6./,KXBC1Z/21/,KXBC2Z/21/,
  13080      1     KYBC1Z/21/,KYBC2Z/21/,XBCL1Z/10./,XBCL2Z/10./,YBCL1Z/10./,
  13081      2     YBCL2Z/10./
  13082 C
  13083 C     DATA STATEMENT FOR COMMON PRES
  13084 C
  13085 CIBM  INITIALIZATION FOR PLEV MOVED FROM SUBROUTINE XDTSRT
  13086       DATA PLEV/200.,250.,300.,400.,500.,700.,850.,1000./
  13087       DATA DPRXZ/25./
  13088       DATA ICOOR/1/,IDAT/4/,IDATZ/3/
  13089 C

Page 358         Source Listing                  IBM1
2017-04-18 11:09                                 syndata.f

  13090 C     DATA STATEMENT FOR NAMELIST SUBM
  13091 C
  13092       DATA XSBM0Z/-1.1/,XSBMXZ/1.2/,YSBM0Z/-0.8/,YSBMXZ/1.4/
  13093 C
  13094 C     DATA STATEMENT FOR COMMON AZI AND OTHER VARIABLES
  13095 C
  13096 C     UNITS FOR RAD0, DRAD ARE IN KM FOR MORE CONVENIENT USER INTERACTIO
  13097 C       THIS IS AN EXCEPTION TO THE STANDARD INTERNAL UNIT, WHICH IS
  13098 C       DEGREES LATITUDE.  RADFCI=1./111.1775 CONVERTS KM TO DEG. LAT.
  13099       DATA RADFCI/.0089946/,
  13100      1     NRDMN/1/,NRDMX/1/,RAD0/0.0/,THTAMX/360./,
  13101      2     DRAD/1.0/,DTHETA/5.0/,RADSHZ/3.0/,UVTORT/.FALSE./
  13102      3     IHCZ/0/,NSWLNZ/1/,MESHCZ/1/
  13103       END


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANAVGZ                     Scalar 13030    L(4)            4           scalar   COM,SAVE         13055                             
 AZI                        Common 13026                                32                                                          
 DATREC                     Scalar 13024    R(4)            4     1     6        COM                                                
 DPRXZ                      Scalar 13036    R(4)            4           scalar   COM,SAVE         13087                             
 DRAD                       Scalar 13026    R(4)            4           scalar   COM,SAVE         13101                             
 DSK                        Common 13016                                76                                                          
 DTAFTZ                     Scalar 13028    L(4)            4           scalar   COM,SAVE         13053                             
 DTHETA                     Scalar 13026    R(4)            4           scalar   COM,SAVE         13101                             
 DUTMNZ                     Scalar 13033    R(4)            4           scalar   COM,SAVE         13074                             
 DUTMXZ                     Scalar 13033    R(4)            4           scalar   COM,SAVE         13074                             
 DVSRTZ                     Scalar 13030    L(4)            4           scalar   COM,SAVE         13056                             
 DXSPDZ                     Scalar 13032    R(4)            4           scalar   COM,SAVE         13062                             
 DYSPDZ                     Scalar 13032    R(4)            4           scalar   COM,SAVE         13062                             
 ELORG                      Scalar 13021    R(4)            4           scalar   COM                                                
 EXTVRZ                     Scalar 13029    L(4)            4           scalar   COM,SAVE         13055                             
 GLORG                      Scalar 13022    R(4)            4           scalar   COM                                                
 IBM1                       Block  13008                                scalar                                                      
 IBMBS                      Common 13028                                960                                                         
 ICOOR                      Scalar 13024    I(4)            4           scalar   COM,SAVE         13088                             
 IDAT                       Scalar 13024    I(4)            4           scalar   COM,SAVE         13088                             
 IDATZ                      Scalar 13024    I(4)            4           scalar   COM,SAVE         13088                             
 IDAYMN                     Scalar 13022    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 13020    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 13021    I(4)            4     1     20       COM                                                
 IHCZ                       Scalar 13035    I(4)            4           scalar   COM,SAVE         13102                             
 IHOLEZ                     Scalar 13028    L(4)            4           scalar   COM,SAVE         13052                             
 ISPTPZ                     Scalar 13032    I(4)            4           scalar   COM,SAVE         13061                             
 ISRCDZ                     Scalar 13033    I(4)            4           scalar   COM,SAVE         13074                             
 ITPEXZ                     Scalar 13031    I(4)            4     1     5        COM,SAVE         13061                             
 ITPMNZ                     Scalar 13031    I(4)            4           scalar   COM,SAVE         13060                             
 ITPMXZ                     Scalar 13031    I(4)            4           scalar   COM,SAVE         13060                             
 JDAY0                      Scalar 13022    I(4)            4           scalar   COM                                                
 JPDZ                       Scalar 13031    I(4)            4           scalar   COM,SAVE         13060                             
 KDATZ                      Scalar 13031    I(4)            4           scalar   COM,SAVE         13060                             
 KDCZ                       Scalar 13033    I(4)            4           scalar   COM,SAVE         13079                             
 KDTDIM                     Param  13012    I(4)            4           scalar                    13024                             
 KLDIM                      Param  13011    I(4)            4           scalar                    13014,13024,13038,13040,13061     

Page 359         Source Listing                  IBM1
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KLSTKZ                     Scalar 13032    I(4)            4     1     8        COM,SAVE         13061                             
 KPLVZ                      Scalar 13028    L(4)            4     2     160      COM,SAVE         13051                             
 KPXDIM                     Param  13014    I(4)            4           scalar                    13051                             
 KVDIM                      Param  13012    I(4)            4           scalar                    13014,13040                       
 KXBC1Z                     Scalar 13034    I(4)            4           scalar   COM,SAVE         13079                             
 KXBC2Z                     Scalar 13034    I(4)            4           scalar   COM,SAVE         13079                             
 KXTOFZ                     Scalar 13032    I(4)            4           scalar   COM,SAVE         13062                             
 KYBC1Z                     Scalar 13035    I(4)            4           scalar   COM,SAVE         13080                             
 KYBC2Z                     Scalar 13035    I(4)            4           scalar   COM,SAVE         13080                             
 LDXDIM                     Param  13009    I(4)            4           scalar                    13020                             
 LLWLZ                      Scalar 13030    L(4)            4           scalar   COM,SAVE         13057                             
 MERCPZ                     Scalar 13030    L(4)            4           scalar   COM,SAVE         13057                             
 MESHCZ                     Scalar 13036    I(4)            4           scalar   COM,SAVE         13102                             
 MSKD11                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13069                             
 MSKD12                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13069                             
 MSKD13                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13069                             
 MSKD14                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13069                             
 MSKD15                     Scalar 13018    I(4)            4           scalar   COM,SAVE         13070                             
 MSKD16                     Scalar 13018    I(4)            4           scalar   COM,SAVE         13070                             
 MSKD17                     Scalar 13018    I(4)            4           scalar   COM,SAVE         13070                             
 MSKD18                     Scalar 13018    I(4)            4           scalar   COM,SAVE         13070                             
 MSKDA1                     Scalar 13016    I(4)            4           scalar   COM,SAVE         13067                             
 MSKDA2                     Scalar 13016    I(4)            4           scalar   COM,SAVE         13067                             
 MSKDA3                     Scalar 13016    I(4)            4           scalar   COM,SAVE         13067                             
 MSKDA4                     Scalar 13016    I(4)            4           scalar   COM,SAVE         13068                             
 MSKDA5                     Scalar 13016    I(4)            4           scalar   COM,SAVE         13068                             
 MSKDA6                     Scalar 13016    I(4)            4           scalar   COM,SAVE         13068                             
 MSKDA7                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13068                             
 MSKDA8                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13068                             
 MSKDA9                     Scalar 13017    I(4)            4           scalar   COM,SAVE         13069                             
 MSKEF                      Scalar 13016    I(4)            4           scalar   COM,SAVE         13067                             
 MSKEZ                      Scalar 13016    I(4)            4           scalar   COM,SAVE         13067                             
 MXZ                        Scalar 13033    I(4)            4           scalar   COM,SAVE         13074                             
 NESTZ                      Scalar 13028    L(4)            4           scalar   COM,SAVE         13052                             
 NEXDIM                     Param  13012    I(4)            4           scalar                    13038,13061                       
 NEXZ                       Scalar 13031    I(4)            4           scalar   COM,SAVE         13060                             
 NFIX0                      Scalar 13022    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  13010    I(4)            4           scalar                    13020,13021                       
 NOFLGZ                     Scalar 13029    L(4)            4           scalar   COM,SAVE         13053                             
 NRDMN                      Scalar 13026    I(4)            4           scalar   COM,SAVE         13100                             
 NRDMX                      Scalar 13026    I(4)            4           scalar   COM,SAVE         13100                             
 NSTIKZ                     Scalar 13031    I(4)            4           scalar   COM,SAVE         13061                             
 NSWLNZ                     Scalar 13036    I(4)            4           scalar   COM,SAVE         13102                             
 NXZ                        Scalar 13033    I(4)            4           scalar   COM,SAVE         13074                             
 PALLZ                      Scalar 13029    L(4)            4           scalar   COM,SAVE         13054                             
 PDOMNZ                     Scalar 13029    L(4)            4           scalar   COM,SAVE         13054                             
 PLEV                       Scalar 13024    R(4)            4     1     8        COM,SAVE         13086                             
 PRDTAZ                     Scalar 13029    L(4)            4           scalar   COM,SAVE         13055                             
 PRES                       Common 13024                                72                                                          
 PRTAZZ                     Scalar 13031    L(4)            4           scalar   COM,SAVE         13058                             
 PRTBGZ                     Scalar 13036    L(4)            4           scalar   COM,SAVE         13058                             
 RAD0                       Scalar 13026    R(4)            4           scalar   COM,SAVE         13100                             
 RADFCI                     Scalar 13026    R(4)            4           scalar   COM,SAVE         13099                             
 RADSHZ                     Scalar 13032    R(4)            4           scalar   COM,SAVE         13101                             
 RHANL                      Scalar 13024    L(4)            4           scalar   COM,SAVE         13052                             

Page 360         Source Listing                  IBM1
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SLECTZ                     Scalar 13029    L(4)            4           scalar   COM,SAVE         13054                             
 STMIDZ                     Scalar 13036    CHAR            12          scalar   COM,SAVE         13049                             
 STMNMZ                     Scalar 13036    CHAR            12          scalar   COM,SAVE         13049                             
 THRSHZ                     Scalar 13032    R(4)            4           scalar   COM,SAVE         13062                             
 THTAMX                     Scalar 13026    R(4)            4           scalar   COM,SAVE         13100                             
 TIMWNZ                     Scalar 13030    L(4)            4           scalar   COM,SAVE         13057                             
 UNIQZ                      Scalar 13030    L(4)            4           scalar   COM,SAVE         13057                             
 USTMZ                      Scalar 13033    R(4)            4           scalar   COM,SAVE         13062                             
 UTC0                       Scalar 13022    R(4)            4           scalar   COM                                                
 UTCOB                      Scalar 13020    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 13021    R(4)            4     1     20       COM                                                
 UVSAVZ                     Scalar 13029    L(4)            4           scalar   COM,SAVE         13053                             
 UVTORT                     Scalar 13026    L(4)            4           scalar   COM,SAVE         13101                             
 VSTMZ                      Scalar 13033    R(4)            4           scalar   COM,SAVE         13063                             
 WRDEVZ                     Scalar 13028    L(4)            4           scalar   COM,SAVE         13052                             
 WRDPTZ                     Scalar 13028    L(4)            4           scalar   COM,SAVE         13051                             
 WRDSTZ                     Scalar 13028    L(4)            4           scalar   COM,SAVE         13051                             
 WRRESZ                     Scalar 13030    L(4)            4           scalar   COM,SAVE         13056                             
 WSTM                       Scalar 13021    R(4)            4     1     20       COM                                                
 XBCL1Z                     Scalar 13034    R(4)            4           scalar   COM,SAVE         13080                             
 XBCL2Z                     Scalar 13034    R(4)            4           scalar   COM,SAVE         13080                             
 XDCWLZ                     Scalar 13033    R(4)            4           scalar   COM,SAVE         13079                             
 XSBM0Z                     Scalar 13035    R(4)            4           scalar   COM,SAVE         13092                             
 XSBMXZ                     Scalar 13035    R(4)            4           scalar   COM,SAVE         13092                             
 XSTM                       Scalar 13020    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 13022    R(4)            4           scalar   COM                                                
 XYT                        Common 13020                                64432                                                       
 YBCL1Z                     Scalar 13034    R(4)            4           scalar   COM,SAVE         13080                             
 YBCL2Z                     Scalar 13034    R(4)            4           scalar   COM,SAVE         13081                             
 YDCWLZ                     Scalar 13034    R(4)            4           scalar   COM,SAVE         13079                             
 YSBM0Z                     Scalar 13035    R(4)            4           scalar   COM,SAVE         13092                             
 YSBMXZ                     Scalar 13035    R(4)            4           scalar   COM,SAVE         13092                             
 YSTM                       Scalar 13020    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 13022    R(4)            4           scalar   COM                                                
 ZSRFZ                      Scalar 13030    L(4)            4           scalar   COM,SAVE         13056                             

Page 361         Source Listing                  IBM1
2017-04-18 11:09                                 syndata.f

  13104 
  13105 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13106 C                .      .    .                                       .
  13107 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  13108 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  13109 C
  13110 C ABSTRACT: ??????????????????????????????????????????????????????????
  13111 C   ??????????????????????????????????????????????????????????????????
  13112 C
  13113 C PROGRAM HISTORY LOG:
  13114 C ????-??-??  S. J. LORD
  13115 C
  13116 C USAGE:    CALL ????????(????)
  13117 C   INPUT ARGUMENT LIST:
  13118 C     ??????   - ???????????????????????????????????????????????
  13119 C
  13120 C   OUTPUT ARGUMENT LIST:
  13121 C     ??????   - ???????????????????????????????????????????????
  13122 C
  13123 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  13124 C     ??????   - ???????????????????????????????????????????????
  13125 C
  13126 C   OUTPUT FILES:
  13127 C     ??????   - ???????????????????????????????????????????????
  13128 C
  13129 C REMARKS: ?????????????????????????????????????????????????????
  13130 C
  13131 C ATTRIBUTES:
  13132 C   LANGUAGE: FORTRAN 90
  13133 C   MACHINE:  NCEP WCOSS
  13134 C
  13135 C$$$
  13136       SUBROUTINE XDTSUB(KPLV,KDAT,DWF,ITYPMN,ITYPMX,NEX,ITYPEX,NEST,
  13137      1                  NOFLAG,PDOMAN,PALL,SELECT,PRDATA,DPR,NSWLN,
  13138      2                  UNIQUE,NFIXPZ,TIMWNZ,IDAYMX,UTCMX,UTCMN,DUTCMN,
  13139      3                  DUTCMX,STMID)
  13140 C       OUTPUT ARG. IDAYMX - SLORD DATE FORMAT FOR DATE (YYYYMMDD) (MAX)
  13141 C
  13142       PARAMETER (MDIM=35,NDIM=35)
  13143       PARAMETER (LDXDIM=8000)
  13144       PARAMETER (NFXDIM=20,NTPDIM=30)
  13145       PARAMETER (KLDIM= 8)
  13146       PARAMETER(KVDIM=20,KDTDIM=5,NEXDIM=5)
  13147 C**SIG      PARAMETER(KVDIM= 7,KDTDIM=5,NEXDIM=5)
  13148       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  13149       PARAMETER (KPXDIM=KVDIM*KLDIM)
  13150 C
  13151 CIBM  THE FOLLOWING COMMON MAY SAVE SOME EXECUTION SPACE ON THE
  13152 CIBM     PITIFULLY SMALL IBM.
  13153 CIBM  COMMON /IND/ INDX(LDXDIM,NTPDIM)
  13154       COMMON /IND/ INDX(LDXDIM)
  13155 C
  13156 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  13157 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  13158       COMMON /AFD/A(KDXDIM,MDIM,NDIM),FD(KDXDIM,LDXDIM),
  13159      1            FKMN(KPXDIM,MDIM,NDIM)
  13160       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,

Page 362         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13161      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  13162       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  13163      1              ID(LDXDIM),LXSORT(LDXDIM)
  13164       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  13165      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
  13166      2            MSKD15,MSKD16,MSKD17,MSKD18
  13167       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  13168      1           WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),ELORG,GLORG,
  13169      2           XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  13170       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  13171       COMMON /TMMNMX/ IYMN,IMMN,IDMN,IHMN,IYMX,IMMX,IDMX,IHMX,IY0,IM0,
  13172      1                ID0,HR0
  13173       COMMON /DWATE/ WDR(NTPDIM),JSKEEM(NTPDIM),IDTYP(100),JDTYP(NTPDIM)
  13174 C
  13175       CHARACTER*8 IDSPD1,IDSPD2*72,IDSPC*125,FLAG*1,STMID*12
  13176       LOGICAL KPLV(KLDIM,KVDIM),NEST,RHANL,NOFLAG,PDOMAN,PALL,SELECT,
  13177      1        PRDATA,NOGOOD,TIMWIN,TIMWNZ,UNIQUE
  13178       DIMENSION JDAT(8),LDAT(8),RINC(5)
  13179       REAL(8)  HEAD_8(5)
  13180       SAVE
  13181       DIMENSION DWF(KDAT*KLDIM),DATA(KDTDIM),FLAG(KDTDIM),
  13182      1          ITYPEX(NEXDIM),PMN(7),PMX(7),LDSORT(LDXDIM),
  13183      2          XDZ(LDXDIM),FDD(LDXDIM),LDXTYP(NTPDIM)
  13184 CIBM 3          INDX(LDXDIM,NTPDIM)
  13185       EQUIVALENCE (PR,DATREC(1)),(DATA(1),DATREC(2))
  13186 C
  13187       DATA  PMN/100.,350.,400.,450.,500.,550.,1001./,
  13188      1      PMX/349.,399.,449.,499.,549.,1000.,1075./
  13189 C
  13190 C     ******* CHANGE PLEV AND DPR BELOW FOR A DIFFERENT VERTICAL
  13191 C             COORDINATE  *******
  13192 C
  13193 CIBM  THE FOLLOWING INITIALIZATION MOVED TO BLOCK DATA
  13194 CIBM  INCLUDE 'PLEV/LIST'
  13195       DATA FMS/0.33/,PSRF/1013.0/,FLAG/KDTDIM*'0'/
  13196 C
  13197 
  13198 C-----------------------------------------------------------------------
  13199 
  13200       ENTRY XDTSRT(KPLV,KDAT,DWF,ITYPMN,ITYPMX,NEX,ITYPEX,NEST,NOFLAG,
  13201      1             PDOMAN,PALL,SELECT,PRDATA,DPR,NSWLN,UNIQUE)
  13202 C
  13203 C     THIS ENTRY READS EACH DATA RECORD, CHECKS PRESSURE LEVEL TO
  13204 C     SEE IF IT BELONGS TO THE CURRENT FIELD GEOMETRY, AND STORES DATA
  13205 C     IN ARRAY FD FOR CHECKING.  AFTER CHECKING AND FILLING IN MISSING
  13206 C     VALUES WITH BOGUS VALUES, THE COMPLETE DATA SET IS WRITTEN TO
  13207 C     DISK.  CURRENTLY, ANY FIELD WITH MORE THAN 33 PCNT (FMS) OF DATA
  13208 C     MISSING IS NOT BOGUSSED.
  13209 C     KDAT IS THE NUMBER OF VARIABLES PER CARD, KLDIM IS THE NUMBER OF L
  13210 C     KDXDIM IS THE NUMBER OF VARIABLES*NUMBER OF LEVELS, LDX COUNTS
  13211 C     OBSERVATIONS READ, LDXDIM IS THE MAXIMUM NUMBER OF OBSERVATIONS
  13212 C
  13213       ICOUNT=0
  13214       KDDIM=KDAT*KLDIM
  13215 C
  13216       FD=-99.0
  13217       WD=-99.0

Page 363         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13218       XD=-99.0
  13219       YD=-99.0
  13220 C
  13221       LDX=1
  13222 C
  13223 C     AUTOMATIC (POTENTIAL) ACCEPTANCE OF DATA AT ALL PRESSURE LEVELS
  13224 C     WHEN SELECT IS TRUE.  IN THIS CASE, KPLV DETERMINES WHICH
  13225 C     PRESSURE LEVELS DATA WILL BE STORED.
  13226 C     CHECK IF TOO MUCH IS EXCLUDED FROM THE ANALYSIS
  13227 C
  13228       IF(SELECT)  PALL=.TRUE.
  13229       IF(NEX .GT. NEXDIM) GO TO 995
  13230 C
  13231 C     DATA READING FOR ODW....WD IS READ IN AS DATA TYPE AND STORED LATE
  13232 C         INTO ID (DATA TYPE).  AFTER THAT POINT, WD IS DATA WEIGHT.
  13233 C         MAXIMUM ALLOWED DATA TYPES IS 30  (=NTPDIM).  ALSO, TWO SPOTS
  13234 C         ARE RESERVED FOR STORM TRACK AND T=0 POSITION (98&99)
  13235 C     DATA TYPES:
  13236 C          1...ODW
  13237 C          2...RAWINSONDE
  13238 C          3...NOAA P-3 AIRCRAFT
  13239 C          4...SURFACE SHIPS
  13240 C          5...COMMERCIAL AIRCRAFT
  13241 C          6...AIR FORCE RECONAISSANCE
  13242 C          7...AIR FORCE VORTEX DATA
  13243 C          8...AIRBORNE DOPPLER DATA
  13244 C          9...PIBAL AND/OR SIGNIFICANT LEVEL OBS.
  13245 C          10..VERTICALLY INTERPOLATED (1-D SPLINE)
  13246 C          11..VERTICALLY INTERPOLATED (2-D SPLINE)
  13247 C          12..NCEP (REGIONAL) ANALYSIS VALUE
  13248 C          13..NHC (ATOLL) ANALYSIS VALUE
  13249 C          20..VAS TEMPERATURE & MOISTURE SOUNDING
  13250 C          21..WISCONSIN CLOUD TRACK WIND
  13251 C          22..VAS-DERIVED GRADIENT WINDS
  13252 C          23..VAS-DERIVED WATER VAPOR WINDS
  13253 C          24..NCEP CLOUD DRIFT WINDS
  13254 C          25..NHC CLOUD DRIFT WINDS
  13255 C          26..TIROS POLAR ORBITING SATELLITE
  13256 C          50..BOGUS DATA (MANUALLY ENTERED)
  13257 C          51..BACKGROUND VALUE (REGIONAL ANALYSIS GRIDDED FIELD)
  13258 C          52..BACKGROUND VALUE (ATOLL ANALYSIS GRIDDED FIELD)
  13259 C          98..STORM TRACK
  13260 C          99..HURRICANE POSITION AT TIME T=0
  13261 C     READ DATA.  IF ALL DATA ARE READ, GOTO 25.  IF NOT, GOTO 40 TO RET
  13262 C
  13263       igo = 20
  13264    20 READ(MSKDA1,ERR=910,END=25) WX,IDAYX,UTCX,YX,XX,PR,
  13265      1     (DATA(K),K=1,KDAT),(FLAG(KFL),KFL=1,KDAT-1)
  13266       ICOUNT = ICOUNT + 1
  13267 C
  13268 C**   DEBUG PRINTOUT:
  13269 c && 7 comments
  13270 CC    IF(MOD(ICOUNT,100) .EQ. 1) THEN
  13271 CC      WRITE(6,21)  ICOUNT,WX,IDAYX,UTCX,YX,XX,PR,(DATA(K),K=1,KDAT),
  13272 CC   1                 (FLAG(KFL),KFL=1,KDAT-1)
  13273 CC 21   FORMAT('...FOR ICOUNT=',I8,' WX,IDAYX,UTCX,YX,XX,PR,DATA,FLAG=',
  13274 CC   1         /,3X,F3.0,1X,I9,1X,F5.0,1X,2(F7.3,1X),3(F6.1,1X),F7.1,

Page 364         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13275 CC   2         2(F6.1,1X),4A1)
  13276 CC    ENDIF
  13277 C
  13278       GO TO 40
  13279    25 IF(.NOT. NEST)  GO TO 130
  13280 C
  13281 C     AUTOMATIC ACCEPTANCE OF ALL NESTED DATA
  13282 C
  13283       FLAG(1:KDAT-1)='0'
  13284 C
  13285       igo = 30
  13286 C
  13287 C     READ SPLINE INTERPOLATED DATA FOR NESTED SUBMESH
  13288 C
  13289       OPEN(UNIT=MSKDA6,ACCESS='SEQUENTIAL',FORM='UNFORMATTED',
  13290 CVAX 1     FILE='RNSTDAT',STATUS='OLD',READONLY,SHARED)
  13291 CIBM 1     FILE='RNSTDAT',STATUS='OLD',ACTION='READ')
  13292      1     FILE='RNSTDAT',STATUS='UNKNOWN')
  13293    30 READ(MSKDA6,END=130) WX,IDAYX,UTCX,YX,XX,PR,DATA
  13294 C
  13295 C     DEBUG PRINTOUT
  13296 c && 7 comments
  13297 CC    IF(ICOUNT .LE. 15) THEN
  13298 CC      WRITE(6,31)  WX,IDAYX,UTCX,YX,XX,PR,(DATA(K),K=1,KDAT)
  13299 CC 31   FORMAT('...WX,IDAYX,UTCX,YX,XX,PR,DATA=',/,
  13300 CC   1         F3.0,1X,I9,1X,F4.0,1X,2(F7.3,1X),3(F6.1,1X),
  13301 CC   2         F7.1,2(F6.1,1X))
  13302 CC      ICOUNT = ICOUNT + 1
  13303 CC    ENDIF
  13304 C
  13305    40 LDXX=LDX
  13306       CALL XTIME(IDAYX,UTCX,IYX,IMX,IDX,HRX)
  13307 C
  13308 C     A WHOLE BUNCH OF SELECTIVE IF STATEMENTS FOR THE RIGHT KIND OF
  13309 C     DATA
  13310 C
  13311 C     MAKE SURE DATA POINT IS WITHIN THE BOUNDARIES (SET UP IS FOR
  13312 C       LAT/LONG COORDS.  IDEA IS TO PREVENT DATA FROM OTHER NESTED
  13313 C       GRIDS FROM BEING INCLUDED IN THE BOGUS STATISTICS BELOW.
  13314 C
  13315       IF(NEST) THEN
  13316       IF(NSWLN .GT. 0)  THEN
  13317       IF(XX .GT. ABS(XML)+2. .OR. XX .LT. ABS(XMR)-2. .OR.
  13318      1   YX .LT. YNB-2. .OR. YX .GT. YNT+2.)  go to 9999
  13319       ELSE
  13320       IF(XX .LT. XML-2. .OR. XX .GT. XMR+2. .OR.
  13321      1   YX .LT. YNB-2. .OR. YX .GT. YNT+2.)  go to 9999
  13322       ENDIF
  13323       ENDIF
  13324 C
  13325 C     MAKE SURE DATA TYPE IS ALLOWABLE
  13326 C
  13327       IF(IFIX(WX) .LT. ITYPMN .OR. (IFIX(WX) .GT. ITYPMX .AND. IFIX(WX)
  13328      1            .NE. 50))  go to 9999
  13329 C
  13330 C     CHECK FOR EXCLUDED DATA TYPES
  13331 C

Page 365         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13332       DO NEXX=1,NEX
  13333       IF(IFIX(WX) .EQ. ITYPEX(NEXX))  go to 9999
  13334       ENDDO
  13335 C
  13336 C     CHECK IF DATA TIME IS CORRECT
  13337 C
  13338       IF(TIMWIN)  THEN
  13339       IF(IYX .LT. IYMN)  go to 9999
  13340       IF(IMX .LT. IMMN .AND. (IYX .EQ. IYMN))  go to 9999
  13341       IF(IDX .LT. IDMN .AND. (IMX .EQ. IMMN .AND. IYX .EQ. IYMN))
  13342      1    go to 9999
  13343       IF(HRX .LT. HRMN .AND. IDX .EQ. IDMN .AND. IMX .EQ. IMMN
  13344      1   .AND. IYX .EQ. IYMN)  go to 9999
  13345       IF(IYX .GT. IYMX)  go to 9999
  13346       IF(IMX .GT. IMMX .AND. IYX .EQ. IYMX)  go to 9999
  13347       IF(IDX .GT. IDMX .AND. (IMX .EQ. IMMX .AND. IYX .EQ. IYMX))
  13348      1    go to 9999
  13349       IF(HRX .GT. HRMX .AND. (IDX .EQ. IDMX .AND. IMX .EQ. IMMX
  13350      1   .AND. IYX .EQ. IYMX))  go to 9999
  13351       ENDIF
  13352 C
  13353 C     VERTICAL COORDINATE SELECTION:  THREE OPTIONS ARE AVAILABLE.
  13354 C     1) FOR A VERTICAL DOMAIN INSTEAD OF INDIVIDUAL LEVELS, PDOMAN=.TRU
  13355 C        AND THE FIRST IF STATEMENT BELOW IS ACTIVATED.
  13356 C     2) FOR INDIVIDUAL VERTICAL LEVELS, THE SECOND IF STATEMENT BELOW
  13357 C        IS ACTIVATED (PDOMAN=PALL=.FALSE.)
  13358 C     3) FOR ALL LEVELS, USING THE IDENTICAL GEOMETRY WITH HEIGHT, PALL=
  13359 C        AND BOTH IF STATEMENTS BELOW ARE INACTIVATED.
  13360 C     4) FOR MULTIPLE SELECTED LEVELS, SELECT=.TRUE.
  13361 C     DEFINE VERTICAL COORDINATE: PUT EITHER PRESSURE OR HEIGHT INTO DAT
  13362 C
  13363       VCOORD=DATREC(ICOOR)
  13364       DATAZ=DATREC(IDAT)
  13365       DATA(IDATZ)=DATAZ
  13366 C
  13367 C     DOMAIN OPTION:  CHECK IF THE DATA ARE BETWEEN THE DESIRED LEVELS
  13368 C
  13369       IF(PDOMAN .AND. (VCOORD .LT. PMN(JPD) .OR.
  13370      1                  VCOORD .GT. PMX(JPD)))  go to 9999
  13371 C
  13372 C     INDIVIDUAL LEVEL OPTION:  CHECK IF THE DATA ARE WITHIN THE DESIRED
  13373 C     PRESSURE WINDOW
  13374 C
  13375       IF((.NOT. PDOMAN .AND. .NOT. PALL) .AND.
  13376      1     ABS(VCOORD-PLEV(JPD)) .GT. DPR)  go to 9999
  13377 C
  13378 C     MULTIPLE SELECTED LEVELS: PERFORM A PRELIMINARY PRESSURE CHECK
  13379 C                               TO MAKE SURE DATA LIES AT A REQUESTED
  13380 C                               ANALYSIS LEVEL.  GOTO 47 IF ALL LEVELS
  13381 C                               ARE ADMITTED.  FIRST, CHECK IF PARTICULA
  13382 C                               LEVEL AND VARIABLE ARE SELECTED, THEN TH
  13383 C                               DATA ARE WITHIN THE DESIRED PRESSURE LEV
  13384 C
  13385       IF(.NOT. SELECT)  GO TO 47
  13386 C
  13387       DO KPL=1,KLDIM
  13388          DO KD=1,KDAT

Page 366         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13389             IF(.NOT. KPLV(KPL,KD))  GO TO 46
  13390             IF(ABS(VCOORD-PLEV(KPL)) .LE. DPR)  GO TO 47
  13391    46       CONTINUE
  13392          ENDDO
  13393       ENDDO
  13394 C
  13395       go to 9999
  13396 C
  13397 C     ACCEPT DATA, BUT REJECT IF TIME AND LOCATION DATA ARE DUPLICATE
  13398 C
  13399    47 LNEW=0
  13400       LP=LDXX
  13401 C
  13402       IF(UNIQUE)  THEN
  13403       DO 50 L=1,LDXX-1
  13404       LP=L
  13405       IF(XX .EQ. XD(L) .AND. YX .EQ. YD(L) .AND. WX .EQ. WD(L) .AND.
  13406      1   IDAYX .EQ. IDAYOB(L) .AND. UTCX .EQ. UTCOB(L))  GO TO 60
  13407    50 CONTINUE
  13408       LP=LDXX
  13409       ENDIF
  13410 C
  13411 C     CHECK IF THERE ARE TOO MANY OBSERVATIONS
  13412 C
  13413       IF(LDX .GT. LDXDIM) GO TO 930
  13414 C
  13415 C     STORE THE NEW DATA POINT......
  13416 C     WARNING: HURPOS MUST BE CALLED FIRST
  13417 C
  13418       LNEW=1
  13419       XD(LDX) =XX
  13420       YD(LDX) =YX
  13421       WD(LDX) =WX
  13422       IF(PRDATA)  WRITE(6,51)  LDX,WD(LDX),XD(LDX),YD(LDX),UTCX,IDAYX,
  13423      1            (FLAG(KFL),KFL=1,KDAT-1)
  13424    51 FORMAT(' ***** DATA LOCATION PT.#',I6,'  TYPE=',F3.0,
  13425      1       '  X=',F6.1,'  Y=',F6.1,' UTC=',F6.0,'  DAY=',I10,
  13426      2       '  FLAG=',4A1)
  13427       IDAYOB(LDX)=IDAYX
  13428       UTCOB(LDX)=UTCX
  13429       LDX=LDX+1
  13430 C
  13431 C     SET INDICES FOR DISTRIBUTION OF DATA VERTICALLY (IN A LAYER OF
  13432 C     THICKNESS DPR).  DO NOT DO IF DATA ARE NOT WITHIN THE PRESSURE WIN
  13433 C
  13434    60 KPMN=KLDIM+1
  13435       KPMX=0
  13436 C
  13437       DO 70 KPL=1,KLDIM
  13438       IF(ABS(VCOORD-PLEV(KPL)) .GT. DPR)  GO TO 70
  13439       KPMN=MIN(KPMN,KPL)
  13440       KPMX=MAX(KPMX,KPL)
  13441    70 CONTINUE
  13442 C
  13443 C     CHECK IF DATA HAVE BEEN ACCEPTED
  13444 C
  13445       IF(KPMX .EQ. 0 .OR. KPMN .EQ. KLDIM+1)  GO TO 990

Page 367         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13446 C
  13447 C     FOR UNCONDITIONAL STORAGE OF DATA POINTS, CHANGE ABOVE "GO TO 80"
  13448 C     BRANCH TO "GO TO 89", AND COMMENT OUT ALL CODE FROM STATEMENT
  13449 C     NUMBERS 80-88(+) BELOW.
  13450 C
  13451       NOGOOD=.FALSE.
  13452 C
  13453       DO 100 KP=KPMN,KPMX
  13454       IGOOD=0
  13455       IPERT=0
  13456 C
  13457 C     ONLY A SINGLE FLAG IS GIVEN SO IT MUST BE COPIED INTO THE SECOND
  13458 C     WIND COMPONENT.  ASSUME WINDS ARE THE LAST TWO DATA SLOTS.
  13459 C
  13460       FLAG(KDAT)=FLAG(KDAT-1)
  13461       DO 85 KV=1,KDAT
  13462 C
  13463 C     MAKE SURE DATA ARE TO BE ACCEPTED
  13464 C
  13465       IF(.NOT. KPLV(KP,KV))  GO TO 85
  13466       IPERT=1
  13467 C
  13468 C     SELECTIVE IF STATEMENT FOR MISSING DATA OR DATA FLAGGED AS SUSPICI
  13469 C     ******  IMPORTANT NOTE:  AS OF 6/22/88, YOU MAY ENTER A
  13470 C                              BOGUS DATA POINT WITH MISSING DATA
  13471 C                              AND THE PROGRAM WILL FILL IN VALUES
  13472 C                              FROM NEIGHBORING DATA POINTS THAT DO
  13473 C                              NOT HAVE MISSING DATA.
  13474 C
  13475       IF(IFIX(WX) .NE. 50)  THEN
  13476       IF(DATA(KV) .EQ. -99.0 .OR. (FLAG(KV) .EQ. 'X' .AND.
  13477      1                            (.NOT. NOFLAG .OR. WX .EQ. 1)))
  13478      2                             GO TO 85
  13479       ENDIF
  13480       IGOOD=IGOOD+1
  13481       IF(PRDATA .AND. IGOOD .EQ. 1)  WRITE(6,84) VCOORD,PLEV(KP),
  13482      1                               (DATA(KDD),KDD=1,KDAT)
  13483    84 FORMAT(40X,'  ...VCOORD,PRLEV,T,RH,Z,U,V=',
  13484      1       2F7.1,2F6.1,F7.1,2F6.1)
  13485    85 CONTINUE
  13486       IF(IGOOD .GE. 1 .OR. IPERT .EQ. 0)  GO TO 87
  13487       NOGOOD=.TRUE.
  13488       IF(PRDATA)  WRITE(6,86) LDXZZ1,XD(LDXZZ1),YD(LDXZZ1),
  13489      1            (DATA(KDD),KDD=1,KDAT)
  13490    86 FORMAT('  -- NO PERT. DATA AT PT.#',I4,11X,' X=',F6.1,'  Y=',
  13491      1       F6.1,/,29X,'   DATA=',5F10.3)
  13492       GO TO 100
  13493 C
  13494 C     OPTIONAL CONVERSION OF RELATIVE HUMIDITY TO MIXING RATIO FOR SPLIN
  13495 C     ******  NOTE: RELATIVE HUMIDITY (DATA(2)) IS IN PERCENT  *****
  13496 C             TEMPERATURE IS DATA(1)
  13497 C             THEREFORE MULTIPLY BY 10. TO CONVERT TO G/KG
  13498 C     CHECK THAT RELATIVE HUMIDITY IS ACCEPTED OR EXISTS
  13499 C
  13500    87 IF(.NOT. KPLV(KP,2) .OR. RHANL .OR. DATA(2) .EQ.-99.0)  GO TO 89
  13501 C
  13502 C     CHECK THAT TEMPERATURE DATA EXIST

Page 368         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13503 C
  13504       IF(DATA(1) .NE. -99.0)  GO TO 88
  13505       LDXZZ1=LDX-1
  13506       WRITE(6,871)  LDXZZ1,XD(LDXZZ1),YD(LDXZZ1)
  13507   871 FORMAT('  ** NO TEMP FOR Q CALC PT#',I3,10X,'  X=',F6.1,'  Y=',
  13508      1       F6.1)
  13509       NOGOOD=.TRUE.
  13510       GO TO 100
  13511 C
  13512 C        ******  NOTE:  SATURATION CALCULATION IS WITH RESPECT TO ICE IF
  13513 C                       PRESSURE LEVEL IS 300 MB OR LESS  (CORRESPONDING
  13514 C                       TO A TEMPERATURE OF ABOUT -30 DEG C). THIS BRANC
  13515 C                       IS WITH RESPECT TO PRESSURE RATHER THAN TEMPERAT
  13516 C                       TO PREVENT HORIZONTAL DISCONTINUITIES DURING THE
  13517 C                       SPLINE ANALYSIS.  ADDITIONAL SCALING FACTOR OF
  13518 C                       100 IS USED FOR MIXING RATIO AT UPPER LEVELS
  13519 C     IF AVAILABLE, USE SURFACE PRESSURE FROM SOUNDING FOR MIXING RATIO
  13520 C     CALCULATION.  IF NOT, USE PSRF=1013.0 MB.
  13521 C
  13522    88 IF(KP .NE. KLDIM)THEN
  13523         PRX=PR
  13524       ELSEIF(DATA(3) .EQ. -99.0)THEN
  13525         PRX=PSRF
  13526       ELSE
  13527       PRX=DATA(3)
  13528       ENDIF
  13529 C
  13530 C     CALCULATE MIXING RATIO
  13531 C
  13532       IF(NINT(PR*10.) .GT. 3000)  THEN
  13533          QS=QSATW(DATA(1)+273.16,PRX)
  13534       ELSE
  13535          QS=QSATI(DATA(1)+273.16,PRX)
  13536       END IF
  13537       DATA(2)=DATA(2)*QS*10.
  13538    89 DO 90 K=1,KDAT
  13539 C
  13540 C     CHECK IF DATA ARE MISSING
  13541 C
  13542       IF(DATA(K) .EQ. -99.0)  GO TO 90
  13543 C
  13544 C     CHECK IF DATA WERE PREVIOUSLY ACCEPTED
  13545 C
  13546       IF(FD((K-1)*KLDIM+KP,LP) .NE. -99.0 .AND. WX .GT. WD(LP))
  13547      1    GO TO 90
  13548 C
  13549 C     PRINTOUT POINTS WITH DUPLICATE DATA (ALL WITHIN THE PRESSURE
  13550 C       WINDOW)
  13551 C
  13552       IF(FD((K-1)*KLDIM+KP,LP) .NE. -99.0 .AND. KP .EQ. KPMN
  13553      1   .AND. K .EQ. 1 .AND. LNEW .EQ. 0)  THEN
  13554       WRITE(6,891) IFIX(WD(LP)),XD(LP),YD(LP),KP,PLEV(KP),
  13555      1             (FD((KK-1)*KLDIM+KP,LP),DATA(KK),KK=1,KDAT)
  13556   891 FORMAT(5X,'... FOR ID=',I3,', XD, YD=',2F8.3,
  13557      1       ', AND KP, PLEV(KP)=',I3,F7.0,
  13558      1       ', DUPLICATE DATA FOUND. OLD, NEW=',/,40X,10F7.1)
  13559       ENDIF

Page 369         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13560 C
  13561 C     PUT DATA INTO FD
  13562 C
  13563       FD((K-1)*KLDIM+KP,LP)=DATA(K)
  13564    90 CONTINUE
  13565   100 CONTINUE
  13566 C
  13567       IF(NOGOOD)  LDX=LDX-LNEW
  13568 C
  13569 C     READ NEXT DATA CARD
  13570 C
  13571       go to 9999
  13572   130 LDX=LDX-1
  13573 C
  13574 C     CHECK IF ANY DATA HAVE BEEN ACCEPTED
  13575 C
  13576       IF(LDX .EQ. 0)  GO TO 920
  13577 C
  13578 C     CLOSE RAW DATA FILE
  13579 C
  13580       CLOSE(UNIT=MSKDA1,STATUS='KEEP')
  13581       WRITE(6,131)  LDX,ITYPMN,ITYPMX,(ITYPEX(NEXX),NEXX=1,NEX)
  13582   131 FORMAT(/'....XDTSRT HAS READ DATA....',I5,' POINTS...',/,
  13583      1       ' ....MINIMUM  DATA TYPE IS',I4,/,
  13584      2       ' ....MAXIMUM  DATA TYPE IS',I4,/,
  13585      3      (' ....EXCLUDED DATA TYPE IS',I4))
  13586 C
  13587       WRITE(6,132)
  13588   132 FORMAT('....TRANSFORM COORDINATES AND WEIGHT DATA.')
  13589 C
  13590 C     TRANSFORM X,Y,TIME COORDINATES:
  13591 C               0000 UTC ON DAY OF FIRST OBSERVATION OR FIX IS T=0.
  13592 C                   TIME IS MEASURED IN FRACTIONAL HOURS FROM T=0.
  13593 C                   A SPECIFIC TIME, T=T0, IS DEFINED AS A CENTRAL
  13594 C                   TIME FOR THE OBSERVATIONS.
  13595 C               FOR FIXED EARTH COORDINATES, X,Y ARE MEASURED RELATIVE
  13596 C                   TO SOUTHWEST CORNER OF DOMAIN.  HURRICANE TRACK AND
  13597 C                   POSITION AT TIME T=T0 ARE PRINTED.
  13598 C               FOR STORM-RELATIVE COORDINATES, ONLY A SINGLE HURRICANE
  13599 C                   POSITION IS PRINTED.  POSITIONS OF ALL OBSERVATIONS
  13600 C                   ARE MEASURED WITH RESPECT TO THIS POSITION.
  13601 C
  13602       IF(NSWLN .GT. 0)  CALL CSGNLN(NFIXP)
  13603       CALL CTRANS(NFIXP)
  13604 C
  13605 C     DATA WEIGHTING.  THERE ARE THREE OPTIONS WHICH MAY BE ASSIGNED
  13606 C       INDIVIDUALLY FOR EACH DATA TYPE.  SEE SUBROUTINE WTDAT
  13607 C       FOR DETAILS.
  13608 C
  13609       CALL RWT
  13610 C
  13611       LDXTYP=0
  13612 C
  13613 CIBM  WE CREATE AN OUTER LOOP TO SELECT A SINGLE DATA TYPE AT A TIME
  13614 CIBM    IN ORDER TO SAVE SPACE
  13615 C
  13616       WRITE(6,141) (NTP,NTP=1,NTPDIM),(JDTYP(NTP),NTP=1,NTPDIM),

Page 370         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13617      1             (JSKEEM(NTP),NTP=1,NTPDIM)
  13618   141 FORMAT(//35X,'=== DATA WEIGHTING SCHEMES ===',/,
  13619      1       13X,'NTP=',30I3,/,7X,'DATA TYPE=',30I3,/,10X,
  13620      2       'SCHEME=',30I3)
  13621 C
  13622       WRITE(6,142)
  13623   142 FORMAT(/39X,'DATA WEIGHT TABLE',/,18X,'TYPE',4X,'SCHEME',
  13624      1       6X,'REL. WT.',5X,'# PTS',6X,'# CELLS',4X,'ABS. WT.')
  13625 C
  13626       DO 160 NTP=1,NTPDIM
  13627 C
  13628         DO 150 LD=1,LDX
  13629         CALL DOMCHK(XD(LD),YD(LD),IN)
  13630         IF(NTP .EQ. 1)  ID(LD)=IFIX(WD(LD))
  13631 c fixit?? - out of bounds error is possible on 'IDTYP', I made this
  13632 c           change to avoid the problem
  13633 cdak    IDZZ=IDTYP(ID(LD))
  13634         if(ID(LD).gt.0)  then
  13635            IDZZ=IDTYP(ID(LD))
  13636         else
  13637            idzz=0
  13638         endif
  13639 
  13640 
  13641         IF(IDZZ .EQ. NTP)  THEN
  13642           IF(IN .EQ. 0)  THEN
  13643 C     OUTSIDE ANALYSIS REGION
  13644             WD(LD)=-99.0
  13645             ID(LD)=-ID(LD)
  13646             ELSE
  13647 C     INSIDE ANALYSIS REGION: SET RELATIVE WEIGHT AND PREPARE
  13648 C       FOR ABSOLUTE WEIGHT CALCULATION
  13649 C
  13650             WD(LD)=WDR(IDZZ)
  13651             LDXTYP(IDZZ)=LDXTYP(IDZZ)+1
  13652 CIBM        INDX(LDXTYP(IDZZ),IDZZ)=LD
  13653             INDX(LDXTYP(IDZZ))=LD
  13654           ENDIF
  13655         ENDIF
  13656   150   CONTINUE
  13657 C
  13658 CIBM  DO 160 NTP=1,NTPDIM
  13659       IF(LDXTYP(NTP) .EQ. 0)  GO TO 160
  13660 CIBM  CALL WTDAT(JSKEEM(NTP),LDXTYP(NTP),JCELLX,WFAC,INDX(1,NTP))
  13661       CALL WTDAT(JSKEEM(NTP),LDXTYP(NTP),JCELLX,WFAC,INDX)
  13662       WRITE(6,159) JDTYP(NTP),JSKEEM(NTP),WDR(NTP),LDXTYP(NTP),JCELLX,
  13663      1             WFAC
  13664   159 FORMAT(17X,I3,7X,I2,9X,F6.3,4X,I7,8X,I4,6X,F6.3)
  13665   160 CONTINUE
  13666 C
  13667 C     PRINT DATA LOCATIONS AND POINT DATA VALUES
  13668 C
  13669       CALL PRDLOC(NFIXP)
  13670 C
  13671 C     SORT DATA POINTS BY INCREASING XD, THEN CHECK FOR MISSING DATA
  13672 C     PUTTING DATA INTO FDD
  13673 C

Page 371         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13674       XDZ(1:LDX)=XD(1:LDX)
  13675 C
  13676       CALL SORTRL(XDZ,LDSORT,LDX)
  13677 C
  13678       LXSORT(1:LDX)=LDSORT(1:LDX)
  13679 C
  13680       WRITE(6,199) FMS
  13681   199 FORMAT('....CHECK FOR MISSING DATA (CUTOFF IS',2PF5.1,'PERCENT).')
  13682 C
  13683       DO 280 KF=1,KDDIM
  13684       NMS=LDX
  13685       DO 240 L=1,LDX
  13686       FDD(L)=-99.0
  13687       IF(FD(KF,L) .EQ. -99.0)  GO TO 240
  13688       NMS=NMS-1
  13689       FDD(L)=FD(KF,L)
  13690   240 CONTINUE
  13691       FRMS=REAL(NMS)/REAL(LDX)
  13692       KV=(KF-1)/KLDIM+1
  13693       KL=MOD(KF,KLDIM)
  13694       IF(KL .EQ. 0)  KL=KLDIM
  13695 C
  13696 c && 3 comments
  13697 CC    WRITE(6,2226) KF,KV,PLEV(KL),FRMS
  13698 C2226 FORMAT('....KF=',I4,'...KV=',I4,'  (',F5.0,' MB) CHECKED...',
  13699 CC   1       2PF5.1,' PERCENT MISSING')
  13700 C     CHECK IF MUCH OF THE DATA ARE MISSING
  13701 C
  13702       IF(FRMS .GT. FMS)  GO TO 270
  13703       NBOGUS=0
  13704 C
  13705 C     CHECK IF INDIVIDUAL DATA TYPES ARE MISSING
  13706 C
  13707       DO 260 L=1,LDX
  13708       IF(FDD(L) .NE. -99.0)  GO TO 260
  13709       LP=L
  13710 C
  13711 C     FIND THE SORT INDEX
  13712 C
  13713       DO 250 LL=1,LDX
  13714       LD=LL
  13715       IF(LXSORT(LL) .EQ. LP)  GO TO 255
  13716   250 CONTINUE
  13717       WRITE(6,2116)
  13718  2116 FORMAT(/'****** CANNOT FIND LDSORT INDEX IN XDTSRT')
  13719       CALL ABRT1(' XDTSRT',2116)
  13720   255 CONTINUE
  13721 C
  13722 c && 3 comments
  13723 CC    WRITE(6,1111) XD(LP),YD(LP),KF,LP,LD
  13724 C1111 FORMAT('..... BOGUS CALLED AT X=',F5.1,', Y=',F5.1,' FIELD #',
  13725 CC   1 I4,', POINT #',I5,', AND SORTED #',I5)
  13726 C     LINEARLY INTERPOLATE MISSING VALUE (BOGUS POINT) AND PUT BACK INTO
  13727 C
  13728       NBOGUS=NBOGUS+1
  13729 C** DEBUG
  13730       IPRT=0

Page 372         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13731       IF(KV .EQ. 4 .OR. KV .EQ. 5)  IPRT=1
  13732       CALL BOGUS(LD,LP,FDD,DV,IPRT)
  13733       FD(KF,LP)=DV
  13734 C
  13735 c && 2 comments
  13736 CC    WRITE(6,2101) FD(KF,LP)
  13737 C2101 FORMAT('.... BOGUS VALUE IS',F10.2)
  13738 C
  13739   260 CONTINUE
  13740       WRITE(6,261)  KL,KV,NBOGUS,LDX,FRMS
  13741   261 FORMAT('....KL=',I3,', KV=',I4,': # BOGUS PTS.=',I4,
  13742      1       ', TOTAL PTS.=',I5,', FRMS=',2PF5.1,'PERCENT')
  13743       GO TO 280
  13744   270 IF(KPLV(KL,KV))  WRITE(6,276) KL,KV,FRMS
  13745   276 FORMAT('****KL=',I3,', KV=',I4,': FRMS=',2PF5.1,
  13746      1       ' PERCENT (EXCEEDS CUTOFF)')
  13747       KPLV(KL,KV)=.FALSE.
  13748       IF(KV .LE. 3)  GO TO 280
  13749       IF(KV .EQ. 4)  KPLV(KL,5)=.FALSE.
  13750       IF(KV .EQ. 5)  KPLV(KL,4)=.FALSE.
  13751       KPLV(KL,6)=.FALSE.
  13752   280 CONTINUE
  13753 C
  13754 C     PRINT UPDATED DATA FIELDS
  13755 C     WRITE COMPLETE DATA FILE TO MSKDA3
  13756 C
  13757 C
  13758 C     OPENING ALLDAT HANDLED BY CRAY JCL
  13759 C
  13760 C     OPEN(UNIT=MSKDA3,ACCESS='SEQUENTIAL',FORM='UNFORMATTED',
  13761 C    1     FILE='ALLDAT',STATUS='UNKNOWN')
  13762 C
  13763       DO 290 L=1,LDX
  13764       DWF(1:KDDIM)=FD(1:KDDIM,L)
  13765       HEAD_8(1)=WD(L)
  13766       HEAD_8(2)=REAL(IDAYOB(L))
  13767       HEAD_8(3)=UTCOB(L)
  13768       HEAD_8(4)=XD(L)
  13769       HEAD_8(5)=YD(L)
  13770       WRITE (MSKDA3) HEAD_8,DWF
  13771   290 CONTINUE
  13772 C
  13773 C     CLOSE(UNIT=MSKDA3,STATUS='KEEP')
  13774       REWIND MSKDA3
  13775 CIBM  WRITE(1,291) LDX
  13776 C 291 FORMAT(/'...INPUT DATA HAVE BEEN READ, LDX=',I8)
  13777       RETURN
  13778  9999 continue
  13779       if(igo.eq.20)  then
  13780          go to 20
  13781       else  if(igo.eq.30)  then
  13782          go to 30
  13783       else
  13784          call ABRT1(' XDTSRT',9999)
  13785       endif
  13786 
  13787 C-----------------------------------------------------------------------

Page 373         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13788 
  13789       ENTRY FNDDAY(STMID,NFIXPZ,TIMWNZ)
  13790 C
  13791 C     THIS ENTRY READS STMID, WSTM, NFIXB, NFIXE AND NFIXP FROM THE
  13792 C       STMDAT FILE AND JDAY0 AND UTC0 FROM THE SAME FILE IF IT IS
  13793 C       MISSING.  NFIXB IS INDEX OF THE FIX BEGINNING THE TIME WINDOW
  13794 C       FOR DATA, NFIXE ENDS THE TIME WINDOW, AND NFIXP IS THE TOTAL
  13795 C       NUMBER OF FIXES READ, AND MAY INCLUDE FORECAST POSITIONS
  13796 C       TO BE PLOTTED.  (THE LATTER OPTION IS CURRENTLY NOT AVAILABLE FO
  13797 C       VAX ANALYSES).
  13798 C     ****** IMPORTANT:  IF JDAY0 AND/OR UTC0 ARE MISSING, ASSUME THAT
  13799 C       THE SECOND FIX RECORD CONTAINS JDAY0 ******
  13800 C
  13801       TIMWIN=TIMWNZ
  13802       XSTM0=-99.0
  13803       YSTM0=-99.0
  13804       ITFND=0
  13805 C
  13806       READ(MSKDA2,306)STMID
  13807   306 FORMAT(A12)
  13808       READ(MSKDA2,*) WSTMX,NFIXB,NFIXE,NFIXP
  13809 C
  13810       IF(NFIXP .EQ. NFIXE)  THEN
  13811       IF(TIMWIN)  WRITE(6,311)
  13812   311 FORMAT('....TIME WINDOW FOR ANALYSIS IS FIRST TO LAST FIX',
  13813      1       ' POSITION READ.')
  13814       ELSE IF(NFIXP .LT. NFIXE)  THEN
  13815       NFIXP=NFIXE
  13816 C
  13817       ELSE
  13818       IF(TIMWIN)  WRITE(6,312)
  13819   312 FORMAT('....TIME WINDOW FOR ANALYSIS DOES NOT EXTEND TO',
  13820      1       ' LAST FIX POSITION READ.')
  13821       ENDIF
  13822 C
  13823       NFIXPZ=NFIXP
  13824       WRITE(6,313)
  13825   313 FORMAT(/'....HURRICANE LOCATIONS',4X,'LAT.',6X,'LONG.   UTC',
  13826      1       6X,'DAY')
  13827 C
  13828 C     READ IN STORM FIXES AND DEFINE DATE OF ANALYSIS AS SECOND FIX
  13829 C     IMPORTANT:  FIX POSITIONS MUST BE ENTERED IN CHRONOLOGICAL ORDER.
  13830 C     FIND THE STORM FIX FOR THE DESIRED TIME
  13831 C     IF DOES NOT EXIST, XSTM0 AND YSTM0 REMAIN -99., ITFND REMAINS 0
  13832 C
  13833 C     CHECK IF THERE ARE TOO MANY STORM FIXES
  13834 C
  13835       IF(NFIXP .GT. NFXDIM)  GO TO 940
  13836 C
  13837       DO 408 N=1,NFIXP
  13838         READ(MSKDA2,*) XSTM(N),YSTM(N),IDAYST(N),UTCSTM(N)
  13839         WRITE(6,405) YSTM(N),XSTM(N),UTCSTM(N),IDAYST(N)
  13840   405 FORMAT(25X,F7.3,3X,F7.3,F7.0,I11)
  13841       IF(N .EQ. 2 .AND. (JDAY0 .EQ. -99 .OR. UTC0 .EQ. -99.0))  THEN
  13842         JDAY0=IDAYST(N)
  13843         UTC0=UTCSTM(N)
  13844         XSTM0=XSTM(N)

Page 374         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13845         YSTM0=YSTM(N)
  13846         NFIX0=N
  13847         WSTM(N)=WSTMX+1
  13848       ENDIF
  13849       WSTM(N)=WSTMX
  13850       IF(IDAYST(N) .NE. JDAY0 .OR. UTCSTM(N) .NE. UTC0)  GO TO 408
  13851       ITFND=1
  13852       XSTM0=XSTM(N)
  13853       YSTM0=YSTM(N)
  13854       NFIX0=N
  13855       WSTM(N)=WSTMX+1
  13856   408 CONTINUE
  13857 C
  13858       CLOSE(UNIT=MSKDA2,STATUS='KEEP')
  13859 C
  13860 C     CHECK IF FIX WAS FOUND
  13861 C
  13862       IF(XSTM0 .EQ. -99.0 .OR. YSTM0 .EQ. -99.0)  GO TO 960
  13863 C
  13864       RETURN
  13865 C
  13866 
  13867 C-----------------------------------------------------------------------
  13868 
  13869       ENTRY HURPOS(IDAYMX,UTCMX,UTCMN,DUTCMN,DUTCMX)
  13870 C       OUTPUT ARG. IDAYMX - SLORD DATE FORMAT FOR DATE (YYYYMMDD) (MAX)
  13871 C
  13872 C     ADD WINDOWS TO THE TIMES OF THE FIRST AND LAST FIX AND MAKE SURE D
  13873 C     AND TIME ARE IN THE CORRECT FORM
  13874 C
  13875       iymn=idayst(nfixb)/10000
  13876       immn=mod((idayst(nfixb)/100),100)
  13877       idmn=mod(idayst(nfixb),100)
  13878       ihmn=nint(utcstm(nfixb))/100
  13879       iminmn=mod(nint(utcstm(nfixb)),100)
  13880       rinc = 0.
  13881       rinc(3) = dutcmn
  13882       ldat = 0
  13883       ldat(1) = iymn
  13884       ldat(2) = immn
  13885       ldat(3) = idmn
  13886       ldat(5) = ihmn
  13887       ldat(6) = iminmn
  13888       call w3movdat(rinc,ldat,jdat)
  13889       idaymn=(jdat(1)*10000) + (jdat(2)*100) + jdat(3)
  13890       utcmn=(jdat(5)*100) + jdat(6)
  13891       iymx=idayst(nfixe)/10000
  13892       immx=mod((idayst(nfixe)/100),100)
  13893       idmx=mod(idayst(nfixe),100)
  13894       ihmx=nint(utcstm(nfixe))/100
  13895       iminmx=mod(nint(utcstm(nfixe)),100)
  13896       rinc = 0.
  13897       rinc(3) = -dutcmx
  13898       ldat = 0
  13899       ldat(1) = iymx
  13900       ldat(2) = immx
  13901       ldat(3) = idmx

Page 375         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13902       ldat(5) = ihmx
  13903       ldat(6) = iminmx
  13904       call w3movdat(rinc,ldat,jdat)
  13905       idaymx=(jdat(1)*10000) + (jdat(2)*100) + jdat(3)
  13906       utcmx=(jdat(5)*100) + jdat(6)
  13907 C
  13908 C     CHECK IF STORM-RELATIVE COORDINATES ARE TO BE USED BUT NO FIX IS F
  13909 C
  13910   415 IF(ITFND .EQ. 0 .AND. ISRCD .EQ. 1)  GO TO 950
  13911       IF(TIMWIN)  THEN
  13912       WRITE(6,1412) IFIX(UTCMN),IDAYMN,IFIX(UTCMX),IDAYMX
  13913  1412 FORMAT(/'....DATA ACCEPTED BETWEEN',I5,' UTC,',I9,' AND',I5,
  13914      1       ' UTC,',I9)
  13915       ELSE
  13916       WRITE(6,1413)
  13917  1413 FORMAT(/'....THERE IS NO TIME WINDOW FOR DATA.',/,
  13918      1       '     WARNING:  ERRORS MAY OCCUR IF STORM-RELATIVE',
  13919      2       ' COORDINATES ARE USED.')
  13920       ENDIF
  13921 C
  13922 C     GET YEAR, MONTH, DAY, AND HOUR FOR FIRST AND LAST FIX AND CURRENT
  13923 C
  13924       CALL XTIME(IDAYMN,UTCMN,IYMN,IMMN,IDMN,HRMN)
  13925       IHMN=NINT(HRMN)
  13926       CALL XTIME(IDAYMX,UTCMX,IYMX,IMMX,IDMX,HRMX)
  13927 
  13928       IHMX=NINT(HRMX)
  13929       CALL XTIME(JDAY0,UTC0,IY0,IM0,ID0,HR0)
  13930       RETURN
  13931 C
  13932 C     ERRORS AND WARNINGS
  13933 C
  13934   910 WRITE(6,911)  LDX
  13935   911 FORMAT(/10X,'....READ ERROR IN XDTSRT...LDX=',I5)
  13936       CALL ABRT1(' XDTSRT',911)
  13937   920 WRITE(6,921) ICOUNT,VCOORD,PLEV(JPD),ITYPMN,ITYPMX,IFIX(WX),
  13938      1             IDAYX,UTCX,JDAY0,UTC0
  13939   921 FORMAT(/'****** LDX=0, THERE ARE NO ACCEPTED DATA POINTS^',/,
  13940      1       ' ...ICOUNT,VCOORD,PLEV(JPD),ITYPMN,ITYPMX,IFIX(WX),',
  13941      2       'IDAYX,UTCX,JDAY0,UTC0=',/,4X,I8,2F8.2,3I5,2(I11,F9.1))
  13942       CALL ABRT1(' XDTSRT',921)
  13943   930 WRITE(6,931)  LDX,LDXX,LP
  13944   931 FORMAT(/'****** LDX EXCEEDS LDXDIM IN XDTSRT',3I10)
  13945       CALL ABRT1(' XDTSRT',931)
  13946   940 WRITE(6,941) NFIXP,NFXDIM
  13947   941 FORMAT(/'****** # OF FIX POSITIONS,',I4,' EXCEEDS NFXDIM=',I4)
  13948       CALL ABRT1(' XDTSRT',941)
  13949   950 WRITE(6,951) (IDAYST(N),UTCSTM(N),N=1,NFIXE)
  13950   951 FORMAT(/'****** ZERO TIME NOT FOUND FOR STORM-RELATIVE COORDINATES
  13951      1       ',/,(5X,I13,F13.2/))
  13952       CALL ABRT1(' XDTSRT',951)
  13953 C
  13954   960 WRITE(6,961) JDAY0,UTC0,(IDAYST(N),UTCSTM(N),N=1,NFIXP)
  13955   961 FORMAT(/'****** FIX TIMES DO NOT MATCH T=0 ANALYSIS TIME',/,
  13956      1       (I10,F6.1))
  13957       CALL ABRT1(' XDTSRT',961)
  13958 C

Page 376         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13959   990 WRITE(6,991) L,XX,YX,VCOORD,DATA
  13960   991 FORMAT(/'****** PRESSURE NOT FOUND IN XDTSRT',I5,2F10.2,/,
  13961      1       7F14.1)
  13962       CALL ABRT1(' XDTSRT',991)
  13963   995 WRITE(6,996) NEX,NEXDIM
  13964   996 FORMAT(/'****** NEX=',I4,' AND EXCEEDS NEXDIM=',I5)
  13965       CALL ABRT1(' XDTSRT',996)
  13966       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 fndday_               hurpos_               xdtsrt_               xdtsub_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  13565                                                          13453,13492,13510                 
 130                        Label  13572                                                          13279,13293                       
 131                        Label  13582                                                          13581                             
 132                        Label  13588                                                          13587                             
 141                        Label  13618                                                          13616                             
 1412                       Label  13913                                                          13912                             
 1413                       Label  13917                                                          13916                             
 142                        Label  13623                                                          13622                             
 150                        Label  13656                                                          13628                             
 159                        Label  13664                                                          13662                             
 160                        Label  13665                                                          13626,13659                       
 199                        Label  13681                                                          13680                             
 20                         Label  13264                                                          13780                             
 2116                       Label  13718                                                          13717                             
 240                        Label  13690                                                          13685,13687                       
 25                         Label  13279                                                          13264                             
 250                        Label  13716                                                          13713                             
 255                        Label  13720                                                          13715                             
 260                        Label  13739                                                          13707,13708                       
 261                        Label  13741                                                          13740                             
 270                        Label  13744                                                          13702                             
 276                        Label  13745                                                          13744                             
 280                        Label  13752                                                          13683,13743,13748                 
 290                        Label  13771                                                          13763                             
 30                         Label  13293                                                          13782                             
 306                        Label  13807                                                          13806                             
 311                        Label  13812                                                          13811                             
 312                        Label  13819                                                          13818                             
 313                        Label  13825                                                          13824                             
 40                         Label  13305                                                          13278                             
 405                        Label  13840                                                          13839                             
 408                        Label  13856                                                          13837,13850                       
 415                        Label  13910                                                                                            
 46                         Label  13391                                                          13389                             
 47                         Label  13399                                                          13385,13390                       
 50                         Label  13407                                                          13403                             

Page 377         Source Listing                  XDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 51                         Label  13424                                                          13422                             
 60                         Label  13434                                                          13406                             
 70                         Label  13441                                                          13437,13438                       
 84                         Label  13483                                                          13481                             
 85                         Label  13485                                                          13461,13465,13478                 
 86                         Label  13490                                                          13488                             
 87                         Label  13500                                                          13486                             
 871                        Label  13507                                                          13506                             
 88                         Label  13522                                                          13504                             
 89                         Label  13538                                                          13500                             
 891                        Label  13556                                                          13554                             
 90                         Label  13564                                                          13538,13542,13547                 
 910                        Label  13934                                                          13264                             
 911                        Label  13935                                                          13934                             
 920                        Label  13937                                                          13576                             
 921                        Label  13939                                                          13937                             
 930                        Label  13943                                                          13413                             
 931                        Label  13944                                                          13943                             
 940                        Label  13946                                                          13835                             
 941                        Label  13947                                                          13946                             
 950                        Label  13949                                                          13910                             
 951                        Label  13950                                                          13949                             
 960                        Label  13954                                                          13862                             
 961                        Label  13955                                                          13954                             
 990                        Label  13959                                                          13445                             
 991                        Label  13960                                                          13959                             
 995                        Label  13963                                                          13229                             
 996                        Label  13964                                                          13963                             
 9999                       Label  13778                                                          13318,13321,13328,13333,13339,1334
                                                                                                  0,13342,13344,13345,13346,13348,13
                                                                                                  350,13370,13376,13395,13571       
 A                          Scalar 13158    R(4)            4     3     49000    COM                                                
 ABRT1                      Subr   13719                                                          13719,13784,13936,13942,13945,1394
                                                                                                  8,13952,13957,13962,13965         
 ABS                        Func   13317                                scalar                    13317,13376,13390,13438           
 AFD                        Common 13158                                2260000  SAVE                                               
 BOGUS                      Subr   13732                                                          13732                             
 CSGNLN                     Subr   13602                                                          13602                             
 CTRANS                     Subr   13603                                                          13603                             
 DATA                       Scalar 13181    R(4)            4     1     5        COM              13265,13293,13365,13476,13482,1348
                                                                                                  9,13500,13504,13524,13527,13533,13
                                                                                                  535,13537,13542,13555,13563,13959 
 DATAZ                      Local  13364    R(4)            4           scalar   SAVE             13364,13365                       
 DATREC                     Scalar 13170    R(4)            4     1     6        COM              13363,13364                       
 DOMCHK                     Subr   13629                                                          13629                             
 DPR                        Dummy  13137    R(4)            4           scalar   ARG,INOUT        13376,13390,13438                 
 DSK                        Common 13164                                76       SAVE                                               
 DUTCMN                     Dummy  13138    R(4)            4           scalar   ARG,INOUT        13881                             
 DUTCMX                     Dummy  13139    R(4)            4           scalar   ARG,INOUT        13897                             
 DV                         Local  13732    R(4)            4           scalar   SAVE             13732,13733                       
 DWATE                      Common 13173                                760      SAVE                                               
 DWF                        Dummy  13136    R(4)            4     1     0        ARG,INOUT        13764,13770                       
 ELORG                      Scalar 13168    R(4)            4           scalar   COM                                                
 FD                         Scalar 13158    R(4)            4     2     320000   COM              13216,13546,13552,13555,13563,1368
                                                                                                  7,13689,13733,13764               

Page 378         Source Listing                  XDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 FDD                        Local  13183    R(4)            4     1     8000     SAVE             13686,13689,13708,13732           
 FKMN                       Scalar 13159    R(4)            4     3     196000   COM                                                
 FLAG                       Local  13175    CHAR            1     1     5        SAVE             13195,13265,13283,13423,13460,1347
                                                                                                  6                                 
 FMS                        Local  13195    R(4)            4           scalar   SAVE             13195,13680,13702                 
 FNDDAY                     Subr   13789                                                                                            
 FRMS                       Local  13691    R(4)            4           scalar   SAVE             13691,13702,13740,13744           
 GLORG                      Scalar 13168    R(4)            4           scalar   COM                                                
 HEAD_8                     Local  13179    R(8)            8     1     5        SAVE             13765,13766,13767,13768,13769,1377
                                                                                                  0                                 
 HR0                        Scalar 13172    R(4)            4           scalar   COM              13929                             
 HRMN                       Local  13343    R(4)            4           scalar   SAVE             13343,13924,13925                 
 HRMX                       Local  13349    R(4)            4           scalar   SAVE             13349,13926,13928                 
 HRX                        Local  13306    R(4)            4           scalar   SAVE             13306,13343,13349                 
 HURPOS                     Subr   13869                                                                                            
 ICOOR                      Scalar 13170    I(4)            4           scalar   COM              13363                             
 ICOUNT                     Local  13213    I(4)            4           scalar   SAVE             13213,13266,13937                 
 ID                         Scalar 13163    I(4)            4     1     8000     COM              13630,13634,13635,13645           
 ID0                        Scalar 13172    I(4)            4           scalar   COM              13929                             
 IDAT                       Scalar 13170    I(4)            4           scalar   COM              13364                             
 IDATZ                      Scalar 13170    I(4)            4           scalar   COM              13365                             
 IDAYMN                     Scalar 13169    I(4)            4           scalar   COM              13889,13912,13924                 
 IDAYMX                     Dummy  13138    I(4)            4           scalar   ARG,INOUT        13905,13912,13926                 
 IDAYOB                     Scalar 13167    I(4)            4     1     8000     COM              13406,13427,13766                 
 IDAYST                     Scalar 13168    I(4)            4     1     20       COM              13838,13839,13842,13850,13875,1387
                                                                                                  6,13877,13891,13892,13893,13949,13
                                                                                                  954                               
 IDAYX                      Local  13264    I(4)            4           scalar   SAVE             13264,13293,13306,13406,13422,1342
                                                                                                  7,13938                           
 IDMN                       Scalar 13171    I(4)            4           scalar   COM              13341,13343,13877,13885,13924     
 IDMX                       Scalar 13171    I(4)            4           scalar   COM              13347,13349,13893,13901,13926     
 IDSPC                      Scalar 13161    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 13162    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 13162    CHAR            72          scalar   COM                                                
 IDTYP                      Scalar 13173    I(4)            4     1     100      COM              13635                             
 IDX                        Local  13306    I(4)            4           scalar   SAVE             13306,13341,13343,13347,13349     
 IDZZ                       Local  13635    I(4)            4           scalar   SAVE             13635,13637,13641,13650,13651,1365
                                                                                                  3                                 
 IFIX                       Func   13327                                scalar                    13327,13333,13475,13554,13630,1391
                                                                                                  2,13937                           
 IGO                        Local  13263    I(4)            4           scalar   SAVE             13263,13285,13779,13781           
 IGOOD                      Local  13454    I(4)            4           scalar   SAVE             13454,13480,13481,13486           
 IHMN                       Scalar 13171    I(4)            4           scalar   COM              13878,13886,13925                 
 IHMX                       Scalar 13171    I(4)            4           scalar   COM              13894,13902,13928                 
 IM0                        Scalar 13171    I(4)            4           scalar   COM              13929                             
 IMINMN                     Local  13879    I(4)            4           scalar   SAVE             13879,13887                       
 IMINMX                     Local  13895    I(4)            4           scalar   SAVE             13895,13903                       
 IMMN                       Scalar 13171    I(4)            4           scalar   COM              13340,13341,13343,13876,13884,1392
                                                                                                  4                                 
 IMMX                       Scalar 13171    I(4)            4           scalar   COM              13346,13347,13349,13892,13900,1392
                                                                                                  6                                 
 IMX                        Local  13306    I(4)            4           scalar   SAVE             13306,13340,13341,13343,13346,1334
                                                                                                  7,13349                           
 IN                         Local  13629    I(4)            4           scalar   SAVE             13629,13642                       
 IND                        Common 13154                                32000    SAVE                                               

Page 379         Source Listing                  XDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INDX                       Scalar 13154    I(4)            4     1     8000     COM              13653,13661                       
 IPERT                      Local  13455    I(4)            4           scalar   SAVE             13455,13466,13486                 
 IPRT                       Local  13730    I(4)            4           scalar   SAVE             13730,13731,13732                 
 ISRCD                      Scalar 13160    I(4)            4           scalar   COM              13910                             
 ITFND                      Local  13804    I(4)            4           scalar   SAVE             13804,13851,13910                 
 ITYPEX                     Dummy  13136    I(4)            4     1     5        ARG,INOUT        13333,13581                       
 ITYPMN                     Dummy  13136    I(4)            4           scalar   ARG,INOUT        13327,13581,13937                 
 ITYPMX                     Dummy  13136    I(4)            4           scalar   ARG,INOUT        13327,13581,13937                 
 IY0                        Scalar 13171    I(4)            4           scalar   COM              13929                             
 IYMN                       Scalar 13171    I(4)            4           scalar   COM              13339,13340,13341,13344,13875,1388
                                                                                                  3,13924                           
 IYMX                       Scalar 13171    I(4)            4           scalar   COM              13345,13346,13347,13350,13891,1389
                                                                                                  9,13926                           
 IYX                        Local  13306    I(4)            4           scalar   SAVE             13306,13339,13340,13341,13344,1334
                                                                                                  5,13346,13347,13350               
 JCELLX                     Local  13661    I(4)            4           scalar   SAVE             13661,13662                       
 JDAT                       Local  13178    I(4)            4     1     8        SAVE             13888,13889,13890,13904,13905,1390
                                                                                                  6                                 
 JDAY0                      Scalar 13169    I(4)            4           scalar   COM              13841,13842,13850,13929,13938,1395
                                                                                                  4                                 
 JDTYP                      Scalar 13173    I(4)            4     1     30       COM              13616,13662                       
 JPD                        Scalar 13160    I(4)            4           scalar   COM              13369,13370,13376,13937           
 JSKEEM                     Scalar 13173    I(4)            4     1     30       COM              13617,13661,13662                 
 K                          Local  13265    I(4)            4           scalar   SAVE             13265,13538,13542,13546,13552,1355
                                                                                                  3,13563                           
 KBCTYP                     Scalar 13160    I(4)            4     1     4        COM                                                
 KD                         Local  13388    I(4)            4           scalar   SAVE             13388,13389                       
 KDAT                       Dummy  13136    I(4)            4           scalar   ARG,INOUT        13181,13214,13265,13283,13388,1342
                                                                                                  3,13460,13461,13482,13489,13538,13
                                                                                                  555                               
 KDCTYP                     Scalar 13160    I(4)            4           scalar   COM                                                
 KDD                        Local  13482    I(4)            4           scalar   SAVE             13482,13489                       
 KDDIM                      Local  13214    I(4)            4           scalar   SAVE             13214,13683,13764                 
 KDTDIM                     Param  13146    I(4)            4           scalar                    13148,13170,13181,13195           
 KDXDIM                     Param  13148    I(4)            4           scalar                    13158                             
 KF                         Local  13683    I(4)            4           scalar   SAVE             13683,13687,13689,13692,13693,1373
                                                                                                  3                                 
 KFL                        Local  13265    I(4)            4           scalar   SAVE             13265,13423                       
 KK                         Local  13555    I(4)            4           scalar   SAVE             13555                             
 KL                         Local  13693    I(4)            4           scalar   SAVE             13693,13694,13740,13744,13747,1374
                                                                                                  9,13750,13751                     
 KLDIM                      Param  13145    I(4)            4           scalar                    13148,13149,13170,13176,13181,1321
                                                                                                  4,13387,13434,13437,13445,13522,13
                                                                                                  546,13552,13555,13563,13692,13693,
                                                                                                  13694                             
 KP                         Local  13453    I(4)            4           scalar   SAVE             13453,13465,13481,13500,13522,1354
                                                                                                  6,13552,13554,13555,13563         
 KPL                        Local  13387    I(4)            4           scalar   SAVE             13387,13389,13390,13437,13438,1343
                                                                                                  9,13440                           
 KPLV                       Dummy  13136    L(4)            4     2     160      ARG,INOUT        13389,13465,13500,13744,13747,1374
                                                                                                  9,13750,13751                     
 KPMN                       Local  13434    I(4)            4           scalar   SAVE             13434,13439,13445,13453,13552     
 KPMX                       Local  13435    I(4)            4           scalar   SAVE             13435,13440,13445,13453           
 KPXDIM                     Param  13149    I(4)            4           scalar                    13159                             
 KV                         Local  13461    I(4)            4           scalar   SAVE             13461,13465,13476,13692,13731,1374

Page 380         Source Listing                  XDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  0,13744,13747,13748,13749,13750   
 KVDIM                      Param  13146    I(4)            4           scalar                    13149,13176                       
 L                          Local  13403    I(4)            4           scalar   SAVE             13403,13404,13405,13406,13685,1368
                                                                                                  6,13687,13689,13707,13708,13709,13
                                                                                                  763,13764,13765,13766,13767,13768,
                                                                                                  13769,13959                       
 LD                         Local  13628    I(4)            4           scalar   SAVE             13628,13629,13630,13634,13635,1364
                                                                                                  4,13645,13650,13653,13714,13732   
 LDAT                       Local  13178    I(4)            4     1     8        SAVE             13882,13883,13884,13885,13886,1388
                                                                                                  7,13888,13898,13899,13900,13901,13
                                                                                                  902,13903,13904                   
 LDSORT                     Local  13182    I(4)            4     1     8000     SAVE             13676,13678                       
 LDX                        Scalar 13162    I(4)            4           scalar   COM              13221,13305,13413,13419,13420,1342
                                                                                                  1,13422,13427,13428,13429,13505,13
                                                                                                  567,13572,13576,13581,13628,13674,
                                                                                                  13676,13678,13684,13685,13691,1370
                                                                                                  7,13713,13740,13763,13934,13943   
 LDXDIM                     Param  13143    I(4)            4           scalar                    13154,13158,13162,13163,13167,1318
                                                                                                  2,13183,13413                     
 LDXTYP                     Local  13183    I(4)            4     1     30       SAVE             13611,13651,13653,13659,13661,1366
                                                                                                  2                                 
 LDXX                       Local  13305    I(4)            4           scalar   SAVE             13305,13400,13403,13408,13943     
 LDXZZ1                     Local  13488    I(4)            4           scalar   SAVE             13488,13505,13506                 
 LL                         Local  13713    I(4)            4           scalar   SAVE             13713,13714,13715                 
 LNEW                       Local  13399    I(4)            4           scalar   SAVE             13399,13418,13553,13567           
 LP                         Local  13400    I(4)            4           scalar   SAVE             13400,13404,13408,13546,13552,1355
                                                                                                  4,13555,13563,13709,13715,13732,13
                                                                                                  733,13943                         
 LXSORT                     Scalar 13163    I(4)            4     1     8000     COM              13678,13715                       
 MAX                        Func   13440                                scalar                    13440                             
 MDIM                       Param  13142    I(4)            4           scalar                    13158,13159                       
 MIN                        Func   13439                                scalar                    13439                             
 MOD                        Func   13693                                scalar                    13693,13876,13877,13879,13892,1389
                                                                                                  3,13895                           
 MSKD11                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 13166    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 13166    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 13166    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 13166    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 13164    I(4)            4           scalar   COM              13264,13580                       
 MSKDA2                     Scalar 13164    I(4)            4           scalar   COM              13806,13808,13838,13858           
 MSKDA3                     Scalar 13164    I(4)            4           scalar   COM              13770,13774                       
 MSKDA4                     Scalar 13164    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 13164    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 13164    I(4)            4           scalar   COM              13289,13293                       
 MSKDA7                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 13165    I(4)            4           scalar   COM                                                
 MSKEF                      Scalar 13164    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 13164    I(4)            4           scalar   COM                                                
 MX                         Scalar 13160    I(4)            4           scalar   COM                                                
 N                          Local  13837    I(4)            4           scalar   SAVE             13837,13838,13839,13841,13842,1384

Page 381         Source Listing                  XDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,13844,13845,13846,13847,13849,13
                                                                                                  850,13852,13853,13854,13855,13949,
                                                                                                  13954                             
 NBOGUS                     Local  13703    I(4)            4           scalar   SAVE             13703,13728,13740                 
 NDIM                       Param  13142    I(4)            4           scalar                    13158,13159                       
 NEST                       Dummy  13136    L(4)            4           scalar   ARG,INOUT        13279,13315                       
 NEX                        Dummy  13136    I(4)            4           scalar   ARG,INOUT        13229,13332,13581,13963           
 NEXDIM                     Param  13146    I(4)            4           scalar                    13182,13229,13963                 
 NEXX                       Local  13332    I(4)            4           scalar   SAVE             13332,13333,13581                 
 NFIX0                      Scalar 13169    I(4)            4           scalar   COM              13846,13854                       
 NFIXB                      Local  13808    I(4)            4           scalar   SAVE             13808,13875,13876,13877,13878,1387
                                                                                                  9                                 
 NFIXE                      Local  13808    I(4)            4           scalar   SAVE             13808,13810,13814,13815,13891,1389
                                                                                                  2,13893,13894,13895,13949         
 NFIXP                      Local  13602    I(4)            4           scalar   SAVE             13602,13603,13669,13808,13810,1381
                                                                                                  4,13815,13823,13835,13837,13946,13
                                                                                                  954                               
 NFIXPZ                     Dummy  13138    I(4)            4           scalar   ARG,INOUT        13823                             
 NFXDIM                     Param  13144    I(4)            4           scalar                    13167,13168,13835,13946           
 NINT                       Func   13532                                scalar                    13532,13878,13879,13894,13895,1392
                                                                                                  5,13928                           
 NMS                        Local  13684    I(4)            4           scalar   SAVE             13684,13688,13691                 
 NOFLAG                     Dummy  13137    L(4)            4           scalar   ARG,INOUT        13477                             
 NOGOOD                     Local  13177    L(4)            4           scalar   SAVE             13451,13487,13509,13567           
 NSWLN                      Dummy  13137    I(4)            4           scalar   ARG,INOUT        13316,13602                       
 NTP                        Local  13616    I(4)            4           scalar   SAVE             13616,13617,13626,13630,13641,1365
                                                                                                  9,13661,13662                     
 NTPDIM                     Param  13144    I(4)            4           scalar                    13173,13183,13616,13617,13626     
 NX                         Scalar 13160    I(4)            4           scalar   COM                                                
 PALL                       Dummy  13137    L(4)            4           scalar   ARG,INOUT        13228,13375                       
 PDOMAN                     Dummy  13137    L(4)            4           scalar   ARG,INOUT        13369,13375                       
 PLEV                       Scalar 13170    R(4)            4     1     8        COM              13376,13390,13438,13481,13554,1393
                                                                                                  7                                 
 PMN                        Local  13182    R(4)            4     1     7        SAVE             13187,13369                       
 PMX                        Local  13182    R(4)            4     1     7        SAVE             13188,13370                       
 PR                         Scalar 13185    R(4)            4           scalar   COM              13264,13293,13523,13532           
 PRDATA                     Dummy  13137    L(4)            4           scalar   ARG,INOUT        13422,13481,13488                 
 PRDLOC                     Subr   13669                                                          13669                             
 PRES                       Common 13170                                72       SAVE                                               
 PRX                        Local  13523    R(4)            4           scalar   SAVE             13523,13525,13527,13533,13535     
 PSRF                       Local  13195    R(4)            4           scalar   SAVE             13195,13525                       
 QS                         Local  13533    R(4)            4           scalar   SAVE             13533,13535,13537                 
 QSATI                      Func   13535    R(4)            4           scalar                    13535                             
 QSATW                      Func   13533    R(4)            4           scalar                    13533                             
 REAL                       Func   13691                                scalar                    13691,13766                       
 RHANL                      Scalar 13170    L(4)            4           scalar   COM              13500                             
 RINC                       Local  13178    R(4)            4     1     5        SAVE             13880,13881,13888,13896,13897,1390
                                                                                                  4                                 
 RWT                        Subr   13609                                                          13609                             
 S2DTPT                     Common 13162                                160084   SAVE                                               
 S2PRIC                     Common 13160                                217      SAVE                                               
 SELECT                     Dummy  13137    L(4)            4           scalar   ARG,INOUT        13228,13385                       
 SORTRL                     Subr   13676                                                          13676                             
 STMID                      Dummy  13139    CHAR            12          scalar   ARG,INOUT        13806                             
 TIMWIN                     Local  13177    L(4)            4           scalar   SAVE             13338,13801,13811,13818,13911     

Page 382         Source Listing                  XDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TIMWNZ                     Dummy  13138    L(4)            4           scalar   ARG,INOUT        13801                             
 TMMNMX                     Common 13171                                48       SAVE                                               
 UNIQUE                     Dummy  13138    L(4)            4           scalar   ARG,INOUT        13402                             
 UTC0                       Scalar 13169    R(4)            4           scalar   COM              13841,13843,13850,13929,13938,1395
                                                                                                  4                                 
 UTCMN                      Dummy  13138    R(4)            4           scalar   ARG,INOUT        13890,13912,13924                 
 UTCMX                      Dummy  13138    R(4)            4           scalar   ARG,INOUT        13906,13912,13926                 
 UTCOB                      Scalar 13167    R(4)            4     1     8000     COM              13406,13428,13767                 
 UTCSTM                     Scalar 13168    R(4)            4     1     20       COM              13838,13839,13843,13850,13878,1387
                                                                                                  9,13894,13895,13949,13954         
 UTCX                       Local  13264    R(4)            4           scalar   SAVE             13264,13293,13306,13406,13422,1342
                                                                                                  8,13938                           
 VCOORD                     Local  13363    R(4)            4           scalar   SAVE             13363,13369,13370,13376,13390,1343
                                                                                                  8,13481,13937,13959               
 W3MOVDAT                   Subr   13888                                                          13888,13904                       
 WD                         Scalar 13162    R(4)            4     1     8000     COM              13217,13405,13421,13422,13546,1355
                                                                                                  4,13630,13644,13650,13765         
 WDR                        Scalar 13173    R(4)            4     1     30       COM              13650,13662                       
 WFAC                       Local  13661    R(4)            4           scalar   SAVE             13661,13663                       
 WSTM                       Scalar 13168    R(4)            4     1     20       COM              13847,13849,13855                 
 WSTMX                      Local  13808    R(4)            4           scalar   SAVE             13808,13847,13849,13855           
 WTDAT                      Subr   13661                                                          13661                             
 WX                         Local  13264    R(4)            4           scalar   SAVE             13264,13293,13327,13333,13405,1342
                                                                                                  1,13475,13477,13546,13937         
 XD                         Scalar 13162    R(4)            4     1     8000     COM              13218,13405,13419,13422,13488,1350
                                                                                                  6,13554,13629,13674,13768         
 XDTSRT                     Subr   13200                                                                                            
 XDTSUB                     Subr   13136                                                                                            
 XDZ                        Local  13183    R(4)            4     1     8000     SAVE             13674,13676                       
 XM1                        Scalar 13161    R(4)            4           scalar   COM                                                
 XML                        Scalar 13160    R(4)            4           scalar   COM              13317,13320                       
 XMR                        Scalar 13160    R(4)            4           scalar   COM              13317,13320                       
 XMXX                       Scalar 13161    R(4)            4           scalar   COM                                                
 XSTM                       Scalar 13167    R(4)            4     1     20       COM              13838,13839,13844,13852           
 XSTM0                      Scalar 13169    R(4)            4           scalar   COM              13802,13844,13852,13862           
 XTIME                      Subr   13306                                                          13306,13924,13926,13929           
 XX                         Local  13264    R(4)            4           scalar   SAVE             13264,13293,13317,13320,13405,1341
                                                                                                  9,13959                           
 XYBCWL                     Scalar 13161    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 13161    R(4)            4     1     2        COM                                                
 XYT                        Common 13167                                64432    SAVE                                               
 YD                         Scalar 13162    R(4)            4     1     8000     COM              13219,13405,13420,13422,13488,1350
                                                                                                  6,13554,13629,13769               
 YN1                        Scalar 13161    R(4)            4           scalar   COM                                                
 YNB                        Scalar 13160    R(4)            4           scalar   COM              13318,13321                       
 YNT                        Scalar 13160    R(4)            4           scalar   COM              13318,13321                       
 YNXX                       Scalar 13161    R(4)            4           scalar   COM                                                
 YSTM                       Scalar 13167    R(4)            4     1     20       COM              13838,13839,13845,13853           
 YSTM0                      Scalar 13169    R(4)            4           scalar   COM              13803,13845,13853,13862           
 YX                         Local  13264    R(4)            4           scalar   SAVE             13264,13293,13318,13321,13405,1342
                                                                                                  0,13959                           

Page 383         Source Listing                  XDTSUB
2017-04-18 11:09                                 syndata.f

  13967 
  13968 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  13969 C                .      .    .                                       .
  13970 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  13971 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  13972 C
  13973 C ABSTRACT: ??????????????????????????????????????????????????????????
  13974 C   ??????????????????????????????????????????????????????????????????
  13975 C
  13976 C PROGRAM HISTORY LOG:
  13977 C ????-??-??  S. J. LORD
  13978 C
  13979 C USAGE:    CALL ????????(????)
  13980 C   INPUT ARGUMENT LIST:
  13981 C     ??????   - ???????????????????????????????????????????????
  13982 C
  13983 C   OUTPUT ARGUMENT LIST:
  13984 C     ??????   - ???????????????????????????????????????????????
  13985 C
  13986 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  13987 C     ??????   - ???????????????????????????????????????????????
  13988 C
  13989 C   OUTPUT FILES:
  13990 C     ??????   - ???????????????????????????????????????????????
  13991 C
  13992 C REMARKS: ?????????????????????????????????????????????????????
  13993 C
  13994 C ATTRIBUTES:
  13995 C   LANGUAGE: FORTRAN 90
  13996 C   MACHINE:  NCEP WCOSS
  13997 C
  13998 C$$$
  13999       SUBROUTINE YDTSUB(KPLV,KDAT,KK,KLAB,FD,A,FKMN,DRF,KDXZ,USTM,VSTM,
  14000      1                  CYBANL,EXVARZ,KEXTFZ,KFOZ,SECVAR,XZ,YZ,KPZ1,
  14001      2                  KPZ2,SPVAL,SCLF)
  14002 C
  14003       PARAMETER (MDIM=35,NDIM=35)
  14004       PARAMETER (LDXDIM=8000)
  14005       PARAMETER (NFXDIM=20)
  14006       PARAMETER (KLDIM= 8)
  14007       PARAMETER(KVDIM=20,KDTDIM=5)
  14008 C**SGI      PARAMETER(KVDIM= 7,KDTDIM=5)
  14009       PARAMETER (KPXDIM=KVDIM*KLDIM)
  14010       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  14011 C
  14012       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  14013      1              ID(LDXDIM),LXSORT(LDXDIM)
  14014       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  14015      1                YNC(NDIM),COSYN(NDIM)
  14016       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  14017      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
  14018      2            MSKD15,MSKD16,MSKD17,MSKD18
  14019       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  14020      1                DMEAN(KDTDIM*KLDIM)
  14021       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  14022      1           WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),ELORG,GLORG,
  14023      2           XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN

Page 384         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14024       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  14025       COMMON /RAVGW/RESAVG(KDXDIM)
  14026 C
  14027       CHARACTER*8 IDSPD1,IDSPD2*72
  14028       CHARACTER*2 SCLF
  14029       CHARACTER IDXLEV*8,IDXVAR*32,IDXXVR*32,IDSFPR*32,IDXL*8,IDV*32,
  14030      1          IDSPK*40,IDDER*5,IDDVAR*7,IDUNT1*5,IDUNT2*15
  14031 C
  14032       EXTERNAL XBF,YBF,DXBF,DYBF,DDXBF,DDYBF
  14033 C
  14034       DIMENSION FD(KDXDIM,LDXDIM),DRF(KDAT*KLDIM)
  14035       DIMENSION A(KDXDIM,MDIM,NDIM),FKMN(KPXDIM,MDIM,NDIM),FP(MDIM,NDIM)
  14036      1          ,IDSVX(KVDIM-(KDTDIM+1)),IDSVK(KVDIM-(KDTDIM+1),2),
  14037      2           IDEXTV(KVDIM),IDSVKE(KDTDIM),SPVAL(KPXDIM),UVSTM(2)
  14038 C
  14039       DIMENSION IDXLEV(KLDIM),IDXVAR(KVDIM),IDXXVR(KVDIM),IDDER(3),
  14040      1          IDDVAR(KDTDIM),IDUNT1(KDTDIM),ISVTBL(KVDIM-(KDTDIM+1))
  14041 C
  14042       DIMENSION KPLV(KLDIM,KVDIM)
  14043       LOGICAL KPLV,KEEP,RHANL,EXTVAR,EXVARZ,UVFLG,SECVAR,CYBANL
  14044 
  14045       REAL(8)  HEAD_8(5),COSDEG_8
  14046 
  14047       SAVE
  14048 C
  14049       DATA KPXO/0/,EXTVAR/.FALSE./
  14050 C
  14051 C     ******* CHANGE VALUES OF IDXLEV FOR A DIFFERENT VERTICAL
  14052 C             COORDINATE  *******
  14053 C
  14054       DATA IDXLEV/' 200 MB ',' 250 MB ',' 300 MB ',' 400 MB ',
  14055      1            ' 500 MB ',' 700 MB ',' 850 MB ','1000 MB '/
  14056 CIBM  THE FOLLOWING INITIALIZATION FOR ANALYSIS VARIABLES HAS BEEN
  14057 CIBM    MOVED TO AN INCLUDE STATEMENT.
  14058       DATA IDXVAR/'TEMPERATURE  (DEG C)            ',
  14059      D            'MIXING RATIO (G/KG)             ',
  14060      D            'GEOPOTENTIAL HEIGHT  (M)        ',
  14061      D            'U COMPONENT OF WIND  (M SEC**-1)',
  14062      D            'V COMPONENT OF WIND  (M SEC**-1)',
  14063      D            'WIND DIR/SPD (WD*0.1/M SEC**-1) ',
  14064      1            'TEMP. X-GRADIENT  (DEG/(100 KM))',
  14065      2            'TEMP. Y-GRADIENT  (DEG/(100 KM))',
  14066      3            'QMIX X-GRADIENT  (G/KG/(100 KM))',
  14067      4            'QMIX Y-GRADIENT  (G/KG/(100 KM))',
  14068      5            'GEOPOT. X-GRADIENT  (M/(100 KM))',
  14069      6            'GEOPOT. Y-GRADIENT  (M/(100 KM))',
  14070      7            'U WIND X-GRADIENT (M/S/(100 KM))',
  14071      8            'V WIND X-GRADIENT (M/S/(100 KM))',
  14072      9            'U WIND Y-GRADIENT (M/S/(100 KM))',
  14073      D            'V WIND Y-GRADIENT (M/S/(100 KM))',
  14074      1            'DIVERGENCE    (10**-5 SEC**-1)  ',
  14075      2            'VORTICITY     (10**-5 SEC**-1)  ',
  14076      3            'RELATIVE HUMIDITY (PERCENT)     ',
  14077      4            'HOR ADV REL VORT (10**-10/S**2) '/
  14078 CIBM  DATA IDXVAR/'TEMPERATURE  (DEG C)            ',
  14079 CIBM D            'MIXING RATIO (G/KG)             ',
  14080 CIBM D            'GEOPOTENTIAL HEIGHT  (M)        ',

Page 385         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14081 CIBM D            'U COMPONENT OF WIND  (M SEC**-1)',
  14082 CIBM D            'V COMPONENT OF WIND  (M SEC**-1)',
  14083 CIBM D            'WIND DIR/SPD (WD*0.1/M SEC**-1) ',
  14084 CIBM 1            'TEMP. X-GRADIENT  (DEG/(100 KM))',
  14085 CIBM 2            'TEMP. Y-GRADIENT  (DEG/(100 KM))',
  14086 CIBM 3            'QMIX X-GRADIENT  (G/KG/(100 KM))',
  14087 CIBM 4            'QMIX Y-GRADIENT  (G/KG/(100 KM))',
  14088 CIBM 5            'GEOPOT. X-GRADIENT  (M/(100 KM))',
  14089 CIBM 6            'GEOPOT. Y-GRADIENT  (M/(100 KM))',
  14090 CIBM 7            'U WIND X-GRADIENT (M/S/(100 KM))',
  14091 CIBM 8            'V WIND X-GRADIENT (M/S/(100 KM))',
  14092 CIBM 9            'U WIND Y-GRADIENT (M/S/(100 KM))',
  14093 CIBM D            'V WIND Y-GRADIENT (M/S/(100 KM))',
  14094 CIBM 1            'DIVERGENCE    (10**-5 SEC**-1)  ',
  14095 CIBM 2            'VORTICITY     (10**-5 SEC**-1)  ',
  14096 CIBM 3            'RELATIVE HUMIDITY (PERCENT)     ',
  14097 CIBM 4            'HOR ADV REL VORT (10**-10/S**2) '/
  14098       DATA IDXXVR/'OMEGA      (MB/HR)              ',
  14099      1             'VORTICITY TEND (10**-10 SEC**-2)',
  14100      2             'H DIV REL VORT (10**-10 SEC**-2)',
  14101      3             'OMEGA X-GRADNT  (MB/HR/(100 KM))',
  14102      4             'OMEGA Y-GRADNT  (MB/HR/(100 KM))',
  14103      5             'VORT. TEND. X-GRADNT            ',
  14104      6             'VORT. TEND. Y-GRADNT            ',
  14105      7             'H DIV REL VORT  X-GRADNT        ',
  14106      8             'H DIV REL VORT  Y-GRADNT        ',
  14107      9             11*' '/
  14108       DATA IDDVAR/'(TEMP) ','(QMIX) ','(GEOP) ','(UWND) ','(VWND) '/,
  14109      D     IDDER /'DDXY ','DDXX ','DDYY '/,
  14110      D     IDUNT1/' (DEG','(G/KG','   (M',' (M/S',
  14111      D            ' (M/S'/,
  14112      D     IDUNT2/'/(10**10 M**2))'/
  14113       DATA IDSFPR/'PRESSURE  (MB)                  '/,
  14114 C**SGI     D     IDSVX/2/
  14115 C**SGI     D     IDSVK/4,
  14116 C**SGI     D           5/
  14117      D     ISVTBL/1,2,3,4,5,6,7,8,9,10,11,12,13,14/
  14118      D     IDSVX/1,1,1,1,1,1,1,1,1,1,2,2,2,2/,
  14119      D     IDSVK/1,1,2,2,3,3,4,5,4,5,5,4,1,4,
  14120      D           1,1,2,2,3,3,4,5,4,5,4,5,2,5/
  14121       DATA IDEXTV/70,100,101,71,72,151,152,161,162,11*0/,
  14122 C**SGI      DATA IDEXTV/70,100,101,71,72,151,152/,
  14123      D     IDSVKE/70,100,101,2*0/
  14124 C
  14125 C     RADF=1.X10**5/(REARTH*2PI/360 DEG)  OMEG=2*OMEGA*1.X10**5
  14126 C     DEGF=2PI/360 DEG
  14127 C
  14128       DATA RADF/.8994628/,DEGF/1.745329E-2/
  14129       DATA OMEG/14.584/,GRAV/9.81/
  14130 C
  14131 C     THIS SUBROUTINE READS THE COMPLETED DATA SET AND SELECTS WHICH
  14132 C     FIELDS ARE TO BE ANALYZED.
  14133 C                 KDAT :  NUMBER OF BASIC DATA VARIABLES (5) AVAILABLE
  14134 C                         AT ANY DATA POINT
  14135 C                 KPLV :  CONTROLS PRINTING BY LEVEL AND VARIABLE
  14136 C                 KLDIM:  NUMBER OF ALLOWED VERTICAL LEVELS
  14137 C                         (100,150,200, ....950,SFC)

Page 386         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14138 C                 KVDIM:  NUMBER OF BASIC VARIABLES (T, RH, Z, U, V) PLU
  14139 C                         ANY VARIABLES DERIVED FROM COMBINATIONS OF
  14140 C                         THESE BASIC VARIABLES, E.G. VORTICITY.
  14141 C                 FD   :  STORAGE ARRAY FOR ALL DATA
  14142 C
  14143 
  14144 C-----------------------------------------------------------------------
  14145 
  14146       ENTRY XDATR(KPLV,KDAT,FD,DRF,KDXZ,USTM,VSTM,CYBANL)
  14147 C
  14148 C
  14149 C     OPENING ALLDAT HANDLED BY CRAY JCL
  14150 C
  14151 C     OPEN(UNIT=MSKDA3,ACCESS='SEQUENTIAL',FORM='UNFORMATTED',
  14152 C    1     FILE='ALLDAT',STATUS='UNKNOWN')
  14153 CVAX 1     FILE='ALLDAT',STATUS='OLD',READONLY,SHARED)
  14154 CIBM 1     FILE='ALLDAT',STATUS='OLD',ACTION='READ')
  14155 C    1     STATUS='OLD')
  14156 C
  14157 C     CHECK ON WIND PRINTOUT
  14158 C
  14159       DO KV=4,5
  14160          DO KL=1,KLDIM
  14161             IF(.NOT. KPLV(KL,KV) .AND. KPLV(KL,6))  KPLV(KL,KV)=.TRUE.
  14162          ENDDO
  14163       ENDDO
  14164       UVSTM(1)=USTM
  14165       UVSTM(2)=VSTM
  14166 C
  14167 C     PICK UP DATA POINT BY POINT
  14168 C
  14169       DO 30 L=1,LDX
  14170       READ (MSKDA3,ERR=990,END=970)  HEAD_8,DRF
  14171       KF=0
  14172 C
  14173 C     IF DATA ARE WANTED, PUT IT INTO FD
  14174 C
  14175       DO 20 KL=1,KLDIM
  14176       DO 10 KD=1,KDAT
  14177       IF(.NOT. KPLV(KL,KD))  GO TO 10
  14178       KF=KF+1
  14179       FD(KF,L)=DRF(KLDIM*(KD-1)+KL)
  14180    10 CONTINUE
  14181    20 CONTINUE
  14182    30 CONTINUE
  14183       CLOSE(UNIT=MSKDA3,STATUS='KEEP')
  14184 C
  14185 C     TEST FOR MISSING DATA: IF SO IGNORE ENTIRE ARRAY
  14186 C
  14187       KFM=KF
  14188       KF=0
  14189 C
  14190       DO KL=1,KLDIM
  14191          DO KV=1,KDAT
  14192             IF(.NOT. KPLV(KL,KV))  GO TO 50
  14193             KF=KF+1
  14194 c && 2 comments

Page 387         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14195 CC          WRITE(6,4111) KL,KV,KF
  14196 C4111 FORMAT('...CHECKING STORAGE IN XDATR, KL,KV,KF=',3I5)
  14197             KEEP=.TRUE.
  14198             DO 40 LD=1,LDX
  14199                IF(FD(KF,LD) .NE. -99.0)  GO TO 40
  14200                KEEP=.FALSE.
  14201 c && 2 comments
  14202 CC             WRITE(6,4112) LD,KL,KV,KF
  14203 C4112 FORMAT('*** FOUND MISSING DATA IN FD, LD,KL,KV,KF=',4I5)
  14204    40       CONTINUE
  14205             IF(KEEP)  GO TO 50
  14206             KPLV(KL,KV)=.FALSE.
  14207             IF(KV .EQ. 4 .OR. KV .EQ. 5)  KPLV(KL,6)=.FALSE.
  14208             IF(KF .EQ. KFM)  GO TO 49
  14209             DO KD=KF,KFM-1
  14210                DO LD=1,LDX
  14211                   FD(KD,LD)=FD(KD+1,LD)
  14212                ENDDO
  14213             ENDDO
  14214    49       KF=KF-1
  14215    50       CONTINUE
  14216          ENDDO
  14217       ENDDO
  14218 C
  14219       KF=0
  14220 C
  14221 C     SUBTRACT OUT STORM MOTION (DEFAULT USTM=VSTM=0)
  14222 C
  14223       DO KL=1,KLDIM
  14224          DO KD=1,KDAT
  14225             IF(.NOT. KPLV(KL,KD))  GO TO 70
  14226             KF=KF+1
  14227             IF(KD .NE. 4 .AND. KD .NE. 5)  GO TO 70
  14228             DO 60 LD=1,LDX
  14229                IF(FD(KF,LD) .NE. -99.0)  FD(KF,LD)=FD(KF,LD)-UVSTM(KD-3)
  14230    60       CONTINUE
  14231    70       CONTINUE
  14232          ENDDO
  14233       ENDDO
  14234 C
  14235       KF=0
  14236 C
  14237       DO 100 KL=1,KLDIM
  14238       DO 90 KV=1,KDAT
  14239       IF(.NOT. KPLV(KL,KV))  GO TO 90
  14240       KF=KF+1
  14241 C
  14242 C     STORE VARIABLE IDENTITY AND LEVEL.
  14243 C     ******  FOR VAX ONLY ... SUBTRACT OUT MEAN FIELD ...  ******
  14244 C
  14245       IF(.NOT. CYBANL)  CALL MEANV(KF,FD)
  14246       KVZ=KV
  14247       IF(KV .EQ. 2 .AND. RHANL)  KVZ=KVDIM-1
  14248       IF(.NOT. EXTVAR) IDSPK(KF)=IDXLEV(KL)//IDXVAR(KVZ)
  14249       IF(      EXTVAR) IDSPK(KF)=IDXLEV(KL)//
  14250      1                           IDXXVR(KVZ+KXTOFF-1)
  14251       IF(KVZ .EQ. 3 .AND. IDXLEV(KL) .EQ. 'SURFACE ')

Page 388         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14252      1     IDSPK(KF)=IDXLEV(KL)//IDSFPR
  14253       IDVAR(KF)=KVZ
  14254       IF(EXTVAR) IDVAR(KF)=IDEXTV(KVZ+KXTOFF-1)
  14255       IDLEV(KF)=KL
  14256    90 CONTINUE
  14257   100 CONTINUE
  14258 C
  14259       KDATZ=KDAT
  14260       KDXZ=KF
  14261       KDXO=KF
  14262       IF(KDXZ .EQ. 0)  GO TO 960
  14263       RETURN
  14264 C
  14265 
  14266 C-----------------------------------------------------------------------
  14267 
  14268       ENTRY DVLAB(KK,KLAB,SCLF)
  14269 C
  14270 C     DECIDE THE DATA TYPE AND PRESSURE LEVEL
  14271 C
  14272       KV=(KK-1)/KLDIM+1
  14273       IF(KV .EQ. 2 .AND. RHANL)  KV=KVDIM-1
  14274       KL=MOD(KK,KLDIM)
  14275       IF(KL .EQ. 0)  KL=KLDIM
  14276 C
  14277 C     DATA TYPES AND PRESSURE LEVELS
  14278 C
  14279       IDXL=IDXLEV(KL)
  14280       IDV=IDXVAR(KV)
  14281       IF(KV .EQ. 3 .AND. KL .EQ. KLDIM)  IDV=IDSFPR
  14282       IF(EXTVAR)  IDV=IDXXVR(KV+KXTOFF-1)
  14283 C
  14284       GO TO (200,300,400,500,600), KLAB
  14285   200 WRITE(6,201)  IDXL,IDV
  14286   201 FORMAT(//43X,'PRELIMINARY DATA VALUES',/,41X,A8,A32,/)
  14287       RETURN
  14288   300 WRITE(6,301) IDXL,IDV
  14289   301 FORMAT(//46X,'FINAL DATA VALUES',/,41X,A8,A32,/)
  14290       RETURN
  14291   400 WRITE(6,401)  IDXL,IDV
  14292   401 FORMAT(//30X,'DEVIATION  (DATA - SPLINE)     RMS/MEAN',
  14293      1       ' (NUMBER OF POINTS) TABLE',/,41X,A8,A32)
  14294       RETURN
  14295   500 WRITE(6,501)  SCLF
  14296   501 FORMAT(25X,'SPLINE INTERPOLATED DATA.  ADDITIONAL SCALE',
  14297      1       ' FACTOR IS 10**',A2)
  14298       RETURN
  14299   600 WRITE(6,601)  IDXL,IDV
  14300   601 FORMAT(//36X,'HORIZONTALLY INTERPOLATED DATA VALUES',/,
  14301      1       41X,A8,A32,/)
  14302       RETURN
  14303 C
  14304 
  14305 C-----------------------------------------------------------------------
  14306 
  14307       ENTRY STEXTV(EXVARZ,KEXTFZ)
  14308       EXTVAR=EXVARZ

Page 389         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14309       KXTOFF=KEXTFZ
  14310       RETURN
  14311 
  14312 C-----------------------------------------------------------------------
  14313 
  14314 C
  14315       ENTRY OUTVAR(KPLV,A,FKMN,KFOZ)
  14316       KVS=KDTDIM+2
  14317       KVSX=KVDIM
  14318       KFO=KFOZ
  14319 C
  14320       DO KL=1,KLDIM
  14321       DO KV=KVS,KVSX
  14322       IF(.NOT. KPLV(KL,KV))  GO TO 2000
  14323       KSVZ=KV-(KDTDIM+1)
  14324       KSVT=ISVTBL(KV-(KDTDIM+1))
  14325       KSVX=IDSVX(KSVZ)
  14326       IF(EXTVAR)  GO TO 1000
  14327       IDSV1=IDSVK(KSVZ,1)
  14328       IDSV2=IDSVK(KSVZ,2)
  14329       GO TO 1005
  14330  1000 IF(KSVZ .GT. 2)  GO TO 980
  14331       IDSV1=IDSVKE(KXTOFF)
  14332  1005 GO TO (1010,1020,1010,1020,1010,1020,1010,1010,1020,1020,
  14333      1       1030,1040,1050,1080),KSVT
  14334 C
  14335 C     THE FOLLOWING ROUTING STATEMENT TO BE USED FOR GEOSTROPHIC WIND
  14336 C        CALCULATIONS
  14337 C 1005 GO TO (1010,1020,1010,1020,1060,1070,1010,1010,1020,1020,
  14338 C     1       1030,1040,1050,1080),KSVT
  14339 C
  14340       WRITE(6,1099)  KSVT,KSVX,KV,KL
  14341  1099 FORMAT(/'***** KSVT OUT OF RANGE IN OUTVAR, KSVT,KSVX,KV,KL=',4I5)
  14342       CALL ABRT1(' OUTVAR',1099)
  14343 C
  14344 C     X-GRADIENT (PER 100 KM)
  14345 C
  14346  1010 CALL SLINTD(DXBF,YBF)
  14347       CALL VFIND(KFOZ,IDSV1,KL,KPA1)
  14348       IF(KPA1 .LT. 1)  GO TO 1990
  14349       KFO=KFO+1
  14350       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14351       DO N=1,NXX
  14352       PERHKM=RADF/COSYN(N)
  14353       DO M=1,MXX
  14354       FKMN(KFO,M,N)=FKMN(KFO,M,N)*PERHKM
  14355       ENDDO
  14356       ENDDO
  14357       GO TO 1970
  14358 C
  14359 C     Y-GRADIENT (PER 100 KM)
  14360 C
  14361  1020 CALL SLINTD(XBF,DYBF)
  14362       CALL VFIND(KFOZ,IDSV1,KL,KPA1)
  14363       IF(KPA1 .LT. 1)  GO TO 1990
  14364       KFO=KFO+1
  14365       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)

Page 390         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14366       DO N=1,NXX
  14367       DO M=1,MXX
  14368       FKMN(KFO,M,N)=FKMN(KFO,M,N)*RADF
  14369       ENDDO
  14370       ENDDO
  14371       GO TO 1970
  14372 C
  14373 C     DIVERGENCE:  ?COS(LAT)**-1(-2PI/360*SIN(LAT)*V+DX(U))+DY(V)?*RADF*
  14374 C
  14375  1030 CALL SLINTD(XBF,YBF)
  14376       CALL VFIND(KFOZ,IDSV1,KL,KPA1)
  14377       IF(KPA1 .LT. 1)  GO TO 1990
  14378       KFO=KFO+1
  14379       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14380       DO N=1,NXX
  14381       SINYN=-SQRT(1.-COSYN(N)**2)*DEGF
  14382       DO M=1,MXX
  14383       FKMN(KFO,M,N)=SINYN*FKMN(KFO,M,N)
  14384       ENDDO
  14385       ENDDO
  14386       CALL SLINTD(DXBF,YBF)
  14387       CALL SLINTS(1,1)
  14388       CALL VFIND(KFOZ,IDSV2,KL,KPA2)
  14389       IF(KPA2 .LT. 1)  GO TO 1990
  14390       CALL SLINTO(A,KPA2,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14391       DO N=1,NXX
  14392       DO M=1,MXX
  14393       FKMN(KFO,M,N)=FKMN(KFO,M,N)/COSYN(N)
  14394       ENDDO
  14395       ENDDO
  14396       CALL SLINTD(XBF,DYBF)
  14397       CALL SLINTS(1,1)
  14398       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14399       DO N=1,NXX
  14400       DO M=1,MXX
  14401       FKMN(KFO,M,N)=FKMN(KFO,M,N)*RADF
  14402       ENDDO
  14403       ENDDO
  14404       GO TO 1970
  14405 C
  14406 C     VORTICITY:  ?COS(LAT)**-1(2PI/360*SIN(LAT)*U+DX(V))-DY(U)?*RADF**-
  14407 C
  14408  1040 CALL SLINTD(XBF,YBF)
  14409       CALL VFIND(KFOZ,IDSV1,KL,KPA1)
  14410       IF(KPA1 .LT. 1)  GO TO 1990
  14411       KFO=KFO+1
  14412       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14413       DO N=1,NXX
  14414       SINYN=SQRT(1.-COSYN(N)**2)*DEGF
  14415       DO M=1,MXX
  14416       FKMN(KFO,M,N)=SINYN*FKMN(KFO,M,N)
  14417       ENDDO
  14418       ENDDO
  14419       CALL SLINTD(DXBF,YBF)
  14420       CALL SLINTS(1,1)
  14421       CALL VFIND(KFOZ,IDSV2,KL,KPA2)
  14422       IF(KPA2 .LT. 1)  GO TO 1990

Page 391         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14423       CALL SLINTO(A,KPA2,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14424       DO N=1,NXX
  14425       DO M=1,MXX
  14426       FKMN(KFO,M,N)=FKMN(KFO,M,N)/COSYN(N)
  14427       ENDDO
  14428       ENDDO
  14429       CALL SLINTD(XBF,DYBF)
  14430       CALL SLINTS(1,-1)
  14431       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14432       DO N=1,NXX
  14433       DO M=1,MXX
  14434       FKMN(KFO,M,N)=FKMN(KFO,M,N)*RADF
  14435       ENDDO
  14436       ENDDO
  14437       GO TO 1970
  14438 C
  14439 C     RELATIVE HUMIDITY
  14440 C
  14441  1050 CALL VFIND(KFOZ,IDSV1,KL,KPF1)
  14442       CALL VFIND(KFOZ,IDSV2,KL,KPF2)
  14443       IF(KPF1 .LT. 1 .OR. KPF2 .LT. 1)  GO TO 1990
  14444       KFO=KFO+1
  14445       DO N=1,NXX
  14446       DO M=1,MXX
  14447          IF(NINT(PLEV(KL)*10.) .GT. 3000)  THEN
  14448             QS=QSATW(FKMN(KPF1,M,N)+273.16,PLEV(KL))
  14449          ELSE
  14450             QS=QSATI(FKMN(KPF1,M,N)+273.16,PLEV(KL))
  14451          END IF
  14452       FKMN(KFO,M,N)=FKMN(KPF2,M,N)/(10.*QS)
  14453       ENDDO
  14454       ENDDO
  14455 C
  14456 C     WIND DIRECTION
  14457 C
  14458 C 1010 DO 1015 KSV=1,KSVX
  14459 C      CALL VFIND(KFOZ,IDSVK(KSVZ,KSV),KL,KPF)
  14460 C      IF(KPF .LT. 1)  GO TO 1990
  14461 C
  14462 C      DO 1011 M=1,MXX
  14463 C      DO 1011 N=1,NXX
  14464 C 1011 FP(M,N)=FKMN(KPF,M,N)
  14465 C 1015 CALL DPREP(FP,IDSVK(KSVZ,KSV),MDIM,NDIM)
  14466 C      CALL DPREP(FP,KV,MDIM,NDIM)
  14467 C      KFO=KFO+1
  14468 C      DO 1017 M=1,MXX
  14469 C      DO 1017 N=1,NXX
  14470 C 1017 FKMN(KFO,M,N)=IFIX(FP(M,N))
  14471 C      GO TO 1970
  14472 C
  14473 C     WIND SPEED
  14474 C
  14475 C 1020 DO 1025 KSV=1,KSVX
  14476 C      CALL VFIND(KFOZ,IDSVK(KSVZ,KSV),KL,KPF)
  14477 C      IF(KPF .LT. 1)  GO TO 1990
  14478 C
  14479 C      DO 1021 M=1,MXX

Page 392         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14480 C      DO 1021 N=1,NXX
  14481 C 1021 FP(M,N)=FKMN(KPF,M,N)
  14482 C 1025 CALL DPREP(FP,IDSVK(KSVZ,KSV),MDIM,NDIM)
  14483 C      CALL DPREP(FP,KV,MDIM,NDIM)
  14484 C      KFO=KFO+1
  14485 C      DO 1027 M=1,MXX
  14486 C      DO 1027 N=1,NXX
  14487 C 1027 FKMN(KFO,M,N)=NINT((FP(M,N)-REAL(IFIX(FP(M,N))))*100.)
  14488 C      GO TO 1970
  14489 C
  14490 C     X-COMPONENT OF GEOSTROPHIC WIND (NORTHERN HEMISPHERE ONLY)
  14491 C
  14492 C 1060 CALL SLINTD(XBF,DYBF)
  14493 C      CALL VFIND(KFOZ,IDSV1,KL,KPA1)
  14494 C      IF(KPA1 .LT. 1)  GO TO 1990
  14495 C      KFO=KFO+1
  14496 C      CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14497 C      DO 1061 N=1,NXX
  14498 C      GEOSU=GRAV*RADF/(MAX(1.E-6,SQRT(1.-COSYN(N)**2))*OMEG)
  14499 C      DO 1061 M=1,MXX
  14500 C 1061 FKMN(KFO,M,N)=-FKMN(KFO,M,N)*GEOSU
  14501 C      GO TO 1970
  14502 C
  14503 C     Y-COMPONENT OF GEOSTROPHIC WIND (NORTHERN HEMISPHERE ONLY)
  14504 C
  14505 C 1070 CALL SLINTD(DXBF,YBF)
  14506 C      CALL VFIND(KFOZ,IDSV1,KL,KPA1)
  14507 C      IF(KPA1 .LT. 1)  GO TO 1990
  14508 C      KFO=KFO+1
  14509 C      CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14510 C      DO 1071 N=1,NXX
  14511 C      GEOSV=GRAV*RADF/(MAX(1.E-6,SQRT(1.-COSYN(N)**2))*OMEG*COSYN(N))
  14512 C      DO 1071 M=1,MXX
  14513 C 1071 FKMN(KFO,M,N)=FKMN(KFO,M,N)*GEOSV
  14514 C      GO TO 1970
  14515 C
  14516 C     HORIZONTAL ADVECTION OF RELATIVE VORTICITY. TERM 1 IS CONTRIBUTION
  14517 C       FROM U D(ZETA)/DX.  TERM2 IS CONTRIBUTION FROM V D(ZETA)/DY.
  14518 C
  14519  1080 CALL VFIND(KFOZ,IDSV1,KL,KPU)
  14520       CALL VFIND(KFOZ,IDSV2,KL,KPV)
  14521       IF(KPU .LT. 1 .OR. KPV .LT. 1)  GO TO 1990
  14522       KFO=KFO+1
  14523       KFOS1=KFO+4
  14524       KFOS2=KFOS1+1
  14525       IF(KFOS2 .GT. KPXDIM)  GO TO 930
  14526 C
  14527 C     TERM 1:SIN(PHI) DU/DX; TERM2: U/SIN(PHI)
  14528 C
  14529       CALL SLINTD(DXBF,YBF)
  14530       CALL SLINTO(A,KPU,FKMN,KPXDIM,MDIM,NDIM,KFOS1)
  14531       CALL SLINTD(XBF,YBF)
  14532       CALL SLINTO(A,KPU,FKMN,KPXDIM,MDIM,NDIM,KFOS2)
  14533       DO N=1,NXX
  14534       SINYN=SQRT(1.-COSYN(N)**2)
  14535       IF(SINYN .EQ. 0)  GO TO 920
  14536       DO M=1,MXX

Page 393         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14537       FKMN(KFOS1,M,N)= FKMN(KFOS1,M,N)*SINYN*DEGF
  14538       FKMN(KFOS2,M,N)=(FKMN(KFOS2,M,N)+DMEAN(KPU))/SINYN*DEGF
  14539       ENDDO
  14540       ENDDO
  14541 C
  14542 C     ADD DDX(V) TO TERM1; DIVIDE BY COS(PHI) LATER
  14543 C
  14544       CALL SLINTD(DDXBF,YBF)
  14545       CALL SLINTS(1,1)
  14546       CALL SLINTO(A,KPV,FKMN,KPXDIM,MDIM,NDIM,KFOS1)
  14547 C
  14548 C     TERM2: ADD DX(V) AND DIVIDE BY COS(PHI)
  14549 C
  14550       CALL SLINTD(DXBF,YBF)
  14551       CALL SLINTS(1,1)
  14552       CALL SLINTO(A,KPV,FKMN,KPXDIM,MDIM,NDIM,KFOS2)
  14553       DO N=1,NXX
  14554       DO M=1,MXX
  14555       FKMN(KFOS1,M,N)=FKMN(KFOS1,M,N)/COSYN(N)
  14556       FKMN(KFOS2,M,N)=FKMN(KFOS2,M,N)/COSYN(N)
  14557       ENDDO
  14558       ENDDO
  14559 C
  14560 C     TERM2: ADD DY(U) AND MULTIPLY BY SIN(PHI)
  14561 C
  14562       CALL SLINTD(XBF,DYBF)
  14563       CALL SLINTS(1,1)
  14564       CALL SLINTO(A,KPU,FKMN,KPXDIM,MDIM,NDIM,KFOS2)
  14565       DO N=1,NXX
  14566       SINYN=SQRT(1.-COSYN(N)**2)*DEGF
  14567       DO M=1,MXX
  14568       FKMN(KFOS2,M,N)=FKMN(KFOS2,M,N)*SINYN
  14569       ENDDO
  14570       ENDDO
  14571 C
  14572 C     TERM2: ADD DDXY(V) AND DIVIDE BY COS(PHI)
  14573 C
  14574       CALL SLINTD(DXBF,DYBF)
  14575       CALL SLINTS(1,1)
  14576       CALL SLINTO(A,KPV,FKMN,KPXDIM,MDIM,NDIM,KFOS2)
  14577       DO N=1,NXX
  14578       DO M=1,MXX
  14579       FKMN(KFOS2,M,N)=FKMN(KFOS2,M,N)/COSYN(N)
  14580       ENDDO
  14581       ENDDO
  14582 C
  14583 C     TERM 1: SUBTRACT DDXY(U); DIVIDE BY COS(PHI) LATER.
  14584 C     TERM 2: SUBTRACT DDY(U)
  14585 C
  14586       CALL SLINTS(1,-1)
  14587       CALL SLINTO(A,KPU,FKMN,KPXDIM,MDIM,NDIM,KFOS1)
  14588       CALL SLINTD(XBF,DDYBF)
  14589       CALL SLINTS(1,-1)
  14590       CALL SLINTO(A,KPU,FKMN,KPXDIM,MDIM,NDIM,KFOS2)
  14591 C
  14592 C     COMBINE TERMS 1 & 2.  MULTIPLY BY U AND V; DIVIDE TERM1 BY COS(PHI
  14593 C

Page 394         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14594       RADFSQ=RADF**2
  14595       DO N=1,NXX
  14596       DO M=1,MXX
  14597 C
  14598 C      TEM1=FKMN(KFOS1,M,N)/COSYN(N)
  14599 C      TEM2=FKMN(KFOS2,M,N)
  14600 C      FKMN(KFO,M,N)=-(FKMN(KPU,M,N)*TEM1+
  14601 C     1                FKMN(KPV,M,N)*TEM2)
  14602 C
  14603       FKMN(KFO,M,N)=-(FKMN(KPU,M,N)*FKMN(KFOS1,M,N)/COSYN(N)+
  14604      1                FKMN(KPV,M,N)*FKMN(KFOS2,M,N))*RADFSQ
  14605 C
  14606 C      IF(TEM1**2+TEM2**2 .NE. 0.0) FKMN(KFO,M,N)=
  14607 C     1         FKMN(KFO,M,N)/SQRT(TEM1**2+TEM2**2)
  14608 C
  14609       ENDDO
  14610       ENDDO
  14611 C
  14612 C     DECOMPOSE TOTAL WIND INTO AZIMUTHAL AVERAGE, MEAN RESIDUAL
  14613 C     (TOTAL WIND-AZIMUTHAL AVERAGE), AND EDDY RESIDUAL FOR
  14614 C     VORTICITY ADVECTION.  CONTRIBUTIONS BY AZIMUTHAL AVERAGE
  14615 C     AND EDDY RESIDUAL ARE DONE NEXT, AND CONTRIBUTION BY MEAN
  14616 C     RESIDUAL ARE DONE LAST.
  14617 C     ALSO, STORE LABELS AND ADDRESSES OF PREVIOUS VARIABLES.
  14618 C     NOTE:  CALCULATIONS ARE SKIPPED IF MEAN AND RESIDUAL VARIABLES
  14619 C            ARE NOT FOUND
  14620 C
  14621       IDSV1=211
  14622       DO 1100 KEX=1,2
  14623       IDSPK(KFO)=IDXLEV(KL)//IDXVAR(KV)
  14624       IDVAR(KFO)=KV
  14625       IDLEV(KFO)=KL
  14626       CALL VFIND(KFOZ,IDSV1  ,KL,KPUZ)
  14627       CALL VFIND(KFOZ,IDSV1+1,KL,KPVZ)
  14628       IF(KPUZ .LT. 1 .OR. KPVZ .LT. 1)  GO TO 2000
  14629       KFO=KFO+1
  14630       DO N=1,NXX
  14631       DO M=1,MXX
  14632       FKMN(KFO,M,N)=-(FKMN(KPUZ,M,N)*FKMN(KFOS1,M,N)/COSYN(N)+
  14633      1                FKMN(KPVZ,M,N)*FKMN(KFOS2,M,N))*RADFSQ
  14634       ENDDO
  14635       ENDDO
  14636       IDSV1=IDSV1+2
  14637  1100 CONTINUE
  14638 C
  14639 C     CONTRIBUTION BY MEAN RESIDUAL
  14640 C
  14641       IDSPK(KFO)=IDXLEV(KL)//IDXVAR(KV)
  14642       IDVAR(KFO)=KV
  14643       IDLEV(KFO)=KL
  14644       KFO=KFO+1
  14645       DO N=1,NXX
  14646       DO M=1,MXX
  14647       FKMN(KFO,M,N)=-(RESAVG(KPU)*FKMN(KFOS1,M,N)/COSYN(N)+
  14648      1                RESAVG(KPV)*FKMN(KFOS2,M,N))*RADFSQ
  14649       ENDDO
  14650       ENDDO

Page 395         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14651 C
  14652 C     STORE LABELS AND ADDRESSES
  14653 C
  14654  1970 IF(EXTVAR)  GO TO 1975
  14655       IDSPK(KFO)=IDXLEV(KL)//IDXVAR(KV)
  14656       IDVAR(KFO)=KV
  14657       IDLEV(KFO)=KL
  14658       GO TO 1980
  14659  1975 IDSPK(KFO)=IDXLEV(KL)//IDXXVR(3+KSVZ+2*(KXTOFF-1))
  14660       IDVAR(KFO)=IDEXTV(3+KSVZ+2*(KXTOFF-1))
  14661       IDLEV(KFO)=KL
  14662  1980 CONTINUE
  14663       GO TO 2000
  14664  1990 WRITE(6,1999)  KFOZ,IDSV1,IDSV2,KL,KV,KSVZ
  14665  1999 FORMAT(/'....SECONDARY VARIABLE NOT FOUND, CALCULATION ABANDONED',
  14666      1       /,5X,'KFOZ,IDSV1,IDSV2,KL,KV,KSVZ=',6I6)
  14667  2000 CONTINUE
  14668       ENDDO
  14669       ENDDO
  14670 C
  14671       KFOZ=KFO
  14672       RETURN
  14673 
  14674 C-----------------------------------------------------------------------
  14675 
  14676 C
  14677       ENTRY OUTSDR(KPLV,A,FKMN,KFOZ)
  14678 C
  14679 C     THIS ENTRY PRODUCES A COMPLETE SET OF SECOND DERIVATIVES
  14680 C            (DDXY,DDXX,DDYY) FOR EACH VARIABLE.
  14681 C
  14682       KFO=KFOZ
  14683 C
  14684       DO KL=1,KLDIM
  14685       DO KD=1,KDATZ
  14686       IF(.NOT. KPLV(KL,KD))  GO TO 3000
  14687 C
  14688 C     DDXY: SECOND CROSS DERIVATIVE  (10**-10 M**-2)
  14689 C
  14690       CALL SLINTD(DXBF,DYBF)
  14691       CALL VFIND(KFOZ,KD,KL,KPA1)
  14692       IF(KPA1 .LT. 1)  GO TO 2990
  14693       KFO=KFO+1
  14694       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14695       DO N=1,NXX
  14696       PRT7KM=RADF**2/COSYN(N)
  14697       DO M=1,MXX
  14698       FKMN(KFO,M,N)=FKMN(KFO,M,N)*PRT7KM
  14699       ENDDO
  14700       ENDDO
  14701       IDSPK(KFO)=IDXLEV(KL)//IDDER(1)//IDDVAR(KD)//IDUNT1(KD)//IDUNT2
  14702       IDVAR(KFO)=10*(KD+1)+1
  14703       IDLEV(KFO)=KL
  14704 C
  14705 C     DDXX: X-SECOND DERIVATIVE (10**-10 M**-2)
  14706 C
  14707       CALL SLINTD(DDXBF,YBF)

Page 396         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14708       CALL VFIND(KFOZ,KD,KL,KPA1)
  14709       IF(KPA1 .LT. 1)  GO TO 2990
  14710       KFO=KFO+1
  14711       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14712       DO N=1,NXX
  14713       PRT7KM=(RADF/COSYN(N))**2
  14714       DO M=1,MXX
  14715       FKMN(KFO,M,N)=FKMN(KFO,M,N)*PRT7KM
  14716       ENDDO
  14717       ENDDO
  14718       IDSPK(KFO)=IDXLEV(KL)//IDDER(2)//IDDVAR(KD)//IDUNT1(KD)//IDUNT2
  14719       IDVAR(KFO)=10*(KD+1)+2
  14720       IDLEV(KFO)=KL
  14721 C
  14722 C     Y-SECOND DERIVATIVE (10**-10 M**-2)
  14723 C
  14724       CALL SLINTD(XBF,DDYBF)
  14725       CALL VFIND(KFOZ,KD,KL,KPA1)
  14726       IF(KPA1 .LT. 1)  GO TO 2990
  14727       KFO=KFO+1
  14728       CALL SLINTO(A,KPA1,FKMN,KPXDIM,MDIM,NDIM,KFO)
  14729       DO N=1,NXX
  14730       DO M=1,MXX
  14731       FKMN(KFO,M,N)=FKMN(KFO,M,N)*RADF**2
  14732       ENDDO
  14733       ENDDO
  14734       IDSPK(KFO)=IDXLEV(KL)//IDDER(3)//IDDVAR(KD)//IDUNT1(KD)//IDUNT2
  14735       IDVAR(KFO)=10*(KD+1)+3
  14736       IDLEV(KFO)=KL
  14737       GO TO 3000
  14738 C
  14739  2990 WRITE(6,2999)  KL,KD
  14740  2999 FORMAT(/'....DATA VARIABLE NOT FOUND FOR SECOND DERIVATIVE,',
  14741      1       ' CALCULATION ABANDONED',2I6)
  14742 C
  14743  3000 CONTINUE
  14744       ENDDO
  14745       ENDDO
  14746 C
  14747       KFOZ=KFO
  14748       RETURN
  14749 
  14750 C-----------------------------------------------------------------------
  14751 
  14752 C
  14753       ENTRY SPTVAR(SECVAR,XZ,YZ,A,KPZ1,KPZ2,SPVAL)
  14754 C
  14755 C     THIS ENTRY GIVES SPOT VALUES FOR ALL VARIABLES.
  14756 C
  14757       UVFLG=.FALSE.
  14758       igo = 3040
  14759       IF(SECVAR)  THEN
  14760         KVZ=KPZ1
  14761         KLZ=KPZ2
  14762         KVZZ=KVZ
  14763         KPZZ=MAX(KDXO,KPXO)+1
  14764         KPZ1=KPZZ

Page 397         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14765         KPZ2=KPZZ
  14766         IDSPK(KPZZ)=IDXLEV(KLZ)//IDXVAR(KVZ)
  14767       ENDIF
  14768       DO 4000 KPZ=KPZ1,KPZ2
  14769         IF(.NOT.SECVAR)  THEN
  14770           KVZ=IDVAR(KPZ)
  14771           KLZ=IDLEV(KPZ)
  14772           KVZZ=KVZ
  14773           IF(EXTVAR)  KVZZ=KXTOFF
  14774         ENDIF
  14775        IF(KVZZ .EQ. KVDIM-1)  GO TO 3030
  14776         IF(KVZZ .GT. KDTDIM+1)  THEN
  14777            if(igo.eq.3040)  then
  14778               go to 3040
  14779            else if(igo.eq.3045)  then
  14780               go to 3045
  14781            else
  14782               call ABRT1(' SPTVAR',4000)
  14783            end if
  14784         ENDIF
  14785         IF(KVZZ .LE. 3)  GO TO 3030
  14786         IF(KVZZ .EQ. KDTDIM+1)  GO TO 950
  14787 C
  14788 C       U WILL GIVE WIND SPEED, V WILL GIVE WIND DIRECTION
  14789 C
  14790         CALL VFIND(KDXO,4,KLZ,KDZ1)
  14791         CALL VFIND(KDXO,5,KLZ,KDZ2)
  14792         IF(KDZ1 .LT. 1 .OR. KDZ2 .LT. 1)  GO TO 3990
  14793         CALL SPTINO(XZ,YZ,A,KDZ1,KDZ1,SPZU)
  14794         CALL SPTINO(XZ,YZ,A,KDZ2,KDZ2,SPZV)
  14795         SPZU=SPZU+DMEAN(KDZ1)
  14796         SPZV=SPZV+DMEAN(KDZ2)
  14797         CALL WDWS(SPZU,SPZV)
  14798 C
  14799 C       PUT THE CORRECT WIND DATA TYPE INTO SPVAL
  14800 C
  14801         IF(UVFLG)THEN
  14802           SPVAL(KPZ)=SPZU
  14803           UVFLG=.FALSE.
  14804         ELSE
  14805           SPVAL(KPZ)=SPZV
  14806           UVFLG=.TRUE.
  14807         ENDIF
  14808         GO TO 4000
  14809 C
  14810 C       T, Q, Z, OR EXTERNAL VARIABLE
  14811 C
  14812  3030   CALL VFIND(KDXO,KVZ,KLZ,KDZ1)
  14813         CALL SPTINO(XZ,YZ,A,KDZ1,KDZ1,SPZ)
  14814         SPVAL(KPZ)=SPZ+DMEAN(KDZ1)
  14815         GO TO 4000
  14816 C
  14817 C       GRADIENTS, DIVERGENCE, VORTICITY, AND RELATIVE HUMIDITY
  14818 C
  14819  3040   COSY=COSDEG_8(GLORG+YZ)
  14820         igo = 3045
  14821 C

Page 398         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14822  3045   IF(EXTVAR)  GO TO 940
  14823         KSVZ=KVZ-(KDTDIM+1)
  14824         IDSV1=IDSVK(KSVZ,1)
  14825         IDSV2=IDSVK(KSVZ,2)
  14826         CALL VFIND(KDXO,IDSV1,KLZ,KDZ1)
  14827         CALL VFIND(KDXO,IDSV2,KLZ,KDZ2)
  14828         IF(KDZ1 .LT. 1 .OR. KDZ2 .LT. 1)  GO TO 3990
  14829 C
  14830         GO TO (3050,3060,3050,3060,3050,3060,3050,3050,3060,3060,
  14831      1         3070,3080,3090,3100), KSVZ
  14832 C
  14833 C       X-GRADIENT
  14834 C
  14835  3050   CALL SPOTDX(XZ,YZ,A,KDZ1,KDZ1,SPZ)
  14836         SPVAL(KPZ)=SPZ*RADF/COSY
  14837         GO TO 4000
  14838 C
  14839 C       Y-GRADIENT
  14840 C
  14841  3060   CALL SPOTDY(XZ,YZ,A,KDZ1,KDZ1,SPZ)
  14842         SPVAL(KPZ)=SPZ*RADF
  14843         GO TO 4000
  14844 C
  14845 C       DIVERGENCE
  14846 C
  14847  3070   CALL SPTINO(XZ,YZ,A,KDZ1,KDZ1,SPZV)
  14848         CALL SPOTDX(XZ,YZ,A,KDZ2,KDZ2,SPZDXU)
  14849         CALL SPOTDY(XZ,YZ,A,KDZ1,KDZ1,SPZDYV)
  14850         SPZV=SPZV+DMEAN(KDZ1)
  14851         SPVAL(KPZ)=((-SQRT(1.-COSY**2)*DEGF*SPZV+SPZDXU)/COSY+SPZDYV)*
  14852      1                RADF
  14853         GO TO 4000
  14854 C
  14855 C       VORTICITY
  14856 C
  14857  3080   CALL SPTINO(XZ,YZ,A,KDZ1,KDZ1,SPZU)
  14858         CALL SPOTDX(XZ,YZ,A,KDZ2,KDZ2,SPZDXV)
  14859         CALL SPOTDY(XZ,YZ,A,KDZ1,KDZ1,SPZDYU)
  14860         SPZU=SPZU+DMEAN(KDZ1)
  14861         SPVAL(KPZ)=((SQRT(1.-COSY**2)*DEGF*SPZU+SPZDXV)/COSY-SPZDYU)*
  14862      1               RADF
  14863         GO TO 4000
  14864 C
  14865 C       RELATIVE HUMIDITY
  14866 C
  14867  3090   CALL SPTINO(XZ,YZ,A,KDZ1,KDZ1,SPZT)
  14868         CALL SPTINO(XZ,YZ,A,KDZ2,KDZ2,SPZQ)
  14869         SPZT=SPZT+DMEAN(KDZ1)+273.16
  14870         SPZQ=SPZQ+DMEAN(KDZ2)
  14871         IF(NINT(PLEV(KLZ)*10.) .GT. 3000)  THEN
  14872            QS=QSATW(SPZT,PLEV(KLZ))
  14873         ELSE
  14874            QS=QSATI(SPZT,PLEV(KLZ))
  14875         END IF
  14876         SPVAL(KPZ)=SPZQ/(10.*QS)
  14877         GO TO 4000
  14878 C

Page 399         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14879 C       HORIZONTAL ADVECTION OF RELATIVE VORTICITY
  14880 C
  14881  3100   SINY=SQRT(1.-COSY**2)
  14882         CALL SPTINO(XZ,YZ,A,KDZ1,KDZ1,SPU)
  14883         CALL SPTINO(XZ,YZ,A,KDZ2,KDZ2,SPV)
  14884 
  14885 C fixit?? # of args. in SPOTDX call is 7 here, 6 elsewhere (set last
  14886 C arg. to ZERO)
  14887 CDAK    CALL SPOTDX (XZ,YZ,A,KDZ1,KDZ2,SPDXU,SPDXV)
  14888         spdxv = 0.
  14889         call spotdx (xz,yz,a,kdz1,kdz2,spdxu)
  14890         CALL SPOTDY (XZ,YZ,A,KDZ1,KDZ1,SPDYU)
  14891         CALL SPDDXX(XZ,YZ,A,KDZ2,KDZ2,SDDXXV)
  14892         CALL SPDDYY(XZ,YZ,A,KDZ1,KDZ1,SDDYYU)
  14893 C fixit?? # of args. in SPDDXY call is 7 here, 6 elsewhere (set last
  14894 C arg. to ZERO)
  14895 CDAK    CALL SPDDXY(XZ,YZ,A,KDZ1,KDZ2,SDDXYU,SDDXYV)
  14896         sddxyv = 0.
  14897         call spddxy(xz,yz,a,kdz1,kdz2,sddxyu)
  14898 C
  14899         SPU=SPU+DMEAN(KDZ1)
  14900         SPV=SPV+DMEAN(KDZ2)
  14901 C
  14902         SPVAL(KPZ)=-(SPU*((SDDXXV+DEGF*SINY*SPDXU)/COSY-SDDXYU)/COSY+
  14903      1             SPV*((SDDXYV+DEGF*(SINY*SPDYU+(DEGF*SPU+SINY*SPDXV)/
  14904      2             COSY))/COSY-SDDYYU))*RADF**2
  14905         GO TO 4000
  14906 C
  14907  3990   WRITE(6,3991) KLZ,IDSV1,IDSV2,KDZ1,KDZ2
  14908  3991   FORMAT(/'**** SECONDARY VARIABLE NOT FOUND. KLZ,IDSV1,IDSV2,',
  14909      1         'KDZ1,KDZ2=',5I10)
  14910 C
  14911  4000 CONTINUE
  14912 C
  14913       RETURN
  14914 C
  14915   920 WRITE(6,921)  N
  14916   921 FORMAT(/'***** SINYN=0, N=',I3,' CALCULATION OF HOR. VORT. ADV.',
  14917      1       ' WILL BLOW UP.')
  14918       CALL ABRT1(' SPTVAR',920)
  14919 C
  14920   930 WRITE(6,931) KFOS2,KPXDIM
  14921   931 FORMAT(/'***** KFOS2=',I5,' AND IS GREATER THAN KPXDIM=',I5)
  14922       CALL ABRT1(' SPTVAR',931)
  14923 C
  14924   940 WRITE(6,941)
  14925   941 FORMAT(/'***** SECONDARY VARIABLES ARE NOT ALLOWED FOR EXTERNAL',
  14926      1       ' DATA')
  14927       CALL ABRT1(' SPTVAR',941)
  14928 C
  14929   950 WRITE(6,951) KVZ
  14930   951 FORMAT(/'***** WRONG VARIABLE IN SPTVAR, KVZ=',I4)
  14931       CALL ABRT1(' SPTVAR',951)
  14932 C
  14933   960 WRITE(6,961) KF,KDXZ,LDX
  14934   961 FORMAT(/'***** DATA FILLING ERROR IN XDATR...KF=',I10,
  14935      1       ' KDXZ=',I10,' LDX=',I10)

Page 400         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14936       CALL ABRT1(' SPTVAR',961)
  14937 C
  14938   970 WRITE(6,971)  MSKDA3,L,HEAD_8,DRF
  14939   971 FORMAT(/'***** END OF RECORD IN XDATR',2I7,F3.0,/,(10F5.1))
  14940       CALL ABRT1(' SPTVAR',971)
  14941 C
  14942   980 WRITE(6,981)
  14943   981 FORMAT(/'***** KSVZ GREATER THAN 2 FOR EXTERNAL VARIABLE')
  14944       CALL ABRT1(' SPTVAR',981)
  14945 C
  14946   990 WRITE(6,991) MSKDA3,L,HEAD_8,DRF
  14947   991 FORMAT(/10X,'***** READ ERROR IN XDATR',2I10,5F10.1,/,
  14948      1      (5F10.1,/))
  14949       CALL ABRT1(' SPTVAR',991)
  14950       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 dvlab_                outvar_               stextv_               ydtsub_             
 outsdr_               sptvar_               xdatr_                                    


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  14180                                                          14176,14177                       
 100                        Label  14257                                                          14237                             
 1000                       Label  14330                                                          14326                             
 1005                       Label  14332                                                          14329                             
 1010                       Label  14346                                                          14332                             
 1020                       Label  14361                                                          14332                             
 1030                       Label  14375                                                          14333                             
 1040                       Label  14408                                                          14333                             
 1050                       Label  14441                                                          14333                             
 1080                       Label  14519                                                          14333                             
 1099                       Label  14341                                                          14340                             
 1100                       Label  14637                                                          14622                             
 1970                       Label  14654                                                          14357,14371,14404,14437           
 1975                       Label  14659                                                          14654                             
 1980                       Label  14662                                                          14658                             
 1990                       Label  14664                                                          14348,14363,14377,14389,14410,1442
                                                                                                  2,14443,14521                     
 1999                       Label  14665                                                          14664                             
 20                         Label  14181                                                          14175                             
 200                        Label  14285                                                          14284                             
 2000                       Label  14667                                                          14322,14628,14663                 
 201                        Label  14286                                                          14285                             
 2990                       Label  14739                                                          14692,14709,14726                 
 2999                       Label  14740                                                          14739                             
 30                         Label  14182                                                          14169                             
 300                        Label  14288                                                          14284                             
 3000                       Label  14743                                                          14686,14737                       
 301                        Label  14289                                                          14288                             

Page 401         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 3030                       Label  14812                                                          14775,14785                       
 3040                       Label  14819                                                          14778                             
 3045                       Label  14822                                                          14780                             
 3050                       Label  14835                                                          14830                             
 3060                       Label  14841                                                          14830                             
 3070                       Label  14847                                                          14831                             
 3080                       Label  14857                                                          14831                             
 3090                       Label  14867                                                          14831                             
 3100                       Label  14881                                                          14831                             
 3990                       Label  14907                                                          14792,14828                       
 3991                       Label  14908                                                          14907                             
 40                         Label  14204                                                          14198,14199                       
 400                        Label  14291                                                          14284                             
 4000                       Label  14911                                                          14768,14808,14815,14837,14843,1485
                                                                                                  3,14863,14877,14905               
 401                        Label  14292                                                          14291                             
 49                         Label  14214                                                          14208                             
 50                         Label  14215                                                          14192,14205                       
 500                        Label  14295                                                          14284                             
 501                        Label  14296                                                          14295                             
 60                         Label  14230                                                          14228                             
 600                        Label  14299                                                          14284                             
 601                        Label  14300                                                          14299                             
 70                         Label  14231                                                          14225,14227                       
 90                         Label  14256                                                          14238,14239                       
 920                        Label  14915                                                          14535                             
 921                        Label  14916                                                          14915                             
 930                        Label  14920                                                          14525                             
 931                        Label  14921                                                          14920                             
 940                        Label  14924                                                          14822                             
 941                        Label  14925                                                          14924                             
 950                        Label  14929                                                          14786                             
 951                        Label  14930                                                          14929                             
 960                        Label  14933                                                          14262                             
 961                        Label  14934                                                          14933                             
 970                        Label  14938                                                          14170                             
 971                        Label  14939                                                          14938                             
 980                        Label  14942                                                          14330                             
 981                        Label  14943                                                          14942                             
 990                        Label  14946                                                          14170                             
 991                        Label  14947                                                          14946                             
 A                          Dummy  13999    R(4)            4     3     49000    ARG,INOUT        14350,14365,14379,14390,14398,1441
                                                                                                  2,14423,14431,14530,14532,14546,14
                                                                                                  552,14564,14576,14587,14590,14694,
                                                                                                  14711,14728,14793,14794,14813,1483
                                                                                                  5,14841,14847,14848,14849,14857,14
                                                                                                  858,14859,14867,14868,14882,14883,
                                                                                                  14889,14890,14891,14892,14897     
 ABRT1                      Subr   14342                                                          14342,14782,14918,14922,14927,1493
                                                                                                  1,14936,14940,14944,14949         
 COSDEG_8                   Func   14045    R(8)            8           scalar                    14819                             
 COSY                       Local  14819    R(4)            4           scalar   SAVE             14819,14836,14851,14861,14881,1490
                                                                                                  2,14904                           
 COSYN                      Scalar 14015    R(4)            4     1     35       COM              14352,14381,14393,14414,14426,1453
                                                                                                  4,14555,14556,14566,14579,14603,14

Page 402         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  632,14647,14696,14713             
 CYBANL                     Dummy  14000    L(4)            4           scalar   ARG,INOUT        14245                             
 DATREC                     Scalar 14024    R(4)            4     1     6        COM                                                
 DDXBF                      Subr   14032                                scalar                    14544,14707                       
 DDYBF                      Subr   14032                                scalar                    14588,14724                       
 DEGF                       Local  14128    R(4)            4           scalar   SAVE             14128,14381,14414,14537,14538,1456
                                                                                                  6,14851,14861,14902,14903         
 DMEAN                      Scalar 14020    R(4)            4     1     40       COM              14538,14795,14796,14814,14850,1486
                                                                                                  0,14869,14870,14899,14900         
 DRF                        Dummy  13999    R(4)            4     1     0        ARG,INOUT        14170,14179,14938,14946           
 DSK                        Common 14016                                76       SAVE                                               
 DVLAB                      Subr   14268                                                                                            
 DXBF                       Subr   14032                                scalar                    14346,14386,14419,14529,14550,1457
                                                                                                  4,14690                           
 DXM                        Scalar 14014    R(4)            4           scalar   COM                                                
 DYBF                       Subr   14032                                scalar                    14361,14396,14429,14562,14574,1469
                                                                                                  0                                 
 DYN                        Scalar 14014    R(4)            4           scalar   COM                                                
 ELORG                      Scalar 14022    R(4)            4           scalar   COM                                                
 EXTVAR                     Local  14043    L(4)            4           scalar   SAVE             14049,14248,14249,14254,14282,1430
                                                                                                  8,14326,14654,14773,14822         
 EXVARZ                     Dummy  14000    L(4)            4           scalar   ARG,INOUT        14308                             
 FD                         Dummy  13999    R(4)            4     2     320000   ARG,INOUT        14179,14199,14211,14229,14245     
 FKMN                       Dummy  13999    R(4)            4     3     196000   ARG,INOUT        14350,14354,14365,14368,14379,1438
                                                                                                  3,14390,14393,14398,14401,14412,14
                                                                                                  416,14423,14426,14431,14434,14448,
                                                                                                  14450,14452,14530,14532,14537,1453
                                                                                                  8,14546,14552,14555,14556,14564,14
                                                                                                  568,14576,14579,14587,14590,14603,
                                                                                                  14604,14632,14633,14647,14648,1469
                                                                                                  4,14698,14711,14715,14728,14731   
 FP                         Local  14035    R(4)            4     2     1225     SAVE                                               
 GLORG                      Scalar 14022    R(4)            4           scalar   COM              14819                             
 GRAV                       Local  14129    R(4)            4           scalar   SAVE             14129                             
 HEAD_8                     Local  14045    R(8)            8     1     5        SAVE             14170,14938,14946                 
 ICOOR                      Scalar 14024    I(4)            4           scalar   COM                                                
 ID                         Scalar 14013    I(4)            4     1     8000     COM                                                
 IDAT                       Scalar 14024    I(4)            4           scalar   COM                                                
 IDATZ                      Scalar 14024    I(4)            4           scalar   COM                                                
 IDAYMN                     Scalar 14023    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 14021    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 14022    I(4)            4     1     20       COM                                                
 IDDER                      Local  14030    CHAR            5     1     3        SAVE             14109,14701,14718,14734           
 IDDVAR                     Local  14030    CHAR            7     1     5        SAVE             14108,14701,14718,14734           
 IDEXTV                     Local  14037    I(4)            4     1     20       SAVE             14121,14254,14660                 
 IDLEV                      Scalar 14019    I(4)            4     1     160      COM              14255,14625,14643,14657,14661,1470
                                                                                                  3,14720,14736,14771               
 IDSFPR                     Local  14029    CHAR            32          scalar   SAVE             14113,14252,14281                 
 IDSPD1                     Scalar 14012    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 14012    CHAR            72          scalar   COM                                                
 IDSPK                      Scalar 14019    CHAR            40    1     160      COM              14248,14249,14252,14623,14641,1465
                                                                                                  5,14659,14701,14718,14734,14766   
 IDSV1                      Local  14327    I(4)            4           scalar   SAVE             14327,14331,14347,14362,14376,1440
                                                                                                  9,14441,14519,14621,14626,14627,14
                                                                                                  636,14664,14824,14826,14907       

Page 403         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDSV2                      Local  14328    I(4)            4           scalar   SAVE             14328,14388,14421,14442,14520,1466
                                                                                                  4,14825,14827,14907               
 IDSVK                      Local  14036    I(4)            4     2     28       SAVE             14119,14327,14328,14824,14825     
 IDSVKE                     Local  14037    I(4)            4     1     5        SAVE             14123,14331                       
 IDSVX                      Local  14036    I(4)            4     1     14       SAVE             14118,14325                       
 IDUNT1                     Local  14030    CHAR            5     1     5        SAVE             14110,14701,14718,14734           
 IDUNT2                     Local  14030    CHAR            15          scalar   SAVE             14112,14701,14718,14734           
 IDV                        Local  14029    CHAR            32          scalar   SAVE             14280,14281,14282,14285,14288,1429
                                                                                                  1,14299                           
 IDVAR                      Scalar 14019    I(4)            4     1     160      COM              14253,14254,14624,14642,14656,1466
                                                                                                  0,14702,14719,14735,14770         
 IDXL                       Local  14029    CHAR            8           scalar   SAVE             14279,14285,14288,14291,14299     
 IDXLEV                     Local  14029    CHAR            8     1     8        SAVE             14054,14248,14249,14251,14252,1427
                                                                                                  9,14623,14641,14655,14659,14701,14
                                                                                                  718,14734,14766                   
 IDXVAR                     Local  14029    CHAR            32    1     20       SAVE             14058,14248,14280,14623,14641,1465
                                                                                                  5,14766                           
 IDXXVR                     Local  14029    CHAR            32    1     20       SAVE             14098,14250,14282,14659           
 IGO                        Local  14758    I(4)            4           scalar   SAVE             14758,14777,14779,14820           
 ISVTBL                     Local  14040    I(4)            4     1     14       SAVE             14117,14324                       
 JDAY0                      Scalar 14023    I(4)            4           scalar   COM                                                
 KD                         Local  14176    I(4)            4           scalar   SAVE             14176,14177,14179,14209,14211,1422
                                                                                                  4,14225,14227,14229,14685,14686,14
                                                                                                  691,14701,14702,14708,14718,14719,
                                                                                                  14725,14734,14735,14739           
 KDAT                       Dummy  13999    I(4)            4           scalar   ARG,INOUT        14034,14176,14191,14224,14238,1425
                                                                                                  9                                 
 KDATZ                      Local  14259    I(4)            4           scalar   SAVE             14259,14685                       
 KDTDIM                     Param  14007    I(4)            4           scalar                    14010,14020,14024,14036,14037,1404
                                                                                                  0,14316,14323,14324,14776,14786,14
                                                                                                  823                               
 KDXDIM                     Param  14010    I(4)            4           scalar                    14025,14034,14035                 
 KDXO                       Local  14261    I(4)            4           scalar   SAVE             14261,14763,14790,14791,14812,1482
                                                                                                  6,14827                           
 KDXZ                       Dummy  13999    I(4)            4           scalar   ARG,INOUT        14260,14262,14933                 
 KDZ1                       Local  14790    I(4)            4           scalar   SAVE             14790,14792,14793,14795,14812,1481
                                                                                                  3,14814,14826,14828,14835,14841,14
                                                                                                  847,14849,14850,14857,14859,14860,
                                                                                                  14867,14869,14882,14889,14890,1489
                                                                                                  2,14897,14899,14907               
 KDZ2                       Local  14791    I(4)            4           scalar   SAVE             14791,14792,14794,14796,14827,1482
                                                                                                  8,14848,14858,14868,14870,14883,14
                                                                                                  889,14891,14897,14900,14907       
 KEEP                       Local  14043    L(4)            4           scalar   SAVE             14197,14200,14205                 
 KEX                        Local  14622    I(4)            4           scalar   SAVE             14622                             
 KEXTFZ                     Dummy  14000    I(4)            4           scalar   ARG,INOUT        14309                             
 KF                         Local  14171    I(4)            4           scalar   SAVE             14171,14178,14179,14187,14188,1419
                                                                                                  3,14199,14208,14209,14214,14219,14
                                                                                                  226,14229,14235,14240,14245,14248,
                                                                                                  14249,14252,14253,14254,14255,1426
                                                                                                  0,14261,14933                     
 KFM                        Local  14187    I(4)            4           scalar   SAVE             14187,14208,14209                 
 KFO                        Local  14318    I(4)            4           scalar   SAVE             14318,14349,14350,14354,14364,1436
                                                                                                  5,14368,14378,14379,14383,14390,14
                                                                                                  393,14398,14401,14411,14412,14416,

Page 404         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  14423,14426,14431,14434,14444,1445
                                                                                                  2,14522,14523,14603,14623,14624,14
                                                                                                  625,14629,14632,14641,14642,14643,
                                                                                                  14644,14647,14655,14656,14657,1465
                                                                                                  9,14660,14661,14671,14682,14693,14
                                                                                                  694,14698,14701,14702,14703,14710,
                                                                                                  14711,14715,14718,14719,14720,1472
                                                                                                  7,14728,14731,14734,14735,14736,14
                                                                                                  747                               
 KFOS1                      Local  14523    I(4)            4           scalar   SAVE             14523,14524,14530,14537,14546,1455
                                                                                                  5,14587,14603,14632,14647         
 KFOS2                      Local  14524    I(4)            4           scalar   SAVE             14524,14525,14532,14538,14552,1455
                                                                                                  6,14564,14568,14576,14579,14590,14
                                                                                                  604,14633,14648,14920             
 KFOZ                       Dummy  14000    I(4)            4           scalar   ARG,INOUT        14318,14347,14362,14376,14388,1440
                                                                                                  9,14421,14441,14442,14519,14520,14
                                                                                                  626,14627,14664,14671,14682,14691,
                                                                                                  14708,14725,14747                 
 KK                         Dummy  13999    I(4)            4           scalar   ARG,INOUT        14272,14274                       
 KL                         Local  14160    I(4)            4           scalar   SAVE             14160,14161,14175,14177,14179,1419
                                                                                                  0,14192,14206,14207,14223,14225,14
                                                                                                  237,14239,14248,14249,14251,14252,
                                                                                                  14255,14274,14275,14279,14281,1432
                                                                                                  0,14322,14340,14347,14362,14376,14
                                                                                                  388,14409,14421,14441,14442,14447,
                                                                                                  14448,14450,14519,14520,14623,1462
                                                                                                  5,14626,14627,14641,14643,14655,14
                                                                                                  657,14659,14661,14664,14684,14686,
                                                                                                  14691,14701,14703,14708,14718,1472
                                                                                                  0,14725,14734,14736,14739         
 KLAB                       Dummy  13999    I(4)            4           scalar   ARG,INOUT        14284                             
 KLDIM                      Param  14006    I(4)            4           scalar                    14009,14010,14020,14024,14034,1403
                                                                                                  9,14042,14160,14175,14179,14190,14
                                                                                                  223,14237,14272,14274,14275,14281,
                                                                                                  14320,14684                       
 KLZ                        Local  14761    I(4)            4           scalar   SAVE             14761,14766,14771,14790,14791,1481
                                                                                                  2,14826,14827,14871,14872,14874,14
                                                                                                  907                               
 KPA1                       Local  14347    I(4)            4           scalar   SAVE             14347,14348,14350,14362,14363,1436
                                                                                                  5,14376,14377,14379,14398,14409,14
                                                                                                  410,14412,14431,14691,14692,14694,
                                                                                                  14708,14709,14711,14725,14726,1472
                                                                                                  8                                 
 KPA2                       Local  14388    I(4)            4           scalar   SAVE             14388,14389,14390,14421,14422,1442
                                                                                                  3                                 
 KPF1                       Local  14441    I(4)            4           scalar   SAVE             14441,14443,14448,14450           
 KPF2                       Local  14442    I(4)            4           scalar   SAVE             14442,14443,14452                 
 KPLV                       Dummy  13999    L(4)            4     2     160      ARG,INOUT        14161,14177,14192,14206,14207,1422
                                                                                                  5,14239,14322,14686               
 KPU                        Local  14519    I(4)            4           scalar   SAVE             14519,14521,14530,14532,14538,1456
                                                                                                  4,14587,14590,14603,14647         
 KPUZ                       Local  14626    I(4)            4           scalar   SAVE             14626,14628,14632                 
 KPV                        Local  14520    I(4)            4           scalar   SAVE             14520,14521,14546,14552,14576,1460
                                                                                                  4,14648                           
 KPVZ                       Local  14627    I(4)            4           scalar   SAVE             14627,14628,14633                 

Page 405         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KPX                        Scalar 14019    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  14009    I(4)            4           scalar                    14019,14035,14037,14350,14365,1437
                                                                                                  9,14390,14398,14412,14423,14431,14
                                                                                                  525,14530,14532,14546,14552,14564,
                                                                                                  14576,14587,14590,14694,14711,1472
                                                                                                  8,14920                           
 KPXO                       Local  14049    I(4)            4           scalar   SAVE             14049,14763                       
 KPZ                        Local  14768    I(4)            4           scalar   SAVE             14768,14770,14771,14802,14805,1481
                                                                                                  4,14836,14842,14851,14861,14876,14
                                                                                                  902                               
 KPZ1                       Dummy  14000    I(4)            4           scalar   ARG,INOUT        14760,14764,14768                 
 KPZ2                       Dummy  14001    I(4)            4           scalar   ARG,INOUT        14761,14765,14768                 
 KPZZ                       Local  14763    I(4)            4           scalar   SAVE             14763,14764,14765,14766           
 KSVT                       Local  14324    I(4)            4           scalar   SAVE             14324,14333,14340                 
 KSVX                       Local  14325    I(4)            4           scalar   SAVE             14325,14340                       
 KSVZ                       Local  14323    I(4)            4           scalar   SAVE             14323,14325,14327,14328,14330,1465
                                                                                                  9,14660,14664,14823,14824,14825,14
                                                                                                  831                               
 KV                         Local  14159    I(4)            4           scalar   SAVE             14159,14161,14191,14192,14206,1420
                                                                                                  7,14238,14239,14246,14247,14272,14
                                                                                                  273,14280,14281,14282,14321,14322,
                                                                                                  14323,14324,14340,14623,14624,1464
                                                                                                  1,14642,14655,14656,14664         
 KVDIM                      Param  14007    I(4)            4           scalar                    14009,14036,14037,14039,14040,1404
                                                                                                  2,14247,14273,14317,14775         
 KVS                        Local  14316    I(4)            4           scalar   SAVE             14316,14321                       
 KVSX                       Local  14317    I(4)            4           scalar   SAVE             14317,14321                       
 KVZ                        Local  14246    I(4)            4           scalar   SAVE             14246,14247,14248,14250,14251,1425
                                                                                                  3,14254,14760,14762,14766,14770,14
                                                                                                  772,14812,14823,14929             
 KVZZ                       Local  14762    I(4)            4           scalar   SAVE             14762,14772,14773,14775,14776,1478
                                                                                                  5,14786                           
 KXTOFF                     Local  14250    I(4)            4           scalar   SAVE             14250,14254,14282,14309,14331,1465
                                                                                                  9,14660,14773                     
 L                          Local  14169    I(4)            4           scalar   SAVE             14169,14179,14938,14946           
 LD                         Local  14198    I(4)            4           scalar   SAVE             14198,14199,14210,14211,14228,1422
                                                                                                  9                                 
 LDX                        Scalar 14012    I(4)            4           scalar   COM              14169,14198,14210,14228,14933     
 LDXDIM                     Param  14004    I(4)            4           scalar                    14012,14013,14021,14034           
 LXSORT                     Scalar 14013    I(4)            4     1     8000     COM                                                
 M                          Local  14353    I(4)            4           scalar   SAVE             14353,14354,14367,14368,14382,1438
                                                                                                  3,14392,14393,14400,14401,14415,14
                                                                                                  416,14425,14426,14433,14434,14446,
                                                                                                  14448,14450,14452,14536,14537,1453
                                                                                                  8,14554,14555,14556,14567,14568,14
                                                                                                  578,14579,14596,14603,14604,14631,
                                                                                                  14632,14633,14646,14647,14648,1469
                                                                                                  7,14698,14714,14715,14730,14731   
 MAX                        Func   14763                                scalar                    14763                             
 MDIM                       Param  14003    I(4)            4           scalar                    14014,14035,14350,14365,14379,1439
                                                                                                  0,14398,14412,14423,14431,14530,14
                                                                                                  532,14546,14552,14564,14576,14587,
                                                                                                  14590,14694,14711,14728           
 MEANV                      Subr   14245                                                          14245                             
 MOD                        Func   14274                                scalar                    14274                             

Page 406         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKD11                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 14018    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 14018    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 14018    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 14018    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 14016    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 14016    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 14016    I(4)            4           scalar   COM              14170,14183,14938,14946           
 MSKDA4                     Scalar 14016    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 14016    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 14016    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 14017    I(4)            4           scalar   COM                                                
 MSKEF                      Scalar 14016    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 14016    I(4)            4           scalar   COM                                                
 MXX                        Scalar 14014    I(4)            4           scalar   COM              14353,14367,14382,14392,14400,1441
                                                                                                  5,14425,14433,14446,14536,14554,14
                                                                                                  567,14578,14596,14631,14646,14697,
                                                                                                  14714,14730                       
 N                          Local  14351    I(4)            4           scalar   SAVE             14351,14352,14354,14366,14368,1438
                                                                                                  0,14381,14383,14391,14393,14399,14
                                                                                                  401,14413,14414,14416,14424,14426,
                                                                                                  14432,14434,14445,14448,14450,1445
                                                                                                  2,14533,14534,14537,14538,14553,14
                                                                                                  555,14556,14565,14566,14568,14577,
                                                                                                  14579,14595,14603,14604,14630,1463
                                                                                                  2,14633,14645,14647,14648,14695,14
                                                                                                  696,14698,14712,14713,14715,14729,
                                                                                                  14731,14915                       
 NDIM                       Param  14003    I(4)            4           scalar                    14014,14015,14035,14350,14365,1437
                                                                                                  9,14390,14398,14412,14423,14431,14
                                                                                                  530,14532,14546,14552,14564,14576,
                                                                                                  14587,14590,14694,14711,14728     
 NFIX0                      Scalar 14023    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  14005    I(4)            4           scalar                    14021,14022                       
 NINT                       Func   14447                                scalar                    14447,14871                       
 NXX                        Scalar 14014    I(4)            4           scalar   COM              14351,14366,14380,14391,14399,1441
                                                                                                  3,14424,14432,14445,14533,14553,14
                                                                                                  565,14577,14595,14630,14645,14695,
                                                                                                  14712,14729                       
 OMEG                       Local  14129    R(4)            4           scalar   SAVE             14129                             
 OUTSDR                     Subr   14677                                                                                            
 OUTVAR                     Subr   14315                                                                                            
 PERHKM                     Local  14352    R(4)            4           scalar   SAVE             14352,14354                       
 PLEV                       Scalar 14024    R(4)            4     1     8        COM              14447,14448,14450,14871,14872,1487
                                                                                                  4                                 
 PRES                       Common 14024                                72       SAVE                                               
 PRT7KM                     Local  14696    R(4)            4           scalar   SAVE             14696,14698,14713,14715           
 QS                         Local  14448    R(4)            4           scalar   SAVE             14448,14450,14452,14872,14874,1487
                                                                                                  6                                 
 QSATI                      Func   14450    R(4)            4           scalar                    14450,14874                       

Page 407         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 QSATW                      Func   14448    R(4)            4           scalar                    14448,14872                       
 RADF                       Local  14128    R(4)            4           scalar   SAVE             14128,14352,14368,14401,14434,1459
                                                                                                  4,14696,14713,14731,14836,14842,14
                                                                                                  852,14862,14904                   
 RADFSQ                     Local  14594    R(4)            4           scalar   SAVE             14594,14604,14633,14648           
 RAVGW                      Common 14025                                160      SAVE                                               
 RESAVG                     Scalar 14025    R(4)            4     1     40       COM              14647,14648                       
 RHANL                      Scalar 14024    L(4)            4           scalar   COM              14247,14273                       
 S2DTPT                     Common 14012                                160084   SAVE                                               
 S2KOMP                     Common 14019                                7844     SAVE                                               
 S2NODE                     Common 14014                                716      SAVE                                               
 SCLF                       Dummy  14001    CHAR            2           scalar   ARG,INOUT        14295                             
 SDDXXV                     Local  14891    R(4)            4           scalar   SAVE             14891,14902                       
 SDDXYU                     Local  14897    R(4)            4           scalar   SAVE             14897,14902                       
 SDDXYV                     Local  14896    R(4)            4           scalar   SAVE             14896,14903                       
 SDDYYU                     Local  14892    R(4)            4           scalar   SAVE             14892,14904                       
 SECVAR                     Dummy  14000    L(4)            4           scalar   ARG,INOUT        14759,14769                       
 SINY                       Local  14881    R(4)            4           scalar   SAVE             14881,14902,14903                 
 SINYN                      Local  14381    R(4)            4           scalar   SAVE             14381,14383,14414,14416,14534,1453
                                                                                                  5,14537,14538,14566,14568         
 SLINTD                     Subr   14346                                                          14346,14361,14375,14386,14396,1440
                                                                                                  8,14419,14429,14529,14531,14544,14
                                                                                                  550,14562,14574,14588,14690,14707,
                                                                                                  14724                             
 SLINTO                     Subr   14350                                                          14350,14365,14379,14390,14398,1441
                                                                                                  2,14423,14431,14530,14532,14546,14
                                                                                                  552,14564,14576,14587,14590,14694,
                                                                                                  14711,14728                       
 SLINTS                     Subr   14387                                                          14387,14397,14420,14430,14545,1455
                                                                                                  1,14563,14575,14586,14589         
 SPDDXX                     Subr   14891                                                          14891                             
 SPDDXY                     Subr   14897                                                          14897                             
 SPDDYY                     Subr   14892                                                          14892                             
 SPDXU                      Local  14889    R(4)            4           scalar   SAVE             14889,14902                       
 SPDXV                      Local  14888    R(4)            4           scalar   SAVE             14888,14903                       
 SPDYU                      Local  14890    R(4)            4           scalar   SAVE             14890,14903                       
 SPOTDX                     Subr   14835                                                          14835,14848,14858,14889           
 SPOTDY                     Subr   14841                                                          14841,14849,14859,14890           
 SPTINO                     Subr   14793                                                          14793,14794,14813,14847,14857,1486
                                                                                                  7,14868,14882,14883               
 SPTVAR                     Subr   14753                                                                                            
 SPU                        Local  14882    R(4)            4           scalar   SAVE             14882,14899,14902,14903           
 SPV                        Local  14883    R(4)            4           scalar   SAVE             14883,14900,14903                 
 SPVAL                      Dummy  14001    R(4)            4     1     160      ARG,INOUT        14802,14805,14814,14836,14842,1485
                                                                                                  1,14861,14876,14902               
 SPZ                        Local  14813    R(4)            4           scalar   SAVE             14813,14814,14835,14836,14841,1484
                                                                                                  2                                 
 SPZDXU                     Local  14848    R(4)            4           scalar   SAVE             14848,14851                       
 SPZDXV                     Local  14858    R(4)            4           scalar   SAVE             14858,14861                       
 SPZDYU                     Local  14859    R(4)            4           scalar   SAVE             14859,14861                       
 SPZDYV                     Local  14849    R(4)            4           scalar   SAVE             14849,14851                       
 SPZQ                       Local  14868    R(4)            4           scalar   SAVE             14868,14870,14876                 
 SPZT                       Local  14867    R(4)            4           scalar   SAVE             14867,14869,14872,14874           
 SPZU                       Local  14793    R(4)            4           scalar   SAVE             14793,14795,14797,14802,14857,1486
                                                                                                  0,14861                           

Page 408         Source Listing                  YDTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SPZV                       Local  14794    R(4)            4           scalar   SAVE             14794,14796,14797,14805,14847,1485
                                                                                                  0,14851                           
 SQRT                       Func   14381                                scalar                    14381,14414,14534,14566,14851,1486
                                                                                                  1,14881                           
 STEXTV                     Subr   14307                                                                                            
 USTM                       Dummy  13999    R(4)            4           scalar   ARG,INOUT        14164                             
 UTC0                       Scalar 14023    R(4)            4           scalar   COM                                                
 UTCOB                      Scalar 14021    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 14022    R(4)            4     1     20       COM                                                
 UVFLG                      Local  14043    L(4)            4           scalar   SAVE             14757,14801,14803,14806           
 UVSTM                      Local  14037    R(4)            4     1     2        SAVE             14164,14165,14229                 
 VFIND                      Subr   14347                                                          14347,14362,14376,14388,14409,1442
                                                                                                  1,14441,14442,14519,14520,14626,14
                                                                                                  627,14691,14708,14725,14790,14791,
                                                                                                  14812,14826,14827                 
 VSTM                       Dummy  13999    R(4)            4           scalar   ARG,INOUT        14165                             
 WD                         Scalar 14012    R(4)            4     1     8000     COM                                                
 WDWS                       Subr   14797                                                          14797                             
 WSTM                       Scalar 14022    R(4)            4     1     20       COM                                                
 XBF                        Subr   14032                                scalar                    14361,14375,14396,14408,14429,1453
                                                                                                  1,14562,14588,14724               
 XD                         Scalar 14012    R(4)            4     1     8000     COM                                                
 XDATR                      Subr   14146                                                                                            
 XM                         Scalar 14014    R(4)            4     1     35       COM                                                
 XMC                        Scalar 14014    R(4)            4     1     35       COM                                                
 XSTM                       Scalar 14021    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 14023    R(4)            4           scalar   COM                                                
 XYT                        Common 14021                                64432    SAVE                                               
 XZ                         Dummy  14000    R(4)            4           scalar   ARG,INOUT        14793,14794,14813,14835,14841,1484
                                                                                                  7,14848,14849,14857,14858,14859,14
                                                                                                  867,14868,14882,14883,14889,14890,
                                                                                                  14891,14892,14897                 
 YBF                        Subr   14032                                scalar                    14346,14375,14386,14408,14419,1452
                                                                                                  9,14531,14544,14550,14707         
 YD                         Scalar 14012    R(4)            4     1     8000     COM                                                
 YDTSUB                     Subr   13999                                                                                            
 YN                         Scalar 14014    R(4)            4     1     35       COM                                                
 YNC                        Scalar 14015    R(4)            4     1     35       COM                                                
 YSTM                       Scalar 14021    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 14023    R(4)            4           scalar   COM                                                
 YZ                         Dummy  14000    R(4)            4           scalar   ARG,INOUT        14793,14794,14813,14819,14835,1484
                                                                                                  1,14847,14848,14849,14857,14858,14
                                                                                                  859,14867,14868,14882,14883,14889,
                                                                                                  14890,14891,14892,14897           

Page 409         Source Listing                  YDTSUB
2017-04-18 11:09                                 syndata.f

  14951 
  14952 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  14953 C                .      .    .                                       .
  14954 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  14955 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  14956 C
  14957 C ABSTRACT: ??????????????????????????????????????????????????????????
  14958 C   ??????????????????????????????????????????????????????????????????
  14959 C
  14960 C PROGRAM HISTORY LOG:
  14961 C ????-??-??  S. J. LORD
  14962 C
  14963 C USAGE:    CALL ????????(????)
  14964 C   INPUT ARGUMENT LIST:
  14965 C     ??????   - ???????????????????????????????????????????????
  14966 C
  14967 C   OUTPUT ARGUMENT LIST:
  14968 C     ??????   - ???????????????????????????????????????????????
  14969 C
  14970 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  14971 C     ??????   - ???????????????????????????????????????????????
  14972 C
  14973 C   OUTPUT FILES:
  14974 C     ??????   - ???????????????????????????????????????????????
  14975 C
  14976 C REMARKS: ?????????????????????????????????????????????????????
  14977 C
  14978 C ATTRIBUTES:
  14979 C   LANGUAGE: FORTRAN 90
  14980 C   MACHINE:  NCEP WCOSS
  14981 C
  14982 C$$$
  14983       SUBROUTINE DIFSUB(KPLV,A,KDAT,WRDSTT,KDXZ,DPRX,NSTICK,KLSTIK,
  14984      1                  DATAFT,UVSAVE,PRDATA,KP1,KP2,IHOLE,KDXX,XZ,YZ,
  14985      2                  ISPTYP,DXSPD,DYSPD,NSWLN,PRTBOG,STMNAM)
  14986 C
  14987       PARAMETER (MDIM=35,NDIM=35)
  14988       PARAMETER (LDXDIM=8000)
  14989       PARAMETER (NFXDIM=20,NTPDIM=30)
  14990       PARAMETER (KLDIM= 8)
  14991       PARAMETER(KVDIM=20,KDTDIM=5)
  14992 C**SGI      PARAMETER(KVDIM= 7,KDTDIM=5)
  14993       PARAMETER (KPXDIM=KVDIM*KLDIM)
  14994       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  14995       PARAMETER (MXDDIM=70,NYDDIM=70)
  14996       PARAMETER (LDWDIM=1)
  14997       PARAMETER (NHLDIM=2)
  14998 C
  14999 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  15000 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  15001       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  15002      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  15003       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  15004      1               ID(LDXDIM),LXSORT(LDXDIM)
  15005       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  15006      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,
  15007      2            MSKD14,MSKD15,MSKD16,MSKD17,MSKD18

Page 410         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15008       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  15009      1                 DMEAN(KDTDIM*KLDIM)
  15010       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  15011      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),
  15012      2            ELORG,GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  15013       COMMON /DWATE/ WDR(NTPDIM),JSKEEM(NTPDIM),IDTYP(100),JDTYP(NTPDIM)
  15014       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  15015 C
  15016 C     NOTE: SPACE FOR THE 1000 MB DATA MUST BE CREATED BY DIMENSIONING
  15017 C           FEXTD(KLDIM+1....)
  15018 C
  15019       DOUBLE PRECISION FEXTD(KLDIM+1,KDTDIM,LDWDIM)
  15020       LOGICAL KPLV(KLDIM,KVDIM),RHANL,IHOLE,PRTBOG,DATAFT,UVSAVE,WRDSTT,
  15021      1        MAXFND,PRDATA,SECVAR
  15022       LOGICAL INTQF
  15023 C
  15024       CHARACTER IDSPC*125,IDSPD1*8,IDSPD2*72,IDSPK*40,IDSPKZ*40,FLAGZ*1,
  15025      1          STMNAM*12
  15026       CHARACTER*1 IMAXMN,IMORE
  15027 CIBM  CHARACTER ZTIME*8,ZDATE*9
  15028 C
  15029       SAVE
  15030 C
  15031       DIMENSION A(KDXDIM,MDIM,NDIM),FDD(LDXDIM),
  15032      1          FDDX(LDXDIM),FDDZ(KDTDIM,LDWDIM),LDW(LDXDIM),
  15033      2          XDSPD(MXDDIM),YDSPD(NYDDIM),DATA(KDTDIM),DATAX(KDTDIM),
  15034      3          NDR(LDWDIM),XHOLMN(NHLDIM),XHOLMX(NHLDIM),
  15035      4          YHOLMN(NHLDIM),YHOLMX(NHLDIM),RMS(NTPDIM),
  15036      5          NRMS(NTPDIM),DSPOT(KPXDIM),KLSTIK(KLDIM),
  15037      6          XDZ(LDWDIM),YDZ(LDWDIM),LDWZ(LDWDIM),SAVUVA(LDXDIM,2),
  15038      7          RMEAN(NTPDIM),SKWVAL(5,19),FLAGZ(KDTDIM)
  15039 C
  15040       NAMELIST/HOLE/XHOLMN,XHOLMX,YHOLMN,YHOLMX,NHOLE
  15041 C
  15042       DATA FLAGZ/KDTDIM*'0'/,MDUM/0/
  15043       DATA IUNTQF/18/,IUNTQL/19/,INTQF/.FALSE./,RMISS/-99.0/
  15044 C
  15045 C-----------------------------------------------------------------------
  15046 
  15047       ENTRY STICKD(KPLV,A,KDAT,KDXZ,DPRX,NSTICK,KLSTIK,DATAFT,UVSAVE,
  15048      1             WRDSTT,PRDATA)
  15049 C
  15050 C     ENTRY STICKD SERVES TWO PURPOSES: THE BRANCH IS CONTROLLED BY
  15051 C         DATAFT
  15052 C         DATAFT=.FALSE.:   STICKD FINDS VALUE OF SPLINE-INTERPOLATED FI
  15053 C                           AT A GIVEN X-Y LOCATION IN THE DOMAIN AND ST
  15054 C                           THAT VALUE ON DISK.
  15055 C         DATAFT=.TRUE.:   STICKD COMPUTES DIFFERENCE BETWEEN EXTERNALLY
  15056 C                          DEFINED DATA (READ FROM MSKDA8) AND THE SPLIN
  15057 C                          FIELD.
  15058 C
  15059 C     NSTICK IS THE NUMBER OF LEVELS AT WHICH THE SPLINE-FIELD VALUES
  15060 C       ARE TO BE FOUND.
  15061 C     KLSTIK CONTAINS THE ANALYSIS LEVELS (NSTICK VALUES).
  15062 C
  15063       OPEN(UNIT=MSKDA8,FILE='STKDATI',ACCESS='SEQUENTIAL',
  15064 CVAX 1     FORM='UNFORMATTED',READONLY,SHARED)

Page 411         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15065 CIBM 1     FORM='UNFORMATTED',ACTION='READ')
  15066      1     STATUS='UNKNOWN',FORM='UNFORMATTED')
  15067 C
  15068 C     CHECK HEAD RECORDS TO MAKE SURE GEOMETRY MATCHES
  15069 C
  15070       CALL HEDCHK(MSKDA8)
  15071 C
  15072       LDXZ=1
  15073 C
  15074       FEXTD=RMISS
  15075 C
  15076   310 READ(MSKDA8,END=320) LDWZ(LDXZ),NDR(LDXZ),IDAYX,UTCX,YDZ(LDXZ),
  15077      1                     XDZ(LDXZ),YX,XX,KDS,KDF
  15078       IF(PRDATA)  WRITE(6,311)LDWZ(LDXZ),NDR(LDXZ),IDAYX,UTCX,YDZ(LDXZ),
  15079      1                         XDZ(LDXZ),YX,XX
  15080   311 FORMAT('***** WPROC DATA LOCATION PT.#',I5,4X,I4,1X,I9,
  15081      1        1X,F5.0,4F6.1)
  15082 C
  15083       DO ND=1,NDR(LDXZ)
  15084       READ(MSKDA8)  (FEXTD(ND,KD,LDXZ),KD=KDS,KDF)
  15085       ENDDO
  15086 C
  15087       LDXZ=LDXZ+1
  15088       IF(LDXZ .GT. LDWDIM)  GO TO 993
  15089       GO TO 310
  15090 C
  15091   320 LDXZ=LDXZ-1
  15092 C
  15093 C     LEVEL BY LEVEL, REMOVE ALL DATA POINTS NOT IN THE DOMAIN AND,
  15094 C     FOR THE DATAFT OPTION, REMOVE ALL DATA NOT AT THE LEVEL IN
  15095 C     QUESTION.
  15096 C
  15097       DO 400 KLSTK=1,NSTICK
  15098       KLZ=KLSTIK(KLSTK)
  15099       LDXX=0
  15100       DO 360 LD=1,LDXZ
  15101       CALL DOMCHK(XDZ(LD),YDZ(LD),IN)
  15102       IF(IN .EQ. 0)  GO TO 360
  15103 C
  15104       IF(.NOT. DATAFT)   GO TO 350
  15105 C
  15106 C     DATAFT .EQ. .TRUE. OPTION
  15107 C       SIFT THROUGH AVAILABLE DATA FOR EACH POINT TO PICK UP DATA AT TH
  15108 C       RIGHT LEVEL
  15109 C     IMPORTANT NOTE:  THERE IS A LIMITATION TO THE SIFTING TECHNIQUE AS
  15110 C                      CODED HERE:  ONLY A SINGLE OBSERVATION AT A GIVEN
  15111 C                      LOCATION WILL BE FOUND.  IF THERE ARE MULTIPLE
  15112 C                      OBSERVATIONS WITHIN THE PRESSURE WINDOW (DPRX), O
  15113 C                      SEVERAL DIFFERENT DATA TYPES, THE CODE WILL CHOSE
  15114 C                      ONLY THE FIRST AND IGNORE THE REST.  THESE CASES
  15115 C               OCCUR VERY INFREQUENTLY.    *******
  15116 C
  15117       DO 330 ND=1,NDR(LD)
  15118       NDZ=ND
  15119       CALL UPKPRW(FEXTD(ND,KDS,LD),UVX,PRX,WX)
  15120       IF(ABS(PRX-PLEV(KLZ)) .LE. DPRX)  GO TO 340
  15121   330 CONTINUE

Page 412         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15122       GO TO 360
  15123 C
  15124   340 FDDZ(KDS,LDXX+1)=UVX
  15125       IF(KDS+1 .GT. KDF)  GO TO 350
  15126       DO KD=KDS+1,KDF
  15127       CALL UPKPRW(FEXTD(NDZ,KD,LD),UVX,PRX,WX)
  15128       FDDZ(KD,LDXX+1)=UVX
  15129       ENDDO
  15130 C
  15131   350 LDXX=LDXX+1
  15132       if(LDXX .GT. LDXDIM)  THEN
  15133          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  15134      $    'LDXX=',LDXX,', return'
  15135          return
  15136       endif
  15137       XD(LDXX)=XDZ(LD)
  15138       YD(LDXX)=YDZ(LD)
  15139       ID(LDXX)=WX
  15140       LDW(LDXX)=LDWZ(LD)
  15141 C
  15142 c && 3 comments
  15143 CC    WRITE(6,359)  LDXX,XD(LDXX),YD(LDXX),LDW(LDXX)
  15144 CC359 FORMAT(5X,'DATA POINT #',I5,' AT XD=',F6.1,', YD=',F6.1,
  15145 CC   1' IN REGION...WPROC #',I5)
  15146   360 CONTINUE
  15147       LDX=LDXX
  15148 C
  15149 CIBM  WRITE(1,366) LDX,KLZ
  15150 C 366 FORMAT(/'...DATA DIFFERENCE POINTS FOUND, LDX=',I6,' AT LEVEL',
  15151 C    1       I3)
  15152 C
  15153       CALL PRDLOC(0)
  15154 C
  15155 C     WRITE HEAD RECORD FOR STICK DATA FILE OR DATAFT FILE
  15156 C
  15157       IF(DATAFT)   THEN
  15158       CALL OUTDV1(MSKDA9,'STKDATO')
  15159       IF(WRDSTT)   CALL OUTST1
  15160       ELSE
  15161       WRITE(MSKDA9) LDX,LDW
  15162       ENDIF
  15163 C
  15164       DO 390 KD=1,KDAT+1
  15165       NV=KD
  15166       IF(.NOT. KPLV(KLZ,KD))  GO TO 390
  15167       KUV=1
  15168       IF(KD .EQ. KDAT)  KUV=2
  15169       IF(KD .LE. KDAT)  THEN
  15170 C
  15171       CALL VFIND(KDXZ,NV,KLZ,KF)
  15172       IF(KF .LT. 0)  GO TO 980
  15173 C
  15174 C     ZERO RMS STORAGE
  15175 C
  15176       RMS=0.0
  15177       NRMS=0
  15178       RMEAN=0.0

Page 413         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15179 C
  15180       DO 380 LD=1,LDX
  15181 C
  15182       CALL SPTINO(XD(LD),YD(LD),A,KF,KF,SPLD)
  15183 C
  15184 C     DON'T FORGET TO ADD IN THE MEAN VALUE TO ALL SPOT CALCULATIONS
  15185 C
  15186       FDDX(LD)=SPLD+DMEAN(KF)
  15187       FDD(LD)=SPLD+DMEAN(KF)
  15188 C
  15189       IF(.NOT. DATAFT)   GO TO 380
  15190       FDD(LD)=FDDZ(KD,LD)-(SPLD+DMEAN(KF))
  15191       SAVUVA(LD,KUV)=FDDX(LD)
  15192       ITYP=IDTYP(ID(LD))
  15193       IF(ITYP .EQ. 0 .OR. ITYP .GT. NTPDIM)  GO TO 998
  15194       RMS(ITYP)=RMS(ITYP)+FDD(LD)**2
  15195       NRMS(ITYP)=NRMS(ITYP)+1
  15196       RMEAN(ITYP)=RMEAN(ITYP)+FDD(LD)
  15197 C
  15198   380 CONTINUE
  15199 C
  15200 C     CURRENTLY ONLY SUMMARY PRINTOUT OF DEVIATIONS IS MADE
  15201 C
  15202       DO 385 NTP=1,NTPDIM
  15203       IF(NRMS(NTP) .EQ. 0)  GO TO 385
  15204       RMS(NTP)=SQRT(RMS(NTP)/REAL(NRMS(NTP)))
  15205       RMEAN(NTP)=RMEAN(NTP)/REAL(NRMS(NTP))
  15206       WRITE(6,384)  NV,KLZ,JDTYP(NTP),RMEAN(NTP),RMS(NTP),NRMS(NTP)
  15207   384 FORMAT('...NV=',I2,', LEVEL=',I2,', DATA TYPE=',I3,
  15208      1       '...MEAN ERROR=',F7.2,'...RMS ERROR=',F7.2,', # PTS.=',I4)
  15209   385 CONTINUE
  15210 C
  15211       ENDIF
  15212 C
  15213       CALL DPREP(FDD,NV,LDX,1)
  15214 C
  15215 C
  15216 C     CALCULATE THE RMS AND MEAN DEVIATIONS IN TERMS OF WIND SPEED & DIR
  15217 C
  15218       IF(NV .EQ. KDAT+1 .AND. DATAFT)   THEN
  15219 C
  15220       DO 387 KKVAR=1,2
  15221 C
  15222 C         ZERO RMS AND MEAN STORAGE FOR EACH VARIABLE
  15223 C
  15224       RMEAN=0.
  15225       RMS=0.
  15226       NRMS=0
  15227 C
  15228       DO 3380 LD=1,LDX
  15229       IF(FDD(LD) .NE. -900.)  THEN
  15230       ITYP=IDTYP(ID(LD))
  15231       IF(ITYP .EQ. 0 .OR. ITYP .GT. NTPDIM)  GO TO 998
  15232       SPD100=REAL(IFIX(FDD(LD)))
  15233       SDDIRZ=SPD100*0.01
  15234 C
  15235       IF(KKVAR .EQ. 1)  THEN

Page 414         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15236       DIRDEV=(FDD(LD)-SPD100)*1000.-180.
  15237       DIRUV=ATAN2DEG(SAVUVA(LD,1),SAVUVA(LD,2))
  15238       SDDIRZ=DIRDEV-DIRUV
  15239 C fixit?? "DIR" is never initialized (give it value ZERO)
  15240       dir = 0.
  15241       IF(ABS(SDDIRZ) .GT. 180.) SDDIRZ=360.-SIGN(SDDIRZ,DIR)
  15242       ENDIF
  15243 C
  15244       RMEAN(ITYP)=RMEAN(ITYP)+SDDIRZ
  15245       RMS(ITYP)=RMS(ITYP)+SDDIRZ**2
  15246       NRMS(ITYP)=NRMS(ITYP)+1
  15247       ENDIF
  15248  3380 CONTINUE
  15249 C
  15250 C           CALCULATE RMS AND MEAN
  15251 C
  15252               DO 3385 NTP=1,NTPDIM
  15253                 IF(NRMS(NTP).NE.0)THEN
  15254                   RMS(NTP)=SQRT(RMS(NTP)/REAL(NRMS(NTP)))
  15255                   RMEAN(NTP)=RMEAN(NTP)/REAL(NRMS(NTP))
  15256       WRITE(6,3384)  NV,KKVAR,KLZ,JDTYP(NTP),RMEAN(NTP),RMS(NTP),
  15257      1               NRMS(NTP)
  15258  3384 FORMAT('...NV=',I2,' DIR/SPD=',I2,', LEVEL=',I2,
  15259      1       ', DATA TYPE=',I3,'...MEAN ERROR=',F7.2,'...RMS ERROR=',
  15260      2       F7.2,', # PTS.=',I4)
  15261                 ENDIF
  15262  3385         CONTINUE
  15263       IF(KKVAR .EQ. 1 .AND. WRDSTT)
  15264      1                           CALL OUTST2(NV,KLZ,NRMS,RMS,RMEAN)
  15265   387 CONTINUE
  15266       ENDIF
  15267 C
  15268 C     WRITE SPLINE-INTERPOLATED VALUES: STICK DATA OR DATAFT OPTIONS
  15269 C
  15270       NVZ=NV
  15271 C
  15272       IF(      DATAFT)   THEN
  15273       CALL OUTDV2(NVZ,KLZ,FDD)
  15274       IF(WRDSTT) CALL OUTST2(NVZ,KLZ,NRMS,RMS,RMEAN)
  15275       IF(UVSAVE) CALL OUTDV2(NVZ,KLZ,FDDX)
  15276       ELSE
  15277       CALL OUTSTK(KD,LDX,FDD,KLZ,LDW(LD))
  15278       ENDIF
  15279 C
  15280       print *, ' '
  15281       print *, ' '
  15282   390 CONTINUE
  15283       IF(KLSTK .EQ. NSTICK)  GO TO 400
  15284       CLOSE(UNIT=MSKDA9,STATUS='KEEP')
  15285       CALL OPNFIL(MSKDA9)
  15286   400 CONTINUE
  15287 C
  15288       CLOSE(UNIT=MSKDA9,STATUS='KEEP')
  15289       CLOSE(UNIT=MSKDA8,STATUS='KEEP')
  15290       RETURN
  15291 C
  15292 

Page 415         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15293 C-----------------------------------------------------------------------
  15294 
  15295       ENTRY SPTDAT(KP1,KP2,KPLV,A,KDAT,IHOLE,ISPTYP,DXSPD,DYSPD,NSWLN,
  15296      1             PRTBOG,STMNAM)
  15297 C
  15298 C     THIS ENTRY PICKS UP SAMPLE DATA AT ARBITRARY LAT./LONG. SPACING FR
  15299 C     WITHIN THE ENTIRE HORIZONTAL DOMAIN.
  15300 C        *****  NOTE:  THESE HOLE PARAMETERS ARE UPDATED IN IHOLE=.TRUE.
  15301 C                      AND ARE DESIGNED SO THAT THE HOLE-CATCHER BELOW I
  15302 C                      DEACTIVATED WHEN IHOLE=.FALSE.  *****
  15303 C
  15304       IF(NHOLE .GT. NHLDIM)   GO TO 995
  15305 C
  15306       XHOLMN=XML
  15307       XHOLMX=XMR
  15308       YHOLMN=YNT
  15309       YHOLMX=YNB
  15310 C
  15311 CIBM  IF(JPD .EQ. 1 .OR. (IDLEV(KP1) .EQ. KLDIM .AND. IDVAR(KP1)
  15312 CIBM 1   .EQ. 3))  CALL OPNFIL(MSKDA9)
  15313 CIBM  IF(JPD .NE. 1)  CALL ENDFIL(MSKDA9)
  15314 C
  15315 C     ***** IMPORTANT *****
  15316 C           THE PRESENT CONFIGURATION IS TO WRITE THE SAMPLED DATA
  15317 C           AS FORMATTED RECORDS
  15318 C
  15319 C
  15320       REWIND MSKDA9
  15321 C
  15322       WRITE(6,501) DXSPD,DYSPD
  15323   501 FORMAT('....SPOT DATA SAMPLER:  DXSPD=',F5.2,',  DYSPD=',F5.2)
  15324 C
  15325       IF(DXSPD .GT. 0)  THEN
  15326       NNX=INT((XMR-XML)/DXSPD)
  15327       XOFF=0.5*(XMR-XML-REAL(NNX)*DXSPD)
  15328       ELSE
  15329       NNX=0
  15330       XOFF=0.0
  15331       ENDIF
  15332 C
  15333       IF(DYSPD .GT. 0)  THEN
  15334       YOFF=0.5*(YNT-YNB-REAL(NNY)*DYSPD)
  15335       NNY=INT((YNT-YNB)/DYSPD)
  15336       ELSE
  15337       NNY=0
  15338       YOFF=0.0
  15339       ENDIF
  15340 C
  15341       XDSPD(1)=XML+XOFF
  15342       YDSPD(1)=YNB+YOFF
  15343       XSPD=XDSPD(1)
  15344       YSPD=YDSPD(1)
  15345       NSPD=1
  15346 C
  15347       WRITE(6,502) XSPD,YSPD,XOFF,YOFF,XML,YNB,NNX,NNY
  15348   502 FORMAT('....ANCHOR POINT IS:',F9.2,' LONG.,',F7.2,' LAT.',/,
  15349      1       5X,'XOFF,YOFF,XML,YNB,NNX,NNY=',4F10.3,2I5)

Page 416         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15350 C
  15351       IF(.NOT. IHOLE)  GO TO 510
  15352 C
  15353 c**sgiREAD(5,NML=HOLE)
  15354       READ(5,HOLE)
  15355       WRITE(6,HOLE)
  15356       WRITE(6,505) (NH,XHOLMN(NH),XHOLMX(NH),YHOLMN(NH),
  15357      1              YHOLMX(NH),NH=1,NHOLE)
  15358   505 FORMAT('....HOLE PARAMETERS: HOLE#',I2,'  XHOLMN=',F6.1,
  15359      1       '  XHOLMX=',F6.1,/,29X,'  YHOLMN=',F6.1,
  15360      2       '  YHOLMX=',F6.1)
  15361       DO 507 NH=1,NHOLE
  15362       XHOLMN(NH)=XHOLMN(NH)*REAL(-NSWLN)
  15363       XHOLMX(NH)=XHOLMX(NH)*REAL(-NSWLN)
  15364   507 CONTINUE
  15365 C
  15366   510 XSPD=XSPD+ABS(DXSPD)
  15367       IF(XSPD .GT. XMR)  GO TO 520
  15368       NSPD=NSPD+1
  15369       XDSPD(NSPD)=XSPD
  15370       GO TO 510
  15371 C
  15372   520 IF(NXSPD .GT. MXDDIM)  THEN
  15373       WRITE(6,521) NXSPD,MXDDIM
  15374   521 FORMAT('######INSUFFICIENT SPACE FOR SPOT SAMPLED POINTS,',
  15375      1       'NXSPD=',I4,' WHILE MXDDIM=',I4,/,7X,'NUMBER OF POINTS ',
  15376      2       'REDUCED.')
  15377       NSPD=MXDDIM
  15378       ENDIF
  15379       NXSPD=NSPD
  15380       NSPD=1
  15381   530 YSPD=YSPD+ABS(DYSPD)
  15382       IF(YSPD .GT. YNT)  GO TO 540
  15383       NSPD=NSPD+1
  15384       YDSPD(NSPD)=YSPD
  15385       GO TO 530
  15386 C
  15387   540 IF(NYSPD .GT. NYDDIM)  THEN
  15388       WRITE(6,541) NYSPD,NYDDIM
  15389   541 FORMAT('######INSUFFICIENT SPACE FOR SPOT SAMPLED POINTS,',
  15390      1       'NYSPD=',I4,' WHILE NYDDIM=',I4,/,7X,'NUMBER OF POINTS ',
  15391      2       'REDUCED.')
  15392       NSPD=NYDDIM
  15393       ENDIF
  15394       NYSPD=NSPD
  15395 C
  15396       WRITE(6,565)  ABS(DXSPD),ABS(DYSPD),NXSPD,NYSPD,IHOLE,
  15397      1              (NH,XHOLMN(NH),XHOLMX(NH),YHOLMN(NH),YHOLMX(NH),
  15398      2              NH=1,NHOLE)
  15399   565 FORMAT(/5X,'SAMPLE DATA WRITTEN:  DXSPD=',F5.2,'  DYSPD=',
  15400      1        F5.2,'  NXSPD=',I4,'  NYSPD=',I4,'  HOLE (',L1,')',/,
  15401      2        (30X,'HOLE#',I2,3X,'XHOLMN=',F6.1,'  XHOLMX=',F6.1,
  15402      3        '  YHOLMN=',F6.1,'  YHOLMX=',F6.1))
  15403       WRITE(6,566) MSKDA9
  15404   566 FORMAT(/'...WRITING SAMPLED DATA TO MSKDA9=',I3)
  15405 C
  15406       WRITE(MSKDA9,567) XDSPD(1),XDSPD(NXSPD),YDSPD(1),YDSPD(NYSPD),

Page 417         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15407      1                  ABS(DXSPD),ABS(DYSPD),STMNAM
  15408   567 FORMAT(6F10.3,1X,'''',A12,'''')
  15409 C
  15410       KL=IDLEV(KP1)
  15411       KPA=KP1
  15412 C
  15413       DO 700 KP=KP1,KP2
  15414       KPP=KP
  15415       IF(IDLEV(KP) .EQ. KL)  GO TO 660
  15416 C
  15417   600 KPB=KPP-1
  15418 C
  15419       DO NYD=1,NYSPD
  15420       DO NXD=1,NXSPD
  15421 C
  15422 C     HOLE CATCHER
  15423 C
  15424       DO 605 NH=1,NHOLE
  15425       IF(XDSPD(NXD) .GE. XHOLMN(NH) .AND. XDSPD(NXD) .LE. XHOLMX(NH)
  15426      1                               .AND.
  15427      2   YDSPD(NYD) .GE. YHOLMN(NH) .AND. YDSPD(NYD) .LE. YHOLMX(NH))
  15428      2   GO TO 650
  15429   605 CONTINUE
  15430 C
  15431       CALL SPTIKA(XDSPD(NXD)-ELORG,YDSPD(NYD)-GLORG,A,KPA,KPB,DATAX)
  15432 C
  15433       DATA(1:KDAT)=RMISS
  15434 
  15435       DO KF=1,KPB-KPA+1
  15436       KV=IDVAR(KF)
  15437       IF(KV .EQ. KVDIM)  KV=2
  15438       DATA(KV)=DATAX(KF)+DMEAN(KPA+KF-1)
  15439       ENDDO
  15440       PR=PLEV(KL)
  15441       CALL OUTREC(PR,DATA)
  15442 C
  15443       NNSWLN=-NSWLN
  15444       XDSPDZ=REAL(NNSWLN)*XDSPD(NXD)
  15445       IF(PRTBOG)  WRITE(6,611) ISPTYP,JDAY0,IFIX(UTC0),YDSPD(NYD),
  15446      1             XDSPDZ,PR,(DATA(KD),KD=1,KDAT)
  15447       WRITE(MSKDA9,612) ISPTYP,JDAY0,IFIX(UTC0),YDSPD(NYD),XDSPDZ,
  15448      1                  PR,(DATA(KD),KD=1,KDAT)
  15449   611 FORMAT(1X,I2,1X,I9,1X,I4,1X,2(F7.3,1X),3(F6.1,1X),F7.1,
  15450      1       2(F6.1,1X))
  15451   612 FORMAT(I2,1X,I9,1X,I4,1X,2(F7.3,1X),3(F6.1,1X),F7.1,
  15452      1       2(F6.1,1X))
  15453 C
  15454 C     WRITE(MSKDA9)  REAL(ISPTYP),JDAY0,UTC0,YDSPD(NYD),XDSPDZ,
  15455 C    1               PR,DATA,(FLAGZ(KFL),KFL=1,KDTDIM-1)
  15456   650 CONTINUE
  15457       ENDDO
  15458       ENDDO
  15459       KPA=KP
  15460       KL=IDLEV(KP)
  15461       GO TO 700
  15462   660 IF(KP .NE. KP2)  GO TO 700
  15463       KPP=KP2+1

Page 418         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15464       GO TO 600
  15465   700 CONTINUE
  15466 C
  15467       CLOSE(UNIT=MSKDA9,STATUS='KEEP')
  15468       RETURN
  15469 C
  15470 
  15471 C-----------------------------------------------------------------------
  15472 
  15473       ENTRY SPTLOC(A,KDXX,XZ,YZ,NSWLN)
  15474 C
  15475 C     THIS IS AN INTERACTIVE ENTRY TO PICK UP SPOT VALUES AT SPECIFIED
  15476 C     LOCATIONS FOR ANY ANALYZED DATA VARIABLE WITHIN THE DOMAIN.
  15477 C     DEFAULT INITIAL LOCATION IS THE STORM FIX POSITION.
  15478 C
  15479 C     WRITE HEADER INTO SKWT FILE AND CLEAR THE VALUES IN SKWVAL
  15480 C     OR TYPE OUT AVAILABLE DATA GROUPS AND CHOOSE DESIRED VARIABLES
  15481 C
  15482       WRITE(6,800)
  15483   800 FORMAT(//5X,'INTERACTIVE QUERY FOR POINT VALUES.')
  15484       WRITE(2,*)' ...INTERACTIVE QUERY FOR POINT VALUES.  AVAILABLE',
  15485      1          ' DATA ARE:'
  15486       WRITE(2,801)
  15487   805 DO 810 KD=1,KDXX
  15488         WRITE(2,811) KD,IDLEV(KD),IDSPK(KD)
  15489   810 CONTINUE
  15490       WRITE(2,*)' ...PLEASE ENTER VARIABLE NUMBER AND NUMBER OF',
  15491      1          ' VARIABLES, (KDZ,KDZX)'
  15492       WRITE(2,*)'    (ENTER NUMBER GREATER THAN LAST VARIABLE TO',
  15493      1          '  CALCULATE A SECONDARY VARIABLE)'
  15494       READ(3,*) KDZ,KDZX
  15495       IF(KDZ.LE.KDXX)THEN
  15496         SECVAR=.FALSE.
  15497         KDZ1=KDZ
  15498         KDZ2=KDZ+KDZX-1
  15499         KDZZ1=KDZ1
  15500         KDZZ2=KDZ2
  15501         KVZ1=KDZ1
  15502         KLZ1=KDZ2
  15503       ELSE
  15504         SECVAR=.TRUE.
  15505         KDZZ1=KDXX+1
  15506         KDZZ2=KDXX+1
  15507         WRITE(2,*)' ...ENTER VARIABLE AND LEVEL (KVZ,KLZ)'
  15508         READ(3,*) KDZ1,KDZ2
  15509         KVZ1=KDZ1
  15510         KLZ1=KDZ2
  15511       ENDIF
  15512 C
  15513 C     ENTER LOCATION OF THE DESIRED POINT AND MAKE SURE XSPOT IS IN THE
  15514 C     CORRECT HEMISPHERE
  15515 C
  15516   813 WRITE(2,*)' ...ENTER X-Y COORDINATE (LAT.,LONG.) OR'
  15517       WRITE(2,*)'    (-99.0,-99.0) FOR DEFAULT (STORM FIX LOCATION).'
  15518       WRITE(2,*)'    LONGITUDE IS POSITIVE IN THE WESTERN HEMISPHERE.'
  15519       READ(3,*)  YSPOT,XSPOT
  15520 C

Page 419         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15521 C     CALCULATE DISTANCE OF SPOT FROM (ELORG,GLORG) IF SPOT IS NOT
  15522 C       STORMFIX, MAKE SURE THE DESIRED POINT IS WITHIN THE DOMAIN
  15523 C
  15524       IF(YSPOT .NE. RMISS) THEN
  15525         XSPOT=XSPOT*(-NSWLN)
  15526         IF(YSPOT.LT.YNB.OR.YSPOT.GT.YNT.OR.XSPOT.LT.XML.OR.XSPOT.GT.
  15527      1     XMR)THEN
  15528           WRITE(2,*)' THE CHOSEN LOCATION IS NOT WITHIN THE DOMAIN.'
  15529           GOTO 813
  15530         ENDIF
  15531         XZ=XSPOT-ELORG
  15532         YZ=YSPOT-GLORG
  15533       ENDIF
  15534 C
  15535 C     CALCULATE AND PRINT THE SPOT VALUE
  15536 C
  15537       CALL SPTVAR(SECVAR,XZ,YZ,A,KDZ1,KDZ2,DSPOT)
  15538       WRITE(2,814)  GLORG+YZ,ELORG+XZ
  15539       WRITE(6,814)  GLORG+YZ,ELORG+XZ
  15540       DO 8818 KZZ=KDZ1,KDZ2
  15541       IDSPKZ=IDSPK(KZZ)
  15542       IF(IDVAR(KZZ) .EQ. 4) IDSPKZ(9:40)='WIND SPEED'
  15543       IF(IDVAR(KZZ) .EQ. 5) IDSPKZ(9:40)='WIND DIRECTION'
  15544       WRITE(2,815)  IDSPKZ,DSPOT(KZZ)
  15545       WRITE(6,815)  IDSPKZ,DSPOT(KZZ)
  15546  8818 CONTINUE
  15547 C
  15548 C     ASK FOR OTHER VARIABLES OTHER LOCATIONS OR QUIT
  15549 C     WRITE VALUES FOR CURRENT LOCATION TO MSKD17 IF NEW LOCATION IS REQ
  15550 C
  15551  816  WRITE(2,*)' ...NEW VARIABLE (V), NEW LOCATION (L), OR QUIT (Q)?'
  15552       READ(3,'(A1)') IMORE
  15553       IF(IMORE.EQ.'Q' .OR. IMORE .EQ. 'Q')THEN
  15554         RETURN
  15555       ENDIF
  15556       IF(IMORE .EQ. 'V' .OR. IMORE .EQ. 'V')  THEN
  15557         GOTO 805
  15558       ENDIF
  15559       KDZ1=KVZ1
  15560       KDZ2=KLZ1
  15561       IF(IMORE .EQ. 'L' .OR. IMORE .EQ. 'L')  THEN
  15562         GOTO 813
  15563       ELSE
  15564         GOTO 816
  15565       ENDIF
  15566 C
  15567   801 FORMAT('    KD',3X,'LEVEL',8X,'VARIABLE')
  15568   811 FORMAT(I6,3X,I3,2X,A40)
  15569   814 FORMAT('...AT LATITUDE',F8.3,' AND LONGITUDE',F8.3,'...')
  15570   815 FORMAT(10X,A40,'=',F9.2)
  15571 C
  15572 
  15573 C-----------------------------------------------------------------------
  15574 
  15575       ENTRY SPSKWT(A,KDXX,XZ,YZ,NSWLN)
  15576 C
  15577 C     THIS IS AN INTERACTIVE ENTRY TO PICK UP SPOT VALUES AT SPECIFIED

Page 420         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15578 C     LOCATIONS FOR ANY ANALYZED DATA VARIABLE WITHIN THE DOMAIN.
  15579 C     DEFAULT INITIAL LOCATION IS THE STORM FIX POSITION.
  15580 C
  15581 C     WRITE HEADER INTO SKWT FILE AND CLEAR THE VALUES IN SKWVAL
  15582 C     OR TYPE OUT AVAILABLE DATA GROUPS AND CHOOSE DESIRED VARIABLES
  15583 C
  15584       CALL OUTDV1(MSKD17,'SKWT')
  15585       DO 2803 II=2,5
  15586         DO 2804 III=1,19
  15587           SKWVAL(II,III)=-99.
  15588           IF(II.EQ.2)THEN
  15589             SKWVAL(1,III)=1050-III*50
  15590           ENDIF
  15591  2804   CONTINUE
  15592  2803 CONTINUE
  15593       SECVAR=.FALSE.
  15594       KDZ=1
  15595       KDZX=KDXX
  15596       KDZ1=KDZ
  15597       KDZ2=KDZ+KDZX-1
  15598       KDZZ1=KDZ1
  15599       KDZZ2=KDZ2
  15600       KVZ1=KDZ1
  15601       KLZ1=KDZ2
  15602 C
  15603 C     ENTER LOCATION OF THE DESIRED POINT AND MAKE SURE XSPOT IS IN THE
  15604 C     CORRECT HEMISPHERE
  15605 C
  15606  2813 WRITE(2,*)' ...ENTER X-Y COORDINATE (LAT.,LONG.) OR'
  15607       WRITE(2,*)'    (-99.0,-99.0) FOR DEFAULT (STORM FIX LOCATION).'
  15608       WRITE(2,*)'    LONGITUDE IS POSITIVE IN THE WESTERN HEMISPHERE.'
  15609       READ(3,*)  YSPOT,XSPOT
  15610 C
  15611 C     CALCULATE DISTANCE OF SPOT FROM ELORG,GLORG IF SPOT IS NOT STORMFI
  15612 C       MAKE SURE THE DESIRED POINT IS WITHIN THE DOMAIN
  15613 C
  15614       IF(YSPOT .NE. RMISS) THEN
  15615         XSPOT=XSPOT*(-NSWLN)
  15616         IF(YSPOT.LT.YNB.OR.YSPOT.GT.YNT.OR.XSPOT.LT.XML.OR.XSPOT.GT.
  15617      1     XMR)THEN
  15618           WRITE(2,*)' THE CHOSEN LOCATION IS NOT WITHIN THE DOMAIN.'
  15619           GOTO 2813
  15620         ENDIF
  15621         XZ=XSPOT-ELORG
  15622         YZ=YSPOT-GLORG
  15623       ENDIF
  15624 C
  15625 C     CALCULATE AND PRINT THE SPOT VALUE
  15626 C
  15627       CALL SPTVAR(SECVAR,XZ,YZ,A,KDZ1,KDZ2,DSPOT)
  15628       WRITE(2,2814)  GLORG+YZ,ELORG+XZ
  15629       DO 1817 KD=KDZZ1,KDZZ2
  15630         IDSPKZ=IDSPK(KD)
  15631         WRITE(2,*)' IDSPK=',IDSPKZ
  15632         IF(IDSPKZ(2:4).EQ.'URF')THEN
  15633           NPSAVE=1
  15634         ELSE

Page 421         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15635           READ(IDSPKZ(2:4),'(I3)')IDPRES
  15636           DO 2817 IKD=1,18
  15637             IF(IDPRES*10 .EQ. NINT(PLEV(IKD)*10.))  THEN
  15638               NPSAVE=20-IKD
  15639             ENDIF
  15640  2817     CONTINUE
  15641         ENDIF
  15642         IF(IDSPKZ(9:19).EQ.'U COMPONENT')THEN
  15643           SKWVAL(5,NPSAVE)=DSPOT(KD)
  15644           WRITE(IDSPKZ(9:40),'(A)')'WIND SPEED  (M SEC**-1)         '
  15645         ELSEIF(IDSPKZ(9:19).EQ.'V COMPONENT')THEN
  15646           SKWVAL(4,NPSAVE)=DSPOT(KD)
  15647           WRITE(IDSPKZ(9:40),'(A)')'WIND DIRECTION (DEGREES)        '
  15648         ELSEIF(IDSPKZ(9:19).EQ.'TEMPERATURE')THEN
  15649           SKWVAL(2,NPSAVE)=DSPOT(KD)
  15650         ELSEIF(IDSPKZ(9:19).EQ.'RELATIVE HU')THEN
  15651           SKWVAL(3,NPSAVE)=DSPOT(KD)
  15652         ELSEIF(IDSPKZ(9:13).EQ.'PRESS')THEN
  15653           SKWVAL(1,NPSAVE)=DSPOT(KD)
  15654         ELSEIF(IDSPKZ(9:13).EQ.'GEOPO'.AND.NPSAVE.EQ.1)THEN
  15655           SKWVAL(1,NPSAVE)=DSPOT(KD)
  15656         ENDIF
  15657         WRITE(2,2815) IDSPKZ,DSPOT(KD)
  15658  1817 CONTINUE
  15659 C
  15660 C     ASK FOR OTHER VARIABLES OTHER LOCATIONS OR QUIT
  15661 C     WRITE VALUES FOR CURRENT LOCATION TO MSKD17 IF NEW LOCATION IS REQ
  15662 C
  15663  2816 WRITE(2,*)' ...NEW LOCATION (L) OR QUIT (Q)?'
  15664       READ(3,'(A1)') IMORE
  15665       NLEVEL=0
  15666       DO 2799 III=1,19
  15667         IF(SKWVAL(2,III).NE.-99.)THEN
  15668           NLEVEL=NLEVEL+1
  15669         ENDIF
  15670  2799 CONTINUE
  15671       WRITE(2,*)' NLEVEL=',NLEVEL
  15672       CALL OUTDV3(ELORG+XZ,GLORG+YZ,NLEVEL,SKWVAL)
  15673       IF(IMORE.EQ.'Q')THEN
  15674         RETURN
  15675       ENDIF
  15676 
  15677       SKWVAL(2:5,:)=-99.
  15678 
  15679       KDZ1=KVZ1
  15680       KDZ2=KLZ1
  15681       IF(IMORE .EQ. 'L' .OR. IMORE .EQ. 'L')THEN
  15682         GOTO 2813
  15683       ELSE
  15684         GOTO 2816
  15685       ENDIF
  15686 C
  15687 C     FORMAT STATEMENTS
  15688 C
  15689  2814 FORMAT('...AT LATITUDE',F8.3,' AND LONGITUDE',F8.3,'...')
  15690  2815 FORMAT(A40,'=',F9.2)
  15691 C

Page 422         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15692 
  15693 C-----------------------------------------------------------------------
  15694 
  15695       ENTRY SPTFND(A,KDXX,XZ,YZ,NSWLN)
  15696 C
  15697 C     THIS IS AN INTERACTIVE ENTRY TO FIND MAXIMUM OR MINIMUM VALUES
  15698 C     WITHIN A SPECIFIED SEARCH RADIUS OF ANY VARIABLE WITHIN THE
  15699 C     DOMAIN
  15700 C
  15701       IOPT=1
  15702       XZZ=XZ
  15703       YZZ=YZ
  15704       REWIND IUNTQL
  15705 
  15706       WRITE(6,1823)  INTQF,KDXX,XZ,YZ
  15707  1823 FORMAT(/'...ENTERING SPTFND WITH INTQF,KDXX,XZ,YZ=',L3,I4,2F10.3)
  15708 
  15709       KFLAG = 0
  15710  8350 CONTINUE
  15711       IF(INTQF.OR.KFLAG.EQ.1)  THEN
  15712          IF(KFLAG.EQ.1)  GO TO 835
  15713          WRITE(6,830)
  15714   830    FORMAT(//5X,'INTERACTIVE SEARCH FOR MINIMUM/MAXIMUM VALUES.')
  15715          WRITE(6,831)
  15716   831    FORMAT(/'...INTERACTIVE SEARCH FOR MINIMUM/MAXIMUM VALUES.',
  15717      1          ' AVAILABLE DATA ARE:',/,'     KD',3X,'LEVEL',3X,
  15718      2          'VARIABLE')
  15719   835    CONTINUE
  15720          DO KD=1,KDXX
  15721             WRITE(6,811) KD,IDLEV(KD),IDSPK(KD)
  15722          ENDDO
  15723 
  15724          SECVAR=.FALSE.
  15725 C**SGI   WRITE(0,841)
  15726 C 841    FORMAT('...PLEASE ENTER VARIABLE NUMBER (KDZ) ',/,'   (ENTER',
  15727 C    1          ' NUMBER GREATER THAN LAST VARIABLE TO CALCULATE A',
  15728 C    2          ' SECONDARY VARIABLE)')
  15729          READ(7,*) KDZ
  15730          WRITE(6,*) KDZ
  15731          KDZ1=KDZ
  15732          KDZ2=KDZ
  15733          KVZ1=KDZ1
  15734          KLZ1=KDZ2
  15735          IF(KDZ .LE. KDXX)  GO TO 845
  15736          SECVAR=.TRUE.
  15737 C**SGI   WRITE(0,*)' ...ENTER VARIABLE AND LEVEL (KVZ,KLZ)'
  15738          READ(7,*) KDZ1,KDZ2
  15739          KVZ1=KDZ1
  15740          KLZ1=KDZ2
  15741   845    CONTINUE
  15742          MAXFND=.TRUE.
  15743          WRITE(6,846)
  15744   846    FORMAT('...DO YOU WANT TO FIND MAXIMUM (M) OR MINIMUM (N)?')
  15745          READ(7,847) IMAXMN
  15746   847    FORMAT(A1)
  15747          IF(IMAXMN .EQ. 'N' .OR. IMAXMN .EQ. 'N')  MAXFND=.FALSE.
  15748 

Page 423         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15749 C     ENTER THE CENTER OF THE SEARCH AREA AND MAKE SURE IT IS IN THE
  15750 C     CORRECT HEMISPHERE
  15751 
  15752          WRITE(6,*)' ...ENTER COORDINATES FOR CENTER OF SEARCH AREA',
  15753      1          ' AND RADIUS (LAT.,LONG.,RADIUS)'
  15754          WRITE(6,*)'    OR (-99.0,-99.0,RADIUS) FOR DEFAULT (STORM FIX',
  15755      1          ' LOCATION)'
  15756         WRITE(6,*)'    LONGITUDE IS POSITIVE IN THE WESTERN HEMISPHERE.'
  15757          WRITE(6,*)'    RADIUS IS IN DEG. LAT.'
  15758          READ(7,*)  YSPOT,XSPOT,RAD
  15759       ELSE
  15760          CALL GETSVF(IUNTQF,KDXX,KDZ,MAXFND,YSPOT,XSPOT,RAD)
  15761       ENDIF
  15762 
  15763   844 CONTINUE
  15764       SECVAR=.FALSE.
  15765       XZ=XZZ
  15766       YZ=YZZ
  15767 
  15768       IF(.NOT. INTQF)  THEN
  15769       IF(KDZ .LT. 0)  GO TO 890
  15770 C**SGI      WRITE(0,1848)  KDZ,YSPOT,XSPOT,RAD,MAXFND
  15771       WRITE(6,1848)  KDZ,YSPOT,XSPOT,RAD,MAXFND
  15772  1848 FORMAT(/'...NON INTERACTIVE MAX/MIN FINDER WITH KDZ,YSPOT,',
  15773      1       'XSPOT,RAD,MAXFND=',I4,3F10.2,L3)
  15774       KDZ1=KDZ
  15775       KDZ2=KDZ
  15776       KVZ1=KDZ1
  15777       KLZ1=KDZ2
  15778       ENDIF
  15779 C
  15780 C     DO COORDINATE TRANSFORMATION
  15781 C
  15782       IF(YSPOT .NE. RMISS)  THEN
  15783          XSPOT=XSPOT*(-NSWLN)
  15784          XZ=XSPOT-ELORG
  15785          YZ=YSPOT-GLORG
  15786       ENDIF
  15787       WRITE(6,8849) XZ,XSPOT,YZ,YSPOT
  15788  8849 FORMAT(/'...INITIAL CALL OF SIMCON WITH',
  15789      1       ' RELATIVE X=',F8.3,', =',F9.2,' LONGITUDE,',/,31X,
  15790      1       ' RELATIVE Y=',F8.3,', =',F9.2,' LATITUDE.')
  15791       CALL DOMCHK(XZ,YZ,IN)
  15792       IF(IN .EQ. 0)  THEN
  15793          WRITE(6,8846) XZ,YZ,ELORG,GLORG,XZ+ELORG,YX+GLORG
  15794  8846    FORMAT('...INITIAL VALUES NOT IN DOMAIN,XZ,YZ,ELORG,GLORG,',
  15795      1          'XZ+ELORG,YX+GLORG=',/,5X,6F10.3)
  15796 
  15797 C     ENTER THE CENTER OF THE SEARCH AREA AND MAKE SURE IT IS IN THE
  15798 C     CORRECT HEMISPHERE
  15799 
  15800          WRITE(6,*)' ...ENTER COORDINATES FOR CENTER OF SEARCH AREA',
  15801      1          ' AND RADIUS (LAT.,LONG.,RADIUS)'
  15802          WRITE(6,*)'    OR (-99.0,-99.0,RADIUS) FOR DEFAULT (STORM FIX',
  15803      1          ' LOCATION)'
  15804         WRITE(6,*)'    LONGITUDE IS POSITIVE IN THE WESTERN HEMISPHERE.'
  15805          WRITE(6,*)'    RADIUS IS IN DEG. LAT.'

Page 424         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15806          READ(7,*)  YSPOT,XSPOT,RAD
  15807          GO TO 844
  15808       ENDIF
  15809 C
  15810 C     HUGH WILLOUGHBY'S SIMPLEX ALGORITHM SEARCHES FOR MINIMUM OR
  15811 C     MAXIMUM VALUE
  15812 C
  15813       CALL SIMCON(SECVAR,MAXFND,XZ,YZ,RAD,A,KDZ1,KDZ2,SPOTMN,IOPT,MDUM)
  15814       CALL DOMCHK(XZ,YZ,IN)
  15815       IF(IN .EQ. 0)  THEN
  15816       YLAT=RMISS
  15817       XLON=RMISS
  15818       IF(MAXFND)  THEN
  15819       IMNMX=1
  15820       WRITE(6,850) GLORG+YZ,ELORG+XZ
  15821   850 FORMAT(' MAX. VALUE NOT IN DOMAIN AT LAT.',F8.3,
  15822      1       ' LONG.',F9.3)
  15823       ELSE
  15824       IMNMX=-1
  15825       WRITE(6,8551) GLORG+YZ,ELORG+XZ
  15826  8551 FORMAT(' MIN. VALUE NOT IN DOMAIN AT LAT.',F8.3,
  15827      1       ' LONG.',F9.3)
  15828       ENDIF
  15829 C
  15830       ELSE IF(IN .EQ. 1)  THEN
  15831       YLAT=GLORG+YZ
  15832       XLON=ELORG+XZ
  15833       IF(MAXFND)  THEN
  15834 C**SGI      WRITE(0,851)  IDLEV(KLZ1),IDVAR(KVZ1),SPOTMN,GLORG+YZ,ELORG+
  15835   851 FORMAT(' AT LEVEL',I3,' AND VARIABLE',I3,', MAX. VALUE =',
  15836      1       F9.2,' IS AT LAT.',F8.3,', LONG.',F9.3)
  15837       WRITE(6,851)  IDLEV(KLZ1),IDVAR(KVZ1),SPOTMN,GLORG+YZ,ELORG+XZ
  15838       IMNMX=1
  15839       ELSE
  15840 C**SGI      WRITE(0,852)  IDLEV(KLZ1),IDVAR(KVZ1),SPOTMN,GLORG+YZ,ELORG+
  15841   852 FORMAT(' AT LEVEL',I3,' AND VARIABLE',I3,', MIN. VALUE =',
  15842      1       F9.2,' IS AT LAT.',F8.3,', LONG.',F9.3)
  15843       WRITE(6,852)  IDLEV(KLZ1),IDVAR(KVZ1),SPOTMN,GLORG+YZ,ELORG+XZ
  15844       IMNMX=-1
  15845       ENDIF
  15846 
  15847       ENDIF
  15848   890 CONTINUE
  15849 C
  15850       IF(.NOT. INTQF)  THEN
  15851       IF(KDZ .EQ. -99)  THEN
  15852       RETURN
  15853       ELSE
  15854       CALL OUTSV(IUNTQL,ISIGN(IDVAR(KVZ1),IMNMX),IDLEV(KLZ1),YLAT,XLON,
  15855      1           SPOTMN)
  15856       CALL GETSVM(IUNTQF,KDXX,KDZ,MAXFND,YSPOT,XSPOT,RAD)
  15857       GO TO 844
  15858       ENDIF
  15859       ENDIF
  15860 
  15861       WRITE(6,*)' ...ANY MORE VARIABLES OR LOCATIONS? (Y/N)'
  15862       READ(7,'(A1)') IMORE

Page 425         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15863       WRITE(6,'(A1)') IMORE
  15864       IF(IMORE .NE. 'Y')  RETURN
  15865       WRITE(6,*)' ...NEW VARIABLE (V) OR LOCATION (L)'
  15866       READ(7,'(A1)') IMORE
  15867       WRITE(6,'(A1)') IMORE
  15868       IF(IMORE .EQ. 'V' .OR. IMORE .EQ. 'V')  THEN
  15869          KFLAG = 1
  15870          GO TO 8350
  15871       END IF
  15872       KDZ1=KVZ1
  15873       KDZ2=KLZ1
  15874       MAXFND=.TRUE.
  15875       WRITE(6,846)
  15876       READ(7,847) IMAXMN
  15877       IF(IMAXMN .EQ. 'N' .OR. IMAXMN .EQ. 'N')  MAXFND=.FALSE.
  15878 
  15879 C     ENTER THE CENTER OF THE SEARCH AREA AND MAKE SURE IT IS IN THE
  15880 C     CORRECT HEMISPHERE
  15881 
  15882       WRITE(6,*)' ...ENTER COORDINATES FOR CENTER OF SEARCH AREA',
  15883      1          ' AND RADIUS (LAT.,LONG.,RADIUS)'
  15884       WRITE(6,*)'    OR (-99.0,-99.0,RADIUS) FOR DEFAULT (STORM FIX',
  15885      1          ' LOCATION)'
  15886       WRITE(6,*)'    LONGITUDE IS POSITIVE IN THE WESTERN HEMISPHERE.'
  15887       WRITE(6,*)'    RADIUS IS IN DEG. LAT.'
  15888       READ(7,*)  YSPOT,XSPOT,RAD
  15889       GO TO 844
  15890 C
  15891   980 WRITE(6,981)  KDXZ,NV,KLZ,KF
  15892   981 FORMAT('****** VARIABLE COULD NOT BE FOUND IN STICKD, KDXZ,',
  15893      1       'NV,KLZ,KF=',4I6)
  15894       CALL ABRT1(' SPTFND',981)
  15895   993 WRITE(6,994)  LDWDIM
  15896   994 FORMAT('****** LDWDIM=',I4,' LIMIT IS EXCEEDED IN STICKD.',/,
  15897      1    5X,' HOWEVER, PROCESSING IS CONTINUING WITHOUT READING',
  15898      2       ' ALL RECORDS')
  15899       GO TO 320
  15900   995 WRITE(2,996)  NHOLE,NHLDIM
  15901   996 FORMAT(/'  ****** NUMBER OF HOLES=',I5,', WHILE SPACE ALLOCATED',
  15902      1       'FOR ONLY',I3)
  15903       CALL ABRT1(' SPTFND',996)
  15904   998 WRITE(6,999)  LD,ID(LD)
  15905   999 FORMAT(/'***** INCORRECT ID BRANCH IN SPTDIF',2I5)
  15906       CALL ABRT1(' SPTFND',999)
  15907       END

Page 426         Source Listing                  DIFSUB
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name                  Name                  Name               
                                                                                                                                   
 difsub_               spskwt_               sptdat_               sptfnd_               sptloc_               stickd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1817                       Label  15658                                                          15629                             
 1823                       Label  15707                                                          15706                             
 1848                       Label  15772                                                          15771                             
 2799                       Label  15670                                                          15666                             
 2803                       Label  15592                                                          15585                             
 2804                       Label  15591                                                          15586                             
 2813                       Label  15606                                                          15619,15682                       
 2814                       Label  15689                                                          15628                             
 2815                       Label  15690                                                          15657                             
 2816                       Label  15663                                                          15684                             
 2817                       Label  15640                                                          15636                             
 310                        Label  15076                                                          15089                             
 311                        Label  15080                                                          15078                             
 320                        Label  15091                                                          15076,15899                       
 330                        Label  15121                                                          15117                             
 3380                       Label  15248                                                          15228                             
 3384                       Label  15258                                                          15256                             
 3385                       Label  15262                                                          15252                             
 340                        Label  15124                                                          15120                             
 350                        Label  15131                                                          15104,15125                       
 360                        Label  15146                                                          15100,15102,15122                 
 380                        Label  15198                                                          15180,15189                       
 384                        Label  15207                                                          15206                             
 385                        Label  15209                                                          15202,15203                       
 387                        Label  15265                                                          15220                             
 390                        Label  15282                                                          15164,15166                       
 400                        Label  15286                                                          15097,15283                       
 501                        Label  15323                                                          15322                             
 502                        Label  15348                                                          15347                             
 505                        Label  15358                                                          15356                             
 507                        Label  15364                                                          15361                             
 510                        Label  15366                                                          15351,15370                       
 520                        Label  15372                                                          15367                             
 521                        Label  15374                                                          15373                             
 530                        Label  15381                                                          15385                             
 540                        Label  15387                                                          15382                             
 541                        Label  15389                                                          15388                             
 565                        Label  15399                                                          15396                             
 566                        Label  15404                                                          15403                             
 567                        Label  15408                                                          15406                             
 600                        Label  15417                                                          15464                             
 605                        Label  15429                                                          15424                             
 611                        Label  15449                                                          15445                             
 612                        Label  15451                                                          15447                             

Page 427         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 650                        Label  15456                                                          15428                             
 660                        Label  15462                                                          15415                             
 700                        Label  15465                                                          15413,15461,15462                 
 800                        Label  15483                                                          15482                             
 801                        Label  15567                                                          15486                             
 805                        Label  15487                                                          15557                             
 810                        Label  15489                                                          15487                             
 811                        Label  15568                                                          15488,15721                       
 813                        Label  15516                                                          15529,15562                       
 814                        Label  15569                                                          15538,15539                       
 815                        Label  15570                                                          15544,15545                       
 816                        Label  15551                                                          15564                             
 830                        Label  15714                                                          15713                             
 831                        Label  15716                                                          15715                             
 835                        Label  15719                                                          15712                             
 8350                       Label  15710                                                          15870                             
 844                        Label  15763                                                          15807,15857,15889                 
 845                        Label  15741                                                          15735                             
 846                        Label  15744                                                          15743,15875                       
 847                        Label  15746                                                          15745,15876                       
 850                        Label  15821                                                          15820                             
 851                        Label  15835                                                          15837                             
 852                        Label  15841                                                          15843                             
 8551                       Label  15826                                                          15825                             
 8818                       Label  15546                                                          15540                             
 8846                       Label  15794                                                          15793                             
 8849                       Label  15788                                                          15787                             
 890                        Label  15848                                                          15769                             
 980                        Label  15891                                                          15172                             
 981                        Label  15892                                                          15891                             
 993                        Label  15895                                                          15088                             
 994                        Label  15896                                                          15895                             
 995                        Label  15900                                                          15304                             
 996                        Label  15901                                                          15900                             
 998                        Label  15904                                                          15193,15231                       
 999                        Label  15905                                                          15904                             
 A                          Dummy  14983    R(4)            4     3     49000    ARG,INOUT        15182,15431,15537,15627,15813     
 ABRT1                      Subr   15894                                                          15894,15903,15906                 
 ABS                        Func   15120                                scalar                    15120,15241,15366,15381,15396,1540
                                                                                                  7                                 
 ATAN2DEG                   Func   15237    R(4)            4           scalar                    15237                             
 DATA                       Local  15033    R(4)            4     1     5        SAVE             15433,15438,15441,15446,15448     
 DATAFT                     Dummy  14984    L(4)            4           scalar   ARG,INOUT        15104,15157,15189,15218,15272     
 DATAX                      Local  15033    R(4)            4     1     5        SAVE             15431,15438                       
 DATREC                     Scalar 15014    R(4)            4     1     6        COM                                                
 DIFSUB                     Subr   14983                                                                                            
 DIR                        Local  15240    R(4)            4           scalar   SAVE             15240,15241                       
 DIRDEV                     Local  15236    R(4)            4           scalar   SAVE             15236,15238                       
 DIRUV                      Local  15237    R(4)            4           scalar   SAVE             15237,15238                       
 DMEAN                      Scalar 15009    R(4)            4     1     40       COM              15186,15187,15190,15438           
 DOMCHK                     Subr   15101                                                          15101,15791,15814                 
 DPREP                      Subr   15213                                                          15213                             
 DPRX                       Dummy  14983    R(4)            4           scalar   ARG,INOUT        15120                             
 DSK                        Common 15005                                76       SAVE                                               
 DSPOT                      Local  15036    R(4)            4     1     160      SAVE             15537,15544,15545,15627,15643,1564

Page 428         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  6,15649,15651,15653,15655,15657   
 DWATE                      Common 15013                                760      SAVE                                               
 DXSPD                      Dummy  14985    R(4)            4           scalar   ARG,INOUT        15322,15325,15326,15327,15366,1539
                                                                                                  6,15407                           
 DYSPD                      Dummy  14985    R(4)            4           scalar   ARG,INOUT        15322,15333,15334,15335,15381,1539
                                                                                                  6,15407                           
 ELORG                      Scalar 15012    R(4)            4           scalar   COM              15431,15531,15538,15539,15621,1562
                                                                                                  8,15672,15784,15793,15820,15825,15
                                                                                                  832,15837,15843                   
 FDD                        Local  15031    R(4)            4     1     8000     SAVE             15187,15190,15194,15196,15213,1522
                                                                                                  9,15232,15236,15273,15277         
 FDDX                       Local  15032    R(4)            4     1     8000     SAVE             15186,15191,15275                 
 FDDZ                       Local  15032    R(4)            4     2     5        SAVE             15124,15128,15190                 
 FEXTD                      Local  15019    R(8)            8     3     45       SAVE             15074,15084,15119,15127           
 FLAGZ                      Local  15024    CHAR            1     1     5        SAVE             15042                             
 GETSVF                     Subr   15760                                                          15760                             
 GETSVM                     Subr   15856                                                          15856                             
 GLORG                      Scalar 15012    R(4)            4           scalar   COM              15431,15532,15538,15539,15622,1562
                                                                                                  8,15672,15785,15793,15820,15825,15
                                                                                                  831,15837,15843                   
 HEDCHK                     Subr   15070                                                          15070                             
 HOLE                       Local  15040                                scalar                    15354,15355                       
 ICOOR                      Scalar 15014    I(4)            4           scalar   COM                                                
 ID                         Scalar 15004    I(4)            4     1     8000     COM              15139,15192,15230,15904           
 IDAT                       Scalar 15014    I(4)            4           scalar   COM                                                
 IDATZ                      Scalar 15014    I(4)            4           scalar   COM                                                
 IDAYMN                     Scalar 15012    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 15010    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 15011    I(4)            4     1     20       COM                                                
 IDAYX                      Local  15076    I(4)            4           scalar   SAVE             15076,15078                       
 IDLEV                      Scalar 15008    I(4)            4     1     160      COM              15410,15415,15460,15488,15721,1583
                                                                                                  7,15843,15854                     
 IDPRES                     Local  15635    I(4)            4           scalar   SAVE             15635,15637                       
 IDSPC                      Scalar 15002    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 15003    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 15003    CHAR            72          scalar   COM                                                
 IDSPK                      Scalar 15008    CHAR            40    1     160      COM              15488,15541,15630,15721           
 IDSPKZ                     Local  15024    CHAR            40          scalar   SAVE             15541,15542,15543,15544,15545,1563
                                                                                                  0,15631,15632,15635,15642,15644,15
                                                                                                  645,15647,15648,15650,15652,15654,
                                                                                                  15657                             
 IDTYP                      Scalar 15013    I(4)            4     1     100      COM              15192,15230                       
 IDVAR                      Scalar 15008    I(4)            4     1     160      COM              15436,15542,15543,15837,15843,1585
                                                                                                  4                                 
 IFIX                       Func   15232                                scalar                    15232,15445,15447                 
 IHOLE                      Dummy  14984    L(4)            4           scalar   ARG,INOUT        15351,15396                       
 II                         Local  15585    I(4)            4           scalar   SAVE             15585,15587,15588                 
 III                        Local  15586    I(4)            4           scalar   SAVE             15586,15587,15589,15666,15667     
 IKD                        Local  15636    I(4)            4           scalar   SAVE             15636,15637,15638                 
 IMAXMN                     Local  15026    CHAR            1           scalar   SAVE             15745,15747,15876,15877           
 IMNMX                      Local  15819    I(4)            4           scalar   SAVE             15819,15824,15838,15844,15854     
 IMORE                      Local  15026    CHAR            1           scalar   SAVE             15552,15553,15556,15561,15664,1567
                                                                                                  3,15681,15862,15863,15864,15866,15
                                                                                                  867,15868                         
 IN                         Local  15101    I(4)            4           scalar   SAVE             15101,15102,15791,15792,15814,1581

Page 429         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  5,15830                           
 INT                        Func   15326                                scalar                    15326,15335                       
 INTQF                      Local  15022    L(4)            4           scalar   SAVE             15043,15706,15711,15768,15850     
 IOPT                       Local  15701    I(4)            4           scalar   SAVE             15701,15813                       
 ISIGN                      Func   15854                                scalar                    15854                             
 ISPTYP                     Dummy  14985    I(4)            4           scalar   ARG,INOUT        15445,15447                       
 ISRCD                      Scalar 15001    I(4)            4           scalar   COM                                                
 ITYP                       Local  15192    I(4)            4           scalar   SAVE             15192,15193,15194,15195,15196,1523
                                                                                                  0,15231,15244,15245,15246         
 IUNTQF                     Local  15043    I(4)            4           scalar   SAVE             15043,15760,15856                 
 IUNTQL                     Local  15043    I(4)            4           scalar   SAVE             15043,15704,15854                 
 JDAY0                      Scalar 15012    I(4)            4           scalar   COM              15445,15447                       
 JDTYP                      Scalar 15013    I(4)            4     1     30       COM              15206,15256                       
 JPD                        Scalar 15001    I(4)            4           scalar   COM                                                
 JSKEEM                     Scalar 15013    I(4)            4     1     30       COM                                                
 KBCTYP                     Scalar 15001    I(4)            4     1     4        COM                                                
 KD                         Local  15084    I(4)            4           scalar   SAVE             15084,15126,15127,15128,15164,1516
                                                                                                  5,15166,15168,15169,15190,15277,15
                                                                                                  446,15448,15487,15488,15629,15630,
                                                                                                  15643,15646,15649,15651,15653,1565
                                                                                                  5,15657,15720,15721               
 KDAT                       Dummy  14983    I(4)            4           scalar   ARG,INOUT        15164,15168,15169,15218,15433,1544
                                                                                                  6,15448                           
 KDCTYP                     Scalar 15001    I(4)            4           scalar   COM                                                
 KDF                        Local  15077    I(4)            4           scalar   SAVE             15077,15084,15125,15126           
 KDS                        Local  15077    I(4)            4           scalar   SAVE             15077,15084,15119,15124,15125,1512
                                                                                                  6                                 
 KDTDIM                     Param  14991    I(4)            4           scalar                    14994,15009,15014,15019,15032,1503
                                                                                                  3,15038,15042                     
 KDXDIM                     Param  14994    I(4)            4           scalar                    15031                             
 KDXX                       Dummy  14984    I(4)            4           scalar   ARG,INOUT        15487,15495,15505,15506,15595,1570
                                                                                                  6,15720,15735,15760,15856         
 KDXZ                       Dummy  14983    I(4)            4           scalar   ARG,INOUT        15171,15891                       
 KDZ                        Local  15494    I(4)            4           scalar   SAVE             15494,15495,15497,15498,15594,1559
                                                                                                  6,15597,15729,15730,15731,15732,15
                                                                                                  735,15760,15769,15771,15774,15775,
                                                                                                  15851,15856                       
 KDZ1                       Local  15497    I(4)            4           scalar   SAVE             15497,15499,15501,15508,15509,1553
                                                                                                  7,15540,15559,15596,15598,15600,15
                                                                                                  627,15679,15731,15733,15738,15739,
                                                                                                  15774,15776,15813,15872           
 KDZ2                       Local  15498    I(4)            4           scalar   SAVE             15498,15500,15502,15508,15510,1553
                                                                                                  7,15540,15560,15597,15599,15601,15
                                                                                                  627,15680,15732,15734,15738,15740,
                                                                                                  15775,15777,15813,15873           
 KDZX                       Local  15494    I(4)            4           scalar   SAVE             15494,15498,15595,15597           
 KDZZ1                      Local  15499    I(4)            4           scalar   SAVE             15499,15505,15598,15629           
 KDZZ2                      Local  15500    I(4)            4           scalar   SAVE             15500,15506,15599,15629           
 KF                         Local  15171    I(4)            4           scalar   SAVE             15171,15172,15182,15186,15187,1519
                                                                                                  0,15435,15436,15438,15891         
 KFLAG                      Local  15709    I(4)            4           scalar   SAVE             15709,15711,15712,15869           
 KKVAR                      Local  15220    I(4)            4           scalar   SAVE             15220,15235,15256,15263           
 KL                         Local  15410    I(4)            4           scalar   SAVE             15410,15415,15440,15460           
 KLDIM                      Param  14990    I(4)            4           scalar                    14993,14994,15009,15014,15019,1502
                                                                                                  0,15036                           

Page 430         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KLSTIK                     Dummy  14983    I(4)            4     1     8        ARG,INOUT        15098                             
 KLSTK                      Local  15097    I(4)            4           scalar   SAVE             15097,15098,15283                 
 KLZ                        Local  15098    I(4)            4           scalar   SAVE             15098,15120,15166,15171,15206,1525
                                                                                                  6,15264,15273,15274,15275,15277,15
                                                                                                  891                               
 KLZ1                       Local  15502    I(4)            4           scalar   SAVE             15502,15510,15560,15601,15680,1573
                                                                                                  4,15740,15777,15837,15843,15854,15
                                                                                                  873                               
 KP                         Local  15413    I(4)            4           scalar   SAVE             15413,15414,15415,15459,15460,1546
                                                                                                  2                                 
 KP1                        Dummy  14984    I(4)            4           scalar   ARG,INOUT        15410,15411,15413                 
 KP2                        Dummy  14984    I(4)            4           scalar   ARG,INOUT        15413,15462,15463                 
 KPA                        Local  15411    I(4)            4           scalar   SAVE             15411,15431,15435,15438,15459     
 KPB                        Local  15417    I(4)            4           scalar   SAVE             15417,15431,15435                 
 KPLV                       Dummy  14983    L(4)            4     2     160      ARG,INOUT        15166                             
 KPP                        Local  15414    I(4)            4           scalar   SAVE             15414,15417,15463                 
 KPX                        Scalar 15008    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  14993    I(4)            4           scalar                    15008,15036                       
 KUV                        Local  15167    I(4)            4           scalar   SAVE             15167,15168,15191                 
 KV                         Local  15436    I(4)            4           scalar   SAVE             15436,15437,15438                 
 KVDIM                      Param  14991    I(4)            4           scalar                    14993,15020,15437                 
 KVZ1                       Local  15501    I(4)            4           scalar   SAVE             15501,15509,15559,15600,15679,1573
                                                                                                  3,15739,15776,15837,15843,15854,15
                                                                                                  872                               
 KZZ                        Local  15540    I(4)            4           scalar   SAVE             15540,15541,15542,15543,15544,1554
                                                                                                  5                                 
 LD                         Local  15100    I(4)            4           scalar   SAVE             15100,15101,15117,15119,15127,1513
                                                                                                  7,15138,15140,15180,15182,15186,15
                                                                                                  187,15190,15191,15192,15194,15196,
                                                                                                  15228,15229,15230,15232,15236,1523
                                                                                                  7,15277,15904                     
 LDW                        Local  15032    I(4)            4     1     8000     SAVE             15140,15161,15277                 
 LDWDIM                     Param  14996    I(4)            4           scalar                    15019,15032,15034,15037,15088,1589
                                                                                                  5                                 
 LDWZ                       Local  15037    I(4)            4     1     1        SAVE             15076,15078,15140                 
 LDX                        Scalar 15003    I(4)            4           scalar   COM              15147,15161,15180,15213,15228,1527
                                                                                                  7                                 
 LDXDIM                     Param  14988    I(4)            4           scalar                    15003,15004,15010,15031,15032,1503
                                                                                                  7,15132,15133                     
 LDXX                       Local  15099    I(4)            4           scalar   SAVE             15099,15124,15128,15131,15132,1513
                                                                                                  4,15137,15138,15139,15140,15147   
 LDXZ                       Local  15072    I(4)            4           scalar   SAVE             15072,15076,15077,15078,15079,1508
                                                                                                  3,15084,15087,15088,15091,15100   
 LXSORT                     Scalar 15004    I(4)            4     1     8000     COM                                                
 MAXFND                     Local  15021    L(4)            4           scalar   SAVE             15742,15747,15760,15771,15813,1581
                                                                                                  8,15833,15856,15874,15877         
 MDIM                       Param  14987    I(4)            4           scalar                    15031                             
 MDUM                       Local  15042    I(4)            4           scalar   SAVE             15042,15813                       
 MSKD11                     Scalar 15006    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 15006    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 15006    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 15007    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 15007    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 15007    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 15007    I(4)            4           scalar   COM              15584                             

Page 431         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKD18                     Scalar 15007    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 15005    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 15005    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 15005    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 15005    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 15005    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 15005    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 15006    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 15006    I(4)            4           scalar   COM              15063,15070,15076,15084,15289     
 MSKDA9                     Scalar 15006    I(4)            4           scalar   COM              15158,15161,15284,15285,15288,1532
                                                                                                  0,15403,15406,15447,15467         
 MSKEF                      Scalar 15005    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 15005    I(4)            4           scalar   COM                                                
 MX                         Scalar 15001    I(4)            4           scalar   COM                                                
 MXDDIM                     Param  14995    I(4)            4           scalar                    15033,15372,15373,15377           
 ND                         Local  15083    I(4)            4           scalar   SAVE             15083,15084,15117,15118,15119     
 NDIM                       Param  14987    I(4)            4           scalar                    15031                             
 NDR                        Local  15034    I(4)            4     1     1        SAVE             15076,15078,15083,15117           
 NDZ                        Local  15118    I(4)            4           scalar   SAVE             15118,15127                       
 NFIX0                      Scalar 15012    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  14989    I(4)            4           scalar                    15010,15011                       
 NH                         Local  15356    I(4)            4           scalar   SAVE             15356,15357,15361,15362,15363,1539
                                                                                                  7,15398,15424,15425,15427         
 NHLDIM                     Param  14997    I(4)            4           scalar                    15034,15035,15304,15900           
 NHOLE                      Local  15040    I(4)            4           scalar   SAVE             15040,15304,15357,15361,15398,1542
                                                                                                  4,15900                           
 NINT                       Func   15637                                scalar                    15637                             
 NLEVEL                     Local  15665    I(4)            4           scalar   SAVE             15665,15668,15671,15672           
 NNSWLN                     Local  15443    I(4)            4           scalar   SAVE             15443,15444                       
 NNX                        Local  15326    I(4)            4           scalar   SAVE             15326,15327,15329,15347           
 NNY                        Local  15334    I(4)            4           scalar   SAVE             15334,15335,15337,15347           
 NPSAVE                     Local  15633    I(4)            4           scalar   SAVE             15633,15638,15643,15646,15649,1565
                                                                                                  1,15653,15654,15655               
 NRMS                       Local  15036    I(4)            4     1     30       SAVE             15177,15195,15203,15204,15205,1520
                                                                                                  6,15226,15246,15253,15254,15255,15
                                                                                                  257,15264,15274                   
 NSPD                       Local  15345    I(4)            4           scalar   SAVE             15345,15368,15369,15377,15379,1538
                                                                                                  0,15383,15384,15392,15394         
 NSTICK                     Dummy  14983    I(4)            4           scalar   ARG,INOUT        15097,15283                       
 NSWLN                      Dummy  14985    I(4)            4           scalar   ARG,INOUT        15362,15363,15443,15525,15615,1578
                                                                                                  3                                 
 NTP                        Local  15202    I(4)            4           scalar   SAVE             15202,15203,15204,15205,15206,1525
                                                                                                  2,15253,15254,15255,15256,15257   
 NTPDIM                     Param  14989    I(4)            4           scalar                    15013,15035,15036,15038,15193,1520
                                                                                                  2,15231,15252                     
 NV                         Local  15165    I(4)            4           scalar   SAVE             15165,15171,15206,15213,15218,1525
                                                                                                  6,15264,15270,15891               
 NVZ                        Local  15270    I(4)            4           scalar   SAVE             15270,15273,15274,15275           
 NX                         Scalar 15001    I(4)            4           scalar   COM                                                
 NXD                        Local  15420    I(4)            4           scalar   SAVE             15420,15425,15431,15444           
 NXSPD                      Local  15372    I(4)            4           scalar   SAVE             15372,15373,15379,15396,15406,1542
                                                                                                  0                                 
 NYD                        Local  15419    I(4)            4           scalar   SAVE             15419,15427,15431,15445,15447     
 NYDDIM                     Param  14995    I(4)            4           scalar                    15033,15387,15388,15392           
 NYSPD                      Local  15387    I(4)            4           scalar   SAVE             15387,15388,15394,15396,15406,1541

Page 432         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  9                                 
 OPNFIL                     Subr   15285                                                          15285                             
 OUTDV1                     Subr   15158                                                          15158,15584                       
 OUTDV2                     Subr   15273                                                          15273,15275                       
 OUTDV3                     Subr   15672                                                          15672                             
 OUTREC                     Subr   15441                                                          15441                             
 OUTST1                     Subr   15159                                                          15159                             
 OUTST2                     Subr   15264                                                          15264,15274                       
 OUTSTK                     Subr   15277                                                          15277                             
 OUTSV                      Subr   15854                                                          15854                             
 PLEV                       Scalar 15014    R(4)            4     1     8        COM              15120,15440,15637                 
 PR                         Local  15440    R(4)            4           scalar   SAVE             15440,15441,15446,15448           
 PRDATA                     Dummy  14984    L(4)            4           scalar   ARG,INOUT        15078                             
 PRDLOC                     Subr   15153                                                          15153                             
 PRES                       Common 15014                                72       SAVE                                               
 PRTBOG                     Dummy  14985    L(4)            4           scalar   ARG,INOUT        15445                             
 PRX                        Local  15119    R(4)            4           scalar   SAVE             15119,15120,15127                 
 RAD                        Local  15758    R(4)            4           scalar   SAVE             15758,15760,15771,15806,15813,1585
                                                                                                  6,15888                           
 REAL                       Func   15204                                scalar                    15204,15205,15232,15254,15255,1532
                                                                                                  7,15334,15362,15363,15444         
 RHANL                      Scalar 15014    L(4)            4           scalar   COM                                                
 RMEAN                      Local  15038    R(4)            4     1     30       SAVE             15178,15196,15205,15206,15224,1524
                                                                                                  4,15255,15256,15264,15274         
 RMISS                      Local  15043    R(4)            4           scalar   SAVE             15043,15074,15433,15524,15614,1578
                                                                                                  2,15816,15817                     
 RMS                        Local  15035    R(4)            4     1     30       SAVE             15176,15194,15204,15206,15225,1524
                                                                                                  5,15254,15256,15264,15274         
 S2DTPT                     Common 15003                                160084   SAVE                                               
 S2KOMP                     Common 15008                                7844     SAVE                                               
 S2PRIC                     Common 15001                                217      SAVE                                               
 SAVUVA                     Local  15037    R(4)            4     2     16000    SAVE             15191,15237                       
 SDDIRZ                     Local  15233    R(4)            4           scalar   SAVE             15233,15238,15241,15244,15245     
 SECVAR                     Local  15021    L(4)            4           scalar   SAVE             15496,15504,15537,15593,15627,1572
                                                                                                  4,15736,15764,15813               
 SIGN                       Func   15241                                scalar                    15241                             
 SIMCON                     Subr   15813                                                          15813                             
 SKWVAL                     Local  15038    R(4)            4     2     95       SAVE             15587,15589,15643,15646,15649,1565
                                                                                                  1,15653,15655,15667,15672,15677   
 SPD100                     Local  15232    R(4)            4           scalar   SAVE             15232,15233,15236                 
 SPLD                       Local  15182    R(4)            4           scalar   SAVE             15182,15186,15187,15190           
 SPOTMN                     Local  15813    R(4)            4           scalar   SAVE             15813,15837,15843,15855           
 SPSKWT                     Subr   15575                                                                                            
 SPTDAT                     Subr   15295                                                                                            
 SPTFND                     Subr   15695                                                                                            
 SPTIKA                     Subr   15431                                                          15431                             
 SPTINO                     Subr   15182                                                          15182                             
 SPTLOC                     Subr   15473                                                                                            
 SPTVAR                     Subr   15537                                                          15537,15627                       
 SQRT                       Func   15204                                scalar                    15204,15254                       
 STICKD                     Subr   15047                                                                                            
 STMNAM                     Dummy  14985    CHAR            12          scalar   ARG,INOUT        15407                             
 UPKPRW                     Subr   15119                                                          15119,15127                       
 UTC0                       Scalar 15012    R(4)            4           scalar   COM              15445,15447                       
 UTCOB                      Scalar 15010    R(4)            4     1     8000     COM                                                

Page 433         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UTCSTM                     Scalar 15011    R(4)            4     1     20       COM                                                
 UTCX                       Local  15076    R(4)            4           scalar   SAVE             15076,15078                       
 UVSAVE                     Dummy  14984    L(4)            4           scalar   ARG,INOUT        15275                             
 UVX                        Local  15119    R(4)            4           scalar   SAVE             15119,15124,15127,15128           
 VFIND                      Subr   15171                                                          15171                             
 WD                         Scalar 15003    R(4)            4     1     8000     COM                                                
 WDR                        Scalar 15013    R(4)            4     1     30       COM                                                
 WRDSTT                     Dummy  14983    L(4)            4           scalar   ARG,INOUT        15159,15263,15274                 
 WSTM                       Scalar 15011    R(4)            4     1     20       COM                                                
 WX                         Local  15119    R(4)            4           scalar   SAVE             15119,15127,15139                 
 XD                         Scalar 15003    R(4)            4     1     8000     COM              15137,15182                       
 XDSPD                      Local  15033    R(4)            4     1     70       SAVE             15341,15343,15369,15406,15425,1543
                                                                                                  1,15444                           
 XDSPDZ                     Local  15444    R(4)            4           scalar   SAVE             15444,15446,15447                 
 XDZ                        Local  15037    R(4)            4     1     1        SAVE             15077,15079,15101,15137           
 XHOLMN                     Local  15034    R(4)            4     1     2        SAVE             15040,15306,15356,15362,15397,1542
                                                                                                  5                                 
 XHOLMX                     Local  15034    R(4)            4     1     2        SAVE             15040,15307,15356,15363,15397,1542
                                                                                                  5                                 
 XLON                       Local  15817    R(4)            4           scalar   SAVE             15817,15832,15854                 
 XM1                        Scalar 15002    R(4)            4           scalar   COM                                                
 XML                        Scalar 15001    R(4)            4           scalar   COM              15306,15326,15327,15341,15347,1552
                                                                                                  6,15616                           
 XMR                        Scalar 15001    R(4)            4           scalar   COM              15307,15326,15327,15367,15527,1561
                                                                                                  7                                 
 XMXX                       Scalar 15002    R(4)            4           scalar   COM                                                
 XOFF                       Local  15327    R(4)            4           scalar   SAVE             15327,15330,15341,15347           
 XSPD                       Local  15343    R(4)            4           scalar   SAVE             15343,15347,15366,15367,15369     
 XSPOT                      Local  15519    R(4)            4           scalar   SAVE             15519,15525,15526,15531,15609,1561
                                                                                                  5,15616,15621,15758,15760,15771,15
                                                                                                  783,15784,15787,15806,15856,15888 
 XSTM                       Scalar 15010    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 15012    R(4)            4           scalar   COM                                                
 XX                         Local  15077    R(4)            4           scalar   SAVE             15077,15079                       
 XYBCWL                     Scalar 15002    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 15002    R(4)            4     1     2        COM                                                
 XYT                        Common 15010                                64432    SAVE                                               
 XZ                         Dummy  14984    R(4)            4           scalar   ARG,INOUT        15531,15537,15538,15539,15621,1562
                                                                                                  7,15628,15672,15702,15706,15765,15
                                                                                                  784,15787,15791,15793,15813,15814,
                                                                                                  15820,15825,15832,15837,15843     
 XZZ                        Local  15702    R(4)            4           scalar   SAVE             15702,15765                       
 YD                         Scalar 15003    R(4)            4     1     8000     COM              15138,15182                       
 YDSPD                      Local  15033    R(4)            4     1     70       SAVE             15342,15344,15384,15406,15427,1543
                                                                                                  1,15445,15447                     
 YDZ                        Local  15037    R(4)            4     1     1        SAVE             15076,15078,15101,15138           
 YHOLMN                     Local  15035    R(4)            4     1     2        SAVE             15040,15308,15356,15397,15427     
 YHOLMX                     Local  15035    R(4)            4     1     2        SAVE             15040,15309,15357,15397,15427     
 YLAT                       Local  15816    R(4)            4           scalar   SAVE             15816,15831,15854                 
 YN1                        Scalar 15002    R(4)            4           scalar   COM                                                
 YNB                        Scalar 15001    R(4)            4           scalar   COM              15309,15334,15335,15342,15347,1552
                                                                                                  6,15616                           
 YNT                        Scalar 15001    R(4)            4           scalar   COM              15308,15334,15335,15382,15526,1561
                                                                                                  6                                 
 YNXX                       Scalar 15002    R(4)            4           scalar   COM                                                

Page 434         Source Listing                  DIFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YOFF                       Local  15334    R(4)            4           scalar   SAVE             15334,15338,15342,15347           
 YSPD                       Local  15344    R(4)            4           scalar   SAVE             15344,15347,15381,15382,15384     
 YSPOT                      Local  15519    R(4)            4           scalar   SAVE             15519,15524,15526,15532,15609,1561
                                                                                                  4,15616,15622,15758,15760,15771,15
                                                                                                  782,15785,15787,15806,15856,15888 
 YSTM                       Scalar 15010    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 15012    R(4)            4           scalar   COM                                                
 YX                         Local  15077    R(4)            4           scalar   SAVE             15077,15079,15793                 
 YZ                         Dummy  14984    R(4)            4           scalar   ARG,INOUT        15532,15537,15538,15539,15622,1562
                                                                                                  7,15628,15672,15703,15706,15766,15
                                                                                                  785,15787,15791,15793,15813,15814,
                                                                                                  15820,15825,15831,15837,15843     
 YZZ                        Local  15703    R(4)            4           scalar   SAVE             15703,15766                       

Page 435         Source Listing                  DIFSUB
2017-04-18 11:09                                 syndata.f

  15908 
  15909 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  15910 C                .      .    .                                       .
  15911 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  15912 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  15913 C
  15914 C ABSTRACT: ??????????????????????????????????????????????????????????
  15915 C   ??????????????????????????????????????????????????????????????????
  15916 C
  15917 C PROGRAM HISTORY LOG:
  15918 C ????-??-??  S. J. LORD
  15919 C
  15920 C USAGE:    CALL ????????(????)
  15921 C   INPUT ARGUMENT LIST:
  15922 C     ??????   - ???????????????????????????????????????????????
  15923 C
  15924 C   OUTPUT ARGUMENT LIST:
  15925 C     ??????   - ???????????????????????????????????????????????
  15926 C
  15927 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  15928 C     ??????   - ???????????????????????????????????????????????
  15929 C
  15930 C   OUTPUT FILES:
  15931 C     ??????   - ???????????????????????????????????????????????
  15932 C
  15933 C REMARKS: ?????????????????????????????????????????????????????
  15934 C
  15935 C ATTRIBUTES:
  15936 C   LANGUAGE: FORTRAN 90
  15937 C   MACHINE:  NCEP WCOSS
  15938 C
  15939 C$$$
  15940       SUBROUTINE PRDLOC(NFIX)
  15941 C
  15942       PARAMETER (MDIM=35,NDIM=35)
  15943       PARAMETER (LDXDIM=8000)
  15944       PARAMETER (NFXDIM=20,NTPDIM=30)
  15945 CIBM  PARAMETER (MXCOL=MIN(5*MDIM,120))
  15946 C
  15947 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  15948 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  15949       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  15950      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  15951       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  15952      1                 YNC(NDIM),COSYN(NDIM)
  15953       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  15954      1               ID(LDXDIM),LXSORT(LDXDIM)
  15955       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  15956      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),
  15957      2            ELORG,GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  15958       COMMON /DWATE/ WDR(NTPDIM),JSKEEM(NTPDIM),IDTYP(100),JDTYP(NTPDIM)
  15959 C
  15960       SAVE
  15961 C
  15962       DIMENSION DTYP(NTPDIM+2)
  15963 C
  15964       CHARACTER*8 IDSPD1,IDSPD2*72,IDSPC*125,IFMTA4*16

Page 436         Source Listing                  PRDLOC
2017-04-18 11:09                                 syndata.f

  15965       CHARACTER   IFM1*1,IFM2*3,IFM3*4,IFM4*1,IFM5*5,DVX*6
  15966       CHARACTER*1 DTYP,LINE*120
  15967 C
  15968       DIMENSION YDZ(LDXDIM+NFXDIM),XDZ(LDXDIM+NFXDIM),IDZ(LDXDIM+NFXDIM)
  15969      1         ,LDSORT(LDXDIM+NFXDIM),DV(LDXDIM+NFXDIM),NSFT(6)
  15970 C
  15971 CIBM  THE FOLLOWING INITIALIZATION OF IDTYP AND JDTYP HAVE BEEN MOVED
  15972 CIBM     TO A BLOCK DATA ROUTINE FOLLOWING THIS SUBROUTINE.
  15973 CIBM  DATA NSFT/2*4,5,2*4,3/,MPAGE/24/,NLPAGE/43/,
  15974 CIBM 1     IDTYP/1,2,3,4,5,6,7,8,9,10,11,12,13,6*0,14,15,16,17,18,19,
  15975 CIBM 2           20,23*0,21,22,23,45*0,24,25,0/,
  15976 CIBM
  15977 CIBM  JDTYP IS THE INVERSE TABLE TO IDTYP
  15978 CIBM
  15979 CIBM 3     JDTYP/1,2,3,4,5,6,7,8,9,10,11,12,13,20,21,22,23,24,25,26,
  15980 CIBM 4           50,51,52,7*0/
  15981       DATA NSFT/2*4,5,2*4,3/,MPAGE/24/,NLPAGE/51/
  15982       DATA IFM1/'('/,IFM2/'   '/,IFM3/'F5.1'/,
  15983      1     IFM4/')'/,IFM5/'     '/
  15984       DATA DTYP/'0','R','N','P','C','A','F','D','B',
  15985      1          'X','Y','M','K','L','T','G','V','U',
  15986      2          'W','I','*','#','$','S','H',7*' '/
  15987 C
  15988 
  15989 C     CONSTANTS RELATED TO THE NUMBER OF NODAL INTERVALS
  15990 C
  15991       MXCOL=MIN(5*MDIM,120)
  15992       IFMTA4=IFM1//IFM2//IFM3//IFM4//IFM5
  15993       MXMAX=5*MIN(MX,MPAGE-1)
  15994       LYMAX=MIN(2*NX+1,NLPAGE)
  15995 C
  15996 C     CONSTANTS RELATED TO THE DISTANCE OF THE STORM CENTER TO THE BOUND
  15997 C
  15998       DYNX=YNXX-YN1
  15999       DXMX=XMXX-XM1
  16000 C
  16001 C     CONSTANTS RELATED TO BOTH
  16002 C
  16003       YL=REAL(2*NX)/DYNX
  16004       XL=REAL(5*MX)/DXMX
  16005 C
  16006 C     MORE CONSTANTS RELATED TO THE NUMBER OF NODAL INTERVALS
  16007 C
  16008       MPGX=MX/MPAGE+1
  16009       NPGX=(2*NX)/NLPAGE+1
  16010 C
  16011 C     SAVE VALUES OF LONGITUDE, LATITUDE, AND DATA TYPE
  16012 C
  16013       XDZ(1:LDX)=XD(1:LDX)
  16014       YDZ(1:LDX)=YD(1:LDX)
  16015       IDZ(1:LDX)=ID(1:LDX)
  16016 C
  16017 C     SPECIAL LOCATION FOR HURRICANE POSITIONS
  16018 C     ******** WARNING:  FORTRAN77 GIVES NO EXECUTION OF THE
  16019 C                        FOLLOWING DO-LOOP IF NFIX=0   ********
  16020 C
  16021       IF(NFIX .EQ. 1)  THEN

Page 437         Source Listing                  PRDLOC
2017-04-18 11:09                                 syndata.f

  16022          XDZ(LDX+1)=XSTM(NFIX0)
  16023          YDZ(LDX+1)=YSTM(NFIX0)
  16024          IDZ(LDX+1)=IFIX(WSTM(NFIX0))
  16025       ELSE
  16026          DO N=1,NFIX
  16027             XDZ(LDX+N)=XSTM(N)
  16028             YDZ(LDX+N)=YSTM(N)
  16029             IDZ(LDX+N)=IFIX(WSTM(N))
  16030          ENDDO
  16031       ENDIF
  16032 C
  16033       LDX1=LDX+NFIX
  16034 C
  16035 C     SORT YDZ
  16036 C
  16037       CALL SORTRL(YDZ,LDSORT,LDX1)
  16038 C
  16039 C     CONTINUE FOR EARTH-RELATIVE COORDINATES
  16040 C
  16041       IF(NFIX .EQ. 0)  RETURN
  16042       WRITE(6,710)
  16043       WRITE(6,711)
  16044   710 FORMAT(//42X,'DATA POINT LOCATIONS',/,1X,
  16045      1       'O...ODW (1)                      ',
  16046      2       'F...AIR FORCE VORTEX DATA (7)    ',
  16047      3       'K...NHC ATOLL/200 ANALYSIS (13)  ',
  16048      4       'W...NHC CLD TRK (25)             ',/,1X,
  16049      5       'R...RAWINSONDES (2)              ',
  16050      6       'D...DOPPLER (8)                  ',
  16051      7       'L...VAS TEMPERATURE & MOIS. (20) ',
  16052      8       'I...TIROS SATELLITE (26)         ',/1X,
  16053      9       'N...NOAA P-3 AIRCRAFT (3)        ',
  16054      D       'B...PIBAL/SIGNIFICANT LEVEL (9)  ',
  16055      1       'T...WISCONSIN CLD TRK (21)       ',
  16056      2       '*...BOGUS POINT (50)             ',/,1X,
  16057      3       'P...SURFACE SHIP (4)             ',
  16058      4       'X...VERT. INT. (1-D SPL) (10)    ',
  16059      5       'G...VAS-GRADIENT (22)            ',
  16060      6       '#...BACKGROUND VALUE (RGL) (51)  ')
  16061   711 FORMAT(
  16062      7       'C...COMMERCIAL AIRCRAFT (5)      ',
  16063      8       'Y...VERT. INT. (2-D SPL) (11)    ',
  16064      9       'V...WISCONSIN WATER VAPOR (23)   ',
  16065      O       '$...BACKGROUND VALUE (ATL)  (52) ',/,1X,
  16066      1       'A...AIR FORCE RECONNAISSANCE (6) ',
  16067      2       'M...NCEP REGIONAL ANALYSIS (12)  ',
  16068      3       'U...NCEP CLD TRK (24)            ',
  16069      4       'S...STORM TRACK (98)             ',/,100X,
  16070      5       'H...HURRICANE (99)               ')
  16071 C
  16072 C     MAKE A MAP OF THE DATA POINTS
  16073 C
  16074       DO  NPG=1,NPGX
  16075       DO  MPG=1,MPGX
  16076 C
  16077          ML1=(MPG-1)*MPAGE+1
  16078          MLX=MIN(MPAGE*MPG,MXX)

Page 438         Source Listing                  PRDLOC
2017-04-18 11:09                                 syndata.f

  16079          MWDTH=5*(MLX-ML1+1)
  16080          NL1=(NPG-1)*(NLPAGE/2+1)
  16081 C
  16082 C     WRITE GRID
  16083 C
  16084          WRITE(6,910) (XMC(M),M=ML1,MLX)
  16085          WRITE(6,810) (M,M=ML1,MLX)
  16086   810    FORMAT(10X,'M=',I4,23I5)
  16087          WRITE(6,811)
  16088   811    FORMAT('  LAT.  N')
  16089          LD=1
  16090          LN=1
  16091          N=NXX-NL1
  16092    20    CONTINUE
  16093          LINE(1:MXCOL)=' '
  16094    40    CONTINUE
  16095 C
  16096 C     ACCEPT NEXT DATA POINT (FROM NORTH TO SOUTH)
  16097 C
  16098          LDPS=LDX1+1-LD
  16099          LDP =LDSORT(LDPS)
  16100          LY  =NINT((YNXX-YDZ(LDPS))*YL+1)
  16101          LYP =(LY-1)/NLPAGE+1
  16102 C
  16103 C     CHECK IF DATA POINT IS ON THE MAP
  16104 C
  16105          IF(LYP .NE. NPG .OR. LY .LT. 1)  GO TO 70
  16106          LYZ=MOD(LY,NLPAGE)
  16107          IF(LYZ .EQ. 0)  LYZ=NLPAGE
  16108 C
  16109 C     CHECK IF DATA POINT IS ON THE MAP
  16110 C
  16111          IF(LYZ .GT. LYMAX)  GO TO 70
  16112          IF(LYZ-LN.NE.0) GO TO 80
  16113          CALL DOMCHK(XDZ(LDP),YDZ(LDPS),IN)
  16114          IF(IN .EQ. 0)  GO TO 70
  16115          LX=5+NINT((XDZ(LDP)-XM1)*XL)
  16116          LXP=LX/(MPAGE*5)+1
  16117 C        LXP=(LX-5)/(MPAGE*5)+1
  16118 C
  16119 C** DEBUG
  16120 c && 3 comments
  16121 CC       WRITE(6,51) LDP,LDPS,XDZ(LDP),
  16122 CC   1   YDZ(LDPS),LYZ,LX,XL,XDZ(LDP)-XM1,LXP,MPG
  16123 CC 51    FORMAT(/'....AFTER LXP CALC:',2I10,2F13.3,2I10,2F13.3,2I5)
  16124 C
  16125          IF(LXP .NE. MPG)  GO TO 70
  16126          LXZ=MOD(LX,MPAGE*5)
  16127          IF(LXZ .EQ. 0 .AND. LX .NE. 0)  LXZ=MPAGE*5
  16128 C** DEBUG
  16129 c && 3 comments
  16130 CC       WRITE(6,1151) LDP,LDPS,XDZ(LDP),
  16131 CC   1    YDZ(LDPS),LYZ,LX,XL,XDZ(LDP)-XM1,LXP,MPG,LXZ
  16132 C1151    FORMAT(/'....AFTER LXZ CALC:',2I10,2F13.3,2I10,2F13.3,3I5)
  16133 C
  16134          LXZ=MAX(LXZ-1,1)
  16135          IF(LINE(LXZ:LXZ) .NE. ' ')  THEN

Page 439         Source Listing                  PRDLOC
2017-04-18 11:09                                 syndata.f

  16136          LINE(LXZ:LXZ)='+'
  16137          ELSE
  16138 c fixit?? - I made the following change to avoid a ZERO subscript
  16139 c            for 'DTYP'
  16140 cdak     LINE(LXZ:LXZ)=DTYP(IDTYP(IDZ(LDP)))
  16141          if(IDTYP(IDZ(LDP)).gt.0)  then
  16142             LINE(LXZ:LXZ)=DTYP(IDTYP(IDZ(LDP)))
  16143          else
  16144             line(lxz:lxz)=' '
  16145          endif
  16146 
  16147 
  16148 C** DEBUG
  16149 C        IF(LDP .LE. 100)  THEN
  16150 c && 2 comments
  16151 CC       WRITE(6,8145) LDP,IDTYP(IDZ(LDP)),LXZ,LX,LDPS,LXP,MWDTH
  16152 C8145    FORMAT('...LDP,IDTYP(IDZ(LDP)),LXZ,LX,LDPS,LXP,MWDTH=',7I5)
  16153 C        ENDIF
  16154          ENDIF
  16155    70    CONTINUE
  16156          IF(LD .EQ. LDX1)  GO TO 80
  16157          LD=LD+1
  16158          GO TO 40
  16159 C
  16160 C     XMC, YNC ARE X,Y COORDINATES OF NODAL POINTS.  HERE, WE ASSUME
  16161 C     NODAL POINTS ARE ON BOUNDARIES.  THESE MAY BE ODD OR EVEN NUMBERED
  16162 C     LINES, DEPENDING ON THE NUMBER OF PAGES IN THE Y-DIRECTION.
  16163 C
  16164    80    CONTINUE
  16165          IF(MOD(LN,2) .NE. MOD(NPG,2))  GO TO 85
  16166          WRITE(6,814) YNC(N),N,LINE(1:MWDTH)
  16167   814    FORMAT(F6.2,1X,I3,2X,A)
  16168          N=N-1
  16169          GO TO 90
  16170    85    CONTINUE
  16171          WRITE(6,815) LINE(1:MWDTH)
  16172   815    FORMAT(12X,A)
  16173 C
  16174 C     SET UP FOR THE NEXT LINE, ONLY IF IT'S NOT THE END OF A PAGE, OR
  16175 C     THE END OF THE DATA.
  16176 C
  16177    90    CONTINUE
  16178          IF(LN .EQ. 2*NX+1 .OR. LN .EQ. NLPAGE .OR. N .EQ. 0)  GO TO 100
  16179          LN=LN+1
  16180          GO TO 20
  16181 C
  16182 C     PUT GRID AT BOTTOM OF PAGE
  16183 C
  16184   100    CONTINUE
  16185          WRITE(6,850) (M,M=ML1,MLX)
  16186   850    FORMAT(/10X,'M=',I4,23I5)
  16187          WRITE(6,910) (XMC(M),M=ML1,MLX)
  16188   910    FORMAT(6X,'LONG.=',12F8.2/12X,12F8.2)
  16189 C
  16190 C     START NEW PAGE
  16191 C
  16192          IF(NPG .NE. NPGX .OR. MPG .NE. MPGX)  THEN

Page 440         Source Listing                  PRDLOC
2017-04-18 11:09                                 syndata.f

  16193             print *, ' '
  16194             print *, ' '
  16195          ENDIF
  16196       ENDDO
  16197       ENDDO
  16198 C
  16199       RETURN
  16200       END


ENTRY POINTS

  Name               
                     
 prdloc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  16184                                                          16178                             
 20                         Label  16092                                                          16180                             
 40                         Label  16094                                                          16158                             
 70                         Label  16155                                                          16105,16111,16114,16125           
 710                        Label  16044                                                          16042                             
 711                        Label  16061                                                          16043                             
 80                         Label  16164                                                          16112,16156                       
 810                        Label  16086                                                          16085                             
 811                        Label  16088                                                          16087                             
 814                        Label  16167                                                          16166                             
 815                        Label  16172                                                          16171                             
 85                         Label  16170                                                          16165                             
 850                        Label  16186                                                          16185                             
 90                         Label  16177                                                          16169                             
 910                        Label  16188                                                          16084,16187                       
 COSYN                      Scalar 15952    R(4)            4     1     35       COM                                                
 DOMCHK                     Subr   16113                                                          16113                             
 DTYP                       Local  15962    CHAR            1     1     32       SAVE             15984,16142                       
 DV                         Local  15969    R(4)            4     1     8020     SAVE                                               
 DVX                        Local  15965    CHAR            6           scalar   SAVE                                               
 DWATE                      Common 15958                                760      SAVE                                               
 DXM                        Scalar 15951    R(4)            4           scalar   COM                                                
 DXMX                       Local  15999    R(4)            4           scalar   SAVE             15999,16004                       
 DYN                        Scalar 15951    R(4)            4           scalar   COM                                                
 DYNX                       Local  15998    R(4)            4           scalar   SAVE             15998,16003                       
 ELORG                      Scalar 15957    R(4)            4           scalar   COM                                                
 GLORG                      Scalar 15957    R(4)            4           scalar   COM                                                
 ID                         Scalar 15954    I(4)            4     1     8000     COM              16015                             
 IDAYMN                     Scalar 15957    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 15955    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 15956    I(4)            4     1     20       COM                                                
 IDSPC                      Scalar 15950    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 15953    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 15953    CHAR            72          scalar   COM                                                
 IDTYP                      Scalar 15958    I(4)            4     1     100      COM              16141,16142                       
 IDZ                        Local  15968    I(4)            4     1     8020     SAVE             16015,16024,16029,16141,16142     

Page 441         Source Listing                  PRDLOC
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IFIX                       Func   16024                                scalar                    16024,16029                       
 IFM1                       Local  15965    CHAR            1           scalar   SAVE             15982,15992                       
 IFM2                       Local  15965    CHAR            3           scalar   SAVE             15982,15992                       
 IFM3                       Local  15965    CHAR            4           scalar   SAVE             15982,15992                       
 IFM4                       Local  15965    CHAR            1           scalar   SAVE             15983,15992                       
 IFM5                       Local  15965    CHAR            5           scalar   SAVE             15983,15992                       
 IFMTA4                     Local  15964    CHAR            16          scalar   SAVE             15992                             
 IN                         Local  16113    I(4)            4           scalar   SAVE             16113,16114                       
 ISRCD                      Scalar 15949    I(4)            4           scalar   COM                                                
 JDAY0                      Scalar 15957    I(4)            4           scalar   COM                                                
 JDTYP                      Scalar 15958    I(4)            4     1     30       COM                                                
 JPD                        Scalar 15949    I(4)            4           scalar   COM                                                
 JSKEEM                     Scalar 15958    I(4)            4     1     30       COM                                                
 KBCTYP                     Scalar 15949    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 15949    I(4)            4           scalar   COM                                                
 LD                         Local  16089    I(4)            4           scalar   SAVE             16089,16098,16156,16157           
 LDP                        Local  16099    I(4)            4           scalar   SAVE             16099,16113,16115,16141,16142     
 LDPS                       Local  16098    I(4)            4           scalar   SAVE             16098,16099,16100,16113           
 LDSORT                     Local  15969    I(4)            4     1     8020     SAVE             16037,16099                       
 LDX                        Scalar 15953    I(4)            4           scalar   COM              16013,16014,16015,16022,16023,1602
                                                                                                  4,16027,16028,16029,16033         
 LDX1                       Local  16033    I(4)            4           scalar   SAVE             16033,16037,16098,16156           
 LDXDIM                     Param  15943    I(4)            4           scalar                    15953,15954,15955,15968,15969     
 LINE                       Local  15966    CHAR            120         scalar   SAVE             16093,16135,16136,16142,16144,1616
                                                                                                  6,16171                           
 LN                         Local  16090    I(4)            4           scalar   SAVE             16090,16112,16165,16178,16179     
 LX                         Local  16115    I(4)            4           scalar   SAVE             16115,16116,16126,16127           
 LXP                        Local  16116    I(4)            4           scalar   SAVE             16116,16125                       
 LXSORT                     Scalar 15954    I(4)            4     1     8000     COM                                                
 LXZ                        Local  16126    I(4)            4           scalar   SAVE             16126,16127,16134,16135,16136,1614
                                                                                                  2,16144                           
 LY                         Local  16100    I(4)            4           scalar   SAVE             16100,16101,16105,16106           
 LYMAX                      Local  15994    I(4)            4           scalar   SAVE             15994,16111                       
 LYP                        Local  16101    I(4)            4           scalar   SAVE             16101,16105                       
 LYZ                        Local  16106    I(4)            4           scalar   SAVE             16106,16107,16111,16112           
 M                          Local  16084    I(4)            4           scalar   SAVE             16084,16085,16185,16187           
 MAX                        Func   16134                                scalar                    16134                             
 MDIM                       Param  15942    I(4)            4           scalar                    15951,15991                       
 MIN                        Func   15991                                scalar                    15991,15993,15994,16078           
 ML1                        Local  16077    I(4)            4           scalar   SAVE             16077,16079,16084,16085,16185,1618
                                                                                                  7                                 
 MLX                        Local  16078    I(4)            4           scalar   SAVE             16078,16079,16084,16085,16185,1618
                                                                                                  7                                 
 MOD                        Func   16106                                scalar                    16106,16126,16165                 
 MPAGE                      Local  15981    I(4)            4           scalar   SAVE             15981,15993,16008,16077,16078,1611
                                                                                                  6,16126,16127                     
 MPG                        Local  16075    I(4)            4           scalar   SAVE             16075,16077,16078,16125,16192     
 MPGX                       Local  16008    I(4)            4           scalar   SAVE             16008,16075,16192                 
 MWDTH                      Local  16079    I(4)            4           scalar   SAVE             16079,16166,16171                 
 MX                         Scalar 15949    I(4)            4           scalar   COM              15993,16004,16008                 
 MXCOL                      Local  15991    I(4)            4           scalar   SAVE             15991,16093                       
 MXMAX                      Local  15993    I(4)            4           scalar   SAVE             15993                             
 MXX                        Scalar 15951    I(4)            4           scalar   COM              16078                             
 N                          Local  16026    I(4)            4           scalar   SAVE             16026,16027,16028,16029,16091,1616
                                                                                                  6,16168,16178                     

Page 442         Source Listing                  PRDLOC
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NDIM                       Param  15942    I(4)            4           scalar                    15951,15952                       
 NFIX                       Dummy  15940    I(4)            4           scalar   ARG,INOUT        16021,16026,16033,16041           
 NFIX0                      Scalar 15957    I(4)            4           scalar   COM              16022,16023,16024                 
 NFXDIM                     Param  15944    I(4)            4           scalar                    15955,15956,15968,15969           
 NINT                       Func   16100                                scalar                    16100,16115                       
 NL1                        Local  16080    I(4)            4           scalar   SAVE             16080,16091                       
 NLPAGE                     Local  15981    I(4)            4           scalar   SAVE             15981,15994,16009,16080,16101,1610
                                                                                                  6,16107,16178                     
 NPG                        Local  16074    I(4)            4           scalar   SAVE             16074,16080,16105,16165,16192     
 NPGX                       Local  16009    I(4)            4           scalar   SAVE             16009,16074,16192                 
 NSFT                       Local  15969    I(4)            4     1     6        SAVE             15981                             
 NTPDIM                     Param  15944    I(4)            4           scalar                    15958,15962                       
 NX                         Scalar 15949    I(4)            4           scalar   COM              15994,16003,16009,16178           
 NXX                        Scalar 15951    I(4)            4           scalar   COM              16091                             
 PRDLOC                     Subr   15940                                                                                            
 REAL                       Func   16003                                scalar                    16003,16004                       
 S2DTPT                     Common 15953                                160084   SAVE                                               
 S2NODE                     Common 15951                                716      SAVE                                               
 S2PRIC                     Common 15949                                217      SAVE                                               
 SORTRL                     Subr   16037                                                          16037                             
 UTC0                       Scalar 15957    R(4)            4           scalar   COM                                                
 UTCOB                      Scalar 15955    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 15956    R(4)            4     1     20       COM                                                
 WD                         Scalar 15953    R(4)            4     1     8000     COM                                                
 WDR                        Scalar 15958    R(4)            4     1     30       COM                                                
 WSTM                       Scalar 15956    R(4)            4     1     20       COM              16024,16029                       
 XD                         Scalar 15953    R(4)            4     1     8000     COM              16013                             
 XDZ                        Local  15968    R(4)            4     1     8020     SAVE             16013,16022,16027,16113,16115     
 XL                         Local  16004    R(4)            4           scalar   SAVE             16004,16115                       
 XM                         Scalar 15951    R(4)            4     1     35       COM                                                
 XM1                        Scalar 15950    R(4)            4           scalar   COM              15999,16115                       
 XMC                        Scalar 15951    R(4)            4     1     35       COM              16084,16187                       
 XML                        Scalar 15949    R(4)            4           scalar   COM                                                
 XMR                        Scalar 15949    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 15950    R(4)            4           scalar   COM              15999                             
 XSTM                       Scalar 15955    R(4)            4     1     20       COM              16022,16027                       
 XSTM0                      Scalar 15957    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 15950    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 15950    R(4)            4     1     2        COM                                                
 XYT                        Common 15955                                64432    SAVE                                               
 YD                         Scalar 15953    R(4)            4     1     8000     COM              16014                             
 YDZ                        Local  15968    R(4)            4     1     8020     SAVE             16014,16023,16028,16037,16100,1611
                                                                                                  3                                 
 YL                         Local  16003    R(4)            4           scalar   SAVE             16003,16100                       
 YN                         Scalar 15951    R(4)            4     1     35       COM                                                
 YN1                        Scalar 15950    R(4)            4           scalar   COM              15998                             
 YNB                        Scalar 15949    R(4)            4           scalar   COM                                                
 YNC                        Scalar 15952    R(4)            4     1     35       COM              16166                             
 YNT                        Scalar 15949    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 15950    R(4)            4           scalar   COM              15998,16100                       
 YSTM                       Scalar 15955    R(4)            4     1     20       COM              16023,16028                       
 YSTM0                      Scalar 15957    R(4)            4           scalar   COM                                                

Page 443         Source Listing                  PRDLOC
2017-04-18 11:09                                 syndata.f

  16201 
  16202 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16203 C                .      .    .                                       .
  16204 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16205 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16206 C
  16207 C ABSTRACT: ??????????????????????????????????????????????????????????
  16208 C   ??????????????????????????????????????????????????????????????????
  16209 C
  16210 C PROGRAM HISTORY LOG:
  16211 C ????-??-??  S. J. LORD
  16212 C
  16213 C USAGE:    CALL ????????(????)
  16214 C   INPUT ARGUMENT LIST:
  16215 C     ??????   - ???????????????????????????????????????????????
  16216 C
  16217 C   OUTPUT ARGUMENT LIST:
  16218 C     ??????   - ???????????????????????????????????????????????
  16219 C
  16220 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16221 C     ??????   - ???????????????????????????????????????????????
  16222 C
  16223 C   OUTPUT FILES:
  16224 C     ??????   - ???????????????????????????????????????????????
  16225 C
  16226 C REMARKS: ?????????????????????????????????????????????????????
  16227 C
  16228 C ATTRIBUTES:
  16229 C   LANGUAGE: FORTRAN 90
  16230 C   MACHINE:  NCEP WCOSS
  16231 C
  16232 C$$$
  16233       BLOCK DATA IBM2
  16234       PARAMETER (NTPDIM=30)
  16235       COMMON /DWATE/ WDR(NTPDIM),JSKEEM(NTPDIM),IDTYP(100),JDTYP(NTPDIM)
  16236       DATA
  16237      1     IDTYP/1,2,3,4,5,6,7,8,9,10,11,12,13,6*0,14,15,16,17,18,19,
  16238      2           20,23*0,21,22,23,45*0,24,25,0/,JSKEEM/NTPDIM*0/
  16239 C
  16240 C     JDTYP IS THE INVERSE TABLE TO IDTYP
  16241 C
  16242      3     JDTYP/1,2,3,4,5,6,7,8,9,10,11,12,13,20,21,22,23,24,25,26,
  16243      4           50,51,52,7*0/
  16244       END

Page 444         Source Listing                  IBM2
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DWATE                      Common 16235                                760                                                         
 IBM2                       Block  16233                                scalar                                                      
 IDTYP                      Scalar 16235    I(4)            4     1     100      COM,SAVE         16237                             
 JDTYP                      Scalar 16235    I(4)            4     1     30       COM,SAVE         16242                             
 JSKEEM                     Scalar 16235    I(4)            4     1     30       COM,SAVE         16238                             
 NTPDIM                     Param  16234    I(4)            4           scalar                    16235,16238                       
 WDR                        Scalar 16235    R(4)            4     1     30       COM                                                

Page 445         Source Listing                  IBM2
2017-04-18 11:09                                 syndata.f

  16245 
  16246 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16247 C                .      .    .                                       .
  16248 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16249 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16250 C
  16251 C ABSTRACT: ??????????????????????????????????????????????????????????
  16252 C   ??????????????????????????????????????????????????????????????????
  16253 C
  16254 C PROGRAM HISTORY LOG:
  16255 C ????-??-??  S. J. LORD
  16256 C
  16257 C USAGE:    CALL ????????(????)
  16258 C   INPUT ARGUMENT LIST:
  16259 C     ??????   - ???????????????????????????????????????????????
  16260 C
  16261 C   OUTPUT ARGUMENT LIST:
  16262 C     ??????   - ???????????????????????????????????????????????
  16263 C
  16264 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16265 C     ??????   - ???????????????????????????????????????????????
  16266 C
  16267 C   OUTPUT FILES:
  16268 C     ??????   - ???????????????????????????????????????????????
  16269 C
  16270 C REMARKS: ?????????????????????????????????????????????????????
  16271 C
  16272 C ATTRIBUTES:
  16273 C   LANGUAGE: FORTRAN 90
  16274 C   MACHINE:  NCEP WCOSS
  16275 C
  16276 C$$$
  16277       SUBROUTINE WTDAT(JSKMZ,LDXZ,JCELLX,WFACZ,INDXZ)
  16278       PARAMETER (MDIM=35,NDIM=35)
  16279       PARAMETER (LDXDIM=8000)
  16280 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  16281 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  16282       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  16283      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  16284 C
  16285       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  16286      1               ID(LDXDIM),LXSORT(LDXDIM)
  16287 C
  16288       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  16289      1                 YNC(NDIM),COSYN(NDIM)
  16290 
  16291       CHARACTER IDSPC*125,IDSPD1*8,IDSPD2*72
  16292 C
  16293       DIMENSION NMCELL(MDIM,NDIM),INDXZ(LDXDIM)
  16294 C
  16295 C     VAX VERSION, MODIFIED 5/17/88 BY SJL
  16296 C
  16297       GO TO (100,200,300)  JSKMZ+1
  16298       WRITE(6,1)
  16299     1 FORMAT('****** WEIGHTING OPTION NOT ALLOWED BY WTDAT,',
  16300      1       ' DEFAULT APPLIED')
  16301 C

Page 446         Source Listing                  WTDAT
2017-04-18 11:09                                 syndata.f

  16302 C     DEFAULT WEIGHTING IS RELATIVE WEIGHT FOR ALL DATA, IRRESPECTIVE
  16303 C        OF DENSITY.  IN THIS CASE, JCELLX HAS NO MEANING.
  16304 C
  16305   100 JCELLX=-1
  16306       WFACZ=WD(INDXZ(1))
  16307 C      DO 110 LD=1,LDXZ
  16308 C      WD(INDXZ(LD))=WDRZ
  16309 C  110 CONTINUE
  16310       RETURN
  16311 C
  16312 C     OPTION 1: REGULARLY SPACED DATA.  JCELLX IS THE APPROXIMATE
  16313 C               NUMBER OF DATA POINTS PER CELL.  JCELLX=0 INDICATES
  16314 C               LESS THAN 1 POINT PER CELL OVER THE WHOLE MESH.
  16315 C
  16316   200 CONTINUE
  16317       WFAC=REAL(MXX*NXX)/REAL(LDXZ)
  16318       JCELLX=MXX*NXX
  16319       DO 210 LD=1,LDXZ
  16320       WD(INDXZ(LD))=MIN(WFAC*WD(INDXZ(LD)),1.0)
  16321   210 CONTINUE
  16322       WFACZ=WD(INDXZ(1))
  16323       RETURN
  16324 C
  16325 C     OPTION 2: FOR IRREGULARLY SPACED, POSSIBLY LOCALLY CLUMPED, DATA.
  16326 C               JCELLX IS THE APPROXIMATE NUMBER OF DATA POINTS PER
  16327 C               CELL.  JCELLX=0 INDICATES LESS THAN 1 POINT PER CELL
  16328 C               OVER THE WHOLE MESH.
  16329 C
  16330   300 CONTINUE
  16331       NMCELL(1:MXX,1:NXX)=0
  16332 C
  16333       DX0=1./DXM
  16334       DY0=1./DYN
  16335       DO 320 LD=1,LDXZ
  16336       MC=MIN(INT((XD(INDXZ(LD))-XM(1))*DX0)+1,MX)
  16337       NC=MIN(INT((YD(INDXZ(LD))-YN(1))*DY0)+1,NX)
  16338       NMCELL(MC,NC)=NMCELL(MC,NC)+1
  16339   320 CONTINUE
  16340 C
  16341 C     UNIQUE CELL COUNTER
  16342 C
  16343       JCELLX=0
  16344       DO NCZ=1,NXX
  16345       DO MCZ=1,MXX
  16346       IF(NMCELL(MCZ,NCZ) .NE. 0)  JCELLX=JCELLX+1
  16347       ENDDO
  16348       ENDDO
  16349 C
  16350       WFAC=REAL(JCELLX)/REAL(LDXZ)
  16351 C
  16352       DO 340 LD=1,LDXZ
  16353       WD(INDXZ(LD))=MIN(WD(INDXZ(LD))*WFAC,1.0)
  16354   340 CONTINUE
  16355       WFACZ=WD(INDXZ(1))
  16356 C
  16357       RETURN
  16358       END

Page 447         Source Listing                  WTDAT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 wtdat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  16299                                                          16298                             
 100                        Label  16305                                                          16297                             
 200                        Label  16316                                                          16297                             
 210                        Label  16321                                                          16319                             
 300                        Label  16330                                                          16297                             
 320                        Label  16339                                                          16335                             
 340                        Label  16354                                                          16352                             
 COSYN                      Scalar 16289    R(4)            4     1     35       COM                                                
 DX0                        Local  16333    R(4)            4           scalar                    16333,16336                       
 DXM                        Scalar 16288    R(4)            4           scalar   COM              16333                             
 DY0                        Local  16334    R(4)            4           scalar                    16334,16337                       
 DYN                        Scalar 16288    R(4)            4           scalar   COM              16334                             
 ID                         Scalar 16286    I(4)            4     1     8000     COM                                                
 IDSPC                      Scalar 16283    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 16285    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 16285    CHAR            72          scalar   COM                                                
 INDXZ                      Dummy  16277    I(4)            4     1     8000     ARG,INOUT        16306,16320,16322,16336,16337,1635
                                                                                                  3,16355                           
 INT                        Func   16336                                scalar                    16336,16337                       
 ISRCD                      Scalar 16282    I(4)            4           scalar   COM                                                
 JCELLX                     Dummy  16277    I(4)            4           scalar   ARG,INOUT        16305,16318,16343,16346,16350     
 JPD                        Scalar 16282    I(4)            4           scalar   COM                                                
 JSKMZ                      Dummy  16277    I(4)            4           scalar   ARG,INOUT        16297                             
 KBCTYP                     Scalar 16282    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 16282    I(4)            4           scalar   COM                                                
 LD                         Local  16319    I(4)            4           scalar                    16319,16320,16335,16336,16337,1635
                                                                                                  2,16353                           
 LDX                        Scalar 16285    I(4)            4           scalar   COM                                                
 LDXDIM                     Param  16279    I(4)            4           scalar                    16285,16286,16293                 
 LDXZ                       Dummy  16277    I(4)            4           scalar   ARG,INOUT        16317,16319,16335,16350,16352     
 LXSORT                     Scalar 16286    I(4)            4     1     8000     COM                                                
 MC                         Local  16336    I(4)            4           scalar                    16336,16338                       
 MCZ                        Local  16345    I(4)            4           scalar                    16345,16346                       
 MDIM                       Param  16278    I(4)            4           scalar                    16288,16293                       
 MIN                        Func   16320                                scalar                    16320,16336,16337,16353           
 MX                         Scalar 16282    I(4)            4           scalar   COM              16336                             
 MXX                        Scalar 16288    I(4)            4           scalar   COM              16317,16318,16331,16345           
 NC                         Local  16337    I(4)            4           scalar                    16337,16338                       
 NCZ                        Local  16344    I(4)            4           scalar                    16344,16346                       
 NDIM                       Param  16278    I(4)            4           scalar                    16288,16289,16293                 
 NMCELL                     Local  16293    I(4)            4     2     1225                      16331,16338,16346                 
 NX                         Scalar 16282    I(4)            4           scalar   COM              16337                             
 NXX                        Scalar 16288    I(4)            4           scalar   COM              16317,16318,16331,16344           
 REAL                       Func   16317                                scalar                    16317,16350                       

Page 448         Source Listing                  WTDAT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 S2DTPT                     Common 16285                                160084                                                      
 S2NODE                     Common 16288                                716                                                         
 S2PRIC                     Common 16282                                217                                                         
 WD                         Scalar 16285    R(4)            4     1     8000     COM              16306,16320,16322,16353,16355     
 WFAC                       Local  16317    R(4)            4           scalar                    16317,16320,16350,16353           
 WFACZ                      Dummy  16277    R(4)            4           scalar   ARG,INOUT        16306,16322,16355                 
 WTDAT                      Subr   16277                                                                                            
 XD                         Scalar 16285    R(4)            4     1     8000     COM              16336                             
 XM                         Scalar 16288    R(4)            4     1     35       COM              16336                             
 XM1                        Scalar 16283    R(4)            4           scalar   COM                                                
 XMC                        Scalar 16288    R(4)            4     1     35       COM                                                
 XML                        Scalar 16282    R(4)            4           scalar   COM                                                
 XMR                        Scalar 16282    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 16283    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 16283    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 16283    R(4)            4     1     2        COM                                                
 YD                         Scalar 16285    R(4)            4     1     8000     COM              16337                             
 YN                         Scalar 16288    R(4)            4     1     35       COM              16337                             
 YN1                        Scalar 16283    R(4)            4           scalar   COM                                                
 YNB                        Scalar 16282    R(4)            4           scalar   COM                                                
 YNC                        Scalar 16289    R(4)            4     1     35       COM                                                
 YNT                        Scalar 16282    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 16283    R(4)            4           scalar   COM                                                

Page 449         Source Listing                  WTDAT
2017-04-18 11:09                                 syndata.f

  16359 
  16360 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16361 C                .      .    .                                       .
  16362 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16363 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16364 C
  16365 C ABSTRACT: ??????????????????????????????????????????????????????????
  16366 C   ??????????????????????????????????????????????????????????????????
  16367 C
  16368 C PROGRAM HISTORY LOG:
  16369 C ????-??-??  S. J. LORD
  16370 C
  16371 C USAGE:    CALL ????????(????)
  16372 C   INPUT ARGUMENT LIST:
  16373 C     ??????   - ???????????????????????????????????????????????
  16374 C
  16375 C   OUTPUT ARGUMENT LIST:
  16376 C     ??????   - ???????????????????????????????????????????????
  16377 C
  16378 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16379 C     ??????   - ???????????????????????????????????????????????
  16380 C
  16381 C   OUTPUT FILES:
  16382 C     ??????   - ???????????????????????????????????????????????
  16383 C
  16384 C REMARKS: ?????????????????????????????????????????????????????
  16385 C
  16386 C ATTRIBUTES:
  16387 C   LANGUAGE: FORTRAN 90
  16388 C   MACHINE:  NCEP WCOSS
  16389 C
  16390 C$$$
  16391       SUBROUTINE RWT
  16392       PARAMETER (NTPDIM=30)
  16393       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  16394      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
  16395      2            MSKD15,MSKD16,MSKD17,MSKD18
  16396       COMMON /DWATE/ WDR(NTPDIM),JSKEEM(NTPDIM),IDTYP(100),JDTYP(NTPDIM)
  16397 C
  16398       SAVE
  16399 C
  16400       DIMENSION WREL(NTPDIM)
  16401 C
  16402 CIBM  INITIALIZATION OF JSKEEM HAS BEEN MOVED TO THE BLOCK DATA
  16403 CIBM     BEFORE SUBROUTINE VICSPL
  16404 CIBM  DATA WREL/NTPDIM*1.0/,JSKEEM/NTPDIM*0/
  16405       DATA WREL/NTPDIM*1.0/
  16406 C
  16407       WDR=WREL
  16408 C
  16409 C     EXCEPTIONS TO THE RELATIVE WEIGHTS AND DATA WEIGHTING SCHEMES FOR
  16410 C       EACH DATA TYPE ARE READ FROM AN EXTERNAL FILE.
  16411 C       OPEN FILE FOR DATA SCHEMES AND RELATIVE WEIGHTS.
  16412 C
  16413 CVAX  OPEN(UNIT=MSKD15,FILE='WEIGHT',STATUS='OLD',READONLY,SHARED)
  16414 CIBM  OPEN(UNIT=MSKD15,FILE='WEIGHT',STATUS='OLD',ACTION='READ')
  16415 C

Page 450         Source Listing                  RWT
2017-04-18 11:09                                 syndata.f

  16416 C     FILE OPENS NOT USED ON CRAY
  16417 C
  16418 C     OPEN(UNIT=MSKD15,FILE='WEIGHT',STATUS='OLD')
  16419 C     OPEN(UNIT=MSKD15,STATUS='OLD')
  16420 C
  16421       READ(MSKD15,11)
  16422    11 FORMAT(A)
  16423       DO 20 NTPZ=1,NTPDIM
  16424       READ(MSKD15,*,END=30) NTP,JDTYPZ,JSKEEM(NTP),WDR(NTP)
  16425 C
  16426 C     ERROR CATCHER
  16427 C
  16428       IF(JDTYPZ .NE. JDTYP(NTP)) GO TO 900
  16429    20 CONTINUE
  16430    30 CLOSE(UNIT=MSKD15,STATUS='KEEP')
  16431       RETURN
  16432 C
  16433   900 WRITE(6,901) NTPZ,JDTYPZ,NTP,JDTYP(NTP)
  16434   901 FORMAT('****** ERROR READING DATA TYPES IN RWT, NTPZ,JDTYPZ,',
  16435      1       'NTP,JDTYP(NTP)=',4I5)
  16436       END


ENTRY POINTS

  Name            
                  
 rwt_             

Page 451         Source Listing                  RWT
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  16422                                                          16421                             
 20                         Label  16429                                                          16423                             
 30                         Label  16430                                                          16424                             
 900                        Label  16433                                                          16428                             
 901                        Label  16434                                                          16433                             
 DSK                        Common 16393                                76       SAVE                                               
 DWATE                      Common 16396                                760      SAVE                                               
 IDTYP                      Scalar 16396    I(4)            4     1     100      COM                                                
 JDTYP                      Scalar 16396    I(4)            4     1     30       COM              16428,16433                       
 JDTYPZ                     Local  16424    I(4)            4           scalar   SAVE             16424,16428,16433                 
 JSKEEM                     Scalar 16396    I(4)            4     1     30       COM              16424                             
 MSKD11                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 16395    I(4)            4           scalar   COM              16421,16424,16430                 
 MSKD16                     Scalar 16395    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 16395    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 16395    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 16393    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 16393    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 16393    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 16393    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 16393    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 16393    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 16394    I(4)            4           scalar   COM                                                
 MSKEF                      Scalar 16393    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 16393    I(4)            4           scalar   COM                                                
 NTP                        Local  16424    I(4)            4           scalar   SAVE             16424,16428,16433                 
 NTPDIM                     Param  16392    I(4)            4           scalar                    16396,16400,16405,16423           
 NTPZ                       Local  16423    I(4)            4           scalar   SAVE             16423,16433                       
 RWT                        Subr   16391                                                                                            
 WDR                        Scalar 16396    R(4)            4     1     30       COM              16407,16424                       
 WREL                       Local  16400    R(4)            4     1     30       SAVE             16405,16407                       

Page 452         Source Listing                  RWT
2017-04-18 11:09                                 syndata.f

  16437 
  16438 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16439 C                .      .    .                                       .
  16440 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16441 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16442 C
  16443 C ABSTRACT: ??????????????????????????????????????????????????????????
  16444 C   ??????????????????????????????????????????????????????????????????
  16445 C
  16446 C PROGRAM HISTORY LOG:
  16447 C ????-??-??  S. J. LORD
  16448 C
  16449 C USAGE:    CALL ????????(????)
  16450 C   INPUT ARGUMENT LIST:
  16451 C     ??????   - ???????????????????????????????????????????????
  16452 C
  16453 C   OUTPUT ARGUMENT LIST:
  16454 C     ??????   - ???????????????????????????????????????????????
  16455 C
  16456 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16457 C     ??????   - ???????????????????????????????????????????????
  16458 C
  16459 C   OUTPUT FILES:
  16460 C     ??????   - ???????????????????????????????????????????????
  16461 C
  16462 C REMARKS: ?????????????????????????????????????????????????????
  16463 C
  16464 C ATTRIBUTES:
  16465 C   LANGUAGE: FORTRAN 90
  16466 C   MACHINE:  NCEP WCOSS
  16467 C
  16468 C$$$
  16469       SUBROUTINE OUTSTT(NVZ,KLZ,NRMS,RMS,RMEAN)
  16470       PARAMETER (LDXDIM=8000)
  16471       PARAMETER (NFXDIM=20,NTPDIM=30)
  16472       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  16473      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,MSKD14,
  16474      2            MSKD15,MSKD16,MSKD17,MSKD18
  16475       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  16476      1           WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),ELORG,GLORG,
  16477      2           XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  16478       COMMON /DWATE/ WDR(NTPDIM),JSKEEM(NTPDIM),IDTYP(100),JDTYP(NTPDIM)
  16479 C
  16480       SAVE
  16481 C
  16482       DIMENSION NRMS(NTPDIM),RMS(NTPDIM),RMEAN(NTPDIM)
  16483 C
  16484 
  16485 C-----------------------------------------------------------------------
  16486 
  16487       ENTRY OUTST1
  16488 CIBM  OPEN(UNIT=MSKD16,FILE='DSTAT',STATUS='NEW',RECL=170)
  16489       OPEN(UNIT=MSKD16,FILE='DSTAT',STATUS='UNKNOWN')
  16490       WRITE(MSKD16,1) JDAY0,IFIX(UTC0),NTPDIM
  16491       WRITE(MSKD16,2) (JDTYP(NTP),NTP=1,NTPDIM)
  16492       WRITE(MSKD16,2) (JSKEEM(NTP),NTP=1,NTPDIM)
  16493     1 FORMAT(I9,1X,I4,I3)

Page 453         Source Listing                  OUTSTT
2017-04-18 11:09                                 syndata.f

  16494     2 FORMAT(20I3)
  16495       RETURN
  16496 C
  16497 
  16498 C-----------------------------------------------------------------------
  16499 
  16500       ENTRY OUTST2(NVZ,KLZ,NRMS,RMS,RMEAN)
  16501       WRITE(6,11) NVZ,KLZ
  16502       WRITE(MSKD16,12) NVZ,KLZ,(NRMS (NTP),NTP=1,NTPDIM)
  16503       WRITE(MSKD16,13) (RMS   (NTP),NTP=1,NTPDIM)
  16504       WRITE(MSKD16,13) (RMEAN(NTP),NTP=1,NTPDIM)
  16505    11 FORMAT(/'...DEVIATION STATISTICS FOR VARIABLE #',I3,
  16506      1       ' AND LEVEL=',I3,' HAVE BEEN WRITTEN TO DISK.')
  16507    12 FORMAT(2I3,20I8,/,7X,20I8)
  16508    13 FORMAT(6X,20F8.2)
  16509 C
  16510       RETURN
  16511       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 outst1_               outst2_               outstt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  16493                                                          16490                             
 11                         Label  16505                                                          16501                             
 12                         Label  16507                                                          16502                             
 13                         Label  16508                                                          16503,16504                       
 2                          Label  16494                                                          16491,16492                       
 DSK                        Common 16472                                76       SAVE                                               
 DWATE                      Common 16478                                760      SAVE                                               
 ELORG                      Scalar 16476    R(4)            4           scalar   COM                                                
 GLORG                      Scalar 16476    R(4)            4           scalar   COM                                                
 IDAYMN                     Scalar 16477    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 16475    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 16476    I(4)            4     1     20       COM                                                
 IDTYP                      Scalar 16478    I(4)            4     1     100      COM                                                
 IFIX                       Func   16490                                scalar                    16490                             
 JDAY0                      Scalar 16477    I(4)            4           scalar   COM              16490                             
 JDTYP                      Scalar 16478    I(4)            4     1     30       COM              16491                             
 JSKEEM                     Scalar 16478    I(4)            4     1     30       COM              16492                             
 KLZ                        Dummy  16469    I(4)            4           scalar   ARG,INOUT        16501,16502                       
 LDXDIM                     Param  16470    I(4)            4           scalar                    16475                             
 MSKD11                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 16474    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 16474    I(4)            4           scalar   COM              16489,16490,16491,16492,16502,1650
                                                                                                  3,16504                           

Page 454         Source Listing                  OUTSTT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKD17                     Scalar 16474    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 16474    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 16472    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 16472    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 16472    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 16472    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 16472    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 16472    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 16473    I(4)            4           scalar   COM                                                
 MSKEF                      Scalar 16472    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 16472    I(4)            4           scalar   COM                                                
 NFIX0                      Scalar 16477    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  16471    I(4)            4           scalar                    16475,16476                       
 NRMS                       Dummy  16469    I(4)            4     1     30       ARG,INOUT        16502                             
 NTP                        Local  16491    I(4)            4           scalar   SAVE             16491,16492,16502,16503,16504     
 NTPDIM                     Param  16471    I(4)            4           scalar                    16478,16482,16490,16491,16492,1650
                                                                                                  2,16503,16504                     
 NVZ                        Dummy  16469    I(4)            4           scalar   ARG,INOUT        16501,16502                       
 OUTST1                     Subr   16487                                                                                            
 OUTST2                     Subr   16500                                                                                            
 OUTSTT                     Subr   16469                                                                                            
 RMEAN                      Dummy  16469    R(4)            4     1     30       ARG,INOUT        16504                             
 RMS                        Dummy  16469    R(4)            4     1     30       ARG,INOUT        16503                             
 UTC0                       Scalar 16477    R(4)            4           scalar   COM              16490                             
 UTCOB                      Scalar 16475    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 16476    R(4)            4     1     20       COM                                                
 WDR                        Scalar 16478    R(4)            4     1     30       COM                                                
 WSTM                       Scalar 16476    R(4)            4     1     20       COM                                                
 XSTM                       Scalar 16475    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 16477    R(4)            4           scalar   COM                                                
 XYT                        Common 16475                                64432    SAVE                                               
 YSTM                       Scalar 16475    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 16477    R(4)            4           scalar   COM                                                

Page 455         Source Listing                  OUTSTT
2017-04-18 11:09                                 syndata.f

  16512 
  16513 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16514 C                .      .    .                                       .
  16515 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16516 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16517 C
  16518 C ABSTRACT: ??????????????????????????????????????????????????????????
  16519 C   ??????????????????????????????????????????????????????????????????
  16520 C
  16521 C PROGRAM HISTORY LOG:
  16522 C ????-??-??  S. J. LORD
  16523 C
  16524 C USAGE:    CALL ????????(????)
  16525 C   INPUT ARGUMENT LIST:
  16526 C     ??????   - ???????????????????????????????????????????????
  16527 C
  16528 C   OUTPUT ARGUMENT LIST:
  16529 C     ??????   - ???????????????????????????????????????????????
  16530 C
  16531 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16532 C     ??????   - ???????????????????????????????????????????????
  16533 C
  16534 C   OUTPUT FILES:
  16535 C     ??????   - ???????????????????????????????????????????????
  16536 C
  16537 C REMARKS: ?????????????????????????????????????????????????????
  16538 C
  16539 C ATTRIBUTES:
  16540 C   LANGUAGE: FORTRAN 90
  16541 C   MACHINE:  NCEP WCOSS
  16542 C
  16543 C$$$
  16544       SUBROUTINE GETSVF(IUNTQF,KDXX,KDZ,MAXFND,YSPOT,XSPOT,RAD)
  16545 
  16546       PARAMETER (KLDIM= 8)
  16547       PARAMETER(KVDIM=20,KDTDIM=5)
  16548       PARAMETER (KPXDIM=KVDIM*KLDIM)
  16549 
  16550       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  16551       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  16552      1                 DMEAN(KDTDIM*KLDIM)
  16553       CHARACTER IDSPK*40
  16554       CHARACTER MAXFNZ*1
  16555       LOGICAL RHANL,MAXFND
  16556 
  16557       SAVE
  16558 
  16559       REWIND IUNTQF
  16560       NREC=0
  16561 
  16562 
  16563 C-----------------------------------------------------------------------
  16564 
  16565       ENTRY GETSVM(IUNTQF,KDXX,KDZ,MAXFND,YSPOT,XSPOT,RAD)
  16566 C
  16567 C     READ REQUESTED VARIABLES FOR TRACKING
  16568 C

Page 456         Source Listing                  GETSVF
2017-04-18 11:09                                 syndata.f

  16569       NREC=NREC+1
  16570       READ(IUNTQF,11,END=50)  IDVZZ,PRESZ,YSPOTZ,XSPOTZ,RADZ,MAXFNZ
  16571    11 FORMAT(I4,4F10.2,1X,A)
  16572 C
  16573 C     TRANSLATE REQUESTED VARIABLES TO SPLINE VARIABLE PARLANCE
  16574 C
  16575       IDVZ=IDVZZ
  16576       IF(IDVZZ .EQ. 5)  IDVZ=18
  16577 C
  16578 C     SCAN THROUGH ALL AVAILABLE SPLINE VARIABLES TO FIND THE MATCHING
  16579 C       INDEX
  16580 C
  16581       DO 30 KDXZ=1,KDXX
  16582       IF(NINT(PLEV(IDLEV(KDXZ))*10.) .EQ. NINT(PRESZ*10.) .AND.
  16583      $  IDVAR(KDXZ) .EQ. IDVZ)  THEN
  16584       KDZ=KDXZ
  16585       WRITE(6,23) NREC,IDLEV(KDXZ),PLEV(IDLEV(KDXZ)),IDVAR(KDXZ)
  16586    23 FORMAT('...FOUND VARIABLE AND LEVEL,NREC,IDLEV(KDXZ),',
  16587      1       'PLEV(IDLEV(KDXZ)),IDVAR(KDXZ)=',/,4X,2I5,F8.1,I5)
  16588       IF(MAXFNZ .EQ. 'N' .OR. MAXFNZ .EQ. 'N')  THEN
  16589       MAXFND=.FALSE.
  16590       ELSE
  16591       MAXFND=.TRUE.
  16592       ENDIF
  16593       YSPOT=YSPOTZ
  16594       XSPOT=XSPOTZ
  16595       RAD=RADZ
  16596       RETURN
  16597       ENDIF
  16598    30 CONTINUE
  16599       KDZ=-1
  16600       WRITE(6,31)  IDVZ,PRESZ
  16601    31 FORMAT(/'###VARIABLE=',I3,' AT PRESSURE=',F8.1,' NOT FOUND BY ',
  16602      1       'GETSVF/M')
  16603       RETURN
  16604 
  16605    50 CONTINUE
  16606       WRITE(6,51)  NREC
  16607    51 FORMAT(/'...ALL REQUESTED VARIABLES HAVE BEEN PROCESSED BY ',
  16608      1       'GETSVF/M. NREC=',I3)
  16609       KDZ=-99
  16610       RETURN
  16611 
  16612       END

Page 457         Source Listing                  GETSVF
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name               
                                           
 getsvf_               getsvm_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  16571                                                          16570                             
 23                         Label  16586                                                          16585                             
 30                         Label  16598                                                          16581                             
 31                         Label  16601                                                          16600                             
 50                         Label  16605                                                          16570                             
 51                         Label  16607                                                          16606                             
 DATREC                     Scalar 16550    R(4)            4     1     6        COM                                                
 DMEAN                      Scalar 16552    R(4)            4     1     40       COM                                                
 GETSVF                     Subr   16544                                                                                            
 GETSVM                     Subr   16565                                                                                            
 ICOOR                      Scalar 16550    I(4)            4           scalar   COM                                                
 IDAT                       Scalar 16550    I(4)            4           scalar   COM                                                
 IDATZ                      Scalar 16550    I(4)            4           scalar   COM                                                
 IDLEV                      Scalar 16551    I(4)            4     1     160      COM              16582,16585                       
 IDSPK                      Scalar 16551    CHAR            40    1     160      COM                                                
 IDVAR                      Scalar 16551    I(4)            4     1     160      COM              16583,16585                       
 IDVZ                       Local  16575    I(4)            4           scalar   SAVE             16575,16576,16583,16600           
 IDVZZ                      Local  16570    I(4)            4           scalar   SAVE             16570,16575,16576                 
 IUNTQF                     Dummy  16544    I(4)            4           scalar   ARG,INOUT        16559,16570                       
 KDTDIM                     Param  16547    I(4)            4           scalar                    16550,16552                       
 KDXX                       Dummy  16544    I(4)            4           scalar   ARG,INOUT        16581                             
 KDXZ                       Local  16581    I(4)            4           scalar   SAVE             16581,16582,16583,16584,16585     
 KDZ                        Dummy  16544    I(4)            4           scalar   ARG,INOUT        16584,16599,16609                 
 KLDIM                      Param  16546    I(4)            4           scalar                    16548,16550,16552                 
 KPX                        Scalar 16551    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  16548    I(4)            4           scalar                    16551                             
 KVDIM                      Param  16547    I(4)            4           scalar                    16548                             
 MAXFND                     Dummy  16544    L(4)            4           scalar   ARG,INOUT        16589,16591                       
 MAXFNZ                     Local  16554    CHAR            1           scalar   SAVE             16570,16588                       
 NINT                       Func   16582                                scalar                    16582                             
 NREC                       Local  16560    I(4)            4           scalar   SAVE             16560,16569,16585,16606           
 PLEV                       Scalar 16550    R(4)            4     1     8        COM              16582,16585                       
 PRES                       Common 16550                                72       SAVE                                               
 PRESZ                      Local  16570    R(4)            4           scalar   SAVE             16570,16582,16600                 
 RAD                        Dummy  16544    R(4)            4           scalar   ARG,INOUT        16595                             
 RADZ                       Local  16570    R(4)            4           scalar   SAVE             16570,16595                       
 RHANL                      Scalar 16550    L(4)            4           scalar   COM                                                
 S2KOMP                     Common 16551                                7844     SAVE                                               
 XSPOT                      Dummy  16544    R(4)            4           scalar   ARG,INOUT        16594                             
 XSPOTZ                     Local  16570    R(4)            4           scalar   SAVE             16570,16594                       
 YSPOT                      Dummy  16544    R(4)            4           scalar   ARG,INOUT        16593                             
 YSPOTZ                     Local  16570    R(4)            4           scalar   SAVE             16570,16593                       

Page 458         Source Listing                  GETSVF
2017-04-18 11:09                                 syndata.f

  16613 
  16614 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16615 C                .      .    .                                       .
  16616 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16617 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16618 C
  16619 C ABSTRACT: ??????????????????????????????????????????????????????????
  16620 C   ??????????????????????????????????????????????????????????????????
  16621 C
  16622 C PROGRAM HISTORY LOG:
  16623 C ????-??-??  S. J. LORD
  16624 C
  16625 C USAGE:    CALL ????????(????)
  16626 C   INPUT ARGUMENT LIST:
  16627 C     ??????   - ???????????????????????????????????????????????
  16628 C
  16629 C   OUTPUT ARGUMENT LIST:
  16630 C     ??????   - ???????????????????????????????????????????????
  16631 C
  16632 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16633 C     ??????   - ???????????????????????????????????????????????
  16634 C
  16635 C   OUTPUT FILES:
  16636 C     ??????   - ???????????????????????????????????????????????
  16637 C
  16638 C REMARKS: ?????????????????????????????????????????????????????
  16639 C
  16640 C ATTRIBUTES:
  16641 C   LANGUAGE: FORTRAN 90
  16642 C   MACHINE:  NCEP WCOSS
  16643 C
  16644 C$$$
  16645       SUBROUTINE OUTSV(IUNTQL,IDVW,IDLZ,YLAT,XLON,VALZ)
  16646 
  16647       PARAMETER (KLDIM= 8)
  16648       PARAMETER (KDTDIM=5)
  16649 
  16650       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  16651 
  16652       SAVE
  16653 
  16654       IF(IABS(IDVW) .EQ. 18)  THEN
  16655       IDVW=ISIGN(5,IDVW)
  16656       ENDIF
  16657       WRITE(IUNTQL,101)  IDVW,PLEV(IDLZ),YLAT,XLON,VALZ
  16658       WRITE(6     ,103)  IDVW,PLEV(IDLZ),YLAT,XLON,VALZ
  16659   101 FORMAT(I3,F10.1,2F12.4,E14.6)
  16660   103 FORMAT('...WRITING TO LOCATION FILE. VARIABLE, PRESSURE,LAT,LON,',
  16661      1       'VALUE=',/,1X,I3,F10.1,2F12.4,E14.6)
  16662       RETURN
  16663       END

Page 459         Source Listing                  OUTSV
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 outsv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  16659                                                          16657                             
 103                        Label  16660                                                          16658                             
 DATREC                     Scalar 16650    R(4)            4     1     6        COM                                                
 IABS                       Func   16654                                scalar                    16654                             
 ICOOR                      Scalar 16650    I(4)            4           scalar   COM                                                
 IDAT                       Scalar 16650    I(4)            4           scalar   COM                                                
 IDATZ                      Scalar 16650    I(4)            4           scalar   COM                                                
 IDLZ                       Dummy  16645    I(4)            4           scalar   ARG,INOUT        16657,16658                       
 IDVW                       Dummy  16645    I(4)            4           scalar   ARG,INOUT        16654,16655,16657,16658           
 ISIGN                      Func   16655                                scalar                    16655                             
 IUNTQL                     Dummy  16645    I(4)            4           scalar   ARG,INOUT        16657                             
 KDTDIM                     Param  16648    I(4)            4           scalar                    16650                             
 KLDIM                      Param  16647    I(4)            4           scalar                    16650                             
 OUTSV                      Subr   16645                                                                                            
 PLEV                       Scalar 16650    R(4)            4     1     8        COM              16657,16658                       
 PRES                       Common 16650                                72       SAVE                                               
 RHANL                      Scalar 16650    R(4)            4           scalar   COM                                                
 VALZ                       Dummy  16645    R(4)            4           scalar   ARG,INOUT        16657,16658                       
 XLON                       Dummy  16645    R(4)            4           scalar   ARG,INOUT        16657,16658                       
 YLAT                       Dummy  16645    R(4)            4           scalar   ARG,INOUT        16657,16658                       

Page 460         Source Listing                  OUTSV
2017-04-18 11:09                                 syndata.f

  16664 
  16665 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  16666 C                .      .    .                                       .
  16667 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  16668 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  16669 C
  16670 C ABSTRACT: ??????????????????????????????????????????????????????????
  16671 C   ??????????????????????????????????????????????????????????????????
  16672 C
  16673 C PROGRAM HISTORY LOG:
  16674 C ????-??-??  S. J. LORD
  16675 C
  16676 C USAGE:    CALL ????????(????)
  16677 C   INPUT ARGUMENT LIST:
  16678 C     ??????   - ???????????????????????????????????????????????
  16679 C
  16680 C   OUTPUT ARGUMENT LIST:
  16681 C     ??????   - ???????????????????????????????????????????????
  16682 C
  16683 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  16684 C     ??????   - ???????????????????????????????????????????????
  16685 C
  16686 C   OUTPUT FILES:
  16687 C     ??????   - ???????????????????????????????????????????????
  16688 C
  16689 C REMARKS: ?????????????????????????????????????????????????????
  16690 C
  16691 C ATTRIBUTES:
  16692 C   LANGUAGE: FORTRAN 90
  16693 C   MACHINE:  NCEP WCOSS
  16694 C
  16695 C$$$
  16696 C                 SLOVER **   06/06/84
  16697 C                             SLOCCO ADDED FOR CORNER CONDITIONS
  16698 C
  16699 C     ++ ASSUMED DIM PARAMETERS ... MDIM=47...NDIM=35,
  16700 C                               ... KLDIM=19
  16701 C                               ... KVDIM= 7,
  16702 C
  16703       SUBROUTINE SLOSUB(IDSPCZ,MXZ,NXZ,NSWLN,XMLZ,XMRZ,YNBZ,YNTZ,JPDZ,
  16704      1                  ISRCDZ,IHCZ,ELORG,GLORG,XSTM,YSTM,LLWLZ,KDCTYZ,
  16705      2                  XYDCW1,XYDCW2,KBCTY1,KBCTY2,KBCTY3,KBCTY4,
  16706      3                  XYBCW1,XYBCW2,XYBCW3,XYBCW4)
  16707 C
  16708 C     ** COMPILATION PARAMETERS **
  16709 C
  16710       PARAMETER (MDIM=35,NDIM=35)
  16711       parameter (iarg_5=1)
  16712 C
  16713 C     MDIM     ARRAY DIMENSION FOR NODAL INDEX M IN THE X DIRECTION
  16714 C     NDIM     ARRAY DIMENSION FOR NODAL INDEX N IN THE Y DIRECTION
  16715 C
  16716 C     ** PRIMARY CONSTANTS FOR SPLINE ANALYSIS PACKAGE
  16717 C
  16718 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  16719 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  16720       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,

Page 461         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  16721      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  16722 C
  16723 C     ** SECONDARY CONSTANTS FOR CONVENIENCE, DEFINED BY SLOVER
  16724 C
  16725       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  16726      1                 YNC(NDIM),COSYN(NDIM)
  16727       COMMON /S2BCDC/ DX0,DX1,DX2,DY0,DY1,DY2,CBCBF(8),XYSDCP(2)
  16728 C
  16729 C     ** DEFINED BY SLOCCO,CALLED WITHIN SLOVER
  16730 C
  16731       COMMON /WLCONV/ DXF,DYF,DXORG,DYORG
  16732 C
  16733       SAVE
  16734 C
  16735 C     ** DUMMY ARGUMENT
  16736 C
  16737       CHARACTER*125 IDSPCZ,IDSPC,ULBL*15
  16738       LOGICAL LLWL,LLWLZ
  16739 
  16740       REAL(8)  COSDEG_8
  16741 C
  16742 C     ** LOCAL WORK SPACE
  16743 C
  16744       DIMENSION XYSBCP(4),ZC(2)
  16745       dimension xml_1(iarg_5),ynb_1(iarg_5)
  16746       dimension xm1_1(iarg_5),yn1_1(iarg_5)
  16747       dimension xmr_1(iarg_5),ynt_1(iarg_5)
  16748       dimension xmxx_1(iarg_5),ynxx_1(iarg_5)
  16749       dimension xstmz_1(iarg_5),ystmz_1(iarg_5)
  16750       dimension xstm_1(iarg_5),ystm_1(iarg_5)
  16751       dimension elorgp1_1(iarg_5),glorgp1_1(iarg_5)
  16752       dimension dxorg_1(iarg_5),dyorg_1(iarg_5)
  16753 C
  16754 C     ** NUMERICAL CONSTANTS
  16755       DATA PI2/6.283185307180/,NFIRST/1/
  16756 C
  16757 
  16758 C-----------------------------------------------------------------------
  16759 
  16760       ENTRY SLOVER
  16761 C
  16762 C     TIMING
  16763 C
  16764       IZERO = 0
  16765       INSEC = ISECND(IZERO)
  16766 C
  16767 C     ** OVERHEAD CHORES FOR TWO-D SPLINE ANALYSIS AND INVERSE TRANSFORM
  16768 C
  16769 C     INPUT    ALL THE PRIMARY CONSTANTS IN /S2PRIC/
  16770 C              IDSPC .. CODE AND EXPLANATION (80 CHARACTERS)
  16771 C
  16772 C     OUTPUT   ALL THE SECONDARY CONSTANTS IN /S2NODE/ AND /S2BCDC/
  16773 C
  16774 C     ENTRIES FOR DEFINING THE PRIMARY CONSTANTS
  16775 C              STSPID(IDSPCZ)
  16776 C              STSPND(MXZ,NXZ)
  16777 C              STDOMN(NSWLN,XMLZ,XMRZ,YNBZ,YNTZ,JPDZ,ISRCDZ)

Page 462         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  16778 C              STHORC(IHCZ,XSTM,YSTM)
  16779 C              STSPDC(KDCTYZ,XYDCW1,XYDCW2)
  16780 C
  16781 C     ENTRIES FOR PRINT OUTPUT
  16782 C              PROVRC ... TO PRINT /S2PRIC/
  16783 C              PRBCDC ... TO PRINT /S2BCDC/ AND XYSBCP
  16784 C
  16785 C     SECONDARY CONSTANTS
  16786 C
  16787       MXX=MX+1
  16788       DXM=(XMXX-XM1)/REAL(MX)
  16789       XM(1)=XM1
  16790       NXX=NX+1
  16791       DYN=(YNXX-YN1)/REAL(NX)
  16792       YN(1)=YN1
  16793 C
  16794 C     CHECK IF MDIM AND NDIM ARE LARGER THAN THE NUMBER OF NODAL INTERVA
  16795 C
  16796       IF(MXX.GT.MDIM.OR.NXX.GT.NDIM) GO TO 90
  16797 C
  16798 C     SET NODAL POINTS IN BOTH EARTH- AND STORM-RELATIVE COORDINATES
  16799 C     XMC AND YNC ARE IN EARTH-RELATIVE COORDINATES, COSYN IS COS(YNC)
  16800 C     XM AND YN ARE IN STORM-RELATIVE COORDINATES
  16801 C
  16802       DO M=2,MXX
  16803          XM(M)=XM1+(M-1)*DXM
  16804       ENDDO
  16805 C
  16806 C
  16807       DO N=2,NXX
  16808          YN(N)=YN1+(N-1)*DYN
  16809       ENDDO
  16810 C
  16811 C
  16812       COSYN(NXX)=COSDEG_8(YNT)
  16813       IF(IHC .EQ. 0)  THEN
  16814         XMC(1)=ABS(XML)
  16815         YNC(1)=YNB
  16816         DO M=2,MXX
  16817           XMC(M)=ABS(XML+(M-1)*DXM)
  16818         ENDDO
  16819         DO N=2,NXX
  16820           YNC(N)=YNB+(N-1)*DYN
  16821           COSYN(NXX+1-N)=COSDEG_8(YNT-(N-1)*DYN)
  16822         ENDDO
  16823       ELSE
  16824         DO 21 N=1,NXX
  16825           CALL MERCLL(XM(1),YN(N),XMC(1),YNC(N),1)
  16826           COSYN(NXX+1-N)=COSDEG_8(YNT-(N-1)*DYN)
  16827    21   CONTINUE
  16828         DO 22 M=1,MXX
  16829           CALL MERCLL(XM(M),YN(1),XMC(M),YNC(1),1)
  16830           XMC(M)=ABS(XMC(M))
  16831    22   CONTINUE
  16832       ENDIF
  16833 C
  16834 C     CONSTANTS FOR BASIS FUNCTION CALCULATION

Page 463         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  16835 C
  16836       DX0=1./DXM
  16837       DX1=3.*DX0
  16838       DX2=6.*DX0**2
  16839       DY0=1./DYN
  16840       DY1=3.*DY0
  16841       DY2=6.*DY0**2
  16842 
  16843 C
  16844 C     ** DC AND BC CONSTANTS ARE NONDIMENSIONALIZED, ZC IS LENGTH OF AN
  16845 C     XYDCWL AND XYBCWL (FILTER BOUNDARY CONDITION WAVELENGTHS) MUST BE
  16846 C     IN METERS OR DEG. LAT/LON.
  16847 C
  16848 C     CONVERT TO UNITS OF DELTAY IN BOTH X AND Y DIRECTIONS
  16849 C
  16850       IF(LLWL)  THEN
  16851 C
  16852 C     CONVERT TO DEG. LAT.
  16853 C
  16854       DYF=DYORG
  16855       DXF=DXORG
  16856 C
  16857 C     CONVERT TO DELTAY UNITS
  16858 C
  16859       ELSE
  16860       DYF=DYN
  16861       DXF=DYF
  16862       ENDIF
  16863 C
  16864       IF(NFIRST .EQ. 0)  THEN
  16865         XYDCWL(1)=XYDCWL(1)*DXF
  16866         XYDCWL(2)=XYDCWL(2)*DYF
  16867         XYBCWL(1)=XYBCWL(1)*DXF
  16868         XYBCWL(2)=XYBCWL(2)*DXF
  16869         XYBCWL(3)=XYBCWL(3)*DYF
  16870         XYBCWL(4)=XYBCWL(4)*DYF
  16871       ENDIF
  16872       Z=1./PI2
  16873       ZC(1)=Z/DXM
  16874       ZC(2)=Z/DYN
  16875 C
  16876       DO K=1,2
  16877          XYSDCP(K)     =ZC(K)*XYDCWL(K)
  16878          XYSBCP(2*K-1)=ZC(K)*XYBCWL(2*K-1)
  16879          XYSBCP(2*K)   =ZC(K)*XYBCWL(2*K)
  16880       ENDDO
  16881 C
  16882 C     ** BOUNDARY LINES ... K=1 AT XM1, =2 AT XMXX, =3 AT YN1, =4 AT YNX
  16883 C     ** BOUNDARY CONDITION TYPES (PERIODIC CONDITION IS NOT INCLUDED, 0
  16884 C     KBCTYP= 0 ... XSBF=0  ( YSBF=0.  SIMILAR FOR Y, IN ALL BELOW)
  16885 C             1 ... DXSBF=0
  16886 C             2 ... DDXSBF=0
  16887 C            10 ... (-/+)XSBCPI*DXSBF+XSBF=0     (- AT XM1, + AT XMXX)
  16888 C            20 ... (XSBCPI**2)*DDXSBF+XSBF=0
  16889 C            21 ... (-/+)XSBCPI*DDXSBF+DXSBF=0
  16890 C     ** COEFFICIENTS DEFINING XBF AND YBF AT THE BOUNDARY
  16891 C

Page 464         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  16892       DO 38 K=1,4
  16893       KK=2*K-1
  16894       IF(KBCTYP(K).EQ. 0) GO TO 31
  16895       IF(KBCTYP(K).EQ. 1) GO TO 32
  16896       IF(KBCTYP(K).EQ. 2) GO TO 33
  16897       IF(KBCTYP(K).EQ.10) GO TO 34
  16898       IF(KBCTYP(K).EQ.20) GO TO 35
  16899       IF(KBCTYP(K).EQ.21) GO TO 36
  16900       GO TO 91
  16901    31 CBCBF(KK)  =-1.
  16902       CBCBF(KK+1)=-0.25
  16903       GO TO 38
  16904    32 CBCBF(KK)  = 0.
  16905       CBCBF(KK+1)= 0.25
  16906       GO TO 38
  16907    33 CBCBF(KK)  = 0.5
  16908       CBCBF(KK+1)=-0.25
  16909       GO TO 38
  16910    34 CBCBF(KK)  =-1./(3.*XYSBCP(K)+1.)
  16911       CBCBF(KK+1)= 0.25+0.5*CBCBF(KK)
  16912       GO TO 38
  16913    35 Z=3.*XYSBCP(K)**2
  16914       CBCBF(KK)  = 0.5*(Z-1.)/(Z+0.5)
  16915       CBCBF(KK+1)=-0.25
  16916       GO TO 38
  16917    36 CBCBF(KK)  = 0.5*XYSBCP(K)/(0.5+XYSBCP(K))
  16918       CBCBF(KK+1)= 0.25-CBCBF(KK)
  16919    38 CONTINUE
  16920 C
  16921 C     ** CHECK BC TYPES AND DEFINE CORNER CONDITIONS (OCT 79)
  16922 C
  16923       CALL SLOCCO
  16924 C
  16925 C     ** SLOVER DONE **
  16926 C
  16927       NFIRST=1
  16928       IDELTA = ISECND(INSEC)
  16929       WRITE(6,840) IDELTA
  16930   840 FORMAT(/' === SLOVER DONE ===',T91,'ELAPSED TIME=',I6)
  16931       IF(LLWL) THEN
  16932       ULBL='(DEG. LATITUDE)'
  16933       ELSE
  16934       ULBL='(DELTAY UNITS) '
  16935       ENDIF
  16936       IF(IHC .EQ. 0) THEN
  16937       WRITE(6,880) IDSPC,JPD,MX,NX,KDCTYP,(KBCTYP(I),I=1,4),
  16938      1    XM1,XMXX,YN1,YNXX,DXM,DYN,ULBL,XYDCWL(1)/DXF,XYDCWL(2)/DYF,
  16939      2    ULBL,(XYBCWL(I)/DXF,I=1,2),(XYBCWL(I)/DYF,I=3,4)
  16940       ELSE
  16941       WRITE(6,881) IDSPC,JPD,MX,NX,KDCTYP,(KBCTYP(I),I=1,4),
  16942      1    XM1,XMXX,YN1,YNXX,DXM,DYN,ULBL,XYDCWL(1)/DXF,XYDCWL(2)/DYF,
  16943      2    ULBL,(XYBCWL(I)/DXF,I=1,2),(XYBCWL(I)/DYF,I=3,4)
  16944       ENDIF
  16945   880 FORMAT(/'.../S2PRIC/...',/,9X,A125,/,9X,'JPD=',I3,3X,'(MX,NX)',
  16946      1       2I3,', (DC)',I2,', (BC)',4I3,',   (XY LIMITS)',4F8.3,
  16947      2       '   DELTAX=',F6.3,' DEG.',/,9X,'DELTAY=',F6.3,
  16948      3       ' DEG., (DCWL ',A15,')',2F7.3,

Page 465         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  16949      4       ',  (BCWL ',A15,')',4F7.3,/)
  16950   881 FORMAT(/'.../S2PRIC/...',/,9X,A125,/,9X,'JPD=',I3,3X,'(MX,NX)',
  16951      1       2I3,', (DC)',I2,', (BC)',4I3,',   (XY LIMITS)',-5P,4F8.3,
  16952      2       '   DELTAX=',-5P,F6.3,' HKM.',/,9X,'DELTAY=',-5P,F6.3,
  16953      3       ' HKM., (DCWL ',A15,')',0P,2F7.3,
  16954      4       ',  (BCWL ',A15,')',0P,4F7.3,/)
  16955       RETURN
  16956    90 WRITE(6,890) MXX,NXX,MDIM,NDIM
  16957   890 FORMAT(/' === SLOVER FOUND (MXX,NXX).GT.(MDIM,NDIM) ===',3X,4I6)
  16958       GO TO 99
  16959    91 WRITE(6,891) KBCTYP,XYBCWL
  16960   891 FORMAT(/' === SLOVER MET UNDEFINED KBCTYP ===',4I12,/,41X,4F12.3)
  16961    99 CALL ABRT1(' SLOVER',891)
  16962 
  16963 C
  16964 
  16965 C-----------------------------------------------------------------------
  16966 
  16967       ENTRY STSPID(IDSPCZ)
  16968 C
  16969 C     PUT VALUE OF IDSPC INTO COMMON
  16970 C
  16971       IDSPC=IDSPCZ
  16972       RETURN
  16973 C
  16974 
  16975 C-----------------------------------------------------------------------
  16976 
  16977       ENTRY STSPND(MXZ,NXZ)
  16978       MX=MXZ
  16979       NX=NXZ
  16980       RETURN
  16981 C
  16982 
  16983 C-----------------------------------------------------------------------
  16984 
  16985       ENTRY STDOMN(NSWLN,XMLZ,XMRZ,YNBZ,YNTZ,JPDZ,ISRCDZ)
  16986       SGNWLN=REAL(-NSWLN)
  16987       XML=XMLZ*SGNWLN
  16988       XMR=XMRZ*SGNWLN
  16989       YNB=YNBZ
  16990       YNT=YNTZ
  16991       JPD=JPDZ
  16992       ISRCD=ISRCDZ
  16993       RETURN
  16994 C
  16995 
  16996 C-----------------------------------------------------------------------
  16997 
  16998       ENTRY STHORC(IHCZ,ELORG,GLORG,XSTM,YSTM,LLWLZ)
  16999       IHC=IHCZ
  17000       LLWL=LLWLZ
  17001       XSTM=XSTM*SGNWLN
  17002 C
  17003       IF(ELORG .EQ. -99.0 .OR. GLORG .EQ. -99.0)  THEN
  17004         ELORG=0.5*(XML+XMR)
  17005         GLORG=0.5*(YNB+YNT)

Page 466         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  17006       ELSE
  17007       ELORG=ELORG*SGNWLN
  17008       ENDIF
  17009 C
  17010       IF(IHC .EQ. 0)  THEN
  17011       XM1 =XML-ELORG
  17012       XMXX=XMR-ELORG
  17013       YN1 =YNB-GLORG
  17014       YNXX=YNT-GLORG
  17015       DYORG=1.0
  17016       DXORG=DYORG/COSDEG_8(GLORG)
  17017       XSTM=XSTM-ELORG
  17018       YSTM=YSTM-GLORG
  17019 C
  17020       ELSE IF(IHC .EQ. 1)  THEN
  17021       XSTMZ=XSTM
  17022       YSTMZ=YSTM
  17023       CALL MERCG0(ELORG,GLORG)
  17024 cc 7/3/05 dak -- below fixes subr. argument mismatch error
  17025       XML_1(1) = XML
  17026       YNB_1(1) = YNB
  17027       XM1_1(1) = XM1
  17028       YN1_1(1) = YN1
  17029 cc 7/3/05      CALL MERCXY(XML,YNB,XM1,YN1,1)
  17030       call mercxy(XML_1,YNB_1,XM1_1,YN1_1,IARG_5)
  17031 cc 7/3/05 dak -- below fixes subr. argument mismatch error
  17032       XMR_1(1) = XMR
  17033       YNT_1(1) = YNT
  17034       XMXX_1(1) = XMXX
  17035       YNXX_1(1) = YNXX
  17036 cc 7/3/05      CALL MERCXY(XMR,YNT,XMXX,YNXX,1)
  17037       call mercxy(XMR_1,YNT_1,XMXX_1,YNXX_1,IARG_5)
  17038 cc 7/3/05 dak -- below fixes subr. argument mismatch error
  17039       XSTMZ_1(1) = XSTMZ
  17040       YSTMZ_1(1) = YSTMZ
  17041       XSTM_1(1) = XSTM
  17042       YSTM_1(1) = YSTM
  17043 cc 7/3/05      CALL MERCXY(XSTMZ,YSTMZ,XSTM,YSTM,1)
  17044       call mercxy(XSTMZ_1,YSTMZ_1,XSTM_1,YSTM_1,IARG_5)
  17045 C
  17046 C     CALCULATE CONVERSION FACTORS FROM DEG. LAT. TO MERCATOR (METERS)
  17047 C       AT COORDINATE ORIGIN
  17048 C
  17049 cc 7/3/05 dak -- below fixes subr. argument mismatch error
  17050       elorgP1_1(1) = elorg+1.
  17051       glorgP1_1(1) = glorg+1.
  17052       dxorg_1(1) = DXORG
  17053       dyorg_1(1) = DYORG
  17054 cc 7/3/05      CALL MERCXY(ELORG+1.,GLORG+1.,DXORG,DYORG,1)
  17055       call mercxy(elorgP1_1,glorgP1_1,dxorg_1,dyorg_1,iarg_5)
  17056       DXORG=DYORG
  17057 C
  17058       ELSE
  17059       WRITE(6,851) IHC,ELORG,GLORG,XSTM,YSTM
  17060   851 FORMAT('****** IMPROPER COORDINATE SELECTION,',
  17061      1       ' IHC,ELORG,GLORG,XSTM,YSTM=',/,30X,I4,4F14.2)
  17062       CALL ABRT1(' STHORC',891)

Page 467         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  17063       ENDIF
  17064 C
  17065       RETURN
  17066 C
  17067 
  17068 C-----------------------------------------------------------------------
  17069 
  17070       ENTRY STSPDC(KDCTYZ,XYDCW1,XYDCW2)
  17071       KDCTYP=KDCTYZ
  17072       XYDCWL(1)=XYDCW1
  17073       XYDCWL(2)=XYDCW2
  17074       NFIRST=0
  17075       RETURN
  17076 
  17077       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 slosub_               stdomn_               stspdc_               stspnd_             
 slover_               sthorc_               stspid_                                   


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 21                         Label  16827                                                          16824                             
 22                         Label  16831                                                          16828                             
 31                         Label  16901                                                          16894                             
 32                         Label  16904                                                          16895                             
 33                         Label  16907                                                          16896                             
 34                         Label  16910                                                          16897                             
 35                         Label  16913                                                          16898                             
 36                         Label  16917                                                          16899                             
 38                         Label  16919                                                          16892,16903,16906,16909,16912,1691
                                                                                                  6                                 
 840                        Label  16930                                                          16929                             
 851                        Label  17060                                                          17059                             
 880                        Label  16945                                                          16937                             
 881                        Label  16950                                                          16941                             
 890                        Label  16957                                                          16956                             
 891                        Label  16960                                                          16959                             
 90                         Label  16956                                                          16796                             
 91                         Label  16959                                                          16900                             
 99                         Label  16961                                                          16958                             
 ABRT1                      Subr   16961                                                          16961,17062                       
 ABS                        Func   16814                                scalar                    16814,16817,16830                 
 CBCBF                      Scalar 16727    R(4)            4     1     8        COM              16901,16902,16904,16905,16907,1690
                                                                                                  8,16910,16911,16914,16915,16917,16
                                                                                                  918                               
 COSDEG_8                   Func   16740    R(8)            8           scalar                    16812,16821,16826,17016           
 COSYN                      Scalar 16726    R(4)            4     1     35       COM              16812,16821,16826                 
 DX0                        Scalar 16727    R(4)            4           scalar   COM              16836,16837,16838                 
 DX1                        Scalar 16727    R(4)            4           scalar   COM              16837                             

Page 468         Source Listing                  SLOSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DX2                        Scalar 16727    R(4)            4           scalar   COM              16838                             
 DXF                        Scalar 16731    R(4)            4           scalar   COM              16855,16861,16865,16867,16868,1693
                                                                                                  8,16939,16942,16943               
 DXM                        Scalar 16725    R(4)            4           scalar   COM              16788,16803,16817,16836,16873,1693
                                                                                                  8,16942                           
 DXORG                      Scalar 16731    R(4)            4           scalar   COM              16855,17016,17052,17056           
 DXORG_1                    Local  16752    R(4)            4     1     1        SAVE             17052,17055                       
 DY0                        Scalar 16727    R(4)            4           scalar   COM              16839,16840,16841                 
 DY1                        Scalar 16727    R(4)            4           scalar   COM              16840                             
 DY2                        Scalar 16727    R(4)            4           scalar   COM              16841                             
 DYF                        Scalar 16731    R(4)            4           scalar   COM              16854,16860,16861,16866,16869,1687
                                                                                                  0,16938,16939,16942,16943         
 DYN                        Scalar 16725    R(4)            4           scalar   COM              16791,16808,16820,16821,16826,1683
                                                                                                  9,16860,16874,16938,16942         
 DYORG                      Scalar 16731    R(4)            4           scalar   COM              16854,17015,17016,17053,17056     
 DYORG_1                    Local  16752    R(4)            4     1     1        SAVE             17053,17055                       
 ELORG                      Dummy  16704    R(4)            4           scalar   ARG,INOUT        17003,17004,17007,17011,17012,1701
                                                                                                  7,17023,17050,17059               
 ELORGP1_1                  Local  16751    R(4)            4     1     1        SAVE             17050,17055                       
 GLORG                      Dummy  16704    R(4)            4           scalar   ARG,INOUT        17003,17005,17013,17014,17016,1701
                                                                                                  8,17023,17051,17059               
 GLORGP1_1                  Local  16751    R(4)            4     1     1        SAVE             17051,17055                       
 I                          Local  16937    I(4)            4           scalar   SAVE             16937,16939,16941,16943           
 IARG_5                     Param  16711    I(4)            4           scalar                    16745,16746,16747,16748,16749,1675
                                                                                                  0,16751,16752,17030,17037,17044,17
                                                                                                  055                               
 IDELTA                     Local  16928    I(4)            4           scalar   SAVE             16928,16929                       
 IDSPC                      Scalar 16721    CHAR            125         scalar   COM              16937,16941,16971                 
 IDSPCZ                     Dummy  16703    CHAR            125         scalar   ARG,INOUT        16971                             
 IHC                        Local  16813    I(4)            4           scalar   SAVE             16813,16936,16999,17010,17020,1705
                                                                                                  9                                 
 IHCZ                       Dummy  16704    I(4)            4           scalar   ARG,INOUT        16999                             
 INSEC                      Local  16765    I(4)            4           scalar   SAVE             16765,16928                       
 ISECND                     Func   16765    I(4)            4           scalar                    16765,16928                       
 ISRCD                      Scalar 16720    I(4)            4           scalar   COM              16992                             
 ISRCDZ                     Dummy  16704    I(4)            4           scalar   ARG,INOUT        16992                             
 IZERO                      Local  16764    I(4)            4           scalar   SAVE             16764,16765                       
 JPD                        Scalar 16720    I(4)            4           scalar   COM              16937,16941,16991                 
 JPDZ                       Dummy  16703    I(4)            4           scalar   ARG,INOUT        16991                             
 K                          Local  16876    I(4)            4           scalar   SAVE             16876,16877,16878,16879,16892,1689
                                                                                                  3,16894,16895,16896,16897,16898,16
                                                                                                  899,16910,16913,16917             
 KBCTY1                     Dummy  16705    I(4)            4           scalar   ARG,INOUT                                          
 KBCTY2                     Dummy  16705    I(4)            4           scalar   ARG,INOUT                                          
 KBCTY3                     Dummy  16705    I(4)            4           scalar   ARG,INOUT                                          
 KBCTY4                     Dummy  16705    I(4)            4           scalar   ARG,INOUT                                          
 KBCTYP                     Scalar 16720    I(4)            4     1     4        COM              16894,16895,16896,16897,16898,1689
                                                                                                  9,16937,16941,16959               
 KDCTYP                     Scalar 16720    I(4)            4           scalar   COM              16937,16941,17071                 
 KDCTYZ                     Dummy  16704    I(4)            4           scalar   ARG,INOUT        17071                             
 KK                         Local  16893    I(4)            4           scalar   SAVE             16893,16901,16902,16904,16905,1690
                                                                                                  7,16908,16910,16911,16914,16915,16
                                                                                                  917,16918                         
 LLWL                       Local  16738    L(4)            4           scalar   SAVE             16850,16931,17000                 
 LLWLZ                      Dummy  16704    L(4)            4           scalar   ARG,INOUT        17000                             

Page 469         Source Listing                  SLOSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 M                          Local  16802    I(4)            4           scalar   SAVE             16802,16803,16816,16817,16828,1682
                                                                                                  9,16830                           
 MDIM                       Param  16710    I(4)            4           scalar                    16725,16796,16956                 
 MERCG0                     Subr   17023                                                          17023                             
 MERCLL                     Subr   16825                                                          16825,16829                       
 MERCXY                     Subr   17030                                                          17030,17037,17044,17055           
 MX                         Scalar 16720    I(4)            4           scalar   COM              16787,16788,16937,16941,16978     
 MXX                        Scalar 16725    I(4)            4           scalar   COM              16787,16796,16802,16816,16828,1695
                                                                                                  6                                 
 MXZ                        Dummy  16703    I(4)            4           scalar   ARG,INOUT        16978                             
 N                          Local  16807    I(4)            4           scalar   SAVE             16807,16808,16819,16820,16821,1682
                                                                                                  4,16825,16826                     
 NDIM                       Param  16710    I(4)            4           scalar                    16725,16726,16796,16956           
 NFIRST                     Local  16755    I(4)            4           scalar   SAVE             16755,16864,16927,17074           
 NSWLN                      Dummy  16703    I(4)            4           scalar   ARG,INOUT        16986                             
 NX                         Scalar 16720    I(4)            4           scalar   COM              16790,16791,16937,16941,16979     
 NXX                        Scalar 16725    I(4)            4           scalar   COM              16790,16796,16807,16812,16819,1682
                                                                                                  1,16824,16826,16956               
 NXZ                        Dummy  16703    I(4)            4           scalar   ARG,INOUT        16979                             
 PI2                        Local  16755    R(4)            4           scalar   SAVE             16755,16872                       
 REAL                       Func   16788                                scalar                    16788,16791,16986                 
 S2BCDC                     Common 16727                                64       SAVE                                               
 S2NODE                     Common 16725                                716      SAVE                                               
 S2PRIC                     Common 16720                                217      SAVE                                               
 SGNWLN                     Local  16986    R(4)            4           scalar   SAVE             16986,16987,16988,17001,17007     
 SLOCCO                     Subr   16923                                                          16923                             
 SLOSUB                     Subr   16703                                                                                            
 SLOVER                     Subr   16760                                                                                            
 STDOMN                     Subr   16985                                                                                            
 STHORC                     Subr   16998                                                                                            
 STSPDC                     Subr   17070                                                                                            
 STSPID                     Subr   16967                                                                                            
 STSPND                     Subr   16977                                                                                            
 ULBL                       Local  16737    CHAR            15          scalar   SAVE             16932,16934,16938,16939,16942,1694
                                                                                                  3                                 
 WLCONV                     Common 16731                                16       SAVE                                               
 XM                         Scalar 16725    R(4)            4     1     35       COM              16789,16803,16825,16829           
 XM1                        Scalar 16721    R(4)            4           scalar   COM              16788,16789,16803,16938,16942,1701
                                                                                                  1,17027                           
 XM1_1                      Local  16746    R(4)            4     1     1        SAVE             17027,17030                       
 XMC                        Scalar 16725    R(4)            4     1     35       COM              16814,16817,16825,16829,16830     
 XML                        Scalar 16720    R(4)            4           scalar   COM              16814,16817,16987,17004,17011,1702
                                                                                                  5                                 
 XMLZ                       Dummy  16703    R(4)            4           scalar   ARG,INOUT        16987                             
 XML_1                      Local  16745    R(4)            4     1     1        SAVE             17025,17030                       
 XMR                        Scalar 16720    R(4)            4           scalar   COM              16988,17004,17012,17032           
 XMRZ                       Dummy  16703    R(4)            4           scalar   ARG,INOUT        16988                             
 XMR_1                      Local  16747    R(4)            4     1     1        SAVE             17032,17037                       
 XMXX                       Scalar 16721    R(4)            4           scalar   COM              16788,16938,16942,17012,17034     
 XMXX_1                     Local  16748    R(4)            4     1     1        SAVE             17034,17037                       
 XSTM                       Dummy  16704    R(4)            4           scalar   ARG,INOUT        17001,17017,17021,17041,17059     
 XSTMZ                      Local  17021    R(4)            4           scalar   SAVE             17021,17039                       
 XSTMZ_1                    Local  16749    R(4)            4     1     1        SAVE             17039,17044                       
 XSTM_1                     Local  16750    R(4)            4     1     1        SAVE             17041,17044                       
 XYBCW1                     Dummy  16706    R(4)            4           scalar   ARG,INOUT                                          

Page 470         Source Listing                  SLOSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XYBCW2                     Dummy  16706    R(4)            4           scalar   ARG,INOUT                                          
 XYBCW3                     Dummy  16706    R(4)            4           scalar   ARG,INOUT                                          
 XYBCW4                     Dummy  16706    R(4)            4           scalar   ARG,INOUT                                          
 XYBCWL                     Scalar 16721    R(4)            4     1     4        COM              16867,16868,16869,16870,16878,1687
                                                                                                  9,16939,16943,16959               
 XYDCW1                     Dummy  16705    R(4)            4           scalar   ARG,INOUT        17072                             
 XYDCW2                     Dummy  16705    R(4)            4           scalar   ARG,INOUT        17073                             
 XYDCWL                     Scalar 16721    R(4)            4     1     2        COM              16865,16866,16877,16938,16942,1707
                                                                                                  2,17073                           
 XYSBCP                     Local  16744    R(4)            4     1     4        SAVE             16878,16879,16910,16913,16917     
 XYSDCP                     Scalar 16727    R(4)            4     1     2        COM              16877                             
 YN                         Scalar 16725    R(4)            4     1     35       COM              16792,16808,16825,16829           
 YN1                        Scalar 16721    R(4)            4           scalar   COM              16791,16792,16808,16938,16942,1701
                                                                                                  3,17028                           
 YN1_1                      Local  16746    R(4)            4     1     1        SAVE             17028,17030                       
 YNB                        Scalar 16720    R(4)            4           scalar   COM              16815,16820,16989,17005,17013,1702
                                                                                                  6                                 
 YNBZ                       Dummy  16703    R(4)            4           scalar   ARG,INOUT        16989                             
 YNB_1                      Local  16745    R(4)            4     1     1        SAVE             17026,17030                       
 YNC                        Scalar 16726    R(4)            4     1     35       COM              16815,16820,16825,16829           
 YNT                        Scalar 16720    R(4)            4           scalar   COM              16812,16821,16826,16990,17005,1701
                                                                                                  4,17033                           
 YNTZ                       Dummy  16703    R(4)            4           scalar   ARG,INOUT        16990                             
 YNT_1                      Local  16747    R(4)            4     1     1        SAVE             17033,17037                       
 YNXX                       Scalar 16721    R(4)            4           scalar   COM              16791,16938,16942,17014,17035     
 YNXX_1                     Local  16748    R(4)            4     1     1        SAVE             17035,17037                       
 YSTM                       Dummy  16704    R(4)            4           scalar   ARG,INOUT        17018,17022,17042,17059           
 YSTMZ                      Local  17022    R(4)            4           scalar   SAVE             17022,17040                       
 YSTMZ_1                    Local  16749    R(4)            4     1     1        SAVE             17040,17044                       
 YSTM_1                     Local  16750    R(4)            4     1     1        SAVE             17042,17044                       
 Z                          Local  16872    R(4)            4           scalar   SAVE             16872,16873,16874,16913,16914     
 ZC                         Local  16744    R(4)            4     1     2        SAVE             16873,16874,16877,16878,16879     

Page 471         Source Listing                  SLOSUB
2017-04-18 11:09                                 syndata.f

  17078 
  17079 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17080 C                .      .    .                                       .
  17081 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17082 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17083 C
  17084 C ABSTRACT: ??????????????????????????????????????????????????????????
  17085 C   ??????????????????????????????????????????????????????????????????
  17086 C
  17087 C PROGRAM HISTORY LOG:
  17088 C ????-??-??  S. J. LORD
  17089 C
  17090 C USAGE:    CALL ????????(????)
  17091 C   INPUT ARGUMENT LIST:
  17092 C     ??????   - ???????????????????????????????????????????????
  17093 C
  17094 C   OUTPUT ARGUMENT LIST:
  17095 C     ??????   - ???????????????????????????????????????????????
  17096 C
  17097 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17098 C     ??????   - ???????????????????????????????????????????????
  17099 C
  17100 C   OUTPUT FILES:
  17101 C     ??????   - ???????????????????????????????????????????????
  17102 C
  17103 C REMARKS: ?????????????????????????????????????????????????????
  17104 C
  17105 C ATTRIBUTES:
  17106 C   LANGUAGE: FORTRAN 90
  17107 C   MACHINE:  NCEP WCOSS
  17108 C
  17109 C$$$
  17110       SUBROUTINE STSPBC(KBCTY1,KBCTY2,KBCTY3,KBCTY4,XYBCW1,XYBCW2,
  17111      1                  XYBCW3,XYBCW4)
  17112 
  17113       IMPLICIT NONE 
  17114 
  17115       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  17116      1                XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  17117 
  17118       INTEGER ISRCD,JPD,MX,NX,KDCTYP,KBCTYP
  17119       REAL    XML,XMR,YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL,XYBCWL
  17120       CHARACTER*125 IDSPC
  17121 
  17122       INTEGER KBCTY1,KBCTY2,KBCTY3,KBCTY4
  17123       REAL    XYBCW1,XYBCW2,XYBCW3,XYBCW4
  17124 
  17125       KBCTYP(1)=KBCTY1
  17126       KBCTYP(2)=KBCTY2
  17127       KBCTYP(3)=KBCTY3
  17128       KBCTYP(4)=KBCTY4
  17129       XYBCWL(1)=XYBCW1
  17130       XYBCWL(2)=XYBCW2
  17131       XYBCWL(3)=XYBCW3
  17132       XYBCWL(4)=XYBCW4
  17133 
  17134       RETURN

Page 472         Source Listing                  STSPBC
2017-04-18 11:09                                 syndata.f

  17135 
  17136       END


ENTRY POINTS

  Name               
                     
 stspbc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDSPC                      Scalar 17116    CHAR            125         scalar   COM                                                
 ISRCD                      Scalar 17115    I(4)            4           scalar   COM                                                
 JPD                        Scalar 17115    I(4)            4           scalar   COM                                                
 KBCTY1                     Dummy  17110    I(4)            4           scalar   ARG,INOUT        17125                             
 KBCTY2                     Dummy  17110    I(4)            4           scalar   ARG,INOUT        17126                             
 KBCTY3                     Dummy  17110    I(4)            4           scalar   ARG,INOUT        17127                             
 KBCTY4                     Dummy  17110    I(4)            4           scalar   ARG,INOUT        17128                             
 KBCTYP                     Scalar 17115    I(4)            4     1     4        COM              17125,17126,17127,17128           
 KDCTYP                     Scalar 17115    I(4)            4           scalar   COM                                                
 MX                         Scalar 17115    I(4)            4           scalar   COM                                                
 NX                         Scalar 17115    I(4)            4           scalar   COM                                                
 S2PRIC                     Common 17115                                217                                                         
 STSPBC                     Subr   17110                                                                                            
 XM1                        Scalar 17116    R(4)            4           scalar   COM                                                
 XML                        Scalar 17115    R(4)            4           scalar   COM                                                
 XMR                        Scalar 17115    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 17116    R(4)            4           scalar   COM                                                
 XYBCW1                     Dummy  17110    R(4)            4           scalar   ARG,INOUT        17129                             
 XYBCW2                     Dummy  17110    R(4)            4           scalar   ARG,INOUT        17130                             
 XYBCW3                     Dummy  17111    R(4)            4           scalar   ARG,INOUT        17131                             
 XYBCW4                     Dummy  17111    R(4)            4           scalar   ARG,INOUT        17132                             
 XYBCWL                     Scalar 17116    R(4)            4     1     4        COM              17129,17130,17131,17132           
 XYDCWL                     Scalar 17116    R(4)            4     1     2        COM                                                
 YN1                        Scalar 17116    R(4)            4           scalar   COM                                                
 YNB                        Scalar 17115    R(4)            4           scalar   COM                                                
 YNT                        Scalar 17115    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17116    R(4)            4           scalar   COM                                                

Page 473         Source Listing                  STSPBC
2017-04-18 11:09                                 syndata.f

  17137 
  17138 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17139 C                .      .    .                                       .
  17140 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17141 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17142 C
  17143 C ABSTRACT: ??????????????????????????????????????????????????????????
  17144 C   ??????????????????????????????????????????????????????????????????
  17145 C
  17146 C PROGRAM HISTORY LOG:
  17147 C ????-??-??  S. J. LORD
  17148 C
  17149 C USAGE:    CALL ????????(????)
  17150 C   INPUT ARGUMENT LIST:
  17151 C     ??????   - ???????????????????????????????????????????????
  17152 C
  17153 C   OUTPUT ARGUMENT LIST:
  17154 C     ??????   - ???????????????????????????????????????????????
  17155 C
  17156 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17157 C     ??????   - ???????????????????????????????????????????????
  17158 C
  17159 C   OUTPUT FILES:
  17160 C     ??????   - ???????????????????????????????????????????????
  17161 C
  17162 C REMARKS: ?????????????????????????????????????????????????????
  17163 C
  17164 C ATTRIBUTES:
  17165 C   LANGUAGE: FORTRAN 90
  17166 C   MACHINE:  NCEP WCOSS
  17167 C
  17168 C$$$
  17169       BLOCK DATA IBM3
  17170       PARAMETER (KLDIM= 8)
  17171       PARAMETER (KVDIM=20,KDTDIM=5)
  17172 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  17173       PARAMETER (KPXDIM=KVDIM*KLDIM)
  17174 C
  17175       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  17176      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  17177       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  17178      1                 DMEAN(KDTDIM*KLDIM)
  17179       CHARACTER IDSPC*125,IDSPK*40
  17180       DATA IDSPC/' '/
  17181       DATA KPX/KPXDIM/
  17182       END

Page 474         Source Listing                  IBM3
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DMEAN                      Scalar 17178    R(4)            4     1     40       COM                                                
 IBM3                       Block  17169                                scalar                                                      
 IDLEV                      Scalar 17177    I(4)            4     1     160      COM                                                
 IDSPC                      Scalar 17176    CHAR            125         scalar   COM,SAVE         17180                             
 IDSPK                      Scalar 17177    CHAR            40    1     160      COM                                                
 IDVAR                      Scalar 17177    I(4)            4     1     160      COM                                                
 ISRCD                      Scalar 17175    I(4)            4           scalar   COM                                                
 JPD                        Scalar 17175    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 17175    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 17175    I(4)            4           scalar   COM                                                
 KDTDIM                     Param  17171    I(4)            4           scalar                    17178                             
 KLDIM                      Param  17170    I(4)            4           scalar                    17173,17178                       
 KPX                        Scalar 17177    I(4)            4           scalar   COM,SAVE         17181                             
 KPXDIM                     Param  17173    I(4)            4           scalar                    17177,17181                       
 KVDIM                      Param  17171    I(4)            4           scalar                    17173                             
 MX                         Scalar 17175    I(4)            4           scalar   COM                                                
 NX                         Scalar 17175    I(4)            4           scalar   COM                                                
 S2KOMP                     Common 17177                                7844                                                        
 S2PRIC                     Common 17175                                217                                                         
 XM1                        Scalar 17176    R(4)            4           scalar   COM                                                
 XML                        Scalar 17175    R(4)            4           scalar   COM                                                
 XMR                        Scalar 17175    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 17176    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 17176    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 17176    R(4)            4     1     2        COM                                                
 YN1                        Scalar 17176    R(4)            4           scalar   COM                                                
 YNB                        Scalar 17175    R(4)            4           scalar   COM                                                
 YNT                        Scalar 17175    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17176    R(4)            4           scalar   COM                                                

Page 475         Source Listing                  IBM3
2017-04-18 11:09                                 syndata.f

  17183 
  17184 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17185 C                .      .    .                                       .
  17186 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17187 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17188 C
  17189 C ABSTRACT: ??????????????????????????????????????????????????????????
  17190 C   ??????????????????????????????????????????????????????????????????
  17191 C
  17192 C PROGRAM HISTORY LOG:
  17193 C ????-??-??  S. J. LORD
  17194 C
  17195 C USAGE:    CALL ????????(????)
  17196 C   INPUT ARGUMENT LIST:
  17197 C     ??????   - ???????????????????????????????????????????????
  17198 C
  17199 C   OUTPUT ARGUMENT LIST:
  17200 C     ??????   - ???????????????????????????????????????????????
  17201 C
  17202 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17203 C     ??????   - ???????????????????????????????????????????????
  17204 C
  17205 C   OUTPUT FILES:
  17206 C     ??????   - ???????????????????????????????????????????????
  17207 C
  17208 C REMARKS: ?????????????????????????????????????????????????????
  17209 C
  17210 C ATTRIBUTES:
  17211 C   LANGUAGE: FORTRAN 90
  17212 C   MACHINE:  NCEP WCOSS
  17213 C
  17214 C$$$
  17215       SUBROUTINE SLOCCO
  17216 C
  17217 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  17218 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  17219       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  17220      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  17221       COMMON /S2BCDC/ DX0,DX1,DX2,DY0,DY1,DY2,CBCBF(8),XYSDCP(2)
  17222       COMMON /S2CORN/ CORN(4,4)
  17223 C
  17224       SAVE
  17225 C
  17226       CHARACTER*125 IDSPC
  17227 C
  17228 C     ** DEFINITION OF CORNERS AND NEIGHBORS
  17229 C       KORN=1   MA=1   NA=1   , MB=2   NB=2
  17230 C       KORN=2   MA=1   NA=NXX , MB=2   NB=NX
  17231 C       KORN=3   MA=MXX NA=1   , MB=MX  NB=2
  17232 C       KORN=4   MA=MXX NA=NXX , MB=MX  NB=NX
  17233 C       CORNER   KPT=1 (MA,NA),  NEIGHBORS  KPT=2 (MA,NB),
  17234 C                                           KPT=3 (MB,NA),
  17235 C                                           KPT=4 (MB,NB)
  17236 C     ** CORNER CONDITIONS
  17237 C       ++ IF ANY BC TYPE, EITHER X-BC OR Y-BC, IS 0 OR 20,
  17238 C          NO CORNERING WILL BE DONE.
  17239 C       ++ IF BOTH BC TYPES ARE OF THE FIRST ORDER (1 OR 10), THE CORNER

Page 476         Source Listing                  SLOCCO
2017-04-18 11:09                                 syndata.f

  17240 C          CONDITION OF THE SAME ORDER IS AUTOMATICALLY SATISFIED.
  17241 C          THUS, NO NEED TO FLOAT THE CORNER.
  17242 C       ++ THE MIXTURE OF TYPE 10 AND TYPE 2 OR 21 IS NOT PRESENTLY HAND
  17243 C       ++ IF BOTH BC TYPES ARE OF THE SECOND ORDER (2 OR 21), OR
  17244 C          ONE OF THEM IS TYPE 1 (AS THE LIMITING CASE OF TYPE 21), THE
  17245 C          CORNER CONDITION IS IMPOSED BY FLOATING THE CORNER AMPLITUDE.
  17246 C  ***** THE FOLLOWING CONVENTION MUST BE ADHERED TO ***** *****
  17247 C  *****                                                   *****
  17248 C  *****     CORN(1,KORN)=0.   FOR NO CORNERING            *****
  17249 C  *****     CORN(1,KORN)=1.   FOR CORNERING               *****
  17250 C  *****                                                   *****
  17251 C  ***** ***** ***** ***** ***** ***** ***** ***** *****   *****
  17252 C     ** SET CORN(KPT,KORN) IN DEFAULT VALUES (NO CORNERING)
  17253 C
  17254       DO KORN=1,4
  17255       DO KPT =1,4
  17256          CORN(KPT,KORN)=0.
  17257       ENDDO
  17258       ENDDO
  17259 C
  17260 C     ** SET CORN AT EACH CORNER INDEPENDENTLY
  17261 C
  17262       DO KORN=1,4
  17263          KXBC=(KORN-1)/2+1
  17264          KYBC=MOD(KORN-1,2)+3
  17265          KXTYP=KBCTYP(KXBC)
  17266          KYTYP=KBCTYP(KYBC)
  17267        IF(KXTYP.EQ.0.OR.KXTYP.EQ.20.OR.KYTYP.EQ.0.OR.KYTYP.EQ.20)GOTO 18
  17268          KXFLG=0
  17269          KYFLG=0
  17270          IF(KXTYP.EQ.1) KXFLG=1
  17271          IF(KYTYP.EQ.1) KYFLG=1
  17272          IF(KXTYP.EQ.2 .OR. KXTYP.EQ.21) KXFLG=2
  17273          IF(KYTYP.EQ.2 .OR. KYTYP.EQ.21) KYFLG=2
  17274          IF(KXFLG+KYFLG.LE.2) GO TO 18
  17275          IF(KXFLG.EQ.1) THEN
  17276 
  17277 C       ++ SPECIAL CASE KXTYP=1 (AND KYTYP=2 OR 21)
  17278 
  17279             CORN(1,KORN)= 1.
  17280             CORN(2,KORN)= 1.
  17281             CORN(3,KORN)=-0.5
  17282             CORN(4,KORN)= 0.5
  17283             GO TO 18
  17284          END IF
  17285          IF(KYFLG.EQ.1) THEN
  17286 
  17287 C       ++ SPECIAL CASE KYTYP=1 (AND KXTYP=2 OR 21)
  17288 
  17289             CORN(1,KORN)= 1.
  17290             CORN(2,KORN)=-0.5
  17291             CORN(3,KORN)= 1.
  17292             CORN(4,KORN)= 0.5
  17293             GO TO 18
  17294          END IF
  17295 
  17296 C       ++ BOTH BC TYPES ARE TYPE 2 OR 21

Page 477         Source Listing                  SLOCCO
2017-04-18 11:09                                 syndata.f

  17297 
  17298          XALP=4.*CBCBF(2*KXBC-1)
  17299          YALP=4.*CBCBF(2*KYBC-1)
  17300          SX=((2.-XALP)**2+12.)/XALP**2
  17301          RX=((4.+XALP)**2-24.)/XALP**2
  17302          SY=((2.-YALP)**2+12.)/YALP**2
  17303          RY=((4.+YALP)**2-24.)/YALP**2
  17304          Z=1./(SX+SY)
  17305          CORN(1,KORN)= 1.
  17306          CORN(2,KORN)= (SX+RY)*Z
  17307          CORN(3,KORN)= (RX+SY)*Z
  17308          CORN(4,KORN)=-(RX+RY)*Z
  17309    18    CONTINUE
  17310       ENDDO
  17311 
  17312       RETURN
  17313 
  17314       END


ENTRY POINTS

  Name               
                     
 slocco_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 18                         Label  17309                                                          17267,17274,17283,17293           
 CBCBF                      Scalar 17221    R(4)            4     1     8        COM              17298,17299                       
 CORN                       Scalar 17222    R(4)            4     2     16       COM              17256,17279,17280,17281,17282,1728
                                                                                                  9,17290,17291,17292,17305,17306,17
                                                                                                  307,17308                         
 DX0                        Scalar 17221    R(4)            4           scalar   COM                                                
 DX1                        Scalar 17221    R(4)            4           scalar   COM                                                
 DX2                        Scalar 17221    R(4)            4           scalar   COM                                                
 DY0                        Scalar 17221    R(4)            4           scalar   COM                                                
 DY1                        Scalar 17221    R(4)            4           scalar   COM                                                
 DY2                        Scalar 17221    R(4)            4           scalar   COM                                                
 IDSPC                      Scalar 17220    CHAR            125         scalar   COM                                                
 ISRCD                      Scalar 17219    I(4)            4           scalar   COM                                                
 JPD                        Scalar 17219    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 17219    I(4)            4     1     4        COM              17265,17266                       
 KDCTYP                     Scalar 17219    I(4)            4           scalar   COM                                                
 KORN                       Local  17254    I(4)            4           scalar   SAVE             17254,17256,17262,17263,17264,1727
                                                                                                  9,17280,17281,17282,17289,17290,17
                                                                                                  291,17292,17305,17306,17307,17308 
 KPT                        Local  17255    I(4)            4           scalar   SAVE             17255,17256                       
 KXBC                       Local  17263    I(4)            4           scalar   SAVE             17263,17265,17298                 
 KXFLG                      Local  17268    I(4)            4           scalar   SAVE             17268,17270,17272,17274,17275     
 KXTYP                      Local  17265    I(4)            4           scalar   SAVE             17265,17267,17270,17272           
 KYBC                       Local  17264    I(4)            4           scalar   SAVE             17264,17266,17299                 
 KYFLG                      Local  17269    I(4)            4           scalar   SAVE             17269,17271,17273,17274,17285     
 KYTYP                      Local  17266    I(4)            4           scalar   SAVE             17266,17267,17271,17273           

Page 478         Source Listing                  SLOCCO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MOD                        Func   17264                                scalar                    17264                             
 MX                         Scalar 17219    I(4)            4           scalar   COM                                                
 NX                         Scalar 17219    I(4)            4           scalar   COM                                                
 RX                         Local  17301    R(4)            4           scalar   SAVE             17301,17307,17308                 
 RY                         Local  17303    R(4)            4           scalar   SAVE             17303,17306,17308                 
 S2BCDC                     Common 17221                                64       SAVE                                               
 S2CORN                     Common 17222                                64       SAVE                                               
 S2PRIC                     Common 17219                                217      SAVE                                               
 SLOCCO                     Subr   17215                                                                                            
 SX                         Local  17300    R(4)            4           scalar   SAVE             17300,17304,17306                 
 SY                         Local  17302    R(4)            4           scalar   SAVE             17302,17304,17307                 
 XALP                       Local  17298    R(4)            4           scalar   SAVE             17298,17300,17301                 
 XM1                        Scalar 17220    R(4)            4           scalar   COM                                                
 XML                        Scalar 17219    R(4)            4           scalar   COM                                                
 XMR                        Scalar 17219    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 17220    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 17220    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 17220    R(4)            4     1     2        COM                                                
 XYSDCP                     Scalar 17221    R(4)            4     1     2        COM                                                
 YALP                       Local  17299    R(4)            4           scalar   SAVE             17299,17302,17303                 
 YN1                        Scalar 17220    R(4)            4           scalar   COM                                                
 YNB                        Scalar 17219    R(4)            4           scalar   COM                                                
 YNT                        Scalar 17219    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17220    R(4)            4           scalar   COM                                                
 Z                          Local  17304    R(4)            4           scalar   SAVE             17304,17306,17307,17308           

Page 479         Source Listing                  SLOCCO
2017-04-18 11:09                                 syndata.f

  17315 
  17316 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17317 C                .      .    .                                       .
  17318 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17319 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17320 C
  17321 C ABSTRACT: ??????????????????????????????????????????????????????????
  17322 C   ??????????????????????????????????????????????????????????????????
  17323 C
  17324 C PROGRAM HISTORY LOG:
  17325 C ????-??-??  S. J. LORD
  17326 C
  17327 C USAGE:    CALL ????????(????)
  17328 C   INPUT ARGUMENT LIST:
  17329 C     ??????   - ???????????????????????????????????????????????
  17330 C
  17331 C   OUTPUT ARGUMENT LIST:
  17332 C     ??????   - ???????????????????????????????????????????????
  17333 C
  17334 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17335 C     ??????   - ???????????????????????????????????????????????
  17336 C
  17337 C   OUTPUT FILES:
  17338 C     ??????   - ???????????????????????????????????????????????
  17339 C
  17340 C REMARKS: ?????????????????????????????????????????????????????
  17341 C
  17342 C ATTRIBUTES:
  17343 C   LANGUAGE: FORTRAN 90
  17344 C   MACHINE:  NCEP WCOSS
  17345 C
  17346 C$$$
  17347       SUBROUTINE IDSSUB(KPXZ,KP)
  17348 C
  17349 C          ENTRY SETKPX(KPXZ)
  17350 C          ENTRY PRDSPC
  17351 C          ENTRY PRDSPD
  17352 C          ENTRY PRDSPK(KP)
  17353 C
  17354       PARAMETER (KLDIM= 8)
  17355       PARAMETER (KVDIM=20,KDTDIM=5)
  17356 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  17357       PARAMETER (KPXDIM=KVDIM*KLDIM)
  17358 C
  17359 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  17360 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  17361       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  17362      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  17363       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  17364      1                 DMEAN(KDTDIM*KLDIM)
  17365 C
  17366       CHARACTER*8 IDSPK*40,IDSPC*125
  17367 C
  17368       SAVE
  17369 C
  17370 C     ** DEFAULT VALUE
  17371 C

Page 480         Source Listing                  IDSSUB
2017-04-18 11:09                                 syndata.f

  17372 CIBM  DATA KPX/KPXDIM/
  17373 C
  17374 
  17375 C-----------------------------------------------------------------------
  17376 
  17377       ENTRY SETKPX(KPXZ)
  17378 C
  17379       KPX=KPXZ
  17380       RETURN
  17381 C
  17382 
  17383 C-----------------------------------------------------------------------
  17384 
  17385       ENTRY PRDSPC
  17386       WRITE(6,810) IDSPC
  17387   810 FORMAT(9X,'...',A125)
  17388       RETURN
  17389 C
  17390 
  17391 C-----------------------------------------------------------------------
  17392 
  17393       ENTRY PRDSPK(KP)
  17394       KPA=MAX(KP,1)
  17395       KPB=MIN(KP,KPX)
  17396       IF(KPA.NE.KPB) GO TO 18
  17397       WRITE(6,815) IDSPK(KP)
  17398   815 FORMAT(/30X,A40)
  17399       RETURN
  17400    18 CONTINUE
  17401       IF(KPX.LT.1.OR.KPX.GT.KPXDIM) GO TO 90
  17402       KPA=1
  17403       KPB=KPX
  17404       WRITE(6,820) KPX
  17405   820 FORMAT(/' === PRDSPK LISTS ALL ENTRIES IN IDSPK ===   KPX=', I3)
  17406       WRITE(6,822) (K,IDSPK(K),K=KPA,KPB)
  17407   822 FORMAT(23X,I4,'...',A40)
  17408       RETURN
  17409    90 WRITE(6,890) KPX,KPXDIM
  17410   890 FORMAT(/' === PRDSPK(0) FOUND KPX UNDEFINED OR IN ERROR.',   2I4)
  17411       CALL ABRT1(' PRDSPK',890)
  17412       END

Page 481         Source Listing                  IDSSUB
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 idssub_               prdspc_               prdspk_               setkpx_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 18                         Label  17400                                                          17396                             
 810                        Label  17387                                                          17386                             
 815                        Label  17398                                                          17397                             
 820                        Label  17405                                                          17404                             
 822                        Label  17407                                                          17406                             
 890                        Label  17410                                                          17409                             
 90                         Label  17409                                                          17401                             
 ABRT1                      Subr   17411                                                          17411                             
 DMEAN                      Scalar 17364    R(4)            4     1     40       COM                                                
 IDLEV                      Scalar 17363    I(4)            4     1     160      COM                                                
 IDSPC                      Scalar 17362    CHAR            125         scalar   COM              17386                             
 IDSPK                      Scalar 17363    CHAR            40    1     160      COM              17397,17406                       
 IDSSUB                     Subr   17347                                                                                            
 IDVAR                      Scalar 17363    I(4)            4     1     160      COM                                                
 ISRCD                      Scalar 17361    I(4)            4           scalar   COM                                                
 JPD                        Scalar 17361    I(4)            4           scalar   COM                                                
 K                          Local  17406    I(4)            4           scalar   SAVE             17406                             
 KBCTYP                     Scalar 17361    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 17361    I(4)            4           scalar   COM                                                
 KDTDIM                     Param  17355    I(4)            4           scalar                    17364                             
 KLDIM                      Param  17354    I(4)            4           scalar                    17357,17364                       
 KP                         Dummy  17347    I(4)            4           scalar   ARG,INOUT        17394,17395,17397                 
 KPA                        Local  17394    I(4)            4           scalar   SAVE             17394,17396,17402,17406           
 KPB                        Local  17395    I(4)            4           scalar   SAVE             17395,17396,17403,17406           
 KPX                        Scalar 17363    I(4)            4           scalar   COM              17379,17395,17401,17403,17404,1740
                                                                                                  9                                 
 KPXDIM                     Param  17357    I(4)            4           scalar                    17363,17401,17409                 
 KPXZ                       Dummy  17347    I(4)            4           scalar   ARG,INOUT        17379                             
 KVDIM                      Param  17355    I(4)            4           scalar                    17357                             
 MAX                        Func   17394                                scalar                    17394                             
 MIN                        Func   17395                                scalar                    17395                             
 MX                         Scalar 17361    I(4)            4           scalar   COM                                                
 NX                         Scalar 17361    I(4)            4           scalar   COM                                                
 PRDSPC                     Subr   17385                                                                                            
 PRDSPK                     Subr   17393                                                                                            
 S2KOMP                     Common 17363                                7844     SAVE                                               
 S2PRIC                     Common 17361                                217      SAVE                                               
 SETKPX                     Subr   17377                                                                                            
 XM1                        Scalar 17362    R(4)            4           scalar   COM                                                
 XML                        Scalar 17361    R(4)            4           scalar   COM                                                
 XMR                        Scalar 17361    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 17362    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 17362    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 17362    R(4)            4     1     2        COM                                                

Page 482         Source Listing                  IDSSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YN1                        Scalar 17362    R(4)            4           scalar   COM                                                
 YNB                        Scalar 17361    R(4)            4           scalar   COM                                                
 YNT                        Scalar 17361    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17362    R(4)            4           scalar   COM                                                

Page 483         Source Listing                  IDSSUB
2017-04-18 11:09                                 syndata.f

  17413 
  17414 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17415 C                .      .    .                                       .
  17416 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17417 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17418 C
  17419 C ABSTRACT: ??????????????????????????????????????????????????????????
  17420 C   ??????????????????????????????????????????????????????????????????
  17421 C
  17422 C PROGRAM HISTORY LOG:
  17423 C ????-??-??  S. J. LORD
  17424 C
  17425 C USAGE:    CALL ????????(????)
  17426 C   INPUT ARGUMENT LIST:
  17427 C     ??????   - ???????????????????????????????????????????????
  17428 C
  17429 C   OUTPUT ARGUMENT LIST:
  17430 C     ??????   - ???????????????????????????????????????????????
  17431 C
  17432 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17433 C     ??????   - ???????????????????????????????????????????????
  17434 C
  17435 C   OUTPUT FILES:
  17436 C     ??????   - ???????????????????????????????????????????????
  17437 C
  17438 C REMARKS: ?????????????????????????????????????????????????????
  17439 C
  17440 C ATTRIBUTES:
  17441 C   LANGUAGE: FORTRAN 90
  17442 C   MACHINE:  NCEP WCOSS
  17443 C
  17444 C$$$
  17445       FUNCTION XBF(M,X)
  17446 C
  17447 C        ENTRY DXBF, DDXBF
  17448 C     ** THIS VERSION IS FOR THE SLOVER PACKAGE **
  17449 C        SLOVER MUST BE CALLED TO DEFINE CONSTANTS IN /S2BCDC/
  17450 C       ** THE EARLIER VERSION IN CHARM OR RCHARM DOES NOT WORK CORRECTL
  17451 C          WITH NEW BC TYPE 0, 10, OR 20, BECAUSE CBC11 AND CBCX1 ARE
  17452 C          NEGATIVE OR MAY BECOME NEGATIVE. (O.K. WITH TYPE 1,2,3,4 OF O
  17453 C       ** NOTE THE CHANGES IN THE USE OF SIGN FUNCTION AT STATEMENT
  17454 C          NO. 132 AND 142 IN CALCULATION OF DXBF.
  17455 C          THESE SIGN FUNCS ARE COMPLEMENTARY TO THE SIGN FUNC ON D1
  17456 C          NEAR THE BEGINNING OF DXBF ENTRY.  (03/30/79)
  17457 C         FOR THE BOUNDARY CONDITION DEFINITIONS, SEE COMMENTS IN SLOVER
  17458 C           ** PERIODIC BC IS NOT ALLOWED AT THIS TIME (3/26/79)
  17459 C   **ASSUMED**  M.GE.1 AND M.LE.MXX, X.GE.XM(1) AND X.LE.XM(MXX)
  17460 C                N.GE.1 AND N.LE.NXX, Y.GE.YN(1) AND Y.LE.YN(NXX)
  17461 C         SUBROUTINE DOES NOT TEST THESE CONDITIONS.
  17462 C          ALTHOUGH A HALF-NODE OVER-RUN OFF THE EDGES DOES NOT PRODUCE
  17463 C          LARGE ERRORS IN THE FUNCTION VALUE, ERRONEOUS RESULTS
  17464 C          MAY BE RETURNED IF THE CONDITIONS ARE NOT MET.
  17465 C
  17466       PARAMETER (MDIM=35,NDIM=35)
  17467 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  17468 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  17469       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,

Page 484         Source Listing                  XBF
2017-04-18 11:09                                 syndata.f

  17470      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  17471       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  17472      1                 YNC(NDIM),COSYN(NDIM)
  17473       COMMON /S2BCDC/ DX0,DX1,DX2,DY0,DY1,DY2,CBCBF(8),XYSDCP(2)
  17474 C
  17475       CHARACTER*125 IDSPC
  17476       EQUIVALENCE (MX,LX),(CBCBF(1),CBC11),(CBCBF(2),CBC12),
  17477      1                    (CBCBF(3),CBCX1),(CBCBF(4),CBCX2)
  17478 C
  17479       L=M
  17480       XS=(X-XM(L))*DX0
  17481       Z=2.-ABS(XS)
  17482       IF(Z.GT.0)  GO TO 15
  17483       XBF=0.
  17484       RETURN
  17485    15 CONTINUE
  17486       F=0.25*Z**3
  17487       Z=Z-1.
  17488       IF(Z.LE.0)  GO TO 23
  17489       F=F-Z**3
  17490    23 CONTINUE
  17491       IF(L-2.LT.0)  THEN
  17492          GO TO 30
  17493       ELSE IF(L-2.EQ.0)  THEN
  17494          GO TO 35
  17495       END IF
  17496       IF(LX-L.LT.0)  THEN
  17497          GO TO 40
  17498       ELSE  IF(LX-L.EQ.0)  THEN
  17499          GO TO 45
  17500       END IF
  17501    25 CONTINUE
  17502       XBF=F
  17503       RETURN
  17504 C
  17505 C     BOUNDARY ADJUSTMENTS
  17506 C
  17507    30 CONTINUE
  17508       IF(Z.LE.0)  GO TO 25
  17509       F=F+CBC11*(1.-XS)**3
  17510       GO TO 25
  17511    35 CONTINUE
  17512       IF(XS.GE.0)  GO TO 25
  17513       F=F-CBC12*XS**3
  17514       GO TO  25
  17515    40 CONTINUE
  17516       IF(Z.LE.0)  GO TO 25
  17517       F=F+CBCX1*(1.+XS)**3
  17518       GO TO 25
  17519    45 CONTINUE
  17520       IF(XS.LE.0)  GO TO 25
  17521       F=F+CBCX2*XS**3
  17522       GO TO  25
  17523 
  17524 C-----------------------------------------------------------------------
  17525 
  17526 C

Page 485         Source Listing                  XBF
2017-04-18 11:09                                 syndata.f

  17527 C   **FIRST DERIVATIVE OF CUBIC SPLINE BASIS FUNCTION
  17528 C
  17529       ENTRY DXBF(M,X)
  17530       D1=DX1
  17531       L=M
  17532       XS=(X-XM(L))*DX0
  17533       D1=-SIGN(D1,XS)
  17534       Z=2.-ABS(XS)
  17535       IF(Z.GT.0)  GO TO 115
  17536       XBF=0.
  17537       RETURN
  17538   115 CONTINUE
  17539       F=0.25*Z**2
  17540       Z=Z-1.
  17541       IF(Z.LE.0)  GO TO 123
  17542       F=F-Z**2
  17543   123 CONTINUE
  17544       IF(L-2.LT.0)  THEN
  17545          GO TO 130
  17546       ELSE IF (L-2.EQ.0)  THEN
  17547          GO TO 135
  17548       END IF
  17549       IF(LX-L.LT.0)  THEN
  17550          GO TO 140
  17551       ELSE  IF(LX-L.EQ.0)  THEN
  17552          GO TO 145
  17553       END IF
  17554   125 CONTINUE
  17555       XBF=F*D1
  17556       RETURN
  17557   130 CONTINUE
  17558       IF(Z.LE.0)  GO TO 125
  17559       F=F+CBC11*SIGN((1.-XS)**2,XS)
  17560       GO TO 125
  17561   135 CONTINUE
  17562       IF(XS.GE.0)  GO TO 125
  17563       F=F-CBC12*XS**2
  17564       GO TO 125
  17565   140 CONTINUE
  17566       IF(Z.LE.0) GO TO 125
  17567       F=F-CBCX1*SIGN((1.+XS)**2,XS)
  17568       GO TO 125
  17569   145 CONTINUE
  17570       IF(XS.LE.0) GO TO 125
  17571       F=F-CBCX2*XS**2
  17572       GO TO 125
  17573 
  17574 C-----------------------------------------------------------------------
  17575 
  17576 C
  17577 C   **SECOND DERIVATIVE OF CUBIC SPLINE BASIS FUNCTION
  17578 C
  17579       ENTRY DDXBF(M,X)
  17580       D2=DX2
  17581       L=M
  17582       XS=(X-XM(L))*DX0
  17583       Z=2.-ABS(XS)

Page 486         Source Listing                  XBF
2017-04-18 11:09                                 syndata.f

  17584       IF(Z.GT.0)  GO TO 215
  17585       XBF=0.
  17586       RETURN
  17587   215 CONTINUE
  17588       F=0.25*Z
  17589       Z=Z-1.
  17590       IF(Z.LE.0)  GO TO 223
  17591       F=F-Z
  17592   223 CONTINUE
  17593       IF(L-2.LT.0)  THEN
  17594          GO TO 230
  17595       ELSE  IF(L-2.EQ.0)  THEN
  17596          GO TO 235
  17597       END IF
  17598       IF(LX-L.LT.0) THEN
  17599          GO TO 240
  17600       ELSE  IF(LX-L.EQ.0)  THEN
  17601          GO TO 245
  17602       END IF
  17603   225 CONTINUE
  17604       XBF=F*D2
  17605       RETURN
  17606   230 CONTINUE
  17607       IF(Z.LE.0) GO TO 225
  17608       F=F+CBC11*(1.-XS)
  17609       GO TO 225
  17610   235 CONTINUE
  17611       IF(XS.GE.0) GO TO 225
  17612       F=F-CBC12*XS
  17613       GO TO 225
  17614   240 CONTINUE
  17615       IF(Z.LE.0) GO TO 225
  17616       F=F+CBCX1*(1.+XS)
  17617       GO TO 225
  17618   245 CONTINUE
  17619       IF(XS.LE.0) GO TO 225
  17620       F=F+CBCX2*XS
  17621       GO TO 225
  17622       END

Page 487         Source Listing                  XBF
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                 Name                 Name              
                                                              
 ddxbf_               dxbf_                xbf_               


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 115                        Label  17538                                                          17535                             
 123                        Label  17543                                                          17541                             
 125                        Label  17554                                                          17558,17560,17562,17564,17566,1756
                                                                                                  8,17570,17572                     
 130                        Label  17557                                                          17545                             
 135                        Label  17561                                                          17547                             
 140                        Label  17565                                                          17550                             
 145                        Label  17569                                                          17552                             
 15                         Label  17485                                                          17482                             
 215                        Label  17587                                                          17584                             
 223                        Label  17592                                                          17590                             
 225                        Label  17603                                                          17607,17609,17611,17613,17615,1761
                                                                                                  7,17619,17621                     
 23                         Label  17490                                                          17488                             
 230                        Label  17606                                                          17594                             
 235                        Label  17610                                                          17596                             
 240                        Label  17614                                                          17599                             
 245                        Label  17618                                                          17601                             
 25                         Label  17501                                                          17508,17510,17512,17514,17516,1751
                                                                                                  8,17520,17522                     
 30                         Label  17507                                                          17492                             
 35                         Label  17511                                                          17494                             
 40                         Label  17515                                                          17497                             
 45                         Label  17519                                                          17499                             
 ABS                        Func   17481                                scalar                    17481,17534,17583                 
 CBC11                      Scalar 17476    R(4)            4           scalar   COM              17509,17559,17608                 
 CBC12                      Scalar 17476    R(4)            4           scalar   COM              17513,17563,17612                 
 CBCBF                      Scalar 17473    R(4)            4     1     8        COM                                                
 CBCX1                      Scalar 17477    R(4)            4           scalar   COM              17517,17567,17616                 
 CBCX2                      Scalar 17477    R(4)            4           scalar   COM              17521,17571,17620                 
 COSYN                      Scalar 17472    R(4)            4     1     35       COM                                                
 D1                         Local  17530    R(4)            4           scalar                    17530,17533,17555                 
 D2                         Local  17580    R(4)            4           scalar                    17580,17604                       
 DDXBF                      Func   17579    R(4)            4           scalar                                                      
 DX0                        Scalar 17473    R(4)            4           scalar   COM              17480,17532,17582                 
 DX1                        Scalar 17473    R(4)            4           scalar   COM              17530                             
 DX2                        Scalar 17473    R(4)            4           scalar   COM              17580                             
 DXBF                       Func   17529    R(4)            4           scalar                                                      
 DXM                        Scalar 17471    R(4)            4           scalar   COM                                                
 DY0                        Scalar 17473    R(4)            4           scalar   COM                                                
 DY1                        Scalar 17473    R(4)            4           scalar   COM                                                
 DY2                        Scalar 17473    R(4)            4           scalar   COM                                                
 DYN                        Scalar 17471    R(4)            4           scalar   COM                                                
 F                          Local  17486    R(4)            4           scalar                    17486,17489,17502,17509,17513,1751

Page 488         Source Listing                  XBF
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  7,17521,17539,17542,17555,17559,17
                                                                                                  563,17567,17571,17588,17591,17604,
                                                                                                  17608,17612,17616,17620           
 IDSPC                      Scalar 17470    CHAR            125         scalar   COM                                                
 ISRCD                      Scalar 17469    I(4)            4           scalar   COM                                                
 JPD                        Scalar 17469    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 17469    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 17469    I(4)            4           scalar   COM                                                
 L                          Local  17479    I(4)            4           scalar                    17479,17480,17491,17493,17496,1749
                                                                                                  8,17531,17532,17544,17546,17549,17
                                                                                                  551,17581,17582,17593,17595,17598,
                                                                                                  17600                             
 LX                         Scalar 17476    I(4)            4           scalar   COM              17496,17498,17549,17551,17598,1760
                                                                                                  0                                 
 M                          Dummy  17445    I(4)            4           scalar   ARG,INOUT        17479,17531,17581                 
 MDIM                       Param  17466    I(4)            4           scalar                    17471                             
 MX                         Scalar 17469    I(4)            4           scalar   COM                                                
 MXX                        Scalar 17471    I(4)            4           scalar   COM                                                
 NDIM                       Param  17466    I(4)            4           scalar                    17471,17472                       
 NX                         Scalar 17469    I(4)            4           scalar   COM                                                
 NXX                        Scalar 17471    I(4)            4           scalar   COM                                                
 S2BCDC                     Common 17473                                64                                                          
 S2NODE                     Common 17471                                716                                                         
 S2PRIC                     Common 17469                                217                                                         
 SIGN                       Func   17533                                scalar                    17533,17559,17567                 
 X                          Dummy  17445    R(4)            4           scalar   ARG,INOUT        17480,17532,17582                 
 XBF                        Func   17445    R(4)            4           scalar                    17483,17502,17536,17555,17585,1760
                                                                                                  4                                 
 XBF@0                      Local  17445    R(4)            4           scalar                                                      
 XM                         Scalar 17471    R(4)            4     1     35       COM              17480,17532,17582                 
 XM1                        Scalar 17470    R(4)            4           scalar   COM                                                
 XMC                        Scalar 17471    R(4)            4     1     35       COM                                                
 XML                        Scalar 17469    R(4)            4           scalar   COM                                                
 XMR                        Scalar 17469    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 17470    R(4)            4           scalar   COM                                                
 XS                         Local  17480    R(4)            4           scalar                    17480,17481,17509,17512,17513,1751
                                                                                                  7,17520,17521,17532,17533,17534,17
                                                                                                  559,17562,17563,17567,17570,17571,
                                                                                                  17582,17583,17608,17611,17612,1761
                                                                                                  6,17619,17620                     
 XYBCWL                     Scalar 17470    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 17470    R(4)            4     1     2        COM                                                
 XYSDCP                     Scalar 17473    R(4)            4     1     2        COM                                                
 YN                         Scalar 17471    R(4)            4     1     35       COM                                                
 YN1                        Scalar 17470    R(4)            4           scalar   COM                                                
 YNB                        Scalar 17469    R(4)            4           scalar   COM                                                
 YNC                        Scalar 17472    R(4)            4     1     35       COM                                                
 YNT                        Scalar 17469    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17470    R(4)            4           scalar   COM                                                
 Z                          Local  17481    R(4)            4           scalar                    17481,17482,17486,17487,17488,1748
                                                                                                  9,17508,17516,17534,17535,17539,17
                                                                                                  540,17541,17542,17558,17566,17583,
                                                                                                  17584,17588,17589,17590,17591,1760
                                                                                                  7,17615                           

Page 489         Source Listing                  XBF
2017-04-18 11:09                                 syndata.f

  17623 
  17624 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17625 C                .      .    .                                       .
  17626 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17627 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17628 C
  17629 C ABSTRACT: ??????????????????????????????????????????????????????????
  17630 C   ??????????????????????????????????????????????????????????????????
  17631 C
  17632 C PROGRAM HISTORY LOG:
  17633 C ????-??-??  S. J. LORD
  17634 C
  17635 C USAGE:    CALL ????????(????)
  17636 C   INPUT ARGUMENT LIST:
  17637 C     ??????   - ???????????????????????????????????????????????
  17638 C
  17639 C   OUTPUT ARGUMENT LIST:
  17640 C     ??????   - ???????????????????????????????????????????????
  17641 C
  17642 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17643 C     ??????   - ???????????????????????????????????????????????
  17644 C
  17645 C   OUTPUT FILES:
  17646 C     ??????   - ???????????????????????????????????????????????
  17647 C
  17648 C REMARKS: ?????????????????????????????????????????????????????
  17649 C
  17650 C ATTRIBUTES:
  17651 C   LANGUAGE: FORTRAN 90
  17652 C   MACHINE:  NCEP WCOSS
  17653 C
  17654 C$$$
  17655       FUNCTION Y1BF(N,Y)
  17656 CCCCC    ENTRY D1YBF, D1YSBF, DD1YBF, DD1YSF
  17657 C
  17658       PARAMETER (NDIM=71)
  17659 C
  17660       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,YBCWL(2),IDSPC
  17661       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  17662       COMMON /S1BCDC/ DY0,DY1,DY2,CBCBF(4),YSDCPI
  17663 C
  17664       CHARACTER*125 IDSPC
  17665 C
  17666       EQUIVALENCE (NX,LX),(CBCBF(1),CBC11),(CBCBF(2),CBC12),
  17667      1                    (CBCBF(3),CBCX1),(CBCBF(4),CBCX2)
  17668 C
  17669 CCCC  ENTRY Y1BF
  17670 
  17671       L=N
  17672       XS=(Y-YN(L))*DY0
  17673       Z=2.-ABS(XS)
  17674       IF(Z.GT.0) GO TO 15
  17675       Y1BF=0.
  17676       RETURN
  17677    15 CONTINUE
  17678       F=0.25*Z**3
  17679       Z=Z-1.

Page 490         Source Listing                  Y1BF
2017-04-18 11:09                                 syndata.f

  17680       IF(Z.LE.0)  GO TO 23
  17681       F=F-Z**3
  17682    23 CONTINUE
  17683       IF(L-2.LT.0) THEN
  17684          GO TO 30
  17685       ELSE  IF(L-2.EQ.0) THEN
  17686          GO TO 35
  17687       END IF
  17688       IF(LX-L.LT.0) THEN
  17689          GO TO 40
  17690       ELSE  IF(LX-L.EQ.0) THEN
  17691          GO TO 45
  17692       END IF
  17693    25 CONTINUE
  17694       Y1BF=F
  17695       RETURN
  17696 C
  17697 C     BOUNDARY ADJUSTMENTS
  17698 C
  17699    30 CONTINUE
  17700       IF(Z.LE.0)  GO TO 25
  17701       F=F+CBC11*(1.-XS)**3
  17702       GO TO 25
  17703    35 CONTINUE
  17704       IF(XS.GE.0) GO TO 25
  17705       F=F-CBC12*XS**3
  17706       GO TO  25
  17707    40 CONTINUE
  17708       IF(Z.LE.0)  GO TO 25
  17709       F=F+CBCX1*(1.+XS)**3
  17710       GO TO 25
  17711    45 CONTINUE
  17712       IF(XS.LE.0)  GO TO 25
  17713       F=F+CBCX2*XS**3
  17714       GO TO  25
  17715 
  17716 
  17717 C-----------------------------------------------------------------------
  17718 
  17719 C
  17720       ENTRY D1YBF(N,Y)
  17721       D1=DY1
  17722       L=N
  17723       XS=(Y-YN(L))*DY0
  17724       D1=-SIGN(D1,XS)
  17725       Z=2.-ABS(XS)
  17726       IF(Z.GT.0) GO TO 115
  17727       Y1BF=0.
  17728       RETURN
  17729   115 CONTINUE
  17730       F=0.25*Z**2
  17731       Z=Z-1.
  17732       IF(Z.LE.0) GO TO 123
  17733       F=F-Z**2
  17734   123 CONTINUE
  17735       IF(L-2.LT.0) THEN
  17736          GO TO 130

Page 491         Source Listing                  Y1BF
2017-04-18 11:09                                 syndata.f

  17737       ELSE  IF(L-2.EQ.0) THEN
  17738          GO TO 135
  17739       END IF
  17740       IF(LX-L.LT.0) THEN
  17741          GO TO 140
  17742       ELSE  IF(LX-L.EQ.0) THEN
  17743          GO TO 145
  17744       END IF
  17745   125 CONTINUE
  17746       Y1BF=F*D1
  17747       RETURN
  17748   130 CONTINUE
  17749       IF(Z.LE.0) GO TO 125
  17750       F=F+CBC11*SIGN((1.-XS)**2,XS)
  17751       GO TO 125
  17752   135 CONTINUE
  17753       IF(XS.GE.0) GO TO 125
  17754       F=F-CBC12*XS**2
  17755       GO TO 125
  17756   140 CONTINUE
  17757       IF(Z.LE.0) GO TO 125
  17758       F=F-CBCX1*SIGN((1.+XS)**2,XS)
  17759       GO TO 125
  17760   145 CONTINUE
  17761       IF(XS.LE.0) GO TO 125
  17762       F=F-CBCX2*XS**2
  17763       GO TO 125
  17764 C
  17765 
  17766 C-----------------------------------------------------------------------
  17767 
  17768       ENTRY DD1YBF(N,Y)
  17769       D2=DY2
  17770       L=N
  17771       XS=(Y-YN(L))*DY0
  17772       Z=2.-ABS(XS)
  17773       IF(Z.GT.0) GO TO 215
  17774       Y1BF=0.
  17775       RETURN
  17776   215 CONTINUE
  17777       F=0.25*Z
  17778       Z=Z-1.
  17779       IF(Z.LE.0) GO TO 223
  17780       F=F-Z
  17781   223 CONTINUE
  17782       IF(L-2.LT.0) THEN
  17783          GO TO 230
  17784       ELSE  IF(L-2.EQ.0) THEN
  17785          GO TO 235
  17786       END IF
  17787       IF(LX-L.LT.0) THEN
  17788          GO TO 240
  17789       ELSE  IF(LX-L.EQ.0) THEN
  17790          GO TO 245
  17791       END IF
  17792   225 CONTINUE
  17793       Y1BF=F*D2

Page 492         Source Listing                  Y1BF
2017-04-18 11:09                                 syndata.f

  17794       RETURN
  17795   230 CONTINUE
  17796       IF(Z.LE.0) GO TO 225
  17797       F=F+CBC11*(1.-XS)
  17798       GO TO 225
  17799   235 CONTINUE
  17800       IF(XS.GE.0) GO TO 225
  17801       F=F-CBC12*XS
  17802       GO TO 225
  17803   240 CONTINUE
  17804       IF(Z.LE.0) GO TO 225
  17805       F=F+CBCX1*(1.+XS)
  17806       GO TO 225
  17807   245 CONTINUE
  17808       IF(XS.LE.0) GO TO 225
  17809       F=F+CBCX2*XS
  17810       GO TO 225
  17811       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 d1ybf_                dd1ybf_               y1bf_               


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 115                        Label  17729                                                          17726                             
 123                        Label  17734                                                          17732                             
 125                        Label  17745                                                          17749,17751,17753,17755,17757,1775
                                                                                                  9,17761,17763                     
 130                        Label  17748                                                          17736                             
 135                        Label  17752                                                          17738                             
 140                        Label  17756                                                          17741                             
 145                        Label  17760                                                          17743                             
 15                         Label  17677                                                          17674                             
 215                        Label  17776                                                          17773                             
 223                        Label  17781                                                          17779                             
 225                        Label  17792                                                          17796,17798,17800,17802,17804,1780
                                                                                                  6,17808,17810                     
 23                         Label  17682                                                          17680                             
 230                        Label  17795                                                          17783                             
 235                        Label  17799                                                          17785                             
 240                        Label  17803                                                          17788                             
 245                        Label  17807                                                          17790                             
 25                         Label  17693                                                          17700,17702,17704,17706,17708,1771
                                                                                                  0,17712,17714                     
 30                         Label  17699                                                          17684                             
 35                         Label  17703                                                          17686                             
 40                         Label  17707                                                          17689                             
 45                         Label  17711                                                          17691                             
 ABS                        Func   17673                                scalar                    17673,17725,17772                 
 CBC11                      Scalar 17666    R(4)            4           scalar   COM              17701,17750,17797                 

Page 493         Source Listing                  Y1BF
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CBC12                      Scalar 17666    R(4)            4           scalar   COM              17705,17754,17801                 
 CBCBF                      Scalar 17662    R(4)            4     1     4        COM                                                
 CBCX1                      Scalar 17667    R(4)            4           scalar   COM              17709,17758,17805                 
 CBCX2                      Scalar 17667    R(4)            4           scalar   COM              17713,17762,17809                 
 D1                         Local  17721    R(4)            4           scalar                    17721,17724,17746                 
 D1YBF                      Func   17720    R(4)            4           scalar                                                      
 D2                         Local  17769    R(4)            4           scalar                    17769,17793                       
 DD1YBF                     Func   17768    R(4)            4           scalar                                                      
 DY0                        Scalar 17662    R(4)            4           scalar   COM              17672,17723,17771                 
 DY1                        Scalar 17662    R(4)            4           scalar   COM              17721                             
 DY2                        Scalar 17662    R(4)            4           scalar   COM              17769                             
 DYN                        Scalar 17661    R(4)            4           scalar   COM                                                
 F                          Local  17678    R(4)            4           scalar                    17678,17681,17694,17701,17705,1770
                                                                                                  9,17713,17730,17733,17746,17750,17
                                                                                                  754,17758,17762,17777,17780,17793,
                                                                                                  17797,17801,17805,17809           
 IDSPC                      Scalar 17660    CHAR            125         scalar   COM                                                
 KBCTYP                     Scalar 17660    I(4)            4     1     2        COM                                                
 KDCTYP                     Scalar 17660    I(4)            4           scalar   COM                                                
 L                          Local  17671    I(4)            4           scalar                    17671,17672,17683,17685,17688,1769
                                                                                                  0,17722,17723,17735,17737,17740,17
                                                                                                  742,17770,17771,17782,17784,17787,
                                                                                                  17789                             
 LX                         Scalar 17666    I(4)            4           scalar   COM              17688,17690,17740,17742,17787,1778
                                                                                                  9                                 
 N                          Dummy  17655    I(4)            4           scalar   ARG,INOUT        17671,17722,17770                 
 NDIM                       Param  17658    I(4)            4           scalar                    17661                             
 NX                         Scalar 17660    I(4)            4           scalar   COM                                                
 NXX                        Scalar 17661    I(4)            4           scalar   COM                                                
 S1BCDC                     Common 17662                                32                                                          
 S1NODE                     Common 17661                                292                                                         
 S1PRIC                     Common 17660                                161                                                         
 SIGN                       Func   17724                                scalar                    17724,17750,17758                 
 XS                         Local  17672    R(4)            4           scalar                    17672,17673,17701,17704,17705,1770
                                                                                                  9,17712,17713,17723,17724,17725,17
                                                                                                  750,17753,17754,17758,17761,17762,
                                                                                                  17771,17772,17797,17800,17801,1780
                                                                                                  5,17808,17809                     
 Y                          Dummy  17655    R(4)            4           scalar   ARG,INOUT        17672,17723,17771                 
 Y1BF                       Func   17655    R(4)            4           scalar                    17675,17694,17727,17746,17774,1779
                                                                                                  3                                 
 Y1BF@0                     Local  17655    R(4)            4           scalar                                                      
 YBCWL                      Scalar 17660    R(4)            4     1     2        COM                                                
 YDCWL                      Scalar 17660    R(4)            4           scalar   COM                                                
 YN                         Scalar 17661    R(4)            4     1     71       COM              17672,17723,17771                 
 YN1                        Scalar 17660    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17660    R(4)            4           scalar   COM                                                
 YSDCPI                     Scalar 17662    R(4)            4           scalar   COM                                                
 Z                          Local  17673    R(4)            4           scalar                    17673,17674,17678,17679,17680,1768
                                                                                                  1,17700,17708,17725,17726,17730,17
                                                                                                  731,17732,17733,17749,17757,17772,
                                                                                                  17773,17777,17778,17779,17780,1779
                                                                                                  6,17804                           

Page 494         Source Listing                  Y1BF
2017-04-18 11:09                                 syndata.f

  17812 
  17813 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17814 C                .      .    .                                       .
  17815 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17816 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17817 C
  17818 C ABSTRACT: ??????????????????????????????????????????????????????????
  17819 C   ??????????????????????????????????????????????????????????????????
  17820 C
  17821 C PROGRAM HISTORY LOG:
  17822 C ????-??-??  S. J. LORD
  17823 C
  17824 C USAGE:    CALL ????????(????)
  17825 C   INPUT ARGUMENT LIST:
  17826 C     ??????   - ???????????????????????????????????????????????
  17827 C
  17828 C   OUTPUT ARGUMENT LIST:
  17829 C     ??????   - ???????????????????????????????????????????????
  17830 C
  17831 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17832 C     ??????   - ???????????????????????????????????????????????
  17833 C
  17834 C   OUTPUT FILES:
  17835 C     ??????   - ???????????????????????????????????????????????
  17836 C
  17837 C REMARKS: ?????????????????????????????????????????????????????
  17838 C
  17839 C ATTRIBUTES:
  17840 C   LANGUAGE: FORTRAN 90
  17841 C   MACHINE:  NCEP WCOSS
  17842 C
  17843 C$$$
  17844       SUBROUTINE MERCAT(ELO0,GGL0,ELO,GGL,X,Y,LLX)
  17845 C
  17846 C          ENTRY MERCG0(ELO0,GGL0)    SET THE ORIGIN IF AND ONLY IF MFLA
  17847 C          ENTRY MERCXY(ELO,GGL,X,Y)  CONVERT (ELO,GGL) TO (X,Y)
  17848 C          ENTRY MERCLL(X,Y,ELO,GGL)  CONVERT (X,Y) TO (ELO,GGL)
  17849 C     BASIC VARIABLES OF MERCATOR PROJECTION ROUTINE
  17850 C        X,Y   MERCATOR COORDINATES IN METER.
  17851 C        ELO   EAST LONGITUDE (NEGATIVE IF WEST) IN DEGREE
  17852 C        GGL   GEOGRAPHICAL LATITUDE IN DEGREE
  17853 C        GCL   GEOCENTRIC LATITUDE IN RADIAN
  17854 C     FOR FASTER CALCULATIONS, USE GCL=1.0067*CRDNDG*GGL,AND (Y,GCL)-TAB
  17855 C       ARG1,ARG2 MAY BE PLACED IN COMMON.
  17856 C
  17857       SAVE
  17858 C
  17859       DIMENSION ELO(LLX),GGL(LLX),X(LLX),Y(LLX)
  17860       COMMON /MERCON/ RDSEQU,RDSPOL,RDSSPH,MFLAG,ORGELO,ORGGGL
  17861 CIBM  DATA INITIALIZATION MOVED TO BLOCK DATA BELOW THIS SUBROUTINE
  17862 CIBM  DATA RDSEQU/6378.4E3/,RDSPOL/6356.9E3/,RDSSPH/6378.E3/, MFLAG/0/
  17863 C
  17864 
  17865 C-----------------------------------------------------------------------
  17866 
  17867       ENTRY MERCG0(ELO0,GGL0)
  17868       IF(MFLAG.NE.0) RETURN

Page 495         Source Listing                  MERCAT
2017-04-18 11:09                                 syndata.f

  17869 C
  17870 C     INPUT ELO0,GGL0 LONGITUDE AND LATITUDE OF THE ORIGIN IN DEGREES
  17871 C
  17872       ORGELO=ELO0
  17873       ORGGGL=GGL0
  17874       CGCLGG=(RDSPOL/RDSEQU)**2
  17875       CRDNDG=3.1415926536/180.
  17876       GCL0=ATAN(CGCLGG*TAN(CRDNDG*GGL0))
  17877       FML0=1./COS(GCL0)
  17878       CRDSS2=RDSSPH*2./FML0
  17879       CXELO=RDSSPH*CRDNDG/FML0
  17880       CYGCL=RDSSPH/FML0
  17881       X0=CXELO*ELO0
  17882       Y0=CYGCL*ALOG((1.+TAN(.5*GCL0))/(1.-TAN(.5*GCL0)))
  17883       MFLAG=1
  17884       RETURN
  17885 
  17886 C-----------------------------------------------------------------------
  17887 
  17888 C
  17889       ENTRY MERCXY(ELO,GGL,X,Y,LLX)
  17890 C
  17891 C     INPUT    ELO,GGL   LONGITUDE AND LATITUDE IN DEGREES
  17892 C     OUTPUT   X,  Y     MERCATOR COORDINATES IN METERS
  17893 C
  17894       DO 10 LL=1,LLX
  17895         GCL=ATAN(CGCLGG*TAN(CRDNDG*GGL(LL)))
  17896         Z=TAN(0.5*GCL)
  17897         X(LL)=CXELO*ELO(LL)-X0
  17898         Y(LL)=CYGCL*ALOG((1.+Z)/(1.-Z))-Y0
  17899    10 CONTINUE
  17900       RETURN
  17901 
  17902 C-----------------------------------------------------------------------
  17903 
  17904 C
  17905       ENTRY MERCLL(X,Y,ELO,GGL,LLX)
  17906 C
  17907 C     INPUT    X,  Y     MERCATOR COORDINATES IN METERS
  17908 C     OUTPUT   ELO,GGL   LONGITUDE AND LATITUDE IN DEGREES
  17909 C
  17910       DO  LL=1,LLX
  17911          GCL=2.*ATAN(TANH((Y(LL)+Y0)/CRDSS2))
  17912          ELO(LL)=(X(LL)+X0)/CXELO
  17913          GGL(LL)=ATAN(TAN(GCL)/CGCLGG)/CRDNDG
  17914       ENDDO
  17915       RETURN
  17916 
  17917 C-----------------------------------------------------------------------
  17918       END

Page 496         Source Listing                  MERCAT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 mercat_               mercg0_               mercll_               mercxy_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  17899                                                          17894                             
 ALOG                       Func   17882                                scalar                    17882,17898                       
 ATAN                       Func   17876                                scalar                    17876,17895,17911,17913           
 CGCLGG                     Local  17874    R(4)            4           scalar   SAVE             17874,17876,17895,17913           
 COS                        Func   17877                                scalar                    17877                             
 CRDNDG                     Local  17875    R(4)            4           scalar   SAVE             17875,17876,17879,17895,17913     
 CRDSS2                     Local  17878    R(4)            4           scalar   SAVE             17878,17911                       
 CXELO                      Local  17879    R(4)            4           scalar   SAVE             17879,17881,17897,17912           
 CYGCL                      Local  17880    R(4)            4           scalar   SAVE             17880,17882,17898                 
 ELO                        Dummy  17844    R(4)            4     1     0        ARG,INOUT        17897,17912                       
 ELO0                       Dummy  17844    R(4)            4           scalar   ARG,INOUT        17872,17881                       
 FML0                       Local  17877    R(4)            4           scalar   SAVE             17877,17878,17879,17880           
 GCL                        Local  17895    R(4)            4           scalar   SAVE             17895,17896,17911,17913           
 GCL0                       Local  17876    R(4)            4           scalar   SAVE             17876,17877,17882                 
 GGL                        Dummy  17844    R(4)            4     1     0        ARG,INOUT        17895,17913                       
 GGL0                       Dummy  17844    R(4)            4           scalar   ARG,INOUT        17873,17876                       
 LL                         Local  17894    I(4)            4           scalar   SAVE             17894,17895,17897,17898,17910,1791
                                                                                                  1,17912,17913                     
 LLX                        Dummy  17844    I(4)            4           scalar   ARG,INOUT        17859,17894,17910                 
 MERCAT                     Subr   17844                                                                                            
 MERCG0                     Subr   17867                                                                                            
 MERCLL                     Subr   17905                                                                                            
 MERCON                     Common 17860                                24       SAVE                                               
 MERCXY                     Subr   17889                                                                                            
 MFLAG                      Scalar 17860    I(4)            4           scalar   COM              17868,17883                       
 ORGELO                     Scalar 17860    R(4)            4           scalar   COM              17872                             
 ORGGGL                     Scalar 17860    R(4)            4           scalar   COM              17873                             
 RDSEQU                     Scalar 17860    R(4)            4           scalar   COM              17874                             
 RDSPOL                     Scalar 17860    R(4)            4           scalar   COM              17874                             
 RDSSPH                     Scalar 17860    R(4)            4           scalar   COM              17878,17879,17880                 
 TAN                        Func   17876                                scalar                    17876,17882,17895,17896,17913     
 TANH                       Func   17911                                scalar                    17911                             
 X                          Dummy  17844    R(4)            4     1     0        ARG,INOUT        17897,17912                       
 X0                         Local  17881    R(4)            4           scalar   SAVE             17881,17897,17912                 
 Y                          Dummy  17844    R(4)            4     1     0        ARG,INOUT        17898,17911                       
 Y0                         Local  17882    R(4)            4           scalar   SAVE             17882,17898,17911                 
 Z                          Local  17896    R(4)            4           scalar   SAVE             17896,17898                       

Page 497         Source Listing                  MERCAT
2017-04-18 11:09                                 syndata.f

  17919 
  17920 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17921 C                .      .    .                                       .
  17922 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17923 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17924 C
  17925 C ABSTRACT: ??????????????????????????????????????????????????????????
  17926 C   ??????????????????????????????????????????????????????????????????
  17927 C
  17928 C PROGRAM HISTORY LOG:
  17929 C ????-??-??  S. J. LORD
  17930 C
  17931 C USAGE:    CALL ????????(????)
  17932 C   INPUT ARGUMENT LIST:
  17933 C     ??????   - ???????????????????????????????????????????????
  17934 C
  17935 C   OUTPUT ARGUMENT LIST:
  17936 C     ??????   - ???????????????????????????????????????????????
  17937 C
  17938 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17939 C     ??????   - ???????????????????????????????????????????????
  17940 C
  17941 C   OUTPUT FILES:
  17942 C     ??????   - ???????????????????????????????????????????????
  17943 C
  17944 C REMARKS: ?????????????????????????????????????????????????????
  17945 C
  17946 C ATTRIBUTES:
  17947 C   LANGUAGE: FORTRAN 90
  17948 C   MACHINE:  NCEP WCOSS
  17949 C
  17950 C$$$
  17951       BLOCK DATA IBM5
  17952       COMMON /MERCON/ RDSEQU,RDSPOL,RDSSPH,MFLAG,ORGELO,ORGGGL
  17953       DATA RDSEQU/6378.4E3/,RDSPOL/6356.9E3/,RDSSPH/6378.E3/, MFLAG/0/
  17954       END

Page 498         Source Listing                  IBM5
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IBM5                       Block  17951                                scalar                                                      
 MERCON                     Common 17952                                24                                                          
 MFLAG                      Scalar 17952    I(4)            4           scalar   COM,SAVE         17953                             
 ORGELO                     Scalar 17952    R(4)            4           scalar   COM                                                
 ORGGGL                     Scalar 17952    R(4)            4           scalar   COM                                                
 RDSEQU                     Scalar 17952    R(4)            4           scalar   COM,SAVE         17953                             
 RDSPOL                     Scalar 17952    R(4)            4           scalar   COM,SAVE         17953                             
 RDSSPH                     Scalar 17952    R(4)            4           scalar   COM,SAVE         17953                             

Page 499         Source Listing                  IBM5
2017-04-18 11:09                                 syndata.f

  17955 
  17956 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  17957 C                .      .    .                                       .
  17958 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  17959 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  17960 C
  17961 C ABSTRACT: ??????????????????????????????????????????????????????????
  17962 C   ??????????????????????????????????????????????????????????????????
  17963 C
  17964 C PROGRAM HISTORY LOG:
  17965 C ????-??-??  S. J. LORD
  17966 C
  17967 C USAGE:    CALL ????????(????)
  17968 C   INPUT ARGUMENT LIST:
  17969 C     ??????   - ???????????????????????????????????????????????
  17970 C
  17971 C   OUTPUT ARGUMENT LIST:
  17972 C     ??????   - ???????????????????????????????????????????????
  17973 C
  17974 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  17975 C     ??????   - ???????????????????????????????????????????????
  17976 C
  17977 C   OUTPUT FILES:
  17978 C     ??????   - ???????????????????????????????????????????????
  17979 C
  17980 C REMARKS: ?????????????????????????????????????????????????????
  17981 C
  17982 C ATTRIBUTES:
  17983 C   LANGUAGE: FORTRAN 90
  17984 C   MACHINE:  NCEP WCOSS
  17985 C
  17986 C$$$
  17987       SUBROUTINE DOMCHK(XZ,YZ,IN)
  17988 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  17989 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  17990       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  17991      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  17992       CHARACTER IDSPC*125
  17993 C
  17994       SAVE
  17995 C
  17996 C     THIS SUBROUTINE DETERMINES IF A GIVEN LOCATION IS WITHIN
  17997 C     DOMAIN BOUNDARIES.  THE INTERNAL COORDINATE (XM1,XMXX)
  17998 C     AND (YN1,YNXX) IS USED.  THE SUBROUTINE RETURNS IN=1 IF
  17999 C     INSIDE THE DOMAIN, IN=0 IF OUTSIDE.
  18000 C
  18001       IN=1
  18002       IF(XZ .LT. XM1 .OR. XZ .GT. XMXX)  IN=0
  18003       IF(YZ .LT. YN1 .OR. YZ .GT. YNXX)  IN=0
  18004       RETURN
  18005       END

Page 500         Source Listing                  DOMCHK
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 domchk_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DOMCHK                     Subr   17987                                                                                            
 IDSPC                      Scalar 17991    CHAR            125         scalar   COM                                                
 IN                         Dummy  17987    I(4)            4           scalar   ARG,INOUT        18001,18002,18003                 
 ISRCD                      Scalar 17990    I(4)            4           scalar   COM                                                
 JPD                        Scalar 17990    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 17990    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 17990    I(4)            4           scalar   COM                                                
 MX                         Scalar 17990    I(4)            4           scalar   COM                                                
 NX                         Scalar 17990    I(4)            4           scalar   COM                                                
 S2PRIC                     Common 17990                                217      SAVE                                               
 XM1                        Scalar 17991    R(4)            4           scalar   COM              18002                             
 XML                        Scalar 17990    R(4)            4           scalar   COM                                                
 XMR                        Scalar 17990    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 17991    R(4)            4           scalar   COM              18002                             
 XYBCWL                     Scalar 17991    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 17991    R(4)            4     1     2        COM                                                
 XZ                         Dummy  17987    R(4)            4           scalar   ARG,INOUT        18002                             
 YN1                        Scalar 17991    R(4)            4           scalar   COM              18003                             
 YNB                        Scalar 17990    R(4)            4           scalar   COM                                                
 YNT                        Scalar 17990    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 17991    R(4)            4           scalar   COM              18003                             
 YZ                         Dummy  17987    R(4)            4           scalar   ARG,INOUT        18003                             

Page 501         Source Listing                  DOMCHK
2017-04-18 11:09                                 syndata.f

  18006 
  18007 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18008 C                .      .    .                                       .
  18009 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18010 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18011 C
  18012 C ABSTRACT: ??????????????????????????????????????????????????????????
  18013 C   ??????????????????????????????????????????????????????????????????
  18014 C
  18015 C PROGRAM HISTORY LOG:
  18016 C ????-??-??  S. J. LORD
  18017 C
  18018 C USAGE:    CALL ????????(????)
  18019 C   INPUT ARGUMENT LIST:
  18020 C     ??????   - ???????????????????????????????????????????????
  18021 C
  18022 C   OUTPUT ARGUMENT LIST:
  18023 C     ??????   - ???????????????????????????????????????????????
  18024 C
  18025 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18026 C     ??????   - ???????????????????????????????????????????????
  18027 C
  18028 C   OUTPUT FILES:
  18029 C     ??????   - ???????????????????????????????????????????????
  18030 C
  18031 C REMARKS: ?????????????????????????????????????????????????????
  18032 C
  18033 C ATTRIBUTES:
  18034 C   LANGUAGE: FORTRAN 90
  18035 C   MACHINE:  NCEP WCOSS
  18036 C
  18037 C$$$
  18038       SUBROUTINE COORDS(NFIX,ihz)
  18039 C
  18040       PARAMETER (LDXDIM=8000)
  18041       PARAMETER (NFXDIM=20)
  18042 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  18043 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  18044       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  18045      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  18046       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  18047      1               ID(LDXDIM),LXSORT(LDXDIM)
  18048       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  18049      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),
  18050      2            ELORG,GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  18051 C
  18052       SAVE
  18053       CHARACTER*8 HORCZ,IDSPD1,IDSPD2*72,IDSPC*125
  18054       DIMENSION DTFIX(NFXDIM),DTOB(LDXDIM),XDZ(LDXDIM),YDZ(LDXDIM),
  18055      1          HORCZ(2),XZA(1),YZA(1),XSTM0A(1),YSTM0A(1)
  18056       DATA HORCZ/'LAT/LONG','MERCATOR'/
  18057 C
  18058 C     THIS SUBROUTINE DEFINES COORDINATE LOCATION OF ALL DATA POINTS.
  18059 C     THE DOMAIN SIZE IS NOT AFFECTED.  THE CENTER (0,0) OF THE COORDINA
  18060 C     SYSTEM HAS BEEN DEFINED IN ENTRY STHORC OF SUBROUTINE SLOVER.
  18061 C       "EARTH COORDINATES" (EC) MAINTAINS THE (X,Y) POSITION OF EACH OB
  18062 C          IRRESPECTIVE OF THE OBS. TIME.

Page 502         Source Listing                  COORDS
2017-04-18 11:09                                 syndata.f

  18063 C       "STORM-RELATIVE COORDINATES" (SRC) ADJUSTS THE (X,Y) POSITION
  18064 C          OF EACH OBSERVATION TO BE IN THE SAME RELATIVE POSITION TO
  18065 C          THE STORM CENTER AT THE ANALYSIS TIME.
  18066 C
  18067 
  18068 C-----------------------------------------------------------------------
  18069 
  18070       ENTRY CHORC(IHZ)
  18071       IHCSET=IHZ
  18072       RETURN
  18073 C
  18074 
  18075 C-----------------------------------------------------------------------
  18076 
  18077       ENTRY CTRANS(NFIX)
  18078 C
  18079       IF(IHCSET .EQ. 0)  THEN
  18080 C
  18081 C     CONVERT STORM POSITIONS AND DATA LOCATIONS FOR LAT./LONG.
  18082 C       COORDINATES BY SUBTRACTING OFF LAT./LONG. OF COORDINATE
  18083 C       ORIGIN.
  18084 C
  18085       DO N=1,NFIX
  18086       XSTM(N)=XSTM(N)-ELORG
  18087       YSTM(N)=YSTM(N)-GLORG
  18088       ENDDO
  18089 C
  18090       DO LD=1,LDX
  18091       XD(LD)=XD(LD)-ELORG
  18092       YD(LD)=YD(LD)-GLORG
  18093       ENDDO
  18094 C
  18095 C     CONVERT STORM POSITIONS AND DATA LOCATIONS FOR MERCATOR
  18096 C       COORDINATES.
  18097 C
  18098       ELSE IF(IHCSET .EQ. 1)  THEN
  18099 
  18100       XDZ(1:LDX)=XD(1:LDX)
  18101       YDZ(1:LDX)=YD(1:LDX)
  18102 C
  18103       CALL MERCXY(XDZ,YDZ,XD,YD,LDX)
  18104 C
  18105       XDZ(1:NFIX)=XSTM(1:NFIX)
  18106       YDZ(1:NFIX)=YSTM(1:NFIX)
  18107 C
  18108       CALL MERCXY(XDZ,YDZ,XSTM,YSTM,NFIX)
  18109       ELSE
  18110       WRITE(6,31) IHCSET
  18111    31 FORMAT('******IMPROPER COORDINATE SYSTEM IN CTRANS,',
  18112      1       ' IHCSET=',I5)
  18113       CALL ABRT1(' CTRANS',31)
  18114       ENDIF
  18115 C
  18116 C     FOR EARTH-RELATIVE COORDINATES
  18117 C
  18118       IF(ISRCD .EQ. 0) THEN
  18119       WRITE(6,126) HORCZ(IHCSET+1),ELORG,GLORG

Page 503         Source Listing                  COORDS
2017-04-18 11:09                                 syndata.f

  18120   126 FORMAT('....FIXED (',A8,') EARTH COORDINATES RELATIVE TO LONG.=',
  18121      1       F8.3,' AND LATITUDE=',F7.3)
  18122       RETURN
  18123 C
  18124 C     FOR STORM-RELATIVE COORDINATES:  CONVERTING OBSERVATIONS
  18125 C
  18126       ELSE IF(ISRCD .EQ. 1)  THEN
  18127       CALL XTIME(IDAYMN,000.0,IYMN,IMMN,IDMN,HRMN)
  18128 C
  18129       DO 210 N=1,NFIX
  18130       CALL XTIME(IDAYST(N),UTCSTM(N),IYR,IMO,IDA,HR)
  18131       CALL DTIME(IYMN,IMMN,IDMN,HRMN,IYR,IMO,IDA,HR,DTFIX(N))
  18132   210 CONTINUE
  18133 C
  18134       DO 400 LD=1,LDX
  18135       CALL XTIME(IDAYOB(LD),UTCOB(LD),IYR,IMO,IDA,HR)
  18136       CALL DTIME(IYMN,IMMN,IDMN,HRMN,IYR,IMO,IDA,HR,DTOB(LD))
  18137       NFIX1=NFIX-1
  18138       DO 300 N=1,NFIX1
  18139       NF=N
  18140       IF(DTOB(LD) .GT. DTFIX(N) .AND. DTOB(LD) .LE. DTFIX(N+1))
  18141      1      GO TO 310
  18142   300 CONTINUE
  18143       WRITE(6,301)  LD,DTOB(LD),(DTFIX(NN),NN=1,NFIX),IDAYOB(LD),
  18144      1              UTCOB(LD),IYR,IMO,IDA,HR,IYMN,IMMN,IDMN,HRMN
  18145   301 FORMAT(/'****** OBS. TIME',I5,'...CANNOT FIND 2 FIX POSITIONS',
  18146      1       F10.2/3(10X,F10.2/),I13,F13.3/2(3I10,F13.3/))
  18147       CALL ABRT1(' CTRANS',301)
  18148   310 DT=DTFIX(NF+1)-DTFIX(NF)
  18149       IF(ABS(DT) .LT. 1.E-4)  GO TO 910
  18150       RAT=(DTOB(LD)-DTFIX(NF))/(DTFIX(NF+1)-DTFIX(NF))
  18151       XSTOB=XSTM(NF)+(XSTM(NF+1)-XSTM(NF))*RAT-XSTM0
  18152       YSTOB=YSTM(NF)+(YSTM(NF+1)-YSTM(NF))*RAT-YSTM0
  18153       XD(LD)=XD(LD)-XSTOB
  18154       YD(LD)=YD(LD)-YSTOB
  18155   400 CONTINUE
  18156 C
  18157       IF(IHCSET .EQ. 1)  THEN
  18158       XSTM0A(1) = XSTM0
  18159       YSTM0A(1) = YSTM0
  18160       XZA(1) = XZ
  18161       YZA(1) = YZ
  18162       CALL MERCLL(XSTM0A,YSTM0A,XZA,YZA,1)
  18163       ELSE
  18164       XZ=XSTM0+ELORG
  18165       YZ=YSTM0+GLORG
  18166       ENDIF
  18167 C
  18168       CALL XTIME(JDAY0,UTC0,IYR,IMO,IDA,HR)
  18169       WRITE(6,411)  HORCZ(IHCSET+1),HR,IDA,IMO,IYR,YZ,XZ
  18170   411 FORMAT('....',A8,' COORDINATES ADJUSTED FOR MOVING STORM',
  18171      1       ' AT TIME',F9.0,' UTC, ON',I3,'/',I3,'/',I5,/,38X,
  18172      2       'STORM LOCATION: ',' LATITUDE=',F7.3,'   LONGITUDE=',F8.3)
  18173 C
  18174 C     FOR STORM-RELATIVE COORDINATES, PRINT ONLY THE POSITION OF THE
  18175 C         STORM AT TIME=T0  (JDAY0,UTC0)
  18176 C

Page 504         Source Listing                  COORDS
2017-04-18 11:09                                 syndata.f

  18177 C      DO 500 N=1,NFIX
  18178 C      XSTM(N)=XSTM(N)-XSTM(NFIX0)
  18179 C      YSTM(N)=YSTM(N)-YSTM(NFIX0)
  18180 C  500 CONTINUE
  18181       NFIX=1
  18182       WSTM(NFIX0)=99
  18183       RETURN
  18184 C
  18185       ELSE
  18186       WRITE(6,901) ISRCD
  18187   901 FORMAT('******INVALID OPTION FOR ISRCD IN COORDS, ISRCD=',I5)
  18188       CALL ABRT1(' CTRANS',901)
  18189       ENDIF
  18190 C
  18191   910 WRITE(6,911)  NF,DTFIX(NF),DTFIX(NF+1)
  18192   911 FORMAT(/'***** FIX TIMES ARE EQUAL IN CTRANS',I5,2F15.5)
  18193       CALL ABRT1(' CTRANS',911)
  18194       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 chorc_                coords_               ctrans_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 126                        Label  18120                                                          18119                             
 210                        Label  18132                                                          18129                             
 300                        Label  18142                                                          18138                             
 301                        Label  18145                                                          18143                             
 31                         Label  18111                                                          18110                             
 310                        Label  18148                                                          18141                             
 400                        Label  18155                                                          18134                             
 411                        Label  18170                                                          18169                             
 901                        Label  18187                                                          18186                             
 910                        Label  18191                                                          18149                             
 911                        Label  18192                                                          18191                             
 ABRT1                      Subr   18113                                                          18113,18147,18188,18193           
 ABS                        Func   18149                                scalar                    18149                             
 CHORC                      Subr   18070                                                                                            
 COORDS                     Subr   18038                                                                                            
 CTRANS                     Subr   18077                                                                                            
 DT                         Local  18148    R(4)            4           scalar   SAVE             18148,18149                       
 DTFIX                      Local  18054    R(4)            4     1     20       SAVE             18131,18140,18143,18148,18150,1819
                                                                                                  1                                 
 DTIME                      Subr   18131                                                          18131,18136                       
 DTOB                       Local  18054    R(4)            4     1     8000     SAVE             18136,18140,18143,18150           
 ELORG                      Scalar 18050    R(4)            4           scalar   COM              18086,18091,18119,18164           
 GLORG                      Scalar 18050    R(4)            4           scalar   COM              18087,18092,18119,18165           
 HORCZ                      Local  18053    CHAR            8     1     2        SAVE             18056,18119,18169                 
 HR                         Local  18130    R(4)            4           scalar   SAVE             18130,18131,18135,18136,18144,1816
                                                                                                  8,18169                           

Page 505         Source Listing                  COORDS
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HRMN                       Local  18127    R(4)            4           scalar   SAVE             18127,18131,18136,18144           
 ID                         Scalar 18047    I(4)            4     1     8000     COM                                                
 IDA                        Local  18130    I(4)            4           scalar   SAVE             18130,18131,18135,18136,18144,1816
                                                                                                  8,18169                           
 IDAYMN                     Scalar 18050    I(4)            4           scalar   COM              18127                             
 IDAYOB                     Scalar 18048    I(4)            4     1     8000     COM              18135,18143                       
 IDAYST                     Scalar 18049    I(4)            4     1     20       COM              18130                             
 IDMN                       Local  18127    I(4)            4           scalar   SAVE             18127,18131,18136,18144           
 IDSPC                      Scalar 18045    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 18046    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 18046    CHAR            72          scalar   COM                                                
 IHCSET                     Local  18071    I(4)            4           scalar   SAVE             18071,18079,18098,18110,18119,1815
                                                                                                  7,18169                           
 IHZ                        Dummy  18038    I(4)            4           scalar   ARG,INOUT        18071                             
 IMMN                       Local  18127    I(4)            4           scalar   SAVE             18127,18131,18136,18144           
 IMO                        Local  18130    I(4)            4           scalar   SAVE             18130,18131,18135,18136,18144,1816
                                                                                                  8,18169                           
 ISRCD                      Scalar 18044    I(4)            4           scalar   COM              18118,18126,18186                 
 IYMN                       Local  18127    I(4)            4           scalar   SAVE             18127,18131,18136,18144           
 IYR                        Local  18130    I(4)            4           scalar   SAVE             18130,18131,18135,18136,18144,1816
                                                                                                  8,18169                           
 JDAY0                      Scalar 18050    I(4)            4           scalar   COM              18168                             
 JPD                        Scalar 18044    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 18044    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 18044    I(4)            4           scalar   COM                                                
 LD                         Local  18090    I(4)            4           scalar   SAVE             18090,18091,18092,18134,18135,1813
                                                                                                  6,18140,18143,18144,18150,18153,18
                                                                                                  154                               
 LDX                        Scalar 18046    I(4)            4           scalar   COM              18090,18100,18101,18103,18134     
 LDXDIM                     Param  18040    I(4)            4           scalar                    18046,18047,18048,18054           
 LXSORT                     Scalar 18047    I(4)            4     1     8000     COM                                                
 MERCLL                     Subr   18162                                                          18162                             
 MERCXY                     Subr   18103                                                          18103,18108                       
 MX                         Scalar 18044    I(4)            4           scalar   COM                                                
 N                          Local  18085    I(4)            4           scalar   SAVE             18085,18086,18087,18129,18130,1813
                                                                                                  1,18138,18139,18140               
 NF                         Local  18139    I(4)            4           scalar   SAVE             18139,18148,18150,18151,18152,1819
                                                                                                  1                                 
 NFIX                       Dummy  18038    I(4)            4           scalar   ARG,INOUT        18085,18105,18106,18108,18129,1813
                                                                                                  7,18143,18181                     
 NFIX0                      Scalar 18050    I(4)            4           scalar   COM              18182                             
 NFIX1                      Local  18137    I(4)            4           scalar   SAVE             18137,18138                       
 NFXDIM                     Param  18041    I(4)            4           scalar                    18048,18049,18054                 
 NN                         Local  18143    I(4)            4           scalar   SAVE             18143                             
 NX                         Scalar 18044    I(4)            4           scalar   COM                                                
 RAT                        Local  18150    R(4)            4           scalar   SAVE             18150,18151,18152                 
 S2DTPT                     Common 18046                                160084   SAVE                                               
 S2PRIC                     Common 18044                                217      SAVE                                               
 UTC0                       Scalar 18050    R(4)            4           scalar   COM              18168                             
 UTCOB                      Scalar 18048    R(4)            4     1     8000     COM              18135,18144                       
 UTCSTM                     Scalar 18049    R(4)            4     1     20       COM              18130                             
 WD                         Scalar 18046    R(4)            4     1     8000     COM                                                
 WSTM                       Scalar 18049    R(4)            4     1     20       COM              18182                             
 XD                         Scalar 18046    R(4)            4     1     8000     COM              18091,18100,18103,18153           
 XDZ                        Local  18054    R(4)            4     1     8000     SAVE             18100,18103,18105,18108           

Page 506         Source Listing                  COORDS
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XM1                        Scalar 18045    R(4)            4           scalar   COM                                                
 XML                        Scalar 18044    R(4)            4           scalar   COM                                                
 XMR                        Scalar 18044    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 18045    R(4)            4           scalar   COM                                                
 XSTM                       Scalar 18048    R(4)            4     1     20       COM              18086,18105,18108,18151           
 XSTM0                      Scalar 18050    R(4)            4           scalar   COM              18151,18158,18164                 
 XSTM0A                     Local  18055    R(4)            4     1     1        SAVE             18158,18162                       
 XSTOB                      Local  18151    R(4)            4           scalar   SAVE             18151,18153                       
 XTIME                      Subr   18127                                                          18127,18130,18135,18168           
 XYBCWL                     Scalar 18045    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 18045    R(4)            4     1     2        COM                                                
 XYT                        Common 18048                                64432    SAVE                                               
 XZ                         Local  18160    R(4)            4           scalar   SAVE             18160,18164,18169                 
 XZA                        Local  18055    R(4)            4     1     1        SAVE             18160,18162                       
 YD                         Scalar 18046    R(4)            4     1     8000     COM              18092,18101,18103,18154           
 YDZ                        Local  18054    R(4)            4     1     8000     SAVE             18101,18103,18106,18108           
 YN1                        Scalar 18045    R(4)            4           scalar   COM                                                
 YNB                        Scalar 18044    R(4)            4           scalar   COM                                                
 YNT                        Scalar 18044    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 18045    R(4)            4           scalar   COM                                                
 YSTM                       Scalar 18048    R(4)            4     1     20       COM              18087,18106,18108,18152           
 YSTM0                      Scalar 18050    R(4)            4           scalar   COM              18152,18159,18165                 
 YSTM0A                     Local  18055    R(4)            4     1     1        SAVE             18159,18162                       
 YSTOB                      Local  18152    R(4)            4           scalar   SAVE             18152,18154                       
 YZ                         Local  18161    R(4)            4           scalar   SAVE             18161,18165,18169                 
 YZA                        Local  18055    R(4)            4     1     1        SAVE             18161,18162                       

Page 507         Source Listing                  COORDS
2017-04-18 11:09                                 syndata.f

  18195 
  18196 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18197 C                .      .    .                                       .
  18198 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18199 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18200 C
  18201 C ABSTRACT: ??????????????????????????????????????????????????????????
  18202 C   ??????????????????????????????????????????????????????????????????
  18203 C
  18204 C PROGRAM HISTORY LOG:
  18205 C ????-??-??  S. J. LORD
  18206 C
  18207 C USAGE:    CALL ????????(????)
  18208 C   INPUT ARGUMENT LIST:
  18209 C     ??????   - ???????????????????????????????????????????????
  18210 C
  18211 C   OUTPUT ARGUMENT LIST:
  18212 C     ??????   - ???????????????????????????????????????????????
  18213 C
  18214 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18215 C     ??????   - ???????????????????????????????????????????????
  18216 C
  18217 C   OUTPUT FILES:
  18218 C     ??????   - ???????????????????????????????????????????????
  18219 C
  18220 C REMARKS: ?????????????????????????????????????????????????????
  18221 C
  18222 C ATTRIBUTES:
  18223 C   LANGUAGE: FORTRAN 90
  18224 C   MACHINE:  NCEP WCOSS
  18225 C
  18226 C$$$
  18227       SUBROUTINE DTIME(IYZ,IMZ,IDZ,HRZ,IYX,IMX,IDX,HRX,DHR)
  18228       DIMENSION MODA(12)
  18229       DATA MODA/31,28,31,30,31,30,31,31,30,31,30,31/
  18230 C
  18231 C     THIS OUTINE CALCULATES TIME DIFFERENCES.
  18232 C          'Z' IS REFERENCE TIME.
  18233 C          'X' IS TIME RELATIVE TO REFERENCE TIME IN DECIMAL HOURS,
  18234 C               MUST BE GREATER THAN TIME 'Z'.
  18235 C
  18236       DHR=0.0
  18237       IDZZ=IDZ
  18238       IMZZ=IMZ
  18239       HRZZ=HRZ
  18240 C
  18241       IF(IYZ .EQ. IYX)  GO TO 100
  18242       DHR=24.-HRZZ+REAL((MODA(IMZZ)-IDZZ)*24+MAX(IYX-(IYZ+1),0)*8760)
  18243       IMZZ=MOD(IMZZ+1,12)
  18244       IDZZ=1
  18245       HRZZ=0.0
  18246 C
  18247       IF(IMZZ .EQ. 1)  GO TO 100
  18248 C
  18249       DO I=IMZZ,12
  18250       DHR=DHR+REAL(MODA(I)*24)
  18251       ENDDO

Page 508         Source Listing                  DTIME
2017-04-18 11:09                                 syndata.f

  18252 C
  18253       IMZZ=1
  18254   100 IF(IMZZ .EQ. IMX)  GO TO 200
  18255       DHR=DHR+REAL((MODA(IMZZ)-IDZZ)*24)+24.-HRZZ
  18256       IMZZ1=IMZZ+1
  18257       IF(IMZZ1 .GE. IMX)  GO TO 120
  18258       IMX1=IMX-1
  18259 C
  18260       DO I=IMZZ1,IMX1
  18261       DHR=DHR+REAL(MODA(I)*24)
  18262       ENDDO
  18263 C
  18264   120 IMZZ=IMZZ1
  18265       IDZZ=1
  18266       HRZZ=0.0
  18267   200 DHR=DHR+REAL((IDX-IDZZ-1)*24)+24.-HRZZ+HRX
  18268       RETURN
  18269       END


ENTRY POINTS

  Name              
                    
 dtime_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  18254                                                          18241,18247                       
 120                        Label  18264                                                          18257                             
 200                        Label  18267                                                          18254                             
 DHR                        Dummy  18227    R(4)            4           scalar   ARG,INOUT        18236,18242,18250,18255,18261,1826
                                                                                                  7                                 
 DTIME                      Subr   18227                                                                                            
 HRX                        Dummy  18227    R(4)            4           scalar   ARG,INOUT        18267                             
 HRZ                        Dummy  18227    R(4)            4           scalar   ARG,INOUT        18239                             
 HRZZ                       Local  18239    R(4)            4           scalar                    18239,18242,18245,18255,18266,1826
                                                                                                  7                                 
 I                          Local  18249    I(4)            4           scalar                    18249,18250,18260,18261           
 IDX                        Dummy  18227    I(4)            4           scalar   ARG,INOUT        18267                             
 IDZ                        Dummy  18227    I(4)            4           scalar   ARG,INOUT        18237                             
 IDZZ                       Local  18237    I(4)            4           scalar                    18237,18242,18244,18255,18265,1826
                                                                                                  7                                 
 IMX                        Dummy  18227    I(4)            4           scalar   ARG,INOUT        18254,18257,18258                 
 IMX1                       Local  18258    I(4)            4           scalar                    18258,18260                       
 IMZ                        Dummy  18227    I(4)            4           scalar   ARG,INOUT        18238                             
 IMZZ                       Local  18238    I(4)            4           scalar                    18238,18242,18243,18247,18249,1825
                                                                                                  3,18254,18255,18256,18264         
 IMZZ1                      Local  18256    I(4)            4           scalar                    18256,18257,18260,18264           
 IYX                        Dummy  18227    I(4)            4           scalar   ARG,INOUT        18241,18242                       
 IYZ                        Dummy  18227    I(4)            4           scalar   ARG,INOUT        18241,18242                       
 MAX                        Func   18242                                scalar                    18242                             
 MOD                        Func   18243                                scalar                    18243                             
 MODA                       Local  18228    I(4)            4     1     12                        18229,18242,18250,18255,18261     

Page 509         Source Listing                  DTIME
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 REAL                       Func   18242                                scalar                    18242,18250,18255,18261,18267     

Page 510         Source Listing                  DTIME
2017-04-18 11:09                                 syndata.f

  18270 
  18271 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18272 C                .      .    .                                       .
  18273 C SUBPROGRAM:    XTIME       GET YEAR,MONTH,DAY & HR FROM DATE & TIME
  18274 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18275 C
  18276 C ABSTRACT: GET YEAR, MONTH, DAY, AND HOUR FROM DATE (YYYYMMDD) AND
  18277 C   TIME (HHMM).
  18278 C
  18279 C PROGRAM HISTORY LOG:
  18280 C ????-??-??  S. J. LORD
  18281 C
  18282 C USAGE:    CALL XTIME(IDATEJ,UTC,IYR,IMO,IDA,HR)
  18283 C   INPUT ARGUMENT LIST:
  18284 C     IDATEJ   - SLORD DATE FORMAT FOR DATE (YYYYMMDD)
  18285 C     UTC      - SLORD DATE FORMAT FOR DATE (HHMM.)
  18286 C
  18287 C   OUTPUT ARGUMENT LIST:
  18288 C     IYR      - YEAR (YYYY)
  18289 C     IMO      - MONTH
  18290 C     IDA      - DAY
  18291 C     HR       - HOUR
  18292 C
  18293 C REMARKS: NONE.
  18294 C
  18295 C ATTRIBUTES:
  18296 C   LANGUAGE: FORTRAN 90
  18297 C   MACHINE:  NCEP WCOSS
  18298 C
  18299 C$$$
  18300       SUBROUTINE XTIME(IDATEJ,UTC,IYR,IMO,IDA,HR)
  18301       IYR = IDATEJ/10000
  18302       IMO = MOD((IDATEJ/100),100)
  18303       IDA = MOD(IDATEJ,100)
  18304       HR =REAL(NINT(UTC/100.-0.3))
  18305       HR =HR+(UTC-HR*100.)/60.
  18306 
  18307       RETURN
  18308       END

Page 511         Source Listing                  XTIME
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 xtime_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 HR                         Dummy  18300    R(4)            4           scalar   ARG,INOUT        18304,18305                       
 IDA                        Dummy  18300    I(4)            4           scalar   ARG,INOUT        18303                             
 IDATEJ                     Dummy  18300    I(4)            4           scalar   ARG,INOUT        18301,18302,18303                 
 IMO                        Dummy  18300    I(4)            4           scalar   ARG,INOUT        18302                             
 IYR                        Dummy  18300    I(4)            4           scalar   ARG,INOUT        18301                             
 MOD                        Func   18302                                scalar                    18302,18303                       
 NINT                       Func   18304                                scalar                    18304                             
 REAL                       Func   18304                                scalar                    18304                             
 UTC                        Dummy  18300    R(4)            4           scalar   ARG,INOUT        18304,18305                       
 XTIME                      Subr   18300                                                                                            

Page 512         Source Listing                  XTIME
2017-04-18 11:09                                 syndata.f

  18309 
  18310 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18311 C                .      .    .                                       .
  18312 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18313 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18314 C
  18315 C ABSTRACT: ??????????????????????????????????????????????????????????
  18316 C   ??????????????????????????????????????????????????????????????????
  18317 C
  18318 C PROGRAM HISTORY LOG:
  18319 C ????-??-??  S. J. LORD
  18320 C
  18321 C USAGE:    CALL ????????(????)
  18322 C   INPUT ARGUMENT LIST:
  18323 C     ??????   - ???????????????????????????????????????????????
  18324 C
  18325 C   OUTPUT ARGUMENT LIST:
  18326 C     ??????   - ???????????????????????????????????????????????
  18327 C
  18328 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18329 C     ??????   - ???????????????????????????????????????????????
  18330 C
  18331 C   OUTPUT FILES:
  18332 C     ??????   - ???????????????????????????????????????????????
  18333 C
  18334 C REMARKS: ?????????????????????????????????????????????????????
  18335 C
  18336 C ATTRIBUTES:
  18337 C   LANGUAGE: FORTRAN 90
  18338 C   MACHINE:  NCEP WCOSS
  18339 C
  18340 C$$$
  18341       SUBROUTINE WDWSP(U,V)
  18342       DATA EPS/1.E-3/
  18343 C
  18344 C     THIS ENTRY PRODUCES PACKED SPEED (*100) AND WIND DIRECTION
  18345 C
  18346       WDX= 0.0
  18347       WSX=-900.
  18348       IF(U .EQ. -99.0 .OR. V .EQ. -99.0)  GO TO 10
  18349       IF(V .NE. EPS)  V=V-EPS
  18350       WSX=REAL(NINT(SQRT(U**2+V**2)*100.))
  18351       WDX=ATAN2DEG(-U,-V)
  18352       IF(WDX .LT. 0.0)  WDX=360.+WDX
  18353       WDX=REAL(NINT(WDX))/1000.0
  18354    10 V=WDX+WSX
  18355       RETURN
  18356 
  18357 C-----------------------------------------------------------------------
  18358 
  18359 C
  18360       ENTRY WDWS(U,V)
  18361 C
  18362 C     THIS ENTRY PRODUCED WIND DIRECTION/SPEED FROM U,V
  18363 C
  18364       IF(V .NE. EPS)  V=V-EPS
  18365       WSX=SQRT(U**2+V**2)

Page 513         Source Listing                  WDWSP
2017-04-18 11:09                                 syndata.f

  18366       WDX=ATAN2DEG(-U,-V)
  18367       IF(WDX .LT. 0.0)  WDX=WDX+360.
  18368       U=WDX
  18369       V=WSX
  18370       RETURN
  18371       END


ENTRY POINTS

  Name                 Name              
                                         
 wdws_                wdwsp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  18354                                                          18348                             
 ATAN2DEG                   Func   18351    R(4)            4           scalar                    18351,18366                       
 EPS                        Local  18342    R(4)            4           scalar                    18342,18349,18364                 
 NINT                       Func   18350                                scalar                    18350,18353                       
 REAL                       Func   18350                                scalar                    18350,18353                       
 SQRT                       Func   18350                                scalar                    18350,18365                       
 U                          Dummy  18341    R(4)            4           scalar   ARG,INOUT        18348,18350,18351,18365,18366,1836
                                                                                                  8                                 
 V                          Dummy  18341    R(4)            4           scalar   ARG,INOUT        18348,18349,18350,18351,18354,1836
                                                                                                  4,18365,18366,18369               
 WDWS                       Subr   18360                                                                                            
 WDWSP                      Subr   18341                                                                                            
 WDX                        Local  18346    R(4)            4           scalar                    18346,18351,18352,18353,18354,1836
                                                                                                  6,18367,18368                     
 WSX                        Local  18347    R(4)            4           scalar                    18347,18350,18354,18365,18369     

Page 514         Source Listing                  WDWSP
2017-04-18 11:09                                 syndata.f

  18372 
  18373 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18374 C                .      .    .                                       .
  18375 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18376 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18377 C
  18378 C ABSTRACT: ??????????????????????????????????????????????????????????
  18379 C   ??????????????????????????????????????????????????????????????????
  18380 C
  18381 C PROGRAM HISTORY LOG:
  18382 C ????-??-??  S. J. LORD
  18383 C
  18384 C USAGE:    CALL ????????(????)
  18385 C   INPUT ARGUMENT LIST:
  18386 C     ??????   - ???????????????????????????????????????????????
  18387 C
  18388 C   OUTPUT ARGUMENT LIST:
  18389 C     ??????   - ???????????????????????????????????????????????
  18390 C
  18391 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18392 C     ??????   - ???????????????????????????????????????????????
  18393 C
  18394 C   OUTPUT FILES:
  18395 C     ??????   - ???????????????????????????????????????????????
  18396 C
  18397 C REMARKS: ?????????????????????????????????????????????????????
  18398 C
  18399 C ATTRIBUTES:
  18400 C   LANGUAGE: FORTRAN 90
  18401 C   MACHINE:  NCEP WCOSS
  18402 C
  18403 C$$$
  18404       SUBROUTINE BOGUS(LD,LP,FDD,DPV,IPRT)
  18405 C
  18406       PARAMETER (LDXDIM=8000)
  18407       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  18408      1               ID(LDXDIM),LXSORT(LDXDIM)
  18409 C
  18410       CHARACTER*8 IDSPD1,IDSPD2*72
  18411 C
  18412       SAVE
  18413 C
  18414       DIMENSION DDP(4),XDP(4),YDP(4),RAD(4),FDD(LDXDIM)
  18415 C
  18416 C     THIS ROUTINE SUPPLIES BOGUS POINT DATA BY LINEAR INTERPOLATION
  18417 C     FROM NEIGHBORING POINTS.
  18418 C     IMPORTANT:  IT IS ASSUMED THAT DATA HAS BEEN SORTED PREVIOUSLY
  18419 C                 BY X-VALUE (LONGITUDE).
  18420 C           LD IS LXSORT INDEX OF BOGUS POINT.
  18421 C           LP IS LOCATION IN FDD ARRAY.
  18422 C           QUADRANTS:            |
  18423 C                             1   |   2
  18424 C                           -------------
  18425 C                             4   |   3
  18426 C                                 |
  18427 C
  18428       DATA RADMX/1.0E10/

Page 515         Source Listing                  BOGUS
2017-04-18 11:09                                 syndata.f

  18429       X0=XD(LXSORT(LD))
  18430       Y0=YD(LXSORT(LD))
  18431       LST =LD+1
  18432       LEND=LDX
  18433       LINC=1
  18434       NQD =2
  18435       NQDD=1
  18436       EPS =1.E-3
  18437 C
  18438       RAD=RADMX
  18439 C
  18440       IF(LST .GT. LEND)  GO TO 110
  18441       lgo = 110
  18442 C
  18443 C     SEARCH LOOP: FIRST SEARCH EAST QUADRANTS (2&3).  THEN CHANGE
  18444 C                  DO-LOOP INDICES FOR WEST QUADRANTS (1&4)
  18445 C
  18446    10 DO 100 LL=LST,LEND,LINC
  18447       LS=LXSORT(LL)
  18448       XP=XD(LS)-X0
  18449       YP=YD(LS)-Y0
  18450       DP=FDD(LS)
  18451       IF(DP .EQ. -99.0) GO TO 100
  18452       RAD0=SQRT(XP**2+YP**2)
  18453       IF(YP .LE. EPS) GO TO 50
  18454 C
  18455 C     OFFSETS OF VALUE EPS ARE GIVEN TO XDP AND YPD TO ENSURE THAT THEY
  18456 C     ARE IN THE PROPER QUADRANTS
  18457 C
  18458       IF(RAD0 .GE. RAD(NQD))  GO TO 90
  18459       RAD(NQD)=RAD0
  18460       XDP(NQD)=XP+EPS
  18461       YDP(NQD)=YP+ABS(EPS)
  18462       DDP(NQD)=DP
  18463       GO TO 100
  18464    50 CONTINUE
  18465       IF(RAD0 .GE. RAD(NQD+NQDD))  GO TO 90
  18466       RAD(NQD+NQDD)=RAD0
  18467       XDP(NQD+NQDD)=XP+EPS
  18468       YDP(NQD+NQDD)=YP-ABS(EPS)
  18469       DDP(NQD+NQDD)=DP
  18470       GO TO 100
  18471 C
  18472 C     EXIT IF X DISTANCE EXCEEDS MAXIMUM RADIUS FOR BOTH QUADRANTS
  18473 C
  18474    90 RAD2=MAX(RAD(NQD),RAD(NQD+NQDD))
  18475       XD2 =ABS(XP)
  18476       IF(XD2 .GT. RAD2)  THEN
  18477       if(lgo.eq.110)  then
  18478          go to 110
  18479       else  if(lgo.eq.200)  then
  18480          go to 200
  18481       else
  18482          call ABRT1(' BOGUS ',90)
  18483       endif
  18484       ENDIF
  18485   100 CONTINUE

Page 516         Source Listing                  BOGUS
2017-04-18 11:09                                 syndata.f

  18486 C
  18487       if(lgo.eq.110)  then
  18488          go to 110
  18489       else  if(lgo.eq.200)  then
  18490          go to 200
  18491       else
  18492          call ABRT1(' BOGUS ',100)
  18493       endif
  18494 C
  18495 C     RE-LOOP FOR WEST QUADRANTS BY CHANGING INDICES
  18496 C
  18497   110 LST =LD-1
  18498       LEND=1
  18499       LINC=-1
  18500       NQD =1
  18501       NQDD=3
  18502       EPS =-1.E-4
  18503       IF(LST .LT. LEND)  GO TO 200
  18504       lgo = 200
  18505       GO TO 10
  18506 C
  18507 C     ELIMINATE QUADRANTS WITH NO DATA POINTS FOR INTERPOLATION
  18508 C
  18509   200 KQD=0
  18510       RADMN=1.E10
  18511 C
  18512       DO 210 NQD=1,4
  18513       IF(RAD(NQD) .EQ. RADMX)  GO TO 210
  18514       KQD=KQD+1
  18515       RAD(KQD)=RAD(NQD)
  18516       XDP(KQD)=XDP(NQD)
  18517       YDP(KQD)=YDP(NQD)
  18518       DDP(KQD)=DDP(NQD)
  18519       IF(RAD(KQD) .GE. RADMN)  GO TO 210
  18520       RADMN=RAD(KQD)
  18521       NQMN=KQD
  18522   210 CONTINUE
  18523 C
  18524 C     DO LINEAR INTERPOLATION
  18525 C
  18526 C** DEBUG  (BLOCK IF)
  18527 c && 6 comments
  18528 CC    IF(IPRT .EQ. 1)  THEN
  18529 CC    WRITE(6,2211) KQD
  18530 C2211 FORMAT(/'...KQD=',I4,/,' ...KQZ,DDP,XDP,YDP=')
  18531 CC    WRITE(6,2212) (KQZ,DDP(KQZ),XDP(KQZ),YDP(KQZ),KQZ=1,KQD)
  18532 C2212 FORMAT('...',I3,3F14.2)
  18533 CC    ENDIF
  18534       CALL LINT(DDP,XDP,YDP,KQD,DPV,IER)
  18535 C** DEBUG
  18536 c && 2 comments
  18537 CC    WRITE(6,2213) DPV
  18538 C2213 FORMAT('...DPV=',F10.3)
  18539       IF(IER .EQ. 0)  RETURN
  18540       WRITE(2,2222)  X0,Y0,LD,LP,KQD,XP,YP,DP
  18541  2222 FORMAT('****** BOGUS COORDINATE INFO..',2F10.2,3I6,/,20X,3F10.2)
  18542 C

Page 517         Source Listing                  BOGUS
2017-04-18 11:09                                 syndata.f

  18543 C     WHEN ALL ELSE FAILS, PICK DATA FROM THE NEAREST POINT
  18544 C
  18545       DPV=DDP(NQMN)
  18546       RETURN
  18547       END


ENTRY POINTS

  Name              
                    
 bogus_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  18446                                                          18505                             
 100                        Label  18485                                                          18446,18451,18463,18470           
 110                        Label  18497                                                          18440,18478,18488                 
 200                        Label  18509                                                          18480,18490,18503                 
 210                        Label  18522                                                          18512,18513,18519                 
 2222                       Label  18541                                                          18540                             
 50                         Label  18464                                                          18453                             
 90                         Label  18474                                                          18458,18465                       
 ABRT1                      Subr   18482                                                          18482,18492                       
 ABS                        Func   18461                                scalar                    18461,18468,18475                 
 BOGUS                      Subr   18404                                                                                            
 DDP                        Local  18414    R(4)            4     1     4        SAVE             18462,18469,18518,18534,18545     
 DP                         Local  18450    R(4)            4           scalar   SAVE             18450,18451,18462,18469,18540     
 DPV                        Dummy  18404    R(4)            4           scalar   ARG,INOUT        18534,18545                       
 EPS                        Local  18436    R(4)            4           scalar   SAVE             18436,18453,18460,18461,18467,1846
                                                                                                  8,18502                           
 FDD                        Dummy  18404    R(4)            4     1     8000     ARG,INOUT        18450                             
 ID                         Scalar 18408    I(4)            4     1     8000     COM                                                
 IDSPD1                     Scalar 18407    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 18407    CHAR            72          scalar   COM                                                
 IER                        Local  18534    I(4)            4           scalar   SAVE             18534,18539                       
 IPRT                       Dummy  18404    I(4)            4           scalar   ARG,INOUT                                          
 KQD                        Local  18509    I(4)            4           scalar   SAVE             18509,18514,18515,18516,18517,1851
                                                                                                  8,18519,18520,18521,18534,18540   
 LD                         Dummy  18404    I(4)            4           scalar   ARG,INOUT        18429,18430,18431,18497,18540     
 LDX                        Scalar 18407    I(4)            4           scalar   COM              18432                             
 LDXDIM                     Param  18406    I(4)            4           scalar                    18407,18408,18414                 
 LEND                       Local  18432    I(4)            4           scalar   SAVE             18432,18440,18446,18498,18503     
 LGO                        Local  18441    I(4)            4           scalar   SAVE             18441,18477,18479,18487,18489,1850
                                                                                                  4                                 
 LINC                       Local  18433    I(4)            4           scalar   SAVE             18433,18446,18499                 
 LINT                       Subr   18534                                                          18534                             
 LL                         Local  18446    I(4)            4           scalar   SAVE             18446,18447                       
 LP                         Dummy  18404    I(4)            4           scalar   ARG,INOUT        18540                             
 LS                         Local  18447    I(4)            4           scalar   SAVE             18447,18448,18449,18450           
 LST                        Local  18431    I(4)            4           scalar   SAVE             18431,18440,18446,18497,18503     
 LXSORT                     Scalar 18408    I(4)            4     1     8000     COM              18429,18430,18447                 
 MAX                        Func   18474                                scalar                    18474                             
 NQD                        Local  18434    I(4)            4           scalar   SAVE             18434,18458,18459,18460,18461,1846

Page 518         Source Listing                  BOGUS
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  2,18465,18466,18467,18468,18469,18
                                                                                                  474,18500,18512,18513,18515,18516,
                                                                                                  18517,18518                       
 NQDD                       Local  18435    I(4)            4           scalar   SAVE             18435,18465,18466,18467,18468,1846
                                                                                                  9,18474,18501                     
 NQMN                       Local  18521    I(4)            4           scalar   SAVE             18521,18545                       
 RAD                        Local  18414    R(4)            4     1     4        SAVE             18438,18458,18459,18465,18466,1847
                                                                                                  4,18513,18515,18519,18520         
 RAD0                       Local  18452    R(4)            4           scalar   SAVE             18452,18458,18459,18465,18466     
 RAD2                       Local  18474    R(4)            4           scalar   SAVE             18474,18476                       
 RADMN                      Local  18510    R(4)            4           scalar   SAVE             18510,18519,18520                 
 RADMX                      Local  18428    R(4)            4           scalar   SAVE             18428,18438,18513                 
 S2DTPT                     Common 18407                                160084   SAVE                                               
 SQRT                       Func   18452                                scalar                    18452                             
 WD                         Scalar 18407    R(4)            4     1     8000     COM                                                
 X0                         Local  18429    R(4)            4           scalar   SAVE             18429,18448,18540                 
 XD                         Scalar 18407    R(4)            4     1     8000     COM              18429,18448                       
 XD2                        Local  18475    R(4)            4           scalar   SAVE             18475,18476                       
 XDP                        Local  18414    R(4)            4     1     4        SAVE             18460,18467,18516,18534           
 XP                         Local  18448    R(4)            4           scalar   SAVE             18448,18452,18460,18467,18475,1854
                                                                                                  0                                 
 Y0                         Local  18430    R(4)            4           scalar   SAVE             18430,18449,18540                 
 YD                         Scalar 18407    R(4)            4     1     8000     COM              18430,18449                       
 YDP                        Local  18414    R(4)            4     1     4        SAVE             18461,18468,18517,18534           
 YP                         Local  18449    R(4)            4           scalar   SAVE             18449,18452,18453,18461,18468,1854
                                                                                                  0                                 

Page 519         Source Listing                  BOGUS
2017-04-18 11:09                                 syndata.f

  18548 
  18549 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18550 C                .      .    .                                       .
  18551 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18552 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18553 C
  18554 C ABSTRACT: ??????????????????????????????????????????????????????????
  18555 C   ??????????????????????????????????????????????????????????????????
  18556 C
  18557 C PROGRAM HISTORY LOG:
  18558 C ????-??-??  S. J. LORD
  18559 C
  18560 C USAGE:    CALL ????????(????)
  18561 C   INPUT ARGUMENT LIST:
  18562 C     ??????   - ???????????????????????????????????????????????
  18563 C
  18564 C   OUTPUT ARGUMENT LIST:
  18565 C     ??????   - ???????????????????????????????????????????????
  18566 C
  18567 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18568 C     ??????   - ???????????????????????????????????????????????
  18569 C
  18570 C   OUTPUT FILES:
  18571 C     ??????   - ???????????????????????????????????????????????
  18572 C
  18573 C REMARKS: ?????????????????????????????????????????????????????
  18574 C
  18575 C ATTRIBUTES:
  18576 C   LANGUAGE: FORTRAN 90
  18577 C   MACHINE:  NCEP WCOSS
  18578 C
  18579 C$$$
  18580       SUBROUTINE LINT(D,X,Y,KK,DINT,IER)
  18581       DIMENSION D(4),X(4),Y(4),D5(5),X5(5),Y5(5),ZR(4),FZ(4)
  18582 C
  18583       SAVE
  18584 C
  18585       DATA DLMIN/1.E-3/,AMX/1.E10/,EPS/-1.E-5/
  18586 C
  18587 C     KK IS NUMBER OF POINTS TO INTERPOLATE WITH
  18588 C
  18589       IER=0
  18590       GO TO (10,20,30,40), KK
  18591       CALL ABRT1('   LINT',10)
  18592 C
  18593 C     SINGLE POINT:  ASSUME CONSTANT VALUE RATHER THAN EXTRAPOLATE
  18594 C
  18595    10 DINT=D(1)
  18596       RETURN
  18597 C
  18598 C     TWO POINTS:  ASSUME GRADIENT=0 PERPENDICULAR TO LINE JOINING THE
  18599 C                  TWO POINTS.  IF PERPENDICULAR DOES NOT INTERSECT THE
  18600 C                  SEGMENT CONNECTING THE TWO POINTS, THEN EXTRAPOLATION
  18601 C                  WILL OCCUR: THIS IS NOT ALLOWED, SO VALUE OF CLOSEST
  18602 C                  POINT IS CHOSEN.
  18603 C
  18604    20 XZ=0.0

Page 520         Source Listing                  LINT
2017-04-18 11:09                                 syndata.f

  18605       IF(ABS(Y(1)-Y(2)) .LT. DLMIN)  GO TO 25
  18606       IF(ABS(X(1)-X(2)) .LT. DLMIN)  GO TO 27
  18607       XZ=(Y(2)*X(1)-Y(1)*X(2))*(Y(2)-Y(1))/
  18608      1   ((Y(2)-Y(1))**2+(X(2)-X(1))**2)
  18609       IF(XZ .LT. MIN(X(1),X(2)) .OR. XZ .GT. MAX(X(1),X(2)))
  18610      1  GO TO 29
  18611 C
  18612 C     IF THE TWO POINTS ARE LINED UP IN THE Y-DIRECTION
  18613 C
  18614    25 IF(ABS(X(1)-X(2)) .LT. DLMIN)  THEN
  18615       DINT=0.5*(D(1)+D(2))
  18616       ELSE
  18617       DINT=D(2)+(XZ-X(2))*(D(1)-D(2))/(X(1)-X(2))
  18618       ENDIF
  18619       RETURN
  18620 C
  18621 C     IF THE TWO POINTS ARE LINED UP IN THE X-DIRECTION
  18622 C
  18623    27 DINT=(D(2)*Y(1)-D(1)*Y(2))/(Y(1)-Y(2))
  18624       RETURN
  18625 C
  18626 C     IF ALL ELSE FAILS, USE CLOSEST POINT
  18627 C
  18628    29 IND=1
  18629       IF(X(1)**2+Y(1)**2 .GT. X(2)**2+Y(2)**2) IND=2
  18630       DINT=D(IND)
  18631       RETURN
  18632 C
  18633 C     THREE POINTS
  18634 C
  18635    30 NQD=0
  18636 C
  18637       ZR=-AMX
  18638 C
  18639 C     WRAP AROUND
  18640 C
  18641       D(4)=D(1)
  18642       X(4)=X(1)
  18643       Y(4)=Y(1)
  18644 C
  18645       DO 35 KL=1,3
  18646 C
  18647 C     Y-INTERCEPT=A1
  18648 C
  18649       IF(ABS(X(KL+1)-X(KL)) .LT. DLMIN)  GO TO 33
  18650       A1  =(Y(KL  )*X(KL+1)-X(KL  )*Y(KL+1))/(X(KL+1)-X(KL  ))
  18651 C
  18652 C     CHECK IF INTERPOLATION CAN OCCUR
  18653 C
  18654       IF(A1 .LT. MIN(Y(KL),Y(KL+1))+EPS .OR. A1 .GT.
  18655      1           MAX(Y(KL),Y(KL+1))-EPS)  GO TO 33
  18656       KQD=1
  18657       IF(A1 .LT. EPS)  KQD=3
  18658       ZR(KQD)=A1
  18659       IF(ABS(Y(KL+1)-Y(KL)) .LT. DLMIN)  GO TO 32
  18660 C
  18661 C     LINEAR INTERPOLATION

Page 521         Source Listing                  LINT
2017-04-18 11:09                                 syndata.f

  18662 C
  18663       FZ(KQD) =D(KL  )+(A1-Y(KL  ))*(D(KL+1)-D(KL  ))/(Y(KL+1)-Y(KL  ))
  18664       GO TO 33
  18665    32 FZ(KQD)=(D(KL  )*ABS(X(KL+1))+D(KL+1)*ABS(X(KL  )))/
  18666      1        (ABS(X(KL  ))+ABS(X(KL+1)))
  18667 C
  18668 C     X-INTERCEPT=A2
  18669 C
  18670    33 IF(ABS(Y(KL+1)-Y(KL)) .LT. DLMIN)  GO TO 35
  18671       A2  =(X(KL  )*Y(KL+1)-Y(KL  )*X(KL+1))/(Y(KL+1)-Y(KL  ))
  18672 C
  18673 C     CHECK IF INTERPOLATION CAN OCCUR
  18674 C
  18675       IF(A2 .LT. MIN(X(KL),X(KL+1))+EPS .OR. A2 .GT.
  18676      1           MAX(X(KL),X(KL+1))-EPS)  GO TO 35
  18677       KQD=2
  18678       IF(A2 .LT. EPS)  KQD=4
  18679       ZR(KQD)=A2
  18680       IF(ABS(X(KL+1)-X(KL)) .LT. DLMIN)  GO TO 34
  18681 C
  18682 C     LINEAR INTERPOLATION
  18683 C
  18684       FZ(KQD)=D(KL  )+(A2-X(KL ))*(D(KL+1)-D(KL  ))/
  18685      1        (X(KL+1)-X(KL  ))
  18686       GO TO 35
  18687    34 FZ(KQD)=(D(KL  )*ABS(Y(KL+1))+D(KL+1)*ABS(Y(KL  )))/
  18688      1        (ABS(Y(KL  ))+ABS(Y(KL+1)))
  18689    35 CONTINUE
  18690 C
  18691       KQD=0
  18692 C
  18693 C     SAVE VALID INTERCEPTS AND INTERPOLATION VALUES
  18694 C
  18695       DO 36 NQD=1,4
  18696       IF(ZR(NQD) .EQ. -AMX)  GO TO 36
  18697       KQD=KQD+1
  18698       ZR(KQD)=ZR(NQD)
  18699       FZ(KQD)=FZ(NQD)
  18700    36 CONTINUE
  18701 C
  18702 C     BRANCH FOR KQD=1 INDICATES ALL POINTS LIE IN STRAIGHT LINE ON A
  18703 C          PARTICULAR AXIS
  18704 C
  18705       GO TO (20,37,38,47), KQD
  18706       WRITE(2,361) KQD
  18707   361 FORMAT(/'*******KQD WRONG AT 36',I4)
  18708       IER=1
  18709       RETURN
  18710 C
  18711 C     COLLAPSE TO 2-POINT CASE
  18712 C
  18713    37 Y(1)=ZR(1)
  18714       X(2)=ZR(2)
  18715       D(1)=FZ(1)
  18716       D(2)=FZ(2)
  18717       X(1)=0.0
  18718       Y(2)=0.0

Page 522         Source Listing                  LINT
2017-04-18 11:09                                 syndata.f

  18719       GO TO 20
  18720    38 WRITE(2,381)  KQD,(X(K),Y(K),D(K),ZR(K),FZ(K),K=1,4)
  18721   381 FORMAT(/'*******KQD WRONG',I4,/,(5F16.6))
  18722       IER=1
  18723       RETURN
  18724 C
  18725 C     ONE POINT IN EACH QUADRANT: LINEARLY INTERPOLATE TO X,Y AXES,
  18726 C                                 THEN TO ORIGIN.
  18727 C
  18728    40 CONTINUE
  18729 
  18730       D5(1:4)=D
  18731       X5(1:4)=X
  18732       Y5(1:4)=Y
  18733 C
  18734 C     WRAP AROUND
  18735 C
  18736       D5(5)=D5(1)
  18737       X5(5)=X5(1)
  18738       Y5(5)=Y5(1)
  18739 C
  18740 C     CALCULATE INTERCEPTS AND INTERPOLATE
  18741 C
  18742       DO 45 KL=1,3,2
  18743       ZR(KL)  =(Y5(KL  )*X5(KL+1)-X5(KL  )*Y5(KL+1))/(X5(KL+1)-X5(KL  ))
  18744       ZR(KL+1)=(X5(KL+1)*Y5(KL+2)-Y5(KL+1)*X5(KL+2))/(Y5(KL+2)-Y5(KL+1))
  18745       IF(ABS(Y5(KL+1)-Y5(KL)) .LT. DLMIN)  GO TO 42
  18746       FZ(KL)  =D5(KL  )+(ZR(KL  )-Y5(KL  ))*(D5(KL+1)-D5(KL  ))/
  18747      1         (Y5(KL+1)-Y5(KL  ))
  18748       GO TO 43
  18749    42 FZ(KL  )  =(D5(KL  )*ABS(X5(KL+1))+D5(KL+1)*ABS(X5(KL  )))/
  18750      1           (ABS(X5(KL  ))+ABS(X5(KL+1)))
  18751    43 IF(ABS(X5(KL+2)-X5(KL+1)) .LT. DLMIN)  GO TO 44
  18752       FZ(KL+1)=D5(KL+1)+(ZR(KL+1)-X5(KL+1))*(D5(KL+2)-D5(KL+1))/
  18753      1         (X5(KL+2)-X5(KL+1))
  18754       GO TO 45
  18755    44 FZ(KL+1)  =(D5(KL+1)*ABS(Y5(KL+2))+D5(KL+2)*ABS(Y5(KL+1)))/
  18756      1           (ABS(Y5(KL+1))+ABS(Y5(KL+2)))
  18757    45 CONTINUE
  18758 C
  18759 C     LINEAR INTERPOLATION
  18760 C
  18761    47 DINT=0.0
  18762 C
  18763       DO KL=1,2
  18764       DINT=DINT+(ZR(KL)*FZ(KL+2)-ZR(KL+2)*FZ(KL))/(ZR(KL)-ZR(KL+2))
  18765       ENDDO
  18766 C
  18767       DINT=0.5*DINT
  18768       RETURN
  18769       END

Page 523         Source Listing                  LINT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name             
                   
 lint_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  18595                                                          18590                             
 20                         Label  18604                                                          18590,18705,18719                 
 25                         Label  18614                                                          18605                             
 27                         Label  18623                                                          18606                             
 29                         Label  18628                                                          18610                             
 30                         Label  18635                                                          18590                             
 32                         Label  18665                                                          18659                             
 33                         Label  18670                                                          18649,18655,18664                 
 34                         Label  18687                                                          18680                             
 35                         Label  18689                                                          18645,18670,18676,18686           
 36                         Label  18700                                                          18695,18696                       
 361                        Label  18707                                                          18706                             
 37                         Label  18713                                                          18705                             
 38                         Label  18720                                                          18705                             
 381                        Label  18721                                                          18720                             
 40                         Label  18728                                                          18590                             
 42                         Label  18749                                                          18745                             
 43                         Label  18751                                                          18748                             
 44                         Label  18755                                                          18751                             
 45                         Label  18757                                                          18742,18754                       
 47                         Label  18761                                                          18705                             
 A1                         Local  18650    R(4)            4           scalar   SAVE             18650,18654,18657,18658,18663     
 A2                         Local  18671    R(4)            4           scalar   SAVE             18671,18675,18678,18679,18684     
 ABRT1                      Subr   18591                                                          18591                             
 ABS                        Func   18605                                scalar                    18605,18606,18614,18649,18659,1866
                                                                                                  5,18666,18670,18680,18687,18688,18
                                                                                                  745,18749,18750,18751,18755,18756 
 AMX                        Local  18585    R(4)            4           scalar   SAVE             18585,18637,18696                 
 D                          Dummy  18580    R(4)            4     1     4        ARG,INOUT        18595,18615,18617,18623,18630,1864
                                                                                                  1,18663,18665,18684,18687,18715,18
                                                                                                  716,18720,18730                   
 D5                         Local  18581    R(4)            4     1     5        SAVE             18730,18736,18746,18749,18752,1875
                                                                                                  5                                 
 DINT                       Dummy  18580    R(4)            4           scalar   ARG,INOUT        18595,18615,18617,18623,18630,1876
                                                                                                  1,18764,18767                     
 DLMIN                      Local  18585    R(4)            4           scalar   SAVE             18585,18605,18606,18614,18649,1865
                                                                                                  9,18670,18680,18745,18751         
 EPS                        Local  18585    R(4)            4           scalar   SAVE             18585,18654,18655,18657,18675,1867
                                                                                                  6,18678                           
 FZ                         Local  18581    R(4)            4     1     4        SAVE             18663,18665,18684,18687,18699,1871
                                                                                                  5,18716,18720,18746,18749,18752,18
                                                                                                  755,18764                         
 IER                        Dummy  18580    I(4)            4           scalar   ARG,INOUT        18589,18708,18722                 
 IND                        Local  18628    I(4)            4           scalar   SAVE             18628,18629,18630                 

Page 524         Source Listing                  LINT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 K                          Local  18720    I(4)            4           scalar   SAVE             18720                             
 KK                         Dummy  18580    I(4)            4           scalar   ARG,INOUT        18590                             
 KL                         Local  18645    I(4)            4           scalar   SAVE             18645,18649,18650,18654,18655,1865
                                                                                                  9,18663,18665,18666,18670,18671,18
                                                                                                  675,18676,18680,18684,18685,18687,
                                                                                                  18688,18742,18743,18744,18745,1874
                                                                                                  6,18747,18749,18750,18751,18752,18
                                                                                                  753,18755,18756,18763,18764       
 KQD                        Local  18656    I(4)            4           scalar   SAVE             18656,18657,18658,18663,18665,1867
                                                                                                  7,18678,18679,18684,18687,18691,18
                                                                                                  697,18698,18699,18705,18706,18720 
 LINT                       Subr   18580                                                                                            
 MAX                        Func   18609                                scalar                    18609,18655,18676                 
 MIN                        Func   18609                                scalar                    18609,18654,18675                 
 NQD                        Local  18635    I(4)            4           scalar   SAVE             18635,18695,18696,18698,18699     
 X                          Dummy  18580    R(4)            4     1     4        ARG,INOUT        18606,18607,18608,18609,18614,1861
                                                                                                  7,18629,18642,18649,18650,18665,18
                                                                                                  666,18671,18675,18676,18680,18684,
                                                                                                  18685,18714,18717,18720,18731     
 X5                         Local  18581    R(4)            4     1     5        SAVE             18731,18737,18743,18744,18749,1875
                                                                                                  0,18751,18752,18753               
 XZ                         Local  18604    R(4)            4           scalar   SAVE             18604,18607,18609,18617           
 Y                          Dummy  18580    R(4)            4     1     4        ARG,INOUT        18605,18607,18608,18623,18629,1864
                                                                                                  3,18650,18654,18655,18659,18663,18
                                                                                                  670,18671,18687,18688,18713,18718,
                                                                                                  18720,18732                       
 Y5                         Local  18581    R(4)            4     1     5        SAVE             18732,18738,18743,18744,18745,1874
                                                                                                  6,18747,18755,18756               
 ZR                         Local  18581    R(4)            4     1     4        SAVE             18637,18658,18679,18696,18698,1871
                                                                                                  3,18714,18720,18743,18744,18746,18
                                                                                                  752,18764                         

Page 525         Source Listing                  LINT
2017-04-18 11:09                                 syndata.f

  18770 
  18771 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18772 C                .      .    .                                       .
  18773 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18774 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18775 C
  18776 C ABSTRACT: ??????????????????????????????????????????????????????????
  18777 C   ??????????????????????????????????????????????????????????????????
  18778 C
  18779 C PROGRAM HISTORY LOG:
  18780 C ????-??-??  S. J. LORD
  18781 C
  18782 C USAGE:    CALL ????????(????)
  18783 C   INPUT ARGUMENT LIST:
  18784 C     ??????   - ???????????????????????????????????????????????
  18785 C
  18786 C   OUTPUT ARGUMENT LIST:
  18787 C     ??????   - ???????????????????????????????????????????????
  18788 C
  18789 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18790 C     ??????   - ???????????????????????????????????????????????
  18791 C
  18792 C   OUTPUT FILES:
  18793 C     ??????   - ???????????????????????????????????????????????
  18794 C
  18795 C REMARKS: ?????????????????????????????????????????????????????
  18796 C
  18797 C ATTRIBUTES:
  18798 C   LANGUAGE: FORTRAN 90
  18799 C   MACHINE:  NCEP WCOSS
  18800 C
  18801 C$$$
  18802       SUBROUTINE VFIND(KDX,KV,KL,KPF)
  18803 C
  18804       PARAMETER (KLDIM= 8)
  18805       PARAMETER (KVDIM=20,KDTDIM=5)
  18806 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  18807       PARAMETER (KPXDIM=KVDIM*KLDIM)
  18808 C
  18809       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  18810      1                 DMEAN(KDTDIM*KLDIM)
  18811       CHARACTER*40 IDSPK
  18812 C
  18813       SAVE
  18814 C
  18815       DO 10 KP=1,KDX
  18816       KPF=KP
  18817       IF(IDVAR(KP) .EQ. KV .AND. IDLEV(KP) .EQ. KL)  GO TO 20
  18818    10 CONTINUE
  18819 C
  18820       KPF=-1
  18821    20 RETURN
  18822       END

Page 526         Source Listing                  VFIND
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 vfind_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  18818                                                          18815                             
 20                         Label  18821                                                          18817                             
 DMEAN                      Scalar 18810    R(4)            4     1     40       COM                                                
 IDLEV                      Scalar 18809    I(4)            4     1     160      COM              18817                             
 IDSPK                      Scalar 18809    CHAR            40    1     160      COM                                                
 IDVAR                      Scalar 18809    I(4)            4     1     160      COM              18817                             
 KDTDIM                     Param  18805    I(4)            4           scalar                    18810                             
 KDX                        Dummy  18802    I(4)            4           scalar   ARG,INOUT        18815                             
 KL                         Dummy  18802    I(4)            4           scalar   ARG,INOUT        18817                             
 KLDIM                      Param  18804    I(4)            4           scalar                    18807,18810                       
 KP                         Local  18815    I(4)            4           scalar   SAVE             18815,18816,18817                 
 KPF                        Dummy  18802    I(4)            4           scalar   ARG,INOUT        18816,18820                       
 KPX                        Scalar 18809    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  18807    I(4)            4           scalar                    18809                             
 KV                         Dummy  18802    I(4)            4           scalar   ARG,INOUT        18817                             
 KVDIM                      Param  18805    I(4)            4           scalar                    18807                             
 S2KOMP                     Common 18809                                7844     SAVE                                               
 VFIND                      Subr   18802                                                                                            

Page 527         Source Listing                  VFIND
2017-04-18 11:09                                 syndata.f

  18823 
  18824 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18825 C                .      .    .                                       .
  18826 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18827 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18828 C
  18829 C ABSTRACT: ??????????????????????????????????????????????????????????
  18830 C   ??????????????????????????????????????????????????????????????????
  18831 C
  18832 C PROGRAM HISTORY LOG:
  18833 C ????-??-??  S. J. LORD
  18834 C
  18835 C USAGE:    CALL ????????(????)
  18836 C   INPUT ARGUMENT LIST:
  18837 C     ??????   - ???????????????????????????????????????????????
  18838 C
  18839 C   OUTPUT ARGUMENT LIST:
  18840 C     ??????   - ???????????????????????????????????????????????
  18841 C
  18842 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18843 C     ??????   - ???????????????????????????????????????????????
  18844 C
  18845 C   OUTPUT FILES:
  18846 C     ??????   - ???????????????????????????????????????????????
  18847 C
  18848 C REMARKS: ?????????????????????????????????????????????????????
  18849 C
  18850 C ATTRIBUTES:
  18851 C   LANGUAGE: FORTRAN 90
  18852 C   MACHINE:  NCEP WCOSS
  18853 C
  18854 C$$$
  18855       SUBROUTINE DSKNMC(FKMN,KP1,KP2,FWS,FWV,MXZ,NXZ)
  18856 C
  18857       PARAMETER (MDIM=35,NDIM=35)
  18858       PARAMETER (LDXDIM=8000)
  18859       PARAMETER (NFXDIM=20)
  18860       PARAMETER (KLDIM= 8)
  18861       PARAMETER (KVDIM=20,KDTDIM=5)
  18862 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  18863       PARAMETER (KPXDIM=KVDIM*KLDIM)
  18864 C
  18865       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  18866      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,
  18867      2            MSKD14,MSKD15,MSKD16,MSKD17,MSKD18
  18868 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  18869 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  18870       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  18871      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  18872       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  18873      1                 DMEAN(KDTDIM*KLDIM)
  18874       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  18875      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),
  18876      2            ELORG,GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  18877 C
  18878       SAVE
  18879 C

Page 528         Source Listing                  DSKNMC
2017-04-18 11:09                                 syndata.f

  18880       CHARACTER IDSPC*125,IDSPK*40
  18881       DIMENSION FKMN(KPXDIM,MDIM,NDIM),FWV(MXZ,NXZ,2),FWS(MXZ,NXZ)
  18882 C
  18883       PARAMETER(IPLTUN=88)
  18884       CHARACTER MTITLE*80
  18885       DATA      NCHAR/40/
  18886 C
  18887       IF(MX+1 .EQ. MXZ .AND. NX+1 .EQ. NXZ) THEN
  18888         OPEN(UNIT=IPLTUN,FILE='GRIDDAT',STATUS='NEW',
  18889      $    ACCESS='SEQUENTIAL',FORM='UNFORMATTED')
  18890         DO 100 KP=KP1,KP2
  18891           MTITLE = IDSPK(KP)
  18892           IF(IDVAR(KP).EQ.5) THEN
  18893             DO 70 N=1,NXZ
  18894 C
  18895 C               LATITUDE INDICES MUST BE FLIPPED
  18896 C               (UNIPLOT WANTS INDEX 1 AT NORTH POLE)
  18897 C
  18898               N1 = NXZ - N + 1
  18899               DO 60 M=1,MXZ
  18900                 FWV(M,N1,2)=FKMN(KP,M,N)
  18901   60          CONTINUE
  18902   70        CONTINUE
  18903           ELSE
  18904             DO 90 N=1,NXZ
  18905               N1 = NXZ - N + 1
  18906               DO 80 M=1,MXZ
  18907                 FWV(M,N1,1)=FKMN(KP,M,N)
  18908                 FWS(M,N1) =FKMN(KP,M,N)
  18909   80          CONTINUE
  18910   90        CONTINUE
  18911           ENDIF
  18912           IF(IDVAR(KP).EQ.5) THEN
  18913             MTITLE = '50 MB WIND                              '
  18914             WRITE(IPLTUN) MXZ,NXZ,FWV,MTITLE,NCHAR
  18915           ELSEIF(IDVAR(KP).NE.4) THEN
  18916             WRITE(IPLTUN) MXZ,NXZ,FWS,MTITLE,NCHAR
  18917           ENDIF
  18918           WRITE(*,'(1X,''        ... KP='',I4,''   VARIABLE #'',I3,
  18919      $      ''   LEVEL #'',I3)') KP,IDVAR(KP),IDLEV(KP)
  18920   100   CONTINUE
  18921         CLOSE(UNIT=IPLTUN,STATUS='KEEP')
  18922         WRITE(*,'(1X,''.... SPLINE INTERPOLATED VARIABLES WRITTEN '',
  18923      $    ''TO UNIT'',I4)') IPLTUN
  18924       ELSE
  18925         WRITE(*,'(1X,''**** MX+1,NX+1=,'',2I5,'' ARE INCONSISTENT '',
  18926      $    ''WITH MXZ,NXZ='',2I5,'' IN DSKNMC'')') MX+1,NX+1,MXZ,NXZ
  18927         CALL ABRT1(' DSKNMC',100)
  18928       ENDIF
  18929       RETURN
  18930 
  18931 C-----------------------------------------------------------------------
  18932 
  18933 C
  18934       ENTRY DSKCHR(FKMN,KP1,KP2,MXZ,NXZ)
  18935 C
  18936 C     OPEN FORMATTED FILE

Page 529         Source Listing                  DSKNMC
2017-04-18 11:09                                 syndata.f

  18937 C
  18938       OPEN(UNIT=MSKDA4,FILE='GRIDDAT',STATUS='NEW',
  18939      1    ACCESS='SEQUENTIAL')
  18940 C
  18941 C fixit?? "JOBHED" is never assigned a value (set to ZERO)
  18942       jobhed = 0
  18943       WRITE(MSKDA4,111) JOBHED
  18944   111 FORMAT(A80)
  18945       WRITE(MSKDA4,113) KP1,KP2,MXZ,NXZ,YSTM0,XSTM0,XML,XMR,YNB,YNT
  18946   113 FORMAT(1X,4I4,6F10.3)
  18947 C
  18948       DO 140 KP=KP1,KP2
  18949       WRITE(MSKDA4,115) KP,IDSPK(KP)
  18950   115 FORMAT(1X,I5,A40)
  18951       WRITE(MSKDA4,117) ((FKMN(KP,M,N),M=1,MXZ),N=1,NXZ)
  18952   117 FORMAT(3X,7E11.3)
  18953       WRITE(6,11)  KP,IDVAR(KP),IDLEV(KP)
  18954    11 FORMAT('       ... KP=',I4,'   VARIABLE #',I3,'   LEVEL #',I3)
  18955   140 CONTINUE
  18956       RETURN
  18957       END


ENTRY POINTS

  Name                  Name               
                                           
 dskchr_               dsknmc_             

Page 530         Source Listing                  DSKNMC
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  18920                                                          18890                             
 11                         Label  18954                                                          18953                             
 111                        Label  18944                                                          18943                             
 113                        Label  18946                                                          18945                             
 115                        Label  18950                                                          18949                             
 117                        Label  18952                                                          18951                             
 140                        Label  18955                                                          18948                             
 60                         Label  18901                                                          18899                             
 70                         Label  18902                                                          18893                             
 80                         Label  18909                                                          18906                             
 90                         Label  18910                                                          18904                             
 ABRT1                      Subr   18927                                                          18927                             
 DMEAN                      Scalar 18873    R(4)            4     1     40       COM                                                
 DSK                        Common 18865                                76       SAVE                                               
 DSKCHR                     Subr   18934                                                                                            
 DSKNMC                     Subr   18855                                                                                            
 ELORG                      Scalar 18876    R(4)            4           scalar   COM                                                
 FKMN                       Dummy  18855    R(4)            4     3     196000   ARG,INOUT        18900,18907,18908,18951           
 FWS                        Dummy  18855    R(4)            4     2     0        ARG,INOUT        18908,18916                       
 FWV                        Dummy  18855    R(4)            4     3     0        ARG,INOUT        18900,18907,18914                 
 GLORG                      Scalar 18876    R(4)            4           scalar   COM                                                
 IDAYMN                     Scalar 18876    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 18874    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 18875    I(4)            4     1     20       COM                                                
 IDLEV                      Scalar 18872    I(4)            4     1     160      COM              18919,18953                       
 IDSPC                      Scalar 18871    CHAR            125         scalar   COM                                                
 IDSPK                      Scalar 18872    CHAR            40    1     160      COM              18891,18949                       
 IDVAR                      Scalar 18872    I(4)            4     1     160      COM              18892,18912,18915,18919,18953     
 IPLTUN                     Param  18883    I(4)            4           scalar                    18888,18914,18916,18921,18923     
 ISRCD                      Scalar 18870    I(4)            4           scalar   COM                                                
 JDAY0                      Scalar 18876    I(4)            4           scalar   COM                                                
 JOBHED                     Local  18942    I(4)            4           scalar   SAVE             18942,18943                       
 JPD                        Scalar 18870    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 18870    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 18870    I(4)            4           scalar   COM                                                
 KDTDIM                     Param  18861    I(4)            4           scalar                    18873                             
 KLDIM                      Param  18860    I(4)            4           scalar                    18863,18873                       
 KP                         Local  18890    I(4)            4           scalar   SAVE             18890,18891,18892,18900,18907,1890
                                                                                                  8,18912,18915,18919,18948,18949,18
                                                                                                  951,18953                         
 KP1                        Dummy  18855    I(4)            4           scalar   ARG,INOUT        18890,18945,18948                 
 KP2                        Dummy  18855    I(4)            4           scalar   ARG,INOUT        18890,18945,18948                 
 KPX                        Scalar 18872    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  18863    I(4)            4           scalar                    18872,18881                       
 KVDIM                      Param  18861    I(4)            4           scalar                    18863                             
 LDXDIM                     Param  18858    I(4)            4           scalar                    18874                             
 M                          Local  18899    I(4)            4           scalar   SAVE             18899,18900,18906,18907,18908,1895
                                                                                                  1                                 
 MDIM                       Param  18857    I(4)            4           scalar                    18881                             
 MSKD11                     Scalar 18866    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 18866    I(4)            4           scalar   COM                                                

Page 531         Source Listing                  DSKNMC
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKD13                     Scalar 18866    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 18867    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 18867    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 18867    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 18867    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 18867    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 18865    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 18865    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 18865    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 18865    I(4)            4           scalar   COM              18938,18943,18945,18949,18951     
 MSKDA5                     Scalar 18865    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 18865    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 18866    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 18866    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 18866    I(4)            4           scalar   COM                                                
 MSKEF                      Scalar 18865    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 18865    I(4)            4           scalar   COM                                                
 MTITLE                     Local  18884    CHAR            80          scalar   SAVE             18891,18913,18914,18916           
 MX                         Scalar 18870    I(4)            4           scalar   COM              18887,18926                       
 MXZ                        Dummy  18855    I(4)            4           scalar   ARG,INOUT        18881,18887,18899,18906,18914,1891
                                                                                                  6,18926,18945,18951               
 N                          Local  18893    I(4)            4           scalar   SAVE             18893,18898,18900,18904,18905,1890
                                                                                                  7,18908,18951                     
 N1                         Local  18898    I(4)            4           scalar   SAVE             18898,18900,18905,18907,18908     
 NCHAR                      Local  18885    I(4)            4           scalar   SAVE             18885,18914,18916                 
 NDIM                       Param  18857    I(4)            4           scalar                    18881                             
 NFIX0                      Scalar 18876    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  18859    I(4)            4           scalar                    18874,18875                       
 NX                         Scalar 18870    I(4)            4           scalar   COM              18887,18926                       
 NXZ                        Dummy  18855    I(4)            4           scalar   ARG,INOUT        18881,18887,18893,18898,18904,1890
                                                                                                  5,18914,18916,18926,18945,18951   
 S2KOMP                     Common 18872                                7844     SAVE                                               
 S2PRIC                     Common 18870                                217      SAVE                                               
 UTC0                       Scalar 18876    R(4)            4           scalar   COM                                                
 UTCOB                      Scalar 18874    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 18875    R(4)            4     1     20       COM                                                
 WSTM                       Scalar 18875    R(4)            4     1     20       COM                                                
 XM1                        Scalar 18871    R(4)            4           scalar   COM                                                
 XML                        Scalar 18870    R(4)            4           scalar   COM              18945                             
 XMR                        Scalar 18870    R(4)            4           scalar   COM              18945                             
 XMXX                       Scalar 18871    R(4)            4           scalar   COM                                                
 XSTM                       Scalar 18874    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 18876    R(4)            4           scalar   COM              18945                             
 XYBCWL                     Scalar 18871    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 18871    R(4)            4     1     2        COM                                                
 XYT                        Common 18874                                64432    SAVE                                               
 YN1                        Scalar 18871    R(4)            4           scalar   COM                                                
 YNB                        Scalar 18870    R(4)            4           scalar   COM              18945                             
 YNT                        Scalar 18870    R(4)            4           scalar   COM              18945                             
 YNXX                       Scalar 18871    R(4)            4           scalar   COM                                                
 YSTM                       Scalar 18874    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 18876    R(4)            4           scalar   COM              18945                             

Page 532         Source Listing                  DSKNMC
2017-04-18 11:09                                 syndata.f

  18958 
  18959 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  18960 C                .      .    .                                       .
  18961 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  18962 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  18963 C
  18964 C ABSTRACT: ??????????????????????????????????????????????????????????
  18965 C   ??????????????????????????????????????????????????????????????????
  18966 C
  18967 C PROGRAM HISTORY LOG:
  18968 C ????-??-??  S. J. LORD
  18969 C
  18970 C USAGE:    CALL ????????(????)
  18971 C   INPUT ARGUMENT LIST:
  18972 C     ??????   - ???????????????????????????????????????????????
  18973 C
  18974 C   OUTPUT ARGUMENT LIST:
  18975 C     ??????   - ???????????????????????????????????????????????
  18976 C
  18977 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  18978 C     ??????   - ???????????????????????????????????????????????
  18979 C
  18980 C   OUTPUT FILES:
  18981 C     ??????   - ???????????????????????????????????????????????
  18982 C
  18983 C REMARKS: ?????????????????????????????????????????????????????
  18984 C
  18985 C ATTRIBUTES:
  18986 C   LANGUAGE: FORTRAN 90
  18987 C   MACHINE:  NCEP WCOSS
  18988 C
  18989 C$$$
  18990       SUBROUTINE DPREP(F,KV,NF1,NF2)
  18991 C
  18992       PARAMETER (LDXDIM=8000)
  18993       PARAMETER (NFFDIM=LDXDIM)
  18994 C
  18995       SAVE
  18996 C
  18997       DIMENSION F(NF1,NF2),FF(NFFDIM,2)
  18998 C
  18999       IF(NF1*NF2 .GT. NFFDIM)  GO TO 900
  19000       SCS=0.0
  19001       SCM=1.0
  19002       GO TO (90,90,90,40,50,60,60,60),KV
  19003       WRITE(6,11) KV
  19004    11 FORMAT(/'***** KV HAS IMPROPER VALUE IN DPREP',I9)
  19005       CALL ABRT1('  DPREP',11)
  19006 C
  19007 C     GEOPOTENTIAL:  SCALE ONLY IF MAXIMUM HEIGHTS EXCEED 10000 METERS
  19008 C
  19009 CIBM30 ZMAX=-1.E10
  19010 C
  19011 CIBM  DO 35 N2=1,NF2
  19012 CIBM  DO 35 N1=1,NF1
  19013 CIBM  IF(F(N1,N2) .EQ. -99.0)  GO TO 35
  19014 CIBM  ZMAX=MAX(ZMAX,F(N1,N2))

Page 533         Source Listing                  DPREP
2017-04-18 11:09                                 syndata.f

  19015 CIBM5 CONTINUE
  19016 C
  19017 CIBM  IF(ZMAX .GT. 9999.)  SCM=0.1
  19018 CIBM  GO TO 90
  19019 C
  19020 C     SAVE U-COMPONENT OF WIND FOR DIRECTION/SPEED CALCULATION
  19021 C
  19022    40 NF=0
  19023 C
  19024       DO N2=1,NF2
  19025       DO N1=1,NF1
  19026       NF=NF+1
  19027       FF(NF,1)=F(N1,N2)
  19028       ENDDO
  19029       ENDDO
  19030 C
  19031       RETURN
  19032 C
  19033 C     SAVE V-COMPONENT OF WIND AND DIRECTION/SPEED CALCULATION
  19034 C
  19035    50 NF=0
  19036 C
  19037       DO N2=1,NF2
  19038       DO N1=1,NF1
  19039       NF=NF+1
  19040       FF(NF,2)=F(N1,N2)
  19041       ENDDO
  19042       ENDDO
  19043 C
  19044       RETURN
  19045 C
  19046 C     SAVE OTHER DATA
  19047 C
  19048    60 NF=0
  19049 C
  19050       DO N2=1,NF2
  19051       DO N1=1,NF1
  19052       NF=NF+1
  19053       CALL WDWSP(FF(NF,1),FF(NF,2))
  19054       F(N1,N2)=FF(NF,2)
  19055       ENDDO
  19056       ENDDO
  19057 C
  19058       RETURN
  19059 C
  19060 C     SAVE OTHER DATA
  19061 C
  19062    90 DO N2=1,NF2
  19063       DO N1=1,NF1
  19064       IF(F(N1,N2) .EQ. -99.0)  GO TO 95
  19065       F(N1,N2)=(F(N1,N2)-SCS)*SCM
  19066    95 CONTINUE
  19067       ENDDO
  19068       ENDDO
  19069 C
  19070       RETURN
  19071   900 WRITE(6,901)  NF1,NF2,NF1*NF2,NFFDIM

Page 534         Source Listing                  DPREP
2017-04-18 11:09                                 syndata.f

  19072   901 FORMAT(/'****** NF1,NF2,NF1*NF2=',3I6,' ARE GREATER THAN',
  19073      1       ' NFFDIM=LDXD=',I6,' IN DPREP')
  19074       CALL ABRT1('  DPREP',901)
  19075       END


ENTRY POINTS

  Name              
                    
 dprep_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  19004                                                          19003                             
 40                         Label  19022                                                          19002                             
 50                         Label  19035                                                          19002                             
 60                         Label  19048                                                          19002                             
 90                         Label  19062                                                          19002                             
 900                        Label  19071                                                          18999                             
 901                        Label  19072                                                          19071                             
 95                         Label  19066                                                          19064                             
 ABRT1                      Subr   19005                                                          19005,19074                       
 DPREP                      Subr   18990                                                                                            
 F                          Dummy  18990    R(4)            4     2     0        ARG,INOUT        19027,19040,19054,19064,19065     
 FF                         Local  18997    R(4)            4     2     16000    SAVE             19027,19040,19053,19054           
 KV                         Dummy  18990    I(4)            4           scalar   ARG,INOUT        19002,19003                       
 LDXDIM                     Param  18992    I(4)            4           scalar                    18993                             
 N1                         Local  19025    I(4)            4           scalar   SAVE             19025,19027,19038,19040,19051,1905
                                                                                                  4,19063,19064,19065               
 N2                         Local  19024    I(4)            4           scalar   SAVE             19024,19027,19037,19040,19050,1905
                                                                                                  4,19062,19064,19065               
 NF                         Local  19022    I(4)            4           scalar   SAVE             19022,19026,19027,19035,19039,1904
                                                                                                  0,19048,19052,19053,19054         
 NF1                        Dummy  18990    I(4)            4           scalar   ARG,INOUT        18997,18999,19025,19038,19051,1906
                                                                                                  3,19071                           
 NF2                        Dummy  18990    I(4)            4           scalar   ARG,INOUT        18997,18999,19024,19037,19050,1906
                                                                                                  2,19071                           
 NFFDIM                     Param  18993    I(4)            4           scalar                    18997,18999,19071                 
 SCM                        Local  19001    R(4)            4           scalar   SAVE             19001,19065                       
 SCS                        Local  19000    R(4)            4           scalar   SAVE             19000,19065                       
 WDWSP                      Subr   19053                                                          19053                             

Page 535         Source Listing                  DPREP
2017-04-18 11:09                                 syndata.f

  19076 
  19077 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19078 C                .      .    .                                       .
  19079 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19080 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19081 C
  19082 C ABSTRACT: ??????????????????????????????????????????????????????????
  19083 C   ??????????????????????????????????????????????????????????????????
  19084 C
  19085 C PROGRAM HISTORY LOG:
  19086 C ????-??-??  S. J. LORD
  19087 C
  19088 C USAGE:    CALL ????????(????)
  19089 C   INPUT ARGUMENT LIST:
  19090 C     ??????   - ???????????????????????????????????????????????
  19091 C
  19092 C   OUTPUT ARGUMENT LIST:
  19093 C     ??????   - ???????????????????????????????????????????????
  19094 C
  19095 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19096 C     ??????   - ???????????????????????????????????????????????
  19097 C
  19098 C   OUTPUT FILES:
  19099 C     ??????   - ???????????????????????????????????????????????
  19100 C
  19101 C REMARKS: ?????????????????????????????????????????????????????
  19102 C
  19103 C ATTRIBUTES:
  19104 C   LANGUAGE: FORTRAN 90
  19105 C   MACHINE:  NCEP WCOSS
  19106 C
  19107 C$$$
  19108       SUBROUTINE PRFSUB(F,KFDIM,MFDIM,NFDIM,KF,MF1,MF2,NF1,NF2,KVID,
  19109      1                  KSCALP,KFMT)
  19110 C
  19111 C
  19112       PARAMETER (MDIM=35,NDIM=35)
  19113 C
  19114 C     ** PRINT F(KF,MF,NF) FOR SINGLE KF, MF=MF1,MF2 AND NF=NF1,NF2
  19115 C        EACH VALUE OF F IS ENCODED AS  F5.1, AND PRINTED AS A5
  19116 C        UP TO 24 VALUES OF F ARE ALLOWED IN THE FULL WIDTH OF A PAGE
  19117 C
  19118       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  19119      1                 YNC(NDIM),COSYN(NDIM)
  19120       SAVE
  19121       DIMENSION F(KFDIM,MFDIM,NFDIM)
  19122 C
  19123       CHARACTER IFMTA4*16,LF*121
  19124       CHARACTER*1 IFM1,IFM2*3,IFM3*11,IFM4,KSCALP*3,KFMT*11
  19125       DATA IFM1/'('/,IFM2/'   '/,IFM3/'       F5.0'/,IFM4/')'/
  19126 
  19127 C-----------------------------------------------------------------------
  19128 
  19129 C
  19130       ENTRY PRF24A(F,KFDIM,MFDIM,NFDIM,KF,MF1,MF2,NF1,NF2,KVID)
  19131 C
  19132 C     PUT DATA INTO A ONE-DIMENSIONAL ARRAY FOR SIMPLICITY (PARALLEL TO

Page 536         Source Listing                  PRFSUB
2017-04-18 11:09                                 syndata.f

  19133 C     PRDFLD
  19134 C
  19135       MFA=MF1
  19136       MFB=MF2
  19137       LX=MIN(MFB-MFA+1,24)
  19138       NFB=NF2
  19139       NFA=NF1
  19140 C
  19141 C     WRITE LONGITUDE ACROSS
  19142 C
  19143       WRITE(6,710) (XMC(M),M=MFA,MFB)
  19144 C
  19145 C     WRITE NODAL POINT NUMBER ACROSS
  19146 C
  19147       WRITE(6,810) (M,M=MFA,MFB)
  19148       WRITE(6,811)
  19149 C
  19150       DO 16 N=NFB,NFA,-1
  19151         IF(KVID .EQ. 6)  THEN
  19152           DO 14 L=1,LX
  19153             IWD=IFIX(F(KF,L+MFA-1,N))
  19154             ISP=NINT((F(KF,L+MFA-1,N)-REAL(IWD))*100.)
  19155             WRITE(LF(5*(L-1)+1:5*L+1),IFMTA4)  IWD,ISP
  19156    14     CONTINUE
  19157         ELSE
  19158           DO 12 L=1,LX
  19159             WRITE(LF(5*(L-1)+1:5*L+1),IFMTA4) F(KF,L+MFA-1,N)
  19160    12     CONTINUE
  19161         ENDIF
  19162         WRITE(6,814) YNC(N),N,LF(1:5*LX)
  19163    16 CONTINUE
  19164 C
  19165 C     WRITE LONGITUDE AGAIN
  19166 C
  19167       WRITE(6,850) (M,M=MFA,MFB)
  19168 C
  19169 C     WRITE NODAL POINT NUMBER AGAIN
  19170 C
  19171       WRITE(6,910)  (XMC(M),M=MFA,MFB)
  19172       RETURN
  19173   710 FORMAT(6X,'LONG.=',12F8.2/12X,12F8.2)
  19174   810 FORMAT(10X,'M=',I4,23I5)
  19175   811 FORMAT('  LAT.  N')
  19176   814 FORMAT(/F6.2,1X,I3,2X,A)
  19177   850 FORMAT(/10X,'M=',I4,23I5)
  19178   910 FORMAT(6X,'LONG.=',12F8.2/12X,12F8.2)
  19179 
  19180 C-----------------------------------------------------------------------
  19181 
  19182 C
  19183 C     ** SET PRINT SCALE AND THE FORMAT
  19184 C
  19185       ENTRY STFMTA(KSCALP,KFMT)
  19186       WRITE(IFM2,823) KSCALP
  19187   823 FORMAT(A3)
  19188       WRITE(IFM3,829)  KFMT
  19189   829 FORMAT(A11)

Page 537         Source Listing                  PRFSUB
2017-04-18 11:09                                 syndata.f

  19190       IFMTA4 = IFM1//IFM2//IFM3//IFM4
  19191       RETURN
  19192       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 prf24a_               prfsub_               stfmta_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 12                         Label  19160                                                          19158                             
 14                         Label  19156                                                          19152                             
 16                         Label  19163                                                          19150                             
 710                        Label  19173                                                          19143                             
 810                        Label  19174                                                          19147                             
 811                        Label  19175                                                          19148                             
 814                        Label  19176                                                          19162                             
 823                        Label  19187                                                          19186                             
 829                        Label  19189                                                          19188                             
 850                        Label  19177                                                          19167                             
 910                        Label  19178                                                          19171                             
 COSYN                      Scalar 19119    R(4)            4     1     35       COM                                                
 DXM                        Scalar 19118    R(4)            4           scalar   COM                                                
 DYN                        Scalar 19118    R(4)            4           scalar   COM                                                
 F                          Dummy  19108    R(4)            4     3     0        ARG,INOUT        19153,19154,19159                 
 IFIX                       Func   19153                                scalar                    19153                             
 IFM1                       Local  19124    CHAR            1           scalar   SAVE             19125,19190                       
 IFM2                       Local  19124    CHAR            3           scalar   SAVE             19125,19186,19190                 
 IFM3                       Local  19124    CHAR            11          scalar   SAVE             19125,19188,19190                 
 IFM4                       Local  19124    CHAR            1           scalar   SAVE             19125,19190                       
 IFMTA4                     Local  19123    CHAR            16          scalar   SAVE             19155,19159,19190                 
 ISP                        Local  19154    I(4)            4           scalar   SAVE             19154,19155                       
 IWD                        Local  19153    I(4)            4           scalar   SAVE             19153,19154,19155                 
 KF                         Dummy  19108    I(4)            4           scalar   ARG,INOUT        19153,19154,19159                 
 KFDIM                      Dummy  19108    I(4)            4           scalar   ARG,INOUT        19121                             
 KFMT                       Dummy  19109    CHAR            11          scalar   ARG,INOUT        19188                             
 KSCALP                     Dummy  19109    CHAR            3           scalar   ARG,INOUT        19186                             
 KVID                       Dummy  19108    I(4)            4           scalar   ARG,INOUT        19151                             
 L                          Local  19152    I(4)            4           scalar   SAVE             19152,19153,19154,19155,19158,1915
                                                                                                  9                                 
 LF                         Local  19123    CHAR            121         scalar   SAVE             19155,19159,19162                 
 LX                         Local  19137    I(4)            4           scalar   SAVE             19137,19152,19158,19162           
 M                          Local  19143    I(4)            4           scalar   SAVE             19143,19147,19167,19171           
 MDIM                       Param  19112    I(4)            4           scalar                    19118                             
 MF1                        Dummy  19108    I(4)            4           scalar   ARG,INOUT        19135                             
 MF2                        Dummy  19108    I(4)            4           scalar   ARG,INOUT        19136                             
 MFA                        Local  19135    I(4)            4           scalar   SAVE             19135,19137,19143,19147,19153,1915
                                                                                                  4,19159,19167,19171               
 MFB                        Local  19136    I(4)            4           scalar   SAVE             19136,19137,19143,19147,19167,1917
                                                                                                  1                                 
 MFDIM                      Dummy  19108    I(4)            4           scalar   ARG,INOUT        19121                             

Page 538         Source Listing                  PRFSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIN                        Func   19137                                scalar                    19137                             
 MXX                        Scalar 19118    I(4)            4           scalar   COM                                                
 N                          Local  19150    I(4)            4           scalar   SAVE             19150,19153,19154,19159,19162     
 NDIM                       Param  19112    I(4)            4           scalar                    19118,19119                       
 NF1                        Dummy  19108    I(4)            4           scalar   ARG,INOUT        19139                             
 NF2                        Dummy  19108    I(4)            4           scalar   ARG,INOUT        19138                             
 NFA                        Local  19139    I(4)            4           scalar   SAVE             19139,19150                       
 NFB                        Local  19138    I(4)            4           scalar   SAVE             19138,19150                       
 NFDIM                      Dummy  19108    I(4)            4           scalar   ARG,INOUT        19121                             
 NINT                       Func   19154                                scalar                    19154                             
 NXX                        Scalar 19118    I(4)            4           scalar   COM                                                
 PRF24A                     Subr   19130                                                                                            
 PRFSUB                     Subr   19108                                                                                            
 REAL                       Func   19154                                scalar                    19154                             
 S2NODE                     Common 19118                                716      SAVE                                               
 STFMTA                     Subr   19185                                                                                            
 XM                         Scalar 19118    R(4)            4     1     35       COM                                                
 XMC                        Scalar 19118    R(4)            4     1     35       COM              19143,19171                       
 YN                         Scalar 19118    R(4)            4     1     35       COM                                                
 YNC                        Scalar 19119    R(4)            4     1     35       COM              19162                             

Page 539         Source Listing                  PRFSUB
2017-04-18 11:09                                 syndata.f

  19193 
  19194 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19195 C                .      .    .                                       .
  19196 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19197 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19198 C
  19199 C ABSTRACT: ??????????????????????????????????????????????????????????
  19200 C   ??????????????????????????????????????????????????????????????????
  19201 C
  19202 C PROGRAM HISTORY LOG:
  19203 C ????-??-??  S. J. LORD
  19204 C
  19205 C USAGE:    CALL ????????(????)
  19206 C   INPUT ARGUMENT LIST:
  19207 C     ??????   - ???????????????????????????????????????????????
  19208 C
  19209 C   OUTPUT ARGUMENT LIST:
  19210 C     ??????   - ???????????????????????????????????????????????
  19211 C
  19212 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19213 C     ??????   - ???????????????????????????????????????????????
  19214 C
  19215 C   OUTPUT FILES:
  19216 C     ??????   - ???????????????????????????????????????????????
  19217 C
  19218 C REMARKS: ?????????????????????????????????????????????????????
  19219 C
  19220 C ATTRIBUTES:
  19221 C   LANGUAGE: FORTRAN 90
  19222 C   MACHINE:  NCEP WCOSS
  19223 C
  19224 C$$$
  19225       SUBROUTINE PRFMSC(KSCALE,KFMT,NV,SCLF)
  19226 
  19227 C
  19228 C
  19229       PARAMETER (KVDIM=20)
  19230 C**SGIPARAMETER (KVDIM= 7)
  19231       DIMENSION IFMV(KVDIM),ISCLV(KVDIM)
  19232 C
  19233       CHARACTER*11 KFMT,IFMV
  19234       CHARACTER*3 KSCALE,ISCLV,SCLF*2
  19235 C
  19236       SAVE
  19237 C
  19238       DATA IFMV /2*'       F5.1','       F6.0',
  19239 C*SGI1           2*'       F5.1','I2.2,'/',I2',
  19240 C*SGI2             '       F5.1'/
  19241      1           2*'       F5.1',"I2.2,'/',I2",
  19242      2          14*'       F5.1'/
  19243       DATA ISCLV/KVDIM*' 0P'/
  19244 C
  19245       NVPS=NV
  19246 C
  19247 C     DEFAULT FORMAT FOR ALL EXTERNAL VARIABLES (NV=21 OR NV>=70)
  19248 C        IS F5.1
  19249 C

Page 540         Source Listing                  PRFMSC
2017-04-18 11:09                                 syndata.f

  19250       IF(NVPS .EQ. 21 .OR. NVPS .GE. 70)  NVPS=1
  19251       IF(NVPS .LE. KVDIM)  GO TO 10
  19252 C
  19253 C     SORRY:  A KLUGE TO MAKE SECOND DERIVATIVES THE SAME PRINT FORMAT
  19254 C             AS THE FIRST DERIVATIVE (GRADIENT) QUANTITIES^
  19255 C     FOR KVDIM=20:
  19256 C             NV      NVP     NVPS
  19257 C            1-20    UNDEF.   1-19
  19258 C            21-29     7        7
  19259 C            31-39     9        9
  19260 C            41-49    11       11
  19261 C            51-59    13       13
  19262 C            61-69    15       14
  19263 C
  19264       NVP=2*INT(REAL(NV)*0.1-1.0)+5
  19265       NVPS=NVP
  19266       IF(NVP .EQ. 15)  NVPS=14
  19267    10 KFMT=IFMV(NVPS)
  19268       KSCALE=ISCLV(NVPS)
  19269       IF(SCLF .NE. ' 0') KSCALE(1:2)=SCLF
  19270       RETURN
  19271       END


ENTRY POINTS

  Name               
                     
 prfmsc_             

Page 541         Source Listing                  PRFMSC
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  19267                                                          19251                             
 IFMV                       Local  19231    CHAR            11    1     20       SAVE             19238,19267                       
 INT                        Func   19264                                scalar                    19264                             
 ISCLV                      Local  19231    CHAR            3     1     20       SAVE             19243,19268                       
 KFMT                       Dummy  19225    CHAR            11          scalar   ARG,INOUT        19267                             
 KSCALE                     Dummy  19225    CHAR            3           scalar   ARG,INOUT        19268,19269                       
 KVDIM                      Param  19229    I(4)            4           scalar                    19231,19243,19251                 
 NV                         Dummy  19225    I(4)            4           scalar   ARG,INOUT        19245,19264                       
 NVP                        Local  19264    I(4)            4           scalar   SAVE             19264,19265,19266                 
 NVPS                       Local  19245    I(4)            4           scalar   SAVE             19245,19250,19251,19265,19266,1926
                                                                                                  7,19268                           
 PRFMSC                     Subr   19225                                                                                            
 REAL                       Func   19264                                scalar                    19264                             
 SCLF                       Dummy  19225    CHAR            2           scalar   ARG,INOUT        19269                             

Page 542         Source Listing                  PRFMSC
2017-04-18 11:09                                 syndata.f

  19272 
  19273 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19274 C                .      .    .                                       .
  19275 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19276 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19277 C
  19278 C ABSTRACT: ??????????????????????????????????????????????????????????
  19279 C   ??????????????????????????????????????????????????????????????????
  19280 C
  19281 C PROGRAM HISTORY LOG:
  19282 C ????-??-??  S. J. LORD
  19283 C
  19284 C USAGE:    CALL ????????(????)
  19285 C   INPUT ARGUMENT LIST:
  19286 C     ??????   - ???????????????????????????????????????????????
  19287 C
  19288 C   OUTPUT ARGUMENT LIST:
  19289 C     ??????   - ???????????????????????????????????????????????
  19290 C
  19291 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19292 C     ??????   - ???????????????????????????????????????????????
  19293 C
  19294 C   OUTPUT FILES:
  19295 C     ??????   - ???????????????????????????????????????????????
  19296 C
  19297 C REMARKS: ?????????????????????????????????????????????????????
  19298 C
  19299 C ATTRIBUTES:
  19300 C   LANGUAGE: FORTRAN 90
  19301 C   MACHINE:  NCEP WCOSS
  19302 C
  19303 C$$$
  19304       SUBROUTINE PRFKMD(A,FKMN,KP1,KP2)
  19305 C
  19306       PARAMETER (MDIM=35,NDIM=35)
  19307       PARAMETER (KLDIM= 8)
  19308       PARAMETER (KVDIM=20,KDTDIM=5)
  19309 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  19310       PARAMETER (KPXDIM=KVDIM*KLDIM)
  19311       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  19312 C
  19313 C     ** ** EXTERNALS MUST BE DECLARED ** **
  19314 C
  19315       EXTERNAL XBF,YBF,DXBF,DYBF,DDXBF,DDYBF
  19316 C
  19317       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  19318      1                 YNC(NDIM),COSYN(NDIM)
  19319       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  19320      1                 DMEAN(KDTDIM*KLDIM)
  19321 C
  19322       SAVE
  19323 C
  19324       DIMENSION A(KDXDIM,MDIM,NDIM),FKMN(KPXDIM,MDIM,NDIM)
  19325       CHARACTER*40 IDSPK,KFMT*11,KSCALE*3,SCLF*2
  19326       DATA NNPAGE/51/,NMPAGE/24/,SCLF/' 0'/,KSCALE/'   '/
  19327 C
  19328       CALL SLINTA(A,1,MXX,1,1,NXX,1)

Page 543         Source Listing                  PRFKMD
2017-04-18 11:09                                 syndata.f

  19329       CALL SLINTD(XBF,YBF)
  19330 C
  19331       DO 21 KP=KP1,KP2
  19332       CALL SLINTO(A,KP,FKMN,KPXDIM,MDIM,NDIM,KP)
  19333 C
  19334 C     ADD IN MEAN VALUES
  19335 C
  19336       DO M=1,MXX
  19337       DO N=1,NXX
  19338       FKMN(KP,M,N)=FKMN(KP,M,N)+DMEAN(KP)
  19339       ENDDO
  19340       ENDDO
  19341    21 CONTINUE
  19342 
  19343 C-----------------------------------------------------------------------
  19344 
  19345 C
  19346       ENTRY PRFKMV(FKMN,KP1,KP2)
  19347 C
  19348 C     WRITE GRIDDED DATA VALUES
  19349 C
  19350       NODMAX=(NNPAGE-1)/2+1
  19351       NPGMAX=(NXX-1)/NODMAX+1
  19352       MPGMAX=(MXX-1)/NMPAGE+1
  19353       DO 25 KP=KP1,KP2
  19354       NARG1=NXX
  19355         DO 23 NPG=1,NPGMAX
  19356         NARG2=MAX(NARG1+1-NODMAX,1)
  19357           DO 22 MPG=1,MPGMAX
  19358             CALL PRTITL(1)
  19359             CALL PRDSPC
  19360             print *, ' '
  19361             print *, ' '
  19362             CALL PRDSPK(KP)
  19363             CALL SETSCL(FKMN,KP,SCLF)
  19364             CALL DVLAB(KP,4,SCLF)
  19365             CALL PRFMSC(KSCALE,KFMT,IDVAR(KP),SCLF)
  19366             CALL STFMTA(KSCALE,KFMT)
  19367             MARG1=(MPG-1)*NMPAGE+1
  19368             MARG2=MIN(NMPAGE*MPG,MXX)
  19369             CALL PRF24A(FKMN,KPXDIM,MDIM,NDIM,KP,MARG1,MARG2,NARG2,
  19370      1                   NARG1,IDVAR(KP))
  19371    22   CONTINUE
  19372       NARG1=NARG2-1
  19373    23 CONTINUE
  19374    25 CONTINUE
  19375 C
  19376       RETURN
  19377 
  19378 C-----------------------------------------------------------------------
  19379       END

Page 544         Source Listing                  PRFKMD
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name               
                                           
 prfkmd_               prfkmv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 21                         Label  19341                                                          19331                             
 22                         Label  19371                                                          19357                             
 23                         Label  19373                                                          19355                             
 25                         Label  19374                                                          19353                             
 A                          Dummy  19304    R(4)            4     3     49000    ARG,INOUT        19328,19332                       
 COSYN                      Scalar 19318    R(4)            4     1     35       COM                                                
 DDXBF                      Subr   19315                                scalar                                                      
 DDYBF                      Subr   19315                                scalar                                                      
 DMEAN                      Scalar 19320    R(4)            4     1     40       COM              19338                             
 DVLAB                      Subr   19364                                                          19364                             
 DXBF                       Subr   19315                                scalar                                                      
 DXM                        Scalar 19317    R(4)            4           scalar   COM                                                
 DYBF                       Subr   19315                                scalar                                                      
 DYN                        Scalar 19317    R(4)            4           scalar   COM                                                
 FKMN                       Dummy  19304    R(4)            4     3     196000   ARG,INOUT        19332,19338,19363,19369           
 IDLEV                      Scalar 19319    I(4)            4     1     160      COM                                                
 IDSPK                      Scalar 19319    CHAR            40    1     160      COM                                                
 IDVAR                      Scalar 19319    I(4)            4     1     160      COM              19365,19370                       
 KDTDIM                     Param  19308    I(4)            4           scalar                    19311,19320                       
 KDXDIM                     Param  19311    I(4)            4           scalar                    19324                             
 KFMT                       Local  19325    CHAR            11          scalar   SAVE             19365,19366                       
 KLDIM                      Param  19307    I(4)            4           scalar                    19310,19311,19320                 
 KP                         Local  19331    I(4)            4           scalar   SAVE             19331,19332,19338,19353,19362,1936
                                                                                                  3,19364,19365,19369,19370         
 KP1                        Dummy  19304    I(4)            4           scalar   ARG,INOUT        19331,19353                       
 KP2                        Dummy  19304    I(4)            4           scalar   ARG,INOUT        19331,19353                       
 KPX                        Scalar 19319    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  19310    I(4)            4           scalar                    19319,19324,19332,19369           
 KSCALE                     Local  19325    CHAR            3           scalar   SAVE             19326,19365,19366                 
 KVDIM                      Param  19308    I(4)            4           scalar                    19310                             
 M                          Local  19336    I(4)            4           scalar   SAVE             19336,19338                       
 MARG1                      Local  19367    I(4)            4           scalar   SAVE             19367,19369                       
 MARG2                      Local  19368    I(4)            4           scalar   SAVE             19368,19369                       
 MAX                        Func   19356                                scalar                    19356                             
 MDIM                       Param  19306    I(4)            4           scalar                    19317,19324,19332,19369           
 MIN                        Func   19368                                scalar                    19368                             
 MPG                        Local  19357    I(4)            4           scalar   SAVE             19357,19367,19368                 
 MPGMAX                     Local  19352    I(4)            4           scalar   SAVE             19352,19357                       
 MXX                        Scalar 19317    I(4)            4           scalar   COM              19328,19336,19352,19368           
 N                          Local  19337    I(4)            4           scalar   SAVE             19337,19338                       
 NARG1                      Local  19354    I(4)            4           scalar   SAVE             19354,19356,19370,19372           
 NARG2                      Local  19356    I(4)            4           scalar   SAVE             19356,19369,19372                 
 NDIM                       Param  19306    I(4)            4           scalar                    19317,19318,19324,19332,19369     
 NMPAGE                     Local  19326    I(4)            4           scalar   SAVE             19326,19352,19367,19368           

Page 545         Source Listing                  PRFKMD
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NNPAGE                     Local  19326    I(4)            4           scalar   SAVE             19326,19350                       
 NODMAX                     Local  19350    I(4)            4           scalar   SAVE             19350,19351,19356                 
 NPG                        Local  19355    I(4)            4           scalar   SAVE             19355                             
 NPGMAX                     Local  19351    I(4)            4           scalar   SAVE             19351,19355                       
 NXX                        Scalar 19317    I(4)            4           scalar   COM              19328,19337,19351,19354           
 PRDSPC                     Subr   19359                                                          19359                             
 PRDSPK                     Subr   19362                                                          19362                             
 PRF24A                     Subr   19369                                                          19369                             
 PRFKMD                     Subr   19304                                                                                            
 PRFKMV                     Subr   19346                                                                                            
 PRFMSC                     Subr   19365                                                          19365                             
 PRTITL                     Subr   19358                                                          19358                             
 S2KOMP                     Common 19319                                7844     SAVE                                               
 S2NODE                     Common 19317                                716      SAVE                                               
 SCLF                       Local  19325    CHAR            2           scalar   SAVE             19326,19363,19364,19365           
 SETSCL                     Subr   19363                                                          19363                             
 SLINTA                     Subr   19328                                                          19328                             
 SLINTD                     Subr   19329                                                          19329                             
 SLINTO                     Subr   19332                                                          19332                             
 STFMTA                     Subr   19366                                                          19366                             
 XBF                        Subr   19315                                scalar                    19329                             
 XM                         Scalar 19317    R(4)            4     1     35       COM                                                
 XMC                        Scalar 19317    R(4)            4     1     35       COM                                                
 YBF                        Subr   19315                                scalar                    19329                             
 YN                         Scalar 19317    R(4)            4     1     35       COM                                                
 YNC                        Scalar 19318    R(4)            4     1     35       COM                                                

Page 546         Source Listing                  PRFKMD
2017-04-18 11:09                                 syndata.f

  19380 
  19381 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19382 C                .      .    .                                       .
  19383 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19384 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19385 C
  19386 C ABSTRACT: ??????????????????????????????????????????????????????????
  19387 C   ??????????????????????????????????????????????????????????????????
  19388 C
  19389 C PROGRAM HISTORY LOG:
  19390 C ????-??-??  S. J. LORD
  19391 C
  19392 C USAGE:    CALL ????????(????)
  19393 C   INPUT ARGUMENT LIST:
  19394 C     ??????   - ???????????????????????????????????????????????
  19395 C
  19396 C   OUTPUT ARGUMENT LIST:
  19397 C     ??????   - ???????????????????????????????????????????????
  19398 C
  19399 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19400 C     ??????   - ???????????????????????????????????????????????
  19401 C
  19402 C   OUTPUT FILES:
  19403 C     ??????   - ???????????????????????????????????????????????
  19404 C
  19405 C REMARKS: ?????????????????????????????????????????????????????
  19406 C
  19407 C ATTRIBUTES:
  19408 C   LANGUAGE: FORTRAN 90
  19409 C   MACHINE:  NCEP WCOSS
  19410 C
  19411 C$$$
  19412       SUBROUTINE MEANV(KF,FD)
  19413 C
  19414       PARAMETER (LDXDIM=8000)
  19415       PARAMETER (KLDIM= 8)
  19416       PARAMETER (KVDIM=20,KDTDIM=5)
  19417 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  19418       PARAMETER (KPXDIM=KVDIM*KLDIM)
  19419       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  19420 C
  19421       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  19422      1               ID(LDXDIM),LXSORT(LDXDIM)
  19423       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  19424      1                 DMEAN(KDTDIM*KLDIM)
  19425 C
  19426       CHARACTER IDSPD1*8,IDSPD2*72,IDSPK*40
  19427 C
  19428       SAVE
  19429 C
  19430       DIMENSION FD(KDXDIM,LDXDIM)
  19431 C
  19432 C     CALCULATE THE MEAN
  19433 C
  19434       DMEAN(KF)=0.0
  19435 C
  19436       DO LD=1,LDX

Page 547         Source Listing                  MEANV
2017-04-18 11:09                                 syndata.f

  19437       DMEAN(KF)=DMEAN(KF)+FD(KF,LD)
  19438       ENDDO
  19439 C
  19440       DMEAN(KF)=DMEAN(KF)/REAL(LDX)
  19441 C
  19442 C     CALCULATE THE DEVIATION FROM THE MEAN
  19443 C
  19444       DO LD=1,LDX
  19445       FD(KF,LD)=FD(KF,LD)-DMEAN(KF)
  19446       ENDDO
  19447 C
  19448       RETURN
  19449       END


ENTRY POINTS

  Name              
                    
 meanv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DMEAN                      Scalar 19424    R(4)            4     1     40       COM              19434,19437,19440,19445           
 FD                         Dummy  19412    R(4)            4     2     320000   ARG,INOUT        19437,19445                       
 ID                         Scalar 19422    I(4)            4     1     8000     COM                                                
 IDLEV                      Scalar 19423    I(4)            4     1     160      COM                                                
 IDSPD1                     Scalar 19421    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 19421    CHAR            72          scalar   COM                                                
 IDSPK                      Scalar 19423    CHAR            40    1     160      COM                                                
 IDVAR                      Scalar 19423    I(4)            4     1     160      COM                                                
 KDTDIM                     Param  19416    I(4)            4           scalar                    19419,19424                       
 KDXDIM                     Param  19419    I(4)            4           scalar                    19430                             
 KF                         Dummy  19412    I(4)            4           scalar   ARG,INOUT        19434,19437,19440,19445           
 KLDIM                      Param  19415    I(4)            4           scalar                    19418,19419,19424                 
 KPX                        Scalar 19423    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  19418    I(4)            4           scalar                    19423                             
 KVDIM                      Param  19416    I(4)            4           scalar                    19418                             
 LD                         Local  19436    I(4)            4           scalar   SAVE             19436,19437,19444,19445           
 LDX                        Scalar 19421    I(4)            4           scalar   COM              19436,19440,19444                 
 LDXDIM                     Param  19414    I(4)            4           scalar                    19421,19422,19430                 
 LXSORT                     Scalar 19422    I(4)            4     1     8000     COM                                                
 MEANV                      Subr   19412                                                                                            
 REAL                       Func   19440                                scalar                    19440                             
 S2DTPT                     Common 19421                                160084   SAVE                                               
 S2KOMP                     Common 19423                                7844     SAVE                                               
 WD                         Scalar 19421    R(4)            4     1     8000     COM                                                
 XD                         Scalar 19421    R(4)            4     1     8000     COM                                                
 YD                         Scalar 19421    R(4)            4     1     8000     COM                                                

Page 548         Source Listing                  MEANV
2017-04-18 11:09                                 syndata.f

  19450 
  19451 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19452 C                .      .    .                                       .
  19453 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19454 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19455 C
  19456 C ABSTRACT: ??????????????????????????????????????????????????????????
  19457 C   ??????????????????????????????????????????????????????????????????
  19458 C
  19459 C PROGRAM HISTORY LOG:
  19460 C ????-??-??  S. J. LORD
  19461 C
  19462 C USAGE:    CALL ????????(????)
  19463 C   INPUT ARGUMENT LIST:
  19464 C     ??????   - ???????????????????????????????????????????????
  19465 C
  19466 C   OUTPUT ARGUMENT LIST:
  19467 C     ??????   - ???????????????????????????????????????????????
  19468 C
  19469 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19470 C     ??????   - ???????????????????????????????????????????????
  19471 C
  19472 C   OUTPUT FILES:
  19473 C     ??????   - ???????????????????????????????????????????????
  19474 C
  19475 C REMARKS: ?????????????????????????????????????????????????????
  19476 C
  19477 C ATTRIBUTES:
  19478 C   LANGUAGE: FORTRAN 90
  19479 C   MACHINE:  NCEP WCOSS
  19480 C
  19481 C$$$
  19482       SUBROUTINE OUTSUB(MSKDAZ,OUTFIL,NV,KL,FDZ,XSPOT,YSPOT,NLEVEL,
  19483      1                  SKWVAL)
  19484 C
  19485       PARAMETER (LDXDIM=8000)
  19486       PARAMETER (NFXDIM=20)
  19487 C
  19488 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  19489 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  19490       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  19491      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  19492       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  19493      1               ID(LDXDIM),LXSORT(LDXDIM)
  19494       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  19495      1           WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),ELORG,GLORG,
  19496      2           XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  19497 C
  19498       DIMENSION WDZ(LDXDIM),FDZ(LDXDIM),SKWVAL(5,19)
  19499 C
  19500       CHARACTER IDSPC*125,IDSPD1*8,IDSPD2*72
  19501       CHARACTER ZTIME*8,ZDATE*11,OUTFIL*(*)
  19502 C
  19503       SAVE
  19504 C
  19505 
  19506 C-----------------------------------------------------------------------

Page 549         Source Listing                  OUTSUB
2017-04-18 11:09                                 syndata.f

  19507 
  19508       ENTRY OUTDV1(MSKDAZ,OUTFIL)
  19509       MSKZ=MSKDAZ
  19510 C
  19511 C     OPEN THE FILE, GET THE CORRECT TIME AND DATE, AND WRITE THE HEADER
  19512 C     TO THE FILE
  19513 C
  19514       OPEN(UNIT=MSKZ,FILE=OUTFIL,STATUS='NEW',ACCESS='SEQUENTIAL',
  19515      1     FORM='UNFORMATTED')
  19516       CALL SPDATE(ZDATE)
  19517       CALL SPTIME(ZTIME)
  19518 C** DEBUG
  19519 C     WE CURRENTLY WRITE THE NEGATIVE OF ALL LONGITUDES UNTIL
  19520 C       THE "NCEP" PART OF THE PLOTTING PACKAGE ACCEPTS THE FACT
  19521 C       THAT POSITIVE LONGITUDES ARE IN THE EASTERN HEMISPHERE AND
  19522 C       LONGITUDE INCREASES EASTWARD.
  19523 C
  19524       WRITE(MSKZ) IDSPC,MX,NX,KDCTYP,KBCTYP,ISRCD,-XML,-XMR,YNB,
  19525      1            YNT,-ELORG,GLORG,JPD,XYDCWL,XYBCWL,XD,YD,LDX,
  19526      2            ZDATE,ZTIME
  19527 C
  19528 C     CHOOSE THE CORRECT OUTPUT STATEMENT AND WRITE
  19529 C
  19530       IF(OUTFIL.EQ.'SKWT')     WRITE(6,100)MSKZ,OUTFIL
  19531       IF(OUTFIL .NE. 'SKWT')  WRITE(6,1)  MSKZ,OUTFIL
  19532 C
  19533 C     FOR COMPATIBILITY WITH PREVIOUS FILES OF THIS TYPE, CREATE WDZ FRO
  19534 C       THE ID ARRAY.
  19535 C
  19536       WDZ(1:LDX)=REAL(ID(1:LDX))
  19537 C
  19538 c && 4 comments
  19539 CC    WRITE(6,13)  IDSPC,MX,NX,KDCTYP,KBCTYP,ISRCD,XML,XMXX,YNB,YNXX,
  19540 CC   1             YNT,JPD,XYDCWL,XYBCWL,(XD(LD),YD(LD),LD=1,LDX),
  19541 CC   2             ZDATE,ZTIME
  19542 CC 13 FORMAT(/A125/8I10/5F10.2,I10/6F10.2/41(2F10.2/),A11,A9)
  19543 C
  19544     1 FORMAT(/'....(DATA-SPLINE) DEVIATIONS WILL BE WRITTEN TO UNIT',I4,
  19545      1       ' AND NAME=',A10)
  19546   100 FORMAT(/'....DATA FOR SKW-T DIAGRAMS WILL BE WRITTEN TO UNIT'
  19547      1      ,I4,' AND NAME=',A4)
  19548 
  19549       RETURN
  19550 C
  19551 
  19552 C-----------------------------------------------------------------------
  19553 
  19554       ENTRY OUTDV2(NV,KL,FDZ)
  19555 C
  19556       WRITE(MSKZ) NV,KL,XD,YD,WDZ,FDZ
  19557       WRITE(6,111)  NV,KL
  19558   111 FORMAT('       ... VARIABLE #',I3,'   LEVEL #',I3,' WRITTEN TO ',
  19559      1       'DISK')
  19560 C
  19561 c && 2 comments
  19562 CC    WRITE(6,112) NV,KL,(WDZ(LD),XD(LD),YD(LD),FDZ(LD),LD=1,LDX)
  19563 CC112 FORMAT(/'  ...NV,KL=',2I5/' ...WDZ,XD,YD,FDZ='/(F4.0,2F6.1,F10.3))

Page 550         Source Listing                  OUTSUB
2017-04-18 11:09                                 syndata.f

  19564 C
  19565       RETURN
  19566 
  19567 C-----------------------------------------------------------------------
  19568 
  19569 C
  19570       ENTRY OUTDV3(XSPOT,YSPOT,NLEVEL,SKWVAL)
  19571 C
  19572 C     WRITE P, T, RH, WSPD, WDIR TO FILE 24 FOR SKW-T LOG-P PLOT
  19573 C
  19574       WRITE(MSKZ)NLEVEL,YSPOT,XSPOT,JDAY0,UTC0
  19575       WRITE(2,*)NLEVEL,YSPOT,XSPOT,JDAY0,UTC0
  19576       DO 113 I=1,19
  19577         IDTTST=0
  19578         DO 114 II=2,5
  19579           IF(SKWVAL(II,I).NE.-99.)THEN
  19580             IDTTST=1
  19581           ENDIF
  19582   114   CONTINUE
  19583         IF(IDTTST.EQ.1)THEN
  19584           WRITE(MSKZ)(SKWVAL(II,I),II=1,5)
  19585           WRITE(2,*)(SKWVAL(II,I),II=1,5)
  19586         ENDIF
  19587   113 CONTINUE
  19588       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 outdv1_               outdv2_               outdv3_               outsub_             

Page 551         Source Listing                  OUTSUB
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  19544                                                          19531                             
 100                        Label  19546                                                          19530                             
 111                        Label  19558                                                          19557                             
 113                        Label  19587                                                          19576                             
 114                        Label  19582                                                          19578                             
 ELORG                      Scalar 19495    R(4)            4           scalar   COM              19525                             
 FDZ                        Dummy  19482    R(4)            4     1     8000     ARG,INOUT        19556                             
 GLORG                      Scalar 19495    R(4)            4           scalar   COM              19525                             
 I                          Local  19576    I(4)            4           scalar   SAVE             19576,19579,19584,19585           
 ID                         Scalar 19493    I(4)            4     1     8000     COM              19536                             
 IDAYMN                     Scalar 19496    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 19494    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 19495    I(4)            4     1     20       COM                                                
 IDSPC                      Scalar 19491    CHAR            125         scalar   COM              19524                             
 IDSPD1                     Scalar 19492    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 19492    CHAR            72          scalar   COM                                                
 IDTTST                     Local  19577    I(4)            4           scalar   SAVE             19577,19580,19583                 
 II                         Local  19578    I(4)            4           scalar   SAVE             19578,19579,19584,19585           
 ISRCD                      Scalar 19490    I(4)            4           scalar   COM              19524                             
 JDAY0                      Scalar 19496    I(4)            4           scalar   COM              19574,19575                       
 JPD                        Scalar 19490    I(4)            4           scalar   COM              19525                             
 KBCTYP                     Scalar 19490    I(4)            4     1     4        COM              19524                             
 KDCTYP                     Scalar 19490    I(4)            4           scalar   COM              19524                             
 KL                         Dummy  19482    I(4)            4           scalar   ARG,INOUT        19556,19557                       
 LDX                        Scalar 19492    I(4)            4           scalar   COM              19525,19536                       
 LDXDIM                     Param  19485    I(4)            4           scalar                    19492,19493,19494,19498           
 LXSORT                     Scalar 19493    I(4)            4     1     8000     COM                                                
 MSKDAZ                     Dummy  19482    I(4)            4           scalar   ARG,INOUT        19509                             
 MSKZ                       Local  19509    I(4)            4           scalar   SAVE             19509,19514,19524,19530,19531,1955
                                                                                                  6,19574,19584                     
 MX                         Scalar 19490    I(4)            4           scalar   COM              19524                             
 NFIX0                      Scalar 19496    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  19486    I(4)            4           scalar                    19494,19495                       
 NLEVEL                     Dummy  19482    I(4)            4           scalar   ARG,INOUT        19574,19575                       
 NV                         Dummy  19482    I(4)            4           scalar   ARG,INOUT        19556,19557                       
 NX                         Scalar 19490    I(4)            4           scalar   COM              19524                             
 OUTDV1                     Subr   19508                                                                                            
 OUTDV2                     Subr   19554                                                                                            
 OUTDV3                     Subr   19570                                                                                            
 OUTFIL                     Dummy  19482    CHAR                        scalar   ARG,INOUT        19514,19530,19531                 
 OUTSUB                     Subr   19482                                                                                            
 REAL                       Func   19536                                scalar                    19536                             
 S2DTPT                     Common 19492                                160084   SAVE                                               
 S2PRIC                     Common 19490                                217      SAVE                                               
 SKWVAL                     Dummy  19483    R(4)            4     2     95       ARG,INOUT        19579,19584,19585                 
 SPDATE                     Subr   19516                                                          19516                             
 SPTIME                     Subr   19517                                                          19517                             
 UTC0                       Scalar 19496    R(4)            4           scalar   COM              19574,19575                       
 UTCOB                      Scalar 19494    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 19495    R(4)            4     1     20       COM                                                
 WD                         Scalar 19492    R(4)            4     1     8000     COM                                                

Page 552         Source Listing                  OUTSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 WDZ                        Local  19498    R(4)            4     1     8000     SAVE             19536,19556                       
 WSTM                       Scalar 19495    R(4)            4     1     20       COM                                                
 XD                         Scalar 19492    R(4)            4     1     8000     COM              19525,19556                       
 XM1                        Scalar 19491    R(4)            4           scalar   COM                                                
 XML                        Scalar 19490    R(4)            4           scalar   COM              19524                             
 XMR                        Scalar 19490    R(4)            4           scalar   COM              19524                             
 XMXX                       Scalar 19491    R(4)            4           scalar   COM                                                
 XSPOT                      Dummy  19482    R(4)            4           scalar   ARG,INOUT        19574,19575                       
 XSTM                       Scalar 19494    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 19496    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 19491    R(4)            4     1     4        COM              19525                             
 XYDCWL                     Scalar 19491    R(4)            4     1     2        COM              19525                             
 XYT                        Common 19494                                64432    SAVE                                               
 YD                         Scalar 19492    R(4)            4     1     8000     COM              19525,19556                       
 YN1                        Scalar 19491    R(4)            4           scalar   COM                                                
 YNB                        Scalar 19490    R(4)            4           scalar   COM              19524                             
 YNT                        Scalar 19490    R(4)            4           scalar   COM              19525                             
 YNXX                       Scalar 19491    R(4)            4           scalar   COM                                                
 YSPOT                      Dummy  19482    R(4)            4           scalar   ARG,INOUT        19574,19575                       
 YSTM                       Scalar 19494    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 19496    R(4)            4           scalar   COM                                                
 ZDATE                      Local  19501    CHAR            11          scalar   SAVE             19516,19526                       
 ZTIME                      Local  19501    CHAR            8           scalar   SAVE             19517,19526                       

Page 553         Source Listing                  OUTSUB
2017-04-18 11:09                                 syndata.f

  19589 
  19590 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19591 C                .      .    .                                       .
  19592 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19593 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19594 C
  19595 C ABSTRACT: ??????????????????????????????????????????????????????????
  19596 C   ??????????????????????????????????????????????????????????????????
  19597 C
  19598 C PROGRAM HISTORY LOG:
  19599 C ????-??-??  S. J. LORD
  19600 C
  19601 C USAGE:    CALL ????????(????)
  19602 C   INPUT ARGUMENT LIST:
  19603 C     ??????   - ???????????????????????????????????????????????
  19604 C
  19605 C   OUTPUT ARGUMENT LIST:
  19606 C     ??????   - ???????????????????????????????????????????????
  19607 C
  19608 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19609 C     ??????   - ???????????????????????????????????????????????
  19610 C
  19611 C   OUTPUT FILES:
  19612 C     ??????   - ???????????????????????????????????????????????
  19613 C
  19614 C REMARKS: ?????????????????????????????????????????????????????
  19615 C
  19616 C ATTRIBUTES:
  19617 C   LANGUAGE: FORTRAN 90
  19618 C   MACHINE:  NCEP WCOSS
  19619 C
  19620 C$$$
  19621       FUNCTION QSATW(TA,P)
  19622 C
  19623 C     TA IS TEMPERATURE IN DEG KELVIN
  19624 C     P IS PRESSURE IN MB
  19625 C     QSATW IS SATURATION MIXING RATIO IN G/G
  19626 C
  19627       DATA PS/1013.246/,TS/373.16/
  19628       E1=11.344*(1.0-TA/TS)
  19629       E2=-3.49149*(TS/TA-1.0)
  19630       F1=-7.90298*(TS/TA-1.0)
  19631       F2=5.02808*ALOG10(TS/TA)
  19632       F3=-1.3816*(10.0**E1-1.0)*1.E-7
  19633       F4=8.1328*(10.0**E2-1.0)*1.E-3
  19634       F5=ALOG10(PS)
  19635       F=F1+F2+F3+F4+F5
  19636       ES=10.0**F
  19637       QSATW=.62197*ES/(P-ES)
  19638       RETURN
  19639       END

Page 554         Source Listing                  QSATW
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 qsatw_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALOG10                     Func   19631                                scalar                    19631,19634                       
 E1                         Local  19628    R(4)            4           scalar                    19628,19632                       
 E2                         Local  19629    R(4)            4           scalar                    19629,19633                       
 ES                         Local  19636    R(4)            4           scalar                    19636,19637                       
 F                          Local  19635    R(4)            4           scalar                    19635,19636                       
 F1                         Local  19630    R(4)            4           scalar                    19630,19635                       
 F2                         Local  19631    R(4)            4           scalar                    19631,19635                       
 F3                         Local  19632    R(4)            4           scalar                    19632,19635                       
 F4                         Local  19633    R(4)            4           scalar                    19633,19635                       
 F5                         Local  19634    R(4)            4           scalar                    19634,19635                       
 P                          Dummy  19621    R(4)            4           scalar   ARG,INOUT        19637                             
 PS                         Local  19627    R(4)            4           scalar                    19627,19634                       
 QSATW                      Func   19621    R(4)            4           scalar                    19637                             
 QSATW@0                    Local  19621    R(4)            4           scalar                                                      
 TA                         Dummy  19621    R(4)            4           scalar   ARG,INOUT        19628,19629,19630,19631           
 TS                         Local  19627    R(4)            4           scalar                    19627,19628,19629,19630,19631     

Page 555         Source Listing                  QSATW
2017-04-18 11:09                                 syndata.f

  19640 
  19641 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19642 C                .      .    .                                       .
  19643 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19644 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19645 C
  19646 C ABSTRACT: ??????????????????????????????????????????????????????????
  19647 C   ??????????????????????????????????????????????????????????????????
  19648 C
  19649 C PROGRAM HISTORY LOG:
  19650 C ????-??-??  S. J. LORD
  19651 C
  19652 C USAGE:    CALL ????????(????)
  19653 C   INPUT ARGUMENT LIST:
  19654 C     ??????   - ???????????????????????????????????????????????
  19655 C
  19656 C   OUTPUT ARGUMENT LIST:
  19657 C     ??????   - ???????????????????????????????????????????????
  19658 C
  19659 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19660 C     ??????   - ???????????????????????????????????????????????
  19661 C
  19662 C   OUTPUT FILES:
  19663 C     ??????   - ???????????????????????????????????????????????
  19664 C
  19665 C REMARKS: ?????????????????????????????????????????????????????
  19666 C
  19667 C ATTRIBUTES:
  19668 C   LANGUAGE: FORTRAN 90
  19669 C   MACHINE:  NCEP WCOSS
  19670 C
  19671 C$$$
  19672       FUNCTION QSATI(TA,P)
  19673 C
  19674 C     TA IS TEMPERATURE IN DEG KELVIN
  19675 C     P IS PRESSURE IN MB
  19676 C     QSATI IS SATURATION MIXING RATIO WITH RESPECT TO ICE IN G/G
  19677 C
  19678       DATA P0/6.1071/,T0/273.16/
  19679       F1=-9.09718*(T0/TA-1.0)
  19680       F2=-3.56654*ALOG10(T0/TA)
  19681       F3=0.876793*(1.0-TA/T0)
  19682       F4=ALOG10(P0)
  19683       ES=10.0**(F1+F2+F3+F4)
  19684       QSATI=.62197*ES/(P-ES)
  19685       RETURN
  19686       END

Page 556         Source Listing                  QSATI
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 qsati_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALOG10                     Func   19680                                scalar                    19680,19682                       
 ES                         Local  19683    R(4)            4           scalar                    19683,19684                       
 F1                         Local  19679    R(4)            4           scalar                    19679,19683                       
 F2                         Local  19680    R(4)            4           scalar                    19680,19683                       
 F3                         Local  19681    R(4)            4           scalar                    19681,19683                       
 F4                         Local  19682    R(4)            4           scalar                    19682,19683                       
 P                          Dummy  19672    R(4)            4           scalar   ARG,INOUT        19684                             
 P0                         Local  19678    R(4)            4           scalar                    19678,19682                       
 QSATI                      Func   19672    R(4)            4           scalar                    19684                             
 QSATI@0                    Local  19672    R(4)            4           scalar                                                      
 T0                         Local  19678    R(4)            4           scalar                    19678,19679,19680,19681           
 TA                         Dummy  19672    R(4)            4           scalar   ARG,INOUT        19679,19680,19681                 

Page 557         Source Listing                  QSATI
2017-04-18 11:09                                 syndata.f

  19687 
  19688 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19689 C                .      .    .                                       .
  19690 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19691 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19692 C
  19693 C ABSTRACT: ??????????????????????????????????????????????????????????
  19694 C   ??????????????????????????????????????????????????????????????????
  19695 C
  19696 C PROGRAM HISTORY LOG:
  19697 C ????-??-??  S. J. LORD
  19698 C
  19699 C USAGE:    CALL ????????(????)
  19700 C   INPUT ARGUMENT LIST:
  19701 C     ??????   - ???????????????????????????????????????????????
  19702 C
  19703 C   OUTPUT ARGUMENT LIST:
  19704 C     ??????   - ???????????????????????????????????????????????
  19705 C
  19706 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19707 C     ??????   - ???????????????????????????????????????????????
  19708 C
  19709 C   OUTPUT FILES:
  19710 C     ??????   - ???????????????????????????????????????????????
  19711 C
  19712 C REMARKS: ?????????????????????????????????????????????????????
  19713 C
  19714 C ATTRIBUTES:
  19715 C   LANGUAGE: FORTRAN 90
  19716 C   MACHINE:  NCEP WCOSS
  19717 C
  19718 C$$$
  19719       FUNCTION PCKPRW(UV,PRX,WX)
  19720       DOUBLE PRECISION PCKPRW
  19721       PCKPRW=DBLE(IFIX(SIGN(PRX,UV))+
  19722      1        NINT(UV*10.)*1000)+
  19723      2        DSIGN(DBLE(WX),DBLE(UV))/100.
  19724       RETURN
  19725       END

Page 558         Source Listing                  PCKPRW
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 pckprw_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DBLE                       Func   19721                                scalar                    19721,19723                       
 DSIGN                      Func   19723                                scalar                    19723                             
 IFIX                       Func   19721                                scalar                    19721                             
 NINT                       Func   19722                                scalar                    19722                             
 PCKPRW                     Func   19719    R(8)            8           scalar                    19721                             
 PCKPRW@0                   Local  19719    R(8)            8           scalar                                                      
 PRX                        Dummy  19719    R(4)            4           scalar   ARG,INOUT        19721                             
 SIGN                       Func   19721                                scalar                    19721                             
 UV                         Dummy  19719    R(4)            4           scalar   ARG,INOUT        19721,19722,19723                 
 WX                         Dummy  19719    R(4)            4           scalar   ARG,INOUT        19723                             

Page 559         Source Listing                  PCKPRW
2017-04-18 11:09                                 syndata.f

  19726 
  19727 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19728 C                .      .    .                                       .
  19729 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19730 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19731 C
  19732 C ABSTRACT: ??????????????????????????????????????????????????????????
  19733 C   ??????????????????????????????????????????????????????????????????
  19734 C
  19735 C PROGRAM HISTORY LOG:
  19736 C ????-??-??  S. J. LORD
  19737 C
  19738 C USAGE:    CALL ????????(????)
  19739 C   INPUT ARGUMENT LIST:
  19740 C     ??????   - ???????????????????????????????????????????????
  19741 C
  19742 C   OUTPUT ARGUMENT LIST:
  19743 C     ??????   - ???????????????????????????????????????????????
  19744 C
  19745 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19746 C     ??????   - ???????????????????????????????????????????????
  19747 C
  19748 C   OUTPUT FILES:
  19749 C     ??????   - ???????????????????????????????????????????????
  19750 C
  19751 C REMARKS: ?????????????????????????????????????????????????????
  19752 C
  19753 C ATTRIBUTES:
  19754 C   LANGUAGE: FORTRAN 90
  19755 C   MACHINE:  NCEP WCOSS
  19756 C
  19757 C$$$
  19758       SUBROUTINE UPKPRW(PCKX,UVX,PRX,WX)
  19759       DOUBLE PRECISION PCKX
  19760       IPCKX=INT(PCKX)
  19761       PCKX3=PCKX*0.001
  19762       WX=REAL(NINT(DABS(PCKX-DBLE(IPCKX))*100.))
  19763       PRX=REAL(INT(DABS(PCKX3-DBLE(INT(PCKX3)))*1000.))
  19764       IF(NINT(PRX*10.) .LT. 1000)  PRX=PRX+1000.
  19765       UVX=SIGN(REAL(INT(PCKX3)),PCKX3)*0.1
  19766       RETURN
  19767       END

Page 560         Source Listing                  UPKPRW
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 upkprw_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DABS                       Func   19762                                scalar                    19762,19763                       
 DBLE                       Func   19762                                scalar                    19762,19763                       
 INT                        Func   19760                                scalar                    19760,19763,19765                 
 IPCKX                      Local  19760    I(4)            4           scalar                    19760,19762                       
 NINT                       Func   19762                                scalar                    19762,19764                       
 PCKX                       Dummy  19758    R(8)            8           scalar   ARG,INOUT        19760,19761,19762                 
 PCKX3                      Local  19761    R(4)            4           scalar                    19761,19763,19765                 
 PRX                        Dummy  19758    R(4)            4           scalar   ARG,INOUT        19763,19764                       
 REAL                       Func   19762                                scalar                    19762,19763,19765                 
 SIGN                       Func   19765                                scalar                    19765                             
 UPKPRW                     Subr   19758                                                                                            
 UVX                        Dummy  19758    R(4)            4           scalar   ARG,INOUT        19765                             
 WX                         Dummy  19758    R(4)            4           scalar   ARG,INOUT        19762                             

Page 561         Source Listing                  UPKPRW
2017-04-18 11:09                                 syndata.f

  19768 
  19769 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19770 C                .      .    .                                       .
  19771 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19772 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19773 C
  19774 C ABSTRACT: ??????????????????????????????????????????????????????????
  19775 C   ??????????????????????????????????????????????????????????????????
  19776 C
  19777 C PROGRAM HISTORY LOG:
  19778 C ????-??-??  S. J. LORD
  19779 C
  19780 C USAGE:    CALL ????????(????)
  19781 C   INPUT ARGUMENT LIST:
  19782 C     ??????   - ???????????????????????????????????????????????
  19783 C
  19784 C   OUTPUT ARGUMENT LIST:
  19785 C     ??????   - ???????????????????????????????????????????????
  19786 C
  19787 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19788 C     ??????   - ???????????????????????????????????????????????
  19789 C
  19790 C   OUTPUT FILES:
  19791 C     ??????   - ???????????????????????????????????????????????
  19792 C
  19793 C REMARKS: ?????????????????????????????????????????????????????
  19794 C
  19795 C ATTRIBUTES:
  19796 C   LANGUAGE: FORTRAN 90
  19797 C   MACHINE:  NCEP WCOSS
  19798 C
  19799 C$$$
  19800       SUBROUTINE OUTSTK(KD,LDXX,FDD,KLSTIK,LDWX)
  19801 C
  19802       PARAMETER (KLDIM= 8)
  19803       PARAMETER (KDTDIM=5)
  19804 C**SGIPARAMETER (KDTDIM=5)
  19805 C
  19806       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  19807      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,
  19808      2            MSKD14,MSKD15,MSKD16,MSKD17,MSKD18
  19809       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  19810 C
  19811       LOGICAL RHANL
  19812       DOUBLE PRECISION PCKPRW
  19813 C
  19814       SAVE
  19815 C
  19816       DIMENSION FDD(LDXX)
  19817 C
  19818 C     ******  WARNING: SINGLE PRECISION VALUES ARE WRITTEN TO
  19819 C                      DISK.  THIS IS ADEQUATE ONLY FOR SINGLE
  19820 C                      DIGIT VALUES OF WX.
  19821 C
  19822       WX=6.
  19823       PRX=PLEV(KLSTIK)
  19824 C

Page 562         Source Listing                  OUTSTK
2017-04-18 11:09                                 syndata.f

  19825       DO LD=1,LDXX
  19826       FDD(LD)=PCKPRW(FDD(LD),PRX,WX)
  19827       ENDDO
  19828 C
  19829       WRITE(MSKDA9) KLSTIK,KD,LDXX,FDD,LDWX
  19830 C
  19831       RETURN
  19832       END


ENTRY POINTS

  Name               
                     
 outstk_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DATREC                     Scalar 19809    R(4)            4     1     6        COM                                                
 DSK                        Common 19806                                76       SAVE                                               
 FDD                        Dummy  19800    R(4)            4     1     0        ARG,INOUT        19826,19829                       
 ICOOR                      Scalar 19809    I(4)            4           scalar   COM                                                
 IDAT                       Scalar 19809    I(4)            4           scalar   COM                                                
 IDATZ                      Scalar 19809    I(4)            4           scalar   COM                                                
 KD                         Dummy  19800    I(4)            4           scalar   ARG,INOUT        19829                             
 KDTDIM                     Param  19803    I(4)            4           scalar                    19809                             
 KLDIM                      Param  19802    I(4)            4           scalar                    19809                             
 KLSTIK                     Dummy  19800    I(4)            4           scalar   ARG,INOUT        19823,19829                       
 LD                         Local  19825    I(4)            4           scalar   SAVE             19825,19826                       
 LDWX                       Dummy  19800    I(4)            4           scalar   ARG,INOUT        19829                             
 LDXX                       Dummy  19800    I(4)            4           scalar   ARG,INOUT        19816,19825,19829                 
 MSKD11                     Scalar 19807    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 19807    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 19807    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 19808    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 19808    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 19808    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 19808    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 19808    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 19806    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 19806    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 19806    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 19806    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 19806    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 19806    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 19807    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 19807    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 19807    I(4)            4           scalar   COM              19829                             
 MSKEF                      Scalar 19806    I(4)            4           scalar   COM                                                
 MSKEZ                      Scalar 19806    I(4)            4           scalar   COM                                                
 OUTSTK                     Subr   19800                                                                                            
 PCKPRW                     Func   19812    R(8)            8           scalar                    19826                             
 PLEV                       Scalar 19809    R(4)            4     1     8        COM              19823                             
 PRES                       Common 19809                                72       SAVE                                               

Page 563         Source Listing                  OUTSTK
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PRX                        Local  19823    R(4)            4           scalar   SAVE             19823,19826                       
 RHANL                      Scalar 19809    L(4)            4           scalar   COM                                                
 WX                         Local  19822    R(4)            4           scalar   SAVE             19822,19826                       

Page 564         Source Listing                  OUTSTK
2017-04-18 11:09                                 syndata.f

  19833 
  19834 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19835 C                .      .    .                                       .
  19836 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19837 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19838 C
  19839 C ABSTRACT: ??????????????????????????????????????????????????????????
  19840 C   ??????????????????????????????????????????????????????????????????
  19841 C
  19842 C PROGRAM HISTORY LOG:
  19843 C ????-??-??  S. J. LORD
  19844 C
  19845 C USAGE:    CALL ????????(????)
  19846 C   INPUT ARGUMENT LIST:
  19847 C     ??????   - ???????????????????????????????????????????????
  19848 C
  19849 C   OUTPUT ARGUMENT LIST:
  19850 C     ??????   - ???????????????????????????????????????????????
  19851 C
  19852 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19853 C     ??????   - ???????????????????????????????????????????????
  19854 C
  19855 C   OUTPUT FILES:
  19856 C     ??????   - ???????????????????????????????????????????????
  19857 C
  19858 C REMARKS: ?????????????????????????????????????????????????????
  19859 C
  19860 C ATTRIBUTES:
  19861 C   LANGUAGE: FORTRAN 90
  19862 C   MACHINE:  NCEP WCOSS
  19863 C
  19864 C$$$
  19865       SUBROUTINE OPNFIL(MSKDA9)
  19866       OPEN(UNIT=MSKDA9,FILE='STKDATO',ACCESS='SEQUENTIAL',
  19867      1     STATUS='UNKNOWN',FORM='UNFORMATTED')
  19868       RETURN
  19869       END

Page 565         Source Listing                  OPNFIL
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 opnfil_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKDA9                     Dummy  19865    I(4)            4           scalar   ARG,INOUT        19866                             
 OPNFIL                     Subr   19865                                                                                            

Page 566         Source Listing                  OPNFIL
2017-04-18 11:09                                 syndata.f

  19870 
  19871 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19872 C                .      .    .                                       .
  19873 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19874 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19875 C
  19876 C ABSTRACT: ??????????????????????????????????????????????????????????
  19877 C   ??????????????????????????????????????????????????????????????????
  19878 C
  19879 C PROGRAM HISTORY LOG:
  19880 C ????-??-??  S. J. LORD
  19881 C
  19882 C USAGE:    CALL ????????(????)
  19883 C   INPUT ARGUMENT LIST:
  19884 C     ??????   - ???????????????????????????????????????????????
  19885 C
  19886 C   OUTPUT ARGUMENT LIST:
  19887 C     ??????   - ???????????????????????????????????????????????
  19888 C
  19889 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19890 C     ??????   - ???????????????????????????????????????????????
  19891 C
  19892 C   OUTPUT FILES:
  19893 C     ??????   - ???????????????????????????????????????????????
  19894 C
  19895 C REMARKS: ?????????????????????????????????????????????????????
  19896 C
  19897 C ATTRIBUTES:
  19898 C   LANGUAGE: FORTRAN 90
  19899 C   MACHINE:  NCEP WCOSS
  19900 C
  19901 C$$$
  19902       SUBROUTINE ENDFIL(MSKDA9)
  19903       OPEN(UNIT=MSKDA9,FILE='STKDATO',ACCESS='SEQUENTIAL',
  19904      1     STATUS='UNKNOWN',FORM='UNFORMATTED',ERR=990)
  19905     1 READ(MSKDA9,END=100,ERR=900)
  19906       GO TO 1
  19907   100 RETURN
  19908   900 WRITE(6,901)  MSKDA9
  19909   901 FORMAT('******  ERROR READING UNIT',I4,' IN ENDFIL')
  19910       CALL ABRT1(' ENDFIL',901)
  19911   990 WRITE(6,991) MSKDA9
  19912   991 FORMAT(/'****** ERROR SKIPPING TO END OF FILE',I4,'.  OPENING',
  19913      1       ' A NEW FILE')
  19914       CALL OPNFIL(MSKDA9)
  19915       RETURN
  19916       END

Page 567         Source Listing                  ENDFIL
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 endfil_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  19905                                                          19906                             
 100                        Label  19907                                                          19905                             
 900                        Label  19908                                                          19905                             
 901                        Label  19909                                                          19908                             
 990                        Label  19911                                                          19904                             
 991                        Label  19912                                                          19911                             
 ABRT1                      Subr   19910                                                          19910                             
 ENDFIL                     Subr   19902                                                                                            
 MSKDA9                     Dummy  19902    I(4)            4           scalar   ARG,INOUT        19903,19905,19908,19911,19914     
 OPNFIL                     Subr   19914                                                          19914                             

Page 568         Source Listing                  ENDFIL
2017-04-18 11:09                                 syndata.f

  19917 
  19918 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  19919 C                .      .    .                                       .
  19920 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  19921 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  19922 C
  19923 C ABSTRACT: ??????????????????????????????????????????????????????????
  19924 C   ??????????????????????????????????????????????????????????????????
  19925 C
  19926 C PROGRAM HISTORY LOG:
  19927 C ????-??-??  S. J. LORD
  19928 C
  19929 C USAGE:    CALL ????????(????)
  19930 C   INPUT ARGUMENT LIST:
  19931 C     ??????   - ???????????????????????????????????????????????
  19932 C
  19933 C   OUTPUT ARGUMENT LIST:
  19934 C     ??????   - ???????????????????????????????????????????????
  19935 C
  19936 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  19937 C     ??????   - ???????????????????????????????????????????????
  19938 C
  19939 C   OUTPUT FILES:
  19940 C     ??????   - ???????????????????????????????????????????????
  19941 C
  19942 C REMARKS: ?????????????????????????????????????????????????????
  19943 C
  19944 C ATTRIBUTES:
  19945 C   LANGUAGE: FORTRAN 90
  19946 C   MACHINE:  NCEP WCOSS
  19947 C
  19948 C$$$
  19949       SUBROUTINE SPTDER(X,Y,A,K1,K2,F)
  19950 C
  19951       PARAMETER (MDIM=35,NDIM=35)
  19952       PARAMETER (KLDIM= 8)
  19953       PARAMETER (KDTDIM=5)
  19954       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  19955 C
  19956       SAVE
  19957 C
  19958 C     ** ** SPOT INVERSE TRANSFORMATION OF SPLINE AMPLITUDES TO
  19959 C               DERIVATIVES OF F AT X,Y
  19960 C       X,Y        THE SPOT COORDINATES AT WHICH OUTPUT F IS DESIRED
  19961 C       A(K,M,N)   KTH COMPONET OF NODAL AMPLITUDE AT M,N
  19962 C       K1,K2      THE  RANGE OF COMPONENTS K OF THE AMPLITUDE (NOT OF O
  19963 C       F(KF)      THE SPOT OUTPUT F.  KF=1 FOR K=K1
  19964 C                                      KF=2 FOR K=K1+1,  TILL
  19965 C                                      KF=K2-K1+1 FOR K=K2
  19966 C     THERE ARE SEPARATE ENTRY POINTS FOR EACH DERIVATIVE.
  19967 C SPOTDX: FIRST X DERIVATIVE
  19968 C SPOTDY: FIRST Y DERIVATIVE
  19969 C SPDDXX: SECOND X DERIVATIVE
  19970 C SPDDYY: SECOND Y DERIVATIVE
  19971 C SPDDXY: SECOND CROSS DERIVATIVE
  19972 C     ** DUMMY ARGUMENTS
  19973 C

Page 569         Source Listing                  SPTDER
2017-04-18 11:09                                 syndata.f

  19974       DIMENSION A(KDXDIM,MDIM,NDIM)
  19975 cc dak 07/03/05      DIMENSION F(1)
  19976       dimension f(*) ! dak 7/3/05: fix bounds-check error
  19977       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  19978      1                 YNC(NDIM),COSYN(NDIM)
  19979       EQUIVALENCE (XM(1),X1),(YN(1),Y1)
  19980 C
  19981 C     ** LOCAL WORK SPACE
  19982 C
  19983       DIMENSION BM(4),BN(4),ZN(4)
  19984 C
  19985 
  19986 C-----------------------------------------------------------------------
  19987 
  19988       ENTRY SPOTDX(X,Y,A,K1,K2,F)
  19989       M0=MAX(INT((X-X1)/DXM),1)-1
  19990       N0=MAX(INT((Y-Y1)/DYN),1)-1
  19991       M4=MIN(MXX-M0,4)
  19992       N4=MIN(NXX-N0,4)
  19993 C
  19994 C     FIRST X DERIVATIVE
  19995 C
  19996       DO M=1,M4
  19997       BM(M)=DXBF(M+M0,X)
  19998       ENDDO
  19999 C
  20000       DO N=1,N4
  20001 C
  20002       BN(N)=YBF(N+N0,Y)
  20003       ENDDO
  20004       GO TO 30
  20005 C
  20006 
  20007 C-----------------------------------------------------------------------
  20008 
  20009       ENTRY SPOTDY(X,Y,A,K1,K2,F)
  20010       M0=MAX(INT((X-X1)/DXM),1)-1
  20011       N0=MAX(INT((Y-Y1)/DYN),1)-1
  20012       M4=MIN(MXX-M0,4)
  20013       N4=MIN(NXX-N0,4)
  20014 C
  20015 C     FIRST Y DERIVATIVE
  20016 C
  20017       DO M=1,M4
  20018       BM(M)=XBF(M+M0,X)
  20019       ENDDO
  20020 C
  20021       DO N=1,N4
  20022       BN(N)=DYBF(N+N0,Y)
  20023       ENDDO
  20024 C
  20025       GO TO 30
  20026 C
  20027 
  20028 C-----------------------------------------------------------------------
  20029 
  20030       ENTRY SPDDXX(X,Y,A,K1,K2,F)

Page 570         Source Listing                  SPTDER
2017-04-18 11:09                                 syndata.f

  20031       M0=MAX(INT((X-X1)/DXM),1)-1
  20032       N0=MAX(INT((Y-Y1)/DYN),1)-1
  20033       M4=MIN(MXX-M0,4)
  20034       N4=MIN(NXX-N0,4)
  20035 C
  20036 C     SECOND X DERIVATIVE
  20037 C
  20038       DO M=1,M4
  20039          BM(M)=DDXBF(M+M0,X)
  20040       ENDDO
  20041 C
  20042       DO N=1,N4
  20043          BN(N)=YBF(N+N0,Y)
  20044       ENDDO
  20045 C
  20046       GO TO 30
  20047 C
  20048 
  20049 C-----------------------------------------------------------------------
  20050 
  20051       ENTRY SPDDYY(X,Y,A,K1,K2,F)
  20052       M0=MAX(INT((X-X1)/DXM),1)-1
  20053       N0=MAX(INT((Y-Y1)/DYN),1)-1
  20054       M4=MIN(MXX-M0,4)
  20055       N4=MIN(NXX-N0,4)
  20056 C
  20057 C     SECOND Y DERIVATIVE
  20058 C
  20059       DO M=1,M4
  20060       BM(M)=XBF(M+M0,X)
  20061       ENDDO
  20062 C
  20063       DO N=1,N4
  20064       BN(N)=DDYBF(N+N0,Y)
  20065       ENDDO
  20066 C
  20067       GO TO 30
  20068 C
  20069 
  20070 C-----------------------------------------------------------------------
  20071 
  20072       ENTRY SPDDXY(X,Y,A,K1,K2,F)
  20073       M0=MAX(INT((X-X1)/DXM),1)-1
  20074       N0=MAX(INT((Y-Y1)/DYN),1)-1
  20075       M4=MIN(MXX-M0,4)
  20076       N4=MIN(NXX-N0,4)
  20077 C
  20078 C     SECOND CROSS DERIVATIVE
  20079 C
  20080       DO M=1,M4
  20081       BM(M)=DXBF(M+M0,X)
  20082       ENDDO
  20083 C
  20084       DO N=1,N4
  20085       BN(N)=DYBF(N+N0,Y)
  20086       ENDDO
  20087 C

Page 571         Source Listing                  SPTDER
2017-04-18 11:09                                 syndata.f

  20088    30 KF=0
  20089 C
  20090       DO K=K1,K2
  20091          KF=KF+1
  20092          DO N=1,4
  20093             ZN(N)=0.
  20094          ENDDO
  20095          DO M=1,M4
  20096             DO N=1,N4
  20097                ZN(N)=ZN(N)+BM(M)*A(K,M+M0,N+N0)*BN(N)
  20098             ENDDO
  20099          ENDDO
  20100          F(KF)=ZN(1)+ZN(2)+ZN(3)+ZN(4)
  20101       ENDDO
  20102 C
  20103       RETURN
  20104       END


ENTRY POINTS

  Name                  Name                  Name                  Name                  Name                  Name               
                                                                                                                                   
 spddxx_               spddxy_               spddyy_               spotdx_               spotdy_               sptder_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 30                         Label  20088                                                          20004,20025,20046,20067           
 A                          Dummy  19949    R(4)            4     3     49000    ARG,INOUT        20097                             
 BM                         Local  19983    R(4)            4     1     4        SAVE             19997,20018,20039,20060,20081,2009
                                                                                                  7                                 
 BN                         Local  19983    R(4)            4     1     4        SAVE             20002,20022,20043,20064,20085,2009
                                                                                                  7                                 
 COSYN                      Scalar 19978    R(4)            4     1     35       COM                                                
 DDXBF                      Func   20039    R(4)            4           scalar                    20039                             
 DDYBF                      Func   20064    R(4)            4           scalar                    20064                             
 DXBF                       Func   19997    R(4)            4           scalar                    19997,20081                       
 DXM                        Scalar 19977    R(4)            4           scalar   COM              19989,20010,20031,20052,20073     
 DYBF                       Func   20022    R(4)            4           scalar                    20022,20085                       
 DYN                        Scalar 19977    R(4)            4           scalar   COM              19990,20011,20032,20053,20074     
 F                          Dummy  19949    R(4)            4     1     0        ARG,INOUT        20100                             
 INT                        Func   19989                                scalar                    19989,19990,20010,20011,20031,2003
                                                                                                  2,20052,20053,20073,20074         
 K                          Local  20090    I(4)            4           scalar   SAVE             20090,20097                       
 K1                         Dummy  19949    I(4)            4           scalar   ARG,INOUT        20090                             
 K2                         Dummy  19949    I(4)            4           scalar   ARG,INOUT        20090                             
 KDTDIM                     Param  19953    I(4)            4           scalar                    19954                             
 KDXDIM                     Param  19954    I(4)            4           scalar                    19974                             
 KF                         Local  20088    I(4)            4           scalar   SAVE             20088,20091,20100                 
 KLDIM                      Param  19952    I(4)            4           scalar                    19954                             
 M                          Local  19996    I(4)            4           scalar   SAVE             19996,19997,20017,20018,20038,2003
                                                                                                  9,20059,20060,20080,20081,20095,20
                                                                                                  097                               
 M0                         Local  19989    I(4)            4           scalar   SAVE             19989,19991,19997,20010,20012,2001

Page 572         Source Listing                  SPTDER
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  8,20031,20033,20039,20052,20054,20
                                                                                                  060,20073,20075,20081,20097       
 M4                         Local  19991    I(4)            4           scalar   SAVE             19991,19996,20012,20017,20033,2003
                                                                                                  8,20054,20059,20075,20080,20095   
 MAX                        Func   19989                                scalar                    19989,19990,20010,20011,20031,2003
                                                                                                  2,20052,20053,20073,20074         
 MDIM                       Param  19951    I(4)            4           scalar                    19974,19977                       
 MIN                        Func   19991                                scalar                    19991,19992,20012,20013,20033,2003
                                                                                                  4,20054,20055,20075,20076         
 MXX                        Scalar 19977    I(4)            4           scalar   COM              19991,20012,20033,20054,20075     
 N                          Local  20000    I(4)            4           scalar   SAVE             20000,20002,20021,20022,20042,2004
                                                                                                  3,20063,20064,20084,20085,20092,20
                                                                                                  093,20096,20097                   
 N0                         Local  19990    I(4)            4           scalar   SAVE             19990,19992,20002,20011,20013,2002
                                                                                                  2,20032,20034,20043,20053,20055,20
                                                                                                  064,20074,20076,20085,20097       
 N4                         Local  19992    I(4)            4           scalar   SAVE             19992,20000,20013,20021,20034,2004
                                                                                                  2,20055,20063,20076,20084,20096   
 NDIM                       Param  19951    I(4)            4           scalar                    19974,19977,19978                 
 NXX                        Scalar 19977    I(4)            4           scalar   COM              19992,20013,20034,20055,20076     
 S2NODE                     Common 19977                                716      SAVE                                               
 SPDDXX                     Subr   20030                                                                                            
 SPDDXY                     Subr   20072                                                                                            
 SPDDYY                     Subr   20051                                                                                            
 SPOTDX                     Subr   19988                                                                                            
 SPOTDY                     Subr   20009                                                                                            
 SPTDER                     Subr   19949                                                                                            
 X                          Dummy  19949    R(4)            4           scalar   ARG,INOUT        19989,19997,20010,20018,20031,2003
                                                                                                  9,20052,20060,20073,20081         
 X1                         Scalar 19979    R(4)            4           scalar   COM              19989,20010,20031,20052,20073     
 XBF                        Func   20018    R(4)            4           scalar                    20018,20060                       
 XM                         Scalar 19977    R(4)            4     1     35       COM                                                
 XMC                        Scalar 19977    R(4)            4     1     35       COM                                                
 Y                          Dummy  19949    R(4)            4           scalar   ARG,INOUT        19990,20002,20011,20022,20032,2004
                                                                                                  3,20053,20064,20074,20085         
 Y1                         Scalar 19979    R(4)            4           scalar   COM              19990,20011,20032,20053,20074     
 YBF                        Func   20002    R(4)            4           scalar                    20002,20043                       
 YN                         Scalar 19977    R(4)            4     1     35       COM                                                
 YNC                        Scalar 19978    R(4)            4     1     35       COM                                                
 ZN                         Local  19983    R(4)            4     1     4        SAVE             20093,20097,20100                 

Page 573         Source Listing                  SPTDER
2017-04-18 11:09                                 syndata.f

  20105 
  20106 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20107 C                .      .    .                                       .
  20108 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20109 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20110 C
  20111 C ABSTRACT: ??????????????????????????????????????????????????????????
  20112 C   ??????????????????????????????????????????????????????????????????
  20113 C
  20114 C PROGRAM HISTORY LOG:
  20115 C ????-??-??  S. J. LORD
  20116 C
  20117 C USAGE:    CALL ????????(????)
  20118 C   INPUT ARGUMENT LIST:
  20119 C     ??????   - ???????????????????????????????????????????????
  20120 C
  20121 C   OUTPUT ARGUMENT LIST:
  20122 C     ??????   - ???????????????????????????????????????????????
  20123 C
  20124 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20125 C     ??????   - ???????????????????????????????????????????????
  20126 C
  20127 C   OUTPUT FILES:
  20128 C     ??????   - ???????????????????????????????????????????????
  20129 C
  20130 C REMARKS: ?????????????????????????????????????????????????????
  20131 C
  20132 C ATTRIBUTES:
  20133 C   LANGUAGE: FORTRAN 90
  20134 C   MACHINE:  NCEP WCOSS
  20135 C
  20136 C$$$
  20137       SUBROUTINE OUTREC(PR,DATA)
  20138 C
  20139       PARAMETER (KLDIM= 8)
  20140       PARAMETER (KDTDIM=5)
  20141 C**SGIPARAMETER (KDTDIM=5)
  20142 C
  20143       COMMON /PRES/ PLEV(KLDIM),RHANL,DATREC(KDTDIM+1),ICOOR,IDAT,IDATZ
  20144 C
  20145       SAVE
  20146 C
  20147       DIMENSION DATA(KDTDIM),DATAX(KDTDIM)
  20148       EQUIVALENCE (PRX,DATREC(1)),(DATREC(2),DATAX(1))
  20149 C
  20150 C     THIS SUBROUTINE RESHUFFLES AN OUTPUT DATA RECORD THAT MAY HAVE BEE
  20151 C       REARRANGED DUE TO ANALYSIS ON OTHER THAN P-COORDINATES
  20152 C
  20153       PRX=PR
  20154 C
  20155       DATAX=DATA
  20156 C
  20157       DATAZ=DATA(IDATZ)
  20158       DATREC(ICOOR)=PR
  20159       DATREC(IDAT)=DATAZ
  20160       PR=PRX
  20161 C

Page 574         Source Listing                  OUTREC
2017-04-18 11:09                                 syndata.f

  20162       DATA=DATAX
  20163 C
  20164       RETURN
  20165       END


ENTRY POINTS

  Name               
                     
 outrec_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DATA                       Dummy  20137    R(4)            4     1     5        ARG,INOUT        20155,20157,20162                 
 DATAX                      Scalar 20147    R(4)            4     1     5        COM              20155,20162                       
 DATAZ                      Local  20157    R(4)            4           scalar   SAVE             20157,20159                       
 DATREC                     Scalar 20143    R(4)            4     1     6        COM              20158,20159                       
 ICOOR                      Scalar 20143    I(4)            4           scalar   COM              20158                             
 IDAT                       Scalar 20143    I(4)            4           scalar   COM              20159                             
 IDATZ                      Scalar 20143    I(4)            4           scalar   COM              20157                             
 KDTDIM                     Param  20140    I(4)            4           scalar                    20143,20147                       
 KLDIM                      Param  20139    I(4)            4           scalar                    20143                             
 OUTREC                     Subr   20137                                                                                            
 PLEV                       Scalar 20143    R(4)            4     1     8        COM                                                
 PR                         Dummy  20137    R(4)            4           scalar   ARG,INOUT        20153,20158,20160                 
 PRES                       Common 20143                                72       SAVE                                               
 PRX                        Scalar 20148    R(4)            4           scalar   COM              20153,20160                       
 RHANL                      Scalar 20143    R(4)            4           scalar   COM                                                

Page 575         Source Listing                  OUTREC
2017-04-18 11:09                                 syndata.f

  20166 
  20167 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20168 C                .      .    .                                       .
  20169 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20170 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20171 C
  20172 C ABSTRACT: ??????????????????????????????????????????????????????????
  20173 C   ??????????????????????????????????????????????????????????????????
  20174 C
  20175 C PROGRAM HISTORY LOG:
  20176 C ????-??-??  S. J. LORD
  20177 C
  20178 C USAGE:    CALL ????????(????)
  20179 C   INPUT ARGUMENT LIST:
  20180 C     ??????   - ???????????????????????????????????????????????
  20181 C
  20182 C   OUTPUT ARGUMENT LIST:
  20183 C     ??????   - ???????????????????????????????????????????????
  20184 C
  20185 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20186 C     ??????   - ???????????????????????????????????????????????
  20187 C
  20188 C   OUTPUT FILES:
  20189 C     ??????   - ???????????????????????????????????????????????
  20190 C
  20191 C REMARKS: ?????????????????????????????????????????????????????
  20192 C
  20193 C ATTRIBUTES:
  20194 C   LANGUAGE: FORTRAN 90
  20195 C   MACHINE:  NCEP WCOSS
  20196 C
  20197 C$$$
  20198       SUBROUTINE SETSCL(FKMN,KP,SCLF)
  20199 C
  20200       PARAMETER (MDIM=35,NDIM=35)
  20201       PARAMETER (KLDIM= 8)
  20202       PARAMETER (KVDIM=20,KDTDIM=5)
  20203 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  20204       PARAMETER (KPXDIM=KVDIM*KLDIM)
  20205 C
  20206       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  20207      1                 YNC(NDIM),COSYN(NDIM)
  20208       COMMON /S2KOMP/ IDSPK(KPXDIM),IDVAR(KPXDIM),IDLEV(KPXDIM),KPX,
  20209      1                 DMEAN(KDTDIM*KLDIM)
  20210 C
  20211       SAVE
  20212 C
  20213       DIMENSION FKMN(KPXDIM,MDIM,NDIM),RMNMX(2,3)
  20214 C
  20215       CHARACTER IDSPK*40,SCLF*2
  20216 C
  20217       DATA SCALE/10.0/,RMNMX/-99.5,999.94,-999.,9999.,-1.0,1.0/
  20218 C
  20219 C     THIS SUBROUTINE SETS A SCALING FACTOR SO THAT NUMBERS ARE GREATER
  20220 C       THAN -99.5 AND LESS THAN 999.94, OR -999 OR 9999 FOR GEOPOTENTIA
  20221 C       NUMBERS THAT HAVE ABSOLUTE VALUE LESS THAN 1 ARE SCALED TO BE GR
  20222 C       THAN 1.0 OR LESS THEN -1.0.

Page 576         Source Listing                  SETSCL
2017-04-18 11:09                                 syndata.f

  20223 C     THIS VERSION IS FOR A THREE-DIMENSIONAL INPUT ARRAY.
  20224 C
  20225       NSCLF=0
  20226       KKSET=1
  20227       IF(IDVAR(KP) .EQ. 3) KKSET=2
  20228       FMAX=-1.E10
  20229       FMIN= 1.E10
  20230 C
  20231       DO N=1,NXX
  20232       DO M=1,MXX
  20233       FMIN=MIN(FMIN,FKMN(KP,M,N))
  20234       FMAX=MAX(FMAX,FKMN(KP,M,N))
  20235       ENDDO
  20236       ENDDO
  20237       IF(FMIN .EQ. 0.0 .AND. FMAX .EQ. 0.0)  GO TO 100
  20238 C
  20239    15 IF(FMIN .GT. RMNMX(1,KKSET))  GO TO 20
  20240       NSCLF=NSCLF+1
  20241       FMIN=FMIN/SCALE
  20242       GO TO 15
  20243 C
  20244    20 FMAX=FMAX/SCALE**NSCLF
  20245    25 IF(FMAX .LT. RMNMX(2,KKSET))  GO TO 40
  20246       NSCLF=NSCLF+1
  20247       FMAX=FMAX/SCALE
  20248       GO TO 25
  20249 C
  20250    40 IF(ABS(FMAX) .GT. RMNMX(2,3) .OR. ABS(FMIN) .GT. RMNMX(2,3))
  20251      1      GO TO 100
  20252       NSCLF=NSCLF-1
  20253       FMIN=FMIN*SCALE
  20254       FMAX=FMAX*SCALE
  20255       GO TO 40
  20256 C
  20257   100 WRITE(SCLF,'(I2)') -NSCLF
  20258       RETURN
  20259       END

Page 577         Source Listing                  SETSCL
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 setscl_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  20257                                                          20237,20251                       
 15                         Label  20239                                                          20242                             
 20                         Label  20244                                                          20239                             
 25                         Label  20245                                                          20248                             
 40                         Label  20250                                                          20245,20255                       
 ABS                        Func   20250                                scalar                    20250                             
 COSYN                      Scalar 20207    R(4)            4     1     35       COM                                                
 DMEAN                      Scalar 20209    R(4)            4     1     40       COM                                                
 DXM                        Scalar 20206    R(4)            4           scalar   COM                                                
 DYN                        Scalar 20206    R(4)            4           scalar   COM                                                
 FKMN                       Dummy  20198    R(4)            4     3     196000   ARG,INOUT        20233,20234                       
 FMAX                       Local  20228    R(4)            4           scalar   SAVE             20228,20234,20237,20244,20245,2024
                                                                                                  7,20250,20254                     
 FMIN                       Local  20229    R(4)            4           scalar   SAVE             20229,20233,20237,20239,20241,2025
                                                                                                  0,20253                           
 IDLEV                      Scalar 20208    I(4)            4     1     160      COM                                                
 IDSPK                      Scalar 20208    CHAR            40    1     160      COM                                                
 IDVAR                      Scalar 20208    I(4)            4     1     160      COM              20227                             
 KDTDIM                     Param  20202    I(4)            4           scalar                    20209                             
 KKSET                      Local  20226    I(4)            4           scalar   SAVE             20226,20227,20239,20245           
 KLDIM                      Param  20201    I(4)            4           scalar                    20204,20209                       
 KP                         Dummy  20198    I(4)            4           scalar   ARG,INOUT        20227,20233,20234                 
 KPX                        Scalar 20208    I(4)            4           scalar   COM                                                
 KPXDIM                     Param  20204    I(4)            4           scalar                    20208,20213                       
 KVDIM                      Param  20202    I(4)            4           scalar                    20204                             
 M                          Local  20232    I(4)            4           scalar   SAVE             20232,20233,20234                 
 MAX                        Func   20234                                scalar                    20234                             
 MDIM                       Param  20200    I(4)            4           scalar                    20206,20213                       
 MIN                        Func   20233                                scalar                    20233                             
 MXX                        Scalar 20206    I(4)            4           scalar   COM              20232                             
 N                          Local  20231    I(4)            4           scalar   SAVE             20231,20233,20234                 
 NDIM                       Param  20200    I(4)            4           scalar                    20206,20207,20213                 
 NSCLF                      Local  20225    I(4)            4           scalar   SAVE             20225,20240,20244,20246,20252,2025
                                                                                                  7                                 
 NXX                        Scalar 20206    I(4)            4           scalar   COM              20231                             
 RMNMX                      Local  20213    R(4)            4     2     6        SAVE             20217,20239,20245,20250           
 S2KOMP                     Common 20208                                7844     SAVE                                               
 S2NODE                     Common 20206                                716      SAVE                                               
 SCALE                      Local  20217    R(4)            4           scalar   SAVE             20217,20241,20244,20247,20253,2025
                                                                                                  4                                 
 SCLF                       Dummy  20198    CHAR            2           scalar   ARG,INOUT        20257                             
 SETSCL                     Subr   20198                                                                                            
 XM                         Scalar 20206    R(4)            4     1     35       COM                                                
 XMC                        Scalar 20206    R(4)            4     1     35       COM                                                

Page 578         Source Listing                  SETSCL
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YN                         Scalar 20206    R(4)            4     1     35       COM                                                
 YNC                        Scalar 20207    R(4)            4     1     35       COM                                                

Page 579         Source Listing                  SETSCL
2017-04-18 11:09                                 syndata.f

  20260 
  20261 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20262 C                .      .    .                                       .
  20263 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20264 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20265 C
  20266 C ABSTRACT: ??????????????????????????????????????????????????????????
  20267 C   ??????????????????????????????????????????????????????????????????
  20268 C
  20269 C PROGRAM HISTORY LOG:
  20270 C ????-??-??  S. J. LORD
  20271 C
  20272 C USAGE:    CALL ????????(????)
  20273 C   INPUT ARGUMENT LIST:
  20274 C     ??????   - ???????????????????????????????????????????????
  20275 C
  20276 C   OUTPUT ARGUMENT LIST:
  20277 C     ??????   - ???????????????????????????????????????????????
  20278 C
  20279 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20280 C     ??????   - ???????????????????????????????????????????????
  20281 C
  20282 C   OUTPUT FILES:
  20283 C     ??????   - ???????????????????????????????????????????????
  20284 C
  20285 C REMARKS: ?????????????????????????????????????????????????????
  20286 C
  20287 C ATTRIBUTES:
  20288 C   LANGUAGE: FORTRAN 90
  20289 C   MACHINE:  NCEP WCOSS
  20290 C
  20291 C$$$
  20292       SUBROUTINE HEDCHK(MSKDAZ)
  20293       PARAMETER (LDXDIM=8000)
  20294       PARAMETER (NFXDIM=20)
  20295       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  20296      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),
  20297      2            ELORG,GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  20298 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  20299 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  20300       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  20301      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  20302       DIMENSION KBCTYZ(4),XYDCWZ(2),XYBCWZ(4)
  20303       CHARACTER IDSPC*125,IDSPCZ*125
  20304 C
  20305       SAVE
  20306 
  20307 C     THIS SUBROUTINE CHECKS THE STANDARD HEAD RECORD AND COMPARES IT
  20308 C       WITH CURRENT VALUES IN COMMON /S2PRIC/.   MISMATCH CAUSES
  20309 C       PROGRAM TO CROAK GRACEFULLY.  MODIFICATION FOR OLD VERSUS
  20310 C       NEW STYLE HEAD RECORDS 10/17/88.
  20311 C
  20312       READ(MSKDAZ,ERR=100) IDSPCZ,MXZ,NXZ,KDCTYZ,KBCTYZ,ISRCDZ,
  20313      1                     XMLZ,XMRZ,YNBZ,YNTZ,ELORGZ,GLORGZ,
  20314      2                     JPDZ,XYDCWZ,XYBCWZ
  20315       XMLZ=-XMLZ
  20316       XMRZ=-XMRZ

Page 580         Source Listing                  HEDCHK
2017-04-18 11:09                                 syndata.f

  20317       ELORGZ=-ELORGZ
  20318       IF(ISRCDZ .NE. ISRCD .OR. XMLZ .NE. XML .OR. XMRZ .NE. XMR .OR.
  20319      1   YNBZ .NE. YNB .OR. YNTZ .NE. YNT .OR. ELORG .NE. ELORGZ .OR.
  20320      2   GLORGZ .NE. GLORG)  GO TO 10
  20321       RETURN
  20322 C
  20323    10 WRITE(6,11) ISRCDZ,XMLZ,XMRZ,YNBZ,YNTZ,ELORGZ,GLORGZ,
  20324      1            ISRCD ,XML ,XMRZ,YNB ,YNT ,ELORG ,GLORG
  20325    11 FORMAT(/'*****HEAD RECORDS (NEW STYLE) DO NOT MATCH.',
  20326      1       '  PROBABLE MISMATCH OF GEOMETRY',/,
  20327      2       ' ...ISRCDZ,XMLZ,XMRZ,YNBZ,YNTZ,ELORGZ,GLORGZ=',
  20328      3       I3,6F10.3,/,' ...ISRCD,XML,XMR,YNB,YNT,ELORG,GLORG=',
  20329      4       I3,6F10.3)
  20330       CALL ABRT1(' HEDCHK',11)
  20331 C
  20332 C     FOR OLD STYLE HEAD RECORDS THAT DO NOT CONTAIN ELORG,GLORG
  20333 C
  20334   100 REWIND MSKDAZ
  20335       READ(MSKDAZ) IDSPCZ,MXZ,NXZ,KDCTYZ,KBCTYZ,ISRCDZ,XMLZ,XMXXZ,
  20336      1             YNBZ,YNXXZ,YNTZ
  20337       XMLZ=-XMLZ
  20338       IF(ISRCDZ .NE. ISRCD .OR. XMLZ .NE. XML .OR. XMXXZ .NE. XMXX .OR.
  20339      1   YNBZ .NE. YNB .OR. YNXXZ .NE. YNXX .OR.
  20340      2   YNTZ .NE. YNT)  GO TO 110
  20341       RETURN
  20342 C
  20343   110 WRITE(6,111) ISRCDZ,XMLZ,XMXXZ,YNBZ,YNXXZ,YNTZ,
  20344      1             ISRCD ,XML ,XMXX ,YNB ,YNXX ,YNT
  20345   111 FORMAT(/'*****HEAD RECORDS (OLD STYLE) DO NOT MATCH.',
  20346      1       ' PROBABLE MISMATCH OF GEOMETRY',/,
  20347      2       ' ...ISRCDZ,XMLZ,XMXXZ,YNBZ,YNXXZ,YNTZ=',
  20348      2       I3,5F10.3,/,' ...ISRCD,XML,XMXX,YNB,YNXX,YNT=',
  20349      2       I3,5F10.3)
  20350       CALL ABRT1(' HEDCHK',111)
  20351 
  20352       END

Page 581         Source Listing                  HEDCHK
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 hedchk_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  20323                                                          20320                             
 100                        Label  20334                                                          20312                             
 11                         Label  20325                                                          20323                             
 110                        Label  20343                                                          20340                             
 111                        Label  20345                                                          20343                             
 ABRT1                      Subr   20330                                                          20330,20350                       
 ELORG                      Scalar 20297    R(4)            4           scalar   COM              20319,20324                       
 ELORGZ                     Local  20313    R(4)            4           scalar   SAVE             20313,20317,20319,20323           
 GLORG                      Scalar 20297    R(4)            4           scalar   COM              20320,20324                       
 GLORGZ                     Local  20313    R(4)            4           scalar   SAVE             20313,20320,20323                 
 HEDCHK                     Subr   20292                                                                                            
 IDAYMN                     Scalar 20297    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 20295    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 20296    I(4)            4     1     20       COM                                                
 IDSPC                      Scalar 20301    CHAR            125         scalar   COM                                                
 IDSPCZ                     Local  20303    CHAR            125         scalar   SAVE             20312,20335                       
 ISRCD                      Scalar 20300    I(4)            4           scalar   COM              20318,20324,20338,20344           
 ISRCDZ                     Local  20312    I(4)            4           scalar   SAVE             20312,20318,20323,20335,20338,2034
                                                                                                  3                                 
 JDAY0                      Scalar 20297    I(4)            4           scalar   COM                                                
 JPD                        Scalar 20300    I(4)            4           scalar   COM                                                
 JPDZ                       Local  20314    I(4)            4           scalar   SAVE             20314                             
 KBCTYP                     Scalar 20300    I(4)            4     1     4        COM                                                
 KBCTYZ                     Local  20302    I(4)            4     1     4        SAVE             20312,20335                       
 KDCTYP                     Scalar 20300    I(4)            4           scalar   COM                                                
 KDCTYZ                     Local  20312    I(4)            4           scalar   SAVE             20312,20335                       
 LDXDIM                     Param  20293    I(4)            4           scalar                    20295                             
 MSKDAZ                     Dummy  20292    I(4)            4           scalar   ARG,INOUT        20312,20334,20335                 
 MX                         Scalar 20300    I(4)            4           scalar   COM                                                
 MXZ                        Local  20312    I(4)            4           scalar   SAVE             20312,20335                       
 NFIX0                      Scalar 20297    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  20294    I(4)            4           scalar                    20295,20296                       
 NX                         Scalar 20300    I(4)            4           scalar   COM                                                
 NXZ                        Local  20312    I(4)            4           scalar   SAVE             20312,20335                       
 S2PRIC                     Common 20300                                217      SAVE                                               
 UTC0                       Scalar 20297    R(4)            4           scalar   COM                                                
 UTCOB                      Scalar 20295    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 20296    R(4)            4     1     20       COM                                                
 WSTM                       Scalar 20296    R(4)            4     1     20       COM                                                
 XM1                        Scalar 20301    R(4)            4           scalar   COM                                                
 XML                        Scalar 20300    R(4)            4           scalar   COM              20318,20324,20338,20344           
 XMLZ                       Local  20313    R(4)            4           scalar   SAVE             20313,20315,20318,20323,20335,2033
                                                                                                  7,20338,20343                     
 XMR                        Scalar 20300    R(4)            4           scalar   COM              20318                             

Page 582         Source Listing                  HEDCHK
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XMRZ                       Local  20313    R(4)            4           scalar   SAVE             20313,20316,20318,20323,20324     
 XMXX                       Scalar 20301    R(4)            4           scalar   COM              20338,20344                       
 XMXXZ                      Local  20335    R(4)            4           scalar   SAVE             20335,20338,20343                 
 XSTM                       Scalar 20295    R(4)            4     1     20       COM                                                
 XSTM0                      Scalar 20297    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 20301    R(4)            4     1     4        COM                                                
 XYBCWZ                     Local  20302    R(4)            4     1     4        SAVE             20314                             
 XYDCWL                     Scalar 20301    R(4)            4     1     2        COM                                                
 XYDCWZ                     Local  20302    R(4)            4     1     2        SAVE             20314                             
 XYT                        Common 20295                                64432    SAVE                                               
 YN1                        Scalar 20301    R(4)            4           scalar   COM                                                
 YNB                        Scalar 20300    R(4)            4           scalar   COM              20319,20324,20339,20344           
 YNBZ                       Local  20313    R(4)            4           scalar   SAVE             20313,20319,20323,20336,20339,2034
                                                                                                  3                                 
 YNT                        Scalar 20300    R(4)            4           scalar   COM              20319,20324,20340,20344           
 YNTZ                       Local  20313    R(4)            4           scalar   SAVE             20313,20319,20323,20336,20340,2034
                                                                                                  3                                 
 YNXX                       Scalar 20301    R(4)            4           scalar   COM              20339,20344                       
 YNXXZ                      Local  20336    R(4)            4           scalar   SAVE             20336,20339,20343                 
 YSTM                       Scalar 20295    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 20297    R(4)            4           scalar   COM                                                

Page 583         Source Listing                  HEDCHK
2017-04-18 11:09                                 syndata.f

  20353 
  20354 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20355 C                .      .    .                                       .
  20356 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20357 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20358 C
  20359 C ABSTRACT: ??????????????????????????????????????????????????????????
  20360 C   ??????????????????????????????????????????????????????????????????
  20361 C
  20362 C PROGRAM HISTORY LOG:
  20363 C ????-??-??  S. J. LORD
  20364 C
  20365 C USAGE:    CALL ????????(????)
  20366 C   INPUT ARGUMENT LIST:
  20367 C     ??????   - ???????????????????????????????????????????????
  20368 C
  20369 C   OUTPUT ARGUMENT LIST:
  20370 C     ??????   - ???????????????????????????????????????????????
  20371 C
  20372 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20373 C     ??????   - ???????????????????????????????????????????????
  20374 C
  20375 C   OUTPUT FILES:
  20376 C     ??????   - ???????????????????????????????????????????????
  20377 C
  20378 C REMARKS: ?????????????????????????????????????????????????????
  20379 C
  20380 C ATTRIBUTES:
  20381 C   LANGUAGE: FORTRAN 90
  20382 C   MACHINE:  NCEP WCOSS
  20383 C
  20384 C$$$
  20385       SUBROUTINE CSGNLN(NFIX)
  20386 C
  20387       PARAMETER (LDXDIM=8000)
  20388       PARAMETER (NFXDIM=20)
  20389 C
  20390       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  20391      1               ID(LDXDIM),LXSORT(LDXDIM)
  20392       COMMON/XYT/IDAYOB(LDXDIM),UTCOB(LDXDIM),XSTM(NFXDIM),YSTM(NFXDIM),
  20393      1            WSTM(NFXDIM),IDAYST(NFXDIM),UTCSTM(NFXDIM),
  20394      2            ELORG,GLORG,XSTM0,YSTM0,JDAY0,UTC0,NFIX0,IDAYMN
  20395 C
  20396       CHARACTER*8 IDSPD1,IDSPD2*72
  20397 C
  20398 C     TRANSFORMATION FOR DATA POINTS
  20399 C
  20400       DO 10 LD=1,LDX
  20401       XD(LD)=-XD(LD)
  20402    10 CONTINUE
  20403 C
  20404 C     TRANSFORMATION FOR STORM FIXES
  20405 C
  20406       DO 20 N=1,NFIX
  20407       XSTM(N)=-XSTM(N)
  20408    20 CONTINUE
  20409       RETURN

Page 584         Source Listing                  CSGNLN
2017-04-18 11:09                                 syndata.f

  20410       END


ENTRY POINTS

  Name               
                     
 csgnln_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  20402                                                          20400                             
 20                         Label  20408                                                          20406                             
 CSGNLN                     Subr   20385                                                                                            
 ELORG                      Scalar 20394    R(4)            4           scalar   COM                                                
 GLORG                      Scalar 20394    R(4)            4           scalar   COM                                                
 ID                         Scalar 20391    I(4)            4     1     8000     COM                                                
 IDAYMN                     Scalar 20394    I(4)            4           scalar   COM                                                
 IDAYOB                     Scalar 20392    I(4)            4     1     8000     COM                                                
 IDAYST                     Scalar 20393    I(4)            4     1     20       COM                                                
 IDSPD1                     Scalar 20390    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 20390    CHAR            72          scalar   COM                                                
 JDAY0                      Scalar 20394    I(4)            4           scalar   COM                                                
 LD                         Local  20400    I(4)            4           scalar                    20400,20401                       
 LDX                        Scalar 20390    I(4)            4           scalar   COM              20400                             
 LDXDIM                     Param  20387    I(4)            4           scalar                    20390,20391,20392                 
 LXSORT                     Scalar 20391    I(4)            4     1     8000     COM                                                
 N                          Local  20406    I(4)            4           scalar                    20406,20407                       
 NFIX                       Dummy  20385    I(4)            4           scalar   ARG,INOUT        20406                             
 NFIX0                      Scalar 20394    I(4)            4           scalar   COM                                                
 NFXDIM                     Param  20388    I(4)            4           scalar                    20392,20393                       
 S2DTPT                     Common 20390                                160084                                                      
 UTC0                       Scalar 20394    R(4)            4           scalar   COM                                                
 UTCOB                      Scalar 20392    R(4)            4     1     8000     COM                                                
 UTCSTM                     Scalar 20393    R(4)            4     1     20       COM                                                
 WD                         Scalar 20390    R(4)            4     1     8000     COM                                                
 WSTM                       Scalar 20393    R(4)            4     1     20       COM                                                
 XD                         Scalar 20390    R(4)            4     1     8000     COM              20401                             
 XSTM                       Scalar 20392    R(4)            4     1     20       COM              20407                             
 XSTM0                      Scalar 20394    R(4)            4           scalar   COM                                                
 XYT                        Common 20392                                64432                                                       
 YD                         Scalar 20390    R(4)            4     1     8000     COM                                                
 YSTM                       Scalar 20392    R(4)            4     1     20       COM                                                
 YSTM0                      Scalar 20394    R(4)            4           scalar   COM                                                

Page 585         Source Listing                  CSGNLN
2017-04-18 11:09                                 syndata.f

  20411 
  20412 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20413 C                .      .    .                                       .
  20414 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20415 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20416 C
  20417 C ABSTRACT: ??????????????????????????????????????????????????????????
  20418 C   ??????????????????????????????????????????????????????????????????
  20419 C
  20420 C PROGRAM HISTORY LOG:
  20421 C ????-??-??  S. J. LORD
  20422 C
  20423 C USAGE:    CALL ????????(????)
  20424 C   INPUT ARGUMENT LIST:
  20425 C     ??????   - ???????????????????????????????????????????????
  20426 C
  20427 C   OUTPUT ARGUMENT LIST:
  20428 C     ??????   - ???????????????????????????????????????????????
  20429 C
  20430 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20431 C     ??????   - ???????????????????????????????????????????????
  20432 C
  20433 C   OUTPUT FILES:
  20434 C     ??????   - ???????????????????????????????????????????????
  20435 C
  20436 C REMARKS: ?????????????????????????????????????????????????????
  20437 C
  20438 C ATTRIBUTES:
  20439 C   LANGUAGE: FORTRAN 90
  20440 C   MACHINE:  NCEP WCOSS
  20441 C
  20442 C$$$
  20443       SUBROUTINE SIMCON(SECVAR,MAXFND,XCTR,YCTR,RAD,A,KDX1,KDX2,VALMN,
  20444      1                  IOPT,MWAVES)
  20445 C
  20446       PARAMETER (MDIM=35,NDIM=35)
  20447       PARAMETER (KLDIM= 8)
  20448       PARAMETER (KDTDIM=5)
  20449       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  20450 C
  20451       SAVE
  20452 C
  20453       DIMENSION A(KDXDIM,MDIM,NDIM)
  20454       COMPLEX(8) VERT(3),RVERT,XVERT,CVERT,SVERT(3)
  20455       REAL LEGAR(3),RLEG,XLEG,CLEG,RCOEF,XCOEF,CCOEF,SCOEF
  20456       LOGICAL DONE,DOIT,MAXFND,SECVAR
  20457       CHARACTER*3 CMXN
  20458       DATA RCOEF,XCOEF,CCOEF,SCOEF/-1.0,-2.0,0.5,0.5/
  20459 C
  20460       WRITE(6,11)  MAXFND,IOPT,MWAVES
  20461    11 FORMAT(/'...ENTERING SIMCON WITH MAXFND,IOPT,MWAVES=',L2,2I4)
  20462       CALL SETSIM(SECVAR,MAXFND,XCTR,YCTR,RAD,A,KDX1,KDX2,IOPT,MWAVES,
  20463      1            VERT,LEGAR,DONE,IBST,IWST,KOUNT,CMXN)
  20464 CIBM  DO WHILE (.NOT. DONE)
  20465       DO 1000 IZZZ=1,99
  20466       IF(DONE)  GO TO 1100
  20467         KOUNT = KOUNT + 1

Page 586         Source Listing                  SIMCON
2017-04-18 11:09                                 syndata.f

  20468         CALL SIZE(VERT,RVERT,RCOEF,IBST,IWST)
  20469         CALL ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,RVERT,RLEG)
  20470         IF (DOIT(RLEG,LEGAR(IBST))) THEN
  20471           CALL SIZE(VERT,XVERT,XCOEF,IBST,IWST)
  20472           CALL ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,XVERT,XLEG)
  20473         IF (DOIT(XLEG,LEGAR(IBST))) THEN
  20474           CALL STASH(VERT,LEGAR,XVERT,XLEG,IWST)
  20475         ELSE
  20476         CALL STASH(VERT,LEGAR,RVERT,RLEG,IWST)
  20477         ENDIF
  20478         ELSE IF(DOIT(RLEG,LEGAR(2)))THEN
  20479           CALL STASH(VERT,LEGAR,RVERT,RLEG,IWST)
  20480         ELSE
  20481           IF (DOIT(RLEG,LEGAR(IWST))) THEN
  20482        CALL STASH(VERT,LEGAR,RVERT,RLEG,IWST)
  20483        ENDIF
  20484        CALL SIZE(VERT,CVERT,CCOEF,IBST,IWST)
  20485        CALL ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,CVERT,CLEG)
  20486        IF(DOIT(CLEG,LEGAR(IWST)))THEN
  20487          CALL STASH(VERT,LEGAR,CVERT,CLEG,IWST)
  20488        ELSE
  20489          CALL SHRINK(VERT,SVERT,SCOEF,IBST,IWST)
  20490          CALL ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,SVERT(2),LEGAR(2))
  20491          VERT(2) = SVERT(2)
  20492          CALL ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,SVERT(IWST),
  20493      1               LEGAR(IWST))
  20494          VERT(IWST) = SVERT(IWST)
  20495         ENDIF
  20496       ENDIF
  20497       CALL RNKVRT(VERT,LEGAR)
  20498       CALL CONTST(KOUNT,DONE,VERT)
  20499 c && 2 comments
  20500 CC      WRITE(6,21) KOUNT,LEGAR(IBST),VERT(IBST)
  20501 CC21    FORMAT(' ITER:',I4,'; MIN/MAX VALUE: ',F12.5,' AT ', 2F12.7)
  20502         VALMN=LEGAR(IBST)
  20503         XCTR=REAL(VERT(IBST))
  20504         YCTR=AIMAG(VERT(IBST))
  20505  1000 CONTINUE
  20506       WRITE(6,1001)
  20507  1001 FORMAT('**** SIMPLEX DID NOT CONVERGE AFTER 99 ITERATIONS')
  20508 CIBM  ENDDO
  20509  1100 CONTINUE
  20510       RETURN
  20511       END

Page 587         Source Listing                  SIMCON
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 simcon_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1000                       Label  20505                                                          20465                             
 1001                       Label  20507                                                          20506                             
 11                         Label  20461                                                          20460                             
 1100                       Label  20509                                                          20466                             
 A                          Dummy  20443    R(4)            4     3     49000    ARG,INOUT        20462,20469,20472,20485,20490,2049
                                                                                                  2                                 
 AIMAG                      Func   20504                                scalar                    20504                             
 ALSAND                     Subr   20469                                                          20469,20472,20485,20490,20492     
 CCOEF                      Local  20455    R(4)            4           scalar   SAVE             20458,20484                       
 CLEG                       Local  20455    R(4)            4           scalar   SAVE             20485,20486,20487                 
 CMXN                       Local  20457    CHAR            3           scalar   SAVE             20463                             
 CONTST                     Subr   20498                                                          20498                             
 CVERT                      Local  20454    C(16)           16          scalar   SAVE             20484,20485,20487                 
 DOIT                       Func   20456    L(4)            4           scalar                    20470,20473,20478,20481,20486     
 DONE                       Local  20456    L(4)            4           scalar   SAVE             20463,20466,20498                 
 IBST                       Local  20463    I(4)            4           scalar   SAVE             20463,20468,20470,20471,20473,2048
                                                                                                  4,20489,20502,20503,20504         
 IOPT                       Dummy  20444    I(4)            4           scalar   ARG,INOUT        20460,20462,20469,20472,20485,2049
                                                                                                  0,20492                           
 IWST                       Local  20463    I(4)            4           scalar   SAVE             20463,20468,20471,20474,20476,2047
                                                                                                  9,20481,20482,20484,20486,20487,20
                                                                                                  489,20492,20493,20494             
 IZZZ                       Local  20465    I(4)            4           scalar   SAVE             20465                             
 KDTDIM                     Param  20448    I(4)            4           scalar                    20449                             
 KDX1                       Dummy  20443    I(4)            4           scalar   ARG,INOUT        20462,20469,20472,20485,20490,2049
                                                                                                  2                                 
 KDX2                       Dummy  20443    I(4)            4           scalar   ARG,INOUT        20462,20469,20472,20485,20490,2049
                                                                                                  2                                 
 KDXDIM                     Param  20449    I(4)            4           scalar                    20453                             
 KLDIM                      Param  20447    I(4)            4           scalar                    20449                             
 KOUNT                      Local  20463    I(4)            4           scalar   SAVE             20463,20467,20498                 
 LEGAR                      Local  20455    R(4)            4     1     3        SAVE             20463,20470,20473,20474,20476,2047
                                                                                                  8,20479,20481,20482,20486,20487,20
                                                                                                  490,20493,20497,20502             
 MAXFND                     Dummy  20443    L(4)            4           scalar   ARG,INOUT        20460,20462                       
 MDIM                       Param  20446    I(4)            4           scalar                    20453                             
 MWAVES                     Dummy  20444    I(4)            4           scalar   ARG,INOUT        20460,20462,20469,20472,20485,2049
                                                                                                  0,20492                           
 NDIM                       Param  20446    I(4)            4           scalar                    20453                             
 RAD                        Dummy  20443    R(4)            4           scalar   ARG,INOUT        20462                             
 RCOEF                      Local  20455    R(4)            4           scalar   SAVE             20458,20468                       
 REAL                       Func   20503                                scalar                    20503                             
 RLEG                       Local  20455    R(4)            4           scalar   SAVE             20469,20470,20476,20478,20479,2048
                                                                                                  1,20482                           

Page 588         Source Listing                  SIMCON
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RNKVRT                     Subr   20497                                                          20497                             
 RVERT                      Local  20454    C(16)           16          scalar   SAVE             20468,20469,20476,20479,20482     
 SCOEF                      Local  20455    R(4)            4           scalar   SAVE             20458,20489                       
 SECVAR                     Dummy  20443    L(4)            4           scalar   ARG,INOUT        20462,20469,20472,20485,20490,2049
                                                                                                  2                                 
 SETSIM                     Subr   20462                                                          20462                             
 SHRINK                     Subr   20489                                                          20489                             
 SIMCON                     Subr   20443                                                                                            
 SIZE                       Subr   20468                                                          20468,20471,20484                 
 STASH                      Subr   20474                                                          20474,20476,20479,20482,20487     
 SVERT                      Local  20454    C(16)           16    1     3        SAVE             20489,20490,20491,20492,20494     
 VALMN                      Dummy  20443    R(4)            4           scalar   ARG,INOUT        20502                             
 VERT                       Local  20454    C(16)           16    1     3        SAVE             20463,20468,20471,20474,20476,2047
                                                                                                  9,20482,20484,20487,20489,20491,20
                                                                                                  494,20497,20498,20503,20504       
 XCOEF                      Local  20455    R(4)            4           scalar   SAVE             20458,20471                       
 XCTR                       Dummy  20443    R(4)            4           scalar   ARG,INOUT        20462,20503                       
 XLEG                       Local  20455    R(4)            4           scalar   SAVE             20472,20473,20474                 
 XVERT                      Local  20454    C(16)           16          scalar   SAVE             20471,20472,20474                 
 YCTR                       Dummy  20443    R(4)            4           scalar   ARG,INOUT        20462,20504                       

Page 589         Source Listing                  SIMCON
2017-04-18 11:09                                 syndata.f

  20512 
  20513 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20514 C                .      .    .                                       .
  20515 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20516 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20517 C
  20518 C ABSTRACT: ??????????????????????????????????????????????????????????
  20519 C   ??????????????????????????????????????????????????????????????????
  20520 C
  20521 C PROGRAM HISTORY LOG:
  20522 C ????-??-??  S. J. LORD
  20523 C
  20524 C USAGE:    CALL ????????(????)
  20525 C   INPUT ARGUMENT LIST:
  20526 C     ??????   - ???????????????????????????????????????????????
  20527 C
  20528 C   OUTPUT ARGUMENT LIST:
  20529 C     ??????   - ???????????????????????????????????????????????
  20530 C
  20531 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20532 C     ??????   - ???????????????????????????????????????????????
  20533 C
  20534 C   OUTPUT FILES:
  20535 C     ??????   - ???????????????????????????????????????????????
  20536 C
  20537 C REMARKS: ?????????????????????????????????????????????????????
  20538 C
  20539 C ATTRIBUTES:
  20540 C   LANGUAGE: FORTRAN 90
  20541 C   MACHINE:  NCEP WCOSS
  20542 C
  20543 C$$$
  20544       SUBROUTINE SETSIM(SECVAR,MAXFND,XCTR,YCTR,RAD,A,KDX1,KDX2,IOPT,
  20545      1                  MWAVES,VERT,LEGAR,DONE,IBST,IWST,KOUNT,CMXN)
  20546 C
  20547       SAVE
  20548 C
  20549       PARAMETER (MDIM=35,NDIM=35)
  20550       PARAMETER (KLDIM= 8)
  20551       PARAMETER (KDTDIM=5)
  20552       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  20553       DIMENSION A(KDXDIM,MDIM,NDIM)
  20554 C
  20555       COMMON/CRITR/EPS,ITMAX
  20556       COMMON /MAXMIN/PMAX
  20557 C
  20558       COMPLEX(8) VERT(3),AI
  20559       CHARACTER*3 CMXN
  20560       REAL LEGAR(3),SQR32,XCTR,YCTR,RAD
  20561       LOGICAL DONE,PMAX,MAXFND,SECVAR
  20562       DATA SQR32/0.866025/
  20563 C
  20564       DONE = .FALSE.
  20565       PMAX = .FALSE.
  20566       IF(MAXFND)  PMAX = .TRUE.
  20567       IF (PMAX)THEN
  20568         IBST = 3

Page 590         Source Listing                  SETSIM
2017-04-18 11:09                                 syndata.f

  20569         IWST = 1
  20570         CMXN = 'MAX'
  20571       ELSE
  20572         IBST = 1
  20573         IWST = 3
  20574         CMXN = 'MIN'
  20575       ENDIF
  20576       KOUNT = 0
  20577 C
  20578 C     INITIAL VERTICES ARE AT THE POINTS OF AN EQUILATERAL TRIANGLE
  20579 C
  20580       AI=(0,1.0)
  20581       VERT(1) = XCTR+AI*(YCTR+RAD)
  20582       VERT(2) = XCTR+SQR32*RAD+AI*(YCTR-0.5*RAD)
  20583       VERT(3) = XCTR-SQR32*RAD+AI*(YCTR-0.5*RAD)
  20584 C
  20585       IF(IOPT .LT. 0)  THEN
  20586       IOPTZ=IABS(IOPT)
  20587       IMFLTP=IOPTZ/10
  20588 C
  20589 C     WARNING:  HARDWIRED ASSUMPTIONS ABOUT FILE TYPES ARE GIVEN HERE
  20590 C               IMFLTP=1: COEFFICIENTS OF U,V WIND
  20591 C               IMFLTP=2: COEFFICIENTS OF VORT, DIV.
  20592 C
  20593       IF(IMFLTP .EQ. 1)  THEN
  20594       IPLUS=1
  20595       ITRNC=1
  20596       ELSE IF(IMFLTP .EQ. 2)  THEN
  20597       IPLUS=0
  20598       ITRNC=0
  20599       ENDIF
  20600       CALL SETTRN(KDX2,KDX1,MWAVES,IPLUS,ITRNC)
  20601       ENDIF
  20602 C
  20603       EPS = 0.045
  20604       ITMAX = 40
  20605       DO 99 I = 1,3
  20606         CALL ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,VERT(I),LEGAR(I))
  20607 c && 3 comments
  20608 CC    WRITE(6,9981) I,KDX1,KDX2,IOPT,MWAVES,VERT(I),LEGAR(I)
  20609 C9981 FORMAT('...IN SETSIM, I,KDX1,KDX2,IOPT,MWAVES,VERT,LEGAR=',
  20610 CC   1       5I5,/,4X,4F10.3)
  20611 CIBM  ENDDO
  20612    99 CONTINUE
  20613       CALL RNKVRT(VERT,LEGAR)
  20614       RETURN
  20615       END

Page 591         Source Listing                  SETSIM
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 setsim_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 99                         Label  20612                                                          20605                             
 A                          Dummy  20544    R(4)            4     3     49000    ARG,INOUT        20606                             
 AI                         Local  20558    C(16)           16          scalar   SAVE             20580,20581,20582,20583           
 ALSAND                     Subr   20606                                                          20606                             
 CMXN                       Dummy  20545    CHAR            3           scalar   ARG,INOUT        20570,20574                       
 CRITR                      Common 20555                                8        SAVE                                               
 DONE                       Dummy  20545    L(4)            4           scalar   ARG,INOUT        20564                             
 EPS                        Scalar 20555    R(4)            4           scalar   COM              20603                             
 I                          Local  20605    I(4)            4           scalar   SAVE             20605,20606                       
 IABS                       Func   20586                                scalar                    20586                             
 IBST                       Dummy  20545    I(4)            4           scalar   ARG,INOUT        20568,20572                       
 IMFLTP                     Local  20587    I(4)            4           scalar   SAVE             20587,20593,20596                 
 IOPT                       Dummy  20544    I(4)            4           scalar   ARG,INOUT        20585,20586,20606                 
 IOPTZ                      Local  20586    I(4)            4           scalar   SAVE             20586,20587                       
 IPLUS                      Local  20594    I(4)            4           scalar   SAVE             20594,20597,20600                 
 ITMAX                      Scalar 20555    I(4)            4           scalar   COM              20604                             
 ITRNC                      Local  20595    I(4)            4           scalar   SAVE             20595,20598,20600                 
 IWST                       Dummy  20545    I(4)            4           scalar   ARG,INOUT        20569,20573                       
 KDTDIM                     Param  20551    I(4)            4           scalar                    20552                             
 KDX1                       Dummy  20544    I(4)            4           scalar   ARG,INOUT        20600,20606                       
 KDX2                       Dummy  20544    I(4)            4           scalar   ARG,INOUT        20600,20606                       
 KDXDIM                     Param  20552    I(4)            4           scalar                    20553                             
 KLDIM                      Param  20550    I(4)            4           scalar                    20552                             
 KOUNT                      Dummy  20545    I(4)            4           scalar   ARG,INOUT        20576                             
 LEGAR                      Dummy  20545    R(4)            4     1     3        ARG,INOUT        20606,20613                       
 MAXFND                     Dummy  20544    L(4)            4           scalar   ARG,INOUT        20566                             
 MAXMIN                     Common 20556                                4        SAVE                                               
 MDIM                       Param  20549    I(4)            4           scalar                    20553                             
 MWAVES                     Dummy  20545    I(4)            4           scalar   ARG,INOUT        20600,20606                       
 NDIM                       Param  20549    I(4)            4           scalar                    20553                             
 PMAX                       Scalar 20556    L(4)            4           scalar   COM              20565,20566,20567                 
 RAD                        Dummy  20544    R(4)            4           scalar   ARG,INOUT        20581,20582,20583                 
 RNKVRT                     Subr   20613                                                          20613                             
 SECVAR                     Dummy  20544    L(4)            4           scalar   ARG,INOUT        20606                             
 SETSIM                     Subr   20544                                                                                            
 SETTRN                     Subr   20600                                                          20600                             
 SQR32                      Local  20560    R(4)            4           scalar   SAVE             20562,20582,20583                 
 VERT                       Dummy  20545    C(16)           16    1     3        ARG,INOUT        20581,20582,20583,20606,20613     
 XCTR                       Dummy  20544    R(4)            4           scalar   ARG,INOUT        20581,20582,20583                 
 YCTR                       Dummy  20544    R(4)            4           scalar   ARG,INOUT        20581,20582,20583                 

Page 592         Source Listing                  SETSIM
2017-04-18 11:09                                 syndata.f

  20616 
  20617 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20618 C                .      .    .                                       .
  20619 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20620 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20621 C
  20622 C ABSTRACT: ??????????????????????????????????????????????????????????
  20623 C   ??????????????????????????????????????????????????????????????????
  20624 C
  20625 C PROGRAM HISTORY LOG:
  20626 C ????-??-??  S. J. LORD
  20627 C
  20628 C USAGE:    CALL ????????(????)
  20629 C   INPUT ARGUMENT LIST:
  20630 C     ??????   - ???????????????????????????????????????????????
  20631 C
  20632 C   OUTPUT ARGUMENT LIST:
  20633 C     ??????   - ???????????????????????????????????????????????
  20634 C
  20635 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20636 C     ??????   - ???????????????????????????????????????????????
  20637 C
  20638 C   OUTPUT FILES:
  20639 C     ??????   - ???????????????????????????????????????????????
  20640 C
  20641 C REMARKS: ?????????????????????????????????????????????????????
  20642 C
  20643 C ATTRIBUTES:
  20644 C   LANGUAGE: FORTRAN 90
  20645 C   MACHINE:  NCEP WCOSS
  20646 C
  20647 C$$$
  20648       SUBROUTINE RNKVRT(VERT,LEGAR)
  20649       COMPLEX(8) VERT(3),TVERT
  20650       REAL LEGAR(3),TLEG
  20651 C
  20652       SAVE
  20653 C
  20654       DO 199 I = 1,3
  20655         DO 99 J= 1,2
  20656           IF (LEGAR(J) .GT. LEGAR(J+1)) THEN
  20657             TVERT = VERT(J)
  20658             TLEG = LEGAR(J)
  20659             VERT(J) = VERT(J+1)
  20660             LEGAR(J) = LEGAR(J+1)
  20661             VERT(J+1) = TVERT
  20662             LEGAR(J+1) = TLEG
  20663           ENDIF
  20664 CIBMNDDO
  20665 CIBM  ENDDO
  20666   99  CONTINUE
  20667  199  CONTINUE
  20668 C
  20669 c && 4 comments
  20670 CC    DO I = 1,3
  20671 CC       WRITE(6,10)I,VERT(I),LEGAR(I)
  20672 CC    ENDDO

Page 593         Source Listing                  RNKVRT
2017-04-18 11:09                                 syndata.f

  20673 CC10  FORMAT(' RNKVRT: VERTEX# ',I2,' VERT = ',2F10.5,' LEGAR = ',G12.5)
  20674       RETURN
  20675       END


ENTRY POINTS

  Name               
                     
 rnkvrt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 199                        Label  20667                                                          20654                             
 99                         Label  20666                                                          20655                             
 I                          Local  20654    I(4)            4           scalar   SAVE             20654                             
 J                          Local  20655    I(4)            4           scalar   SAVE             20655,20656,20657,20658,20659,2066
                                                                                                  0,20661,20662                     
 LEGAR                      Dummy  20648    R(4)            4     1     3        ARG,INOUT        20656,20658,20660,20662           
 RNKVRT                     Subr   20648                                                                                            
 TLEG                       Local  20650    R(4)            4           scalar   SAVE             20658,20662                       
 TVERT                      Local  20649    C(16)           16          scalar   SAVE             20657,20661                       
 VERT                       Dummy  20648    C(16)           16    1     3        ARG,INOUT        20657,20659,20661                 

Page 594         Source Listing                  RNKVRT
2017-04-18 11:09                                 syndata.f

  20676 
  20677 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20678 C                .      .    .                                       .
  20679 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20680 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20681 C
  20682 C ABSTRACT: ??????????????????????????????????????????????????????????
  20683 C   ??????????????????????????????????????????????????????????????????
  20684 C
  20685 C PROGRAM HISTORY LOG:
  20686 C ????-??-??  S. J. LORD
  20687 C
  20688 C USAGE:    CALL ????????(????)
  20689 C   INPUT ARGUMENT LIST:
  20690 C     ??????   - ???????????????????????????????????????????????
  20691 C
  20692 C   OUTPUT ARGUMENT LIST:
  20693 C     ??????   - ???????????????????????????????????????????????
  20694 C
  20695 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20696 C     ??????   - ???????????????????????????????????????????????
  20697 C
  20698 C   OUTPUT FILES:
  20699 C     ??????   - ???????????????????????????????????????????????
  20700 C
  20701 C REMARKS: ?????????????????????????????????????????????????????
  20702 C
  20703 C ATTRIBUTES:
  20704 C   LANGUAGE: FORTRAN 90
  20705 C   MACHINE:  NCEP WCOSS
  20706 C
  20707 C$$$
  20708       SUBROUTINE STASH(VERT,LEGAR,NVERT,NLEG,IWST)
  20709       COMPLEX(8) VERT(3),NVERT
  20710       REAL LEGAR(3),NLEG
  20711 C
  20712       SAVE
  20713 C
  20714 c && 1 comment
  20715 CC    WRITE(6,9)VERT(IWST),LEGAR(IWST)
  20716 C
  20717       VERT(IWST) = NVERT
  20718       LEGAR(IWST) = NLEG
  20719 C
  20720 c && 3 comments
  20721 CC    WRITE(6,10)VERT(IWST),LEGAR(IWST)
  20722 CC  9 FORMAT(' STASH: OLD VERT(IWST) AND LEGAR(IWST) ',2F10.5,G12.5)
  20723 CC 10 FORMAT(' STASH: NEW VERT(IWST) AND LEGAR(IWST) ',2F10.5,G12.5)
  20724 C
  20725       RETURN
  20726       END

Page 595         Source Listing                  STASH
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name              
                    
 stash_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IWST                       Dummy  20708    I(4)            4           scalar   ARG,INOUT        20717,20718                       
 LEGAR                      Dummy  20708    R(4)            4     1     3        ARG,INOUT        20718                             
 NLEG                       Dummy  20708    R(4)            4           scalar   ARG,INOUT        20718                             
 NVERT                      Dummy  20708    C(16)           16          scalar   ARG,INOUT        20717                             
 STASH                      Subr   20708                                                                                            
 VERT                       Dummy  20708    C(16)           16    1     3        ARG,INOUT        20717                             

Page 596         Source Listing                  STASH
2017-04-18 11:09                                 syndata.f

  20727 
  20728 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20729 C                .      .    .                                       .
  20730 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20731 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20732 C
  20733 C ABSTRACT: ??????????????????????????????????????????????????????????
  20734 C   ??????????????????????????????????????????????????????????????????
  20735 C
  20736 C PROGRAM HISTORY LOG:
  20737 C ????-??-??  S. J. LORD
  20738 C
  20739 C USAGE:    CALL ????????(????)
  20740 C   INPUT ARGUMENT LIST:
  20741 C     ??????   - ???????????????????????????????????????????????
  20742 C
  20743 C   OUTPUT ARGUMENT LIST:
  20744 C     ??????   - ???????????????????????????????????????????????
  20745 C
  20746 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20747 C     ??????   - ???????????????????????????????????????????????
  20748 C
  20749 C   OUTPUT FILES:
  20750 C     ??????   - ???????????????????????????????????????????????
  20751 C
  20752 C REMARKS: ?????????????????????????????????????????????????????
  20753 C
  20754 C ATTRIBUTES:
  20755 C   LANGUAGE: FORTRAN 90
  20756 C   MACHINE:  NCEP WCOSS
  20757 C
  20758 C$$$
  20759       SUBROUTINE SIZE(VERT,NVERT,COEF,IBST,IWST)
  20760       COMPLEX(8) VERT(3),NVERT,BVERT
  20761 C
  20762       SAVE
  20763 C
  20764       BVERT = 0.5 * (VERT(IBST) + VERT(2))
  20765       NVERT = BVERT + COEF*(VERT(IWST)-BVERT)
  20766 C
  20767 c && 2 comments
  20768 CC    WRITE(6,10)COEF,VERT(IWST),NVERT
  20769 CC 10 FORMAT(' SIZE: COEF =',F10.5,' OLD =',2F10.5,' NEW =',2F10.5)
  20770 C
  20771       RETURN
  20772       END

Page 597         Source Listing                  SIZE
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name             
                   
 size_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BVERT                      Local  20760    C(16)           16          scalar   SAVE             20764,20765                       
 COEF                       Dummy  20759    R(4)            4           scalar   ARG,INOUT        20765                             
 IBST                       Dummy  20759    I(4)            4           scalar   ARG,INOUT        20764                             
 IWST                       Dummy  20759    I(4)            4           scalar   ARG,INOUT        20765                             
 NVERT                      Dummy  20759    C(16)           16          scalar   ARG,INOUT        20765                             
 SIZE                       Subr   20759                                                                                            
 VERT                       Dummy  20759    C(16)           16    1     3        ARG,INOUT        20764,20765                       

Page 598         Source Listing                  SIZE
2017-04-18 11:09                                 syndata.f

  20773 
  20774 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20775 C                .      .    .                                       .
  20776 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20777 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20778 C
  20779 C ABSTRACT: ??????????????????????????????????????????????????????????
  20780 C   ??????????????????????????????????????????????????????????????????
  20781 C
  20782 C PROGRAM HISTORY LOG:
  20783 C ????-??-??  S. J. LORD
  20784 C
  20785 C USAGE:    CALL ????????(????)
  20786 C   INPUT ARGUMENT LIST:
  20787 C     ??????   - ???????????????????????????????????????????????
  20788 C
  20789 C   OUTPUT ARGUMENT LIST:
  20790 C     ??????   - ???????????????????????????????????????????????
  20791 C
  20792 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20793 C     ??????   - ???????????????????????????????????????????????
  20794 C
  20795 C   OUTPUT FILES:
  20796 C     ??????   - ???????????????????????????????????????????????
  20797 C
  20798 C REMARKS: ?????????????????????????????????????????????????????
  20799 C
  20800 C ATTRIBUTES:
  20801 C   LANGUAGE: FORTRAN 90
  20802 C   MACHINE:  NCEP WCOSS
  20803 C
  20804 C$$$
  20805       SUBROUTINE SHRINK(VERT,SVERT,SCOEF,IBST,IWST)
  20806       COMPLEX(8) VERT(3),SVERT(3)
  20807 C
  20808       SAVE
  20809 C
  20810       SVERT(2)=VERT(IBST)+SCOEF*(VERT(2)-VERT(IBST))
  20811 C
  20812 c && 1 comment
  20813 CC    WRITE(6,10)2,VERT(2),SVERT(2)
  20814 C
  20815       SVERT(IWST)=VERT(IBST)+SCOEF*(VERT(IWST)-VERT(IBST))
  20816 C
  20817 c && 2 comments
  20818 CC    WRITE(6,10)IWST,VERT(IWST),SVERT(IWST)
  20819 CC 10 FORMAT(' SHRINK: VERTEX#',I2,' OLD =',2F10.5,' NEW =',2F10.5)
  20820 C
  20821       RETURN
  20822       END

Page 599         Source Listing                  SHRINK
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 shrink_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IBST                       Dummy  20805    I(4)            4           scalar   ARG,INOUT        20810,20815                       
 IWST                       Dummy  20805    I(4)            4           scalar   ARG,INOUT        20815                             
 SCOEF                      Dummy  20805    R(4)            4           scalar   ARG,INOUT        20810,20815                       
 SHRINK                     Subr   20805                                                                                            
 SVERT                      Dummy  20805    C(16)           16    1     3        ARG,INOUT        20810,20815                       
 VERT                       Dummy  20805    C(16)           16    1     3        ARG,INOUT        20810,20815                       

Page 600         Source Listing                  SHRINK
2017-04-18 11:09                                 syndata.f

  20823 
  20824 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20825 C                .      .    .                                       .
  20826 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20827 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20828 C
  20829 C ABSTRACT: ??????????????????????????????????????????????????????????
  20830 C   ??????????????????????????????????????????????????????????????????
  20831 C
  20832 C PROGRAM HISTORY LOG:
  20833 C ????-??-??  S. J. LORD
  20834 C
  20835 C USAGE:    CALL ????????(????)
  20836 C   INPUT ARGUMENT LIST:
  20837 C     ??????   - ???????????????????????????????????????????????
  20838 C
  20839 C   OUTPUT ARGUMENT LIST:
  20840 C     ??????   - ???????????????????????????????????????????????
  20841 C
  20842 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20843 C     ??????   - ???????????????????????????????????????????????
  20844 C
  20845 C   OUTPUT FILES:
  20846 C     ??????   - ???????????????????????????????????????????????
  20847 C
  20848 C REMARKS: ?????????????????????????????????????????????????????
  20849 C
  20850 C ATTRIBUTES:
  20851 C   LANGUAGE: FORTRAN 90
  20852 C   MACHINE:  NCEP WCOSS
  20853 C
  20854 C$$$
  20855       SUBROUTINE ALSAND(SECVAR,A,KDX1,KDX2,IOPT,MWAVES,VERT,LEG)
  20856 C
  20857       PARAMETER (MDIM=35,NDIM=35)
  20858       PARAMETER (KLDIM= 8)
  20859       PARAMETER (KVDIM=20,KDTDIM=5)
  20860 C**SGIPARAMETER (KVDIM= 7,KDTDIM=5)
  20861       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  20862       PARAMETER (KPXDIM=KVDIM*KLDIM)
  20863 C
  20864       SAVE
  20865 C
  20866       DIMENSION A(KDXDIM,MDIM,NDIM),SPLV(KPXDIM),AVG(KDXDIM)
  20867       LOGICAL SECVAR,PRTAZI,ANNAVG
  20868       COMPLEX(8) VERT
  20869       REAL LEG,X0,Y0
  20870       DATA PRTAZI/.FALSE./,ANNAVG/.TRUE./
  20871 C
  20872       X0 = REAL(VERT)
  20873       Y0 = AIMAG(VERT)
  20874 C
  20875 C     POSITIVE OPTIONS ARE FOR SPLINE FUNCTIONS.
  20876 C     NEGATIVE OPTIONS ARE FOR GLOBAL SPECTRAL MODEL FUNCTIONS
  20877 C
  20878 C     GO TO (10,20),IOPT
  20879       IF(IOPT .LT. 0)  THEN

Page 601         Source Listing                  ALSAND
2017-04-18 11:09                                 syndata.f

  20880       IOPTZ=IABS(IOPT)
  20881       IMFLTP=IOPTZ/10
  20882       IVAR0=IOPTZ-IMFLTP*10
  20883 C
  20884 C     WARNING:  HARDWIRED ASSUMPTIONS ABOUT FILE TYPES ARE GIVEN HERE
  20885 C               IMFLTP=1: COEFFICIENTS OF U,V WIND
  20886 C               IMFLTP=2: COEFFICIENTS OF VORT, DIV.
  20887 C
  20888       IF(IMFLTP .EQ. 1)  THEN
  20889       IPLUS=1
  20890       ITRNC=1
  20891       ELSE IF(IMFLTP .EQ. 2)  THEN
  20892       IPLUS=0
  20893       ITRNC=0
  20894       ENDIF
  20895 C
  20896 C
  20897 C     SCALARS: T, RH, Z, VORTICITY(6), DIVERGENCE(7)
  20898 C
  20899       IF(IVAR0 .LE. 3 .OR. IVAR0 .EQ. 6 .OR. IVAR0 .EQ. 7)  THEN
  20900       IF(IMFLTP .EQ. 1)  THEN
  20901       CALL SCASP1(X0,Y0,KDX1,KDX2,MWAVES,ITRNC,VALOUT)
  20902       ELSE IF(IMFLTP .EQ. 2)  THEN
  20903       CALL SCASP1(X0,Y0,KDX1,KDX2,MWAVES,ITRNC,VALOUT)
  20904 c && 3 comments
  20905 CC    WRITE(6,1293) IVAR0,KDX1,KDX2,X0,Y0,VALOUT
  20906 C1293 FORMAT('...SCASP1 CALLED, IVAR0,KDX1,KDX2,X0,Y0,VALOUT=',
  20907 CC   1       3I5,2F10.4,E12.4)
  20908       ENDIF
  20909       LEG=VALOUT
  20910 C
  20911 C     WIND: CALCULATE WIND SPEED FROM U,V ALL AT ONCE
  20912 C
  20913       ELSE IF(IVAR0 .EQ. 4)  THEN
  20914       IF(IMFLTP .EQ. 1)  THEN
  20915 c && 3 comments
  20916 CC    WRITE(6,508) KDX2,KDX1,MWAVES,IPLUS,ITRNC
  20917 CC508 FORMAT('...CALLING SETRES FOR CENTER FINDING: KL,JV,MWAVES,',
  20918 CC   1       'IPLUS,ITRNC=',5I5)
  20919       CALL SETRES(KDX2,KDX1,MWAVES,IPLUS,ITRNC)
  20920       CALL UVWSP1(X0,Y0,KDX1  ,KDX2,MWAVES,IPLUS,ITRNC,UWIND)
  20921 c && 1 comment
  20922 CC    WRITE(6,508) KDX2,KDX1,MWAVES,IPLUS,ITRNC
  20923       CALL SETRES(KDX2,KDX1+1,MWAVES,IPLUS,ITRNC)
  20924       CALL UVWSP1(X0,Y0,KDX1+1,KDX2,MWAVES,IPLUS,ITRNC,VWIND)
  20925 C
  20926       ELSE IF(IMFLTP .EQ. 2)  THEN
  20927 c && 1 comment
  20928 CC    WRITE(6,508) KDX2,KDX1,MWAVES,IPLUS,ITRNC
  20929       CALL SETRES(KDX2,KDX1,MWAVES,IPLUS,ITRNC)
  20930       CALL UVRSP2(X0,Y0,KDX1  ,KDX2,MWAVES,ITRNC,UWIND,VWIND)
  20931 c && 1 comment
  20932 CC    WRITE(6,508) KDX2,KDX1,MWAVES,IPLUS,ITRNC
  20933       CALL SETRES(KDX2,KDX1+1,MWAVES,IPLUS,ITRNC)
  20934       CALL UVDSP2(X0,Y0,KDX1+1,KDX2,MWAVES,ITRNC,UWIND,VWIND)
  20935       ENDIF
  20936       LEG=SQRT(UWIND**2+VWIND**2)

Page 602         Source Listing                  ALSAND
2017-04-18 11:09                                 syndata.f

  20937       ENDIF
  20938 C
  20939       ELSE IF(IOPT .EQ. 1)  THEN
  20940       KVZ=KDX1
  20941       KLZ=KDX2
  20942       CALL SPTVAR(SECVAR,X0,Y0,A,KVZ,KLZ,SPLV)
  20943       LEG=SPLV(KVZ)
  20944 C
  20945       ELSE IF(IOPT .EQ. 2)  THEN
  20946       IF(KDX2-KDX1 .GT. 1)  GO TO 900
  20947 C*CRAYCALL AZIAVG(A,KDX1,KDX2,X0,Y0,AVG,PRTAZI,ANNAVG)
  20948       LEG=AVG(KDX2)
  20949 C
  20950       ELSE
  20951 c && 2 comments
  20952 CC    WRITE(6,1) IOPT
  20953 CC  1 FORMAT(/'******IMPROPER OPTION IN ALSAND, IOPT=',I6)
  20954       CALL ABRT1(' ALSAND',1)
  20955       ENDIF
  20956 C
  20957 c && 5 comments
  20958 CC    WRITE(6,98) REAL(VERT),AIMAG(VERT),KDX1,KDX2,X0,Y0,LEG
  20959 CC98  FORMAT('...ALSAND, REAL(VERT),AIMAG(VERT),KDX1,KDX2,X0,Y0,LEG=',
  20960 CC   1       2F10.3,2I5,3F10.3)
  20961 CC    WRITE(6,99)VERT,LEG
  20962 CC99  FORMAT(' ALSAND: VERTEX AT ',2F10.5,' LEG = ',G12.5)
  20963       RETURN
  20964 900   WRITE(6,901) KDX1,KDX2
  20965 901   FORMAT('*****TOO MANY VARIABLES IN SIMCON, KDX1,KDX2=',2I5)
  20966       CALL ABRT1(' ALSAND',901)
  20967       END

Page 603         Source Listing                  ALSAND
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 alsand_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 900                        Label  20964                                                          20946                             
 901                        Label  20965                                                          20964                             
 A                          Dummy  20855    R(4)            4     3     49000    ARG,INOUT        20942                             
 ABRT1                      Subr   20954                                                          20954,20966                       
 AIMAG                      Func   20873                                scalar                    20873                             
 ALSAND                     Subr   20855                                                                                            
 ANNAVG                     Local  20867    L(4)            4           scalar   SAVE             20870                             
 AVG                        Local  20866    R(4)            4     1     40       SAVE             20948                             
 IABS                       Func   20880                                scalar                    20880                             
 IMFLTP                     Local  20881    I(4)            4           scalar   SAVE             20881,20882,20888,20891,20900,2090
                                                                                                  2,20914,20926                     
 IOPT                       Dummy  20855    I(4)            4           scalar   ARG,INOUT        20879,20880,20939,20945           
 IOPTZ                      Local  20880    I(4)            4           scalar   SAVE             20880,20881,20882                 
 IPLUS                      Local  20889    I(4)            4           scalar   SAVE             20889,20892,20919,20920,20923,2092
                                                                                                  4,20929,20933                     
 ITRNC                      Local  20890    I(4)            4           scalar   SAVE             20890,20893,20901,20903,20919,2092
                                                                                                  0,20923,20924,20929,20930,20933,20
                                                                                                  934                               
 IVAR0                      Local  20882    I(4)            4           scalar   SAVE             20882,20899,20913                 
 KDTDIM                     Param  20859    I(4)            4           scalar                    20861                             
 KDX1                       Dummy  20855    I(4)            4           scalar   ARG,INOUT        20901,20903,20919,20920,20923,2092
                                                                                                  4,20929,20930,20933,20934,20940,20
                                                                                                  946,20964                         
 KDX2                       Dummy  20855    I(4)            4           scalar   ARG,INOUT        20901,20903,20919,20920,20923,2092
                                                                                                  4,20929,20930,20933,20934,20941,20
                                                                                                  946,20948,20964                   
 KDXDIM                     Param  20861    I(4)            4           scalar                    20866                             
 KLDIM                      Param  20858    I(4)            4           scalar                    20861,20862                       
 KLZ                        Local  20941    I(4)            4           scalar   SAVE             20941,20942                       
 KPXDIM                     Param  20862    I(4)            4           scalar                    20866                             
 KVDIM                      Param  20859    I(4)            4           scalar                    20862                             
 KVZ                        Local  20940    I(4)            4           scalar   SAVE             20940,20942,20943                 
 LEG                        Dummy  20855    R(4)            4           scalar   ARG,INOUT        20909,20936,20943,20948           
 MDIM                       Param  20857    I(4)            4           scalar                    20866                             
 MWAVES                     Dummy  20855    I(4)            4           scalar   ARG,INOUT        20901,20903,20919,20920,20923,2092
                                                                                                  4,20929,20930,20933,20934         
 NDIM                       Param  20857    I(4)            4           scalar                    20866                             
 PRTAZI                     Local  20867    L(4)            4           scalar   SAVE             20870                             
 REAL                       Func   20872                                scalar                    20872                             
 SCASP1                     Subr   20901                                                          20901,20903                       
 SECVAR                     Dummy  20855    L(4)            4           scalar   ARG,INOUT        20942                             
 SETRES                     Subr   20919                                                          20919,20923,20929,20933           
 SPLV                       Local  20866    R(4)            4     1     160      SAVE             20942,20943                       
 SPTVAR                     Subr   20942                                                          20942                             

Page 604         Source Listing                  ALSAND
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SQRT                       Func   20936                                scalar                    20936                             
 UVDSP2                     Subr   20934                                                          20934                             
 UVRSP2                     Subr   20930                                                          20930                             
 UVWSP1                     Subr   20920                                                          20920,20924                       
 UWIND                      Local  20920    R(4)            4           scalar   SAVE             20920,20930,20934,20936           
 VALOUT                     Local  20901    R(4)            4           scalar   SAVE             20901,20903,20909                 
 VERT                       Dummy  20855    C(16)           16          scalar   ARG,INOUT        20872,20873                       
 VWIND                      Local  20924    R(4)            4           scalar   SAVE             20924,20930,20934,20936           
 X0                         Local  20869    R(4)            4           scalar   SAVE             20872,20901,20903,20920,20924,2093
                                                                                                  0,20934,20942                     
 Y0                         Local  20869    R(4)            4           scalar   SAVE             20873,20901,20903,20920,20924,2093
                                                                                                  0,20934,20942                     

Page 605         Source Listing                  ALSAND
2017-04-18 11:09                                 syndata.f

  20968 
  20969 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  20970 C                .      .    .                                       .
  20971 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  20972 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  20973 C
  20974 C ABSTRACT: ??????????????????????????????????????????????????????????
  20975 C   ??????????????????????????????????????????????????????????????????
  20976 C
  20977 C PROGRAM HISTORY LOG:
  20978 C ????-??-??  S. J. LORD
  20979 C
  20980 C USAGE:    CALL ????????(????)
  20981 C   INPUT ARGUMENT LIST:
  20982 C     ??????   - ???????????????????????????????????????????????
  20983 C
  20984 C   OUTPUT ARGUMENT LIST:
  20985 C     ??????   - ???????????????????????????????????????????????
  20986 C
  20987 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  20988 C     ??????   - ???????????????????????????????????????????????
  20989 C
  20990 C   OUTPUT FILES:
  20991 C     ??????   - ???????????????????????????????????????????????
  20992 C
  20993 C REMARKS: ?????????????????????????????????????????????????????
  20994 C
  20995 C ATTRIBUTES:
  20996 C   LANGUAGE: FORTRAN 90
  20997 C   MACHINE:  NCEP WCOSS
  20998 C
  20999 C$$$
  21000       SUBROUTINE CONTST(KOUNT,DONE,VERT)
  21001       COMPLEX(8) VERT(3)
  21002       LOGICAL DONE
  21003       COMMON/CRITR/EPS,ITMAX
  21004 C
  21005       SAVE
  21006 C
  21007       SMAX = 0.0
  21008       DO 99 I = 1,3
  21009         J = I + 1
  21010         IF (J .GT. 3) J = J - 3
  21011 cdakxxxxSS = CABS(VERT(I)-VERT(J))
  21012         SS = ABS(VERT(I)-VERT(J))
  21013         SMAX = MAX(SS,SMAX)
  21014 C
  21015 c && 2 comments
  21016 CC      WRITE(6,10)I,J,SS
  21017 CC 10 FORMAT(' CONTST: SIDE BETWEEN ',I2,' AND ',I2,' HAS LENGTH',F10.5)
  21018 C
  21019 CIBM  ENDDO
  21020    99 CONTINUE
  21021       DONE = (SMAX .LT. EPS).OR.(KOUNT.GE.ITMAX)
  21022       IF(KOUNT .GT. ITMAX) WRITE(6,11) ITMAX
  21023 11    FORMAT('**** MAX ITERATIONS (',I4,') EXCEEDED IN SIMCON')
  21024       RETURN

Page 606         Source Listing                  CONTST
2017-04-18 11:09                                 syndata.f

  21025       END


ENTRY POINTS

  Name               
                     
 contst_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  21023                                                          21022                             
 99                         Label  21020                                                          21008                             
 ABS                        Func   21012                                scalar                    21012                             
 CONTST                     Subr   21000                                                                                            
 CRITR                      Common 21003                                8        SAVE                                               
 DONE                       Dummy  21000    L(4)            4           scalar   ARG,INOUT        21021                             
 EPS                        Scalar 21003    R(4)            4           scalar   COM              21021                             
 I                          Local  21008    I(4)            4           scalar   SAVE             21008,21009,21012                 
 ITMAX                      Scalar 21003    I(4)            4           scalar   COM              21021,21022                       
 J                          Local  21009    I(4)            4           scalar   SAVE             21009,21010,21012                 
 KOUNT                      Dummy  21000    I(4)            4           scalar   ARG,INOUT        21021,21022                       
 MAX                        Func   21013                                scalar                    21013                             
 SMAX                       Local  21007    R(4)            4           scalar   SAVE             21007,21013,21021                 
 SS                         Local  21012    R(4)            4           scalar   SAVE             21012,21013                       
 VERT                       Dummy  21000    C(16)           16    1     3        ARG,INOUT        21012                             

Page 607         Source Listing                  CONTST
2017-04-18 11:09                                 syndata.f

  21026 
  21027 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  21028 C                .      .    .                                       .
  21029 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  21030 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  21031 C
  21032 C ABSTRACT: ??????????????????????????????????????????????????????????
  21033 C   ??????????????????????????????????????????????????????????????????
  21034 C
  21035 C PROGRAM HISTORY LOG:
  21036 C ????-??-??  S. J. LORD
  21037 C
  21038 C USAGE:    CALL ????????(????)
  21039 C   INPUT ARGUMENT LIST:
  21040 C     ??????   - ???????????????????????????????????????????????
  21041 C
  21042 C   OUTPUT ARGUMENT LIST:
  21043 C     ??????   - ???????????????????????????????????????????????
  21044 C
  21045 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  21046 C     ??????   - ???????????????????????????????????????????????
  21047 C
  21048 C   OUTPUT FILES:
  21049 C     ??????   - ???????????????????????????????????????????????
  21050 C
  21051 C REMARKS: ?????????????????????????????????????????????????????
  21052 C
  21053 C ATTRIBUTES:
  21054 C   LANGUAGE: FORTRAN 90
  21055 C   MACHINE:  NCEP WCOSS
  21056 C
  21057 C$$$
  21058       LOGICAL FUNCTION DOIT(ALN,ALO)
  21059       COMMON /MAXMIN/PMAX
  21060       LOGICAL PMAX
  21061       IF(PMAX) THEN
  21062         DOIT = ALN .GT. ALO
  21063       ELSE
  21064         DOIT = ALN .LT. ALO
  21065       ENDIF
  21066       RETURN
  21067       END

Page 608         Source Listing                  DOIT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name             
                   
 doit_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALN                        Dummy  21058    R(4)            4           scalar   ARG,INOUT        21062,21064                       
 ALO                        Dummy  21058    R(4)            4           scalar   ARG,INOUT        21062,21064                       
 DOIT                       Func   21058    L(4)            4           scalar                    21062,21064                       
 DOIT@0                     Local  21058    L(4)            4           scalar                                                      
 MAXMIN                     Common 21059                                4                                                           
 PMAX                       Scalar 21059    L(4)            4           scalar   COM              21061                             

Page 609         Source Listing                  DOIT
2017-04-18 11:09                                 syndata.f

  21068 
  21069 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  21070 C                .      .    .                                       .
  21071 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  21072 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  21073 C
  21074 C ABSTRACT: ??????????????????????????????????????????????????????????
  21075 C   ??????????????????????????????????????????????????????????????????
  21076 C
  21077 C PROGRAM HISTORY LOG:
  21078 C ????-??-??  S. J. LORD
  21079 C
  21080 C USAGE:    CALL ????????(????)
  21081 C   INPUT ARGUMENT LIST:
  21082 C     ??????   - ???????????????????????????????????????????????
  21083 C
  21084 C   OUTPUT ARGUMENT LIST:
  21085 C     ??????   - ???????????????????????????????????????????????
  21086 C
  21087 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  21088 C     ??????   - ???????????????????????????????????????????????
  21089 C
  21090 C   OUTPUT FILES:
  21091 C     ??????   - ???????????????????????????????????????????????
  21092 C
  21093 C REMARKS: ?????????????????????????????????????????????????????
  21094 C
  21095 C ATTRIBUTES:
  21096 C   LANGUAGE: FORTRAN 90
  21097 C   MACHINE:  NCEP WCOSS
  21098 C
  21099 C$$$
  21100 C       SLARGO **   06/06/84
  21101 C       SLACCO FOR CORNER CONDITIONS.   PASDSS EXPANDED.
  21102 C       AMM,AMR,AML ARE ALL SQUARE MATRICES
  21103 C       THE OLD VERSION OF SLARGO (09/05/79) BEFORE
  21104 C       SWITCHING TO SLACCO VERSION, IS IN PLIB SPLAOLD
  21105 C     ++ ASSUMED DIM PARAMETERS ... MDIM=47...NDIM=35,
  21106 C
  21107       SUBROUTINE SLARGO
  21108 C
  21109 C     ** TWO-D VERSION OF THE EARLIER PLIB WALTZ ROUTINES **
  21110 C          PERIODIC BC IS NOT ALLOWED AT THIS TIME (03/31/79)
  21111 C
  21112       PARAMETER (MDIM=35,NDIM=35)
  21113 C
  21114 C     ** SECONDARY PARAMETERS FOR COMPILATION
  21115 C
  21116 C
  21117 C     ** WORK SPACE IN THE BLANK COMMON **
  21118 C        AMM, AMR, AML, ARE ALL SQUARE MATRICES
  21119 C        CCD, CCF, ARE MATRIX SPACE FOR CORNER CONDITIONS
  21120 C
  21121 C     ** NODAL CONSTANTS
  21122 C
  21123       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  21124      1                 YNC(NDIM),COSYN(NDIM)

Page 610         Source Listing                  SLARGO
2017-04-18 11:09                                 syndata.f

  21125 C
  21126 C     ** TRICYCLE INDICES
  21127 C
  21128       COMMON /MADCON/ MAD1,MADX,MAD,MM0,MR1,MR2,MR3,ML1,ML2,ML3,MRX,MLX
  21129 C
  21130       SAVE
  21131 C
  21132 C     ** ** SLARGO BEGINS ** **
  21133 C
  21134       IZERO = 0
  21135       INSEC = ISECND(IZERO)
  21136 C
  21137 C     ** PREPARE FOR GETAMR.  SLIMAC ASSUMES /S2DTPT/ HAS BEEN DEFINED
  21138 C
  21139       CALL SLIMAC
  21140 C
  21141 C     ** INITIALIZE TWO DISK UNITS
  21142 C        BOTH /S2PRIC/ AND /S2DTPT/ WILL BE COPIED ON UNIT MSKEF
  21143 C
  21144       CALL SLEFW0
  21145 C
  21146 C     ** INITIALIZE THE N-MATRIX ROUTINES
  21147 C
  21148       CALL PASDXX(NXX)
  21149 C
  21150 C     ** INITIALIZE THE TRICYCLE ROUTINES
  21151 C
  21152       CALL CLRADE
  21153 C
  21154 C     ** INITIALIZE THE CORNERING ROUTINE
  21155 C
  21156       CALL SLACCO
  21157 C
  21158 C     ** INITIALIZE TRICYCLE INDECES
  21159 C
  21160       MAD1=1
  21161       MADX=MXX
  21162       MAD=0
  21163       MM0=2
  21164       MR1=3
  21165       MR2=1
  21166       MR3=2
  21167 C
  21168 C     ** START THE TRICYCLES
  21169 C
  21170    10 MAD=MAD+1
  21171       MM0=MR1
  21172       MR1=MR2
  21173       MR2=MR3
  21174       MR3=MM0
  21175       ML3=MR3
  21176       ML2=MR1
  21177       ML1=MR2
  21178       MLX=MIN(MAD-MAD1,3)
  21179       MRX=MIN(MADX-MAD,3)
  21180       CALL CALDMM
  21181 C

Page 611         Source Listing                  SLARGO
2017-04-18 11:09                                 syndata.f

  21182 C       ** SLEFW1 IS CALLED BY CALDMM
  21183 C
  21184       CALL CALELR
  21185 C
  21186 C       ** SLEFW2 IS CALLED BY CALELR
  21187 C
  21188       CALL AMRTOL
  21189       IF(MAD.LT.MADX) GO TO 10
  21190 C
  21191 C     ** MERGE THE TWO DISK UNITS INTO ONE, MSKEF, BY BACK READING MSKEZ
  21192 C
  21193       CALL SLEFED
  21194       IDELTA = ISECND(INSEC)
  21195       WRITE(6,880) IDELTA
  21196   880 FORMAT(/' === SLARGO DONE ===',T91,'ELAPSED TIME=',I6)
  21197       RETURN
  21198       END


ENTRY POINTS

  Name               
                     
 slargo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  21170                                                          21189                             
 880                        Label  21196                                                          21195                             
 AMRTOL                     Subr   21188                                                          21188                             
 CALDMM                     Subr   21180                                                          21180                             
 CALELR                     Subr   21184                                                          21184                             
 CLRADE                     Subr   21152                                                          21152                             
 COSYN                      Scalar 21124    R(4)            4     1     35       COM                                                
 DXM                        Scalar 21123    R(4)            4           scalar   COM                                                
 DYN                        Scalar 21123    R(4)            4           scalar   COM                                                
 IDELTA                     Local  21194    I(4)            4           scalar   SAVE             21194,21195                       
 INSEC                      Local  21135    I(4)            4           scalar   SAVE             21135,21194                       
 ISECND                     Func   21135    I(4)            4           scalar                    21135,21194                       
 IZERO                      Local  21134    I(4)            4           scalar   SAVE             21134,21135                       
 MAD                        Scalar 21128    I(4)            4           scalar   COM              21162,21170,21178,21179,21189     
 MAD1                       Scalar 21128    I(4)            4           scalar   COM              21160,21178                       
 MADCON                     Common 21128                                48       SAVE                                               
 MADX                       Scalar 21128    I(4)            4           scalar   COM              21161,21179,21189                 
 MDIM                       Param  21112    I(4)            4           scalar                    21123                             
 MIN                        Func   21178                                scalar                    21178,21179                       
 ML1                        Scalar 21128    I(4)            4           scalar   COM              21177                             
 ML2                        Scalar 21128    I(4)            4           scalar   COM              21176                             
 ML3                        Scalar 21128    I(4)            4           scalar   COM              21175                             
 MLX                        Scalar 21128    I(4)            4           scalar   COM              21178                             
 MM0                        Scalar 21128    I(4)            4           scalar   COM              21163,21171,21174                 
 MR1                        Scalar 21128    I(4)            4           scalar   COM              21164,21171,21172,21176           
 MR2                        Scalar 21128    I(4)            4           scalar   COM              21165,21172,21173,21177           
 MR3                        Scalar 21128    I(4)            4           scalar   COM              21166,21173,21174,21175           

Page 612         Source Listing                  SLARGO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MRX                        Scalar 21128    I(4)            4           scalar   COM              21179                             
 MXX                        Scalar 21123    I(4)            4           scalar   COM              21161                             
 NDIM                       Param  21112    I(4)            4           scalar                    21123,21124                       
 NXX                        Scalar 21123    I(4)            4           scalar   COM              21148                             
 PASDXX                     Subr   21148                                                          21148                             
 S2NODE                     Common 21123                                716      SAVE                                               
 SLACCO                     Subr   21156                                                          21156                             
 SLARGO                     Subr   21107                                                                                            
 SLEFED                     Subr   21193                                                          21193                             
 SLEFW0                     Subr   21144                                                          21144                             
 SLIMAC                     Subr   21139                                                          21139                             
 XM                         Scalar 21123    R(4)            4     1     35       COM                                                
 XMC                        Scalar 21123    R(4)            4     1     35       COM                                                
 YN                         Scalar 21123    R(4)            4     1     35       COM                                                
 YNC                        Scalar 21124    R(4)            4     1     35       COM                                                

Page 613         Source Listing                  SLARGO
2017-04-18 11:09                                 syndata.f

  21199 
  21200 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  21201 C                .      .    .                                       .
  21202 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  21203 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  21204 C
  21205 C ABSTRACT: ??????????????????????????????????????????????????????????
  21206 C   ??????????????????????????????????????????????????????????????????
  21207 C
  21208 C PROGRAM HISTORY LOG:
  21209 C ????-??-??  S. J. LORD
  21210 C
  21211 C USAGE:    CALL ????????(????)
  21212 C   INPUT ARGUMENT LIST:
  21213 C     ??????   - ???????????????????????????????????????????????
  21214 C
  21215 C   OUTPUT ARGUMENT LIST:
  21216 C     ??????   - ???????????????????????????????????????????????
  21217 C
  21218 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  21219 C     ??????   - ???????????????????????????????????????????????
  21220 C
  21221 C   OUTPUT FILES:
  21222 C     ??????   - ???????????????????????????????????????????????
  21223 C
  21224 C REMARKS: ?????????????????????????????????????????????????????
  21225 C
  21226 C ATTRIBUTES:
  21227 C   LANGUAGE: FORTRAN 90
  21228 C   MACHINE:  NCEP WCOSS
  21229 C
  21230 C$$$
  21231       SUBROUTINE SPLEFW(AML1,AML2,AML3,D,EL1,EL2,MZ,ER1,ER2,ER3)
  21232 cdak dk-check
  21233       PARAMETER (MDIM=35,NDIM=35)
  21234       PARAMETER (LDXDIM=8000)
  21235 C
  21236 C     ** SECONDARY PARAMETERS FOR COMPILATION
  21237 C
  21238       PARAMETER (NSDIM=NDIM*NDIM)
  21239 C
  21240 C     ** THE FOLLOWING BASIC COMMONS ARE COPIED ON MSKEF, SO THAT,
  21241 C         IF THE DISK FILE IS SAVED, IT WILL CONTAIN ALL THE INFORMATION
  21242 C         NECESSARY FOR LATER USAGE.
  21243 C         NOTE THAT THE SAME /S2DTPT/ USED BY SLIMAC/GETAMR MUST
  21244 C         BE USED ALSO BY SLIMBO FOR CONSISTENCY
  21245 C
  21246 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  21247 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  21248       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  21249      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  21250       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  21251      1               ID(LDXDIM),LXSORT(LDXDIM)
  21252       COMMON/DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  21253      1           MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,
  21254      2           MSKD14,MSKD15,MSKD16,MSKD17,MSKD18
  21255 C

Page 614         Source Listing                  SPLEFW
2017-04-18 11:09                                 syndata.f

  21256       CHARACTER*8 IDSPD1,IDSPD2*72,IDSPC*125,KENTRY*7
  21257 C
  21258 C     ** DUMMY ARGUMENTS  (FROM THE BLANK COMMON DEFINED IN SLARGO)
  21259 C
  21260       SAVE
  21261 C
  21262       DIMENSION AML1(NSDIM),AML2(NSDIM),AML3(NSDIM),D(NSDIM),
  21263      1          EL1(NSDIM),EL2(NSDIM),ER1(NSDIM),ER2(NSDIM),ER3(NSDIM)
  21264 C
  21265 C     ** WORK SPACE IN THE BLANK COMMON ... TO BACK READ MSKEZ
  21266 C         SINCE THE BACK READ IS DONE ONLY AT THE END OF SLARGO,
  21267 C         THE USE OF BLANK COMMON BY SLEFED WILL NOT INTERFERE
  21268 C         WITH SLARGO EXECUTION.
  21269 C
  21270       COMMON /MER/ MEZ,ER(NSDIM,3)
  21271 C
  21272       CHARACTER*8 IDEF,IDZ*96,ZTIME,ZDATE*11
  21273 C
  21274 C     ** SAFETY LOCK
  21275 C
  21276       DATA MDONE/-9/,KENTRY/' SPLEFW'/,IDEF/' MSKEF  '/
  21277 C
  21278 C     ** MSKEF FILE ID CODE ... MAY BE REDEFINED BY CALLING STEFID(IDEFZ
  21279 C
  21280 C     ** LOCAL WORK SPACE FOR ASSEMBLING MSKEF HEAD RECORD
  21281 C
  21282 
  21283 C-----------------------------------------------------------------------
  21284 
  21285       ENTRY SLEFW0
  21286       REWIND MSKEF
  21287       REWIND MSKEZ
  21288       CALL SPDATE(ZDATE)
  21289       CALL SPTIME(ZTIME)
  21290       WRITE(IDZ,805) IDEF,MDIM,NDIM,LDXDIM,LDX,ZDATE,ZTIME
  21291   805 FORMAT(A8,' (M-,N-,LDXDIM)=',3I8,'   LDX=',I8,
  21292      1    '  DATE=',A11,'  TIME=',A8)
  21293 C
  21294 C     ** LDXDIM IS NOT USED IN DETERMINING THE RECORD LENGTH, SO THAT
  21295 C         LDXDIM OF SPLEFW AND THAT OF SPLEFR NEED NOT BE THE SAME,
  21296 C         AS LONG AS THE BOTH VALUES OF LDXDIM ARE .GE. LDX.
  21297 C     ** WRITE THE HEAD RECORD ON MSKEF
  21298 C         THE RECORD LENGTH = 13 + 27 + 11 + 3*LDX = 51 + 3*LDX
  21299 C
  21300       WRITE(MSKEF) IDZ,IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP,XM1,XMXX,YN1,
  21301      1             YNXX,XYDCWL,XYBCWL,IDSPD1,IDSPD2,LDX,XD,YD,WD,ID,XML,
  21302      2             XMR,YNB,YNT
  21303       WRITE(6,808) MSKEF,MSKEZ,IDZ
  21304   808 FORMAT(/' === SLEFW0 DONE ===   MSKEF=',I5,3X,'MSKEZ=',I5,/
  21305      1   ,5X,'...',A96)
  21306       MDONE=0
  21307       RETURN
  21308 
  21309 C-----------------------------------------------------------------------
  21310 
  21311 C
  21312 C     ** ** IMPORTANT DECISION ON THE MSKEF RECORD FORMAT ** **

Page 615         Source Listing                  SPLEFW
2017-04-18 11:09                                 syndata.f

  21313 C        TO VECTORIZE SLIMBO CALCULATIONS ON CRAY-1, THERE IS
  21314 C        NO COMPUTATIONAL ADVANTAGE IN KEEPING   AML  AS NRDIM MATRICES
  21315 C        AS OF OCT 79, ALL ARRAYS, AMM, AMR AND AML, IN SLARGO ARE IN
  21316 C        THE FULL SQUARE FORM.  NO NEED TO CONVERT AML IN THIS ROUTINE.
  21317 C        SLEFW1 WRITES TWO RECORDS OF LENGTH ... 1+3*NSDIM ... FOR EACH
  21318 C        SLEFW2 WRITES ONE RECORD OF THE SAME LENGTH
  21319 C        THE DEFAULT VALUE OF  BS PARAMETER  IN cRAY JCL  ASSIGN  IS 4.
  21320 C        IF NDIM=41,  BS=12(OCTAL)  MAY BE ADVISABLE  FOR UNIT MSKEF
  21321 C
  21322       ENTRY SLEFW1(AML1,AML2,AML3,D,EL1,EL2,MZ)
  21323       MF=MZ
  21324       IF(MF.NE.MDONE+1) GO TO 91
  21325       WRITE(MSKEF) MF,AML1,AML2,AML3
  21326       WRITE(MSKEF) MF,D,EL1,EL2
  21327       RETURN
  21328 
  21329 C-----------------------------------------------------------------------
  21330 
  21331 C
  21332       ENTRY SLEFW2(ER1,ER2,ER3,MZ)
  21333       ME=-MZ
  21334       IF(MF+ME.NE.0) GO TO 92
  21335       WRITE(MSKEZ) ME,ER1,ER2,ER3
  21336       MDONE=MDONE+1
  21337       RETURN
  21338 
  21339 C-----------------------------------------------------------------------
  21340 
  21341 C
  21342       ENTRY SLEFED
  21343 C
  21344 C     MERGE MSKEZ AND MSKEF
  21345 C
  21346       IF(MDONE.NE.MX+1) GO TO 93
  21347       ENDFILE MSKEZ
  21348 C
  21349       DO 52 MM=1,MDONE
  21350       BACKSPACE MSKEZ
  21351       BACKSPACE MSKEZ
  21352       READ(MSKEZ,ERR=95) MEZ,ER
  21353       IF(MDONE+MEZ.NE.MM-1) GO TO 95
  21354       WRITE(MSKEF) MEZ,ER
  21355    52 CONTINUE
  21356 C
  21357 C     +++ WITHOUT THIS WAIT, EOF IS WRITTEN BEFORE THE LAST RECORD OUT
  21358 C
  21359       ENDFILE (MSKEF,ERR=96)
  21360       REWIND MSKEF
  21361       WRITE(6,854) MSKEF,MDONE
  21362   854 FORMAT(/' === SLEFED DONE ===   MSKEF=',I4,3X,'MDONE=',I3)
  21363       RETURN
  21364 C
  21365 C-----------------------------------------------------------------------
  21366 C
  21367 C     ** ERROR EXIT
  21368 C
  21369    91 KENTRY='SLEFW1'

Page 616         Source Listing                  SPLEFW
2017-04-18 11:09                                 syndata.f

  21370       GO TO 94
  21371    92 KENTRY='SLEFW2'
  21372       GO TO 94
  21373    93 KENTRY='SLEFED'
  21374    94 WRITE(6,894) KENTRY,MF,ME,MDONE
  21375   894 FORMAT(/' === ',A7,' MET WRONG M COUNTS.  (MF,ME,MDONE)=',3I6)
  21376       GO TO 99
  21377    95 WRITE(6,895) MM,MEZ,MDONE
  21378   895 FORMAT(/' === SLEFED BACK READ ERROR.  (MM,ME,MDONE)=',3I6)
  21379       GO TO 99
  21380    96 WRITE(6,896) MSKEF
  21381   896 FORMAT(/' ... ENDFILE ERROR ON ',A8)
  21382    99 CALL ABRT1(KENTRY,896)
  21383       END


ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 slefed_               slefw0_               slefw1_               slefw2_               splefw_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 52                         Label  21355                                                          21349                             
 805                        Label  21291                                                          21290                             
 808                        Label  21304                                                          21303                             
 854                        Label  21362                                                          21361                             
 894                        Label  21375                                                          21374                             
 895                        Label  21378                                                          21377                             
 896                        Label  21381                                                          21380                             
 91                         Label  21369                                                          21324                             
 92                         Label  21371                                                          21334                             
 93                         Label  21373                                                          21346                             
 94                         Label  21374                                                          21370,21372                       
 95                         Label  21377                                                          21352,21353                       
 96                         Label  21380                                                          21359                             
 99                         Label  21382                                                          21376,21379                       
 ABRT1                      Subr   21382                                                          21382                             
 AML1                       Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21325                             
 AML2                       Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21325                             
 AML3                       Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21325                             
 D                          Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21326                             
 DSK                        Common 21252                                76       SAVE                                               
 EL1                        Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21326                             
 EL2                        Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21326                             
 ER                         Scalar 21270    R(4)            4     2     3675     COM              21352,21354                       
 ER1                        Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21335                             
 ER2                        Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21335                             
 ER3                        Dummy  21231    R(4)            4     1     1225     ARG,INOUT        21335                             
 ID                         Scalar 21251    I(4)            4     1     8000     COM              21301                             
 IDEF                       Local  21272    CHAR            8           scalar   SAVE             21276,21290                       
 IDSPC                      Scalar 21249    CHAR            125         scalar   COM              21300                             
 IDSPD1                     Scalar 21250    CHAR            8           scalar   COM              21301                             

Page 617         Source Listing                  SPLEFW
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDSPD2                     Scalar 21250    CHAR            72          scalar   COM              21301                             
 IDZ                        Local  21272    CHAR            96          scalar   SAVE             21290,21300,21303                 
 ISRCD                      Scalar 21248    I(4)            4           scalar   COM              21300                             
 JPD                        Scalar 21248    I(4)            4           scalar   COM              21300                             
 KBCTYP                     Scalar 21248    I(4)            4     1     4        COM              21300                             
 KDCTYP                     Scalar 21248    I(4)            4           scalar   COM              21300                             
 KENTRY                     Local  21256    CHAR            7           scalar   SAVE             21276,21369,21371,21373,21374,2138
                                                                                                  2                                 
 LDX                        Scalar 21250    I(4)            4           scalar   COM              21290,21301                       
 LDXDIM                     Param  21234    I(4)            4           scalar                    21250,21251,21290                 
 LXSORT                     Scalar 21251    I(4)            4     1     8000     COM                                                
 MDIM                       Param  21233    I(4)            4           scalar                    21290                             
 MDONE                      Local  21276    I(4)            4           scalar   SAVE             21276,21306,21324,21336,21346,2134
                                                                                                  9,21353,21361,21374,21377         
 ME                         Local  21333    I(4)            4           scalar   SAVE             21333,21334,21335,21374           
 MER                        Common 21270                                14704    SAVE                                               
 MEZ                        Scalar 21270    I(4)            4           scalar   COM              21352,21353,21354,21377           
 MF                         Local  21323    I(4)            4           scalar   SAVE             21323,21324,21325,21326,21334,2137
                                                                                                  4                                 
 MM                         Local  21349    I(4)            4           scalar   SAVE             21349,21353,21377                 
 MSKD11                     Scalar 21253    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 21253    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 21253    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 21254    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 21254    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 21254    I(4)            4           scalar   COM                                                
 MSKD17                     Scalar 21254    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 21254    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 21252    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 21252    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 21252    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 21252    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 21252    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 21252    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 21253    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 21253    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 21253    I(4)            4           scalar   COM                                                
 MSKEF                      Scalar 21252    I(4)            4           scalar   COM              21286,21300,21303,21325,21326,2135
                                                                                                  4,21359,21360,21361,21380         
 MSKEZ                      Scalar 21252    I(4)            4           scalar   COM              21287,21303,21335,21347,21350,2135
                                                                                                  1,21352                           
 MX                         Scalar 21248    I(4)            4           scalar   COM              21300,21346                       
 MZ                         Dummy  21231    I(4)            4           scalar   ARG,INOUT        21323,21333                       
 NDIM                       Param  21233    I(4)            4           scalar                    21238,21290                       
 NSDIM                      Param  21238    I(4)            4           scalar                    21262,21263,21270                 
 NX                         Scalar 21248    I(4)            4           scalar   COM              21300                             
 S2DTPT                     Common 21250                                160084   SAVE                                               
 S2PRIC                     Common 21248                                217      SAVE                                               
 SLEFED                     Subr   21342                                                                                            
 SLEFW0                     Subr   21285                                                                                            
 SLEFW1                     Subr   21322                                                                                            
 SLEFW2                     Subr   21332                                                                                            
 SPDATE                     Subr   21288                                                          21288                             
 SPLEFW                     Subr   21231                                                                                            
 SPTIME                     Subr   21289                                                          21289                             

Page 618         Source Listing                  SPLEFW
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 WD                         Scalar 21250    R(4)            4     1     8000     COM              21301                             
 XD                         Scalar 21250    R(4)            4     1     8000     COM              21301                             
 XM1                        Scalar 21249    R(4)            4           scalar   COM              21300                             
 XML                        Scalar 21248    R(4)            4           scalar   COM              21301                             
 XMR                        Scalar 21248    R(4)            4           scalar   COM              21302                             
 XMXX                       Scalar 21249    R(4)            4           scalar   COM              21300                             
 XYBCWL                     Scalar 21249    R(4)            4     1     4        COM              21301                             
 XYDCWL                     Scalar 21249    R(4)            4     1     2        COM              21301                             
 YD                         Scalar 21250    R(4)            4     1     8000     COM              21301                             
 YN1                        Scalar 21249    R(4)            4           scalar   COM              21300                             
 YNB                        Scalar 21248    R(4)            4           scalar   COM              21302                             
 YNT                        Scalar 21248    R(4)            4           scalar   COM              21302                             
 YNXX                       Scalar 21249    R(4)            4           scalar   COM              21301                             
 ZDATE                      Local  21272    CHAR            11          scalar   SAVE             21288,21290                       
 ZTIME                      Local  21272    CHAR            8           scalar   SAVE             21289,21290                       

Page 619         Source Listing                  SPLEFW
2017-04-18 11:09                                 syndata.f

  21384 
  21385 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  21386 C                .      .    .                                       .
  21387 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  21388 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  21389 C
  21390 C ABSTRACT: ??????????????????????????????????????????????????????????
  21391 C   ??????????????????????????????????????????????????????????????????
  21392 C
  21393 C PROGRAM HISTORY LOG:
  21394 C ????-??-??  S. J. LORD
  21395 C
  21396 C USAGE:    CALL ????????(????)
  21397 C   INPUT ARGUMENT LIST:
  21398 C     ??????   - ???????????????????????????????????????????????
  21399 C
  21400 C   OUTPUT ARGUMENT LIST:
  21401 C     ??????   - ???????????????????????????????????????????????
  21402 C
  21403 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  21404 C     ??????   - ???????????????????????????????????????????????
  21405 C
  21406 C   OUTPUT FILES:
  21407 C     ??????   - ???????????????????????????????????????????????
  21408 C
  21409 C REMARKS: ?????????????????????????????????????????????????????
  21410 C
  21411 C ATTRIBUTES:
  21412 C   LANGUAGE: FORTRAN 90
  21413 C   MACHINE:  NCEP WCOSS
  21414 C
  21415 C$$$
  21416       SUBROUTINE GAMSUB(AMM,AMR,M,AZZ)
  21417 C
  21418 C          ENTRY GETAMR (AMM,AMR,M)
  21419 C          ENTRY GTAMXX(AZZ)
  21420 C
  21421       PARAMETER (MDIM=35,NDIM=35)
  21422       PARAMETER (LDXDIM=8000)
  21423 C
  21424 C     ** DATA POINTS INFORMATION **
  21425 C
  21426       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  21427      1               ID(LDXDIM),LXSORT(LDXDIM)
  21428 C
  21429 C     OTHER CONSTANTS
  21430 C
  21431 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  21432 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  21433       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  21434      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  21435       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  21436      1                 YNC(NDIM),COSYN(NDIM)
  21437 C
  21438 C     LOCAL CONSTANTS FOR SLADDQ
  21439 C
  21440       COMMON /S2MACQ/ MXX1,MX1,MX2,MX3,NXX1,NX1,NX2,NX3

Page 620         Source Listing                  GAMSUB
2017-04-18 11:09                                 syndata.f

  21441 C
  21442 C     DUMMY ARGUMENTS ... AMM,AMR ARE SQUARE MATRICES (OCT 79)
  21443 C
  21444       SAVE
  21445 C
  21446       DIMENSION AMM(NDIM,NDIM),AMR(NDIM,NDIM,3),AZZ(NDIM,NDIM)
  21447 C
  21448 C     LOCAL WORK SPACE
  21449 C
  21450       DIMENSION ROWM(NDIM,4,4,4)
  21451 C
  21452 C     EQUIVALENCE (ROWM,XDZ)
  21453 C
  21454       DIMENSION LROW(4)
  21455 C
  21456       CHARACTER*8 IDSPD1,IDSPD2*72,IDSPC*125
  21457 C
  21458 C     INPUT TO SLIMAC VIA /S2DTPT/
  21459 C      XD      X COORDINATES DO DATA POINTS
  21460 C      YD      Y COORDINATES DO DATA POINTS
  21461 C      WD      WEIGHTS ON DATA AT INDIVIDUAL DATA POINTS
  21462 C              MUST HAVE BEEN SET BEFORE SLIMAC IS CALLED
  21463 C              ++ TO AVOID POSSIBLE HANG UP IN GETAMR, WD WILL BE
  21464 C                 SET NEGATIVE IF XD OR YD IS OFF LIMITS
  21465 C              ANY POINTS WITH ZERO OR NEGATIVE WEIGHT WILL NOT BE
  21466 C              INCLUDED IN THE ROWM ACCUMULATION BY SLIMAC/GETAMR
  21467 C      LDX     MAX NUMBER OF DATA POINTS.  MUST BE .LE. LDXDIM
  21468 C      IDSPD   ID OF THE DATA POINT SET, AND EXPLANATION (80 CHARACTERS)
  21469 C     INPUT TO GETAMR
  21470 C      M       X-NODE INDEX.   MUST START AT 1, AND END AT MXX.
  21471 C     OUT FROM GETAMR
  21472 C      AMM     (N,N) MATRIX AT (M,M) DIAGONAL
  21473 C      AMR     (N,N) MATRICES OF (M,M+MR) OFF-DIAGONAL
  21474 C              *** MR=1 IN SPLESK ROUTINES IS FOR THE FIRST OFF-DIAGONAL
  21475 C     +++ +++ NRTOS0 IS USED TO TRANSFORM REC ARRAYS TO SQUARE ARRAYS ++
  21476 C     LOCAL ARRAYS
  21477 C      ROWM    WILL BE ACTIVE DURING SLARGO EXECUTION
  21478 C      LXSORT  IS NOT DEFINED IN XDTSRT THROUGH COMMON
  21479 C      LROW    ROW CYCLING REGISTER
  21480 C      XDZ     TEMPORARY WORK SPACE  EQUIVALENCED TO ROWM
  21481 C              ITS NEED BY SORTRL ENDS BEFORE ROWM IS CLEARED BY SLIMAC
  21482 C     SAFETY LOCK ... MDONE
  21483 C
  21484       DATA MDONE/-9/
  21485 
  21486 C-----------------------------------------------------------------------
  21487 
  21488 C
  21489       ENTRY SLIMAC
  21490 C
  21491 C     ** DEFINE /S2MACQ/ FOR THE USE BY SLADDQ
  21492 C
  21493       MXX1=MXX+1
  21494       MX1=MX-1
  21495       MX2=MX-2
  21496       MX3=MX-3
  21497       NXX1=NXX+1

Page 621         Source Listing                  GAMSUB
2017-04-18 11:09                                 syndata.f

  21498       NX1=NX-1
  21499       NX2=NX-2
  21500       NX3=NX-3
  21501 C
  21502 C     ** INITIALIZATION FOR GETAMR **
  21503 C     CHECK DATA POINTS AND WEIGHTS
  21504 C     ONLY DATA INSIDE DOMAIN ARE ACCEPTED
  21505 C
  21506       LDOK=0
  21507       LDOFF=0
  21508 C
  21509       DO 84 LD=1,LDX
  21510 C
  21511 C     IGNORE IF THE WEIGHT IS ALREADY MARKED OFF
  21512 C
  21513       IF(WD(LD).LE.0.) GO TO 82
  21514 C
  21515 C     CHECK FOR OFF-LIMIT POINTS:  THIS CHECK HAS BEEN MOVED TO XDTSRT.
  21516 C                                  (6/13/88)
  21517 C
  21518 C      IF(XD(LD) .LT. XM1 .OR. XD(LD) .GT. XMXX)  GO TO 82
  21519 C      IF(YD(LD) .LT. YN1 .OR. YD(LD) .GT. YNXX)  GO TO 82
  21520 C
  21521 C     ACCEPTED POINTS
  21522 C
  21523       LDOK=LDOK+1
  21524       GO TO 84
  21525 C
  21526 C     OFF THE LIMITS.  WD SET TO NEGATIVE
  21527 C
  21528    82 WD(LD)=-ABS(WD(LD))
  21529 C
  21530 c && 2 comments
  21531 CC    WRITE(6,830) XD(LD),YD(LD)
  21532 CC830 FORMAT(10X,'REJECTED DATA POINT...XD=',F6.2,'  YD=',F6.2)
  21533       LDOFF=LDOFF+1
  21534    84 CONTINUE
  21535 C
  21536       WRITE(6,885) LDX,LDOK,LDOFF
  21537   885 FORMAT(/' === SLIMAC DATA POINTS CHECK.    LDX=',I7,
  21538      1    ' (INPUT TOTAL COUNT)',/,35X,'LDOK=',I6,' (ACCEPTED BY ',
  21539      2    'SLIMAC)',/,34X,'LDOFF=',I6,' (REJECTED.  WD REDEFINED)')
  21540 C
  21541 C     QUIT, IF NO DATA POINTS WERE ACCEPTED
  21542 C
  21543       IF(LDOK.LE.0) GO TO 91
  21544 C
  21545 C     INITIALIZE THE ROW POINTER AND ROWM
  21546 C
  21547       DO L=1,4
  21548       LROW(L)=L
  21549       ENDDO
  21550 C
  21551       ROWM=0.
  21552 C
  21553       DY0=1./DYN
  21554       MDONE=0

Page 622         Source Listing                  GAMSUB
2017-04-18 11:09                                 syndata.f

  21555       IDD=0
  21556       XSTOP=XM(3)
  21557       CALL SLIQBG
  21558       RETURN
  21559 
  21560 C-----------------------------------------------------------------------
  21561 
  21562 C
  21563       ENTRY GETAMR(AMM,AMR,M)
  21564 C
  21565 C     MAKE SURE CORRECT NODE IS BEING CALCULATED
  21566 C
  21567       IF(M.NE.MDONE+1) GO TO 92
  21568       IF(M.GT.MXX)     GO TO 92
  21569 C
  21570 C     CHECK IF UNPROCESSED DATA STILL REMAIN
  21571 C
  21572   110 IF(IDD.GE.LDX) GO TO 120
  21573       IDD=IDD+1
  21574       if(IDD .GT. LDXDIM)  THEN
  21575          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  21576      $    'IDD=',IDD,', return'
  21577          return
  21578       endif
  21579       LD=LXSORT(IDD)
  21580       X=XD(LD)
  21581       Y=YD(LD)
  21582       W=WD(LD)
  21583       IF(W.LE.0.) GO TO 110
  21584 C
  21585 C     CHECK IF X IS IN THE ACCUMULATION RANGE
  21586 C
  21587       IF(X.LE.XSTOP) GO TO 112
  21588       IDD=IDD-1
  21589       GO TO 120
  21590 C
  21591 C     ** ROWM ACCUMULATION **
  21592 C
  21593   112 MA1=M
  21594       MMAX=MIN(MA1+3,MXX)
  21595       NA1=MAX(INT((Y-YN1)*DY0),1)
  21596       NAX=MIN(NA1+3,NXX)
  21597 C
  21598       DO MA=MA1,MMAX
  21599       LR=LROW(MA-MA1+1)
  21600       WMA =XBF(MA,X)*W
  21601       DO MB=MA,MMAX
  21602       MR=MB-MA+1
  21603       WMAB=XBF(MB,X)*WMA
  21604       DO NA=NA1,NAX
  21605       WMABNA=YBF(NA,Y)*WMAB
  21606       DO NB=NA,NAX
  21607       NR=NB-NA+1
  21608       ROWM(NA,NR,MR,LR)=ROWM(NA,NR,MR,LR)+YBF(NB,Y)*WMABNA
  21609       ENDDO
  21610       ENDDO
  21611       ENDDO

Page 623         Source Listing                  GAMSUB
2017-04-18 11:09                                 syndata.f

  21612       ENDDO
  21613 C
  21614       GO TO 110
  21615 C
  21616 C     NO MORE DATA POINTS LEFT IN THE PRESENT ACCUMULATION RANGE
  21617 C     ADD Q
  21618 C
  21619   120 LR=LROW(1)
  21620 C
  21621 C     SET UP ROWM MATRIX
  21622 C
  21623       CALL SLADDQ(M,ROWM(:,:,:,LR))
  21624 C
  21625 C     TRANSFER THE READY RESULTS IN ROWM AT LR=LROW(1) TO AMM AND AMR
  21626 C
  21627       CALL NRTOS0(ROWM(:,:,1,LR),AMM)
  21628 C
  21629 C     +++ MR=1 IS THE DIAGONAL IN ROWM, BUT THE FIRST OFF-DIAGONAL IN AM
  21630 C
  21631       DO MR=2,4
  21632       CALL NRTOS0(ROWM(:,:,MR,LR),AMR(:,:,MR-1))
  21633       ENDDO
  21634 C
  21635 C     ** PREPARE FOR NEXT ENTRY TO GETAMR
  21636 C     CLEAR THE LR=LROW(1)
  21637 C
  21638       ROWM(:,:,:,LR)=0.
  21639 C
  21640 C     CYCLE UP LROW FOR NEXT ENTRY
  21641 C     ++ SYSTEM (CFT) ERROR IN VECTORIZED MOD FUNC.  DO NOT USE MOD. 7/3
  21642 C
  21643       DO L=1,4
  21644       LZ=LROW(L)+1
  21645       IF(LZ.GT.4) LZ=LZ-4
  21646       LROW(L)=LZ
  21647       ENDDO
  21648 C
  21649 C     ADVANCE THE ACCUMULATION LIMIT
  21650 C
  21651       XSTOP=XSTOP+DXM
  21652       MDONE=M
  21653       RETURN
  21654 
  21655 C-----------------------------------------------------------------------
  21656 
  21657 C
  21658 C       ** SPECIAL ENTRY TO GET THE PREVIEW OF AMM AT MXX (CALLED BY SLA
  21659 C
  21660       ENTRY GTAMXX(AZZ)
  21661       IF(MDONE.NE.MX) GO TO 93
  21662       IF(IDD.GE.LDX) GO TO 155
  21663       LDLEFT=0
  21664 C
  21665       DO 151 LD=IDD+1,LDX
  21666       IF(WD(LD).GT.0.) LDLEFT=LDLEFT+1
  21667   151 CONTINUE
  21668 C

Page 624         Source Listing                  GAMSUB
2017-04-18 11:09                                 syndata.f

  21669       IF(LDLEFT.EQ.0) GO TO 155
  21670       WRITE(6,8152) LDLEFT,MDONE
  21671  8152 FORMAT(/' === GTAMXX WARNING...',I5,'VALID DATA POINTS ARE ',
  21672      1    'STILL LEFT UNACCUMULATED AT MDONE=',I3)
  21673 C
  21674 C       ++ GET AMM OF MXX IN AZZ, WITHOUT DISTURBING THE SLIMAC SEQUENCE
  21675 C
  21676   155 LRXX=LROW(1)
  21677 C
  21678       AZZ(1:NXX,1:4)=ROWM(1:NXX,:,1,LRXX)
  21679 C
  21680 C     ADD AZZ TO PNMR AND QNMG AND RETURN IN AZZ
  21681 C
  21682       CALL SLADDQ(MXX,AZZ)
  21683 C
  21684 C     SHIFT VALUES IN AZZ BACK TO ITSELF
  21685 C
  21686       CALL NRTOS0(AZZ,AZZ)
  21687       RETURN
  21688 C
  21689 C     ** ERROR EXITS **
  21690 C
  21691    91 WRITE(6,891)
  21692   891 FORMAT(' === SLIMAC CALLS EXIT.  NO ACCEPTED DATA POINTS.')
  21693       GO TO 99
  21694    92 WRITE(6,892) M,MDONE,MXX
  21695   892 FORMAT(/' === GETAMR/SLIMAC WAS CALLED WITH A WRONG M.   M=',I3,
  21696      1    '  MDONE=',I3,'  MXX=',I3,/,6X,'OR, SLIMAC HAS NOT BEEN ',
  21697      2    'CALLED')
  21698       GO TO 99
  21699    93 WRITE(6,893) MDONE,MX
  21700   893 FORMAT(/' === GTAMXX WAS CALLED AT A WRONG M.  MDONE=',I3,
  21701      1    ' MUST BE EQUAL TO MX=',I3)
  21702    99 CALL ABRT1(' SLIMAC',893)
  21703       END

Page 625         Source Listing                  GAMSUB
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 gamsub_               getamr_               gtamxx_               slimac_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 110                        Label  21572                                                          21583,21614                       
 112                        Label  21593                                                          21587                             
 120                        Label  21619                                                          21572,21589                       
 151                        Label  21667                                                          21665                             
 155                        Label  21676                                                          21662,21669                       
 8152                       Label  21671                                                          21670                             
 82                         Label  21528                                                          21513                             
 84                         Label  21534                                                          21509,21524                       
 885                        Label  21537                                                          21536                             
 891                        Label  21692                                                          21691                             
 892                        Label  21695                                                          21694                             
 893                        Label  21700                                                          21699                             
 91                         Label  21691                                                          21543                             
 92                         Label  21694                                                          21567,21568                       
 93                         Label  21699                                                          21661                             
 99                         Label  21702                                                          21693,21698                       
 ABRT1                      Subr   21702                                                          21702                             
 ABS                        Func   21528                                scalar                    21528                             
 AMM                        Dummy  21416    R(4)            4     2     1225     ARG,INOUT        21627                             
 AMR                        Dummy  21416    R(4)            4     3     3675     ARG,INOUT        21632                             
 AZZ                        Dummy  21416    R(4)            4     2     1225     ARG,INOUT        21678,21682,21686                 
 COSYN                      Scalar 21436    R(4)            4     1     35       COM                                                
 DXM                        Scalar 21435    R(4)            4           scalar   COM              21651                             
 DY0                        Local  21553    R(4)            4           scalar   SAVE             21553,21595                       
 DYN                        Scalar 21435    R(4)            4           scalar   COM              21553                             
 GAMSUB                     Subr   21416                                                                                            
 GETAMR                     Subr   21563                                                                                            
 GTAMXX                     Subr   21660                                                                                            
 ID                         Scalar 21427    I(4)            4     1     8000     COM                                                
 IDD                        Local  21555    I(4)            4           scalar   SAVE             21555,21572,21573,21574,21576,2157
                                                                                                  9,21588,21662,21665               
 IDSPC                      Scalar 21434    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 21426    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 21426    CHAR            72          scalar   COM                                                
 INT                        Func   21595                                scalar                    21595                             
 ISRCD                      Scalar 21433    I(4)            4           scalar   COM                                                
 JPD                        Scalar 21433    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 21433    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 21433    I(4)            4           scalar   COM                                                
 L                          Local  21547    I(4)            4           scalar   SAVE             21547,21548,21643,21644,21646     
 LD                         Local  21509    I(4)            4           scalar   SAVE             21509,21513,21528,21579,21580,2158
                                                                                                  1,21582,21665,21666               
 LDLEFT                     Local  21663    I(4)            4           scalar   SAVE             21663,21666,21669,21670           
 LDOFF                      Local  21507    I(4)            4           scalar   SAVE             21507,21533,21536                 

Page 626         Source Listing                  GAMSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LDOK                       Local  21506    I(4)            4           scalar   SAVE             21506,21523,21536,21543           
 LDX                        Scalar 21426    I(4)            4           scalar   COM              21509,21536,21572,21662,21665     
 LDXDIM                     Param  21422    I(4)            4           scalar                    21426,21427,21574,21575           
 LR                         Local  21599    I(4)            4           scalar   SAVE             21599,21608,21619,21623,21627,2163
                                                                                                  2,21638                           
 LROW                       Local  21454    I(4)            4     1     4        SAVE             21548,21599,21619,21644,21646,2167
                                                                                                  6                                 
 LRXX                       Local  21676    I(4)            4           scalar   SAVE             21676,21678                       
 LXSORT                     Scalar 21427    I(4)            4     1     8000     COM              21579                             
 LZ                         Local  21644    I(4)            4           scalar   SAVE             21644,21645,21646                 
 M                          Dummy  21416    I(4)            4           scalar   ARG,INOUT        21567,21568,21593,21623,21652,2169
                                                                                                  4                                 
 MA                         Local  21598    I(4)            4           scalar   SAVE             21598,21599,21600,21601,21602     
 MA1                        Local  21593    I(4)            4           scalar   SAVE             21593,21594,21598,21599           
 MAX                        Func   21595                                scalar                    21595                             
 MB                         Local  21601    I(4)            4           scalar   SAVE             21601,21602,21603                 
 MDIM                       Param  21421    I(4)            4           scalar                    21435                             
 MDONE                      Local  21484    I(4)            4           scalar   SAVE             21484,21554,21567,21652,21661,2167
                                                                                                  0,21694,21699                     
 MIN                        Func   21594                                scalar                    21594,21596                       
 MMAX                       Local  21594    I(4)            4           scalar   SAVE             21594,21598,21601                 
 MR                         Local  21602    I(4)            4           scalar   SAVE             21602,21608,21631,21632           
 MX                         Scalar 21433    I(4)            4           scalar   COM              21494,21495,21496,21661,21699     
 MX1                        Scalar 21440    I(4)            4           scalar   COM              21494                             
 MX2                        Scalar 21440    I(4)            4           scalar   COM              21495                             
 MX3                        Scalar 21440    I(4)            4           scalar   COM              21496                             
 MXX                        Scalar 21435    I(4)            4           scalar   COM              21493,21568,21594,21682,21694     
 MXX1                       Scalar 21440    I(4)            4           scalar   COM              21493                             
 NA                         Local  21604    I(4)            4           scalar   SAVE             21604,21605,21606,21607,21608     
 NA1                        Local  21595    I(4)            4           scalar   SAVE             21595,21596,21604                 
 NAX                        Local  21596    I(4)            4           scalar   SAVE             21596,21604,21606                 
 NB                         Local  21606    I(4)            4           scalar   SAVE             21606,21607,21608                 
 NDIM                       Param  21421    I(4)            4           scalar                    21435,21436,21446,21450           
 NR                         Local  21607    I(4)            4           scalar   SAVE             21607,21608                       
 NRTOS0                     Subr   21627                                                          21627,21632,21686                 
 NX                         Scalar 21433    I(4)            4           scalar   COM              21498,21499,21500                 
 NX1                        Scalar 21440    I(4)            4           scalar   COM              21498                             
 NX2                        Scalar 21440    I(4)            4           scalar   COM              21499                             
 NX3                        Scalar 21440    I(4)            4           scalar   COM              21500                             
 NXX                        Scalar 21435    I(4)            4           scalar   COM              21497,21596,21678                 
 NXX1                       Scalar 21440    I(4)            4           scalar   COM              21497                             
 ROWM                       Local  21450    R(4)            4     4     2240     SAVE             21551,21608,21623,21627,21632,2163
                                                                                                  8,21678                           
 S2DTPT                     Common 21426                                160084   SAVE                                               
 S2MACQ                     Common 21440                                32       SAVE                                               
 S2NODE                     Common 21435                                716      SAVE                                               
 S2PRIC                     Common 21433                                217      SAVE                                               
 SLADDQ                     Subr   21623                                                          21623,21682                       
 SLIMAC                     Subr   21489                                                                                            
 SLIQBG                     Subr   21557                                                          21557                             
 W                          Local  21582    R(4)            4           scalar   SAVE             21582,21583,21600                 
 WD                         Scalar 21426    R(4)            4     1     8000     COM              21513,21528,21582,21666           
 WMA                        Local  21600    R(4)            4           scalar   SAVE             21600,21603                       
 WMAB                       Local  21603    R(4)            4           scalar   SAVE             21603,21605                       
 WMABNA                     Local  21605    R(4)            4           scalar   SAVE             21605,21608                       

Page 627         Source Listing                  GAMSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 X                          Local  21580    R(4)            4           scalar   SAVE             21580,21587,21600,21603           
 XBF                        Func   21600    R(4)            4           scalar                    21600,21603                       
 XD                         Scalar 21426    R(4)            4     1     8000     COM              21580                             
 XM                         Scalar 21435    R(4)            4     1     35       COM              21556                             
 XM1                        Scalar 21434    R(4)            4           scalar   COM                                                
 XMC                        Scalar 21435    R(4)            4     1     35       COM                                                
 XML                        Scalar 21433    R(4)            4           scalar   COM                                                
 XMR                        Scalar 21433    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 21434    R(4)            4           scalar   COM                                                
 XSTOP                      Local  21556    R(4)            4           scalar   SAVE             21556,21587,21651                 
 XYBCWL                     Scalar 21434    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 21434    R(4)            4     1     2        COM                                                
 Y                          Local  21581    R(4)            4           scalar   SAVE             21581,21595,21605,21608           
 YBF                        Func   21605    R(4)            4           scalar                    21605,21608                       
 YD                         Scalar 21426    R(4)            4     1     8000     COM              21581                             
 YN                         Scalar 21435    R(4)            4     1     35       COM                                                
 YN1                        Scalar 21434    R(4)            4           scalar   COM              21595                             
 YNB                        Scalar 21433    R(4)            4           scalar   COM                                                
 YNC                        Scalar 21436    R(4)            4     1     35       COM                                                
 YNT                        Scalar 21433    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 21434    R(4)            4           scalar   COM                                                

Page 628         Source Listing                  GAMSUB
2017-04-18 11:09                                 syndata.f

  21704 
  21705 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  21706 C                .      .    .                                       .
  21707 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  21708 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  21709 C
  21710 C ABSTRACT: ??????????????????????????????????????????????????????????
  21711 C   ??????????????????????????????????????????????????????????????????
  21712 C
  21713 C PROGRAM HISTORY LOG:
  21714 C ????-??-??  S. J. LORD
  21715 C
  21716 C USAGE:    CALL ????????(????)
  21717 C   INPUT ARGUMENT LIST:
  21718 C     ??????   - ???????????????????????????????????????????????
  21719 C
  21720 C   OUTPUT ARGUMENT LIST:
  21721 C     ??????   - ???????????????????????????????????????????????
  21722 C
  21723 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  21724 C     ??????   - ???????????????????????????????????????????????
  21725 C
  21726 C   OUTPUT FILES:
  21727 C     ??????   - ???????????????????????????????????????????????
  21728 C
  21729 C REMARKS: ?????????????????????????????????????????????????????
  21730 C
  21731 C ATTRIBUTES:
  21732 C   LANGUAGE: FORTRAN 90
  21733 C   MACHINE:  NCEP WCOSS
  21734 C
  21735 C$$$
  21736       SUBROUTINE SLIQBG
  21737 C
  21738 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  21739 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  21740       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  21741      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  21742       COMMON /S2BCDC/ DX0,DX1,DX2,DY0,DY1,DY2,CBCBF(8),XYSDCP(2)
  21743       COMMON /S2QRBG/ QMRBG(7,4,4),QNRBG(7,4,4)
  21744 C
  21745       SAVE
  21746 C
  21747       CHARACTER*125 IDSPC
  21748 C
  21749 C     ** STRUCTURE OF QMRBG (I,J,K)  (FOR ANY K)
  21750 C   I   J= 1         2         3         4
  21751 C              QUADRATURE INTEGRAL TERMS               THE ORDER OF DERI
  21752 C   1     1,1       1,2       1,3       1,4                 IN QUADRATUR
  21753 C   2     2,2       2,3       2,4       2,5
  21754 C   3     3,3       3,4       3,5       3,6              K=1   0TH ORDER
  21755 C   4    MX,MX    MX1,MX    MX2,MX    MX3,MX               2   1ST ORDER
  21756 C   5   MXX,MXX    MX,MXX   MX1,MXX   MX2,MXX              3   2ND ORDER
  21757 C                                                          4   3RD ORDER
  21758 C     +++ NO BOUNDARY TERMS ARE USED IN SLACCO VERSION OF SLADDQ (OCT 79
  21759 C               BOUNDARY-POINT TERMS
  21760 C        .......(SYMMETRIC)........  (ANTI-SYM)

Page 629         Source Listing                  SLIQBG
2017-04-18 11:09                                 syndata.f

  21761 C   6     1,1       1,2       2,2       1,2
  21762 C   7    MX,MX     MX,MXX   MXX,MXX    MX,MXX
  21763 C     ORTHO- AND PARA-ELEMENTS ARE PARTIAL QUADRATURES OF BF AND DERIVAT
  21764 C
  21765       DIMENSION QO11(4),QO12(4),QO22(4),QP11(4),QP12(4),QP22(4)
  21766 C
  21767       DATA QO11/0.530357142857143, 0.63750, 2.250, 20.25/,
  21768      1     QO12/0.057589285714286, 0.13125,-1.125, -6.75/,
  21769      2     QO22/0.008928571428571, 0.11250, 0.750,  2.25/,
  21770      3     QP11/0.416517857142857,-0.54375,-1.125,-20.25/,
  21771      4     QP12/0.026785714285714,-0.22500, 0.000,  6.75/,
  21772      5     QP22/0.000446428571429,-0.01875, 0.375, -2.25/
  21773 C
  21774 C     ** NO-PRINT
  21775 C
  21776 C     FOR INTERIOR NODES
  21777 C
  21778       QMRBG(3,1,:)=2.*(QO11(:)+QO22(:))
  21779       QMRBG(3,2,:)= 2.*QO12(:)+QP11(:)
  21780       QMRBG(3,3,:)= 2.*QP12(:)
  21781       QMRBG(3,4,:)=    QP22(:)
  21782 C
  21783       QNRBG(3,:,:)=QMRBG(3,:,:)
  21784 C
  21785       DO K=1,4
  21786          DO I=2,4
  21787             QMRBG(I,3,K)=QMRBG(3,3,K)
  21788             QNRBG(I,3,K)=QNRBG(3,3,K)
  21789          ENDDO
  21790          DO I=1,5
  21791             QMRBG(I,4,K)=QMRBG(3,4,K)
  21792             QNRBG(I,4,K)=QNRBG(3,4,K)
  21793          ENDDO
  21794       ENDDO
  21795 C
  21796 C     FOR BOUNDARY NODES
  21797 C
  21798       ZM11=4.*CBCBF(1)
  21799       ZM12=4.*CBCBF(2)
  21800       ZMX1=4.*CBCBF(3)
  21801       ZMX2=4.*CBCBF(4)
  21802       ZN11=4.*CBCBF(5)
  21803       ZN12=4.*CBCBF(6)
  21804       ZNX1=4.*CBCBF(7)
  21805       ZNX2=4.*CBCBF(8)
  21806 C
  21807       DO 22 K=1,4
  21808       QMRBG(1,1,K)=QO11(K)+QO22(K)+ZM11*(2.*QO12(K)+ZM11*QO22(K))
  21809       QNRBG(1,1,K)=QO11(K)+QO22(K)+ZN11*(2.*QO12(K)+ZN11*QO22(K))
  21810       QMRBG(1,2,K)=QP11(K)+QO12(K)+ZM12*(QO12(K)+ZM11*QO22(K))
  21811      1             +ZM11*QP12(K)
  21812       QNRBG(1,2,K)=QP11(K)+QO12(K)+ZN12*(QO12(K)+ZN11*QO22(K))
  21813      1             +ZN11*QP12(K)
  21814       QMRBG(1,3,K)=2.*QP12(K)+ZM11*QP22(K)
  21815       QNRBG(1,3,K)=2.*QP12(K)+ZN11*QP22(K)
  21816       QMRBG(2,1,K)=2.*QO11(K)+QO22(K)+ZM12*(2.*QP12(K)+ZM12*QO22(K))
  21817       QNRBG(2,1,K)=2.*QO11(K)+QO22(K)+ZN12*(2.*QP12(K)+ZN12*QO22(K))

Page 630         Source Listing                  SLIQBG
2017-04-18 11:09                                 syndata.f

  21818       QMRBG(2,2,K)=2.*QO12(K)+QP11(K)+ZM12*QP22(K)
  21819       QNRBG(2,2,K)=2.*QO12(K)+QP11(K)+ZN12*QP22(K)
  21820       QMRBG(4,1,K)=2.*QO11(K)+QO22(K)+ZMX2*(2.*QP12(K)+ZMX2*QO22(K))
  21821       QNRBG(4,1,K)=2.*QO11(K)+QO22(K)+ZNX2*(2.*QP12(K)+ZNX2*QO22(K))
  21822       QMRBG(4,2,K)=2.*QO12(K)+QP11(K)+ZMX2*QP22(K)
  21823       QNRBG(4,2,K)=2.*QO12(K)+QP11(K)+ZNX2*QP22(K)
  21824       QMRBG(5,1,K)=QO11(K)+QO22(K)+ZMX1*(2.*QO12(K)+ZMX1*QO22(K))
  21825       QNRBG(5,1,K)=QO11(K)+QO22(K)+ZNX1*(2.*QO12(K)+ZNX1*QO22(K))
  21826       QMRBG(5,2,K)=QP11(K)+QO12(K)+ZMX2*(QO12(K)+ZMX1*QO22(K))
  21827      1             +ZMX1*QP12(K)
  21828       QNRBG(5,2,K)=QP11(K)+QO12(K)+ZNX2*(QO12(K)+ZNX1*QO22(K))
  21829      1             +ZNX1*QP12(K)
  21830       QMRBG(5,3,K)= 2.*QP12(K)+ZMX1*QP22(K)
  21831       QNRBG(5,3,K)= 2.*QP12(K)+ZNX1*QP22(K)
  21832    22 CONTINUE
  21833 C
  21834 C     +++ BOUNDARY LINE AND CORNER TERMS ARE NOT USED ANY MORE (OCT 79)
  21835 C
  21836       QMRBG(6:7,:,:)=0.
  21837       QNRBG(6:7,:,:)=0.
  21838 C
  21839 C     ** PRINT OUTPUT, UNCOMMENT THESE
  21840 C
  21841 CCCC  WRITE(6,880) KBCTYP(1),KBCTYP(2),ZM11,ZM12,ZMX1,ZMX2
  21842 CCCC  WRITE(6,881) (((QMRBG(I,J,K),J=1,4),I=1,7),K=1,4)
  21843 CCCC  WRITE(6,880) KBCTYP(3),KBCTYP(4),ZN11,ZN12,ZNX1,ZNX2
  21844 CCCC  WRITE(6,881) (((QNRBG(I,J,K),J=1,4),I=1,7),K=1,4)
  21845 CC880 FORMAT(/'.../S2QRBG/... BEFORE DC FACTOR MULTIPLICATION ...',//,
  21846 CCCC 1    11X,I3,13X,I3,/,(7X,2F7.3,2X,2F7.3))
  21847 CC881 FORMAT(//,(5(5X,4F16.10,/),/,2(5X,4F16.10,/)))
  21848 C
  21849 C     ** MULTIPLY DC-FACTORS **
  21850 C
  21851       DO K=2,4
  21852          KK=2*(K-1)
  21853          Z1=XYSDCP(1)**KK
  21854          Z2=XYSDCP(2)**KK
  21855          DO J=1,4
  21856             DO I=1,7
  21857                QMRBG(I,J,K)=Z1*QMRBG(I,J,K)
  21858                QNRBG(I,J,K)=Z2*QNRBG(I,J,K)
  21859             ENDDO
  21860          ENDDO
  21861       ENDDO
  21862 C
  21863       RETURN
  21864 
  21865       END

Page 631         Source Listing                  SLIQBG
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sliqbg_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 22                         Label  21832                                                          21807                             
 CBCBF                      Scalar 21742    R(4)            4     1     8        COM              21798,21799,21800,21801,21802,2180
                                                                                                  3,21804,21805                     
 DX0                        Scalar 21742    R(4)            4           scalar   COM                                                
 DX1                        Scalar 21742    R(4)            4           scalar   COM                                                
 DX2                        Scalar 21742    R(4)            4           scalar   COM                                                
 DY0                        Scalar 21742    R(4)            4           scalar   COM                                                
 DY1                        Scalar 21742    R(4)            4           scalar   COM                                                
 DY2                        Scalar 21742    R(4)            4           scalar   COM                                                
 I                          Local  21786    I(4)            4           scalar   SAVE             21786,21787,21788,21790,21791,2179
                                                                                                  2,21856,21857,21858               
 IDSPC                      Scalar 21741    CHAR            125         scalar   COM                                                
 ISRCD                      Scalar 21740    I(4)            4           scalar   COM                                                
 J                          Local  21855    I(4)            4           scalar   SAVE             21855,21857,21858                 
 JPD                        Scalar 21740    I(4)            4           scalar   COM                                                
 K                          Local  21785    I(4)            4           scalar   SAVE             21785,21787,21788,21791,21792,2180
                                                                                                  7,21808,21809,21810,21811,21812,21
                                                                                                  813,21814,21815,21816,21817,21818,
                                                                                                  21819,21820,21821,21822,21823,2182
                                                                                                  4,21825,21826,21827,21828,21829,21
                                                                                                  830,21831,21851,21852,21857,21858 
 KBCTYP                     Scalar 21740    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 21740    I(4)            4           scalar   COM                                                
 KK                         Local  21852    I(4)            4           scalar   SAVE             21852,21853,21854                 
 MX                         Scalar 21740    I(4)            4           scalar   COM                                                
 NX                         Scalar 21740    I(4)            4           scalar   COM                                                
 QMRBG                      Scalar 21743    R(4)            4     3     112      COM              21778,21779,21780,21781,21783,2178
                                                                                                  7,21791,21808,21810,21814,21816,21
                                                                                                  818,21820,21822,21824,21826,21830,
                                                                                                  21836,21857                       
 QNRBG                      Scalar 21743    R(4)            4     3     112      COM              21783,21788,21792,21809,21812,2181
                                                                                                  5,21817,21819,21821,21823,21825,21
                                                                                                  828,21831,21837,21858             
 QO11                       Local  21765    R(4)            4     1     4        SAVE             21767,21778,21808,21809,21816,2181
                                                                                                  7,21820,21821,21824,21825         
 QO12                       Local  21765    R(4)            4     1     4        SAVE             21768,21779,21808,21809,21810,2181
                                                                                                  2,21818,21819,21822,21823,21824,21
                                                                                                  825,21826,21828                   
 QO22                       Local  21765    R(4)            4     1     4        SAVE             21769,21778,21808,21809,21810,2181
                                                                                                  2,21816,21817,21820,21821,21824,21
                                                                                                  825,21826,21828                   
 QP11                       Local  21765    R(4)            4     1     4        SAVE             21770,21779,21810,21812,21818,2181
                                                                                                  9,21822,21823,21826,21828         
 QP12                       Local  21765    R(4)            4     1     4        SAVE             21771,21780,21811,21813,21814,2181

Page 632         Source Listing                  SLIQBG
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  5,21816,21817,21820,21821,21827,21
                                                                                                  829,21830,21831                   
 QP22                       Local  21765    R(4)            4     1     4        SAVE             21772,21781,21814,21815,21818,2181
                                                                                                  9,21822,21823,21830,21831         
 S2BCDC                     Common 21742                                64       SAVE                                               
 S2PRIC                     Common 21740                                217      SAVE                                               
 S2QRBG                     Common 21743                                896      SAVE                                               
 SLIQBG                     Subr   21736                                                                                            
 XM1                        Scalar 21741    R(4)            4           scalar   COM                                                
 XML                        Scalar 21740    R(4)            4           scalar   COM                                                
 XMR                        Scalar 21740    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 21741    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 21741    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 21741    R(4)            4     1     2        COM                                                
 XYSDCP                     Scalar 21742    R(4)            4     1     2        COM              21853,21854                       
 YN1                        Scalar 21741    R(4)            4           scalar   COM                                                
 YNB                        Scalar 21740    R(4)            4           scalar   COM                                                
 YNT                        Scalar 21740    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 21741    R(4)            4           scalar   COM                                                
 Z1                         Local  21853    R(4)            4           scalar   SAVE             21853,21857                       
 Z2                         Local  21854    R(4)            4           scalar   SAVE             21854,21858                       
 ZM11                       Local  21798    R(4)            4           scalar   SAVE             21798,21808,21810,21811,21814     
 ZM12                       Local  21799    R(4)            4           scalar   SAVE             21799,21810,21816,21818           
 ZMX1                       Local  21800    R(4)            4           scalar   SAVE             21800,21824,21826,21827,21830     
 ZMX2                       Local  21801    R(4)            4           scalar   SAVE             21801,21820,21822,21826           
 ZN11                       Local  21802    R(4)            4           scalar   SAVE             21802,21809,21812,21813,21815     
 ZN12                       Local  21803    R(4)            4           scalar   SAVE             21803,21812,21817,21819           
 ZNX1                       Local  21804    R(4)            4           scalar   SAVE             21804,21825,21828,21829,21831     
 ZNX2                       Local  21805    R(4)            4           scalar   SAVE             21805,21821,21823,21828           

Page 633         Source Listing                  SLIQBG
2017-04-18 11:09                                 syndata.f

  21866 
  21867 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  21868 C                .      .    .                                       .
  21869 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  21870 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  21871 C
  21872 C ABSTRACT: ??????????????????????????????????????????????????????????
  21873 C   ??????????????????????????????????????????????????????????????????
  21874 C
  21875 C PROGRAM HISTORY LOG:
  21876 C ????-??-??  S. J. LORD
  21877 C
  21878 C USAGE:    CALL ????????(????)
  21879 C   INPUT ARGUMENT LIST:
  21880 C     ??????   - ???????????????????????????????????????????????
  21881 C
  21882 C   OUTPUT ARGUMENT LIST:
  21883 C     ??????   - ???????????????????????????????????????????????
  21884 C
  21885 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  21886 C     ??????   - ???????????????????????????????????????????????
  21887 C
  21888 C   OUTPUT FILES:
  21889 C     ??????   - ???????????????????????????????????????????????
  21890 C
  21891 C REMARKS: ?????????????????????????????????????????????????????
  21892 C
  21893 C ATTRIBUTES:
  21894 C   LANGUAGE: FORTRAN 90
  21895 C   MACHINE:  NCEP WCOSS
  21896 C
  21897 C$$$
  21898       SUBROUTINE SLADDQ(M,PNMR)
  21899 C
  21900 C     +++ NO BOUNDARY LINE AND CORNER TERMS OF QMRBG,QNRBG ARE USED
  21901 C         IN THE SLACCO VERSION OF SLADDQ (OCT 79)
  21902 C
  21903       PARAMETER (MDIM=35,NDIM=35)
  21904 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  21905 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  21906       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  21907      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  21908       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  21909      1                 YNC(NDIM),COSYN(NDIM)
  21910       COMMON /S2MACQ/ MXX1,MX1,MX2,MX3,NXX1,NX1,NX2,NX3
  21911       COMMON /S2QRBG/ QMRBG(7,4,4),QNRBG(7,4,4)
  21912 C
  21913       CHARACTER*125 IDSPC
  21914 C
  21915       SAVE
  21916 C
  21917       DIMENSION PNMR(NDIM,4,4)
  21918       DIMENSION QNMG(5,4,4),QAS1(4),QASX(4),MG(4)
  21919 C
  21920       QAS1=0.
  21921       QASX=0.
  21922       QNMG=0.

Page 634         Source Listing                  SLADDQ
2017-04-18 11:09                                 syndata.f

  21923 C
  21924 C     SET UP INDEXING PARAMETERS FOR OMRBG
  21925 C
  21926       IF(M-MX1.EQ.0) THEN
  21927          GO TO 18
  21928       ELSE  IF(M-MX1.GT.0)  THEN
  21929          GO TO 15
  21930       END IF
  21931       IF(M-2.EQ.0)  THEN
  21932          GO TO 12
  21933       ELSE  IF(M-2.GT.0)  THEN
  21934          GO TO 13
  21935       END IF
  21936 C
  21937 C     FOR M=1
  21938 C
  21939       GO TO 13
  21940 C
  21941 C     FOR M=2
  21942 C
  21943    12 CONTINUE
  21944 C
  21945 C     FOR ALL M THAT IS .LT. MX1
  21946 C
  21947    13 CONTINUE
  21948       MRX=4
  21949 C
  21950       DO MR=1,MRX
  21951       MG(MR)=MIN(M,3)
  21952       ENDDO
  21953 C
  21954       GO TO 20
  21955    15 CONTINUE
  21956       IF(M-MX.LT.0) THEN
  21957          GO TO 18
  21958       ELSE  IF(M-MX.GT.0)  THEN
  21959          GO TO 17
  21960       END IF
  21961 C
  21962 C     FOR M=MX
  21963 C
  21964       GO TO 18
  21965 C
  21966 C     FOR M=MXX
  21967 C
  21968    17 CONTINUE
  21969 C
  21970 C     FOR M=MX1,MX,MXX
  21971 C
  21972    18 CONTINUE
  21973       MRX=MXX1-M
  21974 C
  21975       DO MR=1,MRX
  21976       MG(MR)=MR+M-MX3
  21977       ENDDO
  21978 C
  21979 C     ** TEST KDCTYP (ORDER OF FILTER)

Page 635         Source Listing                  SLADDQ
2017-04-18 11:09                                 syndata.f

  21980 C     === TYPE 2 AND 3 ARE PRESENTLY ALLOWED ===
  21981 C
  21982    20 CONTINUE
  21983       IF(KDCTYP-2.LT.0)  THEN
  21984          GO TO 90
  21985       ELSE  IF(KDCTYP-2.EQ.0) THEN
  21986          GO TO 50
  21987       END IF
  21988 C
  21989 C     THIRD ORDER CONSTRAINT ... KDCTYP=3
  21990 C
  21991       DO 34 MR=1,MRX
  21992       MGZ=MG(MR)
  21993 C
  21994 C     SYMMETRIC BODY TERMS
  21995 C
  21996       DO NR=1,4
  21997       DO NG=1,5
  21998       QNMG(NG,NR,MR)=    QMRBG(MGZ,MR,4)*QNRBG(NG,NR,1)
  21999      1               +3.*QMRBG(MGZ,MR,3)*QNRBG(NG,NR,2)
  22000      2               +3.*QMRBG(MGZ,MR,2)*QNRBG(NG,NR,3)
  22001      3                  +QMRBG(MGZ,MR,1)*QNRBG(NG,NR,4)
  22002       ENDDO
  22003       ENDDO
  22004    34 CONTINUE
  22005 C
  22006 C     ** ADD QNMG TO PNMR
  22007 C
  22008    40 CONTINUE
  22009       DO MR=1,MRX
  22010          DO NR=1,4
  22011             DO N=1,2
  22012                PNMR(N,NR,MR)=PNMR(N,NR,MR)+QNMG(N,NR,MR)
  22013             ENDDO
  22014             DO N=3,NX2
  22015                PNMR(N,NR,MR)=PNMR(N,NR,MR)+QNMG(3,NR,MR)
  22016             ENDDO
  22017          ENDDO
  22018          DO N=NX1,NXX
  22019             NRX=NXX1-N
  22020             DO NR=1,NRX
  22021                PNMR(N,NR,MR)=PNMR(N,NR,MR)+QNMG(NR+5-NRX,NR,MR)
  22022             ENDDO
  22023          ENDDO
  22024 C
  22025 C     PLACE THE ANTISYMMETRIC TERMS IN THE LOWER CORNER OF PNMR
  22026 C       ** NO FLAG IS SET AS WAS IN THE EARLIER PRACTICE IN VALSE AND AN
  22027 C
  22028          PNMR(NXX,3,MR)=QAS1(MR)
  22029          PNMR(NX ,4,MR)=QASX(MR)
  22030       ENDDO
  22031 C
  22032       RETURN
  22033 C
  22034 C     SECOND ORDER CONSTRAINT ... KDCTYP=2
  22035 C
  22036    50 CONTINUE

Page 636         Source Listing                  SLADDQ
2017-04-18 11:09                                 syndata.f

  22037       DO 54 MR=1,MRX
  22038       MGZ=MG(MR)
  22039       QNMG(:,:,MR)=    QMRBG(MGZ,MR,3)*QNRBG(1:5,:,1)
  22040      1             +2.*QMRBG(MGZ,MR,2)*QNRBG(1:5,:,2)
  22041      2                +QMRBG(MGZ,MR,1)*QNRBG(1:5,:,3)
  22042    54 CONTINUE
  22043 C
  22044       GO TO 40
  22045    90 CONTINUE
  22046       WRITE(6,890) KDCTYP
  22047   890 FORMAT(/' === SLADDQ DOES NOT ACCEPT   KDCTYP=',I2)
  22048       CALL ABRT1(' SLADDQ',890)
  22049       END


ENTRY POINTS

  Name               
                     
 sladdq_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 12                         Label  21943                                                          21932                             
 13                         Label  21947                                                          21934,21939                       
 15                         Label  21955                                                          21929                             
 17                         Label  21968                                                          21959                             
 18                         Label  21972                                                          21927,21957,21964                 
 20                         Label  21982                                                          21954                             
 34                         Label  22004                                                          21991                             
 40                         Label  22008                                                          22044                             
 50                         Label  22036                                                          21986                             
 54                         Label  22042                                                          22037                             
 890                        Label  22047                                                          22046                             
 90                         Label  22045                                                          21984                             
 ABRT1                      Subr   22048                                                          22048                             
 COSYN                      Scalar 21909    R(4)            4     1     35       COM                                                
 DXM                        Scalar 21908    R(4)            4           scalar   COM                                                
 DYN                        Scalar 21908    R(4)            4           scalar   COM                                                
 IDSPC                      Scalar 21907    CHAR            125         scalar   COM                                                
 ISRCD                      Scalar 21906    I(4)            4           scalar   COM                                                
 JPD                        Scalar 21906    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 21906    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 21906    I(4)            4           scalar   COM              21983,21985,22046                 
 M                          Dummy  21898    I(4)            4           scalar   ARG,INOUT        21926,21928,21931,21933,21951,2195
                                                                                                  6,21958,21973,21976               
 MDIM                       Param  21903    I(4)            4           scalar                    21908                             
 MG                         Local  21918    I(4)            4     1     4        SAVE             21951,21976,21992,22038           
 MGZ                        Local  21992    I(4)            4           scalar   SAVE             21992,21998,21999,22000,22001,2203
                                                                                                  8,22039,22040,22041               
 MIN                        Func   21951                                scalar                    21951                             
 MR                         Local  21950    I(4)            4           scalar   SAVE             21950,21951,21975,21976,21991,2199
                                                                                                  2,21998,21999,22000,22001,22009,22
                                                                                                  012,22015,22021,22028,22029,22037,

Page 637         Source Listing                  SLADDQ
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  22038,22039,22040,22041           
 MRX                        Local  21948    I(4)            4           scalar   SAVE             21948,21950,21973,21975,21991,2200
                                                                                                  9,22037                           
 MX                         Scalar 21906    I(4)            4           scalar   COM              21956,21958                       
 MX1                        Scalar 21910    I(4)            4           scalar   COM              21926,21928                       
 MX2                        Scalar 21910    I(4)            4           scalar   COM                                                
 MX3                        Scalar 21910    I(4)            4           scalar   COM              21976                             
 MXX                        Scalar 21908    I(4)            4           scalar   COM                                                
 MXX1                       Scalar 21910    I(4)            4           scalar   COM              21973                             
 N                          Local  22011    I(4)            4           scalar   SAVE             22011,22012,22014,22015,22018,2201
                                                                                                  9,22021                           
 NDIM                       Param  21903    I(4)            4           scalar                    21908,21909,21917                 
 NG                         Local  21997    I(4)            4           scalar   SAVE             21997,21998,21999,22000,22001     
 NR                         Local  21996    I(4)            4           scalar   SAVE             21996,21998,21999,22000,22001,2201
                                                                                                  0,22012,22015,22020,22021         
 NRX                        Local  22019    I(4)            4           scalar   SAVE             22019,22020,22021                 
 NX                         Scalar 21906    I(4)            4           scalar   COM              22029                             
 NX1                        Scalar 21910    I(4)            4           scalar   COM              22018                             
 NX2                        Scalar 21910    I(4)            4           scalar   COM              22014                             
 NX3                        Scalar 21910    I(4)            4           scalar   COM                                                
 NXX                        Scalar 21908    I(4)            4           scalar   COM              22018,22028                       
 NXX1                       Scalar 21910    I(4)            4           scalar   COM              22019                             
 PNMR                       Dummy  21898    R(4)            4     3     560      ARG,INOUT        22012,22015,22021,22028,22029     
 QAS1                       Local  21918    R(4)            4     1     4        SAVE             21920,22028                       
 QASX                       Local  21918    R(4)            4     1     4        SAVE             21921,22029                       
 QMRBG                      Scalar 21911    R(4)            4     3     112      COM              21998,21999,22000,22001,22039,2204
                                                                                                  0,22041                           
 QNMG                       Local  21918    R(4)            4     3     80       SAVE             21922,21998,22012,22015,22021,2203
                                                                                                  9                                 
 QNRBG                      Scalar 21911    R(4)            4     3     112      COM              21998,21999,22000,22001,22039,2204
                                                                                                  0,22041                           
 S2MACQ                     Common 21910                                32       SAVE                                               
 S2NODE                     Common 21908                                716      SAVE                                               
 S2PRIC                     Common 21906                                217      SAVE                                               
 S2QRBG                     Common 21911                                896      SAVE                                               
 SLADDQ                     Subr   21898                                                                                            
 XM                         Scalar 21908    R(4)            4     1     35       COM                                                
 XM1                        Scalar 21907    R(4)            4           scalar   COM                                                
 XMC                        Scalar 21908    R(4)            4     1     35       COM                                                
 XML                        Scalar 21906    R(4)            4           scalar   COM                                                
 XMR                        Scalar 21906    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 21907    R(4)            4           scalar   COM                                                
 XYBCWL                     Scalar 21907    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 21907    R(4)            4     1     2        COM                                                
 YN                         Scalar 21908    R(4)            4     1     35       COM                                                
 YN1                        Scalar 21907    R(4)            4           scalar   COM                                                
 YNB                        Scalar 21906    R(4)            4           scalar   COM                                                
 YNC                        Scalar 21909    R(4)            4     1     35       COM                                                
 YNT                        Scalar 21906    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 21907    R(4)            4           scalar   COM                                                

Page 638         Source Listing                  SLADDQ
2017-04-18 11:09                                 syndata.f

  22050 
  22051 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22052 C                .      .    .                                       .
  22053 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22054 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22055 C
  22056 C ABSTRACT: ??????????????????????????????????????????????????????????
  22057 C   ??????????????????????????????????????????????????????????????????
  22058 C
  22059 C PROGRAM HISTORY LOG:
  22060 C ????-??-??  S. J. LORD
  22061 C
  22062 C USAGE:    CALL ????????(????)
  22063 C   INPUT ARGUMENT LIST:
  22064 C     ??????   - ???????????????????????????????????????????????
  22065 C
  22066 C   OUTPUT ARGUMENT LIST:
  22067 C     ??????   - ???????????????????????????????????????????????
  22068 C
  22069 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  22070 C     ??????   - ???????????????????????????????????????????????
  22071 C
  22072 C   OUTPUT FILES:
  22073 C     ??????   - ???????????????????????????????????????????????
  22074 C
  22075 C REMARKS: ?????????????????????????????????????????????????????
  22076 C
  22077 C ATTRIBUTES:
  22078 C   LANGUAGE: FORTRAN 90
  22079 C   MACHINE:  NCEP WCOSS
  22080 C
  22081 C$$$
  22082       SUBROUTINE ADEXXX
  22083       PARAMETER (NDIM=35)
  22084 C
  22085 C     ** SECONDARY PARAMETERS FOR COMPILATION
  22086 C
  22087       PARAMETER (NSDIM=NDIM*NDIM)
  22088 C
  22089 C     DUMMY ARGUMENTS ARE NOW IN BLANK COMMON FOR VAX-11
  22090 C
  22091       COMMON/AAA/AMM(NDIM,NDIM),AMR(NSDIM,3),AML(NSDIM,3,3),DMM(NSDIM),
  22092      1          E(NSDIM,3,3),ANS(NSDIM),CCD(NDIM,NDIM),CCF(NDIM,NDIM)
  22093       COMMON /MADCON/ MAD1,MADX,MAD,MM0,MR1,MR2,MR3,ML1,ML2,ML3,MRX,MLX
  22094 C
  22095       SAVE
  22096 
  22097 C-----------------------------------------------------------------------
  22098 
  22099 C
  22100       ENTRY CLRADE
  22101       CALL CLRANS(AMM)
  22102       CALL CLRANS(DMM)
  22103       CALL CLRANS(ANS)
  22104 C
  22105       DO J=1,3
  22106          CALL CLRANS(AMR(:,J))

Page 639         Source Listing                  ADEXXX
2017-04-18 11:09                                 syndata.f

  22107          DO I=1,3
  22108             CALL CLRANS(AML(:,I,J))
  22109             CALL CLRANS(E(:,I,J))
  22110          ENDDO
  22111       ENDDO
  22112 C
  22113       RETURN
  22114 
  22115 C-----------------------------------------------------------------------
  22116 
  22117 C
  22118       ENTRY AMRTOL
  22119       CALL NSTPS0(AMR(:,1),AML(:,MR1,MM0))
  22120       CALL NSTPS0(AMR(:,2),AML(:,MR2,MM0))
  22121       CALL NSTPS0(AMR(:,3),AML(:,MR3,MM0))
  22122       RETURN
  22123 
  22124 C-----------------------------------------------------------------------
  22125 
  22126 C
  22127       ENTRY CALDMM
  22128 C
  22129 C     GET MATRICES AMM AND AMR
  22130 C
  22131       CALL GETAMR(AMM,AMR,MAD)
  22132 C
  22133 C     DO MATRIX MANIPULATION OF TRICYCLING
  22134 C
  22135       CALL CCOAMR(MAD)
  22136 C
  22137 C     PUT ANS INTO AMM
  22138 C
  22139       CALL NSTOS0(AMM,ANS)
  22140 C
  22141 C     ANS=AML*E+ANS
  22142 C
  22143       CALL MLXN9A(AML,E,ANS,MM0)
  22144 C
  22145 C     DMM=INV(ANS)
  22146 C
  22147       CALL NEGINV(ANS,DMM)
  22148 C
  22149 C     WRITE AML,DMM, AND E TO MSKEF
  22150 C
  22151       CALL SLEFW1(AML(:,MM0,ML1),AML(:,MM0,ML2),AML(:,MM0,ML3),DMM,
  22152      1            E(:,ML1,MM0),E(:,ML2,MM0),MAD)
  22153       RETURN
  22154 
  22155 C-----------------------------------------------------------------------
  22156 
  22157 C
  22158       ENTRY CALELR
  22159 C
  22160 C     ** E MUST HAVE BEEN INITIALIZED TO ZERO, TO GET E ZEROED AT FRONT
  22161 C        E AT THE TAIL END WILL BE ZEROED BY NON-PERIODIC GETAMR
  22162 C        ** SPECIAL CLEARING OF E FOR PERIODIC BC IS OMITTED IN THIS VER
  22163 C     ** IT IS OK TO CALCULATE E(1,MM0,MR) IN THE ORDER OF MR3,MR2,MR1.

Page 640         Source Listing                  ADEXXX
2017-04-18 11:09                                 syndata.f

  22164 C        BUT MR3 MUST BE THE LAST, FOR E(1,ML1,MR) AND E(1,ML2,MR)
  22165 C
  22166       GO TO (14,13,12,11),MRX+1
  22167    11 CALL NSXNS0(DMM,AMR(:,3),E(:,MM0,MR3))
  22168    12 CALL NSTOS0(AMR(:,2),ANS)
  22169       CALL MLXN9A(AML,E,ANS,MR2)
  22170       CALL NSXNS0(DMM,ANS,E(:,MM0,MR2))
  22171    13 CALL NSTOS0(AMR(:,1),ANS)
  22172       CALL MLXN9A(AML,E,ANS,MR1)
  22173       CALL NSXNS0(DMM,ANS,E(:,MM0,MR1))
  22174    14 GO TO (15,16,17,18),MRX+1
  22175 C
  22176 C     ** CLEARING E(1,MM0,MR) AT THE TAIL END
  22177 C     ** CORRESPONDING E(1,ML1,MR) AND E(1,ML2,MR) ARE CLEARED BELOW 20
  22178 C
  22179    15 CALL CLRANS (E(:,MM0,MR1))
  22180    16 CALL CLRANS (E(:,MM0,MR2))
  22181    17 CALL CLRANS (E(:,MM0,MR3))
  22182    18 CONTINUE
  22183 C
  22184 C     WRITE E TO MSKEZ
  22185 C
  22186       CALL SLEFW2(E(:,MM0,MR1),E(:,MM0,MR2),E(:,MM0,MR3),MAD)
  22187 C
  22188 C     ** MR3 MUST BE THE LAST
  22189 C        USE NS0XNS(BS,AS,CS) AT MR3, BECAUSE
  22190 C        E(1,MLZ,MM0) AND E(1,MLZ,MR3) SHARE THE SAME ADDRESS
  22191 C
  22192 C  20 CONTINUE
  22193       IF(MLX.LE.0) GO TO 28
  22194       MLZ=ML1
  22195 C
  22196       DO L=1,2
  22197       CALL NSXNSA(E(:,MLZ,MM0),E(:,MM0,MR1),E(:,MLZ,MR1))
  22198       CALL NSXNSA(E(:,MLZ,MM0),E(:,MM0,MR2),E(:,MLZ,MR2))
  22199       CALL NS0XNS(E(:,MLZ,MM0),E(:,MM0,MR3),E(:,MLZ,MR3))
  22200       IF(MLX.LE.L) GO TO 28
  22201       MLZ=ML2
  22202       ENDDO
  22203 C
  22204    28 CONTINUE
  22205       RETURN
  22206       END

Page 641         Source Listing                  ADEXXX
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 adexxx_               amrtol_               caldmm_               calelr_               clrade_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  22167                                                          22166                             
 12                         Label  22168                                                          22166                             
 13                         Label  22171                                                          22166                             
 14                         Label  22174                                                          22166                             
 15                         Label  22179                                                          22174                             
 16                         Label  22180                                                          22174                             
 17                         Label  22181                                                          22174                             
 18                         Label  22182                                                          22174                             
 28                         Label  22204                                                          22193,22200                       
 AAA                        Common 22091                                127400   SAVE                                               
 ADEXXX                     Subr   22082                                                                                            
 AML                        Scalar 22091    R(4)            4     3     11025    COM              22108,22119,22120,22121,22143,2215
                                                                                                  1,22169,22172                     
 AMM                        Scalar 22091    R(4)            4     2     1225     COM              22101,22131,22139                 
 AMR                        Scalar 22091    R(4)            4     2     3675     COM              22106,22119,22120,22121,22131,2216
                                                                                                  7,22168,22171                     
 AMRTOL                     Subr   22118                                                                                            
 ANS                        Scalar 22092    R(4)            4     1     1225     COM              22103,22139,22143,22147,22168,2216
                                                                                                  9,22170,22171,22172,22173         
 CALDMM                     Subr   22127                                                                                            
 CALELR                     Subr   22158                                                                                            
 CCD                        Scalar 22092    R(4)            4     2     1225     COM                                                
 CCF                        Scalar 22092    R(4)            4     2     1225     COM                                                
 CCOAMR                     Subr   22135                                                          22135                             
 CLRADE                     Subr   22100                                                                                            
 CLRANS                     Subr   22101                                                          22101,22102,22103,22106,22108,2210
                                                                                                  9,22179,22180,22181               
 DMM                        Scalar 22091    R(4)            4     1     1225     COM              22102,22147,22151,22167,22170,2217
                                                                                                  3                                 
 E                          Scalar 22092    R(4)            4     3     11025    COM              22109,22143,22152,22167,22169,2217
                                                                                                  0,22172,22173,22179,22180,22181,22
                                                                                                  186,22197,22198,22199             
 GETAMR                     Subr   22131                                                          22131                             
 I                          Local  22107    I(4)            4           scalar   SAVE             22107,22108,22109                 
 J                          Local  22105    I(4)            4           scalar   SAVE             22105,22106,22108,22109           
 L                          Local  22196    I(4)            4           scalar   SAVE             22196,22200                       
 MAD                        Scalar 22093    I(4)            4           scalar   COM              22131,22135,22152,22186           
 MAD1                       Scalar 22093    I(4)            4           scalar   COM                                                
 MADCON                     Common 22093                                48       SAVE                                               
 MADX                       Scalar 22093    I(4)            4           scalar   COM                                                
 ML1                        Scalar 22093    I(4)            4           scalar   COM              22151,22152,22194                 
 ML2                        Scalar 22093    I(4)            4           scalar   COM              22151,22152,22201                 
 ML3                        Scalar 22093    I(4)            4           scalar   COM              22151                             
 MLX                        Scalar 22093    I(4)            4           scalar   COM              22193,22200                       

Page 642         Source Listing                  ADEXXX
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MLXN9A                     Subr   22143                                                          22143,22169,22172                 
 MLZ                        Local  22194    I(4)            4           scalar   SAVE             22194,22197,22198,22199,22201     
 MM0                        Scalar 22093    I(4)            4           scalar   COM              22119,22120,22121,22143,22151,2215
                                                                                                  2,22167,22170,22173,22179,22180,22
                                                                                                  181,22186,22197,22198,22199       
 MR1                        Scalar 22093    I(4)            4           scalar   COM              22119,22172,22173,22179,22186,2219
                                                                                                  7                                 
 MR2                        Scalar 22093    I(4)            4           scalar   COM              22120,22169,22170,22180,22186,2219
                                                                                                  8                                 
 MR3                        Scalar 22093    I(4)            4           scalar   COM              22121,22167,22181,22186,22199     
 MRX                        Scalar 22093    I(4)            4           scalar   COM              22166,22174                       
 NDIM                       Param  22083    I(4)            4           scalar                    22087,22091,22092                 
 NEGINV                     Subr   22147                                                          22147                             
 NS0XNS                     Subr   22199                                                          22199                             
 NSDIM                      Param  22087    I(4)            4           scalar                    22091,22092                       
 NSTOS0                     Subr   22139                                                          22139,22168,22171                 
 NSTPS0                     Subr   22119                                                          22119,22120,22121                 
 NSXNS0                     Subr   22167                                                          22167,22170,22173                 
 NSXNSA                     Subr   22197                                                          22197,22198                       
 SLEFW1                     Subr   22151                                                          22151                             
 SLEFW2                     Subr   22186                                                          22186                             

Page 643         Source Listing                  ADEXXX
2017-04-18 11:09                                 syndata.f

  22207 
  22208 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22209 C                .      .    .                                       .
  22210 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22211 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22212 C
  22213 C ABSTRACT: ??????????????????????????????????????????????????????????
  22214 C   ??????????????????????????????????????????????????????????????????
  22215 C
  22216 C PROGRAM HISTORY LOG:
  22217 C ????-??-??  S. J. LORD
  22218 C
  22219 C USAGE:    CALL ????????(????)
  22220 C   INPUT ARGUMENT LIST:
  22221 C     ??????   - ???????????????????????????????????????????????
  22222 C
  22223 C   OUTPUT ARGUMENT LIST:
  22224 C     ??????   - ???????????????????????????????????????????????
  22225 C
  22226 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  22227 C     ??????   - ???????????????????????????????????????????????
  22228 C
  22229 C   OUTPUT FILES:
  22230 C     ??????   - ???????????????????????????????????????????????
  22231 C
  22232 C REMARKS: ?????????????????????????????????????????????????????
  22233 C
  22234 C ATTRIBUTES:
  22235 C   LANGUAGE: FORTRAN 90
  22236 C   MACHINE:  NCEP WCOSS
  22237 C
  22238 C$$$
  22239       SUBROUTINE CCOSUB(MAD)
  22240 C
  22241 C     ENTRY CCOAMR (MAD)
  22242 C     ** MODIFY AMM AND AMR ACCORDING TO CORNER CONDITIONS SET BY SLOCCO
  22243 C        CCOAMR MUST FOLLOW GETAMR IN CALDMM OF ADEXXX
  22244 C
  22245       PARAMETER (MDIM=35,NDIM=35)
  22246       PARAMETER (NSDIM=NDIM*NDIM)
  22247 C
  22248       COMMON/AAA/AMM(NDIM,NDIM),AMR(NSDIM,3),AML(NSDIM,3,3),DMM(NSDIM),
  22249      1          E(NSDIM,3,3),ANS(NSDIM),CCD(NDIM,NDIM),CCF(NDIM,NDIM)
  22250 C
  22251       SAVE
  22252 C
  22253       DIMENSION AR1(NSDIM),AR2(NSDIM),AR3(NSDIM)
  22254       EQUIVALENCE (AR1(1),AMR(1,1)),(AR2(1),AMR(1,2)),(AR3(1),AMR(1,3))
  22255 C
  22256       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  22257      1                 YNC(NDIM),COSYN(NDIM)
  22258 C
  22259       COMMON /S2CORN/ CORN(4,4)
  22260       DIMENSION CCMM(32),CCR1(32),CCR2(32)
  22261 
  22262 C-----------------------------------------------------------------------
  22263 

Page 644         Source Listing                  CCOSUB
2017-04-18 11:09                                 syndata.f

  22264 C
  22265       ENTRY SLACCO
  22266 C
  22267 C       ++ SET CONSTANTS AND ROUTES
  22268 C
  22269       MX3=MXX-4
  22270       NX=NXX-1
  22271       mgo1 = 20
  22272       mgo2 = 30
  22273       mgox2 = 40
  22274       mgox1 = 50
  22275       mgox = 60
  22276       mgoxx = 70
  22277       IF(CORN(1,1).GT.0. .OR. CORN(1,2).GT.0.) GO TO 5
  22278       mgo1 = 13
  22279       mgo2 = 13
  22280     5 IF(CORN(1,3).GT.0. .OR. CORN(1,4).GT.0.) GO TO 8
  22281       mgox2 = 13
  22282       mgox1 = 13
  22283       mgox = 13
  22284       mgoxx = 13
  22285     8 RETURN
  22286 
  22287 C-----------------------------------------------------------------------
  22288 
  22289 C
  22290       ENTRY CCOAMR(MAD)
  22291       MCCO=MIN(MAD,3)+IDIM(MAD,MX3)
  22292       GO TO (11,12,13,14,15,16,17),MCCO
  22293    11 CONTINUE
  22294       if(mgo1.eq.20)  then
  22295          go to 20
  22296       else if(mgo1.eq.13)  then
  22297          return
  22298       else
  22299          call ABRT1(' CCOMAR',11)
  22300       endif
  22301    12 CONTINUE
  22302       if(mgo2.eq.30)  then
  22303          go to 30
  22304       else if(mgo2.eq.13)  then
  22305          return
  22306       else
  22307          call ABRT1(' CCOMAR',12)
  22308       endif
  22309    13 CONTINUE
  22310       RETURN
  22311    14 CONTINUE
  22312       if(mgox2.eq.40)  then
  22313          go to 40
  22314       else if(mgox2.eq.13)  then
  22315          return
  22316       else
  22317          call ABRT1(' CCOMAR',14)
  22318       endif
  22319    15 CONTINUE
  22320       if(mgox1.eq.50)  then

Page 645         Source Listing                  CCOSUB
2017-04-18 11:09                                 syndata.f

  22321          go to 50
  22322       else if(mgox1.eq.13)  then
  22323          return
  22324       else
  22325          call ABRT1(' CCOMAR',15)
  22326       endif
  22327    16 CONTINUE
  22328       if(mgox.eq.60)  then
  22329          go to 60
  22330       else if(mgox.eq.13)  then
  22331          return
  22332       else
  22333          call ABRT1(' CCOMAR',16)
  22334       endif
  22335    17 CONTINUE
  22336       if(mgoxx.eq.70)  then
  22337          go to 70
  22338       else if(mgoxx.eq.13)  then
  22339          return
  22340       else
  22341          call ABRT1(' CCOMAR',17)
  22342       endif
  22343 C
  22344 C     ** M=1 **
  22345 C       ++ SET CORNER CONDITION MATRICES, CCD AND CCF,FOR CORNER 1 AND 2
  22346 C       ++ FIRST CLEAR CCD AND CCF
  22347 C
  22348    20 CALL CLRANS(CCD)
  22349       CALL CLRANS(CCF)
  22350 C
  22351       DO  N=1,NXX
  22352          CCD(N,N)=1.0
  22353       ENDDO
  22354 C
  22355       CCD(1,1)=1.-CORN(1,1)
  22356       CCD(1,2)=CORN(2,1)
  22357       CCF(1,1)=CORN(3,1)
  22358       CCF(1,2)=CORN(4,1)
  22359       CCD(NXX,NXX)=1.-CORN(1,2)
  22360       CCD(NXX,NX )=CORN(2,2)
  22361       CCF(NXX,NXX)=CORN(3,2)
  22362       CCF(NXX,NX )=CORN(4,2)
  22363 C
  22364 C     ++ CALCULATE AND SAVE ADDITIVE TERMS FOR M=2,
  22365 C        BEFORE AMM,AMR AT M=1 ARE MODIFIED
  22366 C        ANS=TRANSPOSE(CCF)*AR3
  22367 C
  22368       CALL NTXNS0(CCF,AR3,ANS)
  22369 C
  22370 C     PUT 2-D ANS INTO 3-D CCR2
  22371 C
  22372       CALL CC2SAV(ANS,CCR2)
  22373 C
  22374 C     ANS=TRANSPOSE(CCF)*AR2
  22375 C
  22376       CALL NTXNS0(CCF,AR2,ANS)
  22377 C

Page 646         Source Listing                  CCOSUB
2017-04-18 11:09                                 syndata.f

  22378 C     PUT 2-D ANS INTO 3-D CCR1
  22379 C
  22380       CALL CC2SAV(ANS,CCR1)
  22381 C
  22382 C     ANS=AMM*CCF
  22383 C
  22384       CALL NSXNS0(AMM,CCF,ANS)
  22385 C
  22386 C     ANS=TRANSPOSE(CCF)*ANS
  22387 C
  22388       CALL NTXNS0(CCF,ANS,ANS)
  22389 C
  22390 C     ANS=TRANSPOSE(AR1)*CCF+ANS
  22391 C
  22392       CALL NTXNSA(AR1,CCF,ANS)
  22393 C
  22394 C     ANS=TRANSPOSE(CCF)*AR1+ANS
  22395 C
  22396       CALL NTXNSA(CCF,AR1,ANS)
  22397 C
  22398 C     PUT 2-D ANS INTO 3-D CCMM
  22399 C
  22400       CALL CC2SAV(ANS,CCMM)
  22401 C
  22402 C       ++ MODIFY AMM AND AMR OF M=1.  MUST BE DONE BACKWARD IN MR
  22403 C     AR3=TRANSPOSE(CCD)*AR3
  22404 C
  22405       CALL NTXNS0(CCD,AR3,AR3)
  22406 C
  22407 C     AR2=TRANSPOSE(CCD)*AR2
  22408 C
  22409       CALL NTXNS0(CCD,AR2,AR2)
  22410 C
  22411 C     AR1=TRANSPOSE(CCD)*AR1
  22412 C
  22413       CALL NTXNS0(CCD,AR1,AR1)
  22414 C
  22415 C     ANS=AMM*CCF
  22416 C
  22417       CALL NSXNS0(AMM,CCF,ANS)
  22418 C
  22419 C     AR1=TRANSPOSE(CCD)*ANS+AR1
  22420 C
  22421       CALL NTXNSA(CCD,ANS,AR1)
  22422 C
  22423 C     ANS=AMM*CCD
  22424 C
  22425       CALL NSXNS0(AMM,CCD,ANS)
  22426 C
  22427 C     AMM=TRANSPOSE(CCD)*ANS+AMM
  22428 C
  22429       CALL NTXNS0(CCD,ANS,AMM)
  22430 C
  22431 C       ++ FOR LITTLE JOSEPH ++
  22432 C
  22433       AMM(1,1)    =CORN(1,1)+AMM(1,1)
  22434       AMM(NXX,NXX)=CORN(1,2)+AMM(NXX,NXX)

Page 647         Source Listing                  CCOSUB
2017-04-18 11:09                                 syndata.f

  22435       RETURN
  22436 C
  22437 C     ** M=2 **
  22438 C     ++ ADD THE SAVED TERMS
  22439 C
  22440    30 CALL CC2ADD(AR2,CCR2)
  22441       CALL CC2ADD(AR1,CCR1)
  22442       CALL CC2ADD(AMM,CCMM)
  22443       RETURN
  22444 C
  22445 C     ** M=MX2 **
  22446 C       ++ SET CORNER CONDITION MATRICES, CCD AND CCF,FOR CORNER 3 AND 4
  22447 C
  22448    40 CALL CLRANS(CCD)
  22449       CALL CLRANS(CCF)
  22450 C
  22451       DO  N=1,NXX
  22452          CCD(N,N)=1.0
  22453       ENDDO
  22454 C
  22455       CCD(1,1)=1.-CORN(1,3)
  22456       CCD(1,2)=CORN(2,3)
  22457       CCF(1,1)=CORN(3,3)
  22458       CCF(1,2)=CORN(4,3)
  22459       CCD(NXX,NXX)=1.-CORN(1,4)
  22460       CCD(NXX,NX )=CORN(2,4)
  22461       CCF(NXX,NXX)=CORN(3,4)
  22462       CCF(NXX,NX )=CORN(4,4)
  22463 C
  22464 C     ++ MODIFY AMR FOR M=MX2.  MUST BE DOE FORWARD IN MR
  22465 C     AR2=AR3*CCF+AR2
  22466 C
  22467       CALL NSXNSA(AR3,CCF,AR2)
  22468 C
  22469 C     AR3=CCD*AR3
  22470 C
  22471       CALL NS0XNS(AR3,CCD,AR3)
  22472       RETURN
  22473 C
  22474 C     ** M=MX1 **
  22475 C     AR1=AR2*CCF+AR1
  22476 C
  22477    50 CALL NSXNSA(AR2,CCF,AR1)
  22478 C
  22479 C     AR2=CCD*AR2
  22480 C
  22481       CALL NS0XNS(AR2,CCD,AR2)
  22482       RETURN
  22483 C
  22484 C     ** M=MX **
  22485 C     ++ GTAMXX GETS AMM OF MXX, AHEAD OF THE NORMAL M-SEQUENCE
  22486 C        CALCULATIONS MUST PROCEED FORWARD IN MR
  22487 C     AMM=AR1*CCF*AMM
  22488 C
  22489    60 CALL NSXNSA(AR1,CCF,AMM)
  22490 C
  22491 C     ANS=TRANSPOSE(AMM)

Page 648         Source Listing                  CCOSUB
2017-04-18 11:09                                 syndata.f

  22492 C
  22493       CALL NSTPS0(AMM,ANS)
  22494 C
  22495 C     ANS=TRANSPOSE(AR1)*CFF+ANS
  22496 C
  22497       CALL NTXNSA(AR1,CCF,ANS)
  22498 C
  22499 C     AMM=TRANSPOSE(ANS)
  22500 C
  22501       CALL NSTPS0(ANS,AMM)
  22502 C
  22503 C     ADD ROWM TO NEW PNMR AND QNMG AND RETURN NEW MATRIX
  22504 C
  22505       CALL GTAMXX(ANS)
  22506 C
  22507 C     ANS=CCF*ANS
  22508 C
  22509       CALL NS0XNS(ANS,CCF,ANS)
  22510 C
  22511 C     AMM=TRANSPOSE(CCF)*ANS*AMM
  22512 C
  22513       CALL NTXNSA(CCF,ANS,AMM)
  22514 C
  22515 C     AR1=CCD*AR1
  22516 C
  22517       CALL NS0XNS(AR1,CCD,AR1)
  22518 C
  22519 C     ADD ROWM, NEW PNMR, AND NEW QNMG AND PUT BACK INTO ANS
  22520 C
  22521       CALL GTAMXX(ANS)
  22522 C
  22523 C     ANS=TRANSPOSE(CCF)*ANS
  22524 C
  22525       CALL NTXNS0(CCF,ANS,ANS)
  22526 C
  22527 C     AR1=ANS*CCD+AR1
  22528 C
  22529       CALL NSXNSA(ANS,CCD,AR1)
  22530       RETURN
  22531 C
  22532 C     ** M=MXX **
  22533 C     ANS=TRANSPOSE(CCD)*AMM
  22534 C
  22535    70 CALL NTXNS0(CCD,AMM,ANS)
  22536 C
  22537 C     AMM=ANS*CCD
  22538 C
  22539       CALL NSXNS0(ANS,CCD,AMM)
  22540 C
  22541 C     ++ FOR LITTLE JOSEPH ++
  22542 C
  22543       AMM(1,1)    =CORN(1,3)+AMM(1,1)
  22544       AMM(NXX,NXX)=CORN(1,4)+AMM(NXX,NXX)
  22545       RETURN
  22546       END

Page 649         Source Listing                  CCOSUB
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 ccoamr_               ccosub_               slacco_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  22293                                                          22292                             
 12                         Label  22301                                                          22292                             
 13                         Label  22309                                                          22292                             
 14                         Label  22311                                                          22292                             
 15                         Label  22319                                                          22292                             
 16                         Label  22327                                                          22292                             
 17                         Label  22335                                                          22292                             
 20                         Label  22348                                                          22295                             
 30                         Label  22440                                                          22303                             
 40                         Label  22448                                                          22313                             
 5                          Label  22280                                                          22277                             
 50                         Label  22477                                                          22321                             
 60                         Label  22489                                                          22329                             
 70                         Label  22535                                                          22337                             
 8                          Label  22285                                                          22280                             
 AAA                        Common 22248                                127400   SAVE                                               
 ABRT1                      Subr   22299                                                          22299,22307,22317,22325,22333,2234
                                                                                                  1                                 
 AML                        Scalar 22248    R(4)            4     3     11025    COM                                                
 AMM                        Scalar 22248    R(4)            4     2     1225     COM              22384,22417,22425,22429,22433,2243
                                                                                                  4,22442,22489,22493,22501,22513,22
                                                                                                  535,22539,22543,22544             
 AMR                        Scalar 22248    R(4)            4     2     3675     COM                                                
 ANS                        Scalar 22249    R(4)            4     1     1225     COM              22368,22372,22376,22380,22384,2238
                                                                                                  8,22392,22396,22400,22417,22421,22
                                                                                                  425,22429,22493,22497,22501,22505,
                                                                                                  22509,22513,22521,22525,22529,2253
                                                                                                  5,22539                           
 AR1                        Scalar 22253    R(4)            4     1     1225     COM              22392,22396,22413,22421,22441,2247
                                                                                                  7,22489,22497,22517,22529         
 AR2                        Scalar 22253    R(4)            4     1     1225     COM              22376,22409,22440,22467,22477,2248
                                                                                                  1                                 
 AR3                        Scalar 22253    R(4)            4     1     1225     COM              22368,22405,22467,22471           
 CC2ADD                     Subr   22440                                                          22440,22441,22442                 
 CC2SAV                     Subr   22372                                                          22372,22380,22400                 
 CCD                        Scalar 22249    R(4)            4     2     1225     COM              22348,22352,22355,22356,22359,2236
                                                                                                  0,22405,22409,22413,22421,22425,22
                                                                                                  429,22448,22452,22455,22456,22459,
                                                                                                  22460,22471,22481,22517,22529,2253
                                                                                                  5,22539                           
 CCF                        Scalar 22249    R(4)            4     2     1225     COM              22349,22357,22358,22361,22362,2236
                                                                                                  8,22376,22384,22388,22392,22396,22
                                                                                                  417,22449,22457,22458,22461,22462,
                                                                                                  22467,22477,22489,22497,22509,2251

Page 650         Source Listing                  CCOSUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,22525                           
 CCMM                       Local  22260    R(4)            4     1     32       SAVE             22400,22442                       
 CCOAMR                     Subr   22290                                                                                            
 CCOSUB                     Subr   22239                                                                                            
 CCR1                       Local  22260    R(4)            4     1     32       SAVE             22380,22441                       
 CCR2                       Local  22260    R(4)            4     1     32       SAVE             22372,22440                       
 CLRANS                     Subr   22348                                                          22348,22349,22448,22449           
 CORN                       Scalar 22259    R(4)            4     2     16       COM              22277,22280,22355,22356,22357,2235
                                                                                                  8,22359,22360,22361,22362,22433,22
                                                                                                  434,22455,22456,22457,22458,22459,
                                                                                                  22460,22461,22462,22543,22544     
 COSYN                      Scalar 22257    R(4)            4     1     35       COM                                                
 DMM                        Scalar 22248    R(4)            4     1     1225     COM                                                
 DXM                        Scalar 22256    R(4)            4           scalar   COM                                                
 DYN                        Scalar 22256    R(4)            4           scalar   COM                                                
 E                          Scalar 22249    R(4)            4     3     11025    COM                                                
 GTAMXX                     Subr   22505                                                          22505,22521                       
 IDIM                       Func   22291                                scalar                    22291                             
 MAD                        Dummy  22239    I(4)            4           scalar   ARG,INOUT        22291                             
 MCCO                       Local  22291    I(4)            4           scalar   SAVE             22291,22292                       
 MDIM                       Param  22245    I(4)            4           scalar                    22256                             
 MGO1                       Local  22271    I(4)            4           scalar   SAVE             22271,22278,22294,22296           
 MGO2                       Local  22272    I(4)            4           scalar   SAVE             22272,22279,22302,22304           
 MGOX                       Local  22275    I(4)            4           scalar   SAVE             22275,22283,22328,22330           
 MGOX1                      Local  22274    I(4)            4           scalar   SAVE             22274,22282,22320,22322           
 MGOX2                      Local  22273    I(4)            4           scalar   SAVE             22273,22281,22312,22314           
 MGOXX                      Local  22276    I(4)            4           scalar   SAVE             22276,22284,22336,22338           
 MIN                        Func   22291                                scalar                    22291                             
 MX3                        Local  22269    I(4)            4           scalar   SAVE             22269,22291                       
 MXX                        Scalar 22256    I(4)            4           scalar   COM              22269                             
 N                          Local  22351    I(4)            4           scalar   SAVE             22351,22352,22451,22452           
 NDIM                       Param  22245    I(4)            4           scalar                    22246,22248,22249,22256,22257     
 NS0XNS                     Subr   22471                                                          22471,22481,22509,22517           
 NSDIM                      Param  22246    I(4)            4           scalar                    22248,22249,22253                 
 NSTPS0                     Subr   22493                                                          22493,22501                       
 NSXNS0                     Subr   22384                                                          22384,22417,22425,22539           
 NSXNSA                     Subr   22467                                                          22467,22477,22489,22529           
 NTXNS0                     Subr   22368                                                          22368,22376,22388,22405,22409,2241
                                                                                                  3,22429,22525,22535               
 NTXNSA                     Subr   22392                                                          22392,22396,22421,22497,22513     
 NX                         Local  22270    I(4)            4           scalar   SAVE             22270,22360,22362,22460,22462     
 NXX                        Scalar 22256    I(4)            4           scalar   COM              22270,22351,22359,22360,22361,2236
                                                                                                  2,22434,22451,22459,22460,22461,22
                                                                                                  462,22544                         
 S2CORN                     Common 22259                                64       SAVE                                               
 S2NODE                     Common 22256                                716      SAVE                                               
 SLACCO                     Subr   22265                                                                                            
 XM                         Scalar 22256    R(4)            4     1     35       COM                                                
 XMC                        Scalar 22256    R(4)            4     1     35       COM                                                
 YN                         Scalar 22256    R(4)            4     1     35       COM                                                
 YNC                        Scalar 22257    R(4)            4     1     35       COM                                                

Page 651         Source Listing                  CCOSUB
2017-04-18 11:09                                 syndata.f

  22547 
  22548 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22549 C                .      .    .                                       .
  22550 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22551 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22552 C
  22553 C ABSTRACT: ??????????????????????????????????????????????????????????
  22554 C   ??????????????????????????????????????????????????????????????????
  22555 C
  22556 C PROGRAM HISTORY LOG:
  22557 C ????-??-??  S. J. LORD
  22558 C
  22559 C USAGE:    CALL ????????(????)
  22560 C   INPUT ARGUMENT LIST:
  22561 C     ??????   - ???????????????????????????????????????????????
  22562 C
  22563 C   OUTPUT ARGUMENT LIST:
  22564 C     ??????   - ???????????????????????????????????????????????
  22565 C
  22566 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  22567 C     ??????   - ???????????????????????????????????????????????
  22568 C
  22569 C   OUTPUT FILES:
  22570 C     ??????   - ???????????????????????????????????????????????
  22571 C
  22572 C REMARKS: ?????????????????????????????????????????????????????
  22573 C
  22574 C ATTRIBUTES:
  22575 C   LANGUAGE: FORTRAN 90
  22576 C   MACHINE:  NCEP WCOSS
  22577 C
  22578 C$$$
  22579       SUBROUTINE CC2SUB(ANZ,CCZ)
  22580 C
  22581 C          ENTRY CC2ADD (ANZ,CCZ)
  22582 C
  22583       PARAMETER (MDIM=35,NDIM=35)
  22584 C
  22585       DIMENSION ANZ(NDIM,NDIM),CCZ(4,4,2)
  22586 C
  22587       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  22588      1                 YNC(NDIM),COSYN(NDIM)
  22589 C
  22590       SAVE
  22591 
  22592 C-----------------------------------------------------------------------
  22593 
  22594 C
  22595       ENTRY CC2SAV(ANZ,CCZ)
  22596 C
  22597 C     PUT 2 DIMENSIONED ANZ INTO 3 DIMENSIONED CCZ
  22598 C
  22599       N0=NXX-4
  22600 C
  22601       CCZ(:,:,1)=ANZ(1:4,1:4)
  22602       CCZ(:,:,2)=ANZ(N0+1:N0+4,N0+1:N0+4)
  22603 C

Page 652         Source Listing                  CC2SUB
2017-04-18 11:09                                 syndata.f

  22604       RETURN
  22605 
  22606 C-----------------------------------------------------------------------
  22607 
  22608 C
  22609       ENTRY CC2ADD(ANZ,CCZ)
  22610 C
  22611 C     ANZ=ANZ=CCZ
  22612 C
  22613       DO I=1,4
  22614       DO J=1,4
  22615       ANZ(I,J)=ANZ(I,J)+CCZ(I,J,1)
  22616       ANZ(I+N0,J+N0)=ANZ(I+N0,J+N0)+CCZ(I,J,2)
  22617       ENDDO
  22618       ENDDO
  22619 C
  22620       RETURN
  22621       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 cc2add_               cc2sav_               cc2sub_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANZ                        Dummy  22579    R(4)            4     2     1225     ARG,INOUT        22601,22602,22615,22616           
 CC2ADD                     Subr   22609                                                                                            
 CC2SAV                     Subr   22595                                                                                            
 CC2SUB                     Subr   22579                                                                                            
 CCZ                        Dummy  22579    R(4)            4     3     32       ARG,INOUT        22601,22602,22615,22616           
 COSYN                      Scalar 22588    R(4)            4     1     35       COM                                                
 DXM                        Scalar 22587    R(4)            4           scalar   COM                                                
 DYN                        Scalar 22587    R(4)            4           scalar   COM                                                
 I                          Local  22613    I(4)            4           scalar   SAVE             22613,22615,22616                 
 J                          Local  22614    I(4)            4           scalar   SAVE             22614,22615,22616                 
 MDIM                       Param  22583    I(4)            4           scalar                    22587                             
 MXX                        Scalar 22587    I(4)            4           scalar   COM                                                
 N0                         Local  22599    I(4)            4           scalar   SAVE             22599,22602,22616                 
 NDIM                       Param  22583    I(4)            4           scalar                    22585,22587,22588                 
 NXX                        Scalar 22587    I(4)            4           scalar   COM              22599                             
 S2NODE                     Common 22587                                716      SAVE                                               
 XM                         Scalar 22587    R(4)            4     1     35       COM                                                
 XMC                        Scalar 22587    R(4)            4     1     35       COM                                                
 YN                         Scalar 22587    R(4)            4     1     35       COM                                                
 YNC                        Scalar 22588    R(4)            4     1     35       COM                                                

Page 653         Source Listing                  CC2SUB
2017-04-18 11:09                                 syndata.f

  22622 
  22623 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22624 C                .      .    .                                       .
  22625 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22626 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22627 C
  22628 C ABSTRACT: ??????????????????????????????????????????????????????????
  22629 C   ??????????????????????????????????????????????????????????????????
  22630 C
  22631 C PROGRAM HISTORY LOG:
  22632 C ????-??-??  S. J. LORD
  22633 C
  22634 C USAGE:    CALL ????????(????)
  22635 C   INPUT ARGUMENT LIST:
  22636 C     ??????   - ???????????????????????????????????????????????
  22637 C
  22638 C   OUTPUT ARGUMENT LIST:
  22639 C     ??????   - ???????????????????????????????????????????????
  22640 C
  22641 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  22642 C     ??????   - ???????????????????????????????????????????????
  22643 C
  22644 C   OUTPUT FILES:
  22645 C     ??????   - ???????????????????????????????????????????????
  22646 C
  22647 C REMARKS: ?????????????????????????????????????????????????????
  22648 C
  22649 C ATTRIBUTES:
  22650 C   LANGUAGE: FORTRAN 90
  22651 C   MACHINE:  NCEP WCOSS
  22652 C
  22653 C$$$
  22654       SUBROUTINE MLXN9A(AML,AN9,ANS,MRZ)
  22655 C
  22656 C     ANS=AML*AN9*ANS, THE PARTS OF WHICH DEPEND ON MRZ
  22657 C
  22658       PARAMETER (NDIM=35)
  22659 C
  22660 C     ** SECONDARY PARAMETERS FOR COMPILATION
  22661 C
  22662       PARAMETER (NSDIM=NDIM*NDIM)
  22663       COMMON /MADCON/ MAD1,MADX,MAD,MM0,MR1,MR2,MR3,ML1,ML2,ML3,MRX,MLX
  22664 C
  22665       SAVE
  22666 C
  22667 C     DUMMY ARGUMENTS
  22668 C
  22669       DIMENSION AML(NSDIM,3,3),AN9(NSDIM,3,3),ANS(NSDIM)
  22670 C
  22671 C     ** THE OUTPUT WILL BE IN ANS
  22672 C
  22673       GO TO (14,13,12,11),MLX+1
  22674    11 CALL NSXNSA(AML(:,MM0,ML3),AN9(:,ML3,MRZ),ANS)
  22675    12 CALL NSXNSA(AML(:,MM0,ML2),AN9(:,ML2,MRZ),ANS)
  22676    13 CALL NSXNSA(AML(:,MM0,ML1),AN9(:,ML1,MRZ),ANS)
  22677    14 RETURN
  22678       END

Page 654         Source Listing                  MLXN9A
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 mlxn9a_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  22674                                                          22673                             
 12                         Label  22675                                                          22673                             
 13                         Label  22676                                                          22673                             
 14                         Label  22677                                                          22673                             
 AML                        Dummy  22654    R(4)            4     3     11025    ARG,INOUT        22674,22675,22676                 
 AN9                        Dummy  22654    R(4)            4     3     11025    ARG,INOUT        22674,22675,22676                 
 ANS                        Dummy  22654    R(4)            4     1     1225     ARG,INOUT        22674,22675,22676                 
 MAD                        Scalar 22663    I(4)            4           scalar   COM                                                
 MAD1                       Scalar 22663    I(4)            4           scalar   COM                                                
 MADCON                     Common 22663                                48       SAVE                                               
 MADX                       Scalar 22663    I(4)            4           scalar   COM                                                
 ML1                        Scalar 22663    I(4)            4           scalar   COM              22676                             
 ML2                        Scalar 22663    I(4)            4           scalar   COM              22675                             
 ML3                        Scalar 22663    I(4)            4           scalar   COM              22674                             
 MLX                        Scalar 22663    I(4)            4           scalar   COM              22673                             
 MLXN9A                     Subr   22654                                                                                            
 MM0                        Scalar 22663    I(4)            4           scalar   COM              22674,22675,22676                 
 MR1                        Scalar 22663    I(4)            4           scalar   COM                                                
 MR2                        Scalar 22663    I(4)            4           scalar   COM                                                
 MR3                        Scalar 22663    I(4)            4           scalar   COM                                                
 MRX                        Scalar 22663    I(4)            4           scalar   COM                                                
 MRZ                        Dummy  22654    I(4)            4           scalar   ARG,INOUT        22674,22675,22676                 
 NDIM                       Param  22658    I(4)            4           scalar                    22662                             
 NSDIM                      Param  22662    I(4)            4           scalar                    22669                             
 NSXNSA                     Subr   22674                                                          22674,22675,22676                 

Page 655         Source Listing                  MLXN9A
2017-04-18 11:09                                 syndata.f

  22679 
  22680 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22681 C                .      .    .                                       .
  22682 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22683 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22684 C
  22685 C ABSTRACT: ??????????????????????????????????????????????????????????
  22686 C   ??????????????????????????????????????????????????????????????????
  22687 C
  22688 C PROGRAM HISTORY LOG:
  22689 C ????-??-??  S. J. LORD
  22690 C
  22691 C USAGE:    CALL ????????(????)
  22692 C   INPUT ARGUMENT LIST:
  22693 C     ??????   - ???????????????????????????????????????????????
  22694 C
  22695 C   OUTPUT ARGUMENT LIST:
  22696 C     ??????   - ???????????????????????????????????????????????
  22697 C
  22698 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  22699 C     ??????   - ???????????????????????????????????????????????
  22700 C
  22701 C   OUTPUT FILES:
  22702 C     ??????   - ???????????????????????????????????????????????
  22703 C
  22704 C REMARKS: ?????????????????????????????????????????????????????
  22705 C
  22706 C ATTRIBUTES:
  22707 C   LANGUAGE: FORTRAN 90
  22708 C   MACHINE:  NCEP WCOSS
  22709 C
  22710 C$$$
  22711       SUBROUTINE PASSUB(NXX,BR,BS,CS)
  22712 C
  22713 C     ** COLLECTION OF N-MATRIX ROUTINES FOR SPLEFSK
  22714 C     ** PASDXX MUST BE CALLED, ONCE FOR ALL,
  22715 C        BEFORE ANY ENTRIES, BELOW, ARE CALLED.
  22716 C  ++++++++ THE LIST OF N-MATRIX ROUTINES ++++++++
  22717 C    SUB NAMES   ENTRY NAMES            OPERATIONS
  22718 C     PASDXX     NRTOS0(BR,CS)          CS=   BR
  22719 C                NEGINV(BS,CS)          CS=-INV(BS)
  22720 C     PASDSS     NSXNSA(AS,BS,CS)       CS=AS*BS+CS
  22721 C                NSXNS0(AS,BS,CS)       CS=AS*BS
  22722 C                NTXNSA(AS,BS,CS)       CS=TP(AS)*BS+CS
  22723 C                NTXNS0(AS,BS,CS)       CS=TP(AS)*BS
  22724 C                NSTOS0(BS,CS)          CS=   BS
  22725 C                NSTPS0(AS,CS)          CS=TP(AS)
  22726 C                CLRANS (CS)            CS=0.
  22727 C                 .. VARIANTS IN ADDRESS SHARING ..
  22728 C                NS0XNS(BS,AS,CS)       CS=BS*AS
  22729 C     PASDRR     ANRTOD (BR,CD)         CD=   BR
  22730 C         AS,BS,CS  NDIM*NDIM SQUARE MATRICES
  22731 C            BR,CR  NDIM*4 RECTANGLE MATRICES
  22732 C               CD  NDIM*7 RECTANGLE MATRICES (DOUBLE R)
  22733 C         CS,CR,CD  ARE ALWAYS THE OUTPUT
  22734 C         BS OR BR  MAY SHARE THE SAME ADDRESS WITH CS OR CR, RESPECTIVE
  22735 C               AS  MUST HAVE ITS OWN ADDRESS DIFFERENT FROM BS,BR,CS,OR

Page 656         Source Listing                  PASSUB
2017-04-18 11:09                                 syndata.f

  22736 C     ** WORK SPACE IS PROVIDED LOCALLY FOR
  22737 C         ZS(NDIM,NDIM) AND ZD(NDIM,7) IN PASDXX
  22738 C         ZV(NDIM)                     IN PASDSS
  22739 C     ** DO INDEX CONSTANTS ARE GENERATED IN /PASDCC/ BY PASDXX
  22740 C
  22741       PARAMETER (NDIM=35)
  22742 C
  22743       SAVE
  22744 C
  22745 C     DUMMY ARGUMENTS
  22746 C
  22747       DIMENSION BS(NDIM,NDIM),CS(NDIM,NDIM),BSD(NDIM,NDIM)
  22748       DIMENSION BR(NDIM,4)   ,CSD(NDIM,NDIM)
  22749 C
  22750       DOUBLE PRECISION BSD,CSD,DET
  22751 C
  22752 C     LOCAL WORK SPACE
  22753 C
  22754       DIMENSION ZD(NDIM,7)
  22755 C
  22756       COMMON /PASDCC/ IXX,IX,IX1,IX2
  22757 C
  22758 C-----------------------------------------------------------------------
  22759 
  22760 C
  22761 C     ENTRY PASDXX(NXX)    ... MUST BE CALLED TO DEFINE DO INDEX CONSTAN
  22762 C     NXX IS THE NUMBER OF NODAL INTERVALS IN THE Y-DIRECTION
  22763 C
  22764       ENTRY PASDXX(NXX)
  22765       IXX=NXX
  22766       IX =IXX-1
  22767       IX1=IX-1
  22768       IX2=IX-2
  22769       IF(NXX.LE.NDIM) RETURN
  22770       WRITE(6,800) NXX,NDIM
  22771   800 FORMAT(/' === PASDXX FOUND NXX .GT. NDIM ===',3X,2I6)
  22772       CALL ABRT1(' PASDXX',800)
  22773 
  22774 C-----------------------------------------------------------------------
  22775 
  22776 C
  22777       ENTRY NRTOS0(BR,CS)
  22778 C
  22779 C     CS=BR
  22780 C
  22781       CALL ANRTOD (BR,ZD)
  22782 C
  22783       DO I=1,IXX
  22784          CS(I,1:IXX)=0.
  22785          DO J=MAX(I-3,1),MIN(I+3,IXX)
  22786             CS(I,J)=ZD(I,J+4-I)
  22787          ENDDO
  22788       ENDDO
  22789 C
  22790       RETURN
  22791 
  22792 C-----------------------------------------------------------------------

Page 657         Source Listing                  PASSUB
2017-04-18 11:09                                 syndata.f

  22793 
  22794 C
  22795       ENTRY NEGINV(BS,CS)
  22796 C
  22797 C     COPY BS INTO DOUBLE PRECISION ARRAY
  22798 C
  22799       BSD(1:IXX,1:IXX)=BS(1:IXX,1:IXX)
  22800 C
  22801 C     CSD=INV(BSD)
  22802 C
  22803       CALL INVMTX(BSD,NDIM,CSD,NDIM,IXX,DET,ZD,IER)
  22804       IF(IER.GT.1) GO TO 54
  22805 C
  22806       CS(1:IXX,1:IXX)=-CSD(1:IXX,1:IXX)
  22807 C
  22808       RETURN
  22809    54 WRITE(6,854) IER,DET
  22810   854 FORMAT(/' === NEGINV/INVMTX FOUND BS TO BE SINGULAR.   IER=',I2,
  22811      1    3X,D12.3)
  22812       CALL ABRT1(' NEGINV',854)
  22813       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 neginv_               nrtos0_               pasdxx_               passub_             

Page 658         Source Listing                  PASSUB
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 54                         Label  22809                                                          22804                             
 800                        Label  22771                                                          22770                             
 854                        Label  22810                                                          22809                             
 ABRT1                      Subr   22772                                                          22772,22812                       
 ANRTOD                     Subr   22781                                                          22781                             
 BR                         Dummy  22711    R(4)            4     2     140      ARG,INOUT        22781                             
 BS                         Dummy  22711    R(4)            4     2     1225     ARG,INOUT        22799                             
 BSD                        Local  22747    R(8)            8     2     1225     SAVE             22799,22803                       
 CS                         Dummy  22711    R(4)            4     2     1225     ARG,INOUT        22784,22786,22806                 
 CSD                        Local  22748    R(8)            8     2     1225     SAVE             22803,22806                       
 DET                        Local  22750    R(8)            8           scalar   SAVE             22803,22809                       
 I                          Local  22783    I(4)            4           scalar   SAVE             22783,22784,22785,22786           
 IER                        Local  22803    I(4)            4           scalar   SAVE             22803,22804,22809                 
 INVMTX                     Subr   22803                                                          22803                             
 IX                         Scalar 22756    I(4)            4           scalar   COM              22766,22767,22768                 
 IX1                        Scalar 22756    I(4)            4           scalar   COM              22767                             
 IX2                        Scalar 22756    I(4)            4           scalar   COM              22768                             
 IXX                        Scalar 22756    I(4)            4           scalar   COM              22765,22766,22783,22784,22785,2279
                                                                                                  9,22803,22806                     
 J                          Local  22785    I(4)            4           scalar   SAVE             22785,22786                       
 MAX                        Func   22785                                scalar                    22785                             
 MIN                        Func   22785                                scalar                    22785                             
 NDIM                       Param  22741    I(4)            4           scalar                    22747,22748,22754,22769,22770,2280
                                                                                                  3                                 
 NEGINV                     Subr   22795                                                                                            
 NRTOS0                     Subr   22777                                                                                            
 NXX                        Dummy  22711    I(4)            4           scalar   ARG,INOUT        22765,22769,22770                 
 PASDCC                     Common 22756                                16       SAVE                                               
 PASDXX                     Subr   22764                                                                                            
 PASSUB                     Subr   22711                                                                                            
 ZD                         Local  22754    R(4)            4     2     245      SAVE             22781,22786,22803                 

Page 659         Source Listing                  PASSUB
2017-04-18 11:09                                 syndata.f

  22814 
  22815 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22816 C                .      .    .                                       .
  22817 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22818 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22819 C
  22820 C ABSTRACT: ??????????????????????????????????????????????????????????
  22821 C   ??????????????????????????????????????????????????????????????????
  22822 C
  22823 C PROGRAM HISTORY LOG:
  22824 C ????-??-??  S. J. LORD
  22825 C
  22826 C USAGE:    CALL ????????(????)
  22827 C   INPUT ARGUMENT LIST:
  22828 C     ??????   - ???????????????????????????????????????????????
  22829 C
  22830 C   OUTPUT ARGUMENT LIST:
  22831 C     ??????   - ???????????????????????????????????????????????
  22832 C
  22833 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  22834 C     ??????   - ???????????????????????????????????????????????
  22835 C
  22836 C   OUTPUT FILES:
  22837 C     ??????   - ???????????????????????????????????????????????
  22838 C
  22839 C REMARKS: ?????????????????????????????????????????????????????
  22840 C
  22841 C ATTRIBUTES:
  22842 C   LANGUAGE: FORTRAN 90
  22843 C   MACHINE:  NCEP WCOSS
  22844 C
  22845 C$$$
  22846       SUBROUTINE PASDSS(AS,BS,CS)
  22847       PARAMETER (NDIM=35)
  22848 C
  22849       SAVE
  22850 C
  22851 C     DUMMY ARGUMENTS
  22852 C
  22853       DIMENSION AS(NDIM,NDIM),BS(NDIM,NDIM),CS(NDIM,NDIM)
  22854 C
  22855 C     LOCAL WORK SPACE
  22856 C
  22857       DIMENSION ZV(NDIM)
  22858 C
  22859       COMMON /PASDCC/ IXX,IX,IX1,IX2
  22860 
  22861 C-----------------------------------------------------------------------
  22862 
  22863 C
  22864       ENTRY NSXNSA(AS,BS,CS)
  22865 C
  22866 C     CS=AS*BS+CS
  22867 C
  22868       DO J=1,IXX
  22869          ZV(1:IXX)=CS(1:IXX,J)
  22870          DO K=1,IXX

Page 660         Source Listing                  PASDSS
2017-04-18 11:09                                 syndata.f

  22871             DO I=1,IXX
  22872                ZV(I)=AS(I,K)*BS(K,J)+ZV(I)
  22873             ENDDO
  22874          ENDDO
  22875          CS(1:IXX,J)=ZV(1:IXX)
  22876       ENDDO
  22877 C
  22878       RETURN
  22879 
  22880 C-----------------------------------------------------------------------
  22881 
  22882 C
  22883       ENTRY NSXNS0(AS,BS,CS)
  22884 C
  22885 C     CS=AS*BS
  22886 C
  22887       DO J=1,IXX
  22888          ZV(1:IXX)=0.
  22889          DO K=1,IXX
  22890             DO I=1,IXX
  22891                ZV(I)=AS(I,K)*BS(K,J)+ZV(I)
  22892             ENDDO
  22893          ENDDO
  22894          CS(1:IXX,J)=ZV(1:IXX)
  22895       ENDDO
  22896 C
  22897       RETURN
  22898 
  22899 C-----------------------------------------------------------------------
  22900 
  22901 C
  22902       ENTRY NTXNSA(AS,BS,CS)
  22903 C
  22904 C     CS=TRANSPOSE(AS)*BS+CS
  22905 C
  22906       DO J=1,IXX
  22907          ZV(1:IXX)=CS(1:IXX,J)
  22908          DO K=1,IXX
  22909             DO I=1,IXX
  22910                ZV(I)=AS(K,I)*BS(K,J)+ZV(I)
  22911             ENDDO
  22912          ENDDO
  22913          CS(1:IXX,J)=ZV(1:IXX)
  22914       ENDDO
  22915 C
  22916       RETURN
  22917 
  22918 C-----------------------------------------------------------------------
  22919 
  22920 C
  22921       ENTRY NTXNS0(AS,BS,CS)
  22922 C
  22923 C     CS=TRANSPOSE(AS)*BS
  22924 C
  22925       DO J=1,IXX
  22926          ZV(1:IXX)=0.
  22927          DO K=1,IXX

Page 661         Source Listing                  PASDSS
2017-04-18 11:09                                 syndata.f

  22928             DO I=1,IXX
  22929                ZV(I)=AS(K,I)*BS(K,J)+ZV(I)
  22930             ENDDO
  22931          ENDDO
  22932          CS(1:IXX,J)=ZV(1:IXX)
  22933       ENDDO
  22934 C
  22935       RETURN
  22936 
  22937 C-----------------------------------------------------------------------
  22938 
  22939 C
  22940       ENTRY NSTOS0(BS,CS)
  22941 C
  22942 C     PUT BS INTO CS
  22943 C
  22944       CS(1:IXX,1:IXX)=BS(1:IXX,1:IXX)
  22945 C
  22946       RETURN
  22947 
  22948 C-----------------------------------------------------------------------
  22949 
  22950 C
  22951       ENTRY NSTPS0(AS,CS)
  22952 C
  22953 C     CS=TRANSPOSE(AS)
  22954 C
  22955       DO J=1,IXX
  22956          CS(1:IXX,J)=AS(J,1:IXX)
  22957       ENDDO
  22958 C
  22959       RETURN
  22960 
  22961 C-----------------------------------------------------------------------
  22962 
  22963 C
  22964       ENTRY CLRANS (CS)
  22965 C
  22966       CS(1:IXX,1:IXX)=0.
  22967 C
  22968       RETURN
  22969 
  22970 C-----------------------------------------------------------------------
  22971 
  22972 C
  22973       ENTRY NS0XNS(BS,AS,CS)
  22974 C
  22975 C     CS=AS*BS
  22976 C
  22977       DO I=1,IXX
  22978          ZV(1:IXX)=0.
  22979          DO K=1,IXX
  22980             DO J=1,IXX
  22981                ZV(J)=BS(I,K)*AS(K,J)+ZV(J)
  22982             ENDDO
  22983          ENDDO
  22984          CS(I,1:IXX)=ZV(1:IXX)

Page 662         Source Listing                  PASDSS
2017-04-18 11:09                                 syndata.f

  22985       ENDDO
  22986 C
  22987       RETURN
  22988       END


ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 clrans_               nstos0_               nsxns0_               ntxns0_               pasdss_             
 ns0xns_               nstps0_               nsxnsa_               ntxnsa_                                   


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AS                         Dummy  22846    R(4)            4     2     1225     ARG,INOUT        22872,22891,22910,22929,22956,2298
                                                                                                  1                                 
 BS                         Dummy  22846    R(4)            4     2     1225     ARG,INOUT        22872,22891,22910,22929,22944,2298
                                                                                                  1                                 
 CLRANS                     Subr   22964                                                                                            
 CS                         Dummy  22846    R(4)            4     2     1225     ARG,INOUT        22869,22875,22894,22907,22913,2293
                                                                                                  2,22944,22956,22966,22984         
 I                          Local  22871    I(4)            4           scalar   SAVE             22871,22872,22890,22891,22909,2291
                                                                                                  0,22928,22929,22977,22981,22984   
 IX                         Scalar 22859    I(4)            4           scalar   COM                                                
 IX1                        Scalar 22859    I(4)            4           scalar   COM                                                
 IX2                        Scalar 22859    I(4)            4           scalar   COM                                                
 IXX                        Scalar 22859    I(4)            4           scalar   COM              22868,22869,22870,22871,22875,2288
                                                                                                  7,22888,22889,22890,22894,22906,22
                                                                                                  907,22908,22909,22913,22925,22926,
                                                                                                  22927,22928,22932,22944,22955,2295
                                                                                                  6,22966,22977,22978,22979,22980,22
                                                                                                  984                               
 J                          Local  22868    I(4)            4           scalar   SAVE             22868,22869,22872,22875,22887,2289
                                                                                                  1,22894,22906,22907,22910,22913,22
                                                                                                  925,22929,22932,22955,22956,22980,
                                                                                                  22981                             
 K                          Local  22870    I(4)            4           scalar   SAVE             22870,22872,22889,22891,22908,2291
                                                                                                  0,22927,22929,22979,22981         
 NDIM                       Param  22847    I(4)            4           scalar                    22853,22857                       
 NS0XNS                     Subr   22973                                                                                            
 NSTOS0                     Subr   22940                                                                                            
 NSTPS0                     Subr   22951                                                                                            
 NSXNS0                     Subr   22883                                                                                            
 NSXNSA                     Subr   22864                                                                                            
 NTXNS0                     Subr   22921                                                                                            
 NTXNSA                     Subr   22902                                                                                            
 PASDCC                     Common 22859                                16       SAVE                                               
 PASDSS                     Subr   22846                                                                                            
 ZV                         Local  22857    R(4)            4     1     35       SAVE             22869,22872,22875,22888,22891,2289
                                                                                                  4,22907,22910,22913,22926,22929,22
                                                                                                  932,22978,22981,22984             

Page 663         Source Listing                  PASDSS
2017-04-18 11:09                                 syndata.f

  22989 
  22990 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  22991 C                .      .    .                                       .
  22992 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  22993 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  22994 C
  22995 C ABSTRACT: ??????????????????????????????????????????????????????????
  22996 C   ??????????????????????????????????????????????????????????????????
  22997 C
  22998 C PROGRAM HISTORY LOG:
  22999 C ????-??-??  S. J. LORD
  23000 C
  23001 C USAGE:    CALL ????????(????)
  23002 C   INPUT ARGUMENT LIST:
  23003 C     ??????   - ???????????????????????????????????????????????
  23004 C
  23005 C   OUTPUT ARGUMENT LIST:
  23006 C     ??????   - ???????????????????????????????????????????????
  23007 C
  23008 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  23009 C     ??????   - ???????????????????????????????????????????????
  23010 C
  23011 C   OUTPUT FILES:
  23012 C     ??????   - ???????????????????????????????????????????????
  23013 C
  23014 C REMARKS: ?????????????????????????????????????????????????????
  23015 C
  23016 C ATTRIBUTES:
  23017 C   LANGUAGE: FORTRAN 90
  23018 C   MACHINE:  NCEP WCOSS
  23019 C
  23020 C$$$
  23021       SUBROUTINE ANRTOD (BR,CD)
  23022       PARAMETER (NDIM=35)
  23023 C
  23024       SAVE
  23025 C
  23026 C
  23027       DIMENSION BR(NDIM,4),CD(NDIM,7)
  23028       COMMON /PASDCC/ IXX,IX,IX1,IX2
  23029 C
  23030 C
  23031 C      EXPAND BR TO DOUBLE RECTANGLE ARRAY, CD(NDIM,7)
  23032 C     ** THE UN-USED CORNERS OF CD ARE NOT CLEARED.
  23033 C
  23034       CD(1:IXX,4:7)=BR(1:IXX,:)
  23035 C
  23036       DO J=1,3
  23037          DO I=5-J,IXX
  23038             CD(I,J)=BR(I+J-4,5-J)
  23039          ENDDO
  23040       ENDDO
  23041 C
  23042 C
  23043 C     ADD OR SUBTRACT ANTISYMMETRIC TERMS
  23044 C
  23045       CD(1,5)=CD(1,5)+CD(IXX,6)

Page 664         Source Listing                  ANRTOD
2017-04-18 11:09                                 syndata.f

  23046       CD(2,3)=CD(2,3)-CD(IXX,6)
  23047       CD(IXX-1,5)=CD(IXX-1,5)+CD(IXX-1,7)
  23048       CD(IXX  ,3)=CD(IXX  ,3)-CD(IXX-1,7)
  23049       RETURN
  23050 
  23051       END


ENTRY POINTS

  Name               
                     
 anrtod_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANRTOD                     Subr   23021                                                                                            
 BR                         Dummy  23021    R(4)            4     2     140      ARG,INOUT        23034,23038                       
 CD                         Dummy  23021    R(4)            4     2     245      ARG,INOUT        23034,23038,23045,23046,23047,2304
                                                                                                  8                                 
 I                          Local  23037    I(4)            4           scalar   SAVE             23037,23038                       
 IX                         Scalar 23028    I(4)            4           scalar   COM                                                
 IX1                        Scalar 23028    I(4)            4           scalar   COM                                                
 IX2                        Scalar 23028    I(4)            4           scalar   COM                                                
 IXX                        Scalar 23028    I(4)            4           scalar   COM              23034,23037,23045,23046,23047,2304
                                                                                                  8                                 
 J                          Local  23036    I(4)            4           scalar   SAVE             23036,23037,23038                 
 NDIM                       Param  23022    I(4)            4           scalar                    23027                             
 PASDCC                     Common 23028                                16       SAVE                                               

Page 665         Source Listing                  ANRTOD
2017-04-18 11:09                                 syndata.f

  23052 
  23053 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  23054 C                .      .    .                                       .
  23055 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  23056 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  23057 C
  23058 C ABSTRACT: ??????????????????????????????????????????????????????????
  23059 C   ??????????????????????????????????????????????????????????????????
  23060 C
  23061 C PROGRAM HISTORY LOG:
  23062 C ????-??-??  S. J. LORD
  23063 C
  23064 C USAGE:    CALL ????????(????)
  23065 C   INPUT ARGUMENT LIST:
  23066 C     ??????   - ???????????????????????????????????????????????
  23067 C
  23068 C   OUTPUT ARGUMENT LIST:
  23069 C     ??????   - ???????????????????????????????????????????????
  23070 C
  23071 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  23072 C     ??????   - ???????????????????????????????????????????????
  23073 C
  23074 C   OUTPUT FILES:
  23075 C     ??????   - ???????????????????????????????????????????????
  23076 C
  23077 C REMARKS: ?????????????????????????????????????????????????????
  23078 C
  23079 C ATTRIBUTES:
  23080 C   LANGUAGE: FORTRAN 90
  23081 C   MACHINE:  NCEP WCOSS
  23082 C
  23083 C$$$
  23084 C                 SLIMBO **   06/11/84
  23085 C                             SLICCO ADDED FOR CORNER CONDITIONS
  23086 C                             SPTIKA ADDED.   TESTING ROUTINES REMOVED
  23087 C                             PAST REV. 04/04,09,17,20/79
  23088 C                             PAST REV. 05/01,08/,06/01/,07/31/79
  23089 C     ++ ASSUMED DIM PARAMETERS ... MDIM=47...NDIM=35, LDXDIM=8000,
  23090 C                               ... KDXDIM=KDTDIM*KLDIM KDTDIM=5
  23091 C
  23092       SUBROUTINE SLIMBO(FD,KP1,KP2,A)
  23093 C
  23094 C     ** NODAL SPLINE AMPLITUDES A(K,M,N) FROM DATA FD(K,L)**
  23095 C     ** MODIFIED FOR CORNER CONDITIONS (OCT 79)
  23096 C
  23097       PARAMETER (MDIM=35,NDIM=35)
  23098       PARAMETER (LDXDIM=8000)
  23099       PARAMETER (KLDIM= 8)
  23100       PARAMETER (KDTDIM=5)
  23101       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  23102 C
  23103 C     ** SECONDARY PARAMETERS FOR COMPILATION
  23104 C
  23105       PARAMETER (NSDIM=NDIM*NDIM)
  23106 C
  23107 C     ** DUMMY ARGUMENTS
  23108 C

Page 666         Source Listing                  SLIMBO
2017-04-18 11:09                                 syndata.f

  23109       SAVE
  23110 C
  23111       DIMENSION FD(KDXDIM,LDXDIM),A(KDXDIM,MDIM,NDIM)
  23112 C
  23113 C     INPUT    MSKEF     DISK UNIT FROM WHICH MATRIX COEFFICIENTS ARE RE
  23114 C              FD(K,L)   K-TH COMPONENT OF FIELD DATA AT LOCATION L
  23115 C              KP1       FIRST COMPONENT K TO BE PROCESSED
  23116 C              KP2       LAST  COMPONENT K TO BE PROCESSED
  23117 C     OUTPUT   A(K,M,N)  NODAL AMPLITUDE OF K-TH COMPONENT AT NODE (M,N)
  23118 C     ** PREREQUISITES ... MAY BE SATISFIED BY CALLING SLEFCD(MSKEF)
  23119 C                          BEFORE ENTERING SLIMBO
  23120 C        $$ DISK UNIT MSKEF, PREVIOUSLY WRITTEN BY SLARGO
  23121 C             THE COMPATIBILITY AND IDENTITY MAY BE TESTED BY
  23122 C             CALLING SLEFCD
  23123 C        $$ SLOVER WAS CALLED TO DEFINE CONSTANTS IN SEVERAL COMMONS
  23124 C        $$ DATA POINTS WERE DEFINED IN /S2DTPT/ INCLUDING WEIGHTS
  23125 C     ** EXPLICITLY REQUIRED COMMONS
  23126 C
  23127       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  23128      1                 YNC(NDIM),COSYN(NDIM)
  23129       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  23130      1               ID(LDXDIM),LXSORT(LDXDIM)
  23131       COMMON /S2EFRM/ MEF,ANS(NSDIM,3)
  23132 C
  23133       CHARACTER*8 IDSPD1,IDSPD2*72
  23134 C
  23135 C     ** EQUIVALENT ARRAYS FOR EASE OF INDEXING AND INTERPRETATION
  23136 C
  23137       DIMENSION AML(NDIM,NDIM,3),D(NDIM,NDIM),EML(NDIM,NDIM,2),
  23138      1          EMR(NDIM,NDIM,3)
  23139 C
  23140       EQUIVALENCE (ANS(1,1),AML(1,1,1),D(1,1),EMR(1,1,1)),
  23141      1            (ANS(1,2),EML(1,1,1))
  23142 C
  23143 C     +++ ALL MATRICES, INCLUDING AML, ARE NSDIM SQUARE MATRICES +++
  23144 C     ** LOCAL WORK SPACE
  23145 C
  23146       DIMENSION ZV(NDIM,KDXDIM),B1(NDIM),B2(NDIM),B3(NDIM),
  23147      1          BV(NDIM,3,KDXDIM)
  23148 C
  23149       IZERO = 0
  23150       INSEC = ISECND(IZERO)
  23151 c && 2 comments
  23152 CC    WRITE(6,800) INSEC
  23153 CC800 FORMAT(/' === SLIMBO BEGINS ===',T91,'SECOND=',I6)
  23154 C
  23155 C     ** INITIALIZATION
  23156 C
  23157       CALL SLEFR0
  23158       KA=MIN(KP1,KP2)
  23159       KB=MAX(KP1,KP2)
  23160       IF(KB.GT.KDXDIM) GO TO 90
  23161 C
  23162       A(KA:KB,1:MXX,1:NXX)=0.
  23163 C
  23164       CALL SLICCO(KA,KB,MXX,NXX)
  23165 C

Page 667         Source Listing                  SLIMBO
2017-04-18 11:09                                 syndata.f

  23166 C     ** CONSTANTS FOR CONVENIENCE
  23167 C
  23168       XM1=XM(1)
  23169       YN1=YN(1)
  23170       DX0=1./DXM
  23171       DY0=1./DYN
  23172 C
  23173 C     ** CONVERSION OF DISCRETE FIELD DATA TO NODAL FORCING **
  23174 C
  23175       DO 18 L=1,LDX
  23176       IF(WD(L) .LE. 0.0) GO TO 18
  23177       MA=MAX(INT((XD(L)-XM1)*DX0),1)
  23178       NA=MAX(INT((YD(L)-YN1)*DY0),1)
  23179       MB=MIN(MA+3,MXX)
  23180       NB=MIN(NA+3,NXX)
  23181       DO M=MA,MB
  23182          WM=WD(L)
  23183          WM=WM*XBF(M,XD(L))
  23184          DO N=NA,NB
  23185             WMN=WM*YBF(N,YD(L))
  23186             DO K=KA,KB
  23187                A(K,M,N)=A(K,M,N)+WMN*FD(K,L)
  23188             ENDDO
  23189          ENDDO
  23190       ENDDO
  23191    18 CONTINUE
  23192 C
  23193 C
  23194 C     ** ADJUST THE NODAL FORCING FOR CORNERING
  23195 C
  23196       CALL SLICCB(A)
  23197 C
  23198 C     ** CONVERSION OF NODAL FORCING TO NODAL AMPLITUDES **
  23199 C       +++ WE RETURN TO THE RIGHT-HANDED FORCING +++
  23200 C       +++ THE LEFT-HANDED CONVENTION IN PLIB SPLEND IS NOT USED +++
  23201 C     ** FORWARD TRICYCLING **
  23202 C
  23203       BV(1:NXX,:,KA:KB)=0.
  23204 C
  23205       DO M=1,MXX
  23206          CALL SLEFRA(M)
  23207          DO 22 K=KA,KB
  23208          ZV(1:NXX,K)=-A(K,M,1:NXX)
  23209          DO ML=1,MIN(M-1,3)
  23210             DO NN=1,NXX
  23211                DO  N=1,NXX
  23212                   ZV(N,K)=AML(N,NN,ML)*BV(NN,ML,K)+ZV(N,K)
  23213                ENDDO
  23214             ENDDO
  23215          ENDDO
  23216    22    CONTINUE
  23217          CALL SLEFRF(M)
  23218          DO K=KA,KB
  23219             B1(1:NXX)=0.
  23220             DO NN=1,NXX
  23221                DO N=1,NXX
  23222                   B1(N)=D(N,NN)*ZV(NN,K)+B1(N)

Page 668         Source Listing                  SLIMBO
2017-04-18 11:09                                 syndata.f

  23223                ENDDO
  23224             ENDDO
  23225             B2(1:NXX)=BV(1:NXX,1,K)
  23226             B3(1:NXX)=BV(1:NXX,2,K)
  23227             DO NN=1,NXX
  23228                DO N=1,NXX
  23229                   B2(N)=EML(N,NN,1)*B1(NN)+B2(N)
  23230                   B3(N)=EML(N,NN,2)*B1(NN)+B3(N)
  23231                ENDDO
  23232             ENDDO
  23233             BV(1:NXX,3,K)=B3(1:NXX)
  23234             BV(1:NXX,2,K)=B2(1:NXX)
  23235             BV(1:NXX,1,K)=B1(1:NXX)
  23236             A(K,M,1:NXX)=B1(1:NXX)
  23237          ENDDO
  23238       ENDDO
  23239 C
  23240 C     ** BACKTRACKING **
  23241 C        +++ UNBROKEN MULTIPLE DO DID NOT VECTORIZE +++
  23242 C
  23243       DO M=MXX,1,-1
  23244          CALL SLEFRE(M)
  23245          DO K=KA,KB
  23246             B1(1:NXX)=A(K,M,1:NXX)
  23247             DO MR=1,MIN(MXX-M,3)
  23248                DO NN=1,NXX
  23249                   DO N=1,NXX
  23250                      B1(N)=EMR(N,NN,MR)*A(K,M+MR,NN)+B1(N)
  23251                   ENDDO
  23252                ENDDO
  23253             ENDDO
  23254             A(K,M,1:NXX)=B1(1:NXX)
  23255          ENDDO
  23256       ENDDO
  23257 C
  23258 C     ** FIX THE FLOATED CORNER AMPLITUDES
  23259 C
  23260       CALL SLICCA(A)
  23261       IDELTA = ISECND(INSEC)
  23262       WRITE(6,880) IDELTA
  23263   880 FORMAT(' === SLIMBO DONE ===',T91,'ELAPSED TIME=',I6)
  23264       RETURN
  23265 C
  23266 C     ** ERROR EXIT
  23267 C
  23268    90 WRITE(6,890) KP1,KP2,KDXDIM
  23269   890 FORMAT(/' === SLIMBO FOUND THE COMPONENT RANGE  K=',I2,',',I2,
  23270      1    '  EXCEEDED KDXDIM=',I2)
  23271       CALL ABRT1(' SLIMBO',890)
  23272       END

Page 669         Source Listing                  SLIMBO
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 slimbo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 18                         Label  23191                                                          23175,23176                       
 22                         Label  23216                                                          23207                             
 880                        Label  23263                                                          23262                             
 890                        Label  23269                                                          23268                             
 90                         Label  23268                                                          23160                             
 A                          Dummy  23092    R(4)            4     3     49000    ARG,INOUT        23162,23187,23196,23208,23236,2324
                                                                                                  6,23250,23254,23260               
 ABRT1                      Subr   23271                                                          23271                             
 AML                        Scalar 23137    R(4)            4     3     3675     COM              23212                             
 ANS                        Scalar 23131    R(4)            4     2     3675     COM                                                
 B1                         Local  23146    R(4)            4     1     35       SAVE             23219,23222,23229,23230,23235,2323
                                                                                                  6,23246,23250,23254               
 B2                         Local  23146    R(4)            4     1     35       SAVE             23225,23229,23234                 
 B3                         Local  23146    R(4)            4     1     35       SAVE             23226,23230,23233                 
 BV                         Local  23147    R(4)            4     3     4200     SAVE             23203,23212,23225,23226,23233,2323
                                                                                                  4,23235                           
 COSYN                      Scalar 23128    R(4)            4     1     35       COM                                                
 D                          Scalar 23137    R(4)            4     2     1225     COM              23222                             
 DX0                        Local  23170    R(4)            4           scalar   SAVE             23170,23177                       
 DXM                        Scalar 23127    R(4)            4           scalar   COM              23170                             
 DY0                        Local  23171    R(4)            4           scalar   SAVE             23171,23178                       
 DYN                        Scalar 23127    R(4)            4           scalar   COM              23171                             
 EML                        Scalar 23137    R(4)            4     3     2450     COM              23229,23230                       
 EMR                        Scalar 23138    R(4)            4     3     3675     COM              23250                             
 FD                         Dummy  23092    R(4)            4     2     320000   ARG,INOUT        23187                             
 ID                         Scalar 23130    I(4)            4     1     8000     COM                                                
 IDELTA                     Local  23261    I(4)            4           scalar   SAVE             23261,23262                       
 IDSPD1                     Scalar 23129    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 23129    CHAR            72          scalar   COM                                                
 INSEC                      Local  23150    I(4)            4           scalar   SAVE             23150,23261                       
 INT                        Func   23177                                scalar                    23177,23178                       
 ISECND                     Func   23150    I(4)            4           scalar                    23150,23261                       
 IZERO                      Local  23149    I(4)            4           scalar   SAVE             23149,23150                       
 K                          Local  23186    I(4)            4           scalar   SAVE             23186,23187,23207,23208,23212,2321
                                                                                                  8,23222,23225,23226,23233,23234,23
                                                                                                  235,23236,23245,23246,23250,23254 
 KA                         Local  23158    I(4)            4           scalar   SAVE             23158,23162,23164,23186,23203,2320
                                                                                                  7,23218,23245                     
 KB                         Local  23159    I(4)            4           scalar   SAVE             23159,23160,23162,23164,23186,2320
                                                                                                  3,23207,23218,23245               
 KDTDIM                     Param  23100    I(4)            4           scalar                    23101                             
 KDXDIM                     Param  23101    I(4)            4           scalar                    23111,23146,23147,23160,23268     
 KLDIM                      Param  23099    I(4)            4           scalar                    23101                             
 KP1                        Dummy  23092    I(4)            4           scalar   ARG,INOUT        23158,23159,23268                 

Page 670         Source Listing                  SLIMBO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KP2                        Dummy  23092    I(4)            4           scalar   ARG,INOUT        23158,23159,23268                 
 L                          Local  23175    I(4)            4           scalar   SAVE             23175,23176,23177,23178,23182,2318
                                                                                                  3,23185,23187                     
 LDX                        Scalar 23129    I(4)            4           scalar   COM              23175                             
 LDXDIM                     Param  23098    I(4)            4           scalar                    23111,23129,23130                 
 LXSORT                     Scalar 23130    I(4)            4     1     8000     COM                                                
 M                          Local  23181    I(4)            4           scalar   SAVE             23181,23183,23187,23205,23206,2320
                                                                                                  8,23209,23217,23236,23243,23244,23
                                                                                                  246,23247,23250,23254             
 MA                         Local  23177    I(4)            4           scalar   SAVE             23177,23179,23181                 
 MAX                        Func   23159                                scalar                    23159,23177,23178                 
 MB                         Local  23179    I(4)            4           scalar   SAVE             23179,23181                       
 MDIM                       Param  23097    I(4)            4           scalar                    23111,23127                       
 MEF                        Scalar 23131    I(4)            4           scalar   COM                                                
 MIN                        Func   23158                                scalar                    23158,23179,23180,23209,23247     
 ML                         Local  23209    I(4)            4           scalar   SAVE             23209,23212                       
 MR                         Local  23247    I(4)            4           scalar   SAVE             23247,23250                       
 MXX                        Scalar 23127    I(4)            4           scalar   COM              23162,23164,23179,23205,23243,2324
                                                                                                  7                                 
 N                          Local  23184    I(4)            4           scalar   SAVE             23184,23185,23187,23211,23212,2322
                                                                                                  1,23222,23228,23229,23230,23249,23
                                                                                                  250                               
 NA                         Local  23178    I(4)            4           scalar   SAVE             23178,23180,23184                 
 NB                         Local  23180    I(4)            4           scalar   SAVE             23180,23184                       
 NDIM                       Param  23097    I(4)            4           scalar                    23105,23111,23127,23128,23137,2313
                                                                                                  8,23146,23147                     
 NN                         Local  23210    I(4)            4           scalar   SAVE             23210,23212,23220,23222,23227,2322
                                                                                                  9,23230,23248,23250               
 NSDIM                      Param  23105    I(4)            4           scalar                    23131                             
 NXX                        Scalar 23127    I(4)            4           scalar   COM              23162,23164,23180,23203,23208,2321
                                                                                                  0,23211,23219,23220,23221,23225,23
                                                                                                  226,23227,23228,23233,23234,23235,
                                                                                                  23236,23246,23248,23249,23254     
 S2DTPT                     Common 23129                                160084   SAVE                                               
 S2EFRM                     Common 23131                                14704    SAVE                                               
 S2NODE                     Common 23127                                716      SAVE                                               
 SLEFR0                     Subr   23157                                                          23157                             
 SLEFRA                     Subr   23206                                                          23206                             
 SLEFRE                     Subr   23244                                                          23244                             
 SLEFRF                     Subr   23217                                                          23217                             
 SLICCA                     Subr   23260                                                          23260                             
 SLICCB                     Subr   23196                                                          23196                             
 SLICCO                     Subr   23164                                                          23164                             
 SLIMBO                     Subr   23092                                                                                            
 WD                         Scalar 23129    R(4)            4     1     8000     COM              23176,23182                       
 WM                         Local  23182    R(4)            4           scalar   SAVE             23182,23183,23185                 
 WMN                        Local  23185    R(4)            4           scalar   SAVE             23185,23187                       
 XBF                        Func   23183    R(4)            4           scalar                    23183                             
 XD                         Scalar 23129    R(4)            4     1     8000     COM              23177,23183                       
 XM                         Scalar 23127    R(4)            4     1     35       COM              23168                             
 XM1                        Local  23168    R(4)            4           scalar   SAVE             23168,23177                       
 XMC                        Scalar 23127    R(4)            4     1     35       COM                                                
 YBF                        Func   23185    R(4)            4           scalar                    23185                             
 YD                         Scalar 23129    R(4)            4     1     8000     COM              23178,23185                       
 YN                         Scalar 23127    R(4)            4     1     35       COM              23169                             

Page 671         Source Listing                  SLIMBO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YN1                        Local  23169    R(4)            4           scalar   SAVE             23169,23178                       
 YNC                        Scalar 23128    R(4)            4     1     35       COM                                                
 ZV                         Local  23146    R(4)            4     2     1400     SAVE             23208,23212,23222                 

Page 672         Source Listing                  SLIMBO
2017-04-18 11:09                                 syndata.f

  23273 
  23274 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  23275 C                .      .    .                                       .
  23276 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  23277 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  23278 C
  23279 C ABSTRACT: ??????????????????????????????????????????????????????????
  23280 C   ??????????????????????????????????????????????????????????????????
  23281 C
  23282 C PROGRAM HISTORY LOG:
  23283 C ????-??-??  S. J. LORD
  23284 C
  23285 C USAGE:    CALL ????????(????)
  23286 C   INPUT ARGUMENT LIST:
  23287 C     ??????   - ???????????????????????????????????????????????
  23288 C
  23289 C   OUTPUT ARGUMENT LIST:
  23290 C     ??????   - ???????????????????????????????????????????????
  23291 C
  23292 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  23293 C     ??????   - ???????????????????????????????????????????????
  23294 C
  23295 C   OUTPUT FILES:
  23296 C     ??????   - ???????????????????????????????????????????????
  23297 C
  23298 C REMARKS: ?????????????????????????????????????????????????????
  23299 C
  23300 C ATTRIBUTES:
  23301 C   LANGUAGE: FORTRAN 90
  23302 C   MACHINE:  NCEP WCOSS
  23303 C
  23304 C$$$
  23305       SUBROUTINE SLISUB(KP1,KP2,MXXZ,NXXZ,A,B)
  23306 C
  23307 C          ENTRY SLICCO(KP1,KP2,MXXZ,NXXZ)
  23308 C          ENTRY SLICCB(B)
  23309 C          ENTRY SLICCA(A)
  23310 C
  23311       PARAMETER (MDIM=35,NDIM=35)
  23312       PARAMETER (KLDIM= 8)
  23313       PARAMETER (KDTDIM=5)
  23314       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  23315 C
  23316       SAVE
  23317 C
  23318       DIMENSION A(KDXDIM,MDIM,NDIM),B(KDXDIM,MDIM,NDIM)
  23319       COMMON /S2CORN/ CORN(4,4)
  23320 
  23321 C-----------------------------------------------------------------------
  23322 
  23323 C
  23324       ENTRY SLICCO(KP1,KP2,MXXZ,NXXZ)
  23325 C     ++ INITIALIZE CONSTANTS FOR SLICCB AND SLICCA ENTRIES
  23326 C        /S2CORN/ MUST HAVE BEEN DEFINED BY SLOVER, OR BY SLEFCD
  23327 C
  23328       KA=KP1
  23329       KB=KP2

Page 673         Source Listing                  SLISUB
2017-04-18 11:09                                 syndata.f

  23330       MXX=MXXZ
  23331       NXX=NXXZ
  23332       RETURN
  23333 
  23334 C-----------------------------------------------------------------------
  23335 
  23336 C
  23337 C     ** ADJUST NODAL FORCING, B, FOR CORNERING
  23338 C
  23339       ENTRY SLICCB(B)
  23340 C
  23341       DO 19 KORN=1,4
  23342       IF(CORN(1,KORN).EQ.0.) GO TO 19
  23343       GO TO (11,11,12,12),KORN
  23344    11 MA=1
  23345       MB=2
  23346       GO TO 13
  23347    12 MA=MXX
  23348       MB=MXX-1
  23349    13 GO TO (14,15,14,15),KORN
  23350    14 NA=1
  23351       NB=2
  23352       GO TO 16
  23353    15 NA=NXX
  23354       NB=NXX-1
  23355    16 CONTINUE
  23356       DO K=KA,KB
  23357          B(K,MA,NB)=CORN(2,KORN)*B(K,MA,NA)+B(K,MA,NB)
  23358          B(K,MB,NA)=CORN(3,KORN)*B(K,MA,NA)+B(K,MB,NA)
  23359          B(K,MB,NB)=CORN(4,KORN)*B(K,MA,NA)+B(K,MB,NB)
  23360       ENDDO
  23361       B(KA:KB,MA,NA)=0.
  23362    19 CONTINUE
  23363 C
  23364       RETURN
  23365 
  23366 C-----------------------------------------------------------------------
  23367 
  23368 C
  23369 C     ** FIX THE FLOATED CORNER AMPLITUDES
  23370 C
  23371       ENTRY SLICCA(A)
  23372 C
  23373       DO 38 KORN=1,4
  23374       IF(CORN(1,KORN).EQ.0.) GO TO 38
  23375       GO TO (31,31,32,32),KORN
  23376    31 MA=1
  23377       MB=2
  23378       GO TO 33
  23379    32 MA=MXX
  23380       MB=MXX-1
  23381    33 GO TO (34,35,34,35),KORN
  23382    34 NA=1
  23383       NB=2
  23384       GO TO 36
  23385    35 NA=NXX
  23386       NB=NXX-1

Page 674         Source Listing                  SLISUB
2017-04-18 11:09                                 syndata.f

  23387    36 DO 37 K=KA,KB
  23388       A(K,MA,NA)=CORN(2,KORN)*A(K,MA,NB)+CORN(3,KORN)*A(K,MB,NA)
  23389      1                                  +CORN(4,KORN)*A(K,MB,NB)
  23390    37 CONTINUE
  23391    38 CONTINUE
  23392 C
  23393       RETURN
  23394       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 slicca_               sliccb_               slicco_               slisub_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 11                         Label  23344                                                          23343                             
 12                         Label  23347                                                          23343                             
 13                         Label  23349                                                          23346                             
 14                         Label  23350                                                          23349                             
 15                         Label  23353                                                          23349                             
 16                         Label  23355                                                          23352                             
 19                         Label  23362                                                          23341,23342                       
 31                         Label  23376                                                          23375                             
 32                         Label  23379                                                          23375                             
 33                         Label  23381                                                          23378                             
 34                         Label  23382                                                          23381                             
 35                         Label  23385                                                          23381                             
 36                         Label  23387                                                          23384                             
 37                         Label  23390                                                          23387                             
 38                         Label  23391                                                          23373,23374                       
 A                          Dummy  23305    R(4)            4     3     49000    ARG,INOUT        23388,23389                       
 B                          Dummy  23305    R(4)            4     3     49000    ARG,INOUT        23357,23358,23359,23361           
 CORN                       Scalar 23319    R(4)            4     2     16       COM              23342,23357,23358,23359,23374,2338
                                                                                                  8,23389                           
 K                          Local  23356    I(4)            4           scalar   SAVE             23356,23357,23358,23359,23387,2338
                                                                                                  8,23389                           
 KA                         Local  23328    I(4)            4           scalar   SAVE             23328,23356,23361,23387           
 KB                         Local  23329    I(4)            4           scalar   SAVE             23329,23356,23361,23387           
 KDTDIM                     Param  23313    I(4)            4           scalar                    23314                             
 KDXDIM                     Param  23314    I(4)            4           scalar                    23318                             
 KLDIM                      Param  23312    I(4)            4           scalar                    23314                             
 KORN                       Local  23341    I(4)            4           scalar   SAVE             23341,23342,23343,23349,23357,2335
                                                                                                  8,23359,23373,23374,23375,23381,23
                                                                                                  388,23389                         
 KP1                        Dummy  23305    I(4)            4           scalar   ARG,INOUT        23328                             
 KP2                        Dummy  23305    I(4)            4           scalar   ARG,INOUT        23329                             
 MA                         Local  23344    I(4)            4           scalar   SAVE             23344,23347,23357,23358,23359,2336
                                                                                                  1,23376,23379,23388               
 MB                         Local  23345    I(4)            4           scalar   SAVE             23345,23348,23358,23359,23377,2338
                                                                                                  0,23388,23389                     
 MDIM                       Param  23311    I(4)            4           scalar                    23318                             

Page 675         Source Listing                  SLISUB
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MXX                        Local  23330    I(4)            4           scalar   SAVE             23330,23347,23348,23379,23380     
 MXXZ                       Dummy  23305    I(4)            4           scalar   ARG,INOUT        23330                             
 NA                         Local  23350    I(4)            4           scalar   SAVE             23350,23353,23357,23358,23359,2336
                                                                                                  1,23382,23385,23388               
 NB                         Local  23351    I(4)            4           scalar   SAVE             23351,23354,23357,23359,23383,2338
                                                                                                  6,23388,23389                     
 NDIM                       Param  23311    I(4)            4           scalar                    23318                             
 NXX                        Local  23331    I(4)            4           scalar   SAVE             23331,23353,23354,23385,23386     
 NXXZ                       Dummy  23305    I(4)            4           scalar   ARG,INOUT        23331                             
 S2CORN                     Common 23319                                64       SAVE                                               
 SLICCA                     Subr   23371                                                                                            
 SLICCB                     Subr   23339                                                                                            
 SLICCO                     Subr   23324                                                                                            
 SLISUB                     Subr   23305                                                                                            

Page 676         Source Listing                  SLISUB
2017-04-18 11:09                                 syndata.f

  23395 
  23396 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  23397 C                .      .    .                                       .
  23398 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  23399 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  23400 C
  23401 C ABSTRACT: ??????????????????????????????????????????????????????????
  23402 C   ??????????????????????????????????????????????????????????????????
  23403 C
  23404 C PROGRAM HISTORY LOG:
  23405 C ????-??-??  S. J. LORD
  23406 C
  23407 C USAGE:    CALL ????????(????)
  23408 C   INPUT ARGUMENT LIST:
  23409 C     ??????   - ???????????????????????????????????????????????
  23410 C
  23411 C   OUTPUT ARGUMENT LIST:
  23412 C     ??????   - ???????????????????????????????????????????????
  23413 C
  23414 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  23415 C     ??????   - ???????????????????????????????????????????????
  23416 C
  23417 C   OUTPUT FILES:
  23418 C     ??????   - ???????????????????????????????????????????????
  23419 C
  23420 C REMARKS: ?????????????????????????????????????????????????????
  23421 C
  23422 C ATTRIBUTES:
  23423 C   LANGUAGE: FORTRAN 90
  23424 C   MACHINE:  NCEP WCOSS
  23425 C
  23426 C$$$
  23427       SUBROUTINE SPLEFR(M)
  23428       PARAMETER (NDIM=35)
  23429       PARAMETER (LDXDIM=8000)
  23430 C
  23431 C     ** SECONDARY PARAMETERS FOR COMPILATION
  23432 C
  23433       PARAMETER (NSDIM=NDIM*NDIM)
  23434 C
  23435 C     ** OUT FROM SLEFCD(MSKEF).../S2PRIC/ AND S2DTPT/ ARE DEFINED,
  23436 C                                  SLOVER IS CALLED, AND MSKEF IS READIE
  23437 C
  23438 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  23439 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  23440       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  23441      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  23442       COMMON/S2DTPT/IDSPD1,IDSPD2,LDX,XD(LDXDIM),YD(LDXDIM),WD(LDXDIM),
  23443      1               ID(LDXDIM),LXSORT(LDXDIM)
  23444       COMMON /DSK/MSKEF,MSKEZ,MSKDA1,MSKDA2,MSKDA3,MSKDA4,MSKDA5,MSKDA6,
  23445      1            MSKDA7,MSKDA8,MSKDA9,MSKD11,MSKD12,MSKD13,
  23446      2            MSKD14,MSKD15,MSKD16,MSKD17,MSKD18
  23447 C
  23448       CHARACTER*8 IDSPD1,IDSPD2*72,IDSPC*125,IDSPCZ*125,KENTRY*7
  23449 C
  23450 C     ** OUT FROM SLEFR0(MSKEF)...NONE BUT MSKEF IS READIED
  23451 C     ** OUT FORM SLEFRA(M)     ...AML MATRICES TO /S2EFRM/

Page 677         Source Listing                  SPLEFR
2017-04-18 11:09                                 syndata.f

  23452 C     $$ OUT FROM SLEFRF(M)     ...D AND EML MATRICES TO /S2EFRM/
  23453 C     ** OUT FROM SLEFRE(M)     ...EMR MATRICES TO /S2EFRM/
  23454 C
  23455       COMMON /S2EFRM/ MEF,ANS(NSDIM,3)
  23456 C
  23457 C     ** LOCAL SPACE
  23458 C
  23459       CHARACTER*8 IDZ
  23460 C
  23461       SAVE
  23462 C
  23463       DIMENSION IDZ(12)
  23464 C
  23465       DATA KENTRY/' SPLEFR'/
  23466 
  23467 C-----------------------------------------------------------------------
  23468 
  23469 C
  23470       ENTRY SLEFCD
  23471       REWIND MSKEF
  23472       READ(MSKEF) IDZ,IDSPCZ,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP,XM1,XMXX,
  23473      1            YN1,YNXX,XYDCWL,XYBCWL,IDSPD1,IDSPD2,LDX
  23474       IF(LDX.LE.0 .OR. LDX.GT.LDXDIM) GO TO 91
  23475 C      DECODE(8,812,IDZ(5)) NDIMEF
  23476       READ(IDZ(5),812)  NDIMEF
  23477       READ(IDZ(6),812)  LDXDEF
  23478   812 FORMAT(I8)
  23479       IF(IDSPCZ .NE. IDSPC)  THEN
  23480       WRITE(6,813)  IDSPC,IDSPCZ
  23481   813 FORMAT('....WARNING: IDSPC AND IDSPCZ ARE NOT THE SAME, ERRORS',
  23482      1       ' RELATED TO STORM POSITION MAY OCCUR',/,
  23483      2       '  ...IDSPC=',A125,/,'  ...IDSPCZ=',A125)
  23484       ENDIF
  23485       IF(NDIMEF.NE.NDIM) GO TO 92
  23486       IF(LDXDEF .NE. LDXDIM)  GO TO 93
  23487       BACKSPACE (MSKEF,ERR=96)
  23488       READ(MSKEF) IDZ,IDSPCZ,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP,XM1,XMXX,YN1,
  23489      1            YNXX,XYDCWL,XYBCWL,IDSPD1,IDSPD2,LDX,XD,YD,WD,ID,XML,
  23490      1            XMR,YNB,YNT
  23491       WRITE(6,815) MSKEF,IDZ
  23492   815 FORMAT(/' ===  SLEFCD (MSKEF=',I4,') HAS DEFINED /S2PRIC/ AND '
  23493      1   ,'/S2DTPT/.',/,5X,'...',12A8,/,6X,'SLOVER WILL BE CALLED')
  23494       CALL SLOVER
  23495       RETURN
  23496 
  23497 C-----------------------------------------------------------------------
  23498 
  23499 C
  23500       ENTRY SLEFR0
  23501       REWIND MSKEF
  23502       READ(MSKEF) IDZ
  23503 c && 3 comments
  23504 CC    WRITE(6,825) MSKEF
  23505 CC825 FORMAT(/' === SLEFR0(MSKEF=',I4,') DONE.  NO CHANGES IN '
  23506 CC   1   ,'/S2PRIC/ OR /S2DTPT/.  NO CHECKS ON LDX OR NDIM.')
  23507       RETURN
  23508 

Page 678         Source Listing                  SPLEFR
2017-04-18 11:09                                 syndata.f

  23509 C-----------------------------------------------------------------------
  23510 
  23511 C
  23512       ENTRY SLEFRA(M)
  23513       KENTRY='SLEFRA'
  23514       GO TO 40
  23515 
  23516 C-----------------------------------------------------------------------
  23517 
  23518 C
  23519       ENTRY SLEFRF(M)
  23520       KENTRY='SLEFRF'
  23521    40 CONTINUE
  23522       READ(MSKEF) MEF,ANS
  23523       IF(M.NE.MEF) GO TO 95
  23524       RETURN
  23525 
  23526 C-----------------------------------------------------------------------
  23527 
  23528 C
  23529       ENTRY SLEFRE(M)
  23530       KENTRY='SLEFRE'
  23531       READ(MSKEF) MEF,ANS
  23532       IF(M+MEF.NE.0) GO TO 95
  23533       RETURN
  23534 C
  23535 C     ** ERROR EXITS
  23536 C
  23537    91 WRITE(6,891) MSKEF,LDX,LDXDIM,IDZ
  23538   891 FORMAT(/' === SLEFCD FOUND LDX FROM MSKEF=',I4,' IS .LE. ZERO, ',
  23539      1    'OR, .GT. THE CURRENT LDXDIM.',2I6,/,5X,I7,'...',12A8)
  23540       GO TO 99
  23541    92 WRITE(6,892) MSKEF,NDIMEF,NDIM,IDZ
  23542   892 FORMAT(/' === SLEFCD FOUND NDIM FROM MSKEF=',I4,' DOES NOT',
  23543      1       ' AGREE WITH THE CURRENT NDIM.  FATAL.',5X,2I4,/,5X,12A8)
  23544       GO TO 99
  23545    93 WRITE(6,893) MSKEF,LDXDEF,LDXDIM,IDZ
  23546   893 FORMAT(/' === SLEFCD FOUND LDXDIM FROM MSKEF=',I4,' DOES NOT',
  23547      1       ' AGREE WITH THE CURRENT NDIM.  FATAL.',5X,2I4,/,5X,12A8)
  23548       GO TO 99
  23549    95 WRITE(6,895) KENTRY,M,MEF,MSKEF
  23550   895 FORMAT(' === ',A7,' FOR M=',I3,' MET  MEF=',I4,
  23551      1    '  IN READING MSKEF=',A8)
  23552       CALL MSKDMP(MSKEF)
  23553       GO TO 99
  23554    96 WRITE(6,896) MSKEF
  23555   896 FORMAT(/' ... BACKSPACE ERROR ON ',Z8)
  23556    99 CALL ABRT1(KENTRY,896)
  23557       END

Page 679         Source Listing                  SPLEFR
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name                  Name                  Name                  Name               
                                                                                                                                   
 slefcd_               slefr0_               slefra_               slefre_               slefrf_               splefr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 40                         Label  23521                                                          23514                             
 812                        Label  23478                                                          23476,23477                       
 813                        Label  23481                                                          23480                             
 815                        Label  23492                                                          23491                             
 891                        Label  23538                                                          23537                             
 892                        Label  23542                                                          23541                             
 893                        Label  23546                                                          23545                             
 895                        Label  23550                                                          23549                             
 896                        Label  23555                                                          23554                             
 91                         Label  23537                                                          23474                             
 92                         Label  23541                                                          23485                             
 93                         Label  23545                                                          23486                             
 95                         Label  23549                                                          23523,23532                       
 96                         Label  23554                                                          23487                             
 99                         Label  23556                                                          23540,23544,23548,23553           
 ABRT1                      Subr   23556                                                          23556                             
 ANS                        Scalar 23455    R(4)            4     2     3675     COM              23522,23531                       
 DSK                        Common 23444                                76       SAVE                                               
 ID                         Scalar 23443    I(4)            4     1     8000     COM              23489                             
 IDSPC                      Scalar 23441    CHAR            125         scalar   COM              23479,23480                       
 IDSPCZ                     Local  23448    CHAR            125         scalar   SAVE             23472,23479,23480,23488           
 IDSPD1                     Scalar 23442    CHAR            8           scalar   COM              23473,23489                       
 IDSPD2                     Scalar 23442    CHAR            72          scalar   COM              23473,23489                       
 IDZ                        Local  23459    CHAR            8     1     12       SAVE             23472,23476,23477,23488,23491,2350
                                                                                                  2,23537,23541,23545               
 ISRCD                      Scalar 23440    I(4)            4           scalar   COM              23472,23488                       
 JPD                        Scalar 23440    I(4)            4           scalar   COM              23472,23488                       
 KBCTYP                     Scalar 23440    I(4)            4     1     4        COM              23472,23488                       
 KDCTYP                     Scalar 23440    I(4)            4           scalar   COM              23472,23488                       
 KENTRY                     Local  23448    CHAR            7           scalar   SAVE             23465,23513,23520,23530,23549,2355
                                                                                                  6                                 
 LDX                        Scalar 23442    I(4)            4           scalar   COM              23473,23474,23489,23537           
 LDXDEF                     Local  23477    I(4)            4           scalar   SAVE             23477,23486,23545                 
 LDXDIM                     Param  23429    I(4)            4           scalar                    23442,23443,23474,23486,23537,2354
                                                                                                  5                                 
 LXSORT                     Scalar 23443    I(4)            4     1     8000     COM                                                
 M                          Dummy  23427    I(4)            4           scalar   ARG,INOUT        23523,23532,23549                 
 MEF                        Scalar 23455    I(4)            4           scalar   COM              23522,23523,23531,23532,23549     
 MSKD11                     Scalar 23445    I(4)            4           scalar   COM                                                
 MSKD12                     Scalar 23445    I(4)            4           scalar   COM                                                
 MSKD13                     Scalar 23445    I(4)            4           scalar   COM                                                
 MSKD14                     Scalar 23446    I(4)            4           scalar   COM                                                
 MSKD15                     Scalar 23446    I(4)            4           scalar   COM                                                
 MSKD16                     Scalar 23446    I(4)            4           scalar   COM                                                

Page 680         Source Listing                  SPLEFR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MSKD17                     Scalar 23446    I(4)            4           scalar   COM                                                
 MSKD18                     Scalar 23446    I(4)            4           scalar   COM                                                
 MSKDA1                     Scalar 23444    I(4)            4           scalar   COM                                                
 MSKDA2                     Scalar 23444    I(4)            4           scalar   COM                                                
 MSKDA3                     Scalar 23444    I(4)            4           scalar   COM                                                
 MSKDA4                     Scalar 23444    I(4)            4           scalar   COM                                                
 MSKDA5                     Scalar 23444    I(4)            4           scalar   COM                                                
 MSKDA6                     Scalar 23444    I(4)            4           scalar   COM                                                
 MSKDA7                     Scalar 23445    I(4)            4           scalar   COM                                                
 MSKDA8                     Scalar 23445    I(4)            4           scalar   COM                                                
 MSKDA9                     Scalar 23445    I(4)            4           scalar   COM                                                
 MSKDMP                     Subr   23552                                                          23552                             
 MSKEF                      Scalar 23444    I(4)            4           scalar   COM              23471,23472,23487,23488,23491,2350
                                                                                                  1,23502,23522,23531,23537,23541,23
                                                                                                  545,23549,23552,23554             
 MSKEZ                      Scalar 23444    I(4)            4           scalar   COM                                                
 MX                         Scalar 23440    I(4)            4           scalar   COM              23472,23488                       
 NDIM                       Param  23428    I(4)            4           scalar                    23433,23485,23541                 
 NDIMEF                     Local  23476    I(4)            4           scalar   SAVE             23476,23485,23541                 
 NSDIM                      Param  23433    I(4)            4           scalar                    23455                             
 NX                         Scalar 23440    I(4)            4           scalar   COM              23472,23488                       
 S2DTPT                     Common 23442                                160084   SAVE                                               
 S2EFRM                     Common 23455                                14704    SAVE                                               
 S2PRIC                     Common 23440                                217      SAVE                                               
 SLEFCD                     Subr   23470                                                                                            
 SLEFR0                     Subr   23500                                                                                            
 SLEFRA                     Subr   23512                                                                                            
 SLEFRE                     Subr   23529                                                                                            
 SLEFRF                     Subr   23519                                                                                            
 SLOVER                     Subr   23494                                                          23494                             
 SPLEFR                     Subr   23427                                                                                            
 WD                         Scalar 23442    R(4)            4     1     8000     COM              23489                             
 XD                         Scalar 23442    R(4)            4     1     8000     COM              23489                             
 XM1                        Scalar 23441    R(4)            4           scalar   COM              23472,23488                       
 XML                        Scalar 23440    R(4)            4           scalar   COM              23489                             
 XMR                        Scalar 23440    R(4)            4           scalar   COM              23490                             
 XMXX                       Scalar 23441    R(4)            4           scalar   COM              23472,23488                       
 XYBCWL                     Scalar 23441    R(4)            4     1     4        COM              23473,23489                       
 XYDCWL                     Scalar 23441    R(4)            4     1     2        COM              23473,23489                       
 YD                         Scalar 23442    R(4)            4     1     8000     COM              23489                             
 YN1                        Scalar 23441    R(4)            4           scalar   COM              23473,23488                       
 YNB                        Scalar 23440    R(4)            4           scalar   COM              23490                             
 YNT                        Scalar 23440    R(4)            4           scalar   COM              23490                             
 YNXX                       Scalar 23441    R(4)            4           scalar   COM              23473,23489                       

Page 681         Source Listing                  SPLEFR
2017-04-18 11:09                                 syndata.f

  23558 
  23559 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  23560 C                .      .    .                                       .
  23561 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  23562 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  23563 C
  23564 C ABSTRACT: ??????????????????????????????????????????????????????????
  23565 C   ??????????????????????????????????????????????????????????????????
  23566 C
  23567 C PROGRAM HISTORY LOG:
  23568 C ????-??-??  S. J. LORD
  23569 C
  23570 C USAGE:    CALL ????????(????)
  23571 C   INPUT ARGUMENT LIST:
  23572 C     ??????   - ???????????????????????????????????????????????
  23573 C
  23574 C   OUTPUT ARGUMENT LIST:
  23575 C     ??????   - ???????????????????????????????????????????????
  23576 C
  23577 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  23578 C     ??????   - ???????????????????????????????????????????????
  23579 C
  23580 C   OUTPUT FILES:
  23581 C     ??????   - ???????????????????????????????????????????????
  23582 C
  23583 C REMARKS: ?????????????????????????????????????????????????????
  23584 C
  23585 C ATTRIBUTES:
  23586 C   LANGUAGE: FORTRAN 90
  23587 C   MACHINE:  NCEP WCOSS
  23588 C
  23589 C$$$
  23590       SUBROUTINE SPLINT (A,KPA,F,KPFDIM,MFDIM,NFDIM,KPF,M1,M2,M3,N1,N2,
  23591      1                   N3,ZXBF,ZYBF,ISFIN,ISFAC)
  23592       PARAMETER (MDIM=35,NDIM=35)
  23593       PARAMETER (KLDIM= 8)
  23594       PARAMETER (KDTDIM=5)
  23595       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  23596 C
  23597       SAVE
  23598 C
  23599 C     ** DUMMY ARGUMENTS
  23600 C     ** INPUT ... SPLINE AMPLITUDE
  23601 C
  23602       DIMENSION A(KDXDIM,MDIM,NDIM)
  23603 C
  23604 C     ** OUTPUT ..
  23605 C
  23606       DIMENSION F(KPFDIM,MFDIM,NFDIM)
  23607 C
  23608 C     ** PARAMETER FOR THE LOCAL USE ... MAXIMUM DIVISIONS ALLOWED
  23609 C
  23610       PARAMETER (IXBFDM=8,JXBFDM=8)
  23611 C
  23612 C     ** LOCAL ARRAYS ... BF TABLES
  23613 C
  23614       DIMENSION XB1(4,IXBFDM),XBM(4,IXBFDM),XBX(4,IXBFDM),XBXX(4)

Page 682         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23615       DIMENSION YB1(4,JXBFDM),YBN(4,JXBFDM),YBX(4,JXBFDM),YBXX(4)
  23616 C
  23617 C     ** LOCAL WORK SPACE
  23618 C
  23619       DIMENSION ZAB(MDIM,NDIM)
  23620 C
  23621       CHARACTER*7 KENTRY
  23622       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  23623      1                 YNC(NDIM),COSYN(NDIM)
  23624 C
  23625       DATA KENTRY/' SPLINT'/
  23626 C
  23627 C-----------------------------------------------------------------------
  23628 
  23629 C
  23630       ENTRY SLINTA(A,M1,M2,M3,N1,N2,N3)
  23631       KENTRY = 'SLINTA'
  23632 C
  23633 C     LOCALLY DEFINED
  23634 C
  23635       MX=MXX-1
  23636       MX1=MX-1
  23637       NX=NXX-1
  23638       NX1=NX-1
  23639       IF(MXX.GT.MDIM) GO TO 900
  23640       IF(NXX.GT.NDIM) GO TO 900
  23641 C
  23642 C     ** SET CONSTANTS FOR DEFINING THE AREA AND SUBDIVISIONS
  23643 C
  23644       MA=MIN(M1,M2)
  23645       MB=MAX(M1,M2)
  23646       IX=MAX(M3,1)
  23647       NA=MIN(N1,N2)
  23648       NB=MAX(N1,N2)
  23649       JX=MAX(N3,1)
  23650       IF(MA.LT.1)   GO TO 901
  23651       IF(MB.GT.MXX) GO TO 901
  23652       IF(NA.LT.1)   GO TO 901
  23653       IF(NB.GT.NXX) GO TO 901
  23654       IF(IX.GT.IXBFDM) GO TO 905
  23655       IF(JX.GT.JXBFDM) GO TO 905
  23656       MAOL=MAX(MA-1,1)
  23657       MBOL=MIN(MB+1,MXX)
  23658       MAIL=MAX(MA,2)
  23659       NAIL=MAX(NA,2)
  23660       MBIL1=MIN(MB,MX1)
  23661       MBIL2=MIN(MB-1,MX1)
  23662       NBIL1=MIN(NB,NX1)
  23663       NBIL2=MIN(NB-1,NX1)
  23664 C
  23665 C     ** MINIMUM DIMENSIONS REQUIRED OF THE OUTPUT FIELD
  23666 C
  23667       MFDIM0=IX*(MB-MA)+1
  23668       NFDIM0=JX*(NB-NA)+1
  23669 C
  23670 C     ** SET THE IN AND OUT SWITCHES TO THE NORMAL POSITIONS
  23671 C

Page 683         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23672       lsfin = 83
  23673       lsfout = 320
  23674 C
  23675 C     ** ROUTING DECISIONS
  23676 C
  23677       lgon1 = 120
  23678       lgonx = 150
  23679       lgom1 = 220
  23680       lgomx = 250
  23681       IF(NA.EQ.1)   lgon1 = 110
  23682       IF(NB.EQ.NXX) then
  23683          lgonx = 126
  23684       else  IF(NB.EQ.NX)  then
  23685          lgonx = 128
  23686       endif
  23687       IF(MA.EQ.1)   lgom1 = 210
  23688       IF(MB.EQ.MXX)  then
  23689          lgomx = 226
  23690       else  IF(MB.EQ.MX)  then
  23691          lgomx = 228
  23692       end if
  23693       RETURN
  23694 
  23695 C-----------------------------------------------------------------------
  23696 
  23697 C
  23698 C     ** INPUT ... THE SPLINE BASIS FUNCTIONS
  23699 C     ZXBF     XBF,DXBF, OR DDXBF
  23700 C     ZYBF     YBF,DYBF, OR DDYBF
  23701 C     ** ** ** WARNING ** ** **
  23702 C     THERE IS NO DEFAULT SETTING OF ZXBF OR ZYBF.
  23703 C     SLINTD MUST BE CALLED, AT LEAST ONCE, TO DEFINE THE BF TABLES
  23704 C     ** WARNING **
  23705 C       DO NOT SHORTCUT SLINTD WITHIN THIS SUBROUTINE ALTHOUGH IT MAY
  23706 C       SEEM TO BE UNNECESSARY WHEN M3,N3 ARE UNCHANGED.
  23707 C       SINCE ZXBF OR ZYBF MAY BE CHANGED, ONLY THE CALLING ROUTINE
  23708 C       CAN DETERMINE THE NEED OF CALLING SLINTD ANEW.
  23709 C       SIMILARLY, THE TEST OF M3,N3 BY SLINTO IS NO GUARANTEE FOR
  23710 C       CORRECT BF TABLES, IF THERE WERE OMISSION OF CALLING SLINTD.
  23711 C
  23712       ENTRY SLINTD(ZXBF,ZYBF)
  23713 C
  23714 C     ** SAVE THE CURRENT IX(=M3) AND JX(=N3)
  23715 C
  23716       IXBF0=IX
  23717       JXBF0=JX
  23718       DXMI=DXM/REAL(IX)
  23719       DYNJ=DYN/REAL(JX)
  23720 C
  23721       DO I=1,IX
  23722       XMI=(I-1)*DXMI
  23723       DO MD=0,2
  23724          XB1(2+MD,I)=ZXBF(1+MD,XM(1)+XMI)
  23725       ENDDO
  23726       DO MD=-1,2
  23727          XBM(2+MD,I)=ZXBF(3+MD,XM(3)+XMI)
  23728       ENDDO

Page 684         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23729       DO MD=-1,1
  23730          XBX(2+MD,I)=ZXBF(MX+MD,XM(MX)+XMI)
  23731       ENDDO
  23732       ENDDO
  23733 C
  23734       DO MD=-1,0
  23735          XBXX(2+MD)=ZXBF(MXX+MD,XM(MXX))
  23736       ENDDO
  23737 C
  23738       DO J=1,JX
  23739       YNJ=(J-1)*DYNJ
  23740       DO ND=0,2
  23741          YB1(2+ND,J)=ZYBF(1+ND,YN(1)+YNJ)
  23742       ENDDO
  23743       DO ND=-1,2
  23744          YBN(2+ND,J)=ZYBF(3+ND,YN(3)+YNJ)
  23745       ENDDO
  23746       DO ND=-1,1
  23747          YBX(2+ND,J)=ZYBF(NX+ND,YN(NX)+YNJ)
  23748       ENDDO
  23749       ENDDO
  23750 C
  23751       DO ND=-1,0
  23752          YBXX(2+ND)=ZYBF(NXX+ND,YN(NXX))
  23753       ENDDO
  23754 C
  23755       RETURN
  23756 C
  23757 C     ** INPUT ARGUMENTS
  23758 C     ISFIN=-1   SIGN OF INPUT F IS REVERSED (NOT CLEARED)
  23759 C          = 0   INPUT F IS CLEARED TO ZERO
  23760 C          = 1   INPUT F IS PASSED AS IS, TO BE ACCUMULATED UPON
  23761 C     ISFAC= 1   POSITIVE ACCUMULATION OF THE NEW F ON THE INPUT F
  23762 C          =-1   NEGATIVE ACCUMULATION OF THE NEW F ON THE INPUT F
  23763 C     NOTE ... LSFIN,LSFOUT DO NOT CORRESPOND TO ISFIN,ISFAC, INDIVIDUAL
  23764 C              SINCE LSFOUT FLIPS THE SIGN OF THE FINAL OUTPUT FIELD,
  23765 C              LSFIN MUST BE SET KNOWING WHAT LSFOUT WILL DO AT THE END
  23766 C     ++ SLINTO, WHEN EXECUTED, ALWAYS RESETS THE INTERNAL SWITCHES
  23767 C        TO  ISFIN=0 AND ISFAC=1.  SLINTS MUST BE CALLED EVERYTIME
  23768 C        WHEN DIFFERENT SETTINGS ARE DESIRED
  23769 C
  23770 
  23771 C-----------------------------------------------------------------------
  23772 
  23773       ENTRY SLINTS(ISFIN,ISFAC)
  23774       IF(ISFAC.LT.0) THEN
  23775          GO TO 71
  23776       ELSE
  23777          GO TO 72
  23778       ENDIF
  23779 C
  23780 C       FLIP THE SIGN OF THE OUTPUT FIELD
  23781 C
  23782    71 CONTINUE
  23783       lsfout = 310
  23784 C
  23785       IF(ISFIN.LT.0) THEN

Page 685         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23786          GO TO 75
  23787       ELSE  IF(ISFIN.EQ.0)  THEN
  23788          GO TO 74
  23789       ELSE
  23790          GO TO 73
  23791       ENDIF
  23792 C
  23793 C       PASS THE OUTPUT FIELD AS IS (THE NORMAL OUT SWITCH POSITION)
  23794 C
  23795    72 CONTINUE
  23796       lsfout = 320
  23797       IF(ISFIN.LT.0) THEN
  23798          GO TO 73
  23799       ELSE  IF(ISFIN.EQ.0)  THEN
  23800          GO TO 74
  23801       ELSE
  23802          GO TO 75
  23803       ENDIF
  23804 C
  23805 C       FLIP THE SIGN OF THE INPUT FIELD
  23806 C
  23807    73 CONTINUE
  23808       lsfin = 81
  23809       GO TO 78
  23810 C
  23811 C       CLEAR THE INPUT FIELD (THE NORMAL IN SWITCH POSITION)
  23812 C
  23813    74 CONTINUE
  23814       lsfin = 83
  23815       GO TO 78
  23816 C
  23817 C       PASS THE INPUT FIELD AS IS
  23818 C
  23819    75 CONTINUE
  23820       lsfin = 85
  23821    78 RETURN
  23822 
  23823 C-----------------------------------------------------------------------
  23824 
  23825 C
  23826       ENTRY SLINTO(A,KPA,F,KPFDIM,MFDIM,NFDIM,KPF)
  23827       KENTRY = 'SLINTO'
  23828       KA=KPA
  23829       KF=KPF
  23830 C
  23831 C     ** CHECK THE INPUT ARGUMENTS
  23832 C
  23833       IF(KPA.GT.KDXDIM) GO TO 902
  23834       IF(KPF.GT.KPFDIM) GO TO 910
  23835       IF(MFDIM.LT.MFDIM0) GO TO 910
  23836       IF(NFDIM.LT.NFDIM0) GO TO 910
  23837       IF(IX.NE.IXBF0) GO TO 920
  23838       IF(JX.NE.JXBF0) GO TO 920
  23839 C
  23840 C     ** THE IN SWITCH
  23841 C
  23842       if(lsfin.eq.81)  then

Page 686         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23843          go to 81
  23844       else if(lsfin.eq.83)  then
  23845          go to 83
  23846       else if(lsfin.eq.85)  then
  23847          go to 85
  23848       else
  23849          call ABRT1(' SLINTO',81)
  23850       endif
  23851 C
  23852    81 CONTINUE
  23853       DO M=1,MFDIM
  23854          DO N=1,NFDIM
  23855             F(KF,M,N)=-F(KF,M,N)
  23856          ENDDO
  23857       ENDDO
  23858 C
  23859       GO TO 85
  23860 C
  23861    83 CONTINUE
  23862 
  23863       F(KF,:,:)=0.
  23864 C
  23865 C     RESET THE IN SWITCH TO THE NORMAL POSITION ... CLEAR
  23866 C
  23867    85 CONTINUE
  23868       lsfin = 83
  23869 C
  23870       DO J=1,JX
  23871       IF((J-2).LT.0)  THEN
  23872          GO TO 101
  23873       ELSE  IF((J-2).EQ.0)  THEN
  23874          GO TO 102
  23875       ELSE
  23876          GO TO 103
  23877       ENDIF
  23878 C
  23879 C     ON THE N-NODES (J=1)
  23880 C
  23881   101 NDX=1
  23882       NBIL=NBIL1
  23883       NBJ=NB
  23884       GO TO 103
  23885 C
  23886 C     OFF-NODE FINE MESH POINTS
  23887 C
  23888   102 NDX=2
  23889       NBIL=NBIL2
  23890       NBJ=NB-1
  23891   103 CONTINUE
  23892 C
  23893 C     CLEAR THE ACCUMULATION WORK SPACE
  23894 C
  23895       ZAB(MAOL:MBOL,NA:NB)=0.
  23896 
  23897       if(lgon1.eq.110)  then
  23898          go to 110
  23899       else  if(lgon1.eq.120)  then

Page 687         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23900          go to 120
  23901       else
  23902          call ABRT1(' SLINTO',110)
  23903       endif
  23904 C
  23905 C     AT N=1. (FOR NA=1 ONLY)
  23906 C
  23907   110 CONTINUE
  23908       DO ND=0,NDX
  23909          DO M=MAOL,MBOL
  23910             ZAB(M,1)=A(KA,M,1+ND)*YB1(2+ND,J)+ZAB(M,1)
  23911          ENDDO
  23912       ENDDO
  23913 C
  23914 C     AT ALL N BETWEEN NAIL AND NBIL, BUT NBIL IS.LE. NX1
  23915 C     NOTE ... THE SECOND DO WILL NOT EXECUTE IF NAIL .GT. NBIL
  23916 C
  23917   120 CONTINUE
  23918       DO ND=-1,NDX
  23919          DO N=NAIL,NBIL
  23920             DO M=MAOL,MBOL
  23921                ZAB(M,N)=A(KA,M,N+ND)*YBN(2+ND,J)+ZAB(M,N)
  23922             ENDDO
  23923          ENDDO
  23924       ENDDO
  23925 C
  23926 C     CHECK THE LEFT LIMIT OF ACCUMULATION
  23927 C
  23928       if(lgonx.eq.126)  then
  23929          go to 126
  23930       else  if(lgonx.eq.128)  then
  23931          go to 128
  23932       else  if(lgonx.eq.150)  then
  23933          go to 150
  23934       else
  23935          call ABRT1(' SLINTO',126)
  23936       endif
  23937 
  23938   126 IF(J.EQ.1) GO TO 130
  23939       GO TO 140
  23940   128 IF(J.EQ.1) GO TO 140
  23941       GO TO 150
  23942 C
  23943 C     ONLY FOR J=1 AND NB=NXX
  23944 C
  23945   130 CONTINUE
  23946       DO ND=-1,0
  23947          DO M=MAOL,MBOL
  23948             ZAB(M,NXX)=A(KA,M,NXX+ND)*YBXX(2+ND)+ZAB(M,NXX)
  23949          ENDDO
  23950       ENDDO
  23951 C
  23952 C     FOR ALL J IF NB=NXX(ENTERS FROM 132)
  23953 C     ONLY FOR J=1 IF NB=NX
  23954 C
  23955   140 CONTINUE
  23956       DO ND=-1,1

Page 688         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  23957          DO M=MAOL,MBOL
  23958             ZAB(M,NX)=A(KA,M,NX+ND)*YBX(2+ND,J)+ZAB(M,NX)
  23959          ENDDO
  23960       ENDDO
  23961   150 CONTINUE
  23962       DO I=1,IX
  23963       IF((I-2).LT.0)  THEN
  23964          GO TO 201
  23965       ELSE  IF((I-2).EQ.0)  THEN
  23966          GO TO 202
  23967       ELSE
  23968          GO TO 203
  23969       ENDIF
  23970   201 MDX=1
  23971       MBIL=MBIL1
  23972       GO TO 203
  23973   202 MDX=2
  23974       MBIL=MBIL2
  23975   203 CONTINUE
  23976 C
  23977 C     FOR SHORTHAND WRITING
  23978 C
  23979       JZ=JX-J
  23980       IZ=IX-I
  23981       IMXXZ=IX*MXX-IZ
  23982       IMXZ =IX*MX -IZ
  23983 C
  23984 C     ++ NBJ, BELOW, IS CORRECTION OF NB IN EARLIER VERSIONS (07/30/79)
  23985 C
  23986       if(lgom1.eq.210)  then
  23987          go to 210
  23988       else  if(lgom1.eq.220)  then
  23989          go to 220
  23990       else
  23991          call ABRT1(' SLINTO',210)
  23992       endif
  23993   210 CONTINUE
  23994       DO MD=0,MDX
  23995          DO N=NA,NBJ
  23996             F(KF,I,JX*N-JZ)=ZAB(1+MD,N)*XB1(2+MD,I)+F(KF,I,JX*N-JZ)
  23997          ENDDO
  23998       ENDDO
  23999   220 CONTINUE
  24000       DO MD=-1,MDX
  24001          DO M=MAIL,MBIL
  24002             DO N=NA,NBJ
  24003                F(KF,IX*M-IZ,JX*N-JZ)=ZAB(M+MD,N)*XBM(2+MD,I)
  24004      1                                          +F(KF,IX*M-IZ,JX*N-JZ)
  24005             ENDDO
  24006          ENDDO
  24007       ENDDO
  24008       if(lgomx.eq.226)  then
  24009          go to 226
  24010       else  if(lgomx.eq.228)  then
  24011          go to 228
  24012       else  if(lgomx.eq.250)  then
  24013          go to 250

Page 689         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  24014       else
  24015          call ABRT1(' SLINTO',226)
  24016       endif
  24017   226 IF(I.EQ.1) GO TO 230
  24018       GO TO 240
  24019   228 IF(I.EQ.1) GO TO 240
  24020       GO TO 250
  24021   230 CONTINUE
  24022       DO MD=-1,0
  24023          DO N=NA,NBJ
  24024             F(KF,IMXXZ,JX*N-JZ)=ZAB(MXX+MD,N)*XBXX(2+MD)+
  24025      1                                              F(KF,IMXXZ,JX*N-JZ)
  24026          ENDDO
  24027       ENDDO
  24028   240 CONTINUE
  24029       DO MD=-1,1
  24030          DO N=NA,NBJ
  24031             F(KF,IMXZ,JX*N-JZ)=ZAB(MX+MD,N)*XBX(2+MD,I)+
  24032      1                                               F(KF,IMXZ,JX*N-JZ)
  24033          ENDDO
  24034       ENDDO
  24035   250 CONTINUE
  24036       ENDDO
  24037       ENDDO
  24038   300 CONTINUE
  24039 C
  24040 C     ** THE OUT SWITCH
  24041 C
  24042       if(lsfout.eq.310)  then
  24043          go to 310
  24044       else if(lsfout.eq.320)  then
  24045          go to 320
  24046       else
  24047          call ABRT1(' SLINTO',310)
  24048       endif
  24049 C
  24050   310 CONTINUE
  24051       DO M=1,MFDIM
  24052          DO N=1,NFDIM
  24053             F(KF,M,N)=-F(KF,M,N)
  24054          ENDDO
  24055       ENDDO
  24056 C
  24057 C     RESET THE OUT SWITCH TO THE NORMAL POSITION (PASS AS IS)
  24058 C
  24059       lsfout = 320
  24060   320 CONTINUE
  24061       RETURN
  24062 C
  24063 C     ** ERROR EXITS
  24064 C
  24065   900 WRITE(6,8900) MXX,NXX,MDIM,NDIM
  24066  8900 FORMAT(/' === SLINTA FOUND MXX,NXX TOO LARGE FOR MDIM,NDIM'
  24067      1   ,5X,2I5,5X,2I5)
  24068       GO TO 990
  24069   901 WRITE(6,8901) M1,M2,N1,N2,MXX,NXX
  24070  8901 FORMAT(/' === SLINTA INPUT ARGUMENTS M1,M2,N1,N2 ARE IN ERROR'

Page 690         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  24071      1    ,5X,2I5,3X,2I5,5X,'MXX,NXX ARE',3X,2I5)
  24072       GO TO 990
  24073   902 WRITE(6,8902) KPA,KDXDIM
  24074  8902 FORMAT(/' === SLINTO ARGUMENT KPA IS TOO LARGE FOR KDXDIM',5X,2I3
  24075      1)
  24076       GO TO 990
  24077   905 WRITE(6,8905) M3,N3,IXBFDM,JXBFDM
  24078  8905 FORMAT(/' === SLINTA INPUT ARGUMENTS M3,N3 ARE TOO LARGE FOR '
  24079      1    ,'THE LOCAL PARAMETERS IXBFDM,JXBFDM',5X,2I3,5X,2I3)
  24080       GO TO 990
  24081   910 WRITE(6,8910) KPFDIM,MFDIM,NFDIM,MFDIM0,NFDIM0
  24082  8910 FORMAT(/' === SLINTO ARGUMENTS KPFDIM,MFDIM,NFDIM ARE TOO SMALL '
  24083      1   ,'FOR THE REQUIRED KPF,MFDIM0,NFDIM0', 5X,I3,2I5,5X,I3,2I5)
  24084       GO TO 990
  24085   920 WRITE(6,8920) IX,JX,IXBF0,JXBF0
  24086  8920 FORMAT(/' === SLINTO FOUND M3,N3 HAVE BEEN CHANGED SINCE THE '
  24087      1   ,'LAST CALL TO SLINTD WAS MADE',5X,2I3,5X,2I3)
  24088       GO TO 990
  24089   990 CALL ABRT1(KENTRY,8920)
  24090       END


ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 slinta_               slintd_               slinto_               slints_               splint_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  23881                                                          23872                             
 102                        Label  23888                                                          23874                             
 103                        Label  23891                                                          23876,23884                       
 110                        Label  23907                                                          23898                             
 120                        Label  23917                                                          23900                             
 126                        Label  23938                                                          23929                             
 128                        Label  23940                                                          23931                             
 130                        Label  23945                                                          23938                             
 140                        Label  23955                                                          23939,23940                       
 150                        Label  23961                                                          23933,23941                       
 201                        Label  23970                                                          23964                             
 202                        Label  23973                                                          23966                             
 203                        Label  23975                                                          23968,23972                       
 210                        Label  23993                                                          23987                             
 220                        Label  23999                                                          23989                             
 226                        Label  24017                                                          24009                             
 228                        Label  24019                                                          24011                             
 230                        Label  24021                                                          24017                             
 240                        Label  24028                                                          24018,24019                       
 250                        Label  24035                                                          24013,24020                       
 300                        Label  24038                                                                                            
 310                        Label  24050                                                          24043                             
 320                        Label  24060                                                          24045                             
 71                         Label  23782                                                          23775                             

Page 691         Source Listing                  SPLINT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 72                         Label  23795                                                          23777                             
 73                         Label  23807                                                          23790,23798                       
 74                         Label  23813                                                          23788,23800                       
 75                         Label  23819                                                          23786,23802                       
 78                         Label  23821                                                          23809,23815                       
 81                         Label  23852                                                          23843                             
 83                         Label  23861                                                          23845                             
 85                         Label  23867                                                          23847,23859                       
 8900                       Label  24066                                                          24065                             
 8901                       Label  24070                                                          24069                             
 8902                       Label  24074                                                          24073                             
 8905                       Label  24078                                                          24077                             
 8910                       Label  24082                                                          24081                             
 8920                       Label  24086                                                          24085                             
 900                        Label  24065                                                          23639,23640                       
 901                        Label  24069                                                          23650,23651,23652,23653           
 902                        Label  24073                                                          23833                             
 905                        Label  24077                                                          23654,23655                       
 910                        Label  24081                                                          23834,23835,23836                 
 920                        Label  24085                                                          23837,23838                       
 990                        Label  24089                                                          24068,24072,24076,24080,24084,2408
                                                                                                  8                                 
 A                          Dummy  23590    R(4)            4     3     49000    ARG,INOUT        23910,23921,23948,23958           
 ABRT1                      Subr   23849                                                          23849,23902,23935,23991,24015,2404
                                                                                                  7,24089                           
 COSYN                      Scalar 23623    R(4)            4     1     35       COM                                                
 DXM                        Scalar 23622    R(4)            4           scalar   COM              23718                             
 DXMI                       Local  23718    R(4)            4           scalar   SAVE             23718,23722                       
 DYN                        Scalar 23622    R(4)            4           scalar   COM              23719                             
 DYNJ                       Local  23719    R(4)            4           scalar   SAVE             23719,23739                       
 F                          Dummy  23590    R(4)            4     3     0        ARG,INOUT        23855,23863,23996,24003,24004,2402
                                                                                                  4,24025,24031,24032,24053         
 I                          Local  23721    I(4)            4           scalar   SAVE             23721,23722,23724,23727,23730,2396
                                                                                                  2,23963,23965,23980,23996,24003,24
                                                                                                  017,24019,24031                   
 IMXXZ                      Local  23981    I(4)            4           scalar   SAVE             23981,24024,24025                 
 IMXZ                       Local  23982    I(4)            4           scalar   SAVE             23982,24031,24032                 
 ISFAC                      Dummy  23591    I(4)            4           scalar   ARG,INOUT        23774                             
 ISFIN                      Dummy  23591    I(4)            4           scalar   ARG,INOUT        23785,23787,23797,23799           
 IX                         Local  23646    I(4)            4           scalar   SAVE             23646,23654,23667,23716,23718,2372
                                                                                                  1,23837,23962,23980,23981,23982,24
                                                                                                  003,24004,24085                   
 IXBF0                      Local  23716    I(4)            4           scalar   SAVE             23716,23837,24085                 
 IXBFDM                     Param  23610    I(4)            4           scalar                    23614,23654,24077                 
 IZ                         Local  23980    I(4)            4           scalar   SAVE             23980,23981,23982,24003,24004     
 J                          Local  23738    I(4)            4           scalar   SAVE             23738,23739,23741,23744,23747,2387
                                                                                                  0,23871,23873,23910,23921,23938,23
                                                                                                  940,23958,23979                   
 JX                         Local  23649    I(4)            4           scalar   SAVE             23649,23655,23668,23717,23719,2373
                                                                                                  8,23838,23870,23979,23996,24003,24
                                                                                                  004,24024,24025,24031,24032,24085 
 JXBF0                      Local  23717    I(4)            4           scalar   SAVE             23717,23838,24085                 
 JXBFDM                     Param  23610    I(4)            4           scalar                    23615,23655,24077                 
 JZ                         Local  23979    I(4)            4           scalar   SAVE             23979,23996,24003,24004,24024,2402
                                                                                                  5,24031,24032                     

Page 692         Source Listing                  SPLINT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 KA                         Local  23828    I(4)            4           scalar   SAVE             23828,23910,23921,23948,23958     
 KDTDIM                     Param  23594    I(4)            4           scalar                    23595                             
 KDXDIM                     Param  23595    I(4)            4           scalar                    23602,23833,24073                 
 KENTRY                     Local  23621    CHAR            7           scalar   SAVE             23625,23631,23827,24089           
 KF                         Local  23829    I(4)            4           scalar   SAVE             23829,23855,23863,23996,24003,2400
                                                                                                  4,24024,24025,24031,24032,24053   
 KLDIM                      Param  23593    I(4)            4           scalar                    23595                             
 KPA                        Dummy  23590    I(4)            4           scalar   ARG,INOUT        23828,23833,24073                 
 KPF                        Dummy  23590    I(4)            4           scalar   ARG,INOUT        23829,23834                       
 KPFDIM                     Dummy  23590    I(4)            4           scalar   ARG,INOUT        23606,23834,24081                 
 LGOM1                      Local  23679    I(4)            4           scalar   SAVE             23679,23687,23986,23988           
 LGOMX                      Local  23680    I(4)            4           scalar   SAVE             23680,23689,23691,24008,24010,2401
                                                                                                  2                                 
 LGON1                      Local  23677    I(4)            4           scalar   SAVE             23677,23681,23897,23899           
 LGONX                      Local  23678    I(4)            4           scalar   SAVE             23678,23683,23685,23928,23930,2393
                                                                                                  2                                 
 LSFIN                      Local  23672    I(4)            4           scalar   SAVE             23672,23808,23814,23820,23842,2384
                                                                                                  4,23846,23868                     
 LSFOUT                     Local  23673    I(4)            4           scalar   SAVE             23673,23783,23796,24042,24044,2405
                                                                                                  9                                 
 M                          Local  23853    I(4)            4           scalar   SAVE             23853,23855,23909,23910,23920,2392
                                                                                                  1,23947,23948,23957,23958,24001,24
                                                                                                  003,24004,24051,24053             
 M1                         Dummy  23590    I(4)            4           scalar   ARG,INOUT        23644,23645,24069                 
 M2                         Dummy  23590    I(4)            4           scalar   ARG,INOUT        23644,23645,24069                 
 M3                         Dummy  23590    I(4)            4           scalar   ARG,INOUT        23646,24077                       
 MA                         Local  23644    I(4)            4           scalar   SAVE             23644,23650,23656,23658,23667,2368
                                                                                                  7                                 
 MAIL                       Local  23658    I(4)            4           scalar   SAVE             23658,24001                       
 MAOL                       Local  23656    I(4)            4           scalar   SAVE             23656,23895,23909,23920,23947,2395
                                                                                                  7                                 
 MAX                        Func   23645                                scalar                    23645,23646,23648,23649,23656,2365
                                                                                                  8,23659                           
 MB                         Local  23645    I(4)            4           scalar   SAVE             23645,23651,23657,23660,23661,2366
                                                                                                  7,23688,23690                     
 MBIL                       Local  23971    I(4)            4           scalar   SAVE             23971,23974,24001                 
 MBIL1                      Local  23660    I(4)            4           scalar   SAVE             23660,23971                       
 MBIL2                      Local  23661    I(4)            4           scalar   SAVE             23661,23974                       
 MBOL                       Local  23657    I(4)            4           scalar   SAVE             23657,23895,23909,23920,23947,2395
                                                                                                  7                                 
 MD                         Local  23723    I(4)            4           scalar   SAVE             23723,23724,23726,23727,23729,2373
                                                                                                  0,23734,23735,23994,23996,24000,24
                                                                                                  003,24022,24024,24029,24031       
 MDIM                       Param  23592    I(4)            4           scalar                    23602,23619,23622,23639,24065     
 MDX                        Local  23970    I(4)            4           scalar   SAVE             23970,23973,23994,24000           
 MFDIM                      Dummy  23590    I(4)            4           scalar   ARG,INOUT        23606,23835,23853,24051,24081     
 MFDIM0                     Local  23667    I(4)            4           scalar   SAVE             23667,23835,24081                 
 MIN                        Func   23644                                scalar                    23644,23647,23657,23660,23661,2366
                                                                                                  2,23663                           
 MX                         Local  23635    I(4)            4           scalar   SAVE             23635,23636,23690,23730,23982,2403
                                                                                                  1                                 
 MX1                        Local  23636    I(4)            4           scalar   SAVE             23636,23660,23661                 
 MXX                        Scalar 23622    I(4)            4           scalar   COM              23635,23639,23651,23657,23688,2373
                                                                                                  5,23981,24024,24065,24069         
 N                          Local  23854    I(4)            4           scalar   SAVE             23854,23855,23919,23921,23995,2399

Page 693         Source Listing                  SPLINT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  6,24002,24003,24004,24023,24024,24
                                                                                                  025,24030,24031,24032,24052,24053 
 N1                         Dummy  23590    I(4)            4           scalar   ARG,INOUT        23647,23648,24069                 
 N2                         Dummy  23590    I(4)            4           scalar   ARG,INOUT        23647,23648,24069                 
 N3                         Dummy  23591    I(4)            4           scalar   ARG,INOUT        23649,24077                       
 NA                         Local  23647    I(4)            4           scalar   SAVE             23647,23652,23659,23668,23681,2389
                                                                                                  5,23995,24002,24023,24030         
 NAIL                       Local  23659    I(4)            4           scalar   SAVE             23659,23919                       
 NB                         Local  23648    I(4)            4           scalar   SAVE             23648,23653,23662,23663,23668,2368
                                                                                                  2,23684,23883,23890,23895         
 NBIL                       Local  23882    I(4)            4           scalar   SAVE             23882,23889,23919                 
 NBIL1                      Local  23662    I(4)            4           scalar   SAVE             23662,23882                       
 NBIL2                      Local  23663    I(4)            4           scalar   SAVE             23663,23889                       
 NBJ                        Local  23883    I(4)            4           scalar   SAVE             23883,23890,23995,24002,24023,2403
                                                                                                  0                                 
 ND                         Local  23740    I(4)            4           scalar   SAVE             23740,23741,23743,23744,23746,2374
                                                                                                  7,23751,23752,23908,23910,23918,23
                                                                                                  921,23946,23948,23956,23958       
 NDIM                       Param  23592    I(4)            4           scalar                    23602,23619,23622,23623,23640,2406
                                                                                                  5                                 
 NDX                        Local  23881    I(4)            4           scalar   SAVE             23881,23888,23908,23918           
 NFDIM                      Dummy  23590    I(4)            4           scalar   ARG,INOUT        23606,23836,23854,24052,24081     
 NFDIM0                     Local  23668    I(4)            4           scalar   SAVE             23668,23836,24081                 
 NX                         Local  23637    I(4)            4           scalar   SAVE             23637,23638,23684,23747,23958     
 NX1                        Local  23638    I(4)            4           scalar   SAVE             23638,23662,23663                 
 NXX                        Scalar 23622    I(4)            4           scalar   COM              23637,23640,23653,23682,23752,2394
                                                                                                  8,24065,24069                     
 REAL                       Func   23718                                scalar                    23718,23719                       
 S2NODE                     Common 23622                                716      SAVE                                               
 SLINTA                     Subr   23630                                                                                            
 SLINTD                     Subr   23712                                                                                            
 SLINTO                     Subr   23826                                                                                            
 SLINTS                     Subr   23773                                                                                            
 SPLINT                     Subr   23590                                                                                            
 XB1                        Local  23614    R(4)            4     2     32       SAVE             23724,23996                       
 XBM                        Local  23614    R(4)            4     2     32       SAVE             23727,24003                       
 XBX                        Local  23614    R(4)            4     2     32       SAVE             23730,24031                       
 XBXX                       Local  23614    R(4)            4     1     4        SAVE             23735,24024                       
 XM                         Scalar 23622    R(4)            4     1     35       COM              23724,23727,23730,23735           
 XMC                        Scalar 23622    R(4)            4     1     35       COM                                                
 XMI                        Local  23722    R(4)            4           scalar   SAVE             23722,23724,23727,23730           
 YB1                        Local  23615    R(4)            4     2     32       SAVE             23741,23910                       
 YBN                        Local  23615    R(4)            4     2     32       SAVE             23744,23921                       
 YBX                        Local  23615    R(4)            4     2     32       SAVE             23747,23958                       
 YBXX                       Local  23615    R(4)            4     1     4        SAVE             23752,23948                       
 YN                         Scalar 23622    R(4)            4     1     35       COM              23741,23744,23747,23752           
 YNC                        Scalar 23623    R(4)            4     1     35       COM                                                
 YNJ                        Local  23739    R(4)            4           scalar   SAVE             23739,23741,23744,23747           
 ZAB                        Local  23619    R(4)            4     2     1225     SAVE             23895,23910,23921,23948,23958,2399
                                                                                                  6,24003,24024,24031               
 ZXBF                       Func   23591    R(4)            4           scalar   ARG,INOUT        23724,23727,23730,23735           
 ZYBF                       Func   23591    R(4)            4           scalar   ARG,INOUT        23741,23744,23747,23752           

Page 694         Source Listing                  SPLINT
2017-04-18 11:09                                 syndata.f

  24091 
  24092 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24093 C                .      .    .                                       .
  24094 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24095 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24096 C
  24097 C ABSTRACT: ??????????????????????????????????????????????????????????
  24098 C   ??????????????????????????????????????????????????????????????????
  24099 C
  24100 C PROGRAM HISTORY LOG:
  24101 C ????-??-??  S. J. LORD
  24102 C
  24103 C USAGE:    CALL ????????(????)
  24104 C   INPUT ARGUMENT LIST:
  24105 C     ??????   - ???????????????????????????????????????????????
  24106 C
  24107 C   OUTPUT ARGUMENT LIST:
  24108 C     ??????   - ???????????????????????????????????????????????
  24109 C
  24110 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24111 C     ??????   - ???????????????????????????????????????????????
  24112 C
  24113 C   OUTPUT FILES:
  24114 C     ??????   - ???????????????????????????????????????????????
  24115 C
  24116 C REMARKS: ?????????????????????????????????????????????????????
  24117 C
  24118 C ATTRIBUTES:
  24119 C   LANGUAGE: FORTRAN 90
  24120 C   MACHINE:  NCEP WCOSS
  24121 C
  24122 C$$$
  24123       SUBROUTINE SPTINO(X,Y,A,K1,K2,F)
  24124 C
  24125       PARAMETER (MDIM=35,NDIM=35)
  24126       PARAMETER (KLDIM= 8)
  24127       PARAMETER (KDTDIM=5)
  24128       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  24129 C
  24130       SAVE
  24131 C
  24132 C     ** ** SPOT INVERSE TRANSFORMATION OF SPLINE AMPLITUDES TO F AT X,Y
  24133 C       X,Y        THE SPOT COORDINATES AT WHICH OUTPUT F IS DESIRED
  24134 C       A(K,M,N)   KTH COMPONENT OF NODAL AMPLITUDE AT M,N
  24135 C       K1,K2      THE  RANGE OF COMPONENTS K OF THE AMPLITUDE (NOT OF O
  24136 C       F(KF)      THE SPOT OUTPUT F.  KF=1 FOR K=K1
  24137 C                                      KF=2 FOR K=K1+1,  TILL
  24138 C                                      KF=K2-K1+1 FOR K=K2
  24139 C     ** DUMMY ARGUMENTS
  24140 C
  24141       DIMENSION A(KDXDIM,MDIM,NDIM)
  24142 cc dak 07/03/05      DIMENSION F(1)
  24143       dimension f(*) ! dak 7/3/05: fix bounds-check error
  24144       DIMENSION BM(4),BN(4),ZN(4)
  24145 C
  24146       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  24147      1                 YNC(NDIM),COSYN(NDIM)

Page 695         Source Listing                  SPTINO
2017-04-18 11:09                                 syndata.f

  24148       EQUIVALENCE (XM(1),X1),(YN(1),Y1)
  24149 C
  24150 C     ** LOCAL WORK SPACE
  24151 C
  24152       M0=MAX(INT((X-X1)/DXM),1)-1
  24153       N0=MAX(INT((Y-Y1)/DYN),1)-1
  24154       M4=MIN(MXX-M0,4)
  24155       N4=MIN(NXX-N0,4)
  24156 C
  24157       DO M=1,M4
  24158          BM(M)=XBF(M+M0,X)
  24159       ENDDO
  24160 C
  24161       DO N=1,N4
  24162          BN(N)=YBF(N+N0,Y)
  24163       ENDDO
  24164 C
  24165       KF=0
  24166 C
  24167       DO K=K1,K2
  24168          KF=KF+1
  24169          ZN=0.
  24170          DO M=1,M4
  24171             DO N=1,N4
  24172                ZN(N)=ZN(N)+BM(M)*A(K,M+M0,N+N0)*BN(N)
  24173             ENDDO
  24174          ENDDO
  24175          F(KF)=ZN(1)+ZN(2)+ZN(3)+ZN(4)
  24176       ENDDO
  24177 C
  24178       RETURN
  24179       END

Page 696         Source Listing                  SPTINO
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sptino_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  24123    R(4)            4     3     49000    ARG,INOUT        24172                             
 BM                         Local  24144    R(4)            4     1     4        SAVE             24158,24172                       
 BN                         Local  24144    R(4)            4     1     4        SAVE             24162,24172                       
 COSYN                      Scalar 24147    R(4)            4     1     35       COM                                                
 DXM                        Scalar 24146    R(4)            4           scalar   COM              24152                             
 DYN                        Scalar 24146    R(4)            4           scalar   COM              24153                             
 F                          Dummy  24123    R(4)            4     1     0        ARG,INOUT        24175                             
 INT                        Func   24152                                scalar                    24152,24153                       
 K                          Local  24167    I(4)            4           scalar   SAVE             24167,24172                       
 K1                         Dummy  24123    I(4)            4           scalar   ARG,INOUT        24167                             
 K2                         Dummy  24123    I(4)            4           scalar   ARG,INOUT        24167                             
 KDTDIM                     Param  24127    I(4)            4           scalar                    24128                             
 KDXDIM                     Param  24128    I(4)            4           scalar                    24141                             
 KF                         Local  24165    I(4)            4           scalar   SAVE             24165,24168,24175                 
 KLDIM                      Param  24126    I(4)            4           scalar                    24128                             
 M                          Local  24157    I(4)            4           scalar   SAVE             24157,24158,24170,24172           
 M0                         Local  24152    I(4)            4           scalar   SAVE             24152,24154,24158,24172           
 M4                         Local  24154    I(4)            4           scalar   SAVE             24154,24157,24170                 
 MAX                        Func   24152                                scalar                    24152,24153                       
 MDIM                       Param  24125    I(4)            4           scalar                    24141,24146                       
 MIN                        Func   24154                                scalar                    24154,24155                       
 MXX                        Scalar 24146    I(4)            4           scalar   COM              24154                             
 N                          Local  24161    I(4)            4           scalar   SAVE             24161,24162,24171,24172           
 N0                         Local  24153    I(4)            4           scalar   SAVE             24153,24155,24162,24172           
 N4                         Local  24155    I(4)            4           scalar   SAVE             24155,24161,24171                 
 NDIM                       Param  24125    I(4)            4           scalar                    24141,24146,24147                 
 NXX                        Scalar 24146    I(4)            4           scalar   COM              24155                             
 S2NODE                     Common 24146                                716      SAVE                                               
 SPTINO                     Subr   24123                                                                                            
 X                          Dummy  24123    R(4)            4           scalar   ARG,INOUT        24152,24158                       
 X1                         Scalar 24148    R(4)            4           scalar   COM              24152                             
 XBF                        Func   24158    R(4)            4           scalar                    24158                             
 XM                         Scalar 24146    R(4)            4     1     35       COM                                                
 XMC                        Scalar 24146    R(4)            4     1     35       COM                                                
 Y                          Dummy  24123    R(4)            4           scalar   ARG,INOUT        24153,24162                       
 Y1                         Scalar 24148    R(4)            4           scalar   COM              24153                             
 YBF                        Func   24162    R(4)            4           scalar                    24162                             
 YN                         Scalar 24146    R(4)            4     1     35       COM                                                
 YNC                        Scalar 24147    R(4)            4     1     35       COM                                                
 ZN                         Local  24144    R(4)            4     1     4        SAVE             24169,24172,24175                 

Page 697         Source Listing                  SPTINO
2017-04-18 11:09                                 syndata.f

  24180 
  24181 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24182 C                .      .    .                                       .
  24183 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24184 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24185 C
  24186 C ABSTRACT: ??????????????????????????????????????????????????????????
  24187 C   ??????????????????????????????????????????????????????????????????
  24188 C
  24189 C PROGRAM HISTORY LOG:
  24190 C ????-??-??  S. J. LORD
  24191 C
  24192 C USAGE:    CALL ????????(????)
  24193 C   INPUT ARGUMENT LIST:
  24194 C     ??????   - ???????????????????????????????????????????????
  24195 C
  24196 C   OUTPUT ARGUMENT LIST:
  24197 C     ??????   - ???????????????????????????????????????????????
  24198 C
  24199 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24200 C     ??????   - ???????????????????????????????????????????????
  24201 C
  24202 C   OUTPUT FILES:
  24203 C     ??????   - ???????????????????????????????????????????????
  24204 C
  24205 C REMARKS: ?????????????????????????????????????????????????????
  24206 C
  24207 C ATTRIBUTES:
  24208 C   LANGUAGE: FORTRAN 90
  24209 C   MACHINE:  NCEP WCOSS
  24210 C
  24211 C$$$
  24212       SUBROUTINE MSKDMP(MSK)
  24213 C
  24214       REWIND MSK
  24215       WRITE(6,810) MSK,MSK
  24216   810 FORMAT(/' === MSKDMP WAS CALLED ON UNIT=',A8,2X,I3,//,3X,'CNT'
  24217      1    ,'  UNT  LNGTH    WRD1 INT   WRD1 OCTAL',T59,'WRD2 OCTAL'
  24218      2    ,T84,'WRD3 OCTAL',/)
  24219       WRITE(6,10)
  24220    10 FORMAT(/' .... DUMMY MSKDMP ROUTINE')
  24221       CALL ABRT1(' MSKDMP',10)
  24222       RETURN
  24223       END

Page 698         Source Listing                  MSKDMP
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 mskdmp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  24220                                                          24219                             
 810                        Label  24216                                                          24215                             
 ABRT1                      Subr   24221                                                          24221                             
 MSK                        Dummy  24212    I(4)            4           scalar   ARG,INOUT        24214,24215                       
 MSKDMP                     Subr   24212                                                                                            

Page 699         Source Listing                  MSKDMP
2017-04-18 11:09                                 syndata.f

  24224 
  24225 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24226 C                .      .    .                                       .
  24227 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24228 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24229 C
  24230 C ABSTRACT: ??????????????????????????????????????????????????????????
  24231 C   ??????????????????????????????????????????????????????????????????
  24232 C
  24233 C PROGRAM HISTORY LOG:
  24234 C ????-??-??  S. J. LORD
  24235 C
  24236 C USAGE:    CALL ????????(????)
  24237 C   INPUT ARGUMENT LIST:
  24238 C     ??????   - ???????????????????????????????????????????????
  24239 C
  24240 C   OUTPUT ARGUMENT LIST:
  24241 C     ??????   - ???????????????????????????????????????????????
  24242 C
  24243 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24244 C     ??????   - ???????????????????????????????????????????????
  24245 C
  24246 C   OUTPUT FILES:
  24247 C     ??????   - ???????????????????????????????????????????????
  24248 C
  24249 C REMARKS: ?????????????????????????????????????????????????????
  24250 C
  24251 C ATTRIBUTES:
  24252 C   LANGUAGE: FORTRAN 90
  24253 C   MACHINE:  NCEP WCOSS
  24254 C
  24255 C$$$
  24256       SUBROUTINE SPTIKA(X,Y,A,K1,K2,F)
  24257 C
  24258       PARAMETER (MDIM=35,NDIM=35)
  24259       PARAMETER (KLDIM= 8)
  24260       PARAMETER (KDTDIM=5)
  24261       PARAMETER (KDXDIM=KDTDIM*KLDIM)
  24262 C
  24263       SAVE
  24264 C
  24265 C     ** ** SPOT INVERSE TRANSFORMATION OF SPLINE AMPLITUDES TO F AT X,Y
  24266 C     ++ ++ THIS VERSION, SPTIKA, IS DIFFERENT FROM SPTINO IN SLIMBO,
  24267 C           IN THAT EXECUTION IS VECTORIZED WITH RESPECT TO KP.
  24268 C       X,Y        THE SPOT COORDINATES AT WHICH OUTPUT F IS DESIRED
  24269 C       A(K,M,N)   KTH COMPONET OF NODAL AMPLITUDE AT M,N
  24270 C       K1,K2      THE  RANGE OF COMPONENTS K OF THE AMPLITUDE (NOT OF O
  24271 C       F(KF)      THE SPOT OUTPUT F.  KF=1 FOR K=K1
  24272 C                                      KF=2 FOR K=K1+1,  TILL
  24273 C                                      KF=K2-K1+1 FOR K=K2
  24274 C     ** DUMMY ARGUMENTS
  24275 C
  24276       DIMENSION A(KDXDIM,MDIM,NDIM)
  24277 cc dak 07/03/05      F(1)
  24278       dimension f(*) ! dak 7/3/05: fix bounds-check error
  24279       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  24280      1                 YNC(NDIM),COSYN(NDIM)

Page 700         Source Listing                  SPTIKA
2017-04-18 11:09                                 syndata.f

  24281       EQUIVALENCE (XM(1),X1),(YN(1),Y1)
  24282 C
  24283 C     ** LOCAL WORK SPACE
  24284 C
  24285       DIMENSION BM(4),BN(4),ZN(4,KDXDIM)
  24286 C
  24287       M0=MAX(INT((X-X1)/DXM),1)-1
  24288       N0=MAX(INT((Y-Y1)/DYN),1)-1
  24289       M4=MIN(MXX-M0,4)
  24290       N4=MIN(NXX-N0,4)
  24291 C
  24292       DO M=1,M4
  24293          BM(M)=XBF(M+M0,X)
  24294       ENDDO
  24295 C
  24296       DO N=1,N4
  24297          BN(N)=YBF(N+N0,Y)
  24298       ENDDO
  24299 C
  24300       K0=K1-1
  24301       KFX=K2-K0
  24302 C
  24303       ZN(:,1:KFX)=0.
  24304 C
  24305       DO M=1,M4
  24306       DO N=1,N4
  24307       DO KF=1,KFX
  24308          ZN(N,KF)=ZN(N,KF)+BM(M)*A(KF+K0,M+M0,N+N0)*BN(N)
  24309       ENDDO
  24310       ENDDO
  24311       ENDDO
  24312 C
  24313       F(1:KFX)=ZN(1,1:KFX)+ZN(2,1:KFX)+ZN(3,1:KFX)+ZN(4,1:KFX)
  24314 C
  24315       RETURN
  24316       END

Page 701         Source Listing                  SPTIKA
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sptika_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  24256    R(4)            4     3     49000    ARG,INOUT        24308                             
 BM                         Local  24285    R(4)            4     1     4        SAVE             24293,24308                       
 BN                         Local  24285    R(4)            4     1     4        SAVE             24297,24308                       
 COSYN                      Scalar 24280    R(4)            4     1     35       COM                                                
 DXM                        Scalar 24279    R(4)            4           scalar   COM              24287                             
 DYN                        Scalar 24279    R(4)            4           scalar   COM              24288                             
 F                          Dummy  24256    R(4)            4     1     0        ARG,INOUT        24313                             
 INT                        Func   24287                                scalar                    24287,24288                       
 K0                         Local  24300    I(4)            4           scalar   SAVE             24300,24301,24308                 
 K1                         Dummy  24256    I(4)            4           scalar   ARG,INOUT        24300                             
 K2                         Dummy  24256    I(4)            4           scalar   ARG,INOUT        24301                             
 KDTDIM                     Param  24260    I(4)            4           scalar                    24261                             
 KDXDIM                     Param  24261    I(4)            4           scalar                    24276,24285                       
 KF                         Local  24307    I(4)            4           scalar   SAVE             24307,24308                       
 KFX                        Local  24301    I(4)            4           scalar   SAVE             24301,24303,24307,24313           
 KLDIM                      Param  24259    I(4)            4           scalar                    24261                             
 M                          Local  24292    I(4)            4           scalar   SAVE             24292,24293,24305,24308           
 M0                         Local  24287    I(4)            4           scalar   SAVE             24287,24289,24293,24308           
 M4                         Local  24289    I(4)            4           scalar   SAVE             24289,24292,24305                 
 MAX                        Func   24287                                scalar                    24287,24288                       
 MDIM                       Param  24258    I(4)            4           scalar                    24276,24279                       
 MIN                        Func   24289                                scalar                    24289,24290                       
 MXX                        Scalar 24279    I(4)            4           scalar   COM              24289                             
 N                          Local  24296    I(4)            4           scalar   SAVE             24296,24297,24306,24308           
 N0                         Local  24288    I(4)            4           scalar   SAVE             24288,24290,24297,24308           
 N4                         Local  24290    I(4)            4           scalar   SAVE             24290,24296,24306                 
 NDIM                       Param  24258    I(4)            4           scalar                    24276,24279,24280                 
 NXX                        Scalar 24279    I(4)            4           scalar   COM              24290                             
 S2NODE                     Common 24279                                716      SAVE                                               
 SPTIKA                     Subr   24256                                                                                            
 X                          Dummy  24256    R(4)            4           scalar   ARG,INOUT        24287,24293                       
 X1                         Scalar 24281    R(4)            4           scalar   COM              24287                             
 XBF                        Func   24293    R(4)            4           scalar                    24293                             
 XM                         Scalar 24279    R(4)            4     1     35       COM                                                
 XMC                        Scalar 24279    R(4)            4     1     35       COM                                                
 Y                          Dummy  24256    R(4)            4           scalar   ARG,INOUT        24288,24297                       
 Y1                         Scalar 24281    R(4)            4           scalar   COM              24288                             
 YBF                        Func   24297    R(4)            4           scalar                    24297                             
 YN                         Scalar 24279    R(4)            4     1     35       COM                                                
 YNC                        Scalar 24280    R(4)            4     1     35       COM                                                
 ZN                         Local  24285    R(4)            4     2     160      SAVE             24303,24308,24313                 

Page 702         Source Listing                  SPTIKA
2017-04-18 11:09                                 syndata.f

  24317 
  24318 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24319 C                .      .    .                                       .
  24320 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24321 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24322 C
  24323 C ABSTRACT: ??????????????????????????????????????????????????????????
  24324 C   ??????????????????????????????????????????????????????????????????
  24325 C
  24326 C PROGRAM HISTORY LOG:
  24327 C ????-??-??  S. J. LORD
  24328 C
  24329 C USAGE:    CALL ????????(????)
  24330 C   INPUT ARGUMENT LIST:
  24331 C     ??????   - ???????????????????????????????????????????????
  24332 C
  24333 C   OUTPUT ARGUMENT LIST:
  24334 C     ??????   - ???????????????????????????????????????????????
  24335 C
  24336 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24337 C     ??????   - ???????????????????????????????????????????????
  24338 C
  24339 C   OUTPUT FILES:
  24340 C     ??????   - ???????????????????????????????????????????????
  24341 C
  24342 C REMARKS: ?????????????????????????????????????????????????????
  24343 C
  24344 C ATTRIBUTES:
  24345 C   LANGUAGE: FORTRAN 90
  24346 C   MACHINE:  NCEP WCOSS
  24347 C
  24348 C$$$
  24349       SUBROUTINE INVMTX (A,NA,V,NV,N,D,ZD,IER)
  24350 C
  24351 C DIMENSION OF           A(NA,N),V(NV,N),ZD(2*N)
  24352 C ARGUMENTS
  24353 C LATEST REVISION        AUGUST 1977
  24354 C PURPOSE                INVMTX CALCULATES THE INVERSE OF THE MATRIX A,
  24355 C                        OF ORDER N, USING GAUSSIAN ELIMINATION WITH
  24356 C                        FULL PIVOTING.
  24357 C ACCESS CARD            *FORTRAN,S=ULIB,N=INVMTX
  24358 C USAGE                  CALL INVMTX (A,NA,V,NV,N,D,ZD,IER)
  24359 C ARGUMENTS
  24360 C ON INPUT               A
  24361 C                          A TWO-DIMENSIONAL VARIABLE WITH ROW, (FIRST)
  24362 C                          DIMENSION NA AND COLUMN (SECOND) DIMENSION
  24363 C                          .GE. N.  ON INPUT, A CONTAINS THE ELEMENTS OF
  24364 C                          THE N BY N MATRIX TO BE INVERTED.
  24365 C                        NA
  24366 C                          AN INTEGER INPUT VARIABLE SET EQUAL TO THE
  24367 C                          ROW (FIRST) DIMENSION OF A AS DECLARED IN THE
  24368 C                          CALLING PROGRAM.  NA MUST BE .GE. N.
  24369 C                        NV
  24370 C                          AN INTEGER INPUT VARIABLE SET EQUAL TO THE
  24371 C                          ROW (FIRST) DIMENSION OF V AS DECLARED IN THE
  24372 C                          CALLING PROGRAM.  NV MUST BE .GE. N.
  24373 C                        N

Page 703         Source Listing                  INVMTX
2017-04-18 11:09                                 syndata.f

  24374 C                          AN INTEGER INPUT VARIABLE SET EQUAL TO THE
  24375 C                          ORDER OF THE MATRIX TO BE INVERTED.
  24376 C                        ZD
  24377 C                          A REAL ARRAY USED INTERNALLY FOR WORKING
  24378 C                          STORAGE.  IT MUST HAVE DIMENSION AT LEAST
  24379 C                          2*N.
  24380 C ON OUTPUT              V
  24381 C                          A TWO-DIMENSIONAL VARIABLE WITH ROW (FIRST)
  24382 C                          DIMENSION NV AND COLUMN (SECOND) DIMENSION
  24383 C                          .GE. N.  ON OUTPUT, V CONTAINS THE INVERSE OF
  24384 C                          A.
  24385 C                          IF THE MATRIX A NEED NOT BE SAVED, THEN THE
  24386 C                          MATRIX A MAY BE USED AS THE INVERSE V IN THE
  24387 C                          CALL; I.E.,
  24388 C                            CALL INVMTX(A,NA,A,NA,N,D,ZD,IER)
  24389 C                          THEN, ON OUTPUT, A WILL CONTAIN THE INVERSE
  24390 C                          MATRIX AND THE ORIGINAL A WILL HAVE BEEN
  24391 C                          DESTROYED.
  24392 C                        D
  24393 C                          A REAL VARIABLE WHICH, ON OUTPUT, CONTAINS
  24394 C                          THE DETERMINANT OF A.  IF, DURING THE
  24395 C                          COMPUTATION OF THE INVERSE, THE DETERMINANT
  24396 C                          BECOMES LARGER THAN THE LARGEST FLOATING
  24397 C                          POINT NUMBER THE MACHINE CAN REPRESENT, THE
  24398 C                          DETERMINANT CALCULATION IS ABANDONED, A
  24399 C                          MESSAGE IS PRINTED, AND A MEANINGLESS NUMBER
  24400 C                          IS RETURNED IN D.
  24401 C                        IER
  24402 C                          AN INTEGER ERROR FLAG
  24403 C                            =  1  IF THE DETERMINANT IS LARGER THAN THE
  24404 C                                  LARGEST FLOATING POINT NUMBER THAT
  24405 C                                  THE MACHINE CAN REPRESENT.
  24406 C                            = 33  IF THE MATRIX IS NUMERICALLY
  24407 C                                  SINGULAR.
  24408 C                            = 34  IF N .LT. 1.
  24409 C                            = 35  IF NA .LT. N.
  24410 C                            = 36  IF NV .LT. N.
  24411 C ENTRY POINTS           INVMTX, IERINV
  24412 C COMMON BLOCKS          NONE
  24413 C I/O                    AN NCAR RESIDENT ROUTINE, ULIBER, IS USED TO
  24414 C                        PRINT ERROR MESSAGES.
  24415 C PRECISION              DOUBLE (6/22/84 FOR VAX-11 USAGE)
  24416 C REQUIRED ULIB          NONE
  24417 C ROUTINES
  24418 C SPECIALISTS            JO WALSH AND BEN DOMENICO, NCAR,
  24419 C                        BOULDER, COLORADO 80307
  24420 C LANGUAGE               FORTRAN
  24421 C HISTORY                REVISED AND STANDARDIZED FOR NSSL BY JO WALSH,
  24422 C                        APRIL 1974; CERTIFIED BY BEN DOMENICO,
  24423 C                        APRIL 1976.
  24424 C ALGORITHM              THE  UBROUTINE INVMTX SOLVES THE MATRIX
  24425 C                        EQUATION
  24426 C                            A*V = I
  24427 C                        FOR THE MATRIX V (I.E., A**(-1)), WHERE I IS
  24428 C                        THE IDENTITY MATRIX.  THE METHOD USED IS
  24429 C                        GAUSSIAN ELIMINATION WITH FULL PIVOTING.  THE
  24430 C                        MATRIX A IS DECOMPOSED INTO THE PRODUCT OF A

Page 704         Source Listing                  INVMTX
2017-04-18 11:09                                 syndata.f

  24431 C                        LOWER TRIANGULAR MATRIX AND AN UPPER TRIANGULAR
  24432 C                        MATRIX
  24433 C                            A = L*U
  24434 C                        THUS
  24435 C                                A*V = I
  24436 C                            (L*U)*V = I
  24437 C                                U*V = L**(-1)
  24438 C                        THIS UPPER TRIANGULAR MATRIX EQUATION IS SOLVED
  24439 C                        FOR THE COLUMNS OF V USING BACK SUBSTITUTION.
  24440 C                        IF AT ANY POINT, AFTER PIVOTING IS DONE, A
  24441 C                        PIVOT ELEMENT IS NUMERICALLY ZERO RELATIVE TO
  24442 C                        THE LARGEST ELEMENT OF THE MATRIX, THE MATRIX A
  24443 C                        IS DECLARED SINGULAR AND THE SUBROUTINE
  24444 C                        TERMINATES.
  24445 C SPACE REQUIRED         535 (OCTAL) = 349 (DECIMAL)
  24446 C ACCURACY               FOR ANY INPUT MATRIX, A,
  24447 C                          MAX((NORM(A*V(I)-E(I))/(NORM(A)*NORM(V(I)))
  24448 C                              .LE. TOL*N*EPS
  24449 C                        WHERE V(I) IS THE ITH COLUMN OF THE MATRIX V,
  24450 C                        E(I) IS THE ITH COLUMN OF THE IDENTITY MATRIX,
  24451 C                        EPS IS THE LARGEST FLOATING POINT NUMBER SUCH
  24452 C                        THAT 1.+EPS = 1., AND ALL THE NORMS ARE
  24453 C                        L-INFINITY NORMS.  TOL IS A TOLERANCE FACTOR
  24454 C                        SET TO 100 FOR TESTING PURPOSES.
  24455 C                        FOR A SPECIFIC INPUT MATRIX A, AN UPPER BOUND
  24456 C                        ON THE RELATIVE ERROR IN THE COMPUTED INVERSE V
  24457 C                        CAN BE CALCULATED IN TERMS OF THE RESIDUALS
  24458 C                        MATRIX R AS FOLLOWS:
  24459 C                            ((NORM(E))/(NORM(A**(-1)))) .LE. NORM(R)
  24460 C                        WHERE V = A**(-1)+E (THE EXACT INVERSE,
  24461 C                        A**(-1), PLUS AN ERROR MATRIX, E).  THUS, THE
  24462 C                        RELATIVE ERROR IN V, AS MEASURED BY NORM
  24463 C                        (E)/NORM (A**(-1)), IS BOUNDED BY THE NORM OF
  24464 C                        THE RESIDUAL MATRIX WHICH CAN BE COMPUTED AS
  24465 C                        R = A*V**(-1).
  24466 C TIMING                 THE TIME REQUIRED BY INVMTX IS PROPORTIONAL TO
  24467 C                        THE QUANTITY N**3 .   ON THE NCAR
  24468 C                        CONTROL DATA 7600 WITH N = 100, INVMTX TAKES
  24469 C                        ABOUT 1.6 TO 1.7 SECONDS DEPENDING ON THE TIME
  24470 C                        REQUIRED TO FIND THE PIVOT ELEMENTS.
  24471 C PORTABILITY            THE NCAR ROUTINE, ULIBER, IS CALLED.  THERE IS
  24472 C                        A FORTRAN VERSION OF ULIBER ON ULIB.  THERE IS
  24473 C                        A MACHINE-DEPENDENT CONSTANT IN A DATA
  24474 C                        STATEMENT IN INVMTX.  THIS CONSTANT SHOULD BE
  24475 C                        SET TO THE APPROPRIATE VALUE FOR THE MACHINE
  24476 C                        BEING USED, OR THE CODE WHICH USES THE CONSTANT
  24477 C                        CAN BE DELETED AS INDICATED IN THE COMMENT
  24478 C                        CARDS.
  24479 C REQUIRED RESIDENT      ULIBER
  24480 C ROUTINES
  24481 C NOTE                   IN ALMOST ALL APPLICATIONS (E.G., SOLVING
  24482 C                        LINEAR SYSTEMS OR DETERMINING PARTICULAR
  24483 C                        ELEMENTS OF THE INVERSE), THE NSSL PACKAGE,
  24484 C                        LINEQSV, CAN PROVIDE THE SAME CAPABILITIES AS
  24485 C                        INVMTX APPROXIMATELY THREE TIMES AS FAST.
  24486 C                        HOWEVER, INVMTX PERFORMS FULL PIVOTING AND
  24487 C                        REQUIRES LESS STORAGE SINCE IT CAN INVERT THE

Page 705         Source Listing                  INVMTX
2017-04-18 11:09                                 syndata.f

  24488 C                        MATRIX IN PLACE.
  24489 C
  24490       INTEGER NA,NV,N,IER
  24491 cc dak 07/3/05      REAL  ZD(1)
  24492       real  zd(*)  ! dak 7/3/05: fix bounds-check error
  24493       DIMENSION            A(NA,N)    ,V(NV,N)
  24494       DOUBLE PRECISION A,V,D,HOLD,PVT,VH,VMAX
  24495 C
  24496 C FLTMAX IS SET TO THE LARGEST FLOATING POINT NUMBER REPRESENTABLE IN
  24497 C THE MACHINE
  24498 C
  24499       CHARACTER *34 ERMESS
  24500       DATA IEXMAX/38/
  24501 C
  24502 C CALL INVMTA TO CHECK VALIDITY OF ARGUMENT RANGES
  24503 C
  24504       IER = IERINV(N,NA,NV)
  24505       IF (IER .NE. 0) RETURN
  24506 C
  24507 C STORE A IN V
  24508 C
  24509       ZD(1:N) = 0.
  24510       V(1:N,:) = A(1:N,:)
  24511       D = 1.
  24512       IEX = 0
  24513       DO 110 M=1,N
  24514          VMAX = 0.
  24515          DO 104 J=1,N
  24516             IF (NINT(ZD(J)) .NE. 0) GO TO 104
  24517 C
  24518 C FIND MAXIMUM PIVOT ELEMENT
  24519 C
  24520             DO 103 I=1,N
  24521                IF(NINT(ZD(I)) .NE. 0) GO TO 103
  24522                VH = ABS(V(I,J))
  24523                IF (VMAX .GE. VH) GO TO 103
  24524                VMAX = VH
  24525                K = I
  24526                L = J
  24527   103       CONTINUE
  24528   104    CONTINUE
  24529          ZD(L) = K
  24530          NPM = N+M
  24531          ZD(NPM) = L
  24532          D = D*V(K,L)
  24533   105    CONTINUE
  24534          IF (ABS(D) .LE. 1.0) GO TO 106
  24535          D = D*0.1
  24536          IEX = IEX+1
  24537          GO TO 105
  24538   106    CONTINUE
  24539          PVT = V(K,L)
  24540 C
  24541 C CHECK FOR NUMERCALLY SINGULAR MATRIX
  24542 C
  24543          IF (M .EQ. 1) PVTMX = ABS(PVT)
  24544          IF (ABS(PVT/REAL(M))+PVTMX .EQ. PVTMX) GO TO 113

Page 706         Source Listing                  INVMTX
2017-04-18 11:09                                 syndata.f

  24545 C
  24546 C INTERCHANGE ROWS, PLACING PIVOT ELEMENT ON THE DIAGONAL.
  24547 C THEN PROCEDE WITH PIVOTING.
  24548 C
  24549          V(K,L) = 1.
  24550          DO 107 J=1,N
  24551             HOLD = V(K,J)
  24552             V(K,J) = V(L,J)
  24553             V(L,J) = HOLD/PVT
  24554   107    CONTINUE
  24555          DO 109 I=1,N
  24556             IF (I .EQ. L) GO TO 109
  24557             HOLD = V(I,L)
  24558             V(I,L) = 0.
  24559             DO 108 J=1,N
  24560                V(I,J) = V(I,J)-V(L,J)*HOLD
  24561   108       CONTINUE
  24562   109    CONTINUE
  24563   110 CONTINUE
  24564 C
  24565 C PERMUTE FINAL INVERSE MATRIX
  24566 C
  24567       M = N+N+1
  24568       DO 112 J=1,N
  24569          M = M-1
  24570          L = NINT(ZD(M))
  24571          K = NINT(ZD(L))
  24572          IF (K .EQ. L) GO TO 112
  24573          D = -D
  24574          DO 111 I=1,N
  24575             HOLD = V(I,L)
  24576             V(I,L) = V(I,K)
  24577             V(I,K) = HOLD
  24578   111    CONTINUE
  24579   112 CONTINUE
  24580 C
  24581 C CHECK FOR OVERFLOW IN DETERMINANT CALCULATION.
  24582 C
  24583       IF (IEX .GT. IEXMAX) GO TO 114
  24584       D = D*10.**IEX
  24585       RETURN
  24586   113 IER = 33
  24587       ERMESS = 'MATRIX SINGULAR IN INVMTX'
  24588       GO TO 115
  24589   114 IER = 1
  24590       D = REAL(IEX)
  24591       ERMESS = 'DETERMINANT TOO LARGE IN INVMTX'
  24592       RETURN
  24593   115 WRITE(6,116) IER,ERMESS
  24594   116 FORMAT(/'  ....  ERROR NO. ',I4,' IN INVMTX',4X,A34)
  24595       RETURN
  24596       END

Page 707         Source Listing                  INVMTX
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 invmtx_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 103                        Label  24527                                                          24520,24521,24523                 
 104                        Label  24528                                                          24515,24516                       
 105                        Label  24533                                                          24537                             
 106                        Label  24538                                                          24534                             
 107                        Label  24554                                                          24550                             
 108                        Label  24561                                                          24559                             
 109                        Label  24562                                                          24555,24556                       
 110                        Label  24563                                                          24513                             
 111                        Label  24578                                                          24574                             
 112                        Label  24579                                                          24568,24572                       
 113                        Label  24586                                                          24544                             
 114                        Label  24589                                                          24583                             
 115                        Label  24593                                                          24588                             
 116                        Label  24594                                                          24593                             
 A                          Dummy  24349    R(8)            8     2     0        ARG,INOUT        24510                             
 ABS                        Func   24522                                scalar                    24522,24534,24543,24544           
 D                          Dummy  24349    R(8)            8           scalar   ARG,INOUT        24511,24532,24534,24535,24573,2458
                                                                                                  4,24590                           
 ERMESS                     Local  24499    CHAR            34          scalar                    24587,24591,24593                 
 HOLD                       Local  24494    R(8)            8           scalar                    24551,24553,24557,24560,24575,2457
                                                                                                  7                                 
 I                          Local  24520    I(4)            4           scalar                    24520,24521,24522,24525,24555,2455
                                                                                                  6,24557,24558,24560,24574,24575,24
                                                                                                  576,24577                         
 IER                        Dummy  24349    I(4)            4           scalar   ARG,INOUT        24504,24505,24586,24589,24593     
 IERINV                     Func   24504    I(4)            4           scalar                    24504                             
 IEX                        Local  24512    I(4)            4           scalar                    24512,24536,24583,24584,24590     
 IEXMAX                     Local  24500    I(4)            4           scalar                    24500,24583                       
 INVMTX                     Subr   24349                                                                                            
 J                          Local  24515    I(4)            4           scalar                    24515,24516,24522,24526,24550,2455
                                                                                                  1,24552,24553,24559,24560,24568   
 K                          Local  24525    I(4)            4           scalar                    24525,24529,24532,24539,24549,2455
                                                                                                  1,24552,24571,24572,24576,24577   
 L                          Local  24526    I(4)            4           scalar                    24526,24529,24531,24532,24539,2454
                                                                                                  9,24552,24553,24556,24557,24558,24
                                                                                                  560,24570,24571,24572,24575,24576 
 M                          Local  24513    I(4)            4           scalar                    24513,24530,24543,24544,24567,2456
                                                                                                  9,24570                           
 N                          Dummy  24349    I(4)            4           scalar   ARG,INOUT        24493,24504,24509,24510,24513,2451
                                                                                                  5,24520,24530,24550,24555,24559,24
                                                                                                  567,24568,24574                   
 NA                         Dummy  24349    I(4)            4           scalar   ARG,INOUT        24493,24504                       
 NINT                       Func   24516                                scalar                    24516,24521,24570,24571           
 NPM                        Local  24530    I(4)            4           scalar                    24530,24531                       

Page 708         Source Listing                  INVMTX
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NV                         Dummy  24349    I(4)            4           scalar   ARG,INOUT        24493,24504                       
 PVT                        Local  24494    R(8)            8           scalar                    24539,24543,24544,24553           
 PVTMX                      Local  24543    R(4)            4           scalar                    24543,24544                       
 REAL                       Func   24544                                scalar                    24544,24590                       
 V                          Dummy  24349    R(8)            8     2     0        ARG,INOUT        24510,24522,24532,24539,24549,2455
                                                                                                  1,24552,24553,24557,24558,24560,24
                                                                                                  575,24576,24577                   
 VH                         Local  24494    R(8)            8           scalar                    24522,24523,24524                 
 VMAX                       Local  24494    R(8)            8           scalar                    24514,24523,24524                 
 ZD                         Dummy  24349    R(4)            4     1     0        ARG,INOUT        24509,24516,24521,24529,24531,2457
                                                                                                  0,24571                           

Page 709         Source Listing                  INVMTX
2017-04-18 11:09                                 syndata.f

  24597 
  24598 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24599 C                .      .    .                                       .
  24600 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24601 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24602 C
  24603 C ABSTRACT: ??????????????????????????????????????????????????????????
  24604 C   ??????????????????????????????????????????????????????????????????
  24605 C
  24606 C PROGRAM HISTORY LOG:
  24607 C ????-??-??  S. J. LORD
  24608 C
  24609 C USAGE:    CALL ????????(????)
  24610 C   INPUT ARGUMENT LIST:
  24611 C     ??????   - ???????????????????????????????????????????????
  24612 C
  24613 C   OUTPUT ARGUMENT LIST:
  24614 C     ??????   - ???????????????????????????????????????????????
  24615 C
  24616 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24617 C     ??????   - ???????????????????????????????????????????????
  24618 C
  24619 C   OUTPUT FILES:
  24620 C     ??????   - ???????????????????????????????????????????????
  24621 C
  24622 C REMARKS: ?????????????????????????????????????????????????????
  24623 C
  24624 C ATTRIBUTES:
  24625 C   LANGUAGE: FORTRAN 90
  24626 C   MACHINE:  NCEP WCOSS
  24627 C
  24628 C$$$
  24629       FUNCTION IERINV (N,NA,NV)
  24630 C
  24631 C THIS FUNCTION TESTS THE INPUT ARGUMENTS N, NA, AND NV TO INSURE
  24632 C THAT THEY ARE IN THE PROPER RANGES.  THE INPUT ARGUMENTS HAVE THE
  24633 C SAME MEANING AS IN INVMTX.
  24634 C IF ONE OR MORE OF THE FOLLOWING CONDITIONS OCCURS, A FATAL ERROR
  24635 C MESSAGE IS WRITTEN TO UNIT 6 AND THE FUNCTION RETURNS WITH IERINV
  24636 C EQUAL TO THE VALUE INDICATED.
  24637 C        FOR N .LT. 1, IERINV = 34.
  24638 C        FOR NA .LT. N, IERINV = 35.
  24639 C        FOR NV .LT. N, IERINV = 36.
  24640 C IF NO ERROR CONDITION IS DETECTED, THE FUNCTION RETURNS WITH
  24641 C IERINV = 0.
  24642 C
  24643       CHARACTER*24 ERMESS
  24644       IERINV = 0
  24645       IF (N .GE. 1) GO TO 101
  24646       IERINV = 34
  24647       ERMESS = ' N .LT. 1 IN INVMTX '
  24648       GO TO 103
  24649   101 IF (NA .GE. N) GO TO 102
  24650       IERINV = 35
  24651       ERMESS ='NA .LT. N IN INVMTX '
  24652       GO TO 103
  24653   102 IF (NV .GE. N) RETURN

Page 710         Source Listing                  IERINV
2017-04-18 11:09                                 syndata.f

  24654       IERINV = 36
  24655       ERMESS = ' NV .LT. N IN INVMTX '
  24656   103 WRITE(6,104) IERINV,ERMESS
  24657   104 FORMAT(/' ....  ERROR IN IERINV NO. ',I3,4X,A24)
  24658       RETURN
  24659       END


ENTRY POINTS

  Name               
                     
 ierinv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 101                        Label  24649                                                          24645                             
 102                        Label  24653                                                          24649                             
 103                        Label  24656                                                          24648,24652                       
 104                        Label  24657                                                          24656                             
 ERMESS                     Local  24643    CHAR            24          scalar                    24647,24651,24655,24656           
 IERINV                     Func   24629    I(4)            4           scalar                    24644,24646,24650,24654,24656     
 IERINV@0                   Local  24629    I(4)            4           scalar                                                      
 N                          Dummy  24629    I(4)            4           scalar   ARG,INOUT        24645,24649,24653                 
 NA                         Dummy  24629    I(4)            4           scalar   ARG,INOUT        24649                             
 NV                         Dummy  24629    I(4)            4           scalar   ARG,INOUT        24653                             

Page 711         Source Listing                  IERINV
2017-04-18 11:09                                 syndata.f

  24660 
  24661 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24662 C                .      .    .                                       .
  24663 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24664 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24665 C
  24666 C ABSTRACT: ??????????????????????????????????????????????????????????
  24667 C   ??????????????????????????????????????????????????????????????????
  24668 C
  24669 C PROGRAM HISTORY LOG:
  24670 C ????-??-??  S. J. LORD
  24671 C
  24672 C USAGE:    CALL ????????(????)
  24673 C   INPUT ARGUMENT LIST:
  24674 C     ??????   - ???????????????????????????????????????????????
  24675 C
  24676 C   OUTPUT ARGUMENT LIST:
  24677 C     ??????   - ???????????????????????????????????????????????
  24678 C
  24679 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24680 C     ??????   - ???????????????????????????????????????????????
  24681 C
  24682 C   OUTPUT FILES:
  24683 C     ??????   - ???????????????????????????????????????????????
  24684 C
  24685 C REMARKS: ?????????????????????????????????????????????????????
  24686 C
  24687 C ATTRIBUTES:
  24688 C   LANGUAGE: FORTRAN 90
  24689 C   MACHINE:  NCEP WCOSS
  24690 C
  24691 C$$$
  24692       SUBROUTINE XSPLCM(NX,YNB,YNT,YDCWL,KYBC1,KYBC2,YBCWL1,YBCWL2,DATA,
  24693      1                  YDZ,WDZ,LDXX,FITNOD,YNOD,IVARZ,IPLVL,RLAT0,
  24694      2                  RLON0,IHR0,IDAY0,STMNMZ)
  24695 C
  24696 C                    1-D SPLINE  **  03/19/90
  24697 C
  24698 C     MODIFICATION OF XSPLINEX FOR 1 DIMENSIONAL INTERPOLATION OF
  24699 C           DATA FOR COMPOSITING
  24700 C
  24701 C
  24702 C
  24703 C         ++ THIS SUBROUTINE CALLS ALL NECESSARY ROUTINES.  INPUTS
  24704 C              ARE BOUNDARY CONDITIONS, DATA, FILTER WAVELENGTHS
  24705 C                  FROM ARGUMENTS    ++
  24706 C
  24707 C
  24708       PARAMETER (NDIM=71)
  24709 ccccc PARAMETER (LDXDIM=2500)
  24710       PARAMETER (LDXDIM=8000)
  24711       PARAMETER (KDTDIM=5)
  24712 C
  24713       COMMON / / A(KDTDIM,NDIM),FD(KDTDIM,LDXDIM),FKMN(KDTDIM,NDIM),
  24714      1           AMM(NDIM,NDIM),DMM(NDIM,NDIM)
  24715       COMMON/S1DTPT/IDSPD1,IDSPD2,LDX,YD(LDXDIM),WD(LDXDIM),
  24716      1               LXSORT(LDXDIM)

Page 712         Source Listing                  XSPLCM
2017-04-18 11:09                                 syndata.f

  24717       COMMON/S1KOMP/IDSPK(KDTDIM),IDVAR(KDTDIM),KPX
  24718 C
  24719       CHARACTER IDSPD1*8,IDSPD2*72,IDSPK*40,IDXVAR*32
  24720       CHARACTER IDSPC*125,IOK*1,STMNMZ*(*)
  24721       LOGICAL FIRST
  24722 C
  24723       DIMENSION YDZ(LDXX),LDSORT(LDXDIM),DATA(LDXX),WDZ(LDXX),
  24724      1          YNOD(NX+1),FITNOD(NX+1),YDZZ(LDXDIM),IDXVAR(KDTDIM)
  24725 C
  24726       DATA IDXVAR/'SURFACE PRESSURE                ',
  24727      D            'TANGENTIAL COMP. OF WIND (M/S)  ',
  24728      D            'RADIAL COMP. OF WIND (M/S)      ',
  24729      D            'VORTICITY (10**-5 S**-1)        ',
  24730      D            'DIVERGENCE (10**-5 S**-1)       '/
  24731 C    D            'TOTAL WIND SPEED     (M/S)      ',
  24732 C    D            'GEOPOTENTIAL HEIGHT  (M)        '/
  24733 C    D            'TEMPERATURE  (DEG C)            ',
  24734 C    D            'MIXING RATIO (G/KG)             '/
  24735 C
  24736 C
  24737 C     DATA NX/10/,YNB/1050./,YNT/200./
  24738 C     DATA KDC/3/,YDCWL/6./,KDAT/1/
  24739 C     DATA KYBC1/21/,KYBC2/21/,YBCWL1/10./,YBCWL2/10./
  24740       DATA FIRST/.TRUE./
  24741 C
  24742 C     DATA DEFINITION
  24743 C     DOMAIN PARAMETERS:
  24744 C                  NX   - NUMBER OF NODAL POINTS
  24745 C                  YNB  - LEFT BOUNDARY
  24746 C                  YNT  - RIGHT BOUNDARY
  24747 C
  24748       IF(FIRST)  CALL RDTITL(2)
  24749       FIRST=.FALSE.
  24750       CALL PRTITL(2)
  24751 C
  24752 C
  24753       IF(IPLVL .GT. 0)  WRITE(6,11)
  24754    11 FORMAT(///11X,'DATA TYPES ARE:',/,16X,
  24755      1       ' 1: OBS. SURFACE PRESSURE DATA',/,16X,
  24756      2       ' 2: OBS. TANGENTIAL WIND DATA',/,16X,
  24757      3       ' 3: OBS. RADIAL WIND DATA DATA',/,16X,
  24758      4       ' 4: SHAPIRO VORTEX MODEL VORTICITY',/,16X,
  24759      5       ' 5: SHAPIRO VORTEX MODEL DIVERGENCE')
  24760 C
  24761       WRITE(IDSPC,18) STMNMZ,IVARZ,RLAT0,RLON0,IDAY0,IHR0
  24762    18 FORMAT(A,' DATA TYPE=',I4,'  LAT.=',
  24763      1       F6.1,'  LONG.=',
  24764      2       F6.1,' DAY=',I8,'  HOUR=',I6,18X)
  24765 C
  24766 C     CONVERT INPUT DOMAIN PARAMETERS TO SPLINE NOTATION
  24767 C
  24768       YN1  = YNB
  24769       YNXX = YNT
  24770       DYN=(YNXX-YN1)/NX
  24771       NODINT=NX
  24772 C
  24773       CALL STSND1(NX,YN1,YNXX)

Page 713         Source Listing                  XSPLCM
2017-04-18 11:09                                 syndata.f

  24774 C
  24775 C     SET INPUTL BC & FILTER
  24776 C
  24777       KYBC1Z=KYBC1
  24778       KYBC2Z=KYBC2
  24779       YBCL1Z=YBCWL1
  24780       YBCL2Z=YBCWL2
  24781       YDCWLZ=YDCWL
  24782 C
  24783 C     DEFAULT UNIT IS NORMAL PRINTOUT
  24784 C
  24785       IUNIT=6
  24786       IOK='Y'
  24787       KDATS=1
  24788       KDATF=1
  24789       KDAT=1
  24790       KDC=3
  24791 C
  24792 C     CONVERT FILTER WAVELENGTHS AND B.C. WAVELENGTHS TO INTERNAL UNITS
  24793 C         ******   INTERNAL UNITS ARE DELTAY (KM)   ******
  24794 C
  24795       YDCWLZ=YDCWLZ*DYN
  24796       YBCL1Z=YBCL1Z*DYN
  24797       YBCL2Z=YBCL2Z*DYN
  24798 C
  24799       CALL STSID1(IDSPC)
  24800       CALL STSBC1(KYBC1Z,KYBC2Z,YBCL1Z,YBCL2Z)
  24801       CALL STSDC1(KDC,YDCWLZ)
  24802       CALL SL1OVR(NODINT,YNOD)
  24803 C
  24804       FD(1:KDAT,:)=-99.0
  24805       WD=-99.0
  24806       YD=-99.0
  24807 C
  24808 C
  24809       IDSPK(KDAT)=IDXVAR(IVARZ)
  24810       IDVAR(KDAT)=IVARZ
  24811       LDX=LDXX
  24812       DO 20 LD=1,LDX
  24813       WD(LD)=WDZ(LD)
  24814       YD(LD)=YDZ(LD)
  24815       YDZZ(LD)=YDZ(LD)
  24816       FD(KDAT,LD)=DATA(LD)
  24817 c && 3 comments
  24818 CC    WRITE(6,13) LD,YDZ(LD),WDZ(LD),DATA(LD)
  24819 CC 13 FORMAT('...DATA INPUT BEFORE SORTING: LD,YDZ,WDZ,DATA=',I4,
  24820 CC   1       3F12.2)
  24821    20 CONTINUE
  24822 C
  24823       CALL SORTRL(YDZZ,LDSORT,LDX)
  24824 C
  24825       DO 40 LD=1,LDX
  24826       LXSORT(LD)=LDSORT(LD)
  24827 c && 3 comments
  24828 CC    WRITE(6,39) LD,LXSORT(LD),YD(LD),WD(LD),FD(KDAT,LD)
  24829 CC 39 FORMAT('...DATA INPUT AFTER SORTING: LD,LDSORT,YD,WD,FD=',2I4,
  24830 CC   1       3F12.2)

Page 714         Source Listing                  XSPLCM
2017-04-18 11:09                                 syndata.f

  24831    40 CONTINUE
  24832 C
  24833       WRITE(6,51)  LDX
  24834    51 FORMAT(/'....XSPLCM HAS READ DATA ....',I5,' POINTS...')
  24835 C
  24836 C
  24837 C     ***** CALCULATE MATRIX COEFFICIENTS *****
  24838 C
  24839       CALL SL1RGO
  24840 C
  24841       KDX=KDAT
  24842       CALL ST1KPX(KDX)
  24843       CALL SL1MBO(KDATS,KDATF)
  24844       CALL PR1FKM(A,FKMN,KDATS,KDATF)
  24845       IF(IPLVL .GE. 1)
  24846      1   CALL OUTPUTT(FD,A,FKMN,KDATS,KDATF,IUNIT,IPLVL,IOK)
  24847 C
  24848       FITNOD=FKMN(KDAT,1:NX+1)
  24849 C
  24850       WRITE(6,111)
  24851   111 FORMAT(/'...END 1-D SPLINE FITTING...')
  24852 C
  24853       RETURN
  24854 C
  24855       END


ENTRY POINTS

  Name               
                     
 xsplcm_             

Page 715         Source Listing                  XSPLCM
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                            Common 24714                                203168                                                      
 11                         Label  24754                                                          24753                             
 111                        Label  24851                                                          24850                             
 18                         Label  24762                                                          24761                             
 20                         Label  24821                                                          24812                             
 40                         Label  24831                                                          24825                             
 51                         Label  24834                                                          24833                             
 A                          Scalar 24713    R(4)            4     2     355      COM              24844,24846                       
 AMM                        Scalar 24714    R(4)            4     2     5041     COM                                                
 DATA                       Dummy  24692    R(4)            4     1     0        ARG,INOUT        24816                             
 DMM                        Scalar 24714    R(4)            4     2     5041     COM                                                
 DYN                        Local  24770    R(4)            4           scalar                    24770,24795,24796,24797           
 FD                         Scalar 24713    R(4)            4     2     40000    COM              24804,24816,24846                 
 FIRST                      Local  24721    L(4)            4           scalar                    24740,24748,24749                 
 FITNOD                     Dummy  24693    R(4)            4     1     0        ARG,INOUT        24848                             
 FKMN                       Scalar 24713    R(4)            4     2     355      COM              24844,24846,24848                 
 IDAY0                      Dummy  24694    I(4)            4           scalar   ARG,INOUT        24761                             
 IDSPC                      Local  24720    CHAR            125         scalar                    24761,24799                       
 IDSPD1                     Scalar 24715    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 24715    CHAR            72          scalar   COM                                                
 IDSPK                      Scalar 24717    CHAR            40    1     5        COM              24809                             
 IDVAR                      Scalar 24717    I(4)            4     1     5        COM              24810                             
 IDXVAR                     Local  24719    CHAR            32    1     5                         24726,24809                       
 IHR0                       Dummy  24694    I(4)            4           scalar   ARG,INOUT        24761                             
 IOK                        Local  24720    CHAR            1           scalar                    24786,24846                       
 IPLVL                      Dummy  24693    I(4)            4           scalar   ARG,INOUT        24753,24845,24846                 
 IUNIT                      Local  24785    I(4)            4           scalar                    24785,24846                       
 IVARZ                      Dummy  24693    I(4)            4           scalar   ARG,INOUT        24761,24809,24810                 
 KDAT                       Local  24789    I(4)            4           scalar                    24789,24804,24809,24810,24816,2484
                                                                                                  1,24848                           
 KDATF                      Local  24788    I(4)            4           scalar                    24788,24843,24844,24846           
 KDATS                      Local  24787    I(4)            4           scalar                    24787,24843,24844,24846           
 KDC                        Local  24790    I(4)            4           scalar                    24790,24801                       
 KDTDIM                     Param  24711    I(4)            4           scalar                    24713,24717,24724                 
 KDX                        Local  24841    I(4)            4           scalar                    24841,24842                       
 KPX                        Scalar 24717    I(4)            4           scalar   COM                                                
 KYBC1                      Dummy  24692    I(4)            4           scalar   ARG,INOUT        24777                             
 KYBC1Z                     Local  24777    I(4)            4           scalar                    24777,24800                       
 KYBC2                      Dummy  24692    I(4)            4           scalar   ARG,INOUT        24778                             
 KYBC2Z                     Local  24778    I(4)            4           scalar                    24778,24800                       
 LD                         Local  24812    I(4)            4           scalar                    24812,24813,24814,24815,24816,2482
                                                                                                  5,24826                           
 LDSORT                     Local  24723    I(4)            4     1     8000                      24823,24826                       
 LDX                        Scalar 24715    I(4)            4           scalar   COM              24811,24812,24823,24825,24833     
 LDXDIM                     Param  24710    I(4)            4           scalar                    24713,24715,24716,24723,24724     
 LDXX                       Dummy  24693    I(4)            4           scalar   ARG,INOUT        24723,24811                       
 LXSORT                     Scalar 24716    I(4)            4     1     8000     COM              24826                             
 NDIM                       Param  24708    I(4)            4           scalar                    24713,24714                       
 NODINT                     Local  24771    I(4)            4           scalar                    24771,24802                       
 NX                         Dummy  24692    I(4)            4           scalar   ARG,INOUT        24724,24770,24771,24773,24848     
 OUTPUTT                    Subr   24846                                                          24846                             

Page 716         Source Listing                  XSPLCM
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PR1FKM                     Subr   24844                                                          24844                             
 PRTITL                     Subr   24750                                                          24750                             
 RDTITL                     Subr   24748                                                          24748                             
 RLAT0                      Dummy  24693    R(4)            4           scalar   ARG,INOUT        24761                             
 RLON0                      Dummy  24694    R(4)            4           scalar   ARG,INOUT        24761                             
 S1DTPT                     Common 24715                                96084                                                       
 S1KOMP                     Common 24717                                224                                                         
 SL1MBO                     Subr   24843                                                          24843                             
 SL1OVR                     Subr   24802                                                          24802                             
 SL1RGO                     Subr   24839                                                          24839                             
 SORTRL                     Subr   24823                                                          24823                             
 ST1KPX                     Subr   24842                                                          24842                             
 STMNMZ                     Dummy  24694    CHAR                        scalar   ARG,INOUT        24761                             
 STSBC1                     Subr   24800                                                          24800                             
 STSDC1                     Subr   24801                                                          24801                             
 STSID1                     Subr   24799                                                          24799                             
 STSND1                     Subr   24773                                                          24773                             
 WD                         Scalar 24715    R(4)            4     1     8000     COM              24805,24813                       
 WDZ                        Dummy  24693    R(4)            4     1     0        ARG,INOUT        24813                             
 XSPLCM                     Subr   24692                                                                                            
 YBCL1Z                     Local  24779    R(4)            4           scalar                    24779,24796,24800                 
 YBCL2Z                     Local  24780    R(4)            4           scalar                    24780,24797,24800                 
 YBCWL1                     Dummy  24692    R(4)            4           scalar   ARG,INOUT        24779                             
 YBCWL2                     Dummy  24692    R(4)            4           scalar   ARG,INOUT        24780                             
 YD                         Scalar 24715    R(4)            4     1     8000     COM              24806,24814                       
 YDCWL                      Dummy  24692    R(4)            4           scalar   ARG,INOUT        24781                             
 YDCWLZ                     Local  24781    R(4)            4           scalar                    24781,24795,24801                 
 YDZ                        Dummy  24693    R(4)            4     1     0        ARG,INOUT        24814,24815                       
 YDZZ                       Local  24724    R(4)            4     1     8000                      24815,24823                       
 YN1                        Local  24768    R(4)            4           scalar                    24768,24770,24773                 
 YNB                        Dummy  24692    R(4)            4           scalar   ARG,INOUT        24768                             
 YNOD                       Dummy  24693    R(4)            4     1     0        ARG,INOUT        24802                             
 YNT                        Dummy  24692    R(4)            4           scalar   ARG,INOUT        24769                             
 YNXX                       Local  24769    R(4)            4           scalar                    24769,24770,24773                 

Page 717         Source Listing                  XSPLCM
2017-04-18 11:09                                 syndata.f

  24856 
  24857 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  24858 C                .      .    .                                       .
  24859 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  24860 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  24861 C
  24862 C ABSTRACT: ??????????????????????????????????????????????????????????
  24863 C   ??????????????????????????????????????????????????????????????????
  24864 C
  24865 C PROGRAM HISTORY LOG:
  24866 C ????-??-??  S. J. LORD
  24867 C
  24868 C USAGE:    CALL ????????(????)
  24869 C   INPUT ARGUMENT LIST:
  24870 C     ??????   - ???????????????????????????????????????????????
  24871 C
  24872 C   OUTPUT ARGUMENT LIST:
  24873 C     ??????   - ???????????????????????????????????????????????
  24874 C
  24875 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  24876 C     ??????   - ???????????????????????????????????????????????
  24877 C
  24878 C   OUTPUT FILES:
  24879 C     ??????   - ???????????????????????????????????????????????
  24880 C
  24881 C REMARKS: ?????????????????????????????????????????????????????
  24882 C
  24883 C ATTRIBUTES:
  24884 C   LANGUAGE: FORTRAN 90
  24885 C   MACHINE:  NCEP WCOSS
  24886 C
  24887 C$$$
  24888       SUBROUTINE OUTPUTT(FD,A,FKMN,KDATS,KDATF,IUNIT,IPLVL,IOK)
  24889 C
  24890       PARAMETER (NDIM=71)
  24891 ccccc PARAMETER (LDXDIM=2500)
  24892       PARAMETER (LDXDIM=8000)
  24893       PARAMETER (KDTDIM=5)
  24894       PARAMETER (NLXDIM=NDIM+LDXDIM)
  24895 C
  24896       COMMON/S1DTPT/IDSPD1,IDSPD2,LDX,YD(LDXDIM),WD(LDXDIM),
  24897      1               LXSORT(LDXDIM)
  24898       COMMON /S1KOMP/ IDSPK(KDTDIM),IDVAR(KDTDIM),KPX
  24899       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  24900 C
  24901       DIMENSION FD(KDTDIM,LDXDIM),A(KDTDIM,NDIM),FKMN(KDTDIM,NDIM),
  24902      1          ORD(NLXDIM),UVDATA(NLXDIM,3,2),ADATA(3,NLXDIM),
  24903      2          ABSMX(KDTDIM),HEADR(KDTDIM)
  24904 C
  24905       CHARACTER IDSPD1*8,IDSPD2*72,IDSPK*40,HEADR*14,IOK*1
  24906       LOGICAL PDATA,GSET
  24907 C
  24908       DATA ABSMX/1020.,80.,80.,2*1.E-2/,
  24909      1                                     HEADR/'SURFACE PRESS.',
  24910      2                                           'TANGENTIAL WND',
  24911      3                                           'RADIAL WIND   ',
  24912      4                                           'VORTICITY     ',

Page 718         Source Listing                  OUTPUTT
2017-04-18 11:09                                 syndata.f

  24913      4                                           'DIVERGENCE    '/
  24914 C    3                                           'TOTAL WIND SPD',
  24915 C    4                                           'GEOPOT. HEIGHT'/
  24916 C      DATA ABSMX/360.,25./,HEADR/'WIND DIRECTION',
  24917 C     1                                        'WIND SPEED    '/
  24918 C
  24919     1 DO 300 KD=KDATS,KDATF
  24920       IF(IOK .EQ. 'Y')  CALL PR1VRC
  24921       WRITE(IUNIT,3)  KD,IDSPK(KD)
  24922     3 FORMAT(/4X,'KD=',I4,2X,A40,/,5X,'D/N',2X,
  24923      1       'DIST',7X,'SPLINE',7X,'DATA',7X,'TYPE',7X,'DEVIATION')
  24924 C
  24925       ID=1
  24926       LN=1
  24927       LG=1
  24928       NG=3
  24929       PDATA=.TRUE.
  24930 C
  24931     5 LD=LXSORT(ID)
  24932       IF(ABS(YN(LN)-YD(LD)) .LT. 0.1)  GO TO 10
  24933       IF(YN(LN) .LT. YD(LD) .OR. .NOT. PDATA)  GO TO 20
  24934 C
  24935 C     PRINT DATA POINT ONLY
  24936 C
  24937       CALL SP1TNO(YD(LD),A,KD,SPLZ)
  24938       WRITE(IUNIT,6)  YD(LD),SPLZ,FD(KD,LD),WD(LD),FD(KD,LD)-SPLZ
  24939     6 FORMAT(5X,'D ',F6.1,2F12.3,F10.2,F12.3)
  24940 C
  24941 C     STORE FOR GRAPHING
  24942 C
  24943       ORD(LG)=YD(LD)
  24944       UVDATA(LG,1,KD)=SPLZ
  24945       UVDATA(LG,2,KD)=FD(KD,LD)
  24946       UVDATA(LG,3,KD)=FD(KD,LD)-SPLZ
  24947       LG=LG+1
  24948 C
  24949       ID=ID+1
  24950       GO TO 200
  24951 C
  24952 C     PRINT DATA POINT AND NODAL VALUE
  24953 C
  24954    10 WRITE(IUNIT,11)  YN(LN),FKMN(KD,LN),FD(KD,LD),WD(LD),
  24955      1             FD(KD,LD)-FKMN(KD,LN)
  24956    11 FORMAT(5X,'* ',F6.1,2F12.3,F10.2,F12.3)
  24957 C
  24958 C     STORE FOR GRAPHING
  24959 C
  24960       ORD(LG)=YN(LN)
  24961       UVDATA(LG,1,KD)=FKMN(KD,LN)
  24962       UVDATA(LG,2,KD)=FD(KD,LD)
  24963       UVDATA(LG,3,KD)=FD(KD,LD)-FKMN(KD,LN)
  24964       LG=LG+1
  24965 C
  24966       ID=ID+1
  24967       LN=LN+1
  24968       GO TO 200
  24969 C

Page 719         Source Listing                  OUTPUTT
2017-04-18 11:09                                 syndata.f

  24970 C     PRINT NODAL VALUE ONLY
  24971 C
  24972    20 WRITE(IUNIT,21)  YN(LN),FKMN(KD,LN)
  24973    21 FORMAT(5X,'N ',F6.1,F12.3)
  24974 C
  24975 C     STORE FOR GRAPHING
  24976 C
  24977       ORD(LG)=YN(LN)
  24978       UVDATA(LG,1,KD)=FKMN(KD,LN)
  24979       UVDATA(LG,2,KD)=0.0
  24980       UVDATA(LG,3,KD)=0.0
  24981       LG=LG+1
  24982 C
  24983       LN=LN+1
  24984 C
  24985   200 IF(LN .GT. NXX)  GO TO 300
  24986       IF(ID .LE. LDX .AND. PDATA)  GO TO 5
  24987       PDATA=.FALSE.
  24988       ID=LDX
  24989       GO TO 5
  24990 C
  24991   300 CONTINUE
  24992 C
  24993 C     OPTION FOR INTERACTIVE USAGE IF IUNIT .NE. 6
  24994 C
  24995       IF(IUNIT .EQ. 6)  GO TO 350
  24996 C
  24997       WRITE(6,310)
  24998   310 FORMAT(' PROFILE OK? (Y/N)')
  24999       READ(IUNIT,311) IOK
  25000   311 FORMAT(A1)
  25001 C
  25002       IF(IOK .EQ. 'Y') GO TO 330
  25003       RETURN
  25004 C
  25005   330 IUNIT=6
  25006       GO TO 1
  25007 C
  25008 C     OUTPUT COSMETICS
  25009 C
  25010   350 IF(KDATF .LT. KPX)  RETURN
  25011       print *, ' '
  25012       print *, ' '
  25013 C
  25014       LG=LG-1
  25015 C
  25016       DO 500 K=1,KDATF
  25017 C
  25018       XMIN=1.E10
  25019       DO L=1,LG
  25020       DO N=1,NG
  25021       IF(N .LE. 2 .AND. UVDATA(L,N,K) .NE. 0.0 )
  25022      1                   XMIN=MIN(UVDATA(L,N,K),XMIN)
  25023       ADATA(N,L)=UVDATA(L,N,K)
  25024       ENDDO
  25025       ENDDO
  25026 C

Page 720         Source Listing                  OUTPUTT
2017-04-18 11:09                                 syndata.f

  25027 C     XMIN=10.*(NINT(XMIN*0.1))-10.
  25028 C
  25029 C     SKIP GRAPHS IS PRINT LEVEL (IPLVL) IS LESS THAN 2.
  25030 C
  25031       IF(IPLVL .NE. 2)  GO TO 500
  25032       WRITE(6,451) HEADR(IDVAR(K))
  25033   451 FORMAT(///30X,A14)
  25034       GSET=.FALSE.
  25035       MAXAB=100
  25036       CALL DSGRPH(NG,ORD,ADATA,ABSMX(IDVAR(K)),XMIN,MAXAB,LG,GSET,0)
  25037   500 CONTINUE
  25038 C
  25039       RETURN
  25040       END


ENTRY POINTS

  Name                
                      
 outputt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  24919                                                          25006                             
 10                         Label  24954                                                          24932                             
 11                         Label  24956                                                          24954                             
 20                         Label  24972                                                          24933                             
 200                        Label  24985                                                          24950,24968                       
 21                         Label  24973                                                          24972                             
 3                          Label  24922                                                          24921                             
 300                        Label  24991                                                          24919,24985                       
 310                        Label  24998                                                          24997                             
 311                        Label  25000                                                          24999                             
 330                        Label  25005                                                          25002                             
 350                        Label  25010                                                          24995                             
 451                        Label  25033                                                          25032                             
 5                          Label  24931                                                          24986,24989                       
 500                        Label  25037                                                          25016,25031                       
 6                          Label  24939                                                          24938                             
 A                          Dummy  24888    R(4)            4     2     355      ARG,INOUT        24937                             
 ABS                        Func   24932                                scalar                    24932                             
 ABSMX                      Local  24903    R(4)            4     1     5                         24908,25036                       
 ADATA                      Local  24902    R(4)            4     2     24213                     25023,25036                       
 DSGRPH                     Subr   25036                                                          25036                             
 DYN                        Scalar 24899    R(4)            4           scalar   COM                                                
 FD                         Dummy  24888    R(4)            4     2     40000    ARG,INOUT        24938,24945,24946,24954,24955,2496
                                                                                                  2,24963                           
 FKMN                       Dummy  24888    R(4)            4     2     355      ARG,INOUT        24954,24955,24961,24963,24972,2497
                                                                                                  8                                 
 GSET                       Local  24906    L(4)            4           scalar                    25034,25036                       
 HEADR                      Local  24903    CHAR            14    1     5                         24909,25032                       
 ID                         Local  24925    I(4)            4           scalar                    24925,24931,24949,24966,24986,2498
                                                                                                  8                                 

Page 721         Source Listing                  OUTPUTT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDSPD1                     Scalar 24896    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 24896    CHAR            72          scalar   COM                                                
 IDSPK                      Scalar 24898    CHAR            40    1     5        COM              24921                             
 IDVAR                      Scalar 24898    I(4)            4     1     5        COM              25032,25036                       
 IOK                        Dummy  24888    CHAR            1           scalar   ARG,INOUT        24920,24999,25002                 
 IPLVL                      Dummy  24888    I(4)            4           scalar   ARG,INOUT        25031                             
 IUNIT                      Dummy  24888    I(4)            4           scalar   ARG,INOUT        24921,24938,24954,24972,24995,2499
                                                                                                  9,25005                           
 K                          Local  25016    I(4)            4           scalar                    25016,25021,25022,25023,25032,2503
                                                                                                  6                                 
 KD                         Local  24919    I(4)            4           scalar                    24919,24921,24937,24938,24944,2494
                                                                                                  5,24946,24954,24955,24961,24962,24
                                                                                                  963,24972,24978,24979,24980       
 KDATF                      Dummy  24888    I(4)            4           scalar   ARG,INOUT        24919,25010,25016                 
 KDATS                      Dummy  24888    I(4)            4           scalar   ARG,INOUT        24919                             
 KDTDIM                     Param  24893    I(4)            4           scalar                    24898,24901,24903                 
 KPX                        Scalar 24898    I(4)            4           scalar   COM              25010                             
 L                          Local  25019    I(4)            4           scalar                    25019,25021,25022,25023           
 LD                         Local  24931    I(4)            4           scalar                    24931,24932,24933,24937,24938,2494
                                                                                                  3,24945,24946,24954,24955,24962,24
                                                                                                  963                               
 LDX                        Scalar 24896    I(4)            4           scalar   COM              24986,24988                       
 LDXDIM                     Param  24892    I(4)            4           scalar                    24894,24896,24897,24901           
 LG                         Local  24927    I(4)            4           scalar                    24927,24943,24944,24945,24946,2494
                                                                                                  7,24960,24961,24962,24963,24964,24
                                                                                                  977,24978,24979,24980,24981,25014,
                                                                                                  25019,25036                       
 LN                         Local  24926    I(4)            4           scalar                    24926,24932,24933,24954,24955,2496
                                                                                                  0,24961,24963,24967,24972,24977,24
                                                                                                  978,24983,24985                   
 LXSORT                     Scalar 24897    I(4)            4     1     8000     COM              24931                             
 MAXAB                      Local  25035    I(4)            4           scalar                    25035,25036                       
 MIN                        Func   25022                                scalar                    25022                             
 N                          Local  25020    I(4)            4           scalar                    25020,25021,25022,25023           
 NDIM                       Param  24890    I(4)            4           scalar                    24894,24899,24901                 
 NG                         Local  24928    I(4)            4           scalar                    24928,25020,25036                 
 NLXDIM                     Param  24894    I(4)            4           scalar                    24902                             
 NXX                        Scalar 24899    I(4)            4           scalar   COM              24985                             
 ORD                        Local  24902    R(4)            4     1     8071                      24943,24960,24977,25036           
 OUTPUTT                    Subr   24888                                                                                            
 PDATA                      Local  24906    L(4)            4           scalar                    24929,24933,24986,24987           
 PR1VRC                     Subr   24920                                                          24920                             
 S1DTPT                     Common 24896                                96084                                                       
 S1KOMP                     Common 24898                                224                                                         
 S1NODE                     Common 24899                                292                                                         
 SP1TNO                     Subr   24937                                                          24937                             
 SPLZ                       Local  24937    R(4)            4           scalar                    24937,24938,24944,24946           
 UVDATA                     Local  24902    R(4)            4     3     48426                     24944,24945,24946,24961,24962,2496
                                                                                                  3,24978,24979,24980,25021,25022,25
                                                                                                  023                               
 WD                         Scalar 24896    R(4)            4     1     8000     COM              24938,24954                       
 XMIN                       Local  25018    R(4)            4           scalar                    25018,25022,25036                 
 YD                         Scalar 24896    R(4)            4     1     8000     COM              24932,24933,24937,24938,24943     
 YN                         Scalar 24899    R(4)            4     1     71       COM              24932,24933,24954,24960,24972,2497
                                                                                                  7                                 

Page 722         Source Listing                  OUTPUTT
2017-04-18 11:09                                 syndata.f

  25041 
  25042 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25043 C                .      .    .                                       .
  25044 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25045 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25046 C
  25047 C ABSTRACT: ??????????????????????????????????????????????????????????
  25048 C   ??????????????????????????????????????????????????????????????????
  25049 C
  25050 C PROGRAM HISTORY LOG:
  25051 C ????-??-??  S. J. LORD
  25052 C
  25053 C USAGE:    CALL ????????(????)
  25054 C   INPUT ARGUMENT LIST:
  25055 C     ??????   - ???????????????????????????????????????????????
  25056 C
  25057 C   OUTPUT ARGUMENT LIST:
  25058 C     ??????   - ???????????????????????????????????????????????
  25059 C
  25060 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25061 C     ??????   - ???????????????????????????????????????????????
  25062 C
  25063 C   OUTPUT FILES:
  25064 C     ??????   - ???????????????????????????????????????????????
  25065 C
  25066 C REMARKS: ?????????????????????????????????????????????????????
  25067 C
  25068 C ATTRIBUTES:
  25069 C   LANGUAGE: FORTRAN 90
  25070 C   MACHINE:  NCEP WCOSS
  25071 C
  25072 C$$$
  25073       SUBROUTINE DSGRPH(NGRAPH,ORDNAT,ADATA,ABSMAX,ABSMIN,DIMABS,DIMORD,
  25074      1                  GSET,ISPC)
  25075       CHARACTER*1  IBEGIN,IEND,LINE(101),NDATA(11)
  25076       COMMON/CPRINT/IBEGIN,IEND
  25077       INTEGER DIMORD,DIMABS
  25078       DIMENSION ADATA(NGRAPH,DIMORD),ABSISA(11),ORDNAT(DIMORD)
  25079       LOGICAL GSET
  25080       DATA NDATA/' ','1','2','3','4','5','6','7','8','9','.'/
  25081 C
  25082 C
  25083 C     NGRAPH = NUMBER OF 1-DIMENSIONAL ARRAYS TO BE PLOTTED
  25084 C     ORDNAT = DATA PLOTTED ON ORDINATE
  25085 C     ADATA  = 2-DIMENSIONAL DATA ARRAY CONTAINING ALL PLOTTED ARRAYS
  25086 C     ABSMAX = MAXIMUM VALUE ON ABSCISSA
  25087 C     ABSMIN = MINIMUM VALUE ON ABSCISSA
  25088 C     DIMABS = WIDTH OF ABSCISSA
  25089 C     DIMORD = NUMBER OF ORDINATE VALUES TO BE PLOTTED
  25090 C     GSET   = FALSE IF GRAPH ROUTINE IS TO FIND THE MAXIMUM AND
  25091 C              MINIMUM ABSCISSAE
  25092 C
  25093 C
  25094       ABSMX=ABSMAX
  25095       ABSMN=ABSMIN
  25096       IBEGIN = '.'
  25097       IEND = '.'

Page 723         Source Listing                  DSGRPH
2017-04-18 11:09                                 syndata.f

  25098 C
  25099 C     OPTIONALLY FIND MAXIMUM AND MINIMUM ABSCISSAE
  25100 C
  25101       IF(GSET) GO TO 5
  25102       ABSMX = -1.0
  25103       ABSMN = 1.E15
  25104       DO J=1,DIMORD
  25105       DO I=1,NGRAPH
  25106          IF(ADATA(I,J) .GT. ABSMX) ABSMX = ADATA(I,J)
  25107          IF(ADATA(I,J) .LE. ABSMN) ABSMN = ADATA(I,J)
  25108       ENDDO
  25109       ENDDO
  25110     5 TEM = ABSMX-ABSMN
  25111       DELABS = TEM/(DIMABS-1)
  25112       DPRNT = TEM/10.
  25113       ABSISA(1) = ABSMN
  25114       DO I=2,11
  25115          ABSISA(I) = ABSISA(I-1)+DPRNT
  25116       ENDDO
  25117 C
  25118 C     FIND ZERO IF ANY
  25119 C
  25120       NZERO = MAX(1.0,-ABSMN/DELABS+1.0)
  25121 C
  25122 C     PRINT GRAPH
  25123 C
  25124       WRITE(6,5555)
  25125  5555 FORMAT(//,3X,'PR',4X,'SPL',4X,'DATA',2X,'DEV')
  25126       WRITE(6,55) (ABSISA(J),J=1,11)
  25127    55 FORMAT(23X,11F10.2)
  25128       DO J=1,DIMABS
  25129       LINE(J) = '.'
  25130       IF(MOD(J-NZERO,5) .EQ. 0) LINE(J) = '^'
  25131       ENDDO
  25132       LINE(NZERO) = '^'
  25133       CALL PRNT(DIMABS,LINE)
  25134       LINE(1:DIMABS) = ' '
  25135       LINE(NZERO) = '^'
  25136 C
  25137       DO 1000 K=1,DIMORD
  25138 C
  25139       GO TO (100,200,300),NGRAPH
  25140 C
  25141   100 CONTINUE
  25142       NABS1 = MIN(INT(MAX(1.0,(ADATA(1,K)-ABSMN)/DELABS+1.0)),DIMABS)
  25143       LINE(NABS1) = NDATA(NGRAPH+1)
  25144       WRITE(6,101) ORDNAT(K),ADATA(1,K),IBEGIN,(LINE(J),J=1,DIMABS),IEND
  25145   101 FORMAT(F6.1,1X,F7.2,14X,102A1)
  25146       LINE(NABS1) = ' '
  25147       LINE(NZERO) = '^'
  25148       GO TO 400
  25149   200 CONTINUE
  25150       NABS1 = MIN(INT(MAX(1.0,(ADATA(1,K)-ABSMN)/DELABS+1.0)),DIMABS)
  25151       LINE(NABS1) = '1'
  25152       NABS2 = MIN(INT(MAX(1.0,(ADATA(2,K)-ABSMN)/DELABS+1.0)),DIMABS)
  25153       LINE(NABS2) = '2'
  25154       IF(NABS1 .EQ. NABS2) LINE(NABS2) = '+'

Page 724         Source Listing                  DSGRPH
2017-04-18 11:09                                 syndata.f

  25155       WRITE(6,201) ORDNAT(K),(ADATA(N,K),N=1,NGRAPH),IBEGIN
  25156      1,(LINE(J),J=1,DIMABS),IEND
  25157   201 FORMAT(F6.1,1X,2(F7.2,1X),5X,102A1)
  25158       LINE(NABS1) = ' '
  25159       LINE(NABS2) = ' '
  25160       LINE(NZERO) = '^'
  25161       GO TO 400
  25162   300 CONTINUE
  25163       NABS1 = MIN(INT(MAX(1.0,(ADATA(1,K)-ABSMN)/DELABS+1.0)),DIMABS)
  25164       LINE(NABS1) = '1'
  25165       NABS2 = MIN(INT(MAX(1.0,(ADATA(2,K)-ABSMN)/DELABS+1.0)),DIMABS)
  25166       LINE(NABS2) = '2'
  25167       NABS3 = MIN(INT(MAX(1.0,(ADATA(3,K)-ABSMN)/DELABS+1.0)),DIMABS)
  25168       LINE(NABS3) = '3'
  25169       IF(NABS1 .EQ. NABS2 .OR. NABS2 .EQ. NABS3) LINE(NABS2) = '+'
  25170       IF(NABS1 .EQ. NABS3) LINE(NABS1) = '+'
  25171       IF(NABS1 .EQ. NABS2 .AND. NABS2 .EQ. NABS3) LINE(NABS1) = 'X'
  25172       WRITE(6,301) ORDNAT(K),(ADATA(N,K),N=1,NGRAPH),IBEGIN
  25173      1,(LINE(J),J=1,DIMABS),IEND
  25174   301 FORMAT(F6.1,1X,2(F7.2,1X),F5.1,102A1)
  25175       LINE(NABS1) = ' '
  25176       LINE(NABS2) = ' '
  25177       LINE(NABS3) = ' '
  25178       LINE(NZERO) = '^'
  25179   400 CONTINUE
  25180       IF(ISPC .LE. 1 .OR. K .EQ. DIMORD) GO TO 1000
  25181       DO I=1,ISPC
  25182          CALL PRNT(DIMABS,LINE)
  25183       ENDDO
  25184  1000 CONTINUE
  25185       DO J=1,DIMABS
  25186          LINE(J) = '.'
  25187          IF(MOD(J-NZERO,5) .EQ. 0) LINE(J) = '^'
  25188       ENDDO
  25189       LINE(NZERO) = '^'
  25190       CALL PRNT(DIMABS,LINE)
  25191 C
  25192       WRITE(6,55) (ABSISA(J),J=1,11)
  25193 C
  25194       RETURN
  25195       END

Page 725         Source Listing                  DSGRPH
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 dsgrph_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  25141                                                          25139                             
 1000                       Label  25184                                                          25137,25180                       
 101                        Label  25145                                                          25144                             
 200                        Label  25149                                                          25139                             
 201                        Label  25157                                                          25155                             
 300                        Label  25162                                                          25139                             
 301                        Label  25174                                                          25172                             
 400                        Label  25179                                                          25148,25161                       
 5                          Label  25110                                                          25101                             
 55                         Label  25127                                                          25126,25192                       
 5555                       Label  25125                                                          25124                             
 ABSISA                     Local  25078    R(4)            4     1     11                        25113,25115,25126,25192           
 ABSMAX                     Dummy  25073    R(4)            4           scalar   ARG,INOUT        25094                             
 ABSMIN                     Dummy  25073    R(4)            4           scalar   ARG,INOUT        25095                             
 ABSMN                      Local  25095    R(4)            4           scalar                    25095,25103,25107,25110,25113,2512
                                                                                                  0,25142,25150,25152,25163,25165,25
                                                                                                  167                               
 ABSMX                      Local  25094    R(4)            4           scalar                    25094,25102,25106,25110           
 ADATA                      Dummy  25073    R(4)            4     2     0        ARG,INOUT        25106,25107,25142,25144,25150,2515
                                                                                                  2,25155,25163,25165,25167,25172   
 CPRINT                     Common 25076                                2                                                           
 DELABS                     Local  25111    R(4)            4           scalar                    25111,25120,25142,25150,25152,2516
                                                                                                  3,25165,25167                     
 DIMABS                     Dummy  25073    I(4)            4           scalar   ARG,INOUT        25111,25128,25133,25134,25142,2514
                                                                                                  4,25150,25152,25156,25163,25165,25
                                                                                                  167,25173,25182,25185,25190       
 DIMORD                     Dummy  25073    I(4)            4           scalar   ARG,INOUT        25078,25104,25137,25180           
 DPRNT                      Local  25112    R(4)            4           scalar                    25112,25115                       
 DSGRPH                     Subr   25073                                                                                            
 GSET                       Dummy  25074    L(4)            4           scalar   ARG,INOUT        25101                             
 I                          Local  25105    I(4)            4           scalar                    25105,25106,25107,25114,25115,2518
                                                                                                  1                                 
 IBEGIN                     Scalar 25075    CHAR            1           scalar   COM              25096,25144,25155,25172           
 IEND                       Scalar 25075    CHAR            1           scalar   COM              25097,25144,25156,25173           
 INT                        Func   25142                                scalar                    25142,25150,25152,25163,25165,2516
                                                                                                  7                                 
 ISPC                       Dummy  25074    I(4)            4           scalar   ARG,INOUT        25180,25181                       
 J                          Local  25104    I(4)            4           scalar                    25104,25106,25107,25126,25128,2512
                                                                                                  9,25130,25144,25156,25173,25185,25
                                                                                                  186,25187,25192                   
 K                          Local  25137    I(4)            4           scalar                    25137,25142,25144,25150,25152,2515
                                                                                                  5,25163,25165,25167,25172,25180   
 LINE                       Local  25075    CHAR            1     1     101                       25129,25130,25132,25133,25134,2513
                                                                                                  5,25143,25144,25146,25147,25151,25

Page 726         Source Listing                  DSGRPH
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  153,25154,25156,25158,25159,25160,
                                                                                                  25164,25166,25168,25169,25170,2517
                                                                                                  1,25173,25175,25176,25177,25178,25
                                                                                                  182,25186,25187,25189,25190       
 MAX                        Func   25120                                scalar                    25120,25142,25150,25152,25163,2516
                                                                                                  5,25167                           
 MIN                        Func   25142                                scalar                    25142,25150,25152,25163,25165,2516
                                                                                                  7                                 
 MOD                        Func   25130                                scalar                    25130,25187                       
 N                          Local  25155    I(4)            4           scalar                    25155,25172                       
 NABS1                      Local  25142    I(4)            4           scalar                    25142,25143,25146,25150,25151,2515
                                                                                                  4,25158,25163,25164,25169,25170,25
                                                                                                  171,25175                         
 NABS2                      Local  25152    I(4)            4           scalar                    25152,25153,25154,25159,25165,2516
                                                                                                  6,25169,25171,25176               
 NABS3                      Local  25167    I(4)            4           scalar                    25167,25168,25169,25170,25171,2517
                                                                                                  7                                 
 NDATA                      Local  25075    CHAR            1     1     11                        25080,25143                       
 NGRAPH                     Dummy  25073    I(4)            4           scalar   ARG,INOUT        25078,25105,25139,25143,25155,2517
                                                                                                  2                                 
 NZERO                      Local  25120    I(4)            4           scalar                    25120,25130,25132,25135,25147,2516
                                                                                                  0,25178,25187,25189               
 ORDNAT                     Dummy  25073    R(4)            4     1     0        ARG,INOUT        25144,25155,25172                 
 PRNT                       Subr   25133                                                          25133,25182,25190                 
 TEM                        Local  25110    R(4)            4           scalar                    25110,25111,25112                 

Page 727         Source Listing                  DSGRPH
2017-04-18 11:09                                 syndata.f

  25196 
  25197 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25198 C                .      .    .                                       .
  25199 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25200 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25201 C
  25202 C ABSTRACT: ??????????????????????????????????????????????????????????
  25203 C   ??????????????????????????????????????????????????????????????????
  25204 C
  25205 C PROGRAM HISTORY LOG:
  25206 C ????-??-??  S. J. LORD
  25207 C
  25208 C USAGE:    CALL ????????(????)
  25209 C   INPUT ARGUMENT LIST:
  25210 C     ??????   - ???????????????????????????????????????????????
  25211 C
  25212 C   OUTPUT ARGUMENT LIST:
  25213 C     ??????   - ???????????????????????????????????????????????
  25214 C
  25215 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25216 C     ??????   - ???????????????????????????????????????????????
  25217 C
  25218 C   OUTPUT FILES:
  25219 C     ??????   - ???????????????????????????????????????????????
  25220 C
  25221 C REMARKS: ?????????????????????????????????????????????????????
  25222 C
  25223 C ATTRIBUTES:
  25224 C   LANGUAGE: FORTRAN 90
  25225 C   MACHINE:  NCEP WCOSS
  25226 C
  25227 C$$$
  25228       SUBROUTINE PRNT(NDIM,L)
  25229       CHARACTER*1  IBEGIN,IEND,L(NDIM)
  25230       COMMON/CPRINT/IBEGIN,IEND
  25231       WRITE(6,10) IBEGIN,L,IEND
  25232    10 FORMAT(28X,102A1)
  25233 C
  25234       RETURN
  25235       END

Page 728         Source Listing                  PRNT
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name             
                   
 prnt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  25232                                                          25231                             
 CPRINT                     Common 25230                                2                                                           
 IBEGIN                     Scalar 25229    CHAR            1           scalar   COM              25231                             
 IEND                       Scalar 25229    CHAR            1           scalar   COM              25231                             
 L                          Dummy  25228    CHAR            1     1     0        ARG,INOUT        25231                             
 NDIM                       Dummy  25228    I(4)            4           scalar   ARG,INOUT        25229                             
 PRNT                       Subr   25228                                                                                            

Page 729         Source Listing                  PRNT
2017-04-18 11:09                                 syndata.f

  25236 
  25237 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25238 C                .      .    .                                       .
  25239 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25240 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25241 C
  25242 C ABSTRACT: ??????????????????????????????????????????????????????????
  25243 C   ??????????????????????????????????????????????????????????????????
  25244 C
  25245 C PROGRAM HISTORY LOG:
  25246 C ????-??-??  S. J. LORD
  25247 C
  25248 C USAGE:    CALL ????????(????)
  25249 C   INPUT ARGUMENT LIST:
  25250 C     ??????   - ???????????????????????????????????????????????
  25251 C
  25252 C   OUTPUT ARGUMENT LIST:
  25253 C     ??????   - ???????????????????????????????????????????????
  25254 C
  25255 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25256 C     ??????   - ???????????????????????????????????????????????
  25257 C
  25258 C   OUTPUT FILES:
  25259 C     ??????   - ???????????????????????????????????????????????
  25260 C
  25261 C REMARKS: ?????????????????????????????????????????????????????
  25262 C
  25263 C ATTRIBUTES:
  25264 C   LANGUAGE: FORTRAN 90
  25265 C   MACHINE:  NCEP WCOSS
  25266 C
  25267 C$$$
  25268 C
  25269 C
  25270       SUBROUTINE OVRSUB(IDSPCZ,NXZ,YN1Z,YNXXZ,KDCTYZ,YDCWLZ)
  25271 C
  25272 C     ++ ASSUMED DIM PARAMETERS ...NDIM=71,
  25273 C
  25274 C     ** COMPILATION PARAMETERS **
  25275 C
  25276       PARAMETER (NDIM=71)
  25277 C
  25278 C     NDIM     ARRAY DIMENSION FOR NODAL INDEX N IN THE Y DIRECTION
  25279 C
  25280 C     ** PRIMARY CONSTANTS FOR SPLINE ANALYSIS PACKAGE
  25281 C
  25282       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,
  25283      1        YBCWL(2),IDSPC
  25284 C
  25285 C     ** SECONDARY CONSTANTS FOR CONVENIENCE
  25286 C
  25287       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  25288 C
  25289 C     ** DUMMY ARGUMENT
  25290       CHARACTER*125 IDSPCZ,IDSPC
  25291 
  25292 C

Page 730         Source Listing                  OVRSUB
2017-04-18 11:09                                 syndata.f

  25293 C     ** OVERHEAD CHORES FOR TWO-D SPLINE ANALYSIS AND INVERSE TRANSFORM
  25294 C
  25295 C     INPUT    ALL THE PRIMARY CONSTANTS IN /S1PRIC/
  25296 C              IDSPC .. CODE AND EXPLANATION (80 CHARACTERS)
  25297 C
  25298 C     OUTPUT   ALL THE SECONDARY CONSTANTS IN /S1NODE/ AND /S1BCDC/
  25299 C
  25300 C     ENTRIES FOR DEFINING THE PRIMARY CONSTANTS
  25301 C              STSID1(IDSPCZ)
  25302 C              STSND1(NXZ,YN1Z,YNXXZ)
  25303 C              STSDC1(KDCTYZ,YDCWLZ)
  25304 C
  25305 C     ENTRIES FOR PRINT OUTPUT
  25306 C              PR1VRC ... TO PRINT /S1PRIC/
  25307 C
  25308 C
  25309 C
  25310 C
  25311 C-----------------------------------------------------------------------
  25312 
  25313 C
  25314 C
  25315       ENTRY STSID1(IDSPCZ)
  25316       IDSPC=IDSPCZ
  25317       RETURN
  25318 
  25319 C-----------------------------------------------------------------------
  25320 
  25321 C
  25322       ENTRY STSND1(NXZ,YN1Z,YNXXZ)
  25323       NX=NXZ
  25324       YN1 =YN1Z
  25325       YNXX=YNXXZ
  25326       RETURN
  25327 
  25328 C-----------------------------------------------------------------------
  25329 
  25330 C
  25331       ENTRY STSDC1(KDCTYZ,YDCWLZ)
  25332       KDCTYP=KDCTYZ
  25333       YDCWL=YDCWLZ
  25334       RETURN
  25335 
  25336 C-----------------------------------------------------------------------
  25337 
  25338 C
  25339 C
  25340       ENTRY PR1VRC
  25341 C
  25342 C  80 CONTINUE
  25343       WRITE(6,880) IDSPC,NX,KDCTYP,(KBCTYP(I),I=1,2),
  25344      1    YN1,YNXX,DYN,YDCWL/DYN,
  25345      2    (YBCWL(I)/DYN,I=1,2)
  25346 C
  25347   880 FORMAT('.../S1PRIC/...',/,9X,A125,/,'  NX=',
  25348      1       I3,', (DC)',I2,', (BC)',2I3,',   (Y LIMITS)',2F10.3,/,
  25349      2       9X,'DELTAY=',F7.3,' KM,  (DCWL (DELTAY UNITS))',F8.1,

Page 731         Source Listing                  OVRSUB
2017-04-18 11:09                                 syndata.f

  25350      3       ',  (BCWL (DELTAY UNITS))',2F8.1)
  25351       RETURN
  25352 
  25353       END


ENTRY POINTS

  Name                  Name                  Name                  Name                  Name               
                                                                                                             
 ovrsub_               pr1vrc_               stsdc1_               stsid1_               stsnd1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 880                        Label  25347                                                          25343                             
 DYN                        Scalar 25287    R(4)            4           scalar   COM              25344,25345                       
 I                          Local  25343    I(4)            4           scalar                    25343,25345                       
 IDSPC                      Scalar 25283    CHAR            125         scalar   COM              25316,25343                       
 IDSPCZ                     Dummy  25270    CHAR            125         scalar   ARG,INOUT        25316                             
 KBCTYP                     Scalar 25282    I(4)            4     1     2        COM              25343                             
 KDCTYP                     Scalar 25282    I(4)            4           scalar   COM              25332,25343                       
 KDCTYZ                     Dummy  25270    I(4)            4           scalar   ARG,INOUT        25332                             
 NDIM                       Param  25276    I(4)            4           scalar                    25287                             
 NX                         Scalar 25282    I(4)            4           scalar   COM              25323,25343                       
 NXX                        Scalar 25287    I(4)            4           scalar   COM                                                
 NXZ                        Dummy  25270    I(4)            4           scalar   ARG,INOUT        25323                             
 OVRSUB                     Subr   25270                                                                                            
 PR1VRC                     Subr   25340                                                                                            
 S1NODE                     Common 25287                                292                                                         
 S1PRIC                     Common 25282                                161                                                         
 STSDC1                     Subr   25331                                                                                            
 STSID1                     Subr   25315                                                                                            
 STSND1                     Subr   25322                                                                                            
 YBCWL                      Scalar 25283    R(4)            4     1     2        COM              25345                             
 YDCWL                      Scalar 25282    R(4)            4           scalar   COM              25333,25344                       
 YDCWLZ                     Dummy  25270    R(4)            4           scalar   ARG,INOUT        25333                             
 YN                         Scalar 25287    R(4)            4     1     71       COM                                                
 YN1                        Scalar 25282    R(4)            4           scalar   COM              25324,25344                       
 YN1Z                       Dummy  25270    R(4)            4           scalar   ARG,INOUT        25324                             
 YNXX                       Scalar 25282    R(4)            4           scalar   COM              25325,25344                       
 YNXXZ                      Dummy  25270    R(4)            4           scalar   ARG,INOUT        25325                             

Page 732         Source Listing                  OVRSUB
2017-04-18 11:09                                 syndata.f

  25354 
  25355 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25356 C                .      .    .                                       .
  25357 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25358 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25359 C
  25360 C ABSTRACT: ??????????????????????????????????????????????????????????
  25361 C   ??????????????????????????????????????????????????????????????????
  25362 C
  25363 C PROGRAM HISTORY LOG:
  25364 C ????-??-??  S. J. LORD
  25365 C
  25366 C USAGE:    CALL ????????(????)
  25367 C   INPUT ARGUMENT LIST:
  25368 C     ??????   - ???????????????????????????????????????????????
  25369 C
  25370 C   OUTPUT ARGUMENT LIST:
  25371 C     ??????   - ???????????????????????????????????????????????
  25372 C
  25373 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25374 C     ??????   - ???????????????????????????????????????????????
  25375 C
  25376 C   OUTPUT FILES:
  25377 C     ??????   - ???????????????????????????????????????????????
  25378 C
  25379 C REMARKS: ?????????????????????????????????????????????????????
  25380 C
  25381 C ATTRIBUTES:
  25382 C   LANGUAGE: FORTRAN 90
  25383 C   MACHINE:  NCEP WCOSS
  25384 C
  25385 C$$$
  25386       SUBROUTINE STSBC1(KBCTY1,KBCTY2,YBCWL1,YBCWL2)
  25387 
  25388       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,YBCWL(2),IDSPC
  25389 
  25390       INTEGER NX,KDCTYP,KBCTYP,IDSPC
  25391       REAL YN1,YNXX,YDCWL,YBCWL
  25392 
  25393       KBCTYP(1)=KBCTY1
  25394       KBCTYP(2)=KBCTY2
  25395       YBCWL(1)=YBCWL1
  25396       YBCWL(2)=YBCWL2
  25397 
  25398       RETURN
  25399 
  25400       END

Page 733         Source Listing                  STSBC1
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 stsbc1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDSPC                      Scalar 25388    I(4)            4           scalar   COM                                                
 KBCTY1                     Dummy  25386    I(4)            4           scalar   ARG,INOUT        25393                             
 KBCTY2                     Dummy  25386    I(4)            4           scalar   ARG,INOUT        25394                             
 KBCTYP                     Scalar 25388    I(4)            4     1     2        COM              25393,25394                       
 KDCTYP                     Scalar 25388    I(4)            4           scalar   COM                                                
 NX                         Scalar 25388    I(4)            4           scalar   COM                                                
 S1PRIC                     Common 25388                                40                                                          
 STSBC1                     Subr   25386                                                                                            
 YBCWL                      Scalar 25388    R(4)            4     1     2        COM              25395,25396                       
 YBCWL1                     Dummy  25386    R(4)            4           scalar   ARG,INOUT        25395                             
 YBCWL2                     Dummy  25386    R(4)            4           scalar   ARG,INOUT        25396                             
 YDCWL                      Scalar 25388    R(4)            4           scalar   COM                                                
 YN1                        Scalar 25388    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 25388    R(4)            4           scalar   COM                                                

Page 734         Source Listing                  STSBC1
2017-04-18 11:09                                 syndata.f

  25401 
  25402 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25403 C                .      .    .                                       .
  25404 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25405 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25406 C
  25407 C ABSTRACT: ??????????????????????????????????????????????????????????
  25408 C   ??????????????????????????????????????????????????????????????????
  25409 C
  25410 C PROGRAM HISTORY LOG:
  25411 C ????-??-??  S. J. LORD
  25412 C
  25413 C USAGE:    CALL ????????(????)
  25414 C   INPUT ARGUMENT LIST:
  25415 C     ??????   - ???????????????????????????????????????????????
  25416 C
  25417 C   OUTPUT ARGUMENT LIST:
  25418 C     ??????   - ???????????????????????????????????????????????
  25419 C
  25420 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25421 C     ??????   - ???????????????????????????????????????????????
  25422 C
  25423 C   OUTPUT FILES:
  25424 C     ??????   - ???????????????????????????????????????????????
  25425 C
  25426 C REMARKS: ?????????????????????????????????????????????????????
  25427 C
  25428 C ATTRIBUTES:
  25429 C   LANGUAGE: FORTRAN 90
  25430 C   MACHINE:  NCEP WCOSS
  25431 C
  25432 C$$$
  25433       SUBROUTINE SL1OVR(NYNOD,YNOD)
  25434 
  25435       IMPLICIT NONE
  25436 
  25437       INTEGER NDIM,NXX,NX,KDCTYP,KBCTYP
  25438 C
  25439 C     ** COMPILATION PARAMETERS **
  25440 C
  25441       PARAMETER (NDIM=71)
  25442 
  25443 C
  25444 C     NDIM     ARRAY DIMENSION FOR NODAL INDEX N IN THE Y DIRECTION
  25445 C
  25446 C     ** PRIMARY CONSTANTS FOR SPLINE ANALYSIS PACKAGE
  25447 C
  25448       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,YBCWL(2),IDSPC
  25449 
  25450 C
  25451 C     ** SECONDARY CONSTANTS FOR CONVENIENCE
  25452 C
  25453       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  25454       COMMON /S1BCDC/ DY0,DY1,DY2,CBCBF(4),YSDCPI
  25455 
  25456       REAL    YN1,YNXX,YDCWL,YBCWL,DYN,YN
  25457       REAL    DY0,DY1,DY2,CBCBF,YSDCPI

Page 735         Source Listing                  SL1OVR
2017-04-18 11:09                                 syndata.f

  25458 
  25459 C     ** DUMMY ARGUMENT
  25460       CHARACTER*125 IDSPCZ,IDSPC
  25461 C
  25462 C     ** LOCAL WORK SPACE
  25463       INTEGER NYNOD
  25464       REAL YSBCPI(2),YNOD(NYNOD+1)
  25465 C
  25466 C     ** NUMERICAL CONSTANTS
  25467       REAL PI2/6.283185307180/
  25468 
  25469       INTEGER N,K,KK
  25470       REAL(4) Z,ZC 
  25471 
  25472       NXX=NX+1
  25473       DYN=(YNXX-YN1)/REAL(NX)
  25474       YN(1)=YN1
  25475       YNOD(1)=YN1
  25476 
  25477 C     ** CHECK NDIM **
  25478 C
  25479       IF(NXX.GT.NDIM) GO TO 90
  25480 
  25481       DO N=2,NXX
  25482          YN(N)=YN1+(N-1)*DYN
  25483          YNOD(N)=YN(N)
  25484       ENDDO
  25485 C
  25486 C     CONSTANTS FOR BASIS FUNCTION CALCULATION
  25487 C
  25488       DY0=1./DYN
  25489       DY1=3.*DY0
  25490       DY2=6.*DY0**2
  25491 C
  25492 C
  25493 C     ** DC AND BC CONSTANTS ARE NONDIMENSIONALIZED
  25494 C
  25495 C     YDCWL AND YBCWL MUST BE GIVEN IN INTERNAL LENGTH UNITS ... METERS
  25496 C
  25497       Z=1./PI2
  25498       ZC=Z/DYN
  25499       YSDCPI   =ZC*YDCWL
  25500       YSBCPI(1)=ZC*YBCWL(1)
  25501       YSBCPI(2)=ZC*YBCWL(2)
  25502 C
  25503 C     ** BOUNDARY LINES ... K=1 AT YN1, =2 AT YNXX
  25504 C
  25505 C     ** BOUNDARY CONDITION TYPES (PERIODIC CONDITION IS NOT INCLUDED, 0
  25506 C
  25507 C     KBCTYP= 0 ... YSBF=0
  25508 C             1 ... DYSBF=0
  25509 C             2 ... DDYSBF=0
  25510 C            10 ... (-/+)YSBCPI*DYSBF+YSBF=0     (- AT YN1, + AT YNXX)
  25511 C            20 ... (YSBCPI**2)*DDYSBF+YSBF=0
  25512 C            21 ... (-/+)YSBCPI*DDYSBF+DYSBF=0
  25513 C
  25514 C     ** COEFFICIENTS DEFINING Y1BF AT THE BOUNDARY

Page 736         Source Listing                  SL1OVR
2017-04-18 11:09                                 syndata.f

  25515 C
  25516       DO 38 K=1,2
  25517       KK=K+K-1
  25518       IF(KBCTYP(K).EQ. 0) GO TO 31
  25519       IF(KBCTYP(K).EQ. 1) GO TO 32
  25520       IF(KBCTYP(K).EQ. 2) GO TO 33
  25521       IF(KBCTYP(K).EQ.10) GO TO 34
  25522       IF(KBCTYP(K).EQ.20) GO TO 35
  25523       IF(KBCTYP(K).EQ.21) GO TO 36
  25524       GO TO 91
  25525 
  25526 C     TYPE 0
  25527    31 CBCBF(KK)  =-1.
  25528       CBCBF(KK+1)=-0.25
  25529         GO TO 38
  25530 C     TYPE 1
  25531    32 CBCBF(KK)  = 0.
  25532       CBCBF(KK+1)= 0.25
  25533         GO TO 38
  25534 C     TYPE 2
  25535    33 CBCBF(KK)  = 0.5
  25536       CBCBF(KK+1)=-0.25
  25537         GO TO 38
  25538 C     TYPE 10
  25539    34 CBCBF(KK)  =-1./(3.*YSBCPI(K)+1.)
  25540       CBCBF(KK+1)= 0.25+0.5*CBCBF(KK)
  25541       GO TO 38
  25542 C     TYPE 20
  25543    35 Z=3.*YSBCPI(K)**2
  25544       CBCBF(KK)  = 0.5*(Z-1.)/(Z+0.5)
  25545       CBCBF(KK+1)=-0.25
  25546         GO TO 38
  25547 C     TYPE 21
  25548    36 CBCBF(KK)  = 0.5*YSBCPI(K)/(0.5+YSBCPI(K))
  25549       CBCBF(KK+1)= 0.25-CBCBF(KK)
  25550    38 CONTINUE
  25551 
  25552       RETURN
  25553 
  25554 C-----------------------------------------------------------------------
  25555 C
  25556 C     ** ERROR EXITS **
  25557    90 WRITE(6,890) NXX,NDIM
  25558   890 FORMAT(/' === SL1OVR FOUND NXX.GT. NDIM) ===',3X,2I6)
  25559       GO TO 99
  25560 C
  25561    91 WRITE(6,891) KBCTYP,YBCWL
  25562   891 FORMAT(/' === SL1OVR MET UNDEFINED KBCTYP ===',2I12,/,41X,2F12.3)
  25563    99 CALL ABRT1(' SL1OVR',891)
  25564 
  25565       END

Page 737         Source Listing                  SL1OVR
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sl1ovr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 31                         Label  25527                                                          25518                             
 32                         Label  25531                                                          25519                             
 33                         Label  25535                                                          25520                             
 34                         Label  25539                                                          25521                             
 35                         Label  25543                                                          25522                             
 36                         Label  25548                                                          25523                             
 38                         Label  25550                                                          25516,25529,25533,25537,25541,2554
                                                                                                  6                                 
 890                        Label  25558                                                          25557                             
 891                        Label  25562                                                          25561                             
 90                         Label  25557                                                          25479                             
 91                         Label  25561                                                          25524                             
 99                         Label  25563                                                          25559                             
 ABRT1                      Subr   25563                                                          25563                             
 CBCBF                      Scalar 25454    R(4)            4     1     4        COM              25527,25528,25531,25532,25535,2553
                                                                                                  6,25539,25540,25544,25545,25548,25
                                                                                                  549                               
 DY0                        Scalar 25454    R(4)            4           scalar   COM              25488,25489,25490                 
 DY1                        Scalar 25454    R(4)            4           scalar   COM              25489                             
 DY2                        Scalar 25454    R(4)            4           scalar   COM              25490                             
 DYN                        Scalar 25453    R(4)            4           scalar   COM              25473,25482,25488,25498           
 IDSPC                      Scalar 25448    CHAR            125         scalar   COM                                                
 IDSPCZ                     Local  25460    CHAR            125         scalar                                                      
 K                          Local  25469    I(4)            4           scalar                    25516,25517,25518,25519,25520,2552
                                                                                                  1,25522,25523,25539,25543,25548   
 KBCTYP                     Scalar 25437    I(4)            4     1     2        COM              25518,25519,25520,25521,25522,2552
                                                                                                  3,25561                           
 KDCTYP                     Scalar 25437    I(4)            4           scalar   COM                                                
 KK                         Local  25469    I(4)            4           scalar                    25517,25527,25528,25531,25532,2553
                                                                                                  5,25536,25539,25540,25544,25545,25
                                                                                                  548,25549                         
 N                          Local  25469    I(4)            4           scalar                    25481,25482,25483                 
 NDIM                       Param  25437    I(4)            4           scalar                    25453,25479,25557                 
 NX                         Scalar 25437    I(4)            4           scalar   COM              25472,25473                       
 NXX                        Scalar 25437    I(4)            4           scalar   COM              25472,25479,25481,25557           
 NYNOD                      Dummy  25433    I(4)            4           scalar   ARG,INOUT        25464                             
 PI2                        Local  25467    R(4)            4           scalar                    25467,25497                       
 REAL                       Func   25473                                scalar                    25473                             
 S1BCDC                     Common 25454                                32                                                          
 S1NODE                     Common 25453                                292                                                         
 S1PRIC                     Common 25448                                161                                                         
 SL1OVR                     Subr   25433                                                                                            
 YBCWL                      Scalar 25448    R(4)            4     1     2        COM              25500,25501,25561                 
 YDCWL                      Scalar 25448    R(4)            4           scalar   COM              25499                             

Page 738         Source Listing                  SL1OVR
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YN                         Scalar 25453    R(4)            4     1     71       COM              25474,25482,25483                 
 YN1                        Scalar 25448    R(4)            4           scalar   COM              25473,25474,25475,25482           
 YNOD                       Dummy  25433    R(4)            4     1     0        ARG,INOUT        25475,25483                       
 YNXX                       Scalar 25448    R(4)            4           scalar   COM              25473                             
 YSBCPI                     Local  25464    R(4)            4     1     2                         25500,25501,25539,25543,25548     
 YSDCPI                     Scalar 25454    R(4)            4           scalar   COM              25499                             
 Z                          Local  25470    R(4)            4           scalar                    25497,25498,25543,25544           
 ZC                         Local  25470    R(4)            4           scalar                    25498,25499,25500,25501           

Page 739         Source Listing                  SL1OVR
2017-04-18 11:09                                 syndata.f

  25566 
  25567 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25568 C                .      .    .                                       .
  25569 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25570 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25571 C
  25572 C ABSTRACT: ??????????????????????????????????????????????????????????
  25573 C   ??????????????????????????????????????????????????????????????????
  25574 C
  25575 C PROGRAM HISTORY LOG:
  25576 C ????-??-??  S. J. LORD
  25577 C
  25578 C USAGE:    CALL ????????(????)
  25579 C   INPUT ARGUMENT LIST:
  25580 C     ??????   - ???????????????????????????????????????????????
  25581 C
  25582 C   OUTPUT ARGUMENT LIST:
  25583 C     ??????   - ???????????????????????????????????????????????
  25584 C
  25585 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25586 C     ??????   - ???????????????????????????????????????????????
  25587 C
  25588 C   OUTPUT FILES:
  25589 C     ??????   - ???????????????????????????????????????????????
  25590 C
  25591 C REMARKS: ?????????????????????????????????????????????????????
  25592 C
  25593 C ATTRIBUTES:
  25594 C   LANGUAGE: FORTRAN 90
  25595 C   MACHINE:  NCEP WCOSS
  25596 C
  25597 C$$$
  25598       SUBROUTINE ST1KPX(KPXZ)
  25599 
  25600       PARAMETER (KDTDIM=5)
  25601 C
  25602       COMMON /S1KOMP/ IDSPK(KDTDIM),IDVAR(KDTDIM),KPX
  25603       CHARACTER*8 IDSPK*40
  25604 
  25605       KPX=KPXZ
  25606       RETURN
  25607 
  25608       END

Page 740         Source Listing                  ST1KPX
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 st1kpx_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IDSPK                      Scalar 25602    CHAR            40    1     5        COM                                                
 IDVAR                      Scalar 25602    I(4)            4     1     5        COM                                                
 KDTDIM                     Param  25600    I(4)            4           scalar                    25602                             
 KPX                        Scalar 25602    I(4)            4           scalar   COM              25605                             
 KPXZ                       Dummy  25598    I(4)            4           scalar   ARG,INOUT        25605                             
 S1KOMP                     Common 25602                                224                                                         
 ST1KPX                     Subr   25598                                                                                            

Page 741         Source Listing                  ST1KPX
2017-04-18 11:09                                 syndata.f

  25609 
  25610 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25611 C                .      .    .                                       .
  25612 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25613 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25614 C
  25615 C ABSTRACT: ??????????????????????????????????????????????????????????
  25616 C   ??????????????????????????????????????????????????????????????????
  25617 C
  25618 C PROGRAM HISTORY LOG:
  25619 C ????-??-??  S. J. LORD
  25620 C
  25621 C USAGE:    CALL ????????(????)
  25622 C   INPUT ARGUMENT LIST:
  25623 C     ??????   - ???????????????????????????????????????????????
  25624 C
  25625 C   OUTPUT ARGUMENT LIST:
  25626 C     ??????   - ???????????????????????????????????????????????
  25627 C
  25628 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25629 C     ??????   - ???????????????????????????????????????????????
  25630 C
  25631 C   OUTPUT FILES:
  25632 C     ??????   - ???????????????????????????????????????????????
  25633 C
  25634 C REMARKS: ?????????????????????????????????????????????????????
  25635 C
  25636 C ATTRIBUTES:
  25637 C   LANGUAGE: FORTRAN 90
  25638 C   MACHINE:  NCEP WCOSS
  25639 C
  25640 C$$$
  25641       FUNCTION YBF(N,Y)
  25642 C
  25643 C        ENTRY DYBF, DDYBF
  25644 C
  25645       PARAMETER (MDIM=35,NDIM=35)
  25646 CIBM  COMMON /S2PRIC/ IDSPC,ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,
  25647 CIBM 1                 YNB,YNT,XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4)
  25648       COMMON /S2PRIC/ ISRCD,JPD,MX,NX,KDCTYP,KBCTYP(4),XML,XMR,YNB,YNT,
  25649      1                 XM1,XMXX,YN1,YNXX,XYDCWL(2),XYBCWL(4),IDSPC
  25650       COMMON /S2NODE/ MXX,NXX,DXM,DYN,XM(MDIM),YN(NDIM),XMC(MDIM),
  25651      1                 YNC(NDIM),COSYN(NDIM)
  25652       COMMON /S2BCDC/ DX0,DX1,DX2,DY0,DY1,DY2,CBCBF(8),XYSDCP(2)
  25653       CHARACTER*125 IDSPC
  25654       EQUIVALENCE (NX,LX),(CBCBF(5),CBC11),(CBCBF(6),CBC12),
  25655      1                    (CBCBF(7),CBCX1),(CBCBF(8),CBCX2)
  25656 
  25657       L=N
  25658       XS=(Y-YN(L))*DY0
  25659       Z=2.-ABS(XS)
  25660       IF(Z.GT.0)  GO TO 15
  25661       YBF=0.
  25662       RETURN
  25663    15 CONTINUE
  25664       F=0.25*Z**3
  25665       Z=Z-1.

Page 742         Source Listing                  YBF
2017-04-18 11:09                                 syndata.f

  25666       IF(Z.LE.0)  GO TO 23
  25667       F=F-Z**3
  25668    23 CONTINUE
  25669       IF(L-2.LT.0)  THEN
  25670          GO TO 30
  25671       ELSE  IF(L-2.EQ.0)  THEN
  25672          GO TO 35
  25673       END IF
  25674       IF(LX-L.LT.0)  THEN
  25675          GO TO 40
  25676       ELSE  IF(LX-L.EQ.0)  THEN
  25677          GO TO 45
  25678       END IF
  25679    25 CONTINUE
  25680       YBF=F
  25681       RETURN
  25682 C
  25683 C     BOUNDARY ADJUSTMENTS
  25684 C
  25685    30 CONTINUE
  25686       IF(Z.LE.0)  GO TO 25
  25687       F=F+CBC11*(1.-XS)**3
  25688       GO TO 25
  25689    35 CONTINUE
  25690       IF(XS.GE.0)  GO TO 25
  25691       F=F-CBC12*XS**3
  25692       GO TO  25
  25693    40 CONTINUE
  25694       IF(Z.LE.0)  GO TO 25
  25695       F=F+CBCX1*(1.+XS)**3
  25696       GO TO 25
  25697    45 CONTINUE
  25698       IF(XS.LE.0)  GO TO 25
  25699       F=F+CBCX2*XS**3
  25700       GO TO  25
  25701 C
  25702 
  25703 C-----------------------------------------------------------------------
  25704 
  25705       ENTRY DYBF(N,Y)
  25706       D1=DY1
  25707       L=N
  25708       XS=(Y-YN(L))*DY0
  25709       D1=-SIGN(D1,XS)
  25710       Z=2.-ABS(XS)
  25711       IF(Z.GT.0) GO TO 115
  25712       YBF=0.
  25713       RETURN
  25714   115 CONTINUE
  25715       F=0.25*Z**2
  25716       Z=Z-1.
  25717       IF(Z.LE.0) GO TO 123
  25718       F=F-Z**2
  25719   123 CONTINUE
  25720       IF(L-2.LT.0) THEN
  25721          GO TO 130
  25722       ELSE  IF(L-2.EQ.0)  THEN

Page 743         Source Listing                  YBF
2017-04-18 11:09                                 syndata.f

  25723          GO TO 135
  25724       END IF
  25725       IF(LX-L.LT.0) THEN
  25726          GO TO 140
  25727       ELSE  IF(LX-L.EQ.0)  THEN
  25728          GO TO 145
  25729       END IF
  25730   125 CONTINUE
  25731       YBF=F*D1
  25732       RETURN
  25733   130 CONTINUE
  25734       IF(Z.LE.0) GO TO 125
  25735       F=F+CBC11*SIGN((1.-XS)**2,XS)
  25736       GO TO 125
  25737   135 CONTINUE
  25738       IF(XS.GE.0) GO TO 125
  25739       F=F-CBC12*XS**2
  25740       GO TO 125
  25741   140 CONTINUE
  25742       IF(Z.LE.0) GO TO 125
  25743       F=F-CBCX1*SIGN((1.+XS)**2,XS)
  25744       GO TO 125
  25745   145 CONTINUE
  25746       IF(XS.LE.0) GO TO 125
  25747       F=F-CBCX2*XS**2
  25748       GO TO 125
  25749 C
  25750 
  25751 C-----------------------------------------------------------------------
  25752 
  25753       ENTRY DDYBF(N,Y)
  25754       D2=DY2
  25755       L=N
  25756       XS=(Y-YN(L))*DY0
  25757       Z=2.-ABS(XS)
  25758       IF(Z.GT.0) GO TO 215
  25759       YBF=0.
  25760       RETURN
  25761   215 CONTINUE
  25762       F=0.25*Z
  25763       Z=Z-1.
  25764       IF(Z.LE.0) GO TO 223
  25765       F=F-Z
  25766   223 CONTINUE
  25767       IF(L-2.LT.0) THEN
  25768          GO TO 230
  25769       ELSE  IF(L-2.EQ.0)  THEN
  25770          GO TO 235
  25771       END IF
  25772       IF(LX-L.LT.0) THEN
  25773          GO TO 240
  25774       ELSE  IF(LX-L.EQ.0)  THEN
  25775          GO TO 245
  25776       END IF
  25777   225 CONTINUE
  25778       YBF=F*D2
  25779       RETURN

Page 744         Source Listing                  YBF
2017-04-18 11:09                                 syndata.f

  25780   230 CONTINUE
  25781       IF(Z.LE.0) GO TO 225
  25782       F=F+CBC11*(1.-XS)
  25783       GO TO 225
  25784   235 CONTINUE
  25785       IF(XS.GE.0) GO TO 225
  25786       F=F-CBC12*XS
  25787       GO TO 225
  25788   240 CONTINUE
  25789       IF(Z.LE.0) GO TO 225
  25790       F=F+CBCX1*(1.+XS)
  25791       GO TO 225
  25792   245 CONTINUE
  25793       IF(XS.LE.0) GO TO 225
  25794       F=F+CBCX2*XS
  25795       GO TO 225
  25796       END


ENTRY POINTS

  Name                 Name                 Name              
                                                              
 ddybf_               dybf_                ybf_               


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 115                        Label  25714                                                          25711                             
 123                        Label  25719                                                          25717                             
 125                        Label  25730                                                          25734,25736,25738,25740,25742,2574
                                                                                                  4,25746,25748                     
 130                        Label  25733                                                          25721                             
 135                        Label  25737                                                          25723                             
 140                        Label  25741                                                          25726                             
 145                        Label  25745                                                          25728                             
 15                         Label  25663                                                          25660                             
 215                        Label  25761                                                          25758                             
 223                        Label  25766                                                          25764                             
 225                        Label  25777                                                          25781,25783,25785,25787,25789,2579
                                                                                                  1,25793,25795                     
 23                         Label  25668                                                          25666                             
 230                        Label  25780                                                          25768                             
 235                        Label  25784                                                          25770                             
 240                        Label  25788                                                          25773                             
 245                        Label  25792                                                          25775                             
 25                         Label  25679                                                          25686,25688,25690,25692,25694,2569
                                                                                                  6,25698,25700                     
 30                         Label  25685                                                          25670                             
 35                         Label  25689                                                          25672                             
 40                         Label  25693                                                          25675                             
 45                         Label  25697                                                          25677                             
 ABS                        Func   25659                                scalar                    25659,25710,25757                 
 CBC11                      Scalar 25654    R(4)            4           scalar   COM              25687,25735,25782                 
 CBC12                      Scalar 25654    R(4)            4           scalar   COM              25691,25739,25786                 

Page 745         Source Listing                  YBF
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CBCBF                      Scalar 25652    R(4)            4     1     8        COM                                                
 CBCX1                      Scalar 25655    R(4)            4           scalar   COM              25695,25743,25790                 
 CBCX2                      Scalar 25655    R(4)            4           scalar   COM              25699,25747,25794                 
 COSYN                      Scalar 25651    R(4)            4     1     35       COM                                                
 D1                         Local  25706    R(4)            4           scalar                    25706,25709,25731                 
 D2                         Local  25754    R(4)            4           scalar                    25754,25778                       
 DDYBF                      Func   25753    R(4)            4           scalar                                                      
 DX0                        Scalar 25652    R(4)            4           scalar   COM                                                
 DX1                        Scalar 25652    R(4)            4           scalar   COM                                                
 DX2                        Scalar 25652    R(4)            4           scalar   COM                                                
 DXM                        Scalar 25650    R(4)            4           scalar   COM                                                
 DY0                        Scalar 25652    R(4)            4           scalar   COM              25658,25708,25756                 
 DY1                        Scalar 25652    R(4)            4           scalar   COM              25706                             
 DY2                        Scalar 25652    R(4)            4           scalar   COM              25754                             
 DYBF                       Func   25705    R(4)            4           scalar                                                      
 DYN                        Scalar 25650    R(4)            4           scalar   COM                                                
 F                          Local  25664    R(4)            4           scalar                    25664,25667,25680,25687,25691,2569
                                                                                                  5,25699,25715,25718,25731,25735,25
                                                                                                  739,25743,25747,25762,25765,25778,
                                                                                                  25782,25786,25790,25794           
 IDSPC                      Scalar 25649    CHAR            125         scalar   COM                                                
 ISRCD                      Scalar 25648    I(4)            4           scalar   COM                                                
 JPD                        Scalar 25648    I(4)            4           scalar   COM                                                
 KBCTYP                     Scalar 25648    I(4)            4     1     4        COM                                                
 KDCTYP                     Scalar 25648    I(4)            4           scalar   COM                                                
 L                          Local  25657    I(4)            4           scalar                    25657,25658,25669,25671,25674,2567
                                                                                                  6,25707,25708,25720,25722,25725,25
                                                                                                  727,25755,25756,25767,25769,25772,
                                                                                                  25774                             
 LX                         Scalar 25654    I(4)            4           scalar   COM              25674,25676,25725,25727,25772,2577
                                                                                                  4                                 
 MDIM                       Param  25645    I(4)            4           scalar                    25650                             
 MX                         Scalar 25648    I(4)            4           scalar   COM                                                
 MXX                        Scalar 25650    I(4)            4           scalar   COM                                                
 N                          Dummy  25641    I(4)            4           scalar   ARG,INOUT        25657,25707,25755                 
 NDIM                       Param  25645    I(4)            4           scalar                    25650,25651                       
 NX                         Scalar 25648    I(4)            4           scalar   COM                                                
 NXX                        Scalar 25650    I(4)            4           scalar   COM                                                
 S2BCDC                     Common 25652                                64                                                          
 S2NODE                     Common 25650                                716                                                         
 S2PRIC                     Common 25648                                217                                                         
 SIGN                       Func   25709                                scalar                    25709,25735,25743                 
 XM                         Scalar 25650    R(4)            4     1     35       COM                                                
 XM1                        Scalar 25649    R(4)            4           scalar   COM                                                
 XMC                        Scalar 25650    R(4)            4     1     35       COM                                                
 XML                        Scalar 25648    R(4)            4           scalar   COM                                                
 XMR                        Scalar 25648    R(4)            4           scalar   COM                                                
 XMXX                       Scalar 25649    R(4)            4           scalar   COM                                                
 XS                         Local  25658    R(4)            4           scalar                    25658,25659,25687,25690,25691,2569
                                                                                                  5,25698,25699,25708,25709,25710,25
                                                                                                  735,25738,25739,25743,25746,25747,
                                                                                                  25756,25757,25782,25785,25786,2579
                                                                                                  0,25793,25794                     
 XYBCWL                     Scalar 25649    R(4)            4     1     4        COM                                                
 XYDCWL                     Scalar 25649    R(4)            4     1     2        COM                                                

Page 746         Source Listing                  YBF
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XYSDCP                     Scalar 25652    R(4)            4     1     2        COM                                                
 Y                          Dummy  25641    R(4)            4           scalar   ARG,INOUT        25658,25708,25756                 
 YBF                        Func   25641    R(4)            4           scalar                    25661,25680,25712,25731,25759,2577
                                                                                                  8                                 
 YBF@0                      Local  25641    R(4)            4           scalar                                                      
 YN                         Scalar 25650    R(4)            4     1     35       COM              25658,25708,25756                 
 YN1                        Scalar 25649    R(4)            4           scalar   COM                                                
 YNB                        Scalar 25648    R(4)            4           scalar   COM                                                
 YNC                        Scalar 25651    R(4)            4     1     35       COM                                                
 YNT                        Scalar 25648    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 25649    R(4)            4           scalar   COM                                                
 Z                          Local  25659    R(4)            4           scalar                    25659,25660,25664,25665,25666,2566
                                                                                                  7,25686,25694,25710,25711,25715,25
                                                                                                  716,25717,25718,25734,25742,25757,
                                                                                                  25758,25762,25763,25764,25765,2578
                                                                                                  1,25789                           

Page 747         Source Listing                  YBF
2017-04-18 11:09                                 syndata.f

  25797 
  25798 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25799 C                .      .    .                                       .
  25800 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25801 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25802 C
  25803 C ABSTRACT: ??????????????????????????????????????????????????????????
  25804 C   ??????????????????????????????????????????????????????????????????
  25805 C
  25806 C PROGRAM HISTORY LOG:
  25807 C ????-??-??  S. J. LORD
  25808 C
  25809 C USAGE:    CALL ????????(????)
  25810 C   INPUT ARGUMENT LIST:
  25811 C     ??????   - ???????????????????????????????????????????????
  25812 C
  25813 C   OUTPUT ARGUMENT LIST:
  25814 C     ??????   - ???????????????????????????????????????????????
  25815 C
  25816 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25817 C     ??????   - ???????????????????????????????????????????????
  25818 C
  25819 C   OUTPUT FILES:
  25820 C     ??????   - ???????????????????????????????????????????????
  25821 C
  25822 C REMARKS: ?????????????????????????????????????????????????????
  25823 C
  25824 C ATTRIBUTES:
  25825 C   LANGUAGE: FORTRAN 90
  25826 C   MACHINE:  NCEP WCOSS
  25827 C
  25828 C$$$
  25829       SUBROUTINE PR1FKM(A,FKMN,KP1,KP2)
  25830 C
  25831       PARAMETER (NDIM=71)
  25832       PARAMETER (KDTDIM=5)
  25833 C
  25834 C     ** ** EXTERNALS MUST BE DECLARED ** **
  25835 C
  25836       EXTERNAL Y1BF,D1YBF,DD1YBF
  25837 C
  25838       COMMON /S1KOMP/ IDSPK(KDTDIM),IDVAR(KDTDIM),KPX
  25839       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  25840 C
  25841       DIMENSION A(KDTDIM,NDIM),FKMN(KDTDIM,NDIM)
  25842 C
  25843       CHARACTER*40 IDSPK
  25844 C
  25845       CALL SL1NTA(A,1,NXX,1)
  25846       CALL SL1NTD(Y1BF)
  25847 C
  25848       DO KP=KP1,KP2
  25849          CALL SL1NTO(A,KP,FKMN,KDTDIM,NDIM,KP)
  25850       ENDDO
  25851 C
  25852 c && 4 comments
  25853 CC    DO KP=KP1,KP2

Page 748         Source Listing                  PR1FKM
2017-04-18 11:09                                 syndata.f

  25854 CC       WRITE(6,21) KP,IDSPK(KP),(YN(N),FKMN(KP,N),N=1,NDIM)
  25855 CC    ENDDO
  25856 CC 21 FORMAT(//15X,'KP=',I3,5X,A40,/,(25X,F6.1,F13.8,/))
  25857 C
  25858       RETURN
  25859 C
  25860       END


ENTRY POINTS

  Name               
                     
 pr1fkm_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  25829    R(4)            4     2     355      ARG,INOUT        25845,25849                       
 D1YBF                      Subr   25836                                scalar                                                      
 DD1YBF                     Subr   25836                                scalar                                                      
 DYN                        Scalar 25839    R(4)            4           scalar   COM                                                
 FKMN                       Dummy  25829    R(4)            4     2     355      ARG,INOUT        25849                             
 IDSPK                      Scalar 25838    CHAR            40    1     5        COM                                                
 IDVAR                      Scalar 25838    I(4)            4     1     5        COM                                                
 KDTDIM                     Param  25832    I(4)            4           scalar                    25838,25841,25849                 
 KP                         Local  25848    I(4)            4           scalar                    25848,25849                       
 KP1                        Dummy  25829    I(4)            4           scalar   ARG,INOUT        25848                             
 KP2                        Dummy  25829    I(4)            4           scalar   ARG,INOUT        25848                             
 KPX                        Scalar 25838    I(4)            4           scalar   COM                                                
 NDIM                       Param  25831    I(4)            4           scalar                    25839,25841,25849                 
 NXX                        Scalar 25839    I(4)            4           scalar   COM              25845                             
 PR1FKM                     Subr   25829                                                                                            
 S1KOMP                     Common 25838                                224                                                         
 S1NODE                     Common 25839                                292                                                         
 SL1NTA                     Subr   25845                                                          25845                             
 SL1NTD                     Subr   25846                                                          25846                             
 SL1NTO                     Subr   25849                                                          25849                             
 Y1BF                       Subr   25836                                scalar                    25846                             
 YN                         Scalar 25839    R(4)            4     1     71       COM                                                

Page 749         Source Listing                  PR1FKM
2017-04-18 11:09                                 syndata.f

  25861 
  25862 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25863 C                .      .    .                                       .
  25864 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25865 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25866 C
  25867 C ABSTRACT: ??????????????????????????????????????????????????????????
  25868 C   ??????????????????????????????????????????????????????????????????
  25869 C
  25870 C PROGRAM HISTORY LOG:
  25871 C ????-??-??  S. J. LORD
  25872 C
  25873 C USAGE:    CALL ????????(????)
  25874 C   INPUT ARGUMENT LIST:
  25875 C     ??????   - ???????????????????????????????????????????????
  25876 C
  25877 C   OUTPUT ARGUMENT LIST:
  25878 C     ??????   - ???????????????????????????????????????????????
  25879 C
  25880 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25881 C     ??????   - ???????????????????????????????????????????????
  25882 C
  25883 C   OUTPUT FILES:
  25884 C     ??????   - ???????????????????????????????????????????????
  25885 C
  25886 C REMARKS: ?????????????????????????????????????????????????????
  25887 C
  25888 C ATTRIBUTES:
  25889 C   LANGUAGE: FORTRAN 90
  25890 C   MACHINE:  NCEP WCOSS
  25891 C
  25892 C$$$
  25893       BLOCK DATA IBM4
  25894       PARAMETER (KDTDIM=5)
  25895       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,
  25896      1        YBCWL(2),IDSPC
  25897       COMMON /S1KOMP/ IDSPK(KDTDIM),IDVAR(KDTDIM),KPX
  25898       COMMON /ZETAC/ CPA,CPB,CSTR,CPSTR0,CZ0,CZ1,CZ2,CZ3,CP00
  25899 C
  25900       CHARACTER*125 IDSPC
  25901       CHARACTER*40 IDSPK
  25902       DATA  IDSPC/' '/
  25903       DATA KPX/KDTDIM/
  25904       DATA CPA/1012./,CPB/70./,CSTR/5./,CPSTR0/700./,CP00/0.001/
  25905       END

Page 750         Source Listing                  IBM4
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CP00                       Scalar 25898    R(4)            4           scalar   COM,SAVE         25904                             
 CPA                        Scalar 25898    R(4)            4           scalar   COM,SAVE         25904                             
 CPB                        Scalar 25898    R(4)            4           scalar   COM,SAVE         25904                             
 CPSTR0                     Scalar 25898    R(4)            4           scalar   COM,SAVE         25904                             
 CSTR                       Scalar 25898    R(4)            4           scalar   COM,SAVE         25904                             
 CZ0                        Scalar 25898    R(4)            4           scalar   COM                                                
 CZ1                        Scalar 25898    R(4)            4           scalar   COM                                                
 CZ2                        Scalar 25898    R(4)            4           scalar   COM                                                
 CZ3                        Scalar 25898    R(4)            4           scalar   COM                                                
 IBM4                       Block  25893                                scalar                                                      
 IDSPC                      Scalar 25896    CHAR            125         scalar   COM,SAVE         25902                             
 IDSPK                      Scalar 25897    CHAR            40    1     5        COM                                                
 IDVAR                      Scalar 25897    I(4)            4     1     5        COM                                                
 KBCTYP                     Scalar 25895    I(4)            4     1     2        COM                                                
 KDCTYP                     Scalar 25895    I(4)            4           scalar   COM                                                
 KDTDIM                     Param  25894    I(4)            4           scalar                    25897,25903                       
 KPX                        Scalar 25897    I(4)            4           scalar   COM,SAVE         25903                             
 NX                         Scalar 25895    I(4)            4           scalar   COM                                                
 S1KOMP                     Common 25897                                224                                                         
 S1PRIC                     Common 25895                                161                                                         
 YBCWL                      Scalar 25896    R(4)            4     1     2        COM                                                
 YDCWL                      Scalar 25895    R(4)            4           scalar   COM                                                
 YN1                        Scalar 25895    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 25895    R(4)            4           scalar   COM                                                
 ZETAC                      Common 25898                                36                                                          

Page 751         Source Listing                  IBM4
2017-04-18 11:09                                 syndata.f

  25906 
  25907 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25908 C                .      .    .                                       .
  25909 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25910 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25911 C
  25912 C ABSTRACT: ??????????????????????????????????????????????????????????
  25913 C   ??????????????????????????????????????????????????????????????????
  25914 C
  25915 C PROGRAM HISTORY LOG:
  25916 C ????-??-??  S. J. LORD
  25917 C
  25918 C USAGE:    CALL ????????(????)
  25919 C   INPUT ARGUMENT LIST:
  25920 C     ??????   - ???????????????????????????????????????????????
  25921 C
  25922 C   OUTPUT ARGUMENT LIST:
  25923 C     ??????   - ???????????????????????????????????????????????
  25924 C
  25925 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  25926 C     ??????   - ???????????????????????????????????????????????
  25927 C
  25928 C   OUTPUT FILES:
  25929 C     ??????   - ???????????????????????????????????????????????
  25930 C
  25931 C REMARKS: ?????????????????????????????????????????????????????
  25932 C
  25933 C ATTRIBUTES:
  25934 C   LANGUAGE: FORTRAN 90
  25935 C   MACHINE:  NCEP WCOSS
  25936 C
  25937 C$$$
  25938 C.                SL1RGO **   11/20/84
  25939 C
  25940 C     ++ ASSUMED DIM PARAMETERS ... NDIM=71
  25941 C
  25942 C
  25943       SUBROUTINE SL1RGO
  25944 C
  25945 C     ** ONE-D VERSION OF THE EARLIER TWO-D SPLINE ROUTINES **
  25946 C          PERIODIC BC IS NOT ALLOWED AT THIS TIME (03/31/79)
  25947 C
  25948       PARAMETER (NDIM=71)
  25949 C
  25950 C     ** NODAL CONSTANTS
  25951       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  25952 C
  25953 C
  25954 C
  25955 C     ** ** SL1RGO BEGINS ** **
  25956 C
  25957 c && 2 comments
  25958 CC    IZERO = 0
  25959 CC    INSEC = ISECND(IZERO)
  25960 C
  25961 C     ** PREPARE FOR GT1AMR.  SL1MAC ASSUMES /S1DTPT/ HAS BEEN DEFINED.
  25962       CALL SL1MAC

Page 752         Source Listing                  SL1RGO
2017-04-18 11:09                                 syndata.f

  25963 C
  25964 C     ** INITIALIZE THE N-MATRIX ROUTINES
  25965       CALL PASD1X(NXX)
  25966 C
  25967 C     ** ZERO MATRICES
  25968       CALL CL1ADE
  25969 C
  25970 C     ** MATRIX INVERSION
  25971       CALL CA1DMM
  25972 C
  25973 c && 3 comments
  25974 CC    IDELTA = ISECND(INSEC)
  25975 CC    WRITE(6,880) IDELTA
  25976 CC880 FORMAT(/' === SL1RGO DONE ===',T91,'ELAPSED TIME=',I6)
  25977       RETURN
  25978 C
  25979       END


ENTRY POINTS

  Name               
                     
 sl1rgo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CA1DMM                     Subr   25971                                                          25971                             
 CL1ADE                     Subr   25968                                                          25968                             
 DYN                        Scalar 25951    R(4)            4           scalar   COM                                                
 NDIM                       Param  25948    I(4)            4           scalar                    25951                             
 NXX                        Scalar 25951    I(4)            4           scalar   COM              25965                             
 PASD1X                     Subr   25965                                                          25965                             
 S1NODE                     Common 25951                                292                                                         
 SL1MAC                     Subr   25962                                                          25962                             
 SL1RGO                     Subr   25943                                                                                            
 YN                         Scalar 25951    R(4)            4     1     71       COM                                                

Page 753         Source Listing                  SL1RGO
2017-04-18 11:09                                 syndata.f

  25980 
  25981 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  25982 C                .      .    .                                       .
  25983 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  25984 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  25985 C
  25986 C ABSTRACT: ??????????????????????????????????????????????????????????
  25987 C   ??????????????????????????????????????????????????????????????????
  25988 C
  25989 C PROGRAM HISTORY LOG:
  25990 C ????-??-??  S. J. LORD
  25991 C
  25992 C USAGE:    CALL ????????(????)
  25993 C   INPUT ARGUMENT LIST:
  25994 C     ??????   - ???????????????????????????????????????????????
  25995 C
  25996 C   OUTPUT ARGUMENT LIST:
  25997 C     ??????   - ???????????????????????????????????????????????
  25998 C
  25999 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26000 C     ??????   - ???????????????????????????????????????????????
  26001 C
  26002 C   OUTPUT FILES:
  26003 C     ??????   - ???????????????????????????????????????????????
  26004 C
  26005 C REMARKS: ?????????????????????????????????????????????????????
  26006 C
  26007 C ATTRIBUTES:
  26008 C   LANGUAGE: FORTRAN 90
  26009 C   MACHINE:  NCEP WCOSS
  26010 C
  26011 C$$$
  26012 C                             AMM IS SQUARE MATRIX
  26013       SUBROUTINE SL1GET(AMM)
  26014 C          ENTRY GT1AMR (AMM)
  26015 C
  26016       PARAMETER (NDIM=71)
  26017 ccccc PARAMETER (LDXDIM=2500)
  26018       PARAMETER (LDXDIM=8000)
  26019 C
  26020 C     ** DATA POINTS INFORMATION **
  26021 C
  26022       COMMON/S1DTPT/IDSPD1,IDSPD2,LDX,YD(LDXDIM),WD(LDXDIM),
  26023      1               LXSORT(LDXDIM)
  26024 C
  26025 C     DUMMY ARGUMENTS ... AMM,IS SQUARE MATRIX  (OCT 79)
  26026       DIMENSION AMM(NDIM,NDIM)
  26027 C
  26028 C     LOCAL WORK SPACE
  26029       DIMENSION ROWM(NDIM,4)
  26030 C
  26031 C     OTHER CONSTANTS
  26032       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,
  26033      1        YBCWL(2),IDSPC
  26034       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  26035 C     LOCAL CONSTANTS FOR SL1ADQ
  26036       COMMON /S1MACQ/ NXX1,NX1,NX2,NX3

Page 754         Source Listing                  SL1GET
2017-04-18 11:09                                 syndata.f

  26037       CHARACTER*8 IDSPD1,IDSPD2*72,IDSPC*125
  26038 C
  26039 C     INPUT TO SL1MAC VIA /S1DTPT/
  26040 C      YD      Y COORDINATES OF DATA POINTS
  26041 C      WD      WEIGHTS ON DATA AT INDIVIDUAL DATA POINTS
  26042 C              MUST HAVE BEEN SET BEFORE SL1MAC IS CALLED
  26043 C              ++ TO AVOID POSSIBLE HANG UP IN GT1AMR, WD WILL BE
  26044 C                 SET NEGATIVE IF XD OR YD IS OFF LIMITS.
  26045 C              ANY POINTS WITH ZERO OR NEGATIVE WEIGHT WILL NOT BE
  26046 C              INCLUDED IN THE ROWM ACCUMULATION BY SL1MAC/GT1AMR
  26047 C      LDX     MAX NUMBER OF DATA POINTS.  MUST BE .LE. LDXDIM
  26048 C      IDSPD   ID OF THE DATA POINT SET, AND EXPLANATION (80 CHARACTERS)
  26049 C
  26050 C     INPUT TO GT1AMR
  26051 C
  26052 C     OUT FROM GT1AMR
  26053 C      AMM     (N,N) MATRIX AT (M,M) DIAGONAL
  26054 C     +++ +++ NRT1S0 IS USED TO TRANSFORM REC ARRAYS TO SQUARE ARRAYS ++
  26055 C
  26056 C     LOCAL ARRAYS
  26057 C      ROWM    WILL BE ACTIVE DURING SL1RGO EXECUTION
  26058 C
  26059 C
  26060 
  26061       SAVE
  26062 
  26063 C-----------------------------------------------------------------------
  26064 
  26065 C     ** DEFINE /S1MACQ/ FOR THE USE BY SL1ADQ
  26066       ENTRY SL1MAC
  26067       NXX1=NXX+1
  26068       NX1=NX-1
  26069       NX2=NX-2
  26070       NX3=NX-3
  26071 C
  26072 C     ** INITIALIZATION FOR GT1AMR **
  26073 C
  26074 C     CHECK DATA POINTS AND WEIGHTS
  26075 C       ONLY DATA INSIDE DOMAIN ARE ACCEPTED
  26076 C
  26077       LDOK=0
  26078       LDOFF=0
  26079       DO 84 LD=1,LDX
  26080 C       IGNORE IF THE WEIGHT IS ALREADY MARKED OFF
  26081       IF(WD(LD).LE.0.) GO TO 84
  26082 C       CHECK FOR OFF-LIMIT POINTS
  26083       IF(YD(LD) .LT. YN1 .OR. YD(LD) .GT. YNXX)  GO TO 82
  26084 C       ACCEPTED POINTS
  26085       LDOK=LDOK+1
  26086       GO TO 84
  26087 C       OFF THE LIMITS.  WD SET TO NEGATIVE
  26088    82 WD(LD)=-ABS(WD(LD))
  26089       WRITE(6,830) YD(LD)
  26090   830 FORMAT(10X,'REJECTED DATA POINT...  YD=',F8.2)
  26091       LDOFF=LDOFF+1
  26092    84 CONTINUE
  26093 C

Page 755         Source Listing                  SL1GET
2017-04-18 11:09                                 syndata.f

  26094       WRITE(6,885) LDX,LDOK,LDOFF
  26095   885 FORMAT(/' === SL1MAC DATA POINTS CHECK.      LDX=',I6,
  26096      1    ' (INPUT TOTAL COUNT)',/,36X,'LDOK=',I6,' (ACCEPTED BY ',
  26097      2    'SL1MAC)',/,35X,'LDOFF=',I6,' (REJECTED.  WD REDEFINED)')
  26098 C
  26099 C     QUIT, IF LDOK IS ZERO
  26100       IF(LDOK.LE.0) GO TO 91
  26101 C
  26102 C
  26103 C
  26104       ROWM=0.
  26105 C
  26106       DY0=1./DYN
  26107       ID=0
  26108 C
  26109       CALL SL1QBG
  26110 C
  26111       RETURN
  26112 
  26113 C-----------------------------------------------------------------------
  26114 
  26115 C
  26116 C
  26117       ENTRY GT1AMR(AMM)
  26118 C
  26119 C     CHECK IF UNPROCESSED DATA STILL REMAIN
  26120   110 IF(ID.GE.LDX) GO TO 120
  26121       ID=ID+1
  26122       if(ID .GT. LDXDIM)  THEN
  26123          print *, 'LDXDIM limit (',LDXDIM,') exceeded - ',
  26124      $    'ID=',ID,', return'
  26125          return
  26126       endif
  26127       LD=LXSORT(ID)
  26128       Y=YD(LD)
  26129       W=MIN(WD(LD),1.0)
  26130       IF(W.LE.0.) GO TO 110
  26131 C
  26132 C     ** ROWM ACCUMULATION **
  26133       NA1=MAX(INT((Y-YN1)*DY0),1)
  26134       NAX=MIN(NA1+3,NXX)
  26135 C
  26136       DO NA=NA1,NAX
  26137       WMABNA=Y1BF(NA,Y)*W
  26138       DO NB=NA,NAX
  26139       NR=NB-NA+1
  26140       ROWM(NA,NR)=ROWM(NA,NR)+Y1BF(NB,Y)*WMABNA
  26141       ENDDO
  26142       ENDDO
  26143 C
  26144       GO TO 110
  26145 C
  26146 C
  26147 C     NO MORE DATA POINTS LEFT IN THE PRESENT ACCUMULATION RANGE
  26148 C
  26149 C     ADD Q
  26150 C

Page 756         Source Listing                  SL1GET
2017-04-18 11:09                                 syndata.f

  26151   120 CALL SL1ADQ(ROWM)
  26152 C
  26153 C     TRANSFER RESULTS TO AMM
  26154 C
  26155       CALL NRT1S0(ROWM,AMM)
  26156 C
  26157       RETURN
  26158 C
  26159 C     ** ERROR EXITS **
  26160 C
  26161    91 WRITE(6,891)
  26162   891 FORMAT(' === SL1MAC CALLS EXIT.  NO ACCEPTED DATA POINTS.')
  26163       CALL ABRT1(' SL1MAC',891)
  26164       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 gt1amr_               sl1get_               sl1mac_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 110                        Label  26120                                                          26130,26144                       
 120                        Label  26151                                                          26120                             
 82                         Label  26088                                                          26083                             
 830                        Label  26090                                                          26089                             
 84                         Label  26092                                                          26079,26081,26086                 
 885                        Label  26095                                                          26094                             
 891                        Label  26162                                                          26161                             
 91                         Label  26161                                                          26100                             
 ABRT1                      Subr   26163                                                          26163                             
 ABS                        Func   26088                                scalar                    26088                             
 AMM                        Dummy  26013    R(4)            4     2     5041     ARG,INOUT        26155                             
 DY0                        Local  26106    R(4)            4           scalar   SAVE             26106,26133                       
 DYN                        Scalar 26034    R(4)            4           scalar   COM              26106                             
 GT1AMR                     Subr   26117                                                                                            
 ID                         Local  26107    I(4)            4           scalar   SAVE             26107,26120,26121,26122,26124,2612
                                                                                                  7                                 
 IDSPC                      Scalar 26033    CHAR            125         scalar   COM                                                
 IDSPD1                     Scalar 26022    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 26022    CHAR            72          scalar   COM                                                
 INT                        Func   26133                                scalar                    26133                             
 KBCTYP                     Scalar 26032    I(4)            4     1     2        COM                                                
 KDCTYP                     Scalar 26032    I(4)            4           scalar   COM                                                
 LD                         Local  26079    I(4)            4           scalar   SAVE             26079,26081,26083,26088,26089,2612
                                                                                                  7,26128,26129                     
 LDOFF                      Local  26078    I(4)            4           scalar   SAVE             26078,26091,26094                 
 LDOK                       Local  26077    I(4)            4           scalar   SAVE             26077,26085,26094,26100           
 LDX                        Scalar 26022    I(4)            4           scalar   COM              26079,26094,26120                 
 LDXDIM                     Param  26018    I(4)            4           scalar                    26022,26023,26122,26123           
 LXSORT                     Scalar 26023    I(4)            4     1     8000     COM              26127                             
 MAX                        Func   26133                                scalar                    26133                             

Page 757         Source Listing                  SL1GET
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIN                        Func   26129                                scalar                    26129,26134                       
 NA                         Local  26136    I(4)            4           scalar   SAVE             26136,26137,26138,26139,26140     
 NA1                        Local  26133    I(4)            4           scalar   SAVE             26133,26134,26136                 
 NAX                        Local  26134    I(4)            4           scalar   SAVE             26134,26136,26138                 
 NB                         Local  26138    I(4)            4           scalar   SAVE             26138,26139,26140                 
 NDIM                       Param  26016    I(4)            4           scalar                    26026,26029,26034                 
 NR                         Local  26139    I(4)            4           scalar   SAVE             26139,26140                       
 NRT1S0                     Subr   26155                                                          26155                             
 NX                         Scalar 26032    I(4)            4           scalar   COM              26068,26069,26070                 
 NX1                        Scalar 26036    I(4)            4           scalar   COM              26068                             
 NX2                        Scalar 26036    I(4)            4           scalar   COM              26069                             
 NX3                        Scalar 26036    I(4)            4           scalar   COM              26070                             
 NXX                        Scalar 26034    I(4)            4           scalar   COM              26067,26134                       
 NXX1                       Scalar 26036    I(4)            4           scalar   COM              26067                             
 ROWM                       Local  26029    R(4)            4     2     284      SAVE             26104,26140,26151,26155           
 S1DTPT                     Common 26022                                96084    SAVE                                               
 S1MACQ                     Common 26036                                16       SAVE                                               
 S1NODE                     Common 26034                                292      SAVE                                               
 S1PRIC                     Common 26032                                161      SAVE                                               
 SL1ADQ                     Subr   26151                                                          26151                             
 SL1GET                     Subr   26013                                                                                            
 SL1MAC                     Subr   26066                                                                                            
 SL1QBG                     Subr   26109                                                          26109                             
 W                          Local  26129    R(4)            4           scalar   SAVE             26129,26130,26137                 
 WD                         Scalar 26022    R(4)            4     1     8000     COM              26081,26088,26129                 
 WMABNA                     Local  26137    R(4)            4           scalar   SAVE             26137,26140                       
 Y                          Local  26128    R(4)            4           scalar   SAVE             26128,26133,26137,26140           
 Y1BF                       Func   26137    R(4)            4           scalar                    26137,26140                       
 YBCWL                      Scalar 26033    R(4)            4     1     2        COM                                                
 YD                         Scalar 26022    R(4)            4     1     8000     COM              26083,26089,26128                 
 YDCWL                      Scalar 26032    R(4)            4           scalar   COM                                                
 YN                         Scalar 26034    R(4)            4     1     71       COM                                                
 YN1                        Scalar 26032    R(4)            4           scalar   COM              26083,26133                       
 YNXX                       Scalar 26032    R(4)            4           scalar   COM              26083                             

Page 758         Source Listing                  SL1GET
2017-04-18 11:09                                 syndata.f

  26165 
  26166 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26167 C                .      .    .                                       .
  26168 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26169 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26170 C
  26171 C ABSTRACT: ??????????????????????????????????????????????????????????
  26172 C   ??????????????????????????????????????????????????????????????????
  26173 C
  26174 C PROGRAM HISTORY LOG:
  26175 C ????-??-??  S. J. LORD
  26176 C
  26177 C USAGE:    CALL ????????(????)
  26178 C   INPUT ARGUMENT LIST:
  26179 C     ??????   - ???????????????????????????????????????????????
  26180 C
  26181 C   OUTPUT ARGUMENT LIST:
  26182 C     ??????   - ???????????????????????????????????????????????
  26183 C
  26184 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26185 C     ??????   - ???????????????????????????????????????????????
  26186 C
  26187 C   OUTPUT FILES:
  26188 C     ??????   - ???????????????????????????????????????????????
  26189 C
  26190 C REMARKS: ?????????????????????????????????????????????????????
  26191 C
  26192 C ATTRIBUTES:
  26193 C   LANGUAGE: FORTRAN 90
  26194 C   MACHINE:  NCEP WCOSS
  26195 C
  26196 C$$$
  26197       SUBROUTINE SL1QBG
  26198 C
  26199       COMMON /S1BCDC/ DY0,DY1,DY2,CBCBF(4),YSDCPI
  26200 C
  26201       COMMON /S1QRBG/ QNRBG(5,4,4)
  26202 C
  26203 C     ** STRUCTURE OF QNRBG (I,J,K)  (FOR ANY K)
  26204 C
  26205 C   I   J= 1         2         3         4
  26206 C
  26207 C              QUADRATURE INTEGRAL TERMS               THE ORDER OF DERI
  26208 C   1     1,1       1,2       1,3       1,4                 IN QUADRATUR
  26209 C   2     2,2       2,3       2,4       2,5
  26210 C   3     3,3       3,4       3,5       3,6              K=1   0TH ORDER
  26211 C   4    NX,NX    NX1,NX    NX2,NX    NX3,NX               2   1ST ORDER
  26212 C   5   NXX,NXX    NX,NXX   NX1,NXX   NX2,NXX              3   2ND ORDER
  26213 C                                                          4   3RD ORDER
  26214 C
  26215 C     ORTHO- AND PARA-ELEMENTS ARE PARTIAL QUADRATURES OF BF AND DERIVAT
  26216 C
  26217       DIMENSION QO11(4),QO12(4),QO22(4),QP11(4),QP12(4),QP22(4)
  26218 C
  26219       DATA QO11/0.530357142857143, 0.63750, 2.250, 20.25/,
  26220      1     QO12/0.057589285714286, 0.13125,-1.125, -6.75/,
  26221      2     QO22/0.008928571428571, 0.11250, 0.750,  2.25/,

Page 759         Source Listing                  SL1QBG
2017-04-18 11:09                                 syndata.f

  26222      3     QP11/0.416517857142857,-0.54375,-1.125,-20.25/,
  26223      4     QP12/0.026785714285714,-0.22500, 0.000,  6.75/,
  26224      5     QP22/0.000446428571429,-0.01875, 0.375, -2.25/
  26225 C
  26226 C
  26227 C     ** THE NORMAL NO-PRINT ENTRY
  26228 C
  26229 C     FOR INTERIOR NODES
  26230 
  26231       QNRBG(3,1,:)= 2.*(QO11(:)+QO22(:))
  26232       QNRBG(3,2,:)= 2. *QO12(:)+QP11(:)
  26233       QNRBG(3,3,:)= 2. *QP12(:)
  26234       QNRBG(3,4,:)=     QP22(:)
  26235 
  26236       DO K=1,4
  26237          DO I=2,4
  26238             QNRBG(I,3,K)=QNRBG(3,3,K)
  26239          ENDDO
  26240          DO I=1,5
  26241             QNRBG(I,4,K)=QNRBG(3,4,K)
  26242          ENDDO
  26243       ENDDO
  26244 C
  26245 C     FOR BOUNDARY NODES
  26246       ZN11=4.*CBCBF(1)
  26247       ZN12=4.*CBCBF(2)
  26248       ZNX1=4.*CBCBF(3)
  26249       ZNX2=4.*CBCBF(4)
  26250 C
  26251       DO 22 K=1,4
  26252       QNRBG(1,1,K)=QO11(K)+QO22(K)+ZN11*(2.*QO12(K)+ZN11*QO22(K))
  26253       QNRBG(1,2,K)=QP11(K)+QO12(K)+ZN12*(QO12(K)+ZN11*QO22(K))
  26254      1             +ZN11*QP12(K)
  26255       QNRBG(1,3,K)=2.*QP12(K)+ZN11*QP22(K)
  26256       QNRBG(2,1,K)=2.*QO11(K)+QO22(K)+ZN12*(2.*QP12(K)+ZN12*QO22(K))
  26257       QNRBG(2,2,K)=2.*QO12(K)+QP11(K)+ZN12*QP22(K)
  26258       QNRBG(4,1,K)=2.*QO11(K)+QO22(K)+ZNX2*(2.*QP12(K)+ZNX2*QO22(K))
  26259       QNRBG(4,2,K)=2.*QO12(K)+QP11(K)+ZNX2*QP22(K)
  26260       QNRBG(5,1,K)=QO11(K)+QO22(K)+ZNX1*(2.*QO12(K)+ZNX1*QO22(K))
  26261       QNRBG(5,2,K)=QP11(K)+QO12(K)+ZNX2*(QO12(K)+ZNX1*QO22(K))
  26262      1             +ZNX1*QP12(K)
  26263       QNRBG(5,3,K)= 2.*QP12(K)+ZNX1*QP22(K)
  26264    22 CONTINUE
  26265 C
  26266 C     ** MULTIPLY DC-FACTORS **
  26267 C
  26268       DO K=2,4
  26269       KK=2*(K-1)
  26270       Z2=YSDCPI**KK
  26271       DO J=1,4
  26272       DO I=1,5
  26273       QNRBG(I,J,K)=Z2*QNRBG(I,J,K)
  26274       ENDDO
  26275       ENDDO
  26276       ENDDO
  26277 C
  26278       RETURN

Page 760         Source Listing                  SL1QBG
2017-04-18 11:09                                 syndata.f

  26279 
  26280       END


ENTRY POINTS

  Name               
                     
 sl1qbg_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 22                         Label  26264                                                          26251                             
 CBCBF                      Scalar 26199    R(4)            4     1     4        COM              26246,26247,26248,26249           
 DY0                        Scalar 26199    R(4)            4           scalar   COM                                                
 DY1                        Scalar 26199    R(4)            4           scalar   COM                                                
 DY2                        Scalar 26199    R(4)            4           scalar   COM                                                
 I                          Local  26237    I(4)            4           scalar                    26237,26238,26240,26241,26272,2627
                                                                                                  3                                 
 J                          Local  26271    I(4)            4           scalar                    26271,26273                       
 K                          Local  26236    I(4)            4           scalar                    26236,26238,26241,26251,26252,2625
                                                                                                  3,26254,26255,26256,26257,26258,26
                                                                                                  259,26260,26261,26262,26263,26268,
                                                                                                  26269,26273                       
 KK                         Local  26269    I(4)            4           scalar                    26269,26270                       
 QNRBG                      Scalar 26201    R(4)            4     3     80       COM              26231,26232,26233,26234,26238,2624
                                                                                                  1,26252,26253,26255,26256,26257,26
                                                                                                  258,26259,26260,26261,26263,26273 
 QO11                       Local  26217    R(4)            4     1     4                         26219,26231,26252,26256,26258,2626
                                                                                                  0                                 
 QO12                       Local  26217    R(4)            4     1     4                         26220,26232,26252,26253,26257,2625
                                                                                                  9,26260,26261                     
 QO22                       Local  26217    R(4)            4     1     4                         26221,26231,26252,26253,26256,2625
                                                                                                  8,26260,26261                     
 QP11                       Local  26217    R(4)            4     1     4                         26222,26232,26253,26257,26259,2626
                                                                                                  1                                 
 QP12                       Local  26217    R(4)            4     1     4                         26223,26233,26254,26255,26256,2625
                                                                                                  8,26262,26263                     
 QP22                       Local  26217    R(4)            4     1     4                         26224,26234,26255,26257,26259,2626
                                                                                                  3                                 
 S1BCDC                     Common 26199                                32                                                          
 S1QRBG                     Common 26201                                320                                                         
 SL1QBG                     Subr   26197                                                                                            
 YSDCPI                     Scalar 26199    R(4)            4           scalar   COM              26270                             
 Z2                         Local  26270    R(4)            4           scalar                    26270,26273                       
 ZN11                       Local  26246    R(4)            4           scalar                    26246,26252,26253,26254,26255     
 ZN12                       Local  26247    R(4)            4           scalar                    26247,26253,26256,26257           
 ZNX1                       Local  26248    R(4)            4           scalar                    26248,26260,26261,26262,26263     
 ZNX2                       Local  26249    R(4)            4           scalar                    26249,26258,26259,26261           

Page 761         Source Listing                  SL1QBG
2017-04-18 11:09                                 syndata.f

  26281 
  26282 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26283 C                .      .    .                                       .
  26284 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26285 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26286 C
  26287 C ABSTRACT: ??????????????????????????????????????????????????????????
  26288 C   ??????????????????????????????????????????????????????????????????
  26289 C
  26290 C PROGRAM HISTORY LOG:
  26291 C ????-??-??  S. J. LORD
  26292 C
  26293 C USAGE:    CALL ????????(????)
  26294 C   INPUT ARGUMENT LIST:
  26295 C     ??????   - ???????????????????????????????????????????????
  26296 C
  26297 C   OUTPUT ARGUMENT LIST:
  26298 C     ??????   - ???????????????????????????????????????????????
  26299 C
  26300 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26301 C     ??????   - ???????????????????????????????????????????????
  26302 C
  26303 C   OUTPUT FILES:
  26304 C     ??????   - ???????????????????????????????????????????????
  26305 C
  26306 C REMARKS: ?????????????????????????????????????????????????????
  26307 C
  26308 C ATTRIBUTES:
  26309 C   LANGUAGE: FORTRAN 90
  26310 C   MACHINE:  NCEP WCOSS
  26311 C
  26312 C$$$
  26313       SUBROUTINE SL1ADQ(PNMR)
  26314 C
  26315 C
  26316       PARAMETER (NDIM=71)
  26317 C
  26318       COMMON /S1PRIC/ NX,KDCTYP,KBCTYP(2),YN1,YNXX,YDCWL,
  26319      1        YBCWL(2),IDSPC
  26320       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  26321 C
  26322       COMMON /S1QRBG/ QNRBG(5,4,4)
  26323       COMMON /S1MACQ/ NXX1,NX1,NX2,NX3
  26324       CHARACTER*125 IDSPC
  26325 C
  26326       DIMENSION PNMR(NDIM,4)
  26327       DIMENSION QNMG(5,4)
  26328 C
  26329       QNMG=0.
  26330 C
  26331 C
  26332 C     ** TEST KDCTYP   === TYPE 2 AND 3 ARE PRESENTLY ALLOWED ===
  26333 C
  26334       IF(KDCTYP-2.LT.0) THEN
  26335          GO TO 90
  26336       ELSE  IF(KDCTYP-2.EQ.0) THEN
  26337          GO TO 50

Page 762         Source Listing                  SL1ADQ
2017-04-18 11:09                                 syndata.f

  26338       END IF
  26339 C
  26340 C     THIRD ORDER CONSTRAINT ... KDCTYP=3
  26341 C
  26342 C     SYMMETRIC BODY TERMS
  26343 
  26344       QNMG=QNRBG(:,:,4)
  26345 C
  26346 C
  26347 C     ** ADD QNMG TO PNMR
  26348 C
  26349    40 CONTINUE
  26350       DO NR=1,4
  26351          DO N=1,2
  26352             PNMR(N,NR)=PNMR(N,NR)+QNMG(N,NR)
  26353          ENDDO
  26354          DO N=3,NX2
  26355             PNMR(N,NR)=PNMR(N,NR)+QNMG(3,NR)
  26356          ENDDO
  26357       ENDDO
  26358       DO N=NX1,NXX
  26359          NRX=NXX1-N
  26360          DO NR=1,NRX
  26361             PNMR(N,NR)=PNMR(N,NR)+QNMG(NR+5-NRX,NR)
  26362          ENDDO
  26363       ENDDO
  26364 C
  26365       RETURN
  26366 C
  26367 C
  26368 C     SECOND ORDER CONSTRAINT ... KDCTYP=2
  26369 C
  26370    50 CONTINUE
  26371 
  26372       QNMG=QNRBG(:,:,3)
  26373 
  26374       GO TO 40
  26375 C
  26376 C
  26377    90 WRITE(6,890) KDCTYP
  26378   890 FORMAT(/' === SL1ADQ DOES NOT ACCEPT   KDCTYP=',I2)
  26379       CALL ABRT1(' SL1ADQ',890)
  26380 C
  26381       END

Page 763         Source Listing                  SL1ADQ
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sl1adq_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 40                         Label  26349                                                          26374                             
 50                         Label  26370                                                          26337                             
 890                        Label  26378                                                          26377                             
 90                         Label  26377                                                          26335                             
 ABRT1                      Subr   26379                                                          26379                             
 DYN                        Scalar 26320    R(4)            4           scalar   COM                                                
 IDSPC                      Scalar 26319    CHAR            125         scalar   COM                                                
 KBCTYP                     Scalar 26318    I(4)            4     1     2        COM                                                
 KDCTYP                     Scalar 26318    I(4)            4           scalar   COM              26334,26336,26377                 
 N                          Local  26351    I(4)            4           scalar                    26351,26352,26354,26355,26358,2635
                                                                                                  9,26361                           
 NDIM                       Param  26316    I(4)            4           scalar                    26320,26326                       
 NR                         Local  26350    I(4)            4           scalar                    26350,26352,26355,26360,26361     
 NRX                        Local  26359    I(4)            4           scalar                    26359,26360,26361                 
 NX                         Scalar 26318    I(4)            4           scalar   COM                                                
 NX1                        Scalar 26323    I(4)            4           scalar   COM              26358                             
 NX2                        Scalar 26323    I(4)            4           scalar   COM              26354                             
 NX3                        Scalar 26323    I(4)            4           scalar   COM                                                
 NXX                        Scalar 26320    I(4)            4           scalar   COM              26358                             
 NXX1                       Scalar 26323    I(4)            4           scalar   COM              26359                             
 PNMR                       Dummy  26313    R(4)            4     2     284      ARG,INOUT        26352,26355,26361                 
 QNMG                       Local  26327    R(4)            4     2     20                        26329,26344,26352,26355,26361,2637
                                                                                                  2                                 
 QNRBG                      Scalar 26322    R(4)            4     3     80       COM              26344,26372                       
 S1MACQ                     Common 26323                                16                                                          
 S1NODE                     Common 26320                                292                                                         
 S1PRIC                     Common 26318                                161                                                         
 S1QRBG                     Common 26322                                320                                                         
 SL1ADQ                     Subr   26313                                                                                            
 YBCWL                      Scalar 26319    R(4)            4     1     2        COM                                                
 YDCWL                      Scalar 26318    R(4)            4           scalar   COM                                                
 YN                         Scalar 26320    R(4)            4     1     71       COM                                                
 YN1                        Scalar 26318    R(4)            4           scalar   COM                                                
 YNXX                       Scalar 26318    R(4)            4           scalar   COM                                                

Page 764         Source Listing                  SL1ADQ
2017-04-18 11:09                                 syndata.f

  26382 
  26383 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26384 C                .      .    .                                       .
  26385 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26386 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26387 C
  26388 C ABSTRACT: ??????????????????????????????????????????????????????????
  26389 C   ??????????????????????????????????????????????????????????????????
  26390 C
  26391 C PROGRAM HISTORY LOG:
  26392 C ????-??-??  S. J. LORD
  26393 C
  26394 C USAGE:    CALL ????????(????)
  26395 C   INPUT ARGUMENT LIST:
  26396 C     ??????   - ???????????????????????????????????????????????
  26397 C
  26398 C   OUTPUT ARGUMENT LIST:
  26399 C     ??????   - ???????????????????????????????????????????????
  26400 C
  26401 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26402 C     ??????   - ???????????????????????????????????????????????
  26403 C
  26404 C   OUTPUT FILES:
  26405 C     ??????   - ???????????????????????????????????????????????
  26406 C
  26407 C REMARKS: ?????????????????????????????????????????????????????
  26408 C
  26409 C ATTRIBUTES:
  26410 C   LANGUAGE: FORTRAN 90
  26411 C   MACHINE:  NCEP WCOSS
  26412 C
  26413 C$$$
  26414       SUBROUTINE AD1EXX
  26415 C
  26416       PARAMETER (NDIM=71)
  26417       PARAMETER (KDTDIM=5)
  26418 ccccc PARAMETER (LDXDIM=2500)
  26419       PARAMETER (LDXDIM=8000)
  26420 C
  26421 C     DUMMY ARGUMENTS ARE NOW IN BLANK COMMON FOR VAX-11
  26422       COMMON // A(KDTDIM,NDIM),FD(KDTDIM,LDXDIM),FKMN(KDTDIM,NDIM),
  26423      1          AMM(NDIM,NDIM),DMM(NDIM,NDIM)
  26424 C
  26425 
  26426 C-----------------------------------------------------------------------
  26427 
  26428       ENTRY CL1ADE
  26429 C
  26430       CALL CL1ANS(AMM)
  26431       CALL CL1ANS(DMM)
  26432       RETURN
  26433 C
  26434 C
  26435 C
  26436 
  26437 C-----------------------------------------------------------------------
  26438 

Page 765         Source Listing                  AD1EXX
2017-04-18 11:09                                 syndata.f

  26439       ENTRY CA1DMM
  26440 C
  26441       CALL GT1AMR(AMM)
  26442 C
  26443       CALL NEG1NV(AMM,DMM)
  26444 C
  26445       RETURN
  26446 C
  26447       END


ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 ad1exx_               ca1dmm_               cl1ade_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                            Common 26423                                203168                                                      
 A                          Scalar 26422    R(4)            4     2     355      COM                                                
 AD1EXX                     Subr   26414                                                                                            
 AMM                        Scalar 26423    R(4)            4     2     5041     COM              26430,26441,26443                 
 CA1DMM                     Subr   26439                                                                                            
 CL1ADE                     Subr   26428                                                                                            
 CL1ANS                     Subr   26430                                                          26430,26431                       
 DMM                        Scalar 26423    R(4)            4     2     5041     COM              26431,26443                       
 FD                         Scalar 26422    R(4)            4     2     40000    COM                                                
 FKMN                       Scalar 26422    R(4)            4     2     355      COM                                                
 GT1AMR                     Subr   26441                                                          26441                             
 KDTDIM                     Param  26417    I(4)            4           scalar                    26422                             
 LDXDIM                     Param  26419    I(4)            4           scalar                    26422                             
 NDIM                       Param  26416    I(4)            4           scalar                    26422,26423                       
 NEG1NV                     Subr   26443                                                          26443                             

Page 766         Source Listing                  AD1EXX
2017-04-18 11:09                                 syndata.f

  26448 
  26449 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26450 C                .      .    .                                       .
  26451 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26452 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26453 C
  26454 C ABSTRACT: ??????????????????????????????????????????????????????????
  26455 C   ??????????????????????????????????????????????????????????????????
  26456 C
  26457 C PROGRAM HISTORY LOG:
  26458 C ????-??-??  S. J. LORD
  26459 C
  26460 C USAGE:    CALL ????????(????)
  26461 C   INPUT ARGUMENT LIST:
  26462 C     ??????   - ???????????????????????????????????????????????
  26463 C
  26464 C   OUTPUT ARGUMENT LIST:
  26465 C     ??????   - ???????????????????????????????????????????????
  26466 C
  26467 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26468 C     ??????   - ???????????????????????????????????????????????
  26469 C
  26470 C   OUTPUT FILES:
  26471 C     ??????   - ???????????????????????????????????????????????
  26472 C
  26473 C REMARKS: ?????????????????????????????????????????????????????
  26474 C
  26475 C ATTRIBUTES:
  26476 C   LANGUAGE: FORTRAN 90
  26477 C   MACHINE:  NCEP WCOSS
  26478 C
  26479 C$$$
  26480       SUBROUTINE PAS1XS(NXX,BR,BS,CS)
  26481 C
  26482 C     ** COLLECTION OF N-MATRIX ROUTINES FOR SPLEFSK
  26483 C
  26484 C     ** PASD1X MUST BE CALLED, ONCE FOR ALL,
  26485 C        BEFORE ANY ENTRIES, BELOW, ARE CALLED.
  26486 C
  26487 C
  26488 C  ++++++++ THE LIST OF N-MATRIX ROUTINES ++++++++
  26489 C
  26490 C    SUB NAMES   ENTRY NAMES            OPERATIONS
  26491 C
  26492 C     PASD1X     NRT1S0(BR,CS)          CS=   BR
  26493 C                NEG1NV(BS,CS)          CS=-INV(BS)
  26494 C
  26495 C     PASD1S     itself                 CS=AS*BS+CS
  26496 C                CL1ANS (CS)            CS=0.
  26497 C
  26498 C     PASD1R     AN1RTD (BR,CD)         CD=   BR
  26499 C                AN1TPD (BR,CD)         CD=TP(BR)
  26500 C
  26501 C         AS,BS,CS  NDIM*NDIM SQUARE MATRICES
  26502 C            BR,CR  NDIM*4 RECTANGLE MATRICES
  26503 C               CD  NDIM*7 RECTANGLE MATRICES (DOUBLE R)
  26504 C

Page 767         Source Listing                  PAS1XS
2017-04-18 11:09                                 syndata.f

  26505 C         CS,CR,CD  ARE ALWAYS THE OUTPUT
  26506 C         BS OR BR  MAY SHARE THE SAME ADDRESS WITH CS OR CR, RESPECTIVE
  26507 C               AS  MUST HAVE ITS OWN ADDRESS DIFFERENT FROM BS,BR,CS,OR
  26508 C
  26509 C     ** WORK SPACE IS PROVIDED LOCALLY FOR
  26510 C         ZD(NDIM,7) IN PASD1X
  26511 C         ZV(NDIM)   IN PASD1S
  26512 C
  26513 C     ** DO INDEX CONSTANTS ARE GENERATED IN /PASDCC/ BY PASD1X
  26514 C
  26515 C
  26516       PARAMETER (NDIM=71)
  26517 C
  26518 C     DUMMY ARGUMENTS
  26519       DIMENSION BS(NDIM,NDIM),CS(NDIM,NDIM),BSD(NDIM,NDIM)
  26520       DIMENSION BR(NDIM,4)   ,CSD(NDIM,NDIM)
  26521       DOUBLE PRECISION BSD,CSD,DET
  26522 C
  26523 C      LOCAL WORK SPACE
  26524       DIMENSION ZD(NDIM,7)
  26525 C
  26526       COMMON /PASDCC/ IXX,IX,IX1,IX2
  26527 C
  26528 C-----------------------------------------------------------------------
  26529 
  26530 C
  26531 C     ENTRY PASD1X(NXX)    ... MUST BE CALLED TO DEFINE DO INDEX CONSTAN
  26532 C
  26533       ENTRY PASD1X(NXX)
  26534       IXX=NXX
  26535       IX =IXX-1
  26536       IX1=IX-1
  26537       IX2=IX-2
  26538 C
  26539       IF(NXX.LE.NDIM) RETURN
  26540 C
  26541       WRITE(6,800) NXX,NDIM
  26542   800 FORMAT(/' === PASD1X FOUND NXX .GT. NDIM ===',3X,2I6)
  26543       CALL ABRT1(' PASD1X',800)
  26544 
  26545 C-----------------------------------------------------------------------
  26546 C
  26547       ENTRY NRT1S0(BR,CS)
  26548 C
  26549       CALL AN1RTD (BR,ZD)
  26550 C
  26551       DO I=1,IXX
  26552          CS(I,1:IXX)=0.
  26553          DO J=MAX(I-3,1),MIN(I+3,IXX)
  26554             CS(I,J)=ZD(I,J+4-I)
  26555          ENDDO
  26556       ENDDO
  26557       RETURN
  26558 
  26559 C-----------------------------------------------------------------------
  26560 C
  26561 C

Page 768         Source Listing                  PAS1XS
2017-04-18 11:09                                 syndata.f

  26562       ENTRY NEG1NV(BS,CS)
  26563 C
  26564 C     COPY BS INTO DOUBLE PRECISION ARRAY
  26565 C
  26566       BSD(1:IXX,1:IXX)=BS(1:IXX,1:IXX)
  26567 C
  26568       CALL INVMTX(BSD,NDIM,CSD,NDIM,IXX,DET,ZD,IER)
  26569 C
  26570       IF(IER.GT.1) GO TO 54
  26571 C
  26572       CS(1:IXX,1:IXX)=CSD(1:IXX,1:IXX)
  26573 
  26574       RETURN
  26575 C
  26576 C
  26577    54 WRITE(6,854) IER,DET
  26578   854 FORMAT(/' === NEG1NV/INVMTX FOUND BS TO BE SINGULAR.   IER=',I2,
  26579      1    3X,D12.3)
  26580       CALL ABRT1(' NEG1NV',854)
  26581 C
  26582       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 neg1nv_               nrt1s0_               pas1xs_               pasd1x_             

Page 769         Source Listing                  PAS1XS
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 54                         Label  26577                                                          26570                             
 800                        Label  26542                                                          26541                             
 854                        Label  26578                                                          26577                             
 ABRT1                      Subr   26543                                                          26543,26580                       
 AN1RTD                     Subr   26549                                                          26549                             
 BR                         Dummy  26480    R(4)            4     2     284      ARG,INOUT        26549                             
 BS                         Dummy  26480    R(4)            4     2     5041     ARG,INOUT        26566                             
 BSD                        Local  26519    R(8)            8     2     5041                      26566,26568                       
 CS                         Dummy  26480    R(4)            4     2     5041     ARG,INOUT        26552,26554,26572                 
 CSD                        Local  26520    R(8)            8     2     5041                      26568,26572                       
 DET                        Local  26521    R(8)            8           scalar                    26568,26577                       
 I                          Local  26551    I(4)            4           scalar                    26551,26552,26553,26554           
 IER                        Local  26568    I(4)            4           scalar                    26568,26570,26577                 
 INVMTX                     Subr   26568                                                          26568                             
 IX                         Scalar 26526    I(4)            4           scalar   COM              26535,26536,26537                 
 IX1                        Scalar 26526    I(4)            4           scalar   COM              26536                             
 IX2                        Scalar 26526    I(4)            4           scalar   COM              26537                             
 IXX                        Scalar 26526    I(4)            4           scalar   COM              26534,26535,26551,26552,26553,2656
                                                                                                  6,26568,26572                     
 J                          Local  26553    I(4)            4           scalar                    26553,26554                       
 MAX                        Func   26553                                scalar                    26553                             
 MIN                        Func   26553                                scalar                    26553                             
 NDIM                       Param  26516    I(4)            4           scalar                    26519,26520,26524,26539,26541,2656
                                                                                                  8                                 
 NEG1NV                     Subr   26562                                                                                            
 NRT1S0                     Subr   26547                                                                                            
 NXX                        Dummy  26480    I(4)            4           scalar   ARG,INOUT        26534,26539,26541                 
 PAS1XS                     Subr   26480                                                                                            
 PASD1X                     Subr   26533                                                                                            
 PASDCC                     Common 26526                                16                                                          
 ZD                         Local  26524    R(4)            4     2     497                       26549,26554,26568                 

Page 770         Source Listing                  PAS1XS
2017-04-18 11:09                                 syndata.f

  26583 
  26584 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26585 C                .      .    .                                       .
  26586 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26587 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26588 C
  26589 C ABSTRACT: ??????????????????????????????????????????????????????????
  26590 C   ??????????????????????????????????????????????????????????????????
  26591 C
  26592 C PROGRAM HISTORY LOG:
  26593 C ????-??-??  S. J. LORD
  26594 C
  26595 C USAGE:    CALL ????????(????)
  26596 C   INPUT ARGUMENT LIST:
  26597 C     ??????   - ???????????????????????????????????????????????
  26598 C
  26599 C   OUTPUT ARGUMENT LIST:
  26600 C     ??????   - ???????????????????????????????????????????????
  26601 C
  26602 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26603 C     ??????   - ???????????????????????????????????????????????
  26604 C
  26605 C   OUTPUT FILES:
  26606 C     ??????   - ???????????????????????????????????????????????
  26607 C
  26608 C REMARKS: ?????????????????????????????????????????????????????
  26609 C
  26610 C ATTRIBUTES:
  26611 C   LANGUAGE: FORTRAN 90
  26612 C   MACHINE:  NCEP WCOSS
  26613 C
  26614 C$$$
  26615       SUBROUTINE CL1ANS (CS)
  26616 C
  26617       PARAMETER (NDIM=71)
  26618 C
  26619       DIMENSION CS(NDIM,NDIM)
  26620 C
  26621       COMMON /PASDCC/ IXX,IX,IX1,IX2
  26622 C
  26623       CS(1:IXX,1:IXX)=0.
  26624 
  26625       RETURN
  26626 
  26627       END

Page 771         Source Listing                  CL1ANS
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 cl1ans_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CL1ANS                     Subr   26615                                                                                            
 CS                         Dummy  26615    R(4)            4     2     5041     ARG,INOUT        26623                             
 IX                         Scalar 26621    I(4)            4           scalar   COM                                                
 IX1                        Scalar 26621    I(4)            4           scalar   COM                                                
 IX2                        Scalar 26621    I(4)            4           scalar   COM                                                
 IXX                        Scalar 26621    I(4)            4           scalar   COM              26623                             
 NDIM                       Param  26617    I(4)            4           scalar                    26619                             
 PASDCC                     Common 26621                                16                                                          

Page 772         Source Listing                  CL1ANS
2017-04-18 11:09                                 syndata.f

  26628 
  26629 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26630 C                .      .    .                                       .
  26631 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26632 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26633 C
  26634 C ABSTRACT: ??????????????????????????????????????????????????????????
  26635 C   ??????????????????????????????????????????????????????????????????
  26636 C
  26637 C PROGRAM HISTORY LOG:
  26638 C ????-??-??  S. J. LORD
  26639 C
  26640 C USAGE:    CALL ????????(????)
  26641 C   INPUT ARGUMENT LIST:
  26642 C     ??????   - ???????????????????????????????????????????????
  26643 C
  26644 C   OUTPUT ARGUMENT LIST:
  26645 C     ??????   - ???????????????????????????????????????????????
  26646 C
  26647 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26648 C     ??????   - ???????????????????????????????????????????????
  26649 C
  26650 C   OUTPUT FILES:
  26651 C     ??????   - ???????????????????????????????????????????????
  26652 C
  26653 C REMARKS: ?????????????????????????????????????????????????????
  26654 C
  26655 C ATTRIBUTES:
  26656 C   LANGUAGE: FORTRAN 90
  26657 C   MACHINE:  NCEP WCOSS
  26658 C
  26659 C$$$
  26660       SUBROUTINE PASD1R(BR,CD)
  26661 C
  26662       PARAMETER (NDIM=71)
  26663 C
  26664 C     DUMMY ARGUMENTS
  26665       DIMENSION BR(NDIM,4),CD(NDIM,7)
  26666 C
  26667       COMMON /PASDCC/ IXX,IX,IX1,IX2
  26668 C
  26669 
  26670 C-----------------------------------------------------------------------
  26671 
  26672 C
  26673       ENTRY AN1RTD (BR,CD)
  26674 C
  26675       lgo = 16
  26676 C
  26677 C      EXPAND BR TO DOUBLE RECTANGLE ARRAY, CD(NDIM,7)
  26678 C     ** THE UN-USED CORNERS OF CD ARE NOT CLEARED.
  26679 C
  26680    10 CONTINUE
  26681       CD(1:IXX,4:7)=BR(1:IXX,:)
  26682 C
  26683       DO J=1,3
  26684          DO I=5-J,IXX

Page 773         Source Listing                  PASD1R
2017-04-18 11:09                                 syndata.f

  26685             CD(I,J)=BR(I+J-4,5-J)
  26686          ENDDO
  26687       ENDDO
  26688 C
  26689       if(lgo.eq.16)  then
  26690          go to 16
  26691       else  if(lgo.eq.18)  then
  26692          go to 18
  26693       else
  26694          call ABRT1(' AN1RTD',16)
  26695       endif
  26696 C
  26697 C     ADD OR SUBTRACT ANTISYMMETRIC TERMS
  26698    16 CD(1,5)=CD(1,5)+CD(IXX,6)
  26699       CD(2,3)=CD(2,3)-CD(IXX,6)
  26700       CD(IXX-1,5)=CD(IXX-1,5)+CD(IXX-1,7)
  26701       CD(IXX  ,3)=CD(IXX  ,3)-CD(IXX-1,7)
  26702       RETURN
  26703 
  26704 C-----------------------------------------------------------------------
  26705 
  26706 C
  26707 C
  26708       ENTRY AN1TPD (BR,CD)
  26709 C
  26710       lgo = 18
  26711       GO TO 10
  26712 C
  26713 C      REVERSE THE SIGN OF ANTISYMMETRIC TERMS (TRANSPOSE)
  26714    18 CD(IXX  ,6)=-CD(IXX  ,6)
  26715       CD(IXX-1,7)=-CD(IXX-1,7)
  26716       GO TO 16
  26717 
  26718 C-----------------------------------------------------------------------
  26719       END

Page 774         Source Listing                  PASD1R
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name                  Name                  Name               
                                                                 
 an1rtd_               an1tpd_               pasd1r_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  26680                                                          26711                             
 16                         Label  26698                                                          26690,26716                       
 18                         Label  26714                                                          26692                             
 ABRT1                      Subr   26694                                                          26694                             
 AN1RTD                     Subr   26673                                                                                            
 AN1TPD                     Subr   26708                                                                                            
 BR                         Dummy  26660    R(4)            4     2     284      ARG,INOUT        26681,26685                       
 CD                         Dummy  26660    R(4)            4     2     497      ARG,INOUT        26681,26685,26698,26699,26700,2670
                                                                                                  1,26714,26715                     
 I                          Local  26684    I(4)            4           scalar                    26684,26685                       
 IX                         Scalar 26667    I(4)            4           scalar   COM                                                
 IX1                        Scalar 26667    I(4)            4           scalar   COM                                                
 IX2                        Scalar 26667    I(4)            4           scalar   COM                                                
 IXX                        Scalar 26667    I(4)            4           scalar   COM              26681,26684,26698,26699,26700,2670
                                                                                                  1,26714,26715                     
 J                          Local  26683    I(4)            4           scalar                    26683,26684,26685                 
 LGO                        Local  26675    I(4)            4           scalar                    26675,26689,26691,26710           
 NDIM                       Param  26662    I(4)            4           scalar                    26665                             
 PASD1R                     Subr   26660                                                                                            
 PASDCC                     Common 26667                                16                                                          

Page 775         Source Listing                  PASD1R
2017-04-18 11:09                                 syndata.f

  26720 
  26721 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26722 C                .      .    .                                       .
  26723 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26724 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26725 C
  26726 C ABSTRACT: ??????????????????????????????????????????????????????????
  26727 C   ??????????????????????????????????????????????????????????????????
  26728 C
  26729 C PROGRAM HISTORY LOG:
  26730 C ????-??-??  S. J. LORD
  26731 C
  26732 C USAGE:    CALL ????????(????)
  26733 C   INPUT ARGUMENT LIST:
  26734 C     ??????   - ???????????????????????????????????????????????
  26735 C
  26736 C   OUTPUT ARGUMENT LIST:
  26737 C     ??????   - ???????????????????????????????????????????????
  26738 C
  26739 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26740 C     ??????   - ???????????????????????????????????????????????
  26741 C
  26742 C   OUTPUT FILES:
  26743 C     ??????   - ???????????????????????????????????????????????
  26744 C
  26745 C REMARKS: ?????????????????????????????????????????????????????
  26746 C
  26747 C ATTRIBUTES:
  26748 C   LANGUAGE: FORTRAN 90
  26749 C   MACHINE:  NCEP WCOSS
  26750 C
  26751 C$$$
  26752 C.                SL1MBO **   11/20/84
  26753 C     ++ ASSUMED DIM PARAMETERS ... NDIM=71, LDXDIM=8000,
  26754 C                               ... KDTDIM=5
  26755 C
  26756 C
  26757       SUBROUTINE SL1MBO(KP1,KP2)
  26758 C
  26759 C     ** NODAL SPLINE AMPLITUDES A(K,N) FROM DATA FD(K,L)**
  26760 C
  26761 C
  26762       PARAMETER (NDIM=71)
  26763 ccccc PARAMETER (LDXDIM=2500)
  26764       PARAMETER (LDXDIM=8000)
  26765       PARAMETER (KDTDIM=5)
  26766 C
  26767 C     ** SECONDARY PARAMETERS FOR COMPILATION
  26768 C
  26769 C     ** DUMMY ARGUMENTS
  26770 C
  26771 C      DIMENSION FD(KDTDIM,LDXDIM),A(KDTDIM,NDIM)
  26772 C
  26773 C
  26774 C              FD(K,L)   K-TH COMPONENT OF FIELD DATA AT LOCATION L
  26775 C              KP1       FIRST COMPONENT K TO BE PROCESSED
  26776 C              KP2       LAST  COMPONENT K TO BE PROCESSED

Page 776         Source Listing                  SL1MBO
2017-04-18 11:09                                 syndata.f

  26777 C
  26778 C     OUTPUT   A(K,N)  NODAL AMPLITUDE OF K-TH COMPONENT AT NODE N
  26779 C
  26780 C
  26781 C
  26782 C        $$ SL1OVR WAS CALLED TO DEFINE CONSTANTS IN SEVERAL COMMONS
  26783 C
  26784 C        $$ DATA POINTS WERE DEFINED IN /S1DTPT/ INCLUDING WEIGHTS
  26785 C
  26786 C     ** EXPLICITLY REQUIRED COMMONS
  26787 C
  26788       COMMON // A(KDTDIM,NDIM),FD(KDTDIM,LDXDIM),FKMN(KDTDIM,NDIM),
  26789      1          AMM(NDIM,NDIM),DMM(NDIM,NDIM)
  26790 C
  26791       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  26792       COMMON/S1DTPT/IDSPD1,IDSPD2,LDX,YD(LDXDIM),WD(LDXDIM),
  26793      1               LXSORT(LDXDIM)
  26794 C
  26795       CHARACTER*8 IDSPD1,IDSPD2*72
  26796 C
  26797 C     ** LOCAL WORK SPACE
  26798 C
  26799       DIMENSION ZV(NDIM,KDTDIM)
  26800 C
  26801 C
  26802 c && 4 comments
  26803 CC    IZERO = 0
  26804 CC    INSEC = ISECND(IZERO)
  26805 CC    WRITE(6,800) INSEC
  26806 CC800 FORMAT(/' === SL1MBO BEGINS ===',T91,'SECOND=',I6)
  26807 C
  26808 C
  26809       KA=MIN(KP1,KP2)
  26810       KB=MAX(KP1,KP2)
  26811       IF(KB.GT.KDTDIM) GO TO 90
  26812 C
  26813       A(KA:KB,1:NXX)=0.
  26814 C
  26815 C
  26816 C     ** CONSTANTS FOR CONVENIENCE
  26817       YN1=YN(1)
  26818       DY0=1./DYN
  26819 C
  26820 C
  26821 C     ** CONVERSION OF DISCRETE FIELD DATA TO NODAL FORCING **
  26822 C
  26823       DO18 L=1,LDX
  26824 C
  26825       IF(WD(L).LE.0) GO TO 18
  26826       NA=MAX(INT((YD(L)-YN1)*DY0),1)
  26827       NB=MIN(NA+3,NXX)
  26828 C
  26829       DO N=NA,NB
  26830          WMN=Y1BF(N,YD(L))*MIN(WD(L),1.0)
  26831          DO K=KA,KB
  26832             A(K,N)=A(K,N)+WMN*FD(K,L)
  26833          ENDDO

Page 777         Source Listing                  SL1MBO
2017-04-18 11:09                                 syndata.f

  26834       ENDDO
  26835 C
  26836    18 CONTINUE
  26837 C
  26838 C
  26839 C     ** CONVERSION OF NODAL FORCING TO NODAL AMPLITUDES **
  26840 C       +++ WE RETURN TO THE RIGHT-HANDED FORCING +++
  26841 C       +++ THE LEFT-HANDED CONVENTION IN PLIB SPLEND IS NOT USED +++
  26842 C
  26843 C
  26844       DO K=KA,KB
  26845          ZV(1:NXX,K)=0.0
  26846          DO I=1,NXX
  26847             DO J=1,NXX
  26848                ZV(I,K)=ZV(I,K)+DMM(I,J)*A(K,J)
  26849             ENDDO
  26850          ENDDO
  26851       ENDDO
  26852       DO K=KA,KB
  26853          DO N=1,NXX
  26854             A(K,N)=ZV(N,K)
  26855          ENDDO
  26856       ENDDO
  26857 C
  26858 c && 3 comments
  26859 CC    IDELTA = ISECND(INSEC)
  26860 CC    WRITE(6,880) IDELTA
  26861 CC880 FORMAT(' === SL1MBO DONE ===',T91,'ELAPSED TIME=',I6)
  26862 C
  26863       RETURN
  26864 C
  26865 C     ** ERROR EXIT
  26866 C
  26867    90 WRITE(6,890) KP1,KP2,KDTDIM
  26868   890 FORMAT(/' === SL1MBO FOUND THE COMPONENT RANGE  K=',I2,',',I2,
  26869      1       '  EXCEEDED  KDTDIM=',I2)
  26870       CALL ABRT1(' SL1MBO',890)
  26871       END

Page 778         Source Listing                  SL1MBO
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 sl1mbo_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                            Common 26789                                203168                                                      
 18                         Label  26836                                                          26823,26825                       
 890                        Label  26868                                                          26867                             
 90                         Label  26867                                                          26811                             
 A                          Scalar 26788    R(4)            4     2     355      COM              26813,26832,26848,26854           
 ABRT1                      Subr   26870                                                          26870                             
 AMM                        Scalar 26789    R(4)            4     2     5041     COM                                                
 DMM                        Scalar 26789    R(4)            4     2     5041     COM              26848                             
 DY0                        Local  26818    R(4)            4           scalar                    26818,26826                       
 DYN                        Scalar 26791    R(4)            4           scalar   COM              26818                             
 FD                         Scalar 26788    R(4)            4     2     40000    COM              26832                             
 FKMN                       Scalar 26788    R(4)            4     2     355      COM                                                
 I                          Local  26846    I(4)            4           scalar                    26846,26848                       
 IDSPD1                     Scalar 26792    CHAR            8           scalar   COM                                                
 IDSPD2                     Scalar 26792    CHAR            72          scalar   COM                                                
 INT                        Func   26826                                scalar                    26826                             
 J                          Local  26847    I(4)            4           scalar                    26847,26848                       
 K                          Local  26831    I(4)            4           scalar                    26831,26832,26844,26845,26848,2685
                                                                                                  2,26854                           
 KA                         Local  26809    I(4)            4           scalar                    26809,26813,26831,26844,26852     
 KB                         Local  26810    I(4)            4           scalar                    26810,26811,26813,26831,26844,2685
                                                                                                  2                                 
 KDTDIM                     Param  26765    I(4)            4           scalar                    26788,26799,26811,26867           
 KP1                        Dummy  26757    I(4)            4           scalar   ARG,INOUT        26809,26810,26867                 
 KP2                        Dummy  26757    I(4)            4           scalar   ARG,INOUT        26809,26810,26867                 
 L                          Local  26823    I(4)            4           scalar                    26823,26825,26826,26830,26832     
 LDX                        Scalar 26792    I(4)            4           scalar   COM              26823                             
 LDXDIM                     Param  26764    I(4)            4           scalar                    26788,26792,26793                 
 LXSORT                     Scalar 26793    I(4)            4     1     8000     COM                                                
 MAX                        Func   26810                                scalar                    26810,26826                       
 MIN                        Func   26809                                scalar                    26809,26827,26830                 
 N                          Local  26829    I(4)            4           scalar                    26829,26830,26832,26853,26854     
 NA                         Local  26826    I(4)            4           scalar                    26826,26827,26829                 
 NB                         Local  26827    I(4)            4           scalar                    26827,26829                       
 NDIM                       Param  26762    I(4)            4           scalar                    26788,26789,26791,26799           
 NXX                        Scalar 26791    I(4)            4           scalar   COM              26813,26827,26845,26846,26847,2685
                                                                                                  3                                 
 S1DTPT                     Common 26792                                96084                                                       
 S1NODE                     Common 26791                                292                                                         
 SL1MBO                     Subr   26757                                                                                            
 WD                         Scalar 26792    R(4)            4     1     8000     COM              26825,26830                       
 WMN                        Local  26830    R(4)            4           scalar                    26830,26832                       
 Y1BF                       Func   26830    R(4)            4           scalar                    26830                             
 YD                         Scalar 26792    R(4)            4     1     8000     COM              26826,26830                       

Page 779         Source Listing                  SL1MBO
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YN                         Scalar 26791    R(4)            4     1     71       COM              26817                             
 YN1                        Local  26817    R(4)            4           scalar                    26817,26826                       
 ZV                         Local  26799    R(4)            4     2     355                       26845,26848,26854                 

Page 780         Source Listing                  SL1MBO
2017-04-18 11:09                                 syndata.f

  26872 
  26873 
  26874 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  26875 C                .      .    .                                       .
  26876 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  26877 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  26878 C
  26879 C ABSTRACT: ??????????????????????????????????????????????????????????
  26880 C   ??????????????????????????????????????????????????????????????????
  26881 C
  26882 C PROGRAM HISTORY LOG:
  26883 C ????-??-??  S. J. LORD
  26884 C
  26885 C USAGE:    CALL ????????(????)
  26886 C   INPUT ARGUMENT LIST:
  26887 C     ??????   - ???????????????????????????????????????????????
  26888 C
  26889 C   OUTPUT ARGUMENT LIST:
  26890 C     ??????   - ???????????????????????????????????????????????
  26891 C
  26892 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  26893 C     ??????   - ???????????????????????????????????????????????
  26894 C
  26895 C   OUTPUT FILES:
  26896 C     ??????   - ???????????????????????????????????????????????
  26897 C
  26898 C REMARKS: ?????????????????????????????????????????????????????
  26899 C
  26900 C ATTRIBUTES:
  26901 C   LANGUAGE: FORTRAN 90
  26902 C   MACHINE:  NCEP WCOSS
  26903 C
  26904 C$$$
  26905       SUBROUTINE SP1LNT(A,KPA,F,KPFDIM,NFDIM,KPF,N1,N2,N3,ZYBF)
  26906 C
  26907 C
  26908 C
  26909       PARAMETER (NDIM=71)
  26910       PARAMETER (KDTDIM=5)
  26911 C
  26912 C     ** DUMMY ARGUMENTS
  26913 C
  26914 C     ** INPUT ... SPLINE AMPLITUDE
  26915       DIMENSION A(KDTDIM,NDIM)
  26916 C
  26917 C     ** OUTPUT ..
  26918       DIMENSION F(KPFDIM,NFDIM)
  26919 C
  26920 C     ** PARAMETER FOR THE LOCAL USE ... MAXIMUM DIVISIONS ALLOWED
  26921       PARAMETER (JXBFDM=8)
  26922 C
  26923 C     ** LOCAL ARRAYS ... BF TABLES
  26924       DIMENSION YB1(4,JXBFDM),YBN(4,JXBFDM),YBX(4,JXBFDM),YBXX(4)
  26925 C     ** LOCAL WORK SPACE
  26926       CHARACTER*7 KENTRY
  26927 C
  26928       COMMON /S1NODE/ NXX,DYN,YN(NDIM)

Page 781         Source Listing                  SP1LNT
2017-04-18 11:09                                 syndata.f

  26929       DATA KENTRY/' SP1LNT'/
  26930 C
  26931       SAVE
  26932 C
  26933 C-----------------------------------------------------------------------
  26934 
  26935       ENTRY SL1NTA(A,N1,N2,N3)
  26936       KENTRY = 'SL1NTA'
  26937 C
  26938 C
  26939 C       LOCALLY DEFINED
  26940       NX=NXX-1
  26941       NX1=NX-1
  26942       IF(NXX.GT.NDIM) GO TO 900
  26943 C
  26944 C     ** SET CONSTANTS FOR DEFINING THE AREA AND SUBDIVISIONS
  26945 C
  26946       NA=MIN(N1,N2)
  26947       NB=MAX(N1,N2)
  26948       JX=MAX(N3,1)
  26949       IF(NA.LT.1)   GO TO 901
  26950       IF(NB.GT.NXX) GO TO 901
  26951 C
  26952       IF(JX.GT.JXBFDM) GO TO 905
  26953 C
  26954 C
  26955       NAIL=MAX(NA,2)
  26956       NBIL1=MIN(NB,NX1)
  26957       NBIL2=MIN(NB-1,NX1)
  26958 C
  26959 C     ** MINIMUM DIMENSIONS REQUIRED OF THE OUTPUT FIELD
  26960 C
  26961       NFDIM0=JX*(NB-NA)+1
  26962 C
  26963 C     ** ROUTING DECISIONS
  26964 C
  26965       lgon1 = 120
  26966       lgonx = 150
  26967 C
  26968       IF(NA.EQ.1)   lgon1 = 110
  26969       IF(NB.EQ.NXX)  then
  26970          lgonx = 126
  26971       else  IF(NB.EQ.NX)  then
  26972          lgonx = 128
  26973       endif
  26974 C
  26975       RETURN
  26976 
  26977 C-----------------------------------------------------------------------
  26978 
  26979 C
  26980 C
  26981 C     ** INPUT ... THE SPLINE BASIS FUNCTIONS
  26982 C
  26983 C     ZXBF     XBF,DXBF, OR DDXBF
  26984 C     ZYBF     Y1BF,D1YBF, OR DD1YBF
  26985 C

Page 782         Source Listing                  SP1LNT
2017-04-18 11:09                                 syndata.f

  26986 C     ** ** ** WARNING ** ** **
  26987 C
  26988 C       THERE IS NO DEFAULT SETTING OF ZYBF.
  26989 C         SL1NTD MUST BE CALLED, AT LEAST ONCE, TO DEFINE THE BF TABLES
  26990 C
  26991 C     ** WARNING **
  26992 C       DO NOT SHORTCUT SL1NTD WITHIN THIS SUBROUTINE ALTHOUGH IT MAY
  26993 C       SEEM TO BE UNNECESSARY WHEN N3 IS UNCHANGED.
  26994 C
  26995 C       SINCE ZYBF MAY BE CHANGED, ONLY THE CALLING ROUTINE
  26996 C       CAN DETERMINE THE NEED OF CALLING SL1NTD ANEW.
  26997 C
  26998 C       SIMILARLY, THE TEST OF N3 BY SL1NTO IS NO GUARANTEE FOR
  26999 C       CORRECT BF TABLES, IF THERE WERE OMISSION OF CALLING SL1NTD.
  27000 C
  27001 C
  27002 
  27003 C-----------------------------------------------------------------------
  27004 
  27005       ENTRY SL1NTD(ZYBF)
  27006 C
  27007 C     ** SAVE THE CURRENT JX(=N3)
  27008       JXBF0=JX
  27009 C
  27010       DYNJ=DYN/REAL(JX)
  27011 C
  27012       DO 64 J=1,JX
  27013       YNJ=(J-1)*DYNJ
  27014 C
  27015       DO ND=0,2
  27016          YB1(2+ND,J)=ZYBF(1+ND,YN(1)+YNJ)
  27017       ENDDO
  27018 C
  27019       DO ND=-1,2
  27020          YBN(2+ND,J)=ZYBF(3+ND,YN(3)+YNJ)
  27021       ENDDO
  27022 C
  27023       DO ND=-1,1
  27024          YBX(2+ND,J)=ZYBF(NX+ND,YN(NX)+YNJ)
  27025       ENDDO
  27026    64 CONTINUE
  27027 C
  27028       DO ND=-1,0
  27029          YBXX(2+ND)=ZYBF(NXX+ND,YN(NXX))
  27030       ENDDO
  27031 C
  27032       RETURN
  27033 
  27034 C-----------------------------------------------------------------------
  27035 
  27036       ENTRY SL1NTO(A,KPA,F,KPFDIM,NFDIM,KPF)
  27037       KENTRY = 'SL1NTO'
  27038 C
  27039       KA=KPA
  27040       KF=KPF
  27041 C
  27042 C     ** CHECK THE INPUT ARGUMENTS

Page 783         Source Listing                  SP1LNT
2017-04-18 11:09                                 syndata.f

  27043       IF(KPA.GT.KDTDIM) GO TO 902
  27044       IF(KPF.GT.KPFDIM) GO TO 910
  27045 C
  27046       IF(NFDIM.LT.NFDIM0) GO TO 910
  27047 C
  27048 C
  27049       IF(JX.NE.JXBF0) GO TO 920
  27050 
  27051       F(KF,:)=0.
  27052 C
  27053       DO 300 J=1,JX
  27054 C
  27055       IF(J-2.EQ.0) THEN
  27056          GO TO 102
  27057       ELSE  IF(J-2.GT.0) THEN
  27058          GO TO 103
  27059       END IF
  27060 C
  27061 C       ON THE N-NODES (J=1)
  27062       NDX=1
  27063       NBIL=NBIL1
  27064       GO TO 103
  27065 C
  27066 C       OFF-NODE FINE MSESH POINTS
  27067   102 NDX=2
  27068       NBIL=NBIL2
  27069 C
  27070   103 CONTINUE
  27071 C
  27072 C
  27073       if(lgon1.eq.110)  then
  27074          go to 110
  27075       else  if(lgon1.eq.120)  then
  27076          go to 120
  27077       else
  27078          call ABRT1(' SL1NTO',103)
  27079       endif
  27080 C
  27081 C       AT N=1. (FOR NA=1 ONLY)
  27082   110 CONTINUE
  27083       DO ND=0,NDX
  27084          F(KF,1)=A(KA,1+ND)*YB1(2+ND,J)+F(KF,1)
  27085       ENDDO
  27086 C
  27087 C       AT ALL N BETWEEN NAIL AND NBIL, BUT NBIL IS.LE. NX1
  27088 C         NOTE ... THE SECOND DO WILL NOT EXECUTE IF NAIL .GT. NBIL
  27089 C
  27090   120 CONTINUE
  27091       DO ND=-1,NDX
  27092       DO N=NAIL,NBIL
  27093          F(KF,N)=A(KA,N+ND)*YBN(2+ND,J)+F(KF,N)
  27094       ENDDO
  27095       ENDDO
  27096 C
  27097 C      CHECK THE LEFT LIMIT OF ACCUMULATION
  27098       if(lgonx.eq.126)  then
  27099          go to 126

Page 784         Source Listing                  SP1LNT
2017-04-18 11:09                                 syndata.f

  27100       else  if(lgonx.eq.128)  then
  27101          go to 128
  27102       else  if(lgonx.eq.150)  then
  27103          go to 150
  27104       else
  27105          call ABRT1(' SL1NTO',126)
  27106       endif
  27107   126 IF(J.EQ.1) GO TO 130
  27108       GO TO 140
  27109   128 IF(J.EQ.1) GO TO 140
  27110       GO TO 150
  27111 C
  27112 C       ONLY FOR J=1 AND NB=NXX
  27113   130 CONTINUE
  27114       DO ND=-1,0
  27115          F(KF,NXX)=A(KA,NXX+ND)*YBXX(2+ND)+F(KF,NXX)
  27116       ENDDO
  27117 C
  27118 C       FOR ALL J IF NB=NXX(ENTERS FROM 132)
  27119 C       ONLY FOR J=1 IF NB=NX
  27120 C
  27121   140 CONTINUE
  27122       DO ND=-1,1
  27123          F(KF,NX)=A(KA,NX+ND)*YBX(2+ND,J)+F(KF,NX)
  27124       ENDDO
  27125 C
  27126   150 CONTINUE
  27127 C
  27128 C
  27129   300 CONTINUE
  27130 C
  27131 C
  27132       RETURN
  27133 C
  27134 C
  27135 C     ** ERROR EXITS
  27136 C
  27137   900 WRITE(6,8900) NXX,NDIM
  27138  8900 FORMAT(/' === SL1NTA FOUND NXX TOO LARGE FOR NDIM'
  27139      1   ,5X,I5,5X,I5)
  27140       CALL ABRT1(KENTRY,8900)
  27141 C
  27142   901 WRITE(6,8901) N1,N2,NXX
  27143  8901 FORMAT(/' === SL1NTA INPUT ARGUMENTS N1,N2 ARE IN ERROR'
  27144      1    ,5X,I5,3X,I5,5X,'NXX IS',3X,I5)
  27145       CALL ABRT1(KENTRY,8901)
  27146 C
  27147   902 WRITE(6,8902) KPA,KDTDIM
  27148  8902 FORMAT(/' === SL1NTO ARGUMENT KPA IS TOO LARGE FOR KDTDIM',5X,2I3)
  27149       CALL ABRT1(KENTRY,8902)
  27150 C
  27151   905 WRITE(6,8905) N3,JXBFDM
  27152  8905 FORMAT(/' === SL1NTA INPUT ARGUMENTS N3 ARE TOO LARGE FOR '
  27153      1    ,'THE LOCAL PARAMETER JXBFDM',5X,I3,5X,I3)
  27154       CALL ABRT1(KENTRY,8905)
  27155 C
  27156   910 WRITE(6,8910) KPFDIM,NFDIM,NFDIM0

Page 785         Source Listing                  SP1LNT
2017-04-18 11:09                                 syndata.f

  27157  8910 FORMAT(/' === SL1NTO ARGUMENTS KPFDIM,NFDIM ARE TOO SMALL '
  27158      1   ,'FOR THE REQUIRED KPF,NFDIM0', 5X,I3,I5,5X,I3,I5)
  27159       CALL ABRT1(KENTRY,8910)
  27160 C
  27161   920 WRITE(6,8920) JX,JXBF0
  27162  8920 FORMAT(/' === SL1NTO FOUND N3 HAVE BEEN CHANGED SINCE THE '
  27163      1   ,'LAST CALL TO SL1NTD WAS MADE',5X,I3,5X,I3)
  27164       CALL ABRT1(KENTRY,8920)
  27165 C
  27166       END


ENTRY POINTS

  Name                  Name                  Name                  Name               
                                                                                       
 sl1nta_               sl1ntd_               sl1nto_               sp1lnt_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 102                        Label  27067                                                          27056                             
 103                        Label  27070                                                          27058,27064                       
 110                        Label  27082                                                          27074                             
 120                        Label  27090                                                          27076                             
 126                        Label  27107                                                          27099                             
 128                        Label  27109                                                          27101                             
 130                        Label  27113                                                          27107                             
 140                        Label  27121                                                          27108,27109                       
 150                        Label  27126                                                          27103,27110                       
 300                        Label  27129                                                          27053                             
 64                         Label  27026                                                          27012                             
 8900                       Label  27138                                                          27137                             
 8901                       Label  27143                                                          27142                             
 8902                       Label  27148                                                          27147                             
 8905                       Label  27152                                                          27151                             
 8910                       Label  27157                                                          27156                             
 8920                       Label  27162                                                          27161                             
 900                        Label  27137                                                          26942                             
 901                        Label  27142                                                          26949,26950                       
 902                        Label  27147                                                          27043                             
 905                        Label  27151                                                          26952                             
 910                        Label  27156                                                          27044,27046                       
 920                        Label  27161                                                          27049                             
 A                          Dummy  26905    R(4)            4     2     355      ARG,INOUT        27084,27093,27115,27123           
 ABRT1                      Subr   27078                                                          27078,27105,27140,27145,27149,2715
                                                                                                  4,27159,27164                     
 DYN                        Scalar 26928    R(4)            4           scalar   COM              27010                             
 DYNJ                       Local  27010    R(4)            4           scalar   SAVE             27010,27013                       
 F                          Dummy  26905    R(4)            4     2     0        ARG,INOUT        27051,27084,27093,27115,27123     
 J                          Local  27012    I(4)            4           scalar   SAVE             27012,27013,27016,27020,27024,2705
                                                                                                  3,27055,27057,27084,27093,27107,27
                                                                                                  109,27123                         
 JX                         Local  26948    I(4)            4           scalar   SAVE             26948,26952,26961,27008,27010,2701
                                                                                                  2,27049,27053,27161               

Page 786         Source Listing                  SP1LNT
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 JXBF0                      Local  27008    I(4)            4           scalar   SAVE             27008,27049,27161                 
 JXBFDM                     Param  26921    I(4)            4           scalar                    26924,26952,27151                 
 KA                         Local  27039    I(4)            4           scalar   SAVE             27039,27084,27093,27115,27123     
 KDTDIM                     Param  26910    I(4)            4           scalar                    26915,27043,27147                 
 KENTRY                     Local  26926    CHAR            7           scalar   SAVE             26929,26936,27037,27140,27145,2714
                                                                                                  9,27154,27159,27164               
 KF                         Local  27040    I(4)            4           scalar   SAVE             27040,27051,27084,27093,27115,2712
                                                                                                  3                                 
 KPA                        Dummy  26905    I(4)            4           scalar   ARG,INOUT        27039,27043,27147                 
 KPF                        Dummy  26905    I(4)            4           scalar   ARG,INOUT        27040,27044                       
 KPFDIM                     Dummy  26905    I(4)            4           scalar   ARG,INOUT        26918,27044,27156                 
 LGON1                      Local  26965    I(4)            4           scalar   SAVE             26965,26968,27073,27075           
 LGONX                      Local  26966    I(4)            4           scalar   SAVE             26966,26970,26972,27098,27100,2710
                                                                                                  2                                 
 MAX                        Func   26947                                scalar                    26947,26948,26955                 
 MIN                        Func   26946                                scalar                    26946,26956,26957                 
 N                          Local  27092    I(4)            4           scalar   SAVE             27092,27093                       
 N1                         Dummy  26905    I(4)            4           scalar   ARG,INOUT        26946,26947,27142                 
 N2                         Dummy  26905    I(4)            4           scalar   ARG,INOUT        26946,26947,27142                 
 N3                         Dummy  26905    I(4)            4           scalar   ARG,INOUT        26948,27151                       
 NA                         Local  26946    I(4)            4           scalar   SAVE             26946,26949,26955,26961,26968     
 NAIL                       Local  26955    I(4)            4           scalar   SAVE             26955,27092                       
 NB                         Local  26947    I(4)            4           scalar   SAVE             26947,26950,26956,26957,26961,2696
                                                                                                  9,26971                           
 NBIL                       Local  27063    I(4)            4           scalar   SAVE             27063,27068,27092                 
 NBIL1                      Local  26956    I(4)            4           scalar   SAVE             26956,27063                       
 NBIL2                      Local  26957    I(4)            4           scalar   SAVE             26957,27068                       
 ND                         Local  27015    I(4)            4           scalar   SAVE             27015,27016,27019,27020,27023,2702
                                                                                                  4,27028,27029,27083,27084,27091,27
                                                                                                  093,27114,27115,27122,27123       
 NDIM                       Param  26909    I(4)            4           scalar                    26915,26928,26942,27137           
 NDX                        Local  27062    I(4)            4           scalar   SAVE             27062,27067,27083,27091           
 NFDIM                      Dummy  26905    I(4)            4           scalar   ARG,INOUT        26918,27046,27156                 
 NFDIM0                     Local  26961    I(4)            4           scalar   SAVE             26961,27046,27156                 
 NX                         Local  26940    I(4)            4           scalar   SAVE             26940,26941,26971,27024,27123     
 NX1                        Local  26941    I(4)            4           scalar   SAVE             26941,26956,26957                 
 NXX                        Scalar 26928    I(4)            4           scalar   COM              26940,26942,26950,26969,27029,2711
                                                                                                  5,27137,27142                     
 REAL                       Func   27010                                scalar                    27010                             
 S1NODE                     Common 26928                                292      SAVE                                               
 SL1NTA                     Subr   26935                                                                                            
 SL1NTD                     Subr   27005                                                                                            
 SL1NTO                     Subr   27036                                                                                            
 SP1LNT                     Subr   26905                                                                                            
 YB1                        Local  26924    R(4)            4     2     32       SAVE             27016,27084                       
 YBN                        Local  26924    R(4)            4     2     32       SAVE             27020,27093                       
 YBX                        Local  26924    R(4)            4     2     32       SAVE             27024,27123                       
 YBXX                       Local  26924    R(4)            4     1     4        SAVE             27029,27115                       
 YN                         Scalar 26928    R(4)            4     1     71       COM              27016,27020,27024,27029           
 YNJ                        Local  27013    R(4)            4           scalar   SAVE             27013,27016,27020,27024           
 ZYBF                       Func   26905    R(4)            4           scalar   ARG,INOUT        27016,27020,27024,27029           

Page 787         Source Listing                  SP1LNT
2017-04-18 11:09                                 syndata.f

  27167 
  27168 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  27169 C                .      .    .                                       .
  27170 C SUBPROGRAM:    ????????    ?????????????????????????????????????????
  27171 C   PRGMMR: S. J. LORD       ORG: NP22       DATE: ????-??-??
  27172 C
  27173 C ABSTRACT: ??????????????????????????????????????????????????????????
  27174 C   ??????????????????????????????????????????????????????????????????
  27175 C
  27176 C PROGRAM HISTORY LOG:
  27177 C ????-??-??  S. J. LORD
  27178 C
  27179 C USAGE:    CALL ????????(????)
  27180 C   INPUT ARGUMENT LIST:
  27181 C     ??????   - ???????????????????????????????????????????????
  27182 C
  27183 C   OUTPUT ARGUMENT LIST:
  27184 C     ??????   - ???????????????????????????????????????????????
  27185 C
  27186 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  27187 C     ??????   - ???????????????????????????????????????????????
  27188 C
  27189 C   OUTPUT FILES:
  27190 C     ??????   - ???????????????????????????????????????????????
  27191 C
  27192 C REMARKS: ?????????????????????????????????????????????????????
  27193 C
  27194 C ATTRIBUTES:
  27195 C   LANGUAGE: FORTRAN 90
  27196 C   MACHINE:  NCEP WCOSS
  27197 C
  27198 C$$$
  27199       SUBROUTINE SP1TNO(Y,A,K,F)
  27200 C
  27201       PARAMETER (NDIM=71)
  27202       PARAMETER (KDTDIM=5)
  27203 C
  27204 C
  27205 C     ** ** SPOT INVERSE TRANSFORMATION OF A SINGLE SPLINE AMPLITUDE
  27206 C            TO F AT Y
  27207 C
  27208 C       Y        THE SPOT COORDINATE AT WHICH OUTPUT F IS DESIRED
  27209 C       A(K,N)   KTH COMPONET OF NODAL AMPLITUDE AT N
  27210 C       K        THE  COMPONENT OF THE AMPLITUDE
  27211 C       F        THE SPOT OUTPUT F.
  27212 C
  27213 C     ** DUMMY ARGUMENTS
  27214       DIMENSION A(KDTDIM,NDIM)
  27215 C
  27216       COMMON /S1NODE/ NXX,DYN,YN(NDIM)
  27217       EQUIVALENCE (YN(1),Y1)
  27218 C
  27219 C     ** LOCAL WORK SPACE
  27220       DIMENSION BN(4),ZN(4)
  27221 C
  27222 C
  27223       N0=MAX(INT((Y-Y1)/DYN),1)-1

Page 788         Source Listing                  SP1TNO
2017-04-18 11:09                                 syndata.f

  27224       N4=MIN(NXX-N0,4)
  27225 C
  27226       DO N=1,N4
  27227          BN(N)=Y1BF(N+N0,Y)
  27228       ENDDO
  27229 C
  27230       ZN=0.
  27231 C
  27232       DO N=1,N4
  27233          ZN(N)=ZN(N)+A(K,N+N0)*BN(N)
  27234       ENDDO
  27235 C
  27236       F=ZN(1)+ZN(2)+ZN(3)+ZN(4)
  27237 C
  27238       RETURN
  27239       END


ENTRY POINTS

  Name               
                     
 sp1tno_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  27199    R(4)            4     2     355      ARG,INOUT        27233                             
 BN                         Local  27220    R(4)            4     1     4                         27227,27233                       
 DYN                        Scalar 27216    R(4)            4           scalar   COM              27223                             
 F                          Dummy  27199    R(4)            4           scalar   ARG,INOUT        27236                             
 INT                        Func   27223                                scalar                    27223                             
 K                          Dummy  27199    I(4)            4           scalar   ARG,INOUT        27233                             
 KDTDIM                     Param  27202    I(4)            4           scalar                    27214                             
 MAX                        Func   27223                                scalar                    27223                             
 MIN                        Func   27224                                scalar                    27224                             
 N                          Local  27226    I(4)            4           scalar                    27226,27227,27232,27233           
 N0                         Local  27223    I(4)            4           scalar                    27223,27224,27227,27233           
 N4                         Local  27224    I(4)            4           scalar                    27224,27226,27232                 
 NDIM                       Param  27201    I(4)            4           scalar                    27214,27216                       
 NXX                        Scalar 27216    I(4)            4           scalar   COM              27224                             
 S1NODE                     Common 27216                                292                                                         
 SP1TNO                     Subr   27199                                                                                            
 Y                          Dummy  27199    R(4)            4           scalar   ARG,INOUT        27223,27227                       
 Y1                         Scalar 27217    R(4)            4           scalar   COM              27223                             
 Y1BF                       Func   27227    R(4)            4           scalar                    27227                             
 YN                         Scalar 27216    R(4)            4     1     71       COM                                                
 ZN                         Local  27220    R(4)            4     1     4                         27230,27233,27236                 

Page 789         Source Listing                  SP1TNO
2017-04-18 11:09                                 syndata.f

  27240 
  27241 
  27242 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  27243 C                .      .    .                                       .
  27244 C SUBPROGRAM:    SURPRP      SURVEYS INPUT PREPBUFR FILE FOR PMSL& WND
  27245 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2014-09-05
  27246 C
  27247 C ABSTRACT: SURVEYS THE INPUT PREPBUFR FILE, LOOKING FOR REPORTS FOR
  27248 C   ALL TYPES IN THE VICINITY OF THE TROPICAL STORM IN QUESTION.
  27249 C   IF A MASS REPORT IS FOUND, THEN THE SEA-LEVEL PRESSURE (EITHER
  27250 C   REPORTED OR CALCULATED) IS USED TO HELP GENERATE BOGUS DATA IN
  27251 C   THE VICINITY OF THE STORM.  IF A WIND REPORT IS FOUND, THEN THE
  27252 C   WIND ON ALL LEVELS IS USED IN THE SAME WAY. THIS SUBROUTINE CAN
  27253 C   PRINT OUT ALL QUALIFYING REPORTS (BASED ON MODPRT SWITCH).
  27254 C
  27255 C
  27256 C PROGRAM HISTORY LOG:
  27257 C ????-??-??  S. J. LORD - ORIGINAL AUTHOR
  27258 C 1999-06-28  D. A. KEYSER - MADE CODE MORE EFFICIENT BY SKIPPING
  27259 C        THE READING OF REPORTS OUT OF BUFR MESSAGES WHICH CAN'T
  27260 C        EVER PRODUCE A SEA-LEVEL PRESSURE OR WIND; CORRECTED ERROR
  27261 C        WHICH NEVER ALLOWED SURFACE MARINE SEA-LEVEL PRESSURE TO
  27262 C        BE USED HERE IN THE VICINITY OF STORM; CORRECTED AN ERROR
  27263 C        WHICH USUALLY LED TO 1000 MB PRESSURE/HEIGHT NOT BEING USED
  27264 C        HERE TO CALC. SEA-LEVEL PRESSURE IN THE VICINITY OF STORM;
  27265 C        NOW CHECKS QUALITY MARK OF PERTINENT VARIABLES IN BOTH
  27266 C        MEAN-SEA LEVEL PRESSURE PROCESSING AND WIND PROCESSING FOR
  27267 C        REPORTS IN THE VICINITY OF THE STORM, IF Q.M. IS BAD SKIPS
  27268 C        PROCESSING (NEVER CHECKED Q.M. BEFORE); CORRECTED ERROR
  27269 C        WHICH LED TO REPORT TIME MINUS CYCLE TIME BEING A FACTOR OF
  27270 C        100 TOO SMALL (RESULTED IN INCORRECT STORM ADJUSTMENT IN
  27271 C        SUBR. SURPRP); STREAMLINED CODE TO MAKE IT MORE EFFICIENT;
  27272 C        ADDED DOCBLOCK, COMMENTS, AND MORE STDOUT PRINT
  27273 C 1999-09-24  D. A. KEYSER - REPORTS IN SPSSMI MESSAGES NO LONGER
  27274 C        PROCESSED (USELESS BECAUSE NO WIND DIRECTION AVAILABLE)
  27275 C 2004-09-09  D. A. KEYSER - REPORTS IN NEW MESSAGE TYPE GPSIPW
  27276 C        ARE NOT PROCESSED BECAUSE THEY HAVE NEITHER PRESSURE NOR
  27277 C        WIND DATA
  27278 C 2005-07-01  D. A. KEYSER - REPLACED CALL TO BUFRLIB ROUTINE BORT WITH
  27279 C        CALL TO W3LIB ROUTINE ERREXIT
  27280 C 2014-09-05  D. A. KEYSER - IF EITHER UOB OR VOB (OR BOTH) ARE
  27281 C        MISSING, SKIP THE PROCESSING OF INPUT PREPBUFR WIND REPORT
  27282 C        LEVEL (UOB AND/OR VOB CAN NOW BE MISSING FOR SURFACE WIND
  27283 C        REPORTS SINCE A RECENT IMPLEMENTATION ALLOWS REPORTS WITH ONLY
  27284 C        WIND SPEED OR ONLY WIND DIRECTION TO STORE THESE IN SOB AND
  27285 C        DDO, RESP. - PRIOR TO THIS FIX IN SYNDATA, MISSING VALUES FOR
  27286 C        UOB AND VOB WERE GENERATING NONSENSICAL BOGUS WINDS OR CAUSING
  27287 C        PROGRAM TO ABORT).
  27288 C
  27289 C USAGE:    CALL SURPRP(IUNTPN,IUNTBH,IUNTDH,PTOP,XMLZ,XMRZ,YNBZ,YNTZ,
  27290 C                       RPOT,SPDPOT,NOBWMN,IYRZ,DAY00,NDATA,DATA,
  27291 C                       IPRT,IHRD,INDCOM,ONLYWI,ONLYMA,ONLYPS)
  27292 C   INPUT ARGUMENT LIST:
  27293 C     IUNTPN   - UNIT NUMBER OF INPUT PREPBUFR FILE
  27294 C     IUNTBH   - UNIT NUMBER OF OUTPUT BGHISTRY.DIAG FILE
  27295 C     IUNTDH   - UNIT NUMBER OF OUTPUT DTHISTRY FILE
  27296 C     PTOP     - UPPER PRESSURE (MB) LIMIT FOR EXTRACTING DATA

Page 790         Source Listing                  SP1TNO
2017-04-18 11:09                                 syndata.f

  27297 C     XMLZ     - MINIMUM LONGITUDE LIMIT FOR EXTRACTING DATA
  27298 C     XMRZ     - MAXIMUM LONGITUDE LIMIT FOR EXTRACTING DATA
  27299 C     YNBZ     - MINIMUM LATITUDE  LIMIT FOR EXTRACTING DATA
  27300 C     YNTZ     - MAXIMUM LATITUDE  LIMIT FOR EXTRACTING DATA
  27301 C     RPOT     - ???????????????????????????????????????????????
  27302 C     SPDPOT   - ???????????????????????????????????????????????
  27303 C     NOBWMN   - ???????????????????????????????????????????????
  27304 C     IYRZ     - 4-DIGIT YEAR
  27305 C     DAY00    - FRACTIONAL NUMBER OF DAYS SINCE 365 DAYS PRIOR TO
  27306 C              - 00Z ON NCEP DATE
  27307 C     NDATA    - ???????????????????????????????????????????????
  27308 C     DATA     - ???????????????????????????????????????????????
  27309 C     IPRT     - FLAG TO TURN ON EXTRA STDOUT PRINT
  27310 C     IHRD     - ???????????????????????????????????????????????
  27311 C     INDCOM   - ???????????????????????????????????????????????
  27312 C     ONLYWI   - LOGICAL T/F TO EXTRACT ONLY WIND DATA
  27313 C     ONLYMA   - LOGICAL T/F TO EXTRACT ONLY MASS DATA
  27314 C     ONLYPS   - LOGICAL T/F TO EXTRACT ONLY MASS DATA
  27315 C
  27316 C   OUTPUT FILES:
  27317 C     UNIT 06  - STANDARD OUTPUT PRINT
  27318 C     UNIT "IUNTBH"  - BGHISTRY.DIAG FILE
  27319 C
  27320 C REMARKS: NONE.
  27321 C
  27322 C ATTRIBUTES:
  27323 C   LANGUAGE: FORTRAN 90
  27324 C   MACHINE:  NCEP WCOSS
  27325 C
  27326 C$$$
  27327       SUBROUTINE SURPRP(IUNTPN,IUNTBH,IUNTDH,PTOP,XMLZ,XMRZ,YNBZ,YNTZ,
  27328      1                  RPOT,SPDPOT,NOBWMN,IYRZ,DAY00,NDATA,DATA,IPRT,
  27329      2                  IHRD,INDCOM,ONLYWI,ONLYMA,ONLYPS)
  27330 
  27331       CHARACTER*8 SUBSET,LAST
  27332 
  27333       DIMENSION   DATA(NDATA),INDCOM(NDATA)
  27334 
  27335       CHARACTER*8  STAID
  27336 
  27337       REAL(8) HDR_8(5),OBS_8(4,255),QMS_8(3,255),PSL_8(2),PSFC_8,BMISS
  27338 
  27339       EQUIVALENCE  (STAID,HDR_8(1))
  27340 
  27341       LOGICAL     ONLYWI,ONLYMA,ONLYPS,PROCES
  27342 
  27343       COMMON/BUFRLIB_MISSING/BMISS
  27344 
  27345       DATA TKEL / 273.16 /
  27346       DATA SST  / 28.0   /
  27347       DATA RGAS / 287.   /
  27348       DATA GRAV / 9.81   /
  27349 
  27350       SAVE
  27351 
  27352 C-----------------------------------------------------------------------
  27353 C-----------------------------------------------------------------------

Page 791         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27354 
  27355       WRITE(6,111) XMLZ,XMRZ,YNBZ,YNTZ,ONLYWI,ONLYMA,ONLYPS,IHRD
  27356   111 FORMAT(//' ===> SURPRP: SCANNING PREPBUFR FILE IN THE AREA ',
  27357      $ 'DEFINED BY: XML=',F8.2,', XMR=',F8.2,', YNB=',F8.2,', AND ',
  27358      $ 'YNT=',F8.2/15X,'ONLYWI=',L1,', ONLYMA=',L1,', ONLYPS=',L1//
  27359      $ 15X,'NOTE: The value for "IHRD" should always be ZERO - here ',
  27360      $ 'IHRD =',I4//)
  27361 
  27362       LAST = 'XXXXXXXX'
  27363 
  27364       LATMN=YNBZ
  27365       LATMX=YNTZ
  27366       LONMN=XMLZ
  27367       LONMX=XMRZ
  27368 
  27369 C  OPEN PREPBUFR FILE AND PRINT THE DATE
  27370 C  -------------------------------------
  27371 
  27372       CALL DATELEN(10)
  27373 
  27374       CALL OPENBF(IUNTPN,'IN',IUNTPN)
  27375       CALL READMG(IUNTPN,SUBSET,IDATBF,IRET)
  27376       IF(IRET.NE.0) THEN
  27377          PRINT *, 'SURPRP - ERROR OPENING INPUT PREPBUFR FILE'
  27378          CALL ERREXIT(20)
  27379       END IF
  27380       PRINT 789, IUNTPN,IDATBF
  27381   789 FORMAT(/' ===> SURPRP: INPUT PREPBUFR FILE IN UNIT',I3,
  27382      $ ' SUCCESSFULLY OPENED - SECTION 1 MESSAGE DATE =',I11/)
  27383       WRITE(IUNTBH,*) 'DATE OF INPUT PREPBUFR FILE: ',IDATBF
  27384 
  27385       KOUNT = 0
  27386       KREC  = 0
  27387 
  27388       CALL CLOSBF(IUNTPN)
  27389       CALL OPENBF(IUNTPN,'IN',IUNTPN)
  27390 
  27391 C  READ THE NEXT SUBSET
  27392 C  --------------------
  27393 
  27394       ISKPMG = 0
  27395       ICNTOT = 0
  27396       ICNTTA = 0
  27397 
  27398   300 CONTINUE
  27399 
  27400       CALL READMG(IUNTPN,SUBSET,IDATBF,IRET)
  27401       IF(IRET.NE.0) GO TO 110
  27402       KREC = KREC + 1
  27403       IF(SUBSET.NE.LAST)  THEN
  27404          ISKPMG = 0
  27405          IF(LAST.NE.'XXXXXXXX')  PRINT 1249, IUNTPN,LAST,ICNTTA
  27406  1249 FORMAT(/' ===> SURPRP: ALL MESSAGES IN INPUT PREPBUFR FILE IN ',
  27407      $ 'UNIT',I3,' WITH TABLE A ENTRY "',A8,'" PROCESSED -- '/15X,
  27408      $ 'NUMBER OF INDIVIDUAL REPORTS DECODED OUT OF THESE MESSAGES =',
  27409      $ I6/)
  27410          ICNTTA = 0

Page 792         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27411          PRINT 1240, IUNTPN,SUBSET,IDATBF
  27412  1240 FORMAT(/' ===> SURPRP: NEXT MESSAGE IN INPUT PREPBUFR FILE IN ',
  27413      $ 'UNIT',I3,' HAS NEW TABLE A ENTRY OF "',A8,'" - DATE IS',I11/)
  27414 
  27415 C  NO NEED TO DECODE MESSAGES THAT NEVER CONTAIN WIND OR PRESSURE DATA
  27416 C   (NOTE: "SATEMP" IN NAM RUNS HAS MISSING HEIGHT ON ALL LEVELS)
  27417 C  -------------------------------------------------------------------
  27418 
  27419          IF(SUBSET.EQ.'GOESND  '.OR.SUBSET.EQ.'SATEMP'.OR.
  27420      $      SUBSET.EQ.'GPSIPW  ') THEN
  27421             PRINT 1261
  27422  1261 FORMAT(/' ===> SURPRP: MESSAGES WITH THIS TABLE A ENTRY WILL ',
  27423      $ 'NEVER BE PROCESSED SINCE NEVER HAVE WIND OR PRESSURE DATA,',
  27424      $ ' DON-T DECODE'/)
  27425             ISKPMG = 1
  27426          ELSE  IF(SUBSET.EQ.'SYNDAT  ') THEN
  27427             PRINT 1861
  27428  1861 FORMAT(/' ===> SURPRP: MESSAGES WITH THIS TABLE A ENTRY WILL ',
  27429      $ 'NEVER BE PROCESSED SINCE THE BOGUS SYNDATA SHOULD NOT BE IN ',
  27430      $ 'THE INPUT PREPBUFR FILE, DON-T DECODE'/)
  27431             ISKPMG = 1
  27432          ELSE  IF(SUBSET.EQ.'SPSSMI  ') THEN
  27433             PRINT 1881
  27434  1881 FORMAT(/' ===> SURPRP: MESSAGES WITH THIS TABLE A ENTRY WILL ',
  27435      $ 'NEVER BE PROCESSED SINCE SSM/I WIND SPEED IS USELESS (NO ',
  27436      $ 'DIRECTION) AND'/15X,'SSM/I TPW IS NOT USED, DON-T DECODE'/)
  27437             ISKPMG = 1
  27438          ELSE
  27439             IF(.NOT.ONLYWI)  THEN
  27440 
  27441 C  IF ONLYWI=F, NO NEED TO DECODE MESSAGES CONTAINING ONLY WIND DATA
  27442 C   OR MESSAGES CONTAINING MASS DATA BUT NO PRESSURE
  27443 C  -----------------------------------------------------------------
  27444 
  27445                IF(SUBSET.EQ.'SATWND  '.OR.SUBSET.EQ.'PROFLR  '.OR.
  27446      $            SUBSET.EQ.'VADWND  '.OR.SUBSET.EQ.'ERS1DA  ') THEN
  27447                   PRINT 1241
  27448  1241 FORMAT(/' ===> SURPRP: MESSAGES WITH THIS TABLE A ENTRY WILL ',
  27449      $ 'NEVER BE PROCESSED BASED ON ONLYxx SWITCHES, DON-T DECODE'/)
  27450                   ISKPMG = 1
  27451                END IF
  27452             END IF
  27453             IF(.NOT.ONLYMA.AND..NOT.ONLYPS)  THEN
  27454 
  27455 C  IF ONLYMA & ONLYPS=F, NO NEED TO DECODE MSG CONTAINING ONLY MASS DATA
  27456 C  ---------------------------------------------------------------------
  27457 
  27458                IF(SUBSET.EQ.'SATEMP  '.OR.SUBSET.EQ.'SFCBOG  ') THEN
  27459                   PRINT 1241
  27460                   ISKPMG = 1
  27461                END IF
  27462             END IF
  27463          END IF
  27464          IF(ISKPMG.EQ.0)  PRINT 1242
  27465  1242 FORMAT(/' ===> SURPRP: MESSAGES WITH THIS TABLE A ENTRY MUST BE ',
  27466      $ 'PROCESSED BASED ON ONLYxx SWITCHES, EACH INDIVIDUAL REPORT ',
  27467      $ 'MUST BE DECODED'/)

Page 793         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27468       END IF
  27469 
  27470       LAST = SUBSET
  27471 
  27472       IF(ISKPMG.EQ.1)  THEN
  27473          GO TO 300
  27474       END IF
  27475 
  27476       ICNT = 0
  27477 
  27478     1 CONTINUE
  27479 
  27480       CALL READSB(IUNTPN,IRET)
  27481       IF(IRET.NE.0) GO TO 300
  27482       ICNTTA = ICNTTA + 1
  27483       ICNTOT = ICNTOT + 1
  27484 
  27485       KOUNT = KOUNT+1
  27486       ICNT  = ICNT+1
  27487 
  27488 C  READ THE NEXT HEADER
  27489 C  --------------------
  27490 
  27491       HDR_8=BMISS
  27492       CALL UFBINT(IUNTPN,HDR_8,5,1,IRET,'SID XOB YOB DHR TYP')
  27493       RLON  = HDR_8(2)
  27494       RLAT  = HDR_8(3)
  27495 
  27496       IF(NINT(RLAT*100.) .LE. NINT(LATMN*100.)) GOTO 1
  27497       IF(NINT(RLAT*100.) .GE. NINT(LATMX*100.)) GOTO 1
  27498       IF(NINT(RLON*100.) .LE. NINT(LONMN*100.)) GOTO 1
  27499       IF(NINT(RLON*100.) .GE. NINT(LONMX*100.)) GOTO 1
  27500 
  27501 C  MASS/WIND REPORT SELECTION
  27502 C  --------------------------
  27503 
  27504       PROCES=.FALSE.
  27505       IRTYP = HDR_8(5)
  27506       KK    = IRTYP/100
  27507       IF(ONLYWI .AND. KK.EQ.2)  PROCES=.TRUE.
  27508       IF(ONLYMA .AND. KK.EQ.1)  PROCES=.TRUE.
  27509       IF(ONLYPS .AND. KK.EQ.1)  PROCES=.TRUE.
  27510       IF(.NOT. PROCES)  GO TO 1
  27511 
  27512 C  CONVERT OFF CYCLE TIME TO DECIMAL DAYS  (1/24=4.16666E-2)
  27513 C  ---------------------------------------------------------
  27514 
  27515       DHR   = HDR_8(4)
  27516       ROFFT = 4.16666E-2*DHR
  27517       DAYZ  = DAY00+ROFFT
  27518       RLATZ = RLAT
  27519       RLONZ = RLON
  27520 
  27521 C  READ AND GO THROUGH THE DATA IN A REPORT
  27522 C  ----------------------------------------
  27523 
  27524       PSFC_8=BMISS

Page 794         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27525       MCHOIC = 1
  27526       IF(SUBSET.EQ.'ADPSFC  ')  THEN
  27527          IF(KK.EQ.1)  THEN
  27528 
  27529 C  MASS REPORTS: USE MEAN SEA LEVEL PRESSURE FROM SURFACE REPORTS
  27530 C     FIRST CHOICE: ENCODED VALUE "PMO" (ONLY FOR ADPSFC REPORTS)
  27531 C  --------------------------------------------------------------
  27532 
  27533             PSL_8=BMISS
  27534             CALL UFBINT(IUNTPN,PSL_8,2,1,IONE,'PMO PMQ')
  27535             IF(IBFMS(PSL_8(1)).EQ.0) THEN
  27536                IF(NINT(PSL_8(1)*10.).GT.10200)  THEN
  27537                   WRITE(6,9163)  PSL_8(1),STAID,IRTYP,SUBSET,MCHOIC
  27538  9163 FORMAT(/' ***> SURPRP: UNREAL PSFC=',E16.8,' AT STN. ',A8,
  27539      $ ', R.TYPE =',I4,', SUBSET = "',A8,'", MCHOIC =',I2,' - GO ON TO',
  27540      $ ' NEXT REPORT'/)
  27541                   GO TO 1
  27542                ELSE IF(NINT(PSL_8(2)).GT.7)  THEN
  27543                   WRITE(6,9164)  PSL_8(1),NINT(PSL_8(2)),STAID,IRTYP,
  27544      $             SUBSET,MCHOIC
  27545  9164 FORMAT(/' ***> SURPRP: BAD PSFC=',F6.1,', Q.M.=',I2,' AT STN. ',
  27546      $ A8,', R.TYPE =',I4,', SUBSET = "',A8,'", MCHOIC =',I2,' - GO ON',
  27547      $ ' TO NEXT REPORT'/)
  27548                   GO TO 1
  27549                ENDIF
  27550                PSFC_8=PSL_8(1)
  27551                GO TO 1500
  27552             ENDIF
  27553          ENDIF
  27554       ENDIF
  27555 
  27556       OBS_8=BMISS
  27557       CALL UFBINT(IUNTPN,OBS_8,4,255,NLEV,'POB ZOB UOB VOB')
  27558       QMS_8=BMISS
  27559       CALL UFBINT(IUNTPN,QMS_8,3,255,NLEV,'PQM ZQM WQM')
  27560 
  27561       IWFLG = 1
  27562 
  27563       DO MSEL=1,NLEV
  27564          POB = OBS_8(1,MSEL)
  27565          ZOB = OBS_8(2,MSEL)
  27566          UOB = OBS_8(3,MSEL)
  27567          VOB = OBS_8(4,MSEL)
  27568          PQM = QMS_8(1,MSEL)
  27569 
  27570 C  Don't want to consider pressure with q.m. 10 as bad since only
  27571 C   this code can aplly this quality mark (downstream of here)
  27572 
  27573          IF(NINT(PQM).EQ.10)  PQM = -10
  27574          ZQM = QMS_8(2,MSEL)
  27575          WQM = QMS_8(3,MSEL)
  27576          IF(KK.EQ.1)  THEN
  27577 
  27578 C  MASS REPORTS: USE MEAN SEA LEVEL PRESSURE FROM SURFACE REPORTS
  27579 C     SECOND CHOICE: ENCODED VALUE "POB" IF AT SEA-LEVEL
  27580 C                    (ONLY FOR ADPUPA, SFCSHP AND SFCBOG, REPORTS)
  27581 C     THIRD  CHOICE: CALCULATED FROM 1000 MB PRESSURE AND HEIGHT

Page 795         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27582 C                    (ONLY FOR ADPUPA REPORTS)
  27583 C  ---------------------------------------------------------------
  27584 
  27585             IF(NINT(POB*10.).LE.9999.AND.ZOB.GT.7)  GO TO 1
  27586             IF(ZOB.GT.-1.AND.ZOB.LT.8) THEN
  27587                MCHOIC = 2
  27588                IF(NINT(POB*10.).GT.10200)  THEN
  27589                   WRITE(6,9993)  POB,STAID,IRTYP,SUBSET,MCHOIC,ZOB
  27590  9993 FORMAT(/' ***> SURPRP: UNREAL PSFC=',E16.8,' AT STN. ',A8,
  27591      $ ', R.TYPE =',I4,', SUBSET = "',A8,'", MCHOIC =',I2,', ELEV =',
  27592      $ F8.1/15X,' - GO ON TO NEXT REPORT'/)
  27593                   GO TO 1
  27594                ELSE IF(MAX(NINT(PQM),NINT(ZQM)).GT.7)  THEN
  27595                   WRITE(6,9165)  POB,ABS(NINT(PQM)),ZOB,NINT(ZQM),STAID,
  27596      $             IRTYP,SUBSET,MCHOIC
  27597  9165 FORMAT(/' ***> SURPRP: BAD PSFC=',F6.1,', Q.M.=',I2,' AND/OR BAD',
  27598      $ ' ELEV=',F8.1,', Q.M.=',I2,' AT STN. ',A8,', R.TYPE =',I4,', ',
  27599      $ 'SUBSET = "',A8,'"'/15X,'MCHOIC =',I2,' - GO ON TO NEXT REPORT'/)
  27600                   GO TO 1
  27601                ENDIF
  27602                PSFC_8=POB
  27603                GO TO 1500
  27604            ELSE IF(NINT(POB*10.).EQ.10000.AND.IBFMS(OBS_8(2,MSEL)).EQ.0)
  27605      $       THEN
  27606                MCHOIC = 3
  27607                IF(MAX(NINT(PQM),NINT(ZQM)).GT.7)  THEN
  27608                   WRITE(6,9165)  POB,ABS(NINT(PQM)),ZOB,NINT(ZQM),STAID,
  27609      $             IRTYP,SUBSET,MCHOIC
  27610                   GO TO 1
  27611                END IF
  27612                TSFC=TKEL+SST
  27613                PSFC_8=POB+GRAV*POB/(RGAS*TSFC)*ZOB
  27614                IF(NINT(PSFC_8*10.).GT.10200)  THEN
  27615                   WRITE(6,9167) PSFC_8,STAID,IRTYP,SUBSET,MCHOIC,TSFC,
  27616      $             ZOB,POB
  27617  9167 FORMAT(/' ***> SURPRP: UNREAL PSFC=',E16.8,' AT STN. ',A8,
  27618      $ ', R.TYPE =',I4,', SUBSET = "',A8,'", MCHOIC =',I2,', TSFC =',
  27619      $ F8.3/15X,'Z1000 =',F8.1,', P1000 =',F7.1,' - GO ON TO NEXT ',
  27620      $ 'REPORT'/)
  27621                   GO TO 1
  27622                ENDIF
  27623                GO TO 1500
  27624             ENDIF
  27625 
  27626          ELSE  IF(KK.EQ.2)  THEN
  27627 cdak  fix 9/5/14 vvvvvvvvvv
  27628             if(ibfms(OBS_8(3,MSEL)).gt.0.or.
  27629      $         ibfms(OBS_8(4,MSEL)).gt.0)  then
  27630 
  27631 c  If either UOB or VOB (or both) are missing, skip the processing of
  27632 c  this wind level (UOB and/or VOB can now be missing for surface wind
  27633 c  reports since a recent implementation allows reports with only wind
  27634 c  speed or only wind direction to store these in SOB and DDO, resp.)
  27635 c  -------------------------------------------------------------------
  27636 
  27637                WRITE(6,9195)  POB,STAID,IRTYP,SUBSET,UOB,VOB
  27638  9195 FORMAT(/' ***> SURPRP: ONE OR BOTH UOB/VOB MISSING: PSFC=',F6.1,

Page 796         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27639      $       ' AT STN. ',A8,', R.TYPE =',I4,', SUBSET = "',A8,'",'/
  27640      $ 15X,'UOB = ',G0,', VOB = ',G0,' - SKIP AND GO ON TO NEXT ',
  27641      $ 'LEVEL OF THIS REPORT'/)
  27642                go to 30
  27643            endif
  27644 cdak  fix 9/5/14 ^^^^^^^^^^
  27645 
  27646 C  WIND REPORTS: USE DATA ON ALL LEVELS BELOW PTOP
  27647 C  -----------------------------------------------
  27648 
  27649             IF(NINT(POB*10.).LT.NINT(PTOP*10.))  GO TO 1
  27650             IF(NINT(WQM).GT.7)  THEN
  27651                WRITE(6,9166)  POB,NINT(WQM),STAID,IRTYP,SUBSET
  27652  9166 FORMAT(/' ***> SURPRP: BAD WIND ON LEVEL POB=',F6.1,', WIND ',
  27653      $ 'Q.M.=',I2,' AT STN. ',A8,', R.TYPE =',I4,', SUBSET = "',A8,'"'/
  27654      $ 15X,'- SKIP AND GO ON TO NEXT LEVEL OF THIS REPORT'/)
  27655                GO TO 30
  27656             ENDIF
  27657             IF(IWFLG.EQ.1)  THEN
  27658                IF(IHRD.EQ.0)  THEN
  27659 
  27660 C  ON FIRST VALID WIND LEVEL ONLY, IF IHRD=0 CONVERT TO STORM-RELATIVE
  27661 C   SYSTEM AND CALCULATE DATA-STORM DISTANCE AND ANGLE
  27662 C  -------------------------------------------------------------------
  27663 
  27664                   CALL STMADJ(RLONZ,RLATZ,DAYZ)
  27665                   CALL STMCOR(RLATZ,RLONZ,IHOWFR,ANGLE)
  27666                END IF
  27667 
  27668 C  ON FIRST VALID WIND LEVEL ONLY, PRINT WIND REPORT (MAYBE?)
  27669 C  ----------------------------------------------------------
  27670 
  27671 c && comment out 2 lines
  27672                iprtl = iprt
  27673                iprt=2
  27674                IF(IPRT.GT.1 .AND. MOD(KOUNT,1).EQ.0)  THEN
  27675                  PRINT20,ICNT,KREC,RLAT,RLON,STAID,NLEV,DHR,IRTYP,SUBSET
  27676    20 FORMAT(1X,'WIND: ICNT=',I4,', KREC=',I5,', LAT=',F7.2,', LON=',
  27677      $ F7.2,', STNID=',A8,', LVLS=',I3,', D-TIME=',F6.2,', RTYP=',I3,
  27678      $ ', SUBSET="',A8,'"')
  27679                ENDIF
  27680 c && comment out next line
  27681                iprt=iprtl
  27682                IWFLG = 0
  27683             END IF
  27684 c && 3 comments
  27685 CC          WRITE(6,29) MSEL,POB,UOB,VOB,RLAT,RLON
  27686 CC 29 FORMAT('...SELECTING WINDS, MSEL,PRESR,UWIND,VWIND,RLAT,RLON=',I5,
  27687 CC   $ 5(F10.2))
  27688             DATA(INDCOM(1))=UOB
  27689             DATA(INDCOM(2))=VOB
  27690             IF(IHRD.EQ.0)  THEN
  27691               CALL OWNCOM(IPRT,IHOWFR,ANGLE,RLAT,RLON,POB,IRTYP,NDATA,
  27692      $                    DATA)
  27693             ELSE  IF(IHRD.GT.0)  THEN
  27694                CALL MAKHRD(IRTYP,IYRZ,DAYZ,RLAT,RLON,POB,UOB,VOB)
  27695             END IF

Page 797         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27696          END IF
  27697    30    CONTINUE
  27698 
  27699       ENDDO
  27700 
  27701       GO TO 1
  27702 
  27703  1500 CONTINUE
  27704 
  27705 C  COME HERE IF MASS REPORT WITH SEA-LEVEL PRESSURE
  27706 C  ------------------------------------------------
  27707 
  27708       IF(IHRD.EQ.0)  THEN
  27709 
  27710 C  IF IHRD=0 CONVERT TO STORM-RELATIVE SYSTEM AND CALCULATE DATA-STORM
  27711 C  DISTANCE AND ANGLE
  27712 C  -------------------------------------------------------------------
  27713 
  27714          CALL STMADJ(RLONZ,RLATZ,DAYZ)
  27715          CALL STMCOR(RLATZ,RLONZ,IHOWFR,ANGLE)
  27716       END IF
  27717 
  27718 C  PRINT MASS REPORT (MAYBE?)
  27719 C  --------------------------
  27720 
  27721 c && comment out 2 lines
  27722       iprtl = iprt
  27723       iprt=2
  27724       IF(IPRT.GT.1 .AND. MOD(KOUNT,1).EQ.0)  THEN
  27725          PRINT 21, ICNT,KREC,RLAT,RLON,STAID,NLEV,DHR,IRTYP,SUBSET
  27726    21 FORMAT(1X,'MASS: ICNT=',I4,', KREC=',I5,', LAT=',F7.2,', LON=',
  27727      $ F7.2,', STNID=',A8,', LVLS=',I3,', D-TIME=',F6.2,', RTYP=',I3,
  27728      $ ', SUBSET="',A8,'"')
  27729          IF(MCHOIC.EQ.1)  THEN
  27730             PRINT 220, MCHOIC,PSFC_8
  27731   220 FORMAT(1X,'....: MCHOIC=',I1,', PSFC=',F6.1)
  27732          ELSE  IF(MCHOIC.EQ.2)  THEN
  27733             PRINT 221, MCHOIC,PSFC_8,ZOB
  27734   221 FORMAT(1X,'....: MCHOIC=',I1,', PSFC=',F6.1,', ELEV=',F7.1)
  27735          ELSE  IF(MCHOIC.EQ.3)  THEN
  27736             PRINT 222, MCHOIC,PSFC_8,ZOB,TSFC,POB
  27737   222 FORMAT(1X,'....: MCHOIC=',I1,', PSFC=',F6.1,', Z1000=',F7.1,
  27738      $ ', TSFC=',F7.3,', P1000=',F6.1)
  27739          END IF
  27740       END IF
  27741 c && comment out next line
  27742       iprt=iprtl
  27743 
  27744       DATA(INDCOM(3))=PSFC_8
  27745 
  27746 C ==> Important: If IHRD != 0, then I don't think IHOWFR and
  27747 C                ANGLE would be defined at this point
  27748 
  27749       CALL OPSCOM(IPRT,IHOWFR,ANGLE,RLAT,RLON,IRTYP,NDATA,DATA)
  27750 
  27751       GO TO 1
  27752 

Page 798         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27753  110  CONTINUE
  27754 
  27755 C  FINISHED READING THE FILE
  27756 C  -------------------------
  27757 
  27758       PRINT 1249, IUNTPN,LAST,ICNTTA
  27759       PRINT 1259, IUNTPN,ICNTOT
  27760  1259 FORMAT(//' ===> SURPRP: ALL MESSAGES IN INPUT PREPBUFR FILE IN ',
  27761      $ 'UNIT',I3,' PROCESSED - NUMBER OF INDIVIDUAL REPORTS DECODED'/
  27762      $ 15X,'OUT OF ALL MESSAGES =',I6//)
  27763       CALL CLOSBF(IUNTPN)
  27764       PRINT 799, IUNTPN
  27765   799 FORMAT(/' ===> SURPRP: INPUT PREPBUFR FILE IN UNIT',I3,
  27766      $ ' SUCCESSFULLY CLOSED'/)
  27767 
  27768 C  ANALYZE RESULTS
  27769 C  ---------------
  27770 
  27771       IF(IHRD.EQ.0) CALL ANLCOM(RPOT,SPDPOT,NOBWMN,IUNTDH,ONLYWI,ONLYPS)
  27772 
  27773       RETURN
  27774 
  27775       END


ENTRY POINTS

  Name               
                     
 surprp_             

Page 799         Source Listing                  SURPRP
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  27478                                                          27496,27497,27498,27499,27510,2754
                                                                                                  1,27548,27585,27593,27600,27610,27
                                                                                                  621,27649,27701,27751             
 110                        Label  27753                                                          27401                             
 111                        Label  27356                                                          27355                             
 1240                       Label  27412                                                          27411                             
 1241                       Label  27448                                                          27447,27459                       
 1242                       Label  27465                                                          27464                             
 1249                       Label  27406                                                          27405,27758                       
 1259                       Label  27760                                                          27759                             
 1261                       Label  27422                                                          27421                             
 1500                       Label  27703                                                          27551,27603,27623                 
 1861                       Label  27428                                                          27427                             
 1881                       Label  27434                                                          27433                             
 20                         Label  27676                                                          27675                             
 21                         Label  27726                                                          27725                             
 220                        Label  27731                                                          27730                             
 221                        Label  27734                                                          27733                             
 222                        Label  27737                                                          27736                             
 30                         Label  27697                                                          27642,27655                       
 300                        Label  27398                                                          27473,27481                       
 789                        Label  27381                                                          27380                             
 799                        Label  27765                                                          27764                             
 9163                       Label  27538                                                          27537                             
 9164                       Label  27545                                                          27543                             
 9165                       Label  27597                                                          27595,27608                       
 9166                       Label  27652                                                          27651                             
 9167                       Label  27617                                                          27615                             
 9195                       Label  27638                                                          27637                             
 9993                       Label  27590                                                          27589                             
 ABS                        Func   27595                                scalar                    27595,27608                       
 ANGLE                      Local  27665    R(4)            4           scalar   SAVE             27665,27691,27715,27749           
 ANLCOM                     Subr   27771                                                          27771                             
 BMISS                      Scalar 27337    R(8)            8           scalar   COM              27491,27524,27533,27556,27558     
 BUFRLIB_MISSING            Common 27343                                8        SAVE                                               
 CLOSBF                     Subr   27388                                                          27388,27763                       
 DATA                       Dummy  27328    R(4)            4     1     0        ARG,INOUT        27688,27689,27692,27744,27749     
 DATELEN                    Subr   27372                                                          27372                             
 DAY00                      Dummy  27328    R(4)            4           scalar   ARG,INOUT        27517                             
 DAYZ                       Local  27517    R(4)            4           scalar   SAVE             27517,27664,27694,27714           
 DHR                        Local  27515    R(4)            4           scalar   SAVE             27515,27516,27675,27725           
 ERREXIT                    Subr   27378                                                          27378                             
 GRAV                       Local  27348    R(4)            4           scalar   SAVE             27348,27613                       
 HDR_8                      Local  27337    R(8)            8     1     5        SAVE             27491,27492,27493,27494,27505,2751
                                                                                                  5                                 
 IBFMS                      Func   27535    I(4)            4           scalar                    27535,27604,27628,27629           
 ICNT                       Local  27476    I(4)            4           scalar   SAVE             27476,27486,27675,27725           
 ICNTOT                     Local  27395    I(4)            4           scalar   SAVE             27395,27483,27759                 
 ICNTTA                     Local  27396    I(4)            4           scalar   SAVE             27396,27405,27410,27482,27758     
 IDATBF                     Local  27375    I(4)            4           scalar   SAVE             27375,27380,27383,27400,27411     
 IHOWFR                     Local  27665    I(4)            4           scalar   SAVE             27665,27691,27715,27749           

Page 800         Source Listing                  SURPRP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IHRD                       Dummy  27329    I(4)            4           scalar   ARG,INOUT        27355,27658,27690,27693,27708,2777
                                                                                                  1                                 
 INDCOM                     Dummy  27329    I(4)            4     1     0        ARG,INOUT        27688,27689,27744                 
 IONE                       Local  27534    I(4)            4           scalar   SAVE             27534                             
 IPRT                       Dummy  27328    I(4)            4           scalar   ARG,INOUT        27672,27673,27674,27681,27691,2772
                                                                                                  2,27723,27724,27742,27749         
 IPRTL                      Local  27672    I(4)            4           scalar   SAVE             27672,27681,27722,27742           
 IRET                       Local  27375    I(4)            4           scalar   SAVE             27375,27376,27400,27401,27480,2748
                                                                                                  1,27492                           
 IRTYP                      Local  27505    I(4)            4           scalar   SAVE             27505,27506,27537,27543,27589,2759
                                                                                                  6,27609,27615,27637,27651,27675,27
                                                                                                  691,27694,27725,27749             
 ISKPMG                     Local  27394    I(4)            4           scalar   SAVE             27394,27404,27425,27431,27437,2745
                                                                                                  0,27460,27464,27472               
 IUNTBH                     Dummy  27327    I(4)            4           scalar   ARG,INOUT        27383                             
 IUNTDH                     Dummy  27327    I(4)            4           scalar   ARG,INOUT        27771                             
 IUNTPN                     Dummy  27327    I(4)            4           scalar   ARG,INOUT        27374,27375,27380,27388,27389,2740
                                                                                                  0,27405,27411,27480,27492,27534,27
                                                                                                  557,27559,27758,27759,27763,27764 
 IWFLG                      Local  27561    I(4)            4           scalar   SAVE             27561,27657,27682                 
 IYRZ                       Dummy  27328    I(4)            4           scalar   ARG,INOUT        27694                             
 KK                         Local  27506    I(4)            4           scalar   SAVE             27506,27507,27508,27509,27527,2757
                                                                                                  6,27626                           
 KOUNT                      Local  27385    I(4)            4           scalar   SAVE             27385,27485,27674,27724           
 KREC                       Local  27386    I(4)            4           scalar   SAVE             27386,27402,27675,27725           
 LAST                       Local  27331    CHAR            8           scalar   SAVE             27362,27403,27405,27470,27758     
 LATMN                      Local  27364    I(4)            4           scalar   SAVE             27364,27496                       
 LATMX                      Local  27365    I(4)            4           scalar   SAVE             27365,27497                       
 LONMN                      Local  27366    I(4)            4           scalar   SAVE             27366,27498                       
 LONMX                      Local  27367    I(4)            4           scalar   SAVE             27367,27499                       
 MAKHRD                     Subr   27694                                                          27694                             
 MAX                        Func   27594                                scalar                    27594,27607                       
 MCHOIC                     Local  27525    I(4)            4           scalar   SAVE             27525,27537,27544,27587,27589,2759
                                                                                                  6,27606,27609,27615,27729,27730,27
                                                                                                  732,27733,27735,27736             
 MOD                        Func   27674                                scalar                    27674,27724                       
 MSEL                       Local  27563    I(4)            4           scalar   SAVE             27563,27564,27565,27566,27567,2756
                                                                                                  8,27574,27575,27604,27628,27629   
 NDATA                      Dummy  27328    I(4)            4           scalar   ARG,INOUT        27333,27691,27749                 
 NINT                       Func   27496                                scalar                    27496,27497,27498,27499,27536,2754
                                                                                                  2,27543,27573,27585,27588,27594,27
                                                                                                  595,27604,27607,27608,27614,27649,
                                                                                                  27650,27651                       
 NLEV                       Local  27557    I(4)            4           scalar   SAVE             27557,27559,27563,27675,27725     
 NOBWMN                     Dummy  27328    I(4)            4           scalar   ARG,INOUT        27771                             
 OBS_8                      Local  27337    R(8)            8     2     1020     SAVE             27556,27557,27564,27565,27566,2756
                                                                                                  7,27604,27628,27629               
 ONLYMA                     Dummy  27329    L(4)            4           scalar   ARG,INOUT        27355,27453,27508                 
 ONLYPS                     Dummy  27329    L(4)            4           scalar   ARG,INOUT        27355,27453,27509,27771           
 ONLYWI                     Dummy  27329    L(4)            4           scalar   ARG,INOUT        27355,27439,27507,27771           
 OPENBF                     Subr   27374                                                          27374,27389                       
 OPSCOM                     Subr   27749                                                          27749                             
 OWNCOM                     Subr   27691                                                          27691                             
 POB                        Local  27564    R(4)            4           scalar   SAVE             27564,27585,27588,27589,27595,2760
                                                                                                  2,27604,27608,27613,27616,27637,27

Page 801         Source Listing                  SURPRP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  649,27651,27691,27694,27736       
 PQM                        Local  27568    R(4)            4           scalar   SAVE             27568,27573,27594,27595,27607,2760
                                                                                                  8                                 
 PROCES                     Local  27341    L(4)            4           scalar   SAVE             27504,27507,27508,27509,27510     
 PSFC_8                     Local  27337    R(8)            8           scalar   SAVE             27524,27550,27602,27613,27614,2761
                                                                                                  5,27730,27733,27736,27744         
 PSL_8                      Local  27337    R(8)            8     1     2        SAVE             27533,27534,27535,27536,27537,2754
                                                                                                  2,27543,27550                     
 PTOP                       Dummy  27327    R(4)            4           scalar   ARG,INOUT        27649                             
 QMS_8                      Local  27337    R(8)            8     2     765      SAVE             27558,27559,27568,27574,27575     
 READMG                     Subr   27375                                                          27375,27400                       
 READSB                     Subr   27480                                                          27480                             
 RGAS                       Local  27347    R(4)            4           scalar   SAVE             27347,27613                       
 RLAT                       Local  27494    R(4)            4           scalar   SAVE             27494,27496,27497,27518,27675,2769
                                                                                                  1,27694,27725,27749               
 RLATZ                      Local  27518    R(4)            4           scalar   SAVE             27518,27664,27665,27714,27715     
 RLON                       Local  27493    R(4)            4           scalar   SAVE             27493,27498,27499,27519,27675,2769
                                                                                                  1,27694,27725,27749               
 RLONZ                      Local  27519    R(4)            4           scalar   SAVE             27519,27664,27665,27714,27715     
 ROFFT                      Local  27516    R(4)            4           scalar   SAVE             27516,27517                       
 RPOT                       Dummy  27328    R(4)            4           scalar   ARG,INOUT        27771                             
 SPDPOT                     Dummy  27328    R(4)            4           scalar   ARG,INOUT        27771                             
 SST                        Local  27346    R(4)            4           scalar   SAVE             27346,27612                       
 STAID                      Local  27335    CHAR            8           scalar   SAVE             27537,27543,27589,27595,27608,2761
                                                                                                  5,27637,27651,27675,27725         
 STMADJ                     Subr   27664                                                          27664,27714                       
 STMCOR                     Subr   27665                                                          27665,27715                       
 SUBSET                     Local  27331    CHAR            8           scalar   SAVE             27375,27400,27403,27411,27419,2742
                                                                                                  0,27426,27432,27445,27446,27458,27
                                                                                                  470,27526,27537,27544,27589,27596,
                                                                                                  27609,27615,27637,27651,27675,2772
                                                                                                  5                                 
 SURPRP                     Subr   27327                                                                                            
 TKEL                       Local  27345    R(4)            4           scalar   SAVE             27345,27612                       
 TSFC                       Local  27612    R(4)            4           scalar   SAVE             27612,27613,27615,27736           
 UFBINT                     Subr   27492                                                          27492,27534,27557,27559           
 UOB                        Local  27566    R(4)            4           scalar   SAVE             27566,27637,27688,27694           
 VOB                        Local  27567    R(4)            4           scalar   SAVE             27567,27637,27689,27694           
 WQM                        Local  27575    R(4)            4           scalar   SAVE             27575,27650,27651                 
 XMLZ                       Dummy  27327    R(4)            4           scalar   ARG,INOUT        27355,27366                       
 XMRZ                       Dummy  27327    R(4)            4           scalar   ARG,INOUT        27355,27367                       
 YNBZ                       Dummy  27327    R(4)            4           scalar   ARG,INOUT        27355,27364                       
 YNTZ                       Dummy  27327    R(4)            4           scalar   ARG,INOUT        27355,27365                       
 ZOB                        Local  27565    R(4)            4           scalar   SAVE             27565,27585,27586,27589,27595,2760
                                                                                                  8,27613,27616,27733,27736         
 ZQM                        Local  27574    R(4)            4           scalar   SAVE             27574,27594,27595,27607,27608     

Page 802         Source Listing                  SURPRP
2017-04-18 11:09                                 syndata.f

  27776 
  27777 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  27778 C                .      .    .                                       .
  27779 C SUBPROGRAM:    COMBIN      COMBINES BOGUS AND ENVIRONMENTAL BOGUS
  27780 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2001-09-27
  27781 C
  27782 C ABSTRACT: COMBINES BOGUS AND ENVIRONMENTAL DATA TO PRODUCE
  27783 C   THE FINAL BOGUS VALUES.  CONSIDERS WINDS AND HEIGHTS ONLY.
  27784 C   CAN GENERATE A NEW FORM OF MASS BOGUS REPORT AT THE STORM
  27785 C   LOCATION.
  27786 C
  27787 C PROGRAM HISTORY LOG:
  27788 C 1991-06-06  S. J. LORD
  27789 C 2001-09-27  D. A. KEYSER - OPTION AVAILABLE TO GENERATE A NEW FORM
  27790 C       OF MASS BOGUS REPORT AT THE STORM LOCATION (TYPE 111),
  27791 C       CONTROLLED BY NAMELIST SWITCH "MAK111" (IF FALSE THEN REPORTS
  27792 C       WILL NOT BE GENERATED) (THESE REPORTS ARE LATER MODIFIED IN
  27793 C       SUBR. EDTPRP)
  27794 C
  27795 C USAGE:    CALL PGM-NAME(INARG1, INARG2, WRKARG, OUTARG1, ... )
  27796 C   INPUT ARGUMENT LIST:
  27797 C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
  27798 C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
  27799 C
  27800 C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
  27801 C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
  27802 C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
  27803 C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
  27804 C
  27805 C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
  27806 C     DDNAME1  - GENERIC NAME & CONTENT
  27807 C
  27808 C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
  27809 C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
  27810 C     FT06F001 - INCLUDE IF ANY PRINTOUT
  27811 C
  27812 C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
  27813 C
  27814 C ATTRIBUTES:
  27815 C   LANGUAGE: FORTRAN 90
  27816 C   MACHINE:  NCEP WCOSS
  27817 C
  27818 C$$$
  27819       SUBROUTINE COMBIN(IEFLTP,IUNTFE,MXUNTE,IUNTVO,ADVORT,IUNTBG,RLAT1,
  27820      1                  RLAT2,RLON1,RLON2,F,MAXFI,MAXF2J,STMLTZ,STMLNZ,
  27821      2                  STMDRZ,STMSPZ,IDATEZ,IUTCZ,PCENST,RMAXST,IFSTZ)
  27822 C
  27823       PARAMETER (MAXI=360,MAXJ=181,MAX2J=2*MAXJ)
  27824       PARAMETER (MAXBGI=35,MAXBGJ=35,MAXBGK=10)
  27825       PARAMETER (KDTDIM=5,MAXBG=MAXBGI*MAXBGJ*MAXBGK*KDTDIM)
  27826       PARAMETER (NSTM=1,MAXSTM=NSTM)
  27827 C
  27828       CHARACTER MTITLE*102,STMNMZ*12
  27829       LOGICAL OUTPUT,STORLV,FRSTLV,ADVORT,INCMOD,SETLON,ZEROIT
  27830 C
  27831       COMMON/OVRHED/ITYP,PRES(MAXBGK)
  27832       COMMON/T111SW/MAK111

Page 803         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  27833 C
  27834       SAVE
  27835 
  27836       REAL(8)  SINDEG_8,DISTSP_8
  27837 C
  27838       DIMENSION F(MAXFI,MAXF2J),RLONLS(MAXI),RLATLS(MAXJ),
  27839      1          Z(MAXBGI,MAXBGJ,MAXBGK), T(MAXBGI,MAXBGJ,MAXBGK),
  27840      2          RH(MAXBGI,MAXBGJ,MAXBGK),U(MAXBGI,MAXBGJ,MAXBGK),
  27841      3          V(MAXBGI,MAXBGJ,MAXBGK)
  27842       DIMENSION FENARA(MAXBGI,MAXBGJ,MAXBGK,KDTDIM),BOGDAT(MAXBG),
  27843      1          VORARA(MAXBGI,MAXBGJ,MAXBGK,KDTDIM),VORDAT(MAXBG),
  27844      2          DATOUT(KDTDIM+1,MAXBGK),IUAPRS(MAXBGK)
  27845 C
  27846       CHARACTER STMNAM*9,STMID*3,RSMC*4
  27847 C
  27848       LOGICAL FSTFLG,MAK111
  27849 C
  27850       DIMENSION STMNAM(MAXSTM),STMLAT(MAXSTM),STMLON(MAXSTM),
  27851      1          STMDIR(MAXSTM),STMSPD(MAXSTM),IDATE(MAXSTM),
  27852      2          IUTC(MAXSTM),RMAX(MAXSTM),PENV(MAXSTM),PCEN(MAXSTM),
  27853      3          PTOP(MAXSTM),RSMC(MAXSTM),RMW(MAXSTM),VMAX(MAXSTM),
  27854      4          R15NW(MAXSTM),R15NE(MAXSTM),R15SE(MAXSTM),R15SW(MAXSTM),
  27855      5          STMID(MAXSTM),FSTFLG(MAXSTM)
  27856 C
  27857 C
  27858       EQUIVALENCE (FENARA(1,1,1,1),T(1,1,1)),
  27859      1            (FENARA(1,1,1,2),RH(1,1,1)),
  27860      2            (FENARA(1,1,1,3),Z(1,1,1)),
  27861      3            (FENARA(1,1,1,4),U(1,1,1)),
  27862      4            (FENARA(1,1,1,5),V(1,1,1)),
  27863      5            (FENARA(1,1,1,1),BOGDAT(1)),
  27864      6            (VORARA(1,1,1,1),VORDAT(1))
  27865 C
  27866 C
  27867       DATA EPS/1.E-2/,EPSLL/0.2/,EPSFC/1.E-6/,IQZ/0/,IQV/0/,IRTYP/110/,
  27868      1     IRTYPC/111/,IOVITL/1/,IPRNT/1/,IWRITE/6/,IPMAX/100/
  27869 C
  27870 C     DATA PARAMETERS FOR ESTIMATE OF 1000 MB HEIGHT AND STORM
  27871 C       CENTER BOGUS OBS
  27872 C
  27873       DATA TKEL/273.16/,SST/28.0/,RGAS/287./,GRAV/9.81/,IOFFT/0/,
  27874      1     P1000/1000./,IPSURF/1000/,RMISS/-9999.9/,IQT/0/,IQM/0/,
  27875      2     OMEG/14.584E-5/
  27876 C
  27877 C     SUBROUTINE COMBIN TAKES THE ENVIRONMENTAL FIELD AND THE BOGUS
  27878 C       VORTEX POINTS AND ADDS THEM TOGETHER.
  27879 C
  27880 C     CURRENTLY, TWO TYPES OF ENVIRONMENTAL FIELDS ARE ACCEPTED:
  27881 C         1)  GLOBAL DOMAIN MAP LAUNCHER (LAT/LON)  (IEFLTP=1)
  27882 C         2)  LIMITED DOMAIN MAP LAUNCHER FORMAT (LAT/LON) (IEFLTP=2)
  27883 C
  27884 C     ADVORT=.FALSE. MEANS THAT THE BOGUS VORTEX IS NOT ADDED
  27885 C        TO THE FILTERED LARGE-SCALE ENVIRONMENTAL FIELD
  27886 C
  27887       UCALM=0.0
  27888       VCALM=0.0
  27889       RHCNTR=99.0

Page 804         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  27890       INCMOD=.FALSE.
  27891       SETLON=.FALSE.
  27892 C
  27893 C     **** IMPORTANT NOTE:    *****
  27894 C     TEMPORARILY, WE NEED DELXBG, DELYBG AND STORM NAME FROM BOGUS
  27895 C     DATA FILE. DOMAIN PARAMETERS, DATE, TIME ARE INPUT FROM ARGUMENT
  27896 C       LIST IN SUBROUTINE MODE
  27897 C
  27898       READ(IUNTVO,*) ZLONMN,ZLONMX,ZLATMN,ZLATMX,DELXBG,DELYBG,STMNMZ
  27899       STMNAM(1)=STMNMZ(1:9)
  27900       READ(IUNTVO,*) IZZ,IDATEJ,IUTC(1)
  27901       IDATE(1)=IDATEJ
  27902       BACKSPACE IUNTVO
  27903 C
  27904       IF(IEFLTP .EQ. 1)  THEN
  27905       RLONMN=ZLONMN
  27906       RLONMX=ZLONMX
  27907       RLATMN=ZLATMN
  27908       RLATMX=ZLATMX
  27909       XXDOM=360.
  27910       YYDOM=180.
  27911       XXANCH=0.0
  27912       YYANCH=90.
  27913 C
  27914       ELSE IF(IEFLTP .EQ. 2)  THEN
  27915 C
  27916       RLONMN=RLON1
  27917       RLONMX=RLON2
  27918       RLATMN=RLAT1
  27919       RLATMX=RLAT2
  27920       XXDOM=ABS(RLONMX-RLONMN)
  27921       YYDOM=    RLATMX-RLATMN
  27922       XXANCH=RLONMN
  27923       YYANCH=RLATMX
  27924       ELSE
  27925       WRITE(6,1)  IEFLTP
  27926     1 FORMAT(/'******ENVIRONMENTAL FILE TYPE NOT ALLOWED, IEFLTP=',I5)
  27927       CALL ABRT1(' COMBIN',1)
  27928       ENDIF
  27929 C
  27930       IF(RLONMN .LT. 0.0) RLONMN=360.+RLONMN
  27931       IF(RLONMX .LT. 0.0) RLONMX=360.+RLONMX
  27932 C
  27933       WRITE(IWRITE,199)
  27934   199 FORMAT(//)
  27935       WRITE(6,2) IEFLTP,IUNTVO,IUNTBG,RLATMN,RLATMX,RLONMN,RLONMX,RMAXST
  27936     2 FORMAT(/'...ENTERING COMBIN WITH IEFLTP,IUNTVO,IUNTBG,RLATMN,',
  27937      1       'RLATMX,RLONMN,RLONMX,RMAXST=',/,4X,3I5,5F10.2)
  27938 C
  27939       WRITE(6,3)
  27940       WRITE(6,3)
  27941       WRITE(6,4)
  27942       WRITE(6,5) STMNMZ,IDATE(1),IUTC(1),ADVORT
  27943       WRITE(6,4)
  27944       WRITE(6,3)
  27945       WRITE(6,3)
  27946     3 FORMAT(20X,'**********************************************')

Page 805         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  27947     4 FORMAT(20X,'****                                      ****')
  27948     5 FORMAT(20X,'****',8X,'STORM:',A13,11X,'****',/
  27949      1       20X,'****',4X,'DATE:',I9,' TIME:',I5,9X,'****',/
  27950      2       20X,'****',5X,'ADVORT:',L2,24X,'****')
  27951 C
  27952 C     INITIAL LOOK AT ENVIRONMENTAL FILE TO SET ARRAY SIZE
  27953 C        THEN CALCULATE LATITUDE AND LONGITUDES FOR THE GRIDDED POINTS.
  27954 C        WE ASSUME THAT GRIDDED POINTS ARE EQUALLY
  27955 C        SPACED IN LAT/LON.
  27956 C
  27957       IUNTMX=IUNTFE-1+MXUNTE
  27958       READ(IUNTFE)  ! this is the first "dummy" record
  27959       READ(IUNTFE)  IMAX,JMAX,((F(I,J),I=1,IMAX),J=1,JMAX),MTITLE,NCHAR
  27960       if(nchar.le.0) then
  27961          print *
  27962          print *
  27963          print *, '$$$$$$ nchar = 0!!!! - this should not happen'
  27964          print *
  27965          print *
  27966       else
  27967         WRITE(6,7)   IUNTFE,IUNTMX,IMAX,JMAX,MTITLE(1:NCHAR)
  27968     7    FORMAT(/'...INITIAL FILE READ, UNITS (',I2,', ',I2,') ',
  27969      1          'WILL BE READ, IMAX,JMAX,MTITLE=',2I5,/,4X,A,//)
  27970       end if
  27971 C
  27972 C     ALLOW FOR THE POSSIBILITY THAT THE FIRST FIELD IS A SCALAR,
  27973 C        AND THAT THERE ARE VECTOR FIELDS
  27974 C
  27975       IF(MTITLE(1:1) .NE. '$')  JMAX= JMAX*2
  27976       BACKSPACE IUNTFE
  27977 C
  27978       IF(IMAX .GT. MAXI .OR. JMAX .GT. MAX2J)  THEN
  27979       WRITE(6,9) IMAX,JMAX,MAXI,MAXJ
  27980     9 FORMAT('****** IMAX,JMAX=',2I5,' EXCEED MAXI,MAX2J=',2I5)
  27981       CALL ABRT1(' COMBIN',9)
  27982       ENDIF
  27983 C
  27984       MDIM=IMAX
  27985       NDIM=JMAX
  27986       NDIM2=NDIM/2
  27987       DELYLS=YYDOM/REAL(NDIM2-1)
  27988       IF(IEFLTP .EQ. 1)  DELXLS=XXDOM/REAL(MDIM)
  27989       IF(IEFLTP .EQ. 2)  DELXLS=XXDOM/REAL(MDIM-1)
  27990 C
  27991       DO 10 N=1,NDIM2
  27992       RLATLS(N)=YYANCH-(N-1)*DELYLS
  27993    10 CONTINUE
  27994 C
  27995       DO 20 M=1,MDIM
  27996       RLONLS(M)=XXANCH+(M-1)*DELXLS
  27997    20 CONTINUE
  27998       WRITE(6,21) (RLATLS(N),N=1,NDIM2)
  27999    21 FORMAT('...LATITUDES ARE',/,(5X,10F11.2))
  28000       WRITE(6,22) (RLONLS(M),M=1,MDIM)
  28001    22 FORMAT('...LONGITUDES ARE',/,(5X,10F11.2))
  28002 C
  28003 C     INITIALIZE STORAGE ARRAYS TO MISSING VALUES

Page 806         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28004 C
  28005       BOGDAT=RMISS
  28006       VORDAT=RMISS
  28007 C
  28008       WRITE(6,31) RLONMN,RLONMX,RLATMN,RLATMX,DELXBG,DELXLS,DELYBG,
  28009      1            DELYLS,STMNMZ
  28010    31 FORMAT('...INSERTION AREA DEFINED BY:',/,10X,'RLONMN=',F10.3,
  28011      1       /,10X,'RLONMX=',F10.3,/,10X,'RLATMN=',F10.3,/,10X,
  28012      2       'RLATMX=',F10.3,/,10X,'DELX (BG,LS)=',2F8.4,/,10X,
  28013      3       'DELY (BG,LS)=',2F8.4,/,10X,'STORM NAME=',A12)
  28014 C
  28015       IMODX=1
  28016       IMODY=1
  28017       IF(ABS(DELXBG-DELXLS) .GT. EPS .OR. ABS(DELYBG-DELYLS) .GT. EPS)
  28018      1   THEN
  28019       IMODX=IFIX(DELXBG/DELXLS+EPS)
  28020       IMODY=IFIX(DELYBG/DELYLS+EPS)
  28021       WRITE(6,32) DELXBG,DELXLS,DELYBG,DELYLS,IMODX,IMODY
  28022    32 FORMAT('...DELTAS DO NOT MATCH, MOD FUNCTION WILL BE INVOKED',/,
  28023      1       10X,'DELXBG,DELXLS,DELYBG,DELYLS=',4F10.4,'  IMODX,IMODY=',
  28024      2       2I5)
  28025       IF(IMODX .EQ. 0 .OR. IMODY .EQ. 0)  THEN
  28026       WRITE(6,33) DELXBG,DELXLS,DELYBG,DELYLS
  28027    33 FORMAT(' IMODX OR IMODY ARE ZERO: DELXBG, DELXLS, DELYBG, DELYLS='
  28028      1       ,4F10.4)
  28029       ENDIF
  28030       ENDIF
  28031 C
  28032 C     REMEMBER THAT NORTH POLE CORRESPONDS TO THE SMALLEST N INDEX
  28033 C
  28034       DO 40 N=1,NDIM2
  28035       NMX=N
  28036       IF(NINT(ABS(RLATLS(N)-RLATMN)*100.) .LT. NINT(EPS*100.))  GO TO 45
  28037    40 CONTINUE
  28038       WRITE(6,41) RLATMN
  28039    41 FORMAT('**** RLATLS DOES NOT AGREE WITH ANY RLATMN=',F10.4)
  28040       CALL ABRT1(' COMBIN',41)
  28041    45 DO 50 N=1,NDIM2
  28042       NMN=N
  28043       IF(NINT(ABS(RLATLS(N)-RLATMX)*100.) .LT. NINT(EPS*100.))  GO TO 55
  28044    50 CONTINUE
  28045       WRITE(6,51) RLATMX
  28046    51 FORMAT('**** RLATLS DOES NOT AGREE WITH ANY RLATMX=',F10.4)
  28047       CALL ABRT1(' COMBIN',51)
  28048    55 DO 60 M=1,MDIM
  28049       MMN=M
  28050       IF(NINT(ABS(RLONLS(M)-RLONMN)*100.) .LT. NINT(EPS*100.))  GO TO 65
  28051    60 CONTINUE
  28052       WRITE(6,61) RLONMN
  28053    61 FORMAT('**** RLONLS DOES NOT AGREE WITH ANY RLONMN=',F10.4)
  28054       CALL ABRT1(' COMBIN',61)
  28055    65 DO 70 M=1,MDIM
  28056       MMX=M
  28057       IF(NINT(ABS(RLONLS(M)-RLONMX)*100.) .LT. NINT(EPS*100.))  GO TO 75
  28058    70 CONTINUE
  28059       WRITE(6,71) RLONMX
  28060    71 FORMAT('**** RLONLS DOES NOT AGREE WITH ANY RLONMX=',F10.4)

Page 807         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28061       CALL ABRT1(' COMBIN',71)
  28062 C
  28063    75 CONTINUE
  28064 C
  28065 C     DO SOME CHECKS ON STORAGE SPACE FOR THE FENARA AND VORARA
  28066 C
  28067    76 MXXPTS=NINT(REAL(MMX-MMN+1)/IMODX)
  28068       IF(MXXPTS .GT. MAXBGI)  THEN
  28069       INCMOD=.TRUE.
  28070       WRITE(6,77)  MMX,MMN,MXXPTS,IMODX
  28071    77 FORMAT(/'...INCREMENTATION OF MOD FUNCTION IN X DIRECTION',
  28072      1       ' FOR SELECTION OF LARGE-SCALE AND BOGUS POINTS',/,
  28073      2       '    HAS BEEN NECESSARY BECAUSE MAXBGI IS TOO SMALL',/,
  28074      3       5X,'MXX,MMN,MXXPTS,IMODX=',4I5)
  28075       IMODX=IMODX+1
  28076       GO TO 76
  28077       ENDIF
  28078 C
  28079    78 NXXPTS=NINT(REAL(NMX-NMN+1)/IMODY)
  28080       IF(NXXPTS .GT. MAXBGJ)  THEN
  28081       INCMOD=.TRUE.
  28082       WRITE(6,79)  NMX,NMN,NXXPTS,IMODY
  28083    79 FORMAT(/'...INCREMENTATION OF MOD FUNCTION IN Y DIRECTION',
  28084      1       ' FOR SELECTION OF LARGE-SCALE AND BOGUS POINTS',/,
  28085      2       '    HAS BEEN NECESSARY BECAUSE MAXBGJ IS TOO SMALL',/,
  28086      3       5X,'NXX,NMN,NXXPTS,IMODY=',4I5)
  28087       IMODY=IMODY+1
  28088       GO TO 78
  28089       ENDIF
  28090 C
  28091 C     LOAD VARIABLES FROM LARGE-SCALE MODEL ARRAY
  28092 C
  28093       WRITE(6,799) NMN,NMX,IMODY,MMN,MMX,IMODX
  28094   799 FORMAT(/'...PREPARING TO LOAD VARIABLES FROM ENVIRONMENTAL ARRAY',
  28095      1       ', NMN,NMX,IMODY,MMN,MMX,IMODX=',6I5)
  28096       DO 100 NARA=1,999
  28097       CALL READAG(IUNTFE,MDIM,NDIM,F,KL,IV,IEND)
  28098       IF(IEND .EQ. 1)  GO TO 101
  28099 C
  28100 C     STORE ENVIRONMENTAL FIELDS INTO BOGUS ARRAY.  ALSO ASSIGN
  28101 C        LATITUDE AND LONGITUDE FOR THESE POINTS INTO
  28102 C        RLATLS, RLONLS ARRAYS
  28103 C
  28104       IF(.NOT. SETLON)  THEN
  28105         SETLON=.TRUE.
  28106         MXX=0
  28107         DO 80 M=MMN,MMX,IMODX
  28108         MXX=MXX+1
  28109         RLONLS(MXX)=RLONLS(M)
  28110    80   CONTINUE
  28111       ENDIF
  28112 C
  28113       NXX=0
  28114       DO N=NMN,NMX,IMODY
  28115          NXX=NXX+1
  28116          RLATLS(NXX)=RLATLS(N)
  28117 C

Page 808         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28118          MXX=0
  28119          DO M=MMN,MMX,IMODX
  28120             MXX=MXX+1
  28121             FENARA(MXX,NXX,KL,IV)=F(M,N)
  28122          END DO
  28123       END DO
  28124       WRITE(6,851)  KL,IV,MXX,NXX
  28125   851 FORMAT(//'    ....LARGE SCALE ARRAY: KL,IV,MXX,NXX=',4I5)
  28126       WRITE(6,852) (M,M=1,MXX)
  28127       WRITE(6,853) (RLONLS(M),M=1,MXX)
  28128   852 FORMAT(8X,10I11)
  28129   853 FORMAT(12X,10F11.2)
  28130       DO 856 N=1,NXX
  28131       WRITE(6,854) N,RLATLS(N)
  28132   854 FORMAT(I4,F8.2)
  28133       WRITE(6,857) (FENARA(M,N,KL,IV),M=1,MXX)
  28134   857 FORMAT(12X,10F11.2)
  28135   856 CONTINUE
  28136 C
  28137 C     DOUBLE CHECK CALCULATION OF MXXPTS
  28138 C
  28139       IF(MXXPTS .NE. MXX) THEN
  28140       WRITE(6,858) MXXPTS,MXX
  28141   858 FORMAT(/'***** A SEVERE ERROR HAS OCCURRED, MXXPTS=',I5,
  28142      1       ' NOT EQUAL TO MXX=',I5)
  28143       CALL ABRT1(' COMBIN',858)
  28144       ENDIF
  28145 C
  28146 C     STORE V
  28147 C
  28148       IF(IV .EQ. 4)  THEN
  28149       IV=5
  28150       NXX=0
  28151       DO N=NMN,NMX,IMODY
  28152          MXX=0
  28153          NXX=NXX+1
  28154          DO M=MMN,MMX,IMODX
  28155             MXX=MXX+1
  28156             FENARA(MXX,NXX,KL,IV)=F(M,N+NDIM2)
  28157          END DO
  28158       END DO
  28159       WRITE(6,911)  KL,IV,MXX,NXX
  28160   911 FORMAT(//'    ....LARGE SCALE ARRAY: KL,IV,MXX,NXX=',4I5)
  28161       WRITE(6,912) (M,M=1,MXX)
  28162       WRITE(6,913) (RLONLS(M),M=1,MXX)
  28163   912 FORMAT(8X,10I11)
  28164   913 FORMAT(12X,10F11.2)
  28165       DO 916 N=1,NXX
  28166       WRITE(6,914) N,RLATLS(N)
  28167   914 FORMAT(I4,F8.2)
  28168       WRITE(6,915) (FENARA(M,N,KL,IV),M=1,MXX)
  28169   915 FORMAT(12X,10F11.2)
  28170   916 CONTINUE
  28171       ENDIF
  28172   100 CONTINUE
  28173 C
  28174   101 CONTINUE

Page 809         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28175       IF(IUNTFE .LT. IUNTMX) THEN
  28176       WRITE(6,103) IUNTFE
  28177   103 FORMAT(/'...NOW READING UNIT',I2)
  28178       READ(IUNTFE)
  28179       GO TO 75
  28180       ENDIF
  28181 C
  28182 C     ***************************************
  28183 C     *****  BEGIN DIAGNOSTICS SECTION  *****
  28184 C     ***************************************
  28185 C
  28186       WRITE(6,105)
  28187   105 FORMAT(//10X,'*******  DIAGNOSTICS OF ENVIRONMENTAL FIELDS',
  28188      1       ' OVER BOGUS DOMAIN   *******')
  28189 C
  28190 C     CHECK GEOSTROPHY OF FILTERED ENVIRONMENTAL WIND FIELD
  28191 C
  28192       DO 130 KL=1,MAXBGK
  28193       PHI1=0.0
  28194       PHI2=0.0
  28195       PHI3=0.0
  28196       PHI4=0.0
  28197       IF(ABS(U(1,1,KL)-RMISS) .LT. EPS .OR.
  28198      1   ABS(Z(1,1,KL)-RMISS) .LT. EPS)  GO TO 130
  28199 C
  28200       DO 110 N=1,NXX
  28201       PHI1=PHI1+Z(1  ,N,KL)
  28202       PHI2=PHI2+Z(MXX,N,KL)
  28203   110 CONTINUE
  28204 C
  28205       DO 120 M=1,MXX
  28206       PHI3=PHI3+Z(M,1  ,KL)
  28207       PHI4=PHI4+Z(M,NXX,KL)
  28208   120 CONTINUE
  28209 C
  28210       PHI1=PHI1/REAL(NXX)
  28211       PHI2=PHI2/REAL(NXX)
  28212       PHI3=PHI3/REAL(MXX)
  28213       PHI4=PHI4/REAL(MXX)
  28214       WRITE(6,121) PRES(KL),PHI1,PHI2,PHI3,PHI4
  28215   121 FORMAT(/20X,'CHECKING GEOSTROPHY OF ENVIRONMENTAL FIELDS'//
  28216      1       '...PRES,PHI1,PHI2,PHI3,PHI4=',5F10.2)
  28217 C
  28218       UAVG=0.0
  28219       VAVG=0.0
  28220       DO N=1,NXX
  28221          DO M=1,MXX
  28222             UAVG=UAVG+U(M,N,KL)
  28223             VAVG=VAVG+V(M,N,KL)
  28224          END DO
  28225       END DO
  28226       UAVG=UAVG/REAL(MXX*NXX)
  28227       VAVG=VAVG/REAL(MXX*NXX)
  28228       WRITE(6,126) UAVG,VAVG
  28229   126 FORMAT('...AVERAGED U,V=',2F10.2)
  28230 C
  28231       DX=DISTSP_8(RLATLS(1),RLONLS(1),RLATLS(1),RLONLS(MXX))

Page 810         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28232       DY=DISTSP_8(RLATLS(1),RLONLS(1),RLATLS(NXX),RLONLS(1))
  28233       WRITE(6,127) DX,DY
  28234   127 FORMAT('...DX,DY=',2F12.2)
  28235 C
  28236       FCOR=OMEG*SINDEG_8(0.5*(RLATLS(1)+RLATLS(NXX)))
  28237       IF(ABS(FCOR) .LT. EPSFC)  FCOR=SIGN(EPSFC,FCOR)
  28238       VGEOS=GRAV*(PHI2-PHI1)/(FCOR*DX)
  28239       UGEOS=GRAV*(PHI4-PHI3)/(FCOR*DY)
  28240       WRITE(6,128) UGEOS,VGEOS
  28241   128 FORMAT('...GEOSTROPHIC U,V=',2F10.2,/)
  28242 C
  28243   130 CONTINUE
  28244 C
  28245 C     CALCULATE SOME COMPARISONS BETWEEN THE FILTERED ENVIRONMENTAL
  28246 C       WINDS AND THE 12 HOUR PAST STORM MOTION.
  28247 C     WE ONLY NEED TO ACCESS THE VITAL STATISTICS FILE FOR THE
  28248 C       STAND-ALONE MODE (ASSUMED TO BE THE GLOBAL LAT/LON FILE TYPE)
  28249 C
  28250       IF(IEFLTP .EQ. 1)  THEN
  28251       IOPT=2
  28252       IDTREQ=IDATEZ
  28253       IHRREQ=IUTCZ
  28254       IHRWIN=0
  28255 C
  28256       CALL NEWVIT(IOVITL,IPRNT,IOPT,IERVIT,NSTM,KSTORM,IDTREQ,IHRREQ,
  28257      1            IHRWIN,IDATE,IUTC,STMLAT,STMLON,STMDIR,STMSPD,PCEN,
  28258      2            PENV,RMAX,VMAX,RMW,R15NE,R15SE,R15SW,R15NW,PTOP,
  28259      3            FSTFLG,STMNAM,STMID,RSMC)
  28260 C
  28261       ELSE
  28262       STMLAT(1)=STMLTZ
  28263       STMLON(1)=STMLNZ
  28264       STMDIR(1)=STMDRZ
  28265       STMSPD(1)=STMSPZ
  28266       IDATE(1) =IDATEZ
  28267       IUTC(1)  =IUTCZ
  28268       PCEN (1) =PCENST
  28269       ENDIF
  28270 C
  28271 C     LONGITUDES HAVE BEEN CONVERTED TO 0-360 DEG LONGITUDE FORMAT IN
  28272 C       NEWVIT.
  28273 C
  28274       DO 140 N=NMN,NMX
  28275       NCEN=N
  28276       IF(NINT(RLATLS(N)*100.) .LT. NINT(STMLAT(1)*100.))  GO TO 145
  28277   140 CONTINUE
  28278   145 CONTINUE
  28279       DO 150 M=MMN,MMX
  28280       MCEN=M
  28281       IF(NINT(RLONLS(M)*100.) .GT. NINT(STMLON(1)*100.))  GO TO 155
  28282   150 CONTINUE
  28283 C
  28284   155 CONTINUE
  28285 C
  28286 C     STORM SPEED HAS BEEN CONVERTED TO M/SEC IN NEWVIT.
  28287 C
  28288       WRITE(6,156) NCEN,MCEN,RLONLS(MCEN-1),RLONLS(MCEN),RLATLS(NCEN-1),

Page 811         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28289      1             RLATLS(NCEN),STMLON(1),STMLAT(1)
  28290   156 FORMAT(//' ...NCEN,MCEN=',2I5,'. CLOSEST FOUR POINTS TO STORM ',
  28291      1       'ARE:',2F10.2,' LONGITUDE, AND',2F10.2,' LATITUDE.'/23X,
  28292      2       'STORM LON/LAT=',2F10.2//10X,'PRES',7X,'  ZONAL WIND',9X,
  28293      3       'MERID WIND',11X,'SPEED',12X,'DIRECTION',10X,'DIFFERENCE ',
  28294      4       'VECTOR (ENV-PERSIS)'/23X,4('ENV    STM',9X),'U',7X,'V',7X,
  28295      5       'DIR',4X,'SPEED')
  28296 C
  28297       ULMAVG=0.0
  28298       VLMAVG=0.0
  28299       CALL DS2UV(USTM,VSTM,STMDIR(1),STMSPD(1))
  28300 C
  28301 C     WEIGHTING OF 4 NEAREST NEIGHBORS IS INVERSELY PROPORTIONAL
  28302 C        TO SEPARATION FROM STORM POSITION
  28303 C
  28304       W1=DISTSP_8(RLATLS(NCEN  ),RLONLS(MCEN  ),STMLAT(1),STMLON(1))
  28305       W2=DISTSP_8(RLATLS(NCEN  ),RLONLS(MCEN-1),STMLAT(1),STMLON(1))
  28306       W3=DISTSP_8(RLATLS(NCEN-1),RLONLS(MCEN  ),STMLAT(1),STMLON(1))
  28307       W4=DISTSP_8(RLATLS(NCEN-1),RLONLS(MCEN-1),STMLAT(1),STMLON(1))
  28308 C
  28309       IF(W1 .LT. 1.)  THEN
  28310       W1=1.0
  28311       W2=0.0
  28312       W3=0.0
  28313       W4=0.0
  28314       ELSE IF(W2 .LT. 1.)  THEN
  28315       W1=0.0
  28316       W2=1.0
  28317       W3=0.0
  28318       W4=0.0
  28319       ELSE IF(W3 .LT. 1.)  THEN
  28320       W1=0.0
  28321       W2=0.0
  28322       W3=1.0
  28323       W4=0.0
  28324       ELSE IF(W4 .LT. 1.)  THEN
  28325       W1=0.0
  28326       W2=0.0
  28327       W3=0.0
  28328       W4=1.0
  28329       ELSE
  28330       W1=1./W1
  28331       W2=1./W2
  28332       W3=1./W3
  28333       W4=1./W4
  28334       ENDIF
  28335       WT=W1+W2+W3+W4
  28336 C
  28337       NLM=0
  28338       DO 170 KL=1,MAXBGK
  28339       UAVG=(W1*FENARA(MCEN,NCEN  ,KL,4)+W2*FENARA(MCEN-1,NCEN  ,KL,4)+
  28340      1      W3*FENARA(MCEN,NCEN-1,KL,4)+W4*FENARA(MCEN-1,NCEN-1,KL,4))
  28341      2      /WT
  28342       VAVG=(W1*FENARA(MCEN,NCEN  ,KL,5)+W2*FENARA(MCEN-1,NCEN  ,KL,5)+
  28343      1      W3*FENARA(MCEN,NCEN-1,KL,5)+W4*FENARA(MCEN-1,NCEN-1,KL,5))
  28344      2      /WT
  28345       IF(ABS(UAVG-RMISS) .GT. EPS)  THEN

Page 812         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28346       NLM=NLM+1
  28347       ULMAVG=ULMAVG+UAVG
  28348       VLMAVG=VLMAVG+VAVG
  28349       CALL UV2DS(UAVG,VAVG,ENVDIR,ENVSPD)
  28350       UDIF=UAVG-USTM
  28351       VDIF=VAVG-VSTM
  28352       CALL UV2DS(UDIF,VDIF,DIRDIF,SPDDIF)
  28353       WRITE(6,161) PRES(KL),UAVG,USTM,VAVG,VSTM,ENVSPD,STMSPD(1),
  28354      1             ENVDIR,STMDIR(1),UDIF,VDIF,DIRDIF,SPDDIF
  28355   161 FORMAT(7X,F7.1,6(3X,2F8.2))
  28356       ENDIF
  28357   170 CONTINUE
  28358       ULMAVG=ULMAVG/REAL(NLM)
  28359       VLMAVG=VLMAVG/REAL(NLM)
  28360       CALL UV2DS(ULMAVG,VLMAVG,ENVDIR,ENVSPD)
  28361       UDIF=ULMAVG-USTM
  28362       VDIF=VLMAVG-VSTM
  28363       CALL UV2DS(UDIF,VDIF,DIRDIF,SPDDIF)
  28364       WRITE(6,171) ULMAVG,USTM,VLMAVG,VSTM,ENVSPD,STMSPD(1),ENVDIR,
  28365      1             STMDIR(1),UDIF,VDIF,DIRDIF,SPDDIF
  28366   171 FORMAT(6X,'LYR MEAN',6(3X,2F8.2))
  28367 C
  28368 C     **********************************
  28369 C     ****  READ BOGUS VORTEX DATA  ****
  28370 C     **********************************
  28371 C
  28372       MBGMN= 9999
  28373       MBGMX=-9999
  28374       NBGMN= 9999
  28375       NBGMX=-9999
  28376       DO 200 IREAD=1,9999
  28377       CALL READBG(IUNTVO,RLATBG,RLONBG,KL,ZZ,UU,VV,IEND)
  28378       IF(IEND .EQ. 1)  GO TO 210
  28379 C
  28380 C     TRANSFORM LONGITUDE TO 0-360 DEG
  28381 C
  28382       RLONBG=MOD(360.-RLONBG,360.)
  28383       IPNFND=0
  28384 C
  28385 C     FIND MATCHING LOCATION IN LARGE SCALE ARRAY
  28386 C
  28387       DO 180 N=1,NXX
  28388       NBG=N
  28389       IF(NINT(ABS(RLATBG-RLATLS(N))*100.) .LT. NINT(EPS*100.)) GO TO 185
  28390   180 CONTINUE
  28391       IF(IPNFND .LT. IPMAX) THEN
  28392         IPNFND=IPNFND+1
  28393         WRITE(6,181) RLATBG,INCMOD
  28394   181   FORMAT('****** BOGUS POINT AT RLATBG=',F10.2,' COULD NOT BE',
  28395      1         ' FOUND, INCREMENT MOD FUNCTION IS:',L2)
  28396         IF(.NOT. INCMOD)  CALL ABRT1(' COMBIN',181)
  28397       ENDIF
  28398 C
  28399   185 DO 190 M=1,MXX
  28400       MBG=M
  28401       IF(NINT(ABS(RLONBG-RLONLS(M))*100.) .LT. NINT(EPS*100.)) GO TO 195
  28402   190 CONTINUE

Page 813         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28403       IF(IPNFND .LT. IPMAX) THEN
  28404         IPNFND=IPNFND+1
  28405         WRITE(6,191) RLONBG,INCMOD
  28406   191   FORMAT('****** BOGUS POINT AT RLONBG=',F10.2,' COULD NOT BE',
  28407      1         ' FOUND, INCREMENT MOD FUNCTION IS:',L2)
  28408         IF(.NOT. INCMOD)  CALL ABRT1(' COMBIN',191)
  28409       ENDIF
  28410 C
  28411   195 CONTINUE
  28412       VORARA(MBG,NBG,KL,3)=ZZ
  28413       VORARA(MBG,NBG,KL,4)=UU
  28414       VORARA(MBG,NBG,KL,5)=VV
  28415       MBGMN=MIN(MBGMN,MBG)
  28416       MBGMX=MAX(MBGMX,MBG)
  28417       NBGMN=MIN(NBGMN,NBG)
  28418       NBGMX=MAX(NBGMX,NBG)
  28419 C
  28420       IF(IEND .EQ. 1) GO TO 210
  28421   200 CONTINUE
  28422 C
  28423   210 CONTINUE
  28424 C
  28425 C     AVERAGE HEIGHTS AROUND BORDER.  WE WANT TO ADD THE ONLY THE
  28426 C        HEIGHT DEVIATION TO THE LARGE SCALE FIELD
  28427 C
  28428       DO 250 KL=1,MAXBGK
  28429       IF(VORARA(MBGMN,NBGMN,KL,3) .EQ. RMISS) GO TO 250
  28430       AVG=0.0
  28431       NAVG=0
  28432 C
  28433       DO 220 N=NBGMN,NBGMX
  28434       NAVG=NAVG+2
  28435       AVG=AVG+VORARA(MBGMN,N,KL,3)+VORARA(MBGMX,N,KL,3)
  28436   220 CONTINUE
  28437 C
  28438       DO 230 M=MBGMN+1,MBGMX-1
  28439       NAVG=NAVG+2
  28440       AVG=AVG+VORARA(M,NBGMN,KL,3)+VORARA(M,NBGMX,KL,3)
  28441   230 CONTINUE
  28442 C
  28443       AVG=AVG/REAL(NAVG)
  28444       WRITE(6,231) KL,AVG,NAVG
  28445   231 FORMAT(/'...AVERAGE HEIGHT FIELD FOR KL, AVG,NAVG=',I4,F12.3,I6)
  28446 C
  28447       DO N=NBGMN,NBGMX
  28448          DO M=MBGMN,MBGMX
  28449             VORARA(M,N,KL,3)=VORARA(M,N,KL,3)-AVG
  28450          END DO
  28451       END DO
  28452 C
  28453   250 CONTINUE
  28454 C
  28455 C     COMBINE LARGE SCALE FIELD AND BOGUS FOR ALL POINTS
  28456 C
  28457       WRITE(6,251)  IUNTBG,IRTYP,IRTYPC,IDATE(1),IUTC(1),ADVORT
  28458   251 FORMAT(//'...READY TO CREATE DATA FOR PREPBUFR ON UNIT=',I3,
  28459      1       '. IRTYP,IRTYPC,IDATE,IUTC=',2I5,2X,I10,3X,I5,

Page 814         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28460      2       ' ADD VORTEX=',L2///)
  28461 C
  28462 C     KEEP TRACK OF MAXIMUM NUMBER OF LEVELS IN ALL SOUNDINGS
  28463 C
  28464       IDATE0=IDATE(1)*100+IUTC(1)/100
  28465       MAXLEV=-99
  28466 C
  28467 C     WRITE DOMAIN PARAMETERS
  28468 C
  28469       WRITE(IUNTBG,253) RLATLS(NBGMX),RLATLS(NBGMN),RLONLS(MBGMX),
  28470      1                  RLONLS(MBGMN)
  28471       WRITE(6,253) RLATLS(NBGMX),RLATLS(NBGMN),RLONLS(MBGMX),
  28472      1             RLONLS(MBGMN)
  28473   253 FORMAT(2X,4F10.2)
  28474 C
  28475 C     REDEFINE MAXIMUM AND MINIMUM LAT/LON FOR THE EDTPRP STEP
  28476 C
  28477       RLAT1= 1.E10
  28478       RLAT2=-1.E10
  28479       RLON1= 1.E10
  28480       RLON2=-1.E10
  28481 C
  28482       DO N=1,NXX
  28483       DO M=1,MXX
  28484 C
  28485 C     WE DON'T WANT TO WRITE A BOGUS POINT VERY NEAR THE STORM CENTER
  28486 C
  28487       IF(NINT(ABS(RLATLS(N)-STMLAT(1))*100.) .LE. NINT(EPSLL*100.) .AND.
  28488      1   NINT(ABS(RLONLS(M)-STMLON(1))*100.) .LE. NINT(EPSLL*100.))
  28489      2   GO TO 300
  28490 C
  28491 C     WE MUST GUARANTEE THAT THE VORTEX IS IDENTICALLY ZERO OUTSIDE
  28492 C       RMAX.  IT CAN BE NON-ZERO DUE TO THE SPLINE FILTERING
  28493 C
  28494       ZEROIT=DISTSP_8(RLATLS(N),RLONLS(M),STMLAT(1),STMLON(1)) .GE.
  28495      1       RMAXST*1.E3
  28496 C
  28497 C     IF THIS STORM HAS BEEN BOGUSED BEFORE OR THERE IS A PRIOR
  28498 C       CIRCULATION IN THE GUESS FIELD (IFSTZ>=2), DO NOT WRITE
  28499 C       ANY DATA OUTSIDE RMAX.  THIS HELPS TO PREVENT VORTICITY
  28500 C       SWIRLS AT THE EDGES OF THE BOGUS DATA.
  28501 C
  28502       IF(ZEROIT .AND. IFSTZ .GE. 2)  GO TO 300
  28503 C
  28504       RLAT1=MIN(RLAT1,RLATLS(N))
  28505       RLAT2=MAX(RLAT2,RLATLS(N))
  28506       RLON1=MIN(RLON1,RLONLS(M))
  28507       RLON2=MAX(RLON2,RLONLS(M))
  28508 C
  28509       FRSTLV=.TRUE.
  28510       OUTPUT=.FALSE.
  28511       NLEV=0
  28512 C
  28513       DO 280 KL=1,MAXBGK
  28514 C
  28515       STORLV=.FALSE.
  28516       DO 260 KD=1,KDTDIM

Page 815         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28517       IF(ABS(FENARA(M,N,KL,KD)-RMISS) .GT. EPS .AND.
  28518      1   ABS(VORARA(M,N,KL,KD)-RMISS) .GT. EPS) STORLV=.TRUE.
  28519       IF(ZEROIT)  VORARA(M,N,KL,KD)=0.0
  28520   260 CONTINUE
  28521 C
  28522       IF(STORLV)  THEN
  28523       NLEV=NLEV+1
  28524         IF(MAXLEV .LT. NLEV)  THEN
  28525         IUAPRS(NLEV)=NINT(PRES(KL))
  28526         MAXLEV=NLEV
  28527         ENDIF
  28528       DATOUT(1,NLEV)=PRES(KL)
  28529         IF(FRSTLV)  THEN
  28530         RLAT=RLATLS(N)
  28531         RLON=RLONLS(M)
  28532         FRSTLV=.FALSE.
  28533         OUTPUT=.TRUE.
  28534 c && 2 comments
  28535 CC      WRITE(6,261) RLAT,RLON,DATOUT(1,NLEV)
  28536 CC261   FORMAT('...STORING BOGUS AT RLAT, RLON, PRES=',3F10.2)
  28537         ENDIF
  28538 C
  28539 C     NOTE: CONVENTION FOR MISSING DATA NOW SET TO -9999.9
  28540 C
  28541 C     THE OPTION TO NOT INCLUDE THE BOGUS VORTEX IS NOW ADDED
  28542 C        SET "ADVORT" TO .FALSE.
  28543 C
  28544         IF(ADVORT) THEN
  28545            DO KD=1,KDTDIM
  28546               DATOUT(KD+1,NLEV)=RMISS
  28547               IF(ABS(FENARA(M,N,KL,KD)-RMISS) .GT. EPS)
  28548      1         DATOUT(KD+1,NLEV)=FENARA(M,N,KL,KD)+VORARA(M,N,KL,KD)
  28549            END DO
  28550 C
  28551 C     QUICK FIX FOR SOME MOISTURE AT THE FOUR POINT SURROUNDING THE
  28552 C       STORM CENTER
  28553 C
  28554 C          IF(N .EQ. NCEN .OR. N .EQ. NCEN-1)  THEN
  28555 C             IF(M .EQ. MCEN .OR. M .EQ. MCEN-1)  THEN
  28556 C                DATOUT(3,NLEV)=RHCNTR
  28557 C             ENDIF
  28558 C          ENDIF
  28559 C
  28560         ELSE
  28561            DO KD=1,KDTDIM
  28562               DATOUT(KD+1,NLEV)=RMISS
  28563               IF(ABS(FENARA(M,N,KL,KD)-RMISS) .GT. EPS)
  28564      1         DATOUT(KD+1,NLEV)=FENARA(M,N,KL,KD)
  28565            END DO
  28566         ENDIF
  28567 C
  28568       ENDIF
  28569 C
  28570   280 CONTINUE
  28571 C
  28572 C     WRITE ASSEMBLED WIND BOGUS DATA TO OUTPUT FILE
  28573 C

Page 816         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28574       IF(OUTPUT)  THEN
  28575       WRITE(6,281)      IRTYP,IDATE0,IOFFT,RLAT,RLON,NLEV
  28576       WRITE(IUNTBG,281) IRTYP,IDATE0,IOFFT,RLAT,RLON,NLEV
  28577   281 FORMAT(3X,I3,1X,I10,2X,I4,2(2X,F6.2),3X,I3)
  28578       DO 290 KL=1,NLEV
  28579       WRITE(6,283)      NINT(DATOUT(1,KL)),DATOUT(4,KL),IQZ,
  28580      1                  DATOUT(2,KL),IQT,DATOUT(3,KL),IQM,
  28581      2                  DATOUT(5,KL),DATOUT(6,KL),IQV
  28582       WRITE(IUNTBG,283) NINT(DATOUT(1,KL)),DATOUT(4,KL),IQZ,
  28583      1                  DATOUT(2,KL),IQT,DATOUT(3,KL),IQM,
  28584      2                  DATOUT(5,KL),DATOUT(6,KL),IQV
  28585   283 FORMAT(3X,I4,3(1X,F8.2,4X,I1),2(1X,F8.2),4X,I1)
  28586   290 CONTINUE
  28587       ENDIF
  28588 C
  28589   300 CONTINUE
  28590       END DO
  28591       END DO
  28592 
  28593       IF(.NOT.MAK111)  GO TO 1000
  28594 
  28595 C     CREATE A BOGUS POINT AT THE REPORTED STORM CENTER AND WRITE TO
  28596 C        OUTPUT FILE.  THIS POINT CONTAINS MASS INFORMATION, RIGHT NOW
  28597 C        A SURFACE PRESSURE BASED ON THE REPORTED STORM CENTRAL
  28598 C        PRESSURE AND A SURFACE HEIGHT OF ZERO.  THE SURFACE PRESSURE
  28599 C        WILL BE ADJUSTED AND SPECIFIC HMUIDITY WILL BE ADDED LATER IN
  28600 C        SUBROUTINE EDTPRP. THIS WILL LATER GET PREPBUFR REPORT TYPE
  28601 C        111.
  28602 
  28603       IPSURF=NINT(PCEN(1))
  28604       ZSURF=0.0
  28605 
  28606 C     SKIP ANY MANDATORY LEVELS BELOW THE SURFACE LEVEL
  28607 
  28608       MAXLV1 = 1
  28609       DO KL=1,MAXLEV
  28610          IF(IUAPRS(KL). LT. IPSURF )  THEN
  28611             MAXLV1 = MAXLV1 + 1
  28612          END IF
  28613       END DO
  28614 
  28615 C     THE SURFACE LEVEL
  28616 
  28617       WRITE(6,281)      IRTYPC,IDATE0,IOFFT,STMLAT(1),STMLON(1),MAXLV1
  28618       WRITE(6,283)      IPSURF,ZSURF,IQZ,RMISS,IQT,RMISS,IQM,
  28619      1                  RMISS,RMISS,IQV
  28620       WRITE(IUNTBG,281) IRTYPC,IDATE0,IOFFT,STMLAT(1),STMLON(1),MAXLV1
  28621       WRITE(IUNTBG,283) IPSURF,ZSURF,IQZ,RMISS,IQT,RMISS,IQM,
  28622      1                  RMISS,RMISS,IQV
  28623 
  28624 C     ADDITIONAL LEVELS ABOVE SURFACE
  28625 
  28626       DO KL=1,MAXLEV
  28627          IF(IUAPRS(KL). LT. IPSURF )  THEN
  28628             WRITE(6,283)      IUAPRS(KL),RMISS,IQZ,RMISS,IQT,RMISS,IQM,
  28629      1                        RMISS,RMISS,IQV
  28630             WRITE(IUNTBG,283) IUAPRS(KL),RMISS,IQZ,RMISS,IQT,RMISS,IQM,

Page 817         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28631      1                        RMISS,RMISS,IQV
  28632          END IF
  28633       END DO
  28634 
  28635  1000 CONTINUE
  28636 
  28637       IF(INCMOD) CALL ABRT1(' COMBIN',1000)
  28638 
  28639       RETURN
  28640       END


ENTRY POINTS

  Name               
                     
 combin_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  27926                                                          27925                             
 10                         Label  27993                                                          27991                             
 100                        Label  28172                                                          28096                             
 1000                       Label  28635                                                          28593                             
 101                        Label  28174                                                          28098                             
 103                        Label  28177                                                          28176                             
 105                        Label  28187                                                          28186                             
 110                        Label  28203                                                          28200                             
 120                        Label  28208                                                          28205                             
 121                        Label  28215                                                          28214                             
 126                        Label  28229                                                          28228                             
 127                        Label  28234                                                          28233                             
 128                        Label  28241                                                          28240                             
 130                        Label  28243                                                          28192,28198                       
 140                        Label  28277                                                          28274                             
 145                        Label  28278                                                          28276                             
 150                        Label  28282                                                          28279                             
 155                        Label  28284                                                          28281                             
 156                        Label  28290                                                          28288                             
 161                        Label  28355                                                          28353                             
 170                        Label  28357                                                          28338                             
 171                        Label  28366                                                          28364                             
 180                        Label  28390                                                          28387                             
 181                        Label  28394                                                          28393                             
 185                        Label  28399                                                          28389                             
 190                        Label  28402                                                          28399                             
 191                        Label  28406                                                          28405                             
 195                        Label  28411                                                          28401                             
 199                        Label  27934                                                          27933                             
 2                          Label  27936                                                          27935                             
 20                         Label  27997                                                          27995                             
 200                        Label  28421                                                          28376                             
 21                         Label  27999                                                          27998                             
 210                        Label  28423                                                          28378,28420                       

Page 818         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 22                         Label  28001                                                          28000                             
 220                        Label  28436                                                          28433                             
 230                        Label  28441                                                          28438                             
 231                        Label  28445                                                          28444                             
 250                        Label  28453                                                          28428,28429                       
 251                        Label  28458                                                          28457                             
 253                        Label  28473                                                          28469,28471                       
 260                        Label  28520                                                          28516                             
 280                        Label  28570                                                          28513                             
 281                        Label  28577                                                          28575,28576,28617,28620           
 283                        Label  28585                                                          28579,28582,28618,28621,28628,2863
                                                                                                  0                                 
 290                        Label  28586                                                          28578                             
 3                          Label  27946                                                          27939,27940,27944,27945           
 300                        Label  28589                                                          28489,28502                       
 31                         Label  28010                                                          28008                             
 32                         Label  28022                                                          28021                             
 33                         Label  28027                                                          28026                             
 4                          Label  27947                                                          27941,27943                       
 40                         Label  28037                                                          28034                             
 41                         Label  28039                                                          28038                             
 45                         Label  28041                                                          28036                             
 5                          Label  27948                                                          27942                             
 50                         Label  28044                                                          28041                             
 51                         Label  28046                                                          28045                             
 55                         Label  28048                                                          28043                             
 60                         Label  28051                                                          28048                             
 61                         Label  28053                                                          28052                             
 65                         Label  28055                                                          28050                             
 7                          Label  27968                                                          27967                             
 70                         Label  28058                                                          28055                             
 71                         Label  28060                                                          28059                             
 75                         Label  28063                                                          28057,28179                       
 76                         Label  28067                                                          28076                             
 77                         Label  28071                                                          28070                             
 78                         Label  28079                                                          28088                             
 79                         Label  28083                                                          28082                             
 799                        Label  28094                                                          28093                             
 80                         Label  28110                                                          28107                             
 851                        Label  28125                                                          28124                             
 852                        Label  28128                                                          28126                             
 853                        Label  28129                                                          28127                             
 854                        Label  28132                                                          28131                             
 856                        Label  28135                                                          28130                             
 857                        Label  28134                                                          28133                             
 858                        Label  28141                                                          28140                             
 9                          Label  27980                                                          27979                             
 911                        Label  28160                                                          28159                             
 912                        Label  28163                                                          28161                             
 913                        Label  28164                                                          28162                             
 914                        Label  28167                                                          28166                             
 915                        Label  28169                                                          28168                             
 916                        Label  28170                                                          28165                             
 ABRT1                      Subr   27927                                                          27927,27981,28040,28047,28054,2806
                                                                                                  1,28143,28396,28408,28637         

Page 819         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   27920                                scalar                    27920,28017,28036,28043,28050,2805
                                                                                                  7,28197,28198,28237,28345,28389,28
                                                                                                  401,28487,28488,28517,28518,28547,
                                                                                                  28563                             
 ADVORT                     Dummy  27819    L(4)            4           scalar   ARG,INOUT        27942,28457,28544                 
 AVG                        Local  28430    R(4)            4           scalar   SAVE             28430,28435,28440,28443,28444,2844
                                                                                                  9                                 
 BOGDAT                     Local  27842    R(4)            4     1     61250    SAVE             28005                             
 COMBIN                     Subr   27819                                                                                            
 DATOUT                     Local  27844    R(4)            4     2     60       SAVE             28528,28546,28548,28562,28564,2857
                                                                                                  9,28580,28581,28582,28583,28584   
 DELXBG                     Local  27898    R(4)            4           scalar   SAVE             27898,28008,28017,28019,28021,2802
                                                                                                  6                                 
 DELXLS                     Local  27988    R(4)            4           scalar   SAVE             27988,27989,27996,28008,28017,2801
                                                                                                  9,28021,28026                     
 DELYBG                     Local  27898    R(4)            4           scalar   SAVE             27898,28008,28017,28020,28021,2802
                                                                                                  6                                 
 DELYLS                     Local  27987    R(4)            4           scalar   SAVE             27987,27992,28009,28017,28020,2802
                                                                                                  1,28026                           
 DIRDIF                     Local  28352    R(4)            4           scalar   SAVE             28352,28354,28363,28365           
 DISTSP_8                   Func   27836    R(8)            8           scalar                    28231,28232,28304,28305,28306,2830
                                                                                                  7,28494                           
 DS2UV                      Subr   28299                                                          28299                             
 DX                         Local  28231    R(4)            4           scalar   SAVE             28231,28233,28238                 
 DY                         Local  28232    R(4)            4           scalar   SAVE             28232,28233,28239                 
 ENVDIR                     Local  28349    R(4)            4           scalar   SAVE             28349,28354,28360,28364           
 ENVSPD                     Local  28349    R(4)            4           scalar   SAVE             28349,28353,28360,28364           
 EPS                        Local  27867    R(4)            4           scalar   SAVE             27867,28017,28019,28020,28036,2804
                                                                                                  3,28050,28057,28197,28198,28345,28
                                                                                                  389,28401,28517,28518,28547,28563 
 EPSFC                      Local  27867    R(4)            4           scalar   SAVE             27867,28237                       
 EPSLL                      Local  27867    R(4)            4           scalar   SAVE             27867,28487,28488                 
 F                          Dummy  27820    R(4)            4     2     0        ARG,INOUT        27959,28097,28121,28156           
 FCOR                       Local  28236    R(4)            4           scalar   SAVE             28236,28237,28238,28239           
 FENARA                     Local  27842    R(4)            4     4     61250    SAVE             28121,28133,28156,28168,28339,2834
                                                                                                  0,28342,28343,28517,28547,28548,28
                                                                                                  563,28564                         
 FRSTLV                     Local  27829    L(4)            4           scalar   SAVE             28509,28529,28532                 
 FSTFLG                     Local  27848    L(4)            4     1     1        SAVE             28259                             
 GRAV                       Local  27873    R(4)            4           scalar   SAVE             27873,28238,28239                 
 I                          Local  27959    I(4)            4           scalar   SAVE             27959                             
 IDATE                      Local  27851    I(4)            4     1     1        SAVE             27901,27942,28257,28266,28457,2846
                                                                                                  4                                 
 IDATE0                     Local  28464    I(4)            4           scalar   SAVE             28464,28575,28576,28617,28620     
 IDATEJ                     Local  27900    I(4)            4           scalar   SAVE             27900,27901                       
 IDATEZ                     Dummy  27821    I(4)            4           scalar   ARG,INOUT        28252,28266                       
 IDTREQ                     Local  28252    I(4)            4           scalar   SAVE             28252,28256                       
 IEFLTP                     Dummy  27819    I(4)            4           scalar   ARG,INOUT        27904,27914,27925,27935,27988,2798
                                                                                                  9,28250                           
 IEND                       Local  28097    I(4)            4           scalar   SAVE             28097,28098,28377,28378,28420     
 IERVIT                     Local  28256    I(4)            4           scalar   SAVE             28256                             
 IFIX                       Func   28019                                scalar                    28019,28020                       
 IFSTZ                      Dummy  27821    I(4)            4           scalar   ARG,INOUT        28502                             
 IHRREQ                     Local  28253    I(4)            4           scalar   SAVE             28253,28256                       
 IHRWIN                     Local  28254    I(4)            4           scalar   SAVE             28254,28257                       

Page 820         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IMAX                       Local  27959    I(4)            4           scalar   SAVE             27959,27967,27978,27979,27984     
 IMODX                      Local  28015    I(4)            4           scalar   SAVE             28015,28019,28021,28025,28067,2807
                                                                                                  0,28075,28093,28107,28119,28154   
 IMODY                      Local  28016    I(4)            4           scalar   SAVE             28016,28020,28021,28025,28079,2808
                                                                                                  2,28087,28093,28114,28151         
 INCMOD                     Local  27829    L(4)            4           scalar   SAVE             27890,28069,28081,28393,28396,2840
                                                                                                  5,28408,28637                     
 IOFFT                      Local  27873    I(4)            4           scalar   SAVE             27873,28575,28576,28617,28620     
 IOPT                       Local  28251    I(4)            4           scalar   SAVE             28251,28256                       
 IOVITL                     Local  27868    I(4)            4           scalar   SAVE             27868,28256                       
 IPMAX                      Local  27868    I(4)            4           scalar   SAVE             27868,28391,28403                 
 IPNFND                     Local  28383    I(4)            4           scalar   SAVE             28383,28391,28392,28403,28404     
 IPRNT                      Local  27868    I(4)            4           scalar   SAVE             27868,28256                       
 IPSURF                     Local  27874    I(4)            4           scalar   SAVE             27874,28603,28610,28618,28621,2862
                                                                                                  7                                 
 IQM                        Local  27874    I(4)            4           scalar   SAVE             27874,28580,28583,28618,28621,2862
                                                                                                  8,28630                           
 IQT                        Local  27874    I(4)            4           scalar   SAVE             27874,28580,28583,28618,28621,2862
                                                                                                  8,28630                           
 IQV                        Local  27867    I(4)            4           scalar   SAVE             27867,28581,28584,28619,28622,2862
                                                                                                  9,28631                           
 IQZ                        Local  27867    I(4)            4           scalar   SAVE             27867,28579,28582,28618,28621,2862
                                                                                                  8,28630                           
 IREAD                      Local  28376    I(4)            4           scalar   SAVE             28376                             
 IRTYP                      Local  27867    I(4)            4           scalar   SAVE             27867,28457,28575,28576           
 IRTYPC                     Local  27868    I(4)            4           scalar   SAVE             27868,28457,28617,28620           
 ITYP                       Scalar 27831    I(4)            4           scalar   COM                                                
 IUAPRS                     Local  27844    I(4)            4     1     10       SAVE             28525,28610,28627,28628,28630     
 IUNTBG                     Dummy  27819    I(4)            4           scalar   ARG,INOUT        27935,28457,28469,28576,28582,2862
                                                                                                  0,28621,28630                     
 IUNTFE                     Dummy  27819    I(4)            4           scalar   ARG,INOUT        27957,27958,27959,27967,27976,2809
                                                                                                  7,28175,28176,28178               
 IUNTMX                     Local  27957    I(4)            4           scalar   SAVE             27957,27967,28175                 
 IUNTVO                     Dummy  27819    I(4)            4           scalar   ARG,INOUT        27898,27900,27902,27935,28377     
 IUTC                       Local  27852    I(4)            4     1     1        SAVE             27900,27942,28257,28267,28457,2846
                                                                                                  4                                 
 IUTCZ                      Dummy  27821    I(4)            4           scalar   ARG,INOUT        28253,28267                       
 IV                         Local  28097    I(4)            4           scalar   SAVE             28097,28121,28124,28133,28148,2814
                                                                                                  9,28156,28159,28168               
 IWRITE                     Local  27868    I(4)            4           scalar   SAVE             27868,27933                       
 IZZ                        Local  27900    I(4)            4           scalar   SAVE             27900                             
 J                          Local  27959    I(4)            4           scalar   SAVE             27959                             
 JMAX                       Local  27959    I(4)            4           scalar   SAVE             27959,27967,27975,27978,27979,2798
                                                                                                  5                                 
 KD                         Local  28516    I(4)            4           scalar   SAVE             28516,28517,28518,28519,28545,2854
                                                                                                  6,28547,28548,28561,28562,28563,28
                                                                                                  564                               
 KDTDIM                     Param  27825    I(4)            4           scalar                    27825,27842,27843,27844,28516,2854
                                                                                                  5,28561                           
 KL                         Local  28097    I(4)            4           scalar   SAVE             28097,28121,28124,28133,28156,2815
                                                                                                  9,28168,28192,28197,28198,28201,28
                                                                                                  202,28206,28207,28214,28222,28223,
                                                                                                  28338,28339,28340,28342,28343,2835
                                                                                                  3,28377,28412,28413,28414,28428,28
                                                                                                  429,28435,28440,28444,28449,28513,

Page 821         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  28517,28518,28519,28525,28528,2854
                                                                                                  7,28548,28563,28564,28578,28579,28
                                                                                                  580,28581,28582,28583,28584,28609,
                                                                                                  28610,28626,28627,28628,28630     
 KSTORM                     Local  28256    I(4)            4           scalar   SAVE             28256                             
 M                          Local  27995    I(4)            4           scalar   SAVE             27995,27996,28000,28048,28049,2805
                                                                                                  0,28055,28056,28057,28107,28109,28
                                                                                                  119,28121,28126,28127,28133,28154,
                                                                                                  28156,28161,28162,28168,28205,2820
                                                                                                  6,28207,28221,28222,28223,28279,28
                                                                                                  280,28281,28399,28400,28401,28438,
                                                                                                  28440,28448,28449,28483,28488,2849
                                                                                                  4,28506,28507,28517,28518,28519,28
                                                                                                  531,28547,28548,28563,28564       
 MAK111                     Scalar 27832    L(4)            4           scalar   COM              28593                             
 MAX                        Func   28416                                scalar                    28416,28418,28505,28507           
 MAX2J                      Param  27823    I(4)            4           scalar                    27978                             
 MAXBG                      Param  27825    I(4)            4           scalar                    27842,27843                       
 MAXBGI                     Param  27824    I(4)            4           scalar                    27825,27839,27840,27841,27842,2784
                                                                                                  3,28068                           
 MAXBGJ                     Param  27824    I(4)            4           scalar                    27825,27839,27840,27841,27842,2784
                                                                                                  3,28080                           
 MAXBGK                     Param  27824    I(4)            4           scalar                    27825,27831,27839,27840,27841,2784
                                                                                                  2,27843,27844,28192,28338,28428,28
                                                                                                  513                               
 MAXF2J                     Dummy  27820    I(4)            4           scalar   ARG,INOUT        27838                             
 MAXFI                      Dummy  27820    I(4)            4           scalar   ARG,INOUT        27838                             
 MAXI                       Param  27823    I(4)            4           scalar                    27838,27978,27979                 
 MAXJ                       Param  27823    I(4)            4           scalar                    27823,27838,27979                 
 MAXLEV                     Local  28465    I(4)            4           scalar   SAVE             28465,28524,28526,28609,28626     
 MAXLV1                     Local  28608    I(4)            4           scalar   SAVE             28608,28611,28617,28620           
 MAXSTM                     Param  27826    I(4)            4           scalar                    27850,27851,27852,27853,27854,2785
                                                                                                  5                                 
 MBG                        Local  28400    I(4)            4           scalar   SAVE             28400,28412,28413,28414,28415,2841
                                                                                                  6                                 
 MBGMN                      Local  28372    I(4)            4           scalar   SAVE             28372,28415,28429,28435,28438,2844
                                                                                                  8,28470,28472                     
 MBGMX                      Local  28373    I(4)            4           scalar   SAVE             28373,28416,28435,28438,28448,2846
                                                                                                  9,28471                           
 MCEN                       Local  28280    I(4)            4           scalar   SAVE             28280,28288,28304,28305,28306,2830
                                                                                                  7,28339,28340,28342,28343         
 MDIM                       Local  27984    I(4)            4           scalar   SAVE             27984,27988,27989,27995,28000,2804
                                                                                                  8,28055,28097                     
 MIN                        Func   28415                                scalar                    28415,28417,28504,28506           
 MMN                        Local  28049    I(4)            4           scalar   SAVE             28049,28067,28070,28093,28107,2811
                                                                                                  9,28154,28279                     
 MMX                        Local  28056    I(4)            4           scalar   SAVE             28056,28067,28070,28093,28107,2811
                                                                                                  9,28154,28279                     
 MOD                        Func   28382                                scalar                    28382                             
 MTITLE                     Local  27828    CHAR            102         scalar   SAVE             27959,27967,27975                 
 MXUNTE                     Dummy  27819    I(4)            4           scalar   ARG,INOUT        27957                             
 MXX                        Local  28106    I(4)            4           scalar   SAVE             28106,28108,28109,28118,28120,2812
                                                                                                  1,28124,28126,28127,28133,28139,28
                                                                                                  140,28152,28155,28156,28159,28161,
                                                                                                  28162,28168,28202,28205,28212,2821

Page 822         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,28221,28226,28227,28231,28399,28
                                                                                                  483                               
 MXXPTS                     Local  28067    I(4)            4           scalar   SAVE             28067,28068,28070,28139,28140     
 N                          Local  27991    I(4)            4           scalar   SAVE             27991,27992,27998,28034,28035,2803
                                                                                                  6,28041,28042,28043,28114,28116,28
                                                                                                  121,28130,28131,28133,28151,28156,
                                                                                                  28165,28166,28168,28200,28201,2820
                                                                                                  2,28220,28222,28223,28274,28275,28
                                                                                                  276,28387,28388,28389,28433,28435,
                                                                                                  28447,28449,28482,28487,28494,2850
                                                                                                  4,28505,28517,28518,28519,28530,28
                                                                                                  547,28548,28563,28564             
 NARA                       Local  28096    I(4)            4           scalar   SAVE             28096                             
 NAVG                       Local  28431    I(4)            4           scalar   SAVE             28431,28434,28439,28443,28444     
 NBG                        Local  28388    I(4)            4           scalar   SAVE             28388,28412,28413,28414,28417,2841
                                                                                                  8                                 
 NBGMN                      Local  28374    I(4)            4           scalar   SAVE             28374,28417,28429,28433,28440,2844
                                                                                                  7,28469,28471                     
 NBGMX                      Local  28375    I(4)            4           scalar   SAVE             28375,28418,28433,28440,28447,2846
                                                                                                  9,28471                           
 NCEN                       Local  28275    I(4)            4           scalar   SAVE             28275,28288,28289,28304,28305,2830
                                                                                                  6,28307,28339,28340,28342,28343   
 NCHAR                      Local  27959    I(4)            4           scalar   SAVE             27959,27960,27967                 
 NDIM                       Local  27985    I(4)            4           scalar   SAVE             27985,27986,28097                 
 NDIM2                      Local  27986    I(4)            4           scalar   SAVE             27986,27987,27991,27998,28034,2804
                                                                                                  1,28156                           
 NEWVIT                     Subr   28256                                                          28256                             
 NINT                       Func   28036                                scalar                    28036,28043,28050,28057,28067,2807
                                                                                                  9,28276,28281,28389,28401,28487,28
                                                                                                  488,28525,28579,28582,28603       
 NLEV                       Local  28511    I(4)            4           scalar   SAVE             28511,28523,28524,28525,28526,2852
                                                                                                  8,28546,28548,28562,28564,28575,28
                                                                                                  576,28578                         
 NLM                        Local  28337    I(4)            4           scalar   SAVE             28337,28346,28358,28359           
 NMN                        Local  28042    I(4)            4           scalar   SAVE             28042,28079,28082,28093,28114,2815
                                                                                                  1,28274                           
 NMX                        Local  28035    I(4)            4           scalar   SAVE             28035,28079,28082,28093,28114,2815
                                                                                                  1,28274                           
 NSTM                       Param  27826    I(4)            4           scalar                    27826,28256                       
 NXX                        Local  28113    I(4)            4           scalar   SAVE             28113,28115,28116,28121,28124,2813
                                                                                                  0,28150,28153,28156,28159,28165,28
                                                                                                  200,28207,28210,28211,28220,28226,
                                                                                                  28227,28232,28236,28387,28482     
 NXXPTS                     Local  28079    I(4)            4           scalar   SAVE             28079,28080,28082                 
 OMEG                       Local  27875    R(4)            4           scalar   SAVE             27875,28236                       
 OUTPUT                     Local  27829    L(4)            4           scalar   SAVE             28510,28533,28574                 
 OVRHED                     Common 27831                                44       SAVE                                               
 P1000                      Local  27874    R(4)            4           scalar   SAVE             27874                             
 PCEN                       Local  27852    R(4)            4     1     1        SAVE             28257,28268,28603                 
 PCENST                     Dummy  27821    R(4)            4           scalar   ARG,INOUT        28268                             
 PENV                       Local  27852    R(4)            4     1     1        SAVE             28258                             
 PHI1                       Local  28193    R(4)            4           scalar   SAVE             28193,28201,28210,28214,28238     
 PHI2                       Local  28194    R(4)            4           scalar   SAVE             28194,28202,28211,28214,28238     
 PHI3                       Local  28195    R(4)            4           scalar   SAVE             28195,28206,28212,28214,28239     
 PHI4                       Local  28196    R(4)            4           scalar   SAVE             28196,28207,28213,28214,28239     

Page 823         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PRES                       Scalar 27831    R(4)            4     1     10       COM              28214,28353,28525,28528           
 PTOP                       Local  27853    R(4)            4     1     1        SAVE             28258                             
 R15NE                      Local  27854    R(4)            4     1     1        SAVE             28258                             
 R15NW                      Local  27854    R(4)            4     1     1        SAVE             28258                             
 R15SE                      Local  27854    R(4)            4     1     1        SAVE             28258                             
 R15SW                      Local  27854    R(4)            4     1     1        SAVE             28258                             
 READAG                     Subr   28097                                                          28097                             
 READBG                     Subr   28377                                                          28377                             
 REAL                       Func   27987                                scalar                    27987,27988,27989,28067,28079,2821
                                                                                                  0,28211,28212,28213,28226,28227,28
                                                                                                  358,28359,28443                   
 RGAS                       Local  27873    R(4)            4           scalar   SAVE             27873                             
 RH                         Local  27840    R(4)            4     3     12250    SAVE                                               
 RHCNTR                     Local  27889    R(4)            4           scalar   SAVE             27889                             
 RLAT                       Local  28530    R(4)            4           scalar   SAVE             28530,28575,28576                 
 RLAT1                      Dummy  27819    R(4)            4           scalar   ARG,INOUT        27918,28477,28504                 
 RLAT2                      Dummy  27820    R(4)            4           scalar   ARG,INOUT        27919,28478,28505                 
 RLATBG                     Local  28377    R(4)            4           scalar   SAVE             28377,28389,28393                 
 RLATLS                     Local  27838    R(4)            4     1     181      SAVE             27992,27998,28036,28043,28116,2813
                                                                                                  1,28166,28231,28232,28236,28276,28
                                                                                                  288,28289,28304,28305,28306,28307,
                                                                                                  28389,28469,28471,28487,28494,2850
                                                                                                  4,28505,28530                     
 RLATMN                     Local  27907    R(4)            4           scalar   SAVE             27907,27918,27921,27935,28008,2803
                                                                                                  6,28038                           
 RLATMX                     Local  27908    R(4)            4           scalar   SAVE             27908,27919,27921,27923,27935,2800
                                                                                                  8,28043,28045                     
 RLON                       Local  28531    R(4)            4           scalar   SAVE             28531,28575,28576                 
 RLON1                      Dummy  27820    R(4)            4           scalar   ARG,INOUT        27916,28479,28506                 
 RLON2                      Dummy  27820    R(4)            4           scalar   ARG,INOUT        27917,28480,28507                 
 RLONBG                     Local  28377    R(4)            4           scalar   SAVE             28377,28382,28401,28405           
 RLONLS                     Local  27838    R(4)            4     1     360      SAVE             27996,28000,28050,28057,28109,2812
                                                                                                  7,28162,28231,28232,28281,28288,28
                                                                                                  304,28305,28306,28307,28401,28469,
                                                                                                  28470,28471,28472,28488,28494,2850
                                                                                                  6,28507,28531                     
 RLONMN                     Local  27905    R(4)            4           scalar   SAVE             27905,27916,27920,27922,27930,2793
                                                                                                  5,28008,28050,28052               
 RLONMX                     Local  27906    R(4)            4           scalar   SAVE             27906,27917,27920,27931,27935,2800
                                                                                                  8,28057,28059                     
 RMAX                       Local  27852    R(4)            4     1     1        SAVE             28258                             
 RMAXST                     Dummy  27821    R(4)            4           scalar   ARG,INOUT        27935,28495                       
 RMISS                      Local  27874    R(4)            4           scalar   SAVE             27874,28005,28006,28197,28198,2834
                                                                                                  5,28429,28517,28518,28546,28547,28
                                                                                                  562,28563,28618,28619,28621,28622,
                                                                                                  28628,28629,28630,28631           
 RMW                        Local  27853    R(4)            4     1     1        SAVE             28258                             
 RSMC                       Local  27846    CHAR            4     1     1        SAVE             28259                             
 SETLON                     Local  27829    L(4)            4           scalar   SAVE             27891,28104,28105                 
 SIGN                       Func   28237                                scalar                    28237                             
 SINDEG_8                   Func   27836    R(8)            8           scalar                    28236                             
 SPDDIF                     Local  28352    R(4)            4           scalar   SAVE             28352,28354,28363,28365           
 SST                        Local  27873    R(4)            4           scalar   SAVE             27873                             
 STMDIR                     Local  27851    R(4)            4     1     1        SAVE             28257,28264,28299,28354,28365     
 STMDRZ                     Dummy  27821    R(4)            4           scalar   ARG,INOUT        28264                             

Page 824         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 STMID                      Local  27846    CHAR            3     1     1        SAVE             28259                             
 STMLAT                     Local  27850    R(4)            4     1     1        SAVE             28257,28262,28276,28289,28304,2830
                                                                                                  5,28306,28307,28487,28494,28617,28
                                                                                                  620                               
 STMLNZ                     Dummy  27820    R(4)            4           scalar   ARG,INOUT        28263                             
 STMLON                     Local  27850    R(4)            4     1     1        SAVE             28257,28263,28281,28289,28304,2830
                                                                                                  5,28306,28307,28488,28494,28617,28
                                                                                                  620                               
 STMLTZ                     Dummy  27820    R(4)            4           scalar   ARG,INOUT        28262                             
 STMNAM                     Local  27846    CHAR            9     1     1        SAVE             27899,28259                       
 STMNMZ                     Local  27828    CHAR            12          scalar   SAVE             27898,27899,27942,28009           
 STMSPD                     Local  27851    R(4)            4     1     1        SAVE             28257,28265,28299,28353,28364     
 STMSPZ                     Dummy  27821    R(4)            4           scalar   ARG,INOUT        28265                             
 STORLV                     Local  27829    L(4)            4           scalar   SAVE             28515,28518,28522                 
 T                          Local  27839    R(4)            4     3     12250    SAVE                                               
 T111SW                     Common 27832                                4        SAVE                                               
 TKEL                       Local  27873    R(4)            4           scalar   SAVE             27873                             
 U                          Local  27840    R(4)            4     3     12250    SAVE             28197,28222                       
 UAVG                       Local  28218    R(4)            4           scalar   SAVE             28218,28222,28226,28228,28339,2834
                                                                                                  5,28347,28349,28350,28353         
 UCALM                      Local  27887    R(4)            4           scalar   SAVE             27887                             
 UDIF                       Local  28350    R(4)            4           scalar   SAVE             28350,28352,28354,28361,28363,2836
                                                                                                  5                                 
 UGEOS                      Local  28239    R(4)            4           scalar   SAVE             28239,28240                       
 ULMAVG                     Local  28297    R(4)            4           scalar   SAVE             28297,28347,28358,28360,28361,2836
                                                                                                  4                                 
 USTM                       Local  28299    R(4)            4           scalar   SAVE             28299,28350,28353,28361,28364     
 UU                         Local  28377    R(4)            4           scalar   SAVE             28377,28413                       
 UV2DS                      Subr   28349                                                          28349,28352,28360,28363           
 V                          Local  27841    R(4)            4     3     12250    SAVE             28223                             
 VAVG                       Local  28219    R(4)            4           scalar   SAVE             28219,28223,28227,28228,28342,2834
                                                                                                  8,28349,28351,28353               
 VCALM                      Local  27888    R(4)            4           scalar   SAVE             27888                             
 VDIF                       Local  28351    R(4)            4           scalar   SAVE             28351,28352,28354,28362,28363,2836
                                                                                                  5                                 
 VGEOS                      Local  28238    R(4)            4           scalar   SAVE             28238,28240                       
 VLMAVG                     Local  28298    R(4)            4           scalar   SAVE             28298,28348,28359,28360,28362,2836
                                                                                                  4                                 
 VMAX                       Local  27853    R(4)            4     1     1        SAVE             28258                             
 VORARA                     Local  27843    R(4)            4     4     61250    SAVE             28412,28413,28414,28429,28435,2844
                                                                                                  0,28449,28518,28519,28548         
 VORDAT                     Local  27843    R(4)            4     1     61250    SAVE             28006                             
 VSTM                       Local  28299    R(4)            4           scalar   SAVE             28299,28351,28353,28362,28364     
 VV                         Local  28377    R(4)            4           scalar   SAVE             28377,28414                       
 W1                         Local  28304    R(4)            4           scalar   SAVE             28304,28309,28310,28315,28320,2832
                                                                                                  5,28330,28335,28339,28342         
 W2                         Local  28305    R(4)            4           scalar   SAVE             28305,28311,28314,28316,28321,2832
                                                                                                  6,28331,28335,28339,28342         
 W3                         Local  28306    R(4)            4           scalar   SAVE             28306,28312,28317,28319,28322,2832
                                                                                                  7,28332,28335,28340,28343         
 W4                         Local  28307    R(4)            4           scalar   SAVE             28307,28313,28318,28323,28324,2832
                                                                                                  8,28333,28335,28340,28343         
 WT                         Local  28335    R(4)            4           scalar   SAVE             28335,28341,28344                 
 XXANCH                     Local  27911    R(4)            4           scalar   SAVE             27911,27922,27996                 
 XXDOM                      Local  27909    R(4)            4           scalar   SAVE             27909,27920,27988,27989           

Page 825         Source Listing                  COMBIN
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YYANCH                     Local  27912    R(4)            4           scalar   SAVE             27912,27923,27992                 
 YYDOM                      Local  27910    R(4)            4           scalar   SAVE             27910,27921,27987                 
 Z                          Local  27839    R(4)            4     3     12250    SAVE             28198,28201,28202,28206,28207     
 ZEROIT                     Local  27829    L(4)            4           scalar   SAVE             28494,28502,28519                 
 ZLATMN                     Local  27898    R(4)            4           scalar   SAVE             27898,27907                       
 ZLATMX                     Local  27898    R(4)            4           scalar   SAVE             27898,27908                       
 ZLONMN                     Local  27898    R(4)            4           scalar   SAVE             27898,27905                       
 ZLONMX                     Local  27898    R(4)            4           scalar   SAVE             27898,27906                       
 ZSURF                      Local  28604    R(4)            4           scalar   SAVE             28604,28618,28621                 
 ZZ                         Local  28377    R(4)            4           scalar   SAVE             28377,28412                       

Page 826         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28641 
  28642 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  28643 C                .      .    .                                       .
  28644 C SUBPROGRAM:    EDTPRP      COPIES/EDITS PREPBUFR FILE, ADDS BOGUS
  28645 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2012-08-31
  28646 C
  28647 C ABSTRACT: FIRST, READS THROUGH THE INPUT PREPBUFR FILE AND COPIES
  28648 C   ALL DATA TO THE OUTPUT PREPBUFR FILE.  IN THE PROCESS OF DOING
  28649 C   THIS, - IF REQUESTED - CHECKS FOR MASS REPORTS IN THE VICINITY OF
  28650 C   ALL STORMS PROCESSED AND FLAGS THE PRESSURE Q.M. ON ALL LEVELS
  28651 C   FOR THESE REPORTS, ALSO - IF REQUESTED - CHECKS FOR DROPWINSONDE
  28652 C   WIND REPORTS IN THE VICINITY OF ALL STORMS PROCESSED AND FLAGS THE
  28653 C   WIND Q.M. ON ALL LEVELS FOR THESE REPORTS (SEE COMMENTS IN THIS
  28654 C   SUBROUTINE FOR DEFINITION OF "IN THE VICINITY").  IN BOTH CASES,
  28655 C   THIS WILL PREVENT THESE REPORTS FROM BEING ASSIMILATED BY THE
  28656 C   ANALYSIS.  FINALLY, - IF REQUESTED - APPENDS BOGUS REPORTS,
  28657 C   GENERATED EARLIER FOR EACH STORM, TO THE OUTPUT PREPBUFR FILE.
  28658 C
  28659 C PROGRAM HISTORY LOG:
  28660 C 1991-06-06  S. J. LORD - ORIGINAL AUTHOR
  28661 C 1999-06-28  D. A. KEYSER - MADE CODE MORE EFFICIENT BY SKIPPING
  28662 C        THE READING OF REPORTS OUT OF BUFR MESSAGES WHICH NEVER
  28663 C        CONTAIN MASS DATA OR NEVER CONTAIN PRESSURE SINCE THESE
  28664 C        DATA ARE NEVER EDITED BY THIS SUBROUTINE, INSTEAD
  28665 C        JUST COPIES SUCH MESSAGES DIRECTLY TO OUTPUT PREPBUFR FILE;
  28666 C        CORRECTED ERROR WHICH HAD RESULTED IN ONLY REPORTS IN THE
  28667 C        VICINITY OF THE FIRST STORM BEING SUBJECT TO EDITING (PRESS.
  28668 C        Q.M. FLAGGING); OUTPUT BOGUS REPORTS NOW HAVE UNIQUE STNIDS;
  28669 C        ADDED DOCBLOCK, COMMENTS, AND MORE STDOUT PRINT
  28670 C 1999-09-22  D. A. KEYSER - THE FLAGGING OF MASS REPORTS IN THE
  28671 C        VICINITY OF STORMS IS NOW CONTROLLED BY NEW N-LIST SWITCH
  28672 C        "FLMASS", IF FALSE THEN REPORTS WILL NOT BE FLAGGED
  28673 C 2001-09-27  D. A. KEYSER - ENCODES INTO THE PREPBUFR FILE A NEW
  28674 C        MASS BOGUS REPORT WITH R. TYPE 111 AT THE LOCATION OF THE
  28675 C        STORM (IF PRELIMINARY FORM OF REPORT WAS GENERATED EARLIER
  28676 C        IN SUBROUTINE COMIN), THIS ROUTINE ADJUSTS THE REPORTED STORM
  28677 C        CENTRAL PRESSURE ACCORDING TO THE FIRST GUESS PRESSURE AND
  28678 C        THE STORM CATEGORY ON THE SAFFIR-SIMPSON SCALE, IT THEN USES
  28679 C        THE GUESS TEMPERATURES AND AN ASSUMPTION OF 99% R.H. TO
  28680 C        GENERATE SPECIFIC HUMIDTY ON ALL LEVELS THROUGHOUT THE DEPTH
  28681 C        OF THE STORM
  28682 C 2001-10-10  D. A. KEYSER -- MODIFIED TO NOW PASS TWO SPANNING GLOBAL
  28683 C        SIGMA GUESS FILES INTO W3LIB ROUTINE GBLEVENTS IN SITUATIONS
  28684 C        WHERE THE CENTER DATE FOR THE PREPBUFR FILE HAS AN HOUR THAT
  28685 C        IS NOT A MULTIPLE OF 3 (SEE 2001-10-10 CHANGES TO GBLEVENTS);
  28686 C        ADDED PROGRAM CODE ("SYNDATA") AND REASON CODE (0) FOR ALL
  28687 C        BOGUS DATA CREATED IN REPORT TYPES 210, 100, 111 (FOR TYPE
  28688 C        111 THIS CAN BE UPDATED WITH EVENTS - SEE 2001-09-27)
  28689 C 2004-09-09  D. A. KEYSER - REPORTS IN NEW MESSAGE TYPE GPSIPW
  28690 C        ARE NOT READ BECAUSE THEY NEVER CONTAIN MASS DATA OR PRESSURE
  28691 C        AND THUS ARE NEVER EDITED BY THIS SUBROUTINE (THEY ARE
  28692 C        INCLUDED IN LIST OF MESSAGE TYPES COPIED DIRECTLY TO OUTPUT
  28693 C        PREPBUFR FILE)
  28694 C 2005-07-01  D. A. KEYSER - ADDED OPTION TO FLAG DROPWINSONDE WINDS
  28695 C        ON ALL LEVELS FOR STORMS SUFFICIENTLY CLOSE TO STORMS VIA NEW
  28696 C        NAMELIST SWITCH "FLBWND" (DEFAULTS TO TRUE) (SEE COMMENTS IN
  28697 C        THIS SUBROUTINE FOR DEFINITION OF "SUFFICIENTLY CLOSE"); ADDED

Page 827         Source Listing                  COMBIN
2017-04-18 11:09                                 syndata.f

  28698 C        OPTION TO NOT APPEND TYPE 110/210 BOGUS REPORTS TO PREPBUFR
  28699 C        FILE VIA NEW SCRIPT VARIABLE "DO_BOGUS" (OBTAINED VIA CALL TO
  28700 C        SYSTEM ROUTINE GETENV - DEFAULTS TO "YES")
  28701 C 2012-08-31  D. A. KEYSER - REMOVED DEPENDENCY OF MAK111 ON DO_BOGUS,
  28702 C        THUS IF DO_BOGUS=NO AND MAK111=TRUE TYPE 111 BOGUS REPORTS
  28703 C        WILL BE GENERATED EVEN THOUGH TYPE 110/220 BOGUS REPORTS ARE
  28704 C        NOT (BEFORE NEITHER WOULD BE GENERATED IF DO_BOGUS=NO); FIXED
  28705 C        STDOUT PRINT ERROR FOR LIMITING RADIUS OVERWHICH DROPSONDE
  28706 C        REPORTS WILL HAVE WIND QM'S FLAGGED
  28707 C
  28708 C USAGE:    CALL EDTPRP(BLATMN,BLATMX,BLONMN,BLONMX,RMW,STMLAT,STMLON,
  28709 C    1                  IUNTPN,IUNTPO,IUNTBG,LSTORM,vmax,stmnam)
  28710 C   INPUT ARGUMENT LIST:
  28711 C     BLATMN   - ARRAY CONTAINING MINIMUM LATITUDE FOR EACH STORM
  28712 C              - (WITHIN WHICH MASS OBSERVATIONS MAY BE FLAGGED)
  28713 C     BLATMX   - ARRAY CONTAINING MAXIMUM LATITUDE FOR EACH STORM
  28714 C              - (WITHIN WHICH MASS OBSERVATIONS MAY BE FLAGGED)
  28715 C     BLONMN   - ARRAY CONTAINING MINIMUM LONGITUDE FOR EACH STORM
  28716 C              - (WITHIN WHICH MASS OBSERVATIONS MAY BE FLAGGED)
  28717 C     BLONMX   - ARRAY CONTAINING MAXIMUM LONGITUDE FOR EACH STORM
  28718 C              - (WITHIN WHICH MASS OBSERVATIONS MAY BE FLAGGED)
  28719 C     RMW      - ARRAY CONTAINING RADIUS OF MAXIMUM SURFACE WIND FOR
  28720 C              - EACH STORM (USED TO CALCULATE RADIUS WITHIN WHICH
  28721 C              - DROPWINSONDE WIND OBSERVATIONS MAY BE FLAGGED)
  28722 C     STMLAT   - ARRAY CONTAINING CENTER LATITUDE FOR EACH STORM
  28723 C              - (USED TO DETERMINE IF DROPWINSONDE WIND OBSERVATIONS
  28724 C              - ARE SUFFICIENTLY CLOSE THAT THEY MAY BE FLAGGED)
  28725 C     STMLON   - ARRAY CONTAINING CENTER LONGITUDE FOR EACH STORM
  28726 C              - (USED TO DETERMINE IF DROPWINSONDE WIND OBSERVATIONS
  28727 C              - ARE SUFFICIENTLY CLOSE THAT THEY MAY BE FLAGGED)
  28728 C     IUNTPN   - UNIT NUMBER OF INPUT PREPBUFR FILE
  28729 C     IUNTPO   - UNIT NUMBER OF OUTPUT PREPBUFR FILE
  28730 C     IUNTBG   - UNIT NUMBER OF INPUT FILE CONTAINING BOGUS DATA
  28731 C     LSTORM   - NUMBER OF STORMS
  28732 C     vmax     - array containing maximum reported wind speed (m/s)
  28733 C              - for each storm
  28734 C     stmnam   - character*9 array containing storm names
  28735 C
  28736 C   INPUT FILES:
  28737 C     UNIT "IUNTBG"  - BOGUS DATA
  28738 C     UNIT "IUNTPN"  - PREPBUFR FILE PRIOR TO ADDITION OF BOGUS DATA OR
  28739 C                    - ANY MODIFICATIONS TO NON-BOGUS REPORTS
  28740 C
  28741 C   OUTPUT FILES:
  28742 C     UNIT 06        - STANDARD OUTPUT PRINT
  28743 C     UNIT "IUNTPO"  - PREPBUFR FILE WITH POSSIBLE ADDITION OF BOGUS
  28744 C                    - DATA AND/OR POSSIBLE MODIFICATIONS TO NON-BOGUS
  28745 C                    - REPORTS
  28746 C
  28747 C REMARKS: NONE.
  28748 C
  28749 C ATTRIBUTES:
  28750 C   LANGUAGE: FORTRAN 90
  28751 C   MACHINE:  NCEP WCOSS
  28752 C
  28753 C$$$
  28754       SUBROUTINE EDTPRP(BLATMN,BLATMX,BLONMN,BLONMX,RMW,STMLAT,STMLON,

Page 828         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  28755      1                  IUNTPN,IUNTPO,IUNTBG,LSTORM,vmax,stmnam)
  28756 
  28757       CHARACTER*80 CREC
  28758       CHARACTER*52 HDSTR,PESTR,WESTR,TZSTR,UVSTR,zstr,qstr
  28759       character*9  stmnam
  28760       CHARACTER*8  STNID,SUBSET,SYNSET,LAST
  28761       CHARACTER*3  DO_BOGUS
  28762       CHARACTER*2  PREFIX
  28763 
  28764       DIMENSION    IUNTGS(2)
  28765       DIMENSION    BLATMN(LSTORM),BLATMX(LSTORM),BLONMN(LSTORM),
  28766      $             BLONMX(LSTORM),RMW(LSTORM),STMLAT(LSTORM),
  28767      $             STMLON(LSTORM),RLON(LSTORM),vmax(lstorm),
  28768      $             icat(lstorm),padj(0:5),stmnam(lstorm)
  28769 
  28770       REAL(8)      HDR_8(6),PES_8(4,255),WES_8(5,255),TZS_8(13,255),
  28771      $             UVS_8(10,255),BMISS
  28772       real(8)      qevn_8(4,255),pevn_8(4,255),fcst_8(2,255),
  28773      $             zdta_8(5,255)
  28774       EQUIVALENCE  (STNID,HDR_8(1))
  28775 
  28776       LOGICAL  PREVEN,FLMASS,DROP,FLBWND,MAK111
  28777 
  28778       COMMON/PREVSW/PREVEN
  28779       COMMON/PROCSW/FLMASS,FLBWND,DO_BOGUS
  28780       COMMON/BUFRLIB_MISSING/BMISS
  28781 
  28782       COMMON/T111SW/MAK111
  28783 
  28784       DATA SYNSET /'SYNDAT'/
  28785       DATA PREFIX /'MA'/
  28786 
  28787       DATA HDSTR/'SID XOB YOB DHR TYP TSB                             '/
  28788       DATA PESTR/'POB PQM PPC PRC                                     '/
  28789       DATA WESTR/'UOB VOB WQM WPC WRC                                 '/
  28790       DATA TZSTR/'CAT POB PQM PPC PRC TOB TQM TPC TRC ZOB ZQM ZPC ZRC '/
  28791       DATA UVSTR/'CAT POB PQM PPC PRC UOB VOB WQM WPC WRC             '/
  28792       data zstr /'CAT ZOB ZQM ZPC ZRC                                 '/
  28793       data qstr /'QOB QQM QPC QRC                                     '/
  28794 
  28795       DATA IUNTGS/30,31/,IUNTOE/32/,IUNTSU/80/
  28796 
  28797 C Storm center pressure adjustment (from guess pressure) based on
  28798 C  Category -- cat.  0    1    2    3    4    5 
  28799       data padj /    0.,  0.,  4.,  8., 12., 15.  /
  28800 
  28801       SAVE
  28802 
  28803 C-----------------------------------------------------------------------
  28804 C-----------------------------------------------------------------------
  28805 C FCNS BELOW CONVERT TEMP/TD (K) & PRESS (MB) INTO SAT./ SPEC. HUM.(G/G)
  28806       ES(T) = 6.1078 * EXP((17.269 * (T - 273.16))/((T - 273.16)+237.3))
  28807       QFRMTP(T,P) = (0.622 * ES(T))/(P - (0.378 * ES(T)))
  28808 C-----------------------------------------------------------------------
  28809 C-----------------------------------------------------------------------
  28810 
  28811       LAST = 'XXXXXXXX'

Page 829         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  28812 
  28813 C  OPEN THE INPUT AND OUTPUT BUFR FILES
  28814 C  ------------------------------------
  28815 
  28816       CALL DATELEN(10)
  28817 
  28818       CALL OPENBF(IUNTPN,'IN',IUNTPN)
  28819       CALL READMG(IUNTPN,SUBSET,IDATBF,IRET)
  28820       IF(IRET.NE.0)  THEN
  28821          PRINT *, 'EDTPRP - ERROR OPENING INPUT PREPBUFR FILE'
  28822          CALL ERREXIT(20)
  28823       END IF
  28824       PRINT 789, IUNTPN,IDATBF
  28825   789 FORMAT(/' ===> EDTPRP: INPUT PREPBUFR FILE IN UNIT',I3,
  28826      $ ' SUCCESSFULLY OPENED - SECTION 1 MESSAGE DATE =',I11/)
  28827 
  28828       IF(IDATBF.LT.1000000000)  THEN
  28829 
  28830 C If 2-digit year returned in IDATBF, must use "windowing" technique
  28831 C  to create a 4-digit year
  28832 
  28833 C IMPORTANT: IF DATELEN(10) IS CALLED, THE DATE HERE SHOULD ALWAYS
  28834 C            CONTAIN A 4-DIGIT YEAR, EVEN IF INPUT FILE IS NOT
  28835 C            Y2K COMPLIANT (BUFRLIB DOES THE WINDOWING HERE)
  28836 
  28837          PRINT *, '##SYNDATA - THE FOLLOWING SHOULD NEVER HAPPEN!!!!!'
  28838          PRINT *, '##SYNDATA - 2-DIGIT YEAR IN IDATBF RETURNED FROM ',
  28839      $    'READMG (IDATBF IS: ',IDATBF,') - USE WINDOWING TECHNIQUE ',
  28840      $    'TO OBTAIN 4-DIGIT YEAR'
  28841          IF(IDATBF/1000000.GT.20)  THEN
  28842             IDATBF = 1900000000 + IDATBF
  28843          ELSE
  28844             IDATBF = 2000000000 + IDATBF
  28845          ENDIF
  28846          PRINT *, '##SYNDATA - CORRECTED IDATBF WITH 4-DIGIT YEAR, ',
  28847      $    'IDATBF NOW IS: ',IDATBF
  28848       ENDIF
  28849 
  28850       PRINT 1234
  28851  1234 FORMAT(//' ===> EDTPRP: THE ENTIRE PREPBUFR FILE WILL BE READ, ',
  28852      $ 'ALL MESSAGES ARE COPIED FROM INPUT PREPBUFR FILE TO OUTPUT ',
  28853      $ 'PREPBUFR FILE.'/15X,'STORM BOUNDARIES AND RADIUS OF MAXIMUM ',
  28854      $ 'SURFACE WIND WILL FOLLOW.'//)
  28855       IF(DO_BOGUS.EQ.'YES') PRINT 1336
  28856  1336 FORMAT(' ===> EDTPRP: TYPE 110/210 BOGUS REPORTS WILL BE ',
  28857      $ 'APPENDED TO PREPBUFR FILE.'//)
  28858       IF(MAK111) PRINT 8336
  28859  8336 FORMAT(' ===> EDTPRP: TYPE 111 BOGUS REPORTS WILL BE APPENDED TO',
  28860      $ ' PREPBUFR FILE.'//)
  28861       IF(FLMASS) PRINT 1335
  28862  1335 FORMAT(' ===> EDTPRP: ALL MASS REPORTS WITHIN THE STORM ',
  28863      $ 'BOUNDARIES WILL HAVE THEIR PRESSURE Q.M. FLAGGED ON EVERY ',
  28864      $ 'LEVEL.'//)
  28865       IF(FLBWND) PRINT 1236
  28866  1236 FORMAT(' ===> EDTPRP: ALL DROPWINSONDE REPORTS WITHIN A ',
  28867      $ 'DISTANCE TO STORM CENTER OF THE LARGER OF 111 KM OR 3 X THE ',
  28868      $ 'RADIUS OF MAXIMUM'/15X,'SURFACE WIND WILL HAVE THEIR WIND Q.M.',

Page 830         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  28869      $ ' FLAGGED ON EVERY LEVEL.'//)
  28870 
  28871       DO J = 1,LSTORM
  28872 
  28873 C Determine the Saffir-Simpson Storm Category based on the maximum
  28874 C  reported wind speed (use cateogry 0 for all speeds below hurricane
  28875 C  strength)
  28876 
  28877          vmax(j) = 1.94 * vmax(j)
  28878          if(vmax(j).gt.135.0) then
  28879             icat(j) = 5
  28880          else  if(vmax(j).gt.113.0) then
  28881             icat(j) = 4
  28882          else  if(vmax(j).gt.95.0) then
  28883             icat(j) = 3
  28884          else  if(vmax(j).gt.82.0) then
  28885             icat(j) = 2
  28886          else  if(vmax(j).gt.63.0) then
  28887             icat(j) = 1
  28888          else
  28889             icat(j) = 0
  28890          end if
  28891 
  28892 C  Convert the storm center longitude to west longitude (0-360)
  28893 C   (this is assuming storm center longitude comes in as 0-360 E)
  28894 C  --------------------------------------------------------------
  28895 
  28896          RLON(J) = 360. - STMLON(J)
  28897          IF(RLON(J).EQ.360.)  RLON(J) = 0.
  28898 
  28899          PRINT 1294, stmnam(j),J,STMLAT(J),RLON(J),BLATMN(J),BLATMX(J),
  28900      $    BLONMN(J),BLONMX(J),nint(RMW(J)),nint(vmax(j)),icat(j)
  28901  1294 FORMAT(1X,A9,'(storm #',i2,'):: center:',f7.2,'N lat, ',f8.2,
  28902      $ 'W lon; EDTPRP bdry: ',F7.2,' -',f7.2,'N lat and ',F8.2,
  28903      $ ' -',F8.2,'E lon'/24X,'Radius of max. wind speed is ',I4,
  28904      $ ' km; Max. wind speed is ',I3,' knots making this a Cat. ',I1,
  28905      $ ' storm'//)
  28906       ENDDO
  28907 
  28908       PRINT 1295
  28909  1295 FORMAT(//)
  28910       IF(.NOT.PREVEN)  THEN
  28911          PRINT 7300
  28912  7300 FORMAT(/1X,100('#')/' ===> EDTPRP: W3LIB ROUTINE GBLEVENTS NOT ',
  28913      $ 'INVOKED -- NAMELIST SWITCH "PREVEN" IS FALSE'/1X,100('#')/)
  28914          WRITE(IUNTSU,7300)
  28915          WRITE(IUNTSU,7301)
  28916  7301 FORMAT(130('#')//40X,'*** NO "PREVENT" EVENTS DATA FILTERING ***'
  28917      $ //)
  28918       END IF
  28919       PRINT 1295
  28920 
  28921       CALL CLOSBF(IUNTPN)
  28922       CALL OPENBF(IUNTPN,'IN',IUNTPN)
  28923 
  28924       CALL OPENBF(IUNTPO,'OUT',IUNTPN)
  28925       CALL UFBQCD(IUNTPO,'SYNDATA',SYNPC)

Page 831         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  28926 
  28927 C  VARIOUS COPYING OPTIONS
  28928 C  -----------------------
  28929 
  28930       ICPYMG = 0
  28931       ICNTOT = 0
  28932       ICNTMM = 0
  28933       ICNTMW = 0
  28934       ICNTTA = 0
  28935 
  28936    30 CONTINUE
  28937 
  28938       CALL READMG(IUNTPN,SUBSET,JDATBF,IRET)
  28939       IF(IRET.NE.0) GO TO 20
  28940       IF(.NOT.FLMASS.AND.(.NOT.FLBWND.OR.SUBSET.NE.'ADPUPA  '))  THEN
  28941 
  28942 C  NO NEED TO DECODE THIS MESSAGE IF FLMASS IS FALSE AND EITHER
  28943 C   FLBWND IS FALSE OR THIS MESSAGE TYPE IS NOT ADPUPA
  28944 C  ------------------------------------------------------------
  28945 
  28946          IF(SUBSET.NE.LAST)  THEN
  28947             IF(LAST.NE.'XXXXXXXX')  THEN
  28948                IF(LAST.NE.'ADPUPA  ')  THEN
  28949                   PRINT 2249, IUNTPN,LAST
  28950  2249 FORMAT(/' ===> EDTPRP: ALL MESSAGES IN INPUT PREPBUFR FILE IN ',
  28951      $ 'UNIT',I3,' WITH TABLE A ENTRY "',A8,'" PROCESSED -- '/15X,
  28952      $ 'SINCE FLMASS IS FALSE, NO INDIVIDUAL REPORTS WERE DECODED OUT ',
  28953      $ 'OF THESE MESSAGES'/)
  28954                ELSE
  28955                   IF(.NOT.FLBWND)  THEN
  28956                      PRINT 2250, IUNTPN,LAST
  28957  2250 FORMAT(/' ===> EDTPRP: ALL MESSAGES IN INPUT PREPBUFR FILE IN ',
  28958      $ 'UNIT',I3,' WITH TABLE A ENTRY "',A8,'" PROCESSED -- '/15X,
  28959      $ 'SINCE FLMASS AND FLBWND BOTH FALSE, NO INDIVIDUAL REPORTS ',
  28960      $ 'WERE DECODED OUT OF THESE MESSAGES'/)
  28961                   ELSE
  28962                      PRINT 1249, IUNTPN,LAST,ICNTTA
  28963                      CALL CLOSMG(IUNTPO)
  28964                   END IF
  28965                END IF
  28966                PRINT 1240, IUNTPN,SUBSET,JDATBF
  28967             END IF
  28968          END IF
  28969          LAST = SUBSET
  28970          CALL COPYMG(IUNTPN,IUNTPO)
  28971          GO TO 30
  28972       END IF
  28973       IF(SUBSET.NE.LAST)  THEN
  28974          ICPYMG = 0
  28975          IF(LAST.NE.'XXXXXXXX')  PRINT 1249, IUNTPN,LAST,ICNTTA
  28976  1249 FORMAT(/' ===> EDTPRP: ALL MESSAGES IN INPUT PREPBUFR FILE IN ',
  28977      $ 'UNIT',I3,' WITH TABLE A ENTRY "',A8,'" PROCESSED -- '/15X,
  28978      $ 'NUMBER OF INDIVIDUAL REPORTS DECODED OUT OF THESE MESSAGES =',
  28979      $ I6/)
  28980          ICNTTA = 0
  28981          PRINT 1240, IUNTPN,SUBSET,JDATBF
  28982  1240 FORMAT(/' ===> EDTPRP: NEXT MESSAGE IN INPUT PREPBUFR FILE IN ',

Page 832         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  28983      $ 'UNIT',I3,' HAS NEW TABLE A ENTRY OF "',A8,'" -- DATE IS',I11)
  28984 
  28985 C  NO NEED TO DECODE MESSAGES CONTAINING ONLY WIND DATA OR NO PRESSURE
  28986 C  -------------------------------------------------------------------
  28987 
  28988          IF(SUBSET.EQ.'SATWND  '.OR.SUBSET.EQ.'PROFLR  '.OR.
  28989      $      SUBSET.EQ.'VADWND  '.OR.SUBSET.EQ.'GOESND  '.OR.
  28990      $      SUBSET.EQ.'SPSSMI  '.OR.SUBSET.EQ.'ERS1DA  '.OR.
  28991      $      SUBSET.EQ.'GPSIPW  ') THEN
  28992             PRINT 1241, IUNTPO
  28993  1241 FORMAT(/' ===> EDTPRP: MESSAGES WITH THIS TABLE A ENTRY WILL ',
  28994      $ 'NEVER BE MODIFIED - COPY MESSAGES TO OUTPUT PREPBUFR FILE IN ',
  28995      $ 'UNIT',I3/)
  28996 
  28997 cc dak 7/3/05 - icpymg is ALWAYS zero here
  28998 cc dak 7/3/05 IF(ICPYMG.EQ.0.AND.LAST.NE.'XXXXXXXX') CALL CLOSMG(IUNTPO)
  28999             if(last.ne.'XXXXXXXX')  call closmg(iuntpo)
  29000 
  29001             ICPYMG = 1
  29002          ELSE  IF(SUBSET.EQ.'SYNDAT  ') THEN
  29003             PRINT 1291, IUNTPO
  29004  1291 FORMAT(/' ===> EDTPRP: MESSAGES WITH THIS TABLE A ENTRY WILL ',
  29005      $ 'NEVER BE PROCESSED NOR COPIED TO OUTPUT PREPBUFR FILE IN UNIT',
  29006      $ I3/15X,'SINCE THE BOGUS SYNDATA SHOULD NOT BE IN THE INPUT ',
  29007      $ 'PREPBUFR FILE'/)
  29008             ICPYMG = 1
  29009          ELSE
  29010             PRINT 1242, IUNTPO
  29011  1242 FORMAT(/' ===> EDTPRP: MESSAGES WITH THIS TABLE A ENTRY MAY BE ',
  29012      $ 'MODIFIED PRIOR TO THEIR OUTPUT TO PREPBUFR FILE IN UNIT',I3,/
  29013      $ 15X,' - EACH INDIVIDUAL REPORT MUST BE DECODED'/)
  29014          END IF
  29015       END IF
  29016       LAST = SUBSET
  29017 
  29018       IF(ICPYMG.EQ.1)  THEN
  29019 
  29020 C  "SYNDAT" MESSAGES SHOULD NEVER BE IN INPUT PREPBUFR FILE, BUT IF
  29021 C   THEY ARE DON'T COPY THEM TO OUTPUT PREPBUFR FILE
  29022 C  ----------------------------------------------------------------
  29023 
  29024          IF(SUBSET.NE.'SYNDAT  ')  THEN
  29025             CALL COPYMG(IUNTPN,IUNTPO)
  29026          ELSE
  29027             PRINT 2345, IUNTPN,IUNTPO
  29028  2345 FORMAT(/' ===> EDTPRP: MESSAGE WITH TABLE A ENTRY "SYNDAT  " ',
  29029      $ 'ENCOUNTERED IN INPUT PREPBUFR FILE IN UNIT',I3,/15X,'-- DO NOT',
  29030      $ ' COPY TO OUTPUT PREPBUFR FILE IN UNIT',I3/)
  29031          END IF
  29032          GO TO 30
  29033       END IF
  29034 
  29035       CALL OPENMB(IUNTPO,SUBSET,JDATBF)
  29036 
  29037    10 CONTINUE
  29038 
  29039       CALL READSB(IUNTPN,IRET)

Page 833         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29040       IF(IRET.NE.0) GO TO 30
  29041       ICNTTA = ICNTTA + 1
  29042       ICNTOT = ICNTOT + 1
  29043       CALL UFBCPY(IUNTPN,IUNTPO)
  29044       CALL UFBINT(IUNTPN,HDR_8,6,1,IRET,HDSTR)
  29045       XOB  = HDR_8(2)
  29046       YOB  = HDR_8(3)
  29047       KX   = HDR_8(5)
  29048       ITSB = HDR_8(6)
  29049       KK   = KX/100
  29050       DROP = (KX.EQ.232 .AND. ITSB.EQ.2)
  29051       IF(KK.EQ.2 .AND. .NOT.DROP) GO TO 15 !If this is a wind rpt other
  29052                                            ! than a drop, no chg made
  29053       IF(.NOT.DROP)  THEN
  29054          IF(FLMASS)  THEN
  29055 C-----------------------------------------------------------------------
  29056 C      Processing to flag pressure q.m. on all lvls for mass reports
  29057 C            within any one of the storm(s) lat/lon boundaries
  29058 C-----------------------------------------------------------------------
  29059             DO  J = 1,LSTORM
  29060                IF(NINT(XOB*100.).GE.NINT(BLONMN(J)*100.)) THEN
  29061                   IF(NINT(XOB*100.).LE.NINT(BLONMX(J)*100.)) THEN
  29062                      IF(NINT(YOB*100.).GE.NINT(BLATMN(J)*100.)) THEN
  29063                       IF(NINT(YOB*100.).LE.NINT(BLATMX(J)*100.))GOTO1500
  29064                      END IF
  29065                   END IF
  29066                END IF
  29067             ENDDO
  29068             GO TO 15
  29069  1500       CONTINUE
  29070             CALL UFBINT(IUNTPN,PES_8,4,255,NLEV,PESTR)
  29071             NFLAG = 0
  29072             DO J=1,NLEV
  29073                PQM = PES_8(2,J)
  29074                IF(PQM.LT.10) THEN
  29075                   PES_8(2,J) = 10
  29076                   PES_8(3,J) = SYNPC
  29077                   PES_8(4,J) = 10
  29078                   NFLAG = 1
  29079                ELSE
  29080                   PES_8(:,J) = BMISS
  29081                ENDIF
  29082             ENDDO
  29083             IF(NFLAG.EQ.1)  THEN
  29084                PRINT 7280
  29085  7280 FORMAT(/' ===> EDTPRP: ALL LEVEL PRESSURE Q. MARKS WERE FLAGGED ',
  29086      $ '(SET TO 10, R. CODE=10) FOR THE FOLLOWING NON-BOGUS REPORT:')
  29087                PRINT 7220, YOB,XOB,STNID,NLEV,HDR_8(4),KX
  29088  7220 FORMAT(1X,'LATITUDE =',F7.2,'  LONGITUDE=',F7.2,'  STN. ID  =',A8,
  29089      $ '  NO. LVLS =',I3,'  DEL. TIME=',F6.2,'  REP. TYPE=',I3/)
  29090                ICNTMM = ICNTMM + 1
  29091             END IF
  29092             CALL UFBINT(IUNTPO,PES_8,4,NLEV,IRET,PESTR)
  29093          END IF
  29094       ELSE
  29095          IF(FLBWND) THEN
  29096 C-----------------------------------------------------------------------

Page 834         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29097 C  Processing to flag wind q.m. on all lvls for dropwindonde reports
  29098 C   which are within the larger of 111 km or three times the radius of
  29099 C                  maximum surface wind of any storm
  29100 C-----------------------------------------------------------------------
  29101 
  29102 C  Convert reported dropwinsonde longitude to west longitude (0-360)
  29103 C   (this is assuming dropwinsonde longitude comes in as 0-360 E)
  29104 C  -----------------------------------------------------------------
  29105 
  29106             XOB = 360. - XOB
  29107             IF(XOB.EQ.360.)  XOB = 0.
  29108             DO  J = 1,LSTORM
  29109                JST = J
  29110                CALL CHDIST(RLON(J),STMLAT(J),XOB,YOB,RDIST)
  29111 cppppppppppppppp
  29112 cc          print *, '++ distance to storm ',jst,' = ',rdist,', max ',
  29113 cc   $       'limit for flagging is ',MAX(111.,3*RMW(J))
  29114 cc          print *, 'RLON(J),STMLAT(J),XOB,YOB: ',
  29115 cc   $                RLON(J),STMLAT(J),XOB,YOB
  29116 cppppppppppppppp
  29117                IF(RDIST.LE.(MAX(111.,3*RMW(J))))  GO TO 1600
  29118             ENDDO
  29119             GO TO 15
  29120  1600       CONTINUE
  29121             CALL UFBINT(IUNTPN,WES_8,5,255,NLEV,WESTR)
  29122             NFLAG = 0
  29123             DO J=1,NLEV
  29124                WQM = WES_8(3,J)
  29125                IF(WQM.LT.10) THEN
  29126                   WES_8(3,J) = 10
  29127                   WES_8(4,J) = SYNPC
  29128                   WES_8(5,J) = 99
  29129                   NFLAG = 1
  29130                ELSE
  29131                   WES_8(:,J) = BMISS
  29132                ENDIF
  29133             ENDDO
  29134             IF(NFLAG.EQ.1)  THEN
  29135                PRINT 8280
  29136  8280 FORMAT(/' ===> EDTPRP: ALL LEVEL WIND Q. MARKS WERE FLAGGED ',
  29137      $ '(SET TO 10, R. CODE=99) FOR THE FOLLOWING DROPWINSONDE REPORT:')
  29138                PRINT 8220, YOB,XOB,STNID,NLEV,HDR_8(4),KX,ITSB,JST,
  29139      $         NINT(RDIST),MAX(111,3*NINT(RMW(JST)))
  29140  8220 FORMAT(1X,'LATITUDE =',F7.2,'N  LONGITUDE=',F7.2,'W  STN. ID  =',
  29141      $ A8,'  NO. LVLS =',I3,'  DEL. TIME=',F6.2,'  REP. TYPE/SUBTYPE=',
  29142      $ I3,'/',I1/1X,'DIST. FROM STORM',I3,'=',I5,'KM WHICH IS WITHIN ',
  29143      $ 'LIMIT OF ',I5,'KM'/)
  29144                ICNTMW = ICNTMW + 1
  29145             END IF
  29146             CALL UFBINT(IUNTPO,WES_8,5,NLEV,IRET,WESTR)
  29147          END IF
  29148 C-----------------------------------------------------------------------
  29149       END IF
  29150    15 CONTINUE
  29151       CALL WRITSB(IUNTPO)
  29152       GOTO 10
  29153 

Page 835         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29154    20 CONTINUE
  29155       IF(.NOT.FLMASS.AND.(.NOT.FLBWND.OR.LAST.NE.'ADPUPA  '))  THEN
  29156          IF(LAST.NE.'ADPUPA  ')  THEN
  29157             PRINT 2249, IUNTPN,LAST
  29158          ELSE
  29159             PRINT 2250, IUNTPN,LAST
  29160          END IF
  29161       ELSE
  29162          PRINT 1249, IUNTPN,LAST,ICNTTA
  29163       END IF
  29164       PRINT 1259, IUNTPN,ICNTOT,ICNTMM,ICNTMW,IUNTPO
  29165  1259 FORMAT(//' ===> EDTPRP: ALL MESSAGES IN INPUT PREPBUFR FILE IN ',
  29166      $ 'UNIT',I3,' PROCESSED -'/16X,'NUMBER OF INDIVIDUAL REPORTS ',
  29167      $ 'DECODED OUT OF ALL MESSAGES =',I6,' -- OF THESE ...'/19X,
  29168      $ '-- TOTAL NUMBER OF MASS REPORTS ACTUALLY MODIFIED =',10X,I7/
  29169      $ 19X,'-- TOTAL NUMBER OF DROPWINSONDE WIND REPORTS ACTUALLY ',
  29170      $ 'MODIFIED = ',I3//15X,'OUTPUT PREPBUFR FILE IN UNIT',I3,
  29171      $ ' CONTAINS ALL ORIGINAL REPORTS PLUS ANY OF THESE MODIFICATIONS'
  29172      $ //)
  29173       CALL CLOSBF(IUNTPN)
  29174       PRINT 799, IUNTPN
  29175   799 FORMAT(/' ===> EDTPRP: INPUT PREPBUFR FILE IN UNIT',I3,
  29176      $ ' SUCCESSFULLY CLOSED'/)
  29177       CALL CLOSMG(IUNTPO)
  29178 
  29179       IF(DO_BOGUS.EQ.'NO' .AND. .NOT.MAK111)  THEN
  29180          CALL CLOSBF(IUNTPO)
  29181          PRINT 899, IUNTPO
  29182          PRINT 809
  29183   809 FORMAT(/' ===> EDTPRP: NO BOGUS DATA APPENDED TO PREPBUFR FILE ',
  29184      $ ' (AS REQUESTED)'/)
  29185          RETURN
  29186       END IF
  29187 
  29188       NEWTYP = 1
  29189 
  29190 C***********************************************************************
  29191 C***********************************************************************
  29192 C           ADD THE COMPLETE SET OF BOGUS REPORTS (FOR ALL STORMS)
  29193 C***********************************************************************
  29194 C***********************************************************************
  29195 
  29196       CALL OPENMG(IUNTPO,SYNSET,IDATBF)
  29197       IREPOT  = 0
  29198 
  29199   600 CONTINUE
  29200       READ(IUNTBG,'(A80)',END=100) CREC
  29201       IF(CREC(2:6).NE.'START') GO TO 600
  29202 
  29203 C This is "START" record, NSTORM tells us the storm number ...
  29204 
  29205       READ(CREC(22:24),'(I3)') NSTORM
  29206       READ(IUNTBG,'(A80)',END=100) CREC
  29207       IF(CREC(2:4).EQ.'END') GO TO 600
  29208 
  29209 C This is the first data record for this storm
  29210 

Page 836         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29211       ICOUNT = 0
  29212       IREP   = 0
  29213       IREPO  = 0
  29214       READ(CREC(3:42),'(4F10.2)') XLATMN,XLATMX,XLONMN,XLONMX
  29215 
  29216       PRINT 1235, stmnam(nstorm),NSTORM,XLATMN,XLATMX,XLONMN,XLONMX
  29217  1235 FORMAT(/116('!')/' ===> EDTPRP: For ',A9,' (storm #',I2,'), ',
  29218      $ 'ready to read in and process into PREPBUFR file all generated ',
  29219      $ 'bogus reports'/15X,'Boundary for reports is: ',F7.2,' - ',F7.2,
  29220      $ 'N lat and ',F8.2,' - ',F8.2,'E lon'/116('!')/)
  29221 
  29222    55 CONTINUE
  29223       READ(IUNTBG,'(A80)',END=100) CREC
  29224       IF(CREC(2:4).EQ.'END') THEN
  29225          PRINT 1275, stmnam(nstorm),NSTORM,IREPO,IUNTPO,SYNSET
  29226  1275 FORMAT(/116('i')/' ===> EDTPRP: All done processing bogus ',
  29227      $ 'reports for ',A9,'(storm #',I2,') - these',I4,' reports added ',
  29228      $ 'to '/15X,'PREPBUFR file in unit',I3,' under table A entry "',A8,
  29229      $ '"'/116('i')/)
  29230          GO TO 600
  29231       END IF
  29232       READ(CREC(4:45),'(I3,13X,I4,2(2X,F6.2),3X,I3)') IRTYP,ITIME,ALAT,
  29233      $ ALON,NLVLS
  29234       ICOUNT = ICOUNT+1
  29235       IREP   = IREP+1
  29236       if(irtyp.eq.210.or.irtyp.eq.110) WRITE(6,57) NSTORM,IREP,IRTYP,
  29237      $ ITIME,ALAT,ALON,NLVLS
  29238    57 FORMAT(' STORM#, EDPREP#, IRTYP,ITIME,ALAT,ALON,NLVLS=',4I10,
  29239      $ 2F10.2,I10)
  29240 
  29241 C  GENERATE REPORT ID
  29242 C  ------------------
  29243 
  29244       WRITE(STNID,'(A2,I2.2,I4.4)') PREFIX,NSTORM,ICOUNT
  29245       HDR_8(2) = ALON
  29246       HDR_8(3) = ALAT
  29247       HDR_8(4) = ITIME
  29248       HDR_8(5) = IRTYP
  29249       HDR_8(6) = BMISS
  29250 
  29251 C  READ AND STORE THE REPORT LEVELS
  29252 C  --------------------------------
  29253 
  29254       TZS_8  = BMISS
  29255       UVS_8  = BMISS
  29256       pevn_8 = BMISS
  29257       zdta_8 = BMISS
  29258       qevn_8 = bmiss
  29259       NLT  = 0
  29260       NLW  = 0
  29261       nltx = 0
  29262 
  29263       DO ILEV=1,NLVLS
  29264          READ (IUNTBG,58) IPOB,ZOB,IZQM,TOB,ITQM,QOB,IQQM,UOB,VOB,IWQM
  29265          IF((IRTYP.EQ.210.OR.IRTYP.EQ.110) .AND. DO_BOGUS.EQ.'YES') THEN
  29266             WRITE(6,58) IPOB,ZOB,IZQM,TOB,ITQM,QOB,IQQM,UOB,VOB,IWQM
  29267    58       FORMAT(3X,I4,3(1X,F8.2,4X,I1),2(1X,F8.2),4X,I1)

Page 837         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29268             IF(ZOB.GT.-9999 .OR. TOB.GT.-9999) THEN
  29269                NLT = NLT+1
  29270                TZS_8(1,NLT) = 1
  29271                TZS_8(2,NLT) = IPOB
  29272                TZS_8(3,NLT) = 1
  29273                TZS_8(4,NLT) = SYNPC
  29274                TZS_8(5,NLT) = 0
  29275                IF(TOB.GT.-9999) THEN
  29276                   TZS_8(6,NLT) = TOB
  29277                   TZS_8(7,NLT) = ITQM
  29278                   TZS_8(8,NLT) = SYNPC
  29279                   TZS_8(9,NLT) = 0
  29280                END IF
  29281                IF(ZOB.GT.-9999) THEN
  29282                    TZS_8(10,NLT) = ZOB
  29283                    TZS_8(11,NLT) = IZQM
  29284                    TZS_8(12,NLT) = SYNPC
  29285                    TZS_8(13,NLT) = 0
  29286                END IF
  29287             ENDIF
  29288             IF(UOB.GT.-9999 .AND. VOB.GT.-9999) THEN
  29289                NLW = NLW+1
  29290                UVS_8( 1,NLW) = 1
  29291                UVS_8( 2,NLW) = IPOB
  29292                UVS_8( 3,NLW) = 1
  29293                UVS_8( 4,NLW) = SYNPC
  29294                UVS_8( 5,NLW) = 0
  29295                UVS_8( 6,NLW) = UOB
  29296                UVS_8( 7,NLW) = VOB
  29297                UVS_8( 8,NLW) = IWQM
  29298                UVS_8( 9,NLW) = SYNPC
  29299                UVS_8(10,NLW) = 0
  29300             ENDIF
  29301          ELSE IF(IRTYP.EQ.111 .AND. MAK111) then
  29302             NLTX = NLTX+1
  29303             ZDTA_8(1,NLTX) = 1
  29304             IF(ILEV .EQ. 1)  ZDTA_8(1,NLTX) = 0
  29305             IF(ZOB.GT.-9999) THEN
  29306                ZDTA_8(2,NLTX) = ZOB
  29307                ZDTA_8(3,NLTX) = IZQM
  29308                ZDTA_8(4,NLTX) = SYNPC
  29309                ZDTA_8(5,NLTX) = 0
  29310             END IF
  29311             PEVN_8(1,NLTX) = IPOB
  29312             PEVN_8(2,NLTX) = 1
  29313             PEVN_8(3,NLTX) = SYNPC
  29314             PEVN_8(4,NLTX) = 0
  29315             IF (ILEV .EQ. 1)  THEN
  29316 
  29317 C The initial surface pressure for report type 111 (the reported
  29318 C  storm center pressure) is assigned a reason code of 2
  29319 
  29320                PEVN_8(2,NLTX) = 0
  29321                PEVN_8(3,NLTX) = SYNPC
  29322                PEVN_8(4,NLTX) = 2
  29323             END IF
  29324          ENDIF

Page 838         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29325       ENDDO
  29326 
  29327 C  WRITE THE REPORT(S) OUT
  29328 C  -----------------------
  29329 
  29330       IF(NLT.GT.0) THEN
  29331          CALL UFBINT(IUNTPO,HDR_8,6,  1,IRET,HDSTR)
  29332          CALL UFBINT(IUNTPO,TZS_8,13,NLT,IRET,TZSTR)
  29333 
  29334 C  CALL SUBROUTINE GBLEVENTS TO ENCODE BACKGROUND EVENTS FOR THIS REPORT
  29335 C  ---------------------------------------------------------------------
  29336 
  29337          IF(PREVEN)  CALL GBLEVENTS(IDATBF,IUNTGS,IUNTOE,IUNTPO,IUNTSU,
  29338      $    SYNSET,NEWTYP)
  29339          NEWTYP = 0
  29340          CALL WRITSB(IUNTPO)
  29341          IREPO   = IREPO+1
  29342          IREPOT  = IREPOT+1
  29343          PRINT 1298, IUNTPO,NINT(HDR_8(5))
  29344  1298 FORMAT(/' ===> EDTPRP: THIS BOGUS MASS REPORT SUCCESSFULLY ',
  29345      $ 'ENCODED INTO OUTPUT PREPBUFR FILE IN UNIT',I3,', RTYPE=',I3/)
  29346       ENDIF
  29347 
  29348       IF(NLW.GT.0) THEN
  29349          HDR_8(5) = HDR_8(5) + 100
  29350          CALL UFBINT(IUNTPO,HDR_8,6,  1,IRET,HDSTR)
  29351          CALL UFBINT(IUNTPO,UVS_8,10,NLW,IRET,UVSTR)
  29352 
  29353 C  CALL SUBROUTINE GBLEVENTS TO ENCODE BACKGROUND EVENTS FOR THIS REPORT
  29354 C  ---------------------------------------------------------------------
  29355 
  29356          IF(PREVEN)  CALL GBLEVENTS(IDATBF,IUNTGS,IUNTOE,IUNTPO,IUNTSU,
  29357      $    SYNSET,NEWTYP)
  29358          NEWTYP = 0
  29359          CALL WRITSB(IUNTPO)
  29360          IREPO   = IREPO+1
  29361          IREPOT  = IREPOT+1
  29362          PRINT 1260, IUNTPO,NINT(HDR_8(5))
  29363  1260 FORMAT(/' ===> EDTPRP: THIS BOGUS WIND REPORT SUCCESSFULLY ',
  29364      $ 'ENCODED INTO OUTPUT PREPBUFR FILE IN UNIT',I3,', RTYPE=',I3/)
  29365       ENDIF
  29366 
  29367       if(nltx.gt.0) then
  29368          call ufbint(IUNTPO,hdr_8,6,  1,iret,hdstr)
  29369          call ufbint(IUNTPO,zdta_8,5,nltx,iret,zstr)
  29370          call ufbint(IUNTPO,pevn_8,4,nltx,iret,pestr)
  29371 
  29372 C  CALL SUBROUTINE GBLEVENTS TO ENCODE BACKGROUND EVENTS FOR THIS REPORT
  29373 C  ---------------------------------------------------------------------
  29374 
  29375          if(preven)  call gblevents(idatbf,iuntgs,iuntoe,IUNTPO,iuntsu,
  29376      $    synset,newtyp)
  29377          newtyp = 0
  29378 
  29379 C Now, pull out the guess pressure and temperature
  29380 
  29381          call ufbint(-IUNTPO,fcst_8,2,255,nlev,'PFC TFC ')

Page 839         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29382          write(6,57) nstorm,irep,nint(hdr_8(5)),nint(hdr_8(4)),hdr_8(3),
  29383      $    hdr_8(2),nlev
  29384          do  ilev = 1,nlev
  29385             if(ibfms(fcst_8(1,ilev)).eq.0 .and. icat(nstorm).le.5 .and.
  29386      $                                     icat(nstorm).ge.0) then
  29387                pnew = fcst_8(1,ilev) - padj(icat(nstorm))
  29388                if(pnew.gt.pevn_8(1,ilev))  then
  29389 
  29390 C Next, update the surface pressure by using the guess pressure
  29391 C  along with an adjustment that is based on the Saffir-Simpson
  29392 C  Storm Category - as long as this updated pressure is greater
  29393 C  than the current pressure (the storm central pressure) this
  29394 C  updated pressure is encoded in the PREPBUFR file as an event
  29395 C  with reason code 3
  29396 
  29397                   pevn_8(1,ilev) = pnew
  29398                   pevn_8(2,ilev) = 0
  29399                   pevn_8(3,ilev) = synpc
  29400                   pevn_8(4,ilev) = 3
  29401                   call ufbint(IUNTPO,pevn_8(1,ilev),4,1,iret,pestr)
  29402                end if
  29403             end if
  29404             if(ibfms(fcst_8(2,ilev)).eq.0 .and. ibfms(pevn_8(1,ilev))
  29405      $        .eq.0)  then
  29406 
  29407 C Next, use the guess temperature and pressure obs. (just corrected at
  29408 C  surface) to generate a saturated specific humidity
  29409 
  29410                tkel = fcst_8(2,ilev) + 273.16
  29411                pevn = pevn_8(1,ilev)
  29412                qsat = qfrmtp(tkel,pevn) * 1.e6
  29413                if(qsat.gt.0 .and. qsat.lt.99999.)  then
  29414 
  29415 C Now, generate a specific humidity based on an assumed r.h. of 99%
  29416 C  and encode this as the specific humidity obs. on all levels 0
  29417 C  this event gets reason code 1
  29418 
  29419                   qevn_8(1,ilev) = 0.99 * qsat
  29420                   qevn_8(2,ilev) = 0
  29421                   qevn_8(3,ilev) = synpc
  29422                   qevn_8(4,ilev) = 1
  29423                end if
  29424             end if
  29425             write(6,758) pevn_8(1,ilev),nint(pevn_8(2,ilev)),
  29426      $       zdta_8(1,ilev),nint(zdta_8(2,ilev)),bmiss,nint(bmiss),
  29427      $       qevn_8(1,ilev),nint(qevn_8(2,ilev)),bmiss,bmiss,nint(bmiss)
  29428   758       format(3X,F6.1,4X,I2,3(1X,F8.2,4X,I1),2(1X,F8.2),4X,I1)
  29429          end do
  29430          call ufbint(IUNTPO,qevn_8,4,nlev,iret,qstr)
  29431          call writsb(IUNTPO)
  29432          irepo   = irepo+1
  29433          irepot  = irepot+1
  29434          print 1298, IUNTPO,nint(hdr_8(5))
  29435       endif
  29436 
  29437       IF(MAX(NLT,NLW,nltx).EQ.0) THEN
  29438          IF(DO_BOGUS.NE.'YES' .AND. MAK111) THEN

Page 840         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29439             PRINT 3299, IUNTPO
  29440  3299 FORMAT(/' ===> EDTPRP: THIS BOGUS REPORT   N O T   ENCODED ',
  29441      $ 'INTO OUTPUT PREPBUFR FILE IN UNIT',I3,' - DO_BOGUS=NO'/)
  29442          ELSE IF(DO_BOGUS.EQ.'YES' .AND. .NOT.MAK111) THEN
  29443             PRINT 4299, IUNTPO
  29444  4299 FORMAT(/' ===> EDTPRP: THIS BOGUS REPORT   N O T   ENCODED ',
  29445      $ 'INTO OUTPUT PREPBUFR FILE IN UNIT',I3,' - MAK111=FALSE'/)
  29446          ELSE
  29447             PRINT 1299, IUNTPO
  29448  1299 FORMAT(/' ===> EDTPRP: THIS BOGUS REPORT   N O T   ENCODED ',
  29449      $ 'INTO OUTPUT PREPBUFR FILE IN UNIT',I3/)
  29450          end if
  29451          ICOUNT = ICOUNT-1
  29452       END IF
  29453 
  29454       GOTO 55
  29455 
  29456   100 CONTINUE
  29457 
  29458       PRINT 1261, IUNTPO,IREPOT,SYNSET
  29459  1261 FORMAT(//' ===> EDTPRP: ALL DONE -- OUTPUT PREPBUFR FILE IN UNIT',
  29460      $ I3,' CONTAINS ALL ORIGINAL REPORTS (MAYBE WITH MODIFCATIONS)'/
  29461      $ 15X,'PLUS THESE',I5,' BOGUS REPORTS UNDER TABLE A ENTRY "',A8,
  29462      $ '"'//)
  29463 
  29464 C  NORMAL EXIT
  29465 C  -----------
  29466 
  29467       CALL CLOSMG(IUNTPO)
  29468       CALL CLOSBF(IUNTPO)
  29469       PRINT 899, IUNTPO
  29470   899 FORMAT(/' ===> EDTPRP: OUTPUT PREPBUFR FILE IN UNIT',I3,
  29471      $ ' SUCCESSFULLY CLOSED'/)
  29472 
  29473       RETURN
  29474       END

Page 841         Source Listing                  EDTPRP
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 edtprp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  29037                                                          29152                             
 100                        Label  29456                                                          29200,29206,29223                 
 1234                       Label  28851                                                          28850                             
 1235                       Label  29217                                                          29216                             
 1236                       Label  28866                                                          28865                             
 1240                       Label  28982                                                          28966,28981                       
 1241                       Label  28993                                                          28992                             
 1242                       Label  29011                                                          29010                             
 1249                       Label  28976                                                          28962,28975,29162                 
 1259                       Label  29165                                                          29164                             
 1260                       Label  29363                                                          29362                             
 1261                       Label  29459                                                          29458                             
 1275                       Label  29226                                                          29225                             
 1291                       Label  29004                                                          29003                             
 1294                       Label  28901                                                          28899                             
 1295                       Label  28909                                                          28908,28919                       
 1298                       Label  29344                                                          29343,29434                       
 1299                       Label  29448                                                          29447                             
 1335                       Label  28862                                                          28861                             
 1336                       Label  28856                                                          28855                             
 15                         Label  29150                                                          29051,29068,29119                 
 1500                       Label  29069                                                          29063                             
 1600                       Label  29120                                                          29117                             
 20                         Label  29154                                                          28939                             
 2249                       Label  28950                                                          28949,29157                       
 2250                       Label  28957                                                          28956,29159                       
 2345                       Label  29028                                                          29027                             
 30                         Label  28936                                                          28971,29032,29040                 
 3299                       Label  29440                                                          29439                             
 4299                       Label  29444                                                          29443                             
 55                         Label  29222                                                          29454                             
 57                         Label  29238                                                          29236,29382                       
 58                         Label  29267                                                          29264,29266                       
 600                        Label  29199                                                          29201,29207,29230                 
 7220                       Label  29088                                                          29087                             
 7280                       Label  29085                                                          29084                             
 7300                       Label  28912                                                          28911,28914                       
 7301                       Label  28916                                                          28915                             
 758                        Label  29428                                                          29425                             
 789                        Label  28825                                                          28824                             
 799                        Label  29175                                                          29174                             
 809                        Label  29183                                                          29182                             
 8220                       Label  29140                                                          29138                             
 8280                       Label  29136                                                          29135                             

Page 842         Source Listing                  EDTPRP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 8336                       Label  28859                                                          28858                             
 899                        Label  29470                                                          29181,29469                       
 ALAT                       Local  29232    R(4)            4           scalar   SAVE             29232,29237,29246                 
 ALON                       Local  29233    R(4)            4           scalar   SAVE             29233,29237,29245                 
 BLATMN                     Dummy  28754    R(4)            4     1     0        ARG,INOUT        28899,29062                       
 BLATMX                     Dummy  28754    R(4)            4     1     0        ARG,INOUT        28899,29063                       
 BLONMN                     Dummy  28754    R(4)            4     1     0        ARG,INOUT        28900,29060                       
 BLONMX                     Dummy  28754    R(4)            4     1     0        ARG,INOUT        28900,29061                       
 BMISS                      Scalar 28771    R(8)            8           scalar   COM              29080,29131,29249,29254,29255,2925
                                                                                                  6,29257,29258,29426,29427         
 BUFRLIB_MISSING            Common 28780                                8        SAVE                                               
 CHDIST                     Subr   29110                                                          29110                             
 CLOSBF                     Subr   28921                                                          28921,29173,29180,29468           
 CLOSMG                     Subr   28963                                                          28963,28999,29177,29467           
 COPYMG                     Subr   28970                                                          28970,29025                       
 CREC                       Local  28757    CHAR            80          scalar   SAVE             29200,29201,29205,29206,29207,2921
                                                                                                  4,29223,29224,29232               
 DATELEN                    Subr   28816                                                          28816                             
 DO_BOGUS                   Scalar 28761    CHAR            3           scalar   COM              28855,29179,29265,29438,29442     
 DROP                       Local  28776    L(4)            4           scalar   SAVE             29050,29051,29053                 
 EDTPRP                     Subr   28754                                                                                            
 ERREXIT                    Subr   28822                                                          28822                             
 ES                         Local  28806    R(4)            4           scalar                    28807                             
 EXP                        Func   28806                                scalar                    28806                             
 FCST_8                     Local  28772    R(8)            8     2     510      SAVE             29381,29385,29387,29404,29410     
 FLBWND                     Scalar 28776    L(4)            4           scalar   COM              28865,28940,28955,29095,29155     
 FLMASS                     Scalar 28776    L(4)            4           scalar   COM              28861,28940,29054,29155           
 GBLEVENTS                  Subr   29337                                                          29337,29356,29375                 
 HDR_8                      Local  28770    R(8)            8     1     6        SAVE             29044,29045,29046,29047,29048,2908
                                                                                                  7,29138,29245,29246,29247,29248,29
                                                                                                  249,29331,29343,29349,29350,29362,
                                                                                                  29368,29382,29383,29434           
 HDSTR                      Local  28758    CHAR            52          scalar   SAVE             28787,29044,29331,29350,29368     
 IBFMS                      Func   29385    I(4)            4           scalar                    29385,29404                       
 ICAT                       Local  28768    I(4)            4     1     0                         28879,28881,28883,28885,28887,2888
                                                                                                  9,28900,29385,29386,29387         
 ICNTMM                     Local  28932    I(4)            4           scalar   SAVE             28932,29090,29164                 
 ICNTMW                     Local  28933    I(4)            4           scalar   SAVE             28933,29144,29164                 
 ICNTOT                     Local  28931    I(4)            4           scalar   SAVE             28931,29042,29164                 
 ICNTTA                     Local  28934    I(4)            4           scalar   SAVE             28934,28962,28975,28980,29041,2916
                                                                                                  2                                 
 ICOUNT                     Local  29211    I(4)            4           scalar   SAVE             29211,29234,29244,29451           
 ICPYMG                     Local  28930    I(4)            4           scalar   SAVE             28930,28974,29001,29008,29018     
 IDATBF                     Local  28819    I(4)            4           scalar   SAVE             28819,28824,28828,28839,28841,2884
                                                                                                  2,28844,28847,29196,29337,29356,29
                                                                                                  375                               
 ILEV                       Local  29263    I(4)            4           scalar   SAVE             29263,29304,29315,29384,29385,2938
                                                                                                  7,29388,29397,29398,29399,29400,29
                                                                                                  401,29404,29410,29411,29419,29420,
                                                                                                  29421,29422,29425,29426,29427     
 IPOB                       Local  29264    I(4)            4           scalar   SAVE             29264,29266,29271,29291,29311     
 IQQM                       Local  29264    I(4)            4           scalar   SAVE             29264,29266                       
 IREP                       Local  29212    I(4)            4           scalar   SAVE             29212,29235,29236,29382           
 IREPO                      Local  29213    I(4)            4           scalar   SAVE             29213,29225,29341,29360,29432     
 IREPOT                     Local  29197    I(4)            4           scalar   SAVE             29197,29342,29361,29433,29458     

Page 843         Source Listing                  EDTPRP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IRET                       Local  28819    I(4)            4           scalar   SAVE             28819,28820,28938,28939,29039,2904
                                                                                                  0,29044,29092,29146,29331,29332,29
                                                                                                  350,29351,29368,29369,29370,29401,
                                                                                                  29430                             
 IRTYP                      Local  29232    I(4)            4           scalar   SAVE             29232,29236,29248,29265,29301     
 ITIME                      Local  29232    I(4)            4           scalar   SAVE             29232,29237,29247                 
 ITQM                       Local  29264    I(4)            4           scalar   SAVE             29264,29266,29277                 
 ITSB                       Local  29048    I(4)            4           scalar   SAVE             29048,29050,29138                 
 IUNTBG                     Dummy  28755    I(4)            4           scalar   ARG,INOUT        29200,29206,29223,29264           
 IUNTGS                     Local  28764    I(4)            4     1     2        SAVE             28795,29337,29356,29375           
 IUNTOE                     Local  28795    I(4)            4           scalar   SAVE             28795,29337,29356,29375           
 IUNTPN                     Dummy  28755    I(4)            4           scalar   ARG,INOUT        28818,28819,28824,28921,28922,2892
                                                                                                  4,28938,28949,28956,28962,28966,28
                                                                                                  970,28975,28981,29025,29027,29039,
                                                                                                  29043,29044,29070,29121,29157,2915
                                                                                                  9,29162,29164,29173,29174         
 IUNTPO                     Dummy  28755    I(4)            4           scalar   ARG,INOUT        28924,28925,28963,28970,28992,2899
                                                                                                  9,29003,29010,29025,29027,29035,29
                                                                                                  043,29092,29146,29151,29164,29177,
                                                                                                  29180,29181,29196,29225,29331,2933
                                                                                                  2,29337,29340,29343,29350,29351,29
                                                                                                  356,29359,29362,29368,29369,29370,
                                                                                                  29375,29381,29401,29430,29431,2943
                                                                                                  4,29439,29443,29447,29458,29467,29
                                                                                                  468,29469                         
 IUNTSU                     Local  28795    I(4)            4           scalar   SAVE             28795,28914,28915,29337,29356,2937
                                                                                                  5                                 
 IWQM                       Local  29264    I(4)            4           scalar   SAVE             29264,29266,29297                 
 IZQM                       Local  29264    I(4)            4           scalar   SAVE             29264,29266,29283,29307           
 J                          Local  28871    I(4)            4           scalar   SAVE             28871,28877,28878,28879,28880,2888
                                                                                                  1,28882,28883,28884,28885,28886,28
                                                                                                  887,28889,28896,28897,28899,28900,
                                                                                                  29059,29060,29061,29062,29063,2907
                                                                                                  2,29073,29075,29076,29077,29080,29
                                                                                                  108,29109,29110,29117,29123,29124,
                                                                                                  29126,29127,29128,29131           
 JDATBF                     Local  28938    I(4)            4           scalar   SAVE             28938,28966,28981,29035           
 JST                        Local  29109    I(4)            4           scalar   SAVE             29109,29138,29139                 
 KK                         Local  29049    I(4)            4           scalar   SAVE             29049,29051                       
 KX                         Local  29047    I(4)            4           scalar   SAVE             29047,29049,29050,29087,29138     
 LAST                       Local  28760    CHAR            8           scalar   SAVE             28811,28946,28947,28948,28949,2895
                                                                                                  6,28962,28969,28973,28975,28999,29
                                                                                                  016,29155,29156,29157,29159,29162 
 LSTORM                     Dummy  28755    I(4)            4           scalar   ARG,INOUT        28765,28766,28767,28768,28871,2905
                                                                                                  9,29108                           
 MAK111                     Scalar 28776    L(4)            4           scalar   COM              28858,29179,29301,29438,29442     
 MAX                        Func   29117                                scalar                    29117,29139,29437                 
 NEWTYP                     Local  29188    I(4)            4           scalar   SAVE             29188,29338,29339,29357,29358,2937
                                                                                                  6,29377                           
 NFLAG                      Local  29071    I(4)            4           scalar   SAVE             29071,29078,29083,29122,29129,2913
                                                                                                  4                                 
 NINT                       Func   28900                                scalar                    28900,29060,29061,29062,29063,2913
                                                                                                  9,29343,29362,29382,29425,29426,29
                                                                                                  427,29434                         
 NLEV                       Local  29070    I(4)            4           scalar   SAVE             29070,29072,29087,29092,29121,2912

Page 844         Source Listing                  EDTPRP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,29138,29146,29381,29383,29384,29
                                                                                                  430                               
 NLT                        Local  29259    I(4)            4           scalar   SAVE             29259,29269,29270,29271,29272,2927
                                                                                                  3,29274,29276,29277,29278,29279,29
                                                                                                  282,29283,29284,29285,29330,29332,
                                                                                                  29437                             
 NLTX                       Local  29261    I(4)            4           scalar   SAVE             29261,29302,29303,29304,29306,2930
                                                                                                  7,29308,29309,29311,29312,29313,29
                                                                                                  314,29320,29321,29322,29367,29369,
                                                                                                  29370,29437                       
 NLVLS                      Local  29233    I(4)            4           scalar   SAVE             29233,29237,29263                 
 NLW                        Local  29260    I(4)            4           scalar   SAVE             29260,29289,29290,29291,29292,2929
                                                                                                  3,29294,29295,29296,29297,29298,29
                                                                                                  299,29348,29351,29437             
 NSTORM                     Local  29205    I(4)            4           scalar   SAVE             29205,29216,29225,29236,29244,2938
                                                                                                  2,29385,29386,29387               
 OPENBF                     Subr   28818                                                          28818,28922,28924                 
 OPENMB                     Subr   29035                                                          29035                             
 OPENMG                     Subr   29196                                                          29196                             
 PADJ                       Local  28768    R(4)            4     1     6        SAVE             28799,29387                       
 PESTR                      Local  28758    CHAR            52          scalar   SAVE             28788,29070,29092,29370,29401     
 PES_8                      Local  28770    R(8)            8     2     1020     SAVE             29070,29073,29075,29076,29077,2908
                                                                                                  0,29092                           
 PEVN                       Local  29411    R(4)            4           scalar   SAVE             29411,29412                       
 PEVN_8                     Local  28772    R(8)            8     2     1020     SAVE             29256,29311,29312,29313,29314,2932
                                                                                                  0,29321,29322,29370,29388,29397,29
                                                                                                  398,29399,29400,29401,29404,29411,
                                                                                                  29425                             
 PNEW                       Local  29387    R(4)            4           scalar   SAVE             29387,29388,29397                 
 PQM                        Local  29073    R(4)            4           scalar   SAVE             29073,29074                       
 PREFIX                     Local  28762    CHAR            2           scalar   SAVE             28785,29244                       
 PREVEN                     Scalar 28776    L(4)            4           scalar   COM              28910,29337,29356,29375           
 PREVSW                     Common 28778                                4        SAVE                                               
 PROCSW                     Common 28779                                11       SAVE                                               
 QEVN_8                     Local  28772    R(8)            8     2     1020     SAVE             29258,29419,29420,29421,29422,2942
                                                                                                  7,29430                           
 QFRMTP                     Local  28807    R(4)            4           scalar                    29412                             
 QOB                        Local  29264    R(4)            4           scalar   SAVE             29264,29266                       
 QSAT                       Local  29412    R(4)            4           scalar   SAVE             29412,29413,29419                 
 QSTR                       Local  28758    CHAR            52          scalar   SAVE             28793,29430                       
 RDIST                      Local  29110    R(4)            4           scalar   SAVE             29110,29117,29139                 
 READMG                     Subr   28819                                                          28819,28938                       
 READSB                     Subr   29039                                                          29039                             
 RLON                       Local  28767    R(4)            4     1     0                         28896,28897,28899,29110           
 RMW                        Dummy  28754    R(4)            4     1     0        ARG,INOUT        28900,29117,29139                 
 STMLAT                     Dummy  28754    R(4)            4     1     0        ARG,INOUT        28899,29110                       
 STMLON                     Dummy  28754    R(4)            4     1     0        ARG,INOUT        28896                             
 STMNAM                     Dummy  28755    CHAR            9     1     0        ARG,INOUT        28899,29216,29225                 
 STNID                      Local  28760    CHAR            8           scalar   SAVE             29087,29138,29244                 
 SUBSET                     Local  28760    CHAR            8           scalar   SAVE             28819,28938,28940,28946,28966,2896
                                                                                                  9,28973,28981,28988,28989,28990,28
                                                                                                  991,29002,29016,29024,29035       
 SYNPC                      Local  28925    R(4)            4           scalar   SAVE             28925,29076,29127,29273,29278,2928
                                                                                                  4,29293,29298,29308,29313,29321,29
                                                                                                  399,29421                         

Page 845         Source Listing                  EDTPRP
2017-04-18 11:09 Symbol Table                    syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SYNSET                     Local  28760    CHAR            8           scalar   SAVE             28784,29196,29225,29338,29357,2937
                                                                                                  6,29458                           
 T111SW                     Common 28782                                4        SAVE                                               
 TKEL                       Local  29410    R(4)            4           scalar   SAVE             29410,29412                       
 TOB                        Local  29264    R(4)            4           scalar   SAVE             29264,29266,29268,29275,29276     
 TZSTR                      Local  28758    CHAR            52          scalar   SAVE             28790,29332                       
 TZS_8                      Local  28770    R(8)            8     2     3315     SAVE             29254,29270,29271,29272,29273,2927
                                                                                                  4,29276,29277,29278,29279,29282,29
                                                                                                  283,29284,29285,29332             
 UFBCPY                     Subr   29043                                                          29043                             
 UFBINT                     Subr   29044                                                          29044,29070,29092,29121,29146,2933
                                                                                                  1,29332,29350,29351,29368,29369,29
                                                                                                  370,29381,29401,29430             
 UFBQCD                     Subr   28925                                                          28925                             
 UOB                        Local  29264    R(4)            4           scalar   SAVE             29264,29266,29288,29295           
 UVSTR                      Local  28758    CHAR            52          scalar   SAVE             28791,29351                       
 UVS_8                      Local  28771    R(8)            8     2     2550     SAVE             29255,29290,29291,29292,29293,2929
                                                                                                  4,29295,29296,29297,29298,29299,29
                                                                                                  351                               
 VMAX                       Dummy  28755    R(4)            4     1     0        ARG,INOUT        28877,28878,28880,28882,28884,2888
                                                                                                  6,28900                           
 VOB                        Local  29264    R(4)            4           scalar   SAVE             29264,29266,29288,29296           
 WESTR                      Local  28758    CHAR            52          scalar   SAVE             28789,29121,29146                 
 WES_8                      Local  28770    R(8)            8     2     1275     SAVE             29121,29124,29126,29127,29128,2913
                                                                                                  1,29146                           
 WQM                        Local  29124    R(4)            4           scalar   SAVE             29124,29125                       
 WRITSB                     Subr   29151                                                          29151,29340,29359,29431           
 XLATMN                     Local  29214    R(4)            4           scalar   SAVE             29214,29216                       
 XLATMX                     Local  29214    R(4)            4           scalar   SAVE             29214,29216                       
 XLONMN                     Local  29214    R(4)            4           scalar   SAVE             29214,29216                       
 XLONMX                     Local  29214    R(4)            4           scalar   SAVE             29214,29216                       
 XOB                        Local  29045    R(4)            4           scalar   SAVE             29045,29060,29061,29087,29106,2910
                                                                                                  7,29110,29138                     
 YOB                        Local  29046    R(4)            4           scalar   SAVE             29046,29062,29063,29087,29110,2913
                                                                                                  8                                 
 ZDTA_8                     Local  28773    R(8)            8     2     1275     SAVE             29257,29303,29304,29306,29307,2930
                                                                                                  8,29309,29369,29426               
 ZOB                        Local  29264    R(4)            4           scalar   SAVE             29264,29266,29268,29281,29282,2930
                                                                                                  5,29306                           
 ZSTR                       Local  28758    CHAR            52          scalar   SAVE             28792,29369                       

Page 846         Source Listing                  EDTPRP
2017-04-18 11:09                                 syndata.f

  29475 
  29476 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  29477 C
  29478 C SUBPROGRAM: CHDIST
  29479 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2004-02-02
  29480 C
  29481 C ABSTRACT:  COMPUTES CHORD LENGTH DISTANCE FROM ONE LAT/LON POINT
  29482 C   TO ANOTHER LAT/LON POINT USING THE FORMULA:
  29483 C     S**2/2 = 1 - COS(Y1-Y2) + COS(Y1)*COS(Y2)*(1-COS(X1-X2)).
  29484 C
  29485 C PROGRAM HISTORY LOG:
  29486 C 1990-11-06  J. WOOLLEN -- ORIGINAL AUTHOR
  29487 C 2004-02-02  D. KEYSER  -- CORRECTED SUBROUTINE ARGUMENT MISALIGNMENT
  29488 C    (THIS DID NOT APPEAR TO CAUSE PROBLEMS IN OUTPUT BUT COULD CAUSE
  29489 C    MEMORY CLOBBERING DOWN THE LINE SOMEWHERE)
  29490 C
  29491 C USAGE:  CALL CHDIST(X1,Y1,X2,Y2,DIST)
  29492 C   INPUT ARGUMENTS:
  29493 C     X1         - LONGITUDE (0.-360. W) OF POINT 1
  29494 C     Y1         - LATITUDE  (N+,S-)     OF POINT 1
  29495 C     X2         - LONGITUDE (0.-360. W) OF POINT 2
  29496 C     Y2         - LATITUDE  (N+,S-)     OG POINT 2
  29497 C
  29498 C   OUTPUT ARGUMENTS:
  29499 C     DIST       - CHORD LENGTH DISTANCE BETWEEN POINTS (KM)
  29500 C
  29501 C REMARKS: NONE
  29502 C
  29503 C ATTRIBUTES:
  29504 C   LANGUAGE: FORTRAN 90
  29505 C   MACHINE:  NCEP WCOSS
  29506 C
  29507 C$$$
  29508       SUBROUTINE CHDIST(X1,Y1,X2,Y2,DIST)
  29509 
  29510       DATA PI180/.0174532 /,RADE/6371./
  29511 
  29512       SAVE PI180,RADE
  29513 
  29514 C  COMPUTE THE DISTANCE
  29515 C  --------------------
  29516 
  29517       COSY1 = COS(Y1*PI180)
  29518       COSY2 = COS(Y2*PI180)
  29519       COSDX = COS((X1-X2)*PI180)
  29520       COSDY = COS((Y1-Y2)*PI180)
  29521       S = 1.0-COSDY+COSY1*COSY2*(1.0-COSDX)
  29522       S = SQRT(2.*S)
  29523       IF(S.LE..002) S = 0.
  29524       DIST = S*RADE
  29525 
  29526       RETURN
  29527       END

Page 847         Source Listing                  CHDIST
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 chdist_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHDIST                     Subr   29508                                                                                            
 COS                        Func   29517                                scalar                    29517,29518,29519,29520           
 COSDX                      Local  29519    R(4)            4           scalar                    29519,29521                       
 COSDY                      Local  29520    R(4)            4           scalar                    29520,29521                       
 COSY1                      Local  29517    R(4)            4           scalar                    29517,29521                       
 COSY2                      Local  29518    R(4)            4           scalar                    29518,29521                       
 DIST                       Dummy  29508    R(4)            4           scalar   ARG,INOUT        29524                             
 PI180                      Local  29512    R(4)            4           scalar   SAVE             29510,29517,29518,29519,29520     
 RADE                       Local  29512    R(4)            4           scalar   SAVE             29510,29524                       
 S                          Local  29521    R(4)            4           scalar                    29521,29522,29523,29524           
 SQRT                       Func   29522                                scalar                    29522                             
 X1                         Dummy  29508    R(4)            4           scalar   ARG,INOUT        29519                             
 X2                         Dummy  29508    R(4)            4           scalar   ARG,INOUT        29519                             
 Y1                         Dummy  29508    R(4)            4           scalar   ARG,INOUT        29517,29520                       
 Y2                         Dummy  29508    R(4)            4           scalar   ARG,INOUT        29518,29520                       

Page 848         Source Listing                  CHDIST
2017-04-18 11:09                                 syndata.f

  29528 
  29529 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  29530 C
  29531 C SUBPROGRAM:  SPHERP     SPHERICAL TRANSFORM TO A POINT
  29532 C   PRGMMR: KANAMITSU     ORG: NP23          DATE: 1992-04-16
  29533 C
  29534 C ABSTRACT: TRANSFORMS A SPECTRAL FIELD TO A POINT ON THE GLOBE.
  29535 C
  29536 C PROGRAM HISTORY LOG:
  29537 C 1992-04-16  IREDELL
  29538 C
  29539 C USAGE:    CALL SPHERP(WAVE,MAXWV,IROMB,IDY,MLT,FAC,RLAT,RLON,VALUE)
  29540 C
  29541 C   INPUT ARGUMENT LIST:
  29542 C     WAVE     - IF IDIR < 0, COMPLEX (KMAX) FIELD TO TRANSFORM,
  29543 C                WHERE KMAX=(MAXWV+1)*(IROMB+1)*MAXWV+2)/2.
  29544 C                WAVE STARTS AT THE GLOBAL MEAN COMPONENT AND THEN
  29545 C                CONTAINS THE ZONALLY SYMMETRIC COMPONENTS.
  29546 C     MAXWV    - SPECTRAL TRUNCATION OF THE WAVE
  29547 C     IROMB    - IROMB = 0 FOR TRIANGULAR TRUNCATION
  29548 C                IROMB = 1 FOR RHOMBOIDAL TRUNCATION
  29549 C     IDIR     - 0 FOR NORMAL, 1 FOR LEGENDRE DERIVATIVE
  29550 C     MLT      - MULTIPLICATION OPTION ON WAVE VALUES.
  29551 C                MLT = 0 FOR NO MULTIPLICATION,
  29552 C                MLT = 1 TO MULTIPLY WAVE BY FAC
  29553 C                MLT = -1 TO MULTIPLY WAVE BY SQRT(-1)*FAC
  29554 C     FAC      - IF MLT.NE.0, REAL (KMAX) FIELD TO MULTIPLY WAVE.
  29555 C     RLAT     - LATITUDE IN DEGREES NORTH
  29556 C     RLON     - LONGITUDE IN DEGREES EAST
  29557 C
  29558 C   OUTPUT ARGUMENT LIST:
  29559 C     VALUE    - TRANSFORMED VALUE
  29560 C
  29561 C   SUBPROGRAMS CALLED:
  29562 C     (LEGENDR2) - COMPUTE LEGENDRE POLYNOMIALS
  29563 C
  29564 C   REMARKS: FORTRAN 9X EXTENSIONS ARE USED.
  29565 C     FPP CAN BE USED TO INLINE SUBPROGRAMS.
  29566 C
  29567 C ATTRIBUTES:
  29568 C   LANGUAGE: FORTRAN 90
  29569 C   MACHINE:  IBM-SP
  29570 C
  29571 C$$$
  29572 CFPP$ EXPAND(LEGENDR2)
  29573       SUBROUTINE SPHERP(WAVE,MAXWV,IROMB,IDY,MLT,FAC,RLAT,RLON,VALUE)
  29574       REAL WAVE((MAXWV+1)*((IROMB+1)*MAXWV+2))
  29575       REAL FAC((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)
  29576       REAL PNM((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)
  29577       REAL DNM((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)
  29578       REAL FR(0:MAXWV),FI(0:MAXWV)
  29579       PARAMETER(PI=3.1415926535898,PI180=PI/180.)
  29580       SINLAT=SIN(RLAT*PI180)
  29581       CALL LEGENDR2(SINLAT,MAXWV,IROMB,PNM,DNM)
  29582       IF(IDY.NE.0) THEN
  29583         PNM=DNM
  29584       ENDIF

Page 849         Source Listing                  SPHERP
2017-04-18 11:09                                 syndata.f

  29585       IF(MLT.NE.0) THEN
  29586         PNM=PNM*FAC
  29587       ENDIF
  29588       K=0
  29589       DO M=0,MAXWV
  29590         FR(M)=0.
  29591         FI(M)=0.
  29592       ENDDO
  29593       DO M=0,MAXWV
  29594         DO N=M,IROMB*M+MAXWV
  29595           FR(M)=FR(M)+WAVE(2*K+1)*PNM(K+1)
  29596           FI(M)=FI(M)+WAVE(2*K+2)*PNM(K+1)
  29597           K=K+1
  29598         ENDDO
  29599       ENDDO
  29600       VALUE=0.
  29601       RLAM=RLON*PI180
  29602       IF(MLT.GE.0) THEN
  29603         DO M=1,MAXWV
  29604           VALUE=VALUE+FR(M)*COS(RLAM*M)-FI(M)*SIN(RLAM*M)
  29605         ENDDO
  29606       ELSE
  29607         DO M=1,MAXWV
  29608           VALUE=VALUE-FI(M)*COS(RLAM*M)-FR(M)*SIN(RLAM*M)
  29609         ENDDO
  29610       ENDIF
  29611       VALUE=FR(0)+2.*VALUE
  29612       RETURN
  29613       END

Page 850         Source Listing                  SPHERP
2017-04-18 11:09 Entry Points                    syndata.f



ENTRY POINTS

  Name               
                     
 spherp_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COS                        Func   29604                                scalar                    29604,29608                       
 DNM                        Local  29577    R(4)            4     1     0                         29581,29583                       
 FAC                        Dummy  29573    R(4)            4     1     0        ARG,INOUT        29586                             
 FI                         Local  29578    R(4)            4     1     0                         29591,29596,29604,29608           
 FR                         Local  29578    R(4)            4     1     0                         29590,29595,29604,29608,29611     
 IDY                        Dummy  29573    I(4)            4           scalar   ARG,INOUT        29582                             
 IROMB                      Dummy  29573    I(4)            4           scalar   ARG,INOUT        29574,29575,29576,29577,29581,2959
                                                                                                  4                                 
 K                          Local  29588    I(4)            4           scalar                    29588,29595,29596,29597           
 LEGENDR2                   Subr   29581                                                          29581                             
 M                          Local  29589    I(4)            4           scalar                    29589,29590,29591,29593,29594,2959
                                                                                                  5,29596,29603,29604,29607,29608   
 MAXWV                      Dummy  29573    I(4)            4           scalar   ARG,INOUT        29574,29575,29576,29577,29578,2958
                                                                                                  1,29589,29593,29594,29603,29607   
 MLT                        Dummy  29573    I(4)            4           scalar   ARG,INOUT        29585,29602                       
 N                          Local  29594    I(4)            4           scalar                    29594                             
 PI                         Param  29579    R(4)            4           scalar                    29579                             
 PI180                      Param  29579    R(4)            4           scalar                    29580,29601                       
 PNM                        Local  29576    R(4)            4     1     0                         29581,29583,29586,29595,29596     
 RLAM                       Local  29601    R(4)            4           scalar                    29601,29604,29608                 
 RLAT                       Dummy  29573    R(4)            4           scalar   ARG,INOUT        29580                             
 RLON                       Dummy  29573    R(4)            4           scalar   ARG,INOUT        29601                             
 SIN                        Func   29580                                scalar                    29580,29604,29608                 
 SINLAT                     Local  29580    R(4)            4           scalar                    29580,29581                       
 SPHERP                     Subr   29573                                                                                            
 VALUE                      Dummy  29573    R(4)            4           scalar   ARG,INOUT        29600,29604,29608,29611           
 WAVE                       Dummy  29573    R(4)            4     1     0        ARG,INOUT        29595,29596                       

Page 851         Source Listing                  SPHERP
2017-04-18 11:09                                 syndata.f

  29614 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
  29615 C
  29616 C SUBPROGRAM:  LEGENDR2   COMPUTE LEGENDRE POLYNOMIALS.
  29617 C   PRGMMR: IREDELL       ORG: NP23          DATE: 1992-04-16
  29618 C
  29619 C ABSTRACT: EVALUATES THE NORMALIZED ASSOCIATED LEGENDRE POLYNOMIALS
  29620 C   AT A GIVEN COSINE OF COLATITUDE.
  29621 C
  29622 C PROGRAM HISTORY LOG:
  29623 C 1992-04-16  IREDELL
  29624 C
  29625 C USAGE:    CALL LEGENDR2(COSCLT,MAXWV,IROMB,PNM,DNM)
  29626 C
  29627 C   INPUT ARGUMENT LIST:
  29628 C     COSCLT   - COSINE OF COLATITUDE AT WHICH TO EVALUTATE.
  29629 C     MAXWV    - SPECTRAL TRUNCATION
  29630 C     IROMB    - IROMB = 0 FOR TRIANGULAR TRUNCATION
  29631 C                IROMB = 1 FOR RHOMBOIDAL TRUNCATION
  29632 C
  29633 C   OUTPUT ARGUMENT LIST:
  29634 C     PNM      - REAL (KMAX) POLYNOMIAL VALUES,
  29635 C     DNM      - REAL (KMAX) POLYNOMIAL DERIVATIVES,
  29636 C                WHERE KMAX=(MAXWV+1)*(IROMB+1)*MAXWV+2)/2.
  29637 C
  29638 C   REMARKS: FORTRAN 9X EXTENSIONS ARE USED.
  29639 C
  29640 C ATTRIBUTES:
  29641 C   LANGUAGE: FORTRAN 90
  29642 C   MACHINE:  IBM-SP
  29643 C
  29644 C$$$
  29645       SUBROUTINE LEGENDR2(COSCLT,MAXWV,IROMB,PNM,DNM)
  29646       DIMENSION PNM((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)
  29647       DIMENSION DNM((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)
  29648       DIMENSION EPS(0:100)
  29649       SINCLT=SQRT(1.-COSCLT**2)
  29650       NM=0
  29651       K=1
  29652       PNM(K)=SQRT(0.5)
  29653 CDIR$ NEXTSCALAR
	................1
(1) Unrecognized directive

  29654       DO M=1,MAXWV-NM*(1-IROMB)
  29655         PNMK=PNM(K)
  29656         K=M*(2*MAXWV+2+(1-M)*(1-IROMB))/2+(NM+1)
  29657         PNM(K)=PNMK*SINCLT*SQRT(FLOAT(2*M+1)/FLOAT(2*M))
  29658       ENDDO
  29659       NM=1
  29660 CDIR$ IVDEP
  29661       DO M=0,MAXWV-NM*(1-IROMB)
  29662         N=M+NM
  29663         EPSNM=SQRT(FLOAT(N**2-M**2)/FLOAT(4*N**2-1))
  29664         K=M*(2*MAXWV+2+(1-M)*(1-IROMB))/2+(NM+1)
  29665         PNM(K)=COSCLT*PNM(K-1)/EPSNM
  29666         DNM(K-1)=EPSNM*PNM(K)*(N-1)
  29667         EPS(M)=EPSNM

Page 852         Source Listing                  LEGENDR2
2017-04-18 11:09                                 syndata.f

  29668       ENDDO
  29669       DO NM=2,MAXWV
  29670 CDIR$ IVDEP
  29671         DO M=0,MAXWV-NM*(1-IROMB)
  29672           N=M+NM
  29673           EPSNM=SQRT(FLOAT(N**2-M**2)/FLOAT(4*N**2-1))
  29674           K=M*(2*MAXWV+2+(1-M)*(1-IROMB))/2+(NM+1)
  29675           PNM(K)=(COSCLT*PNM(K-1)-EPS(M)*PNM(K-2))/EPSNM
  29676           DNM(K-1)=EPSNM*PNM(K)*(N-1)-EPS(M)*PNM(K-2)*N
  29677           EPS(M)=EPSNM
  29678         ENDDO
  29679       ENDDO
  29680 CDIR$ IVDEP
  29681       DO M=0,MAXWV
  29682         NM=MAXWV-M*(1-IROMB)
  29683         N=M+NM
  29684         EPS(M)=SQRT(FLOAT(N**2-M**2)/FLOAT(4*N**2-1))
  29685         N=N+1
  29686         EPSNM=SQRT(FLOAT(N**2-M**2)/FLOAT(4*N**2-1))
  29687         K=M*(2*MAXWV+2+(1-M)*(1-IROMB))/2+(NM+1)
  29688         K=K+1
  29689         PNMK=(COSCLT*PNM(K-1)-EPS(M)*PNM(K-2))/EPSNM
  29690         DNM(K-1)=EPSNM*PNMK*(N-1)-EPS(M)*PNM(K-2)*N
  29691       ENDDO
  29692       RETURN
  29693       END


ENTRY POINTS

  Name                 
                       
 legendr2_             

Page 853         Source Listing                  LEGENDR2
2017-04-18 11:09 Symbol Table                    syndata.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COSCLT                     Dummy  29645    R(4)            4           scalar   ARG,INOUT        29649,29665,29675,29689           
 DNM                        Dummy  29645    R(4)            4     1     0        ARG,INOUT        29666,29676,29690                 
 EPS                        Local  29648    R(4)            4     1     101                       29667,29675,29676,29677,29684,2968
                                                                                                  9,29690                           
 EPSNM                      Local  29663    R(4)            4           scalar                    29663,29665,29666,29667,29673,2967
                                                                                                  5,29676,29677,29686,29689,29690   
 FLOAT                      Func   29657                                scalar                    29657,29663,29673,29684,29686     
 IROMB                      Dummy  29645    I(4)            4           scalar   ARG,INOUT        29646,29647,29654,29656,29661,2966
                                                                                                  4,29671,29674,29682,29687         
 K                          Local  29651    I(4)            4           scalar                    29651,29652,29655,29656,29657,2966
                                                                                                  4,29665,29666,29674,29675,29676,29
                                                                                                  687,29688,29689,29690             
 LEGENDR2                   Subr   29645                                                                                            
 M                          Local  29654    I(4)            4           scalar                    29654,29656,29657,29661,29662,2966
                                                                                                  3,29664,29667,29671,29672,29673,29
                                                                                                  674,29675,29676,29677,29681,29682,
                                                                                                  29683,29684,29686,29687,29689,2969
                                                                                                  0                                 
 MAXWV                      Dummy  29645    I(4)            4           scalar   ARG,INOUT        29646,29647,29654,29656,29661,2966
                                                                                                  4,29669,29671,29674,29681,29682,29
                                                                                                  687                               
 N                          Local  29662    I(4)            4           scalar                    29662,29663,29666,29672,29673,2967
                                                                                                  6,29683,29684,29685,29686,29690   
 NM                         Local  29650    I(4)            4           scalar                    29650,29654,29656,29659,29661,2966
                                                                                                  2,29664,29669,29671,29672,29674,29
                                                                                                  682,29683,29687                   
 PNM                        Dummy  29645    R(4)            4     1     0        ARG,INOUT        29652,29655,29657,29665,29666,2967
                                                                                                  5,29676,29689,29690               
 PNMK                       Local  29655    R(4)            4           scalar                    29655,29657,29689,29690           
 SINCLT                     Local  29649    R(4)            4           scalar                    29649,29657                       
 SQRT                       Func   29649                                scalar                    29649,29652,29657,29663,29673,2968
                                                                                                  4,29686                           

Page 854         Source Listing                  LEGENDR2
2017-04-18 11:09                                 syndata.f

  29694 

Page 855         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                            Common 24714                                203168                                                      
                            Common 26423                                203168                                                      
                            Common 26789                                203168                                                      
 AAA                        Common 22091                                127400   SAVE                                               
 AAA                        Common 22248                                127400   SAVE                                               
 ABRT1                      Subr   9266                                                                                             
 AD1EXX                     Subr   26414                                                                                            
 ADEXXX                     Subr   22082                                                                                            
 AFD                        Common 12320                                2260000  SAVE                                               
 AFD                        Common 13158                                2260000  SAVE                                               
 ALSAND                     Subr   20855                                                                                            
 ANRTOD                     Subr   23021                                                                                            
 AS2DVO                     Subr   10883                                                                                            
 ATAN2DEG                   Func   9046     R(4)            4           scalar                    9052,9054                         
 AZI                        Common 12329                                32       SAVE                                               
 AZI                        Common 13026                                32                                                          
 BDATE                      Common 3728                                 32       SAVE                                               
 BDATE                      Common 4090                                 32       SAVE                                               
 BDATE                      Common 4357                                 32       SAVE                                               
 BDATE                      Common 4933                                 32       SAVE                                               
 BDATE                      Common 6756                                 32       SAVE                                               
 BDATE                      Common 7989                                 32                                                          
 BOGMTH                     Subr   1038                                                                                             
 BOGUS                      Subr   18404                                                                                            
 BSSLZ1                     Subr   3991                                                                                             
 BUFRLIB_MISSING            Common 463                                  8                                                           
 BUFRLIB_MISSING            Common 27343                                8        SAVE                                               
 BUFRLIB_MISSING            Common 28780                                8        SAVE                                               
 CC2SUB                     Subr   22579                                                                                            
 CCOSUB                     Subr   22239                                                                                            
 CHDIST                     Subr   29508                                                                                            
 CHGRES                     Subr   8468                                                                                             
 CIRCLE                     Subr   8246                                                                                             
 CL1ANS                     Subr   26615                                                                                            
 CMPSIT                     Subr   9311                                                                                             
 COMBIN                     Subr   27819                                                                                            
 CONTST                     Subr   21000                                                                                            
 COORDS                     Subr   18038                                                                                            
 COSDEG_8                   Func   9137     R(8)            8           scalar                    9143                              
 CPRINT                     Common 25076                                2                                                           
 CPRINT                     Common 25230                                2                                                           
 CRITR                      Common 20555                                8        SAVE                                               
 CRITR                      Common 21003                                8        SAVE                                               
 CSGNLN                     Subr   20385                                                                                            
 CSWRL6                     Subr   11595                                                                                            
 DECVAR                     Subr   5553                                                                                             
 DIFSUB                     Subr   14983                                                                                            
 DISTSP_8                   Func   9173     R(8)            8           scalar                    9183                              
 DOIT                       Func   21058    L(4)            4           scalar                    21062,21064                       
 DOMCHK                     Subr   17987                                                                                            
 DPREP                      Subr   18990                                                                                            

Page 856         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DSGRPH                     Subr   25073                                                                                            
 DSK                        Common 5636                                 76       SAVE                                               
 DSK                        Common 12322                                76       SAVE                                               
 DSK                        Common 13016                                76                                                          
 DSK                        Common 13164                                76       SAVE                                               
 DSK                        Common 14016                                76       SAVE                                               
 DSK                        Common 15005                                76       SAVE                                               
 DSK                        Common 16393                                76       SAVE                                               
 DSK                        Common 16472                                76       SAVE                                               
 DSK                        Common 18865                                76       SAVE                                               
 DSK                        Common 19806                                76       SAVE                                               
 DSK                        Common 21252                                76       SAVE                                               
 DSK                        Common 23444                                76       SAVE                                               
 DSKNMC                     Subr   18855                                                                                            
 DTIME                      Subr   18227                                                                                            
 DWATE                      Common 13173                                760      SAVE                                               
 DWATE                      Common 15013                                760      SAVE                                               
 DWATE                      Common 15958                                760      SAVE                                               
 DWATE                      Common 16235                                760                                                         
 DWATE                      Common 16396                                760      SAVE                                               
 DWATE                      Common 16478                                760      SAVE                                               
 EDTPRP                     Subr   28754                                                                                            
 ENDFIL                     Subr   19902                                                                                            
 ERRF                       Func   12119    R(4)            4           scalar                    12138,12140,12142,12144           
 FCN                        Func   12071    R(4)            4           scalar                    12084                             
 FIXSLM                     Subr   3827                                                                                             
 FUNINC                     Subr   12244                                                                                            
 GAMSUB                     Subr   21416                                                                                            
 GAULAT                     Subr   3897                                                                                             
 GETSVF                     Subr   16544                                                                                            
 GRABMO                     Subr   1204                                                                                             
 GRABVO                     Subr   5629                                                                                             
 HEDCHK                     Subr   20292                                                                                            
 IBM1                       Block  13008                                scalar                                                      
 IBM2                       Block  16233                                scalar                                                      
 IBM3                       Block  17169                                scalar                                                      
 IBM4                       Block  25893                                scalar                                                      
 IBM5                       Block  17951                                scalar                                                      
 IBMBS                      Common 12335                                960      SAVE                                               
 IBMBS                      Common 13028                                960                                                         
 IDSSUB                     Subr   17347                                                                                            
 IERINV                     Func   24629    I(4)            4           scalar                    24644,24646,24650,24654,24656     
 IND                        Common 13154                                32000    SAVE                                               
 INVMTX                     Subr   24349                                                                                            
 ISECND                     Func   8889     I(4)            4           scalar                    8895,8897                         
 LEGENDR2                   Subr   29645                                                                                            
 LINT                       Subr   18580                                                                                            
 MADCON                     Common 21128                                48       SAVE                                               
 MADCON                     Common 22093                                48       SAVE                                               
 MADCON                     Common 22663                                48       SAVE                                               
 MAKHRD                     Subr   12181                                                                                            
 MAKVOR                     Subr   6721                                                                                             
 MAXMIN                     Common 20556                                4        SAVE                                               
 MAXMIN                     Common 21059                                4                                                           
 MEANV                      Subr   19412                                                                                            

Page 857         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MER                        Common 21270                                14704    SAVE                                               
 MERCAT                     Subr   17844                                                                                            
 MERCON                     Common 17860                                24       SAVE                                               
 MERCON                     Common 17952                                24                                                          
 MLXN9A                     Subr   22654                                                                                            
 MM2DVO                     Subr   10445                                                                                            
 MM3DVO                     Subr   6372                                                                                             
 MSKDMP                     Subr   24212                                                                                            
 NEWVIT                     Subr   4898                                                                                             
 OPNFIL                     Subr   19865                                                                                            
 OUTENV                     Subr   3433                                                                                             
 OUTGES                     Subr   3506                                                                                             
 OUTPUTT                    Subr   24888                                                                                            
 OUTREC                     Subr   20137                                                                                            
 OUTSTK                     Subr   19800                                                                                            
 OUTSTT                     Subr   16469                                                                                            
 OUTSUB                     Subr   19482                                                                                            
 OUTSV                      Subr   16645                                                                                            
 OVRHED                     Common 3583                                 44       SAVE                                               
 OVRHED                     Common 27831                                44       SAVE                                               
 OVRLAP                     Subr   7392                                                                                             
 OVRSUB                     Subr   25270                                                                                            
 PAS1XS                     Subr   26480                                                                                            
 PASD1R                     Subr   26660                                                                                            
 PASDCC                     Common 22756                                16       SAVE                                               
 PASDCC                     Common 22859                                16       SAVE                                               
 PASDCC                     Common 23028                                16       SAVE                                               
 PASDCC                     Common 26526                                16                                                          
 PASDCC                     Common 26621                                16                                                          
 PASDCC                     Common 26667                                16                                                          
 PASDSS                     Subr   22846                                                                                            
 PASSUB                     Subr   22711                                                                                            
 PCKPRW                     Func   19719    R(8)            8           scalar                    19721                             
 PR1FKM                     Subr   25829                                                                                            
 PRDLOC                     Subr   15940                                                                                            
 PRES                       Common 12328                                72       SAVE                                               
 PRES                       Common 13024                                72                                                          
 PRES                       Common 13170                                72       SAVE                                               
 PRES                       Common 14024                                72       SAVE                                               
 PRES                       Common 15014                                72       SAVE                                               
 PRES                       Common 16550                                72       SAVE                                               
 PRES                       Common 16650                                72       SAVE                                               
 PRES                       Common 19809                                72       SAVE                                               
 PRES                       Common 20143                                72       SAVE                                               
 PREVSW                     Common 460                                  4                                                           
 PREVSW                     Common 28778                                4        SAVE                                               
 PRFKMD                     Subr   19304                                                                                            
 PRFMSC                     Subr   19225                                                                                            
 PRFSUB                     Subr   19108                                                                                            
 PRNT                       Subr   25228                                                                                            
 PROCSW                     Common 461                                  11                                                          
 PROCSW                     Common 28779                                11       SAVE                                               
 QSATI                      Func   19672    R(4)            4           scalar                    19684                             
 QSATW                      Func   19621    R(4)            4           scalar                    19637                             
 R15FND                     Subr   7306                                                                                             

Page 858         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RAVGW                      Common 14025                                160      SAVE                                               
 RDSUBS                     Subr   8732                                                                                             
 REDSUB                     Subr   3576                                                                                             
 RFAC                       Func   8359     R(4)            4           scalar                    8378,8380,8382                    
 RITCR1                     Subr   7823                                                                                             
 RITCR2                     Subr   7875                                                                                             
 RITSPS                     Subr   7686                                                                                             
 RNKVRT                     Subr   20648                                                                                            
 RWT                        Subr   16391                                                                                            
 S1BCDC                     Common 17662                                32                                                          
 S1BCDC                     Common 25454                                32                                                          
 S1BCDC                     Common 26199                                32                                                          
 S1DTPT                     Common 24715                                96084                                                       
 S1DTPT                     Common 24896                                96084                                                       
 S1DTPT                     Common 26022                                96084    SAVE                                               
 S1DTPT                     Common 26792                                96084                                                       
 S1KOMP                     Common 24717                                224                                                         
 S1KOMP                     Common 24898                                224                                                         
 S1KOMP                     Common 25602                                224                                                         
 S1KOMP                     Common 25838                                224                                                         
 S1KOMP                     Common 25897                                224                                                         
 S1MACQ                     Common 26036                                16       SAVE                                               
 S1MACQ                     Common 26323                                16                                                          
 S1NODE                     Common 17661                                292                                                         
 S1NODE                     Common 24899                                292                                                         
 S1NODE                     Common 25287                                292                                                         
 S1NODE                     Common 25453                                292                                                         
 S1NODE                     Common 25839                                292                                                         
 S1NODE                     Common 25951                                292                                                         
 S1NODE                     Common 26034                                292      SAVE                                               
 S1NODE                     Common 26320                                292                                                         
 S1NODE                     Common 26791                                292                                                         
 S1NODE                     Common 26928                                292      SAVE                                               
 S1NODE                     Common 27216                                292                                                         
 S1PRIC                     Common 17660                                161                                                         
 S1PRIC                     Common 25282                                161                                                         
 S1PRIC                     Common 25388                                40                                                          
 S1PRIC                     Common 25448                                161                                                         
 S1PRIC                     Common 25895                                161                                                         
 S1PRIC                     Common 26032                                161      SAVE                                               
 S1PRIC                     Common 26318                                161                                                         
 S1QRBG                     Common 26201                                320                                                         
 S1QRBG                     Common 26322                                320                                                         
 S2BCDC                     Common 16727                                64       SAVE                                               
 S2BCDC                     Common 17221                                64       SAVE                                               
 S2BCDC                     Common 17473                                64                                                          
 S2BCDC                     Common 21742                                64       SAVE                                               
 S2BCDC                     Common 25652                                64                                                          
 S2CORN                     Common 17222                                64       SAVE                                               
 S2CORN                     Common 22259                                64       SAVE                                               
 S2CORN                     Common 23319                                64       SAVE                                               
 S2DTPT                     Common 13162                                160084   SAVE                                               
 S2DTPT                     Common 14012                                160084   SAVE                                               
 S2DTPT                     Common 15003                                160084   SAVE                                               
 S2DTPT                     Common 15953                                160084   SAVE                                               

Page 859         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 S2DTPT                     Common 16285                                160084                                                      
 S2DTPT                     Common 18046                                160084   SAVE                                               
 S2DTPT                     Common 18407                                160084   SAVE                                               
 S2DTPT                     Common 19421                                160084   SAVE                                               
 S2DTPT                     Common 19492                                160084   SAVE                                               
 S2DTPT                     Common 20390                                160084                                                      
 S2DTPT                     Common 21250                                160084   SAVE                                               
 S2DTPT                     Common 21426                                160084   SAVE                                               
 S2DTPT                     Common 23129                                160084   SAVE                                               
 S2DTPT                     Common 23442                                160084   SAVE                                               
 S2EFRM                     Common 23131                                14704    SAVE                                               
 S2EFRM                     Common 23455                                14704    SAVE                                               
 S2KOMP                     Common 14019                                7844     SAVE                                               
 S2KOMP                     Common 15008                                7844     SAVE                                               
 S2KOMP                     Common 16551                                7844     SAVE                                               
 S2KOMP                     Common 17177                                7844                                                        
 S2KOMP                     Common 17363                                7844     SAVE                                               
 S2KOMP                     Common 18809                                7844     SAVE                                               
 S2KOMP                     Common 18872                                7844     SAVE                                               
 S2KOMP                     Common 19319                                7844     SAVE                                               
 S2KOMP                     Common 19423                                7844     SAVE                                               
 S2KOMP                     Common 20208                                7844     SAVE                                               
 S2MACQ                     Common 21440                                32       SAVE                                               
 S2MACQ                     Common 21910                                32       SAVE                                               
 S2NODE                     Common 14014                                716      SAVE                                               
 S2NODE                     Common 15951                                716      SAVE                                               
 S2NODE                     Common 16288                                716                                                         
 S2NODE                     Common 16725                                716      SAVE                                               
 S2NODE                     Common 17471                                716                                                         
 S2NODE                     Common 19118                                716      SAVE                                               
 S2NODE                     Common 19317                                716      SAVE                                               
 S2NODE                     Common 19977                                716      SAVE                                               
 S2NODE                     Common 20206                                716      SAVE                                               
 S2NODE                     Common 21123                                716      SAVE                                               
 S2NODE                     Common 21435                                716      SAVE                                               
 S2NODE                     Common 21908                                716      SAVE                                               
 S2NODE                     Common 22256                                716      SAVE                                               
 S2NODE                     Common 22587                                716      SAVE                                               
 S2NODE                     Common 23127                                716      SAVE                                               
 S2NODE                     Common 23622                                716      SAVE                                               
 S2NODE                     Common 24146                                716      SAVE                                               
 S2NODE                     Common 24279                                716      SAVE                                               
 S2NODE                     Common 25650                                716                                                         
 S2PRIC                     Common 13160                                217      SAVE                                               
 S2PRIC                     Common 15001                                217      SAVE                                               
 S2PRIC                     Common 15949                                217      SAVE                                               
 S2PRIC                     Common 16282                                217                                                         
 S2PRIC                     Common 16720                                217      SAVE                                               
 S2PRIC                     Common 17115                                217                                                         
 S2PRIC                     Common 17175                                217                                                         
 S2PRIC                     Common 17219                                217      SAVE                                               
 S2PRIC                     Common 17361                                217      SAVE                                               
 S2PRIC                     Common 17469                                217                                                         
 S2PRIC                     Common 17990                                217      SAVE                                               
 S2PRIC                     Common 18044                                217      SAVE                                               

Page 860         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 S2PRIC                     Common 18870                                217      SAVE                                               
 S2PRIC                     Common 19490                                217      SAVE                                               
 S2PRIC                     Common 20300                                217      SAVE                                               
 S2PRIC                     Common 21248                                217      SAVE                                               
 S2PRIC                     Common 21433                                217      SAVE                                               
 S2PRIC                     Common 21740                                217      SAVE                                               
 S2PRIC                     Common 21906                                217      SAVE                                               
 S2PRIC                     Common 23440                                217      SAVE                                               
 S2PRIC                     Common 25648                                217                                                         
 S2QRBG                     Common 21743                                896      SAVE                                               
 S2QRBG                     Common 21911                                896      SAVE                                               
 SEARCH                     Subr   4061                                                                                             
 SETMOD                     Subr   2170                                                                                             
 SETSCL                     Subr   20198                                                                                            
 SETSIM                     Subr   20544                                                                                            
 SETUP                      Subr   5901                                                                                             
 SETVOR                     Subr   6106                                                                                             
 SHRINK                     Subr   20805                                                                                            
 SIMCON                     Subr   20443                                                                                            
 SINDEG_8                   Func   9093     R(8)            8           scalar                    9099                              
 SIZE                       Subr   20759                                                                                            
 SL1ADQ                     Subr   26313                                                                                            
 SL1GET                     Subr   26013                                                                                            
 SL1MBO                     Subr   26757                                                                                            
 SL1OVR                     Subr   25433                                                                                            
 SL1QBG                     Subr   26197                                                                                            
 SL1RGO                     Subr   25943                                                                                            
 SLADDQ                     Subr   21898                                                                                            
 SLARGO                     Subr   21107                                                                                            
 SLDATE                     Subr   3720                                                                                             
 SLIMBO                     Subr   23092                                                                                            
 SLIQBG                     Subr   21736                                                                                            
 SLISUB                     Subr   23305                                                                                            
 SLOCCO                     Subr   17215                                                                                            
 SLOSUB                     Subr   16703                                                                                            
 SORTRL                     Subr   8036                                                                                             
 SP1LNT                     Subr   26905                                                                                            
 SP1TNO                     Subr   27199                                                                                            
 SPHERP                     Subr   29573                                                                                            
 SPLDAT                     Subr   12301                                                                                            
 SPLEFR                     Subr   23427                                                                                            
 SPLEFW                     Subr   21231                                                                                            
 SPLINT                     Subr   23590                                                                                            
 SPMODL                     Subr   2475                                                                                             
 SPTDER                     Subr   19949                                                                                            
 SPTIKA                     Subr   24256                                                                                            
 SPTINO                     Subr   24123                                                                                            
 ST1KPX                     Subr   25598                                                                                            
 STASH                      Subr   20708                                                                                            
 STDEV                      Subr   9221                                                                                             
 STISUB                     Subr   8826                                                                                             
 STSBC1                     Subr   25386                                                                                            
 STSPBC                     Subr   17110                                                                                            
 SURPRP                     Subr   27327                                                                                            
 SYNDAT_SYNDATA             Prog   415                                                                                              

Page 861         Source Listing                  LEGENDR2
2017-04-18 11:09 Subprograms/Common Blocks       syndata.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 T111SW                     Common 462                                  4                                                           
 T111SW                     Common 27832                                4        SAVE                                               
 T111SW                     Common 28782                                4        SAVE                                               
 TEMPLT                     Subr   3193                                                                                             
 TEMWT                      Subr   3363                                                                                             
 TIMSUB                     Subr   7929                                                                                             
 TITLE                      Common 8739                                 263      SAVE                                               
 TMMNMX                     Common 12330                                48       SAVE                                               
 TMMNMX                     Common 13171                                48       SAVE                                               
 TRKSUB                     Subr   4314                                                                                             
 UPKPRW                     Subr   19758                                                                                            
 UV2DS                      Subr   8985                                                                                             
 UVRTCN                     Subr   8939                                                                                             
 UVTOZD                     Subr   8537                                                                                             
 VARS                       Common 6380                                 1452     SAVE                                               
 VFIND                      Subr   18802                                                                                            
 WDWSP                      Subr   18341                                                                                            
 WLCONV                     Common 16731                                16       SAVE                                               
 WTDAT                      Subr   16277                                                                                            
 XBF                        Func   17445    R(4)            4           scalar                    17483,17502,17536,17555,17585,1760
                                                                                                  4                                 
 XDTSUB                     Subr   13136                                                                                            
 XSPLCM                     Subr   24692                                                                                            
 XTIME                      Subr   18300                                                                                            
 XYT                        Common 12325                                64432    SAVE                                               
 XYT                        Common 13020                                64432                                                       
 XYT                        Common 13167                                64432    SAVE                                               
 XYT                        Common 14021                                64432    SAVE                                               
 XYT                        Common 15010                                64432    SAVE                                               
 XYT                        Common 15955                                64432    SAVE                                               
 XYT                        Common 16475                                64432    SAVE                                               
 XYT                        Common 18048                                64432    SAVE                                               
 XYT                        Common 18874                                64432    SAVE                                               
 XYT                        Common 19494                                64432    SAVE                                               
 XYT                        Common 20295                                64432    SAVE                                               
 XYT                        Common 20392                                64432                                                       
 Y1BF                       Func   17655    R(4)            4           scalar                    17675,17694,17727,17746,17774,1779
                                                                                                  3                                 
 YBF                        Func   25641    R(4)            4           scalar                    25661,25680,25712,25731,25759,2577
                                                                                                  8                                 
 YDTSUB                     Subr   13999                                                                                            
 YTIME                      Subr   7987                                                                                             
 ZETAC                      Common 25898                                36                                                          
 ZNEAR                      Func   8426     R(4)            4           scalar                    8429                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte

Page 862         Source Listing                  LEGENDR2
2017-04-18 11:09                                 syndata.f

       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check args                           -check arg_temp_created
       -check assume                         -check bounds
       -check format                         -check nooutput_conversion
       -check overflow                       -check pointers
       -check power                          -check shape
       -check stack                          -check underflow
       -check uninitialized                  -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe0
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access

Page 863         Source Listing                  LEGENDR2
2017-04-18 11:09                                 syndata.f

       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits noftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init snan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O0                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : syndata.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
