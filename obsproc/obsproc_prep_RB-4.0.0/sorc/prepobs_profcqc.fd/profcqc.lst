Page 1           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

      1 C$$$  MAIN PROGRAM DOCUMENTATION BLOCK
      2 C
      3 C MAIN PROGRAM: PREPOBS_PROFCQC
      4 C   PRGMMR: KEYSER           ORG: NP22        DATE: 2016-12-20
      5 C
      6 C ABSTRACT: PERFORMS COMPLEX QUALITY CONTROL OF PROFILER DOPPLER
      7 C   WINDS.  THE INPUT AND OUTPUT ARE IN PREPBUFR FORMAT.  THE
      8 C   CHECKS USED ARE: INCREMENT, VERTICAL STATISTICAL, TEMPORAL
      9 C   STATISTICAL, AND COMBINED VERTICAL-TEMPORAL.
     10 C
     11 C PROGRAM HISTORY LOG:
     12 C 1996-11-20  W. Collins  I/O is completely new, but the algorithms
     13 C     are identical to those already used in the RUC.
     14 C 1997-05-27  W. Collins  24 hours maximum can be qc'd. The NAMELIST
     15 C     reads in the hour limits with respect to the central data time.
     16 C 1998-09-16  W. Collins  Replace faulty date routine with W3MOVDAT.
     17 C 1998-12-22  W. Collins  Correct copy of reports to output.  Previous
     18 C     implementation introduced skip of first block.
     19 C 2000-12-04  W. Collins  Generalize heights of observations to allow
     20 C     any set heights for each station. Honor pre-existing quality
     21 C     marks.
     22 C 2000-12-14  W. Collins  Modify to perform qc at all hours of data,
     23 C     including first and last.  Also prints results for all hours.
     24 C 2001-02-07  W. Collins  Correct error in DMA that did not flag all
     25 C     bad data.  Logic change that allows some off-time data to be
     26 C     qc'd.
     27 C 2001-04-25  W. Collins  Modify to allow up to 143 levels of profiler
     28 C     winds. (Previous limit was 43.)
     29 C 2004-09-09  D. Keyser   Major changes: 1) To correct errors: Lvl
     30 C     index in all arrays now site specific to allow proper temporal
     31 C     checking at each individual site (each site examined over all
     32 C     rpt times to generate hgt profile containing all possible lvls,
     33 C     times w/ new lvls inserted get missing wind). Incr., temporal,
     34 C     vert. & median chk error limits now directly assoc. w/ a rpted
     35 C     hgt above ground lvl rather than w/ lvl index in arrays (ensures
     36 C     proper error limit used at all lvls & eliminates hgt above ground
     37 C     vs. hgt above sea lvl discrepancy - error limits values remain
     38 C     unchanged). Kurtotis stat. now computed correctly. 2) To
     39 C     account for new CAP & JMA rpts: Max. no. of sites processed
     40 C     incr. from 40 to 120. No. of time periods input now site specific
     41 C     (was hardwired to be same for all rpts). Temporal check for CAPs
     42 C     attempt to get 2-hr. spanning del-time so error limits are valid
     43 C     (since based on NPNs), else del-time must be .ge. half-hr on one
     44 C     side, else temporal check not performed.  Max. del-time on one
     45 C     side is 2-hrs for all rpts. 3) Changes which improve q.c. alg.:
     46 C     Namelist switches added to specify output time window - allows
     47 C     input to have wider time window so temporal chk at all output
     48 C     times can be based on 2-sided diff {before temporal chk on
     49 C     output rpts on time (assimilation) bdry based on 1-sided diff}.
     50 C     4) Cosmetic changes: DOCBLOCKS & comments more descriptive.  DO-
     51 C     LOOP logic more concise (esp. in temporal & vert. chks). Stdout
     52 C     easier to read & more complete.  Excessive stdout print of
     53 C     differencing results can be removed w/ new namelist switch which
     54 C     controls the degree of printout. Reason codes are expanded (see
     55 C     remarks). Rpt lvl info. in various output listings expanded &
     56 C     sorted into bins containing both all data lvls & only lvls w/
     57 C     either suspect or bad q. marks; output written to text files but

Page 2           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

     58 C     not incl. in stdout. Stat. output clarified & written to 2 text
     59 C     files separate from stdout.  Computation & printout of stats, as
     60 C     well as combination of stat types printed out controlled via new
     61 C     namelist switches. Stats generated separately for NPN, CAP & JMA
     62 C     rpts and stratified according to hgt above ground.
     63 C 2012-11-20  J. WOOLLEN  INITIAL PORT TO WCOSS 
     64 C 2013-02-05  D. Keyser   Final changes to run on WCOSS: Set BUFRLIB
     65 C     missing (BMISS) to 10E8 rather than 10E10 to avoid integer
     66 C     overflow; rename all REAL(8) variables as *_8; use formatted
     67 C     print statements where previously unformatted print was > 80
     68 C     characters.
     69 C 2016-12-20  Stokes/Keyser  Increase the max allowable number of times
     70 C     per station.  Skip reports and print warning if that limit is 
     71 C     exceeded.
     72 C
     73 C USAGE:
     74 C   INPUT FILES:
     75 C     UNIT 05  - NAMELIST &RDATA (SEE REMARKS)
     76 C     UNIT 14  - PREPBUFR FILE
     77 C
     78 C   OUTPUT FILES:
     79 C     UNIT 06  - STANDARD OUTPUT PRINT
     80 C     UNIT 51  - PREPBUFR FILE
     81 C     UNIT 52  - LISTING (TYPE 1) OF ALL OUTPUT WIND PROFILER LEVELS
     82 C     UNIT 53  - LISTING (TYPE 2) OF ALL OUTPUT WIND PROFILER LEVELS
     83 C     UNIT 54  - LISTING (TYPE 1) OF WIND PROFILER LEVELS WITH EVENTS
     84 C                FROM THIS PROGRAM PLUS PRE-EXISTING PREPBUFR BAD
     85 C                LEVELS
     86 C     UNIT 55  - LISTING (TYPE 2) OF WIND PROFILER LEVELS WITH EVENTS
     87 C                FROM THIS PROGRAM PLUS PRE-EXISTING PREPBUFR BAD
     88 C                LEVELS
     89 C     UNIT 61  - PRINTOUT OF SELECTED STATISTICS OF RESULTS ON EACH 
     90 C                LEVEL (BY REPORT TYPE, REPORT TIME AND FIELD)
     91 C     UNIT 62  - STATISTICS FILE CONTAINING ALL STATISTICS ON EACH
     92 C                LEVEL (BY REPORT TYPE (BY REPORT TYPE AND FIELD, BUT
     93 C                OVER ALL TIMES COMBINED)
     94 C
     95 C   SUBPROGRAMS CALLED:
     96 C     SYSTEM:    - SYSTEM
     97 C     UNIQUE:    - WRITBUFR CHECKS   CSTATS   DIFS
     98 C                  DMA      EVENT    INCR     INDICATE INIT
     99 C                  ISDONE   MODQUAL  PLINT    PRNTDATA
    100 C                  PUTDATA  READPROF RESIDUAL PSTAT    MSTATS
    101 C                  TWODIM   RESTRUCT SORT     ISORT    SHELL
    102 C     LIBRARY:
    103 C       W3NCO    - W3TAGB   W3TAGE   W3MOVDAT ERREXIT
    104 C       BUFRLIB  - CLOSBF   CLOSMG   COPYMG   DATELEN  OPENBF
    105 C                  OPENMG   READMG   READSB   UFBCPY   UFBINT
    106 C                  UFBQCD   WRITSB   UFBCNT   SETBMISS GETBMISS
    107 C
    108 C   EXIT STATES:
    109 C     COND =   0 - SUCCESSFUL RUN
    110 C              4 - NO WIND PROFILER REPORTS READ IN
    111 C
    112 C REMARKS: CONTENTS OF INPUT NAMELIST &RDATA:
    113 C               IPRINT   - Include additional diagnostic print
    114 C                          in stdout?  (=0 - No, =1 - Yes)   (Default=0)

Page 3           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

    115 C               TIMWIN_E - Earliest time relative to cycle time
    116 C                          for outputting reports (hours)    (Def=-3.00)
    117 C               TIMWIN_L - Latest   time relative to cycle time
    118 C                          for outputting reports (hours)    (Def=+2.99)
    119 C               STATS    - Print out stats to units 61 and 62?
    120 C                   STATS=TRUE  -- Yes
    121 C                   STATS=FALSE -- No                          (Default)
    122 C            If STATS=TRUE:
    123 C               MEAN     - Print mean to unit 61?
    124 C                   MEAN=TRUE  -- Yes                          (Default)
    125 C                   MEAN=FALSE -- No
    126 C               STDDEV   - Print standard deviation to unit 61?
    127 C                   STDDEV=TRUE  -- Yes                        (Default)
    128 C                   STDDEV=FALSE -- No
    129 C               SKEW     - Print skewness to unit 61?
    130 C                   SKEW=TRUE  -- Yes
    131 C                   SKEW=FALSE -- No                           (Default)
    132 C               KURT     - Print kurtosis to unit 61?
    133 C                   KURT=TRUE  -- Yes
    134 C                   KURT=FALSE -- No                           (Default)
    135 C               (Note: IF STATS=TRUE, all four moments above are
    136 C                      printed to unit 62 regardless of switches above)
    137 C
    138 C    Reason Codes:
    139 C       Prior to ??/??/2003:
    140 C           3 - Wind obs found to be of questionable quality (wind
    141 C                quality marker set to "3" for suspect)
    142 C          13 - Wind obs failed quality control checks (wind quality
    143 C                marker set to "13" for bad)
    144 C       After ??/??/2003:
    145 C          The reason code provides detailed information about the
    146 C          nature of the quality marker change.  It is defined as a
    147 C          3-digit number XYZ, where the value of each digit has the
    148 C          following meaning:
    149 C
    150 C          Hundredth's digit (X):
    151 C             1 - Median check and vertical check both passed or not
    152 C                  possible
    153 C             2 - Median check suspect, vertical check passed or not
    154 C                  possible
    155 C             3 - Median check passed or not possible, vertical check
    156 C                  suspect
    157 C             4 - Median check and vertical check both suspect
    158 C             5 - Median check failed, vertical check did not fail (may
    159 C                  have passed, may be suspect, or may not be possible)
    160 C             6 - Median check did not fail (may have passed, may be
    161 C                  suspect, or may not be possible), vertical check
    162 C                  failed
    163 C             7 - Median check and vertical check both failed
    164 C
    165 C          Tenth's digit (Y):
    166 C             1 - Temporal check and increment check both passed or not
    167 C                  possible
    168 C             2 - Temporal check suspect, increment check passed or not
    169 C                  possible
    170 C             3 - Temporal check passed or not possible, increment
    171 C                  check suspect

Page 4           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

    172 C             4 - Temporal check and increment check both suspect
    173 C             5 - Temporal check failed, increment check did not fail
    174 C                  (may have passed, may be suspect, or may not be
    175 C                  possible)
    176 C             6 - Temporal check did not fail (may have passed, may be
    177 C                  suspect, or may not be possible), increment check
    178 C                  failed
    179 C             7 - Temporal check and increment check both failed
    180 C
    181 C          Unit's digit (Z):
    182 C             0 - Either: none of the checks failed (but one or more
    183 C                  are suspect, see hundredth's and tenth's digits), or
    184 C                  one or more checks failed (see hundredth's and
    185 C                  tenth's digits) but no vector differences could be
    186 C                  calculated
    187 C             1 - One or more checks failed (see hundredth's and
    188 C                  tenth's digits), where only one vector difference
    189 C                  (increment-temporal, increment-vertical, temporal-
    190 C                  vertical, temporal-median, vertical-median) could be
    191 C                  calculated
    192 C             2 - One or more checks failed (see hundredth's and
    193 C                  tenth's digits), where only increment-temporal
    194 C                  vector difference is small (all others are either
    195 C                  large or could not be calculated)
    196 C             3 - One or more checks failed (see hundredth's and
    197 C                  tenth's digits), where only increment-vertical
    198 C                  vector difference is small (all others are either
    199 C                  large or could not be calculated)
    200 C             4 - One or more checks failed (see hundredth's and
    201 C                  tenth's digits), where only increment-median vector
    202 C                  difference is small (all others are either large or
    203 C                  could not be calculated)
    204 C             5 - One or more checks failed (see hundredth's and
    205 C                  tenth's digits), where only temporal-vertical vector
    206 C                  difference is small (all others are either large or
    207 C                  could not be calculated)
    208 C             6 - One or more checks failed (see hundredth's and
    209 C                  tenth's digits), where only temporal-median vector
    210 C                  difference is small (all others are either large or
    211 C                  could not be calculated)
    212 C             7 - One or more checks failed (see hundredth's and
    213 C                  tenth's digits), where only the vertical-median
    214 C                  vector difference is small (all others are either
    215 C                  large or could not be calculated)
    216 C             8 - One or more checks failed (see hundredth's and
    217 C                  tenth's digits), where any two or three of the
    218 C                  vector differences (increment-temporal, increment-
    219 C                  vertical, temporal-vertical, temporal-median,
    220 C                  vertical-median) are small (all others are either
    221 C                  large or could not be calculated)
    222 C             9 - One or more checks failed (see hundredth's and
    223 C                  tenth's digits), where any four, five or six of the
    224 C                  vector differences (increment-temporal, increment-
    225 C                  vertical, temporal-vertical, temporal-median,
    226 C                  vertical-median) are small (all others are either
    227 C                  large or could not be calculated)
    228 C

Page 5           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

    229 C          Note: The wind quality marker is set to suspect ("3") for
    230 C                any reason code XYZ, where X is 1-4, and Y is 1-4, and
    231 C                Z is 0.  Any other reason code (X is 5-7, or Y is 5-7,
    232 C                or Z is 1-9) results in a wind quality marker set to
    233 C                bad ("13"). 
    234 C
    235 C ATTRIBUTES:
    236 C   LANGUAGE: FORTRAN 90
    237 C   MACHINE:  NCEP WCOSS (iDataPlex and Cray-XC40)
    238 C
    239 C$$$
    240       PROGRAM PREPOBS_PROFCQC
    241 
    242       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
    243 
    244       LOGICAL  DONE,STATS,MEAN,STDDEV,SKEW,KURT
    245       CHARACTER*8  STN
    246       REAL(8)   BMISS,GETBMISS
    247 
    248       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
    249      $ IRTP(NS)
    250       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
    251      $ NFIN,NFOUT
    252       COMMON/TIMEO/TIMWIN_E,TIMWIN_L
    253       COMMON/STATZ/UZS(120,0:24,9,3:8),VZS(120,0:24,9,3:8),
    254      $ UIS(120,0:24,9,3:8),VIS(120,0:24,9,3:8),UTS(120,0:24,9,3:8),
    255      $ VTS(120,0:24,9,3:8),UVS(120,0:24,9,3:8),VVS(120,0:24,9,3:8),
    256      $ VVIS(120,0:24,9,3:8),VVTS(120,0:24,9,3:8),VVVS(120,0:24,9,3:8),
    257      $ VVMS(120,0:24,9,3:8),UMS(120,0:24,9,3:8),VMS(120,0:24,9,3:8)
    258       COMMON/PST/IOFFSET(3:8),LVLINCR(3:8),ILEVELS(3:8),STATS,MEAN,
    259      $ STDDEV,SKEW,KURT
    260       COMMON /BUFRLIB_MISSING/BMISS
    261 
    262       NAMELIST/RDATA/IPRINT,TIMWIN_E,TIMWIN_L,STATS,MEAN,STDDEV,SKEW,
    263      $ KURT
    264 
    265       CALL W3TAGB('PREPOBS_PROFCQC',2016,0355,1200,'NP22')
    266 
    267       WRITE(6,100)
    268 
    269       IPRINT =       0 ! default is no additional diag. print to stdout
    270       TIMWIN_E = -3.00 ! default earliest time to output reports
    271       TIMWIN_L = +2.99 ! default latest   time to output reports
    272       STATS = .FALSE.  ! default is to NOT calc./print stats
    273       MEAN  = .TRUE.   ! if STATS=T, default is to print mean
    274       STDDEV= .TRUE.   ! if STATS=T, default is to print stddev
    275       SKEW  = .FALSE.  ! if STATS=T, default is to NOT print skewness
    276       KURT  = .FALSE.  ! if STATS=T, default is to NOT print kurtosis
    277       READ(5,RDATA)           
    278       WRITE(6,RDATA)
    279 
    280 C  On WCOSS should always set BUFRLIB missing (BMISS) to 10E8 to avoid
    281 C   overflow when either an INTEGER*4 variable is set to BMISS or a
    282 C   REAL*8 (or REAL*4) variable that is missing is NINT'd
    283 C  -------------------------------------------------------------------
    284 ccccc CALL SETBMISS(10E10_8)
    285       CALL SETBMISS(10E8_8)

Page 6           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

    286       BMISS=GETBMISS()
    287       print *
    288       print *, 'BUFRLIB value for missing is: ',bmiss
    289       print *
    290 
    291       WRITE(52,101)
    292       WRITE(53,101)
    293       WRITE(54,101)
    294       WRITE(55,101)
    295 
    296       CALL INIT               ! initialize
    297       CALL READPROF           ! read in wind profiler data
    298       CALL RESTRUCT           ! restructure (sort) vertical & times
    299       CALL INCR               ! calculate increments
    300 
    301       DO IS=1,NSTN            ! Loop through all the unique stations
    302          WRITE(6,102) STN(IS)
    303          NSCAN = 0
    304          DONE = .FALSE.
    305          DO WHILE (.NOT.DONE)      ! Loop through scans
    306             NSCAN = NSCAN + 1
    307             CALL RESIDUAL(IS)      ! calculate residuals
    308             CALL INDICATE(IS)      ! calculate indicators
    309             CALL DIFS(IS,IPRINT)   ! calculate vector differences
    310             CALL DMA(IS)           ! decision making algorithm
    311             CALL ISDONE(DONE)      ! check to see if done
    312          ENDDO
    313          IF(STATS) CALL CSTATS(IS) ! collect statistics
    314          CALL MODQUAL(IS)          ! modify quality marks
    315          CALL PRNTDATA(IS)         ! print data, quality marks
    316       ENDDO
    317 
    318       IF(STATS) CALL PSTAT ! compute mean, std dev, etc. & prnt stats
    319       CALL WRITBUFR        ! write PREPBUFR file w/ profiler events
    320 
    321       CALL W3TAGE('PREPOBS_PROFCQC')
    322 
    323       STOP
    324 
    325   100 FORMAT(' WELCOME TO PREPOBS_PROFCQC -- VERSION 12/20/2016'//)
    326   101 FORMAT(1X,128('*'))
    327   102 FORMAT(/'xxxxxxxxxxxxxxxxxxxxxxxxxxx'/'Process Stn. ',A8)
    328 
    329       END

Page 7           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name              
                    
 MAIN__             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  325                                                            267                               
 101                        Label  326                                                            291,292,293,294                   
 102                        Label  327                                                            302                               
 BMISS                      Scalar 246      R(8)            8           scalar   COM              286,288                           
 BUFRLIB_MISSING            Common 260                                  8                                                           
 CSTATS                     Subr   313                                                            313                               
 DIFS                       Subr   309                                                            309                               
 DMA                        Subr   310                                                            310                               
 DONE                       Local  244      L(4)            4           scalar                    304,305,311                       
 GETBMISS                   Func   246      R(8)            8           scalar                    286                               
 ILEVELS                    Scalar 258      I(4)            4     1     6        COM                                                
 INCR                       Subr   299                                                            299                               
 INDICATE                   Subr   308                                                            308                               
 INIT                       Subr   296                                                            296                               
 IOFFSET                    Scalar 258      I(4)            4     1     6        COM                                                
 IPRINT                     Local  262      I(4)            4           scalar                    262,269,309                       
 IRTP                       Scalar 249      I(4)            4     1     120      COM                                                
 IS                         Local  301      I(4)            4           scalar                    301,302,307,308,309,310,313,314,31
                                                                                                  5                                 
 ISDONE                     Subr   311                                                            311                               
 KURT                       Scalar 244      L(4)            4           scalar   COM              263,276                           
 LVLINCR                    Scalar 258      I(4)            4     1     6        COM                                                
 MEAN                       Scalar 244      L(4)            4           scalar   COM              262,273                           
 MODQUAL                    Subr   314                                                            314                               
 NCH                        Scalar 250      I(4)            4           scalar   COM                                                
 NFIN                       Scalar 251      I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 251      I(4)            4           scalar   COM                                                
 NL                         Param  242      I(4)            4           scalar                                                      
 NLEV                       Scalar 250      I(4)            4           scalar   COM                                                
 NREP                       Scalar 250      I(4)            4           scalar   COM                                                
 NREP1                      Scalar 250      I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 250      I(4)            4           scalar   COM                                                
 NS                         Param  242      I(4)            4           scalar                    248,249                           
 NSCAN                      Scalar 250      I(4)            4           scalar   COM              303,306                           
 NSTN                       Scalar 250      I(4)            4           scalar   COM              301                               
 NSTN1                      Scalar 250      I(4)            4           scalar   COM                                                
 NT                         Param  242      I(4)            4           scalar                    248                               
 NTIMES                     Scalar 248      I(4)            4     1     120      COM                                                
 PARAMS                     Common 250                                  40                                                          
 PREPOBS_PROFCQC            Prog   240                                                                                              
 PRNTDATA                   Subr   315                                                            315                               
 PST                        Common 258                                  92                                                          
 PSTAT                      Subr   318                                                            318                               
 RDATA                      Local  262                                  scalar                    277,278                           

Page 8           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 READPROF                   Subr   297                                                            297                               
 RESIDUAL                   Subr   307                                                            307                               
 RESTRUCT                   Subr   298                                                            298                               
 SETBMISS                   Subr   285                                                            285                               
 SKEW                       Scalar 244      L(4)            4           scalar   COM              262,275                           
 STATS                      Scalar 244      L(4)            4           scalar   COM              262,272,313,318                   
 STATZ                      Common 253                                  9072000                                                     
 STDDEV                     Scalar 244      L(4)            4           scalar   COM              262,274                           
 STN                        Scalar 245      CHAR            8     1     120      COM              302                               
 STNLST                     Common 248                                  51360                                                       
 TIM                        Scalar 248      R(4)            4     2     12000    COM                                                
 TIMEO                      Common 252                                  8                                                           
 TIMWIN_E                   Scalar 252      R(4)            4           scalar   COM              262,270                           
 TIMWIN_L                   Scalar 252      R(4)            4           scalar   COM              262,271                           
 UIS                        Scalar 254      R(4)            4     4     162000   COM                                                
 UMS                        Scalar 257      R(4)            4     4     162000   COM                                                
 UTS                        Scalar 254      R(4)            4     4     162000   COM                                                
 UVS                        Scalar 255      R(4)            4     4     162000   COM                                                
 UZS                        Scalar 253      R(4)            4     4     162000   COM                                                
 VIS                        Scalar 254      R(4)            4     4     162000   COM                                                
 VMS                        Scalar 257      R(4)            4     4     162000   COM                                                
 VTS                        Scalar 255      R(4)            4     4     162000   COM                                                
 VVIS                       Scalar 256      R(4)            4     4     162000   COM                                                
 VVMS                       Scalar 257      R(4)            4     4     162000   COM                                                
 VVS                        Scalar 255      R(4)            4     4     162000   COM                                                
 VVTS                       Scalar 256      R(4)            4     4     162000   COM                                                
 VVVS                       Scalar 256      R(4)            4     4     162000   COM                                                
 VZS                        Scalar 253      R(4)            4     4     162000   COM                                                
 W3TAGB                     Subr   265                                                            265                               
 W3TAGE                     Subr   321                                                            321                               
 WRITBUFR                   Subr   319                                                            319                               
 X                          Scalar 248      R(4)            4     1     120      COM                                                
 Y                          Scalar 248      R(4)            4     1     120      COM                                                
 Z0                         Scalar 248      R(4)            4     1     120      COM                                                

Page 9           Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

    330 
    331 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    332 C
    333 C SUBPROGRAM:    BLOCK DATA
    334 C   PRGMMR: D. A. KEYSER     ORG: NP22       DATE: 2016-12-20
    335 C
    336 C ABSTRACT: BLOCK DATA FOR PREPOBS_PROFCQC.
    337 C
    338 C PROGRAM HISTORY LOG:
    339 C 1996-11-20  W. Collins -- Original author.
    340 C 2004-09-09  D. Keyser  -- XI, XT, XV now expanded to cover all
    341 C     possible levels.
    342 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
    343 C     per station.
    344 C
    345 C
    346 C ATTRIBUTES:
    347 C   LANGUAGE: FORTRAN 90
    348 C   MACHINE:  NCEP WCOSS
    349 C
    350 C$$$
    351 
    352       BLOCK DATA
    353 
    354       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
    355 
    356       COMMON/PST/IOFFSET(3:8),LVLINCR(3:8),ILEVELS(3:8),STATS,MEAN,
    357      $ STDDEV,SKEW,KURT
    358       COMMON/LIMITS/XI(9125), XT(15750), XV(15750)
    359       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
    360      $ NFIN,NFOUT
    361 
    362       DATA  NSTN/0/,NSTN1/0/,NREP/0/,NREP1/0/,NREP_OUT/0/,NLEV/143/,
    363      $ NSCAN/0/,NFIN/14/,NFOUT/51/,NCH/0/
    364 
    365 C --> Height index calculation variables:
    366 C                       NPN  n/a  n/a  n/a  CAP  JMA
    367 C                       ---  ---  ---  ---  ---  ---
    368       DATA  IOFFSET   / 250, -99, -99, -99,   0, 100/ ! Offset
    369       DATA  LVLINCR   / 250, -99, -99, -99,  50, 300/ ! Increment
    370       DATA  ILEVELS   /  64, -99, -99, -99, 120,  30/ ! Max. no. lvls
    371 
    372 C  FOLLOWING DATA SUITABLE FOR NDAS/NAM ANALYSIS BACKGROUND.
    373 C  ALSO USED FOR RAP (AND BEFORE THAT RUC) BACKGROUND.
    374 C  ---------------------------------------------------------
    375 
    376 C               1 -  6875 m : 2.10
    377 C            6876 -  7125 m : 2.20
    378 C            7126 -  7375 m : 2.40
    379 C            7376 -  7625 m : 2.60
    380 C            7626 -  7875 m : 2.80
    381 C            7876 -  8125 m : 3.00
    382 C            8126 -  8375 m : 3.20
    383 C            8376 -  8625 m : 3.40
    384 C            8626 -  8875 m : 3.60
    385 C            8876 -  9125 m : 3.70
    386 C                 >  9125 m : 3.80

Page 10          Source Listing                  PREPOBS_PROFCQC
2017-04-18 11:09                                 profcqc.f

    387 
    388       DATA XI/6875*2.10,  250*2.20,  250*2.40,  250*2.60,  250*2.80,
    389      $         250*3.00,  250*3.20,  250*3.40,  250*3.60,  250*3.70/
    390 
    391 
    392 C               1 -  7125 m : 1.20
    393 C            7126 -  7375 m : 1.25
    394 C            7376 -  7625 m : 1.30
    395 C            7626 -  7875 m : 1.35
    396 C            7876 -  8125 m : 1.40
    397 C            8126 -  8375 m : 1.45
    398 C            8376 -  8625 m : 1.50
    399 C            8626 -  8875 m : 1.55
    400 C            8876 -  9125 m : 1.60
    401 C            9126 -  9750 m : 1.65
    402 C            9501 - 10750 m : 1.70
    403 C           10751 - 11750 m : 1.75
    404 C           11751 - 12750 m : 1.80
    405 C           12751 - 13750 m : 1.85
    406 C           13751 - 14750 m : 1.90
    407 C           14751 - 15750 m : 1.95
    408 C                 > 15750 m : 2.00
    409 
    410       DATA XT/7125*1.20,  250*1.25,  250*1.30,  250*1.35,  250*1.40,
    411      $         250*1.45,  250*1.50,  250*1.55,  250*1.60,  625*1.65,
    412      $        1000*1.70, 1000*1.75, 1000*1.80, 1000*1.85, 1000*1.90,
    413      $        1000*1.95/
    414 
    415 
    416 C               1 -   625 m : 2.20
    417 C             626 -   875 m : 2.00
    418 C             876 -  1125 m : 1.80
    419 C            1126 -  1375 m : 1.50
    420 C            1376 -  1625 m : 1.30
    421 C            1626 -  1875 m : 1.00
    422 C            1876 -  8125 m : 0.70
    423 C            8126 -  8375 m : 0.80
    424 C            8376 -  8625 m : 1.00
    425 C            8626 -  8875 m : 1.20
    426 C            8876 -  9125 m : 1.40
    427 C            9126 -  9750 m : 1.60
    428 C            9501 - 10750 m : 1.80
    429 C           10751 - 11750 m : 2.00
    430 C           11751 - 12750 m : 2.20
    431 C           12751 - 13750 m : 2.40
    432 C           13751 - 14750 m : 2.60
    433 C           14751 - 15750 m : 2.80
    434 C                 > 15750 m : 3.00
    435 
    436       DATA XV/ 625*2.20,  250*2.00,  250*1.80,  250*1.50,  250*1.30,
    437      $         250*1.00, 6250*0.70,  250*0.80,  250*1.00,  250*1.20,
    438      $         250*1.40,  625*1.60, 1000*1.80, 1000*2.00, 1000*2.20,
    439      $        1000*2.40, 1000*2.60, 1000*2.80/
    440 
    441       END

Page 11          Source Listing                  _unnamed_data$_
2017-04-18 11:09                                 profcqc.f

    442 
    443 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    444 C
    445 C SUBPROGRAM:    WRITBUFR
    446 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
    447 C
    448 C ABSTRACT: WRITE OUTPUT PREPBUFR FILE, IDENTICAL TO INPUT
    449 C   EXCEPT FOR THE ADDITION OF WIND PROFILER Q.C. EVENTS.
    450 C
    451 C PROGRAM HISTORY LOG:
    452 C 1996-11-20  W. Collins -- Original author.
    453 C 2004-09-09  D. Keyser  -- Namelist switches added to specify output
    454 C     time window - allows input to have wider time window so temporal
    455 C     chk at all output times can be based on 2-sided diff {before
    456 C     temporal chk on output rpts on time (assimilation) bdry based on
    457 C     1-sided diff}.
    458 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
    459 C     per station.
    460 C
    461 C USAGE:    CALL WRITBUFR
    462 C   INPUT FILES:
    463 C     NFIN    - PREPBUFR INPUT TO THIS PROGRAM
    464 C
    465 C   OUTPUT FILES:
    466 C     NFOUT   - PREPBUFR OUTPUT FROM THIS PROGRAM (INCL. WIND PROFILER
    467 C             - EVENTS)
    468 C     UNIT 06 - STANDARD OUTPUT PRINT
    469 C
    470 C ATTRIBUTES:
    471 C   LANGUAGE: FORTRAN 90
    472 C   MACHINE:  NCEP WCOSS
    473 C
    474 C$$$
    475 
    476       SUBROUTINE WRITBUFR
    477 
    478       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
    479 
    480       LOGICAL  FIRST
    481       CHARACTER*8  STN,LAST,SUBSET,CID
    482       CHARACTER*40 HSTR, OSTR, ESTR
    483       REAL  UVO(255,2),VQM(255),VRC(255)
    484       REAL(8)  SID_8,HDR_8(10),OBS_8(10,255),BMISS
    485       INTEGER  IND(NL)
    486 
    487       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
    488      $ NFIN,NFOUT
    489       COMMON/DATEZ/JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
    490       COMMON/HEADER/SID_8,XOB,YOB,DHR,ELV,XTP,TYP,T29,NLV
    491       COMMON/PROBS/ZOB(255),UOB(255),VOB(255),WQM(255),POB(255),
    492      $ UFC(255),VFC(255),CAT(255),SOB(255),DOB(255)
    493       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),
    494      $ QZ(NL,NT,NS),PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),
    495      $ SZ(NL,NT,NS),DZ(NL,NT,NS),LEVZ(NL,NT,NS)
    496       COMMON/PROFP/ZP(NL,NT,NS),UP(NL,NT,NS),VP(NL,NT,NS),QP(NL,NT,NS),
    497      $ PP(NL,NT,NS),UFP(NL,NT,NS),VFP(NL,NT,NS),LEVP(NL,NT,NS)
    498       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),

Page 12          Source Listing                  WRITBUFR
2017-04-18 11:09                                 profcqc.f

    499      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
    500      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
    501       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
    502      $ IRTP(NS)
    503       COMMON/TIMEO/TIMWIN_E,TIMWIN_L
    504       COMMON /BUFRLIB_MISSING/BMISS
    505 
    506       EQUIVALENCE  (SID_8,CID)
    507 
    508       DATA  HSTR/'SID XOB YOB DHR ELV ITP TYP T29        '/
    509       DATA  OSTR/'ZOB UOB VOB WQM POB UFC VFC CAT FFO DDO'/
    510       DATA  ESTR/'UOB VOB WQM WPC WRC                    '/
    511 
    512       DATA  LAST/'XXXXXXXX'/ISUBO/0/,ISUBOT/0/,IRECOL/0/,IRECO/0/
    513 
    514       WRITE(6,100)
    515 
    516 C  OPEN INPUT FILE AND GET DATE
    517 C  ----------------------------
    518 
    519       REWIND NFIN
    520       CALL DATELEN(10)
    521       CALL OPENBF(NFIN,'IN',NFIN)
    522       WRITE(6,101) NFIN
    523       CALL OPENBF(NFOUT,'OUT',NFIN)
    524       WRITE(6,102) NFOUT,NFIN
    525       CALL UFBQCD(NFIN,'CQCPROF',CQCPC)
    526 
    527    10 CONTINUE
    528 
    529 C  READ NEXT INPUT BUFR MESSAGE
    530 C  ----------------------------
    531 
    532       CALL READMG(NFIN,SUBSET,IDATEP,IRET)
    533       IF(IRET.NE.0) THEN
    534 C ALL BUFR MESSAGES IN FILE HAVE BEEN READ CLOSE INPUT DATA SET
    535          IF(LAST.EQ.'PROFLR  ') THEN
    536             CALL UFBCNT(NFOUT,IRECO,ISUBO)
    537             ISUBOT = ISUBOT + ISUBO
    538             WRITE(6,103) IRECO,LAST,ISUBO,ISUBOT
    539          ENDIF
    540          WRITE(6,104) IRECO,ISUBOT,NFIN
    541          CALL CLOSBF(NFOUT)
    542          WRITE(6,105)  NFOUT,NREP_OUT
    543          RETURN
    544       ENDIF
    545       CALL UFBCNT(NFIN,IRECI,ISUBI)
    546       IF(SUBSET.EQ.'PROFLR  ')  WRITE(6,106) IRECI,SUBSET
    547       IF(LAST.NE.SUBSET) THEN
    548          IF(LAST.EQ.'PROFLR  ') THEN
    549             CALL UFBCNT(NFOUT,IRECO,ISUBO)
    550             ISUBOT = ISUBOT + ISUBO
    551             WRITE(6,103) IRECO,LAST,ISUBO,ISUBOT
    552 C MUST CLOSE THE LAST "PROFLR" TABLE A ENTRY MESSAGE
    553             CALL CLOSMG(NFOUT)
    554          ENDIF
    555          WRITE(6,107) NFOUT,SUBSET,IDATEP

Page 13          Source Listing                  WRITBUFR
2017-04-18 11:09                                 profcqc.f

    556          CALL UFBCNT(NFOUT,IRECOL,ISUBO)
    557          IRECOL = IRECOL + 1
    558       ENDIF
    559       LAST = SUBSET
    560       IF(SUBSET.NE.'PROFLR  ') THEN
    561 C ALL TABLE A ENTRY BUFR MESSAGES THAT ARE NOT "PROFLR" ARE SIMPLY
    562 C  COPIED FROM INPUT FILE TO OUTPUT FILE AS IS (NO DECODING OF SUBSETS)
    563          CALL COPYMG(NFIN,NFOUT)
    564          CALL UFBCNT(NFOUT,IRECO,ISUBO)
    565          ISUBOT = ISUBOT + ISUBO
    566          GOTO 10
    567       ENDIF
    568 C TABLE A ENTRY "PROFLR" MESSAGES COME HERE TO DECODE/ENCODE EACH SUBSET
    569       CALL OPENMB(NFOUT,SUBSET,IDATEP)
    570 
    571    20 CONTINUE
    572 
    573 C READ IN NEXT SUBSET (REPORT) FROM THIS BUFR MESSAGE
    574       CALL READSB(NFIN,IRET)
    575 C NON-ZERO IRET IN READSB MEANS ALL SUBSETS IN BUFR MSG HAVE BEEN READ
    576 C GO ON TO READ NEXT BUFR MESSAGE
    577       IF(IRET.NE.0) GOTO 10
    578 
    579 C  READ AND STORE HEADER ELEMENTS
    580 C  ------------------------------
    581 
    582       CALL UFBINT(NFIN,HDR_8,10,  1,IRET,HSTR)
    583       SID_8 = HDR_8(1)
    584       XOB = HDR_8(2)
    585       YOB = HDR_8(3)
    586       DHR = HDR_8(4)
    587       ELV = HDR_8(5)
    588       XTP = HDR_8(6)
    589       TYP = HDR_8(7)
    590       T29 = HDR_8(8)
    591 
    592 ccccc print*, CID,(HDR_8(i),i=2,8)
    593 
    594 C  DETERMINE IF THIS REPORT IS WITHIN OUTPUT TIME WINDOW RANGE
    595 C  -----------------------------------------------------------
    596 
    597       IF(NINT(DHR*1000.).LT.NINT(TIMWIN_E*1000.).OR.
    598      $   NINT(DHR*1000.).GT.NINT(TIMWIN_L*1000.)) THEN
    599          WRITE(6,108)  CID,YOB,XOB,DHR
    600          GOTO 20
    601       ENDIF
    602 
    603 C  MATCH REPORT ID TO STORED DATA
    604 C  ------------------------------
    605 
    606       DO NN=1,NSTN
    607         N = NN
    608         IF(CID.EQ.STN(N)) THEN
    609 
    610 C  MATCH REPORT D-TIME TO STORED DATA
    611 C  ----------------------------------
    612 

Page 14          Source Listing                  WRITBUFR
2017-04-18 11:09                                 profcqc.f

    613             DO MM=1,NTIMES(N)
    614                M = MM
    615                IF(DHR.EQ.TIM(MM,N))  GOTO 30
    616             ENDDO
    617          ENDIF
    618       ENDDO
    619 
    620 
    621 C  NO MATCH FOR ID OR TIME; COPY REPORT TO OUTPUT
    622 C  ----------------------------------------------
    623 
    624       WRITE(6,109)  CID,DHR
    625       NREP_OUT = NREP_OUT + 1
    626       CALL UFBCPY(NFIN,NFOUT)
    627       CALL WRITSB(NFOUT)
    628       GOTO 20
    629 
    630    30 CONTINUE
    631 
    632       WRITE(6,110)  CID,N,M
    633 
    634 C  READ DATA OF PROPER SUBSET AND STATION
    635 C  --------------------------------------
    636 
    637       CALL UFBINT(NFIN,OBS_8,10,255,NLV,OSTR)
    638       DO L=1,NLV
    639         ZOB(L) = OBS_8(1,L)
    640         UOB(L) = OBS_8(2,L)
    641         VOB(L) = OBS_8(3,L)
    642         WQM(L) = OBS_8(4,L)
    643         POB(L) = OBS_8(5,L)
    644         UFC(L) = OBS_8(6,L)
    645         VFC(L) = OBS_8(7,L)
    646         CAT(L) = OBS_8(8,L)
    647         SOB(L) = OBS_8(9,L)
    648         DOB(L) = OBS_8(10,L)
    649       ENDDO
    650 
    651 C  COPY ORIGINAL REPORT TO OUTPUT
    652 C  ------------------------------
    653 
    654       CALL UFBCPY(NFIN,NFOUT)
    655 
    656 C  FORM BUFR EVENTS
    657 C  ----------------
    658 
    659       FIRST = .TRUE.
    660       LL = 0
    661       DO LZ=1,NZZ(N)
    662         IF(IQCC(LZ,M,N).NE.0 .AND. LEVZ(LZ,M,N).GT.0) THEN
    663           IF(FIRST) THEN
    664             WRITE(6,111)
    665             FIRST = .FALSE.
    666           ENDIF
    667           LL = LL + 1
    668           L0 = LEVZ(LZ,M,N)
    669           UVO(LL,1) = UOB(L0)

Page 15          Source Listing                  WRITBUFR
2017-04-18 11:09                                 profcqc.f

    670           UVO(LL,2) = VOB(L0)
    671           VQM(LL) = IQCC(LZ,M,N)
    672           VRC(LL) = IRC(LZ,M,N)
    673           IND(LL) = L0
    674           WRITE(6,112) L0,CID,NINT(CAT(L0)),ZOB(L0),LL,LZ,M,N,UVO(LL,1),
    675      $     UVO(LL,2),IQCC(LZ,M,N)
    676           IF(L0.GT.1) THEN
    677             LOOP1: DO LM=L0-1,1,-1
    678              IF(ZOB(LM).LT.BMISS) EXIT LOOP1
    679               IF(CAT(LM).EQ.7) THEN
    680                 LL = LL + 1
    681                 UVO(LL,1) = UOB(LM)
    682                 UVO(LL,2) = VOB(LM)
    683                 VQM(LL) = IQCC(LZ,M,N)
    684                 VRC(LL) = IRC(LZ,M,N)
    685                 IND(LL) = LM
    686                 WRITE(6,113) LM,CID,NINT(CAT(LM)),ZOB(LM),LL,LZ,M,N,
    687      $           UVO(LL,1),UVO(LL,2),IQCC(LZ,M,N)
    688               ENDIF
    689             ENDDO LOOP1
    690           ENDIF
    691         ENDIF
    692       ENDDO
    693 
    694 C  WRITE EVENTS
    695 C  ------------
    696 
    697       IF(LL.NE.0) THEN
    698         CALL EVENT(NFOUT,ESTR,NLV,UVO,VQM,VRC,IND,LL,CQCPC)
    699       ELSE
    700          WRITE(6,114)
    701       ENDIF
    702 
    703       NREP_OUT = NREP_OUT + 1
    704       CALL WRITSB(NFOUT)
    705       CALL UFBCNT(NFOUT,IRECO,ISUBON)
    706       IF(IRECO.GT.IRECOL) THEN
    707          IRECOL = IRECO
    708          ISUBOT = ISUBOT + ISUBO
    709          WRITE(6,115) IRECO-1,ISUBO,ISUBOT
    710       ENDIF
    711       ISUBO = ISUBON
    712 
    713       GOTO 20
    714 
    715   100 FORMAT(//'READY TO READ ORIGINAL DATA, COPY TO OUTPUT AND ADD ',
    716      $ 'WIND PROFILER EVENTS'/)
    717   101 FORMAT(/5X,'+++> PREPBUFR DATA SET IN UNIT ',I3,' SUCCESSFULLY',
    718      $ ' OPENED FOR INPUT; FIRST MESSAGE CONTAINS BUFR TABLES A,B,D'/)
    719   102 FORMAT(/5X,'+++> PREPBUFR DATA SET IN UNIT ',I3,' SUCCESSFULLY',
    720      $ ' OPENED FOR OUTPUT; CUSTOMIZED BUFR TABLES A,B,D IN UNIT ',I3/
    721      $ 12X,'READ IN AND ENCODED INTO MESSAGE NO. 1 OF OUTPUT DATA SET'/)
    722   103 FORMAT(/' --- WROTE BUFR DATA MSG NO. ',I10,' -- TABLE A ENTRY "',
    723      $A8,'" - CONTAINS',I6,' REPORTS (TOTAL NO. RPTS WRITTEN =',I7,')'/)
    724   104  FORMAT(/' --- ALL TOTAL OF',I11,' BUFR MESSAGES WRITTEN OUT -- ',
    725      $ 'TOTAL NUMBER OF REPORTS WRITTEN =',I7//5X,'===> PREPBUFR DATA ',
    726      $ 'SET IN UNIT ',I3,' SUCCESSFULLY CLOSED FROM FINAL READ OF ALL ',

Page 16          Source Listing                  WRITBUFR
2017-04-18 11:09                                 profcqc.f

    727      $ 'OBS')
    728   105 FORMAT(/5X,'===> PREPBUFR DATA SET IN UNIT ',I3,' SUCCESSFULLY',
    729      $ ' CLOSED AFTER WRITING OF ALL OBS.'/10X,'THE TOTAL NUMBER OF ',
    730      $ 'WIND PROFILER REPORTS WRITTEN WAS',I4/25X,' *** ALL DONE ***'/)
    731   106 FORMAT(' --- READ IN BUFR DATA MESSAGE NUMBER',I6,' WITH TABLE ',
    732      $ 'A ENTRY "',A8)
    733   107 FORMAT(/' ===> NEXT MESSAGE IN OUTPUT PREPBUFR DATA SET IN UNIT ',
    734      $ I3,' HAS NEW TABLE A ENTRY OF "',A6,'" -- DATE IS',I11)
    735   108 FORMAT(/'##WRITBUFR: RPT OUTSIDE TIME WINDOW, ID ',A8,', LAT=',
    736      $ F7.2,'N, LON=',F8.2,'E, D-TIM=',F7.3,' -- DO NOT COPY RPT TO ',
    737      $ 'OUTPUT FILE'/)
    738   109 FORMAT(/'##WRITBUFR: NO ID AND D-TIME MATCH FOR ID ',A8,' AT ',
    739      $ 'D-TIME ',F6.2,' -- COPY REPORT TO OUTPUT PREPBUFR FILE W/O ANY',
    740      $ ' Q.C.'/)
    741   110 FORMAT(' WRITBUFR: FOUND A MATCH FOR ID ',A8,' (STN. NO.',I4,')',
    742      $ ' AT TIME PERIOD',I3)
    743   111 FORMAT(10X,'  STATION   CAT       ZOB EVNT#  LVL  TIM  STN     ',
    744      $ 'UO      VO IQCC')
    745   112 FORMAT(' L0: ',I5,2X,A8,I5,2X,F8.0,4I5,2F8.1,I5)
    746   113 FORMAT(' LM: ',I5,2X,A8,2I5,X,F8.0,4I5,2F8.1,I5)
    747   114 FORMAT('  ... NO EVENTS WRITTEN')
    748   115 FORMAT(/' --- THIS REPORT OPENS NEW MSG (SAME TABLE A): LAST ',
    749      $ 'DATA MSG WAS NO.',I5,' WITH',I5,' REPORTS (TOTAL NO. REPORTS ',
    750      $ 'WRITTEN =',I7,')'/)
    751 
    752       END


ENTRY POINTS

  Name                 
                       
 writbufr_             

Page 17          Source Listing                  WRITBUFR
2017-04-18 11:09 Symbol Table                    profcqc.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  527                                                            566,577                           
 100                        Label  715                                                            514                               
 101                        Label  717                                                            522                               
 102                        Label  719                                                            524                               
 103                        Label  722                                                            538,551                           
 104                        Label  724                                                            540                               
 105                        Label  728                                                            542                               
 106                        Label  731                                                            546                               
 107                        Label  733                                                            555                               
 108                        Label  735                                                            599                               
 109                        Label  738                                                            624                               
 110                        Label  741                                                            632                               
 111                        Label  743                                                            664                               
 112                        Label  745                                                            674                               
 113                        Label  746                                                            686                               
 114                        Label  747                                                            700                               
 115                        Label  748                                                            709                               
 20                         Label  571                                                            600,628,713                       
 30                         Label  630                                                            615                               
 BMISS                      Scalar 484      R(8)            8           scalar   COM              678                               
 BUFRLIB_MISSING            Common 504                                  8                                                           
 CAT                        Scalar 492      R(4)            4     1     255      COM              646,674,679,686                   
 CID                        Scalar 481      CHAR            8           scalar   COM              599,608,624,632,674,686           
 CLOSBF                     Subr   541                                                            541                               
 CLOSMG                     Subr   553                                                            553                               
 COPYMG                     Subr   563                                                            563                               
 CQCPC                      Local  525      R(4)            4           scalar                    525,698                           
 DATELEN                    Subr   520                                                            520                               
 DATEZ                      Common 489                                  240056                                                      
 DHR                        Scalar 490      R(4)            4           scalar   COM              586,597,598,599,615,624           
 DOB                        Scalar 492      R(4)            4     1     255      COM              648                               
 DT                         Scalar 499      R(4)            4     3     1800000  COM                                                
 DZ                         Scalar 495      R(4)            4     3     1800000  COM                                                
 ELV                        Scalar 490      R(4)            4           scalar   COM              587                               
 ESTR                       Local  482      CHAR            40          scalar                    510,698                           
 EVENT                      Subr   698                                                            698                               
 FIRST                      Local  480      L(4)            4           scalar                    659,663,665                       
 HDR_8                      Local  484      R(8)            8     1     10                        582,583,584,585,586,587,588,589,59
                                                                                                  0                                 
 HEADER                     Common 490                                  40                                                          
 HSTR                       Local  482      CHAR            40          scalar                    508,582                           
 IBAD_FLAG                  Scalar 499      I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 498      I(4)            4     3     1800000  COM                                                
 IDATEP                     Local  532      I(4)            4           scalar                    532,555,569                       
 IND                        Local  485      I(4)            4     1     150                       673,685,698                       
 IQ                         Scalar 498      I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 499      I(4)            4     3     1800000  COM              662,671,675,683,687               
 IRC                        Scalar 500      I(4)            4     3     1800000  COM              672,684                           
 IRECI                      Local  545      I(4)            4           scalar                    545,546                           
 IRECO                      Local  512      I(4)            4           scalar                    512,536,538,540,549,551,564,705,70
                                                                                                  6,707,709                         

Page 18          Source Listing                  WRITBUFR
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IRECOL                     Local  512      I(4)            4           scalar                    512,556,557,706,707               
 IRET                       Local  532      I(4)            4           scalar                    532,533,574,577,582               
 IRTP                       Scalar 502      I(4)            4     1     120      COM                                                
 ISUBI                      Local  545      I(4)            4           scalar                    545                               
 ISUBO                      Local  512      I(4)            4           scalar                    512,536,537,538,549,550,551,556,56
                                                                                                  4,565,708,709,711                 
 ISUBON                     Local  705      I(4)            4           scalar                    705,711                           
 ISUBOT                     Local  512      I(4)            4           scalar                    512,537,538,540,550,551,565,708,70
                                                                                                  9                                 
 JBAD_FLAG                  Scalar 500      I(4)            4     1     120      COM                                                
 JDATE                      Scalar 489      I(4)            4     1     4        COM                                                
 KDATE                      Scalar 489      I(4)            4     3     60000    COM                                                
 L                          Local  638      I(4)            4           scalar                    638,639,640,641,642,643,644,645,64
                                                                                                  6,647,648                         
 L0                         Local  668      I(4)            4           scalar                    668,669,670,673,674,676,677       
 LAST                       Local  481      CHAR            8           scalar                    512,535,538,547,548,551,559       
 LEVP                       Scalar 497      I(4)            4     3     1800000  COM                                                
 LEVZ                       Scalar 495      I(4)            4     3     1800000  COM              662,668                           
 LL                         Local  660      I(4)            4           scalar                    660,667,669,670,671,672,673,674,67
                                                                                                  5,680,681,682,683,684,685,686,687,
                                                                                                  697,698                           
 LM                         Local  677      I(4)            4           scalar                    677,678,679,681,682,685,686       
 LOOP1                      Label  677                                  scalar                    678,689                           
 LZ                         Local  661      I(4)            4           scalar                    661,662,668,671,672,674,675,683,68
                                                                                                  4,686,687                         
 M                          Local  614      I(4)            4           scalar                    614,632,662,668,671,672,674,675,68
                                                                                                  3,684,686,687                     
 MDATE                      Scalar 489      I(4)            4     1     5        COM                                                
 MLEV                       Scalar 499      I(4)            4     2     12000    COM                                                
 MM                         Local  613      I(4)            4           scalar                    613,614,615                       
 N                          Local  607      I(4)            4           scalar                    607,608,613,615,632,661,662,668,67
                                                                                                  1,672,674,675,683,684,686,687     
 NCH                        Scalar 487      I(4)            4           scalar   COM                                                
 NDATE                      Scalar 489      I(4)            4     1     5        COM                                                
 NFIN                       Scalar 488      I(4)            4           scalar   COM              519,521,522,523,524,525,532,540,54
                                                                                                  5,563,574,582,626,637,654         
 NFOUT                      Scalar 488      I(4)            4           scalar   COM              523,524,536,541,542,549,553,555,55
                                                                                                  6,563,564,569,626,627,654,698,704,
                                                                                                  705                               
 NINT                       Func   597                                  scalar                    597,598,674,686                   
 NL                         Param  478      I(4)            4           scalar                    485,493,494,495,496,497,498,499,50
                                                                                                  0                                 
 NLEV                       Scalar 487      I(4)            4           scalar   COM                                                
 NLV                        Scalar 490      I(4)            4           scalar   COM              637,638,698                       
 NN                         Local  606      I(4)            4           scalar                    606,607                           
 NREP                       Scalar 487      I(4)            4           scalar   COM                                                
 NREP1                      Scalar 487      I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 487      I(4)            4           scalar   COM              542,625,703                       
 NS                         Param  478      I(4)            4           scalar                    489,493,494,495,496,497,498,499,50
                                                                                                  0,501,502                         
 NSCAN                      Scalar 487      I(4)            4           scalar   COM                                                
 NSTN                       Scalar 487      I(4)            4           scalar   COM              606                               
 NSTN1                      Scalar 487      I(4)            4           scalar   COM                                                
 NT                         Param  478      I(4)            4           scalar                    489,493,494,495,496,497,498,499,50
                                                                                                  0,501                             

Page 19          Source Listing                  WRITBUFR
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTIMES                     Scalar 501      I(4)            4     1     120      COM              613                               
 NZZ                        Scalar 499      I(4)            4     1     120      COM              661                               
 OBS_8                      Local  484      R(8)            8     2     2550                      637,639,640,641,642,643,644,645,64
                                                                                                  6,647,648                         
 OPENBF                     Subr   521                                                            521,523                           
 OPENMB                     Subr   569                                                            569                               
 OSTR                       Local  482      CHAR            40          scalar                    509,637                           
 PARAMS                     Common 487                                  40                                                          
 POB                        Scalar 491      R(4)            4     1     255      COM              643                               
 PP                         Scalar 497      R(4)            4     3     1800000  COM                                                
 PROBS                      Common 491                                  10200                                                       
 PROFP                      Common 496                                  57600000                                                    
 PROFZ                      Common 493                                  72000000                                                    
 PZ                         Scalar 494      R(4)            4     3     1800000  COM                                                
 QM                         Scalar 498      R(4)            4     3     1800000  COM                                                
 QP                         Scalar 496      R(4)            4     3     1800000  COM                                                
 QUAL                       Common 498                                  43296960                                                    
 QZ                         Scalar 494      R(4)            4     3     1800000  COM                                                
 READMG                     Subr   532                                                            532                               
 READSB                     Subr   574                                                            574                               
 SID_8                      Scalar 484      R(8)            8           scalar   COM              583                               
 SOB                        Scalar 492      R(4)            4     1     255      COM              647                               
 STN                        Scalar 481      CHAR            8     1     120      COM              608                               
 STNLST                     Common 501                                  51360                                                       
 SUBSET                     Local  481      CHAR            8           scalar                    532,546,547,555,559,560,569       
 SZ                         Scalar 495      R(4)            4     3     1800000  COM                                                
 T29                        Scalar 490      R(4)            4           scalar   COM              590                               
 TIM                        Scalar 501      R(4)            4     2     12000    COM              615                               
 TIMEO                      Common 503                                  8                                                           
 TIMWIN_E                   Scalar 503      R(4)            4           scalar   COM              597                               
 TIMWIN_L                   Scalar 503      R(4)            4           scalar   COM              598                               
 TYP                        Scalar 490      R(4)            4           scalar   COM              589                               
 UFBCNT                     Subr   536                                                            536,545,549,556,564,705           
 UFBCPY                     Subr   626                                                            626,654                           
 UFBINT                     Subr   582                                                            582,637                           
 UFBQCD                     Subr   525                                                            525                               
 UFC                        Scalar 492      R(4)            4     1     255      COM              644                               
 UFP                        Scalar 497      R(4)            4     3     1800000  COM                                                
 UFZ                        Scalar 494      R(4)            4     3     1800000  COM                                                
 UOB                        Scalar 491      R(4)            4     1     255      COM              640,669,681                       
 UP                         Scalar 496      R(4)            4     3     1800000  COM                                                
 UVO                        Local  483      R(4)            4     2     510                       669,670,674,675,681,682,687,698   
 UZ                         Scalar 493      R(4)            4     3     1800000  COM                                                
 VFC                        Scalar 492      R(4)            4     1     255      COM              645                               
 VFP                        Scalar 497      R(4)            4     3     1800000  COM                                                
 VFZ                        Scalar 494      R(4)            4     3     1800000  COM                                                
 VOB                        Scalar 491      R(4)            4     1     255      COM              641,670,682                       
 VP                         Scalar 496      R(4)            4     3     1800000  COM                                                
 VQM                        Local  483      R(4)            4     1     255                       671,683,698                       
 VRC                        Local  483      R(4)            4     1     255                       672,684,698                       
 VZ                         Scalar 493      R(4)            4     3     1800000  COM                                                
 WQM                        Scalar 491      R(4)            4     1     255      COM              642                               
 WRITBUFR                   Subr   476                                                                                              
 WRITSB                     Subr   627                                                            627,704                           
 X                          Scalar 501      R(4)            4     1     120      COM                                                

Page 20          Source Listing                  WRITBUFR
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 XOB                        Scalar 490      R(4)            4           scalar   COM              584,599                           
 XTP                        Scalar 490      R(4)            4           scalar   COM              588                               
 Y                          Scalar 501      R(4)            4     1     120      COM                                                
 YOB                        Scalar 490      R(4)            4           scalar   COM              585,599                           
 Z0                         Scalar 501      R(4)            4     1     120      COM                                                
 ZOB                        Scalar 491      R(4)            4     1     255      COM              639,674,678,686                   
 ZP                         Scalar 496      R(4)            4     3     1800000  COM                                                
 ZZ                         Scalar 493      R(4)            4     3     1800000  COM                                                

Page 21          Source Listing                  WRITBUFR
2017-04-18 11:09                                 profcqc.f

    753 
    754 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    755 C
    756 C SUBPROGRAM:    CHECKS
    757 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
    758 C
    759 C ABSTRACT: PERFORM INCREMENT, TEMPORAL AND VERTICAL CHECKS FOR
    760 C   A SINGLE UNIQUE STATION.
    761 C
    762 C PROGRAM HISTORY LOG:
    763 C 1995-04-04  W. Collins -- Original author.
    764 C 2004-09-09  D. Keyser  -- Lvl index in all arrays now site specific
    765 C     to allow proper temporal checking at each individual site. Incr.,
    766 C     temporal, vert. & median chk error limits now directly assoc. w/
    767 C     a rpted hgt above ground lvl rather than w/ lvl index in arrays
    768 C     (ensures proper error limit used at all lvls & eliminates hgt
    769 C     above ground vs. hgt above sea lvl discrepancy - error limits
    770 C     values remain unchanged). Temporal check for CAPs attempt to get
    771 C     2-hr. spanning del-time so error limits are valid (since based on
    772 C     NPNs), else del-time must be .ge. half-hr on one side, else
    773 C     temporal check not performed.  Max. del-time on one side is 2-hrs
    774 C     for all rpts. DO-LOOP logic more concise (esp. in temporal &
    775 C     vert. chks.)
    776 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
    777 C     per station.
    778 C
    779 C USAGE:   SUBROUTINE CHECKS(IS)
    780 C   INPUT ARGUMENT LIST:
    781 C     IS       - STATION INDEX
    782 C
    783 C REMARKS: 
    784 C   VARIABLE NAMES:
    785 C     U        - U-COMPONENT OF WIND (M)
    786 C     V        - V-COMPONENT OF WIND (M)
    787 C     UI       - U-COMPONENT INCREMENT
    788 C     VI       - V-COMPONENT INCREMENT
    789 C     UT       - U-COMPONENT TEMPORAL RESIDUAL
    790 C     VT       - V-COMPONENT TEMPORAL RESIDUAL
    791 C     UV       - U-COMPONENT VERTICAL RESIDUAL
    792 C     VV       - V-COMPONENT VERTICAL RESIDUAL
    793 C     VVI      - VECTOR INCREMENT
    794 C     VVT      - VECTOR TEMPORAL RESIDUAL
    795 C     VVV      - VECTOR VERTICAL RESIDUAL
    796 C     ICQC     - DMA INDEX FOR WIND QUALITY CONTROL
    797 C
    798 C ATTRIBUTES:
    799 C   LANGUAGE: FORTRAN 90
    800 C   MACHINE:  NCEP WCOSS
    801 C
    802 C$$$
    803       SUBROUTINE CHECKS(IS)
    804 
    805       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
    806 
    807       CHARACTER*8     STN
    808       REAL(8)   BMISS
    809 

Page 22          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

    810       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),
    811      $ QZ(NL,NT,NS),PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),
    812      $ SZ(NL,NT,NS),DZ(NL,NT,NS),LEVZ(NL,NT,NS)
    813       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
    814      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
    815      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
    816      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
    817      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
    818       COMMON /QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
    819      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
    820      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
    821       COMMON/LIMITS/XI(9125),XT(15750),XV(15750)
    822       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
    823      $ NFIN,NFOUT
    824       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
    825      $ IRTP(NS)
    826       COMMON /BUFRLIB_MISSING/BMISS
    827 
    828 C     PERFORM TEMPORAL AND VERTICAL CHECKS.
    829 C     USE ONLY NON-MISSING DATA AT ADJACENT TIME OR LEVEL.
    830 C     DO NOT USE INFLUENCING DATA THAT ARE BAD.
    831 C     CHECKS ARE PERFORMED ON INCREMENTS.
    832 C     ALSO CALCULATE THE VECTOR INCREMENT, TEMPORAL RESIDUAL,
    833 C     AND VERTICAL RESIDUAL.
    834 
    835       NZZM1 = NZZ(IS) - 1
    836       NZZM2 = NZZ(IS) - 2
    837 
    838 C  CALCULATE THE VECTOR INCREMENT
    839 C  ------------------------------
    840 
    841       DO N=1,NTIMES(IS)
    842          DO L=1,NZZ(IS)
    843             IF(MAX(ABS(UI(L,N,IS)),ABS(VI(L,N,IS))).LT.BMISS) THEN
    844                VVI(L,N) = SQRT(UI(L,N,IS)**2 + VI(L,N,IS)**2)
    845             ELSE
    846                VVI(L,N) = BMISS
    847             ENDIF
    848          ENDDO
    849       ENDDO
    850 
    851       DO N=1,NTIMES(IS)
    852         LOOP1: DO L=1,NZZ(IS)
    853           IF(NINT(ZZ(L,N,IS)-Z0(IS)).LT.9126) THEN
    854              VMX =  10.0 * XI(NINT(ZZ(L,N,IS)-Z0(IS)))
    855           ELSE
    856              VMX =  10.0 * 3.80
    857           ENDIF
    858           IF(L.NE.NZZ(IS)) THEN
    859              IF(NINT(ZZ(L+1,N,IS)-Z0(IS)).LT.9126) THEN
    860                 VPMX = 10.0 * XI(NINT(ZZ(L+1,N,IS)-Z0(IS)))
    861              ELSE
    862                 VPMX = 10.0 * 3.80
    863              ENDIF
    864           ENDIF
    865           IF(L.NE.1) THEN
    866              IF(NINT(ZZ(L-1,N,IS)-Z0(IS)).LT.9126) THEN

Page 23          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

    867                 VMMX = 10.0 * XI(NINT(ZZ(L-1,N,IS)-Z0(IS)))
    868              ELSE
    869                 VMMX = 10.0 * 3.80
    870              ENDIF 
    871           ENDIF 
    872 
    873 C  PERFORM TEMPORAL CHECK
    874 C  ----------------------
    875 
    876           UT(L,N)  = BMISS
    877           VT(L,N)  = BMISS
    878           VVT(L,N) = BMISS
    879           IF(NTIMES(IS).LT.2)  GOTO 707
    880           IF(MAX(UI(L,N,IS),VI(L,N,IS)).GE.BMISS) GOTO 707
    881           ITRY  = 0
    882           ITLM1 = 100
    883           ITLM2 = 100
    884 
    885   606     CONTINUE
    886 
    887           DO NN = 1,NTIMES(IS)-1
    888             N1 = NN - 1
    889             IF(N-NN.GE.1) THEN
    890               IF(NINT(ABS(TIM(N,IS)*100-TIM(N-NN,IS)*100)).LT.ITLM1)THEN
    891                 CYCLE
    892               ELSE
    893                 N1 = NN
    894                 EXIT
    895               ENDIF
    896             ENDIF
    897             EXIT
    898           ENDDO
    899           DO NN = 1,NTIMES(IS)-1
    900             N2 = NN - 1
    901             IF(N+NN.LE.NTIMES(IS)) THEN
    902               IF(NINT(ABS(TIM(N,IS)*100-TIM(N+NN,IS)*100)).LT.ITLM2)THEN
    903                 CYCLE
    904               ELSE
    905                 N2 = NN
    906                 EXIT
    907               ENDIF
    908             ENDIF
    909             EXIT
    910           ENDDO
    911           IF(MAX(N1,N2).EQ.0)  GOTO 707
    912           IF(MIN(N1,N2).GT.0) THEN
    913             IF(MAX(ICQC(L,N-N1,IS),ICQC(L,N+N2,IS)).EQ.0) THEN
    914               IF(MAX(ABS(UI(L,N-N1,IS)),ABS(VI(L,N-N1,IS)),
    915      $               ABS(UI(L,N+N2,IS)),ABS(VI(L,N+N2,IS))).LT.VMX) THEN
    916                 DT(L,N,IS) = ABS(TIM(N-N1,IS) - TIM(N+N2,IS))
    917                 IF(DT(L,N,IS).LT.2.01) THEN
    918                   UT(L,N) =UI(L,N,IS) -0.5*(UI(L,N-N1,IS)+UI(L,N+N2,IS))
    919                   VT(L,N) =VI(L,N,IS) -0.5*(VI(L,N-N1,IS)+VI(L,N+N2,IS))
    920                   VVT(L,N) = SQRT(UT(L,N)**2 + VT(L,N)**2)
    921                 ELSE
    922                   ITRY = ITRY + 1
    923                   IF(ITRY.EQ.1) THEN

Page 24          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

    924                     ITLM1 = 075
    925                     GOTO 606
    926                   ELSE IF(ITRY.EQ.2) THEN
    927                     ITLM2 = 075
    928                     GOTO 606
    929                   ELSE IF(ITRY.EQ.3) THEN
    930                     ITLM1 = 050
    931                     GOTO 606
    932                   ELSE IF(ITRY.EQ.4) THEN
    933                     ITLM2 = 050
    934                     GOTO 606
    935                   ENDIF
    936                 ENDIF
    937               ENDIF
    938             ENDIF
    939           ELSE IF(N1.EQ.0) THEN
    940 C  Use one-sided differences at earliest time
    941             IF(ICQC(L,N+N2,IS).EQ.0) THEN
    942               IF(MAX(ABS(UI(L,N+N2,IS)),ABS(VI(L,N+N2,IS))).LT.VMX) THEN
    943                 DT(L,N,IS) = ABS(TIM(N,IS) - TIM(N+N2,IS))
    944                 IF(DT(L,N,IS).LT.1.01) THEN
    945                   UT(L,N) = UI(L,N,IS) - UI(L,N+N2,IS)
    946                   VT(L,N) = VI(L,N,IS) - VI(L,N+N2,IS)
    947                   VVT(L,N) = SQRT(UT(L,N)**2 + VT(L,N)**2)
    948                 ELSE
    949                   ITRY = ITRY + 1
    950                   IF(ITRY.EQ.1) THEN
    951                     ITLM2 = 075
    952                     GOTO 606
    953                   ELSE IF(ITRY.EQ.2) THEN
    954                     ITLM2 = 050
    955                     GOTO 606
    956                   ENDIF
    957                 ENDIF
    958               ENDIF
    959             ENDIF
    960           ELSE IF(N2.EQ.0) THEN
    961 C  Use one-sided differences at latest time
    962             IF(ICQC(L,N-N1,IS).EQ.0) THEN
    963               IF(MAX(ABS(UI(L,N-N1,IS)),ABS(VI(L,N-N1,IS))).LT.VMX) THEN
    964                 DT(L,N,IS) = ABS(TIM(N,IS) - TIM(N-N1,IS))
    965                 IF(DT(L,N,IS).LT.1.01) THEN
    966                   UT(L,N) = UI(L,N,IS) - UI(L,N-N1,IS)
    967                   VT(L,N) = VI(L,N,IS) - VI(L,N-N1,IS)
    968                   VVT(L,N) = SQRT(UT(L,N)**2 + VT(L,N)**2)
    969                 ELSE
    970                   ITRY = ITRY + 1
    971                   IF(ITRY.EQ.1) THEN
    972                     ITLM1 = 075
    973                     GOTO 606
    974                   ELSE IF(ITRY.EQ.2) THEN
    975                     ITLM1 = 050
    976                     GOTO 606
    977                   ENDIF
    978                 ENDIF
    979               ENDIF
    980             ENDIF

Page 25          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

    981           ENDIF
    982 
    983   707     CONTINUE
    984 
    985 C  PERFORM VERTICAL CHECK
    986 C  ----------------------
    987 
    988           UV(L,N)  = BMISS
    989           VV(L,N)  = BMISS
    990           VVV(L,N) = BMISS
    991           IF(L.EQ.1) THEN
    992 C  Use one-sided differences at bottom, allow up to one missing or bad
    993 C   intervening level
    994             IF(MAX(ABS(UI(1,N,IS)),ABS(VI(1,N,IS))).LT.BMISS) THEN
    995               DO J = 2,3
    996                 IF(ICQC(J,N,IS).EQ.0) THEN
    997                   IF(MAX(ABS(UI(J,N,IS)),ABS(VI(J,N,IS))).LT.VPMX) THEN
    998                     UV(1,N) = UI(1,N,IS) - UI(J,N,IS)
    999                     VV(1,N) = VI(1,N,IS) - VI(J,N,IS)
   1000                     VVV(1,N) = SQRT(UV(1,N)**2 + VV(1,N)**2)
   1001                     CYCLE LOOP1
   1002                   ENDIF
   1003                 ENDIF
   1004               ENDDO
   1005             ENDIF
   1006           ELSE IF(L.EQ.NZZ(IS)) THEN
   1007 C  Use one-sided differences at top, allow up to one missing or bad
   1008 C   intervening level
   1009             IF(MAX(ABS(UI(NZZ(IS),N,IS)),ABS(VI(NZZ(IS),N,IS)))
   1010      $       .LT.BMISS) THEN
   1011               DO J = NZZM1,NZZM2,-1
   1012                 IF(ICQC(J,N,IS).EQ.0) THEN
   1013                   IF(MAX(ABS(UI(J,N,IS)),ABS(VI(J,N,IS))).LT.VMMX) THEN
   1014                     UV(NZZ(IS),N)  = UI(NZZ(IS),N,IS) - UI(J,N,IS)
   1015                     VV(NZZ(IS),N)  = VI(NZZ(IS),N,IS) - VI(J,N,IS)
   1016                     VVV(NZZ(IS),N) =
   1017      $               SQRT(UV(NZZ(IS),N)**2 + VV(NZZ(IS),N)**2)
   1018                     CYCLE LOOP1
   1019                   ENDIF
   1020                 ENDIF
   1021               ENDDO
   1022             ENDIF
   1023           ELSE IF(L.GT.2 .AND. L.LT.NZZM2) THEN
   1024 C  Attempt two-sided differences when two levels or more away from top
   1025 C   and two levels or more away from bottom, allow up to one missing or
   1026 C   bad intervening level on either side (but NOT on BOTH sides)
   1027             IF(MAX(ABS(UI(L,N,IS)),ABS(VI(L,N,IS))).LT.BMISS) THEN
   1028               DO K = 1,2
   1029                 DO J = 1,2
   1030                   IF(MIN(J,K).EQ.2) GOTO 300
   1031                   IF(MAX(ICQC(L+J,N,IS),ICQC(L-K,N,IS)).EQ.0) THEN
   1032                     IF(MAX(ABS(UI(L+J,N,IS)),ABS(VI(L+J,N,IS))).LT.VPMX
   1033      $           .AND. MAX(ABS(UI(L-K,N,IS)),ABS(VI(L-K,N,IS))).LT.VMMX)
   1034      $               THEN
   1035                       UV(L,N)=UI(L,N,IS)-0.5*(UI(L+J,N,IS)+UI(L-K,N,IS))
   1036                       VV(L,N)=VI(L,N,IS)-0.5*(VI(L+J,N,IS)+VI(L-K,N,IS))
   1037                       VVV(L,N) = SQRT(UV(L,N)**2 + VV(L,N)**2)

Page 26          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

   1038                       CYCLE LOOP1
   1039                     ENDIF
   1040                   ENDIF
   1041                 ENDDO
   1042               ENDDO
   1043 
   1044   300         CONTINUE
   1045 
   1046 C  Use one-sided differences if two or more missing or bad intervening
   1047 C   levels on one side and a non-missing and non-bad neighboring level
   1048 C   on the other side (but do NOT allow for any missing or bad
   1049 C   intervening levels on the differencing side)
   1050               DO J = 1,-1,-2
   1051                 IF(ICQC(L+J,N,IS).EQ.0) THEN
   1052                   IF(MAX(ABS(UI(L+J,N,IS)),ABS(VI(L+J,N,IS))).LT.VPMX)
   1053      $             THEN
   1054                     UV(L,N) = UI(L,N,IS) - UI(L+J,N,IS)
   1055                     VV(L,N) = VI(L,N,IS) - VI(L+J,N,IS)
   1056                     VVV(L,N) = SQRT(UV(L,N)**2 + VV(L,N)**2)
   1057                     CYCLE LOOP1
   1058                   ENDIF
   1059                 ENDIF
   1060               ENDDO
   1061             ENDIF
   1062           ELSE
   1063 C  Attempt two-sided differences when either one level away from top or
   1064 C   on level away from bottom, do NOT allow any missing or bad
   1065 C   intervening levels on EITHER side (even though one may be such on
   1066 C   one side)
   1067             IF(MAX(ABS(UI(L,N,IS)),ABS(VI(L,N,IS))).LT.BMISS) THEN
   1068               IF(MAX(ICQC(L+1,N,IS),ICQC(L-1,N,IS)).EQ.0) THEN
   1069                 IF(MAX(ABS(UI(L+1,N,IS)),ABS(VI(L+1,N,IS))).LT.VPMX.AND.
   1070      $             MAX(ABS(UI(L-1,N,IS)),ABS(VI(L-1,N,IS))).LT.VMMX)THEN
   1071                   UV(L,N) =UI(L,N,IS) -0.5 *(UI(L+1,N,IS) +UI(L-1,N,IS))
   1072                   VV(L,N) =VI(L,N,IS) -0.5 *(VI(L+1,N,IS) +VI(L-1,N,IS))
   1073                   VVV(L,N) = SQRT(UV(L,N)**2 + VV(L,N)**2)
   1074                   CYCLE LOOP1
   1075                 ENDIF
   1076               ENDIF
   1077 C  Use one-sided differences if a missing or bad neighboring level on
   1078 C   one side and a non-missing and non-bad neighboring level on the
   1079 C   other side (but do NOT allow for any missing or bad intervening
   1080 C   levels on the differencing side)
   1081               DO J = 1,-1,-2
   1082                 IF(ICQC(L+J,N,IS).EQ.0) THEN
   1083                   IF(MAX(ABS(UI(L+J,N,IS)),ABS(VI(L+J,N,IS))).LT.VPMX)
   1084      $             THEN
   1085                     UV(L,N) = UI(L,N,IS) - UI(L+J,N,IS)
   1086                     VV(L,N) = VI(L,N,IS) - VI(L+J,N,IS)
   1087                     VVV(L,N) = SQRT(UV(L,N)**2 + VV(L,N)**2)
   1088                     CYCLE LOOP1
   1089                   ENDIF
   1090                 ENDIF
   1091               ENDDO
   1092             ENDIF
   1093           ENDIF
   1094         ENDDO  LOOP1

Page 27          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

   1095       ENDDO
   1096 
   1097       RETURN
   1098 
   1099       END


ENTRY POINTS

  Name               
                     
 checks_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 300                        Label  1044                                                           1030                              
 606                        Label  885                                                            925,928,931,934,952,955,973,976   
 707                        Label  983                                                            879,880,911                       
 ABS                        Func   843                                  scalar                    843,890,902,914,915,916,942,943,96
                                                                                                  3,964,994,997,1009,1013,1027,1032,
                                                                                                  1033,1052,1067,1069,1070,1083     
 BMISS                      Scalar 808      R(8)            8           scalar   COM              843,846,876,877,878,880,988,989,99
                                                                                                  0,994,1010,1027,1067              
 BUFRLIB_MISSING            Common 826                                  8                                                           
 CHECKS                     Subr   803                                                                                              
 DIM                        Scalar 817      R(4)            4     2     15000    COM                                                
 DIT                        Scalar 816      R(4)            4     2     15000    COM                                                
 DIV                        Scalar 816      R(4)            4     2     15000    COM                                                
 DT                         Scalar 819      R(4)            4     3     1800000  COM              916,917,943,944,964,965           
 DTM                        Scalar 817      R(4)            4     2     15000    COM                                                
 DTV                        Scalar 817      R(4)            4     2     15000    COM                                                
 DVM                        Scalar 817      R(4)            4     2     15000    COM                                                
 DZ                         Scalar 812      R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 819      I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 818      I(4)            4     3     1800000  COM              913,941,962,996,1012,1031,1051,106
                                                                                                  8,1082                            
 IQ                         Scalar 818      I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 819      I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 820      I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 825      I(4)            4     1     120      COM                                                
 IS                         Dummy  803      I(4)            4           scalar   ARG,INOUT        835,836,841,842,843,844,851,852,85
                                                                                                  3,854,858,859,860,866,867,879,880,
                                                                                                  887,890,899,901,902,913,914,915,91
                                                                                                  6,917,918,919,941,942,943,944,945,
                                                                                                  946,962,963,964,965,966,967,994,99
                                                                                                  6,997,998,999,1006,1009,1012,1013,
                                                                                                  1014,1015,1016,1017,1027,1031,1032
                                                                                                  ,1033,1035,1036,1051,1052,1054,105
                                                                                                  5,1067,1068,1069,1070,1071,1072,10
                                                                                                  82,1083,1085,1086                 
 ITLM1                      Local  882      I(4)            4           scalar                    882,890,924,930,972,975           
 ITLM2                      Local  883      I(4)            4           scalar                    883,902,927,933,951,954           
 ITRY                       Local  881      I(4)            4           scalar                    881,922,923,926,929,932,949,950,95
                                                                                                  3,970,971,974                     

Page 28          Source Listing                  CHECKS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 J                          Local  995      I(4)            4           scalar                    995,996,997,998,999,1011,1012,1013
                                                                                                  ,1014,1015,1029,1030,1031,1032,103
                                                                                                  5,1036,1050,1051,1052,1054,1055,10
                                                                                                  81,1082,1083,1085,1086            
 JBAD_FLAG                  Scalar 820      I(4)            4     1     120      COM                                                
 K                          Local  1028     I(4)            4           scalar                    1028,1030,1031,1033,1035,1036     
 L                          Local  842      I(4)            4           scalar                    842,843,844,846,852,853,854,858,85
                                                                                                  9,860,865,866,867,876,877,878,880,
                                                                                                  913,914,915,916,917,918,919,920,94
                                                                                                  1,942,943,944,945,946,947,962,963,
                                                                                                  964,965,966,967,968,988,989,990,99
                                                                                                  1,1006,1023,1027,1031,1032,1033,10
                                                                                                  35,1036,1037,1051,1052,1054,1055,1
                                                                                                  056,1067,1068,1069,1070,1071,1072,
                                                                                                  1073,1082,1083,1085,1086,1087     
 LEVZ                       Scalar 812      I(4)            4     3     1800000  COM                                                
 LIMITS                     Common 821                                  162500                                                      
 LOOP1                      Label  852                                  scalar                    1001,1018,1038,1057,1074,1088,1094
 MAX                        Func   843                                  scalar                    843,880,911,913,914,942,963,994,99
                                                                                                  7,1009,1013,1027,1031,1032,1033,10
                                                                                                  52,1067,1068,1069,1070,1083       
 MIN                        Func   912                                  scalar                    912,1030                          
 MLEV                       Scalar 819      I(4)            4     2     12000    COM                                                
 N                          Local  841      I(4)            4           scalar                    841,843,844,846,851,853,854,859,86
                                                                                                  0,866,867,876,877,878,880,889,890,
                                                                                                  901,902,913,914,915,916,917,918,91
                                                                                                  9,920,941,942,943,944,945,946,947,
                                                                                                  962,963,964,965,966,967,968,988,98
                                                                                                  9,990,994,996,997,998,999,1000,100
                                                                                                  9,1012,1013,1014,1015,1016,1017,10
                                                                                                  27,1031,1032,1033,1035,1036,1037,1
                                                                                                  051,1052,1054,1055,1056,1067,1068,
                                                                                                  1069,1070,1071,1072,1073,1082,1083
                                                                                                  ,1085,1086,1087                   
 N1                         Local  888      I(4)            4           scalar                    888,893,911,912,913,914,916,918,91
                                                                                                  9,939,962,963,964,966,967         
 N2                         Local  900      I(4)            4           scalar                    900,905,911,912,913,915,916,918,91
                                                                                                  9,941,942,943,945,946,960         
 NCH                        Scalar 822      I(4)            4           scalar   COM                                                
 NFIN                       Scalar 823      I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 823      I(4)            4           scalar   COM                                                
 NI                         Scalar 815      I(4)            4     2     15000    COM                                                
 NINT                       Func   853                                  scalar                    853,854,859,860,866,867,890,902   
 NL                         Param  805      I(4)            4           scalar                    810,811,812,813,814,815,816,817,81
                                                                                                  8,819,820                         
 NLEV                       Scalar 822      I(4)            4           scalar   COM                                                
 NM                         Scalar 815      I(4)            4     2     15000    COM                                                
 NN                         Local  887      I(4)            4           scalar                    887,888,889,890,893,899,900,901,90
                                                                                                  2,905                             
 NREP                       Scalar 822      I(4)            4           scalar   COM                                                
 NREP1                      Scalar 822      I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 822      I(4)            4           scalar   COM                                                
 NS                         Param  805      I(4)            4           scalar                    810,811,812,813,818,819,820,824,82
                                                                                                  5                                 
 NSCAN                      Scalar 822      I(4)            4           scalar   COM                                                

Page 29          Source Listing                  CHECKS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NSTN                       Scalar 822      I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 822      I(4)            4           scalar   COM                                                
 NT                         Param  805      I(4)            4           scalar                    810,811,812,813,814,815,816,817,81
                                                                                                  8,819,820,824                     
 NTIMES                     Scalar 824      I(4)            4     1     120      COM              841,851,879,887,899,901           
 NTMP                       Scalar 815      I(4)            4     2     15000    COM                                                
 NV                         Scalar 815      I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 819      I(4)            4     1     120      COM              835,836,842,852,858,1006,1009,1014
                                                                                                  ,1015,1016,1017                   
 NZZM1                      Local  835      I(4)            4           scalar                    835,1011                          
 NZZM2                      Local  836      I(4)            4           scalar                    836,1011,1023                     
 PARAMS                     Common 822                                  40                                                          
 PROFZ                      Common 810                                  72000000                                                    
 PZ                         Scalar 811      R(4)            4     3     1800000  COM                                                
 QM                         Scalar 818      R(4)            4     3     1800000  COM                                                
 QUAL                       Common 818                                  43296960                                                    
 QZ                         Scalar 811      R(4)            4     3     1800000  COM                                                
 RESIDS                     Common 813                                  15840000                                                    
 SQRT                       Func   844                                  scalar                    844,920,947,968,1000,1017,1037,105
                                                                                                  6,1073,1087                       
 STN                        Scalar 807      CHAR            8     1     120      COM                                                
 STNLST                     Common 824                                  51360                                                       
 SZ                         Scalar 812      R(4)            4     3     1800000  COM                                                
 TIM                        Scalar 824      R(4)            4     2     12000    COM              890,902,916,943,964               
 UFZ                        Scalar 811      R(4)            4     3     1800000  COM                                                
 UI                         Scalar 813      R(4)            4     3     1800000  COM              843,844,880,914,915,918,942,945,96
                                                                                                  3,966,994,997,998,1009,1013,1014,1
                                                                                                  027,1032,1033,1035,1052,1054,1067,
                                                                                                  1069,1070,1071,1083,1085          
 UM                         Scalar 814      R(4)            4     2     15000    COM                                                
 UT                         Scalar 813      R(4)            4     2     15000    COM              876,918,920,945,947,966,968       
 UV                         Scalar 814      R(4)            4     2     15000    COM              988,998,1000,1014,1017,1035,1037,1
                                                                                                  054,1056,1071,1073,1085,1087      
 UZ                         Scalar 810      R(4)            4     3     1800000  COM                                                
 VFZ                        Scalar 811      R(4)            4     3     1800000  COM                                                
 VI                         Scalar 813      R(4)            4     3     1800000  COM              843,844,880,914,915,919,942,946,96
                                                                                                  3,967,994,997,999,1009,1013,1015,1
                                                                                                  027,1032,1033,1036,1052,1055,1067,
                                                                                                  1069,1070,1072,1083,1086          
 VM                         Scalar 815      R(4)            4     2     15000    COM                                                
 VMMX                       Local  867      R(4)            4           scalar                    867,869,1013,1033,1070            
 VMX                        Local  854      R(4)            4           scalar                    854,856,915,942,963               
 VPMX                       Local  860      R(4)            4           scalar                    860,862,997,1032,1052,1069,1083   
 VT                         Scalar 813      R(4)            4     2     15000    COM              877,919,920,946,947,967,968       
 VV                         Scalar 814      R(4)            4     2     15000    COM              989,999,1000,1015,1017,1036,1037,1
                                                                                                  055,1056,1072,1073,1086,1087      
 VVI                        Scalar 814      R(4)            4     2     15000    COM              844,846                           
 VVM                        Scalar 815      R(4)            4     2     15000    COM                                                
 VVT                        Scalar 814      R(4)            4     2     15000    COM              878,920,947,968                   
 VVV                        Scalar 814      R(4)            4     2     15000    COM              990,1000,1016,1037,1056,1073,1087 
 VZ                         Scalar 810      R(4)            4     3     1800000  COM                                                
 X                          Scalar 824      R(4)            4     1     120      COM                                                
 XI                         Scalar 821      R(4)            4     1     9125     COM              854,860,867                       
 XT                         Scalar 821      R(4)            4     1     15750    COM                                                
 XV                         Scalar 821      R(4)            4     1     15750    COM                                                

Page 30          Source Listing                  CHECKS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 Y                          Scalar 824      R(4)            4     1     120      COM                                                
 Z0                         Scalar 824      R(4)            4     1     120      COM              853,854,859,860,866,867           
 ZI                         Scalar 816      R(4)            4     2     15000    COM                                                
 ZM                         Scalar 816      R(4)            4     2     15000    COM                                                
 ZT                         Scalar 816      R(4)            4     2     15000    COM                                                
 ZV                         Scalar 816      R(4)            4     2     15000    COM                                                
 ZZ                         Scalar 810      R(4)            4     3     1800000  COM              853,854,859,860,866,867           

Page 31          Source Listing                  CHECKS
2017-04-18 11:09                                 profcqc.f

   1100 
   1101 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1102 C
   1103 C SUBPROGRAM:    CSTATS
   1104 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   1105 C
   1106 C ABSTRACT: CALCULATE MOMENTS FOR RESIDUALS FOR A SINGLE STATION.
   1107 C
   1108 C PROGRAM HISTORY LOG:
   1109 C 1995-04-04  W. Collins -- Original author.
   1110 C 2004-09-09  D. Keyser  -- Stats generated separately for NPN, CAP &
   1111 C     JMA rpts and stratified according to hgt above ground.
   1112 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   1113 C     per station.
   1114 C
   1115 C USAGE:   SUBROUTINE CSTATS(IS)
   1116 C
   1117 C   INPUT ARGUMENT LIST:
   1118 C     IS       - STATION INDEX
   1119 C
   1120 C   OUTPUT FILES:
   1121 C     UNIT 61  - PRINTOUT OF SELECTED STATISTICS OF RESULTS ON EACH 
   1122 C                LEVEL (BY REPORT TYPE, REPORT TIME AND FIELD)
   1123 C
   1124 C REMARKS: 
   1125 C   VARIABLE NAMES:
   1126 C     UT       - U-COMPONENT TEMPORAL RESIDUAL
   1127 C     VT       - V-COMPONENT TEMPORAL RESIDUAL
   1128 C     UV       - U-COMPONENT VERTICAL RESIDUAL
   1129 C     VV       - V-COMPONENT VERTICAL RESIDUAL
   1130 C     UM       - U-COMPONENT MEDIAN RESIDUAL
   1131 C     VM       - V-COMPONENT MEDIAN RESIDUAL
   1132 C     VVI      - VECTOR INCREMENT
   1133 C     VVT      - VECTOR TEMPORAL RESIDUAL
   1134 C     VVV      - VECTOR VERTICAL RESIDUAL
   1135 C     VVM      - VECTOR MEDIAN RESIDUAL
   1136 C
   1137 C   OUTPUT ARGUMENT LIST:
   1138 C     ALL PARAMETERS HAVE AN 'S' ADDED TO BASIC INPUT VARIABLE.
   1139 C     THE MEANING IS DESCRIBED IN THE COMMENTS BELOW.
   1140 C     UZS...VVMS
   1141 C
   1142 C ATTRIBUTES:
   1143 C   LANGUAGE: FORTRAN 90
   1144 C   MACHINE:  NCEP WCOSS
   1145 C
   1146 C$$$
   1147       SUBROUTINE CSTATS(IS)
   1148 
   1149       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   1150 
   1151       CHARACTER*8  STN
   1152       REAL(8)   BMISS
   1153 
   1154       COMMON/DATEZ/JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
   1155       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),
   1156      $ QZ(NL,NT,NS),PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),

Page 32          Source Listing                  CSTATS
2017-04-18 11:09                                 profcqc.f

   1157      $ SZ(NL,NT,NS), DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   1158       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   1159      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   1160      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   1161      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   1162      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   1163       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   1164      $ NFIN,NFOUT
   1165       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   1166      $ IRTP(NS)
   1167       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   1168      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   1169      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   1170       COMMON/STATZ/UZS(120,0:24,9,3:8),VZS(120,0:24,9,3:8),
   1171      $ UIS(120,0:24,9,3:8),VIS(120,0:24,9,3:8),UTS(120,0:24,9,3:8),
   1172      $ VTS(120,0:24,9,3:8),UVS(120,0:24,9,3:8),VVS(120,0:24,9,3:8),
   1173      $ VVIS(120,0:24,9,3:8),VVTS(120,0:24,9,3:8),VVVS(120,0:24,9,3:8),
   1174      $ VVMS(120,0:24,9,3:8),UMS(120,0:24,9,3:8),VMS(120,0:24,9,3:8)
   1175       COMMON/PST/IOFFSET(3:8),LVLINCR(3:8),ILEVELS(3:8),STATS,MEAN,
   1176      $ STDDEV,SKEW,KURT
   1177       COMMON/TIMEO/TIMWIN_E,TIMWIN_L
   1178       COMMON /BUFRLIB_MISSING/BMISS
   1179 
   1180 C  HEIGHT INDEX
   1181 C  ------------
   1182 C
   1183 C NOAA PROFILER NETWORK:
   1184 C  250 m increments starting at 376 m and ending at 16365 m (64 levels)
   1185 C  (height above ground)
   1186 C
   1187 C COOPERATIVE AGENCY PROFILERS (INCLUDING BOUNDARY LAYER):
   1188 C  50 m increments starting at 26 m and ending at 6025 m (120 levels)
   1189 C  (height above ground)
   1190 C
   1191 C JAPANESE METEOROLOGICAL AGENCY PROFILERS:
   1192 C  300 m increments starting at 251 m and ending at 9250 m (30 levels)
   1193 C  (height above ground)
   1194 C
   1195 C PROFILERS DECODED FROM PILOT (PIBAL) FORMAT BULLETINS:
   1196 C  Currently no statistics are produced
   1197 
   1198 C     COLLECT STATISTICS:
   1199 C       EXAMPLE-- UZS(LEVEL,HOUR,STATISTIC)
   1200 C       LEVEL     - 1 TO NZZ(IS)
   1201 C       HOUR      - 1 TO NTIMES(IS), WHERE NTIMES(IS) IS FOR ALL HOURS
   1202 C                                    FOR STATION "IS"
   1203 C       STATISTIC - 1: COUNT
   1204 C                   2: SUM
   1205 C                   3: SUM OF SQUARED VALUE
   1206 C                   4: SUM OF CUBED VALUE
   1207 C                   5: SUM OF VALUE TO 4TH POWER
   1208 C                   6: MEAN
   1209 C                   7: STANDARD DEVIATION
   1210 C                   8: SKEWNESS
   1211 C                   9: KURTOSIS
   1212 C     NOTE! STATISTICS 6-9 ARE NOT CALCULATED UNTIL ALL
   1213 C           VALUES OF STATISTICS 1-5 ARE COLLECTED FOR ALL STATIONS.

Page 33          Source Listing                  CSTATS
2017-04-18 11:09                                 profcqc.f

   1214 C           THAT CALCULATION IS PERFORMED IN PSTAT.
   1215 
   1216 C What type of station is this? (=3-NPN, =7-CAP, =8=JMA)
   1217       ITYPE = MOD(IRTP(IS),10)
   1218       IF(ITYPE.LT.3.OR.ITYPE.GT.8)  THEN
   1219         write(61,*)
   1220         write(61,'("Stn. ",A," does not have a valid report type (typ=",
   1221      $   I0,") -- it will not be included in statistical database")')
   1222      $  STN(IS),irtp(is)
   1223         write(61,*)
   1224         RETURN
   1225       ENDIF
   1226 
   1227       LOOP1: DO NN=1,NTIMES(IS)
   1228         IF(KDATE(5,NN,IS).NE.0) THEN
   1229           write(61,*)
   1230           write(61,'("Stn. ",A," at d-time ",F5.2,"is not reporting on",
   1231      $     " the hour -- this time will not be included in statistical",
   1232      $     "database")') STN(IS),TIM(NN,IS)
   1233           write(61,*)
   1234           CYCLE LOOP1
   1235         ENDIF
   1236         N = KDATE(4,NN,IS)
   1237         IF(N.LT.0.OR.N.GT.23) THEN
   1238           write(61,*)
   1239           write(61,'("Stn. ",A," at d-time ",F5.2,"is reporting an ",
   1240      $    "invalid hour -- this time will not be included in ",
   1241      $    "statistical database")') STN(IS),TIM(NN,IS)
   1242           write(61,*)
   1243           CYCLE LOOP1
   1244         ENDIF
   1245         IF(NINT(TIM(NN,IS)*1000.).LT.NINT(TIMWIN_E*1000.).OR.
   1246      $     NINT(TIM(NN,IS)*1000.).GT.NINT(TIMWIN_L*1000.)) CYCLE LOOP1
   1247         LOOP1n1: DO LL=1,NZZ(IS)
   1248           L = NINT((ZZ(LL,NN,IS)-Z0(IS)-IOFFSET(ITYPE)-0.5)/
   1249      $     LVLINCR(ITYPE))
   1250           IF(L.LT.0.OR.L.GT.ILEVELS(ITYPE)) THEN
   1251             write(61,*)
   1252             write(61,'("Stn. ",A," at time ",I0,"Z is reporting a ",
   1253      $       "height above ground outside expected range (hght=",I0,
   1254      $       ") -- this level will not be included in statistical ",
   1255      $       "database")') STN(IS),N,NINT(ZZ(LL,NN,IS)-Z0(IS))
   1256             write(61,*)
   1257             CYCLE LOOP1n1
   1258           ENDIF
   1259           IF(IQ(LL,NN,IS).GT.3.OR.ICQC(LL,NN,IS).GT.1) CYCLE LOOP1n1
   1260           IF(MAX(ABS(UZ(LL,NN,IS)),ABS(VZ(LL,NN,IS))).LT.BMISS) THEN
   1261             UZS(L,N,1,ITYPE)  = UZS(L,N,1,ITYPE)  + 1
   1262             UZS(L,N,2,ITYPE)  = UZS(L,N,2,ITYPE)  + UZ(LL,NN,IS)
   1263             UZS(L,N,3,ITYPE)  = UZS(L,N,3,ITYPE)  + UZ(LL,NN,IS)**2
   1264             UZS(L,N,4,ITYPE)  = UZS(L,N,4,ITYPE)  + UZ(LL,NN,IS)**3
   1265             UZS(L,N,5,ITYPE)  = UZS(L,N,5,ITYPE)  + UZ(LL,NN,IS)**4
   1266             VZS(L,N,1,ITYPE)  = VZS(L,N,1,ITYPE)  + 1
   1267             VZS(L,N,2,ITYPE)  = VZS(L,N,2,ITYPE)  + VZ(LL,NN,IS)
   1268             VZS(L,N,3,ITYPE)  = VZS(L,N,3,ITYPE)  + VZ(LL,NN,IS)**2
   1269             VZS(L,N,4,ITYPE)  = VZS(L,N,4,ITYPE)  + VZ(LL,NN,IS)**3
   1270             VZS(L,N,5,ITYPE)  = VZS(L,N,5,ITYPE)  + VZ(LL,NN,IS)**4

Page 34          Source Listing                  CSTATS
2017-04-18 11:09                                 profcqc.f

   1271             UZS(L,24,1,ITYPE) = UZS(L,24,1,ITYPE) + 1
   1272             UZS(L,24,2,ITYPE) = UZS(L,24,2,ITYPE) + UZ(LL,NN,IS)
   1273             UZS(L,24,3,ITYPE) = UZS(L,24,3,ITYPE) + UZ(LL,NN,IS)**2
   1274             UZS(L,24,4,ITYPE) = UZS(L,24,4,ITYPE) + UZ(LL,NN,IS)**3
   1275             UZS(L,24,5,ITYPE) = UZS(L,24,5,ITYPE) + UZ(LL,NN,IS)**4
   1276             VZS(L,24,1,ITYPE) = VZS(L,24,1,ITYPE) + 1
   1277             VZS(L,24,2,ITYPE) = VZS(L,24,2,ITYPE) + VZ(LL,NN,IS)
   1278             VZS(L,24,3,ITYPE) = VZS(L,24,3,ITYPE) + VZ(LL,NN,IS)**2
   1279             VZS(L,24,4,ITYPE) = VZS(L,24,4,ITYPE) + VZ(LL,NN,IS)**3
   1280             VZS(L,24,5,ITYPE) = VZS(L,24,5,ITYPE) + VZ(LL,NN,IS)**4
   1281           ENDIF
   1282           IF(MAX(ABS(UI(LL,NN,IS)),ABS(VI(LL,NN,IS))).LT.BMISS) THEN
   1283             UIS(L,N,1,ITYPE)  = UIS(L,N,1,ITYPE)  + 1
   1284             UIS(L,N,2,ITYPE)  = UIS(L,N,2,ITYPE)  + UI(LL,NN,IS)
   1285             UIS(L,N,3,ITYPE)  = UIS(L,N,3,ITYPE)  + UI(LL,NN,IS)**2
   1286             UIS(L,N,4,ITYPE)  = UIS(L,N,4,ITYPE)  + UI(LL,NN,IS)**3
   1287             UIS(L,N,5,ITYPE)  = UIS(L,N,5,ITYPE)  + UI(LL,NN,IS)**4
   1288             VIS(L,N,1,ITYPE)  = VIS(L,N,1,ITYPE)  + 1
   1289             VIS(L,N,2,ITYPE)  = VIS(L,N,2,ITYPE)  + VI(LL,NN,IS)
   1290             VIS(L,N,3,ITYPE)  = VIS(L,N,3,ITYPE)  + VI(LL,NN,IS)**2
   1291             VIS(L,N,4,ITYPE)  = VIS(L,N,4,ITYPE)  + VI(LL,NN,IS)**3
   1292             VIS(L,N,5,ITYPE)  = VIS(L,N,5,ITYPE)  + VI(LL,NN,IS)**4
   1293             UIS(L,24,1,ITYPE) = UIS(L,24,1,ITYPE) + 1
   1294             UIS(L,24,2,ITYPE) = UIS(L,24,2,ITYPE) + UI(LL,NN,IS)
   1295             UIS(L,24,3,ITYPE) = UIS(L,24,3,ITYPE) + UI(LL,NN,IS)**2
   1296             UIS(L,24,4,ITYPE) = UIS(L,24,4,ITYPE) + UI(LL,NN,IS)**3
   1297             UIS(L,24,5,ITYPE) = UIS(L,24,5,ITYPE) + UI(LL,NN,IS)**4
   1298             VIS(L,24,1,ITYPE) = VIS(L,24,1,ITYPE) + 1
   1299             VIS(L,24,2,ITYPE) = VIS(L,24,2,ITYPE) + VI(LL,NN,IS)
   1300             VIS(L,24,3,ITYPE) = VIS(L,24,3,ITYPE) + VI(LL,NN,IS)**2
   1301             VIS(L,24,4,ITYPE) = VIS(L,24,4,ITYPE) + VI(LL,NN,IS)**3
   1302             VIS(L,24,5,ITYPE) = VIS(L,24,5,ITYPE) + VI(LL,NN,IS)**4
   1303           ENDIF
   1304           IF(MAX(ABS(UT(LL,NN)),ABS(VT(LL,NN))).LT.BMISS) THEN
   1305             UTS(L,N,1,ITYPE)  = UTS(L,N,1,ITYPE)  + 1
   1306             UTS(L,N,2,ITYPE)  = UTS(L,N,2,ITYPE)  + UT(LL,NN)
   1307             UTS(L,N,3,ITYPE)  = UTS(L,N,3,ITYPE)  + UT(LL,NN)**2
   1308             UTS(L,N,4,ITYPE)  = UTS(L,N,4,ITYPE)  + UT(LL,NN)**3
   1309             UTS(L,N,5,ITYPE)  = UTS(L,N,5,ITYPE)  + UT(LL,NN)**4
   1310             VTS(L,N,1,ITYPE)  = VTS(L,N,1,ITYPE)  + 1
   1311             VTS(L,N,2,ITYPE)  = VTS(L,N,2,ITYPE)  + VT(LL,NN)
   1312             VTS(L,N,3,ITYPE)  = VTS(L,N,3,ITYPE)  + VT(LL,NN)**2
   1313             VTS(L,N,4,ITYPE)  = VTS(L,N,4,ITYPE)  + VT(LL,NN)**3
   1314             VTS(L,N,5,ITYPE)  = VTS(L,N,5,ITYPE)  + VT(LL,NN)**4
   1315             UTS(L,24,1,ITYPE) = UTS(L,24,1,ITYPE) + 1
   1316             UTS(L,24,2,ITYPE) = UTS(L,24,2,ITYPE) + UT(LL,NN)
   1317             UTS(L,24,3,ITYPE) = UTS(L,24,3,ITYPE) + UT(LL,NN)**2
   1318             UTS(L,24,4,ITYPE) = UTS(L,24,4,ITYPE) + UT(LL,NN)**3
   1319             UTS(L,24,5,ITYPE) = UTS(L,24,5,ITYPE) + UT(LL,NN)**4
   1320             VTS(L,24,1,ITYPE) = VTS(L,24,1,ITYPE) + 1
   1321             VTS(L,24,2,ITYPE) = VTS(L,24,2,ITYPE) + VT(LL,NN)
   1322             VTS(L,24,3,ITYPE) = VTS(L,24,3,ITYPE) + VT(LL,NN)**2
   1323             VTS(L,24,4,ITYPE) = VTS(L,24,4,ITYPE) + VT(LL,NN)**3
   1324             VTS(L,24,5,ITYPE) = VTS(L,24,5,ITYPE) + VT(LL,NN)**4
   1325           ENDIF
   1326           IF(MAX(ABS(UV(LL,NN)),ABS(VV(LL,NN))).LT.BMISS) THEN
   1327             UVS(L,N,1,ITYPE)  = UVS(L,N,1,ITYPE)  + 1

Page 35          Source Listing                  CSTATS
2017-04-18 11:09                                 profcqc.f

   1328             UVS(L,N,2,ITYPE)  = UVS(L,N,2,ITYPE)  + UV(LL,NN)
   1329             UVS(L,N,3,ITYPE)  = UVS(L,N,3,ITYPE)  + UV(LL,NN)**2
   1330             UVS(L,N,4,ITYPE)  = UVS(L,N,4,ITYPE)  + UV(LL,NN)**3
   1331             UVS(L,N,5,ITYPE)  = UVS(L,N,5,ITYPE)  + UV(LL,NN)**4
   1332             VVS(L,N,1,ITYPE)  = VVS(L,N,1,ITYPE)  + 1
   1333             VVS(L,N,2,ITYPE)  = VVS(L,N,2,ITYPE)  + VV(LL,NN)
   1334             VVS(L,N,3,ITYPE)  = VVS(L,N,3,ITYPE)  + VV(LL,NN)**2
   1335             VVS(L,N,4,ITYPE)  = VVS(L,N,4,ITYPE)  + VV(LL,NN)**3
   1336             VVS(L,N,5,ITYPE)  = VVS(L,N,5,ITYPE)  + VV(LL,NN)**4
   1337             UVS(L,24,1,ITYPE) = UVS(L,24,1,ITYPE) + 1
   1338             UVS(L,24,2,ITYPE) = UVS(L,24,2,ITYPE) + UV(LL,NN)
   1339             UVS(L,24,3,ITYPE) = UVS(L,24,3,ITYPE) + UV(LL,NN)**2
   1340             UVS(L,24,4,ITYPE) = UVS(L,24,4,ITYPE) + UV(LL,NN)**3
   1341             UVS(L,24,5,ITYPE) = UVS(L,24,5,ITYPE) + UV(LL,NN)**4
   1342             VVS(L,24,1,ITYPE) = VVS(L,24,1,ITYPE) + 1
   1343             VVS(L,24,2,ITYPE) = VVS(L,24,2,ITYPE) + VV(LL,NN)
   1344             VVS(L,24,3,ITYPE) = VVS(L,24,3,ITYPE) + VV(LL,NN)**2
   1345             VVS(L,24,4,ITYPE) = VVS(L,24,4,ITYPE) + VV(LL,NN)**3
   1346             VVS(L,24,5,ITYPE) = VVS(L,24,5,ITYPE) + VV(LL,NN)**4
   1347           ENDIF
   1348           IF(MAX(ABS(UM(LL,NN)),ABS(VM(LL,NN))).LT.BMISS) THEN
   1349             UMS(L,N,1,ITYPE)  = UMS(L,N,1,ITYPE)  + 1
   1350             UMS(L,N,2,ITYPE)  = UMS(L,N,2,ITYPE)  + UM(LL,NN)
   1351             UMS(L,N,3,ITYPE)  = UMS(L,N,3,ITYPE)  + UM(LL,NN)**2
   1352             UMS(L,N,4,ITYPE)  = UMS(L,N,4,ITYPE)  + UM(LL,NN)**3
   1353             UMS(L,N,5,ITYPE)  = UMS(L,N,5,ITYPE)  + UM(LL,NN)**4
   1354             VMS(L,N,1,ITYPE)  = VMS(L,N,1,ITYPE)  + 1
   1355             VMS(L,N,2,ITYPE)  = VMS(L,N,2,ITYPE)  + VM(LL,NN)
   1356             VMS(L,N,3,ITYPE)  = VMS(L,N,3,ITYPE)  + VM(LL,NN)**2
   1357             VMS(L,N,4,ITYPE)  = VMS(L,N,4,ITYPE)  + VM(LL,NN)**3
   1358             VMS(L,N,5,ITYPE)  = VMS(L,N,5,ITYPE)  + VM(LL,NN)**4
   1359             UMS(L,24,1,ITYPE) = UMS(L,24,1,ITYPE) + 1
   1360             UMS(L,24,2,ITYPE) = UMS(L,24,2,ITYPE) + UM(LL,NN)
   1361             UMS(L,24,3,ITYPE) = UMS(L,24,3,ITYPE) + UM(LL,NN)**2
   1362             UMS(L,24,4,ITYPE) = UMS(L,24,4,ITYPE) + UM(LL,NN)**3
   1363             UMS(L,24,5,ITYPE) = UMS(L,24,5,ITYPE) + UM(LL,NN)**4
   1364             VMS(L,24,1,ITYPE) = VMS(L,24,1,ITYPE) + 1
   1365             VMS(L,24,2,ITYPE) = VMS(L,24,2,ITYPE) + VM(LL,NN)
   1366             VMS(L,24,3,ITYPE) = VMS(L,24,3,ITYPE) + VM(LL,NN)**2
   1367             VMS(L,24,4,ITYPE) = VMS(L,24,4,ITYPE) + VM(LL,NN)**3
   1368             VMS(L,24,5,ITYPE) = VMS(L,24,5,ITYPE) + VM(LL,NN)**4
   1369           ENDIF
   1370           IF(ABS(VVI(LL,NN)).LT.BMISS) THEN
   1371             VVIS(L,N,1,ITYPE)  = VVIS(L,N,1,ITYPE)  + 1
   1372             VVIS(L,N,2,ITYPE)  = VVIS(L,N,2,ITYPE)  + VVI(LL,NN)
   1373             VVIS(L,N,3,ITYPE)  = VVIS(L,N,3,ITYPE)  + VVI(LL,NN)**2
   1374             VVIS(L,N,4,ITYPE)  = VVIS(L,N,4,ITYPE)  + VVI(LL,NN)**3
   1375             VVIS(L,N,5,ITYPE)  = VVIS(L,N,5,ITYPE)  + VVI(LL,NN)**4
   1376             VVIS(L,24,1,ITYPE) = VVIS(L,24,1,ITYPE) + 1
   1377             VVIS(L,24,2,ITYPE) = VVIS(L,24,2,ITYPE) + VVI(LL,NN)
   1378             VVIS(L,24,3,ITYPE) = VVIS(L,24,3,ITYPE) + VVI(LL,NN)**2
   1379             VVIS(L,24,4,ITYPE) = VVIS(L,24,4,ITYPE) + VVI(LL,NN)**3
   1380             VVIS(L,24,5,ITYPE) = VVIS(L,24,5,ITYPE) + VVI(LL,NN)**4
   1381           ENDIF
   1382           IF(ABS(VVT(LL,NN)).LT.BMISS) THEN
   1383             VVTS(L,N,1,ITYPE)  = VVTS(L,N,1,ITYPE)  + 1
   1384             VVTS(L,N,2,ITYPE)  = VVTS(L,N,2,ITYPE)  + VVT(LL,NN)

Page 36          Source Listing                  CSTATS
2017-04-18 11:09                                 profcqc.f

   1385             VVTS(L,N,3,ITYPE)  = VVTS(L,N,3,ITYPE)  + VVT(LL,NN)**2
   1386             VVTS(L,N,4,ITYPE)  = VVTS(L,N,4,ITYPE)  + VVT(LL,NN)**3
   1387             VVTS(L,N,5,ITYPE)  = VVTS(L,N,5,ITYPE)  + VVT(LL,NN)**4
   1388             VVTS(L,24,1,ITYPE) = VVTS(L,24,1,ITYPE) + 1
   1389             VVTS(L,24,2,ITYPE) = VVTS(L,24,2,ITYPE) + VVT(LL,NN)
   1390             VVTS(L,24,3,ITYPE) = VVTS(L,24,3,ITYPE) + VVT(LL,NN)**2
   1391             VVTS(L,24,4,ITYPE) = VVTS(L,24,4,ITYPE) + VVT(LL,NN)**3
   1392             VVTS(L,24,5,ITYPE) = VVTS(L,24,5,ITYPE) + VVT(LL,NN)**4
   1393           ENDIF
   1394           IF(ABS(VVV(LL,NN)).LT.BMISS) THEN
   1395             VVVS(L,N,1,ITYPE)  = VVVS(L,N,1,ITYPE)  + 1
   1396             VVVS(L,N,2,ITYPE)  = VVVS(L,N,2,ITYPE)  + VVV(LL,NN)
   1397             VVVS(L,N,3,ITYPE)  = VVVS(L,N,3,ITYPE)  + VVV(LL,NN)**2
   1398             VVVS(L,N,4,ITYPE)  = VVVS(L,N,4,ITYPE)  + VVV(LL,NN)**3
   1399             VVVS(L,N,5,ITYPE)  = VVVS(L,N,5,ITYPE)  + VVV(LL,NN)**4
   1400             VVVS(L,24,1,ITYPE) = VVVS(L,24,1,ITYPE) + 1
   1401             VVVS(L,24,2,ITYPE) = VVVS(L,24,2,ITYPE) + VVV(LL,NN)
   1402             VVVS(L,24,3,ITYPE) = VVVS(L,24,3,ITYPE) + VVV(LL,NN)**2
   1403             VVVS(L,24,4,ITYPE) = VVVS(L,24,4,ITYPE) + VVV(LL,NN)**3
   1404             VVVS(L,24,5,ITYPE) = VVVS(L,24,5,ITYPE) + VVV(LL,NN)**4
   1405           ENDIF
   1406           IF(ABS(VVM(LL,NN)).LT.BMISS) THEN
   1407             VVMS(L,N,1,ITYPE)  = VVMS(L,N,1,ITYPE)  + 1
   1408             VVMS(L,N,2,ITYPE)  = VVMS(L,N,2,ITYPE)  + VVM(LL,NN)
   1409             VVMS(L,N,3,ITYPE)  = VVMS(L,N,3,ITYPE)  + VVM(LL,NN)**2
   1410             VVMS(L,N,4,ITYPE)  = VVMS(L,N,4,ITYPE)  + VVM(LL,NN)**3
   1411             VVMS(L,N,5,ITYPE)  = VVMS(L,N,5,ITYPE)  + VVM(LL,NN)**4
   1412             VVMS(L,24,1,ITYPE) = VVMS(L,24,1,ITYPE) + 1
   1413             VVMS(L,24,2,ITYPE) = VVMS(L,24,2,ITYPE) + VVM(LL,NN)
   1414             VVMS(L,24,3,ITYPE) = VVMS(L,24,3,ITYPE) + VVM(LL,NN)**2
   1415             VVMS(L,24,4,ITYPE) = VVMS(L,24,4,ITYPE) + VVM(LL,NN)**3
   1416             VVMS(L,24,5,ITYPE) = VVMS(L,24,5,ITYPE) + VVM(LL,NN)**4
   1417           ENDIF
   1418         ENDDO  LOOP1n1
   1419       ENDDO  LOOP1
   1420 
   1421       RETURN
   1422 
   1423       END

Page 37          Source Listing                  CSTATS
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name               
                     
 cstats_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   1260                                 scalar                    1260,1282,1304,1326,1348,1370,1382
                                                                                                  ,1394,1406                        
 BMISS                      Scalar 1152     R(8)            8           scalar   COM              1260,1282,1304,1326,1348,1370,1382
                                                                                                  ,1394,1406                        
 BUFRLIB_MISSING            Common 1178                                 8                                                           
 CSTATS                     Subr   1147                                                                                             
 DATEZ                      Common 1154                                 240056                                                      
 DIM                        Scalar 1162     R(4)            4     2     15000    COM                                                
 DIT                        Scalar 1161     R(4)            4     2     15000    COM                                                
 DIV                        Scalar 1161     R(4)            4     2     15000    COM                                                
 DT                         Scalar 1168     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 1162     R(4)            4     2     15000    COM                                                
 DTV                        Scalar 1162     R(4)            4     2     15000    COM                                                
 DVM                        Scalar 1162     R(4)            4     2     15000    COM                                                
 DZ                         Scalar 1157     R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 1168     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 1167     I(4)            4     3     1800000  COM              1259                              
 ILEVELS                    Scalar 1175     I(4)            4     1     6        COM              1250                              
 IOFFSET                    Scalar 1175     I(4)            4     1     6        COM              1248                              
 IQ                         Scalar 1167     I(4)            4     3     1800000  COM              1259                              
 IQCC                       Scalar 1168     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 1169     I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 1166     I(4)            4     1     120      COM              1217,1222                         
 IS                         Dummy  1147     I(4)            4           scalar   ARG,INOUT        1217,1222,1227,1228,1232,1236,1241
                                                                                                  ,1245,1246,1247,1248,1255,1259,126
                                                                                                  0,1262,1263,1264,1265,1267,1268,12
                                                                                                  69,1270,1272,1273,1274,1275,1277,1
                                                                                                  278,1279,1280,1282,1284,1285,1286,
                                                                                                  1287,1289,1290,1291,1292,1294,1295
                                                                                                  ,1296,1297,1299,1300,1301,1302    
 ITYPE                      Local  1217     I(4)            4           scalar                    1217,1218,1248,1249,1250,1261,1262
                                                                                                  ,1263,1264,1265,1266,1267,1268,126
                                                                                                  9,1270,1271,1272,1273,1274,1275,12
                                                                                                  76,1277,1278,1279,1280,1283,1284,1
                                                                                                  285,1286,1287,1288,1289,1290,1291,
                                                                                                  1292,1293,1294,1295,1296,1297,1298
                                                                                                  ,1299,1300,1301,1302,1305,1306,130
                                                                                                  7,1308,1309,1310,1311,1312,1313,13
                                                                                                  14,1315,1316,1317,1318,1319,1320,1
                                                                                                  321,1322,1323,1324,1327,1328,1329,
                                                                                                  1330,1331,1332,1333,1334,1335,1336
                                                                                                  ,1337,1338,1339,1340,1341,1342,134
                                                                                                  3,1344,1345,1346,1349,1350,1351,13
                                                                                                  52,1353,1354,1355,1356,1357,1358,1

Page 38          Source Listing                  CSTATS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  359,1360,1361,1362,1363,1364,1365,
                                                                                                  1366,1367,1368,1371,1372,1373,1374
                                                                                                  ,1375,1376,1377,1378,1379,1380,138
                                                                                                  3,1384,1385,1386,1387,1388,1389,13
                                                                                                  90,1391,1392,1395,1396,1397,1398,1
                                                                                                  399,1400,1401,1402,1403,1404,1407,
                                                                                                  1408,1409,1410,1411,1412,1413,1414
                                                                                                  ,1415,1416                        
 JBAD_FLAG                  Scalar 1169     I(4)            4     1     120      COM                                                
 JDATE                      Scalar 1154     I(4)            4     1     4        COM                                                
 KDATE                      Scalar 1154     I(4)            4     3     60000    COM              1228,1236                         
 KURT                       Scalar 1176     I(4)            4           scalar   COM                                                
 L                          Local  1248     I(4)            4           scalar                    1248,1250,1261,1262,1263,1264,1265
                                                                                                  ,1266,1267,1268,1269,1270,1271,127
                                                                                                  2,1273,1274,1275,1276,1277,1278,12
                                                                                                  79,1280,1283,1284,1285,1286,1287,1
                                                                                                  288,1289,1290,1291,1292,1293,1294,
                                                                                                  1295,1296,1297,1298,1299,1300,1301
                                                                                                  ,1302,1305,1306,1307,1308,1309,131
                                                                                                  0,1311,1312,1313,1314,1315,1316,13
                                                                                                  17,1318,1319,1320,1321,1322,1323,1
                                                                                                  324,1327,1328,1329,1330,1331,1332,
                                                                                                  1333,1334,1335,1336,1337,1338,1339
                                                                                                  ,1340,1341,1342,1343,1344,1345,134
                                                                                                  6,1349,1350,1351,1352,1353,1354,13
                                                                                                  55,1356,1357,1358,1359,1360,1361,1
                                                                                                  362,1363,1364,1365,1366,1367,1368,
                                                                                                  1371,1372,1373,1374,1375,1376,1377
                                                                                                  ,1378,1379,1380,1383,1384,1385,138
                                                                                                  6,1387,1388,1389,1390,1391,1392,13
                                                                                                  95,1396,1397,1398,1399,1400,1401,1
                                                                                                  402,1403,1404,1407,1408,1409,1410,
                                                                                                  1411,1412,1413,1414,1415,1416     
 LEVZ                       Scalar 1157     I(4)            4     3     1800000  COM                                                
 LL                         Local  1247     I(4)            4           scalar                    1247,1248,1255,1259,1260,1262,1263
                                                                                                  ,1264,1265,1267,1268,1269,1270,127
                                                                                                  2,1273,1274,1275,1277,1278,1279,12
                                                                                                  80,1282,1284,1285,1286,1287,1289,1
                                                                                                  290,1291,1292,1294,1295,1296,1297,
                                                                                                  1299,1300,1301,1302,1304,1306,1307
                                                                                                  ,1308,1309,1311,1312,1313,1314,131
                                                                                                  6,1317,1318,1319,1321,1322,1323,13
                                                                                                  24,1326,1328,1329,1330,1331,1333,1
                                                                                                  334,1335,1336,1338,1339,1340,1341,
                                                                                                  1343,1344,1345,1346,1348,1350,1351
                                                                                                  ,1352,1353,1355,1356,1357,1358,136
                                                                                                  0,1361,1362,1363,1365,1366,1367,13
                                                                                                  68,1370,1372,1373,1374,1375,1377,1
                                                                                                  378,1379,1380,1382,1384,1385,1386,
                                                                                                  1387,1389,1390,1391,1392,1394,1396
                                                                                                  ,1397,1398,1399,1401,1402,1403,140
                                                                                                  4,1406,1408,1409,1410,1411,1413,14
                                                                                                  14,1415,1416                      
 LOOP1                      Label  1227                                 scalar                    1234,1243,1246,1419               
 LOOP1N1                    Label  1247                                 scalar                    1257,1259,1418                    

Page 39          Source Listing                  CSTATS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LVLINCR                    Scalar 1175     I(4)            4     1     6        COM              1249                              
 MAX                        Func   1260                                 scalar                    1260,1282,1304,1326,1348          
 MDATE                      Scalar 1154     I(4)            4     1     5        COM                                                
 MEAN                       Scalar 1175     I(4)            4           scalar   COM                                                
 MLEV                       Scalar 1168     I(4)            4     2     12000    COM                                                
 MOD                        Func   1217                                 scalar                    1217                              
 N                          Local  1236     I(4)            4           scalar                    1236,1237,1255,1261,1262,1263,1264
                                                                                                  ,1265,1266,1267,1268,1269,1270,128
                                                                                                  3,1284,1285,1286,1287,1288,1289,12
                                                                                                  90,1291,1292,1305,1306,1307,1308,1
                                                                                                  309,1310,1311,1312,1313,1314,1327,
                                                                                                  1328,1329,1330,1331,1332,1333,1334
                                                                                                  ,1335,1336,1349,1350,1351,1352,135
                                                                                                  3,1354,1355,1356,1357,1358,1371,13
                                                                                                  72,1373,1374,1375,1383,1384,1385,1
                                                                                                  386,1387,1395,1396,1397,1398,1399,
                                                                                                  1407,1408,1409,1410,1411          
 NCH                        Scalar 1163     I(4)            4           scalar   COM                                                
 NDATE                      Scalar 1154     I(4)            4     1     5        COM                                                
 NFIN                       Scalar 1164     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 1164     I(4)            4           scalar   COM                                                
 NI                         Scalar 1160     I(4)            4     2     15000    COM                                                
 NINT                       Func   1245                                 scalar                    1245,1246,1248,1255               
 NL                         Param  1149     I(4)            4           scalar                    1155,1156,1157,1158,1159,1160,1161
                                                                                                  ,1162,1167,1168,1169              
 NLEV                       Scalar 1163     I(4)            4           scalar   COM                                                
 NM                         Scalar 1160     I(4)            4     2     15000    COM                                                
 NN                         Local  1227     I(4)            4           scalar                    1227,1228,1232,1236,1241,1245,1246
                                                                                                  ,1248,1255,1259,1260,1262,1263,126
                                                                                                  4,1265,1267,1268,1269,1270,1272,12
                                                                                                  73,1274,1275,1277,1278,1279,1280,1
                                                                                                  282,1284,1285,1286,1287,1289,1290,
                                                                                                  1291,1292,1294,1295,1296,1297,1299
                                                                                                  ,1300,1301,1302,1304,1306,1307,130
                                                                                                  8,1309,1311,1312,1313,1314,1316,13
                                                                                                  17,1318,1319,1321,1322,1323,1324,1
                                                                                                  326,1328,1329,1330,1331,1333,1334,
                                                                                                  1335,1336,1338,1339,1340,1341,1343
                                                                                                  ,1344,1345,1346,1348,1350,1351,135
                                                                                                  2,1353,1355,1356,1357,1358,1360,13
                                                                                                  61,1362,1363,1365,1366,1367,1368,1
                                                                                                  370,1372,1373,1374,1375,1377,1378,
                                                                                                  1379,1380,1382,1384,1385,1386,1387
                                                                                                  ,1389,1390,1391,1392,1394,1396,139
                                                                                                  7,1398,1399,1401,1402,1403,1404,14
                                                                                                  06,1408,1409,1410,1411,1413,1414,1
                                                                                                  415,1416                          
 NREP                       Scalar 1163     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 1163     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 1163     I(4)            4           scalar   COM                                                
 NS                         Param  1149     I(4)            4           scalar                    1154,1155,1156,1157,1158,1165,1166
                                                                                                  ,1167,1168,1169                   
 NSCAN                      Scalar 1163     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 1163     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 1163     I(4)            4           scalar   COM                                                

Page 40          Source Listing                  CSTATS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NT                         Param  1149     I(4)            4           scalar                    1154,1155,1156,1157,1158,1159,1160
                                                                                                  ,1161,1162,1165,1167,1168,1169    
 NTIMES                     Scalar 1165     I(4)            4     1     120      COM              1227                              
 NTMP                       Scalar 1160     I(4)            4     2     15000    COM                                                
 NV                         Scalar 1160     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 1168     I(4)            4     1     120      COM              1247                              
 PARAMS                     Common 1163                                 40                                                          
 PROFZ                      Common 1155                                 72000000                                                    
 PST                        Common 1175                                 92                                                          
 PZ                         Scalar 1156     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 1167     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 1167                                 43296960                                                    
 QZ                         Scalar 1156     R(4)            4     3     1800000  COM                                                
 RESIDS                     Common 1158                                 15840000                                                    
 SKEW                       Scalar 1176     R(4)            4           scalar   COM                                                
 STATS                      Scalar 1175     R(4)            4           scalar   COM                                                
 STATZ                      Common 1170                                 9072000                                                     
 STDDEV                     Scalar 1176     R(4)            4           scalar   COM                                                
 STN                        Scalar 1151     CHAR            8     1     120      COM              1222,1232,1241,1255               
 STNLST                     Common 1165                                 51360                                                       
 SZ                         Scalar 1157     R(4)            4     3     1800000  COM                                                
 TIM                        Scalar 1165     R(4)            4     2     12000    COM              1232,1241,1245,1246               
 TIMEO                      Common 1177                                 8                                                           
 TIMWIN_E                   Scalar 1177     R(4)            4           scalar   COM              1245                              
 TIMWIN_L                   Scalar 1177     R(4)            4           scalar   COM              1246                              
 UFZ                        Scalar 1156     R(4)            4     3     1800000  COM                                                
 UI                         Scalar 1158     R(4)            4     3     1800000  COM              1282,1284,1285,1286,1287,1294,1295
                                                                                                  ,1296,1297                        
 UIS                        Scalar 1171     R(4)            4     4     162000   COM              1283,1284,1285,1286,1287,1293,1294
                                                                                                  ,1295,1296,1297                   
 UM                         Scalar 1159     R(4)            4     2     15000    COM              1348,1350,1351,1352,1353,1360,1361
                                                                                                  ,1362,1363                        
 UMS                        Scalar 1174     R(4)            4     4     162000   COM              1349,1350,1351,1352,1353,1359,1360
                                                                                                  ,1361,1362,1363                   
 UT                         Scalar 1158     R(4)            4     2     15000    COM              1304,1306,1307,1308,1309,1316,1317
                                                                                                  ,1318,1319                        
 UTS                        Scalar 1171     R(4)            4     4     162000   COM              1305,1306,1307,1308,1309,1315,1316
                                                                                                  ,1317,1318,1319                   
 UV                         Scalar 1159     R(4)            4     2     15000    COM              1326,1328,1329,1330,1331,1338,1339
                                                                                                  ,1340,1341                        
 UVS                        Scalar 1172     R(4)            4     4     162000   COM              1327,1328,1329,1330,1331,1337,1338
                                                                                                  ,1339,1340,1341                   
 UZ                         Scalar 1155     R(4)            4     3     1800000  COM              1260,1262,1263,1264,1265,1272,1273
                                                                                                  ,1274,1275                        
 UZS                        Scalar 1170     R(4)            4     4     162000   COM              1261,1262,1263,1264,1265,1271,1272
                                                                                                  ,1273,1274,1275                   
 VFZ                        Scalar 1156     R(4)            4     3     1800000  COM                                                
 VI                         Scalar 1158     R(4)            4     3     1800000  COM              1282,1289,1290,1291,1292,1299,1300
                                                                                                  ,1301,1302                        
 VIS                        Scalar 1171     R(4)            4     4     162000   COM              1288,1289,1290,1291,1292,1298,1299
                                                                                                  ,1300,1301,1302                   
 VM                         Scalar 1160     R(4)            4     2     15000    COM              1348,1355,1356,1357,1358,1365,1366
                                                                                                  ,1367,1368                        
 VMS                        Scalar 1174     R(4)            4     4     162000   COM              1354,1355,1356,1357,1358,1364,1365
                                                                                                  ,1366,1367,1368                   

Page 41          Source Listing                  CSTATS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VT                         Scalar 1158     R(4)            4     2     15000    COM              1304,1311,1312,1313,1314,1321,1322
                                                                                                  ,1323,1324                        
 VTS                        Scalar 1172     R(4)            4     4     162000   COM              1310,1311,1312,1313,1314,1320,1321
                                                                                                  ,1322,1323,1324                   
 VV                         Scalar 1159     R(4)            4     2     15000    COM              1326,1333,1334,1335,1336,1343,1344
                                                                                                  ,1345,1346                        
 VVI                        Scalar 1159     R(4)            4     2     15000    COM              1370,1372,1373,1374,1375,1377,1378
                                                                                                  ,1379,1380                        
 VVIS                       Scalar 1173     R(4)            4     4     162000   COM              1371,1372,1373,1374,1375,1376,1377
                                                                                                  ,1378,1379,1380                   
 VVM                        Scalar 1160     R(4)            4     2     15000    COM              1406,1408,1409,1410,1411,1413,1414
                                                                                                  ,1415,1416                        
 VVMS                       Scalar 1174     R(4)            4     4     162000   COM              1407,1408,1409,1410,1411,1412,1413
                                                                                                  ,1414,1415,1416                   
 VVS                        Scalar 1172     R(4)            4     4     162000   COM              1332,1333,1334,1335,1336,1342,1343
                                                                                                  ,1344,1345,1346                   
 VVT                        Scalar 1159     R(4)            4     2     15000    COM              1382,1384,1385,1386,1387,1389,1390
                                                                                                  ,1391,1392                        
 VVTS                       Scalar 1173     R(4)            4     4     162000   COM              1383,1384,1385,1386,1387,1388,1389
                                                                                                  ,1390,1391,1392                   
 VVV                        Scalar 1159     R(4)            4     2     15000    COM              1394,1396,1397,1398,1399,1401,1402
                                                                                                  ,1403,1404                        
 VVVS                       Scalar 1173     R(4)            4     4     162000   COM              1395,1396,1397,1398,1399,1400,1401
                                                                                                  ,1402,1403,1404                   
 VZ                         Scalar 1155     R(4)            4     3     1800000  COM              1260,1267,1268,1269,1270,1277,1278
                                                                                                  ,1279,1280                        
 VZS                        Scalar 1170     R(4)            4     4     162000   COM              1266,1267,1268,1269,1270,1276,1277
                                                                                                  ,1278,1279,1280                   
 X                          Scalar 1165     R(4)            4     1     120      COM                                                
 Y                          Scalar 1165     R(4)            4     1     120      COM                                                
 Z0                         Scalar 1165     R(4)            4     1     120      COM              1248,1255                         
 ZI                         Scalar 1161     R(4)            4     2     15000    COM                                                
 ZM                         Scalar 1161     R(4)            4     2     15000    COM                                                
 ZT                         Scalar 1161     R(4)            4     2     15000    COM                                                
 ZV                         Scalar 1161     R(4)            4     2     15000    COM                                                
 ZZ                         Scalar 1155     R(4)            4     3     1800000  COM              1248,1255                         

Page 42          Source Listing                  CSTATS
2017-04-18 11:09                                 profcqc.f

   1424 
   1425 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1426 C
   1427 C SUBPROGRAM:    DIFS
   1428 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   1429 C
   1430 C ABSTRACT: COMPUTE DIFFERENCES OF RESIDUALS, USED IN DMA.
   1431 C
   1432 C PROGRAM HISTORY LOG:
   1433 C 1995-04-04  W. Collins -- Original author.
   1434 C 2004-09-09  D. Keyser  -- Excessive stdout print of differencing
   1435 C     results can be removed w/ new namelist switch which controls the
   1436 C     degree of printout.
   1437 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   1438 C     per station.
   1439 C
   1440 C USAGE:    CALL DIFS(IS,IPRINT)
   1441 C
   1442 C   INPUT ARGUMENT LIST:
   1443 C     IS       - STATION INDEX
   1444 C     IPRINT   - =1 INCLUDE ADDITIONAL DIAGNOSTIC PRINT IN STDOUT,
   1445 C                ELSE = 0
   1446 C
   1447 C   OUTPUT FILES:
   1448 C     UNIT 06  - STANDARD OUTPUT PRINT
   1449 C
   1450 C REMARKS: 
   1451 C   VARIABLE NAMES:
   1452 C     UI       - U INCREMENT
   1453 C     VI       - V INCREMENT
   1454 C     UT       - U-COMPONENT TEMPORAL RESIDUAL
   1455 C     VT       - V-COMPONENT TEMPORAL RESIDUAL
   1456 C     UV       - U-COMPONENT VERTICAL RESIDUAL
   1457 C     VV       - V-COMPONENT VERTICAL RESIDUAL
   1458 C     UM       - U-COMPONENT MEDIAN RESIDUAL
   1459 C     VM       - V-COMPONENT MEDIAN RESIDUAL
   1460 C     VVI      - VECTOR INCREMENT
   1461 C     VVT      - VECTOR TEMPORAL RESIDUAL
   1462 C     VVM      - VECTOR MEDIAN RESIDUAL
   1463 C     VVV      - VECTOR VERTICAL RESIDUAL
   1464 C     DIT      - VECTOR DIFFERENCE: INCREMENT/TEMPORAL
   1465 C     DIV      - VECTOR DIFFERENCE: INCREMENT/VERTICAL
   1466 C     DTV      - VECTOR DIFFERENCE: TEMPORAL/VERTICAL
   1467 C     DIM      - VECTOR DIFFERENCE: INCREMENT/MEDIAN
   1468 C     DVM      - VECTOR DIFFERENCE: VERTICAL/MEDIAN
   1469 C     DTM      - VECTOR DIFFERENCE: TEMPORAL/MEDIAN
   1470 C
   1471 C ATTRIBUTES:
   1472 C   LANGUAGE: FORTRAN 90
   1473 C   MACHINE:  NCEP WCOSS
   1474 C
   1475 C$$$
   1476       SUBROUTINE DIFS(IS,IPRINT)
   1477 
   1478       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   1479 
   1480       CHARACTER*8  STN

Page 43          Source Listing                  DIFS
2017-04-18 11:09                                 profcqc.f

   1481       REAL(8)   BMISS
   1482 
   1483       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   1484      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   1485      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   1486      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   1487      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   1488       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   1489      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   1490      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   1491       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   1492      $ NFIN,NFOUT
   1493       COMMON/LIMITS/XI(9124),XT(15750),XV(15750)
   1494       COMMON /STNLST/ STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   1495      $ IRTP(NS)
   1496       COMMON /BUFRLIB_MISSING/BMISS
   1497 
   1498 C     SPECIFY DIT,DIV,DTV,DIM,DVM,DTM -- MEASURES OF DIFFERENCES
   1499 C     OF THE RESIDUALS.
   1500 
   1501       DO J=1,NTIMES(IS)
   1502         DO I=1,NZZ(IS)
   1503           IF(IPRINT.EQ.1) THEN
   1504             IF(MIN(VVI(I,J),VVT(I,J),VVV(I,J),VVM(I,J)).LT.BMISS) THEN
   1505                WRITE(6,100)NSCAN,J,I,VVI(I,J),VVT(I,J),VVV(I,J),VVM(I,J)
   1506             ELSE
   1507                WRITE(6,101)NSCAN,J,I,VVI(I,J),VVT(I,J),VVV(I,J),VVM(I,J)
   1508             ENDIF
   1509           ENDIF
   1510           IF(MAX(UI(I,J,IS),VI(I,J,IS),UT(I,J),VT(I,J)).LT.BMISS
   1511      $      .AND. VVI(I,J)+VVT(I,J).NE.0.) THEN
   1512             DIT(I,J) = SQRT((UI(I,J,IS) - UT(I,J))**2
   1513      $                    + (VI(I,J,IS) - VT(I,J))**2)
   1514      $                / (0.5*(VVI(I,J) + VVT(I,J)))
   1515           ELSE
   1516             DIT(I,J) = BMISS
   1517           ENDIF
   1518           IF(MAX(UI(I,J,IS),VI(I,J,IS),UV(I,J),VV(I,J)).LT.BMISS
   1519      $      .AND. VVI(I,J)+VVV(I,J).NE.0.) THEN
   1520             DIV(I,J) = SQRT((UI(I,J,IS) - UV(I,J))**2
   1521      $                    + (VI(I,J,IS) - VV(I,J))**2)
   1522      $                / (0.5*(VVI(I,J) + VVV(I,J)))
   1523           ELSE
   1524             DIV(I,J) = BMISS
   1525           ENDIF
   1526           IF(MAX(UT(I,J),VT(I,J),UV(I,J),VV(I,J)).LT.BMISS
   1527      $      .AND. VVT(I,J)+VVV(I,J).NE.0.) THEN
   1528             DTV(I,J) = SQRT((UT(I,J) - UV(I,J))**2
   1529      $                    + (VT(I,J) - VV(I,J))**2)
   1530      $                / (0.5*(VVT(I,J) + VVV(I,J)))
   1531           ELSE
   1532             DTV(I,J) = BMISS
   1533           ENDIF
   1534           IF(MAX(UI(I,J,IS),VI(I,J,IS),UM(I,J),VM(I,J)).LT.BMISS
   1535      $      .AND. VVI(I,J)+VVM(I,J).NE.0.) THEN
   1536             DIM(I,J) = SQRT((UI(I,J,IS) - UM(I,J))**2
   1537      $                    + (VI(I,J,IS) - VM(I,J))**2)

Page 44          Source Listing                  DIFS
2017-04-18 11:09                                 profcqc.f

   1538      $                / (0.5*(VVI(I,J) + VVM(I,J)))
   1539           ELSE
   1540             DIM(I,J) = BMISS
   1541           ENDIF
   1542           IF(MAX(UV(I,J),VV(I,J),UM(I,J),VM(I,J)).LT.BMISS
   1543      $      .AND. VVV(I,J)+VVM(I,J).NE.0.) THEN
   1544             DVM(I,J) = SQRT((UV(I,J) - UM(I,J))**2
   1545      $                    + (VV(I,J) - VM(I,J))**2)
   1546      $                / (0.5*(VVV(I,J) + VVM(I,J)))
   1547           ELSE
   1548             DVM(I,J) = BMISS
   1549           ENDIF
   1550           IF(MAX(UT(I,J),VT(I,J),UM(I,J),VM(I,J)).LT.BMISS
   1551      $      .AND. VVT(I,J)+VVM(I,J).NE.0.) THEN
   1552             DTM(I,J) = SQRT((UT(I,J) - UM(I,J))**2
   1553      $                    + (VT(I,J) - VM(I,J))**2)
   1554      $                / (0.5*(VVT(I,J) + VVM(I,J)))
   1555           ELSE
   1556             DTM(I,J) = BMISS
   1557           ENDIF
   1558         ENDDO
   1559       ENDDO
   1560 
   1561       RETURN
   1562 
   1563   100 FORMAT(' DIFS: scan=',I2,', time period=',I2,', lvl=',I3,
   1564      $ '; vector: incr=',F6.2,', temporal resid=',F6.2,', vertical ',
   1565      $ 'resid=',F6.2,', median resid=',F6.2)
   1566   101 FORMAT('~DIFS: scan=',I2,', time period=',I2,', lvl=',I3,
   1567      $ '; vector: incr=',F6.2,', temporal resid=',F6.2,', vertical ',
   1568      $ 'resid=',F6.2,', median resid=',F6.2)
   1569 
   1570       END

Page 45          Source Listing                  DIFS
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name             
                   
 difs_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1563                                                           1505                              
 101                        Label  1566                                                           1507                              
 BMISS                      Scalar 1481     R(8)            8           scalar   COM              1504,1510,1516,1518,1524,1526,1532
                                                                                                  ,1534,1540,1542,1548,1550,1556    
 BUFRLIB_MISSING            Common 1496                                 8                                                           
 DIFS                       Subr   1476                                                                                             
 DIM                        Scalar 1487     R(4)            4     2     15000    COM              1536,1540                         
 DIT                        Scalar 1486     R(4)            4     2     15000    COM              1512,1516                         
 DIV                        Scalar 1486     R(4)            4     2     15000    COM              1520,1524                         
 DT                         Scalar 1489     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 1487     R(4)            4     2     15000    COM              1552,1556                         
 DTV                        Scalar 1487     R(4)            4     2     15000    COM              1528,1532                         
 DVM                        Scalar 1487     R(4)            4     2     15000    COM              1544,1548                         
 I                          Local  1502     I(4)            4           scalar                    1502,1504,1505,1507,1510,1511,1512
                                                                                                  ,1513,1514,1516,1518,1519,1520,152
                                                                                                  1,1522,1524,1526,1527,1528,1529,15
                                                                                                  30,1532,1534,1535,1536,1537,1538,1
                                                                                                  540,1542,1543,1544,1545,1546,1548,
                                                                                                  1550,1551,1552,1553,1554,1556     
 IBAD_FLAG                  Scalar 1489     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 1488     I(4)            4     3     1800000  COM                                                
 IPRINT                     Dummy  1476     I(4)            4           scalar   ARG,INOUT        1503                              
 IQ                         Scalar 1488     I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 1489     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 1490     I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 1495     I(4)            4     1     120      COM                                                
 IS                         Dummy  1476     I(4)            4           scalar   ARG,INOUT        1501,1502,1510,1512,1513,1518,1520
                                                                                                  ,1521,1534,1536,1537              
 J                          Local  1501     I(4)            4           scalar                    1501,1504,1505,1507,1510,1511,1512
                                                                                                  ,1513,1514,1516,1518,1519,1520,152
                                                                                                  1,1522,1524,1526,1527,1528,1529,15
                                                                                                  30,1532,1534,1535,1536,1537,1538,1
                                                                                                  540,1542,1543,1544,1545,1546,1548,
                                                                                                  1550,1551,1552,1553,1554,1556     
 JBAD_FLAG                  Scalar 1490     I(4)            4     1     120      COM                                                
 LIMITS                     Common 1493                                 162496                                                      
 MAX                        Func   1510                                 scalar                    1510,1518,1526,1534,1542,1550     
 MIN                        Func   1504                                 scalar                    1504                              
 MLEV                       Scalar 1489     I(4)            4     2     12000    COM                                                
 NCH                        Scalar 1491     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 1492     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 1492     I(4)            4           scalar   COM                                                
 NI                         Scalar 1485     I(4)            4     2     15000    COM                                                
 NL                         Param  1478     I(4)            4           scalar                    1483,1484,1485,1486,1487,1488,1489

Page 46          Source Listing                  DIFS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,1490                             
 NLEV                       Scalar 1491     I(4)            4           scalar   COM                                                
 NM                         Scalar 1485     I(4)            4     2     15000    COM                                                
 NREP                       Scalar 1491     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 1491     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 1491     I(4)            4           scalar   COM                                                
 NS                         Param  1478     I(4)            4           scalar                    1483,1488,1489,1490,1494,1495     
 NSCAN                      Scalar 1491     I(4)            4           scalar   COM              1505,1507                         
 NSTN                       Scalar 1491     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 1491     I(4)            4           scalar   COM                                                
 NT                         Param  1478     I(4)            4           scalar                    1483,1484,1485,1486,1487,1488,1489
                                                                                                  ,1490,1494                        
 NTIMES                     Scalar 1494     I(4)            4     1     120      COM              1501                              
 NTMP                       Scalar 1485     I(4)            4     2     15000    COM                                                
 NV                         Scalar 1485     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 1489     I(4)            4     1     120      COM              1502                              
 PARAMS                     Common 1491                                 40                                                          
 QM                         Scalar 1488     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 1488                                 43296960                                                    
 RESIDS                     Common 1483                                 15840000                                                    
 SQRT                       Func   1512                                 scalar                    1512,1520,1528,1536,1544,1552     
 STN                        Scalar 1480     CHAR            8     1     120      COM                                                
 STNLST                     Common 1494                                 51360                                                       
 TIM                        Scalar 1494     R(4)            4     2     12000    COM                                                
 UI                         Scalar 1483     R(4)            4     3     1800000  COM              1510,1512,1518,1520,1534,1536     
 UM                         Scalar 1484     R(4)            4     2     15000    COM              1534,1536,1542,1544,1550,1552     
 UT                         Scalar 1483     R(4)            4     2     15000    COM              1510,1512,1526,1528,1550,1552     
 UV                         Scalar 1484     R(4)            4     2     15000    COM              1518,1520,1526,1528,1542,1544     
 VI                         Scalar 1483     R(4)            4     3     1800000  COM              1510,1513,1518,1521,1534,1537     
 VM                         Scalar 1485     R(4)            4     2     15000    COM              1534,1537,1542,1545,1550,1553     
 VT                         Scalar 1483     R(4)            4     2     15000    COM              1510,1513,1526,1529,1550,1553     
 VV                         Scalar 1484     R(4)            4     2     15000    COM              1518,1521,1526,1529,1542,1545     
 VVI                        Scalar 1484     R(4)            4     2     15000    COM              1504,1505,1507,1511,1514,1519,1522
                                                                                                  ,1535,1538                        
 VVM                        Scalar 1485     R(4)            4     2     15000    COM              1504,1505,1507,1535,1538,1543,1546
                                                                                                  ,1551,1554                        
 VVT                        Scalar 1484     R(4)            4     2     15000    COM              1504,1505,1507,1511,1514,1527,1530
                                                                                                  ,1551,1554                        
 VVV                        Scalar 1484     R(4)            4     2     15000    COM              1504,1505,1507,1519,1522,1527,1530
                                                                                                  ,1543,1546                        
 X                          Scalar 1494     R(4)            4     1     120      COM                                                
 XI                         Scalar 1493     R(4)            4     1     9124     COM                                                
 XT                         Scalar 1493     R(4)            4     1     15750    COM                                                
 XV                         Scalar 1493     R(4)            4     1     15750    COM                                                
 Y                          Scalar 1494     R(4)            4     1     120      COM                                                
 Z0                         Scalar 1494     R(4)            4     1     120      COM                                                
 ZI                         Scalar 1486     R(4)            4     2     15000    COM                                                
 ZM                         Scalar 1486     R(4)            4     2     15000    COM                                                
 ZT                         Scalar 1486     R(4)            4     2     15000    COM                                                
 ZV                         Scalar 1486     R(4)            4     2     15000    COM                                                

Page 47          Source Listing                  DIFS
2017-04-18 11:09                                 profcqc.f

   1571 
   1572 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1573 C
   1574 C SUBPROGRAM:    DMA
   1575 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   1576 C
   1577 C ABSTRACT: DECISION MAKING ALGORITHM FOR PROFILER WIND QC.
   1578 C
   1579 C PROGRAM HISTORY LOG:
   1580 C 1995-04-05  W. Collins -- Original author.
   1581 C 2004-09-09  D. Keyser  -- Reason codes are expanded (see MAIN program
   1582 C     remarks).
   1583 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   1584 C     per station.
   1585 C
   1586 C USAGE:    CALL DMA(IS)
   1587 C   INPUT ARGUMENT LIST:
   1588 C     IS       - STATION INDEX
   1589 C
   1590 C   OUTPUT FILES:
   1591 C     UNIT 06  - STANDARD OUTPUT PRINT
   1592 C
   1593 C REMARKS: 
   1594 C   VARIABLE NAMES:
   1595 C     ZI       - NORMALIZED VECTOR INCREMENT
   1596 C     ZT       - NORMALIZED VECTOR TEMPORAL RESIDUAL
   1597 C     ZV       - NORMALIZED VECTOR VERTICAL RESIDUAL
   1598 C     ZM       - NORMALIZED VECTOR MEDIAN RESIDUAL
   1599 C     DIT      - VECTOR DIFFERENCE: INCREMENT/TEMPORAL
   1600 C     DIV      - VECTOR DIFFERENCE: INCREMENT/VERTICAL
   1601 C     DTV      - VECTOR DIFFERENCE: TEMPORAL/VERTICAL
   1602 C     DIM      - VECTOR DIFFERENCE: INCREMENT/MEDIAN
   1603 C     DVM      - VECTOR DIFFERENCE: VERTICAL/MEDIAN
   1604 C     DTM      - VECTOR DIFFERENCE: TEMPORAL/MEDIAN
   1605 C     ICQC     - DMA INDEX FOR WIND QUALITY CONTROL
   1606 C     NCH      - NUMBER OF CHANGED QUALITY MARKS
   1607 C
   1608 C ATTRIBUTES:
   1609 C   LANGUAGE: FORTRAN 90
   1610 C   MACHINE:  NCEP WCOSS
   1611 C
   1612 C$$$
   1613       SUBROUTINE DMA(IS)
   1614 
   1615       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   1616 
   1617       CHARACTER*8  STN,CID
   1618       REAL(8)   BMISS
   1619 
   1620       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   1621      $ IRTP(NS)
   1622       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   1623      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   1624      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   1625      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   1626      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   1627       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),

Page 48          Source Listing                  DMA
2017-04-18 11:09                                 profcqc.f

   1628      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   1629      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   1630       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   1631      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   1632      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   1633       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   1634      $ NFIN,NFOUT
   1635       COMMON/LIMITS/XI(9125),XT(15750),XV(15750)
   1636       COMMON /BUFRLIB_MISSING/BMISS
   1637 
   1638       DATA  R11/8.0/,R12/3.0/,R2/0.4/,R31/4.0/,R32 /1.5/
   1639 
   1640       CID = STN(IS)
   1641 
   1642 C     DETERMINE FLAGS FOR QUESTIONABLE AND BAD DATA.
   1643 C     SET ICQC TO:
   1644 C       0 IF DATA ARE GOOD
   1645 C       1 IF DATA ARE QUESTIONABLE
   1646 C       2 IF DATA ARE BAD
   1647 C     ALSO RETURN IN NCH THE NUMBER OF DECISIONS THAT CHANGE.
   1648 
   1649       NCH = 0
   1650       DO N=1,NTIMES(IS)
   1651         DO L=1,NZZ(IS)
   1652           ICQCO = ICQC(L,N,IS)
   1653 
   1654 C         FIND AVERAGE VECTOR RESIDUAL MAGNITUDE.
   1655 
   1656           SUM = 0.
   1657           NRES = 0
   1658           RESMN = 0.
   1659           IF(ZI(L,N).LT.BMISS) THEN
   1660             NRES = NRES + 1
   1661             SUM = SUM + ZI(L,N)
   1662           ENDIF
   1663           IF(ZT(L,N).LT.BMISS) THEN
   1664             NRES = NRES + 1
   1665             SUM = SUM + ZT(L,N)
   1666           ENDIF
   1667           IF(ZV(L,N).LT.BMISS) THEN
   1668             NRES = NRES + 1
   1669             SUM = SUM + ZV(L,N)
   1670           ENDIF
   1671           IF(ZM(L,N).LT.BMISS) THEN
   1672             NRES = NRES + 1
   1673             SUM = SUM + ZM(L,N)
   1674           ENDIF
   1675           IF(NRES.GT.0) THEN
   1676             RESMN = SUM / NRES
   1677           ENDIF
   1678 
   1679 C         FIND AVERAGE VECTOR RESIDUAL DIFFERENCE.
   1680 
   1681           SUM = 0.
   1682           NRD = 0
   1683           RESDM = 0.
   1684           IF(DIT(L,N).LT.BMISS) THEN

Page 49          Source Listing                  DMA
2017-04-18 11:09                                 profcqc.f

   1685             NRD = NRD + 1
   1686             SUM = SUM + DIT(L,N)
   1687           ENDIF
   1688           IF(DIV(L,N).LT.BMISS) THEN
   1689             NRD = NRD + 1
   1690             SUM = SUM + DIV(L,N)
   1691           ENDIF
   1692           IF(DTV(L,N).LT.BMISS) THEN
   1693             NRD = NRD + 1
   1694             SUM = SUM + DTV(L,N)
   1695           ENDIF
   1696           IF(DIM(L,N).LT.BMISS) THEN
   1697             NRD = NRD + 1
   1698             SUM = SUM + DIM(L,N)
   1699           ENDIF
   1700           IF(DVM(L,N).LT.BMISS) THEN
   1701             NRD = NRD + 1
   1702             SUM = SUM + DVM(L,N)
   1703           ENDIF
   1704           IF(DTM(L,N).LT.BMISS) THEN
   1705             NRD = NRD + 1
   1706             SUM = SUM + DTM(L,N)
   1707           ENDIF
   1708           IF(NRD.GT.0) THEN
   1709             RESDM = SUM / NRD
   1710           ENDIF
   1711 
   1712 C         FOR AN ERROR, REQUIRE RESMN LARGE AND RESDM TO BE SMALL.
   1713 
   1714           Z1 = 10000.
   1715           Z2 = 13000.
   1716           IF(ZZ(L,N,IS).LE.Z1) THEN ! ZZ .le. 10000 m
   1717             R1 = R11
   1718             R3 = R31
   1719           ELSE IF(ZZ(L,N,IS).GE.Z2) THEN ! ZZ .ge. 13000 m
   1720             R1 = R12
   1721             R3 = R32
   1722           ELSE ! ZZ between 10000 and 13000 m
   1723             R1 = ((Z2-ZZ(L,N,IS))*R11 + (ZZ(L,N,IS)-Z1)*R12)/(Z2-Z1)
   1724             R3 = ((Z2-ZZ(L,N,IS))*R31 + (ZZ(L,N,IS)-Z1)*R32)/(Z2-Z1)
   1725           ENDIF
   1726           K1 = 0
   1727           K2 = 0
   1728           K3 = 0
   1729           ITOT = 0
   1730           IDIT = 0
   1731           IDIV = 0
   1732           IDIM = 0
   1733           IDTV = 0
   1734           IDTM = 0
   1735           IDVM = 0
   1736           IF(RESMN.GT.R1 .AND. RESDM.LT.R2  .OR.
   1737      $      (RESMN.GT.R1 .AND. NRD.EQ.1)) THEN ! Bad
   1738              INEW = 2
   1739             IF(NRD.EQ.1.AND.RESDM.GE.R2) THEN
   1740               K3 = 1
   1741             ELSE

Page 50          Source Listing                  DMA
2017-04-18 11:09                                 profcqc.f

   1742               IF(DIT(L,N).LT.R2) THEN
   1743                 IDIT = 1
   1744                 ITOT = ITOT + 1
   1745               ENDIF
   1746               IF(DIV(L,N).LT.R2) THEN
   1747                 IDIV = 1
   1748                 ITOT = ITOT + 1
   1749               ENDIF
   1750               IF(DIM(L,N).LT.R2) THEN
   1751                 IDIM = 1
   1752                 ITOT = ITOT + 1
   1753               ENDIF
   1754               IF(DTV(L,N).LT.R2) THEN
   1755                 IDTV = 1
   1756                 ITOT = ITOT + 1
   1757               ENDIF
   1758               IF(DTM(L,N).LT.R2) THEN
   1759                 IDTM = 1
   1760                 ITOT = ITOT + 1
   1761               ENDIF
   1762               IF(DVM(L,N).LT.R2) THEN
   1763                 IDVM = 1
   1764                 ITOT = ITOT + 1
   1765               ENDIF
   1766               IF(ITOT.GE.4) THEN
   1767                 K3 = 9
   1768               ELSE IF(ITOT.GE.2) THEN
   1769                 K3 = 8
   1770               ELSE IF(ITOT.EQ.1) THEN
   1771                 IF(IDIT.EQ.1) THEN
   1772                   K3 = 2
   1773                 ELSE IF(IDIV.EQ.1) THEN
   1774                   K3 = 3
   1775                 ELSE IF(IDIM.EQ.1) THEN
   1776                   K3 = 4
   1777                 ELSE IF(IDTV.EQ.1) THEN
   1778                   K3 = 5
   1779                 ELSE IF(IDTM.EQ.1) THEN
   1780                   K3 = 6
   1781                 ELSE IF(IDVM.EQ.1) THEN
   1782                   K3 = 7
   1783                 ENDIF
   1784               ENDIF
   1785             ENDIF
   1786             K1 = 1
   1787             IF(MAX(ZM(L,N),ZV(L,N)).LT.BMISS.AND.MIN(ZM(L,N),ZV(L,N))
   1788      $       .GT.R1) THEN
   1789               K1 = 7
   1790             ELSE IF(ZV(L,N).GT.R1.AND.ZV(L,N).LT.BMISS) THEN
   1791               K1 = 6
   1792             ELSE IF(ZM(L,N).GT.R1.AND.ZM(L,N).LT.BMISS) THEN
   1793               K1 = 5
   1794             ENDIF
   1795             K2 = 1
   1796             IF(MAX(ZT(L,N),ZI(L,N)).LT.BMISS.AND.MIN(ZT(L,N),ZI(L,N))
   1797      $       .GT.R1) THEN
   1798               K2 = 7

Page 51          Source Listing                  DMA
2017-04-18 11:09                                 profcqc.f

   1799             ELSE IF(ZI(L,N).GT.R1.AND.ZI(L,N).LT.BMISS) THEN
   1800               K2 = 6
   1801             ELSE IF(ZT(L,N).GT.R1.AND.ZT(L,N).LT.BMISS) THEN
   1802               K2 = 5
   1803             ENDIF
   1804           ELSE IF(RESMN.GT.R3) THEN
   1805             INEW = 1 ! Suspect
   1806             K1 = 1
   1807             IF(MAX(ZM(L,N),ZV(L,N)).LT.BMISS.AND.MIN(ZM(L,N),ZV(L,N))
   1808      $       .GT.R3) THEN
   1809               K1 = 4
   1810             ELSE IF(ZV(L,N).GT.R3.AND.ZV(L,N).LT.BMISS) THEN
   1811               K1 = 3
   1812             ELSE IF(ZM(L,N).GT.R3.AND.ZM(L,N).LT.BMISS) THEN
   1813               K1 = 2
   1814             ENDIF
   1815             K2 = 1
   1816             IF(MAX(ZT(L,N),ZI(L,N)).LT.BMISS.AND.MIN(ZT(L,N),ZI(L,N))
   1817      $       .GT.R3) THEN
   1818               K2 = 4
   1819             ELSE IF(ZI(L,N).GT.R3.AND.ZI(L,N).LT.BMISS) THEN
   1820               K2 = 3
   1821             ELSE IF(ZT(L,N).GT.R3.AND.ZT(L,N).LT.BMISS) THEN
   1822               K2 = 2
   1823             ENDIF
   1824           ELSE
   1825             INEW = 0 ! Passed checks (good)
   1826           ENDIF
   1827           ICQC(L,N,IS) = INEW
   1828           IF(INEW.GT.0)  IRC(L,N,IS) = K1*100 + K2*10 + K3
   1829 
   1830 C         CHECK FOR DECISION CHANGES
   1831 
   1832           IF(ICQCO.NE.ICQC(L,N,IS)) NCH = NCH + 1
   1833         ENDDO
   1834       ENDDO
   1835 
   1836       WRITE(6,100) NSCAN,NCH
   1837 
   1838       RETURN
   1839 
   1840   100 FORMAT('--> DMA: For scan',I3,' the total number of q.m. changes',
   1841      $ ' is',I4)
   1842 
   1843       END

Page 52          Source Listing                  DMA
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name            
                  
 dma_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1840                                                           1836                              
 BMISS                      Scalar 1618     R(8)            8           scalar   COM              1659,1663,1667,1671,1684,1688,1692
                                                                                                  ,1696,1700,1704,1787,1790,1792,179
                                                                                                  6,1799,1801,1807,1810,1812,1816,18
                                                                                                  19,1821                           
 BUFRLIB_MISSING            Common 1636                                 8                                                           
 CID                        Local  1617     CHAR            8           scalar                    1640                              
 DIM                        Scalar 1626     R(4)            4     2     15000    COM              1696,1698,1750                    
 DIT                        Scalar 1625     R(4)            4     2     15000    COM              1684,1686,1742                    
 DIV                        Scalar 1625     R(4)            4     2     15000    COM              1688,1690,1746                    
 DMA                        Subr   1613                                                                                             
 DT                         Scalar 1631     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 1626     R(4)            4     2     15000    COM              1704,1706,1758                    
 DTV                        Scalar 1626     R(4)            4     2     15000    COM              1692,1694,1754                    
 DVM                        Scalar 1626     R(4)            4     2     15000    COM              1700,1702,1762                    
 DZ                         Scalar 1629     R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 1631     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 1630     I(4)            4     3     1800000  COM              1652,1827,1832                    
 ICQCO                      Local  1652     I(4)            4           scalar                    1652,1832                         
 IDIM                       Local  1732     I(4)            4           scalar                    1732,1751,1775                    
 IDIT                       Local  1730     I(4)            4           scalar                    1730,1743,1771                    
 IDIV                       Local  1731     I(4)            4           scalar                    1731,1747,1773                    
 IDTM                       Local  1734     I(4)            4           scalar                    1734,1759,1779                    
 IDTV                       Local  1733     I(4)            4           scalar                    1733,1755,1777                    
 IDVM                       Local  1735     I(4)            4           scalar                    1735,1763,1781                    
 INEW                       Local  1738     I(4)            4           scalar                    1738,1805,1825,1827,1828          
 IQ                         Scalar 1630     I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 1631     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 1632     I(4)            4     3     1800000  COM              1828                              
 IRTP                       Scalar 1621     I(4)            4     1     120      COM                                                
 IS                         Dummy  1613     I(4)            4           scalar   ARG,INOUT        1640,1650,1651,1652,1716,1719,1723
                                                                                                  ,1724,1827,1828,1832              
 ITOT                       Local  1729     I(4)            4           scalar                    1729,1744,1748,1752,1756,1760,1764
                                                                                                  ,1766,1768,1770                   
 JBAD_FLAG                  Scalar 1632     I(4)            4     1     120      COM                                                
 K1                         Local  1726     I(4)            4           scalar                    1726,1786,1789,1791,1793,1806,1809
                                                                                                  ,1811,1813,1828                   
 K2                         Local  1727     I(4)            4           scalar                    1727,1795,1798,1800,1802,1815,1818
                                                                                                  ,1820,1822,1828                   
 K3                         Local  1728     I(4)            4           scalar                    1728,1740,1767,1769,1772,1774,1776
                                                                                                  ,1778,1780,1782,1828              
 L                          Local  1651     I(4)            4           scalar                    1651,1652,1659,1661,1663,1665,1667
                                                                                                  ,1669,1671,1673,1684,1686,1688,169
                                                                                                  0,1692,1694,1696,1698,1700,1702,17

Page 53          Source Listing                  DMA
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  04,1706,1716,1719,1723,1724,1742,1
                                                                                                  746,1750,1754,1758,1762,1787,1790,
                                                                                                  1792,1796,1799,1801,1807,1810,1812
                                                                                                  ,1816,1819,1821,1827,1828,1832    
 LEVZ                       Scalar 1629     I(4)            4     3     1800000  COM                                                
 LIMITS                     Common 1635                                 162500                                                      
 MAX                        Func   1787                                 scalar                    1787,1796,1807,1816               
 MIN                        Func   1787                                 scalar                    1787,1796,1807,1816               
 MLEV                       Scalar 1631     I(4)            4     2     12000    COM                                                
 N                          Local  1650     I(4)            4           scalar                    1650,1652,1659,1661,1663,1665,1667
                                                                                                  ,1669,1671,1673,1684,1686,1688,169
                                                                                                  0,1692,1694,1696,1698,1700,1702,17
                                                                                                  04,1706,1716,1719,1723,1724,1742,1
                                                                                                  746,1750,1754,1758,1762,1787,1790,
                                                                                                  1792,1796,1799,1801,1807,1810,1812
                                                                                                  ,1816,1819,1821,1827,1828,1832    
 NCH                        Scalar 1633     I(4)            4           scalar   COM              1649,1832,1836                    
 NFIN                       Scalar 1634     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 1634     I(4)            4           scalar   COM                                                
 NI                         Scalar 1624     I(4)            4     2     15000    COM                                                
 NL                         Param  1615     I(4)            4           scalar                    1622,1623,1624,1625,1626,1627,1628
                                                                                                  ,1629,1630,1631,1632              
 NLEV                       Scalar 1633     I(4)            4           scalar   COM                                                
 NM                         Scalar 1624     I(4)            4     2     15000    COM                                                
 NRD                        Local  1682     I(4)            4           scalar                    1682,1685,1689,1693,1697,1701,1705
                                                                                                  ,1708,1709,1737,1739              
 NREP                       Scalar 1633     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 1633     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 1633     I(4)            4           scalar   COM                                                
 NRES                       Local  1657     I(4)            4           scalar                    1657,1660,1664,1668,1672,1675,1676
 NS                         Param  1615     I(4)            4           scalar                    1620,1621,1622,1627,1628,1629,1630
                                                                                                  ,1631,1632                        
 NSCAN                      Scalar 1633     I(4)            4           scalar   COM              1836                              
 NSTN                       Scalar 1633     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 1633     I(4)            4           scalar   COM                                                
 NT                         Param  1615     I(4)            4           scalar                    1620,1622,1623,1624,1625,1626,1627
                                                                                                  ,1628,1629,1630,1631,1632         
 NTIMES                     Scalar 1620     I(4)            4     1     120      COM              1650                              
 NTMP                       Scalar 1624     I(4)            4     2     15000    COM                                                
 NV                         Scalar 1624     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 1631     I(4)            4     1     120      COM              1651                              
 PARAMS                     Common 1633                                 40                                                          
 PROFZ                      Common 1627                                 72000000                                                    
 PZ                         Scalar 1628     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 1630     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 1630                                 43296960                                                    
 QZ                         Scalar 1627     R(4)            4     3     1800000  COM                                                
 R1                         Local  1717     R(4)            4           scalar                    1717,1720,1723,1736,1737,1788,1790
                                                                                                  ,1792,1797,1799,1801              
 R11                        Local  1638     R(4)            4           scalar                    1638,1717,1723                    
 R12                        Local  1638     R(4)            4           scalar                    1638,1720,1723                    
 R2                         Local  1638     R(4)            4           scalar                    1638,1736,1739,1742,1746,1750,1754
                                                                                                  ,1758,1762                        
 R3                         Local  1718     R(4)            4           scalar                    1718,1721,1724,1804,1808,1810,1812
                                                                                                  ,1817,1819,1821                   

Page 54          Source Listing                  DMA
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 R31                        Local  1638     R(4)            4           scalar                    1638,1718,1724                    
 R32                        Local  1638     R(4)            4           scalar                    1638,1721,1724                    
 RESDM                      Local  1683     R(4)            4           scalar                    1683,1709,1736,1739               
 RESIDS                     Common 1622                                 15840000                                                    
 RESMN                      Local  1658     R(4)            4           scalar                    1658,1676,1736,1737,1804          
 STN                        Scalar 1617     CHAR            8     1     120      COM              1640                              
 STNLST                     Common 1620                                 51360                                                       
 SUM                        Local  1656     R(4)            4           scalar                    1656,1661,1665,1669,1673,1676,1681
                                                                                                  ,1686,1690,1694,1698,1702,1706,170
                                                                                                  9                                 
 SZ                         Scalar 1628     R(4)            4     3     1800000  COM                                                
 TIM                        Scalar 1620     R(4)            4     2     12000    COM                                                
 UFZ                        Scalar 1628     R(4)            4     3     1800000  COM                                                
 UI                         Scalar 1622     R(4)            4     3     1800000  COM                                                
 UM                         Scalar 1623     R(4)            4     2     15000    COM                                                
 UT                         Scalar 1622     R(4)            4     2     15000    COM                                                
 UV                         Scalar 1623     R(4)            4     2     15000    COM                                                
 UZ                         Scalar 1627     R(4)            4     3     1800000  COM                                                
 VFZ                        Scalar 1628     R(4)            4     3     1800000  COM                                                
 VI                         Scalar 1622     R(4)            4     3     1800000  COM                                                
 VM                         Scalar 1624     R(4)            4     2     15000    COM                                                
 VT                         Scalar 1622     R(4)            4     2     15000    COM                                                
 VV                         Scalar 1623     R(4)            4     2     15000    COM                                                
 VVI                        Scalar 1623     R(4)            4     2     15000    COM                                                
 VVM                        Scalar 1624     R(4)            4     2     15000    COM                                                
 VVT                        Scalar 1623     R(4)            4     2     15000    COM                                                
 VVV                        Scalar 1623     R(4)            4     2     15000    COM                                                
 VZ                         Scalar 1627     R(4)            4     3     1800000  COM                                                
 X                          Scalar 1620     R(4)            4     1     120      COM                                                
 XI                         Scalar 1635     R(4)            4     1     9125     COM                                                
 XT                         Scalar 1635     R(4)            4     1     15750    COM                                                
 XV                         Scalar 1635     R(4)            4     1     15750    COM                                                
 Y                          Scalar 1620     R(4)            4     1     120      COM                                                
 Z0                         Scalar 1620     R(4)            4     1     120      COM                                                
 Z1                         Local  1714     R(4)            4           scalar                    1714,1716,1723,1724               
 Z2                         Local  1715     R(4)            4           scalar                    1715,1719,1723,1724               
 ZI                         Scalar 1625     R(4)            4     2     15000    COM              1659,1661,1796,1799,1816,1819     
 ZM                         Scalar 1625     R(4)            4     2     15000    COM              1671,1673,1787,1792,1807,1812     
 ZT                         Scalar 1625     R(4)            4     2     15000    COM              1663,1665,1796,1801,1816,1821     
 ZV                         Scalar 1625     R(4)            4     2     15000    COM              1667,1669,1787,1790,1807,1810     
 ZZ                         Scalar 1627     R(4)            4     3     1800000  COM              1716,1719,1723,1724               

Page 55          Source Listing                  DMA
2017-04-18 11:09                                 profcqc.f

   1844 
   1845 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1846 C
   1847 C SUBPROGRAM:    EVENT
   1848 C   PRGMMR: J. WOOLLEN       ORG: NP20       DATE: 1994-??-??
   1849 C
   1850 C ABSTRACT: WRITE OUT EVENTS.
   1851 C
   1852 C PROGRAM HISTORY LOG:
   1853 C 1994-??-??  J. WOOLLEN -- Original author.
   1854 C
   1855 C USAGE:    CALL EVENT(LUNIT,EVNSTR,NLV,OBS,QMS,RCS,IND,NEVN,QCPC)
   1856 C   INPUT ARGUMENT LIST:
   1857 C     LUNIT    - UNIT NUMBER
   1858 C     EVNSTR   - EVENT STREAM OF CHARACTERS
   1859 C     NLV      - NUMBER OF LEVELS
   1860 C     OBS      - OBSERVED VALUE
   1861 C     QMS      - QUALITY MARKER
   1862 C     RCS      - REASON CODE
   1863 C     IND      - INDIRECT ADDRESS OF VALUE
   1864 C     NEVN     - NUMBER OF EVENTS
   1865 C     QCPC     - PROGRAM CODE
   1866 C
   1867 C   OUTPUT FILES:
   1868 C     UNIT 06  - STANDARD OUTPUT PRINT
   1869 C
   1870 C ATTRIBUTES:
   1871 C   LANGUAGE: FORTRAN 90
   1872 C   MACHINE:  NCEP WCOSS
   1873 C
   1874 C$$$
   1875       SUBROUTINE EVENT(LUNIT,EVNSTR,NLV,OBS,QMS,RCS,IND,NEVN,QCPC)
   1876 
   1877       CHARACTER*(*)  EVNSTR
   1878       REAL(8)  EVNS_8(5,255),BMISS
   1879       DIMENSION  OBS(255,2),QMS(NEVN),RCS(NEVN),IND(NEVN)
   1880 
   1881       COMMON /BUFRLIB_MISSING/BMISS
   1882 
   1883       IF(NEVN.EQ.0) THEN
   1884          WRITE(6,100)
   1885          RETURN
   1886       ENDIF
   1887 
   1888 C  CLEAR THE UFB ARRAY FIRST
   1889 C  -------------------------
   1890 
   1891       EVNS_8 = BMISS
   1892 
   1893 C  TRANSFER EVENT ARRAYS INTO UFB ARRAY
   1894 C  ------------------------------------
   1895 
   1896       DO I=1,NEVN
   1897          J = IND(I)
   1898          IF(MIN(OBS(I,1),OBS(I,2)).LT.BMISS) THEN
   1899             EVNS_8(1,J) = OBS(I,1)
   1900             EVNS_8(2,J) = OBS(I,2)

Page 56          Source Listing                  EVENT
2017-04-18 11:09                                 profcqc.f

   1901             EVNS_8(3,J) = QMS(I)
   1902             EVNS_8(4,J) = QCPC
   1903             EVNS_8(5,J) = RCS(I)
   1904          ENDIF
   1905       ENDDO
   1906 
   1907 C  WRITE THE EVENTS AND EXIT
   1908 C  -------------------------
   1909 
   1910       CALL UFBINT(LUNIT,EVNS_8,5,NLV,IRET,EVNSTR)
   1911       WRITE(6,101) NLV,IRET
   1912 
   1913       RETURN
   1914 
   1915   100 FORMAT('  NO EVENTS WRITTEN')
   1916   101 FORMAT('  EVENTS WRITTEN, NLV,IRET:',2I4)
   1917 
   1918       END


ENTRY POINTS

  Name              
                    
 event_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1915                                                           1884                              
 101                        Label  1916                                                           1911                              
 BMISS                      Scalar 1878     R(8)            8           scalar   COM              1891,1898                         
 BUFRLIB_MISSING            Common 1881                                 8                                                           
 EVENT                      Subr   1875                                                                                             
 EVNSTR                     Dummy  1875     CHAR                        scalar   ARG,INOUT        1910                              
 EVNS_8                     Local  1878     R(8)            8     2     1275                      1891,1899,1900,1901,1902,1903,1910
 I                          Local  1896     I(4)            4           scalar                    1896,1897,1898,1899,1900,1901,1903
 IND                        Dummy  1875     I(4)            4     1     0        ARG,INOUT        1897                              
 IRET                       Local  1910     I(4)            4           scalar                    1910,1911                         
 J                          Local  1897     I(4)            4           scalar                    1897,1899,1900,1901,1902,1903     
 LUNIT                      Dummy  1875     I(4)            4           scalar   ARG,INOUT        1910                              
 MIN                        Func   1898                                 scalar                    1898                              
 NEVN                       Dummy  1875     I(4)            4           scalar   ARG,INOUT        1879,1883,1896                    
 NLV                        Dummy  1875     I(4)            4           scalar   ARG,INOUT        1910,1911                         
 OBS                        Dummy  1875     R(4)            4     2     510      ARG,INOUT        1898,1899,1900                    
 QCPC                       Dummy  1875     R(4)            4           scalar   ARG,INOUT        1902                              
 QMS                        Dummy  1875     R(4)            4     1     0        ARG,INOUT        1901                              
 RCS                        Dummy  1875     R(4)            4     1     0        ARG,INOUT        1903                              
 UFBINT                     Subr   1910                                                           1910                              

Page 57          Source Listing                  EVENT
2017-04-18 11:09                                 profcqc.f

   1919 
   1920 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1921 C
   1922 C SUBPROGRAM:    INCR
   1923 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-20
   1924 C
   1925 C ABSTRACT: CALCULATE FORECAST INCREMENTS, I.E. THE DIFFERENCE 
   1926 C   BETWEEN THE OBSERVED VALUE AND THE FORECAST VALUE (OF THE
   1927 C   WIND COMPONENTS).
   1928 C
   1929 C PROGRAM HISTORY LOG:
   1930 C 1996-11-20  W. Collins -- Original author.
   1931 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   1932 C     per station.
   1933 C
   1934 C USAGE:    CALL INCR
   1935 C   OUTPUT FILES:
   1936 C     UNIT 06  - STANDARD OUTPUT PRINT
   1937 C
   1938 C ATTRIBUTES:
   1939 C   LANGUAGE: FORTRAN 90
   1940 C   MACHINE:  NCEP WCOSS
   1941 C
   1942 C$$$
   1943       SUBROUTINE INCR
   1944 
   1945       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   1946 
   1947       CHARACTER*8  STN
   1948       REAL(8)  BMISS
   1949 
   1950       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   1951      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   1952      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   1953       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   1954      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   1955      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   1956      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   1957      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   1958       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   1959      $ NFIN,NFOUT
   1960       COMMON /QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   1961      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   1962      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   1963       COMMON /STNLST/ STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   1964      $ IRTP(NS)
   1965       COMMON /BUFRLIB_MISSING/BMISS
   1966 
   1967       WRITE(6,100)
   1968 
   1969       DO N=1,NSTN
   1970          DO M=1,NTIMES(N)
   1971             DO L=1,NZZ(N)
   1972 	       IF(MAX(UZ(L,M,N),UFZ(L,M,N)).LT.BMISS) THEN
   1973                   UI(L,M,N) = UZ(L,M,N) - UFZ(L,M,N)
   1974                ELSE
   1975                   UI(L,M,N) = BMISS

Page 58          Source Listing                  INCR
2017-04-18 11:09                                 profcqc.f

   1976                ENDIF
   1977 	       IF(MAX(VZ(L,M,N),VFZ(L,M,N)).LT.BMISS) THEN
   1978                   VI(L,M,N) = VZ(L,M,N) - VFZ(L,M,N)
   1979                ELSE
   1980                   VI(L,M,N) = BMISS
   1981                ENDIF
   1982             ENDDO
   1983          ENDDO
   1984       ENDDO
   1985 
   1986       RETURN
   1987 
   1988   100 FORMAT(//'CALCULATING WIND COMPONENT INCREMENTS'//)
   1989 
   1990       END


ENTRY POINTS

  Name             
                   
 incr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1988                                                           1967                              
 BMISS                      Scalar 1948     R(8)            8           scalar   COM              1972,1975,1977,1980               
 BUFRLIB_MISSING            Common 1965                                 8                                                           
 DIM                        Scalar 1957     R(4)            4     2     15000    COM                                                
 DIT                        Scalar 1956     R(4)            4     2     15000    COM                                                
 DIV                        Scalar 1956     R(4)            4     2     15000    COM                                                
 DT                         Scalar 1961     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 1957     R(4)            4     2     15000    COM                                                
 DTV                        Scalar 1957     R(4)            4     2     15000    COM                                                
 DVM                        Scalar 1957     R(4)            4     2     15000    COM                                                
 DZ                         Scalar 1952     R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 1961     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 1960     I(4)            4     3     1800000  COM                                                
 INCR                       Subr   1943                                                                                             
 IQ                         Scalar 1960     I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 1961     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 1962     I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 1964     I(4)            4     1     120      COM                                                
 JBAD_FLAG                  Scalar 1962     I(4)            4     1     120      COM                                                
 L                          Local  1971     I(4)            4           scalar                    1971,1972,1973,1975,1977,1978,1980
 LEVZ                       Scalar 1952     I(4)            4     3     1800000  COM                                                
 M                          Local  1970     I(4)            4           scalar                    1970,1972,1973,1975,1977,1978,1980
 MAX                        Func   1972                                 scalar                    1972,1977                         
 MLEV                       Scalar 1961     I(4)            4     2     12000    COM                                                
 N                          Local  1969     I(4)            4           scalar                    1969,1970,1971,1972,1973,1975,1977
                                                                                                  ,1978,1980                        
 NCH                        Scalar 1958     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 1959     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 1959     I(4)            4           scalar   COM                                                

Page 59          Source Listing                  INCR
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NI                         Scalar 1955     I(4)            4     2     15000    COM                                                
 NL                         Param  1945     I(4)            4           scalar                    1950,1951,1952,1953,1954,1955,1956
                                                                                                  ,1957,1960,1961,1962              
 NLEV                       Scalar 1958     I(4)            4           scalar   COM                                                
 NM                         Scalar 1955     I(4)            4     2     15000    COM                                                
 NREP                       Scalar 1958     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 1958     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 1958     I(4)            4           scalar   COM                                                
 NS                         Param  1945     I(4)            4           scalar                    1950,1951,1952,1953,1960,1961,1962
                                                                                                  ,1963,1964                        
 NSCAN                      Scalar 1958     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 1958     I(4)            4           scalar   COM              1969                              
 NSTN1                      Scalar 1958     I(4)            4           scalar   COM                                                
 NT                         Param  1945     I(4)            4           scalar                    1950,1951,1952,1953,1954,1955,1956
                                                                                                  ,1957,1960,1961,1962,1963         
 NTIMES                     Scalar 1963     I(4)            4     1     120      COM              1970                              
 NTMP                       Scalar 1955     I(4)            4     2     15000    COM                                                
 NV                         Scalar 1955     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 1961     I(4)            4     1     120      COM              1971                              
 PARAMS                     Common 1958                                 40                                                          
 PROFZ                      Common 1950                                 72000000                                                    
 PZ                         Scalar 1951     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 1960     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 1960                                 43296960                                                    
 QZ                         Scalar 1950     R(4)            4     3     1800000  COM                                                
 RESIDS                     Common 1953                                 15840000                                                    
 STN                        Scalar 1947     CHAR            8     1     120      COM                                                
 STNLST                     Common 1963                                 51360                                                       
 SZ                         Scalar 1951     R(4)            4     3     1800000  COM                                                
 TIM                        Scalar 1963     R(4)            4     2     12000    COM                                                
 UFZ                        Scalar 1951     R(4)            4     3     1800000  COM              1972,1973                         
 UI                         Scalar 1953     R(4)            4     3     1800000  COM              1973,1975                         
 UM                         Scalar 1954     R(4)            4     2     15000    COM                                                
 UT                         Scalar 1953     R(4)            4     2     15000    COM                                                
 UV                         Scalar 1954     R(4)            4     2     15000    COM                                                
 UZ                         Scalar 1950     R(4)            4     3     1800000  COM              1972,1973                         
 VFZ                        Scalar 1951     R(4)            4     3     1800000  COM              1977,1978                         
 VI                         Scalar 1953     R(4)            4     3     1800000  COM              1978,1980                         
 VM                         Scalar 1955     R(4)            4     2     15000    COM                                                
 VT                         Scalar 1953     R(4)            4     2     15000    COM                                                
 VV                         Scalar 1954     R(4)            4     2     15000    COM                                                
 VVI                        Scalar 1954     R(4)            4     2     15000    COM                                                
 VVM                        Scalar 1955     R(4)            4     2     15000    COM                                                
 VVT                        Scalar 1954     R(4)            4     2     15000    COM                                                
 VVV                        Scalar 1954     R(4)            4     2     15000    COM                                                
 VZ                         Scalar 1950     R(4)            4     3     1800000  COM              1977,1978                         
 X                          Scalar 1963     R(4)            4     1     120      COM                                                
 Y                          Scalar 1963     R(4)            4     1     120      COM                                                
 Z0                         Scalar 1963     R(4)            4     1     120      COM                                                
 ZI                         Scalar 1956     R(4)            4     2     15000    COM                                                
 ZM                         Scalar 1956     R(4)            4     2     15000    COM                                                
 ZT                         Scalar 1956     R(4)            4     2     15000    COM                                                
 ZV                         Scalar 1956     R(4)            4     2     15000    COM                                                
 ZZ                         Scalar 1950     R(4)            4     3     1800000  COM                                                

Page 60          Source Listing                  INCR
2017-04-18 11:09                                 profcqc.f

   1991 
   1992 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1993 C
   1994 C SUBPROGRAM:    INDICATE
   1995 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   1996 C
   1997 C ABSTRACT: COMPUTE NORMALIZED RESIDUALS FOR A SINGLE UNIQUE
   1998 C   STATION.
   1999 C
   2000 C PROGRAM HISTORY LOG:
   2001 C 1995-04-05  W. Collins -- Original author.
   2002 C 2004-09-09  D. Keyser  -- Incr., temporal, vert. & median chk error
   2003 C     limits now directly assoc. w/ a rpted hgt above ground lvl rather
   2004 C     than w/ lvl index in arrays (ensures proper error limit used at
   2005 C     all lvls & eliminates hgt above ground vs. hgt above sea lvl
   2006 C     discrepancy - error limits values remain unchanged).
   2007 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   2008 C     per station.
   2009 C
   2010 C USAGE:    CALL INDICATE(IS)
   2011 C   INPUT ARGUMENT LIST:
   2012 C     IS       - STATION INDEX
   2013 C
   2014 C REMARKS: 
   2015 C   VARIABLE NAMES:
   2016 C     VVI      - VECTOR INCREMENT
   2017 C     VVT      - VECTOR TEMPORAL RESIDUAL
   2018 C     VVV      - VECTOR VERTICAL RESIDUAL
   2019 C     VVM      - VECTOR MEDIAN RESIDUAL
   2020 C     NI       - NORMALIZED VECTOR INCREMENT
   2021 C     NTMP     - NORMALIZED VECTOR TEMPORAL RESIDUAL
   2022 C     NV       - NORMALIZED VECTOR VERTICAL RESIDUAL
   2023 C     NM       - NORMALIZED MEDIAN RESIDUAL
   2024 C     ZI       - NORMALIZED VECTOR INCREMENT
   2025 C     ZT       - NORMALIZED VECTOR TEMPORAL RESIDUAL
   2026 C     ZV       - NORMALIZED VECTOR VERTICAL RESIDUAL
   2027 C     ZM       - NORMALIZED VECTOR MEDIAN RESIDUAL
   2028 C
   2029 C ATTRIBUTES:
   2030 C   LANGUAGE: FORTRAN 90
   2031 C   MACHINE:  NCEP WCOSS
   2032 C        
   2033 C$$$
   2034       SUBROUTINE INDICATE(IS)
   2035 
   2036       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   2037 
   2038       CHARACTER*8  STN
   2039       REAL(8)  BMISS
   2040 
   2041       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   2042      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   2043      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   2044       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   2045      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   2046      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   2047      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),

Page 61          Source Listing                  INDICATE
2017-04-18 11:09                                 profcqc.f

   2048      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   2049       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   2050      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   2051      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   2052       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   2053      $ NFIN,NFOUT
   2054       COMMON/LIMITS/XI(9125),XT(15750),XV(15750)
   2055       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   2056      $ IRTP(NS)
   2057       COMMON /BUFRLIB_MISSING/BMISS
   2058 
   2059       XM(XIZ,XTZ,XVZ) = SQRT((XIZ**2+XTZ**2+XVZ**2)/3.)
   2060 
   2061 C     SET INDICATORS.
   2062 C     A VALUE OF 2 CORRESPONDS TO 1.0 STANDARD DEVIATION.
   2063 C     VALUES ARE CAPPED AT 20.
   2064 
   2065       DO N=1,NTIMES(IS)
   2066         DO L=1,NZZ(IS)
   2067 
   2068           XIZ = 3.80
   2069           XTZ = 2.00
   2070           XVZ = 3.00
   2071           IF(NINT(ZZ(L,N,IS)-Z0(IS)).LT.15751) THEN
   2072             XTZ = XT(NINT(ZZ(L,N,IS)-Z0(IS)))
   2073             XVZ = XV(NINT(ZZ(L,N,IS)-Z0(IS)))
   2074             IF(NINT(ZZ(L,N,IS)-Z0(IS)).LT.9126) THEN
   2075               XIZ = XI(NINT(ZZ(L,N,IS)-Z0(IS)))
   2076             ENDIF
   2077           ENDIF
   2078           IF(VVI(L,N).LT.BMISS) THEN
   2079             NI(L,N) = VVI(L,N)/(0.5*XIZ)
   2080             ZI(L,N) = VVI(L,N)/XIZ
   2081           ELSE
   2082             NI(L,N) = -1
   2083             ZI(L,N) = BMISS
   2084           ENDIF
   2085           NI(L,N) = MIN(NI(L,N),20)
   2086 	
   2087           IF(VVT(L,N).LT.BMISS) THEN
   2088             NTMP(L,N) = VVT(L,N)/(0.5*XTZ)
   2089             ZT(L,N) = VVT(L,N)/XTZ
   2090           ELSE
   2091             NTMP(L,N) = -1
   2092             ZT(L,N) = BMISS
   2093           ENDIF
   2094           NTMP(L,N) = MIN(NTMP(L,N),20)
   2095 	
   2096           IF(VVV(L,N).LT.BMISS) THEN
   2097             NV(L,N) = VVV(L,N)/(0.5*XVZ)
   2098             ZV(L,N) = VVV(L,N)/XVZ
   2099           ELSE
   2100             NV(L,N) = -1
   2101             ZV(L,N) = BMISS
   2102           ENDIF
   2103           NV(L,N) = MIN(NV(L,N),20)
   2104 	

Page 62          Source Listing                  INDICATE
2017-04-18 11:09                                 profcqc.f

   2105           IF(VVM(L,N).LT.BMISS) THEN
   2106             NM(L,N) = VVM(L,N)/(0.5*XM(XIZ,XTZ,XVZ))
   2107             ZM(L,N) = VVM(L,N)/XM(XIZ,XTZ,XVZ)
   2108           ELSE
   2109             NM(L,N) = -1
   2110             ZM(L,N) = BMISS
   2111           ENDIF
   2112           NM(L,N) = MIN(NM(L,N),20)
   2113 	
   2114         ENDDO
   2115       ENDDO
   2116 
   2117       RETURN
   2118 
   2119       END


ENTRY POINTS

  Name                 
                       
 indicate_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 2039     R(8)            8           scalar   COM              2078,2083,2087,2092,2096,2101,2105
                                                                                                  ,2110                             
 BUFRLIB_MISSING            Common 2057                                 8                                                           
 DIM                        Scalar 2048     R(4)            4     2     15000    COM                                                
 DIT                        Scalar 2047     R(4)            4     2     15000    COM                                                
 DIV                        Scalar 2047     R(4)            4     2     15000    COM                                                
 DT                         Scalar 2050     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 2048     R(4)            4     2     15000    COM                                                
 DTV                        Scalar 2048     R(4)            4     2     15000    COM                                                
 DVM                        Scalar 2048     R(4)            4     2     15000    COM                                                
 DZ                         Scalar 2043     R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 2050     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 2049     I(4)            4     3     1800000  COM                                                
 INDICATE                   Subr   2034                                                                                             
 IQ                         Scalar 2049     I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 2050     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 2051     I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 2056     I(4)            4     1     120      COM                                                
 IS                         Dummy  2034     I(4)            4           scalar   ARG,INOUT        2065,2066,2071,2072,2073,2074,2075
 JBAD_FLAG                  Scalar 2051     I(4)            4     1     120      COM                                                
 L                          Local  2066     I(4)            4           scalar                    2066,2071,2072,2073,2074,2075,2078
                                                                                                  ,2079,2080,2082,2083,2085,2087,208
                                                                                                  8,2089,2091,2092,2094,2096,2097,20
                                                                                                  98,2100,2101,2103,2105,2106,2107,2
                                                                                                  109,2110,2112                     
 LEVZ                       Scalar 2043     I(4)            4     3     1800000  COM                                                
 LIMITS                     Common 2054                                 162500                                                      
 MIN                        Func   2085                                 scalar                    2085,2094,2103,2112               
 MLEV                       Scalar 2050     I(4)            4     2     12000    COM                                                

Page 63          Source Listing                  INDICATE
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 N                          Local  2065     I(4)            4           scalar                    2065,2071,2072,2073,2074,2075,2078
                                                                                                  ,2079,2080,2082,2083,2085,2087,208
                                                                                                  8,2089,2091,2092,2094,2096,2097,20
                                                                                                  98,2100,2101,2103,2105,2106,2107,2
                                                                                                  109,2110,2112                     
 NCH                        Scalar 2052     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 2053     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 2053     I(4)            4           scalar   COM                                                
 NI                         Scalar 2046     I(4)            4     2     15000    COM              2079,2082,2085                    
 NINT                       Func   2071                                 scalar                    2071,2072,2073,2074,2075          
 NL                         Param  2036     I(4)            4           scalar                    2041,2042,2043,2044,2045,2046,2047
                                                                                                  ,2048,2049,2050,2051              
 NLEV                       Scalar 2052     I(4)            4           scalar   COM                                                
 NM                         Scalar 2046     I(4)            4     2     15000    COM              2106,2109,2112                    
 NREP                       Scalar 2052     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 2052     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 2052     I(4)            4           scalar   COM                                                
 NS                         Param  2036     I(4)            4           scalar                    2041,2042,2043,2044,2049,2050,2051
                                                                                                  ,2055,2056                        
 NSCAN                      Scalar 2052     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 2052     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 2052     I(4)            4           scalar   COM                                                
 NT                         Param  2036     I(4)            4           scalar                    2041,2042,2043,2044,2045,2046,2047
                                                                                                  ,2048,2049,2050,2051,2055         
 NTIMES                     Scalar 2055     I(4)            4     1     120      COM              2065                              
 NTMP                       Scalar 2046     I(4)            4     2     15000    COM              2088,2091,2094                    
 NV                         Scalar 2046     I(4)            4     2     15000    COM              2097,2100,2103                    
 NZZ                        Scalar 2050     I(4)            4     1     120      COM              2066                              
 PARAMS                     Common 2052                                 40                                                          
 PROFZ                      Common 2041                                 72000000                                                    
 PZ                         Scalar 2042     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 2049     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 2049                                 43296960                                                    
 QZ                         Scalar 2041     R(4)            4     3     1800000  COM                                                
 RESIDS                     Common 2044                                 15840000                                                    
 SQRT                       Func   2059                                 scalar                    2059                              
 STN                        Scalar 2038     CHAR            8     1     120      COM                                                
 STNLST                     Common 2055                                 51360                                                       
 SZ                         Scalar 2042     R(4)            4     3     1800000  COM                                                
 TIM                        Scalar 2055     R(4)            4     2     12000    COM                                                
 UFZ                        Scalar 2042     R(4)            4     3     1800000  COM                                                
 UI                         Scalar 2044     R(4)            4     3     1800000  COM                                                
 UM                         Scalar 2045     R(4)            4     2     15000    COM                                                
 UT                         Scalar 2044     R(4)            4     2     15000    COM                                                
 UV                         Scalar 2045     R(4)            4     2     15000    COM                                                
 UZ                         Scalar 2041     R(4)            4     3     1800000  COM                                                
 VFZ                        Scalar 2042     R(4)            4     3     1800000  COM                                                
 VI                         Scalar 2044     R(4)            4     3     1800000  COM                                                
 VM                         Scalar 2046     R(4)            4     2     15000    COM                                                
 VT                         Scalar 2044     R(4)            4     2     15000    COM                                                
 VV                         Scalar 2045     R(4)            4     2     15000    COM                                                
 VVI                        Scalar 2045     R(4)            4     2     15000    COM              2078,2079,2080                    
 VVM                        Scalar 2046     R(4)            4     2     15000    COM              2105,2106,2107                    
 VVT                        Scalar 2045     R(4)            4     2     15000    COM              2087,2088,2089                    
 VVV                        Scalar 2045     R(4)            4     2     15000    COM              2096,2097,2098                    

Page 64          Source Listing                  INDICATE
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VZ                         Scalar 2041     R(4)            4     3     1800000  COM                                                
 X                          Scalar 2055     R(4)            4     1     120      COM                                                
 XI                         Scalar 2054     R(4)            4     1     9125     COM              2075                              
 XIZ                        Local  2068     R(4)            4           scalar                    2068,2075,2079,2080,2106,2107     
 XM                         Local  2059     R(4)            4           scalar                    2106,2107                         
 XT                         Scalar 2054     R(4)            4     1     15750    COM              2072                              
 XTZ                        Local  2069     R(4)            4           scalar                    2069,2072,2088,2089,2106,2107     
 XV                         Scalar 2054     R(4)            4     1     15750    COM              2073                              
 XVZ                        Local  2070     R(4)            4           scalar                    2070,2073,2097,2098,2106,2107     
 Y                          Scalar 2055     R(4)            4     1     120      COM                                                
 Z0                         Scalar 2055     R(4)            4     1     120      COM              2071,2072,2073,2074,2075          
 ZI                         Scalar 2047     R(4)            4     2     15000    COM              2080,2083                         
 ZM                         Scalar 2047     R(4)            4     2     15000    COM              2107,2110                         
 ZT                         Scalar 2047     R(4)            4     2     15000    COM              2089,2092                         
 ZV                         Scalar 2047     R(4)            4     2     15000    COM              2098,2101                         
 ZZ                         Scalar 2041     R(4)            4     3     1800000  COM              2071,2072,2073,2074,2075          

Page 65          Source Listing                  INDICATE
2017-04-18 11:09                                 profcqc.f

   2120 
   2121 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2122 C 
   2123 C SUBPROGRAM:    INIT
   2124 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-20
   2125 C
   2126 C ABSTRACT: INITIALIZES SEVERAL VARIABLES.
   2127 C
   2128 C PROGRAM HISTORY LOG:
   2129 C 1996-11-20  W. Collins -- Original author.
   2130 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   2131 C     per station.
   2132 C
   2133 C USAGE:    CALL INIT
   2134 C
   2135 C ATTRIBUTES:
   2136 C   LANGUAGE: FORTRAN 90
   2137 C   MACHINE:  NCEP WCOSS
   2138 C
   2139 C$$$
   2140 
   2141       SUBROUTINE INIT
   2142 
   2143       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   2144 
   2145       CHARACTER*8 STN
   2146       REAL(8)  BMISS
   2147 
   2148       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   2149      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   2150      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   2151       COMMON/PROFP/ZP(NL,NT,NS),UP(NL,NT,NS),VP(NL,NT,NS),QP(NL,NT,NS),
   2152      $ PP(NL,NT,NS),UFP(NL,NT,NS),VFP(NL,NT,NS),LEVP(NL,NT,NS)
   2153       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   2154      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   2155      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   2156       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   2157      $ IRTP(NS)
   2158       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   2159      $ NFIN,NFOUT
   2160       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   2161      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   2162      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   2163      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   2164      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   2165       COMMON/STATZ/UZS(120,0:24,9,3:8),VZS(120,0:24,9,3:8),
   2166      $ UIS(120,0:24,9,3:8),VIS(120,0:24,9,3:8),UTS(120,0:24,9,3:8),
   2167      $ VTS(120,0:24,9,3:8),UVS(120,0:24,9,3:8),VVS(120,0:24,9,3:8),
   2168      $ VVIS(120,0:24,9,3:8),VVTS(120,0:24,9,3:8),VVVS(120,0:24,9,3:8),
   2169      $ VVMS(120,0:24,9,3:8),UMS(120,0:24,9,3:8),VMS(120,0:24,9,3:8)
   2170       COMMON /BUFRLIB_MISSING/BMISS
   2171 
   2172       ZZ   = BMISS
   2173       UZ   = BMISS
   2174       VZ   = BMISS
   2175       QZ   = BMISS
   2176       PZ   = BMISS

Page 66          Source Listing                  INIT
2017-04-18 11:09                                 profcqc.f

   2177       UFZ  = BMISS
   2178       VFZ  = BMISS
   2179       SZ   = BMISS
   2180       DZ   = BMISS
   2181       LEVZ = 0
   2182 
   2183       ZP   = BMISS
   2184       UP   = BMISS
   2185       VP   = BMISS
   2186       QP   = BMISS
   2187       PP   = BMISS
   2188       UFP  = BMISS
   2189       VFP  = BMISS
   2190       LEVP = 0
   2191 
   2192       STN  = '99999999'
   2193       X    = BMISS
   2194       Y    = BMISS
   2195       Z    = BMISS
   2196       TIM  = BMISS
   2197       NTIMES = 0
   2198 
   2199       UI   = BMISS
   2200       VI   = BMISS
   2201 
   2202       QM   = 0
   2203       IQ   = 99999
   2204       ICQC = 0
   2205       IQCC = 0
   2206 
   2207       IBAD_FLAG = 0
   2208       JBAD_FLAG = 0
   2209 
   2210       IRC = 99999
   2211 
   2212       MLEV = 0
   2213 
   2214       DT   = BMISS
   2215 
   2216       UZS  = 0
   2217       VZS  = 0
   2218       UIS  = 0
   2219       VIS  = 0
   2220       UTS  = 0
   2221       VTS  = 0
   2222       UVS  = 0
   2223       VVS  = 0
   2224       VVIS = 0
   2225       VVTS = 0
   2226       VVVS = 0
   2227       VVMS = 0
   2228       UMS  = 0
   2229       VMS  = 0
   2230 
   2231       RETURN
   2232 
   2233       END

Page 67          Source Listing                  INIT
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name             
                   
 init_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 2146     R(8)            8           scalar   COM              2172,2173,2174,2175,2176,2177,2178
                                                                                                  ,2179,2180,2183,2184,2185,2186,218
                                                                                                  7,2188,2189,2193,2194,2195,2196,21
                                                                                                  99,2200,2214                      
 BUFRLIB_MISSING            Common 2170                                 8                                                           
 DIM                        Scalar 2164     R(4)            4     2     15000    COM                                                
 DIT                        Scalar 2163     R(4)            4     2     15000    COM                                                
 DIV                        Scalar 2163     R(4)            4     2     15000    COM                                                
 DT                         Scalar 2154     R(4)            4     3     1800000  COM              2214                              
 DTM                        Scalar 2164     R(4)            4     2     15000    COM                                                
 DTV                        Scalar 2164     R(4)            4     2     15000    COM                                                
 DVM                        Scalar 2164     R(4)            4     2     15000    COM                                                
 DZ                         Scalar 2150     R(4)            4     3     1800000  COM              2180                              
 IBAD_FLAG                  Scalar 2154     I(4)            4     2     12000    COM              2207                              
 ICQC                       Scalar 2153     I(4)            4     3     1800000  COM              2204                              
 INIT                       Subr   2141                                                                                             
 IQ                         Scalar 2153     I(4)            4     3     1800000  COM              2203                              
 IQCC                       Scalar 2154     I(4)            4     3     1800000  COM              2205                              
 IRC                        Scalar 2155     I(4)            4     3     1800000  COM              2210                              
 IRTP                       Scalar 2157     I(4)            4     1     120      COM                                                
 JBAD_FLAG                  Scalar 2155     I(4)            4     1     120      COM              2208                              
 LEVP                       Scalar 2152     I(4)            4     3     1800000  COM              2190                              
 LEVZ                       Scalar 2150     I(4)            4     3     1800000  COM              2181                              
 MLEV                       Scalar 2154     I(4)            4     2     12000    COM              2212                              
 NCH                        Scalar 2158     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 2159     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 2159     I(4)            4           scalar   COM                                                
 NI                         Scalar 2162     I(4)            4     2     15000    COM                                                
 NL                         Param  2143     I(4)            4           scalar                    2148,2149,2150,2151,2152,2153,2154
                                                                                                  ,2155,2160,2161,2162,2163,2164    
 NLEV                       Scalar 2158     I(4)            4           scalar   COM                                                
 NM                         Scalar 2162     I(4)            4     2     15000    COM                                                
 NREP                       Scalar 2158     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 2158     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 2158     I(4)            4           scalar   COM                                                
 NS                         Param  2143     I(4)            4           scalar                    2148,2149,2150,2151,2152,2153,2154
                                                                                                  ,2155,2156,2157,2160              
 NSCAN                      Scalar 2158     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 2158     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 2158     I(4)            4           scalar   COM                                                
 NT                         Param  2143     I(4)            4           scalar                    2148,2149,2150,2151,2152,2153,2154
                                                                                                  ,2155,2156,2160,2161,2162,2163,216
                                                                                                  4                                 
 NTIMES                     Scalar 2156     I(4)            4     1     120      COM              2197                              

Page 68          Source Listing                  INIT
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NTMP                       Scalar 2162     I(4)            4     2     15000    COM                                                
 NV                         Scalar 2162     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 2154     I(4)            4     1     120      COM                                                
 PARAMS                     Common 2158                                 40                                                          
 PP                         Scalar 2152     R(4)            4     3     1800000  COM              2187                              
 PROFP                      Common 2151                                 57600000                                                    
 PROFZ                      Common 2148                                 72000000                                                    
 PZ                         Scalar 2149     R(4)            4     3     1800000  COM              2176                              
 QM                         Scalar 2153     R(4)            4     3     1800000  COM              2202                              
 QP                         Scalar 2151     R(4)            4     3     1800000  COM              2186                              
 QUAL                       Common 2153                                 43296960                                                    
 QZ                         Scalar 2148     R(4)            4     3     1800000  COM              2175                              
 RESIDS                     Common 2160                                 15840000                                                    
 STATZ                      Common 2165                                 9072000                                                     
 STN                        Scalar 2145     CHAR            8     1     120      COM              2192                              
 STNLST                     Common 2156                                 51360                                                       
 SZ                         Scalar 2149     R(4)            4     3     1800000  COM              2179                              
 TIM                        Scalar 2156     R(4)            4     2     12000    COM              2196                              
 UFP                        Scalar 2152     R(4)            4     3     1800000  COM              2188                              
 UFZ                        Scalar 2149     R(4)            4     3     1800000  COM              2177                              
 UI                         Scalar 2160     R(4)            4     3     1800000  COM              2199                              
 UIS                        Scalar 2166     R(4)            4     4     162000   COM              2218                              
 UM                         Scalar 2161     R(4)            4     2     15000    COM                                                
 UMS                        Scalar 2169     R(4)            4     4     162000   COM              2228                              
 UP                         Scalar 2151     R(4)            4     3     1800000  COM              2184                              
 UT                         Scalar 2160     R(4)            4     2     15000    COM                                                
 UTS                        Scalar 2166     R(4)            4     4     162000   COM              2220                              
 UV                         Scalar 2161     R(4)            4     2     15000    COM                                                
 UVS                        Scalar 2167     R(4)            4     4     162000   COM              2222                              
 UZ                         Scalar 2148     R(4)            4     3     1800000  COM              2173                              
 UZS                        Scalar 2165     R(4)            4     4     162000   COM              2216                              
 VFP                        Scalar 2152     R(4)            4     3     1800000  COM              2189                              
 VFZ                        Scalar 2149     R(4)            4     3     1800000  COM              2178                              
 VI                         Scalar 2160     R(4)            4     3     1800000  COM              2200                              
 VIS                        Scalar 2166     R(4)            4     4     162000   COM              2219                              
 VM                         Scalar 2162     R(4)            4     2     15000    COM                                                
 VMS                        Scalar 2169     R(4)            4     4     162000   COM              2229                              
 VP                         Scalar 2151     R(4)            4     3     1800000  COM              2185                              
 VT                         Scalar 2160     R(4)            4     2     15000    COM                                                
 VTS                        Scalar 2167     R(4)            4     4     162000   COM              2221                              
 VV                         Scalar 2161     R(4)            4     2     15000    COM                                                
 VVI                        Scalar 2161     R(4)            4     2     15000    COM                                                
 VVIS                       Scalar 2168     R(4)            4     4     162000   COM              2224                              
 VVM                        Scalar 2162     R(4)            4     2     15000    COM                                                
 VVMS                       Scalar 2169     R(4)            4     4     162000   COM              2227                              
 VVS                        Scalar 2167     R(4)            4     4     162000   COM              2223                              
 VVT                        Scalar 2161     R(4)            4     2     15000    COM                                                
 VVTS                       Scalar 2168     R(4)            4     4     162000   COM              2225                              
 VVV                        Scalar 2161     R(4)            4     2     15000    COM                                                
 VVVS                       Scalar 2168     R(4)            4     4     162000   COM              2226                              
 VZ                         Scalar 2148     R(4)            4     3     1800000  COM              2174                              
 VZS                        Scalar 2165     R(4)            4     4     162000   COM              2217                              
 X                          Scalar 2156     R(4)            4     1     120      COM              2193                              
 Y                          Scalar 2156     R(4)            4     1     120      COM              2194                              
 Z                          Local  2195     R(4)            4           scalar                    2195                              

Page 69          Source Listing                  INIT
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 Z0                         Scalar 2156     R(4)            4     1     120      COM                                                
 ZI                         Scalar 2163     R(4)            4     2     15000    COM                                                
 ZM                         Scalar 2163     R(4)            4     2     15000    COM                                                
 ZP                         Scalar 2151     R(4)            4     3     1800000  COM              2183                              
 ZT                         Scalar 2163     R(4)            4     2     15000    COM                                                
 ZV                         Scalar 2163     R(4)            4     2     15000    COM                                                
 ZZ                         Scalar 2148     R(4)            4     3     1800000  COM              2172                              

Page 70          Source Listing                  INIT
2017-04-18 11:09                                 profcqc.f

   2234 
   2235 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2236 C
   2237 C SUBPROGRAM:    ISDONE
   2238 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1996-11-20
   2239 C
   2240 C ABSTRACT: TEST TO SEE IF QUALITY CONTROL IS COMPLETE FOR THIS
   2241 C   STATION.
   2242 C
   2243 C PROGRAM HISTORY LOG:
   2244 C 1996-11-20  W. Collins -- Original author.
   2245 C
   2246 C USAGE:    CALL ISDONE(DONE)
   2247 C   INPUT ARGUMENT LIST:
   2248 C     DONE     - LOGICAL VARIABLE, TRUE WHEN COMPLETE
   2249 C
   2250 C   OUTPUT FILES:
   2251 C     UNIT 06  - STANDARD OUTPUT PRINT
   2252 C
   2253 C ATTRIBUTES:
   2254 C   LANGUAGE: FORTRAN 90
   2255 C   MACHINE:  NCEP WCOSS
   2256 C
   2257 C$$$
   2258 
   2259       SUBROUTINE ISDONE(DONE)
   2260 
   2261       LOGICAL DONE
   2262 
   2263       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   2264      $ NFIN,NFOUT
   2265 
   2266       IF((NSCAN.GT.1 .AND. NCH.EQ.0) .OR. NSCAN.GT.8) THEN
   2267          DONE = .TRUE.
   2268          IF(NCH.EQ.0) THEN
   2269             WRITE(6,100)
   2270          ELSE
   2271             WRITE(6,101)
   2272          ENDIF
   2273       ELSE
   2274          DONE = .FALSE.
   2275          IF(NCH.EQ.0) THEN
   2276             WRITE(6,102)
   2277          ELSE
   2278             WRITE(6,103)
   2279          ENDIF
   2280       ENDIF
   2281 
   2282       RETURN
   2283 
   2284   100 FORMAT('NO Q.M. CHANGES IN THIS SCAN, DONE WITH THIS STN')
   2285   101 FORMAT('HIT LIMIT OF 9 SCANS STILL WITH Q.M. CHANGES, ',
   2286      $ 'DONE WITH THIS STN')
   2287   102 FORMAT('NO Q.M. CHANGES IN THIS SCAN, BUT THIS IS FIRST SCAN, ',
   2288      $ 'SCAN ONCE AGAIN')
   2289   103 FORMAT('SINCE Q.M. CHANGES IN THIS SCAN, SCAN ONCE AGAIN')
   2290 

Page 71          Source Listing                  ISDONE
2017-04-18 11:09                                 profcqc.f

   2291       END


ENTRY POINTS

  Name               
                     
 isdone_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  2284                                                           2269                              
 101                        Label  2285                                                           2271                              
 102                        Label  2287                                                           2276                              
 103                        Label  2289                                                           2278                              
 DONE                       Dummy  2259     L(4)            4           scalar   ARG,INOUT        2267,2274                         
 ISDONE                     Subr   2259                                                                                             
 NCH                        Scalar 2263     I(4)            4           scalar   COM              2266,2268,2275                    
 NFIN                       Scalar 2264     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 2264     I(4)            4           scalar   COM                                                
 NLEV                       Scalar 2263     I(4)            4           scalar   COM                                                
 NREP                       Scalar 2263     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 2263     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 2263     I(4)            4           scalar   COM                                                
 NSCAN                      Scalar 2263     I(4)            4           scalar   COM              2266                              
 NSTN                       Scalar 2263     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 2263     I(4)            4           scalar   COM                                                
 PARAMS                     Common 2263                                 40                                                          

Page 72          Source Listing                  ISDONE
2017-04-18 11:09                                 profcqc.f

   2292 
   2293 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2294 C
   2295 C SUBPROGRAM:    ISORT
   2296 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1994-03-17
   2297 C
   2298 C ABSTRACT: SORT INTEGERS IA ACCORDING TO THE ORDER SPECIFIED BY THE
   2299 C   INDICES IN INDX.
   2300 C
   2301 C PROGRAM HISTORY LOG:
   2302 C 1994-03-17  W. Collins -- Original author.
   2303 C
   2304 C USAGE:    CALL SORT(IA,INDX,N)
   2305 C   INPUT ARGUMENT LIST:
   2306 C     IA       - VARIABLE
   2307 C     INDX     - ORDER FOR REARRANGEMENT OF RA
   2308 C     N        - DIMENSION OF RA
   2309 C
   2310 C   OUTPUT ARGUMENT LIST:
   2311 C     IA       - VARIABLE
   2312 C
   2313 C ATTRIBUTES:
   2314 C   LANGUAGE: FORTRAN 90
   2315 C   MACHINE:  NCEP WCOSS
   2316 C
   2317 C$$$
   2318       SUBROUTINE ISORT(IA,INDX,N)
   2319 
   2320 C     SORT IA ACCORDING TO THE ORDER SPECIFIED BY THE INDICES IN INDX.
   2321 
   2322       INTEGER INDX(*)
   2323       DIMENSION IA(*), IKSP(899)
   2324 
   2325       IKSP(1:N) = IA(1:N)
   2326 
   2327       IA(1:N) = IKSP(INDX(1:N))
   2328 
   2329       RETURN
   2330 
   2331       END

Page 73          Source Listing                  ISORT
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name              
                    
 isort_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IA                         Dummy  2318     I(4)            4     1     0        ARG,INOUT        2325,2327                         
 IKSP                       Local  2323     I(4)            4     1     899                       2325,2327                         
 INDX                       Dummy  2318     I(4)            4     1     0        ARG,INOUT        2327                              
 ISORT                      Subr   2318                                                                                             
 N                          Dummy  2318     I(4)            4           scalar   ARG,INOUT        2325,2327                         

Page 74          Source Listing                  ISORT
2017-04-18 11:09                                 profcqc.f

   2332 
   2333 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2334 C
   2335 C SUBPROGRAM:    MODQUAL
   2336 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-20
   2337 C
   2338 C ABSTRACT: CONVERTS THIS PROGRAM'S DMA INDEX FOR WIND QUALITY
   2339 C   CONTROL FOR SUSPECT OR BAD (1 OR 2, RESP.) TO PREPBUFR
   2340 C   QUALITY MARK FOR SUSPECT OR BAD (3 OR 13, RESP.).  PRE-
   2341 C   EXISTING BAD PREPBUFR QUALITY MARKS ARE HONORED.
   2342 C
   2343 C PROGRAM HISTORY LOG:
   2344 C 1995-04-05  W. Collins -- Original author.
   2345 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   2346 C     per station.
   2347 C
   2348 C USAGE:    CALL MODQUAL(IS)
   2349 C   INPUT ARGUMENT LIST:
   2350 C     IS       - STATION INDEX
   2351 C
   2352 C REMARKS: 
   2353 C   VARIABLE NAMES:
   2354 C     IQ       - PRE-EXISTING PREPBUFR WIND QUALITY MARKS
   2355 C     ICQC     - DMA INDEX FOR WIND QUALITY CONTROL
   2356 C     IQCC     - EITHER 0 IF PRE-EXISTING PREPBUFR WIND QUALITY
   2357 C                MARK NOT CHANGED BY DMA (I.E., NO EVENT), 3 IF
   2358 C                DMA DETERMINES QUALITY IS SUSPECT, OR 13 IF DMA
   2359 C                DETERMINES QUALITY IS BAD
   2360 C
   2361 C
   2362 C ATTRIBUTES:
   2363 C   LANGUAGE: FORTRAN 90
   2364 C   MACHINE:  NCEP WCOSS
   2365 C
   2366 C$$$
   2367       SUBROUTINE MODQUAL(IS)
   2368 
   2369       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   2370 
   2371       CHARACTER*8  STN
   2372 
   2373       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   2374      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   2375      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   2376       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   2377      $ NFIN,NFOUT
   2378       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   2379      $ IRTP(NS)
   2380       COMMON/TIMEO/TIMWIN_E,TIMWIN_L
   2381 
   2382       DO IT=1,NTIMES(IS)
   2383         DO L=1,NZZ(IS)
   2384 
   2385 C Honor pre-exiting PREPBUFR q.m. as follows:
   2386 C  - If it's BAD, then don't use bad or suspect q.m. from this program
   2387 C  - If it's SUSPECT, then don't use suspect q.m. from this program
   2388 C     (do use BAD q.m. from this program, however)

Page 75          Source Listing                  MODQUAL
2017-04-18 11:09                                 profcqc.f

   2389 
   2390           IF(IQ(L,IT,IS).LT.4) THEN
   2391             IF(ICQC(L,IT,IS).EQ.1.AND.IQ(L,IT,IS).LT.3) THEN
   2392                IQCC(L,IT,IS) = 3  ! Suspect
   2393             ELSE IF(ICQC(L,IT,IS).EQ.2) THEN
   2394                IQCC(L,IT,IS) = 13 ! Bad
   2395             ELSE
   2396                IRC(L,IT,IS) = 99999
   2397             ENDIF
   2398           ELSE
   2399             IRC(L,IT,IS) = 99999
   2400           ENDIF
   2401           IF(NINT(TIM(IT,IS)*1000.).LT.NINT(TIMWIN_E*1000.).OR.
   2402      $       NINT(TIM(IT,IS)*1000.).GT.NINT(TIMWIN_L*1000.)) CYCLE
   2403           IF((IQ(L,IT,IS).GT.2.AND.IQ(L,IT,IS).LT.16) .OR.
   2404      $     ICQC(L,IT,IS).GT.0) THEN
   2405             IBAD_FLAG(IT,IS) = 1
   2406             JBAD_FLAG(IS) = 1
   2407           ENDIF
   2408         ENDDO
   2409       ENDDO
   2410 
   2411       RETURN
   2412 
   2413       END


ENTRY POINTS

  Name                
                      
 modqual_             

Page 76          Source Listing                  MODQUAL
2017-04-18 11:09 Symbol Table                    profcqc.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DT                         Scalar 2374     R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 2374     I(4)            4     2     12000    COM              2405                              
 ICQC                       Scalar 2373     I(4)            4     3     1800000  COM              2391,2393,2404                    
 IQ                         Scalar 2373     I(4)            4     3     1800000  COM              2390,2391,2403                    
 IQCC                       Scalar 2374     I(4)            4     3     1800000  COM              2392,2394                         
 IRC                        Scalar 2375     I(4)            4     3     1800000  COM              2396,2399                         
 IRTP                       Scalar 2379     I(4)            4     1     120      COM                                                
 IS                         Dummy  2367     I(4)            4           scalar   ARG,INOUT        2382,2383,2390,2391,2392,2393,2394
                                                                                                  ,2396,2399,2401,2402,2403,2404,240
                                                                                                  5,2406                            
 IT                         Local  2382     I(4)            4           scalar                    2382,2390,2391,2392,2393,2394,2396
                                                                                                  ,2399,2401,2402,2403,2404,2405    
 JBAD_FLAG                  Scalar 2375     I(4)            4     1     120      COM              2406                              
 L                          Local  2383     I(4)            4           scalar                    2383,2390,2391,2392,2393,2394,2396
                                                                                                  ,2399,2403,2404                   
 MLEV                       Scalar 2374     I(4)            4     2     12000    COM                                                
 MODQUAL                    Subr   2367                                                                                             
 NCH                        Scalar 2376     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 2377     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 2377     I(4)            4           scalar   COM                                                
 NINT                       Func   2401                                 scalar                    2401,2402                         
 NL                         Param  2369     I(4)            4           scalar                    2373,2374,2375                    
 NLEV                       Scalar 2376     I(4)            4           scalar   COM                                                
 NREP                       Scalar 2376     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 2376     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 2376     I(4)            4           scalar   COM                                                
 NS                         Param  2369     I(4)            4           scalar                    2373,2374,2375,2378,2379          
 NSCAN                      Scalar 2376     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 2376     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 2376     I(4)            4           scalar   COM                                                
 NT                         Param  2369     I(4)            4           scalar                    2373,2374,2375,2378               
 NTIMES                     Scalar 2378     I(4)            4     1     120      COM              2382                              
 NZZ                        Scalar 2374     I(4)            4     1     120      COM              2383                              
 PARAMS                     Common 2376                                 40                                                          
 QM                         Scalar 2373     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 2373                                 43296960                                                    
 STN                        Scalar 2371     CHAR            8     1     120      COM                                                
 STNLST                     Common 2378                                 51360                                                       
 TIM                        Scalar 2378     R(4)            4     2     12000    COM              2401,2402                         
 TIMEO                      Common 2380                                 8                                                           
 TIMWIN_E                   Scalar 2380     R(4)            4           scalar   COM              2401                              
 TIMWIN_L                   Scalar 2380     R(4)            4           scalar   COM              2402                              
 X                          Scalar 2378     R(4)            4     1     120      COM                                                
 Y                          Scalar 2378     R(4)            4     1     120      COM                                                
 Z0                         Scalar 2378     R(4)            4     1     120      COM                                                

Page 77          Source Listing                  MODQUAL
2017-04-18 11:09                                 profcqc.f

   2414 
   2415 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2416 C
   2417 C SUBPROGRAM:    PLINT
   2418 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1995-04-05
   2419 C
   2420 C ABSTRACT: INTERPOLATE FIN AT (2,2), NOT USING VALUE AT THIS POINT.
   2421 C   INTERPOLATION IS PLANAR LEAST SQUARES FIT TO SURROUNDING DATA.
   2422 C
   2423 C PROGRAM HISTORY LOG:
   2424 C 1995-04-05  W. Collins -- Original author.
   2425 C
   2426 C USAGE:    CALL PLINT(FIN,FUT,BMISS)
   2427 C   INPUT ARGUMENT LIST:
   2428 C     FIN      - INPUT FIELD
   2429 C     BMISS    - VALUE INDICATING MISSING
   2430 C
   2431 C   OUTPUT ARGUMENT LIST:
   2432 C     FUT      - OUTPUT INTERPOLATED VALUE
   2433 C
   2434 C ATTRIBUTES:
   2435 C   LANGUAGE: FORTRAN 90
   2436 C   MACHINE:  NCEP WCOSS
   2437 C
   2438 C$$$
   2439       SUBROUTINE PLINT(FIN,FUT,BMISS)
   2440 
   2441       REAL FIN(3,3),F(9)
   2442       REAL(8) BMISS
   2443       INTEGER IX(9),IY(9)
   2444 
   2445       IPNT = 0
   2446       FSUM = 0.
   2447 
   2448       DO I=1,3
   2449         DO J=1,3
   2450           FSUM = FSUM + ABS(FIN(I,J))
   2451         ENDDO
   2452       ENDDO
   2453       IF(FSUM.LT..01) THEN
   2454         FUT = BMISS
   2455         RETURN
   2456       ENDIF
   2457 
   2458       F  = BMISS
   2459       IX = 99
   2460       IY = 99
   2461 
   2462       DO J=1,3
   2463         DO I=1,3
   2464           IF(I.EQ.2.AND.J.EQ.2) CYCLE
   2465           IF(FIN(I,J).EQ.BMISS) CYCLE
   2466           IPNT = IPNT + 1
   2467           F(IPNT) = FIN(I,J)
   2468           IX(IPNT) = I-2
   2469           IY(IPNT) = J-2
   2470         ENDDO

Page 78          Source Listing                  PLINT
2017-04-18 11:09                                 profcqc.f

   2471       ENDDO
   2472 
   2473       IF(IPNT.GE.4) GOTO 30
   2474 
   2475       IF(IPNT.LE.2) THEN
   2476         FUT = BMISS
   2477         RETURN
   2478       ENDIF
   2479 
   2480       IF((IX(1).EQ.IX(2).AND.IX(2).EQ.IX(3))
   2481      &  .OR.(IY(1).EQ.IY(2).AND.IY(2).EQ.IY(3))) THEN
   2482         FUT = BMISS
   2483         RETURN
   2484       ENDIF
   2485 
   2486    30 CONTINUE
   2487 
   2488       XB  = 0.
   2489       YB  = 0.
   2490       XYB = 0.
   2491       ZYB = 0.
   2492       ZXB = 0.
   2493       YYB = 0.
   2494       XXB = 0.
   2495       ZB  = 0.
   2496 
   2497       DO I=1,IPNT
   2498         XB = XB + IX(I)
   2499         YB = YB + IY(I)
   2500         XXB = XXB + IX(I)**2
   2501         YYB = YYB + IY(I)**2
   2502         XYB = XYB + IX(I)*IY(I)
   2503         ZB = ZB + F(I)
   2504         ZXB = ZXB + F(I)*IX(I)
   2505         ZYB = ZYB + F(I)*IY(I)
   2506       ENDDO
   2507 
   2508       F1=(XB*(XYB*ZYB-YYB*ZXB)-YB*(XXB*ZYB-XYB*ZXB)+ZB*(XXB*YYB-XYB**2))
   2509       F2 = (XB*(XYB*YB-XB*YYB)-YB*(XXB*YB-XB*XYB)+IPNT*(XXB*YYB-XYB**2))
   2510 
   2511       IF(F2.EQ.0.) THEN
   2512         FUT = BMISS
   2513       ELSE
   2514         FUT = F1/F2
   2515       ENDIF
   2516 
   2517       RETURN
   2518 
   2519       END

Page 79          Source Listing                  PLINT
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name              
                    
 plint_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 30                         Label  2486                                                           2473                              
 ABS                        Func   2450                                 scalar                    2450                              
 BMISS                      Dummy  2439     R(8)            8           scalar   ARG,INOUT        2454,2458,2465,2476,2482,2512     
 F                          Local  2441     R(4)            4     1     9                         2458,2467,2503,2504,2505          
 F1                         Local  2508     R(4)            4           scalar                    2508,2514                         
 F2                         Local  2509     R(4)            4           scalar                    2509,2511,2514                    
 FIN                        Dummy  2439     R(4)            4     2     9        ARG,INOUT        2450,2465,2467                    
 FSUM                       Local  2446     R(4)            4           scalar                    2446,2450,2453                    
 FUT                        Dummy  2439     R(4)            4           scalar   ARG,INOUT        2454,2476,2482,2512,2514          
 I                          Local  2448     I(4)            4           scalar                    2448,2450,2463,2464,2465,2467,2468
                                                                                                  ,2497,2498,2499,2500,2501,2502,250
                                                                                                  3,2504,2505                       
 IPNT                       Local  2445     I(4)            4           scalar                    2445,2466,2467,2468,2469,2473,2475
                                                                                                  ,2497,2509                        
 IX                         Local  2443     I(4)            4     1     9                         2459,2468,2480,2498,2500,2502,2504
 IY                         Local  2443     I(4)            4     1     9                         2460,2469,2481,2499,2501,2502,2505
 J                          Local  2449     I(4)            4           scalar                    2449,2450,2462,2464,2465,2467,2469
 PLINT                      Subr   2439                                                                                             
 XB                         Local  2488     R(4)            4           scalar                    2488,2498,2508,2509               
 XXB                        Local  2494     R(4)            4           scalar                    2494,2500,2508,2509               
 XYB                        Local  2490     R(4)            4           scalar                    2490,2502,2508,2509               
 YB                         Local  2489     R(4)            4           scalar                    2489,2499,2508,2509               
 YYB                        Local  2493     R(4)            4           scalar                    2493,2501,2508,2509               
 ZB                         Local  2495     R(4)            4           scalar                    2495,2503,2508                    
 ZXB                        Local  2492     R(4)            4           scalar                    2492,2504,2508                    
 ZYB                        Local  2491     R(4)            4           scalar                    2491,2505,2508                    

Page 80          Source Listing                  PLINT
2017-04-18 11:09                                 profcqc.f

   2520 
   2521 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2522 C
   2523 C SUBPROGRAM:    PRNTDATA
   2524 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   2525 C
   2526 C ABSTRACT: WRITE WIND PROFILER DATA TO VARIOUS UNITS FOR A SINGLE
   2527 C   UNIQUE STATION.
   2528 C
   2529 C PROGRAM HISTORY LOG:
   2530 C 1995-04-05  W. Collins -- Original author.
   2531 C 2004-09-09  D. Keyser  -- Stdout easier to read & more complete. Rpt
   2532 C     lvl info. in various output listings expanded & sorted into bins
   2533 C     containing both all data lvls & only lvls w/ either suspect or
   2534 C     bad q. marks; output written to text files but not incl. in
   2535 C     stdout.
   2536 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   2537 C     per station.
   2538 C
   2539 C USAGE:    CALL PRNTDATA(IS)
   2540 C   INPUT ARGUMENT LIST:
   2541 C     IS       - STATION INDEX
   2542 C
   2543 C   OUTPUT FILES:
   2544 C     UNIT 06  - STANDARD OUTPUT PRINT
   2545 C     UNIT 52  - LISTING (TYPE 1) OF ALL OUTPUT WIND PROFILER LEVELS
   2546 C     UNIT 53  - LISTING (TYPE 2) OF ALL OUTPUT WIND PROFILER LEVELS
   2547 C     UNIT 54  - LISTING (TYPE 1) OF WIND PROFILER LEVELS WITH EVENTS
   2548 C                FROM THIS PROGRAM PLUS PRE-EXISTING PREPBUFR BAD
   2549 C                LEVELS
   2550 C     UNIT 55  - LISTING (TYPE 2) OF WIND PROFILER LEVELS WITH EVENTS
   2551 C                FROM THIS PROGRAM PLUS PRE-EXISTING PREPBUFR BAD
   2552 C                LEVELS
   2553 C
   2554 C ATTRIBUTES:
   2555 C   LANGUAGE: FORTRAN 90
   2556 C   MACHINE:  NCEP WCOSS
   2557 C
   2558 C$$$
   2559       SUBROUTINE PRNTDATA(IS)
   2560 
   2561       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   2562 
   2563       CHARACTER*8  STN
   2564       CHARACTER*1  CEVN
   2565 
   2566       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   2567      $ IRTP(NS)
   2568       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   2569      $ NFIN,NFOUT
   2570       COMMON/DATEZ/JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
   2571       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   2572      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   2573      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   2574       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   2575      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   2576      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),

Page 81          Source Listing                  PRNTDATA
2017-04-18 11:09                                 profcqc.f

   2577      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   2578      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   2579       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   2580      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   2581      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   2582       COMMON/TIMEO/TIMWIN_E,TIMWIN_L
   2583 
   2584       WRITE(52,100) STN(IS)
   2585       WRITE(53,100) STN(IS)
   2586       IF(JBAD_FLAG(IS).EQ.1) THEN
   2587         WRITE(54,101) STN(IS)
   2588         WRITE(55,101) STN(IS)
   2589         WRITE(54,102)
   2590         WRITE(55,103)
   2591       ENDIF
   2592       WRITE(52,102)
   2593       WRITE(53,103)
   2594       DO N=1,NTIMES(IS)
   2595         IF(NINT(TIM(N,IS)*1000.).LT.NINT(TIMWIN_E*1000.).OR.
   2596      $     NINT(TIM(N,IS)*1000.).GT.NINT(TIMWIN_L*1000.)) CYCLE
   2597 
   2598         IF(NZZ(IS).GT.0) THEN
   2599            WRITE(6,104) STN(IS),Z0(IS),(KDATE(J,N,IS),J=1,5)
   2600            WRITE(6,102)
   2601         ELSE
   2602            CYCLE
   2603         ENDIF
   2604 
   2605 C       PRINT TO VARIOUS UNITS AFTER MAKING SURE THAT
   2606 C       THE NUMBERS ARE SMALL ENOUGH TO FIT IN FORMAT.
   2607 
   2608         IW10000 = 0
   2609         IW13000 = 0
   2610         DO I=1,NZZ(IS)
   2611           IF(ZZ(I,N,IS).GT.99999.) CYCLE
   2612           IF(IQ(I,N,IS).GT.3.OR.IQCC(I,N,IS).EQ.0) THEN
   2613              IQCCP = IQ(I,N,IS)
   2614           ELSE
   2615              IQCCP = IQCC(I,N,IS)
   2616           ENDIF
   2617 
   2618           CEVN = ' '
   2619           IF(IQCC(I,N,IS).GT.0) THEN
   2620              CEVN = '+'
   2621           ENDIF
   2622 
   2623 C         WRITE THIS PROGRAM'S EVENTS + PRE-EXISTING PREPBUFR BAD
   2624 C          LEVELS TO UNIT 54 - TYPE 1 LISTING
   2625 
   2626           IF((IQ(I,N,IS).GT.2.AND.IQ(I,N,IS).LT.16) .OR.
   2627      $        ICQC(I,N,IS).GT.0) THEN
   2628             WRITE(54,105) (KDATE(J,N,IS),J=1,5),STN(IS),
   2629      $       NINT(ZZ(I,N,IS)),NINT(SZ(I,N,IS)),NINT(DZ(I,N,IS)),
   2630      $       UZ(I,N,IS),VZ(I,N,IS),UFZ(I,N,IS),VFZ(I,N,IS),UT(I,N),
   2631      $       VT(I,N),UV(I,N),VV(I,N),UM(I,N),VM(I,N),VVI(I,N),VVT(I,N),
   2632      $       VVV(I,N),VVM(I,N),IQ(I,N,IS),NI(I,N),NTMP(I,N),NV(I,N),
   2633      $       NM(I,N),ICQC(I,N,IS),IQCCP,CEVN

Page 82          Source Listing                  PRNTDATA
2017-04-18 11:09                                 profcqc.f

   2634           ENDIF
   2635 
   2636 C         WRITE THIS PROGRAM'S EVENTS + PRE-EXISTING PREPBUFR BAD
   2637 C          LEVELS TO UNIT 55 - TYPE 2 LISTING
   2638 
   2639           IF((IQ(I,N,IS).GT.2.AND.IQ(I,N,IS).LT.16) .OR.
   2640      $       ICQC(I,N,IS).GT.0) THEN
   2641             IF(NINT(ZZ(I,N,IS)).GT.10000.AND.IW10000.EQ.0) THEN
   2642                WRITE(55,106)
   2643                IW10000 = 1
   2644             ENDIF
   2645             IF(NINT(ZZ(I,N,IS)).GE.13000.AND.IW13000.EQ.0) THEN
   2646                WRITE(55,106)
   2647                IW13000 = 1
   2648             ENDIF
   2649             WRITE(55,107) (KDATE(J,N,IS),J=1,5),STN(IS),
   2650      $       NINT(ZZ(I,N,IS)),UZ(I,N,IS),VZ(I,N,IS),UFZ(I,N,IS),
   2651      $       VFZ(I,N,IS), ZI(I,N),ZT(I,N),DT(I,N,IS),ZV(I,N),ZM(I,N),
   2652      $       DIT(I,N),DIV(I,N),DTV(I,N),DIM(I,N),DVM(I,N),DTM(I,N),
   2653      $       IQ(I,N,IS),ICQC(I,N,IS),IQCCP,CEVN,IRC(I,N,IS)
   2654           ENDIF
   2655 
   2656 C         WRITE ALL DATA TO STANDARD OUTPUT (UNIT 06)
   2657 
   2658           WRITE(6,105) (KDATE(J,N,IS),J=1,5),STN(IS),NINT(ZZ(I,N,IS)),
   2659      $      NINT(SZ(I,N,IS)),NINT(DZ(I,N,IS)),UZ(I,N,IS),VZ(I,N,IS),
   2660      $      UFZ(I,N,IS),VFZ(I,N,IS),UT(I,N),VT(I,N),UV(I,N),VV(I,N),
   2661      $      UM(I,N),VM(I,N),VVI(I,N),VVT(I,N),VVV(I,N),VVM(I,N),
   2662      $      IQ(I,N,IS),NI(I,N),NTMP(I,N),NV(I,N),NM(I,N),ICQC(I,N,IS),
   2663      $      IQCCP,CEVN
   2664 
   2665 C         WRITE ALL DATA TO UNIT 52 - TYPE 1 LISTING
   2666 
   2667           WRITE(52,105) (KDATE(J,N,IS),J=1,5),STN(IS),NINT(ZZ(I,N,IS)),
   2668      $     NINT(SZ(I,N,IS)),NINT(DZ(I,N,IS)),UZ(I,N,IS),VZ(I,N,IS),
   2669      $     UFZ(I,N,IS),VFZ(I,N,IS),UT(I,N),VT(I,N),UV(I,N),VV(I,N),
   2670      $     UM(I,N),VM(I,N),VVI(I,N),VVT(I,N),VVV(I,N),VVM(I,N),
   2671      $     IQ(I,N,IS),NI(I,N),NTMP(I,N),NV(I,N),NM(I,N),ICQC(I,N,IS),
   2672      $     IQCCP,CEVN
   2673 
   2674 C         WRITE ALL DATA TO UNIT 53 - TYPE 2 LISTING
   2675 
   2676            WRITE(53,107) (KDATE(J,N,IS),J=1,5),STN(IS),NINT(ZZ(I,N,IS)),
   2677      $      UZ(I,N,IS),VZ(I,N,IS),UFZ(I,N,IS),VFZ(I,N,IS),ZI(I,N),
   2678      $      ZT(I,N),DT(I,N,IS),ZV(I,N),ZM(I,N),DIT(I,N),DIV(I,N),
   2679      $      DTV(I,N),DIM(I,N),DVM(I,N),DTM(I,N),IQ(I,N,IS),ICQC(I,N,IS),
   2680      $      IQCCP,CEVN,IRC(I,N,IS)
   2681         ENDDO
   2682         WRITE(53,108)
   2683         IF(IBAD_FLAG(N,IS).EQ.1) THEN
   2684            WRITE(54,108)
   2685            WRITE(55,108)
   2686         ENDIF
   2687       ENDDO
   2688 
   2689       RETURN
   2690 

Page 83          Source Listing                  PRNTDATA
2017-04-18 11:09                                 profcqc.f

   2691   100 FORMAT(/1X,128('+')/' FINAL LISTING OF ALL LVLS FOR ',A8,'(+ in ',
   2692      $ 'QQ column means this program wrote a q.c. event)')
   2693   101 FORMAT(/1X,128('+')/' FINAL LISTING OF ALL SUSPECT OR BAD LVLS ',
   2694      $ 'FOR ',A8,'(+ in QQ column means this program wrote a q.c. ',
   2695      $ 'event)')
   2696   102 FORMAT('  DATETIME    STN        Z  SP DIR     U     V    UG    ',
   2697      $  'VG   UT   VT   UV   VV   UM   VM  VVI  VVT  VVV  VVM IQ NI NT',
   2698      $ ' NV NM PQ OQ')
   2699   103 FORMAT('  DATETIME    STN        Z     U     V    UG    ',
   2700      $  'VG    ZI    ZT(del-t)    ZV    ZM   DIT   DIV   DTV   DIM   ',
   2701      $ 'DVM   DTM IQ PQ OQ   RC')
   2702   104 FORMAT(' FINAL LISTING OF ALL LVLS FOR ',A8,', ELEV ',F6.1,' AT ',
   2703      $ I4,'/',I2.2,'/',I2.2,'/',I2.2,I2.2,' (+ in QQ column means this',
   2704      $ ' program wrote a q.c. event)')
   2705   105 FORMAT(I4,4I2.2,1X,A8,I5,1X,I3,1X,I3,4(1X,F5.1),10(1X,F4.1),1X,I2,
   2706      $ 4(1X,I2),2(1X,I2),A1)
   2707   106 FORMAT(1X,64('. '))
   2708   107 FORMAT(I4,4I2.2,1X,A8,I5,6(1X,F5.1),'(',F5.2,')',8(1X,F5.1),
   2709      $ 3(1X,I2),A1,1X,I3.3)
   2710   108 FORMAT(1X,128('-'))
   2711 
   2712       END


ENTRY POINTS

  Name                 
                       
 prntdata_             

Page 84          Source Listing                  PRNTDATA
2017-04-18 11:09 Symbol Table                    profcqc.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  2691                                                           2584,2585                         
 101                        Label  2693                                                           2587,2588                         
 102                        Label  2696                                                           2589,2592,2600                    
 103                        Label  2699                                                           2590,2593                         
 104                        Label  2702                                                           2599                              
 105                        Label  2705                                                           2628,2658,2667                    
 106                        Label  2707                                                           2642,2646                         
 107                        Label  2708                                                           2649,2676                         
 108                        Label  2710                                                           2682,2684,2685                    
 CEVN                       Local  2564     CHAR            1           scalar                    2618,2620,2633,2653,2663,2672,2680
 DATEZ                      Common 2570                                 240056                                                      
 DIM                        Scalar 2578     R(4)            4     2     15000    COM              2652,2679                         
 DIT                        Scalar 2577     R(4)            4     2     15000    COM              2652,2678                         
 DIV                        Scalar 2577     R(4)            4     2     15000    COM              2652,2678                         
 DT                         Scalar 2580     R(4)            4     3     1800000  COM              2651,2678                         
 DTM                        Scalar 2578     R(4)            4     2     15000    COM              2652,2679                         
 DTV                        Scalar 2578     R(4)            4     2     15000    COM              2652,2679                         
 DVM                        Scalar 2578     R(4)            4     2     15000    COM              2652,2679                         
 DZ                         Scalar 2573     R(4)            4     3     1800000  COM              2629,2659,2668                    
 I                          Local  2610     I(4)            4           scalar                    2610,2611,2612,2613,2615,2619,2626
                                                                                                  ,2627,2629,2630,2631,2632,2633,263
                                                                                                  9,2640,2641,2645,2650,2651,2652,26
                                                                                                  53,2658,2659,2660,2661,2662,2667,2
                                                                                                  668,2669,2670,2671,2676,2677,2678,
                                                                                                  2679,2680                         
 IBAD_FLAG                  Scalar 2580     I(4)            4     2     12000    COM              2683                              
 ICQC                       Scalar 2579     I(4)            4     3     1800000  COM              2627,2633,2640,2653,2662,2671,2679
 IQ                         Scalar 2579     I(4)            4     3     1800000  COM              2612,2613,2626,2632,2639,2653,2662
                                                                                                  ,2671,2679                        
 IQCC                       Scalar 2580     I(4)            4     3     1800000  COM              2612,2615,2619                    
 IQCCP                      Local  2613     I(4)            4           scalar                    2613,2615,2633,2653,2663,2672,2680
 IRC                        Scalar 2581     I(4)            4     3     1800000  COM              2653,2680                         
 IRTP                       Scalar 2567     I(4)            4     1     120      COM                                                
 IS                         Dummy  2559     I(4)            4           scalar   ARG,INOUT        2584,2585,2586,2587,2588,2594,2595
                                                                                                  ,2596,2598,2599,2610,2611,2612,261
                                                                                                  3,2615,2619,2626,2627,2628,2629,26
                                                                                                  30,2632,2633,2639,2640,2641,2645,2
                                                                                                  649,2650,2651,2653,2658,2659,2660,
                                                                                                  2662,2667,2668,2669,2671,2676,2677
                                                                                                  ,2678,2679,2680,2683              
 IW10000                    Local  2608     I(4)            4           scalar                    2608,2641,2643                    
 IW13000                    Local  2609     I(4)            4           scalar                    2609,2645,2647                    
 J                          Local  2599     I(4)            4           scalar                    2599,2628,2649,2658,2667,2676     
 JBAD_FLAG                  Scalar 2581     I(4)            4     1     120      COM              2586                              
 JDATE                      Scalar 2570     I(4)            4     1     4        COM                                                
 KDATE                      Scalar 2570     I(4)            4     3     60000    COM              2599,2628,2649,2658,2667,2676     
 LEVZ                       Scalar 2573     I(4)            4     3     1800000  COM                                                
 MDATE                      Scalar 2570     I(4)            4     1     5        COM                                                
 MLEV                       Scalar 2580     I(4)            4     2     12000    COM                                                
 N                          Local  2594     I(4)            4           scalar                    2594,2595,2596,2599,2611,2612,2613
                                                                                                  ,2615,2619,2626,2627,2628,2629,263

Page 85          Source Listing                  PRNTDATA
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  0,2631,2632,2633,2639,2640,2641,26
                                                                                                  45,2649,2650,2651,2652,2653,2658,2
                                                                                                  659,2660,2661,2662,2667,2668,2669,
                                                                                                  2670,2671,2676,2677,2678,2679,2680
                                                                                                  ,2683                             
 NCH                        Scalar 2568     I(4)            4           scalar   COM                                                
 NDATE                      Scalar 2570     I(4)            4     1     5        COM                                                
 NFIN                       Scalar 2569     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 2569     I(4)            4           scalar   COM                                                
 NI                         Scalar 2576     I(4)            4     2     15000    COM              2632,2662,2671                    
 NINT                       Func   2595                                 scalar                    2595,2596,2629,2641,2645,2650,2658
                                                                                                  ,2659,2667,2668,2676              
 NL                         Param  2561     I(4)            4           scalar                    2571,2572,2573,2574,2575,2576,2577
                                                                                                  ,2578,2579,2580,2581              
 NLEV                       Scalar 2568     I(4)            4           scalar   COM                                                
 NM                         Scalar 2576     I(4)            4     2     15000    COM              2633,2662,2671                    
 NREP                       Scalar 2568     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 2568     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 2568     I(4)            4           scalar   COM                                                
 NS                         Param  2561     I(4)            4           scalar                    2566,2567,2570,2571,2572,2573,2574
                                                                                                  ,2579,2580,2581                   
 NSCAN                      Scalar 2568     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 2568     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 2568     I(4)            4           scalar   COM                                                
 NT                         Param  2561     I(4)            4           scalar                    2566,2570,2571,2572,2573,2574,2575
                                                                                                  ,2576,2577,2578,2579,2580,2581    
 NTIMES                     Scalar 2566     I(4)            4     1     120      COM              2594                              
 NTMP                       Scalar 2576     I(4)            4     2     15000    COM              2632,2662,2671                    
 NV                         Scalar 2576     I(4)            4     2     15000    COM              2632,2662,2671                    
 NZZ                        Scalar 2580     I(4)            4     1     120      COM              2598,2610                         
 PARAMS                     Common 2568                                 40                                                          
 PRNTDATA                   Subr   2559                                                                                             
 PROFZ                      Common 2571                                 72000000                                                    
 PZ                         Scalar 2572     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 2579     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 2579                                 43296960                                                    
 QZ                         Scalar 2571     R(4)            4     3     1800000  COM                                                
 RESIDS                     Common 2574                                 15840000                                                    
 STN                        Scalar 2563     CHAR            8     1     120      COM              2584,2585,2587,2588,2599,2628,2649
                                                                                                  ,2658,2667,2676                   
 STNLST                     Common 2566                                 51360                                                       
 SZ                         Scalar 2572     R(4)            4     3     1800000  COM              2629,2659,2668                    
 TIM                        Scalar 2566     R(4)            4     2     12000    COM              2595,2596                         
 TIMEO                      Common 2582                                 8                                                           
 TIMWIN_E                   Scalar 2582     R(4)            4           scalar   COM              2595                              
 TIMWIN_L                   Scalar 2582     R(4)            4           scalar   COM              2596                              
 UFZ                        Scalar 2572     R(4)            4     3     1800000  COM              2630,2650,2660,2669,2677          
 UI                         Scalar 2574     R(4)            4     3     1800000  COM                                                
 UM                         Scalar 2575     R(4)            4     2     15000    COM              2631,2661,2670                    
 UT                         Scalar 2574     R(4)            4     2     15000    COM              2630,2660,2669                    
 UV                         Scalar 2575     R(4)            4     2     15000    COM              2631,2660,2669                    
 UZ                         Scalar 2571     R(4)            4     3     1800000  COM              2630,2650,2659,2668,2677          
 VFZ                        Scalar 2572     R(4)            4     3     1800000  COM              2630,2651,2660,2669,2677          
 VI                         Scalar 2574     R(4)            4     3     1800000  COM                                                
 VM                         Scalar 2576     R(4)            4     2     15000    COM              2631,2661,2670                    

Page 86          Source Listing                  PRNTDATA
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VT                         Scalar 2574     R(4)            4     2     15000    COM              2631,2660,2669                    
 VV                         Scalar 2575     R(4)            4     2     15000    COM              2631,2660,2669                    
 VVI                        Scalar 2575     R(4)            4     2     15000    COM              2631,2661,2670                    
 VVM                        Scalar 2576     R(4)            4     2     15000    COM              2632,2661,2670                    
 VVT                        Scalar 2575     R(4)            4     2     15000    COM              2631,2661,2670                    
 VVV                        Scalar 2575     R(4)            4     2     15000    COM              2632,2661,2670                    
 VZ                         Scalar 2571     R(4)            4     3     1800000  COM              2630,2650,2659,2668,2677          
 X                          Scalar 2566     R(4)            4     1     120      COM                                                
 Y                          Scalar 2566     R(4)            4     1     120      COM                                                
 Z0                         Scalar 2566     R(4)            4     1     120      COM              2599                              
 ZI                         Scalar 2577     R(4)            4     2     15000    COM              2651,2677                         
 ZM                         Scalar 2577     R(4)            4     2     15000    COM              2651,2678                         
 ZT                         Scalar 2577     R(4)            4     2     15000    COM              2651,2678                         
 ZV                         Scalar 2577     R(4)            4     2     15000    COM              2651,2678                         
 ZZ                         Scalar 2571     R(4)            4     3     1800000  COM              2611,2629,2641,2645,2650,2658,2667
                                                                                                  ,2676                             

Page 87          Source Listing                  PRNTDATA
2017-04-18 11:09                                 profcqc.f

   2713 
   2714 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2715 C
   2716 C SUBPROGRAM:    PUTDATA
   2717 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   2718 C
   2719 C ABSTRACT: PLACE DATA FOR A SINGLE REPORT INTO COMMON BLOCKS FOR
   2720 C   USE.  THE ORIGINAL REPORTED LEVELS ARE SPLIT FROM THE AUXILIARY
   2721 C   LEVELS OPTIONALLY ADDED BY THE PREVIOUS PREPOBS_PREPDATA PROGRAM.
   2722 C   ONLY THE ORIGINAL REPORTED LEVELS ARE QC'D AND THE QUALITY OF THE
   2723 C   AUXILIARY LEVELS IS IMPLIED.
   2724 C
   2725 C PROGRAM HISTORY LOG:
   2726 C 1996-11-20  W. Collins -- Original author.
   2727 C 1998-09-16  W. COLLINS -- Use W3LIB routine W3MOVDAT for date
   2728 C     change computation.
   2729 C 2004-09-09  D. Keyser  -- Max. no. of sites processed incr. from 40
   2730 C     to 120. No. of time periods input now site specific (was
   2731 C     hardwired to be same for all rpts).
   2732 C 2016-12-20  Stokes/Keyser  Increase the max allowable number of times
   2733 C     per station.  Skip reports and print warning if that limit is 
   2734 C     exceeded.
   2735 C
   2736 C USAGE:    CALL PUTDATA
   2737 C   OUTPUT FILES:
   2738 C     UNIT 06  - STANDARD OUTPUT PRINT
   2739 C
   2740 C ATTRIBUTES:
   2741 C   LANGUAGE: FORTRAN 90
   2742 C   MACHINE:  NCEP WCOSS
   2743 C
   2744 C$$$
   2745 
   2746       SUBROUTINE PUTDATA
   2747 
   2748       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   2749 
   2750       CHARACTER*8  STN,CID,cNT
   2751       REAL  RINC(5)
   2752       REAL(8)  SID_8
   2753       INTEGER  IDAT(8),JDAT(8)
   2754 
   2755       COMMON/DATEZ/JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
   2756       COMMON/HEADER/SID_8,XOB,YOB,DHR,ELV,XTP,TYP,T29,NLV
   2757       COMMON/PROBS/ZOB(255),UOB(255),VOB(255),WQM(255),POB(255),
   2758      $ UFC(255),VFC(255),CAT(255),SOB(255),DOB(255)
   2759       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   2760      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   2761      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   2762       COMMON/PROFP/ZP(NL,NT,NS),UP(NL,NT,NS),VP(NL,NT,NS),QP(NL,NT,NS),
   2763      $ PP(NL,NT,NS),UFP(NL,NT,NS),VFP(NL,NT,NS),LEVP(NL,NT,NS)
   2764       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   2765      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   2766      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   2767       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   2768      $ IRTP(NS)
   2769       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,

Page 88          Source Listing                  PUTDATA
2017-04-18 11:09                                 profcqc.f

   2770      $ NFIN,NFOUT
   2771 
   2772       EQUIVALENCE (SID_8,CID)
   2773 
   2774       data ifirst/0/
   2775 
   2776       NREP1  = NREP1  + 1
   2777 
   2778 C  FIND A STATION MATCH
   2779 C  --------------------
   2780 
   2781       IF(NSTN.GT.0) THEN
   2782          DO NN=1,NSTN
   2783             N = NN
   2784             IF(STN(N).EQ.CID) GOTO 10    ! We have a match
   2785          ENDDO
   2786       ENDIF
   2787 
   2788 C  IF NO MATCH, ADD THIS STATION TO LIST
   2789 C  -------------------------------------
   2790 
   2791       NSTN  = NSTN  + 1
   2792       NSTN1 = NSTN1 + 1
   2793       IF(NSTN1.GT.NS) THEN
   2794          WRITE(6,100) CID,NS
   2795          NSTN = NS
   2796          RETURN
   2797       ENDIF
   2798       N = NSTN
   2799       STN(N)  = CID
   2800       X(N)    = XOB
   2801       Y(N)    = YOB
   2802       Z0(N)   = ELV
   2803       IRTP(N) = NINT(TYP)
   2804 
   2805    10 CONTINUE
   2806 
   2807 C  PRINT WARNING IF NUMBER OF OB TIMES > LIMIT FOR A PARTICULAR STATION
   2808 C  --------------------------------------------------------------------
   2809 
   2810       NTIMES(N) = NTIMES(N) + 1
   2811       IF(NTIMES(N).GT.NT) THEN
   2812          WRITE(6,105) CID,NT,DHR
   2813          NTIMES(N) = NT
   2814          if(ifirst.eq.0) then
   2815             write(cNT,'(i8)') NT
   2816             call system('[ -n "$jlogfile" ] && $DATA/postmsg'//
   2817      $       ' "$jlogfile" "***WARNING: THE NUMBER OF OB TIMES FOR 1'//
   2818      $       ' OR MORE IDs EXCEEDS LIMIT OF '//cNT//', SOME REPORTS '//
   2819      $       'NOT PROCESSED - INCR. SIZE OF NT"')
   2820             ifirst = 1
   2821          endif
   2822          RETURN
   2823       ENDIF
   2824       TIM(NTIMES(N),N) = DHR
   2825 
   2826 cdak  WRITE(6,101) N,CID

Page 89          Source Listing                  PUTDATA
2017-04-18 11:09                                 profcqc.f

   2827 
   2828       NREP  = NREP  + 1
   2829 
   2830       RINC      = 0.
   2831       RINC(2)   = DHR
   2832       IDAT      = 0
   2833       IDAT(1:3) = JDATE(1:3)
   2834       IDAT(5)   = JDATE(4)
   2835 
   2836       CALL W3MOVDAT(RINC,IDAT,JDAT)
   2837 
   2838 C KDATE WILL HOLD REPORT TIME
   2839 
   2840       KDATE(1:3,NTIMES(N),N) = JDAT(1:3)
   2841       KDATE(4:5,NTIMES(N),N) = JDAT(5:6)
   2842 
   2843 C MLEV WILL HOLD NUMBER OF LEVELS
   2844 
   2845       MLEV(NTIMES(N),N) = NLV
   2846 
   2847 C  SEPARATE THE REPORT INTO TWO PARTS, THE ORIGINAL REPORTED LEVELS
   2848 C  (CAT. 4) AND THE OPTIONAL AUXILIARY LEVELS AT 25 MB INTERVALS
   2849 C  (CAT. 7) -- ONLY THE ORIGINAL REPORTED LEVELS WILL BE Q.C.'D
   2850 C  ----------------------------------------------------------------
   2851 
   2852       LP = 0
   2853       DO LZ=1,NLV
   2854          IF(CAT(LZ).EQ.4 .AND. ZOB(LZ).NE.ELV) THEN    ! Reported level
   2855             ZZ(LZ,NTIMES(N),N)   = ZOB(LZ)
   2856             UZ(LZ,NTIMES(N),N)   = UOB(LZ)
   2857             VZ(LZ,NTIMES(N),N)   = VOB(LZ)
   2858             QZ(LZ,NTIMES(N),N)   = WQM(LZ)
   2859             IQ(LZ,NTIMES(N),N)   = NINT(WQM(LZ))
   2860             PZ(LZ,NTIMES(N),N)   = POB(LZ)
   2861             UFZ(LZ,NTIMES(N),N)  = UFC(LZ)
   2862             VFZ(LZ,NTIMES(N),N)  = VFC(LZ)
   2863             SZ(LZ,NTIMES(N),N)   = SOB(LZ)
   2864             DZ(LZ,NTIMES(N),N)   = DOB(LZ)
   2865             LEVZ(LZ,NTIMES(N),N) = LZ
   2866          ELSE IF(CAT(LZ).EQ.7) THEN    ! Auxiliary level
   2867             LP = LP + 1
   2868             ZP(LP,NTIMES(N),N)   = ZOB(LZ)
   2869             UP(LP,NTIMES(N),N)   = UOB(LZ)
   2870             VP(LP,NTIMES(N),N)   = VOB(LZ)
   2871             QP(LP,NTIMES(N),N)   = WQM(LZ)
   2872             PP(LP,NTIMES(N),N)   = POB(LZ)
   2873             UFP(LP,NTIMES(N),N)  = UFC(LZ)
   2874             VFP(LP,NTIMES(N),N)  = VFC(LZ)
   2875             LEVP(LP,NTIMES(N),N) = LZ
   2876          ENDIF
   2877       ENDDO
   2878 
   2879       RETURN
   2880 
   2881   100 FORMAT(/'##PUTDATA: ID ',A8,' CANNOT BE Q.C.-d BECAUSE THE ',
   2882      $ 'NUMBER OF UNIQUE STATIONS EXCEEDS THE LIMIT OF',I4/)
   2883   101 FORMAT(' PUTDATA: N,CID: ',I5,2X,A8)

Page 90          Source Listing                  PUTDATA
2017-04-18 11:09                                 profcqc.f

   2884   105 FORMAT(/'##PUTDATA: THE NUMBER OF OB TIMES FOR ID ',A8,
   2885      $ ' EXCEEDS THE LIMIT OF ',I0,'. SKIP REPORT FOR DHR=',F7.3/)
   2886 
   2887       END


ENTRY POINTS

  Name                
                      
 putdata_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  2805                                                           2784                              
 100                        Label  2881                                                           2794                              
 101                        Label  2883                                                                                             
 105                        Label  2884                                                           2812                              
 CAT                        Scalar 2758     R(4)            4     1     255      COM              2854,2866                         
 CID                        Scalar 2750     CHAR            8           scalar   COM              2784,2794,2799,2812               
 CNT                        Local  2750     CHAR            8           scalar                    2815,2818                         
 DATEZ                      Common 2755                                 240056                                                      
 DHR                        Scalar 2756     R(4)            4           scalar   COM              2812,2824,2831                    
 DOB                        Scalar 2758     R(4)            4     1     255      COM              2864                              
 DT                         Scalar 2765     R(4)            4     3     1800000  COM                                                
 DZ                         Scalar 2761     R(4)            4     3     1800000  COM              2864                              
 ELV                        Scalar 2756     R(4)            4           scalar   COM              2802,2854                         
 HEADER                     Common 2756                                 40                                                          
 IBAD_FLAG                  Scalar 2765     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 2764     I(4)            4     3     1800000  COM                                                
 IDAT                       Local  2753     I(4)            4     1     8                         2832,2833,2834,2836               
 IFIRST                     Local  2774     I(4)            4           scalar                    2774,2814,2820                    
 IQ                         Scalar 2764     I(4)            4     3     1800000  COM              2859                              
 IQCC                       Scalar 2765     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 2766     I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 2768     I(4)            4     1     120      COM              2803                              
 JBAD_FLAG                  Scalar 2766     I(4)            4     1     120      COM                                                
 JDAT                       Local  2753     I(4)            4     1     8                         2836,2840,2841                    
 JDATE                      Scalar 2755     I(4)            4     1     4        COM              2833,2834                         
 KDATE                      Scalar 2755     I(4)            4     3     60000    COM              2840,2841                         
 LEVP                       Scalar 2763     I(4)            4     3     1800000  COM              2875                              
 LEVZ                       Scalar 2761     I(4)            4     3     1800000  COM              2865                              
 LP                         Local  2852     I(4)            4           scalar                    2852,2867,2868,2869,2870,2871,2872
                                                                                                  ,2873,2874,2875                   
 LZ                         Local  2853     I(4)            4           scalar                    2853,2854,2855,2856,2857,2858,2859
                                                                                                  ,2860,2861,2862,2863,2864,2865,286
                                                                                                  6,2868,2869,2870,2871,2872,2873,28
                                                                                                  74,2875                           
 MDATE                      Scalar 2755     I(4)            4     1     5        COM                                                
 MLEV                       Scalar 2765     I(4)            4     2     12000    COM              2845                              
 N                          Local  2783     I(4)            4           scalar                    2783,2784,2798,2799,2800,2801,2802
                                                                                                  ,2803,2810,2811,2813,2824,2840,284
                                                                                                  1,2845,2855,2856,2857,2858,2859,28
                                                                                                  60,2861,2862,2863,2864,2865,2868,2

Page 91          Source Listing                  PUTDATA
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  869,2870,2871,2872,2873,2874,2875 
 NCH                        Scalar 2769     I(4)            4           scalar   COM                                                
 NDATE                      Scalar 2755     I(4)            4     1     5        COM                                                
 NFIN                       Scalar 2770     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 2770     I(4)            4           scalar   COM                                                
 NINT                       Func   2803                                 scalar                    2803,2859                         
 NL                         Param  2748     I(4)            4           scalar                    2759,2760,2761,2762,2763,2764,2765
                                                                                                  ,2766                             
 NLEV                       Scalar 2769     I(4)            4           scalar   COM                                                
 NLV                        Scalar 2756     I(4)            4           scalar   COM              2845,2853                         
 NN                         Local  2782     I(4)            4           scalar                    2782,2783                         
 NREP                       Scalar 2769     I(4)            4           scalar   COM              2828                              
 NREP1                      Scalar 2769     I(4)            4           scalar   COM              2776                              
 NREP_OUT                   Scalar 2769     I(4)            4           scalar   COM                                                
 NS                         Param  2748     I(4)            4           scalar                    2755,2759,2760,2761,2762,2763,2764
                                                                                                  ,2765,2766,2767,2768,2793,2794,279
                                                                                                  5                                 
 NSCAN                      Scalar 2769     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 2769     I(4)            4           scalar   COM              2781,2782,2791,2795,2798          
 NSTN1                      Scalar 2769     I(4)            4           scalar   COM              2792,2793                         
 NT                         Param  2748     I(4)            4           scalar                    2755,2759,2760,2761,2762,2763,2764
                                                                                                  ,2765,2766,2767,2811,2812,2813,281
                                                                                                  5                                 
 NTIMES                     Scalar 2767     I(4)            4     1     120      COM              2810,2811,2813,2824,2840,2841,2845
                                                                                                  ,2855,2856,2857,2858,2859,2860,286
                                                                                                  1,2862,2863,2864,2865,2868,2869,28
                                                                                                  70,2871,2872,2873,2874,2875       
 NZZ                        Scalar 2765     I(4)            4     1     120      COM                                                
 PARAMS                     Common 2769                                 40                                                          
 POB                        Scalar 2757     R(4)            4     1     255      COM              2860,2872                         
 PP                         Scalar 2763     R(4)            4     3     1800000  COM              2872                              
 PROBS                      Common 2757                                 10200                                                       
 PROFP                      Common 2762                                 57600000                                                    
 PROFZ                      Common 2759                                 72000000                                                    
 PUTDATA                    Subr   2746                                                                                             
 PZ                         Scalar 2760     R(4)            4     3     1800000  COM              2860                              
 QM                         Scalar 2764     R(4)            4     3     1800000  COM                                                
 QP                         Scalar 2762     R(4)            4     3     1800000  COM              2871                              
 QUAL                       Common 2764                                 43296960                                                    
 QZ                         Scalar 2759     R(4)            4     3     1800000  COM              2858                              
 RINC                       Local  2751     R(4)            4     1     5                         2830,2831,2836                    
 SID_8                      Scalar 2752     R(8)            8           scalar   COM                                                
 SOB                        Scalar 2758     R(4)            4     1     255      COM              2863                              
 STN                        Scalar 2750     CHAR            8     1     120      COM              2784,2799                         
 STNLST                     Common 2767                                 51360                                                       
 SYSTEM                     Subr   2816                                                           2816                              
 SZ                         Scalar 2760     R(4)            4     3     1800000  COM              2863                              
 T29                        Scalar 2756     R(4)            4           scalar   COM                                                
 TIM                        Scalar 2767     R(4)            4     2     12000    COM              2824                              
 TYP                        Scalar 2756     R(4)            4           scalar   COM              2803                              
 UFC                        Scalar 2758     R(4)            4     1     255      COM              2861,2873                         
 UFP                        Scalar 2763     R(4)            4     3     1800000  COM              2873                              
 UFZ                        Scalar 2760     R(4)            4     3     1800000  COM              2861                              
 UOB                        Scalar 2757     R(4)            4     1     255      COM              2856,2869                         
 UP                         Scalar 2762     R(4)            4     3     1800000  COM              2869                              

Page 92          Source Listing                  PUTDATA
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 UZ                         Scalar 2759     R(4)            4     3     1800000  COM              2856                              
 VFC                        Scalar 2758     R(4)            4     1     255      COM              2862,2874                         
 VFP                        Scalar 2763     R(4)            4     3     1800000  COM              2874                              
 VFZ                        Scalar 2760     R(4)            4     3     1800000  COM              2862                              
 VOB                        Scalar 2757     R(4)            4     1     255      COM              2857,2870                         
 VP                         Scalar 2762     R(4)            4     3     1800000  COM              2870                              
 VZ                         Scalar 2759     R(4)            4     3     1800000  COM              2857                              
 W3MOVDAT                   Subr   2836                                                           2836                              
 WQM                        Scalar 2757     R(4)            4     1     255      COM              2858,2859,2871                    
 X                          Scalar 2767     R(4)            4     1     120      COM              2800                              
 XOB                        Scalar 2756     R(4)            4           scalar   COM              2800                              
 XTP                        Scalar 2756     R(4)            4           scalar   COM                                                
 Y                          Scalar 2767     R(4)            4     1     120      COM              2801                              
 YOB                        Scalar 2756     R(4)            4           scalar   COM              2801                              
 Z0                         Scalar 2767     R(4)            4     1     120      COM              2802                              
 ZOB                        Scalar 2757     R(4)            4     1     255      COM              2854,2855,2868                    
 ZP                         Scalar 2762     R(4)            4     3     1800000  COM              2868                              
 ZZ                         Scalar 2759     R(4)            4     3     1800000  COM              2855                              

Page 93          Source Listing                  PUTDATA
2017-04-18 11:09                                 profcqc.f

   2888 
   2889 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2890 C
   2891 C SUBPROGRAM:    READPROF
   2892 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   2893 C
   2894 C ABSTRACT: READ PROFILER REPORTS FROM THE PREPBUFR FILE AND STORE
   2895 C   INTO MEMORY.
   2896 C
   2897 C PROGRAM HISTORY LOG:
   2898 C 1996-11-20  W. Collins -- Original author.
   2899 C 2004-09-09  D. Keyser  -- Namelist switches added to specify output
   2900 C     time window.
   2901 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   2902 C     per station.
   2903 C
   2904 C USAGE:    CALL READPROF
   2905 C   OUTPUT FILES:
   2906 C     UNIT 06  - STANDARD OUTPUT PRINT
   2907 C
   2908 C ATTRIBUTES:
   2909 C   LANGUAGE: FORTRAN 90
   2910 C   MACHINE:  NCEP WCOSS
   2911 C
   2912 C$$$
   2913 
   2914       SUBROUTINE READPROF
   2915 
   2916       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   2917 
   2918       LOGICAL  FIRST
   2919       CHARACTER*8  SUBSET,CID
   2920       CHARACTER*40  HSTR,OSTR
   2921       REAL  RINC(5)
   2922       REAL(8)  SID_8,HDR_8(10),OBS_8(10,255)
   2923       INTEGER  IDAT(8),JDAT(8)
   2924 
   2925       COMMON/DATEZ /JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
   2926       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   2927      $ NFIN,NFOUT
   2928       COMMON/HEADER/SID_8,XOB,YOB,DHR,ELV,XTP,TYP,T29,NLV
   2929       COMMON/TIMEO/TIMWIN_E,TIMWIN_L
   2930       COMMON/PROBS/ZOB(255),UOB(255),VOB(255),WQM(255),POB(255),
   2931      $ UFC(255),VFC(255),CAT(255),SOB(255),DOB(255)
   2932 
   2933       EQUIVALENCE  (SID_8,CID)
   2934 
   2935       DATA HSTR /'SID XOB YOB DHR ELV ITP TYP T29        '/
   2936       DATA OSTR /'ZOB UOB VOB WQM POB UFC VFC CAT FFO DDO'/
   2937       DATA FIRST /.TRUE./
   2938 
   2939       IF(FIRST) THEN    ! Do several things the first time in here
   2940          CALL DATELEN(10)
   2941          WRITE(6,100) NFIN
   2942          CALL OPENBF(NFIN,'IN',NFIN)
   2943 
   2944    10    CONTINUE

Page 94          Source Listing                  READPROF
2017-04-18 11:09                                 profcqc.f

   2945 
   2946          CALL READMG(NFIN,SUBSET,IDATEP,IRETMG)
   2947          IF(IRETMG.NE.0)   GOTO 999
   2948          IF(SUBSET.NE.'PROFLR  ')  GOTO 10
   2949          WRITE(6,101) IDATEP
   2950          IF(IDATEP.LT.1000000000) THEN
   2951 
   2952 C If 2-digit year returned in IDATEP, must use "windowing" technique
   2953 C  to create a 4-digit year
   2954 
   2955 C IMPORTANT: IF DATELEN(10) IS CALLED, THE DATE HERE SHOULD ALWAYS
   2956 C            CONTAIN A 4-DIGIT YEAR, EVEN IF INPUT FILE IS NOT
   2957 C            Y2K COMPLIANT (BUFRLIB DOES THE WINDOWING HERE)
   2958 
   2959             PRINT *,'##THE FOLLOWING SHOULD NEVER HAPPEN!!!!'
   2960             PRINT'("##2-DIGIT YEAR IN IDATEP RETURNED FROM ",
   2961      $       "READMG (IDATEP IS: ",I0,") - USE WINDOWING TECHNIQUE",
   2962      $       " TO OBTAIN 4-DIGIT YEAR")', IDATEP
   2963             IF(IDATEP/1000000.GT.20) THEN
   2964                IDATEP = 1900000000 + IDATEP
   2965             ELSE
   2966                IDATEP = 2000000000 + IDATEP
   2967             ENDIF
   2968             PRINT *, '##CORRECTED IDATEP WITH 4-DIGIT YEAR, ',
   2969      $       'IDATEP NOW IS: ',IDATEP
   2970          ENDIF
   2971 
   2972 C JDATE WILL HOLD PREPBUFR CENTER TIME
   2973 
   2974          JDATE(1) = IDATEP/1000000
   2975          JDATE(2) = MOD((IDATEP/10000),100)
   2976          JDATE(3) = MOD((IDATEP/100),100)
   2977          JDATE(4) = MOD(IDATEP,100)
   2978 
   2979          RINC      = 0.
   2980          RINC(2)   = TIMWIN_E
   2981          IDAT      = 0
   2982          IDAT(1:3) = JDATE(1:3)
   2983          IDAT(5)   = JDATE(4)
   2984 
   2985          CALL W3MOVDAT(RINC,IDAT,JDAT)
   2986 
   2987 C MDATE WILL HOLD EARLIEST ALLOWED OUTPUT REPORT TIME
   2988 
   2989          MDATE(1:3) = JDAT(1:3)
   2990          MDATE(4:5) = JDAT(5:6)
   2991 
   2992          RINC(2) = TIMWIN_L
   2993 
   2994          CALL W3MOVDAT(RINC,IDAT,JDAT)
   2995 
   2996 C NDATE WILL HOLD LATEST ALLOWED OUTPUT REPORT TIME
   2997 
   2998          NDATE(1:3) = JDAT(1:3)
   2999          NDATE(4:5) = JDAT(5:6)
   3000 
   3001          WRITE(6,102) MDATE,NDATE

Page 95          Source Listing                  READPROF
2017-04-18 11:09                                 profcqc.f

   3002 
   3003          FIRST = .FALSE.
   3004          WRITE(6,103)
   3005          GOTO 20    ! Read in first wind profiler report
   3006       ENDIF
   3007 
   3008    30 CONTINUE
   3009 
   3010       CALL READMG(NFIN,SUBSET,IDATEP,IRET)
   3011       IF(IRET.NE.0) THEN    ! All BUFR messages have been read
   3012          CALL CLOSBF(NFIN)
   3013          WRITE(6,104)  NFIN,NSTN1,NSTN,NREP1,NREP
   3014          RETURN
   3015       ENDIF
   3016       IF(SUBSET.NE.'PROFLR  ') GOTO  30
   3017 
   3018    20 CONTINUE
   3019 
   3020       CALL READSB(NFIN,IRET)
   3021       IF(IRET.NE.0) GOTO 30
   3022 
   3023 C  READ AND STORE HEADER ELEMENTS
   3024 C  ------------------------------
   3025 
   3026       CALL UFBINT(NFIN,HDR_8,10,  1,IRET,HSTR)
   3027       CALL UFBINT(NFIN,OBS_8,10,255,IRET,OSTR)
   3028       SID_8 = HDR_8(1)
   3029       XOB = HDR_8(2)
   3030       YOB = HDR_8(3)
   3031       DHR = HDR_8(4)
   3032       ELV = HDR_8(5)
   3033       XTP = HDR_8(6)
   3034       TYP = HDR_8(7)
   3035       T29 = HDR_8(8)
   3036 
   3037 C  READ DATA OF PROPER SUBSET
   3038 C  --------------------------
   3039 
   3040       CALL UFBINT(NFIN,OBS_8,10,255,NLV,OSTR)
   3041       ZOB(1:NLV) = OBS_8(1,1:NLV)
   3042       UOB(1:NLV) = OBS_8(2,1:NLV)
   3043       VOB(1:NLV) = OBS_8(3,1:NLV)
   3044       WQM(1:NLV) = OBS_8(4,1:NLV)
   3045       POB(1:NLV) = OBS_8(5,1:NLV)
   3046       UFC(1:NLV) = OBS_8(6,1:NLV)
   3047       VFC(1:NLV) = OBS_8(7,1:NLV)
   3048       CAT(1:NLV) = OBS_8(8,1:NLV)
   3049       SOB(1:NLV) = OBS_8(9,1:NLV)
   3050       DOB(1:NLV) = OBS_8(10,1:NLV)
   3051 
   3052       WRITE(6,105) CID,YOB,XOB,DHR,ELV,XTP,TYP,T29,NLV,SUBSET
   3053 
   3054       WRITE(6,106)
   3055       WRITE(6,107) (POB(L),ZOB(L),UOB(L),VOB(L),UFC(L),VFC(L),WQM(L),
   3056      $ CAT(L),SOB(L),DOB(L),L=1,NLV)
   3057 
   3058 C  PUT THE REPORT INTO MEMORY

Page 96          Source Listing                  READPROF
2017-04-18 11:09                                 profcqc.f

   3059 C  -------------------------
   3060 
   3061       CALL PUTDATA
   3062 
   3063       GOTO 20
   3064 
   3065 C-----------------------------------------------------------------------
   3066   999 CONTINUE
   3067 
   3068 C PREPBUFR DATA SET CONTAINS NO "PROFLR" TABLE A MSGS -- STOP 4  !!!
   3069       WRITE(6,108)
   3070       CALL CLOSBF(NFIN)
   3071       CALL W3TAGE('PREPOBS_PROFCQC')
   3072       CALL ERREXIT(4)
   3073 C-----------------------------------------------------------------------
   3074 
   3075   100 FORMAT(/'READING REPORTS FROM INPUT PREPBUFR FILE IN UNIT ',I3)
   3076   101 FORMAT(/'First PROFLR message found ... '/'PREPBUFR File Sec. 1 ',
   3077      $ 'message date = ',I10)
   3078   102 FORMAT(/'Time window for outputting wind profiler reports is:',1X,
   3079      $ I4,4I2.2,' to ',I4,4I2.2/)
   3080   103 FORMAT(/'==> Begin listing of input wind profiler reports'/)
   3081   104 FORMAT(/5X,'===> PREPBUFR DATA SET IN UNIT ',I3,' SUCCESSFULLY',
   3082      $ ' CLOSED FROM INITIAL READ OF WIND PROFILER OBS.'/10X,'THERE ',
   3083      $ 'ARE A TOTAL OF',I4,' UNIQUE WIND PROFILER STATIONS OVER ALL ',
   3084      $ 'TIME PERIODS'/10X,'A TOTAL OF',I4,' UNIQUE STATIONS WERE ',
   3085      $ 'Q.C.-d'/10X,'THE TOTAL NUMBER OF REPORTS UNPACKED WAS',I4/10X,
   3086      $ 'THE TOTAL NUMPER OF REPORTS Q.C.-d WAS',I4/)
   3087   105 FORMAT(/' ID=',A8,' LAT=',F10.2,' LON=',F10.2,' DHR=',F8.2,
   3088      $ ' ELV=',F8.2,' ITYP=',F6.0,' RTYP=',F6.0,' T29=',F6.0,' LVLS=',
   3089      $ I6,' SUBSET=',A8)
   3090   106 FORMAT('       POB       ZOB       UOB       VOB       UFC',
   3091      $       '       VFC       WQM       CAT       SOB       DOB')
   3092   107 FORMAT(F10.1,F10.0,4F10.1,2F10.0,F10.1,F10.0)
   3093   108 FORMAT(/' PREPBUFR DATA SET CONTAINS NO "PROFLR" TABLE A ',
   3094      $ 'MESSAGES - STOP 4'/)
   3095 
   3096       END

Page 97          Source Listing                  READPROF
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name                 
                       
 readprof_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  2944                                                           2948                              
 100                        Label  3075                                                           2941                              
 101                        Label  3076                                                           2949                              
 102                        Label  3078                                                           3001                              
 103                        Label  3080                                                           3004                              
 104                        Label  3081                                                           3013                              
 105                        Label  3087                                                           3052                              
 106                        Label  3090                                                           3054                              
 107                        Label  3092                                                           3055                              
 108                        Label  3093                                                           3069                              
 20                         Label  3018                                                           3005,3063                         
 30                         Label  3008                                                           3016,3021                         
 999                        Label  3066                                                           2947                              
 CAT                        Scalar 2931     R(4)            4     1     255      COM              3048,3056                         
 CID                        Scalar 2919     CHAR            8           scalar   COM              3052                              
 CLOSBF                     Subr   3012                                                           3012,3070                         
 DATELEN                    Subr   2940                                                           2940                              
 DATEZ                      Common 2925                                 240056                                                      
 DHR                        Scalar 2928     R(4)            4           scalar   COM              3031,3052                         
 DOB                        Scalar 2931     R(4)            4     1     255      COM              3050,3056                         
 ELV                        Scalar 2928     R(4)            4           scalar   COM              3032,3052                         
 ERREXIT                    Subr   3072                                                           3072                              
 FIRST                      Local  2918     L(4)            4           scalar                    2937,2939,3003                    
 HDR_8                      Local  2922     R(8)            8     1     10                        3026,3028,3029,3030,3031,3032,3033
                                                                                                  ,3034,3035                        
 HEADER                     Common 2928                                 40                                                          
 HSTR                       Local  2920     CHAR            40          scalar                    2935,3026                         
 IDAT                       Local  2923     I(4)            4     1     8                         2981,2982,2983,2985,2994          
 IDATEP                     Local  2946     I(4)            4           scalar                    2946,2949,2950,2962,2963,2964,2966
                                                                                                  ,2969,2974,2975,2976,2977,3010    
 IRET                       Local  3010     I(4)            4           scalar                    3010,3011,3020,3021,3026,3027     
 IRETMG                     Local  2946     I(4)            4           scalar                    2946,2947                         
 JDAT                       Local  2923     I(4)            4     1     8                         2985,2989,2990,2994,2998,2999     
 JDATE                      Scalar 2925     I(4)            4     1     4        COM              2974,2975,2976,2977,2982,2983     
 KDATE                      Scalar 2925     I(4)            4     3     60000    COM                                                
 L                          Local  3055     I(4)            4           scalar                    3055,3056                         
 MDATE                      Scalar 2925     I(4)            4     1     5        COM              2989,2990,3001                    
 MOD                        Func   2975                                 scalar                    2975,2976,2977                    
 NCH                        Scalar 2926     I(4)            4           scalar   COM                                                
 NDATE                      Scalar 2925     I(4)            4     1     5        COM              2998,2999,3001                    
 NFIN                       Scalar 2927     I(4)            4           scalar   COM              2941,2942,2946,3010,3012,3013,3020
                                                                                                  ,3026,3027,3040,3070              
 NFOUT                      Scalar 2927     I(4)            4           scalar   COM                                                
 NL                         Param  2916     I(4)            4           scalar                                                      

Page 98          Source Listing                  READPROF
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NLEV                       Scalar 2926     I(4)            4           scalar   COM                                                
 NLV                        Scalar 2928     I(4)            4           scalar   COM              3040,3041,3042,3043,3044,3045,3046
                                                                                                  ,3047,3048,3049,3050,3052,3056    
 NREP                       Scalar 2926     I(4)            4           scalar   COM              3013                              
 NREP1                      Scalar 2926     I(4)            4           scalar   COM              3013                              
 NREP_OUT                   Scalar 2926     I(4)            4           scalar   COM                                                
 NS                         Param  2916     I(4)            4           scalar                    2925                              
 NSCAN                      Scalar 2926     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 2926     I(4)            4           scalar   COM              3013                              
 NSTN1                      Scalar 2926     I(4)            4           scalar   COM              3013                              
 NT                         Param  2916     I(4)            4           scalar                    2925                              
 OBS_8                      Local  2922     R(8)            8     2     2550                      3027,3040,3041,3042,3043,3044,3045
                                                                                                  ,3046,3047,3048,3049,3050         
 OPENBF                     Subr   2942                                                           2942                              
 OSTR                       Local  2920     CHAR            40          scalar                    2936,3027,3040                    
 PARAMS                     Common 2926                                 40                                                          
 POB                        Scalar 2930     R(4)            4     1     255      COM              3045,3055                         
 PROBS                      Common 2930                                 10200                                                       
 PUTDATA                    Subr   3061                                                           3061                              
 READMG                     Subr   2946                                                           2946,3010                         
 READPROF                   Subr   2914                                                                                             
 READSB                     Subr   3020                                                           3020                              
 RINC                       Local  2921     R(4)            4     1     5                         2979,2980,2985,2992,2994          
 SID_8                      Scalar 2922     R(8)            8           scalar   COM              3028                              
 SOB                        Scalar 2931     R(4)            4     1     255      COM              3049,3056                         
 SUBSET                     Local  2919     CHAR            8           scalar                    2946,2948,3010,3016,3052          
 T29                        Scalar 2928     R(4)            4           scalar   COM              3035,3052                         
 TIMEO                      Common 2929                                 8                                                           
 TIMWIN_E                   Scalar 2929     R(4)            4           scalar   COM              2980                              
 TIMWIN_L                   Scalar 2929     R(4)            4           scalar   COM              2992                              
 TYP                        Scalar 2928     R(4)            4           scalar   COM              3034,3052                         
 UFBINT                     Subr   3026                                                           3026,3027,3040                    
 UFC                        Scalar 2931     R(4)            4     1     255      COM              3046,3055                         
 UOB                        Scalar 2930     R(4)            4     1     255      COM              3042,3055                         
 VFC                        Scalar 2931     R(4)            4     1     255      COM              3047,3055                         
 VOB                        Scalar 2930     R(4)            4     1     255      COM              3043,3055                         
 W3MOVDAT                   Subr   2985                                                           2985,2994                         
 W3TAGE                     Subr   3071                                                           3071                              
 WQM                        Scalar 2930     R(4)            4     1     255      COM              3044,3055                         
 XOB                        Scalar 2928     R(4)            4           scalar   COM              3029,3052                         
 XTP                        Scalar 2928     R(4)            4           scalar   COM              3033,3052                         
 YOB                        Scalar 2928     R(4)            4           scalar   COM              3030,3052                         
 ZOB                        Scalar 2930     R(4)            4     1     255      COM              3041,3055                         

Page 99          Source Listing                  READPROF
2017-04-18 11:09                                 profcqc.f

   3097 
   3098 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3099 C
   3100 C SUBPROGRAM:    RESIDUAL
   3101 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-20
   3102 C
   3103 C ABSTRACT: CALCULATE ALL RESIDUALS FOR A SINGLE UNIQUE STATION.
   3104 C
   3105 C PROGRAM HISTORY LOG:
   3106 C 1996-11-20  W. Collins -- Original author.
   3107 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   3108 C     per station.
   3109 C
   3110 C USAGE:    CALL RESIDUAL(IS)
   3111 C   INPUT ARGUMENT LIST:
   3112 C     IS       - STATION INDEX
   3113 C
   3114 C
   3115 C ATTRIBUTES:
   3116 C   LANGUAGE: FORTRAN 90
   3117 C   MACHINE:  NCEP WCOSS
   3118 C
   3119 C$$$
   3120 
   3121       SUBROUTINE RESIDUAL(IS)
   3122 
   3123       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   3124 
   3125       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   3126      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   3127      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   3128       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   3129      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   3130      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   3131      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   3132      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   3133       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   3134      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   3135      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   3136       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   3137      $ NFIN,NFOUT
   3138 
   3139 C  PERFORM INCREMENTAL, VERTICAL AND TEMPORAL CHECKS
   3140 C  -------------------------------------------------
   3141 
   3142       CALL CHECKS(IS)
   3143 
   3144 C  PERFORM PLANAR-LINEAR INTERPOLATION, GET RESIDUAL
   3145 C  -------------------------------------------------
   3146 
   3147       CALL TWODIM(IS)
   3148 
   3149       RETURN
   3150 
   3151       END

Page 100         Source Listing                  RESIDUAL
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name                 
                       
 residual_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECKS                     Subr   3142                                                           3142                              
 DIM                        Scalar 3132     R(4)            4     2     15000    COM                                                
 DIT                        Scalar 3131     R(4)            4     2     15000    COM                                                
 DIV                        Scalar 3131     R(4)            4     2     15000    COM                                                
 DT                         Scalar 3134     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 3132     R(4)            4     2     15000    COM                                                
 DTV                        Scalar 3132     R(4)            4     2     15000    COM                                                
 DVM                        Scalar 3132     R(4)            4     2     15000    COM                                                
 DZ                         Scalar 3127     R(4)            4     3     1800000  COM                                                
 IBAD_FLAG                  Scalar 3134     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 3133     I(4)            4     3     1800000  COM                                                
 IQ                         Scalar 3133     I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 3134     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 3135     I(4)            4     3     1800000  COM                                                
 IS                         Dummy  3121     I(4)            4           scalar   ARG,INOUT        3142,3147                         
 JBAD_FLAG                  Scalar 3135     I(4)            4     1     120      COM                                                
 LEVZ                       Scalar 3127     I(4)            4     3     1800000  COM                                                
 MLEV                       Scalar 3134     I(4)            4     2     12000    COM                                                
 NCH                        Scalar 3136     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 3137     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 3137     I(4)            4           scalar   COM                                                
 NI                         Scalar 3130     I(4)            4     2     15000    COM                                                
 NL                         Param  3123     I(4)            4           scalar                    3125,3126,3127,3128,3129,3130,3131
                                                                                                  ,3132,3133,3134,3135              
 NLEV                       Scalar 3136     I(4)            4           scalar   COM                                                
 NM                         Scalar 3130     I(4)            4     2     15000    COM                                                
 NREP                       Scalar 3136     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 3136     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 3136     I(4)            4           scalar   COM                                                
 NS                         Param  3123     I(4)            4           scalar                    3125,3126,3127,3128,3133,3134,3135
 NSCAN                      Scalar 3136     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 3136     I(4)            4           scalar   COM                                                
 NSTN1                      Scalar 3136     I(4)            4           scalar   COM                                                
 NT                         Param  3123     I(4)            4           scalar                    3125,3126,3127,3128,3129,3130,3131
                                                                                                  ,3132,3133,3134,3135              
 NTMP                       Scalar 3130     I(4)            4     2     15000    COM                                                
 NV                         Scalar 3130     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 3134     I(4)            4     1     120      COM                                                
 PARAMS                     Common 3136                                 40                                                          
 PROFZ                      Common 3125                                 72000000                                                    
 PZ                         Scalar 3126     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 3133     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 3133                                 43296960                                                    
 QZ                         Scalar 3125     R(4)            4     3     1800000  COM                                                

Page 101         Source Listing                  RESIDUAL
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RESIDS                     Common 3128                                 15840000                                                    
 RESIDUAL                   Subr   3121                                                                                             
 SZ                         Scalar 3126     R(4)            4     3     1800000  COM                                                
 TWODIM                     Subr   3147                                                           3147                              
 UFZ                        Scalar 3126     R(4)            4     3     1800000  COM                                                
 UI                         Scalar 3128     R(4)            4     3     1800000  COM                                                
 UM                         Scalar 3129     R(4)            4     2     15000    COM                                                
 UT                         Scalar 3128     R(4)            4     2     15000    COM                                                
 UV                         Scalar 3129     R(4)            4     2     15000    COM                                                
 UZ                         Scalar 3125     R(4)            4     3     1800000  COM                                                
 VFZ                        Scalar 3126     R(4)            4     3     1800000  COM                                                
 VI                         Scalar 3128     R(4)            4     3     1800000  COM                                                
 VM                         Scalar 3130     R(4)            4     2     15000    COM                                                
 VT                         Scalar 3128     R(4)            4     2     15000    COM                                                
 VV                         Scalar 3129     R(4)            4     2     15000    COM                                                
 VVI                        Scalar 3129     R(4)            4     2     15000    COM                                                
 VVM                        Scalar 3130     R(4)            4     2     15000    COM                                                
 VVT                        Scalar 3129     R(4)            4     2     15000    COM                                                
 VVV                        Scalar 3129     R(4)            4     2     15000    COM                                                
 VZ                         Scalar 3125     R(4)            4     3     1800000  COM                                                
 ZI                         Scalar 3131     R(4)            4     2     15000    COM                                                
 ZM                         Scalar 3131     R(4)            4     2     15000    COM                                                
 ZT                         Scalar 3131     R(4)            4     2     15000    COM                                                
 ZV                         Scalar 3131     R(4)            4     2     15000    COM                                                
 ZZ                         Scalar 3125     R(4)            4     3     1800000  COM                                                

Page 102         Source Listing                  RESIDUAL
2017-04-18 11:09                                 profcqc.f

   3152 
   3153 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3154 C
   3155 C SUBPROGRAM:    RESTRUCT
   3156 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   3157 C
   3158 C ABSTRACT: VERTICALLY AND TEMPORALLY RESTRUCTURE THE DATA.
   3159 C
   3160 C PROGRAM HISTORY LOG:
   3161 C 2000-12-01  W. Collins -- Original author (vertical restructuring
   3162 C     only).
   3163 C 2004-09-09  D. Keyser  -- Lvl index in all arrays now site specific
   3164 C     to allow proper temporal checking at each individual site (each
   3165 C     site examined over all rpt times to generate hgt profile
   3166 C     containing all possible lvls, times w/ new lvls inserted get
   3167 C     missing wind).
   3168 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   3169 C     per station.
   3170 C
   3171 C USAGE:    CALL RESTRUCT
   3172 C   OUTPUT FILES:
   3173 C     UNIT 06  - STANDARD OUTPUT PRINT
   3174 C
   3175 C ATTRIBUTES:
   3176 C   LANGUAGE: FORTRAN 90
   3177 C   MACHINE:  NCEP WCOSS
   3178 C
   3179 C$$$
   3180 
   3181       SUBROUTINE RESTRUCT
   3182 
   3183       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   3184 
   3185       CHARACTER*8     STN
   3186       REAL(8)  BMISS
   3187 
   3188       REAL  ZZLEV(NL,NS),UZZ(NL,NT,NS),VZZ(NL,NT,NS),QZZ(NL,NT,NS),
   3189      $ PZZ(NL,NT,NS),UFZZ(NL,NT,NS),VFZZ(NL,NT,NS),SZZ(NL,NT,NS),
   3190      $ DZZ(NL,NT,NS),IQZZ(NL,NT,NS),LEVZZ(NL,NT,NS),WKSP(NL,NT,NS),
   3191      $ ZLEV(NL,NT,NS)
   3192       INTEGER  IKSP(NL,NT,NS),JKSP(5,NT,NS),NZ(NT,NS),IV(NL)
   3193 
   3194       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   3195      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   3196      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   3197       COMMON/PROFP/ZP(NL,NT,NS),UP(NL,NT,NS),VP(NL,NT,NS),QP(NL,NT,NS),
   3198      $ PP(NL,NT,NS),UFP(NL,NT,NS),VFP(NL,NT,NS),LEVP(NL,NT,NS)
   3199       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   3200      $ IRTP(NS)
   3201       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   3202      $ NFIN,NFOUT
   3203       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   3204      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   3205      $ JBAD_FLAG(NS),IRC(NL,NT,NS)
   3206       COMMON/DATEZ/JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
   3207       COMMON /BUFRLIB_MISSING/BMISS
   3208 

Page 103         Source Listing                  RESTRUCT
2017-04-18 11:09                                 profcqc.f

   3209       WRITE(6,100)
   3210 
   3211 C  MAKE LIST OF HEIGHTS OF OBSERVATIONS FOR EACH STATION
   3212 C  -----------------------------------------------------
   3213 
   3214       ZLEV = BMISS
   3215       NZ = 0
   3216       LOOP1: DO IS=1,NSTN
   3217          LOOP1n1: DO IT=1,NTIMES(IS)
   3218             LOOP1n2: DO IL=1,MLEV(IT,IS)
   3219                LOOP1n3: DO I=1,MLEV(IT,IS)
   3220                   IF(ZZ(IL,IT,IS).EQ.ZLEV(I,IT,IS)) CYCLE LOOP1n1
   3221                ENDDO  LOOP1n3
   3222                NZ(IT,IS) = NZ(IT,IS) + 1
   3223                ZLEV(NZ(IT,IS),IT,IS) = ZZ(IL,IT,IS)
   3224             ENDDO  LOOP1n2
   3225          ENDDO  LOOP1n1
   3226       ENDDO  LOOP1
   3227 
   3228       ZZLEV = BMISS
   3229       NZZ = 0
   3230       LOOP1x: DO IS=1,NSTN
   3231          LOOP1n1x: DO IT=1,NTIMES(IS)
   3232             LOOP1n2x: DO IL=1,MLEV(IT,IS)
   3233                LOOP1n3x: DO I=1,NZZ(IS)
   3234                   IF(ZZ(IL,IT,IS).EQ.ZZLEV(I,IS)) CYCLE LOOP1n2x
   3235                ENDDO  LOOP1n3x
   3236                NZZ(IS) = NZZ(IS) + 1
   3237                ZZLEV(NZZ(IS),IS) = ZZ(IL,IT,IS)
   3238             ENDDO  LOOP1n2x
   3239          ENDDO  LOOP1n1x
   3240       ENDDO  LOOP1x
   3241 
   3242 C  SORT LIST OF HEIGHTS FOR EACH STATION
   3243 C  -------------------------------------
   3244 
   3245       IREV  = 0
   3246       UZZ   = BMISS
   3247       VZZ   = BMISS
   3248       QZZ   = BMISS
   3249       PZZ   = BMISS
   3250       UFZZ  = BMISS
   3251       VFZZ  = BMISS
   3252       SZZ   = BMISS
   3253       DZZ   = BMISS
   3254       IQZZ  = 99999
   3255       LEVZZ = 0
   3256 
   3257       DO IS=1,NS
   3258          CALL SHELL(ZZLEV(1,IS),IV,NZZ(IS),IREV)
   3259          DO IT=1,NTIMES(IS)
   3260             DO IL=1,MLEV(IT,IS)
   3261                DO ILL=1,NZZ(IS)
   3262                   IF(NINT(ZZ(IL,IT,IS)).EQ.NINT(ZZLEV(ILL,IS))) THEN
   3263                      UZZ(ILL,IT,IS)   = UZ(IL,IT,IS)
   3264                      VZZ(ILL,IT,IS)   = VZ(IL,IT,IS)
   3265                      QZZ(ILL,IT,IS)   = QZ(IL,IT,IS)

Page 104         Source Listing                  RESTRUCT
2017-04-18 11:09                                 profcqc.f

   3266                      PZZ(ILL,IT,IS)   = PZ(IL,IT,IS)
   3267                      UFZZ(ILL,IT,IS)  = UFZ(IL,IT,IS)
   3268                      VFZZ(ILL,IT,IS)  = VFZ(IL,IT,IS)
   3269                      SZZ(ILL,IT,IS)   = SZ(IL,IT,IS)
   3270                      DZZ(ILL,IT,IS)   = DZ(IL,IT,IS)
   3271                      IQZZ(ILL,IT,IS)  = IQ(IL,IT,IS)
   3272                      LEVZZ(ILL,IT,IS) = LEVZ(IL,IT,IS)
   3273                   ENDIF
   3274                ENDDO
   3275             ENDDO
   3276             ZZ(:,IT,IS) = ZZLEV(:,IS)
   3277          ENDDO
   3278       ENDDO
   3279       UZ   = UZZ
   3280       VZ   = VZZ
   3281       QZ   = QZZ
   3282       PZ   = PZZ
   3283       UFZ  = UFZZ
   3284       VFZ  = VFZZ
   3285       SZ   = SZZ
   3286       DZ   = DZZ
   3287       IQ   = IQZZ
   3288       LEVZ = LEVZZ
   3289 
   3290 C  SORT STATIONS BY D-TIME
   3291 C  -----------------------
   3292 
   3293       IREV = 0
   3294       DO I=1,NS
   3295          CALL SHELL(TIM(1,I),IV,NTIMES(I),IREV)
   3296          WKSP = ZZ
   3297          ZZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3298          WKSP = UZ
   3299          UZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3300          WKSP = VZ
   3301          VZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3302          WKSP = QZ
   3303          QZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3304          WKSP = PZ
   3305          PZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3306          WKSP = UFZ
   3307          UFZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3308          WKSP = VFZ
   3309          VFZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3310          WKSP = SZ
   3311          SZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3312          WKSP = DZ
   3313          DZ(:,1:NTIMES(I),I) = WKSP(:,IV(1:NTIMES(I)),I)
   3314          IKSP = LEVZ
   3315          LEVZ(:,1:NTIMES(I),I) = IKSP(:,IV(1:NTIMES(I)),I)
   3316          IKSP = IQ
   3317          IQ(:,1:NTIMES(I),I) = IKSP(:,IV(1:NTIMES(I)),I)
   3318          JKSP = KDATE
   3319          KDATE(:,1:NTIMES(I),I) = JKSP(:,IV(1:NTIMES(I)),I)
   3320       ENDDO
   3321 
   3322       RETURN

Page 105         Source Listing                  RESTRUCT
2017-04-18 11:09                                 profcqc.f

   3323 
   3324   100 FORMAT(//'RESTRUCTURING (SORTING) VERTICAL LEVELS AND TIME ',
   3325      $ 'PERIODS'//)
   3326 
   3327       END


ENTRY POINTS

  Name                 
                       
 restruct_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  3324                                                           3209                              
 BMISS                      Scalar 3186     R(8)            8           scalar   COM              3214,3228,3246,3247,3248,3249,3250
                                                                                                  ,3251,3252,3253                   
 BUFRLIB_MISSING            Common 3207                                 8                                                           
 DATEZ                      Common 3206                                 240056                                                      
 DT                         Scalar 3204     R(4)            4     3     1800000  COM                                                
 DZ                         Scalar 3196     R(4)            4     3     1800000  COM              3270,3286,3312,3313               
 DZZ                        Local  3190     R(4)            4     3     1800000                   3253,3270,3286                    
 I                          Local  3219     I(4)            4           scalar                    3219,3220,3233,3234,3294,3295,3297
                                                                                                  ,3299,3301,3303,3305,3307,3309,331
                                                                                                  1,3313,3315,3317,3319             
 IBAD_FLAG                  Scalar 3204     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 3203     I(4)            4     3     1800000  COM                                                
 IKSP                       Local  3192     I(4)            4     3     1800000                   3314,3315,3316,3317               
 IL                         Local  3218     I(4)            4           scalar                    3218,3220,3223,3232,3234,3237,3260
                                                                                                  ,3262,3263,3264,3265,3266,3267,326
                                                                                                  8,3269,3270,3271,3272             
 ILL                        Local  3261     I(4)            4           scalar                    3261,3262,3263,3264,3265,3266,3267
                                                                                                  ,3268,3269,3270,3271,3272         
 IQ                         Scalar 3203     I(4)            4     3     1800000  COM              3271,3287,3316,3317               
 IQCC                       Scalar 3204     I(4)            4     3     1800000  COM                                                
 IQZZ                       Local  3190     R(4)            4     3     1800000                   3254,3271,3287                    
 IRC                        Scalar 3205     I(4)            4     3     1800000  COM                                                
 IREV                       Local  3245     I(4)            4           scalar                    3245,3258,3293,3295               
 IRTP                       Scalar 3200     I(4)            4     1     120      COM                                                
 IS                         Local  3216     I(4)            4           scalar                    3216,3217,3218,3219,3220,3222,3223
                                                                                                  ,3230,3231,3232,3233,3234,3236,323
                                                                                                  7,3257,3258,3259,3260,3261,3262,32
                                                                                                  63,3264,3265,3266,3267,3268,3269,3
                                                                                                  270,3271,3272,3276                
 IT                         Local  3217     I(4)            4           scalar                    3217,3218,3219,3220,3222,3223,3231
                                                                                                  ,3232,3234,3237,3259,3260,3262,326
                                                                                                  3,3264,3265,3266,3267,3268,3269,32
                                                                                                  70,3271,3272,3276                 
 IV                         Local  3192     I(4)            4     1     150                       3258,3295,3297,3299,3301,3303,3305
                                                                                                  ,3307,3309,3311,3313,3315,3317,331
                                                                                                  9                                 
 JBAD_FLAG                  Scalar 3205     I(4)            4     1     120      COM                                                
 JDATE                      Scalar 3206     I(4)            4     1     4        COM                                                

Page 106         Source Listing                  RESTRUCT
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 JKSP                       Local  3192     I(4)            4     3     60000                     3318,3319                         
 KDATE                      Scalar 3206     I(4)            4     3     60000    COM              3318,3319                         
 LEVP                       Scalar 3198     I(4)            4     3     1800000  COM                                                
 LEVZ                       Scalar 3196     I(4)            4     3     1800000  COM              3272,3288,3314,3315               
 LEVZZ                      Local  3190     R(4)            4     3     1800000                   3255,3272,3288                    
 LOOP1                      Label  3216                                 scalar                    3226                              
 LOOP1N1                    Label  3217                                 scalar                    3220,3225                         
 LOOP1N1X                   Label  3231                                 scalar                    3239                              
 LOOP1N2                    Label  3218                                 scalar                    3224                              
 LOOP1N2X                   Label  3232                                 scalar                    3234,3238                         
 LOOP1N3                    Label  3219                                 scalar                    3221                              
 LOOP1N3X                   Label  3233                                 scalar                    3235                              
 LOOP1X                     Label  3230                                 scalar                    3240                              
 MDATE                      Scalar 3206     I(4)            4     1     5        COM                                                
 MLEV                       Scalar 3204     I(4)            4     2     12000    COM              3218,3219,3232,3260               
 NCH                        Scalar 3201     I(4)            4           scalar   COM                                                
 NDATE                      Scalar 3206     I(4)            4     1     5        COM                                                
 NFIN                       Scalar 3202     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 3202     I(4)            4           scalar   COM                                                
 NINT                       Func   3262                                 scalar                    3262                              
 NL                         Param  3183     I(4)            4           scalar                    3188,3189,3190,3191,3192,3194,3195
                                                                                                  ,3196,3197,3198,3203,3204,3205    
 NLEV                       Scalar 3201     I(4)            4           scalar   COM                                                
 NREP                       Scalar 3201     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 3201     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 3201     I(4)            4           scalar   COM                                                
 NS                         Param  3183     I(4)            4           scalar                    3188,3189,3190,3191,3192,3194,3195
                                                                                                  ,3196,3197,3198,3199,3200,3203,320
                                                                                                  4,3205,3206,3257,3294             
 NSCAN                      Scalar 3201     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 3201     I(4)            4           scalar   COM              3216,3230                         
 NSTN1                      Scalar 3201     I(4)            4           scalar   COM                                                
 NT                         Param  3183     I(4)            4           scalar                    3188,3189,3190,3191,3192,3194,3195
                                                                                                  ,3196,3197,3198,3199,3203,3204,320
                                                                                                  5,3206                            
 NTIMES                     Scalar 3199     I(4)            4     1     120      COM              3217,3231,3259,3295,3297,3299,3301
                                                                                                  ,3303,3305,3307,3309,3311,3313,331
                                                                                                  5,3317,3319                       
 NZ                         Local  3192     I(4)            4     2     12000                     3215,3222,3223                    
 NZZ                        Scalar 3204     I(4)            4     1     120      COM              3229,3233,3236,3237,3258,3261     
 PARAMS                     Common 3201                                 40                                                          
 PP                         Scalar 3198     R(4)            4     3     1800000  COM                                                
 PROFP                      Common 3197                                 57600000                                                    
 PROFZ                      Common 3194                                 72000000                                                    
 PZ                         Scalar 3195     R(4)            4     3     1800000  COM              3266,3282,3304,3305               
 PZZ                        Local  3189     R(4)            4     3     1800000                   3249,3266,3282                    
 QM                         Scalar 3203     R(4)            4     3     1800000  COM                                                
 QP                         Scalar 3197     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 3203                                 43296960                                                    
 QZ                         Scalar 3194     R(4)            4     3     1800000  COM              3265,3281,3302,3303               
 QZZ                        Local  3188     R(4)            4     3     1800000                   3248,3265,3281                    
 RESTRUCT                   Subr   3181                                                                                             
 SHELL                      Subr   3258                                                           3258,3295                         
 STN                        Scalar 3185     CHAR            8     1     120      COM                                                
 STNLST                     Common 3199                                 51360                                                       

Page 107         Source Listing                  RESTRUCT
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SZ                         Scalar 3195     R(4)            4     3     1800000  COM              3269,3285,3310,3311               
 SZZ                        Local  3189     R(4)            4     3     1800000                   3252,3269,3285                    
 TIM                        Scalar 3199     R(4)            4     2     12000    COM              3295                              
 UFP                        Scalar 3198     R(4)            4     3     1800000  COM                                                
 UFZ                        Scalar 3195     R(4)            4     3     1800000  COM              3267,3283,3306,3307               
 UFZZ                       Local  3189     R(4)            4     3     1800000                   3250,3267,3283                    
 UP                         Scalar 3197     R(4)            4     3     1800000  COM                                                
 UZ                         Scalar 3194     R(4)            4     3     1800000  COM              3263,3279,3298,3299               
 UZZ                        Local  3188     R(4)            4     3     1800000                   3246,3263,3279                    
 VFP                        Scalar 3198     R(4)            4     3     1800000  COM                                                
 VFZ                        Scalar 3195     R(4)            4     3     1800000  COM              3268,3284,3308,3309               
 VFZZ                       Local  3189     R(4)            4     3     1800000                   3251,3268,3284                    
 VP                         Scalar 3197     R(4)            4     3     1800000  COM                                                
 VZ                         Scalar 3194     R(4)            4     3     1800000  COM              3264,3280,3300,3301               
 VZZ                        Local  3188     R(4)            4     3     1800000                   3247,3264,3280                    
 WKSP                       Local  3190     R(4)            4     3     1800000                   3296,3297,3298,3299,3300,3301,3302
                                                                                                  ,3303,3304,3305,3306,3307,3308,330
                                                                                                  9,3310,3311,3312,3313             
 X                          Scalar 3199     R(4)            4     1     120      COM                                                
 Y                          Scalar 3199     R(4)            4     1     120      COM                                                
 Z0                         Scalar 3199     R(4)            4     1     120      COM                                                
 ZLEV                       Local  3191     R(4)            4     3     1800000                   3214,3220,3223                    
 ZP                         Scalar 3197     R(4)            4     3     1800000  COM                                                
 ZZ                         Scalar 3194     R(4)            4     3     1800000  COM              3220,3223,3234,3237,3262,3276,3296
                                                                                                  ,3297                             
 ZZLEV                      Local  3188     R(4)            4     2     18000                     3228,3234,3237,3258,3262,3276     

Page 108         Source Listing                  RESTRUCT
2017-04-18 11:09                                 profcqc.f

   3328 
   3329 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3330 C
   3331 C SUBPROGRAM:    SHELL
   3332 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1991-12-24
   3333 C
   3334 C ABSTRACT: SHELL SORT, BASED UPON THE VALUES OF V.  IV IS THE
   3335 C   ORIGINAL INDEX OF EACH ELEMENT OF V.
   3336 C
   3337 C PROGRAM HISTORY LOG:
   3338 C 1991-12-24  W. COLLINS -- Original author.
   3339 C
   3340 C USAGE:    CALL SHELL(V,IV,MAX,IREV)
   3341 C   INPUT ARGUMENT LIST:
   3342 C     V        - VARIABLE
   3343 C     MAX      - DIMENSION OF V
   3344 C     IREV     = 0 FOR ASCENDING ORDER
   3345 C              > or < 0 FOR DESCENDING ORDER
   3346 C
   3347 C   OUTPUT ARGUMENT LIST:
   3348 C     IV       - ORIGINAL INDEX OF VARIABLE
   3349 C     V        - VARIABLE, SORTED
   3350 C
   3351 C ATTRIBUTES:
   3352 C   LANGUAGE: FORTRAN 90
   3353 C   MACHINE:  NCEP WCOSS
   3354 C
   3355 C$$$
   3356       SUBROUTINE SHELL(V,IV,MAX,IREV)
   3357 
   3358       REAL V(*)
   3359       INTEGER IV(*)
   3360 
   3361       DO I=1,MAX
   3362         IV(I) = I
   3363       ENDDO
   3364 
   3365       IOFSET = MAX/2
   3366 
   3367    20 CONTINUE
   3368 
   3369       LIM = MAX - IOFSET
   3370 
   3371    30 CONTINUE
   3372 
   3373       ISW = 0
   3374       DO I=1,LIM
   3375         IF(V(I).GT.V(I+IOFSET)) THEN
   3376           VT = V(I)
   3377           V(I) = V(I+IOFSET)
   3378           V(I+IOFSET) = VT
   3379           IVT = IV(I)
   3380           IV(I) = IV(I+IOFSET)
   3381           IV(I+IOFSET) = IVT
   3382           ISW = I
   3383         ENDIF
   3384       ENDDO

Page 109         Source Listing                  SHELL
2017-04-18 11:09                                 profcqc.f

   3385       LIM = ISW - IOFSET
   3386       IF(ISW.NE.0) GOTO 30
   3387       IOFSET = IOFSET/2
   3388       IF(IOFSET.GT.0) GOTO 20
   3389 
   3390       IF(IREV.NE.0) THEN
   3391 C        REVERSE SORT ORDER...
   3392          NH = MAX/2
   3393          DO I=1,NH
   3394             ITEMP = IV(I)
   3395             IV(I) = IV(MAX+1-I)
   3396             IV(MAX+1-I) = ITEMP
   3397             TEMP = V(I)
   3398             V(I) = V(MAX+1-I)
   3399             V(MAX+1-I) = TEMP
   3400          ENDDO
   3401       ENDIF
   3402 
   3403       RETURN
   3404 
   3405       END


ENTRY POINTS

  Name              
                    
 shell_             

Page 110         Source Listing                  SHELL
2017-04-18 11:09 Symbol Table                    profcqc.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  3367                                                           3388                              
 30                         Label  3371                                                           3386                              
 I                          Local  3361     I(4)            4           scalar                    3361,3362,3374,3375,3376,3377,3378
                                                                                                  ,3379,3380,3381,3382,3393,3394,339
                                                                                                  5,3396,3397,3398,3399             
 IOFSET                     Local  3365     I(4)            4           scalar                    3365,3369,3375,3377,3378,3380,3381
                                                                                                  ,3385,3387,3388                   
 IREV                       Dummy  3356     I(4)            4           scalar   ARG,INOUT        3390                              
 ISW                        Local  3373     I(4)            4           scalar                    3373,3382,3385,3386               
 ITEMP                      Local  3394     I(4)            4           scalar                    3394,3396                         
 IV                         Dummy  3356     I(4)            4     1     0        ARG,INOUT        3362,3379,3380,3381,3394,3395,3396
 IVT                        Local  3379     I(4)            4           scalar                    3379,3381                         
 LIM                        Local  3369     I(4)            4           scalar                    3369,3374,3385                    
 MAX                        Dummy  3356     I(4)            4           scalar   ARG,INOUT        3361,3365,3369,3392,3395,3396,3398
                                                                                                  ,3399                             
 NH                         Local  3392     I(4)            4           scalar                    3392,3393                         
 SHELL                      Subr   3356                                                                                             
 TEMP                       Local  3397     R(4)            4           scalar                    3397,3399                         
 V                          Dummy  3356     R(4)            4     1     0        ARG,INOUT        3375,3376,3377,3378,3397,3398,3399
 VT                         Local  3376     R(4)            4           scalar                    3376,3378                         

Page 111         Source Listing                  SHELL
2017-04-18 11:09                                 profcqc.f

   3406 
   3407 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3408 C
   3409 C SUBPROGRAM:    SORT
   3410 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1994-03-17
   3411 C
   3412 C ABSTRACT: SORT RA ACCORDING TO THE ORDER SPECIFIED BY THE INDICES
   3413 C   IN INDX.
   3414 C
   3415 C PROGRAM HISTORY LOG:
   3416 C 1994-03-17  W. Collins -- Original author.
   3417 C
   3418 C USAGE:    CALL SORT(RA,INDX,N)
   3419 C   INPUT ARGUMENT LIST:
   3420 C     RA       - VARIABLE
   3421 C     INDX     - ORDER FOR REARRANGEMENT OF RA
   3422 C     N        - DIMENSION OF RA
   3423 C
   3424 C   OUTPUT ARGUMENT LIST:
   3425 C     RA       - VARIABLE
   3426 C
   3427 C ATTRIBUTES:
   3428 C   LANGUAGE: FORTRAN 90
   3429 C   MACHINE:  NCEP WCOSS
   3430 C
   3431 C$$$
   3432       SUBROUTINE SORT(RA,INDX,N)
   3433 
   3434 C     SORT RA ACCORDING TO THE ORDER SPECIFIED BY THE INDICES IN INDX.
   3435 
   3436       INTEGER  INDX(*)
   3437       DIMENSION  RA(*),WKSP(899)
   3438 
   3439       WKSP(1:N) = RA(1:N)
   3440 
   3441       RA(1:N) = WKSP(INDX(1:N))
   3442 
   3443       RETURN
   3444 
   3445       END

Page 112         Source Listing                  SORT
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name             
                   
 sort_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INDX                       Dummy  3432     I(4)            4     1     0        ARG,INOUT        3441                              
 N                          Dummy  3432     I(4)            4           scalar   ARG,INOUT        3439,3441                         
 RA                         Dummy  3432     R(4)            4     1     0        ARG,INOUT        3439,3441                         
 SORT                       Subr   3432                                                                                             
 WKSP                       Local  3437     R(4)            4     1     899                       3439,3441                         

Page 113         Source Listing                  SORT
2017-04-18 11:09                                 profcqc.f

   3446 
   3447 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3448 C
   3449 C SUBPROGRAM:    TWODIM
   3450 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   3451 C
   3452 C ABSTRACT: COMPUTE MEDIAN RESIDUALS FOR A SINGLE UNIQUE
   3453 C   STATION.
   3454 C
   3455 C PROGRAM HISTORY LOG:
   3456 C 1995-04-05  W. Collins -- Original author.
   3457 C 2004-09-09  D. Keyser  -- Lvl index in all arrays now site specific
   3458 C     to allow proper temporal checking at each individual site times
   3459 C     w/ new lvls inserted get missing wind). No. of time periods input
   3460 C     now site specific (was hardwired to be same for all rpts).
   3461 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   3462 C     per station.
   3463 C
   3464 C USAGE:    CALL TWODIM(IS)
   3465 C   INPUT ARGUMENT LIST:
   3466 C     IS       - STATION INDEX
   3467 C
   3468 C REMARKS:
   3469 C   VARIABLE NAMES:
   3470 C     U        - U-COMPONENT
   3471 C     V        - V-COMPONENT
   3472 C     ICQC     - DMA INDEX FOR WIND QUALITY CONTROL
   3473 C     UM       - MEDIAN RESIDUAL FOR U-COMPONENT
   3474 C     VM       - MEDIAN RESIDUAL FOR V-COMPONENT
   3475 C     VVM      - VECTOR MEDIAN RESIDUAL
   3476 C
   3477 C ATTRIBUTES:
   3478 C   LANGUAGE: FORTRAN 90
   3479 C   MACHINE:  NCEP WCOSS
   3480 C
   3481 C$$$
   3482       SUBROUTINE TWODIM(IS)
   3483 
   3484       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   3485 
   3486       CHARACTER*8  STN
   3487       REAL  U(NL,NT),V(NL,NT),TIN(3,3),TUT(NL,NT)
   3488       REAL(8)  BMISS
   3489 
   3490       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   3491      $ IRTP(NS)
   3492       COMMON/PROFZ/ZZ(NL,NT,NS),UZ(NL,NT,NS),VZ(NL,NT,NS),QZ(NL,NT,NS),
   3493      $ PZ(NL,NT,NS),UFZ(NL,NT,NS),VFZ(NL,NT,NS),SZ(NL,NT,NS),
   3494      $ DZ(NL,NT,NS),LEVZ(NL,NT,NS)
   3495       COMMON/RESIDS/UI(NL,NT,NS),VI(NL,NT,NS),UT(NL,NT),VT(NL,NT),
   3496      $ UV(NL,NT),VV(NL,NT),VVI(NL,NT),VVT(NL,NT),VVV(NL,NT),UM(NL,NT),
   3497      $ VM(NL,NT),VVM(NL,NT),NI(NL,NT),NTMP(NL,NT),NV(NL,NT),NM(NL,NT),
   3498      $ ZI(NL,NT),ZT(NL,NT),ZV(NL,NT),ZM(NL,NT),DIT(NL,NT),DIV(NL,NT),
   3499      $ DTV(NL,NT),DIM(NL,NT),DVM(NL,NT),DTM(NL,NT)
   3500       COMMON/QUAL/QM(NL,NT,NS),IQ(NL,NT,NS),ICQC(NL,NT,NS),
   3501      $ IQCC(NL,NT,NS),MLEV(NT,NS),DT(NL,NT,NS),NZZ(NS),IBAD_FLAG(NT,NS),
   3502      $ JBAD_FLAG(NS),IRC(NL,NT,NS)

Page 114         Source Listing                  TWODIM
2017-04-18 11:09                                 profcqc.f

   3503       COMMON/PARAMS/NCH,NLEV,NSCAN,NSTN,NSTN1,NREP,NREP1,NREP_OUT,
   3504      $ NFIN,NFOUT
   3505       COMMON /BUFRLIB_MISSING/BMISS
   3506 
   3507       UM  = BMISS
   3508       VM  = BMISS
   3509       VVM = BMISS
   3510 
   3511       U(1:NL,1:NTIMES(IS)) = UZ(1:NL,1:NTIMES(IS),IS)
   3512       V(1:NL,1:NTIMES(IS)) = VZ(1:NL,1:NTIMES(IS),IS)
   3513 
   3514 C     INPUT FIELD, TIN, WILL CONTAIN MISSING FOR EITHER MISSING OR
   3515 C     'BAD' VALUES.
   3516 
   3517 C     U FIRST.
   3518 
   3519       DO L=1,NTIMES(IS)
   3520         JSTART = 1
   3521         JEND   = 3
   3522         IF(L.EQ.1)          JSTART=2
   3523         IF(L.EQ.NTIMES(IS)) JEND  =2
   3524         DO K=2,NZZ(IS)-1
   3525           TIN = BMISS
   3526           DO J=JSTART,JEND
   3527             DO I=1,3
   3528               IF(U(K+I-2,L+J-2).LT.BMISS .AND.
   3529      $           ICQC(K+I-2,L+J-2,IS).EQ.0) THEN
   3530                 TIN(I,J) = U(K+I-2,L+J-2)
   3531               ENDIF
   3532             ENDDO
   3533           ENDDO
   3534 
   3535 C         DO INTERPOLATION.  TUT IS ARRAY OF INTERPOLATED VALUES.
   3536 
   3537           CALL PLINT(TIN,TUT(K,L),BMISS)
   3538 
   3539 C         CALCULATE 2 D RESIDUAL, UM.
   3540 
   3541           IF(MAX(U(K,L),TUT(K,L)).LT.BMISS) THEN
   3542             UM(K,L) = U(K,L) - TUT(K,L)
   3543           ELSE
   3544             UM(K,L) = BMISS
   3545           ENDIF
   3546 
   3547 C     AND NOW V.
   3548 
   3549           TIN = BMISS
   3550           DO J=JSTART,JEND
   3551             DO I=1,3
   3552               IF(V(K+I-2,L+J-2).LT.BMISS .AND.
   3553      &           ICQC(K+I-2,L+J-2,IS).EQ.0) THEN
   3554                 TIN(I,J) = V(K+I-2,L+J-2)
   3555               ENDIF
   3556             ENDDO
   3557           ENDDO
   3558 
   3559 C         DO INTERPOLATION.  TUT IS FIELD OF INTERPOLATED VALUES.

Page 115         Source Listing                  TWODIM
2017-04-18 11:09                                 profcqc.f

   3560 
   3561           CALL PLINT(TIN,TUT(K,L),BMISS)
   3562 
   3563 C         COMPUTE 2 D RESIDUAL, VM.
   3564 
   3565           IF(MAX(V(K,L),TUT(K,L)).LT.BMISS) THEN
   3566             VM(K,L) = V(K,L) - TUT(K,L)
   3567           ELSE
   3568             VM(K,L) = BMISS
   3569           ENDIF
   3570 
   3571 C           AND COMPUTE VECTOR RESIDUAL.
   3572           IF(MAX(UM(K,L),VM(K,L)).LT.BMISS) THEN
   3573             VVM(K,L) = SQRT(UM(K,L)**2 + VM(K,L)**2)
   3574           ELSE
   3575             VVM(K,L) = BMISS
   3576           ENDIF
   3577         ENDDO
   3578       ENDDO
   3579 
   3580       RETURN
   3581 
   3582       END


ENTRY POINTS

  Name               
                     
 twodim_             

Page 116         Source Listing                  TWODIM
2017-04-18 11:09 Symbol Table                    profcqc.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 3488     R(8)            8           scalar   COM              3507,3508,3509,3525,3528,3537,3541
                                                                                                  ,3544,3549,3552,3561,3565,3568,357
                                                                                                  2,3575                            
 BUFRLIB_MISSING            Common 3505                                 8                                                           
 DIM                        Scalar 3499     R(4)            4     2     15000    COM                                                
 DIT                        Scalar 3498     R(4)            4     2     15000    COM                                                
 DIV                        Scalar 3498     R(4)            4     2     15000    COM                                                
 DT                         Scalar 3501     R(4)            4     3     1800000  COM                                                
 DTM                        Scalar 3499     R(4)            4     2     15000    COM                                                
 DTV                        Scalar 3499     R(4)            4     2     15000    COM                                                
 DVM                        Scalar 3499     R(4)            4     2     15000    COM                                                
 DZ                         Scalar 3494     R(4)            4     3     1800000  COM                                                
 I                          Local  3527     I(4)            4           scalar                    3527,3528,3529,3530,3551,3552,3553
                                                                                                  ,3554                             
 IBAD_FLAG                  Scalar 3501     I(4)            4     2     12000    COM                                                
 ICQC                       Scalar 3500     I(4)            4     3     1800000  COM              3529,3553                         
 IQ                         Scalar 3500     I(4)            4     3     1800000  COM                                                
 IQCC                       Scalar 3501     I(4)            4     3     1800000  COM                                                
 IRC                        Scalar 3502     I(4)            4     3     1800000  COM                                                
 IRTP                       Scalar 3491     I(4)            4     1     120      COM                                                
 IS                         Dummy  3482     I(4)            4           scalar   ARG,INOUT        3511,3512,3519,3523,3524,3529,3553
 J                          Local  3526     I(4)            4           scalar                    3526,3528,3529,3530,3550,3552,3553
                                                                                                  ,3554                             
 JBAD_FLAG                  Scalar 3502     I(4)            4     1     120      COM                                                
 JEND                       Local  3521     I(4)            4           scalar                    3521,3523,3526,3550               
 JSTART                     Local  3520     I(4)            4           scalar                    3520,3522,3526,3550               
 K                          Local  3524     I(4)            4           scalar                    3524,3528,3529,3530,3537,3541,3542
                                                                                                  ,3544,3552,3553,3554,3561,3565,356
                                                                                                  6,3568,3572,3573,3575             
 L                          Local  3519     I(4)            4           scalar                    3519,3522,3523,3528,3529,3530,3537
                                                                                                  ,3541,3542,3544,3552,3553,3554,356
                                                                                                  1,3565,3566,3568,3572,3573,3575   
 LEVZ                       Scalar 3494     I(4)            4     3     1800000  COM                                                
 MAX                        Func   3541                                 scalar                    3541,3565,3572                    
 MLEV                       Scalar 3501     I(4)            4     2     12000    COM                                                
 NCH                        Scalar 3503     I(4)            4           scalar   COM                                                
 NFIN                       Scalar 3504     I(4)            4           scalar   COM                                                
 NFOUT                      Scalar 3504     I(4)            4           scalar   COM                                                
 NI                         Scalar 3497     I(4)            4     2     15000    COM                                                
 NL                         Param  3484     I(4)            4           scalar                    3487,3492,3493,3494,3495,3496,3497
                                                                                                  ,3498,3499,3500,3501,3502,3511,351
                                                                                                  2                                 
 NLEV                       Scalar 3503     I(4)            4           scalar   COM                                                
 NM                         Scalar 3497     I(4)            4     2     15000    COM                                                
 NREP                       Scalar 3503     I(4)            4           scalar   COM                                                
 NREP1                      Scalar 3503     I(4)            4           scalar   COM                                                
 NREP_OUT                   Scalar 3503     I(4)            4           scalar   COM                                                
 NS                         Param  3484     I(4)            4           scalar                    3490,3491,3492,3493,3494,3495,3500
                                                                                                  ,3501,3502                        
 NSCAN                      Scalar 3503     I(4)            4           scalar   COM                                                
 NSTN                       Scalar 3503     I(4)            4           scalar   COM                                                

Page 117         Source Listing                  TWODIM
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NSTN1                      Scalar 3503     I(4)            4           scalar   COM                                                
 NT                         Param  3484     I(4)            4           scalar                    3487,3490,3492,3493,3494,3495,3496
                                                                                                  ,3497,3498,3499,3500,3501,3502    
 NTIMES                     Scalar 3490     I(4)            4     1     120      COM              3511,3512,3519,3523               
 NTMP                       Scalar 3497     I(4)            4     2     15000    COM                                                
 NV                         Scalar 3497     I(4)            4     2     15000    COM                                                
 NZZ                        Scalar 3501     I(4)            4     1     120      COM              3524                              
 PARAMS                     Common 3503                                 40                                                          
 PLINT                      Subr   3537                                                           3537,3561                         
 PROFZ                      Common 3492                                 72000000                                                    
 PZ                         Scalar 3493     R(4)            4     3     1800000  COM                                                
 QM                         Scalar 3500     R(4)            4     3     1800000  COM                                                
 QUAL                       Common 3500                                 43296960                                                    
 QZ                         Scalar 3492     R(4)            4     3     1800000  COM                                                
 RESIDS                     Common 3495                                 15840000                                                    
 SQRT                       Func   3573                                 scalar                    3573                              
 STN                        Scalar 3486     CHAR            8     1     120      COM                                                
 STNLST                     Common 3490                                 51360                                                       
 SZ                         Scalar 3493     R(4)            4     3     1800000  COM                                                
 TIM                        Scalar 3490     R(4)            4     2     12000    COM                                                
 TIN                        Local  3487     R(4)            4     2     9                         3525,3530,3537,3549,3554,3561     
 TUT                        Local  3487     R(4)            4     2     15000                     3537,3541,3542,3561,3565,3566     
 TWODIM                     Subr   3482                                                                                             
 U                          Local  3487     R(4)            4     2     15000                     3511,3528,3530,3541,3542          
 UFZ                        Scalar 3493     R(4)            4     3     1800000  COM                                                
 UI                         Scalar 3495     R(4)            4     3     1800000  COM                                                
 UM                         Scalar 3496     R(4)            4     2     15000    COM              3507,3542,3544,3572,3573          
 UT                         Scalar 3495     R(4)            4     2     15000    COM                                                
 UV                         Scalar 3496     R(4)            4     2     15000    COM                                                
 UZ                         Scalar 3492     R(4)            4     3     1800000  COM              3511                              
 V                          Local  3487     R(4)            4     2     15000                     3512,3552,3554,3565,3566          
 VFZ                        Scalar 3493     R(4)            4     3     1800000  COM                                                
 VI                         Scalar 3495     R(4)            4     3     1800000  COM                                                
 VM                         Scalar 3497     R(4)            4     2     15000    COM              3508,3566,3568,3572,3573          
 VT                         Scalar 3495     R(4)            4     2     15000    COM                                                
 VV                         Scalar 3496     R(4)            4     2     15000    COM                                                
 VVI                        Scalar 3496     R(4)            4     2     15000    COM                                                
 VVM                        Scalar 3497     R(4)            4     2     15000    COM              3509,3573,3575                    
 VVT                        Scalar 3496     R(4)            4     2     15000    COM                                                
 VVV                        Scalar 3496     R(4)            4     2     15000    COM                                                
 VZ                         Scalar 3492     R(4)            4     3     1800000  COM              3512                              
 X                          Scalar 3490     R(4)            4     1     120      COM                                                
 Y                          Scalar 3490     R(4)            4     1     120      COM                                                
 Z0                         Scalar 3490     R(4)            4     1     120      COM                                                
 ZI                         Scalar 3498     R(4)            4     2     15000    COM                                                
 ZM                         Scalar 3498     R(4)            4     2     15000    COM                                                
 ZT                         Scalar 3498     R(4)            4     2     15000    COM                                                
 ZV                         Scalar 3498     R(4)            4     2     15000    COM                                                
 ZZ                         Scalar 3492     R(4)            4     3     1800000  COM                                                

Page 118         Source Listing                  TWODIM
2017-04-18 11:09                                 profcqc.f

   3583 
   3584 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3585 C
   3586 C SUBPROGRAM:    PSTAT
   3587 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   3588 C
   3589 C ABSTRACT: DRIVER SUBROUTINE TO COMPUTE AND PRINT MOMENT
   3590 C   STATISTICS. CALLS SUBROUTINE MSTATS TO ACTUALLY DO THE WORK
   3591 C   FOR A PARTICULAR FIELD AND REPORT TYPE.
   3592 C
   3593 C PROGRAM HISTORY LOG:
   3594 C 1995-04-05  W. Collins -- Original author.
   3595 C 2004-09-09  D. Keyser  -- Stats generated separately for NPN, CAP &
   3596 C     JMA rpts.
   3597 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   3598 C     per station.
   3599 C
   3600 C USAGE:    CALL PSTAT
   3601 C
   3602 C ATTRIBUTES:
   3603 C   LANGUAGE: FORTRAN 90
   3604 C   MACHINE:  NCEP WCOSS
   3605 C
   3606 C$$$
   3607       SUBROUTINE PSTAT
   3608 
   3609       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   3610 
   3611       LOGICAL  STATS,MEAN,STDDEV,SKEW,KURT
   3612       CHARACTER*8  STN
   3613 
   3614       COMMON/STATZ/UZS(120,0:24,9,3:8),VZS(120,0:24,9,3:8),
   3615      $ UIS(120,0:24,9,3:8),VIS(120,0:24,9,3:8),UTS(120,0:24,9,3:8),
   3616      $ VTS(120,0:24,9,3:8),UVS(120,0:24,9,3:8),VVS(120,0:24,9,3:8),
   3617      $ VVIS(120,0:24,9,3:8),VVTS(120,0:24,9,3:8),VVVS(120,0:24,9,3:8),
   3618      $ VVMS(120,0:24,9,3:8),UMS(120,0:24,9,3:8),VMS(120,0:24,9,3:8)
   3619       COMMON/STNLST/STN(NS),X(NS),Y(NS),Z0(NS),NTIMES(NS),TIM(NT,NS),
   3620      $ IRTP(NS)
   3621       COMMON/PST/IOFFSET(3:8),LVLINCR(3:8),ILEVELS(3:8),STATS,MEAN,
   3622      $ STDDEV,SKEW,KURT
   3623 
   3624 C  CALL MSTATS TO PROCESS AND PRINT DESIRED STATISTICS
   3625 C  --------------------------------------------------
   3626 
   3627       CALL MSTATS(UZS,3,'U-COMPONENT WIND',1)
   3628       CALL MSTATS(UZS,7,'U-COMPONENT WIND',1)
   3629       CALL MSTATS(UZS,8,'U-COMPONENT WIND',1)
   3630 
   3631       CALL MSTATS(VZS,3,'V-COMPONENT WIND',2)
   3632       CALL MSTATS(VZS,7,'V-COMPONENT WIND',2)
   3633       CALL MSTATS(VZS,8,'V-COMPONENT WIND',2)
   3634 
   3635       CALL MSTATS(UIS,3,'U-INCREMENT',3)
   3636       CALL MSTATS(UIS,7,'U-INCREMENT',3)
   3637       CALL MSTATS(UIS,8,'U-INCREMENT',3)
   3638 
   3639       CALL MSTATS(VIS,3,'V-INCREMENT',4)

Page 119         Source Listing                  PSTAT
2017-04-18 11:09                                 profcqc.f

   3640       CALL MSTATS(VIS,7,'V-INCREMENT',4)
   3641       CALL MSTATS(VIS,8,'V-INCREMENT',4)
   3642 
   3643       CALL MSTATS(UTS,3,'U-TEMPORAL RESIDUAL',5)
   3644       CALL MSTATS(UTS,7,'U-TEMPORAL RESIDUAL',5)
   3645       CALL MSTATS(UTS,8,'U-TEMPORAL RESIDUAL',5)
   3646 
   3647       CALL MSTATS(VTS,3,'V-TEMPORAL RESIDUAL',6)
   3648       CALL MSTATS(VTS,7,'V-TEMPORAL RESIDUAL',6)
   3649       CALL MSTATS(VTS,8,'V-TEMPORAL RESIDUAL',6)
   3650 
   3651       CALL MSTATS(UVS,3,'U-VERTICAL RESIDUAL',7)
   3652       CALL MSTATS(UVS,7,'U-VERTICAL RESIDUAL',7)
   3653       CALL MSTATS(UVS,8,'U-VERTICAL RESIDUAL',7)
   3654 
   3655       CALL MSTATS(VVS,3,'V-VERTICAL RESIDUAL',8)
   3656       CALL MSTATS(VVS,7,'V-VERTICAL RESIDUAL',8)
   3657       CALL MSTATS(VVS,8,'V-VERTICAL RESIDUAL',8)
   3658 
   3659       CALL MSTATS(UMS,3,'U-2-DIM MEDIAN RESIDUAL',9)
   3660       CALL MSTATS(UMS,7,'U-2-DIM MEDIAN RESIDUAL',9)
   3661       CALL MSTATS(UMS,8,'U-2-DIM MEDIAN RESIDUAL',9)
   3662 
   3663       CALL MSTATS(VMS,3,'V-2-DIM MEDIAN RESIDUAL',10)
   3664       CALL MSTATS(VMS,7,'V-2-DIM MEDIAN RESIDUAL',10)
   3665       CALL MSTATS(VMS,8,'V-2-DIM MEDIAN RESIDUAL',10)
   3666 
   3667       CALL MSTATS(VVIS,3,'VECTOR INCREMENT',11)
   3668       CALL MSTATS(VVIS,7,'VECTOR INCREMENT',11)
   3669       CALL MSTATS(VVIS,8,'VECTOR INCREMENT',11)
   3670 
   3671       CALL MSTATS(VVTS,3,'VECTOR TEMPORAL RESIDUAL',12)
   3672       CALL MSTATS(VVTS,7,'VECTOR TEMPORAL RESIDUAL',12)
   3673       CALL MSTATS(VVTS,8,'VECTOR TEMPORAL RESIDUAL',12)
   3674 
   3675       CALL MSTATS(VVVS,3,'VECTOR VERTICAL RESIDUAL',13)
   3676       CALL MSTATS(VVVS,7,'VECTOR VERTICAL RESIDUAL',13)
   3677       CALL MSTATS(VVVS,8,'VECTOR VERTICAL RESIDUAL',13)
   3678 
   3679       CALL MSTATS(VVMS,3,'VECTOR 2-DIM MEDIAN RESIDUAL',14)
   3680       CALL MSTATS(VVMS,7,'VECTOR 2-DIM MEDIAN RESIDUAL',14)
   3681       CALL MSTATS(VVMS,8,'VECTOR 2-DIM MEDIAN RESIDUAL',14)
   3682 
   3683       RETURN
   3684 
   3685       END

Page 120         Source Listing                  PSTAT
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name              
                    
 pstat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ILEVELS                    Scalar 3621     I(4)            4     1     6        COM                                                
 IOFFSET                    Scalar 3621     I(4)            4     1     6        COM                                                
 IRTP                       Scalar 3620     I(4)            4     1     120      COM                                                
 KURT                       Scalar 3611     L(4)            4           scalar   COM                                                
 LVLINCR                    Scalar 3621     I(4)            4     1     6        COM                                                
 MEAN                       Scalar 3611     L(4)            4           scalar   COM                                                
 MSTATS                     Subr   3627                                                           3627,3628,3629,3631,3632,3633,3635
                                                                                                  ,3636,3637,3639,3640,3641,3643,364
                                                                                                  4,3645,3647,3648,3649,3651,3652,36
                                                                                                  53,3655,3656,3657,3659,3660,3661,3
                                                                                                  663,3664,3665,3667,3668,3669,3671,
                                                                                                  3672,3673,3675,3676,3677,3679,3680
                                                                                                  ,3681                             
 NL                         Param  3609     I(4)            4           scalar                                                      
 NS                         Param  3609     I(4)            4           scalar                    3619,3620                         
 NT                         Param  3609     I(4)            4           scalar                    3619                              
 NTIMES                     Scalar 3619     I(4)            4     1     120      COM                                                
 PST                        Common 3621                                 92                                                          
 PSTAT                      Subr   3607                                                                                             
 SKEW                       Scalar 3611     L(4)            4           scalar   COM                                                
 STATS                      Scalar 3611     L(4)            4           scalar   COM                                                
 STATZ                      Common 3614                                 9072000                                                     
 STDDEV                     Scalar 3611     L(4)            4           scalar   COM                                                
 STN                        Scalar 3612     CHAR            8     1     120      COM                                                
 STNLST                     Common 3619                                 51360                                                       
 TIM                        Scalar 3619     R(4)            4     2     12000    COM                                                
 UIS                        Scalar 3615     R(4)            4     4     162000   COM              3635,3636,3637                    
 UMS                        Scalar 3618     R(4)            4     4     162000   COM              3659,3660,3661                    
 UTS                        Scalar 3615     R(4)            4     4     162000   COM              3643,3644,3645                    
 UVS                        Scalar 3616     R(4)            4     4     162000   COM              3651,3652,3653                    
 UZS                        Scalar 3614     R(4)            4     4     162000   COM              3627,3628,3629                    
 VIS                        Scalar 3615     R(4)            4     4     162000   COM              3639,3640,3641                    
 VMS                        Scalar 3618     R(4)            4     4     162000   COM              3663,3664,3665                    
 VTS                        Scalar 3616     R(4)            4     4     162000   COM              3647,3648,3649                    
 VVIS                       Scalar 3617     R(4)            4     4     162000   COM              3667,3668,3669                    
 VVMS                       Scalar 3618     R(4)            4     4     162000   COM              3679,3680,3681                    
 VVS                        Scalar 3616     R(4)            4     4     162000   COM              3655,3656,3657                    
 VVTS                       Scalar 3617     R(4)            4     4     162000   COM              3671,3672,3673                    
 VVVS                       Scalar 3617     R(4)            4     4     162000   COM              3675,3676,3677                    
 VZS                        Scalar 3614     R(4)            4     4     162000   COM              3631,3632,3633                    
 X                          Scalar 3619     R(4)            4     1     120      COM                                                
 Y                          Scalar 3619     R(4)            4     1     120      COM                                                
 Z0                         Scalar 3619     R(4)            4     1     120      COM                                                

Page 121         Source Listing                  PSTAT
2017-04-18 11:09                                 profcqc.f

   3686 
   3687 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3688 C
   3689 C SUBPROGRAM:    MSTATS
   3690 C   PRGMMR: D. KEYSER        ORG: NP22       DATE: 2016-12-20
   3691 C
   3692 C ABSTRACT: COMPUTES THE VARIOUS MOMENT STATISTICS AND PRINTS
   3693 C   TO FILES.
   3694 C
   3695 C PROGRAM HISTORY LOG:
   3696 C 1995-04-05  W. Collins -- Original author.
   3697 C 2004-09-09  D. Keyser  -- Kurtotis stat. now computed correctly.
   3698 C     Stat. output clarified & written to 2 text files separate from
   3699 C     stdout.  Computation & printout of stats, as well as combination
   3700 C     of stat types printed out controlled via new namelist switches.
   3701 C     Stats generated separately for NPN, CAP & JMA rpts and stratified
   3702 C     according to hgt above ground.
   3703 C 2016-12-20  D. Stokes   Increase the max allowable number of times 
   3704 C     per station.
   3705 C
   3706 C USAGE:    CALL MSTATS(FIELD,ITYPE,TITLE,NUM)
   3707 C   INPUT ARGUMENT LIST:
   3708 C     FIELD    - INPUT FIELD
   3709 C     ITYPE    - PROFILER REPORT TYPE (=3-NPN, =7-CAP, =8=JMA)
   3710 C     TITLE    - CHARACTER TITLE FOR FIELD
   3711 C     IFLD     - INDICATOR FOR TYPE OF FIELD (=1-U-COMP WIND,
   3712 C                =2-V-COMP WIND, =3-U-INCR, =4-V-INCR, =5-U-TEMPORAL
   3713 C                RESID, =6-V-TEMPORAL RESID, =7-U-VERTICAL RESID,
   3714 C                =8-V-VERTICAL RESID, =9-U-MEDIAN RESID, =10-V-MEDIAN
   3715 C                RESID, =11-VECTOR INCR, =12-VECTOR TEMPORAL RESID,
   3716 C                =13-VECTOR VERTICAL RESID, =14-VECTOR MEDIAN RESID)
   3717 C
   3718 C   OUTPUT FILES:
   3719 C     UNIT 61  - PRINTOUT OF SELECTED STATISTICS OF RESULTS ON EACH 
   3720 C                LEVEL (BY REPORT TYPE, REPORT TIME AND FIELD)
   3721 C     UNIT 62  - STATISTICS FILE CONTAINING ALL STATISTICS ON EACH
   3722 C                LEVEL (BY REPORT TYPE (BY REPORT TYPE AND FIELD, BUT
   3723 C                OVER ALL TIMES COMBINED)
   3724 C
   3725 C ATTRIBUTES:
   3726 C   LANGUAGE: FORTRAN 90
   3727 C   MACHINE:  NCEP WCOSS
   3728 C
   3729 C$$$
   3730       SUBROUTINE MSTATS(FIELD,ITYPE,TITLE,IFLD)
   3731 
   3732       PARAMETER  (NL=150,NT=100,NS=120)    ! (levels,times,stations)
   3733 
   3734       LOGICAL  STATS,LPRNT
   3735       CHARACTER*8   STATISTIC(4)
   3736       CHARACTER*(*) TITLE
   3737       CHARACTER*36  TEXT(3:8)
   3738       REAL  FIELD(120,0:24,9,3:8)
   3739       INTEGER  NTIM(26),IZ(120)
   3740 
   3741       COMMON/DATEZ/JDATE(4),KDATE(5,NT,NS),MDATE(5),NDATE(5)
   3742       COMMON/PST/IOFFSET(3:8),LVLINCR(3:8),ILEVELS(3:8),STATS,LPRNT(4)

Page 122         Source Listing                  MSTATS
2017-04-18 11:09                                 profcqc.f

   3743 
   3744       DATA  STATISTIC/'  MEAN  ','STD DEV.','SKEWNESS','KURTOSIS'/
   3745       DATA  TEXT/'NOAA Profiler Network (NPN) Reports:',
   3746      $           'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
   3747      $           'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
   3748      $           'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
   3749      $           'Cooperative Agency Profiler Reports:',
   3750      $           'Jap. Met. Agency Profiler Reports:  '/
   3751 
   3752       IF(ITYPE.NE.3.AND.ITYPE.NE.7.AND.ITYPE.NE.8)  THEN
   3753         write(61,*)
   3754         write(61,'("#### Mean and higher order statistics for field ",
   3755      $   A," cannot be computed or printed because wind profiler ",
   3756      $   "report type (=",I0,") is not valid")') TITLE,ITYPE
   3757         write(61,*)
   3758         RETURN
   3759       ENDIF
   3760        
   3761       ITEST = 0
   3762       INDX  = 0
   3763       IADD = 0
   3764       IF(MDATE(5).NE.0)  THEN
   3765          IADD = 1
   3766          IF(MDATE(4).EQ.23)  IADD = -23
   3767       ENDIF
   3768       NDATE4 = NDATE(4)
   3769       IF(NDATE(4).LT.MDATE(4)+IADD)  NDATE4 = NDATE(4) + 24
   3770       DO NN=MDATE(4)+IADD,NDATE4+1
   3771         IF(NN.LT.NDATE4+1) THEN
   3772            INDX = INDX + 1
   3773            N = NN
   3774            IF(N.GT.23)  N = N - 24
   3775            NTIM(INDX) = N
   3776         ELSE
   3777            N = 24
   3778         ENDIF
   3779         DO L=1,ILEVELS(ITYPE)
   3780           IF(NINT(FIELD(L,N,1,ITYPE)).LT.1) CYCLE
   3781           ITEST = 1
   3782           IZ(L) = (L * LVLINCR(ITYPE)) + IOFFSET(ITYPE)
   3783           SUM1 = FIELD(L,N,2,ITYPE)/FIELD(L,N,1,ITYPE)
   3784           SUM2 = FIELD(L,N,3,ITYPE)/FIELD(L,N,1,ITYPE)
   3785           SUM3 = FIELD(L,N,4,ITYPE)/FIELD(L,N,1,ITYPE)
   3786           SUM4 = FIELD(L,N,5,ITYPE)/FIELD(L,N,1,ITYPE)
   3787 
   3788 C  MEAN (m/s)
   3789 C  ----------
   3790           FIELD(L,N,6,ITYPE) = SUM1
   3791 
   3792 C  STANDARD DEVIATION (m/s)
   3793 C  ------------------------
   3794 
   3795           ARG = SUM2 - SUM1**2
   3796           IF(ARG.GT.0.) FIELD(L,N,7,ITYPE) = SQRT(ARG)
   3797 
   3798 C  SKEWNESS (m/s)
   3799 C  --------------

Page 123         Source Listing                  MSTATS
2017-04-18 11:09                                 profcqc.f

   3800 
   3801           S1 = SUM3 - 3.*SUM2*SUM1 + 2.*SUM1**3
   3802           IF(SUM2.GT.0.) FIELD(L,N,8,ITYPE) = S1/(SUM2)**1.5
   3803 
   3804 C  KURTOSIS (m/s)
   3805 C  --------------
   3806 
   3807           S1 = SUM4 - 4.*SUM3*SUM1 + 6.*SUM2*(SUM1**2) - 3.*SUM1**4
   3808           IF(FIELD(L,N,7,ITYPE).GT.0.001) FIELD(L,N,9,ITYPE) =
   3809      $     (S1/FIELD(L,N,7,ITYPE)**4) - 3.0
   3810 
   3811 C  PRINT STATISTICS TO FILE (ONLY OVER ALL TIME PERIODS)
   3812 C  -----------------------------------------------------
   3813 
   3814           IF(N.EQ.24) WRITE(62,100) ITYPE,IFLD,IZ(L),
   3815      $     (FIELD(L,24,J,ITYPE),J=1,9)
   3816 
   3817         ENDDO
   3818       ENDDO
   3819 
   3820 C  PRINT SELECTED STATISTICS (OVER SEPARATE HOURS) (USER-FRIENDLY FORM)
   3821 C  -------------------------------------------------------------------
   3822 
   3823       IF(INDX.GT.0.AND.INDX.LT.24)  THEN
   3824         WRITE(61,101) TEXT(ITYPE),TITLE
   3825         IF(ITEST.EQ.0)  THEN
   3826           WRITE(61,102)
   3827           RETURN
   3828         ENDIF
   3829         DO ISTAT=1,4
   3830           IF(.NOT.LPRNT(ISTAT)) CYCLE
   3831           JSTAT = ISTAT + 5
   3832           WRITE(61,103) STATISTIC(ISTAT)
   3833           WRITE(61,104) (NTIM(I),I=1,INDX)
   3834           DO L=1,ILEVELS(ITYPE)
   3835             IF(NINT(FIELD(L,24,1,ITYPE)).LE.1) CYCLE
   3836             WRITE(61,105) IZ(L),(FIELD(L,NTIM(N),JSTAT,ITYPE),
   3837      $       NINT(FIELD(L,NTIM(N),1,ITYPE)),N=1,INDX),
   3838      $       FIELD(L,24,JSTAT,ITYPE),NINT(FIELD(L,24,1,ITYPE))
   3839           ENDDO
   3840           WRITE(61,106)
   3841         ENDDO
   3842       ENDIF
   3843 
   3844       RETURN
   3845 
   3846   100 FORMAT(1X,I3,1X,I3,',',I6,',',F8.0,',',8(F12.2,','))
   3847   101 FORMAT(/128('*')/'==> Statistics for ',A36//'Field: ',A/)
   3848   102 FORMAT(/'  ~~~~~> No reports of this type present'/)
   3849   103 FORMAT(35X,A8,'/COUNT'//'~LEVEL(m)    Hour (UTC) ==============>')
   3850   104 FORMAT('above ground',<INDX>(14X,I2.2),14X,'ALL'/'------------',
   3851      $ <INDX>(14X,'--'),14X,'---')
   3852   105 FORMAT(I9,6X,<INDX+1>(F12.2,'/',I3))

Page 124         Source Listing                  MSTATS
2017-04-18 11:09 Entry Points                    profcqc.f



ENTRY POINTS

  Name               
                     
 mstats_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  3846                                                           3814                              
 101                        Label  3847                                                           3824                              
 102                        Label  3848                                                           3826                              
 103                        Label  3849                                                           3832                              
 104                        Label  3850                                                           3833                              
 105                        Label  3852                                                           3836                              
 106                        Label  3853                                                           3840                              
 ARG                        Local  3795     R(4)            4           scalar                    3795,3796                         
 DATEZ                      Common 3741                                 240056                                                      
 FIELD                      Dummy  3730     R(4)            4     4     162000   ARG,INOUT        3780,3783,3784,3785,3786,3790,3796
                                                                                                  ,3802,3808,3809,3815,3835,3836,383
                                                                                                  7,3838                            
 I                          Local  3833     I(4)            4           scalar                    3833                              
 IADD                       Local  3763     I(4)            4           scalar                    3763,3765,3766,3769,3770          
 IFLD                       Dummy  3730     I(4)            4           scalar   ARG,INOUT        3814                              
 ILEVELS                    Scalar 3742     I(4)            4     1     6        COM              3779,3834                         
 INDX                       Local  3762     I(4)            4           scalar                    3762,3772,3775,3823,3833,3837,3850
                                                                                                  ,3851,3852                        
 IOFFSET                    Scalar 3742     I(4)            4     1     6        COM              3782                              
 ISTAT                      Local  3829     I(4)            4           scalar                    3829,3830,3831,3832               
 ITEST                      Local  3761     I(4)            4           scalar                    3761,3781,3825                    
 ITYPE                      Dummy  3730     I(4)            4           scalar   ARG,INOUT        3752,3756,3779,3780,3782,3783,3784
                                                                                                  ,3785,3786,3790,3796,3802,3808,380
                                                                                                  9,3814,3815,3824,3834,3835,3836,38
                                                                                                  37,3838                           
 IZ                         Local  3739     I(4)            4     1     120                       3782,3814,3836                    
 J                          Local  3815     I(4)            4           scalar                    3815                              
 JDATE                      Scalar 3741     I(4)            4     1     4        COM                                                
 JSTAT                      Local  3831     I(4)            4           scalar                    3831,3836,3838                    
 KDATE                      Scalar 3741     I(4)            4     3     60000    COM                                                
 L                          Local  3779     I(4)            4           scalar                    3779,3780,3782,3783,3784,3785,3786
                                                                                                  ,3790,3796,3802,3808,3809,3814,381
                                                                                                  5,3834,3835,3836,3837,3838        
 LPRNT                      Scalar 3734     L(4)            4     1     4        COM              3830                              
 LVLINCR                    Scalar 3742     I(4)            4     1     6        COM              3782                              
 MDATE                      Scalar 3741     I(4)            4     1     5        COM              3764,3766,3769,3770               
 MSTATS                     Subr   3730                                                                                             
 N                          Local  3773     I(4)            4           scalar                    3773,3774,3775,3777,3780,3783,3784
                                                                                                  ,3785,3786,3790,3796,3802,3808,380
                                                                                                  9,3814,3836,3837                  
 NDATE                      Scalar 3741     I(4)            4     1     5        COM              3768,3769                         
 NDATE4                     Local  3768     I(4)            4           scalar                    3768,3769,3770,3771               
 NINT                       Func   3780                                 scalar                    3780,3835,3837,3838               
 NL                         Param  3732     I(4)            4           scalar                                                      

Page 125         Source Listing                  MSTATS
2017-04-18 11:09 Symbol Table                    profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NN                         Local  3770     I(4)            4           scalar                    3770,3771,3773                    
 NS                         Param  3732     I(4)            4           scalar                    3741                              
 NT                         Param  3732     I(4)            4           scalar                    3741                              
 NTIM                       Local  3739     I(4)            4     1     26                        3775,3833,3836,3837               
 PST                        Common 3742                                 92                                                          
 S1                         Local  3801     R(4)            4           scalar                    3801,3802,3807,3809               
 SQRT                       Func   3796                                 scalar                    3796                              
 STATISTIC                  Local  3735     CHAR            8     1     4                         3744,3832                         
 STATS                      Scalar 3734     L(4)            4           scalar   COM                                                
 SUM1                       Local  3783     R(4)            4           scalar                    3783,3790,3795,3801,3807          
 SUM2                       Local  3784     R(4)            4           scalar                    3784,3795,3801,3802,3807          
 SUM3                       Local  3785     R(4)            4           scalar                    3785,3801,3807                    
 SUM4                       Local  3786     R(4)            4           scalar                    3786,3807                         
 TEXT                       Local  3737     CHAR            36    1     6                         3745,3824                         
 TITLE                      Dummy  3730     CHAR                        scalar   ARG,INOUT        3756,3824                         

Page 126         Source Listing                  MSTATS
2017-04-18 11:09                                 profcqc.f

   3853   106 FORMAT(//)
   3854 
   3855       END

Page 127         Source Listing                  MSTATS
2017-04-18 11:09 Subprograms/Common Blocks       profcqc.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 <Block Data>                      352                                                                                              
 BUFRLIB_MISSING            Common 260                                  8                                                           
 BUFRLIB_MISSING            Common 504                                  8                                                           
 BUFRLIB_MISSING            Common 826                                  8                                                           
 BUFRLIB_MISSING            Common 1178                                 8                                                           
 BUFRLIB_MISSING            Common 1496                                 8                                                           
 BUFRLIB_MISSING            Common 1636                                 8                                                           
 BUFRLIB_MISSING            Common 1881                                 8                                                           
 BUFRLIB_MISSING            Common 1965                                 8                                                           
 BUFRLIB_MISSING            Common 2057                                 8                                                           
 BUFRLIB_MISSING            Common 2170                                 8                                                           
 BUFRLIB_MISSING            Common 3207                                 8                                                           
 BUFRLIB_MISSING            Common 3505                                 8                                                           
 CHECKS                     Subr   803                                                                                              
 CSTATS                     Subr   1147                                                                                             
 DATEZ                      Common 489                                  240056                                                      
 DATEZ                      Common 1154                                 240056                                                      
 DATEZ                      Common 2570                                 240056                                                      
 DATEZ                      Common 2755                                 240056                                                      
 DATEZ                      Common 2925                                 240056                                                      
 DATEZ                      Common 3206                                 240056                                                      
 DATEZ                      Common 3741                                 240056                                                      
 DIFS                       Subr   1476                                                                                             
 DMA                        Subr   1613                                                                                             
 EVENT                      Subr   1875                                                                                             
 HEADER                     Common 490                                  40                                                          
 HEADER                     Common 2756                                 40                                                          
 HEADER                     Common 2928                                 40                                                          
 INCR                       Subr   1943                                                                                             
 INDICATE                   Subr   2034                                                                                             
 INIT                       Subr   2141                                                                                             
 ISDONE                     Subr   2259                                                                                             
 ISORT                      Subr   2318                                                                                             
 LIMITS                     Common 358                                  162500                                                      
 LIMITS                     Common 821                                  162500                                                      
 LIMITS                     Common 1493                                 162496                                                      
 LIMITS                     Common 1635                                 162500                                                      
 LIMITS                     Common 2054                                 162500                                                      
 MODQUAL                    Subr   2367                                                                                             
 MSTATS                     Subr   3730                                                                                             
 PARAMS                     Common 250                                  40                                                          
 PARAMS                     Common 359                                  40                                                          
 PARAMS                     Common 487                                  40                                                          
 PARAMS                     Common 822                                  40                                                          
 PARAMS                     Common 1163                                 40                                                          
 PARAMS                     Common 1491                                 40                                                          
 PARAMS                     Common 1633                                 40                                                          
 PARAMS                     Common 1958                                 40                                                          
 PARAMS                     Common 2052                                 40                                                          
 PARAMS                     Common 2158                                 40                                                          
 PARAMS                     Common 2263                                 40                                                          

Page 128         Source Listing                  MSTATS
2017-04-18 11:09 Subprograms/Common Blocks       profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PARAMS                     Common 2376                                 40                                                          
 PARAMS                     Common 2568                                 40                                                          
 PARAMS                     Common 2769                                 40                                                          
 PARAMS                     Common 2926                                 40                                                          
 PARAMS                     Common 3136                                 40                                                          
 PARAMS                     Common 3201                                 40                                                          
 PARAMS                     Common 3503                                 40                                                          
 PLINT                      Subr   2439                                                                                             
 PREPOBS_PROFCQC            Prog   240                                                                                              
 PRNTDATA                   Subr   2559                                                                                             
 PROBS                      Common 491                                  10200                                                       
 PROBS                      Common 2757                                 10200                                                       
 PROBS                      Common 2930                                 10200                                                       
 PROFP                      Common 496                                  57600000                                                    
 PROFP                      Common 2151                                 57600000                                                    
 PROFP                      Common 2762                                 57600000                                                    
 PROFP                      Common 3197                                 57600000                                                    
 PROFZ                      Common 493                                  72000000                                                    
 PROFZ                      Common 810                                  72000000                                                    
 PROFZ                      Common 1155                                 72000000                                                    
 PROFZ                      Common 1627                                 72000000                                                    
 PROFZ                      Common 1950                                 72000000                                                    
 PROFZ                      Common 2041                                 72000000                                                    
 PROFZ                      Common 2148                                 72000000                                                    
 PROFZ                      Common 2571                                 72000000                                                    
 PROFZ                      Common 2759                                 72000000                                                    
 PROFZ                      Common 3125                                 72000000                                                    
 PROFZ                      Common 3194                                 72000000                                                    
 PROFZ                      Common 3492                                 72000000                                                    
 PST                        Common 258                                  92                                                          
 PST                        Common 356                                  92                                                          
 PST                        Common 1175                                 92                                                          
 PST                        Common 3621                                 92                                                          
 PST                        Common 3742                                 92                                                          
 PSTAT                      Subr   3607                                                                                             
 PUTDATA                    Subr   2746                                                                                             
 QUAL                       Common 498                                  43296960                                                    
 QUAL                       Common 818                                  43296960                                                    
 QUAL                       Common 1167                                 43296960                                                    
 QUAL                       Common 1488                                 43296960                                                    
 QUAL                       Common 1630                                 43296960                                                    
 QUAL                       Common 1960                                 43296960                                                    
 QUAL                       Common 2049                                 43296960                                                    
 QUAL                       Common 2153                                 43296960                                                    
 QUAL                       Common 2373                                 43296960                                                    
 QUAL                       Common 2579                                 43296960                                                    
 QUAL                       Common 2764                                 43296960                                                    
 QUAL                       Common 3133                                 43296960                                                    
 QUAL                       Common 3203                                 43296960                                                    
 QUAL                       Common 3500                                 43296960                                                    
 READPROF                   Subr   2914                                                                                             
 RESIDS                     Common 813                                  15840000                                                    
 RESIDS                     Common 1158                                 15840000                                                    
 RESIDS                     Common 1483                                 15840000                                                    
 RESIDS                     Common 1622                                 15840000                                                    

Page 129         Source Listing                  MSTATS
2017-04-18 11:09 Subprograms/Common Blocks       profcqc.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RESIDS                     Common 1953                                 15840000                                                    
 RESIDS                     Common 2044                                 15840000                                                    
 RESIDS                     Common 2160                                 15840000                                                    
 RESIDS                     Common 2574                                 15840000                                                    
 RESIDS                     Common 3128                                 15840000                                                    
 RESIDS                     Common 3495                                 15840000                                                    
 RESIDUAL                   Subr   3121                                                                                             
 RESTRUCT                   Subr   3181                                                                                             
 SHELL                      Subr   3356                                                                                             
 SORT                       Subr   3432                                                                                             
 STATZ                      Common 253                                  9072000                                                     
 STATZ                      Common 1170                                 9072000                                                     
 STATZ                      Common 2165                                 9072000                                                     
 STATZ                      Common 3614                                 9072000                                                     
 STNLST                     Common 248                                  51360                                                       
 STNLST                     Common 501                                  51360                                                       
 STNLST                     Common 824                                  51360                                                       
 STNLST                     Common 1165                                 51360                                                       
 STNLST                     Common 1494                                 51360                                                       
 STNLST                     Common 1620                                 51360                                                       
 STNLST                     Common 1963                                 51360                                                       
 STNLST                     Common 2055                                 51360                                                       
 STNLST                     Common 2156                                 51360                                                       
 STNLST                     Common 2378                                 51360                                                       
 STNLST                     Common 2566                                 51360                                                       
 STNLST                     Common 2767                                 51360                                                       
 STNLST                     Common 3199                                 51360                                                       
 STNLST                     Common 3490                                 51360                                                       
 STNLST                     Common 3619                                 51360                                                       
 TIMEO                      Common 252                                  8                                                           
 TIMEO                      Common 503                                  8                                                           
 TIMEO                      Common 1177                                 8                                                           
 TIMEO                      Common 2380                                 8                                                           
 TIMEO                      Common 2582                                 8                                                           
 TIMEO                      Common 2929                                 8                                                           
 TWODIM                     Subr   3482                                                                                             
 WRITBUFR                   Subr   476                                                                                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases

Page 130         Source Listing                  MSTATS
2017-04-18 11:09                                 profcqc.f

       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape
       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host

Page 131         Source Listing                  MSTATS
2017-04-18 11:09                                 profcqc.f

       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : profcqc.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
