Page 1           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07                                 cqcvad.f

      1 C$$$  MAIN PROGRAM DOCUMENTATION BLOCK
      2 C
      3 C MAIN PROGRAM: PREPOBS_CQCVAD
      4 C   PRGMMR: MELCHIOR         ORG: NP22        DATE: 2016-12-18
      5 C
      6 C ABSTRACT: PERFORM COMPLEX QUALITY CONTROL OF VAD WINDS FROM
      7 C   WSR-88D RADARS.
      8 C
      9 C PROGRAM HISTORY LOG:
     10 C 1999-08-18  W. COLLINS  ORIGINAL AUTHOR
     11 C 1999-10-26  W. COLLINS  ADD DIAGNOSIS TO SCREEN BIRD INFLUENCE
     12 C 2000-10-26  W. COLLINS  GENERALIZE TO ALLOW ANY HEIGHT UP TO
     13 C       35,000 FT.
     14 C 2001-10-08  D. KEYSER   CODE STREAMLINED; NOW TABULATES PERCENT
     15 C       OF LEVELS < 18K FAILING BIRD ALGORITM CHECK ACCORDING TO
     16 C       STATION AND 1-HOUR TIME WINDOWS CENTERED ON 30-MIN PAST
     17 C       HOUR, THIS BIRD Q.C. INFORMATION WRITTEN TO UNIT 52 FOR
     18 C       LATER USE BY 3DVAR IN Q.C. OF NEXRAD RADIAL VELOCITY DATA;
     19 C       CORRECTED ERROR WHICH HAD RESULTED IN NO Q.C. PERFORMED ON
     20 C       LEVELS WHERE EITHER THE U- OR V- INCREMENT WAS ZERO; VALID
     21 C       DATES FOR CHECKING FOR MIGRATING BIRDS EXPANDED FROM 2/15
     22 C       THROUGH 6/15 TO 2/1 THROUGH 6/30 IN SPRING AND FROM 8/15
     23 C       THROUGH 11/15 TO 8/1 THROUGH 11/30 IN FALL; LIMITING
     24 C       V-WIND INCREMENT FOR APPLYING BIRD CONTAMINATION TIGHTENED
     25 C       FROM +8 TO +5 M/S IN SPRING AND FROM -8 TO -5 M/S IN FALL,
     26 C       MORE LEVELS WILL NOW BE FLAGGED
     27 C 2012-03-05  S. MELCHIOR  CODE FURTHER STREAMLINED. CORRECTED VARIOUS
     28 C       TYPO'S IN LEGACY DOCUMENTATION. ADDED MORE CONCISE DESCRIPTIONS
     29 C       TO LEGACY DOCUMENTATION. ADDED MORE COMPLETE DIAGNOSTIC OUTPUT
     30 C       STATEMENTS FOR INSTANCES WHEN SPECIFIC DO LOOPS ARE OUT OF
     31 C       BOUNDS AND WHEN CONDITIONAL STATEMENTS ARE NOT MET. ADDED MORE
     32 C       CONCISE COMMENTS TO IDENTIFY DO LOOP BOUNDARIES. CORRECTED A DO
     33 C       LOOP TERMINUS PARAMETER FROM NLEV TO NLV IN SUBROUTINE COMSTAT.
     34 C       ADDED A MISSING RETURN STATEMENT TO SUBROUTINE HT. UPDATED
     35 C       SUBROUTINE DISTR TO BE MORE FLEXIBLE AND UTILIZE NDIV AND NX AS
     36 C       ARRAY LIMITS RATHER THAN THE HARD CODED 23 AND 899,
     37 C       RESPECTIVELY. EXTENDED MSK ARRAY ALLOCATION FROM 899 TO 1000 IN
     38 C       SUBROUTINES INCDIST AND RESDIST TO ALLOW FOR MORE STATION
     39 C       STATISTICS TO BE PROCESSED - ON OCCASION THE 899 LIMIT HAD BEEN
     40 C       MET AND EXCEEDED CAUSING MEMORY LEAKS. UPDATED SUBROUTINE
     41 C       EVNOUT TO USE INCOMING ARGUMENT NLV TO DEFINE MEMORY ALLOCATION
     42 C       FOR VARIOUS REAL AND INTEGER ARRAYS. THIS MAKES THE SUBROUTINE
     43 C       MORE ROBUST AND EFFICIENT BY ONLY ALLOTTING THE MEMORY SPACE
     44 C       NECESSARY, NOTHING MORE. CREATED SEVERAL NEW PARAMETERS FOR
     45 C       VARIOUS SUBROUTINES TO TIDY UP THE CODE. NTIMES=6 HAS BEEN
     46 C       ADDED TO COMSTAT, GETDAT, INCDIST, INCR, INIT, MATR, DMA,
     47 C       RESDIST, SELECT, SOLVE, ZTOI, AND ZTRES.  NINC=3 HAS BEEN ADDED
     48 C       TO COMSTAT, GETDAT, INCDIST, INCR, INIT, MATR, DMA, RESDIST,
     49 C       SELECT, SOLVE, AND ZTRES.  NEVNT=160000 WAS ADDED TO DMA AND
     50 C       EVNOUT. NDIV=23 HAS BEEN ADED TO INCDIST AND RESDIST.  RENAMED
     51 C       PARAMETER NE TO NME FOR CLARIFICATION SINCE NE IS DIFFICULT TO
     52 C       SEARCH ON AND IS ALSO USED FOR INEQUALITY COMPARISON TESTING
     53 C       (.NE.).  ADDED LOGIC TO TURN OFF BIRD CHECK ALGORITHM FOR VAD
     54 C       WIND REPORTS FROM LEVEL 2 DECODER.  INCREASED NRPT FROM 80000
     55 C       TO 160000 TO ACCOMMODATE VAD WIND REPORTS FROM LEVEL 2 DECODER.
     56 C       CORRECTED BUG IN SUBROUTINE GETDAT TO PROPERLY HANDLE SITUATION
     57 C       WHEN SUBSET IS VADWND AND THE NUMBER OF LEVELS (NUM) EXCEEDS

Page 2           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07                                 cqcvad.f

     58 C       NRPT (160000).
     59 C 2012-11-20  J. WOOLLEN  INITIAL PORT TO WCOSS 
     60 C 2013-02-05  D. Keyser   Final changes to run on WCOSS:  Set BUFRLIB
     61 C       missing (BMISS) to 10E8 rather than 10E10 to avoid integer
     62 C       overflow; rename all REAL(8) variables as *_8.
     63 C 2014-01-15  S. Melchior  Increased NRPT (total number of levels
     64 C       amongst all VAD reports that can be processed) and NEVNT (total
     65 C       number of events amongst all VAD reports that can be processed)
     66 C       both from 160000 to 500000 to accommodate VAD wind reports from
     67 C       Level 2 decoder.
     68 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
     69 C       process) from 200 to 300.  Made minor correction in GETDAT.
     70 C
     71 C USAGE:
     72 C   INPUT FILES:
     73 C     UNIT 11  - INPUT PREPBUFR FILE
     74 C     UNIT 14  - 10-DIGIT TIME (YYYYMMDDHH)
     75 C
     76 C   OUTPUT FILES:
     77 C     UNIT 06  - STANDARD OUTPUT PRINT
     78 C     UNIT 51  - OUTPUT PREPBUFR FILE
     79 C     UNIT 52  - BIRD Q.C. INFORMATION LIST
     80 C     UNIT 53  - FINAL LISTING OF REPORTS WITH Q.C. INFO
     81 C     UNIT 55  - ????????????????????????????
     82 C     UNIT 60  - LISTING OF EVENT INFORMATION
     83 C
     84 C   SUBPROGRAMS CALLED:
     85 C     SYSTEM:    - SYSTEM
     86 C     UNIQUE:    - INIT     GETDAT   INCR     ZTOI     DMA
     87 C                  INCDIST  COMSTAT  RESDIST  CSTATS   VSOLVE
     88 C                  EVENTW   GETOBV   EVNOUT   DISTR    HT
     89 C                  SORTD    DRCTSL   INDEXX   SELECT   MATR
     90 C                  SOLVE    ZTRES    CUMPROB  ANLWT    BLOCK DATA
     91 C     LIBRARY:
     92 C       W3NCO    - W3TAGB   W3TAGE   W3MOVDAT W3DIFDAT
     93 C       BUFRLIB  - DATELEN  CLOSBF   OPENBF   READMG   UFBQCD
     94 C                  CLOSMG   COPYMG   OPENMB   READSB   UFBCPY
     95 C                  WRITSB   UFBINT   SETBMISS GETBMISS
     96 C
     97 C   EXIT STATES:
     98 C     COND =   0 - SUCCESSFUL RUN
     99 C
    100 C REMARKS:
    101 C
    102 C    CONTENTS OF NAMELIST SWITCH "NAMLST"
    103 C        HONOR_FLAGS - LOGICAL, IF TRUE THEN LEVELS WITH BAD Q. MARK
    104 C                      FLAGS ARE HONORED                  (DEFAULT=TRUE)
    105 C        PRINT_52    - LOGICAL, IF TRUE THEN WRITES BIRD QUALITY
    106 C                      CONTROL INFORMATION TO UNIT 52     (DEFAULT=TRUE)
    107 C        PRINT_53    - LOGICAL, IF TRUE THEN WRITES A FINAL REPORT
    108 C                      LISTING WITH Q.C. INFORMATION TO UNIT 53
    109 C                                                        (DEFAULT=FALSE)
    110 C        PRINT_60    - LOGICAL, IF TRUE THEN WRITES EVENT INFORMATION
    111 C                      TO UNIT 60                        (DEFAULT=FALSE)
    112 C        TEST        - LOGICAL, IF TRUE THEN WRITES DIAGNOSTIC PRINT
    113 C                      TO STDOUT (UNIT 06)               (DEFAULT=FALSE)
    114 C        

Page 3           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07                                 cqcvad.f

    115 C
    116 C ATTRIBUTES:
    117 C   LANGUAGE: FORTRAN 90
    118 C   MACHINE:  NCEP WCOSS
    119 C
    120 C$$$
    121       PROGRAM PREPOBS_CQCVAD
    122 
    123       PARAMETER(NLEV=35)
    124 
    125       integer idat(8),jdat(8),idate_e(4,-3:3),idate_l(4,-3:3)
    126       real    rinc(5)
    127       LOGICAL HONOR_FLAGS, PRINT_52, PRINT_53, PRINT_60, TEST, guess
    128       character*8 stnidx
    129       REAL(8)   BMISS,GETBMISS
    130 
    131       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
    132      &                CQCPC, NEV, NME
    133       COMMON /BIRDST/stnidx(9999,-3:3),alatx(9999,-3:3),
    134      & alonx(9999,-3:3),knt_5_yes(9999,-3:3),knt_5_no(9999,-3:3),
    135      & numrpt(9999,-3:3)
    136       common /datet/  idate(4), itim(6)
    137       common /switches/  print_52, print_53, print_60, test
    138       common /flag/   guess
    139       COMMON /BUFRLIB_MISSING/BMISS
    140 
    141       NAMELIST /NAMLST/ HONOR_FLAGS, PRINT_52, PRINT_53, PRINT_60, TEST
    142 
    143       CALL W3TAGB('PREPOBS_CQCVAD',2016,0353,1200,'NP22')
    144 
    145       PRINT *, ' ==> WELCOME TO CQCVAD, VERSION 2016-12-18 <=='
    146       PRINT *, ' '
    147 
    148 C  Set up default values for namelist switches
    149 C  -------------------------------------------
    150 
    151       HONOR_FLAGS = .TRUE.
    152       PRINT_52    = .TRUE.
    153       PRINT_53    = .FALSE.
    154       PRINT_60    = .FALSE.
    155       TEST        = .FALSE.
    156 
    157       READ(5,NAMLST,ERR=10,END=10)
    158    10 CONTINUE
    159       WRITE(6,NAMLST)
    160 
    161 C  On WCOSS should always set BUFRLIB missing (BMISS) to 10E8 to avoid
    162 C   overflow when either an INTEGER*4 variable is set to BMISS or a
    163 C   REAL*8 (or REAL*4) variable that is missing is NINT'd
    164 C  -------------------------------------------------------------------
    165 ccccc CALL SETBMISS(10E10_8)
    166       CALL SETBMISS(10E8_8)
    167       BMISS=GETBMISS()
    168       print *
    169       print *, 'BUFRLIB value for missing is: ',bmiss
    170       print *
    171 

Page 4           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07                                 cqcvad.f

    172 C  PROGRAM TO QUALITY CONTROL VADWINDS
    173 C  -----------------------------------
    174 
    175       CALL INIT
    176 
    177 C  GET DATA AND PUT INTO LINEAR ARRAY
    178 C  ----------------------------------
    179 
    180       ITIME = 1
    181       CALL GETDAT(ITIME)
    182 
    183 C  OBTAIN INCREMENTS
    184 C  -----------------
    185 
    186       CALL INCR
    187 
    188 C  PERFORM OI IN HEIGHT-TIME PLANE (unless no first guess)
    189 C  -------------------------------------------------------
    190 
    191       if (guess) CALL ZTOI
    192 
    193 C  DECISION-MAKING ALGORITHM, ALSO SAVE EVENTS
    194 C  -------------------------------------------
    195 
    196       CALL DMA(HONOR_FLAGS)
    197 
    198 C  GET STATISTICAL DISTRIBUTIONS OF INCREMENTS (unless no first guess)
    199 C  -------------------------------------------------------------------
    200 
    201       if (guess) CALL INCDIST
    202 
    203 C  COMPUTE STATISTICS BASED UPON DELTA-T AND DELTA-Z
    204 C  -------------------------------------------------
    205 
    206       CALL COMSTAT
    207 
    208 C  GET STATISTICAL DISTRIBUTION OF RESIDUALS (unless no first guess)
    209 C  -----------------------------------------------------------------
    210 
    211       if (guess) CALL RESDIST
    212 
    213 C  READ DATA A SECOND TIME AND WRITE EVENTS
    214 C  ----------------------------------------
    215 
    216       ITIME = 2
    217       CALL GETDAT(ITIME)
    218 
    219       if(print_52)  then
    220 
    221 C  WRITE BIRD Q.C. INFORMATION TO UNIT 52
    222 C  --------------------------------------
    223 
    224          write(52,'("===> VAD WIND BIRD MIGRATION Q.C. INFORMATION")')
    225          write(52,'(/6x,"Only levels below 18,000 ft are considered")')
    226          write(52,'(6x,"Stations are parsed into 1-hour time blocks")')
    227          write(52,'(/6x,"PREPBUFR CENTER TIME IS: ",i4,3i2.2//)') idate
    228          write(52,'(" STNID   LAT(N)   LON(E)",9x,"TIME RANGE",10x, ' //

Page 5           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07                                 cqcvad.f

    229      &    '"# LVLS =< 18K FT    # OF RPTS    % LVLS FLAGGED BY BIRD",'//
    230      &    '" ALG.")')
    231          write(52,'(1x,5("-"),3x,6("-"),3x,6("-"),3x,23("-"),3x,' //
    232      &    '16("-"),4x,9("-"),4x,27("-")/)')
    233          idate_e   = 0
    234          idate_l   = 0
    235          idat      = 0
    236          idat(1:3) = idate(1:3)
    237          idat(5)   = idate(4)
    238          rinc      = 0
    239          do  jtim = -3,3
    240             rinc(2)   = jtim - 1
    241             if(jtim.eq.-3)  then
    242                call w3movdat(rinc,idat,jdat)
    243                idate_e(1:3,jtim) = jdat(1:3)
    244                idate_e(4,jtim)   = jdat(5)
    245             else
    246                idate_e(:,jtim) = idate_l(:,jtim-1)
    247                jdat = idat
    248             end if
    249             idat = 0
    250             rinc(2)   = 1
    251             call w3movdat(rinc,jdat,idat)
    252             idate_l(1:3,jtim) = idat(1:3)
    253             idate_l(4,jtim)   = idat(5)
    254          end do
    255          do irep = 1,9999
    256             do jtim = -3,3
    257                if(stnidx(irep,jtim)(1:1).ne.'X')  then
    258                   if(knt_5_yes(irep,jtim)+knt_5_no(irep,jtim).gt.0) then
    259                      percent_5 = (knt_5_yes(irep,jtim)*100.)/
    260      &                        (knt_5_yes(irep,jtim)+knt_5_no(irep,jtim))
    261                   else
    262                      percent_5 = 0.
    263                   end if
    264                write(52,501) stnidx(irep,jtim),alatx(irep,jtim),
    265      &                       alonx(irep,jtim),idate_e(:,jtim),
    266      &                       idate_l(:,jtim),
    267      &                       knt_5_yes(irep,jtim)+knt_5_no(irep,jtim),
    268      &                       numrpt(irep,jtim),percent_5
    269  501  format(a8,1x,f6.2,3x,f6.2,3x,i4,3i2.2,' - ',i4,3i2.2,8x,i5,12x,i3,
    270      & 19x,f5.1)
    271                end if
    272             end do
    273          end do
    274       end if
    275 
    276       CALL W3TAGE('PREPOBS_CQCVAD')
    277 
    278       STOP
    279       END

Page 6           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name              
                    
 MAIN__             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 10                         Label  158                                                            157                               
 501                        Label  269                                                            264                               
 ALATX                      Scalar 133      R(4)            4     2     69993    COM              264                               
 ALONX                      Scalar 134      R(4)            4     2     69993    COM              265                               
 BIRDST                     Common 133                                  1959804                                                     
 BMISS                      Scalar 129      R(8)            8           scalar   COM              167,169                           
 BUFRLIB_MISSING            Common 139                                  8                                                           
 COMSTAT                    Subr   206                                                            206                               
 CON                        Scalar 131      R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 132      R(4)            4           scalar   COM                                                
 DATET                      Common 136                                  40                                                          
 DMA                        Subr   196                                                            196                               
 FLAG                       Common 138                                  4                                                           
 GETBMISS                   Func   129      R(8)            8           scalar                    167                               
 GETDAT                     Subr   181                                                            181,217                           
 GUESS                      Scalar 127      L(4)            4           scalar   COM              191,201,211                       
 HONOR_FLAGS                Local  127      L(4)            4           scalar                    141,151,196                       
 IDAT                       Local  125      I(4)            4     1     8                         235,236,237,242,247,249,251,252,25
                                                                                                  3                                 
 IDATE                      Scalar 136      I(4)            4     1     4        COM              227,236,237                       
 IDATE_E                    Local  125      I(4)            4     2     28                        233,243,244,246,265               
 IDATE_L                    Local  125      I(4)            4     2     28                        234,246,252,253,266               
 IHE                        Scalar 131      I(4)            4           scalar   COM                                                
 INCDIST                    Subr   201                                                            201                               
 INCR                       Subr   186                                                            186                               
 INIT                       Subr   175                                                            175                               
 IOUT                       Scalar 131      I(4)            4           scalar   COM                                                
 IREP                       Local  255      I(4)            4           scalar                    255,257,258,259,260,264,265,267,26
                                                                                                  8                                 
 ITIM                       Scalar 136      I(4)            4     1     6        COM                                                
 ITIME                      Local  180      I(4)            4           scalar                    180,181,216,217                   
 IUNIT                      Scalar 131      I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 131      I(4)            4           scalar   COM                                                
 JDAT                       Local  125      I(4)            4     1     8                         242,243,244,247,251               
 JTIM                       Local  239      I(4)            4           scalar                    239,240,241,243,244,246,252,253,25
                                                                                                  6,257,258,259,260,264,265,266,267,
                                                                                                  268                               
 KNT_5_NO                   Scalar 134      I(4)            4     2     69993    COM              258,260,267                       
 KNT_5_YES                  Scalar 134      I(4)            4     2     69993    COM              258,259,260,267                   
 NAMLST                     Local  141                                  scalar                    157,159                           
 NEV                        Scalar 132      I(4)            4           scalar   COM                                                
 NLEV                       Param  123      I(4)            4           scalar                                                      
 NME                        Scalar 132      I(4)            4           scalar   COM                                                
 NST                        Scalar 131      I(4)            4           scalar   COM                                                

Page 7           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NUM                        Scalar 131      I(4)            4           scalar   COM                                                
 NUMRPT                     Scalar 135      I(4)            4     2     69993    COM              268                               
 PARAMS                     Common 131                                  40                                                          
 PERCENT_5                  Local  259      R(4)            4           scalar                    259,262,268                       
 PREPOBS_CQCVAD             Prog   121                                                                                              
 PRINT_52                   Scalar 127      L(4)            4           scalar   COM              141,152,219                       
 PRINT_53                   Scalar 127      L(4)            4           scalar   COM              141,153                           
 PRINT_60                   Scalar 127      L(4)            4           scalar   COM              141,154                           
 RESDIST                    Subr   211                                                            211                               
 RINC                       Local  126      R(4)            4     1     5                         238,240,242,250,251               
 SETBMISS                   Subr   166                                                            166                               
 STNIDX                     Scalar 128      CHAR            8     2     69993    COM              257,264                           
 SWITCHES                   Common 137                                  16                                                          
 TEST                       Scalar 127      L(4)            4           scalar   COM              141,155                           
 W3MOVDAT                   Subr   242                                                            242,251                           
 W3TAGB                     Subr   143                                                            143                               
 W3TAGE                     Subr   276                                                            276                               
 ZTOI                       Subr   191                                                            191                               

Page 8           Source Listing                  PREPOBS_CQCVAD
2017-04-18 11:07                                 cqcvad.f

    280 
    281 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    282 C
    283 C SUBPROGRAM: BLOCK DATA
    284 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-08-18
    285 C
    286 C ABSTRACT: BLOCK DATA
    287 C
    288 C PROGRAM HISTORY LOG:
    289 C 1999-08-18  W. COLLINS
    290 C 2012-03-05  S. MELCHIOR  RENAMED NE TO NME FOR EASE OF NAVIGATION AND
    291 C       FOR CLARIFICATION SINCE NE IS ALSO USED FOR INEQUALITY TESTING
    292 C       (.NE.). INCREASED NEV FROM 80000 TO 160000 TO ACCOMMODATE VAD
    293 C       WIND REPORTS FROM LEVEL 2 DECODER.
    294 C
    295 C ATTRIBUTES:
    296 C   LANGUAGE: FORTRAN 90
    297 C   MACHINE:  NCEP WCOSS
    298 C
    299 C$$$
    300       BLOCK DATA
    301       PARAMETER (NLEV=35)
    302       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
    303      &                CQCPC, NEV, NME
    304       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
    305       COMMON /CONSTS/ MAT,E,AA,B,XL,R
    306       COMMON /BIRDST/stnidx(9999,-3:3),alatx(9999,-3:3),
    307      & alonx(9999,-3:3),knt_5_yes(9999,-3:3),knt_5_no(9999,-3:3),
    308      & numrpt(9999,-3:3)
    309       common /flag/   guess
    310       character*8 stnidx
    311       logical guess
    312       DATA IUNIT /11/, IUTIM /14/, IOUT /51/
    313       DATA CON /304.8/
    314       DATA IHE /-3/
    315       DATA NEV /160000/
    316       DATA IZLEV /1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,
    317      &  19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35/
    318       DATA MAT /9/, E /.1/, B /.67/, XL /2.3/, R /1.5/
    319       DATA AA /.25/
    320       data stnidx/69993*'XXXXXXXX'/
    321       data alatx/69993*99999./,alonx/69993*99999./
    322       data knt_5_yes/69993*0/,knt_5_no/69993*0/,numrpt/69993*0/
    323       data guess/.true./
    324       END

Page 9           Source Listing                  _unnamed_data$_
2017-04-18 11:07                                 cqcvad.f

    325 
    326 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    327 C
    328 C SUBPROGRAM: COMSTAT
    329 C   PRGMMR: S. Melchior      ORG: NP22       DATE: 2016-12-18
    330 C
    331 C ABSTRACT: COMPUTE STATISTICS FOR HEIGHT-TIME INCREMENT INTERPOLATION.
    332 C
    333 C PROGRAM HISTORY LOG:
    334 C 1999-08-18  W. COLLINS
    335 C 2012-03-05  S. MELCHIOR  CORRECTED DO LOOP TERMINUS PARAMETER FROM
    336 C       NLEV TO NLV. ALSO ADDED PARAMETERS NTIMES=6 AND NINC=3 TO TIDY
    337 C       UP THE CODE.  RENAMED NE TO NME FOR EASE OF NAVIGATION AND FOR
    338 C       CLARIFICATION SINCE NE IS ALSO USED FOR INEQUALITY TESTING
    339 C       (.NE.). INCREASED NEV FROM 80000 TO 160000 TO ACCOMMODATE VAD
    340 C       WIND REPORTS FROM LEVEL 2 DECODER.
    341 C 2014-01-15  S. Melchior  Increased NRPT (total number of levels
    342 C       amongst all VAD reports that can be processed) from 160000 to
    343 C       500000 to accommodate VAD wind reports from Level 2 decoder.
    344 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
    345 C       process) from 200 to 300.
    346 C
    347 C USAGE:    CALL COMSTAT
    348 C
    349 C ATTRIBUTES:
    350 C   LANGUAGE: FORTRAN 90
    351 C   MACHINE:  NCEP WCOSS
    352 C
    353 C$$$
    354       SUBROUTINE COMSTAT
    355 
    356       PARAMETER (NL=34,NTIM=5,NTIMES=6,NRPT=500000,NSTN=300)
    357       PARAMETER (NLEV=35,NINC=3)
    358       INTEGER N12(0:NL,0:NTIM)
    359       REAL    U1(0:NL,0:NTIM),   V1(0:NL,0:NTIM),
    360      &        U1S(0:NL,0:NTIM),  V1S(0:NL,0:NTIM),
    361      &        U2(0:NL,0:NTIM),   V2(0:NL,0:NTIM),
    362      &        U2S(0:NL,0:NTIM),  V2S(0:NL,0:NTIM),
    363      &        U12(0:NL,0:NTIM),  V12(0:NL,0:NTIM),
    364      &        U1B(0:NL,0:NTIM),  U2B(0:NL,0:NTIM),
    365      &        V1B(0:NL,0:NTIM),  V2B(0:NL,0:NTIM),
    366      &        U1SD(0:NL,0:NTIM), V1SD(0:NL,0:NTIM),
    367      &        U2SD(0:NL,0:NTIM), V2SD(0:NL,0:NTIM),
    368      &        U12V(0:NL,0:NTIM), V12V(0:NL,0:NTIM),
    369      &        U12R(0:NL,0:NTIM), V12R(0:NL,0:NTIM)
    370       REAL(8)   BMISS
    371 
    372       COMMON /SINGLE/ ZOB(NRPT), ITM(NRPT),TIM(NRPT),
    373      &                UOB(NRPT), VOB(NRPT), LOB(NRPT),
    374      &                XLA(NRPT), XLO(NRPT), ZST(NRPT),
    375      &                UFF(NRPT), VFF(NRPT), TFF(NRPT),
    376      &                WQM(NRPT)
    377       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
    378      &                VIN(NLEV,NTIMES,NINC,NSTN),
    379      &                UUU(NLEV,NTIMES,NINC,NSTN),
    380      &                VVV(NLEV,NTIMES,NINC,NSTN),
    381      &                TIMIN(NLEV,NTIMES,NINC,NSTN),

Page 10          Source Listing                  COMSTAT
2017-04-18 11:07                                 cqcvad.f

    382      &                NIN(NLEV,NTIMES,NSTN),
    383      &                LLL(NLEV,NTIMES,NINC,NSTN),
    384      &                TFC(NLEV,NTIMES,NINC,NSTN),
    385      &                QQQ(NLEV,NTIMES,NINC,NSTN)
    386       COMMON /DATET/  IDATE(4), ITIM(6)
    387       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
    388      &                CQCPC, NEV, NME
    389       COMMON /BUFRLIB_MISSING/BMISS
    390       COMMON /HTS/    IZLEV(NLEV), ZLEV(NLEV)
    391       COMMON /DMATYP/ IQC(NLEV,NTIMES,NINC,NSTN)
    392 
    393 C  INITIALIZE STATISTICS
    394 C  ---------------------
    395 
    396       N12  = 0
    397       U1   = 0.
    398       V1   = 0.
    399       U1S  = 0.
    400       V1S  = 0.
    401       U2   = 0.
    402       V2   = 0.
    403       U2S  = 0.
    404       V2S  = 0.
    405       U12  = 0.
    406       V12  = 0.
    407       U1B  = 0.
    408       U2B  = 0.
    409       V1B  = 0.
    410       V2B  = 0.
    411       U1SD = 0.
    412       V1SD = 0.
    413       U2SD = 0.
    414       V2SD = 0.
    415       U12V = 0.
    416       V12V = 0.
    417       U12R = 0.
    418       V12R = 0.
    419 
    420 C  COLLECT STATISTICS BY TIME AND HEIGHT DIFFERENCES
    421 C  -------------------------------------------------
    422       DO IS=1,NST ! nst max is nstn=300
    423         DO L=1,NLEV ! nlev max is 35
    424           DO I=1,NTIMES ! ntimes max is 6
    425            DO IT=1,NIN(L,I,IS) !  nin(L,I,IS) max is 3
    426             DO LL=1,NLEV ! nlev max is 35
    427               DO II=1,NTIMES ! ntimes max is 6
    428                DO IIT=1,NIN(LL,II,IS) !  nin(LL,II,IS) max is 3
    429                 IF(MAX(UIN(L,I,IT,IS),UIN(LL,II,IIT,IS),VIN(L,I,IT,IS),
    430      &           VIN(LL,II,IIT,IS)).LT.BMISS .AND.
    431      &           IQC(L,I,IT,IS).EQ.0 .AND. IQC(LL,II,IIT,IS).EQ.0 .AND.
    432      &          .NOT.(TIMIN(L,I,IT,IS).EQ.TIMIN(LL,II,IIT,IS) .AND.
    433      &                                               L.EQ.LL)) THEN
    434                   IDL = ABS(IZLEV(L) - IZLEV(LL)) + 0.5
    435                   IDI = ABS(TIMIN(L,I,IT,IS) - TIMIN(LL,II,IIT,IS))+0.5
    436 	          IF(MIN(IDL,IDI).GE.0 .AND. IDL.LE.NL 
    437      &               .AND. IDI.LE.NTIM) THEN
    438                     N12(IDL,IDI) = N12(IDL,IDI) + 1

Page 11          Source Listing                  COMSTAT
2017-04-18 11:07                                 cqcvad.f

    439                     U1(IDL,IDI)  = U1(IDL,IDI)  + UIN(L,I,IT,IS)
    440                     U1S(IDL,IDI) = U1S(IDL,IDI) + UIN(L,I,IT,IS)**2
    441                     V1(IDL,IDI)  = V1(IDL,IDI)  + VIN(L,I,IT,IS)
    442                     V1S(IDL,IDI) = V1S(IDL,IDI) + VIN(L,I,IT,IS)**2
    443                     U2(IDL,IDI)  = U2(IDL,IDI)  + UIN(LL,II,IIT,IS)
    444                     U2S(IDL,IDI) = U2S(IDL,IDI) + UIN(LL,II,IIT,IS)**2
    445                     V2(IDL,IDI)  = V2(IDL,IDI)  + VIN(LL,II,IIT,IS)
    446                     V2S(IDL,IDI) = V2S(IDL,IDI) + VIN(LL,II,IIT,IS)**2
    447                     U12(IDL,IDI) = U12(IDL,IDI) +
    448      &                                  UIN(L,I,IT,IS)*UIN(LL,II,IIT,IS)
    449                     V12(IDL,IDI) = V12(IDL,IDI) +
    450      &                                  VIN(L,I,IT,IS)*VIN(LL,II,IIT,IS)
    451                   else
    452 C                   WARNING: Either IDL or IDI out of bounds
    453 C                   Cannot calculate stats!
    454 C                   NTIM=5, so IDI=6 will trigger boundary fault.
    455 C                   NL=34; IDL rarely exceeds NL
    456                   ENDIF
    457                 ENDIF
    458                ENDDO
    459               ENDDO
    460             ENDDO
    461            ENDDO
    462           ENDDO
    463         ENDDO
    464       ENDDO
    465 
    466 C  CALCULATE MEAN, STANDARD DEVIATION, CORRELATION COEFFICIENT
    467 C  -----------------------------------------------------------
    468 
    469       DO J=0,NTIM
    470         DO I=0,NL
    471           CALL CSTATS(N12(I,J),U1(I,J),U1S(I,J),U2(I,J),U2S(I,J),
    472      &      U12(I,J),U1B(I,J),U2B(I,J),U1SD(I,J),U2SD(I,J),U12V(I,J),
    473      &      U12R(I,J))
    474           CALL CSTATS(N12(I,J),V1(I,J),V1S(I,J),V2(I,J),V2S(I,J),
    475      &      V12(I,J),V1B(I,J),V2B(I,J),V1SD(I,J),V2SD(I,J),V12V(I,J),
    476      &      V12R(I,J))
    477         ENDDO
    478       ENDDO
    479 
    480 C  PRINT RESULTS
    481 C  -------------
    482 
    483       WRITE(6,500) (ITIM(I),I=1,NTIM+1)
    484   500 FORMAT(/' TIMES: ',6I12)
    485       WRITE(6,501)
    486       DO I=0,NL
    487         WRITE(6,502) I,(N12(I,J),J=0,NTIM)
    488       ENDDO
    489   501 FORMAT(/' Count:',/,
    490      &       22X,'TIME DIFFERENCE (hours)'/
    491      &       '   DZ         0         1         2',
    492      &       '         3         4         5')
    493   502 FORMAT(I5,6I10)
    494 
    495       WRITE(6,500) (ITIM(I),I=1,NTIM)

Page 12          Source Listing                  COMSTAT
2017-04-18 11:07                                 cqcvad.f

    496       WRITE(6,503)
    497       DO I=0,NL
    498         WRITE(6,507) I,(U1SD(I,J),J=0,NTIM)
    499       ENDDO
    500   503 FORMAT(/' Standard Deviation, u-comp for data',
    501      &       ' at same (dz,dt):',/,
    502      &       5X,'TIME DIFFERENCE (hours)'/
    503      &       '   DZ    0    1    2    3    4    5')
    504 
    505       WRITE(6,500) (ITIM(I),I=1,NTIM+1)
    506       WRITE(6,504)
    507       DO I=0,NL
    508         WRITE(6,507) I,(V1SD(I,J),J=0,NTIM)
    509       ENDDO
    510   504 FORMAT(/' Standard Deviation, v-comp for data',
    511      &       ' at same (dz,dt):',/,
    512      &       5X,'TIME DIFFERENCE (hours)'/
    513      &       '   DZ    0    1    2    3    4    5')
    514 
    515       WRITE(6,500) (ITIM(I),I=1,NTIM)
    516       WRITE(6,505)
    517       DO I=0,NL
    518         WRITE(6,508) I,(U12R(I,J),J=0,NTIM)
    519       ENDDO
    520   505 FORMAT(/' Correlation Coefficient, u-comp for data',
    521      &       ' at same (dz,dt):',/,
    522      &       5X,'TIME DIFFERENCE (hours)'/
    523      &       '   DZ    0    1    2    3    4    5')
    524 
    525       WRITE(6,500) (ITIM(I),I=1,NTIM)
    526       WRITE(6,506)
    527       DO I=0,NL
    528         WRITE(6,508) I,(V12R(I,J),J=0,NTIM)
    529       ENDDO
    530   506 FORMAT(/' Correlation Coefficient, v-comp for data',
    531      &       ' at same (dz,dt):',/,
    532      &       5X,'TIME DIFFERENCE (hours)'/
    533      &       '   DZ    0    1    2    3    4    5')
    534 
    535   507 FORMAT(I5,6F5.1)
    536   508 FORMAT(I5,6F5.2)
    537 
    538       RETURN
    539       END

Page 13          Source Listing                  COMSTAT
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name                
                      
 comstat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  484                                                            483,495,505,515,525               
 501                        Label  489                                                            485                               
 502                        Label  493                                                            487                               
 503                        Label  500                                                            496                               
 504                        Label  510                                                            506                               
 505                        Label  520                                                            516                               
 506                        Label  530                                                            526                               
 507                        Label  535                                                            498,508                           
 508                        Label  536                                                            518,528                           
 ABS                        Func   434                                  scalar                    434,435                           
 BMISS                      Scalar 370      R(8)            8           scalar   COM              430                               
 BUFRLIB_MISSING            Common 389                                  8                                                           
 COMSTAT                    Subr   354                                                                                              
 CON                        Scalar 387      R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 388      R(4)            4           scalar   COM                                                
 CSTATS                     Subr   471                                                            471,474                           
 DATET                      Common 386                                  40                                                          
 DMATYP                     Common 391                                  756000                                                      
 HTS                        Common 390                                  280                                                         
 I                          Local  424      I(4)            4           scalar                    424,425,429,431,432,435,439,440,44
                                                                                                  1,442,448,450,470,471,472,473,474,
                                                                                                  475,476,483,486,487,495,497,498,50
                                                                                                  5,507,508,515,517,518,525,527,528 
 IDATE                      Scalar 386      I(4)            4     1     4        COM                                                
 IDI                        Local  435      I(4)            4           scalar                    435,436,437,438,439,440,441,442,44
                                                                                                  3,444,445,446,447,449             
 IDL                        Local  434      I(4)            4           scalar                    434,436,438,439,440,441,442,443,44
                                                                                                  4,445,446,447,449                 
 IHE                        Scalar 387      I(4)            4           scalar   COM                                                
 II                         Local  427      I(4)            4           scalar                    427,428,429,430,431,432,435,443,44
                                                                                                  4,445,446,448,450                 
 IIT                        Local  428      I(4)            4           scalar                    428,429,430,431,432,435,443,444,44
                                                                                                  5,446,448,450                     
 INCS                       Common 377                                  6300000                                                     
 IOUT                       Scalar 387      I(4)            4           scalar   COM                                                
 IQC                        Scalar 391      I(4)            4     4     189000   COM              431                               
 IS                         Local  422      I(4)            4           scalar                    422,425,428,429,430,431,432,435,43
                                                                                                  9,440,441,442,443,444,445,446,448,
                                                                                                  450                               
 IT                         Local  425      I(4)            4           scalar                    425,429,431,432,435,439,440,441,44
                                                                                                  2,448,450                         
 ITIM                       Scalar 386      I(4)            4     1     6        COM              483,495,505,515,525               
 ITM                        Scalar 372      I(4)            4     1     500000   COM                                                
 IUNIT                      Scalar 387      I(4)            4           scalar   COM                                                

Page 14          Source Listing                  COMSTAT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IUTIM                      Scalar 387      I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 390      I(4)            4     1     35       COM              434                               
 J                          Local  469      I(4)            4           scalar                    469,471,472,473,474,475,476,487,49
                                                                                                  8,508,518,528                     
 L                          Local  423      I(4)            4           scalar                    423,425,429,431,432,433,434,435,43
                                                                                                  9,440,441,442,448,450             
 LL                         Local  426      I(4)            4           scalar                    426,428,429,430,431,432,433,434,43
                                                                                                  5,443,444,445,446,448,450         
 LLL                        Scalar 383      I(4)            4     4     189000   COM                                                
 LOB                        Scalar 373      I(4)            4     1     500000   COM                                                
 MAX                        Func   429                                  scalar                    429                               
 MIN                        Func   436                                  scalar                    436                               
 N12                        Local  358      I(4)            4     2     210                       396,438,471,474,487               
 NEV                        Scalar 388      I(4)            4           scalar   COM                                                
 NIN                        Scalar 382      I(4)            4     3     63000    COM              425,428                           
 NINC                       Param  357      I(4)            4           scalar                    377,378,379,380,381,383,384,385,39
                                                                                                  1                                 
 NL                         Param  356      I(4)            4           scalar                    358,359,360,361,362,363,364,365,36
                                                                                                  6,367,368,369,436,470,486,497,507,
                                                                                                  517,527                           
 NLEV                       Param  357      I(4)            4           scalar                    377,378,379,380,381,382,383,384,38
                                                                                                  5,390,391,423,426                 
 NME                        Scalar 388      I(4)            4           scalar   COM                                                
 NRPT                       Param  356      I(4)            4           scalar                    372,373,374,375,376               
 NST                        Scalar 387      I(4)            4           scalar   COM              422                               
 NSTN                       Param  356      I(4)            4           scalar                    377,378,379,380,381,382,383,384,38
                                                                                                  5,391                             
 NTIM                       Param  356      I(4)            4           scalar                    358,359,360,361,362,363,364,365,36
                                                                                                  6,367,368,369,437,469,483,487,495,
                                                                                                  498,505,508,515,518,525,528       
 NTIMES                     Param  356      I(4)            4           scalar                    377,378,379,380,381,382,383,384,38
                                                                                                  5,391,424,427                     
 NUM                        Scalar 387      I(4)            4           scalar   COM                                                
 PARAMS                     Common 387                                  40                                                          
 QQQ                        Scalar 385      R(4)            4     4     189000   COM                                                
 SINGLE                     Common 372                                  26000000                                                    
 TFC                        Scalar 384      R(4)            4     4     189000   COM                                                
 TFF                        Scalar 375      R(4)            4     1     500000   COM                                                
 TIM                        Scalar 372      R(4)            4     1     500000   COM                                                
 TIMIN                      Scalar 381      R(4)            4     4     189000   COM              432,435                           
 U1                         Local  359      R(4)            4     2     210                       397,439,471                       
 U12                        Local  363      R(4)            4     2     210                       405,447,472                       
 U12R                       Local  369      R(4)            4     2     210                       417,473,518                       
 U12V                       Local  368      R(4)            4     2     210                       415,472                           
 U1B                        Local  364      R(4)            4     2     210                       407,472                           
 U1S                        Local  360      R(4)            4     2     210                       399,440,471                       
 U1SD                       Local  366      R(4)            4     2     210                       411,472,498                       
 U2                         Local  361      R(4)            4     2     210                       401,443,471                       
 U2B                        Local  364      R(4)            4     2     210                       408,472                           
 U2S                        Local  362      R(4)            4     2     210                       403,444,471                       
 U2SD                       Local  367      R(4)            4     2     210                       413,472                           
 UFF                        Scalar 375      R(4)            4     1     500000   COM                                                
 UIN                        Scalar 377      R(4)            4     4     189000   COM              429,439,440,443,444,448           
 UOB                        Scalar 373      R(4)            4     1     500000   COM                                                
 UUU                        Scalar 379      R(4)            4     4     189000   COM                                                

Page 15          Source Listing                  COMSTAT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 V1                         Local  359      R(4)            4     2     210                       398,441,474                       
 V12                        Local  363      R(4)            4     2     210                       406,449,475                       
 V12R                       Local  369      R(4)            4     2     210                       418,476,528                       
 V12V                       Local  368      R(4)            4     2     210                       416,475                           
 V1B                        Local  365      R(4)            4     2     210                       409,475                           
 V1S                        Local  360      R(4)            4     2     210                       400,442,474                       
 V1SD                       Local  366      R(4)            4     2     210                       412,475,508                       
 V2                         Local  361      R(4)            4     2     210                       402,445,474                       
 V2B                        Local  365      R(4)            4     2     210                       410,475                           
 V2S                        Local  362      R(4)            4     2     210                       404,446,474                       
 V2SD                       Local  367      R(4)            4     2     210                       414,475                           
 VFF                        Scalar 375      R(4)            4     1     500000   COM                                                
 VIN                        Scalar 378      R(4)            4     4     189000   COM              429,430,441,442,445,446,450       
 VOB                        Scalar 373      R(4)            4     1     500000   COM                                                
 VVV                        Scalar 380      R(4)            4     4     189000   COM                                                
 WQM                        Scalar 376      R(4)            4     1     500000   COM                                                
 XLA                        Scalar 374      R(4)            4     1     500000   COM                                                
 XLO                        Scalar 374      R(4)            4     1     500000   COM                                                
 ZLEV                       Scalar 390      R(4)            4     1     35       COM                                                
 ZOB                        Scalar 372      R(4)            4     1     500000   COM                                                
 ZST                        Scalar 374      R(4)            4     1     500000   COM                                                

Page 16          Source Listing                  COMSTAT
2017-04-18 11:07                                 cqcvad.f

    540 
    541 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    542 C
    543 C SUBPROGRAM: CSTATS
    544 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-08-18
    545 C
    546 C ABSTRACT: CALCULATE MEANS, STANDARD DEVIATIONS, COVARIANCE, AND
    547 C   CORRELATION COEFFICIENT.
    548 C
    549 C PROGRAM HISTORY LOG:
    550 C 1999-08-18  W. COLLINS
    551 C 2012-03-05  S. MELCHIOR  CORRECTED SOME DOCUMENTATION TYPO'S.
    552 C
    553 C USAGE:    CALL CSTATS(N,XS,XSS,YS,YSS,XYS,XB,YB,SX,SY,SXY,RXY)
    554 C   INPUT ARGUMENT LIST:
    555 C     N   - COUNT
    556 C     XS  - SUM(SERIES 1 VALUES)
    557 C     XSS - SUM(SQUARES OF SERIES 1 VALUES)
    558 C     YS  - SUM(SERIES 2 VALUES)
    559 C     YSS - SUM(SQUARES OF SERIES 2 VALUES)
    560 C     XYS - SUM(PRODUCTS OF SERIES 1 AND SERIES 2 VALUES)
    561 C
    562 C   OUTPUT ARGUMENT LIST:
    563 C     XB  - MEAN FOR SERIES 1
    564 C     YB  - MEAN FOR SERIES 2
    565 C     SX  - STANDARD DEVIATION FOR SERIES 1
    566 C     SY  - STANDARD DEVIATION FOR SERIES 2
    567 C     SXY - COVARIANCE OF SERIES 1 AND SERIES 2 VALUES
    568 C     RXY - CORRELATION COEFFICIENT FOR SERIES 1 AND SERIES 2 VALUES
    569 C
    570 C ATTRIBUTES:
    571 C   LANGUAGE: FORTRAN 90
    572 C   MACHINE:  NCEP WCOSS
    573 C
    574 C$$$
    575       SUBROUTINE CSTATS(N,XS,XSS,YS,YSS,XYS,XB,YB,SX,SY,SXY,RXY)
    576 
    577 C  CALCULATE MEANS, STANDARD DEVIATIONS, COVARIANCE, AND
    578 C  CORRELATION COEFFICIENT.
    579 C     N   - COUNT
    580 C     XS  - SUM(SERIES 1 VALUES)
    581 C     XSS - SUM(SQUARES OF SERIES 1 VALUES)
    582 C     YS  - SUM(SERIES 2 VALUES)
    583 C     YSS - SUM(SQUARES OF SERIES 2 VALUES)
    584 C     XYS - SUM(PRODUCTS OF SERIES 1 AND SERIES 2 VALUES)
    585 C     XB  - MEAN FOR SERIES 1
    586 C     YB  - MEAN FOR SERIES 2
    587 C     SX  - STANDARD DEVIATION FOR SERIES 1
    588 C     SY  - STANDARD DEVIATION FOR SERIES 2
    589 C     SXY - COVARIANCE OF SERIES 1 AND SERIES 2 VALUES
    590 C     RXY - CORRELATION COEFFICIENT FOR SERIES 1 AND SERIES 2 VALUES
    591 C  ----------------------------------------------------------------
    592 
    593       IF(N.NE.0) THEN
    594         ON  = 1./N
    595         XB  = XS*ON
    596         YB  = YS*ON

Page 17          Source Listing                  CSTATS
2017-04-18 11:07                                 cqcvad.f

    597         RAD = (XSS-ON*XS**2)*ON
    598         IF(RAD.GT.0.) THEN
    599           SX = SQRT(RAD)
    600         ELSE
    601           SX = 0.
    602         ENDIF
    603         RAD = (YSS-ON*YS**2)*ON
    604         IF(RAD.GT.0.) THEN
    605           SY = SQRT(RAD)
    606         ELSE
    607           SY = 0.
    608         ENDIF
    609         SXY = (XYS-ON*XS*YS)*ON
    610 	IF(SX*SY.NE.0.) THEN
    611           RXY = SXY/(SX*SY)
    612         ELSE
    613 	  RXY = 0.
    614         ENDIF
    615       ENDIF
    616       RETURN
    617       END


ENTRY POINTS

  Name               
                     
 cstats_             

Page 18          Source Listing                  CSTATS
2017-04-18 11:07 Symbol Table                    cqcvad.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CSTATS                     Subr   575                                                                                              
 N                          Dummy  575      I(4)            4           scalar   ARG,INOUT        593,594                           
 ON                         Local  594      R(4)            4           scalar                    594,595,596,597,603,609           
 RAD                        Local  597      R(4)            4           scalar                    597,598,599,603,604,605           
 RXY                        Dummy  575      R(4)            4           scalar   ARG,INOUT        611,613                           
 SQRT                       Func   599                                  scalar                    599,605                           
 SX                         Dummy  575      R(4)            4           scalar   ARG,INOUT        599,601,610,611                   
 SXY                        Dummy  575      R(4)            4           scalar   ARG,INOUT        609,611                           
 SY                         Dummy  575      R(4)            4           scalar   ARG,INOUT        605,607,610,611                   
 XB                         Dummy  575      R(4)            4           scalar   ARG,INOUT        595                               
 XS                         Dummy  575      R(4)            4           scalar   ARG,INOUT        595,597,609                       
 XSS                        Dummy  575      R(4)            4           scalar   ARG,INOUT        597                               
 XYS                        Dummy  575      R(4)            4           scalar   ARG,INOUT        609                               
 YB                         Dummy  575      R(4)            4           scalar   ARG,INOUT        596                               
 YS                         Dummy  575      R(4)            4           scalar   ARG,INOUT        596,603,609                       
 YSS                        Dummy  575      R(4)            4           scalar   ARG,INOUT        603                               

Page 19          Source Listing                  CSTATS
2017-04-18 11:07                                 cqcvad.f

    618 
    619 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    620 C
    621 C SUBPROGRAM: CUMPROB
    622 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-08-18
    623 C
    624 C ABSTRACT: FOR A GIVEN X, RETURN THE CUMULATIVE PROBABILITY FOR
    625 C   ABS(VALUE <= X). X IS ASSUMED TO BE NORMAL VARIATE.
    626 C   USE LINEAR INTERPOLATION IN A TABLE.
    627 C
    628 C PROGRAM HISTORY LOG:
    629 C 1999-08-18  W. COLLINS
    630 C
    631 C USAGE:    Y=CUMPROB(X)
    632 C   INPUT ARGUMENT LIST:
    633 C     X        - NORMAL VARIATE
    634 C
    635 C ATTRIBUTES:
    636 C   LANGUAGE: FORTRAN 90
    637 C   MACHINE:  NCEP WCOSS
    638 C
    639 C$$$
    640       FUNCTION CUMPROB(X)
    641 
    642 C  FOR A GIVEN X, RETURN THE CUMULATIVE PROBABILITY FOR
    643 C  ABS(VALUE <= X). X IS ASSUMED TO BE NORMAL VARIATE.
    644 C  USE LINEAR INTERPOLATION IN A TABLE.
    645 
    646       REAL P(0:40)
    647       DATA P/.5000,.5398,.5793,.6179,.6554,.6915,
    648      &       .7257,.7580,.7881,.8159,.8413,
    649      &       .8643,.8849,.9032,.9192,.9332,
    650      &       .9452,.9554,.9641,.9713,.9772,
    651      &       .9821,.9861,.9893,.9918,.9938,
    652      &       .9953,.9965,.9974,.9981,.9987,
    653      &       .9990,.9993,.9995,.9997,.9998,
    654      &       .9998,.9999,.9999,1.0000,1.0000/
    655 
    656       IF(X.GE.4.) THEN
    657         CUMPROB = 1.
    658       ELSE
    659         Y  = X*10.
    660         IY = Y
    661         F  = Y-IY
    662         PY = (1.-F)* P(IY) + F*P(IY+1)
    663         CUMPROB = 2.*(PY - .5000)
    664       ENDIF
    665 
    666       RETURN
    667       END

Page 20          Source Listing                  CUMPROB
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name                
                      
 cumprob_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CUMPROB                    Func   640      R(4)            4           scalar                    657,663                           
 CUMPROB@0                  Local  640      R(4)            4           scalar                                                      
 F                          Local  661      R(4)            4           scalar                    661,662                           
 IY                         Local  660      I(4)            4           scalar                    660,661,662                       
 P                          Local  646      R(4)            4     1     41                        647,662                           
 PY                         Local  662      R(4)            4           scalar                    662,663                           
 X                          Dummy  640      R(4)            4           scalar   ARG,INOUT        656,659                           
 Y                          Local  659      R(4)            4           scalar                    659,660,661                       

Page 21          Source Listing                  CUMPROB
2017-04-18 11:07                                 cqcvad.f

    668 
    669 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    670 C
    671 C SUBPROGRAM: ANLWT
    672 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2000-01-07
    673 C
    674 C ABSTRACT: FOR A GIVEN X>0., RETURN THE ANALYSIS WEIGHT FOR AN
    675 C   OBSERVATION WITH A GIVEN NORMALIZED RESIDUAL OF X.  IN
    676 C   ORDER TO GET X, THE MEAN IS SUBTRACTED AND THEN DIVIDED BY
    677 C   THE STANDARD DEVIATION.  LINEAR INTERPOLATION IS USED FROM THE
    678 C   FOLLOWING TABLE.  IT IS ASSUMED (FROM PAST DATA) THAT PER IS
    679 C   THE PROPORTION OF THE DATA THAT ARE IN ERROR.  ALL ROUGH
    680 C   ERRORS ARE ASSUMED TO BE CONTAINED WITHIN B STANDARD DEVIATIONS.
    681 C
    682 C PROGRAM HISTORY LOG:
    683 C 1999-08-18  W. COLLINS
    684 C 2000-01-07  W. COLLINS  CHANGE TO AGREE WITH FORMULATION BY
    685 C                         CQCBUFR.
    686 C
    687 C USAGE:    Y=ANLWT(X,B,PER)
    688 C   INPUT ARGUMENT LIST:
    689 C     X        - NORMAL VARIATE
    690 C     B        - LIMIT WRT STANDARD DEVIATIONS FOR ROUGH ERRORS
    691 C     PER      - ASSUMED PROPORTION OF DATA WITH ERRORS
    692 C
    693 C ATTRIBUTES:
    694 C   LANGUAGE: FORTRAN 90
    695 C   MACHINE:  NCEP WCOSS
    696 C
    697 C$$$
    698       FUNCTION ANLWT(X,B,PER)
    699 
    700 C  FOR A GIVEN X>0., RETURN THE ANALYSIS WEIGHT FOR AN OBSERVATION
    701 C  WITH A GIVEN NORMALIZED RESIDUAL OF X.  IN ORDER TO GET X,
    702 C  THE MEAN IS SUBTRACTED AND THEN DIVIDED BY THE STANDARD
    703 C  DEVIATION.  LINEAR INTERPOLATION IS USED FROM THE FOLLOWING
    704 C  TABLE.  IT IS ASSUMED (FROM PAST DATA) THAT PER IS THE
    705 C  PROPORTION OF THE DATA THAT ARE IN ERROR.  ALL ROUGH ERRORS
    706 C  ARE ASSUMED TO BE CONTAINED WITHIN B STANDARD DEVIATIONS.
    707 
    708       REAL W(0:50)
    709       DATA W/.3989,.3970,.3910,.3814,.3683,.3521,.3332,.3123,
    710      &       .2897,.2661,.2420,.2179,.1942,.1714,.1497,.1295,
    711      &       .1109,.0940,.0790,.0656,.0540,.0440,.0355,.0283,
    712      &       .0224,.0175,.0136,.0104,.0079,.0060,.0044,.0033,
    713      &       .0024,.0017,.0012,.0009,.0006,.0004,.0003,.0002,
    714      &       .0001,.00009,.00006,.00004,.00002,.00002,.00001,
    715      &       .00001,.00000,.00000,.00000/
    716 
    717       IF(X.GE.5.) THEN
    718         WINT = 0.
    719       ELSE
    720         Y  = X*10.
    721         IY = Y
    722         F  = Y-IY
    723         WINT = (1.-F)* W(IY) + F*W(IY+1)
    724       ENDIF

Page 22          Source Listing                  ANLWT
2017-04-18 11:07                                 cqcvad.f

    725 
    726       PNOT = 1.-PER
    727       CPRIME = 0.5/B
    728       DENOM = PNOT*WINT + PER*CPRIME
    729       IF(DENOM.NE.0.) THEN
    730         ANLWT = PNOT*WINT/DENOM
    731       ELSE
    732         ANLWT = 1.
    733       ENDIF
    734 
    735 cwgc  A = .5*PER/B
    736 cwgc  P = (1.-A)*WINT + A*(B+X)
    737 cwgc  S = (1.-A)*WINT
    738 
    739 cwgc  IF(P.NE.0.) THEN
    740 cwgc    ANLWT = S/P
    741 cwgc  ELSE
    742 cwgc    ANLWT = 1.
    743 cwgc  ENDIF
    744 
    745       RETURN
    746       END


ENTRY POINTS

  Name              
                    
 anlwt_             

Page 23          Source Listing                  ANLWT
2017-04-18 11:07 Symbol Table                    cqcvad.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ANLWT                      Func   698      R(4)            4           scalar                    730,732                           
 ANLWT@0                    Local  698      R(4)            4           scalar                                                      
 B                          Dummy  698      R(4)            4           scalar   ARG,INOUT        727                               
 CPRIME                     Local  727      R(4)            4           scalar                    727,728                           
 DENOM                      Local  728      R(4)            4           scalar                    728,729,730                       
 F                          Local  722      R(4)            4           scalar                    722,723                           
 IY                         Local  721      I(4)            4           scalar                    721,722,723                       
 PER                        Dummy  698      R(4)            4           scalar   ARG,INOUT        726,728                           
 PNOT                       Local  726      R(4)            4           scalar                    726,728,730                       
 W                          Local  708      R(4)            4     1     51                        709,723                           
 WINT                       Local  718      R(4)            4           scalar                    718,723,728,730                   
 X                          Dummy  698      R(4)            4           scalar   ARG,INOUT        717,720                           
 Y                          Local  720      R(4)            4           scalar                    720,721,722                       

Page 24          Source Listing                  ANLWT
2017-04-18 11:07                                 cqcvad.f

    747 
    748 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    749 C
    750 C SUBPROGRAM: DISTR
    751 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1991-07-23
    752 C
    753 C ABSTRACT: FOR GIVEN DATA, CALCULATE THE 0TH THROUGH 4TH MOMENTS.
    754 C   ALSO PRODUCE BINNED DISTRIBUTION.
    755 C
    756 C PROGRAM HISTORY LOG:
    757 C 1991-07-23  W. COLLINS
    758 C 2012-03-05  S. MELCHIOR  ADDED FLEXIBILITY BY UTILIZING NDIV AND
    759 C       NX AS ARRAY LIMITS RATHER THAN THE HARD-CODED 23 AND 899,
    760 C       RESPECTIVELY. ADDED MORE DESCRIPTIVE DOCUMENTATION. ALSO 
    761 C       ADDED DIAGNOSTIC OUTPUT STATEMENT WHEN LIMITS ARE EXCEEDED. 
    762 C
    763 C USAGE:    CALL DISTR(X, MSK, XLIM, XMSG, NX, N, NDIV, DDIV, NZERO,
    764 C                      DZERO, NS, X1, SD, SK, XK)
    765 C   INPUT ARGUMENT LIST:
    766 C     X        - DATA
    767 C     MSK      - MASK: VALUE = 0 -- USE IN COMPUTATIONS
    768 C                      VALUE.NE.0 -- DONT USE
    769 C     XLIM     - (1) MINIMUM VALUE TO USE
    770 C                (2) MAXIMUM VALUE TO USE
    771 C     XMSG     - MISSING VALUE FOR VARIABLE
    772 C     NX       - DIMENSION OF X AND MSK
    773 C     NDIV     - NUMBER OF DIVISIONS (DIMENSION OF N)
    774 C     DDIV     - DIVISION SIZE
    775 C     NZERO    - = 0, USE DZERO AS CENTER
    776 C                = 1, USE MEAN AS CENTER
    777 C     DZERO    - CENTRAL DIVISION LOCATION
    778 C
    779 C   OUTPUT ARGUMENT LIST:
    780 C     N        - OUTPUT DISTRIBUTION, COUNT IN EACH DIVISION
    781 C     NS       - COUNT OF VALUES USED
    782 C     X1       - FIRST MOMENT (MEAN)
    783 C     X2       - SECOND MOMENT
    784 C     X3       - THIRD MOMENT
    785 C     X4       - FOURTH MOMENT
    786 C     SD       - STANDARD DEVIATION (POPULATION)
    787 C                  = SQRT(X2 - X1**2)
    788 C     SK       - SKEWNESS = X3/(X2)**(3/2)
    789 C     XK       - KURTOSIS = X4/(SD**4) - 3
    790 C
    791 C ATTRIBUTES:
    792 C   LANGUAGE: FORTRAN 90
    793 C   MACHINE:  NCEP WCOSS
    794 C
    795 C$$$
    796       SUBROUTINE DISTR(X,MSK,XLIM,XMSG,NX,N,NDIV,DDIV,NZERO,DZERO,NS,X1,
    797      &                 SD,SK,XK)
    798 
    799       INTEGER N(NDIV), MSK(NX)
    800       REAL X(NX),XLIM(2)
    801 
    802       DZERO0 = DZERO
    803 

Page 25          Source Listing                  DISTR
2017-04-18 11:07                                 cqcvad.f

    804 C     COMPUTE VARIOUS POWERS OF X.
    805 C     ----------------------------
    806 
    807       NS   = 0
    808       SUM1 = 0.
    809       SUM2 = 0.
    810       SUM3 = 0.
    811       SUM4 = 0.
    812       DO I=1,NX
    813         IF(MSK(I).EQ.0.AND.ABS(X(I)).LT.XMSG
    814      &    .AND.X(I).GE.XLIM(1).AND.X(I).LE.XLIM(2)) THEN
    815           NS = NS + 1
    816           SUM1 = SUM1 + X(I)
    817           SUM2 = SUM2 + X(I)**2
    818           SUM3 = SUM3 + X(I)**3
    819           SUM4 = SUM4 + X(I)**4
    820         ENDIF
    821       END DO
    822       IF(NS.LT.1) THEN
    823         DZERO0 = 0.
    824         X1 = 0.
    825         SD = 0.
    826         SK = 0.
    827         XK = 0.
    828         GO TO 15
    829       ENDIF
    830       SUM1 = SUM1/NS
    831       SUM2 = SUM2/NS
    832       SUM3 = SUM3/NS
    833       SUM4 = SUM4/NS
    834 
    835 C     CALCULATE VARIOUS OUTPUT STATISTICS.
    836 C     ------------------------------------
    837 
    838       X1 = SUM1
    839       ARG = SUM2 - SUM1**2
    840       IF(ARG.GT.0.) THEN
    841         SD = SQRT(ARG)
    842       ELSE
    843         SD = 0.
    844       ENDIF
    845       X3 = SUM3 - 3.*SUM2*SUM1 + 2.*SUM1**3
    846       IF(SUM2.GT.0.) THEN
    847         SK = X3/(SUM2)**1.5
    848       ELSE
    849         SK = 0.
    850       ENDIF
    851       X4 = SUM4 - 4.*SUM3*SUM1 + 6.*SUM2*SUM1**2 - 3.*SUM1**4
    852       IF(SD.GT.0.) THEN
    853         XK = (X4/SD**4) - 3.0
    854       ELSE
    855         XK = 0.
    856       ENDIF
    857 
    858 C     COUNT THE NUMBER OF OBSERVATIONS IN EACH DIVISION.
    859 C     --------------------------------------------------
    860 

Page 26          Source Listing                  DISTR
2017-04-18 11:07                                 cqcvad.f

    861    15 CONTINUE
    862 
    863       IF(DDIV.EQ.0.) DDIV = 1.
    864       IF(NZERO.EQ.1) DZERO0 = SUM1
    865       N(1:NDIV) = 0
    866       CON = 0.5*NDIV + 1.0 - DZERO0/DDIV
    867       DO I=1,NX
    868         IF(MSK(I).EQ.0.AND.ABS(X(I)).LT.XMSG
    869      &          ) THEN
    870 cwgc &    .AND.X(I).GE.XLIM(1).AND.X(I).LE.XLIM(2)) THEN
    871           INDEX = X(I)/DDIV + CON
    872           IF(INDEX.LT.1) INDEX = 1
    873           if(index.gt.ndiv) then
    874 C           print *, 'WARNING: INDEX > NDIV, SET INDEX = NDIV'
    875             index = ndiv
    876           endif
    877           N(INDEX) = N(INDEX) + 1
    878         ENDIF
    879       END DO
    880       RETURN
    881       END


ENTRY POINTS

  Name              
                    
 distr_             

Page 27          Source Listing                  DISTR
2017-04-18 11:07 Symbol Table                    cqcvad.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 15                         Label  861                                                            828                               
 ABS                        Func   813                                  scalar                    813,868                           
 ARG                        Local  839      R(4)            4           scalar                    839,840,841                       
 CON                        Local  866      R(4)            4           scalar                    866,871                           
 DDIV                       Dummy  796      R(4)            4           scalar   ARG,INOUT        863,866,871                       
 DISTR                      Subr   796                                                                                              
 DZERO                      Dummy  796      R(4)            4           scalar   ARG,INOUT        802                               
 DZERO0                     Local  802      R(4)            4           scalar                    802,823,864,866                   
 I                          Local  812      I(4)            4           scalar                    812,813,814,816,817,818,819,867,86
                                                                                                  8,871                             
 INDEX                      Local  871      I(4)            4           scalar                    871,872,873,875,877               
 MSK                        Dummy  796      I(4)            4     1     0        ARG,INOUT        813,868                           
 N                          Dummy  796      I(4)            4     1     0        ARG,INOUT        865,877                           
 NDIV                       Dummy  796      I(4)            4           scalar   ARG,INOUT        799,865,866,873,875               
 NS                         Dummy  796      I(4)            4           scalar   ARG,INOUT        807,815,822,830,831,832,833       
 NX                         Dummy  796      I(4)            4           scalar   ARG,INOUT        799,800,812,867                   
 NZERO                      Dummy  796      I(4)            4           scalar   ARG,INOUT        864                               
 SD                         Dummy  797      R(4)            4           scalar   ARG,INOUT        825,841,843,852,853               
 SK                         Dummy  797      R(4)            4           scalar   ARG,INOUT        826,847,849                       
 SQRT                       Func   841                                  scalar                    841                               
 SUM1                       Local  808      R(4)            4           scalar                    808,816,830,838,839,845,851,864   
 SUM2                       Local  809      R(4)            4           scalar                    809,817,831,839,845,846,847,851   
 SUM3                       Local  810      R(4)            4           scalar                    810,818,832,845,851               
 SUM4                       Local  811      R(4)            4           scalar                    811,819,833,851                   
 X                          Dummy  796      R(4)            4     1     0        ARG,INOUT        813,814,816,817,818,819,868,871   
 X1                         Dummy  796      R(4)            4           scalar   ARG,INOUT        824,838                           
 X3                         Local  845      R(4)            4           scalar                    845,847                           
 X4                         Local  851      R(4)            4           scalar                    851,853                           
 XK                         Dummy  797      R(4)            4           scalar   ARG,INOUT        827,853,855                       
 XLIM                       Dummy  796      R(4)            4     1     2        ARG,INOUT        814                               
 XMSG                       Dummy  796      R(4)            4           scalar   ARG,INOUT        813,868                           

Page 28          Source Listing                  DISTR
2017-04-18 11:07                                 cqcvad.f

    882 
    883 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
    884 C
    885 C SUBPROGRAM: DRCTSL
    886 C   PRGMMR: WOOLLEN          ORG: NP22       DATE: 2016-12-18
    887 C
    888 C ABSTRACT: DRIVER FOR CHOLESKY TYPE LINEAR EQUATION SOLVER.
    889 C
    890 C PROGRAM HISTORY LOG:
    891 C 1990-11-06  J. WOOLLEN
    892 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
    893 C       process) from 200 to 300.
    894 C
    895 C USAGE:
    896 C   INPUT ARGUMENTS:
    897 C     FAALL      - ARRAY OF SYMMETRIC MATRIXES
    898 C     RAALL      - ARRAY OF MATRIX RIGHT HAND SIDES
    899 C     NDIM       - ARRAY OF MATRIX RANKS
    900 C     MAXDIM     - MAXIMUM RANK MATRIX IN MATRIX ARRAY
    901 C     NXXYY      - NUMBER OF MATRIXES IN MATRIX ARRAY
    902 C     NFT        - NUMBER OF RIGHT HAND SIDE VECTORS PER MATRIX
    903 C   OUTPUT ARGUMENTS:
    904 C     RAALL      - ARRAY OF MATRIX SOLUTIONS
    905 C     DOTPRD     - ARRAY OF DOT PRODUCTS OF RHS VECTORS WITH MATRIX
    906 C                  SOLUTIONS
    907 C
    908 C REMARKS: ILL CONDITIONED OR NON POSITIVE DEFINITE MATRIXES ARE
    909 C          IDENTIFIED BY DOT PRODUCTS GT 1 OR LT 0 OR BY A MESSAGE
    910 C          FROM VSOLVE. FIVE ATTEMPTS ARE MADE TO SOLVE BAD ONES,
    911 C          BY RIDGE REGRESSION, AFTER WHICH A NULL SOLUTION IS RETURNED.
    912 C
    913 C ATTRIBUTES:
    914 C   LANGUAGE: FORTRAN 90
    915 C   MACHINE:  NCEP WCOSS
    916 C
    917 C$$$
    918       SUBROUTINE DRCTSL(FAALL,RAALL,DOTPRD,NDIM,MAXDIM,NXXYY,NFT)
    919 
    920       PARAMETER(NSTN=300)
    921       DIMENSION  FAALL(NSTN,45), DOTPRD(NSTN,1), RAALL(NSTN,9,1),
    922      &           NDIM(NSTN)
    923       DIMENSION  A(NSTN,45),B(NSTN,9,1),BAD(NSTN),SMOOTH(6)
    924       LOGICAL BAD
    925       DATA SMOOTH /1.00,1.01,1.02,1.05,1.10,2.00/
    926 
    927 C----------------------------------------------------------------------
    928 
    929 C  LOOP FOR POSSIBILITY OF BAD MATRICES
    930 C  ------------------------------------
    931 
    932       DO ITRY=1,6
    933 
    934          NBAD = 0
    935 
    936 C  INITIALIZE THE WORKING ARRAYS
    937 C  -----------------------------
    938 

Page 29          Source Listing                  DRCTSL
2017-04-18 11:07                                 cqcvad.f

    939          A(1:NXXYY,1:MAXDIM*(MAXDIM+1)/2) =
    940      &                              FAALL(1:NXXYY,1:MAXDIM*(MAXDIM+1)/2)
    941 
    942          B(1:NXXYY,1:MAXDIM,1:NFT) = RAALL(1:NXXYY,1:MAXDIM,1:NFT)
    943 
    944          DOTPRD(1:NXXYY,1:NFT) = 0.
    945 
    946          DO J=1,MAXDIM
    947             JJ = J*(J+1)/2
    948             A(1:NXXYY,JJ) = FAALL(1:NXXYY,JJ)*SMOOTH(ITRY)
    949          END DO
    950 
    951 C  CALL THE MATRIX SOLVER
    952 C  ----------------------
    953 
    954          CALL VSOLVE (A,B,NDIM,BAD,NFT,NXXYY,MAXDIM)
    955 
    956 C  MAKE THE DOT PRODUCTS OF SOLUTIONS WITH RIGHT HAND SIDES
    957 C  --------------------------------------------------------
    958 
    959          DO K=1,NFT
    960             DO J=1,MAXDIM
    961                DO I=1,NXXYY
    962                   DOTPRD(I,K) = DOTPRD(I,K) + RAALL(I,J,K)*B(I,J,K)
    963                END DO
    964             END DO
    965          END DO
    966 
    967          DO K=1,NFT
    968             DO I=1,NXXYY
    969                IF(DOTPRD(I,K).GT.1.)THEN
    970                   DO J=1,MAXDIM
    971                      B(I,J,K) = B(I,J,K)/DOTPRD(I,K)
    972                   END DO
    973                   DOTPRD(I,K) = 1.
    974                ENDIF
    975             END DO
    976          END DO
    977 
    978 C  CHECK FOR BAD ONES - DO IT AGAIN IF NECESSARY
    979 C  ---------------------------------------------
    980 
    981          DO J=1,NFT
    982             DO I=1,NXXYY
    983                BAD(I) = BAD(I).OR.DOTPRD(I,J).LT.0..OR.DOTPRD(I,J).GT.1.
    984             END DO
    985          END DO
    986 
    987          DO I=1,NXXYY
    988             IF(BAD(I)) THEN
    989                DOTPRD(I,1:NFT) = 0.
    990                B(I,1:MAXDIM,1:NFT) = 0.
    991                NBAD = NBAD + 1
    992             ENDIF
    993          END DO
    994 
    995          IF(NBAD.NE.0) THEN

Page 30          Source Listing                  DRCTSL
2017-04-18 11:07                                 cqcvad.f

    996             PRINT*, 'NBAD=',NBAD,' ON TRY ',ITRY
    997          ELSE
    998             GOTO 55
    999          ENDIF
   1000 
   1001       END DO
   1002 
   1003 C  COPY SOLUTIONS INTO OUTPUT ARRAY - ZERO BAD ONES OUT
   1004 C  ----------------------------------------------------
   1005 
   1006 55    CONTINUE
   1007       
   1008       RAALL(1:NXXYY,1:MAXDIM,1:NFT) = B(1:NXXYY,1:MAXDIM,1:NFT)
   1009 
   1010       RETURN
   1011       END


ENTRY POINTS

  Name               
                     
 drctsl_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 55                         Label  1006                                                           998                               
 A                          Local  923      R(4)            4     2     13500                     939,948,954                       
 B                          Local  923      R(4)            4     3     2700                      942,954,962,971,990,1008          
 BAD                        Local  923      L(4)            4     1     300                       954,983,988                       
 DOTPRD                     Dummy  918      R(4)            4     2     300      ARG,INOUT        944,962,969,971,973,983,989       
 DRCTSL                     Subr   918                                                                                              
 FAALL                      Dummy  918      R(4)            4     2     13500    ARG,INOUT        940,948                           
 I                          Local  961      I(4)            4           scalar                    961,962,968,969,971,973,982,983,98
                                                                                                  7,988,989,990                     
 ITRY                       Local  932      I(4)            4           scalar                    932,948,996                       
 J                          Local  946      I(4)            4           scalar                    946,947,960,962,970,971,981,983   
 JJ                         Local  947      I(4)            4           scalar                    947,948                           
 K                          Local  959      I(4)            4           scalar                    959,962,967,969,971,973           
 MAXDIM                     Dummy  918      I(4)            4           scalar   ARG,INOUT        939,940,942,946,954,960,970,990,10
                                                                                                  08                                
 NBAD                       Local  934      I(4)            4           scalar                    934,991,995,996                   
 NDIM                       Dummy  918      I(4)            4     1     300      ARG,INOUT        954                               
 NFT                        Dummy  918      I(4)            4           scalar   ARG,INOUT        942,944,954,959,967,981,989,990,10
                                                                                                  08                                
 NSTN                       Param  920      I(4)            4           scalar                    921,922,923                       
 NXXYY                      Dummy  918      I(4)            4           scalar   ARG,INOUT        939,940,942,944,948,954,961,968,98
                                                                                                  2,987,1008                        
 RAALL                      Dummy  918      R(4)            4     3     2700     ARG,INOUT        942,962,1008                      
 SMOOTH                     Local  923      R(4)            4     1     6                         925,948                           
 VSOLVE                     Subr   954                                                            954                               

Page 31          Source Listing                  DRCTSL
2017-04-18 11:07                                 cqcvad.f

   1012 
   1013 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1014 C
   1015 C SUBPROGRAM: EVNOUT
   1016 C   PRGMMR: S. Melchior      ORG: NP22       DATE: 2016-12-18
   1017 C
   1018 C ABSTRACT: THE PRESENT REPORT IS IN /SINGLE/ AND STNID WITH INDICES
   1019 C   FROM NUM1 TO NUM2.  FOLLOWING CODE WILL LOOK AT THE EVENTS
   1020 C   STORED IN /EVENTS/ FOR MATCHES.  ARRAYS OF MATCHES WILL
   1021 C   BE FORMED FOR WRITING THE ACTUAL EVENTS TO THE OUTPUT
   1022 C   BUFR FILE.
   1023 C
   1024 C PROGRAM HISTORY LOG:
   1025 C 1999-08-18  W. COLLINS
   1026 C 2001-10-08  D. KEYSER   NOW TABULATES PERCENT OF LEVELS < 18K
   1027 C       FAILING BIRD ALGORITM CHECK ACCORDING TO STATION AND
   1028 C       1-HOUR TIME WINDOWS CENTERED ON 30-MIN PAST HOUR, THIS
   1029 C       BIRD Q.C. INFORMATION WRITTEN TO UNIT 52 FOR LATER USE
   1030 C       BY SSI IN Q.C. OF NEXRAD RADIAL VELOCITY DATA
   1031 C 2012-03-05  S. MELCHIOR  UPDATED TO USE INCOMING ARGUMENT NLV TO
   1032 C       DEFINE MEMORY ALLOCATION FOR VARIOUS REAL AND INTEGER ARRAYS.
   1033 C       THIS MAKES THE SUBROUTINE MORE ROBUST AND EFFICIENT BY ONLY
   1034 C       ALLOTTING THE MEMORY SPACE NECESSARY, NOTHING MORE.  ADDED
   1035 C       PARAMETER NEVNT=160000 TO TIDY UP THE CODE. CORRECTED  SOME
   1036 C       DOCUMENTATION TYPO'S. ADDED DIAGNOSTIC OUTPUT STATEMENT WHEN
   1037 C       LIMITS ARE EXCEEDED. RENAMED NE to NME TO EASE NAVIGATION AND
   1038 C       FOR CLARIFICATION SINCE NE IS USED FOR INEQUALITY TESTING
   1039 C       (.NE.). INCREASED NRPT FROM 80000 TO 160000 TO ACCOMMODATE VAD
   1040 C       WIND REPORTS FROM LEVEL 2 DECODER.
   1041 C 2012-03-05  D. KEYSER   UPDATED PROCESSING OF RADAR STATION IDS TO
   1042 C       ACCOMMODATE VAD WIND REPORTS FROM LEVEL 2 DECODER.  THESE
   1043 C       REPORTS COME IN WITH THE STATION ID FORMATTED WITH ONLY 4
   1044 C       CHARACTERS WHEREAS LEGACY (RADAR CODED MESSAGE) VAD WIND
   1045 C       REPORTS HAVE STATION IDS WITH 7 CHARACTERS.
   1046 C 2014-01-15  S. Melchior  Increased NRPT (total number of levels
   1047 C       amongst all VAD reports that can be processed) and NEVNT (total
   1048 C       number of events amongst all VAD reports that can be processed)
   1049 C       both from 160000 to 500000 to accommodate VAD wind reports from
   1050 C       Level 2 decoder.
   1051 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   1052 C       process) from 200 to 300.
   1053 C
   1054 C USAGE:    CALL EVNOUT(NUM1,NUM2,NLV)
   1055 C   INPUT ARGUMENT LIST:
   1056 C     NUM1     - LOWER LIMIT OF EVENTS TO SCAN
   1057 C     NUM2     - UPPER LIMIT OF EVENTS TO SCAN
   1058 C     NLV      - NUMBER OF LEVELS
   1059 C
   1060 C ATTRIBUTES:
   1061 C   LANGUAGE: FORTRAN 90
   1062 C   MACHINE:  NCEP WCOSS
   1063 C
   1064 C$$$
   1065       SUBROUTINE EVNOUT(NUM1,NUM2,NLV)
   1066 
   1067       PARAMETER (NRPT=500000,NSTN=300,NLEV=35)
   1068       parameter (nevnt=500000)

Page 32          Source Listing                  EVNOUT
2017-04-18 11:07                                 cqcvad.f

   1069       REAL(8)   BMISS
   1070 
   1071       COMMON /SINGLE/ ZOB(NRPT), ITM(NRPT),TIM(NRPT),
   1072      &                UOB(NRPT), VOB(NRPT), LOB(NRPT),
   1073      &                XLA(NRPT), XLO(NRPT), ZST(NRPT),
   1074      &                UFF(NRPT), VFF(NRPT), TFF(NRPT),
   1075      &                WQM(NRPT)
   1076       COMMON /STN/    SLAT(NSTN), SLON(NSTN), SIDS(NSTN), STNID(NRPT),
   1077      &                ZSTN(NSTN)
   1078       COMMON /EVENTS/ SIDEV(nevnt), HTEV(nevnt),LEV(nevnt),
   1079      &                TIMEV(nevnt), UEV(nevnt), VEV(nevnt),
   1080      &                QALEV(nevnt), RCEV(nevnt)
   1081       COMMON /HTS/    IZLEV(NLEV), ZLEV(NLEV)
   1082       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   1083      &                CQCPC, NEV, NME
   1084       COMMON /BUFRLIB_MISSING/BMISS
   1085       COMMON /FLAG/   guess
   1086       COMMON /BIRDST/stnidx(9999,-3:3),alatx(9999,-3:3),
   1087      & alonx(9999,-3:3),knt_5_yes(9999,-3:3),knt_5_no(9999,-3:3),
   1088      & numrpt(9999,-3:3)
   1089       common /switches/  print_52, print_53, print_60, test
   1090       LOGICAL         guess, PRINT_52, PRINT_53
   1091       REAL            UE(nlv*2), VE(nlv*2), QALE(nlv*2), RCE(nlv*2),
   1092      &                ETYP(nlv*2)
   1093 
   1094       INTEGER         INP(nlv*2)
   1095       CHARACTER*8     SIDS, STNID, SIDEV
   1096       character*8     stnidx
   1097       CHARACTER*40    WEVN
   1098       DATA WEVN   /'UOB VOB WQM WPC WRC                     '/
   1099 
   1100       IF(NUM2.LT.NUM1 .OR. NME.EQ.0) RETURN
   1101 
   1102       INP  = 0
   1103       UE   = BMISS
   1104       VE   = BMISS
   1105       QALE = BMISS
   1106       RCE  = BMISS
   1107 
   1108 C  THE PRESENT REPORT IS IN /SINGLE/ AND STNID WITH INDICES
   1109 C  FROM NUM1 TO NUM2.  FOLLOWING CODE WILL LOOK AT THE EVENTS
   1110 C  STORED IN /EVENTS/ FOR MATCHES.  ARRAYS OF MATCHES WILL
   1111 C  BE FORMED FOR WRITING THE ACTUAL EVENTS TO THE OUPUT
   1112 C  BUFR FILE.
   1113 
   1114 C  LOOP THRU EVENTS
   1115 C  ----------------
   1116 
   1117       ETYP = 0
   1118       NEVN = 0
   1119       loop1: do n=num1,num2
   1120        DO IEV=1,NME !  nme max is nev and nevnt
   1121          IF(SIDEV(IEV).EQ.STNID(N) .AND.
   1122      &      ABS(HTEV(IEV)-ZOB(N)).LT.10. .AND.
   1123      &      TIMEV(IEV).EQ.TIM(N)) THEN
   1124            NEVN = NEVN + 1
   1125   500      FORMAT(' N,IEV,NEVN,NLV,NUM1,NUM2,LEV =',7I5,' FOR ',A8)

Page 33          Source Listing                  EVNOUT
2017-04-18 11:07                                 cqcvad.f

   1126            if(nevn.gt.nlv*2) then
   1127              print *, 'WARNING: NEVN > NLV, EXIT LOOP'
   1128              WRITE(6,500) N,IEV,NEVN,NLV,NUM1,NUM2,LEV(IEV),STNID(N)
   1129              nevn = nevn - 1
   1130              exit LOOP1
   1131            endif
   1132            INP(NEVN) = LEV(IEV)
   1133            UE(NEVN) = UEV(IEV)
   1134            VE(NEVN) = VEV(IEV)
   1135            QALE(NEVN) = QALEV(IEV)
   1136            RCE(NEVN)  = RCEV(IEV)
   1137            ETYP(LOB(N)) = RCEV(IEV)
   1138          ENDIF
   1139        ENDDO
   1140       enddo loop1
   1141 
   1142       IF(NEVN.GT.0) CALL EVENTW(IOUT,WEVN,NLV,UE,VE,QALE,RCE,INP,NEVN,
   1143      &                          CQCPC)
   1144 
   1145       if(print_52)  then
   1146 
   1147 C  KEEP TRACK OF LEVELS FAILING BIRD ALG. FOR LATER Q.C. INFO LISTING
   1148 C  ------------------------------------------------------------------
   1149 
   1150          read(stnid(num1),'(i4)',err=99)  kndx
   1151          go to 98  ! these are ids from Radar Coded Message
   1152    99    continue  ! these are ids from Level 2 decoder
   1153          kndx = 0
   1154          do iii = 1,nst
   1155             if(stnid(num1).eq.sids(iii)) then
   1156                kndx = iii
   1157                exit
   1158             endif
   1159          enddo
   1160    98    continue
   1161          if(kndx.ge.1.and.kndx.le.9999)  then
   1162             jtim = nint(tim(num1)+0.50)
   1163             if(jtim.ge.-3.and.jtim.le.3)  then
   1164                stnidx(kndx,jtim) = stnid(num1)
   1165                alatx(kndx,jtim) = xla(num1)
   1166                alonx(kndx,jtim) = xlo(num1)
   1167                numrpt(kndx,jtim) = numrpt(kndx,jtim) + 1
   1168             end if
   1169          end if
   1170       end if
   1171 
   1172       IF(PRINT_53) THEN
   1173          WRITE(53,501) ITM(NUM1),TIM(NUM1),STNID(NUM1),XLA(NUM1),
   1174      &     XLO(NUM1),ZST(NUM1)
   1175          WRITE(53,502)
   1176       END IF
   1177       if(print_52 .or. print_53) then
   1178          DO N=NUM1,NUM2
   1179             IF(PRINT_53)WRITE(53,503)LOB(N),ZOB(N),UOB(N),VOB(N),UFF(N),
   1180      &       VFF(N),TFF(N),ETYP(LOB(N))
   1181             if(print_52) then
   1182                if(kndx.ge.1.and.kndx.le.9999) then

Page 34          Source Listing                  EVNOUT
2017-04-18 11:07                                 cqcvad.f

   1183                   if(jtim.ge.-3.and.jtim.le.3)  then
   1184                      if(zob(n).lt.5487.) then ! less than 18,000 feet 
   1185                         if(nint(etyp(lob(n))).eq.5) then
   1186                            knt_5_yes(kndx,jtim) = knt_5_yes(kndx,jtim)+1
   1187                         else
   1188                            knt_5_no(kndx,jtim) = knt_5_no(kndx,jtim) + 1
   1189                         end if
   1190                      end if
   1191                   end if
   1192                end if
   1193             end if
   1194          ENDDO
   1195       end if
   1196   501 FORMAT(/,1X,I10,1X,F8.3,1X,A8,1X,F7.2,1X,F8.2,1X,F8.0)
   1197   502 FORMAT(' LOB    ZOB    UOB    VOB    UFF    VFF    TFF',
   1198      &       ' TYP')
   1199   503 FORMAT(2X,I2,F7.0,5(F7.1),F4.0)
   1200 
   1201       RETURN
   1202       END


ENTRY POINTS

  Name               
                     
 evnout_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  1125                                                           1128                              
 501                        Label  1196                                                           1173                              
 502                        Label  1197                                                           1175                              
 503                        Label  1199                                                           1179                              
 98                         Label  1160                                                           1151                              
 99                         Label  1152                                                           1150                              
 ABS                        Func   1122                                 scalar                    1122                              
 ALATX                      Scalar 1086     R(4)            4     2     69993    COM              1165                              
 ALONX                      Scalar 1087     R(4)            4     2     69993    COM              1166                              
 BIRDST                     Common 1086                                 1959804                                                     
 BMISS                      Scalar 1069     R(8)            8           scalar   COM              1103,1104,1105,1106               
 BUFRLIB_MISSING            Common 1084                                 8                                                           
 CON                        Scalar 1082     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 1083     R(4)            4           scalar   COM              1143                              
 ETYP                       Local  1092     R(4)            4     1     0                         1117,1137,1180,1185               
 EVENTS                     Common 1078                                 18000000                                                    
 EVENTW                     Subr   1142                                                           1142                              
 EVNOUT                     Subr   1065                                                                                             
 FLAG                       Common 1085                                 4                                                           
 GUESS                      Scalar 1085     L(4)            4           scalar   COM                                                
 HTEV                       Scalar 1078     R(4)            4     1     500000   COM              1122                              
 HTS                        Common 1081                                 280                                                         
 IEV                        Local  1120     I(4)            4           scalar                    1120,1121,1122,1123,1128,1132,1133
                                                                                                  ,1134,1135,1136,1137              

Page 35          Source Listing                  EVNOUT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IHE                        Scalar 1082     I(4)            4           scalar   COM                                                
 III                        Local  1154     I(4)            4           scalar                    1154,1155,1156                    
 INP                        Local  1094     I(4)            4     1     0                         1102,1132,1142                    
 IOUT                       Scalar 1082     I(4)            4           scalar   COM              1142                              
 ITM                        Scalar 1071     I(4)            4     1     500000   COM              1173                              
 IUNIT                      Scalar 1082     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 1082     I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 1081     I(4)            4     1     35       COM                                                
 JTIM                       Local  1162     I(4)            4           scalar                    1162,1163,1164,1165,1166,1167,1183
                                                                                                  ,1186,1188                        
 KNDX                       Local  1150     I(4)            4           scalar                    1150,1153,1156,1161,1164,1165,1166
                                                                                                  ,1167,1182,1186,1188              
 KNT_5_NO                   Scalar 1087     I(4)            4     2     69993    COM              1188                              
 KNT_5_YES                  Scalar 1087     I(4)            4     2     69993    COM              1186                              
 LEV                        Scalar 1078     I(4)            4     1     500000   COM              1128,1132                         
 LOB                        Scalar 1072     I(4)            4     1     500000   COM              1137,1179,1180,1185               
 LOOP1                      Label  1119                                 scalar                    1130,1140                         
 N                          Local  1119     I(4)            4           scalar                    1119,1121,1122,1123,1128,1137,1178
                                                                                                  ,1179,1180,1184,1185              
 NEV                        Scalar 1083     I(4)            4           scalar   COM                                                
 NEVN                       Local  1118     I(4)            4           scalar                    1118,1124,1126,1128,1129,1132,1133
                                                                                                  ,1134,1135,1136,1142              
 NEVNT                      Param  1068     I(4)            4           scalar                    1078,1079,1080                    
 NINT                       Func   1162                                 scalar                    1162,1185                         
 NLEV                       Param  1067     I(4)            4           scalar                    1081                              
 NLV                        Dummy  1065     I(4)            4           scalar   ARG,INOUT        1091,1092,1094,1126,1128,1142     
 NME                        Scalar 1083     I(4)            4           scalar   COM              1100,1120                         
 NRPT                       Param  1067     I(4)            4           scalar                    1071,1072,1073,1074,1075,1076     
 NST                        Scalar 1082     I(4)            4           scalar   COM              1154                              
 NSTN                       Param  1067     I(4)            4           scalar                    1076,1077                         
 NUM                        Scalar 1082     I(4)            4           scalar   COM                                                
 NUM1                       Dummy  1065     I(4)            4           scalar   ARG,INOUT        1100,1119,1128,1150,1155,1162,1164
                                                                                                  ,1165,1166,1173,1174,1178         
 NUM2                       Dummy  1065     I(4)            4           scalar   ARG,INOUT        1100,1119,1128,1178               
 NUMRPT                     Scalar 1088     I(4)            4     2     69993    COM              1167                              
 PARAMS                     Common 1082                                 40                                                          
 PRINT_52                   Scalar 1089     L(4)            4           scalar   COM              1145,1177,1181                    
 PRINT_53                   Scalar 1089     L(4)            4           scalar   COM              1172,1177,1179                    
 PRINT_60                   Scalar 1089     R(4)            4           scalar   COM                                                
 QALE                       Local  1091     R(4)            4     1     0                         1105,1135,1142                    
 QALEV                      Scalar 1080     R(4)            4     1     500000   COM              1135                              
 RCE                        Local  1091     R(4)            4     1     0                         1106,1136,1142                    
 RCEV                       Scalar 1080     R(4)            4     1     500000   COM              1136,1137                         
 SIDEV                      Scalar 1078     CHAR            8     1     500000   COM              1121                              
 SIDS                       Scalar 1076     CHAR            8     1     300      COM              1155                              
 SINGLE                     Common 1071                                 26000000                                                    
 SLAT                       Scalar 1076     R(4)            4     1     300      COM                                                
 SLON                       Scalar 1076     R(4)            4     1     300      COM                                                
 STN                        Common 1076                                 4006000                                                     
 STNID                      Scalar 1076     CHAR            8     1     500000   COM              1121,1128,1150,1155,1164,1173     
 STNIDX                     Scalar 1086     CHAR            8     2     69993    COM              1164                              
 SWITCHES                   Common 1089                                 16                                                          
 TEST                       Scalar 1089     R(4)            4           scalar   COM                                                
 TFF                        Scalar 1074     R(4)            4     1     500000   COM              1180                              
 TIM                        Scalar 1071     R(4)            4     1     500000   COM              1123,1162,1173                    

Page 36          Source Listing                  EVNOUT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TIMEV                      Scalar 1079     R(4)            4     1     500000   COM              1123                              
 UE                         Local  1091     R(4)            4     1     0                         1103,1133,1142                    
 UEV                        Scalar 1079     R(4)            4     1     500000   COM              1133                              
 UFF                        Scalar 1074     R(4)            4     1     500000   COM              1179                              
 UOB                        Scalar 1072     R(4)            4     1     500000   COM              1179                              
 VE                         Local  1091     R(4)            4     1     0                         1104,1134,1142                    
 VEV                        Scalar 1079     R(4)            4     1     500000   COM              1134                              
 VFF                        Scalar 1074     R(4)            4     1     500000   COM              1180                              
 VOB                        Scalar 1072     R(4)            4     1     500000   COM              1179                              
 WEVN                       Local  1097     CHAR            40          scalar                    1098,1142                         
 WQM                        Scalar 1075     R(4)            4     1     500000   COM                                                
 XLA                        Scalar 1073     R(4)            4     1     500000   COM              1165,1173                         
 XLO                        Scalar 1073     R(4)            4     1     500000   COM              1166,1174                         
 ZLEV                       Scalar 1081     R(4)            4     1     35       COM                                                
 ZOB                        Scalar 1071     R(4)            4     1     500000   COM              1122,1179,1184                    
 ZST                        Scalar 1073     R(4)            4     1     500000   COM              1174                              
 ZSTN                       Scalar 1077     R(4)            4     1     300      COM                                                

Page 37          Source Listing                  EVNOUT
2017-04-18 11:07                                 cqcvad.f

   1203 
   1204 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1205 C
   1206 C SUBPROGRAM: EVENTW
   1207 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-05-23
   1208 C
   1209 C ABSTRACT: COMPUTE EXPANSION FACTOR FOR CORECT.
   1210 C
   1211 C PROGRAM HISTORY LOG:
   1212 C 1994-MM-DD  J. WOOLLEN
   1213 C 1997-05-23  W. COLLINS  MODIFIED FOR WIND EVENT.
   1214 C 2012-03-05  S. MELCHIOR  CLARIFIED DOCUMENTATION.
   1215 C
   1216 C USAGE:   CALL EVENTW(LUNIT,EVNSTR,NLV,UOBS,VOBS,QMS,RCS,IND,NEVN,QCPC)
   1217 C   INPUT ARGUMENT LIST:
   1218 C     LUNIT    - UNIT NUMBER
   1219 C     EVNSTR   - EVENT STREAM OF CHARACTERS
   1220 C     NLV      - NUMBER OF LEVELS
   1221 C     UOBS     - OBSERVED U VALUES
   1222 C     VOBS     - OBSERVED V VALUES
   1223 C     QMS      - QUALITY MARKER
   1224 C     RCS      - REASON CODE
   1225 C     IND      - INDIRECT ADDRESS OF VALUE
   1226 C     NEVN     - NUMBER OF EVENTS
   1227 C     QCPC     - PROGRAM CODE
   1228 C
   1229 C   OUTPUT ARGUMENT LIST:
   1230 C     NONE
   1231 C
   1232 C ATTRIBUTES:
   1233 C   LANGUAGE: FORTRAN 90
   1234 C   MACHINE:  NCEP WCOSS
   1235 C
   1236 C$$$
   1237       SUBROUTINE EVENTW(LUNIT,EVNSTR,NLV,UOBS,VOBS,QMS,RCS,IND,NEVN,
   1238      &                  QCPC)
   1239       LOGICAL  PRINT_60
   1240       CHARACTER*(*) EVNSTR
   1241       DIMENSION     UOBS(NEVN),VOBS(NEVN),QMS(NEVN),RCS(NEVN),IND(NEVN)
   1242       REAL(8)       EVNS_8(5,255),BMISS
   1243 
   1244       COMMON /BUFRLIB_MISSING/BMISS
   1245       common /switches/  print_52, print_53, print_60, test
   1246 
   1247 C-----------------------------------------------------------------------
   1248 
   1249       IF(NEVN.EQ.0) GOTO 100
   1250 
   1251 
   1252 C  CLEAR THE UFB ARRAY FIRST
   1253 C  -------------------------
   1254 
   1255       EVNS_8 = BMISS
   1256 
   1257 C  TRANSFER EVENT ARRAYS INTO UFB ARRAY
   1258 C  ------------------------------------
   1259 

Page 38          Source Listing                  EVENTW
2017-04-18 11:07                                 cqcvad.f

   1260       DO I=1,NEVN
   1261         J = IND(I)
   1262         IF(UOBS(I).LT.BMISS .AND. J.LE.255) THEN
   1263            EVNS_8(1,J) = UOBS(I)
   1264            EVNS_8(2,J) = VOBS(I)
   1265            EVNS_8(3,J) = QMS(I)
   1266            EVNS_8(4,J) = QCPC
   1267            EVNS_8(5,J) = RCS(I)
   1268         ENDIF
   1269       ENDDO
   1270 
   1271 C  WRITE THE EVENTS
   1272 C  ----------------
   1273 
   1274       CALL UFBINT(LUNIT,EVNS_8,5,NLV,IRET,EVNSTR)
   1275 
   1276   100 CONTINUE
   1277 
   1278       IF(PRINT_60) WRITE(60,501) LUNIT,NEVN,NLV,IRET,EVNSTR,
   1279      & QCPC
   1280   501 FORMAT(' EVENTW--LUNIT,NEVN,NLV,IRET,EVNSTR:',4I5,A60,
   1281      &  ' QCPC:',F8.0)
   1282 
   1283       RETURN
   1284       END


ENTRY POINTS

  Name               
                     
 eventw_             

Page 39          Source Listing                  EVENTW
2017-04-18 11:07 Symbol Table                    cqcvad.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  1276                                                           1249                              
 501                        Label  1280                                                           1278                              
 BMISS                      Scalar 1242     R(8)            8           scalar   COM              1255,1262                         
 BUFRLIB_MISSING            Common 1244                                 8                                                           
 EVENTW                     Subr   1237                                                                                             
 EVNSTR                     Dummy  1237     CHAR                        scalar   ARG,INOUT        1274,1278                         
 EVNS_8                     Local  1242     R(8)            8     2     1275                      1255,1263,1264,1265,1266,1267,1274
 I                          Local  1260     I(4)            4           scalar                    1260,1261,1262,1263,1264,1265,1267
 IND                        Dummy  1237     I(4)            4     1     0        ARG,INOUT        1261                              
 IRET                       Local  1274     I(4)            4           scalar                    1274,1278                         
 J                          Local  1261     I(4)            4           scalar                    1261,1262,1263,1264,1265,1266,1267
 LUNIT                      Dummy  1237     I(4)            4           scalar   ARG,INOUT        1274,1278                         
 NEVN                       Dummy  1237     I(4)            4           scalar   ARG,INOUT        1241,1249,1260,1278               
 NLV                        Dummy  1237     I(4)            4           scalar   ARG,INOUT        1274,1278                         
 PRINT_52                   Scalar 1245     R(4)            4           scalar   COM                                                
 PRINT_53                   Scalar 1245     R(4)            4           scalar   COM                                                
 PRINT_60                   Scalar 1239     L(4)            4           scalar   COM              1278                              
 QCPC                       Dummy  1238     R(4)            4           scalar   ARG,INOUT        1266,1279                         
 QMS                        Dummy  1237     R(4)            4     1     0        ARG,INOUT        1265                              
 RCS                        Dummy  1237     R(4)            4     1     0        ARG,INOUT        1267                              
 SWITCHES                   Common 1245                                 16                                                          
 TEST                       Scalar 1245     R(4)            4           scalar   COM                                                
 UFBINT                     Subr   1274                                                           1274                              
 UOBS                       Dummy  1237     R(4)            4     1     0        ARG,INOUT        1262,1263                         
 VOBS                       Dummy  1237     R(4)            4     1     0        ARG,INOUT        1264                              

Page 40          Source Listing                  EVENTW
2017-04-18 11:07                                 cqcvad.f

   1285 
   1286 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1287 C
   1288 C SUBPROGRAM: GETDAT
   1289 C   PRGMMR: S. Melchior      ORG: NP22       DATE: 2016-12-18
   1290 C
   1291 C ABSTRACT: READ PREPBUFR DATA
   1292 C
   1293 C PROGRAM HISTORY LOG:
   1294 C 1999-08-18  W. COLLINS
   1295 C 2001-10-08  D. KEYSER   VALID DATES FOR CHECKING FOR MIGRATING
   1296 C       BIRDS EXPANDED FROM 2/15 THROUGH 6/15 TO 2/1 THROUGH 6/30
   1297 C       IN SPRING AND FROM 8/15 THROUGH 11/15 TO 8/1 THROUGH 11/30
   1298 C       IN FALL
   1299 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO
   1300 C       TIDY UP THE CODE. ADDED DIAGNOSTIC OUTPUT PRINT STATEMENTS
   1301 C       WHEN LIMITS ARE EXCEEDED. RENAMED NE TO NME TO EASE NAVIGATION
   1302 C       AND FOR CLARIFICATION SINCE NE IS USED FOR INEQUALITY TESTING
   1303 C       (.NE.).  ADDED LOGIC TO TURN OFF BIRD CHECK ALGORITHM FOR VAD
   1304 C       WIND REPORTS FROM LEVEL 2 DECODER.  CORRECTED LOGIC TO HANDLE
   1305 C       SITUATIONS WHEN THE SUBSET IS VADWND BUT THE NUMBER OF LEVELS
   1306 C       (NUM) EXCEEDS NRPT.  INCREASED NRPT FROM 80000 TO 160000 TO
   1307 C       ACCOMMODATE VAD WIND REPORTS FROM LEVEL 2 DECODER.
   1308 C 2014-01-15  S. Melchior  Increased NRPT (total number of levels
   1309 C       amongst all VAD reports that can be processed) from 160000 to
   1310 C       500000 to accommodate VAD wind reports from Level 2 decoder.
   1311 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   1312 C       process) from 200 to 300.  Also made a minor logic correction
   1313 C       so that the station info for the "NSTN'th" id is stored if
   1314 C       there are at least that many unique ids.
   1315 C
   1316 C USAGE:    CALL GETDAT(ITIME)
   1317 C   INPUT ARGUMENT LIST:
   1318 C     ITIME    - INDICTES FIRST OR SECOND READ OF DATA
   1319 C
   1320 C ATTRIBUTES:
   1321 C   LANGUAGE: FORTRAN 90
   1322 C   MACHINE:  NCEP WCOSS
   1323 C
   1324 C$$$
   1325       SUBROUTINE GETDAT(ITIME)
   1326 
   1327       PARAMETER (NRPT=500000,NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   1328       PARAMETER (MLV=255)         ! no. of possible levels
   1329       INTEGER IDAT(8), JDAT(8), ITIMES(8,4)
   1330       REAL    TDIF(5,4), RINC(5)
   1331       REAL(8) HDR_8(10), OBS_8(7,MLV), BMISS
   1332       CHARACTER*2 AYR, AHR
   1333       CHARACTER*3 ADOY
   1334       CHARACTER*8 CDR(10),SUBSET,YYMM,DDHH,Q,SID,STNID,SIDS
   1335       CHARACTER*10 CDATE
   1336       EQUIVALENCE (HDR_8,CDR)
   1337       COMMON /SINGLE/ ZOB(NRPT), ITM(NRPT),TIM(NRPT),
   1338      &                UOB(NRPT), VOB(NRPT), LOB(NRPT),
   1339      &                XLA(NRPT), XLO(NRPT), ZST(NRPT),
   1340      &                UFF(NRPT), VFF(NRPT), TFF(NRPT),
   1341      &                WQM(NRPT)

Page 41          Source Listing                  GETDAT
2017-04-18 11:07                                 cqcvad.f

   1342       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   1343      &                VIN(NLEV,NTIMES,NINC,NSTN),
   1344      &                UUU(NLEV,NTIMES,NINC,NSTN),
   1345      &                VVV(NLEV,NTIMES,NINC,NSTN),
   1346      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   1347      &                NIN(NLEV,NTIMES,NSTN),
   1348      &                LLL(NLEV,NTIMES,NINC,NSTN),
   1349      &                TFC(NLEV,NTIMES,NINC,NSTN),
   1350      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   1351       COMMON /STN/    SLAT(NSTN), SLON(NSTN), SIDS(NSTN), STNID(NRPT),
   1352      &                ZSTN(NSTN)
   1353       COMMON /DATET/  IDATE(4), ITIM(6)
   1354       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
   1355       COMMON /PARAMS/ IUNIT, IUTIM, IOUT,
   1356      &                CON, IHE, NUM, NST,
   1357      &                CQCPC, NEV, NME
   1358       COMMON /BUFRLIB_MISSING/BMISS
   1359       COMMON /BIRDS/ BIRDTIME
   1360       DATA ITIMES/0, 2,01,0,0,0,0,0,
   1361      &            0, 6,30,0,0,0,0,0,
   1362      &            0, 8,01,0,0,0,0,0,
   1363      &            0,11,30,0,0,0,0,0/
   1364 
   1365 C  READ CENTRAL TIME (year,month,day,hour)
   1366 C  ---------------------------------------
   1367 
   1368       IF(ITIME.EQ.1) THEN
   1369         CALL DATELEN(10)
   1370         REWIND IUTIM
   1371         READ(IUTIM,500) (IDATE(I),I=1,4)
   1372         WRITE(6,501) (IDATE(I),I=1,4)
   1373   500   FORMAT(I4,3I2)
   1374   501   FORMAT(' GETDAT--IDATE (central data time): ',I4,3I2.2)
   1375 
   1376 C------------------------------------------------
   1377 C  NCEP absolute date and time data structure:
   1378 C    (1)     4-digit year
   1379 C    (2)     month of year (1-12)
   1380 C    (3)     day of month (1-31)
   1381 C    (4)     hhmm time zone differential from UTC
   1382 C    (5)     hour of day in 24-hour clock (0-23)
   1383 C    (6)     minutes of hour (0-59)
   1384 C    (7)     seconds of minute (0-59)
   1385 C    (8)     milliseconds of second (0-999)
   1386 C------------------------------------------------
   1387 C  NCEP relative time interval data structure
   1388 C    (1)     number of days
   1389 C    (2)     number of hours
   1390 C    (3)     number of minutes
   1391 C    (4)     number of seconds
   1392 C    (5)     number of milliseconds
   1393 C------------------------------------------------
   1394 C  Note! IDAT and JDAT are in absolute time, while
   1395 C  RINC is in relative time.
   1396 C  IDAT and JDAT are INTEGER;  RINC is REAL.
   1397 C------------------------------------------------
   1398 

Page 42          Source Listing                  GETDAT
2017-04-18 11:07                                 cqcvad.f

   1399         IDAT      = 0
   1400         IDAT(1:3) = IDATE(1:3)
   1401         IDAT(5)   = IDATE(4)
   1402         DO I=1,6
   1403           MIT = I-1+IHE
   1404           RINC(1) = 0
   1405           RINC(2) = MIT
   1406           RINC(3) = 0
   1407           RINC(4) = 0
   1408           RINC(5) = 0
   1409           CALL W3MOVDAT(RINC,IDAT,JDAT)
   1410           ITIM(I) = JDAT(5)+100*(JDAT(3)+100*(JDAT(2)+100*JDAT(1)))
   1411         ENDDO
   1412 
   1413         WRITE(6,505) (ITIM(I),I=1,6)
   1414   505   FORMAT(' GETDAT--ITIM(I): ',6I12)
   1415 
   1416 C  COMPARE TIMES FOR "ANTI-BIRD" ROUTINE
   1417 C  -------------------------------------
   1418 
   1419         ITIMES(1,1:4) = IDATE(1)
   1420         DO J=1,4
   1421           CALL W3DIFDAT(IDAT,ITIMES(1,J),1,TDIF(1,J))
   1422           WRITE(6,511) (IDAT(II),II=1,8),(ITIMES(II,J),II=1,8),
   1423      &                  TDIF(1,J)
   1424   511     FORMAT(' GETDAT--IDAT,ITIMES,TDIF: ',8I5,4X,8I5,4X,F8.2)
   1425         ENDDO
   1426         IF(TDIF(1,1).GT.0. .AND. MAX(TDIF(1,2),TDIF(1,3),TDIF(1,4))
   1427      &   .LT.0.) THEN
   1428           BIRDTIME = 1.           ! between 01 Feb and 30 Jun
   1429         ELSE IF(MIN(TDIF(1,1),TDIF(1,2),TDIF(1,3)).GT.0. .AND.
   1430      $   TDIF(1,4).LT.0.) THEN
   1431           BIRDTIME = 2.           ! between 01 Aug and 30 Nov
   1432         ELSE
   1433           BIRDTIME = 0.
   1434         ENDIF
   1435 
   1436         WRITE(6,506) BIRDTIME
   1437   506   FORMAT(' GETDAT--BIRDTIME: ',F5.0,/,
   1438      &    '     1. - between 01 Feb and 30 Jun',/,
   1439      &    '     2. - between 01 Aug and 30 Nov',/,
   1440      &    '     0. - otherwise')
   1441 
   1442       ENDIF
   1443 
   1444 C  INITIALIZE DATA COLLECITON ARRAYS
   1445 C  ---------------------------------
   1446 
   1447       NUM   = 0
   1448       OBS_8   = BMISS
   1449       ZOB   = BMISS
   1450       UOB   = BMISS
   1451       VOB   = BMISS
   1452       UIN   = BMISS
   1453       VIN   = BMISS
   1454       XLA   = BMISS
   1455       XLO   = BMISS

Page 43          Source Listing                  GETDAT
2017-04-18 11:07                                 cqcvad.f

   1456       ITM   = 0
   1457       TIM   = BMISS
   1458       STNID = '        '
   1459 
   1460       CALL CLOSBF(IUNIT)
   1461       REWIND IUNIT
   1462       CALL OPENBF(IUNIT,'IN',IUNIT)
   1463       CALL READMG(IUNIT,SUBSET,KDATE,IRETMG)
   1464       IF(IRETMG.NE.0) GOTO 6
   1465       WRITE(CDATE,'(I10)') KDATE
   1466       PRINT*,'DATA VALID AT ',CDATE
   1467       CALL UFBQCD(IUNIT,'CQCVAD ',CQCPC)
   1468       WRITE(6,502) CQCPC
   1469   502 FORMAT(' PROGRAM CODE NUMBER =',F5.0)
   1470       CALL CLOSBF(IUNIT)
   1471       REWIND IUNIT
   1472       CALL OPENBF(IUNIT,'IN',IUNIT)
   1473       IF(ITIME.EQ.2) CALL OPENBF(IOUT,'OUT',IUNIT)
   1474       IS = 0
   1475       IRETSB = 1
   1476 
   1477 C  READ A REPORT
   1478 C  -------------
   1479 
   1480     5 CONTINUE
   1481       IF(IRETSB.NE.0) CALL READMG(IUNIT,SUBSET,KDATE,IRETMG)
   1482     6 CONTINUE
   1483       IF(IRETMG.NE.0) THEN
   1484         WRITE(6,510) IUNIT, IOUT
   1485   510   FORMAT(' GETDAT--CLOSING UNITS:',2I4)
   1486         CALL CLOSBF(IUNIT)
   1487         CALL CLOSBF(IOUT)
   1488         GOTO 20
   1489       ENDIF
   1490       IF(ITIME.EQ.2) THEN
   1491         IF(SUBSET.NE.'VADWND') THEN
   1492           CALL CLOSMG(IOUT)
   1493           CALL COPYMG(IUNIT,IOUT)
   1494           GOTO 5
   1495         ELSE
   1496           if(num.ge.nrpt) then
   1497             iretsb = -1
   1498             go to 5
   1499           endif
   1500           CALL OPENMB(IOUT,SUBSET,KDATE)
   1501         ENDIF
   1502       ELSE IF(SUBSET.NE.'VADWND') THEN
   1503         GOTO 5
   1504       else if(num.ge.nrpt) then
   1505         iretsb = -1
   1506         go to 5
   1507       ENDIF
   1508    30 CONTINUE
   1509       CALL READSB(IUNIT,IRETSB)
   1510       IF(IRETSB.NE.0) GOTO 5
   1511  
   1512       CALL GETOBV(IUNIT,HDR_8,NLV,OBS_8)

Page 44          Source Listing                  GETDAT
2017-04-18 11:07                                 cqcvad.f

   1513 
   1514 C  COLLECT STATION DATA
   1515 C  --------------------
   1516 
   1517       NUM1 = NUM + 1
   1518       RINC = 0
   1519       IDAT = 0
   1520       DO I=1,NLV
   1521         IF(OBS_8(1,I).GE.CON.AND.MAX(OBS_8(2,I),OBS_8(3,I)).LT.BMISS)
   1522      $   THEN
   1523           NUM        = NUM + 1
   1524           if(num.ge.nrpt) then
   1525             print *,'WARNING: NUM>=NRPT, can''t process anymore VAD obs'
   1526             call system('[ -n "$jlogfile" ] && $DATA/postmsg'//
   1527      $       ' "$jlogfile" "***WARNING: NUM >= NRPT, cannot process '//
   1528      $       'any more VAD reports"')
   1529             iretsb = -1
   1530             go to 5
   1531           endif
   1532           STNID(NUM) = CDR(1)
   1533           XLO(NUM)   = HDR_8(2)
   1534           XLA(NUM)   = HDR_8(3)
   1535           ZST(NUM)   = HDR_8(5)
   1536           IDAT(1) = ITIM(1)/1000000
   1537           IDAT(2) = MOD(ITIM(1)/10000,100)
   1538           IDAT(3) = MOD(ITIM(1)/100,100)
   1539           IDAT(5) = MOD(ITIM(1),100)
   1540           RINC(2) = HDR_8(4) - IHE
   1541           CALL W3MOVDAT(RINC,IDAT,JDAT)
   1542           ITM(NUM) = JDAT(5)+100*(JDAT(3)+100*(JDAT(2)+100*JDAT(1)))
   1543           TIM(NUM)   = HDR_8(4)
   1544           LOB(NUM)   = I
   1545           ZOB(NUM)   = OBS_8(1,I)
   1546           UOB(NUM)   = OBS_8(2,I)
   1547           VOB(NUM)   = OBS_8(3,I)
   1548           UFF(NUM)   = OBS_8(4,I)
   1549           VFF(NUM)   = OBS_8(5,I)
   1550           TFF(NUM)   = OBS_8(6,I)
   1551           WQM(NUM)   = OBS_8(7,I)
   1552         ENDIF
   1553 
   1554 c     Turn off bird algorithm QC for VAD wind reports from Level 2
   1555 c      decoder
   1556       read(stnid(num),'(i4)',err=89) kdmy
   1557       go to 90 ! radar coded vadwnd data
   1558    89 continue ! VAD wind reports from Level 2 decoder
   1559       birdtime = 0. ! override regardless of season
   1560    90 continue
   1561 
   1562       ENDDO
   1563       NUM2 = NUM
   1564       if(num.ge.nrpt) then
   1565         print *,'WARNING: NUM>=NRPT, can''t process anymore VAD obs'
   1566         call system('[ -n "$jlogfile" ] && $DATA/postmsg'//
   1567      $  ' "$jlogfile" "***WARNING: NUM >= NRPT, cannot process '//
   1568      $  'any more VAD reports"')
   1569         iretsb = -1

Page 45          Source Listing                  GETDAT
2017-04-18 11:07                                 cqcvad.f

   1570         go to 5
   1571       endif
   1572 
   1573       IF(ITIME.EQ.2) THEN
   1574         CALL UFBCPY(IUNIT,IOUT)
   1575         CALL EVNOUT(NUM1,NUM2,NLV)
   1576         CALL WRITSB(IOUT)
   1577       ENDIF
   1578 
   1579       GOTO 30
   1580 
   1581    20 CONTINUE
   1582 
   1583       WRITE(6,508) NUM, ITIME
   1584   508 FORMAT(' Number of levels reported: ',I6,'  for ITIME: ',I1)
   1585 
   1586       IF(ITIME.EQ.2) RETURN
   1587 
   1588 C  ALL DATA IS NOW READ IN.  DO PROCESSING ON LINEAR ARRAYS OF DATA.
   1589 C  -----------------------------------------------------------------
   1590 
   1591 C  MAKE A LIST OF THE STATIONS REPORTING
   1592 C  -------------------------------------
   1593 
   1594       NST = 0
   1595       sids(1) = '        ' ! initialize sids(1)
   1596       LOOP1: DO I=1,NUM
   1597         LOOP1n1: DO IS=1,NSTN
   1598           IF(SIDS(IS).EQ.STNID(I)) CYCLE LOOP1
   1599         ENDDO LOOP1n1
   1600         if(nst.ge.nstn) then
   1601           print *, 'WARNING: NST>=NSTN, EXIT LOOP'
   1602           exit LOOP1
   1603         endif
   1604         NST = NST + 1
   1605         SIDS(NST) = STNID(I)
   1606         SLAT(NST) = XLA(I)
   1607         SLON(NST) = XLO(I)
   1608         ZSTN(NST) = ZST(I)
   1609       ENDDO LOOP1
   1610 
   1611       WRITE(6,507) NST
   1612   507 FORMAT(' Number of stations reporting: ',I5,/,
   1613      &       '    Station     Lat     Lon  Stn Ht')
   1614       WRITE(6,509) (SIDS(I),SLAT(I),SLON(I),ZSTN(I),I=1,NST)
   1615   509 FORMAT(1X,A10,2F8.2,F8.0)
   1616 
   1617       RETURN
   1618       END

Page 46          Source Listing                  GETDAT
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name               
                     
 getdat_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  1581                                                           1488                              
 30                         Label  1508                                                           1579                              
 5                          Label  1480                                                           1494,1498,1503,1506,1510,1530,1570
 500                        Label  1373                                                           1371                              
 501                        Label  1374                                                           1372                              
 502                        Label  1469                                                           1468                              
 505                        Label  1414                                                           1413                              
 506                        Label  1437                                                           1436                              
 507                        Label  1612                                                           1611                              
 508                        Label  1584                                                           1583                              
 509                        Label  1615                                                           1614                              
 510                        Label  1485                                                           1484                              
 511                        Label  1424                                                           1422                              
 6                          Label  1482                                                           1464                              
 89                         Label  1558                                                           1556                              
 90                         Label  1560                                                           1557                              
 ADOY                       Local  1333     CHAR            3           scalar                                                      
 AHR                        Local  1332     CHAR            2           scalar                                                      
 AYR                        Local  1332     CHAR            2           scalar                                                      
 BIRDS                      Common 1359                                 4                                                           
 BIRDTIME                   Scalar 1359     R(4)            4           scalar   COM              1428,1431,1433,1436,1559          
 BMISS                      Scalar 1331     R(8)            8           scalar   COM              1448,1449,1450,1451,1452,1453,1454
                                                                                                  ,1455,1457,1521                   
 BUFRLIB_MISSING            Common 1358                                 8                                                           
 CDATE                      Local  1335     CHAR            10          scalar                    1465,1466                         
 CDR                        Local  1334     CHAR            8     1     10                        1532                              
 CLOSBF                     Subr   1460                                                           1460,1470,1486,1487               
 CLOSMG                     Subr   1492                                                           1492                              
 CON                        Scalar 1356     R(4)            4           scalar   COM              1521                              
 COPYMG                     Subr   1493                                                           1493                              
 CQCPC                      Scalar 1357     R(4)            4           scalar   COM              1467,1468                         
 DATELEN                    Subr   1369                                                           1369                              
 DATET                      Common 1353                                 40                                                          
 DDHH                       Local  1334     CHAR            8           scalar                                                      
 EVNOUT                     Subr   1575                                                           1575                              
 GETDAT                     Subr   1325                                                                                             
 GETOBV                     Subr   1512                                                           1512                              
 HDR_8                      Local  1331     R(8)            8     1     10                        1512,1533,1534,1535,1540,1543     
 HTS                        Common 1354                                 280                                                         
 I                          Local  1371     I(4)            4           scalar                    1371,1372,1402,1403,1410,1413,1520
                                                                                                  ,1521,1544,1545,1546,1547,1548,154
                                                                                                  9,1550,1551,1596,1598,1605,1606,16
                                                                                                  07,1608,1614                      
 IDAT                       Local  1329     I(4)            4     1     8                         1399,1400,1401,1409,1421,1422,1519

Page 47          Source Listing                  GETDAT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,1536,1537,1538,1539,1541         
 IDATE                      Scalar 1353     I(4)            4     1     4        COM              1371,1372,1400,1401,1419          
 IHE                        Scalar 1356     I(4)            4           scalar   COM              1403,1540                         
 II                         Local  1422     I(4)            4           scalar                    1422                              
 INCS                       Common 1342                                 6300000                                                     
 IOUT                       Scalar 1355     I(4)            4           scalar   COM              1473,1484,1487,1492,1493,1500,1574
                                                                                                  ,1576                             
 IRETMG                     Local  1463     I(4)            4           scalar                    1463,1464,1481,1483               
 IRETSB                     Local  1475     I(4)            4           scalar                    1475,1481,1497,1505,1509,1510,1529
                                                                                                  ,1569                             
 IS                         Local  1474     I(4)            4           scalar                    1474,1597,1598                    
 ITIM                       Scalar 1353     I(4)            4     1     6        COM              1410,1413,1536,1537,1538,1539     
 ITIME                      Dummy  1325     I(4)            4           scalar   ARG,INOUT        1368,1473,1490,1573,1583,1586     
 ITIMES                     Local  1329     I(4)            4     2     32                        1360,1419,1421,1422               
 ITM                        Scalar 1337     I(4)            4     1     500000   COM              1456,1542                         
 IUNIT                      Scalar 1355     I(4)            4           scalar   COM              1460,1461,1462,1463,1467,1470,1471
                                                                                                  ,1472,1473,1481,1484,1486,1493,150
                                                                                                  9,1512,1574                       
 IUTIM                      Scalar 1355     I(4)            4           scalar   COM              1370,1371                         
 IZLEV                      Scalar 1354     I(4)            4     1     35       COM                                                
 J                          Local  1420     I(4)            4           scalar                    1420,1421,1422,1423               
 JDAT                       Local  1329     I(4)            4     1     8                         1409,1410,1541,1542               
 KDATE                      Local  1463     I(4)            4           scalar                    1463,1465,1481,1500               
 KDMY                       Local  1556     I(4)            4           scalar                    1556                              
 LLL                        Scalar 1348     I(4)            4     4     189000   COM                                                
 LOB                        Scalar 1338     I(4)            4     1     500000   COM              1544                              
 LOOP1                      Label  1596                                 scalar                    1598,1602,1609                    
 LOOP1N1                    Label  1597                                 scalar                    1599                              
 MAX                        Func   1426                                 scalar                    1426,1521                         
 MIN                        Func   1429                                 scalar                    1429                              
 MIT                        Local  1403     I(4)            4           scalar                    1403,1405                         
 MLV                        Param  1328     I(4)            4           scalar                    1331                              
 MOD                        Func   1537                                 scalar                    1537,1538,1539                    
 NEV                        Scalar 1357     I(4)            4           scalar   COM                                                
 NIN                        Scalar 1347     I(4)            4     3     63000    COM                                                
 NINC                       Param  1327     I(4)            4           scalar                    1342,1343,1344,1345,1346,1348,1349
                                                                                                  ,1350                             
 NLEV                       Param  1327     I(4)            4           scalar                    1342,1343,1344,1345,1346,1347,1348
                                                                                                  ,1349,1350,1354                   
 NLV                        Local  1512     I(4)            4           scalar                    1512,1520,1575                    
 NME                        Scalar 1357     I(4)            4           scalar   COM                                                
 NRPT                       Param  1327     I(4)            4           scalar                    1337,1338,1339,1340,1341,1351,1496
                                                                                                  ,1504,1524,1564                   
 NST                        Scalar 1356     I(4)            4           scalar   COM              1594,1600,1604,1605,1606,1607,1608
                                                                                                  ,1611,1614                        
 NSTN                       Param  1327     I(4)            4           scalar                    1342,1343,1344,1345,1346,1347,1348
                                                                                                  ,1349,1350,1351,1352,1597,1600    
 NTIMES                     Param  1327     I(4)            4           scalar                    1342,1343,1344,1345,1346,1347,1348
                                                                                                  ,1349,1350                        
 NUM                        Scalar 1356     I(4)            4           scalar   COM              1447,1496,1504,1517,1523,1524,1532
                                                                                                  ,1533,1534,1535,1542,1543,1544,154
                                                                                                  5,1546,1547,1548,1549,1550,1551,15
                                                                                                  56,1563,1564,1583,1596            
 NUM1                       Local  1517     I(4)            4           scalar                    1517,1575                         
 NUM2                       Local  1563     I(4)            4           scalar                    1563,1575                         

Page 48          Source Listing                  GETDAT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 OBS_8                      Local  1331     R(8)            8     2     1785                      1448,1512,1521,1545,1546,1547,1548
                                                                                                  ,1549,1550,1551                   
 OPENBF                     Subr   1462                                                           1462,1472,1473                    
 OPENMB                     Subr   1500                                                           1500                              
 PARAMS                     Common 1355                                 40                                                          
 Q                          Local  1334     CHAR            8           scalar                                                      
 QQQ                        Scalar 1350     R(4)            4     4     189000   COM                                                
 READMG                     Subr   1463                                                           1463,1481                         
 READSB                     Subr   1509                                                           1509                              
 RINC                       Local  1330     R(4)            4     1     5                         1404,1405,1406,1407,1408,1409,1518
                                                                                                  ,1540,1541                        
 SID                        Local  1334     CHAR            8           scalar                                                      
 SIDS                       Scalar 1334     CHAR            8     1     300      COM              1595,1598,1605,1614               
 SINGLE                     Common 1337                                 26000000                                                    
 SLAT                       Scalar 1351     R(4)            4     1     300      COM              1606,1614                         
 SLON                       Scalar 1351     R(4)            4     1     300      COM              1607,1614                         
 STN                        Common 1351                                 4006000                                                     
 STNID                      Scalar 1334     CHAR            8     1     500000   COM              1458,1532,1556,1598,1605          
 SUBSET                     Local  1334     CHAR            8           scalar                    1463,1481,1491,1500,1502          
 SYSTEM                     Subr   1526                                                           1526,1566                         
 TDIF                       Local  1330     R(4)            4     2     20                        1421,1423,1426,1429,1430          
 TFC                        Scalar 1349     R(4)            4     4     189000   COM                                                
 TFF                        Scalar 1340     R(4)            4     1     500000   COM              1550                              
 TIM                        Scalar 1337     R(4)            4     1     500000   COM              1457,1543                         
 TIMIN                      Scalar 1346     R(4)            4     4     189000   COM                                                
 UFBCPY                     Subr   1574                                                           1574                              
 UFBQCD                     Subr   1467                                                           1467                              
 UFF                        Scalar 1340     R(4)            4     1     500000   COM              1548                              
 UIN                        Scalar 1342     R(4)            4     4     189000   COM              1452                              
 UOB                        Scalar 1338     R(4)            4     1     500000   COM              1450,1546                         
 UUU                        Scalar 1344     R(4)            4     4     189000   COM                                                
 VFF                        Scalar 1340     R(4)            4     1     500000   COM              1549                              
 VIN                        Scalar 1343     R(4)            4     4     189000   COM              1453                              
 VOB                        Scalar 1338     R(4)            4     1     500000   COM              1451,1547                         
 VVV                        Scalar 1345     R(4)            4     4     189000   COM                                                
 W3DIFDAT                   Subr   1421                                                           1421                              
 W3MOVDAT                   Subr   1409                                                           1409,1541                         
 WQM                        Scalar 1341     R(4)            4     1     500000   COM              1551                              
 WRITSB                     Subr   1576                                                           1576                              
 XLA                        Scalar 1339     R(4)            4     1     500000   COM              1454,1534,1606                    
 XLO                        Scalar 1339     R(4)            4     1     500000   COM              1455,1533,1607                    
 YYMM                       Local  1334     CHAR            8           scalar                                                      
 ZLEV                       Scalar 1354     R(4)            4     1     35       COM                                                
 ZOB                        Scalar 1337     R(4)            4     1     500000   COM              1449,1545                         
 ZST                        Scalar 1339     R(4)            4     1     500000   COM              1535,1608                         
 ZSTN                       Scalar 1352     R(4)            4     1     300      COM              1608,1614                         

Page 49          Source Listing                  GETDAT
2017-04-18 11:07                                 cqcvad.f

   1619 
   1620 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1621 C
   1622 C SUBPROGRAM: GETOBV
   1623 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1997-03-18
   1624 C
   1625 C ABSTRACT: Read data for a single observation. Place the data in
   1626 C   OBS_8.
   1627 C
   1628 C PROGRAM HISTORY LOG:
   1629 C   97-03-18  W. COLLINS
   1630 C 2012-03-05  S. MELCHIOR  ADDED MORE DESCRIPTIVE DOCUMENTATION AND
   1631 C       CORRECTED DOCUMENTATION TYPO.
   1632 C
   1633 C USAGE:    CALL GETOBV(LUBFR,HDR_8,NLEV,OBS_8)
   1634 C   INPUT ARGUMENT LIST:
   1635 C     LUBFR    - UNIT NO. OF INPUT BUFR FILE
   1636 C
   1637 C   OUTPUT ARGUMENT LIST:
   1638 C     HDR_8    - ARRAY OF OB HEADER INFORMATION
   1639 C     NLEV     - NUMBER OF LEVELS
   1640 C     OBS_8    - ARRAY OF OBSERVATIONS
   1641 C
   1642 C ATTRIBUTES:
   1643 C   LANGUAGE: FORTRAN 90
   1644 C   MACHINE:  NCEP WCOSS
   1645 C
   1646 C$$$
   1647 
   1648       SUBROUTINE GETOBV(LUBFR,HDR_8,NLEV,OBS_8)
   1649 
   1650 C     THIS SUBROUTINE RETURNS ALL EVENTS FOR AN OBSERVATION
   1651 
   1652       PARAMETER (MVR=10)       ! dimensions of header
   1653       PARAMETER (MLV=255)      ! number of possible levels
   1654 
   1655 C     Last index of OBS_8: value, fcst value, quality mark, program
   1656 c     code, reason code
   1657 
   1658       CHARACTER*28 OBSTR
   1659       CHARACTER*40 HDSTR
   1660       REAL(8) HDR_8(10), OBS_8(7,MLV), BMISS
   1661 
   1662       COMMON /BUFRLIB_MISSING/BMISS
   1663 
   1664       DATA HDSTR /'SID XOB YOB DHR ELV ITP TYP             '/
   1665       DATA OBSTR /'ZOB UOB VOB UFC VFC TFC WQM '/
   1666 
   1667       HDR_8 = BMISS
   1668       OBS_8 = BMISS
   1669 
   1670 C  READ HEADER
   1671 C  -----------
   1672 
   1673       CALL UFBINT(LUBFR,HDR_8,MVR,1,IRET,HDSTR)
   1674 
   1675 C  READ EVENTS

Page 50          Source Listing                  GETOBV
2017-04-18 11:07                                 cqcvad.f

   1676 C  -----------
   1677 
   1678       CALL UFBINT(LUBFR,OBS_8,7,MLV,NLEV,OBSTR)
   1679 
   1680       RETURN
   1681       END


ENTRY POINTS

  Name               
                     
 getobv_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 1660     R(8)            8           scalar   COM              1667,1668                         
 BUFRLIB_MISSING            Common 1662                                 8                                                           
 GETOBV                     Subr   1648                                                                                             
 HDR_8                      Dummy  1648     R(8)            8     1     10       ARG,INOUT        1667,1673                         
 HDSTR                      Local  1659     CHAR            40          scalar                    1664,1673                         
 IRET                       Local  1673     I(4)            4           scalar                    1673                              
 LUBFR                      Dummy  1648     I(4)            4           scalar   ARG,INOUT        1673,1678                         
 MLV                        Param  1653     I(4)            4           scalar                    1660,1678                         
 MVR                        Param  1652     I(4)            4           scalar                    1673                              
 NLEV                       Dummy  1648     I(4)            4           scalar   ARG,INOUT        1678                              
 OBSTR                      Local  1658     CHAR            28          scalar                    1665,1678                         
 OBS_8                      Dummy  1648     R(8)            8     2     1785     ARG,INOUT        1668,1678                         
 UFBINT                     Subr   1673                                                           1673,1678                         

Page 51          Source Listing                  GETOBV
2017-04-18 11:07                                 cqcvad.f

   1682 
   1683 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1684 C
   1685 C SUBPROGRAM: HT
   1686 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-08-18
   1687 C
   1688 C ABSTRACT: COMPUTE VERTICAL INDEX FOR HEIGHT
   1689 C
   1690 C PROGRAM HISTORY LOG:
   1691 C 1999-08-18  W. COLLINS
   1692 C 2012-03-05  S. MELCHIOR  ADDED MISSING RETURN STATEMENT.
   1693 C       RENAMED NE TO NME FOR EASE OF NAVIGATION AND FOR
   1694 C       CLARIFICATION SINCE NE IS USED FOR INEQUALITY 
   1695 C       TESTING (.NE.).
   1696 C
   1697 C USAGE:    CALL HT(Z,IHT,IER)
   1698 C   INPUT ARGUMENT LIST:
   1699 C     Z        - HEIGHT (M)
   1700 C
   1701 C   OUTPUT ARGUMENT LIST:
   1702 C     IHT      - VERTICAL INDEX FOR HEIGHT
   1703 C     IER      = 0  ALL OK
   1704 C              = 1  BAD HEIGHT
   1705 C
   1706 C ATTRIBUTES:
   1707 C   LANGUAGE: FORTRAN 90
   1708 C   MACHINE:  NCEP WCOSS
   1709 C
   1710 C$$$
   1711       SUBROUTINE HT(Z,IHT,IER)
   1712 
   1713       PARAMETER (NLEV=35)
   1714       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
   1715       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   1716      &                CQCPC, NEV, NME
   1717 
   1718       IHT = 0
   1719       IER = 0
   1720       IZ = Z/CON + 0.49
   1721       DO L=1,NLEV
   1722         LL = L
   1723         IF(IZ.EQ.IZLEV(L)) THEN
   1724            IHT = LL
   1725            RETURN
   1726         END IF
   1727       ENDDO
   1728 
   1729       IER = 1
   1730       return
   1731 
   1732       END

Page 52          Source Listing                  HT
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name            
                  
 ht_              


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CON                        Scalar 1715     R(4)            4           scalar   COM              1720                              
 CQCPC                      Scalar 1716     R(4)            4           scalar   COM                                                
 HT                         Subr   1711                                                                                             
 HTS                        Common 1714                                 280                                                         
 IER                        Dummy  1711     I(4)            4           scalar   ARG,INOUT        1719,1729                         
 IHE                        Scalar 1715     I(4)            4           scalar   COM                                                
 IHT                        Dummy  1711     I(4)            4           scalar   ARG,INOUT        1718,1724                         
 IOUT                       Scalar 1715     I(4)            4           scalar   COM                                                
 IUNIT                      Scalar 1715     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 1715     I(4)            4           scalar   COM                                                
 IZ                         Local  1720     I(4)            4           scalar                    1720,1723                         
 IZLEV                      Scalar 1714     I(4)            4     1     35       COM              1723                              
 L                          Local  1721     I(4)            4           scalar                    1721,1722,1723                    
 LL                         Local  1722     I(4)            4           scalar                    1722,1724                         
 NEV                        Scalar 1716     I(4)            4           scalar   COM                                                
 NLEV                       Param  1713     I(4)            4           scalar                    1714,1721                         
 NME                        Scalar 1716     I(4)            4           scalar   COM                                                
 NST                        Scalar 1715     I(4)            4           scalar   COM                                                
 NUM                        Scalar 1715     I(4)            4           scalar   COM                                                
 PARAMS                     Common 1715                                 40                                                          
 Z                          Dummy  1711     R(4)            4           scalar   ARG,INOUT        1720                              
 ZLEV                       Scalar 1714     R(4)            4     1     35       COM                                                

Page 53          Source Listing                  HT
2017-04-18 11:07                                 cqcvad.f

   1733 
   1734 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1735 C
   1736 C SUBPROGRAM: INCDIST
   1737 C   PRGMMR: S. Melchior      ORG: NP22       DATE: 2016-12-18
   1738 C
   1739 C ABSTRACT: COMPUTE STATISTICS AND DISTRIBUTIONS FOR INCREMENTS
   1740 C
   1741 C PROGRAM HISTORY LOG:
   1742 C 1999-08-18  W. COLLINS
   1743 C 2012-03-05  S. MELCHIOR  EXTENDED MSK ARRAY ALLOCATION FROM 899 TO
   1744 C       1000 TO ALLOW FOR MORE STATION STATISTICS TO BE PROCESSED - ON
   1745 C       OCCASION THE 899 LIMIT HAD BEEN MET AND EXCEEDED. ADDED
   1746 C       PARAMETERS NTIMES=6, NINC=3, AND NDIV=23  TO TIDY UP THE CODE. 
   1747 C       ADDED DIAGNOSTIC OUTPUT STATEMENTS WHEN LIMITS ARE EXCEEDED.
   1748 C       RENAMED NE TO NME TO EASE NAVIGATION AND FOR CLARIFICATION AS
   1749 C       NE IS USED FOR INEQUALITY TESTING (.NE.). INCREASED NRPT FROM
   1750 C       80000 TO 160000 TO ACCOMMODATE VAD WIND REPORTS FROM LEVEL 2
   1751 C       DECODER.
   1752 C 2014-01-15  S. Melchior Added integer "icntmx" to define the max
   1753 C       value of icnt in the multi-nested do loop that hinges on the
   1754 C       number of levels (NLEV), the number of stations (NST), the
   1755 C       number of times (NTIMES), and the number of increments (NINC).
   1756 C       Increased NRPT (total number of levels amongst all VAD reports
   1757 C       that can be processed) from 160000 to 500000 to accommodate
   1758 C       VAD wind reports from Level 2 decoder.
   1759 C 2014-08-29  S. Melchior  Extended MSK, UW, and VW array allocations
   1760 C       from 1000 to 3600 (NSTN*NTIMES*NINC) to allow for a complete
   1761 C       set of station statistics to be processed.  On occasion the
   1762 C       1000 limit had been met and exceeded, losing out on station
   1763 C       statistics.
   1764 C 2014-09-04  S. Melchior  Redefined MSK, UW, and VW arrays to
   1765 C       utilize parameters NSTN, NTIMES, and NINC rather than 
   1766 C       explicitly setting the array size at 3600. "icntmx" is no 
   1767 C       longer necessary but will be retained because it may prove
   1768 C       useful for future debugging.
   1769 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   1770 C       process) from 200 to 300.
   1771 C
   1772 C USAGE:    CALL INCDIST
   1773 C
   1774 C   OUTPUT FILES:
   1775 C     UNIT 06  - STANDARD OUTPUT PRINT
   1776 C
   1777 C ATTRIBUTES:
   1778 C   LANGUAGE: FORTRAN 90
   1779 C   MACHINE:  NCEP WCOSS
   1780 C
   1781 C$$$
   1782       SUBROUTINE INCDIST
   1783 
   1784       PARAMETER (NRPT=500000,NSTN=300,NLEV=35,NDIV=23,NTIMES=6,NINC=3)
   1785 
   1786       COMMON /STN/    SLAT(NSTN), SLON(NSTN), SIDS(NSTN), STNID(NRPT),
   1787      &                ZSTN(NSTN)
   1788       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   1789      &                VIN(NLEV,NTIMES,NINC,NSTN),

Page 54          Source Listing                  INCDIST
2017-04-18 11:07                                 cqcvad.f

   1790      &                UUU(NLEV,NTIMES,NINC,NSTN),
   1791      &                VVV(NLEV,NTIMES,NINC,NSTN),
   1792      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   1793      &                NIN(NLEV,NTIMES,NSTN),
   1794      &                LLL(NLEV,NTIMES,NINC,NSTN),
   1795      &                TFC(NLEV,NTIMES,NINC,NSTN),
   1796      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   1797       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   1798      &                CQCPC, NEV, NME
   1799       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
   1800       COMMON /DATET/  IDATE(4), ITIM(6)
   1801 
   1802       CHARACTER*8 SIDS, STNID
   1803       COMMON /STATS/  UW(nstn*ntimes*ninc),VW(nstn*ntimes*ninc),
   1804      &                XM(NLEV,2),SD(NLEV,2),XLIM(2)
   1805       COMMON /DMATYP/ IQC(NLEV,NTIMES,NINC,NSTN)
   1806       REAL        UWS(60,NSTN),VWS(60,NSTN)
   1807       REAL        XMS(NLEV,2,NSTN),SDS(NLEV,2,NSTN)
   1808 
   1809       INTEGER     NMS(NDIV,NLEV,2,NSTN),NCS(NLEV,2,NSTN),ICNTS(NSTN)
   1810       INTEGER     NM(NDIV,NLEV,2),MSK(nstn*ntimes*ninc),NC(NLEV,2),
   1811      &            icntmx
   1812       LOGICAL BYSTN
   1813       BYSTN = .TRUE.
   1814       DATA XMSG /99999./
   1815       XLIM(1) = -12.
   1816       XLIM(2) =  12.
   1817       MSK = 0
   1818       icntmx = nst*ntimes*ninc
   1819       DO L=1,NLEV
   1820 
   1821 C  PUT DATA INTO WORK ARRAY
   1822 C  ------------------------
   1823 
   1824 	ICNT = 0
   1825   	UW = 0.
   1826   	VW = 0.
   1827   	ICNTS = 0
   1828         UWS = 0.
   1829         VWS = 0.
   1830         LOOP1n1: DO IS=1,NST !  nst max is nstn
   1831           DO IT=1,NTIMES ! ntimes max is 6
   1832             IF(NIN(L,IT,IS).GT.0) THEN
   1833               DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   1834                 IF(IQC(L,IT,N,IS).EQ.0) THEN
   1835                   ICNT = ICNT + 1
   1836                   UW(ICNT) = UIN(L,IT,N,IS)
   1837                   VW(ICNT) = VIN(L,IT,N,IS)
   1838                 ENDIF
   1839                 IF(BYSTN .AND. (IQC(L,IT,N,IS).EQ.0 .OR.
   1840      &            IQC(L,IT,N,IS).EQ.5)) THEN  ! Dont exclude bird winds
   1841                   ICNTS(IS) = ICNTS(IS) + 1
   1842                   if(icnts(is).gt.60) then
   1843                     print *, 'WARNING: ICNTS(IS)>60, EXIT LOOP'
   1844                     icnts(is) = icnts(is) - 1
   1845                     exit LOOP1n1
   1846                   endif

Page 55          Source Listing                  INCDIST
2017-04-18 11:07                                 cqcvad.f

   1847                   UWS(ICNTS(IS),IS) = UIN(L,IT,N,IS)
   1848                   VWS(ICNTS(IS),IS) = VIN(L,IT,N,IS)
   1849                 ENDIF
   1850               ENDDO
   1851             ENDIF
   1852           ENDDO
   1853         ENDDO LOOP1n1
   1854 
   1855 C  GET DISTRIBUTIONS
   1856 C  -----------------
   1857 
   1858 	BINI = 2.0
   1859         CALL DISTR(UW,MSK,XLIM,XMSG,ICNT,NM(1,L,1),NDIV,BINI,0,0.,
   1860      &             NC(L,1),XM(L,1),SD(L,1),SK,XK)
   1861         CALL DISTR(VW,MSK,XLIM,XMSG,ICNT,NM(1,L,2),NDIV,BINI,0,0.,
   1862      &             NC(L,2),XM(L,2),SD(L,2),SK,XK)
   1863         IF(BYSTN) THEN
   1864           DO IS=1,NST !  nst max is nstn
   1865             CALL DISTR(UWS(1,IS),MSK,XLIM,XMSG,ICNTS(IS),NMS(1,L,1,IS),
   1866      &        NDIV,BINI,0,0.,NCS(L,1,IS),XMS(L,1,IS),SDS(L,1,IS),SK,XK)
   1867             CALL DISTR(VWS(1,IS),MSK,XLIM,XMSG,ICNTS(IS),NMS(1,L,2,IS),
   1868      &        NDIV,BINI,0,0.,NCS(L,2,IS),XMS(L,2,IS),SDS(L,2,IS),SK,XK)
   1869           ENDDO
   1870         ENDIF
   1871 
   1872       ENDDO
   1873 
   1874 C  PRINT DISTRIBUTIONS
   1875 C  -------------------
   1876 
   1877       WRITE(6,500) (IDATE(I),I=1,4), BINI
   1878       WRITE(6,501)
   1879       WRITE(6,502)
   1880       WRITE(6,503) (IZLEV(L), (NM(I,L,1),I=1,NDIV), L=1,NLEV)
   1881 
   1882       WRITE(6,504)
   1883       WRITE(6,502)
   1884       WRITE(6,503) (IZLEV(L), (NM(I,L,2),I=1,NDIV), L=1,NLEV)
   1885 
   1886       WRITE(6,505)
   1887       WRITE(6,506) (IZLEV(L),NC(L,1),XM(L,1),SD(L,1),XM(L,2),
   1888      &              SD(L,2),SQRT(SD(L,1)**2+SD(L,2)**2),L=1,NLEV)
   1889 
   1890       IF(BYSTN) THEN
   1891        IDATE(1) = IDATE(1) - 1000
   1892        WRITE(55) IDATE,NST,SIDS,SLAT,SLON,ZSTN
   1893        WRITE(55) NCS,XMS,SDS,NMS,BINI,XLIM
   1894        IDATE(1) = IDATE(1) + 1000
   1895        DO IS=1,NST
   1896 c       WRITE(6,507) SIDS(IS), SLON(IS), SLAT(IS)
   1897 c       WRITE(6,501)
   1898 c       WRITE(6,502)
   1899 c       WRITE(6,503) (IZLEV(L), (NMS(I,L,1,IS),I=1,23), L=1,NLEV)
   1900 
   1901 c       WRITE(6,507) SIDS(IS), SLON(IS), SLAT(IS)
   1902 c       WRITE(6,504)
   1903 c       WRITE(6,502)

Page 56          Source Listing                  INCDIST
2017-04-18 11:07                                 cqcvad.f

   1904 c       WRITE(6,503) (IZLEV(L), (NMS(I,L,2,IS),I=1,23), L=1,NLEV)
   1905 
   1906         WRITE(6,507) SIDS(IS), SLON(IS), SLAT(IS)
   1907         WRITE(6,505)
   1908         DO L=1,NLEV
   1909          IF(NCS(L,1,IS).GT.0) WRITE(6,506) IZLEV(L),NCS(L,1,IS),
   1910      &    XMS(L,1,IS),SDS(L,1,IS),XMS(L,2,IS),SDS(L,2,IS),
   1911      &    SQRT(SDS(L,1,IS)**2+SDS(L,2,IS)**2)
   1912         ENDDO
   1913        ENDDO
   1914       ENDIF
   1915 
   1916 
   1917   500 FORMAT(/' VAD wind increment statistics for ',I4,3I2.2,
   1918      &       '   Bin increment = ',F8.2,' m/s',
   1919      &       '  (bad & bird winds excluded)')
   1920   501 FORMAT(/50X,'--------DISTRIBUTION FOR U-COMPONENT--------')
   1921   502 FORMAT(' HEIGHT(1000s ft) <-10  -10   -9   -8   -7   -6',
   1922      &  '   -5   -4   -3   -2   -1    0    1    2    3    4    5',
   1923      &  '    6    7    8    9   10  >10')
   1924   503 FORMAT(6X,I5,6X,23I5)
   1925   504 FORMAT(/50X,'--------DISTRIBUTION FOR V-COMPONENT--------')
   1926   505 FORMAT(/' HEIGHT(1000s ft)  Num      U-Mean  U-StdDev',
   1927      &       '    V-Mean  V-StdDev Mag-StdDev')
   1928   506 FORMAT(6X,I5,6X,I5,2X,5F10.1)
   1929   507 FORMAT(/'STATISTICS FOR STATION: ',A8,'  AT (',F8.2,',',F8.2,')',
   1930      &  '  (bad, but not bird winds excluded)')
   1931 
   1932       RETURN
   1933       END

Page 57          Source Listing                  INCDIST
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name                
                      
 incdist_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  1917                                                           1877                              
 501                        Label  1920                                                           1878                              
 502                        Label  1921                                                           1879,1883                         
 503                        Label  1924                                                           1880,1884                         
 504                        Label  1925                                                           1882                              
 505                        Label  1926                                                           1886,1907                         
 506                        Label  1928                                                           1887,1909                         
 507                        Label  1929                                                           1906                              
 BINI                       Local  1858     R(4)            4           scalar                    1858,1859,1861,1866,1868,1877,1893
 BYSTN                      Local  1812     L(4)            4           scalar                    1813,1839,1863,1890               
 CON                        Scalar 1797     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 1798     R(4)            4           scalar   COM                                                
 DATET                      Common 1800                                 40                                                          
 DISTR                      Subr   1859                                                           1859,1861,1865,1867               
 DMATYP                     Common 1805                                 756000                                                      
 HTS                        Common 1799                                 280                                                         
 I                          Local  1877     I(4)            4           scalar                    1877,1880,1884                    
 ICNT                       Local  1824     I(4)            4           scalar                    1824,1835,1836,1837,1859,1861     
 ICNTMX                     Local  1811     I(4)            4           scalar                    1818                              
 ICNTS                      Local  1809     I(4)            4     1     300                       1827,1841,1842,1844,1847,1848,1865
                                                                                                  ,1867                             
 IDATE                      Scalar 1800     I(4)            4     1     4        COM              1877,1891,1892,1894               
 IHE                        Scalar 1797     I(4)            4           scalar   COM                                                
 INCDIST                    Subr   1782                                                                                             
 INCS                       Common 1788                                 6300000                                                     
 IOUT                       Scalar 1797     I(4)            4           scalar   COM                                                
 IQC                        Scalar 1805     I(4)            4     4     189000   COM              1834,1839,1840                    
 IS                         Local  1830     I(4)            4           scalar                    1830,1832,1833,1834,1836,1837,1839
                                                                                                  ,1840,1841,1842,1844,1847,1848,186
                                                                                                  4,1865,1866,1867,1868,1895,1906,19
                                                                                                  09,1910,1911                      
 IT                         Local  1831     I(4)            4           scalar                    1831,1832,1833,1834,1836,1837,1839
                                                                                                  ,1840,1847,1848                   
 ITIM                       Scalar 1800     I(4)            4     1     6        COM                                                
 IUNIT                      Scalar 1797     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 1797     I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 1799     I(4)            4     1     35       COM              1880,1884,1887,1909               
 L                          Local  1819     I(4)            4           scalar                    1819,1832,1833,1834,1836,1837,1839
                                                                                                  ,1840,1847,1848,1859,1860,1861,186
                                                                                                  2,1865,1866,1867,1868,1880,1884,18
                                                                                                  87,1888,1908,1909,1910,1911       
 LLL                        Scalar 1794     I(4)            4     4     189000   COM                                                
 LOOP1N1                    Label  1830                                 scalar                    1845,1853                         
 MSK                        Local  1810     I(4)            4     1     5400                      1817,1859,1861,1865,1867          

Page 58          Source Listing                  INCDIST
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 N                          Local  1833     I(4)            4           scalar                    1833,1834,1836,1837,1839,1840,1847
                                                                                                  ,1848                             
 NC                         Local  1810     I(4)            4     2     70                        1860,1862,1887                    
 NCS                        Local  1809     I(4)            4     3     21000                     1866,1868,1893,1909               
 NDIV                       Param  1784     I(4)            4           scalar                    1809,1810,1859,1861,1866,1868,1880
                                                                                                  ,1884                             
 NEV                        Scalar 1798     I(4)            4           scalar   COM                                                
 NIN                        Scalar 1793     I(4)            4     3     63000    COM              1832,1833                         
 NINC                       Param  1784     I(4)            4           scalar                    1788,1789,1790,1791,1792,1794,1795
                                                                                                  ,1796,1803,1805,1810,1818         
 NLEV                       Param  1784     I(4)            4           scalar                    1788,1789,1790,1791,1792,1793,1794
                                                                                                  ,1795,1796,1799,1804,1805,1807,180
                                                                                                  9,1810,1819,1880,1884,1888,1908   
 NM                         Local  1810     I(4)            4     3     1610                      1859,1861,1880,1884               
 NME                        Scalar 1798     I(4)            4           scalar   COM                                                
 NMS                        Local  1809     I(4)            4     4     483000                    1865,1867,1893                    
 NRPT                       Param  1784     I(4)            4           scalar                    1786                              
 NST                        Scalar 1797     I(4)            4           scalar   COM              1818,1830,1864,1892,1895          
 NSTN                       Param  1784     I(4)            4           scalar                    1786,1787,1788,1789,1790,1791,1792
                                                                                                  ,1793,1794,1795,1796,1803,1805,180
                                                                                                  6,1807,1809,1810                  
 NTIMES                     Param  1784     I(4)            4           scalar                    1788,1789,1790,1791,1792,1793,1794
                                                                                                  ,1795,1796,1803,1805,1810,1818,183
                                                                                                  1                                 
 NUM                        Scalar 1797     I(4)            4           scalar   COM                                                
 PARAMS                     Common 1797                                 40                                                          
 QQQ                        Scalar 1796     R(4)            4     4     189000   COM                                                
 SD                         Scalar 1804     R(4)            4     2     70       COM              1860,1862,1887,1888               
 SDS                        Local  1807     R(4)            4     3     21000                     1866,1868,1893,1910,1911          
 SIDS                       Scalar 1786     CHAR            8     1     300      COM              1892,1906                         
 SK                         Local  1860     R(4)            4           scalar                    1860,1862,1866,1868               
 SLAT                       Scalar 1786     R(4)            4     1     300      COM              1892,1906                         
 SLON                       Scalar 1786     R(4)            4     1     300      COM              1892,1906                         
 SQRT                       Func   1888                                 scalar                    1888,1911                         
 STATS                      Common 1803                                 43768                                                       
 STN                        Common 1786                                 4006000                                                     
 STNID                      Scalar 1786     CHAR            8     1     500000   COM                                                
 TFC                        Scalar 1795     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 1792     R(4)            4     4     189000   COM                                                
 UIN                        Scalar 1788     R(4)            4     4     189000   COM              1836,1847                         
 UUU                        Scalar 1790     R(4)            4     4     189000   COM                                                
 UW                         Scalar 1803     R(4)            4     1     5400     COM              1825,1836,1859                    
 UWS                        Local  1806     R(4)            4     2     18000                     1828,1847,1865                    
 VIN                        Scalar 1789     R(4)            4     4     189000   COM              1837,1848                         
 VVV                        Scalar 1791     R(4)            4     4     189000   COM                                                
 VW                         Scalar 1803     R(4)            4     1     5400     COM              1826,1837,1861                    
 VWS                        Local  1806     R(4)            4     2     18000                     1829,1848,1867                    
 XK                         Local  1860     R(4)            4           scalar                    1860,1862,1866,1868               
 XLIM                       Scalar 1804     R(4)            4     1     2        COM              1815,1816,1859,1861,1865,1867,1893
 XM                         Scalar 1804     R(4)            4     2     70       COM              1860,1862,1887                    
 XMS                        Local  1807     R(4)            4     3     21000                     1866,1868,1893,1910               
 XMSG                       Local  1814     R(4)            4           scalar                    1814,1859,1861,1865,1867          
 ZLEV                       Scalar 1799     R(4)            4     1     35       COM                                                
 ZSTN                       Scalar 1787     R(4)            4     1     300      COM              1892                              

Page 59          Source Listing                  INCDIST
2017-04-18 11:07                                 cqcvad.f

   1934 
   1935 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   1936 C
   1937 C SUBPROGRAM: INCR
   1938 C   PRGMMR: S. Melchior      ORG: NP22       DATE: 2016-12-18
   1939 C
   1940 C ABSTRACT: Compute increments (observation - guess)
   1941 C
   1942 C PROGRAM HISTORY LOG:
   1943 C 1999-08-18  W. COLLINS
   1944 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO TIDY
   1945 C       UP THE CODE. RENAMED NE TO NME TO EASE NAVIGATION AND FOR
   1946 C       CLARIFICATION AS NE IS USED FOR INEQUALITY TESTING (.NE.).
   1947 C       INCREASED NRPT FROM 80000 TO 160000 TO ACCOMMODATE VAD WIND
   1948 C       REPORTS FROM LEVEL 2 DECODER.
   1949 C 2014-01-15  S. Melchior  Increased NRPT (total number of levels
   1950 C       amongst all VAD reports that can be processed) from 160000 to
   1951 C       500000 to accommodate VAD wind reports from Level 2 decoder.
   1952 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   1953 C       process) from 200 to 300.
   1954 C
   1955 C USAGE:    CALL INCR
   1956 C
   1957 C ATTRIBUTES:
   1958 C   LANGUAGE: FORTRAN 90
   1959 C   MACHINE:  NCEP WCOSS
   1960 C
   1961 C$$$
   1962       SUBROUTINE INCR
   1963 
   1964       PARAMETER (NRPT=500000,NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   1965 
   1966       REAL(8)  BMISS
   1967 
   1968       COMMON /DATET/  IDATE(4), ITIM(6)
   1969       COMMON /STN/    SLAT(NSTN), SLON(NSTN), SIDS(NSTN), STNID(NRPT),
   1970      &                ZSTN(NSTN)
   1971       COMMON /SINGLE/ ZOB(NRPT), ITM(NRPT),TIM(NRPT),
   1972      &                UOB(NRPT), VOB(NRPT), LOB(NRPT),
   1973      &                XLA(NRPT), XLO(NRPT), ZST(NRPT),
   1974      &                UFF(NRPT), VFF(NRPT), TFF(NRPT),
   1975      &                WQM(NRPT)
   1976       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   1977      &                VIN(NLEV,NTIMES,NINC,NSTN),
   1978      &                UUU(NLEV,NTIMES,NINC,NSTN),
   1979      &                VVV(NLEV,NTIMES,NINC,NSTN),
   1980      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   1981      &                NIN(NLEV,NTIMES,NSTN),
   1982      &                LLL(NLEV,NTIMES,NINC,NSTN),
   1983      &                TFC(NLEV,NTIMES,NINC,NSTN),
   1984      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   1985       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   1986      &                CQCPC, NEV, NME
   1987       COMMON /BUFRLIB_MISSING/BMISS
   1988       COMMON /FLAG/ guess
   1989       LOGICAL     guess, FIRST
   1990       CHARACTER*8 SIDS, STNID

Page 60          Source Listing                  INCR
2017-04-18 11:07                                 cqcvad.f

   1991       DATA   FIRST /.TRUE./
   1992 
   1993 C  CALCULATE THE INCREMENT (OBSERVATION - GUESS)
   1994 C  ---------------------------------------------
   1995 
   1996       DO I=1,NUM !  num max is nrpt
   1997         DO J=1,NST ! nst max is nstn
   1998           IF(STNID(I).EQ.SIDS(J)) THEN
   1999             CALL HT(ZOB(I),IHT,IER)
   2000             IF(IER.EQ.0 .AND. IHT.GT.0 .AND. IHT.LE.NLEV) THEN
   2001               IT = 0
   2002               LOOP1n2: DO II=1,6
   2003                 IF(ITIM(II).EQ.ITM(I)) THEN
   2004 	          IT = II
   2005                   EXIT LOOP1n2
   2006                   ENDIF
   2007               ENDDO  LOOP1n2
   2008               IF(IT.GE.1 .AND. IT.LE.6) THEN
   2009 
   2010 C  THE USE OF N HERE WILL CAPTURE THE FIRST TWO AND LAST
   2011 C  INCREMENTS FOR EACH HOUR
   2012 C  -----------------------------------------------------
   2013 
   2014                 N = NIN(IHT,IT,J)
   2015                 IF(N.LT.3) THEN
   2016                   N = N+1
   2017                   NIN(IHT,IT,J) = N
   2018                 ENDIF
   2019                 IF(MAX(UFF(I),VFF(I)).LT.BMISS) THEN
   2020                   UIN(IHT,IT,N,J)   = UOB(I) - UFF(I)
   2021                   VIN(IHT,IT,N,J)   = VOB(I) - VFF(I)
   2022                 ELSE
   2023                   IF(FIRST) THEN
   2024 C  Since guess is missing, mark all data as bad
   2025                      guess = .FALSE.
   2026                      WRITE(6,500)
   2027                      WRITE(6,500)
   2028                      WRITE(6,500)
   2029   500                FORMAT(' *****GUESS IS MISSING; ALL DATA ARE',
   2030      &                      ' FLAGGED*****')
   2031                      FIRST = .FALSE.
   2032                   ENDIF
   2033                 ENDIF
   2034                 LLL(IHT,IT,N,J)   = LOB(I)
   2035                 UUU(IHT,IT,N,J)   = UOB(I)
   2036                 VVV(IHT,IT,N,J)   = VOB(I)
   2037                 QQQ(IHT,IT,N,J)   = WQM(I)
   2038                 TFC(IHT,IT,N,J)   = TFF(I)
   2039                 TIMIN(IHT,IT,N,J) = TIM(I)
   2040               ENDIF
   2041             ELSE
   2042               PRINT *,' UNUSUAL HT: ',ZOB(I)
   2043             ENDIF
   2044           ENDIF
   2045         ENDDO
   2046       ENDDO
   2047 

Page 61          Source Listing                  INCR
2017-04-18 11:07                                 cqcvad.f

   2048       RETURN
   2049       END


ENTRY POINTS

  Name             
                   
 incr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  2029                                                           2026,2027,2028                    
 BMISS                      Scalar 1966     R(8)            8           scalar   COM              2019                              
 BUFRLIB_MISSING            Common 1987                                 8                                                           
 CON                        Scalar 1985     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 1986     R(4)            4           scalar   COM                                                
 DATET                      Common 1968                                 40                                                          
 FIRST                      Local  1989     L(4)            4           scalar                    1991,2023,2031                    
 FLAG                       Common 1988                                 4                                                           
 GUESS                      Scalar 1988     L(4)            4           scalar   COM              2025                              
 HT                         Subr   1999                                                           1999                              
 I                          Local  1996     I(4)            4           scalar                    1996,1998,1999,2003,2019,2020,2021
                                                                                                  ,2034,2035,2036,2037,2038,2039,204
                                                                                                  2                                 
 IDATE                      Scalar 1968     I(4)            4     1     4        COM                                                
 IER                        Local  1999     I(4)            4           scalar                    1999,2000                         
 IHE                        Scalar 1985     I(4)            4           scalar   COM                                                
 IHT                        Local  1999     I(4)            4           scalar                    1999,2000,2014,2017,2020,2021,2034
                                                                                                  ,2035,2036,2037,2038,2039         
 II                         Local  2002     I(4)            4           scalar                    2002,2003,2004                    
 INCR                       Subr   1962                                                                                             
 INCS                       Common 1976                                 6300000                                                     
 IOUT                       Scalar 1985     I(4)            4           scalar   COM                                                
 IT                         Local  2001     I(4)            4           scalar                    2001,2004,2008,2014,2017,2020,2021
                                                                                                  ,2034,2035,2036,2037,2038,2039    
 ITIM                       Scalar 1968     I(4)            4     1     6        COM              2003                              
 ITM                        Scalar 1971     I(4)            4     1     500000   COM              2003                              
 IUNIT                      Scalar 1985     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 1985     I(4)            4           scalar   COM                                                
 J                          Local  1997     I(4)            4           scalar                    1997,1998,2014,2017,2020,2021,2034
                                                                                                  ,2035,2036,2037,2038,2039         
 LLL                        Scalar 1982     I(4)            4     4     189000   COM              2034                              
 LOB                        Scalar 1972     I(4)            4     1     500000   COM              2034                              
 LOOP1N2                    Label  2002                                 scalar                    2005,2007                         
 MAX                        Func   2019                                 scalar                    2019                              
 N                          Local  2014     I(4)            4           scalar                    2014,2015,2016,2017,2020,2021,2034
                                                                                                  ,2035,2036,2037,2038,2039         
 NEV                        Scalar 1986     I(4)            4           scalar   COM                                                
 NIN                        Scalar 1981     I(4)            4     3     63000    COM              2014,2017                         
 NINC                       Param  1964     I(4)            4           scalar                    1976,1977,1978,1979,1980,1982,1983
                                                                                                  ,1984                             
 NLEV                       Param  1964     I(4)            4           scalar                    1976,1977,1978,1979,1980,1981,1982
                                                                                                  ,1983,1984,2000                   

Page 62          Source Listing                  INCR
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NME                        Scalar 1986     I(4)            4           scalar   COM                                                
 NRPT                       Param  1964     I(4)            4           scalar                    1969,1971,1972,1973,1974,1975     
 NST                        Scalar 1985     I(4)            4           scalar   COM              1997                              
 NSTN                       Param  1964     I(4)            4           scalar                    1969,1970,1976,1977,1978,1979,1980
                                                                                                  ,1981,1982,1983,1984              
 NTIMES                     Param  1964     I(4)            4           scalar                    1976,1977,1978,1979,1980,1981,1982
                                                                                                  ,1983,1984                        
 NUM                        Scalar 1985     I(4)            4           scalar   COM              1996                              
 PARAMS                     Common 1985                                 40                                                          
 QQQ                        Scalar 1984     R(4)            4     4     189000   COM              2037                              
 SIDS                       Scalar 1969     CHAR            8     1     300      COM              1998                              
 SINGLE                     Common 1971                                 26000000                                                    
 SLAT                       Scalar 1969     R(4)            4     1     300      COM                                                
 SLON                       Scalar 1969     R(4)            4     1     300      COM                                                
 STN                        Common 1969                                 4006000                                                     
 STNID                      Scalar 1969     CHAR            8     1     500000   COM              1998                              
 TFC                        Scalar 1983     R(4)            4     4     189000   COM              2038                              
 TFF                        Scalar 1974     R(4)            4     1     500000   COM              2038                              
 TIM                        Scalar 1971     R(4)            4     1     500000   COM              2039                              
 TIMIN                      Scalar 1980     R(4)            4     4     189000   COM              2039                              
 UFF                        Scalar 1974     R(4)            4     1     500000   COM              2019,2020                         
 UIN                        Scalar 1976     R(4)            4     4     189000   COM              2020                              
 UOB                        Scalar 1972     R(4)            4     1     500000   COM              2020,2035                         
 UUU                        Scalar 1978     R(4)            4     4     189000   COM              2035                              
 VFF                        Scalar 1974     R(4)            4     1     500000   COM              2019,2021                         
 VIN                        Scalar 1977     R(4)            4     4     189000   COM              2021                              
 VOB                        Scalar 1972     R(4)            4     1     500000   COM              2021,2036                         
 VVV                        Scalar 1979     R(4)            4     4     189000   COM              2036                              
 WQM                        Scalar 1975     R(4)            4     1     500000   COM              2037                              
 XLA                        Scalar 1973     R(4)            4     1     500000   COM                                                
 XLO                        Scalar 1973     R(4)            4     1     500000   COM                                                
 ZOB                        Scalar 1971     R(4)            4     1     500000   COM              1999,2042                         
 ZST                        Scalar 1973     R(4)            4     1     500000   COM                                                
 ZSTN                       Scalar 1970     R(4)            4     1     300      COM                                                

Page 63          Source Listing                  INCR
2017-04-18 11:07                                 cqcvad.f

   2050 
   2051 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2052 C
   2053 C SUBPROGRAM: INDEXX
   2054 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-08-18
   2055 C
   2056 C ABSTRACT: Indexes an array arr(1:n), i.e., outputs the array
   2057 C   indx(1:n) such that arr(indx(j)) is in ascending order for
   2058 C   j=1,2,...,N.  The input quantities n and arr are not changed.
   2059 C
   2060 C PROGRAM HISTORY LOG:
   2061 C 1999-08-18  W. COLLINS
   2062 C
   2063 C USAGE:    CALL indexx(n,arr,indx)
   2064 C   INPUT ARGUMENT LIST:
   2065 C     arr      - input array
   2066 C     n        - array size
   2067 C
   2068 C   OUTPUT ARGUMENT LIST:
   2069 C     indx     - index array for ascending order of arr
   2070 C
   2071 C ATTRIBUTES:
   2072 C   LANGUAGE: FORTRAN 90
   2073 C   MACHINE:  NCEP WCOSS
   2074 C
   2075 C$$$
   2076       SUBROUTINE indexx(n,arr,indx)
   2077 
   2078       INTEGER n,indx(n),M,NSTACK
   2079       REAL arr(n)
   2080       PARAMETER (M=7,NSTACK=50)
   2081       INTEGER i,indxt,ir,itemp,j,jstack,k,l,istack(NSTACK)
   2082       REAL a
   2083 
   2084 C     Indexes an array arr(1:n), i.e., outputs the array indx(1:n) such
   2085 C     that arr(indx(j)) is in ascending order for j=1,2,...,N.  The
   2086 C     input quantities n and arr are not changed.
   2087 
   2088       do j=1,n
   2089         indx(j)=j
   2090       enddo
   2091       jstack=0
   2092       l=1
   2093       ir=n
   2094 1     continue
   2095       if(ir-l.lt.M)then
   2096         do j=l+1,ir
   2097           indxt=indx(j)
   2098           a=arr(indxt)
   2099           do i=j-1,1,-1
   2100             if(arr(indx(i)).le.a)goto 2
   2101             indx(i+1)=indx(i)
   2102           enddo
   2103           i=0
   2104 2         continue
   2105           indx(i+1)=indxt
   2106         enddo

Page 64          Source Listing                  INDEXX
2017-04-18 11:07                                 cqcvad.f

   2107         if(jstack.eq.0)return
   2108         ir=istack(jstack)
   2109         l=istack(jstack-1)
   2110         jstack=jstack-2
   2111       else
   2112         k=(l+ir)/2
   2113         itemp=indx(k)
   2114         indx(k)=indx(l+1)
   2115         indx(l+1)=itemp
   2116         if(arr(indx(l+1)).gt.arr(indx(ir)))then
   2117           itemp=indx(l+1)
   2118           indx(l+1)=indx(ir)
   2119           indx(ir)=itemp
   2120         endif
   2121         if(arr(indx(l)).gt.arr(indx(ir)))then
   2122           itemp=indx(l)
   2123           indx(l)=indx(ir)
   2124           indx(ir)=itemp
   2125         endif
   2126         if(arr(indx(l+1)).gt.arr(indx(l)))then
   2127           itemp=indx(l+1)
   2128           indx(l+1)=indx(l)
   2129           indx(l)=itemp
   2130         endif
   2131         i=l+1
   2132         j=ir
   2133         indxt=indx(l)
   2134         a=arr(indxt)
   2135 3       continue
   2136           i=i+1
   2137         if(arr(indx(i)).lt.a)goto 3
   2138 4       continue
   2139           j=j-1
   2140         if(arr(indx(j)).gt.a)goto 4
   2141         if(j.lt.i)goto 5
   2142         itemp=indx(i)
   2143         indx(i)=indx(j)
   2144         indx(j)=itemp
   2145         goto 3
   2146 5       continue
   2147         indx(l)=indx(j)
   2148         indx(j)=indxt
   2149         jstack=jstack+2
   2150         if(jstack.gt.NSTACK)pause 'NSTACK too small in indexx'
   2151         if(ir-i+1.ge.j-l)then
   2152           istack(jstack)=ir
   2153           istack(jstack-1)=i
   2154           ir=j-1
   2155         else
   2156           istack(jstack)=j-1
   2157           istack(jstack-1)=l
   2158           l=i
   2159         endif
   2160       endif
   2161       goto 1
   2162       END

Page 65          Source Listing                  INDEXX
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name               
                     
 indexx_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 1                          Label  2094                                                           2161                              
 2                          Label  2104                                                           2100                              
 3                          Label  2135                                                           2137,2145                         
 4                          Label  2138                                                           2140                              
 5                          Label  2146                                                           2141                              
 A                          Local  2082     R(4)            4           scalar                    2098,2100,2134,2137,2140          
 ARR                        Dummy  2076     R(4)            4     1     0        ARG,INOUT        2098,2100,2116,2121,2126,2134,2137
                                                                                                  ,2140                             
 I                          Local  2081     I(4)            4           scalar                    2099,2100,2101,2103,2105,2131,2136
                                                                                                  ,2137,2141,2142,2143,2151,2153,215
                                                                                                  8                                 
 INDEXX                     Subr   2076                                                                                             
 INDX                       Dummy  2076     I(4)            4     1     0        ARG,INOUT        2089,2097,2100,2101,2105,2113,2114
                                                                                                  ,2115,2116,2117,2118,2119,2121,212
                                                                                                  2,2123,2124,2126,2127,2128,2129,21
                                                                                                  33,2137,2140,2142,2143,2144,2147,2
                                                                                                  148                               
 INDXT                      Local  2081     I(4)            4           scalar                    2097,2098,2105,2133,2134,2148     
 IR                         Local  2081     I(4)            4           scalar                    2093,2095,2096,2108,2112,2116,2118
                                                                                                  ,2119,2121,2123,2124,2132,2151,215
                                                                                                  2,2154                            
 ISTACK                     Local  2081     I(4)            4     1     50                        2108,2109,2152,2153,2156,2157     
 ITEMP                      Local  2081     I(4)            4           scalar                    2113,2115,2117,2119,2122,2124,2127
                                                                                                  ,2129,2142,2144                   
 J                          Local  2081     I(4)            4           scalar                    2088,2089,2096,2097,2099,2132,2139
                                                                                                  ,2140,2141,2143,2144,2147,2148,215
                                                                                                  1,2154,2156                       
 JSTACK                     Local  2081     I(4)            4           scalar                    2091,2107,2108,2109,2110,2149,2150
                                                                                                  ,2152,2153,2156,2157              
 K                          Local  2081     I(4)            4           scalar                    2112,2113,2114                    
 L                          Local  2081     I(4)            4           scalar                    2092,2095,2096,2109,2112,2114,2115
                                                                                                  ,2116,2117,2118,2121,2122,2123,212
                                                                                                  6,2127,2128,2129,2131,2133,2147,21
                                                                                                  51,2157,2158                      
 M                          Param  2078     I(4)            4           scalar                    2095                              
 N                          Dummy  2076     I(4)            4           scalar   ARG,INOUT        2078,2079,2088,2093               
 NSTACK                     Param  2078     I(4)            4           scalar                    2081,2150                         

Page 66          Source Listing                  INDEXX
2017-04-18 11:07                                 cqcvad.f

   2163 
   2164 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2165 C
   2166 C SUBPROGRAM: INIT
   2167 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   2168 C
   2169 C ABSTRACT: Initialize some quantities.
   2170 C
   2171 C PROGRAM HISTORY LOG:
   2172 C 1999-08-18  W. COLLINS
   2173 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO
   2174 C       TIDY UP THE CODE. RENAMED NE TO NME FOR EASE OF 
   2175 C       NAVIGATION AND FOR CLARIFICATION AS NE IS USED FOR 
   2176 C       INEQUALITY TESTING (.NE.).
   2177 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2178 C       process) from 200 to 300.
   2179 C
   2180 C USAGE:    CALL INIT
   2181 C
   2182 C ATTRIBUTES:
   2183 C   LANGUAGE: FORTRAN 90
   2184 C   MACHINE:  NCEP WCOSS
   2185 C
   2186 C$$$
   2187       SUBROUTINE INIT
   2188 
   2189       PARAMETER(NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   2190 
   2191       REAL(8)   BMISS
   2192 
   2193       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   2194      &                CQCPC, NEV, NME
   2195       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   2196      &                VIN(NLEV,NTIMES,NINC,NSTN),
   2197      &                UUU(NLEV,NTIMES,NINC,NSTN),
   2198      &                VVV(NLEV,NTIMES,NINC,NSTN),
   2199      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   2200      &                NIN(NLEV,NTIMES,NSTN),
   2201      &                LLL(NLEV,NTIMES,NINC,NSTN),
   2202      &                TFC(NLEV,NTIMES,NINC,NSTN),
   2203      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   2204       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
   2205       COMMON /BUFRLIB_MISSING/BMISS
   2206 
   2207       ZLEV(:) = CON * IZLEV(:)
   2208 
   2209       UIN =   BMISS
   2210       VIN =   BMISS
   2211       TIMIN = BMISS
   2212       NIN   = 0
   2213 
   2214       RETURN
   2215       END

Page 67          Source Listing                  INIT
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name             
                   
 init_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BMISS                      Scalar 2191     R(8)            8           scalar   COM              2209,2210,2211                    
 BUFRLIB_MISSING            Common 2205                                 8                                                           
 CON                        Scalar 2193     R(4)            4           scalar   COM              2207                              
 CQCPC                      Scalar 2194     R(4)            4           scalar   COM                                                
 HTS                        Common 2204                                 280                                                         
 IHE                        Scalar 2193     I(4)            4           scalar   COM                                                
 INCS                       Common 2195                                 6300000                                                     
 INIT                       Subr   2187                                                                                             
 IOUT                       Scalar 2193     I(4)            4           scalar   COM                                                
 IUNIT                      Scalar 2193     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 2193     I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 2204     I(4)            4     1     35       COM              2207                              
 LLL                        Scalar 2201     I(4)            4     4     189000   COM                                                
 NEV                        Scalar 2194     I(4)            4           scalar   COM                                                
 NIN                        Scalar 2200     I(4)            4     3     63000    COM              2212                              
 NINC                       Param  2189     I(4)            4           scalar                    2195,2196,2197,2198,2199,2201,2202
                                                                                                  ,2203                             
 NLEV                       Param  2189     I(4)            4           scalar                    2195,2196,2197,2198,2199,2200,2201
                                                                                                  ,2202,2203,2204                   
 NME                        Scalar 2194     I(4)            4           scalar   COM                                                
 NST                        Scalar 2193     I(4)            4           scalar   COM                                                
 NSTN                       Param  2189     I(4)            4           scalar                    2195,2196,2197,2198,2199,2200,2201
                                                                                                  ,2202,2203                        
 NTIMES                     Param  2189     I(4)            4           scalar                    2195,2196,2197,2198,2199,2200,2201
                                                                                                  ,2202,2203                        
 NUM                        Scalar 2193     I(4)            4           scalar   COM                                                
 PARAMS                     Common 2193                                 40                                                          
 QQQ                        Scalar 2203     R(4)            4     4     189000   COM                                                
 TFC                        Scalar 2202     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 2199     R(4)            4     4     189000   COM              2211                              
 UIN                        Scalar 2195     R(4)            4     4     189000   COM              2209                              
 UUU                        Scalar 2197     R(4)            4     4     189000   COM                                                
 VIN                        Scalar 2196     R(4)            4     4     189000   COM              2210                              
 VVV                        Scalar 2198     R(4)            4     4     189000   COM                                                
 ZLEV                       Scalar 2204     R(4)            4     1     35       COM              2207                              

Page 68          Source Listing                  INIT
2017-04-18 11:07                                 cqcvad.f

   2216 
   2217 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2218 C
   2219 C SUBPROGRAM: MATR
   2220 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   2221 C
   2222 C ABSTRACT: SET UP THE MATRICES FOR THE HEIGHT-TIME OI ANALYSIS
   2223 C   THE ANALYSIS EQUATION IS AW=C
   2224 C
   2225 C PROGRAM HISTORY LOG:
   2226 C 1999-08-18  W. COLLINS
   2227 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO
   2228 C       TIDY UP THE CODE. RENAMED NE TO NME FOR EASE OF 
   2229 C       NAVIGATION AND ALSO FOR CLARIFICATION AS NE IS USED FOR
   2230 C       INEQUALITY TESTING (.NE.).
   2231 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2232 C       process) from 200 to 300.
   2233 C
   2234 C USAGE:    CALL MATR(IS,IT)
   2235 C   INPUT ARGUMENT LIST:
   2236 C     IS       - STATION INDEX
   2237 C     IT       - TIME INDEX
   2238 C
   2239 C ATTRIBUTES:
   2240 C   LANGUAGE: FORTRAN 90
   2241 C   MACHINE:  NCEP WCOSS
   2242 C
   2243 C$$$
   2244       SUBROUTINE MATR(IS,IT)
   2245 
   2246       PARAMETER(NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   2247       COMMON /MATRIC/ A(NSTN,45), C(NSTN,9), NMAT(NSTN), NM
   2248       COMMON /COLECT/ LS(NSTN,NLEV,NINC), JS(NSTN,NLEV,NINC),
   2249      $                NS(NSTN,NLEV,NINC), NC(NLEV,NINC),
   2250      &                DS(NSTN,NLEV,NINC),
   2251      &                LTSCOL(9,NLEV,NTIMES,NINC,NSTN)
   2252       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   2253      &                VIN(NLEV,NTIMES,NINC,NSTN),
   2254      &                UUU(NLEV,NTIMES,NINC,NSTN),
   2255      &                VVV(NLEV,NTIMES,NINC,NSTN),
   2256      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   2257      &                NIN(NLEV,NTIMES,NSTN),
   2258      &                LLL(NLEV,NTIMES,NINC,NSTN),
   2259      &                TFC(NLEV,NTIMES,NINC,NSTN),
   2260      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   2261       COMMON /HTS/  IZLEV(NLEV), ZLEV(NLEV)
   2262       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   2263      &                CQCPC, NEV, NME
   2264       COMMON /CONSTS/ MAT,E,AA,B,XL,R
   2265       DATA IFIRST /0/
   2266 
   2267 C  SET UP THE MATRICES FOR THE HEIGHT-TIME OI ANALYSIS
   2268 C  THE ANALYSIS EQUATION IS AW=C
   2269 C  ---------------------------------------------------
   2270 
   2271       DIS(T1,T2,Z1,Z2) = SQRT((T2-T1)**2 + (R*(Z2-Z1))**2)
   2272       COV(X) = AA + B*(1.+X/XL)*EXP(-X/XL)

Page 69          Source Listing                  MATR
2017-04-18 11:07                                 cqcvad.f

   2273       IX(I,J) = I*(I-1)/2 + J
   2274 
   2275       IF(IFIRST.EQ.0) THEN
   2276         WRITE(6,509) MAT,E,AA,B,XL,R
   2277   509   FORMAT(/,I3,' POINTS USED IN INTERPOLATION',/,
   2278      &       ' NOISE-TO-SIGNAL RATIO ASSUMED TO BE:',F8.2,/,
   2279      &       ' COV(X) = A+B*(1.+X/XL)*EXP(-X/XL) WITH A = ',
   2280      &       F8.2,'  B = ',F8.2,' AND XL = ',F8.2,/,
   2281      &       ' DIS(T1,T2,Z1,Z2) = SQRT((T2-T1)**2 + (R*(Z2-Z1))**2)',
   2282      &       ' WITH R = ',F8.2/)
   2283         IFIRST = 1
   2284       ENDIF
   2285 
   2286       NM   = 0
   2287       A    = 0.
   2288       C    = 0.
   2289       NMAT = 0
   2290       DO L=1,NLEV
   2291         IF(NIN(L,IT,IS).NE.0) THEN
   2292           DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   2293             NM = NM + 1
   2294             MT = MIN(MAT,NC(L,N))
   2295             NMAT(NM) = MT
   2296 
   2297 C  MATRIX A DIAGONALS, USING TRIANGULAR FORM OF STORAGE
   2298 C  ----------------------------------------------------
   2299 
   2300             DO I=1,MT
   2301               A(NM,IX(I,I)) = 1. + E
   2302             ENDDO
   2303 
   2304 C  REST OF MATRIX A
   2305 C  ----------------
   2306 
   2307             DO J=1,MT
   2308               DO I=1,MT
   2309                 IF(I.GT.J) THEN
   2310                   LI = LS(I,L,N)
   2311                   NI = NS(I,L,N)
   2312                   II = JS(I,L,N)
   2313                   LJ = LS(J,L,N)
   2314                   NJ = NS(J,L,N)
   2315                   IJ = JS(J,L,N)
   2316                   ZI = IZLEV(LI)
   2317                   ZJ = IZLEV(LJ)
   2318                   D  = DIS(TIMIN(LI,II,NI,IS),TIMIN(LJ,IJ,NJ,IS),
   2319      &                     ZI,ZJ)
   2320                   A(NM,IX(I,J)) = COV(D)
   2321                   IF(NM.LE.2) THEN
   2322                   ENDIF
   2323                 ENDIF
   2324               ENDDO
   2325             ENDDO
   2326 
   2327 C  RIGHT-HAND-SIDE, MATRIX C
   2328 C  -------------------------
   2329 

Page 70          Source Listing                  MATR
2017-04-18 11:07                                 cqcvad.f

   2330             DO I=1,MT
   2331               C(NM,I) = COV(DS(I,L,N))
   2332             ENDDO
   2333           ENDDO
   2334         ENDIF
   2335       ENDDO
   2336 
   2337       RETURN
   2338       END


ENTRY POINTS

  Name             
                   
 matr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 509                        Label  2277                                                           2276                              
 A                          Scalar 2247     R(4)            4     2     13500    COM              2287,2301,2320                    
 AA                         Scalar 2264     R(4)            4           scalar   COM              2272,2276                         
 B                          Scalar 2264     R(4)            4           scalar   COM              2272,2276                         
 C                          Scalar 2247     R(4)            4     2     2700     COM              2288,2331                         
 COLECT                     Common 2248                                 7308420                                                     
 CON                        Scalar 2262     R(4)            4           scalar   COM                                                
 CONSTS                     Common 2264                                 24                                                          
 COV                        Local  2272     R(4)            4           scalar                    2320,2331                         
 CQCPC                      Scalar 2263     R(4)            4           scalar   COM                                                
 D                          Local  2318     R(4)            4           scalar                    2318,2320                         
 DIS                        Local  2271     R(4)            4           scalar                    2318                              
 DS                         Scalar 2250     R(4)            4     3     31500    COM              2331                              
 E                          Scalar 2264     R(4)            4           scalar   COM              2276,2301                         
 EXP                        Func   2272                                 scalar                    2272                              
 HTS                        Common 2261                                 280                                                         
 I                          Local  2300     I(4)            4           scalar                    2300,2301,2308,2309,2310,2311,2312
                                                                                                  ,2320,2330,2331                   
 IFIRST                     Local  2265     I(4)            4           scalar                    2265,2275,2283                    
 IHE                        Scalar 2262     I(4)            4           scalar   COM                                                
 II                         Local  2312     I(4)            4           scalar                    2312,2318                         
 IJ                         Local  2315     I(4)            4           scalar                    2315,2318                         
 INCS                       Common 2252                                 6300000                                                     
 IOUT                       Scalar 2262     I(4)            4           scalar   COM                                                
 IS                         Dummy  2244     I(4)            4           scalar   ARG,INOUT        2291,2292,2318                    
 IT                         Dummy  2244     I(4)            4           scalar   ARG,INOUT        2291,2292                         
 IUNIT                      Scalar 2262     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 2262     I(4)            4           scalar   COM                                                
 IX                         Local  2273     I(4)            4           scalar                    2301,2320                         
 IZLEV                      Scalar 2261     I(4)            4     1     35       COM              2316,2317                         
 J                          Local  2307     I(4)            4           scalar                    2307,2309,2313,2314,2315,2320     
 JS                         Scalar 2248     I(4)            4     3     31500    COM              2312,2315                         
 L                          Local  2290     I(4)            4           scalar                    2290,2291,2292,2294,2310,2311,2312
                                                                                                  ,2313,2314,2315,2331              
 LI                         Local  2310     I(4)            4           scalar                    2310,2316,2318                    

Page 71          Source Listing                  MATR
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LJ                         Local  2313     I(4)            4           scalar                    2313,2317,2318                    
 LLL                        Scalar 2258     I(4)            4     4     189000   COM                                                
 LS                         Scalar 2248     I(4)            4     3     31500    COM              2310,2313                         
 LTSCOL                     Scalar 2251     I(4)            4     5     1701000  COM                                                
 MAT                        Scalar 2264     I(4)            4           scalar   COM              2276,2294                         
 MATR                       Subr   2244                                                                                             
 MATRIC                     Common 2247                                 66004                                                       
 MIN                        Func   2294                                 scalar                    2294                              
 MT                         Local  2294     I(4)            4           scalar                    2294,2295,2300,2307,2308,2330     
 N                          Local  2292     I(4)            4           scalar                    2292,2294,2310,2311,2312,2313,2314
                                                                                                  ,2315,2331                        
 NC                         Scalar 2249     I(4)            4     2     105      COM              2294                              
 NEV                        Scalar 2263     I(4)            4           scalar   COM                                                
 NI                         Local  2311     I(4)            4           scalar                    2311,2318                         
 NIN                        Scalar 2257     I(4)            4     3     63000    COM              2291,2292                         
 NINC                       Param  2246     I(4)            4           scalar                    2248,2249,2250,2251,2252,2253,2254
                                                                                                  ,2255,2256,2258,2259,2260         
 NJ                         Local  2314     I(4)            4           scalar                    2314,2318                         
 NLEV                       Param  2246     I(4)            4           scalar                    2248,2249,2250,2251,2252,2253,2254
                                                                                                  ,2255,2256,2257,2258,2259,2260,226
                                                                                                  1,2290                            
 NM                         Scalar 2247     I(4)            4           scalar   COM              2286,2293,2295,2301,2320,2321,2331
 NMAT                       Scalar 2247     I(4)            4     1     300      COM              2289,2295                         
 NME                        Scalar 2263     I(4)            4           scalar   COM                                                
 NS                         Scalar 2249     I(4)            4     3     31500    COM              2311,2314                         
 NST                        Scalar 2262     I(4)            4           scalar   COM                                                
 NSTN                       Param  2246     I(4)            4           scalar                    2247,2248,2249,2250,2251,2252,2253
                                                                                                  ,2254,2255,2256,2257,2258,2259,226
                                                                                                  0                                 
 NTIMES                     Param  2246     I(4)            4           scalar                    2251,2252,2253,2254,2255,2256,2257
                                                                                                  ,2258,2259,2260                   
 NUM                        Scalar 2262     I(4)            4           scalar   COM                                                
 PARAMS                     Common 2262                                 40                                                          
 QQQ                        Scalar 2260     R(4)            4     4     189000   COM                                                
 R                          Scalar 2264     R(4)            4           scalar   COM              2271,2276                         
 SQRT                       Func   2271                                 scalar                    2271                              
 TFC                        Scalar 2259     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 2256     R(4)            4     4     189000   COM              2318                              
 UIN                        Scalar 2252     R(4)            4     4     189000   COM                                                
 UUU                        Scalar 2254     R(4)            4     4     189000   COM                                                
 VIN                        Scalar 2253     R(4)            4     4     189000   COM                                                
 VVV                        Scalar 2255     R(4)            4     4     189000   COM                                                
 XL                         Scalar 2264     R(4)            4           scalar   COM              2272,2276                         
 ZI                         Local  2316     R(4)            4           scalar                    2316,2319                         
 ZJ                         Local  2317     R(4)            4           scalar                    2317,2319                         
 ZLEV                       Scalar 2261     R(4)            4     1     35       COM                                                

Page 72          Source Listing                  MATR
2017-04-18 11:07                                 cqcvad.f

   2339 
   2340 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2341 C
   2342 C SUBPROGRAM: DMA
   2343 C   PRGMMR: S. Melchior      ORG: NP22       DATE: 2016-12-18
   2344 C
   2345 C ABSTRACT: THIS IS THE DECISION MAKING ALGORITHM.  IT DETERMINES
   2346 C   THE DATA QUALITY.
   2347 C
   2348 C PROGRAM HISTORY LOG:
   2349 C 1999-08-18  W. COLLINS
   2350 C 2001-10-08  D. KEYSER   CORRECTED ERROR WHICH HAD RESULTED IN NO
   2351 C       Q.C. PERFORMED ON LEVELS WHERE EITHER THE U- OR V- INCREMENT
   2352 C       WAS ZERO; LIMITING V-WIND INCREMENT FOR APPLYING BIRD
   2353 C       CONTAMINATION TIGHTENED FROM +8 TO +5 M/S IN SPRING AND FROM
   2354 C       -8 TO -5 M/S IN FALL, MORE LEVELS WILL NOW BE FLAGGED
   2355 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6, NINC=3, AND
   2356 C       NEVNT=160000 TO TIDY UP THE CODE. ADDED DIAGNOSTIC OUTPUT
   2357 C       STATEMENTS FOR INSTANCES WHEN LIMITS ARE EXCEEDED. RENAMED NE
   2358 C       TO NME FOR EASE OF NAVIGATION AND ALSO FOR CLARIFICATION AS NE
   2359 C       IS USED FOR INEQUALITY TESTING (.NE.). INCREASED NRPT FROM
   2360 C       80000 TO 160000 TO ACCOMMODATE VAD WIND REPORTS FROM LEVEL 2
   2361 C       DECODER.
   2362 C 2014-01-15  S. Melchior  Increased NRPT (total number of levels
   2363 C       amongst all VAD reports that can be processed) and NEVNT (total
   2364 C       number of events amongst all VAD reports that can be processed)
   2365 C       both from 160000 to 500000 to accommodate VAD wind reports from
   2366 C       Level 2 decoder.
   2367 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2368 C       process) from 200 to 300.
   2369 C
   2370 C USAGE:    CALL DMA(HONOR_FLAGS)
   2371 C   INPUT ARGUMENT LIST:
   2372 C     HONOR_FLAGS  - TRUE IF EXISTING FLAGS ARE HONORED
   2373 C
   2374 C ATTRIBUTES:
   2375 C   LANGUAGE: FORTRAN 90
   2376 C   MACHINE:  NCEP WCOSS
   2377 C
   2378 C$$$
   2379       SUBROUTINE DMA(HONOR_FLAGS)
   2380 
   2381       PARAMETER (NRPT=500000,NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   2382       PARAMETER (nevnt=500000)
   2383       CHARACTER*8 SIDS, STNID, SIDEV
   2384 
   2385       REAL(8)   BMISS
   2386 
   2387       COMMON /HTRES/  RGU(NLEV,NTIMES,NINC,NSTN),
   2388      &                RGV(NLEV,NTIMES,NINC,NSTN)
   2389       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   2390      &                VIN(NLEV,NTIMES,NINC,NSTN),
   2391      &                UUU(NLEV,NTIMES,NINC,NSTN),
   2392      &                VVV(NLEV,NTIMES,NINC,NSTN),
   2393      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   2394      &                NIN(NLEV,NTIMES,NSTN),
   2395      &                LLL(NLEV,NTIMES,NINC,NSTN),

Page 73          Source Listing                  DMA
2017-04-18 11:07                                 cqcvad.f

   2396      &                TFC(NLEV,NTIMES,NINC,NSTN),
   2397      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   2398       COMMON /EVENTS/ SIDEV(nevnt), HTEV(nevnt),LEV(nevnt),
   2399      &                TIMEV(nevnt), UEV(nevnt), VEV(nevnt),
   2400      &                QALEV(nevnt), RCEV(nevnt)
   2401       COMMON /STATS/  UW(nstn*ntimes*ninc),VW(nstn*ntimes*ninc),
   2402      &                XM(NLEV,2),SD(NLEV,2),XLIM(2)
   2403       COMMON /STN/    SLAT(NSTN), SLON(NSTN), SIDS(NSTN), STNID(NRPT),
   2404      &                ZSTN(NSTN)
   2405       COMMON /COLECT/ LS(NSTN,NLEV,NINC), JS(NSTN,NLEV,NINC),
   2406      &                NS(NSTN,NLEV,NINC), NC(NLEV,NINC),
   2407      &                DS(NSTN,NLEV,NINC),
   2408      &                LTSCOL(9,NLEV,NTIMES,NINC,NSTN)
   2409       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
   2410       COMMON /CONSTS/ MAT,E,AA,B,XL,R
   2411       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   2412      &                CQCPC, NEV, NME
   2413       COMMON /BIRDS/  BIRDTIME
   2414       COMMON /DMATYP/ IQC(NLEV,NTIMES,NINC,NSTN)
   2415       COMMON /DATET/  IDATE(4), ITIM(6)
   2416       COMMON /BUFRLIB_MISSING/BMISS
   2417       common /switches/  print_52, print_53, print_60, test
   2418       common /flag/ guess
   2419       LOGICAL         VSNG, VDBL, TEST, VBIRD, VBIG,
   2420      &                HONOR_FLAGS, guess
   2421       integer numerr(0:9,0:NLEV), ndata(0:NLEV)
   2422 
   2423       IQC    = 0
   2424       ndata  = 0
   2425       numerr = 0
   2426       NME     = 0
   2427       nme1    = 0
   2428       nme2    = 0
   2429       DO IS=1,NST ! nst max is nstn
   2430         DO IT=1,6
   2431           VECINL = 0.
   2432           VECZTL = 0.
   2433           LAST   = 0
   2434           DO L=1,NLEV
   2435             IF(NIN(L,IT,IS).NE.0) THEN
   2436               DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   2437                 VSNG  = .FALSE.
   2438                 VDBL  = .FALSE.
   2439                 VBIRD = .FALSE.
   2440                 VBIG  = .FALSE.
   2441 
   2442 c               count data
   2443 c               ----------
   2444 
   2445                 ndata(0) = ndata(0) + 1
   2446                 ndata(l) = ndata(l) + 1
   2447 
   2448                 if(guess)  then
   2449 
   2450 C------------------------------------------------------------------
   2451 C  VECIN AND VECZT ARE ESTIMATES OF STANDARDIZED NORMAL VARIATE
   2452 C------------------------------------------------------------------

Page 74          Source Listing                  DMA
2017-04-18 11:07                                 cqcvad.f

   2453 
   2454                    IF(SD(L,1).NE.0. .AND. SD(L,2).NE.0.) THEN
   2455                      VECIN = SQRT(((UIN(L,IT,N,IS)-XM(L,1))/SD(L,1))**2
   2456      &                          + ((VIN(L,IT,N,IS)-XM(L,2))/SD(L,2))**2)
   2457                    ELSE
   2458                      VECIN = SQRT(((UIN(L,IT,N,IS)-XM(L,1))/5.5)**2
   2459      &                          + ((VIN(L,IT,N,IS)-XM(L,2))/5.5)**2)
   2460                    ENDIF
   2461                    VECZT = SQRT((RGU(L,IT,N,IS)/1.4)**2
   2462      &                        + (RGV(L,IT,N,IS)/1.4)**2)
   2463 
   2464                    B     = 10.0        ! Max error
   2465                    PER   = 0.07        ! Proportion of rough errors
   2466                    WLIM1 = 0.55
   2467                    WLIM2 = 0.3
   2468 
   2469                    WP  = 0.5*(ANLWT(VECZT ,B,PER) + ANLWT(VECIN ,B,PER))
   2470                    WPL = 0.5*(ANLWT(VECZTL,B,PER) + ANLWT(VECINL,B,PER))
   2471                    IF(WP.LT.WLIM2)          VSNG = .TRUE.
   2472                    IF(MAX(WP,WPL).LT.WLIM1) VDBL = .TRUE.
   2473 
   2474                    CP  = 0.5*(CUMPROB(VECZT ) + CUMPROB(VECIN ))
   2475                    CPL = 0.5*(CUMPROB(VECZTL) + CUMPROB(VECINL))
   2476 cwgc               IF(CP.GE..995 .OR. (UUU(L,IT,N,IS)**2
   2477 cwgc &               + VVV(L,IT,N,IS)**2).LT.1.)  VSNG = .TRUE.
   2478 cwgc               IF(MIN(CP,CPL).GE.0.995)       VDBL = .TRUE.
   2479 
   2480                    IF((UUU(L,IT,N,IS)**2 + VVV(L,IT,N,IS)**2).GT.1.)THEN
   2481                       IF(TFC(L,IT,N,IS).GT.-3..OR.TFC(L,IT,N,IS).GE.
   2482      &                 BMISS) THEN
   2483 cdak  10/08/2001         IF(BIRDTIME.EQ.1. AND. VIN(L,IT,N,IS).GT. 8.)
   2484                          IF(BIRDTIME.EQ.1. AND. VIN(L,IT,N,IS).GT. 5.)
   2485      &                    VBIRD = .TRUE.
   2486 cdak  10/08/2001         IF(BIRDTIME.EQ.2. AND. VIN(L,IT,N,IS).LT.-8.)
   2487                          IF(BIRDTIME.EQ.2. AND. VIN(L,IT,N,IS).LT.-5.)
   2488      &                    VBIRD = .TRUE.
   2489                       END IF
   2490                       IF(MAX(ABS(UIN(L,IT,N,IS)),ABS(VIN(L,IT,N,IS)))
   2491      &                 .GT.12.) VBIG = .TRUE.
   2492                    END IF
   2493 
   2494                    ITYP = 0
   2495                    IF(VBIRD)  THEN
   2496                       ITYP = 5
   2497                    ELSE IF((UUU(L,IT,N,IS)**2+VVV(L,IT,N,IS)**2).LT.1.)
   2498      &              THEN
   2499                       ITYP = 4
   2500                    ELSE IF(VSNG) THEN
   2501                       ITYP = 1
   2502                       IF(VDBL) ITYP = 3
   2503                    ELSE IF(VDBL) THEN
   2504                       ITYP = 2
   2505                    ELSE  IF(VBIG) THEN
   2506                       ITYP = 7
   2507                    END IF
   2508                 else
   2509                    ityp = 9

Page 75          Source Listing                  DMA
2017-04-18 11:07                                 cqcvad.f

   2510                 end if
   2511 
   2512 C  DO NOT WRITE A NEW EVENT IF PRE-EXISTING FLAG IS TO BE HONORED
   2513 C  AND INDICATES DATA BAD OR NOT TO BE USED
   2514 C  --------------------------------------------------------------
   2515 
   2516                 IF(HONOR_FLAGS .AND. QQQ(L,IT,N,IS).GE.4.) THEN
   2517                   IQC(L,IT,N,IS) = QQQ(L,IT,N,IS)
   2518                   ITYP = 0
   2519                 ENDIF
   2520 
   2521                 IF(ITYP.NE.0 .OR. .NOT.HONOR_FLAGS) THEN
   2522                   numerr(ityp,0) = numerr(ityp,0) + 1
   2523                   numerr(ityp,l) = numerr(ityp,l) + 1
   2524 
   2525 C  SAVE EVENTS
   2526 C  -----------
   2527 
   2528                   NME  = NME + 1
   2529                   NME1 = NME1 + 1
   2530                   if(nme.gt.nev) then
   2531                     print *, 'WARNING: NME > NEV, STOP PROCESSING'
   2532                     go to 900
   2533                   endif
   2534                   SIDEV(NME) = SIDS(IS)
   2535                   HTEV(NME)  = ZLEV(L)
   2536                   LEV(NME)   = LLL(L,IT,N,IS)
   2537                   TIMEV(NME) = TIMIN(L,IT,N,IS)
   2538                   UEV(NME)   = UUU(L,IT,N,IS)
   2539                   VEV(NME)   = VVV(L,IT,N,IS)
   2540                   IF(ITYP.NE.0) THEN
   2541                     QALEV(NME) = 13.
   2542                   ELSE
   2543                     QALEV(NME) = 1.
   2544                   ENDIF
   2545                   RCEV(NME)  = ITYP
   2546                   IQC(L,IT,N,IS) = ITYP
   2547                   IF(VDBL .AND. LAST.NE.0) THEN
   2548                     NME  = NME + 1
   2549                     NME2 = NME2 + 1
   2550                     if(nme.gt.nev) then
   2551                       print *, 'WARNING: NME > NEV, STOP PROCESSING'
   2552                       go to 900
   2553                     endif
   2554                     SIDEV(NME) = SIDS(IS)
   2555                     HTEV(NME)  = ZLEV(LAST)
   2556                     LEV(NME)   = LLL(LAST,IT,N,IS)
   2557                     TIMEV(NME) = TIMIN(LAST,IT,N,IS)
   2558                     UEV(NME)   = UUU(LAST,IT,N,IS)
   2559                     VEV(NME)   = VVV(LAST,IT,N,IS)
   2560                     QALEV(NME) = 13.
   2561                     RCEV(NME)  = ITYP
   2562                     IQC(LAST,IT,N,IS) = ITYP
   2563                   ENDIF
   2564 
   2565 C  WRITE STATION INFORMATION
   2566 C  -------------------------

Page 76          Source Listing                  DMA
2017-04-18 11:07                                 cqcvad.f

   2567 
   2568                   IF(TEST) THEN
   2569                      WRITE(6,500)
   2570                      WRITE(6,501) SIDS(IS),TIMIN(L,IT,N,IS),L,IT,
   2571      &                N,UUU(L,IT,N,IS),VVV(L,IT,N,IS),UIN(L,IT,N,IS),
   2572      &                VIN(L,IT,N,IS),RGU(L,IT,N,IS),RGV(L,IT,N,IS),
   2573      &                CP,CPL,WP,WPL,ITYP,TFC(L,IT,N,IS)
   2574                   END IF
   2575                   ITEMP = 0
   2576                   ISUBT = 0
   2577                   IF(LTSCOL(1,L,IT,N,IS).NE.0) THEN
   2578 
   2579 C  WRITE INFORMATION ABOUT DATA USED IN Z-T INTERPOLATION
   2580 C  ------------------------------------------------------
   2581 
   2582                     LOOP1: DO I=1,9
   2583                       IF(LTSCOL(I,L,IT,N,IS).EQ.0) EXIT LOOP1
   2584                       LL = LTSCOL(I,L,IT,N,IS)/100
   2585                       IF(LL.LT.1 .OR. LL.GT.NLEV) EXIT LOOP1
   2586                       ITS = LTSCOL(I,L,IT,N,IS)-100*LL
   2587                       IF(ITS.NE.0) THEN
   2588                          ITEMP = ITS/10
   2589                          ISUBT = ITS-10*ITEMP
   2590                          IF(ITEMP.LT.1 .OR. ITEMP.GT.5 .OR.
   2591      &                      ISUBT.LT.1 .OR. ISUBT.GT.3) EXIT LOOP1
   2592                       END IF
   2593                       DIST = SQRT((TIMIN(L,IT,N,IS)
   2594      &                  - TIMIN(LL,ITEMP,ISUBT,IS))**2
   2595      &                  + (R**2) * (IZLEV(L)-IZLEV(LL))**2)
   2596                       if(guess)  then
   2597                          IF(SD(LL,1).NE.0. .AND. SD(LL,2).NE.0.) THEN
   2598                             VECTIN =
   2599      &                       SQRT(((UIN(LL,ITEMP,ISUBT,IS)-XM(LL,1))
   2600      &                       / SD(LL,1))**2 + ((VIN(LL,ITEMP,ISUBT,IS)
   2601      &                       - XM(LL,2))/SD(LL,2))**2)
   2602                          ELSE
   2603                             VECTIN =
   2604      &                       SQRT(((UIN(LL,ITEMP,ISUBT,IS)-XM(LL,1))
   2605      &                       / 5.5)**2 + ((VIN(LL,ITEMP,ISUBT,IS)
   2606      &                       - XM(LL,2))/5.5)**2)
   2607                          ENDIF
   2608                       end if
   2609                       IF(TEST) WRITE(6,504) DIST,LL,ITEMP,ISUBT,
   2610      &                 UIN(LL,ITEMP,ISUBT,IS),VIN(LL,ITEMP,ISUBT,IS)
   2611                     ENDDO  LOOP1
   2612                   END IF
   2613                 ENDIF
   2614                 VECZTL = VECZT
   2615                 VECINL = VECIN
   2616                 LAST = L
   2617               ENDDO
   2618             ENDIF
   2619           ENDDO
   2620         ENDDO
   2621       ENDDO
   2622 
   2623   500 FORMAT(/1X,'STN/DIST  TIME   L  IT   N (   UOB,    VOB)',

Page 77          Source Listing                  DMA
2017-04-18 11:07                                 cqcvad.f

   2624      &       ' (  UIN,    VIN) (  RGU,    RGV)     CP     CPL',
   2625      &       '      WP     WPL ITYP     TFC')
   2626   501 FORMAT(1X,A8,F6.2,3I4,6F8.2,4F8.3,I5,F8.1)
   2627   504 FORMAT(1X,F8.1,3I4,16X,2F8.2)
   2628 
   2629       write(6,511) (idate(j),j=1,4),nst
   2630       write(6,512)
   2631       write(6,513) ndata(0),(numerr(i,0),i=1,5),numerr(7,0),numerr(9,0),
   2632      &             nme1
   2633       do l=1,NLEV
   2634         nsum = 0
   2635         do ie=1,7
   2636           nsum = nsum + numerr(ie,l)
   2637         enddo
   2638         write(6,514) izlev(l),ndata(l),(numerr(i,l),i=1,5),
   2639      &    numerr(7,l),numerr(9,l),nsum
   2640       enddo
   2641   511 format(/' Date: ',i4,3i2.2,'   Number of stations reporting: ',i4)
   2642   512 format(21x,'<---------------error type------------->',/,
   2643      &  ' Height  Data_count    1     2     3     4     5     7     9',
   2644      &       '  Error_count')
   2645   513 format('    all',i9,2x,7i6,i8)
   2646   514 format(1x,i6,i9,2x,7i6,i8)
   2647 
   2648       RETURN
   2649 
   2650   900 CONTINUE
   2651       WRITE(6,505)
   2652   505 FORMAT(' TOO MANY EVENTS')
   2653 
   2654       END

Page 78          Source Listing                  DMA
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name            
                  
 dma_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  2623                                                           2569                              
 501                        Label  2626                                                           2570                              
 504                        Label  2627                                                           2609                              
 505                        Label  2652                                                           2651                              
 511                        Label  2641                                                           2629                              
 512                        Label  2642                                                           2630                              
 513                        Label  2645                                                           2631                              
 514                        Label  2646                                                           2638                              
 900                        Label  2650                                                           2532,2552                         
 AA                         Scalar 2410     R(4)            4           scalar   COM                                                
 ABS                        Func   2490                                 scalar                    2490                              
 ANLWT                      Func   2469     R(4)            4           scalar                    2469,2470                         
 B                          Scalar 2410     R(4)            4           scalar   COM              2464,2469,2470                    
 BIRDS                      Common 2413                                 4                                                           
 BIRDTIME                   Scalar 2413     R(4)            4           scalar   COM              2484,2487                         
 BMISS                      Scalar 2385     R(8)            8           scalar   COM              2482                              
 BUFRLIB_MISSING            Common 2416                                 8                                                           
 COLECT                     Common 2405                                 7308420                                                     
 CON                        Scalar 2411     R(4)            4           scalar   COM                                                
 CONSTS                     Common 2410                                 24                                                          
 CP                         Local  2474     R(4)            4           scalar                    2474,2573                         
 CPL                        Local  2475     R(4)            4           scalar                    2475,2573                         
 CQCPC                      Scalar 2412     R(4)            4           scalar   COM                                                
 CUMPROB                    Func   2474     R(4)            4           scalar                    2474,2475                         
 DATET                      Common 2415                                 40                                                          
 DIST                       Local  2593     R(4)            4           scalar                    2593,2609                         
 DMA                        Subr   2379                                                                                             
 DMATYP                     Common 2414                                 756000                                                      
 DS                         Scalar 2407     R(4)            4     3     31500    COM                                                
 E                          Scalar 2410     R(4)            4           scalar   COM                                                
 EVENTS                     Common 2398                                 18000000                                                    
 FLAG                       Common 2418                                 4                                                           
 GUESS                      Scalar 2418     L(4)            4           scalar   COM              2448,2596                         
 HONOR_FLAGS                Dummy  2379     L(4)            4           scalar   ARG,INOUT        2516,2521                         
 HTEV                       Scalar 2398     R(4)            4     1     500000   COM              2535,2555                         
 HTRES                      Common 2387                                 1512000                                                     
 HTS                        Common 2409                                 280                                                         
 I                          Local  2582     I(4)            4           scalar                    2582,2583,2584,2586,2631,2638     
 IDATE                      Scalar 2415     I(4)            4     1     4        COM              2629                              
 IE                         Local  2635     I(4)            4           scalar                    2635,2636                         
 IHE                        Scalar 2411     I(4)            4           scalar   COM                                                
 INCS                       Common 2389                                 6300000                                                     
 IOUT                       Scalar 2411     I(4)            4           scalar   COM                                                
 IQC                        Scalar 2414     I(4)            4     4     189000   COM              2423,2517,2546,2562               

Page 79          Source Listing                  DMA
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IS                         Local  2429     I(4)            4           scalar                    2429,2435,2436,2455,2456,2458,2459
                                                                                                  ,2461,2462,2480,2481,2484,2487,249
                                                                                                  0,2497,2516,2517,2534,2536,2537,25
                                                                                                  38,2539,2546,2554,2556,2557,2558,2
                                                                                                  559,2562,2570,2571,2572,2573,2577,
                                                                                                  2583,2584,2586,2593,2594,2599,2600
                                                                                                  ,2604,2605,2610                   
 ISUBT                      Local  2576     I(4)            4           scalar                    2576,2589,2591,2594,2599,2600,2604
                                                                                                  ,2605,2609,2610                   
 IT                         Local  2430     I(4)            4           scalar                    2430,2435,2436,2455,2456,2458,2459
                                                                                                  ,2461,2462,2480,2481,2484,2487,249
                                                                                                  0,2497,2516,2517,2536,2537,2538,25
                                                                                                  39,2546,2556,2557,2558,2559,2562,2
                                                                                                  570,2571,2572,2573,2577,2583,2584,
                                                                                                  2586,2593                         
 ITEMP                      Local  2575     I(4)            4           scalar                    2575,2588,2589,2590,2594,2599,2600
                                                                                                  ,2604,2605,2609,2610              
 ITIM                       Scalar 2415     I(4)            4     1     6        COM                                                
 ITS                        Local  2586     I(4)            4           scalar                    2586,2587,2588,2589               
 ITYP                       Local  2494     I(4)            4           scalar                    2494,2496,2499,2501,2502,2504,2506
                                                                                                  ,2509,2518,2521,2522,2523,2540,254
                                                                                                  5,2546,2561,2562,2573             
 IUNIT                      Scalar 2411     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 2411     I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 2409     I(4)            4     1     35       COM              2595,2638                         
 J                          Local  2629     I(4)            4           scalar                    2629                              
 JS                         Scalar 2405     I(4)            4     3     31500    COM                                                
 L                          Local  2434     I(4)            4           scalar                    2434,2435,2436,2446,2454,2455,2456
                                                                                                  ,2458,2459,2461,2462,2480,2481,248
                                                                                                  4,2487,2490,2497,2516,2517,2523,25
                                                                                                  35,2536,2537,2538,2539,2546,2570,2
                                                                                                  571,2572,2573,2577,2583,2584,2586,
                                                                                                  2593,2595,2616,2633,2636,2638,2639
 LAST                       Local  2433     I(4)            4           scalar                    2433,2547,2555,2556,2557,2558,2559
                                                                                                  ,2562,2616                        
 LEV                        Scalar 2398     I(4)            4     1     500000   COM              2536,2556                         
 LL                         Local  2584     I(4)            4           scalar                    2584,2585,2586,2594,2595,2597,2599
                                                                                                  ,2600,2601,2604,2605,2606,2609,261
                                                                                                  0                                 
 LLL                        Scalar 2395     I(4)            4     4     189000   COM              2536,2556                         
 LOOP1                      Label  2582                                 scalar                    2583,2585,2591,2611               
 LS                         Scalar 2405     I(4)            4     3     31500    COM                                                
 LTSCOL                     Scalar 2408     I(4)            4     5     1701000  COM              2577,2583,2584,2586               
 MAT                        Scalar 2410     I(4)            4           scalar   COM                                                
 MAX                        Func   2472                                 scalar                    2472,2490                         
 N                          Local  2436     I(4)            4           scalar                    2436,2455,2456,2458,2459,2461,2462
                                                                                                  ,2480,2481,2484,2487,2490,2497,251
                                                                                                  6,2517,2536,2537,2538,2539,2546,25
                                                                                                  56,2557,2558,2559,2562,2570,2571,2
                                                                                                  572,2573,2577,2583,2584,2586,2593 
 NC                         Scalar 2406     I(4)            4     2     105      COM                                                
 NDATA                      Local  2421     I(4)            4     1     36                        2424,2445,2446,2631,2638          
 NEV                        Scalar 2412     I(4)            4           scalar   COM              2530,2550                         
 NEVNT                      Param  2382     I(4)            4           scalar                    2398,2399,2400                    
 NIN                        Scalar 2394     I(4)            4     3     63000    COM              2435,2436                         

Page 80          Source Listing                  DMA
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NINC                       Param  2381     I(4)            4           scalar                    2387,2388,2389,2390,2391,2392,2393
                                                                                                  ,2395,2396,2397,2401,2405,2406,240
                                                                                                  7,2408,2414                       
 NLEV                       Param  2381     I(4)            4           scalar                    2387,2388,2389,2390,2391,2392,2393
                                                                                                  ,2394,2395,2396,2397,2402,2405,240
                                                                                                  6,2407,2408,2409,2414,2421,2434,25
                                                                                                  85,2633                           
 NME                        Scalar 2412     I(4)            4           scalar   COM              2426,2528,2530,2534,2535,2536,2537
                                                                                                  ,2538,2539,2541,2543,2545,2548,255
                                                                                                  0,2554,2555,2556,2557,2558,2559,25
                                                                                                  60,2561                           
 NME1                       Local  2427     I(4)            4           scalar                    2427,2529,2632                    
 NME2                       Local  2428     I(4)            4           scalar                    2428,2549                         
 NRPT                       Param  2381     I(4)            4           scalar                    2403                              
 NS                         Scalar 2406     I(4)            4     3     31500    COM                                                
 NST                        Scalar 2411     I(4)            4           scalar   COM              2429,2629                         
 NSTN                       Param  2381     I(4)            4           scalar                    2387,2388,2389,2390,2391,2392,2393
                                                                                                  ,2394,2395,2396,2397,2401,2403,240
                                                                                                  4,2405,2406,2407,2408,2414        
 NSUM                       Local  2634     I(4)            4           scalar                    2634,2636,2639                    
 NTIMES                     Param  2381     I(4)            4           scalar                    2387,2388,2389,2390,2391,2392,2393
                                                                                                  ,2394,2395,2396,2397,2401,2408,241
                                                                                                  4                                 
 NUM                        Scalar 2411     I(4)            4           scalar   COM                                                
 NUMERR                     Local  2421     I(4)            4     2     360                       2425,2522,2523,2631,2636,2638,2639
 PARAMS                     Common 2411                                 40                                                          
 PER                        Local  2465     R(4)            4           scalar                    2465,2469,2470                    
 PRINT_52                   Scalar 2417     R(4)            4           scalar   COM                                                
 PRINT_53                   Scalar 2417     R(4)            4           scalar   COM                                                
 PRINT_60                   Scalar 2417     R(4)            4           scalar   COM                                                
 QALEV                      Scalar 2400     R(4)            4     1     500000   COM              2541,2543,2560                    
 QQQ                        Scalar 2397     R(4)            4     4     189000   COM              2516,2517                         
 R                          Scalar 2410     R(4)            4           scalar   COM              2595                              
 RCEV                       Scalar 2400     R(4)            4     1     500000   COM              2545,2561                         
 RGU                        Scalar 2387     R(4)            4     4     189000   COM              2461,2572                         
 RGV                        Scalar 2388     R(4)            4     4     189000   COM              2462,2572                         
 SD                         Scalar 2402     R(4)            4     2     70       COM              2454,2455,2456,2597,2600,2601     
 SIDEV                      Scalar 2383     CHAR            8     1     500000   COM              2534,2554                         
 SIDS                       Scalar 2383     CHAR            8     1     300      COM              2534,2554,2570                    
 SLAT                       Scalar 2403     R(4)            4     1     300      COM                                                
 SLON                       Scalar 2403     R(4)            4     1     300      COM                                                
 SQRT                       Func   2455                                 scalar                    2455,2458,2461,2593,2599,2604     
 STATS                      Common 2401                                 43768                                                       
 STN                        Common 2403                                 4006000                                                     
 STNID                      Scalar 2383     CHAR            8     1     500000   COM                                                
 SWITCHES                   Common 2417                                 16                                                          
 TEST                       Scalar 2417     L(4)            4           scalar   COM              2568,2609                         
 TFC                        Scalar 2396     R(4)            4     4     189000   COM              2481,2573                         
 TIMEV                      Scalar 2399     R(4)            4     1     500000   COM              2537,2557                         
 TIMIN                      Scalar 2393     R(4)            4     4     189000   COM              2537,2557,2570,2593,2594          
 UEV                        Scalar 2399     R(4)            4     1     500000   COM              2538,2558                         
 UIN                        Scalar 2389     R(4)            4     4     189000   COM              2455,2458,2490,2571,2599,2604,2610
 UUU                        Scalar 2391     R(4)            4     4     189000   COM              2480,2497,2538,2558,2571          
 UW                         Scalar 2401     R(4)            4     1     5400     COM                                                
 VBIG                       Local  2419     L(4)            4           scalar                    2440,2491,2505                    

Page 81          Source Listing                  DMA
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VBIRD                      Local  2419     L(4)            4           scalar                    2439,2485,2488,2495               
 VDBL                       Local  2419     L(4)            4           scalar                    2438,2472,2502,2503,2547          
 VECIN                      Local  2455     R(4)            4           scalar                    2455,2458,2469,2474,2615          
 VECINL                     Local  2431     R(4)            4           scalar                    2431,2470,2475,2615               
 VECTIN                     Local  2598     R(4)            4           scalar                    2598,2603                         
 VECZT                      Local  2461     R(4)            4           scalar                    2461,2469,2474,2614               
 VECZTL                     Local  2432     R(4)            4           scalar                    2432,2470,2475,2614               
 VEV                        Scalar 2399     R(4)            4     1     500000   COM              2539,2559                         
 VIN                        Scalar 2390     R(4)            4     4     189000   COM              2456,2459,2484,2487,2490,2572,2600
                                                                                                  ,2605,2610                        
 VSNG                       Local  2419     L(4)            4           scalar                    2437,2471,2500                    
 VVV                        Scalar 2392     R(4)            4     4     189000   COM              2480,2497,2539,2559,2571          
 VW                         Scalar 2401     R(4)            4     1     5400     COM                                                
 WLIM1                      Local  2466     R(4)            4           scalar                    2466,2472                         
 WLIM2                      Local  2467     R(4)            4           scalar                    2467,2471                         
 WP                         Local  2469     R(4)            4           scalar                    2469,2471,2472,2573               
 WPL                        Local  2470     R(4)            4           scalar                    2470,2472,2573                    
 XL                         Scalar 2410     R(4)            4           scalar   COM                                                
 XLIM                       Scalar 2402     R(4)            4     1     2        COM                                                
 XM                         Scalar 2402     R(4)            4     2     70       COM              2455,2456,2458,2459,2599,2601,2604
                                                                                                  ,2606                             
 ZLEV                       Scalar 2409     R(4)            4     1     35       COM              2535,2555                         
 ZSTN                       Scalar 2404     R(4)            4     1     300      COM                                                

Page 82          Source Listing                  DMA
2017-04-18 11:07                                 cqcvad.f

   2655 
   2656 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2657 C
   2658 C SUBPROGRAM: RESDIST
   2659 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   2660 C
   2661 C ABSTRACT: COMPUTE STATISTICS AND DISTRIBUTIONS OF RESIDUALS OF
   2662 C   CHECKS.
   2663 C
   2664 C PROGRAM HISTORY LOG:
   2665 C 1999-08-18  W. COLLINS
   2666 C 2012-03-05  S. MELCHIOR  EXTENDED MSK ARRAY ALLOCATION FROM 899 TO
   2667 C       1000 TO ALLOW FOR MORE STATION STATISTICS TO BE PROCESSED -
   2668 C       ON OCCASION THE 899 LIMIT HAD BEEN MET AND EXCEEDED. ADDED
   2669 C       PARAMETERS NDIV=23, NTIMES=6, NINC=3 TO TIDY UP THE CODE.
   2670 C       ADDIED DIAGNOSTIC OUTPUT STATEMENTS FOR INSTANCES WHEN LIMITS
   2671 C       ARE EXCEEDED. RENAMED NE TO NME FOR EASE OF NAVIGATION AND 
   2672 C       FOR CLARIFICATION AS NE IS USED FOR INEQUALITY TESTING (.NE.).
   2673 C 2014-01-15  S. Melchior Added integer "icntmx" to define the max
   2674 C       value of icnt in the multi-nested do loop that hinges on the
   2675 C       number of levels (NLEV), the number of stations (NST), the
   2676 C       number of times (NTIMES), and the number of increments (NINC).
   2677 C 2014-08-29  S. Melchior  Extended MSK, UW, and VW array allocations
   2678 C       from 1000 to 3600 (NSTN*NTIMES*NINC) to allow for a complete 
   2679 C       set of station statistics to be processed.  On occasion the
   2680 C       1000 limit had been met and exceeded, losing out on station 
   2681 C       statistics.
   2682 C 2014-09-04  S. Melchior  Redefined MSK, UW, and VW arrays to
   2683 C       utilize parameters NSTN, NTIMES, and NINC rather than 
   2684 C       explicitly setting the array size at 3600. "icntmx" is no 
   2685 C       longer necessary but will be retained because it may prove
   2686 C       useful for future debugging.
   2687 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2688 C       process) from 200 to 300.
   2689 C
   2690 C USAGE:    CALL RESDIST
   2691 C
   2692 C   OUTPUT ARGUMENT LIST:
   2693 C     UNIT 06 - STANDARD OUTPUT PRINT
   2694 C
   2695 C ATTRIBUTES:
   2696 C   LANGUAGE: FORTRAN 90
   2697 C   MACHINE:  NCEP WCOSS
   2698 C
   2699 C$$$
   2700       SUBROUTINE RESDIST
   2701 
   2702       PARAMETER(NSTN=300,NLEV=35,NDIV=23,NTIMES=6,NINC=3)
   2703 
   2704       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   2705      &                VIN(NLEV,NTIMES,NINC,NSTN),
   2706      &                UUU(NLEV,NTIMES,NINC,NSTN),
   2707      &                VVV(NLEV,NTIMES,NINC,NSTN),
   2708      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   2709      &                NIN(NLEV,NTIMES,NSTN),
   2710      &                LLL(NLEV,NTIMES,NINC,NSTN),
   2711      &                TFC(NLEV,NTIMES,NINC,NSTN),

Page 83          Source Listing                  RESDIST
2017-04-18 11:07                                 cqcvad.f

   2712      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   2713       COMMON /HTRES/  RGU(NLEV,NTIMES,NINC,NSTN),
   2714      &                RGV(NLEV,NTIMES,NINC,NSTN)
   2715       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   2716      &                CQCPC, NEV, NME
   2717       COMMON /HTS/    IZLEV(NLEV), ZLEV(NLEV)
   2718       COMMON /DATET/  IDATE(4), ITIM(6)
   2719       COMMON /DMATYP/ IQC(NLEV,NTIMES,NINC,NSTN)
   2720       REAL        UW(nstn*ntimes*ninc),VW(nstn*ntimes*ninc),
   2721      &            XM(NLEV,2),SD(NLEV,2),XLIM(2)
   2722       INTEGER     NM(NDIV,NLEV,2),MSK(nstn*ntimes*ninc),NC(NLEV,2),
   2723      &            icntmx
   2724       DATA XLIM /-5.,5./, XMSG /99999./
   2725 
   2726       MSK = 0
   2727       icntmx = nst*ntimes*ninc
   2728 
   2729       DO L=1,NLEV ! nlev max is 35
   2730 
   2731 C  PUT DATA INTO WORK ARRAY
   2732 C  ------------------------
   2733 
   2734         ICNT = 0
   2735         UW = 0
   2736         VW = 0
   2737         LOOP1: DO IS=1,NST !  nst max is nstn
   2738           DO IT=1,NTIMES ! ntimes max is 6
   2739             IF(NIN(L,IT,IS).GT.0) THEN
   2740               DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   2741                 IF(IQC(L,IT,N,IS).EQ.0) THEN
   2742                   ICNT = ICNT + 1
   2743                   UW(ICNT) = RGU(L,IT,N,IS)
   2744                   VW(ICNT) = RGV(L,IT,N,IS)
   2745                 ENDIF
   2746               ENDDO
   2747             ENDIF
   2748           ENDDO
   2749         ENDDO  LOOP1
   2750 
   2751 C  GET DISTRIBUTIONS
   2752 C  -----------------
   2753 
   2754         BINI = 0.5
   2755         CALL DISTR(UW,MSK,XLIM,XMSG,ICNT,NM(1,L,1),NDIV,BINI,0,0.,
   2756      &             NC(L,1),XM(L,1),SD(L,1),SK,XK)
   2757         CALL DISTR(VW,MSK,XLIM,XMSG,ICNT,NM(1,L,2),NDIV,BINI,0,0.,
   2758      &             NC(L,2),XM(L,2),SD(L,2),SK,XK)
   2759 
   2760       ENDDO
   2761 
   2762 C  PRINT DISTRIBUTIONS
   2763 C  -------------------
   2764 
   2765       WRITE(6,500) (IDATE(I),I=1,4), BINI
   2766   500 FORMAT(/' VAD wind z-t residual statistics for ',I4,3I2.2,
   2767      &       '   Bin increment = ',F8.2,' m/s')
   2768       WRITE(6,501)

Page 84          Source Listing                  RESDIST
2017-04-18 11:07                                 cqcvad.f

   2769   501 FORMAT(/50X,'--------DISTRIBUTION FOR U-COMPONENT--------')
   2770       WRITE(6,502)
   2771   502 FORMAT(' HEIGHT(1000s ft) <-10  -10   -9   -8   -7   -6',
   2772      &  '   -5   -4   -3   -2   -1    0    1    2    3    4    5',
   2773      &  '    6    7    8    9   10  >10')
   2774       WRITE(6,503) (IZLEV(L), (NM(I,L,1),I=1,NDIV), L=1,NLEV)
   2775   503 FORMAT(6X,I5,6X,23I5)
   2776 
   2777       WRITE(6,504)
   2778   504 FORMAT(/50X,'--------DISTRIBUTION FOR V-COMPONENT--------')
   2779       WRITE(6,502)
   2780       WRITE(6,503) (IZLEV(L), (NM(I,L,2),I=1,NDIV), L=1,NLEV)
   2781 
   2782       WRITE(6,505)
   2783   505 FORMAT(/' HEIGHT(1000s ft)  Num      U-Mean  U-StdDev',
   2784      &       '    V-Mean  V-StdDev Mag-StdDev')
   2785       WRITE(6,506) (IZLEV(L),NC(L,1),XM(L,1),SD(L,1),XM(L,2),
   2786      &              SD(L,2),SQRT(SD(L,1)**2+SD(L,2)**2),L=1,NLEV)
   2787   506 FORMAT(6X,I5,6X,I5,2X,5F10.1)
   2788 
   2789       RETURN
   2790       END


ENTRY POINTS

  Name                
                      
 resdist_             

Page 85          Source Listing                  RESDIST
2017-04-18 11:07 Symbol Table                    cqcvad.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 500                        Label  2766                                                           2765                              
 501                        Label  2769                                                           2768                              
 502                        Label  2771                                                           2770,2779                         
 503                        Label  2775                                                           2774,2780                         
 504                        Label  2778                                                           2777                              
 505                        Label  2783                                                           2782                              
 506                        Label  2787                                                           2785                              
 BINI                       Local  2754     R(4)            4           scalar                    2754,2755,2757,2765               
 CON                        Scalar 2715     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 2716     R(4)            4           scalar   COM                                                
 DATET                      Common 2718                                 40                                                          
 DISTR                      Subr   2755                                                           2755,2757                         
 DMATYP                     Common 2719                                 756000                                                      
 HTRES                      Common 2713                                 1512000                                                     
 HTS                        Common 2717                                 280                                                         
 I                          Local  2765     I(4)            4           scalar                    2765,2774,2780                    
 ICNT                       Local  2734     I(4)            4           scalar                    2734,2742,2743,2744,2755,2757     
 ICNTMX                     Local  2723     I(4)            4           scalar                    2727                              
 IDATE                      Scalar 2718     I(4)            4     1     4        COM              2765                              
 IHE                        Scalar 2715     I(4)            4           scalar   COM                                                
 INCS                       Common 2704                                 6300000                                                     
 IOUT                       Scalar 2715     I(4)            4           scalar   COM                                                
 IQC                        Scalar 2719     I(4)            4     4     189000   COM              2741                              
 IS                         Local  2737     I(4)            4           scalar                    2737,2739,2740,2741,2743,2744     
 IT                         Local  2738     I(4)            4           scalar                    2738,2739,2740,2741,2743,2744     
 ITIM                       Scalar 2718     I(4)            4     1     6        COM                                                
 IUNIT                      Scalar 2715     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 2715     I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 2717     I(4)            4     1     35       COM              2774,2780,2785                    
 L                          Local  2729     I(4)            4           scalar                    2729,2739,2740,2741,2743,2744,2755
                                                                                                  ,2756,2757,2758,2774,2780,2785,278
                                                                                                  6                                 
 LLL                        Scalar 2710     I(4)            4     4     189000   COM                                                
 LOOP1                      Label  2737                                 scalar                    2749                              
 MSK                        Local  2722     I(4)            4     1     5400                      2726,2755,2757                    
 N                          Local  2740     I(4)            4           scalar                    2740,2741,2743,2744               
 NC                         Local  2722     I(4)            4     2     70                        2756,2758,2785                    
 NDIV                       Param  2702     I(4)            4           scalar                    2722,2755,2757,2774,2780          
 NEV                        Scalar 2716     I(4)            4           scalar   COM                                                
 NIN                        Scalar 2709     I(4)            4     3     63000    COM              2739,2740                         
 NINC                       Param  2702     I(4)            4           scalar                    2704,2705,2706,2707,2708,2710,2711
                                                                                                  ,2712,2713,2714,2719,2720,2722,272
                                                                                                  7                                 
 NLEV                       Param  2702     I(4)            4           scalar                    2704,2705,2706,2707,2708,2709,2710
                                                                                                  ,2711,2712,2713,2714,2717,2719,272
                                                                                                  1,2722,2729,2774,2780,2786        
 NM                         Local  2722     I(4)            4     3     1610                      2755,2757,2774,2780               
 NME                        Scalar 2716     I(4)            4           scalar   COM                                                
 NST                        Scalar 2715     I(4)            4           scalar   COM              2727,2737                         
 NSTN                       Param  2702     I(4)            4           scalar                    2704,2705,2706,2707,2708,2709,2710
                                                                                                  ,2711,2712,2713,2714,2719,2720,272

Page 86          Source Listing                  RESDIST
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  2                                 
 NTIMES                     Param  2702     I(4)            4           scalar                    2704,2705,2706,2707,2708,2709,2710
                                                                                                  ,2711,2712,2713,2714,2719,2720,272
                                                                                                  2,2727,2738                       
 NUM                        Scalar 2715     I(4)            4           scalar   COM                                                
 PARAMS                     Common 2715                                 40                                                          
 QQQ                        Scalar 2712     R(4)            4     4     189000   COM                                                
 RESDIST                    Subr   2700                                                                                             
 RGU                        Scalar 2713     R(4)            4     4     189000   COM              2743                              
 RGV                        Scalar 2714     R(4)            4     4     189000   COM              2744                              
 SD                         Local  2721     R(4)            4     2     70                        2756,2758,2785,2786               
 SK                         Local  2756     R(4)            4           scalar                    2756,2758                         
 SQRT                       Func   2786                                 scalar                    2786                              
 TFC                        Scalar 2711     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 2708     R(4)            4     4     189000   COM                                                
 UIN                        Scalar 2704     R(4)            4     4     189000   COM                                                
 UUU                        Scalar 2706     R(4)            4     4     189000   COM                                                
 UW                         Local  2720     R(4)            4     1     5400                      2735,2743,2755                    
 VIN                        Scalar 2705     R(4)            4     4     189000   COM                                                
 VVV                        Scalar 2707     R(4)            4     4     189000   COM                                                
 VW                         Local  2720     R(4)            4     1     5400                      2736,2744,2757                    
 XK                         Local  2756     R(4)            4           scalar                    2756,2758                         
 XLIM                       Local  2721     R(4)            4     1     2                         2724,2755,2757                    
 XM                         Local  2721     R(4)            4     2     70                        2756,2758,2785                    
 XMSG                       Local  2724     R(4)            4           scalar                    2724,2755,2757                    
 ZLEV                       Scalar 2717     R(4)            4     1     35       COM                                                

Page 87          Source Listing                  RESDIST
2017-04-18 11:07                                 cqcvad.f

   2791 
   2792 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2793 C
   2794 C SUBPROGRAM: SELECT
   2795 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   2796 C
   2797 C ABSTRACT: SELECT DATA TO BE USED IN Z-T OI ANALYSIS
   2798 C
   2799 C PROGRAM HISTORY LOG:
   2800 C 1999-08-18  W. COLLINS
   2801 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO
   2802 C       TIDY UP THE CODE. RENAMED NE TO NME FOR EASE OF 
   2803 C       NAVIGATION AND FOR CLARIFICATION SINCE NE IS USED FOR
   2804 C       INEQUALITY TESTING (.NE.).
   2805 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2806 C       process) from 200 to 300.
   2807 C
   2808 C USAGE:    CALL SELECT(IS,IT)
   2809 C   INPUT ARGUMENT LIST:
   2810 C     IS       - STATION INDEX
   2811 C     IT       - TIME INDEX
   2812 C
   2813 C ATTRIBUTES:
   2814 C   LANGUAGE: FORTRAN 90
   2815 C   MACHINE:  NCEP WCOSS
   2816 C
   2817 C$$$
   2818       SUBROUTINE SELECT(IS,IT)
   2819 
   2820       PARAMETER(NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   2821       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   2822      &                VIN(NLEV,NTIMES,NINC,NSTN),
   2823      &                UUU(NLEV,NTIMES,NINC,NSTN),
   2824      &                VVV(NLEV,NTIMES,NINC,NSTN),
   2825      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   2826      &                NIN(NLEV,NTIMES,NSTN),
   2827      &                LLL(NLEV,NTIMES,NINC,NSTN),
   2828      &                TFC(NLEV,NTIMES,NINC,NSTN),
   2829      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   2830       COMMON /HTS/ IZLEV(NLEV), ZLEV(NLEV)
   2831       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   2832      &                CQCPC, NEV, NME
   2833       COMMON /COLECT/ LS(NSTN,NLEV,NINC), JS(NSTN,NLEV,NINC),
   2834      &                NS(NSTN,NLEV,NINC), NC(NLEV,NINC),
   2835      &                DS(NSTN,NLEV,NINC),
   2836      &                LTSCOL(9,NLEV,NTIMES,NINC,NSTN)
   2837       COMMON /CONSTS/ MAT,E,AA,B,XL,R
   2838 
   2839       DS = 0.
   2840       LS = 0
   2841       JS = 0
   2842       NS = 0
   2843       NC = 0
   2844 
   2845 C  SELECT DATA TO BE USED IN Z-T OI ANALYSIS
   2846 C  -----------------------------------------
   2847 

Page 88          Source Listing                  SELECT
2017-04-18 11:07                                 cqcvad.f

   2848 C  OBS IS AT (L,IT,IS,N).  CALCULATE DISTANCE TO NEIGHBORS.
   2849 C  --------------------------------------------------------
   2850 
   2851       DO L=1,NLEV
   2852         IF(NIN(L,IT,IS).NE.0) THEN
   2853           DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   2854             NM = 0
   2855             L1 = MAX(L-3,1)
   2856             L2 = MIN(L+3,NLEV)
   2857             DO LL=L1,L2
   2858               DO I=1,NTIMES
   2859                 IF(NIN(LL,I,IS).NE.0) THEN
   2860                   DO NN=1,NIN(LL,I,IS) !  nin(LL,I,IS) max is 3
   2861                     IF(.NOT. ((L.EQ.LL) .AND. (I.EQ.IT) .AND.
   2862      &                       (N.EQ.NN))) THEN
   2863                       NM = NM + 1
   2864                       DS(NM,L,N) = SQRT((TIMIN(L,IT,N,IS)
   2865      &                  - TIMIN(LL,I,NN,IS))**2 + (R**2) *
   2866      &                  (IZLEV(L)-IZLEV(LL))**2)
   2867                       LS(NM,L,N) = LL
   2868                       JS(NM,L,N) = I
   2869                       NS(NM,L,N) = NN
   2870                     ENDIF
   2871                   ENDDO
   2872                 ENDIF
   2873               ENDDO
   2874             ENDDO
   2875             NC(L,N) = NM
   2876           ENDDO
   2877         ENDIF
   2878       ENDDO
   2879 
   2880 C  SORT THE QUANTITIES BY DESCENDING DISTANCE
   2881 C  ------------------------------------------
   2882 
   2883       DO L=1,NLEV
   2884         IF(NIN(L,IT,IS).NE.0) THEN
   2885           DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   2886             CALL SORTD(DS(1,L,N),LS(1,L,N),JS(1,L,N),NS(1,L,N),NC(L,N))
   2887             LTSCOL(1:9,L,IT,N,IS) = 
   2888      &                        100*LS(1:9,L,N)+10*JS(1:9,L,N)+NS(1:9,L,N)
   2889           ENDDO
   2890         ENDIF
   2891       ENDDO
   2892 
   2893       RETURN
   2894       END

Page 89          Source Listing                  SELECT
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name               
                     
 select_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AA                         Scalar 2837     R(4)            4           scalar   COM                                                
 B                          Scalar 2837     R(4)            4           scalar   COM                                                
 COLECT                     Common 2833                                 7308420                                                     
 CON                        Scalar 2831     R(4)            4           scalar   COM                                                
 CONSTS                     Common 2837                                 24                                                          
 CQCPC                      Scalar 2832     R(4)            4           scalar   COM                                                
 DS                         Scalar 2835     R(4)            4     3     31500    COM              2839,2864,2886                    
 E                          Scalar 2837     R(4)            4           scalar   COM                                                
 HTS                        Common 2830                                 280                                                         
 I                          Local  2858     I(4)            4           scalar                    2858,2859,2860,2861,2865,2868     
 IHE                        Scalar 2831     I(4)            4           scalar   COM                                                
 INCS                       Common 2821                                 6300000                                                     
 IOUT                       Scalar 2831     I(4)            4           scalar   COM                                                
 IS                         Dummy  2818     I(4)            4           scalar   ARG,INOUT        2852,2853,2859,2860,2864,2865,2884
                                                                                                  ,2885,2887                        
 IT                         Dummy  2818     I(4)            4           scalar   ARG,INOUT        2852,2853,2861,2864,2884,2885,2887
 IUNIT                      Scalar 2831     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 2831     I(4)            4           scalar   COM                                                
 IZLEV                      Scalar 2830     I(4)            4     1     35       COM              2866                              
 JS                         Scalar 2833     I(4)            4     3     31500    COM              2841,2868,2886,2888               
 L                          Local  2851     I(4)            4           scalar                    2851,2852,2853,2855,2856,2861,2864
                                                                                                  ,2866,2867,2868,2869,2875,2883,288
                                                                                                  4,2885,2886,2887,2888             
 L1                         Local  2855     I(4)            4           scalar                    2855,2857                         
 L2                         Local  2856     I(4)            4           scalar                    2856,2857                         
 LL                         Local  2857     I(4)            4           scalar                    2857,2859,2860,2861,2865,2866,2867
 LLL                        Scalar 2827     I(4)            4     4     189000   COM                                                
 LS                         Scalar 2833     I(4)            4     3     31500    COM              2840,2867,2886,2888               
 LTSCOL                     Scalar 2836     I(4)            4     5     1701000  COM              2887                              
 MAT                        Scalar 2837     I(4)            4           scalar   COM                                                
 MAX                        Func   2855                                 scalar                    2855                              
 MIN                        Func   2856                                 scalar                    2856                              
 N                          Local  2853     I(4)            4           scalar                    2853,2862,2864,2867,2868,2869,2875
                                                                                                  ,2885,2886,2887,2888              
 NC                         Scalar 2834     I(4)            4     2     105      COM              2843,2875,2886                    
 NEV                        Scalar 2832     I(4)            4           scalar   COM                                                
 NIN                        Scalar 2826     I(4)            4     3     63000    COM              2852,2853,2859,2860,2884,2885     
 NINC                       Param  2820     I(4)            4           scalar                    2821,2822,2823,2824,2825,2827,2828
                                                                                                  ,2829,2833,2834,2835,2836         
 NLEV                       Param  2820     I(4)            4           scalar                    2821,2822,2823,2824,2825,2826,2827
                                                                                                  ,2828,2829,2830,2833,2834,2835,283
                                                                                                  6,2851,2856,2883                  
 NM                         Local  2854     I(4)            4           scalar                    2854,2863,2864,2867,2868,2869,2875
 NME                        Scalar 2832     I(4)            4           scalar   COM                                                

Page 90          Source Listing                  SELECT
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NN                         Local  2860     I(4)            4           scalar                    2860,2862,2865,2869               
 NS                         Scalar 2834     I(4)            4     3     31500    COM              2842,2869,2886,2888               
 NST                        Scalar 2831     I(4)            4           scalar   COM                                                
 NSTN                       Param  2820     I(4)            4           scalar                    2821,2822,2823,2824,2825,2826,2827
                                                                                                  ,2828,2829,2833,2834,2835,2836    
 NTIMES                     Param  2820     I(4)            4           scalar                    2821,2822,2823,2824,2825,2826,2827
                                                                                                  ,2828,2829,2836,2858              
 NUM                        Scalar 2831     I(4)            4           scalar   COM                                                
 PARAMS                     Common 2831                                 40                                                          
 QQQ                        Scalar 2829     R(4)            4     4     189000   COM                                                
 R                          Scalar 2837     R(4)            4           scalar   COM              2865                              
 SELECT                     Subr   2818                                                                                             
 SORTD                      Subr   2886                                                           2886                              
 SQRT                       Func   2864                                 scalar                    2864                              
 TFC                        Scalar 2828     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 2825     R(4)            4     4     189000   COM              2864,2865                         
 UIN                        Scalar 2821     R(4)            4     4     189000   COM                                                
 UUU                        Scalar 2823     R(4)            4     4     189000   COM                                                
 VIN                        Scalar 2822     R(4)            4     4     189000   COM                                                
 VVV                        Scalar 2824     R(4)            4     4     189000   COM                                                
 XL                         Scalar 2837     R(4)            4           scalar   COM                                                
 ZLEV                       Scalar 2830     R(4)            4     1     35       COM                                                

Page 91          Source Listing                  SELECT
2017-04-18 11:07                                 cqcvad.f

   2895 
   2896 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2897 C
   2898 C SUBPROGRAM: SOLVE
   2899 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   2900 C
   2901 C ABSTRACT:  SOLVE THE MATRIX PROBLEMS
   2902 C   A IS THE SYMMETRIC MATRIX (IN TRIANGULAR FORM)
   2903 C   C IS THE RIGHT-HAND-SIDE VECTOR ON INPUT AND
   2904 C   THE ANALYSIS WEIGHTS ON OUTPUT FROM DRCTSL.
   2905 C
   2906 C PROGRAM HISTORY LOG:
   2907 C 1999-08-18  W. COLLINS
   2908 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO
   2909 C       TIDY UP THE CODE. RENAMED NE TO NME FOR EASE OF
   2910 C       NAVIGATION AND FOR CLARIFICATION AS NE IS USED FOR
   2911 C       INEQUALITY TESTING (.NE.).
   2912 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2913 C       process) from 200 to 300.
   2914 C
   2915 C USAGE:    CALL SOLVE
   2916 C
   2917 C ATTRIBUTES:
   2918 C   LANGUAGE: FORTRAN 90
   2919 C   MACHINE:  NCEP WCOSS
   2920 C
   2921 C$$$
   2922       SUBROUTINE SOLVE
   2923 
   2924       PARAMETER(NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   2925       REAL            DPR(NSTN,1)
   2926       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   2927      &                VIN(NLEV,NTIMES,NINC,NSTN),
   2928      &                UUU(NLEV,NTIMES,NINC,NSTN),
   2929      &                VVV(NLEV,NTIMES,NINC,NSTN),
   2930      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   2931      &                NIN(NLEV,NTIMES,NSTN),
   2932      &                LLL(NLEV,NTIMES,NINC,NSTN),
   2933      &                TFC(NLEV,NTIMES,NINC,NSTN),
   2934      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   2935       COMMON /MATRIC/ A(NSTN,45), C(NSTN,9), NMAT(NSTN), NM
   2936       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   2937      &                CQCPC, NEV, NME
   2938 
   2939 C  SOLVE THE MATRIX PROBLEMS
   2940 C    A IS THE SYMMETRIC MATRIX (IN TRIANGULAR FORM)
   2941 C    C IS THE RIGHT-HAND-SIDE VECTOR ON INPUT AND
   2942 C    THE ANALYSIS WEIGHTS ON OUTPUT FROM DRCTSL.
   2943 
   2944       CALL DRCTSL(A,C,DPR,NMAT,9,NM,1)
   2945 
   2946       RETURN
   2947       END

Page 92          Source Listing                  SOLVE
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name              
                    
 solve_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Scalar 2935     R(4)            4     2     13500    COM              2944                              
 C                          Scalar 2935     R(4)            4     2     2700     COM              2944                              
 CON                        Scalar 2936     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 2937     R(4)            4           scalar   COM                                                
 DPR                        Local  2925     R(4)            4     2     300                       2944                              
 DRCTSL                     Subr   2944                                                           2944                              
 IHE                        Scalar 2936     I(4)            4           scalar   COM                                                
 INCS                       Common 2926                                 6300000                                                     
 IOUT                       Scalar 2936     I(4)            4           scalar   COM                                                
 IUNIT                      Scalar 2936     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 2936     I(4)            4           scalar   COM                                                
 LLL                        Scalar 2932     I(4)            4     4     189000   COM                                                
 MATRIC                     Common 2935                                 66004                                                       
 NEV                        Scalar 2937     I(4)            4           scalar   COM                                                
 NIN                        Scalar 2931     I(4)            4     3     63000    COM                                                
 NINC                       Param  2924     I(4)            4           scalar                    2926,2927,2928,2929,2930,2932,2933
                                                                                                  ,2934                             
 NLEV                       Param  2924     I(4)            4           scalar                    2926,2927,2928,2929,2930,2931,2932
                                                                                                  ,2933,2934                        
 NM                         Scalar 2935     I(4)            4           scalar   COM              2944                              
 NMAT                       Scalar 2935     I(4)            4     1     300      COM              2944                              
 NME                        Scalar 2937     I(4)            4           scalar   COM                                                
 NST                        Scalar 2936     I(4)            4           scalar   COM                                                
 NSTN                       Param  2924     I(4)            4           scalar                    2925,2926,2927,2928,2929,2930,2931
                                                                                                  ,2932,2933,2934,2935              
 NTIMES                     Param  2924     I(4)            4           scalar                    2926,2927,2928,2929,2930,2931,2932
                                                                                                  ,2933,2934                        
 NUM                        Scalar 2936     I(4)            4           scalar   COM                                                
 PARAMS                     Common 2936                                 40                                                          
 QQQ                        Scalar 2934     R(4)            4     4     189000   COM                                                
 SOLVE                      Subr   2922                                                                                             
 TFC                        Scalar 2933     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 2930     R(4)            4     4     189000   COM                                                
 UIN                        Scalar 2926     R(4)            4     4     189000   COM                                                
 UUU                        Scalar 2928     R(4)            4     4     189000   COM                                                
 VIN                        Scalar 2927     R(4)            4     4     189000   COM                                                
 VVV                        Scalar 2929     R(4)            4     4     189000   COM                                                

Page 93          Source Listing                  SOLVE
2017-04-18 11:07                                 cqcvad.f

   2948 
   2949 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   2950 C
   2951 C SUBPROGRAM: SORTD
   2952 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   2953 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   2954 C       process) from 200 to 300.
   2955 C
   2956 C ABSTRACT: SORT D, L, J, N, ALL ACCORDING TO ORDER OF D.
   2957 C
   2958 C PROGRAM HISTORY LOG:
   2959 C 1999-08-18  W. COLLINS
   2960 C
   2961 C USAGE:    CALL SORTD(D,L,J,N,NC)
   2962 C   INPUT ARGUMENT LIST:
   2963 C     D        - ARRAY GOVERNING ORDER OF SORT FOR ALL
   2964 C     L        - ARRAY TO SORT
   2965 C     J        - ARRAY TO SORT
   2966 C     N        - ARRAY TO SORT
   2967 C     NC       - NUMBER OF ELEMENTS TO SORT
   2968 C
   2969 C   OUTPUT ARGUMENT LIST:
   2970 C     D        - SORTED ARRAY
   2971 C     L        - SORTED ARRAY
   2972 C     J        - SORTED ARRAY
   2973 C     N        - SORTED ARRAY
   2974 C
   2975 C ATTRIBUTES:
   2976 C   LANGUAGE: FORTRAN 90
   2977 C   MACHINE:  NCEP WCOSS
   2978 C
   2979 C$$$
   2980       SUBROUTINE SORTD(D,L,J,N,NC)
   2981 
   2982       PARAMETER(NSTN=300)
   2983       REAL    D(*), W(NSTN)
   2984       INTEGER L(*), J(*), N(*), INDX(NSTN), IW(NSTN)
   2985       INDX = 0
   2986 
   2987       CALL INDEXX(NC,D,INDX)
   2988 
   2989       W(1:NC) = D(1:NC)
   2990       D(1:NC) = W(INDX(1:NC))
   2991 
   2992       IW(1:NC) = L(1:NC)
   2993       L(1:NC) = IW(INDX(1:NC))
   2994 
   2995       IW(1:NC) = J(1:NC)
   2996       J(1:NC) = IW(INDX(1:NC))
   2997 
   2998       IW(1:NC) = N(1:NC)
   2999       N(1:NC) = IW(INDX(1:NC))
   3000 
   3001       RETURN
   3002       END

Page 94          Source Listing                  SORTD
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name              
                    
 sortd_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 D                          Dummy  2980     R(4)            4     1     0        ARG,INOUT        2987,2989,2990                    
 INDEXX                     Subr   2987                                                           2987                              
 INDX                       Local  2984     I(4)            4     1     300                       2985,2987,2990,2993,2996,2999     
 IW                         Local  2984     I(4)            4     1     300                       2992,2993,2995,2996,2998,2999     
 J                          Dummy  2980     I(4)            4     1     0        ARG,INOUT        2995,2996                         
 L                          Dummy  2980     I(4)            4     1     0        ARG,INOUT        2992,2993                         
 N                          Dummy  2980     I(4)            4     1     0        ARG,INOUT        2998,2999                         
 NC                         Dummy  2980     I(4)            4           scalar   ARG,INOUT        2987,2989,2990,2992,2993,2995,2996
                                                                                                  ,2998,2999                        
 NSTN                       Param  2982     I(4)            4           scalar                    2983,2984                         
 SORTD                      Subr   2980                                                                                             
 W                          Local  2983     R(4)            4     1     300                       2989,2990                         

Page 95          Source Listing                  SORTD
2017-04-18 11:07                                 cqcvad.f

   3003 
   3004 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3005 C
   3006 C SUBPROGRAM: VSOLVE
   3007 C   PRGMMR: WOOLLEN          ORG: NMC22      DATE: 2016-12-18
   3008 C
   3009 C ABSTRACT: CHOLESKY TYPE SOLUTION FOR ARRAYS OF POSITIVE DEFINITE
   3010 C   SYMMETRIC MATRIXES.
   3011 C
   3012 C PROGRAM HISTORY LOG:
   3013 C   90-11-06  J. WOOLLEN
   3014 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   3015 C       process) from 200 to 300.
   3016 C
   3017 C USAGE:
   3018 C   INPUT ARGUMENTS:
   3019 C     A          - ARRAY OF SYMMETRIC MATRIXES
   3020 C     B          - ARRAY OF RIGHT HAND SIDE VECTORS
   3021 C     NDIM       - ARRAY OF MATRIX RANKS
   3022 C     BAD        - BAD MATRIX INDICATOR
   3023 C     NFT        - NUMBER OF RIGHT HAND SIDES PER MATRIX
   3024 C     NS         - NUMBER OF MATRIXES TO SOLVE
   3025 C     MAXDIM     - LARGEST RANK MATRIX IN STACK
   3026 C
   3027 C   OUTPUT ARGUMENTS:
   3028 C     B          - CONTAINS THE SOLUTIONS UPON RETURN
   3029 C
   3030 C REMARKS: TRIANGULAR REPRESENTATION LISTS ELEMENTS TOWARDS THE
   3031 C   DIAGONAL. ALGORITHM FROM H.CARUS.
   3032 C
   3033 C ATTRIBUTES:
   3034 C   LANGUAGE: FORTRAN 90
   3035 C   MACHINE:  NCEP WCOSS
   3036 C
   3037 C$$$
   3038       SUBROUTINE VSOLVE (A,B,NDIM,BAD,NFT,NS,MAXDIM)
   3039 
   3040       PARAMETER(NSTN=300)
   3041       DIMENSION A(NSTN,45),B(NSTN,9,1),NDIM(NSTN),BAD(NSTN),T(NSTN)
   3042       LOGICAL BAD
   3043 
   3044       DATA CNUM/1.E-15/
   3045 
   3046 C----------------------------------------------------------------------
   3047       IX (I,J) = I*(I-1)/2 + J
   3048 C----------------------------------------------------------------------
   3049 
   3050       N = MAXDIM
   3051 
   3052       BAD(1:NS) = .FALSE.
   3053 
   3054 C  DECOMPOSE THE MATRIXES
   3055 C  ----------------------
   3056 
   3057       DO I=1,N
   3058          DO J=1,I
   3059             T(1:NS) = A(1:NS,IX(I,J))

Page 96          Source Listing                  VSOLVE
2017-04-18 11:07                                 cqcvad.f

   3060             DO K=1,J-1
   3061                DO M=1,NS
   3062                   T(M) = T(M) - A(M,IX(I,K)) * A(M,IX(J,K))
   3063                END DO
   3064             END DO
   3065             IF(I.GT.J) THEN
   3066                DO M=1,NS
   3067                   A(M,IX(I,J)) = T(M) * A(M,IX(j,J))
   3068                END DO
   3069             ELSE
   3070                DO M=1,NS
   3071                   IF(T(M).LT.CNUM .AND. NDIM(M).GE.I) BAD(M) = .TRUE.
   3072                   IF(T(M).LE.0) T(M) = 1.
   3073                END DO
   3074                A(1:NS,IX(I,I)) = 1./SQRT(T(1:NS))
   3075             ENDIF
   3076          END DO
   3077       END DO
   3078 
   3079 C  SOLVE FOR ALL RIGHT HAND SIDES
   3080 C  ------------------------------
   3081 
   3082       DO NF=1,NFT
   3083 
   3084 C  FORWARD SUBSTITUTION
   3085 C  --------------------
   3086 
   3087          DO I=1,N
   3088             T(1:NS) = B(1:NS,I,NF)
   3089             DO J=1,I-1
   3090                DO M=1,NS
   3091                   T(M) = T(M) - A(M,IX(I,J)) * B(M,J,NF)
   3092                END DO
   3093             END DO
   3094             B(1:NS,I,NF) = T(1:NS) * A(1:NS,IX(I,I))
   3095          END DO
   3096 
   3097 C  BACKWARD SUBSTITUTION
   3098 C  ---------------------
   3099 
   3100          DO I=N,1,-1
   3101             T(1:NS) = B(1:NS,I,NF)
   3102             IF(I.NE.N) THEN
   3103                DO J=I+1,N
   3104                   DO M=1,NS
   3105                      T(M) = T(M) - A(M,IX(J,I)) * B(M,J,NF)
   3106                   END DO
   3107                END DO
   3108             END IF
   3109             B(1:NS,I,NF) = T(1:NS) * A(1:NS,IX(I,I))
   3110          END DO
   3111       END DO
   3112 
   3113       RETURN
   3114       END

Page 97          Source Listing                  VSOLVE
2017-04-18 11:07 Entry Points                    cqcvad.f



ENTRY POINTS

  Name               
                     
 vsolve_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  3038     R(4)            4     2     13500    ARG,INOUT        3059,3062,3067,3074,3091,3094,3105
                                                                                                  ,3109                             
 B                          Dummy  3038     R(4)            4     3     2700     ARG,INOUT        3088,3091,3094,3101,3105,3109     
 BAD                        Dummy  3038     L(4)            4     1     300      ARG,INOUT        3052,3071                         
 CNUM                       Local  3044     R(4)            4           scalar                    3044,3071                         
 I                          Local  3057     I(4)            4           scalar                    3057,3058,3059,3062,3065,3067,3071
                                                                                                  ,3074,3087,3088,3089,3091,3094,310
                                                                                                  0,3101,3102,3103,3105,3109        
 IX                         Local  3047     I(4)            4           scalar                    3059,3062,3067,3074,3091,3094,3105
                                                                                                  ,3109                             
 J                          Local  3058     I(4)            4           scalar                    3058,3059,3060,3062,3065,3067,3089
                                                                                                  ,3091,3103,3105                   
 K                          Local  3060     I(4)            4           scalar                    3060,3062                         
 M                          Local  3061     I(4)            4           scalar                    3061,3062,3066,3067,3070,3071,3072
                                                                                                  ,3090,3091,3104,3105              
 MAXDIM                     Dummy  3038     I(4)            4           scalar   ARG,INOUT        3050                              
 N                          Local  3050     I(4)            4           scalar                    3050,3057,3087,3100,3102,3103     
 NDIM                       Dummy  3038     I(4)            4     1     300      ARG,INOUT        3071                              
 NF                         Local  3082     I(4)            4           scalar                    3082,3088,3091,3094,3101,3105,3109
 NFT                        Dummy  3038     I(4)            4           scalar   ARG,INOUT        3082                              
 NS                         Dummy  3038     I(4)            4           scalar   ARG,INOUT        3052,3059,3061,3066,3070,3074,3088
                                                                                                  ,3090,3094,3101,3104,3109         
 NSTN                       Param  3040     I(4)            4           scalar                    3041                              
 SQRT                       Func   3074                                 scalar                    3074                              
 T                          Local  3041     R(4)            4     1     300                       3059,3062,3067,3071,3072,3074,3088
                                                                                                  ,3091,3094,3101,3105,3109         
 VSOLVE                     Subr   3038                                                                                             

Page 98          Source Listing                  VSOLVE
2017-04-18 11:07                                 cqcvad.f

   3115 
   3116 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3117 C
   3118 C SUBPROGRAM: ZTOI
   3119 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 1999-08-18
   3120 C
   3121 C ABSTRACT: PERFORM OI ANALYSIS IN Z-T PLANE, ONE STATION AT A TIME.
   3122 C   PERFORM OI ANALYSIS FOR ALL POSSIBLE HOURS.
   3123 C
   3124 C PROGRAM HISTORY LOG:
   3125 C 1999-08-18  W. COLLINS
   3126 C 2012-03-05  S. MELCHIOR  ADDED PARAMETER NTIMES=6 TO TIDY UP THE
   3127 C       CODE. RENAMED NE TO NME FOR EASE OF NAVIGATION AND FOR
   3128 C       CLARIFICATION SINCE NE IS USED FOR INEQUALITY TESTING
   3129 C       (.NE.).
   3130 C
   3131 C USAGE:    CALL ZTOI
   3132 C
   3133 C ATTRIBUTES:
   3134 C   LANGUAGE: FORTRAN 90
   3135 C   MACHINE:  NCEP WCOSS
   3136 C
   3137 C$$$
   3138       SUBROUTINE ZTOI
   3139 
   3140       PARAMETER (NLEV=35,NTIMES=6)
   3141       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   3142      &                CQCPC, NEV, NME
   3143 
   3144 C  PERFORM OI ANALYSIS IN Z-T PLANE, ONE STATION AT A TIME.
   3145 C  PERFORM OI ANALYSIS FOR THE CENTRAL 3 HOURS
   3146 C  --------------------------------------------------------
   3147 
   3148       DO IS=1,NST !  nst max is nstn
   3149         DO IT=1,NTIMES
   3150 
   3151 C  SELECT DATA FOR THE ANALYSIS
   3152 C  ----------------------------
   3153 
   3154           CALL SELECT(IS,IT)
   3155 
   3156 C  SET UP MATRICES
   3157 C  ---------------
   3158 
   3159           CALL MATR(IS,IT)
   3160 
   3161 C  SOLVE MATRICES
   3162 C  --------------
   3163 
   3164           CALL SOLVE
   3165 
   3166 C  GET RESIDUALS
   3167 C  -------------
   3168 
   3169           CALL ZTRES(IS,IT)
   3170 
   3171         ENDDO

Page 99          Source Listing                  ZTOI
2017-04-18 11:07                                 cqcvad.f

   3172       ENDDO
   3173       RETURN
   3174       END


ENTRY POINTS

  Name             
                   
 ztoi_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CON                        Scalar 3141     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 3142     R(4)            4           scalar   COM                                                
 IHE                        Scalar 3141     I(4)            4           scalar   COM                                                
 IOUT                       Scalar 3141     I(4)            4           scalar   COM                                                
 IS                         Local  3148     I(4)            4           scalar                    3148,3154,3159,3169               
 IT                         Local  3149     I(4)            4           scalar                    3149,3154,3159,3169               
 IUNIT                      Scalar 3141     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 3141     I(4)            4           scalar   COM                                                
 MATR                       Subr   3159                                                           3159                              
 NEV                        Scalar 3142     I(4)            4           scalar   COM                                                
 NLEV                       Param  3140     I(4)            4           scalar                                                      
 NME                        Scalar 3142     I(4)            4           scalar   COM                                                
 NST                        Scalar 3141     I(4)            4           scalar   COM              3148                              
 NTIMES                     Param  3140     I(4)            4           scalar                    3149                              
 NUM                        Scalar 3141     I(4)            4           scalar   COM                                                
 PARAMS                     Common 3141                                 40                                                          
 SELECT                     Subr   3154                                                           3154                              
 SOLVE                      Subr   3164                                                           3164                              
 ZTOI                       Subr   3138                                                                                             
 ZTRES                      Subr   3169                                                           3169                              

Page 100         Source Listing                  ZTOI
2017-04-18 11:07                                 cqcvad.f

   3175 
   3176 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
   3177 C
   3178 C SUBPROGRAM: ZTRES
   3179 C   PRGMMR: W. COLLINS       ORG: NP22       DATE: 2016-12-18
   3180 C
   3181 C ABSTRACT: SOLVE FOR THE HEIGHT-TIME OI ANALYSIS RESIDUALS
   3182 C
   3183 C PROGRAM HISTORY LOG:
   3184 C 1999-08-18  W. COLLINS
   3185 C 2012-03-05  S. MELCHIOR  ADDED PARAMETERS NTIMES=6 AND NINC=3 TO
   3186 C       TIDY UP THE CODE. RENAMED NE TO NME FOR EASE OF 
   3187 C       NAVIGATION AND FOR CLARIFICATION AS NE IS USED FOR
   3188 C       INEQUALITY TESTING (.NE.).
   3189 C 2016-12-18  D. Stokes  Increased NSTN (maximum number of stations to
   3190 C       process) from 200 to 300.
   3191 C
   3192 C USAGE:    CALL ZTRES(IS,IT)
   3193 C   INPUT ARGUMENT LIST:
   3194 C     IS       - STATION INDEX
   3195 C     IT       - TIME INDEX
   3196 C
   3197 C ATTRIBUTES:
   3198 C   LANGUAGE: FORTRAN 90
   3199 C   MACHINE:  NCEP WCOSS
   3200 C
   3201 C$$$
   3202       SUBROUTINE ZTRES(IS,IT)
   3203 
   3204       PARAMETER(NSTN=300,NLEV=35,NTIMES=6,NINC=3)
   3205       REAL WU(NSTN), WV(NSTN)
   3206 
   3207       COMMON /MATRIC/ A(NSTN,45), C(NSTN,9), NMAT(NSTN), NM
   3208       COMMON /PARAMS/ IUNIT, IUTIM, IOUT, CON, IHE, NUM, NST,
   3209      &                CQCPC, NEV, NME
   3210       COMMON /INCS/   UIN(NLEV,NTIMES,NINC,NSTN),
   3211      &                VIN(NLEV,NTIMES,NINC,NSTN),
   3212      &                UUU(NLEV,NTIMES,NINC,NSTN),
   3213      &                VVV(NLEV,NTIMES,NINC,NSTN),
   3214      &                TIMIN(NLEV,NTIMES,NINC,NSTN),
   3215      &                NIN(NLEV,NTIMES,NSTN),
   3216      &                LLL(NLEV,NTIMES,NINC,NSTN),
   3217      &                TFC(NLEV,NTIMES,NINC,NSTN),
   3218      &                QQQ(NLEV,NTIMES,NINC,NSTN)
   3219       COMMON /COLECT/ LS(NSTN,NLEV,NINC), JS(NSTN,NLEV,NINC),
   3220      &                NS(NSTN,NLEV,NINC), NC(NLEV,NINC),
   3221      &                DS(NSTN,NLEV,NINC),
   3222      &                LTSCOL(9,NLEV,NTIMES,NINC,NSTN)
   3223       COMMON /HTRES/  RGU(NLEV,NTIMES,NINC,NSTN),
   3224      &                 RGV(NLEV,NTIMES,NINC,NSTN)
   3225 
   3226 C  SOLVE FOR THE HEIGHT-TIME OI ANALYSIS RESIDUALS
   3227 C  -----------------------------------------------
   3228 
   3229       NN = 0
   3230       DO L=1,NLEV
   3231         IF(NIN(L,IT,IS).NE.0) THEN

Page 101         Source Listing                  ZTRES
2017-04-18 11:07                                 cqcvad.f

   3232           DO N=1,NIN(L,IT,IS) !  nin(L,IT,IS) max is 3
   3233             NN = NN + 1
   3234             RGU(L,IT,N,IS) = UIN(L,IT,N,IS)
   3235             RGV(L,IT,N,IS) = VIN(L,IT,N,IS)
   3236             LOOP1: DO I=1,NMAT(NN)
   3237 
   3238               IF(LTSCOL(I,L,IT,N,IS).EQ.0) CYCLE LOOP1
   3239               LL = LTSCOL(I,L,IT,N,IS)/100
   3240               IF(LL.LT.1 .OR. LL.GT.NLEV) CYCLE LOOP1
   3241               ITS = LTSCOL(I,L,IT,N,IS)-100*LL
   3242               IF(ITS.EQ.0) CYCLE LOOP1
   3243               ITEMP = ITS/10
   3244               ISUBT = ITS-10*ITEMP
   3245 
   3246               RGU(L,IT,N,IS) = RGU(L,IT,N,IS) -
   3247      &            C(NN,I) * UIN(LL,ITEMP,ISUBT,IS)
   3248               RGV(L,IT,N,IS) = RGV(L,IT,N,IS) -
   3249      &            C(NN,I) * VIN(LL,ITEMP,ISUBT,IS)
   3250             ENDDO  LOOP1
   3251             WU(NN) = RGU(L,IT,N,IS)
   3252             WV(NN) = RGV(L,IT,N,IS)
   3253           ENDDO
   3254         ENDIF
   3255       ENDDO
   3256 
   3257       RETURN
   3258       END


ENTRY POINTS

  Name              
                    
 ztres_             

Page 102         Source Listing                  ZTRES
2017-04-18 11:07 Symbol Table                    cqcvad.f



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Scalar 3207     R(4)            4     2     13500    COM                                                
 C                          Scalar 3207     R(4)            4     2     2700     COM              3247,3249                         
 COLECT                     Common 3219                                 7308420                                                     
 CON                        Scalar 3208     R(4)            4           scalar   COM                                                
 CQCPC                      Scalar 3209     R(4)            4           scalar   COM                                                
 DS                         Scalar 3221     R(4)            4     3     31500    COM                                                
 HTRES                      Common 3223                                 1512000                                                     
 I                          Local  3236     I(4)            4           scalar                    3236,3238,3239,3241,3247,3249     
 IHE                        Scalar 3208     I(4)            4           scalar   COM                                                
 INCS                       Common 3210                                 6300000                                                     
 IOUT                       Scalar 3208     I(4)            4           scalar   COM                                                
 IS                         Dummy  3202     I(4)            4           scalar   ARG,INOUT        3231,3232,3234,3235,3238,3239,3241
                                                                                                  ,3246,3247,3248,3249,3251,3252    
 ISUBT                      Local  3244     I(4)            4           scalar                    3244,3247,3249                    
 IT                         Dummy  3202     I(4)            4           scalar   ARG,INOUT        3231,3232,3234,3235,3238,3239,3241
                                                                                                  ,3246,3248,3251,3252              
 ITEMP                      Local  3243     I(4)            4           scalar                    3243,3244,3247,3249               
 ITS                        Local  3241     I(4)            4           scalar                    3241,3242,3243,3244               
 IUNIT                      Scalar 3208     I(4)            4           scalar   COM                                                
 IUTIM                      Scalar 3208     I(4)            4           scalar   COM                                                
 JS                         Scalar 3219     I(4)            4     3     31500    COM                                                
 L                          Local  3230     I(4)            4           scalar                    3230,3231,3232,3234,3235,3238,3239
                                                                                                  ,3241,3246,3248,3251,3252         
 LL                         Local  3239     I(4)            4           scalar                    3239,3240,3241,3247,3249          
 LLL                        Scalar 3216     I(4)            4     4     189000   COM                                                
 LOOP1                      Label  3236                                 scalar                    3238,3240,3242,3250               
 LS                         Scalar 3219     I(4)            4     3     31500    COM                                                
 LTSCOL                     Scalar 3222     I(4)            4     5     1701000  COM              3238,3239,3241                    
 MATRIC                     Common 3207                                 66004                                                       
 N                          Local  3232     I(4)            4           scalar                    3232,3234,3235,3238,3239,3241,3246
                                                                                                  ,3248,3251,3252                   
 NC                         Scalar 3220     I(4)            4     2     105      COM                                                
 NEV                        Scalar 3209     I(4)            4           scalar   COM                                                
 NIN                        Scalar 3215     I(4)            4     3     63000    COM              3231,3232                         
 NINC                       Param  3204     I(4)            4           scalar                    3210,3211,3212,3213,3214,3216,3217
                                                                                                  ,3218,3219,3220,3221,3222,3223,322
                                                                                                  4                                 
 NLEV                       Param  3204     I(4)            4           scalar                    3210,3211,3212,3213,3214,3215,3216
                                                                                                  ,3217,3218,3219,3220,3221,3222,322
                                                                                                  3,3224,3230,3240                  
 NM                         Scalar 3207     I(4)            4           scalar   COM                                                
 NMAT                       Scalar 3207     I(4)            4     1     300      COM              3236                              
 NME                        Scalar 3209     I(4)            4           scalar   COM                                                
 NN                         Local  3229     I(4)            4           scalar                    3229,3233,3236,3247,3249,3251,3252
 NS                         Scalar 3220     I(4)            4     3     31500    COM                                                
 NST                        Scalar 3208     I(4)            4           scalar   COM                                                
 NSTN                       Param  3204     I(4)            4           scalar                    3205,3207,3210,3211,3212,3213,3214
                                                                                                  ,3215,3216,3217,3218,3219,3220,322
                                                                                                  1,3222,3223,3224                  
 NTIMES                     Param  3204     I(4)            4           scalar                    3210,3211,3212,3213,3214,3215,3216
                                                                                                  ,3217,3218,3222,3223,3224         

Page 103         Source Listing                  ZTRES
2017-04-18 11:07 Symbol Table                    cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NUM                        Scalar 3208     I(4)            4           scalar   COM                                                
 PARAMS                     Common 3208                                 40                                                          
 QQQ                        Scalar 3218     R(4)            4     4     189000   COM                                                
 RGU                        Scalar 3223     R(4)            4     4     189000   COM              3234,3246,3251                    
 RGV                        Scalar 3224     R(4)            4     4     189000   COM              3235,3248,3252                    
 TFC                        Scalar 3217     R(4)            4     4     189000   COM                                                
 TIMIN                      Scalar 3214     R(4)            4     4     189000   COM                                                
 UIN                        Scalar 3210     R(4)            4     4     189000   COM              3234,3247                         
 UUU                        Scalar 3212     R(4)            4     4     189000   COM                                                
 VIN                        Scalar 3211     R(4)            4     4     189000   COM              3235,3249                         
 VVV                        Scalar 3213     R(4)            4     4     189000   COM                                                
 WU                         Local  3205     R(4)            4     1     300                       3251                              
 WV                         Local  3205     R(4)            4     1     300                       3252                              
 ZTRES                      Subr   3202                                                                                             

Page 104         Source Listing                  ZTRES
2017-04-18 11:07 Subprograms/Common Blocks       cqcvad.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 <Block Data>                      300                                                                                              
 ANLWT                      Func   698      R(4)            4           scalar                    730,732                           
 BIRDS                      Common 1359                                 4                                                           
 BIRDS                      Common 2413                                 4                                                           
 BIRDST                     Common 133                                  1959804                                                     
 BIRDST                     Common 306                                  1959804                                                     
 BIRDST                     Common 1086                                 1959804                                                     
 BUFRLIB_MISSING            Common 139                                  8                                                           
 BUFRLIB_MISSING            Common 389                                  8                                                           
 BUFRLIB_MISSING            Common 1084                                 8                                                           
 BUFRLIB_MISSING            Common 1244                                 8                                                           
 BUFRLIB_MISSING            Common 1358                                 8                                                           
 BUFRLIB_MISSING            Common 1662                                 8                                                           
 BUFRLIB_MISSING            Common 1987                                 8                                                           
 BUFRLIB_MISSING            Common 2205                                 8                                                           
 BUFRLIB_MISSING            Common 2416                                 8                                                           
 COLECT                     Common 2248                                 7308420                                                     
 COLECT                     Common 2405                                 7308420                                                     
 COLECT                     Common 2833                                 7308420                                                     
 COLECT                     Common 3219                                 7308420                                                     
 COMSTAT                    Subr   354                                                                                              
 CONSTS                     Common 305                                  24                                                          
 CONSTS                     Common 2264                                 24                                                          
 CONSTS                     Common 2410                                 24                                                          
 CONSTS                     Common 2837                                 24                                                          
 CSTATS                     Subr   575                                                                                              
 CUMPROB                    Func   640      R(4)            4           scalar                    657,663                           
 DATET                      Common 136                                  40                                                          
 DATET                      Common 386                                  40                                                          
 DATET                      Common 1353                                 40                                                          
 DATET                      Common 1800                                 40                                                          
 DATET                      Common 1968                                 40                                                          
 DATET                      Common 2415                                 40                                                          
 DATET                      Common 2718                                 40                                                          
 DISTR                      Subr   796                                                                                              
 DMA                        Subr   2379                                                                                             
 DMATYP                     Common 391                                  756000                                                      
 DMATYP                     Common 1805                                 756000                                                      
 DMATYP                     Common 2414                                 756000                                                      
 DMATYP                     Common 2719                                 756000                                                      
 DRCTSL                     Subr   918                                                                                              
 EVENTS                     Common 1078                                 18000000                                                    
 EVENTS                     Common 2398                                 18000000                                                    
 EVENTW                     Subr   1237                                                                                             
 EVNOUT                     Subr   1065                                                                                             
 FLAG                       Common 138                                  4                                                           
 FLAG                       Common 309                                  4                                                           
 FLAG                       Common 1085                                 4                                                           
 FLAG                       Common 1988                                 4                                                           
 FLAG                       Common 2418                                 4                                                           
 GETDAT                     Subr   1325                                                                                             

Page 105         Source Listing                  ZTRES
2017-04-18 11:07 Subprograms/Common Blocks       cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GETOBV                     Subr   1648                                                                                             
 HT                         Subr   1711                                                                                             
 HTRES                      Common 2387                                 1512000                                                     
 HTRES                      Common 2713                                 1512000                                                     
 HTRES                      Common 3223                                 1512000                                                     
 HTS                        Common 304                                  280                                                         
 HTS                        Common 390                                  280                                                         
 HTS                        Common 1081                                 280                                                         
 HTS                        Common 1354                                 280                                                         
 HTS                        Common 1714                                 280                                                         
 HTS                        Common 1799                                 280                                                         
 HTS                        Common 2204                                 280                                                         
 HTS                        Common 2261                                 280                                                         
 HTS                        Common 2409                                 280                                                         
 HTS                        Common 2717                                 280                                                         
 HTS                        Common 2830                                 280                                                         
 INCDIST                    Subr   1782                                                                                             
 INCR                       Subr   1962                                                                                             
 INCS                       Common 377                                  6300000                                                     
 INCS                       Common 1342                                 6300000                                                     
 INCS                       Common 1788                                 6300000                                                     
 INCS                       Common 1976                                 6300000                                                     
 INCS                       Common 2195                                 6300000                                                     
 INCS                       Common 2252                                 6300000                                                     
 INCS                       Common 2389                                 6300000                                                     
 INCS                       Common 2704                                 6300000                                                     
 INCS                       Common 2821                                 6300000                                                     
 INCS                       Common 2926                                 6300000                                                     
 INCS                       Common 3210                                 6300000                                                     
 INDEXX                     Subr   2076                                                                                             
 INIT                       Subr   2187                                                                                             
 MATR                       Subr   2244                                                                                             
 MATRIC                     Common 2247                                 66004                                                       
 MATRIC                     Common 2935                                 66004                                                       
 MATRIC                     Common 3207                                 66004                                                       
 PARAMS                     Common 131                                  40                                                          
 PARAMS                     Common 302                                  40                                                          
 PARAMS                     Common 387                                  40                                                          
 PARAMS                     Common 1082                                 40                                                          
 PARAMS                     Common 1355                                 40                                                          
 PARAMS                     Common 1715                                 40                                                          
 PARAMS                     Common 1797                                 40                                                          
 PARAMS                     Common 1985                                 40                                                          
 PARAMS                     Common 2193                                 40                                                          
 PARAMS                     Common 2262                                 40                                                          
 PARAMS                     Common 2411                                 40                                                          
 PARAMS                     Common 2715                                 40                                                          
 PARAMS                     Common 2831                                 40                                                          
 PARAMS                     Common 2936                                 40                                                          
 PARAMS                     Common 3141                                 40                                                          
 PARAMS                     Common 3208                                 40                                                          
 PREPOBS_CQCVAD             Prog   121                                                                                              
 RESDIST                    Subr   2700                                                                                             
 SELECT                     Subr   2818                                                                                             
 SINGLE                     Common 372                                  26000000                                                    

Page 106         Source Listing                  ZTRES
2017-04-18 11:07 Subprograms/Common Blocks       cqcvad.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SINGLE                     Common 1071                                 26000000                                                    
 SINGLE                     Common 1337                                 26000000                                                    
 SINGLE                     Common 1971                                 26000000                                                    
 SOLVE                      Subr   2922                                                                                             
 SORTD                      Subr   2980                                                                                             
 STATS                      Common 1803                                 43768                                                       
 STATS                      Common 2401                                 43768                                                       
 STN                        Common 1076                                 4006000                                                     
 STN                        Common 1351                                 4006000                                                     
 STN                        Common 1786                                 4006000                                                     
 STN                        Common 1969                                 4006000                                                     
 STN                        Common 2403                                 4006000                                                     
 SWITCHES                   Common 137                                  16                                                          
 SWITCHES                   Common 1089                                 16                                                          
 SWITCHES                   Common 1245                                 16                                                          
 SWITCHES                   Common 2417                                 16                                                          
 VSOLVE                     Subr   3038                                                                                             
 ZTOI                       Subr   3138                                                                                             
 ZTRES                      Subr   3202                                                                                             

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume noold_ldout_format            -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume noprotect_allocates           -assume protect_constants
       -assume noprotect_parens              -assume split_common
       -assume source_include                -assume nostd_intent_in
       -assume std_minus0_rounding           -assume nostd_mod_proc_name
       -assume std_value                     -assume norealloc_lhs
       -assume underscore                    -assume no2underscores
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noargs                         -check noarg_temp_created
       -check noassume                       -check nobounds
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check power                          -check noshape

Page 107         Source Listing                  ZTRES
2017-04-18 11:07                                 cqcvad.f

       -check nostack                        -check nounderflow
       -check nouninitialized                -coarray-num-procs 0
  no   -coarray-config-file                  -convert big_endian
       -cross_reference                      -D __INTEL_COMPILER=1600
       -D __INTEL_COMPILER_UPDATE=3          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20160415
       -D __INTEL_OFFLOAD                    -D __i686
       -D __i686__                           -D __pentiumpro
       -D __pentiumpro__                     -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /usrx/local/intel/2016SP3/daal/include/,/usr/include/,.FOR,./.FOR,/usrx/local/intel/2016SP3/ipp/include/.FOR,
           /usrx/local/intel/2016SP3/mkl/include/.FOR,/usrx/local/intel/2016SP3/tbb/include/.FOR,/usrx/local/intel/2016SP3/daal/include/.FOR,

Page 108         Source Listing                  ZTRES
2017-04-18 11:07                                 cqcvad.f

           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64/.FOR,
           /gpfs/tp1/usrx/local/intel/2016SP3/compilers_and_libraries_2016.3.210/linux/compiler/include/.FOR,/usr/local/include/.FOR,
           /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/.FOR,/usr/include/.FOR,/usr/include/.FOR,/usr/include/.FOR
       -list filename : cqcvad.lst
       -o    filename : none

COMPILER: Intel(R) Fortran 16.0-1633
